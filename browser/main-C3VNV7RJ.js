var Cq=Object.create;var _I=Object.defineProperty,Eq=Object.defineProperties,Sq=Object.getOwnPropertyDescriptor,Dq=Object.getOwnPropertyDescriptors,Mq=Object.getOwnPropertyNames,N1=Object.getOwnPropertySymbols,Tq=Object.getPrototypeOf,yI=Object.prototype.hasOwnProperty,e3=Object.prototype.propertyIsEnumerable;var JN=(i,t,e)=>t in i?_I(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Ct=(i,t)=>{for(var e in t||={})yI.call(t,e)&&JN(i,e,t[e]);if(N1)for(var e of N1(t))e3.call(t,e)&&JN(i,e,t[e]);return i},Xi=(i,t)=>Eq(i,Dq(t));var r_=(i,t)=>{var e={};for(var n in i)yI.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&N1)for(var n of N1(i))t.indexOf(n)<0&&e3.call(i,n)&&(e[n]=i[n]);return e};var t3=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports);var Iq=(i,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Mq(t))!yI.call(i,s)&&s!==e&&_I(i,s,{get:()=>t[s],enumerable:!(n=Sq(t,s))||n.enumerable});return i};var o_=(i,t,e)=>(e=i!=null?Cq(Tq(i)):{},Iq(t||!i||!i.__esModule?_I(e,"default",{value:i,enumerable:!0}):e,i));var Ey=t3((uP,hP)=>{"use strict";(function(i,t){typeof uP=="object"&&typeof hP<"u"?hP.exports=t():typeof define=="function"&&define.amd?define(t):(i=typeof globalThis<"u"?globalThis:i||self,i.mapboxgl=t())})(uP,function(){"use strict";var i,t,e;function n(r,y){if(!i)i=y;else if(!t)t=y;else{var A="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+i+")(sharedChunk); ("+t+")(sharedChunk); self.onerror = null;",P={};i(P),e=y(P),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(e.workerUrl=window.URL.createObjectURL(new Blob([A],{type:"text/javascript"})))}}n(["exports"],function(r){function y(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var A,P={},B={};function U(){if(A)return B;A=1,Object.defineProperty(B,"__esModule",{value:!0}),B.setMatrixArrayType=function(p){B.ARRAY_TYPE=o=p},B.toRadian=function(p){return p*u},B.equals=function(p,h){return Math.abs(p-h)<=d*Math.max(1,Math.abs(p),Math.abs(h))},B.RANDOM=B.ARRAY_TYPE=B.EPSILON=void 0;var d=1e-6;B.EPSILON=d;var o=typeof Float32Array<"u"?Float32Array:Array;B.ARRAY_TYPE=o;var l=Math.random;B.RANDOM=l;var u=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var p=0,h=arguments.length;h--;)p+=arguments[h]*arguments[h];return Math.sqrt(p)}),B}var J,le={};function re(){if(J)return le;function d(h){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},d(h)}J=1,Object.defineProperty(le,"__esModule",{value:!0}),le.create=function(){var h=new o.ARRAY_TYPE(4);return o.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0),h[0]=1,h[3]=1,h},le.clone=function(h){var g=new o.ARRAY_TYPE(4);return g[0]=h[0],g[1]=h[1],g[2]=h[2],g[3]=h[3],g},le.copy=function(h,g){return h[0]=g[0],h[1]=g[1],h[2]=g[2],h[3]=g[3],h},le.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h},le.fromValues=function(h,g,x,C){var D=new o.ARRAY_TYPE(4);return D[0]=h,D[1]=g,D[2]=x,D[3]=C,D},le.set=function(h,g,x,C,D){return h[0]=g,h[1]=x,h[2]=C,h[3]=D,h},le.transpose=function(h,g){if(h===g){var x=g[1];h[1]=g[2],h[2]=x}else h[0]=g[0],h[1]=g[2],h[2]=g[1],h[3]=g[3];return h},le.invert=function(h,g){var x=g[0],C=g[1],D=g[2],v=g[3],E=x*v-D*C;return E?(h[0]=v*(E=1/E),h[1]=-C*E,h[2]=-D*E,h[3]=x*E,h):null},le.adjoint=function(h,g){var x=g[0];return h[0]=g[3],h[1]=-g[1],h[2]=-g[2],h[3]=x,h},le.determinant=function(h){return h[0]*h[3]-h[2]*h[1]},le.multiply=u,le.rotate=function(h,g,x){var C=g[0],D=g[1],v=g[2],E=g[3],T=Math.sin(x),S=Math.cos(x);return h[0]=C*S+v*T,h[1]=D*S+E*T,h[2]=C*-T+v*S,h[3]=D*-T+E*S,h},le.scale=function(h,g,x){var C=g[1],D=g[2],v=g[3],E=x[0],T=x[1];return h[0]=g[0]*E,h[1]=C*E,h[2]=D*T,h[3]=v*T,h},le.fromRotation=function(h,g){var x=Math.sin(g),C=Math.cos(g);return h[0]=C,h[1]=x,h[2]=-x,h[3]=C,h},le.fromScaling=function(h,g){return h[0]=g[0],h[1]=0,h[2]=0,h[3]=g[1],h},le.str=function(h){return"mat2("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+")"},le.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3])},le.LDU=function(h,g,x,C){return h[2]=C[2]/C[0],x[0]=C[0],x[1]=C[1],x[3]=C[3]-h[2]*x[1],[h,g,x]},le.add=function(h,g,x){return h[0]=g[0]+x[0],h[1]=g[1]+x[1],h[2]=g[2]+x[2],h[3]=g[3]+x[3],h},le.subtract=p,le.exactEquals=function(h,g){return h[0]===g[0]&&h[1]===g[1]&&h[2]===g[2]&&h[3]===g[3]},le.equals=function(h,g){var x=h[0],C=h[1],D=h[2],v=h[3],E=g[0],T=g[1],S=g[2],M=g[3];return Math.abs(x-E)<=o.EPSILON*Math.max(1,Math.abs(x),Math.abs(E))&&Math.abs(C-T)<=o.EPSILON*Math.max(1,Math.abs(C),Math.abs(T))&&Math.abs(D-S)<=o.EPSILON*Math.max(1,Math.abs(D),Math.abs(S))&&Math.abs(v-M)<=o.EPSILON*Math.max(1,Math.abs(v),Math.abs(M))},le.multiplyScalar=function(h,g,x){return h[0]=g[0]*x,h[1]=g[1]*x,h[2]=g[2]*x,h[3]=g[3]*x,h},le.multiplyScalarAndAdd=function(h,g,x,C){return h[0]=g[0]+x[0]*C,h[1]=g[1]+x[1]*C,h[2]=g[2]+x[2]*C,h[3]=g[3]+x[3]*C,h},le.sub=le.mul=void 0;var o=function(h,g){if(h&&h.__esModule)return h;if(h===null||d(h)!=="object"&&typeof h!="function")return{default:h};var x=l(void 0);if(x&&x.has(h))return x.get(h);var C={},D=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in h)if(v!=="default"&&Object.prototype.hasOwnProperty.call(h,v)){var E=D?Object.getOwnPropertyDescriptor(h,v):null;E&&(E.get||E.set)?Object.defineProperty(C,v,E):C[v]=h[v]}return C.default=h,x&&x.set(h,C),C}(U());function l(h){if(typeof WeakMap!="function")return null;var g=new WeakMap,x=new WeakMap;return(l=function(C){return C?x:g})(h)}function u(h,g,x){var C=g[0],D=g[1],v=g[2],E=g[3],T=x[0],S=x[1],M=x[2],R=x[3];return h[0]=C*T+v*S,h[1]=D*T+E*S,h[2]=C*M+v*R,h[3]=D*M+E*R,h}function p(h,g,x){return h[0]=g[0]-x[0],h[1]=g[1]-x[1],h[2]=g[2]-x[2],h[3]=g[3]-x[3],h}return le.mul=u,le.sub=p,le}var X,ee={};function we(){if(X)return ee;function d(h){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},d(h)}X=1,Object.defineProperty(ee,"__esModule",{value:!0}),ee.create=function(){var h=new o.ARRAY_TYPE(6);return o.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[4]=0,h[5]=0),h[0]=1,h[3]=1,h},ee.clone=function(h){var g=new o.ARRAY_TYPE(6);return g[0]=h[0],g[1]=h[1],g[2]=h[2],g[3]=h[3],g[4]=h[4],g[5]=h[5],g},ee.copy=function(h,g){return h[0]=g[0],h[1]=g[1],h[2]=g[2],h[3]=g[3],h[4]=g[4],h[5]=g[5],h},ee.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=0,h[5]=0,h},ee.fromValues=function(h,g,x,C,D,v){var E=new o.ARRAY_TYPE(6);return E[0]=h,E[1]=g,E[2]=x,E[3]=C,E[4]=D,E[5]=v,E},ee.set=function(h,g,x,C,D,v,E){return h[0]=g,h[1]=x,h[2]=C,h[3]=D,h[4]=v,h[5]=E,h},ee.invert=function(h,g){var x=g[0],C=g[1],D=g[2],v=g[3],E=g[4],T=g[5],S=x*v-C*D;return S?(h[0]=v*(S=1/S),h[1]=-C*S,h[2]=-D*S,h[3]=x*S,h[4]=(D*T-v*E)*S,h[5]=(C*E-x*T)*S,h):null},ee.determinant=function(h){return h[0]*h[3]-h[1]*h[2]},ee.multiply=u,ee.rotate=function(h,g,x){var C=g[0],D=g[1],v=g[2],E=g[3],T=g[4],S=g[5],M=Math.sin(x),R=Math.cos(x);return h[0]=C*R+v*M,h[1]=D*R+E*M,h[2]=C*-M+v*R,h[3]=D*-M+E*R,h[4]=T,h[5]=S,h},ee.scale=function(h,g,x){var C=g[1],D=g[2],v=g[3],E=g[4],T=g[5],S=x[0],M=x[1];return h[0]=g[0]*S,h[1]=C*S,h[2]=D*M,h[3]=v*M,h[4]=E,h[5]=T,h},ee.translate=function(h,g,x){var C=g[0],D=g[1],v=g[2],E=g[3],T=g[4],S=g[5],M=x[0],R=x[1];return h[0]=C,h[1]=D,h[2]=v,h[3]=E,h[4]=C*M+v*R+T,h[5]=D*M+E*R+S,h},ee.fromRotation=function(h,g){var x=Math.sin(g),C=Math.cos(g);return h[0]=C,h[1]=x,h[2]=-x,h[3]=C,h[4]=0,h[5]=0,h},ee.fromScaling=function(h,g){return h[0]=g[0],h[1]=0,h[2]=0,h[3]=g[1],h[4]=0,h[5]=0,h},ee.fromTranslation=function(h,g){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=g[0],h[5]=g[1],h},ee.str=function(h){return"mat2d("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+")"},ee.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],1)},ee.add=function(h,g,x){return h[0]=g[0]+x[0],h[1]=g[1]+x[1],h[2]=g[2]+x[2],h[3]=g[3]+x[3],h[4]=g[4]+x[4],h[5]=g[5]+x[5],h},ee.subtract=p,ee.multiplyScalar=function(h,g,x){return h[0]=g[0]*x,h[1]=g[1]*x,h[2]=g[2]*x,h[3]=g[3]*x,h[4]=g[4]*x,h[5]=g[5]*x,h},ee.multiplyScalarAndAdd=function(h,g,x,C){return h[0]=g[0]+x[0]*C,h[1]=g[1]+x[1]*C,h[2]=g[2]+x[2]*C,h[3]=g[3]+x[3]*C,h[4]=g[4]+x[4]*C,h[5]=g[5]+x[5]*C,h},ee.exactEquals=function(h,g){return h[0]===g[0]&&h[1]===g[1]&&h[2]===g[2]&&h[3]===g[3]&&h[4]===g[4]&&h[5]===g[5]},ee.equals=function(h,g){var x=h[0],C=h[1],D=h[2],v=h[3],E=h[4],T=h[5],S=g[0],M=g[1],R=g[2],L=g[3],N=g[4],$=g[5];return Math.abs(x-S)<=o.EPSILON*Math.max(1,Math.abs(x),Math.abs(S))&&Math.abs(C-M)<=o.EPSILON*Math.max(1,Math.abs(C),Math.abs(M))&&Math.abs(D-R)<=o.EPSILON*Math.max(1,Math.abs(D),Math.abs(R))&&Math.abs(v-L)<=o.EPSILON*Math.max(1,Math.abs(v),Math.abs(L))&&Math.abs(E-N)<=o.EPSILON*Math.max(1,Math.abs(E),Math.abs(N))&&Math.abs(T-$)<=o.EPSILON*Math.max(1,Math.abs(T),Math.abs($))},ee.sub=ee.mul=void 0;var o=function(h,g){if(h&&h.__esModule)return h;if(h===null||d(h)!=="object"&&typeof h!="function")return{default:h};var x=l(void 0);if(x&&x.has(h))return x.get(h);var C={},D=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in h)if(v!=="default"&&Object.prototype.hasOwnProperty.call(h,v)){var E=D?Object.getOwnPropertyDescriptor(h,v):null;E&&(E.get||E.set)?Object.defineProperty(C,v,E):C[v]=h[v]}return C.default=h,x&&x.set(h,C),C}(U());function l(h){if(typeof WeakMap!="function")return null;var g=new WeakMap,x=new WeakMap;return(l=function(C){return C?x:g})(h)}function u(h,g,x){var C=g[0],D=g[1],v=g[2],E=g[3],T=g[4],S=g[5],M=x[0],R=x[1],L=x[2],N=x[3],$=x[4],H=x[5];return h[0]=C*M+v*R,h[1]=D*M+E*R,h[2]=C*L+v*N,h[3]=D*L+E*N,h[4]=C*$+v*H+T,h[5]=D*$+E*H+S,h}function p(h,g,x){return h[0]=g[0]-x[0],h[1]=g[1]-x[1],h[2]=g[2]-x[2],h[3]=g[3]-x[3],h[4]=g[4]-x[4],h[5]=g[5]-x[5],h}return ee.mul=u,ee.sub=p,ee}var Re,Ce={};function Te(){if(Re)return Ce;function d(h){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},d(h)}Re=1,Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.create=function(){var h=new o.ARRAY_TYPE(9);return o.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h},Ce.fromMat4=function(h,g){return h[0]=g[0],h[1]=g[1],h[2]=g[2],h[3]=g[4],h[4]=g[5],h[5]=g[6],h[6]=g[8],h[7]=g[9],h[8]=g[10],h},Ce.clone=function(h){var g=new o.ARRAY_TYPE(9);return g[0]=h[0],g[1]=h[1],g[2]=h[2],g[3]=h[3],g[4]=h[4],g[5]=h[5],g[6]=h[6],g[7]=h[7],g[8]=h[8],g},Ce.copy=function(h,g){return h[0]=g[0],h[1]=g[1],h[2]=g[2],h[3]=g[3],h[4]=g[4],h[5]=g[5],h[6]=g[6],h[7]=g[7],h[8]=g[8],h},Ce.fromValues=function(h,g,x,C,D,v,E,T,S){var M=new o.ARRAY_TYPE(9);return M[0]=h,M[1]=g,M[2]=x,M[3]=C,M[4]=D,M[5]=v,M[6]=E,M[7]=T,M[8]=S,M},Ce.set=function(h,g,x,C,D,v,E,T,S,M){return h[0]=g,h[1]=x,h[2]=C,h[3]=D,h[4]=v,h[5]=E,h[6]=T,h[7]=S,h[8]=M,h},Ce.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},Ce.transpose=function(h,g){if(h===g){var x=g[1],C=g[2],D=g[5];h[1]=g[3],h[2]=g[6],h[3]=x,h[5]=g[7],h[6]=C,h[7]=D}else h[0]=g[0],h[1]=g[3],h[2]=g[6],h[3]=g[1],h[4]=g[4],h[5]=g[7],h[6]=g[2],h[7]=g[5],h[8]=g[8];return h},Ce.invert=function(h,g){var x=g[0],C=g[1],D=g[2],v=g[3],E=g[4],T=g[5],S=g[6],M=g[7],R=g[8],L=R*E-T*M,N=-R*v+T*S,$=M*v-E*S,H=x*L+C*N+D*$;return H?(h[0]=L*(H=1/H),h[1]=(-R*C+D*M)*H,h[2]=(T*C-D*E)*H,h[3]=N*H,h[4]=(R*x-D*S)*H,h[5]=(-T*x+D*v)*H,h[6]=$*H,h[7]=(-M*x+C*S)*H,h[8]=(E*x-C*v)*H,h):null},Ce.adjoint=function(h,g){var x=g[0],C=g[1],D=g[2],v=g[3],E=g[4],T=g[5],S=g[6],M=g[7],R=g[8];return h[0]=E*R-T*M,h[1]=D*M-C*R,h[2]=C*T-D*E,h[3]=T*S-v*R,h[4]=x*R-D*S,h[5]=D*v-x*T,h[6]=v*M-E*S,h[7]=C*S-x*M,h[8]=x*E-C*v,h},Ce.determinant=function(h){var g=h[3],x=h[4],C=h[5],D=h[6],v=h[7],E=h[8];return h[0]*(E*x-C*v)+h[1]*(-E*g+C*D)+h[2]*(v*g-x*D)},Ce.multiply=u,Ce.translate=function(h,g,x){var C=g[0],D=g[1],v=g[2],E=g[3],T=g[4],S=g[5],M=g[6],R=g[7],L=g[8],N=x[0],$=x[1];return h[0]=C,h[1]=D,h[2]=v,h[3]=E,h[4]=T,h[5]=S,h[6]=N*C+$*E+M,h[7]=N*D+$*T+R,h[8]=N*v+$*S+L,h},Ce.rotate=function(h,g,x){var C=g[0],D=g[1],v=g[2],E=g[3],T=g[4],S=g[5],M=g[6],R=g[7],L=g[8],N=Math.sin(x),$=Math.cos(x);return h[0]=$*C+N*E,h[1]=$*D+N*T,h[2]=$*v+N*S,h[3]=$*E-N*C,h[4]=$*T-N*D,h[5]=$*S-N*v,h[6]=M,h[7]=R,h[8]=L,h},Ce.scale=function(h,g,x){var C=x[0],D=x[1];return h[0]=C*g[0],h[1]=C*g[1],h[2]=C*g[2],h[3]=D*g[3],h[4]=D*g[4],h[5]=D*g[5],h[6]=g[6],h[7]=g[7],h[8]=g[8],h},Ce.fromTranslation=function(h,g){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=g[0],h[7]=g[1],h[8]=1,h},Ce.fromRotation=function(h,g){var x=Math.sin(g),C=Math.cos(g);return h[0]=C,h[1]=x,h[2]=0,h[3]=-x,h[4]=C,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},Ce.fromScaling=function(h,g){return h[0]=g[0],h[1]=0,h[2]=0,h[3]=0,h[4]=g[1],h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},Ce.fromMat2d=function(h,g){return h[0]=g[0],h[1]=g[1],h[2]=0,h[3]=g[2],h[4]=g[3],h[5]=0,h[6]=g[4],h[7]=g[5],h[8]=1,h},Ce.fromQuat=function(h,g){var x=g[0],C=g[1],D=g[2],v=g[3],E=x+x,T=C+C,S=D+D,M=x*E,R=C*E,L=C*T,N=D*E,$=D*T,H=D*S,j=v*E,q=v*T,Y=v*S;return h[0]=1-L-H,h[3]=R-Y,h[6]=N+q,h[1]=R+Y,h[4]=1-M-H,h[7]=$-j,h[2]=N-q,h[5]=$+j,h[8]=1-M-L,h},Ce.normalFromMat4=function(h,g){var x=g[0],C=g[1],D=g[2],v=g[3],E=g[4],T=g[5],S=g[6],M=g[7],R=g[8],L=g[9],N=g[10],$=g[11],H=g[12],j=g[13],q=g[14],Y=g[15],Q=x*T-C*E,pe=x*S-D*E,de=x*M-v*E,ue=C*S-D*T,De=C*M-v*T,fe=D*M-v*S,Me=R*j-L*H,Fe=R*q-N*H,Pe=R*Y-$*H,ze=L*q-N*j,Ne=L*Y-$*j,Ge=N*Y-$*q,Ue=Q*Ge-pe*Ne+de*ze+ue*Pe-De*Fe+fe*Me;return Ue?(h[0]=(T*Ge-S*Ne+M*ze)*(Ue=1/Ue),h[1]=(S*Pe-E*Ge-M*Fe)*Ue,h[2]=(E*Ne-T*Pe+M*Me)*Ue,h[3]=(D*Ne-C*Ge-v*ze)*Ue,h[4]=(x*Ge-D*Pe+v*Fe)*Ue,h[5]=(C*Pe-x*Ne-v*Me)*Ue,h[6]=(j*fe-q*De+Y*ue)*Ue,h[7]=(q*de-H*fe-Y*pe)*Ue,h[8]=(H*De-j*de+Y*Q)*Ue,h):null},Ce.projection=function(h,g,x){return h[0]=2/g,h[1]=0,h[2]=0,h[3]=0,h[4]=-2/x,h[5]=0,h[6]=-1,h[7]=1,h[8]=1,h},Ce.str=function(h){return"mat3("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+", "+h[6]+", "+h[7]+", "+h[8]+")"},Ce.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],h[8])},Ce.add=function(h,g,x){return h[0]=g[0]+x[0],h[1]=g[1]+x[1],h[2]=g[2]+x[2],h[3]=g[3]+x[3],h[4]=g[4]+x[4],h[5]=g[5]+x[5],h[6]=g[6]+x[6],h[7]=g[7]+x[7],h[8]=g[8]+x[8],h},Ce.subtract=p,Ce.multiplyScalar=function(h,g,x){return h[0]=g[0]*x,h[1]=g[1]*x,h[2]=g[2]*x,h[3]=g[3]*x,h[4]=g[4]*x,h[5]=g[5]*x,h[6]=g[6]*x,h[7]=g[7]*x,h[8]=g[8]*x,h},Ce.multiplyScalarAndAdd=function(h,g,x,C){return h[0]=g[0]+x[0]*C,h[1]=g[1]+x[1]*C,h[2]=g[2]+x[2]*C,h[3]=g[3]+x[3]*C,h[4]=g[4]+x[4]*C,h[5]=g[5]+x[5]*C,h[6]=g[6]+x[6]*C,h[7]=g[7]+x[7]*C,h[8]=g[8]+x[8]*C,h},Ce.exactEquals=function(h,g){return h[0]===g[0]&&h[1]===g[1]&&h[2]===g[2]&&h[3]===g[3]&&h[4]===g[4]&&h[5]===g[5]&&h[6]===g[6]&&h[7]===g[7]&&h[8]===g[8]},Ce.equals=function(h,g){var x=h[0],C=h[1],D=h[2],v=h[3],E=h[4],T=h[5],S=h[6],M=h[7],R=h[8],L=g[0],N=g[1],$=g[2],H=g[3],j=g[4],q=g[5],Y=g[6],Q=g[7],pe=g[8];return Math.abs(x-L)<=o.EPSILON*Math.max(1,Math.abs(x),Math.abs(L))&&Math.abs(C-N)<=o.EPSILON*Math.max(1,Math.abs(C),Math.abs(N))&&Math.abs(D-$)<=o.EPSILON*Math.max(1,Math.abs(D),Math.abs($))&&Math.abs(v-H)<=o.EPSILON*Math.max(1,Math.abs(v),Math.abs(H))&&Math.abs(E-j)<=o.EPSILON*Math.max(1,Math.abs(E),Math.abs(j))&&Math.abs(T-q)<=o.EPSILON*Math.max(1,Math.abs(T),Math.abs(q))&&Math.abs(S-Y)<=o.EPSILON*Math.max(1,Math.abs(S),Math.abs(Y))&&Math.abs(M-Q)<=o.EPSILON*Math.max(1,Math.abs(M),Math.abs(Q))&&Math.abs(R-pe)<=o.EPSILON*Math.max(1,Math.abs(R),Math.abs(pe))},Ce.sub=Ce.mul=void 0;var o=function(h,g){if(h&&h.__esModule)return h;if(h===null||d(h)!=="object"&&typeof h!="function")return{default:h};var x=l(void 0);if(x&&x.has(h))return x.get(h);var C={},D=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in h)if(v!=="default"&&Object.prototype.hasOwnProperty.call(h,v)){var E=D?Object.getOwnPropertyDescriptor(h,v):null;E&&(E.get||E.set)?Object.defineProperty(C,v,E):C[v]=h[v]}return C.default=h,x&&x.set(h,C),C}(U());function l(h){if(typeof WeakMap!="function")return null;var g=new WeakMap,x=new WeakMap;return(l=function(C){return C?x:g})(h)}function u(h,g,x){var C=g[0],D=g[1],v=g[2],E=g[3],T=g[4],S=g[5],M=g[6],R=g[7],L=g[8],N=x[0],$=x[1],H=x[2],j=x[3],q=x[4],Y=x[5],Q=x[6],pe=x[7],de=x[8];return h[0]=N*C+$*E+H*M,h[1]=N*D+$*T+H*R,h[2]=N*v+$*S+H*L,h[3]=j*C+q*E+Y*M,h[4]=j*D+q*T+Y*R,h[5]=j*v+q*S+Y*L,h[6]=Q*C+pe*E+de*M,h[7]=Q*D+pe*T+de*R,h[8]=Q*v+pe*S+de*L,h}function p(h,g,x){return h[0]=g[0]-x[0],h[1]=g[1]-x[1],h[2]=g[2]-x[2],h[3]=g[3]-x[3],h[4]=g[4]-x[4],h[5]=g[5]-x[5],h[6]=g[6]-x[6],h[7]=g[7]-x[7],h[8]=g[8]-x[8],h}return Ce.mul=u,Ce.sub=p,Ce}var Xe,et={};function Pt(){if(Xe)return et;function d(v){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},d(v)}Xe=1,Object.defineProperty(et,"__esModule",{value:!0}),et.create=function(){var v=new o.ARRAY_TYPE(16);return o.ARRAY_TYPE!=Float32Array&&(v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[11]=0,v[12]=0,v[13]=0,v[14]=0),v[0]=1,v[5]=1,v[10]=1,v[15]=1,v},et.clone=function(v){var E=new o.ARRAY_TYPE(16);return E[0]=v[0],E[1]=v[1],E[2]=v[2],E[3]=v[3],E[4]=v[4],E[5]=v[5],E[6]=v[6],E[7]=v[7],E[8]=v[8],E[9]=v[9],E[10]=v[10],E[11]=v[11],E[12]=v[12],E[13]=v[13],E[14]=v[14],E[15]=v[15],E},et.copy=function(v,E){return v[0]=E[0],v[1]=E[1],v[2]=E[2],v[3]=E[3],v[4]=E[4],v[5]=E[5],v[6]=E[6],v[7]=E[7],v[8]=E[8],v[9]=E[9],v[10]=E[10],v[11]=E[11],v[12]=E[12],v[13]=E[13],v[14]=E[14],v[15]=E[15],v},et.fromValues=function(v,E,T,S,M,R,L,N,$,H,j,q,Y,Q,pe,de){var ue=new o.ARRAY_TYPE(16);return ue[0]=v,ue[1]=E,ue[2]=T,ue[3]=S,ue[4]=M,ue[5]=R,ue[6]=L,ue[7]=N,ue[8]=$,ue[9]=H,ue[10]=j,ue[11]=q,ue[12]=Y,ue[13]=Q,ue[14]=pe,ue[15]=de,ue},et.set=function(v,E,T,S,M,R,L,N,$,H,j,q,Y,Q,pe,de,ue){return v[0]=E,v[1]=T,v[2]=S,v[3]=M,v[4]=R,v[5]=L,v[6]=N,v[7]=$,v[8]=H,v[9]=j,v[10]=q,v[11]=Y,v[12]=Q,v[13]=pe,v[14]=de,v[15]=ue,v},et.identity=u,et.transpose=function(v,E){if(v===E){var T=E[1],S=E[2],M=E[3],R=E[6],L=E[7],N=E[11];v[1]=E[4],v[2]=E[8],v[3]=E[12],v[4]=T,v[6]=E[9],v[7]=E[13],v[8]=S,v[9]=R,v[11]=E[14],v[12]=M,v[13]=L,v[14]=N}else v[0]=E[0],v[1]=E[4],v[2]=E[8],v[3]=E[12],v[4]=E[1],v[5]=E[5],v[6]=E[9],v[7]=E[13],v[8]=E[2],v[9]=E[6],v[10]=E[10],v[11]=E[14],v[12]=E[3],v[13]=E[7],v[14]=E[11],v[15]=E[15];return v},et.invert=function(v,E){var T=E[0],S=E[1],M=E[2],R=E[3],L=E[4],N=E[5],$=E[6],H=E[7],j=E[8],q=E[9],Y=E[10],Q=E[11],pe=E[12],de=E[13],ue=E[14],De=E[15],fe=T*N-S*L,Me=T*$-M*L,Fe=T*H-R*L,Pe=S*$-M*N,ze=S*H-R*N,Ne=M*H-R*$,Ge=j*de-q*pe,Ue=j*ue-Y*pe,qe=j*De-Q*pe,gt=q*ue-Y*de,ft=q*De-Q*de,Gt=Y*De-Q*ue,wt=fe*Gt-Me*ft+Fe*gt+Pe*qe-ze*Ue+Ne*Ge;return wt?(v[0]=(N*Gt-$*ft+H*gt)*(wt=1/wt),v[1]=(M*ft-S*Gt-R*gt)*wt,v[2]=(de*Ne-ue*ze+De*Pe)*wt,v[3]=(Y*ze-q*Ne-Q*Pe)*wt,v[4]=($*qe-L*Gt-H*Ue)*wt,v[5]=(T*Gt-M*qe+R*Ue)*wt,v[6]=(ue*Fe-pe*Ne-De*Me)*wt,v[7]=(j*Ne-Y*Fe+Q*Me)*wt,v[8]=(L*ft-N*qe+H*Ge)*wt,v[9]=(S*qe-T*ft-R*Ge)*wt,v[10]=(pe*ze-de*Fe+De*fe)*wt,v[11]=(q*Fe-j*ze-Q*fe)*wt,v[12]=(N*Ue-L*gt-$*Ge)*wt,v[13]=(T*gt-S*Ue+M*Ge)*wt,v[14]=(de*Me-pe*Pe-ue*fe)*wt,v[15]=(j*Pe-q*Me+Y*fe)*wt,v):null},et.adjoint=function(v,E){var T=E[0],S=E[1],M=E[2],R=E[3],L=E[4],N=E[5],$=E[6],H=E[7],j=E[8],q=E[9],Y=E[10],Q=E[11],pe=E[12],de=E[13],ue=E[14],De=E[15];return v[0]=N*(Y*De-Q*ue)-q*($*De-H*ue)+de*($*Q-H*Y),v[1]=-(S*(Y*De-Q*ue)-q*(M*De-R*ue)+de*(M*Q-R*Y)),v[2]=S*($*De-H*ue)-N*(M*De-R*ue)+de*(M*H-R*$),v[3]=-(S*($*Q-H*Y)-N*(M*Q-R*Y)+q*(M*H-R*$)),v[4]=-(L*(Y*De-Q*ue)-j*($*De-H*ue)+pe*($*Q-H*Y)),v[5]=T*(Y*De-Q*ue)-j*(M*De-R*ue)+pe*(M*Q-R*Y),v[6]=-(T*($*De-H*ue)-L*(M*De-R*ue)+pe*(M*H-R*$)),v[7]=T*($*Q-H*Y)-L*(M*Q-R*Y)+j*(M*H-R*$),v[8]=L*(q*De-Q*de)-j*(N*De-H*de)+pe*(N*Q-H*q),v[9]=-(T*(q*De-Q*de)-j*(S*De-R*de)+pe*(S*Q-R*q)),v[10]=T*(N*De-H*de)-L*(S*De-R*de)+pe*(S*H-R*N),v[11]=-(T*(N*Q-H*q)-L*(S*Q-R*q)+j*(S*H-R*N)),v[12]=-(L*(q*ue-Y*de)-j*(N*ue-$*de)+pe*(N*Y-$*q)),v[13]=T*(q*ue-Y*de)-j*(S*ue-M*de)+pe*(S*Y-M*q),v[14]=-(T*(N*ue-$*de)-L*(S*ue-M*de)+pe*(S*$-M*N)),v[15]=T*(N*Y-$*q)-L*(S*Y-M*q)+j*(S*$-M*N),v},et.determinant=function(v){var E=v[0],T=v[1],S=v[2],M=v[3],R=v[4],L=v[5],N=v[6],$=v[7],H=v[8],j=v[9],q=v[10],Y=v[11],Q=v[12],pe=v[13],de=v[14],ue=v[15];return(E*L-T*R)*(q*ue-Y*de)-(E*N-S*R)*(j*ue-Y*pe)+(E*$-M*R)*(j*de-q*pe)+(T*N-S*L)*(H*ue-Y*Q)-(T*$-M*L)*(H*de-q*Q)+(S*$-M*N)*(H*pe-j*Q)},et.multiply=p,et.translate=function(v,E,T){var S,M,R,L,N,$,H,j,q,Y,Q,pe,de=T[0],ue=T[1],De=T[2];return E===v?(v[12]=E[0]*de+E[4]*ue+E[8]*De+E[12],v[13]=E[1]*de+E[5]*ue+E[9]*De+E[13],v[14]=E[2]*de+E[6]*ue+E[10]*De+E[14],v[15]=E[3]*de+E[7]*ue+E[11]*De+E[15]):(M=E[1],R=E[2],L=E[3],N=E[4],$=E[5],H=E[6],j=E[7],q=E[8],Y=E[9],Q=E[10],pe=E[11],v[0]=S=E[0],v[1]=M,v[2]=R,v[3]=L,v[4]=N,v[5]=$,v[6]=H,v[7]=j,v[8]=q,v[9]=Y,v[10]=Q,v[11]=pe,v[12]=S*de+N*ue+q*De+E[12],v[13]=M*de+$*ue+Y*De+E[13],v[14]=R*de+H*ue+Q*De+E[14],v[15]=L*de+j*ue+pe*De+E[15]),v},et.scale=function(v,E,T){var S=T[0],M=T[1],R=T[2];return v[0]=E[0]*S,v[1]=E[1]*S,v[2]=E[2]*S,v[3]=E[3]*S,v[4]=E[4]*M,v[5]=E[5]*M,v[6]=E[6]*M,v[7]=E[7]*M,v[8]=E[8]*R,v[9]=E[9]*R,v[10]=E[10]*R,v[11]=E[11]*R,v[12]=E[12],v[13]=E[13],v[14]=E[14],v[15]=E[15],v},et.rotate=function(v,E,T,S){var M,R,L,N,$,H,j,q,Y,Q,pe,de,ue,De,fe,Me,Fe,Pe,ze,Ne,Ge,Ue,qe,gt,ft=S[0],Gt=S[1],wt=S[2],Rt=Math.hypot(ft,Gt,wt);return Rt<o.EPSILON?null:(ft*=Rt=1/Rt,Gt*=Rt,wt*=Rt,M=Math.sin(T),R=Math.cos(T),$=E[1],H=E[2],j=E[3],Y=E[5],Q=E[6],pe=E[7],ue=E[9],De=E[10],fe=E[11],Me=ft*ft*(L=1-R)+R,ze=ft*Gt*L-wt*M,Ne=Gt*Gt*L+R,Ge=wt*Gt*L+ft*M,Ue=ft*wt*L+Gt*M,qe=Gt*wt*L-ft*M,gt=wt*wt*L+R,v[0]=(N=E[0])*Me+(q=E[4])*(Fe=Gt*ft*L+wt*M)+(de=E[8])*(Pe=wt*ft*L-Gt*M),v[1]=$*Me+Y*Fe+ue*Pe,v[2]=H*Me+Q*Fe+De*Pe,v[3]=j*Me+pe*Fe+fe*Pe,v[4]=N*ze+q*Ne+de*Ge,v[5]=$*ze+Y*Ne+ue*Ge,v[6]=H*ze+Q*Ne+De*Ge,v[7]=j*ze+pe*Ne+fe*Ge,v[8]=N*Ue+q*qe+de*gt,v[9]=$*Ue+Y*qe+ue*gt,v[10]=H*Ue+Q*qe+De*gt,v[11]=j*Ue+pe*qe+fe*gt,E!==v&&(v[12]=E[12],v[13]=E[13],v[14]=E[14],v[15]=E[15]),v)},et.rotateX=function(v,E,T){var S=Math.sin(T),M=Math.cos(T),R=E[4],L=E[5],N=E[6],$=E[7],H=E[8],j=E[9],q=E[10],Y=E[11];return E!==v&&(v[0]=E[0],v[1]=E[1],v[2]=E[2],v[3]=E[3],v[12]=E[12],v[13]=E[13],v[14]=E[14],v[15]=E[15]),v[4]=R*M+H*S,v[5]=L*M+j*S,v[6]=N*M+q*S,v[7]=$*M+Y*S,v[8]=H*M-R*S,v[9]=j*M-L*S,v[10]=q*M-N*S,v[11]=Y*M-$*S,v},et.rotateY=function(v,E,T){var S=Math.sin(T),M=Math.cos(T),R=E[0],L=E[1],N=E[2],$=E[3],H=E[8],j=E[9],q=E[10],Y=E[11];return E!==v&&(v[4]=E[4],v[5]=E[5],v[6]=E[6],v[7]=E[7],v[12]=E[12],v[13]=E[13],v[14]=E[14],v[15]=E[15]),v[0]=R*M-H*S,v[1]=L*M-j*S,v[2]=N*M-q*S,v[3]=$*M-Y*S,v[8]=R*S+H*M,v[9]=L*S+j*M,v[10]=N*S+q*M,v[11]=$*S+Y*M,v},et.rotateZ=function(v,E,T){var S=Math.sin(T),M=Math.cos(T),R=E[0],L=E[1],N=E[2],$=E[3],H=E[4],j=E[5],q=E[6],Y=E[7];return E!==v&&(v[8]=E[8],v[9]=E[9],v[10]=E[10],v[11]=E[11],v[12]=E[12],v[13]=E[13],v[14]=E[14],v[15]=E[15]),v[0]=R*M+H*S,v[1]=L*M+j*S,v[2]=N*M+q*S,v[3]=$*M+Y*S,v[4]=H*M-R*S,v[5]=j*M-L*S,v[6]=q*M-N*S,v[7]=Y*M-$*S,v},et.fromTranslation=function(v,E){return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=E[0],v[13]=E[1],v[14]=E[2],v[15]=1,v},et.fromScaling=function(v,E){return v[0]=E[0],v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=E[1],v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=E[2],v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},et.fromRotation=function(v,E,T){var S,M,R,L=T[0],N=T[1],$=T[2],H=Math.hypot(L,N,$);return H<o.EPSILON?null:(L*=H=1/H,N*=H,$*=H,S=Math.sin(E),M=Math.cos(E),v[0]=L*L*(R=1-M)+M,v[1]=N*L*R+$*S,v[2]=$*L*R-N*S,v[3]=0,v[4]=L*N*R-$*S,v[5]=N*N*R+M,v[6]=$*N*R+L*S,v[7]=0,v[8]=L*$*R+N*S,v[9]=N*$*R-L*S,v[10]=$*$*R+M,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v)},et.fromXRotation=function(v,E){var T=Math.sin(E),S=Math.cos(E);return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=S,v[6]=T,v[7]=0,v[8]=0,v[9]=-T,v[10]=S,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},et.fromYRotation=function(v,E){var T=Math.sin(E),S=Math.cos(E);return v[0]=S,v[1]=0,v[2]=-T,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=T,v[9]=0,v[10]=S,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},et.fromZRotation=function(v,E){var T=Math.sin(E),S=Math.cos(E);return v[0]=S,v[1]=T,v[2]=0,v[3]=0,v[4]=-T,v[5]=S,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},et.fromRotationTranslation=h,et.fromQuat2=function(v,E){var T=new o.ARRAY_TYPE(3),S=-E[0],M=-E[1],R=-E[2],L=E[3],N=E[4],$=E[5],H=E[6],j=E[7],q=S*S+M*M+R*R+L*L;return q>0?(T[0]=2*(N*L+j*S+$*R-H*M)/q,T[1]=2*($*L+j*M+H*S-N*R)/q,T[2]=2*(H*L+j*R+N*M-$*S)/q):(T[0]=2*(N*L+j*S+$*R-H*M),T[1]=2*($*L+j*M+H*S-N*R),T[2]=2*(H*L+j*R+N*M-$*S)),h(v,E,T),v},et.getTranslation=function(v,E){return v[0]=E[12],v[1]=E[13],v[2]=E[14],v},et.getScaling=g,et.getRotation=function(v,E){var T=new o.ARRAY_TYPE(3);g(T,E);var S=1/T[0],M=1/T[1],R=1/T[2],L=E[0]*S,N=E[1]*M,$=E[2]*R,H=E[4]*S,j=E[5]*M,q=E[6]*R,Y=E[8]*S,Q=E[9]*M,pe=E[10]*R,de=L+j+pe,ue=0;return de>0?(ue=2*Math.sqrt(de+1),v[3]=.25*ue,v[0]=(q-Q)/ue,v[1]=(Y-$)/ue,v[2]=(N-H)/ue):L>j&&L>pe?(ue=2*Math.sqrt(1+L-j-pe),v[3]=(q-Q)/ue,v[0]=.25*ue,v[1]=(N+H)/ue,v[2]=(Y+$)/ue):j>pe?(ue=2*Math.sqrt(1+j-L-pe),v[3]=(Y-$)/ue,v[0]=(N+H)/ue,v[1]=.25*ue,v[2]=(q+Q)/ue):(ue=2*Math.sqrt(1+pe-L-j),v[3]=(N-H)/ue,v[0]=(Y+$)/ue,v[1]=(q+Q)/ue,v[2]=.25*ue),v},et.fromRotationTranslationScale=function(v,E,T,S){var M=E[0],R=E[1],L=E[2],N=E[3],$=M+M,H=R+R,j=L+L,q=M*$,Y=M*H,Q=M*j,pe=R*H,de=R*j,ue=L*j,De=N*$,fe=N*H,Me=N*j,Fe=S[0],Pe=S[1],ze=S[2];return v[0]=(1-(pe+ue))*Fe,v[1]=(Y+Me)*Fe,v[2]=(Q-fe)*Fe,v[3]=0,v[4]=(Y-Me)*Pe,v[5]=(1-(q+ue))*Pe,v[6]=(de+De)*Pe,v[7]=0,v[8]=(Q+fe)*ze,v[9]=(de-De)*ze,v[10]=(1-(q+pe))*ze,v[11]=0,v[12]=T[0],v[13]=T[1],v[14]=T[2],v[15]=1,v},et.fromRotationTranslationScaleOrigin=function(v,E,T,S,M){var R=E[0],L=E[1],N=E[2],$=E[3],H=R+R,j=L+L,q=N+N,Y=R*H,Q=R*j,pe=R*q,de=L*j,ue=L*q,De=N*q,fe=$*H,Me=$*j,Fe=$*q,Pe=S[0],ze=S[1],Ne=S[2],Ge=M[0],Ue=M[1],qe=M[2],gt=(1-(de+De))*Pe,ft=(Q+Fe)*Pe,Gt=(pe-Me)*Pe,wt=(Q-Fe)*ze,Rt=(1-(Y+De))*ze,yt=(ue+fe)*ze,mi=(pe+Me)*Ne,jt=(ue-fe)*Ne,Jt=(1-(Y+de))*Ne;return v[0]=gt,v[1]=ft,v[2]=Gt,v[3]=0,v[4]=wt,v[5]=Rt,v[6]=yt,v[7]=0,v[8]=mi,v[9]=jt,v[10]=Jt,v[11]=0,v[12]=T[0]+Ge-(gt*Ge+wt*Ue+mi*qe),v[13]=T[1]+Ue-(ft*Ge+Rt*Ue+jt*qe),v[14]=T[2]+qe-(Gt*Ge+yt*Ue+Jt*qe),v[15]=1,v},et.fromQuat=function(v,E){var T=E[0],S=E[1],M=E[2],R=E[3],L=T+T,N=S+S,$=M+M,H=T*L,j=S*L,q=S*N,Y=M*L,Q=M*N,pe=M*$,de=R*L,ue=R*N,De=R*$;return v[0]=1-q-pe,v[1]=j+De,v[2]=Y-ue,v[3]=0,v[4]=j-De,v[5]=1-H-pe,v[6]=Q+de,v[7]=0,v[8]=Y+ue,v[9]=Q-de,v[10]=1-H-q,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},et.frustum=function(v,E,T,S,M,R,L){var N=1/(T-E),$=1/(M-S),H=1/(R-L);return v[0]=2*R*N,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=2*R*$,v[6]=0,v[7]=0,v[8]=(T+E)*N,v[9]=(M+S)*$,v[10]=(L+R)*H,v[11]=-1,v[12]=0,v[13]=0,v[14]=L*R*2*H,v[15]=0,v},et.perspectiveNO=x,et.perspectiveZO=function(v,E,T,S,M){var R,L=1/Math.tan(E/2);return v[0]=L/T,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=L,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[11]=-1,v[12]=0,v[13]=0,v[15]=0,M!=null&&M!==1/0?(v[10]=M*(R=1/(S-M)),v[14]=M*S*R):(v[10]=-1,v[14]=-S),v},et.perspectiveFromFieldOfView=function(v,E,T,S){var M=Math.tan(E.upDegrees*Math.PI/180),R=Math.tan(E.downDegrees*Math.PI/180),L=Math.tan(E.leftDegrees*Math.PI/180),N=Math.tan(E.rightDegrees*Math.PI/180),$=2/(L+N),H=2/(M+R);return v[0]=$,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=H,v[6]=0,v[7]=0,v[8]=-(L-N)*$*.5,v[9]=(M-R)*H*.5,v[10]=S/(T-S),v[11]=-1,v[12]=0,v[13]=0,v[14]=S*T/(T-S),v[15]=0,v},et.orthoNO=C,et.orthoZO=function(v,E,T,S,M,R,L){var N=1/(E-T),$=1/(S-M),H=1/(R-L);return v[0]=-2*N,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=-2*$,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=H,v[11]=0,v[12]=(E+T)*N,v[13]=(M+S)*$,v[14]=R*H,v[15]=1,v},et.lookAt=function(v,E,T,S){var M,R,L,N,$,H,j,q,Y,Q,pe=E[0],de=E[1],ue=E[2],De=S[0],fe=S[1],Me=S[2],Fe=T[0],Pe=T[1],ze=T[2];return Math.abs(pe-Fe)<o.EPSILON&&Math.abs(de-Pe)<o.EPSILON&&Math.abs(ue-ze)<o.EPSILON?u(v):(j=pe-Fe,q=de-Pe,Y=ue-ze,M=fe*(Y*=Q=1/Math.hypot(j,q,Y))-Me*(q*=Q),R=Me*(j*=Q)-De*Y,L=De*q-fe*j,(Q=Math.hypot(M,R,L))?(M*=Q=1/Q,R*=Q,L*=Q):(M=0,R=0,L=0),N=q*L-Y*R,$=Y*M-j*L,H=j*R-q*M,(Q=Math.hypot(N,$,H))?(N*=Q=1/Q,$*=Q,H*=Q):(N=0,$=0,H=0),v[0]=M,v[1]=N,v[2]=j,v[3]=0,v[4]=R,v[5]=$,v[6]=q,v[7]=0,v[8]=L,v[9]=H,v[10]=Y,v[11]=0,v[12]=-(M*pe+R*de+L*ue),v[13]=-(N*pe+$*de+H*ue),v[14]=-(j*pe+q*de+Y*ue),v[15]=1,v)},et.targetTo=function(v,E,T,S){var M=E[0],R=E[1],L=E[2],N=S[0],$=S[1],H=S[2],j=M-T[0],q=R-T[1],Y=L-T[2],Q=j*j+q*q+Y*Y;Q>0&&(j*=Q=1/Math.sqrt(Q),q*=Q,Y*=Q);var pe=$*Y-H*q,de=H*j-N*Y,ue=N*q-$*j;return(Q=pe*pe+de*de+ue*ue)>0&&(pe*=Q=1/Math.sqrt(Q),de*=Q,ue*=Q),v[0]=pe,v[1]=de,v[2]=ue,v[3]=0,v[4]=q*ue-Y*de,v[5]=Y*pe-j*ue,v[6]=j*de-q*pe,v[7]=0,v[8]=j,v[9]=q,v[10]=Y,v[11]=0,v[12]=M,v[13]=R,v[14]=L,v[15]=1,v},et.str=function(v){return"mat4("+v[0]+", "+v[1]+", "+v[2]+", "+v[3]+", "+v[4]+", "+v[5]+", "+v[6]+", "+v[7]+", "+v[8]+", "+v[9]+", "+v[10]+", "+v[11]+", "+v[12]+", "+v[13]+", "+v[14]+", "+v[15]+")"},et.frob=function(v){return Math.hypot(v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],v[8],v[9],v[10],v[11],v[12],v[13],v[14],v[15])},et.add=function(v,E,T){return v[0]=E[0]+T[0],v[1]=E[1]+T[1],v[2]=E[2]+T[2],v[3]=E[3]+T[3],v[4]=E[4]+T[4],v[5]=E[5]+T[5],v[6]=E[6]+T[6],v[7]=E[7]+T[7],v[8]=E[8]+T[8],v[9]=E[9]+T[9],v[10]=E[10]+T[10],v[11]=E[11]+T[11],v[12]=E[12]+T[12],v[13]=E[13]+T[13],v[14]=E[14]+T[14],v[15]=E[15]+T[15],v},et.subtract=D,et.multiplyScalar=function(v,E,T){return v[0]=E[0]*T,v[1]=E[1]*T,v[2]=E[2]*T,v[3]=E[3]*T,v[4]=E[4]*T,v[5]=E[5]*T,v[6]=E[6]*T,v[7]=E[7]*T,v[8]=E[8]*T,v[9]=E[9]*T,v[10]=E[10]*T,v[11]=E[11]*T,v[12]=E[12]*T,v[13]=E[13]*T,v[14]=E[14]*T,v[15]=E[15]*T,v},et.multiplyScalarAndAdd=function(v,E,T,S){return v[0]=E[0]+T[0]*S,v[1]=E[1]+T[1]*S,v[2]=E[2]+T[2]*S,v[3]=E[3]+T[3]*S,v[4]=E[4]+T[4]*S,v[5]=E[5]+T[5]*S,v[6]=E[6]+T[6]*S,v[7]=E[7]+T[7]*S,v[8]=E[8]+T[8]*S,v[9]=E[9]+T[9]*S,v[10]=E[10]+T[10]*S,v[11]=E[11]+T[11]*S,v[12]=E[12]+T[12]*S,v[13]=E[13]+T[13]*S,v[14]=E[14]+T[14]*S,v[15]=E[15]+T[15]*S,v},et.exactEquals=function(v,E){return v[0]===E[0]&&v[1]===E[1]&&v[2]===E[2]&&v[3]===E[3]&&v[4]===E[4]&&v[5]===E[5]&&v[6]===E[6]&&v[7]===E[7]&&v[8]===E[8]&&v[9]===E[9]&&v[10]===E[10]&&v[11]===E[11]&&v[12]===E[12]&&v[13]===E[13]&&v[14]===E[14]&&v[15]===E[15]},et.equals=function(v,E){var T=v[0],S=v[1],M=v[2],R=v[3],L=v[4],N=v[5],$=v[6],H=v[7],j=v[8],q=v[9],Y=v[10],Q=v[11],pe=v[12],de=v[13],ue=v[14],De=v[15],fe=E[0],Me=E[1],Fe=E[2],Pe=E[3],ze=E[4],Ne=E[5],Ge=E[6],Ue=E[7],qe=E[8],gt=E[9],ft=E[10],Gt=E[11],wt=E[12],Rt=E[13],yt=E[14],mi=E[15];return Math.abs(T-fe)<=o.EPSILON*Math.max(1,Math.abs(T),Math.abs(fe))&&Math.abs(S-Me)<=o.EPSILON*Math.max(1,Math.abs(S),Math.abs(Me))&&Math.abs(M-Fe)<=o.EPSILON*Math.max(1,Math.abs(M),Math.abs(Fe))&&Math.abs(R-Pe)<=o.EPSILON*Math.max(1,Math.abs(R),Math.abs(Pe))&&Math.abs(L-ze)<=o.EPSILON*Math.max(1,Math.abs(L),Math.abs(ze))&&Math.abs(N-Ne)<=o.EPSILON*Math.max(1,Math.abs(N),Math.abs(Ne))&&Math.abs($-Ge)<=o.EPSILON*Math.max(1,Math.abs($),Math.abs(Ge))&&Math.abs(H-Ue)<=o.EPSILON*Math.max(1,Math.abs(H),Math.abs(Ue))&&Math.abs(j-qe)<=o.EPSILON*Math.max(1,Math.abs(j),Math.abs(qe))&&Math.abs(q-gt)<=o.EPSILON*Math.max(1,Math.abs(q),Math.abs(gt))&&Math.abs(Y-ft)<=o.EPSILON*Math.max(1,Math.abs(Y),Math.abs(ft))&&Math.abs(Q-Gt)<=o.EPSILON*Math.max(1,Math.abs(Q),Math.abs(Gt))&&Math.abs(pe-wt)<=o.EPSILON*Math.max(1,Math.abs(pe),Math.abs(wt))&&Math.abs(de-Rt)<=o.EPSILON*Math.max(1,Math.abs(de),Math.abs(Rt))&&Math.abs(ue-yt)<=o.EPSILON*Math.max(1,Math.abs(ue),Math.abs(yt))&&Math.abs(De-mi)<=o.EPSILON*Math.max(1,Math.abs(De),Math.abs(mi))},et.sub=et.mul=et.ortho=et.perspective=void 0;var o=function(v,E){if(v&&v.__esModule)return v;if(v===null||d(v)!=="object"&&typeof v!="function")return{default:v};var T=l(void 0);if(T&&T.has(v))return T.get(v);var S={},M=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in v)if(R!=="default"&&Object.prototype.hasOwnProperty.call(v,R)){var L=M?Object.getOwnPropertyDescriptor(v,R):null;L&&(L.get||L.set)?Object.defineProperty(S,R,L):S[R]=v[R]}return S.default=v,T&&T.set(v,S),S}(U());function l(v){if(typeof WeakMap!="function")return null;var E=new WeakMap,T=new WeakMap;return(l=function(S){return S?T:E})(v)}function u(v){return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}function p(v,E,T){var S=E[0],M=E[1],R=E[2],L=E[3],N=E[4],$=E[5],H=E[6],j=E[7],q=E[8],Y=E[9],Q=E[10],pe=E[11],de=E[12],ue=E[13],De=E[14],fe=E[15],Me=T[0],Fe=T[1],Pe=T[2],ze=T[3];return v[0]=Me*S+Fe*N+Pe*q+ze*de,v[1]=Me*M+Fe*$+Pe*Y+ze*ue,v[2]=Me*R+Fe*H+Pe*Q+ze*De,v[3]=Me*L+Fe*j+Pe*pe+ze*fe,v[4]=(Me=T[4])*S+(Fe=T[5])*N+(Pe=T[6])*q+(ze=T[7])*de,v[5]=Me*M+Fe*$+Pe*Y+ze*ue,v[6]=Me*R+Fe*H+Pe*Q+ze*De,v[7]=Me*L+Fe*j+Pe*pe+ze*fe,v[8]=(Me=T[8])*S+(Fe=T[9])*N+(Pe=T[10])*q+(ze=T[11])*de,v[9]=Me*M+Fe*$+Pe*Y+ze*ue,v[10]=Me*R+Fe*H+Pe*Q+ze*De,v[11]=Me*L+Fe*j+Pe*pe+ze*fe,v[12]=(Me=T[12])*S+(Fe=T[13])*N+(Pe=T[14])*q+(ze=T[15])*de,v[13]=Me*M+Fe*$+Pe*Y+ze*ue,v[14]=Me*R+Fe*H+Pe*Q+ze*De,v[15]=Me*L+Fe*j+Pe*pe+ze*fe,v}function h(v,E,T){var S=E[0],M=E[1],R=E[2],L=E[3],N=S+S,$=M+M,H=R+R,j=S*N,q=S*$,Y=S*H,Q=M*$,pe=M*H,de=R*H,ue=L*N,De=L*$,fe=L*H;return v[0]=1-(Q+de),v[1]=q+fe,v[2]=Y-De,v[3]=0,v[4]=q-fe,v[5]=1-(j+de),v[6]=pe+ue,v[7]=0,v[8]=Y+De,v[9]=pe-ue,v[10]=1-(j+Q),v[11]=0,v[12]=T[0],v[13]=T[1],v[14]=T[2],v[15]=1,v}function g(v,E){var T=E[4],S=E[5],M=E[6],R=E[8],L=E[9],N=E[10];return v[0]=Math.hypot(E[0],E[1],E[2]),v[1]=Math.hypot(T,S,M),v[2]=Math.hypot(R,L,N),v}function x(v,E,T,S,M){var R,L=1/Math.tan(E/2);return v[0]=L/T,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=L,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[11]=-1,v[12]=0,v[13]=0,v[15]=0,M!=null&&M!==1/0?(v[10]=(M+S)*(R=1/(S-M)),v[14]=2*M*S*R):(v[10]=-1,v[14]=-2*S),v}function C(v,E,T,S,M,R,L){var N=1/(E-T),$=1/(S-M),H=1/(R-L);return v[0]=-2*N,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=-2*$,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=2*H,v[11]=0,v[12]=(E+T)*N,v[13]=(M+S)*$,v[14]=(L+R)*H,v[15]=1,v}function D(v,E,T){return v[0]=E[0]-T[0],v[1]=E[1]-T[1],v[2]=E[2]-T[2],v[3]=E[3]-T[3],v[4]=E[4]-T[4],v[5]=E[5]-T[5],v[6]=E[6]-T[6],v[7]=E[7]-T[7],v[8]=E[8]-T[8],v[9]=E[9]-T[9],v[10]=E[10]-T[10],v[11]=E[11]-T[11],v[12]=E[12]-T[12],v[13]=E[13]-T[13],v[14]=E[14]-T[14],v[15]=E[15]-T[15],v}return et.perspective=x,et.ortho=C,et.mul=p,et.sub=D,et}var Lt,lt={},Ye={};function xt(){if(Lt)return Ye;function d(M){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},d(M)}Lt=1,Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.create=u,Ye.clone=function(M){var R=new o.ARRAY_TYPE(3);return R[0]=M[0],R[1]=M[1],R[2]=M[2],R},Ye.length=p,Ye.fromValues=function(M,R,L){var N=new o.ARRAY_TYPE(3);return N[0]=M,N[1]=R,N[2]=L,N},Ye.copy=function(M,R){return M[0]=R[0],M[1]=R[1],M[2]=R[2],M},Ye.set=function(M,R,L,N){return M[0]=R,M[1]=L,M[2]=N,M},Ye.add=function(M,R,L){return M[0]=R[0]+L[0],M[1]=R[1]+L[1],M[2]=R[2]+L[2],M},Ye.subtract=h,Ye.multiply=g,Ye.divide=x,Ye.ceil=function(M,R){return M[0]=Math.ceil(R[0]),M[1]=Math.ceil(R[1]),M[2]=Math.ceil(R[2]),M},Ye.floor=function(M,R){return M[0]=Math.floor(R[0]),M[1]=Math.floor(R[1]),M[2]=Math.floor(R[2]),M},Ye.min=function(M,R,L){return M[0]=Math.min(R[0],L[0]),M[1]=Math.min(R[1],L[1]),M[2]=Math.min(R[2],L[2]),M},Ye.max=function(M,R,L){return M[0]=Math.max(R[0],L[0]),M[1]=Math.max(R[1],L[1]),M[2]=Math.max(R[2],L[2]),M},Ye.round=function(M,R){return M[0]=Math.round(R[0]),M[1]=Math.round(R[1]),M[2]=Math.round(R[2]),M},Ye.scale=function(M,R,L){return M[0]=R[0]*L,M[1]=R[1]*L,M[2]=R[2]*L,M},Ye.scaleAndAdd=function(M,R,L,N){return M[0]=R[0]+L[0]*N,M[1]=R[1]+L[1]*N,M[2]=R[2]+L[2]*N,M},Ye.distance=C,Ye.squaredDistance=D,Ye.squaredLength=v,Ye.negate=function(M,R){return M[0]=-R[0],M[1]=-R[1],M[2]=-R[2],M},Ye.inverse=function(M,R){return M[0]=1/R[0],M[1]=1/R[1],M[2]=1/R[2],M},Ye.normalize=function(M,R){var L=R[0],N=R[1],$=R[2],H=L*L+N*N+$*$;return H>0&&(H=1/Math.sqrt(H)),M[0]=R[0]*H,M[1]=R[1]*H,M[2]=R[2]*H,M},Ye.dot=E,Ye.cross=function(M,R,L){var N=R[0],$=R[1],H=R[2],j=L[0],q=L[1],Y=L[2];return M[0]=$*Y-H*q,M[1]=H*j-N*Y,M[2]=N*q-$*j,M},Ye.lerp=function(M,R,L,N){var $=R[0],H=R[1],j=R[2];return M[0]=$+N*(L[0]-$),M[1]=H+N*(L[1]-H),M[2]=j+N*(L[2]-j),M},Ye.hermite=function(M,R,L,N,$,H){var j=H*H,q=j*(2*H-3)+1,Y=j*(H-2)+H,Q=j*(H-1),pe=j*(3-2*H);return M[0]=R[0]*q+L[0]*Y+N[0]*Q+$[0]*pe,M[1]=R[1]*q+L[1]*Y+N[1]*Q+$[1]*pe,M[2]=R[2]*q+L[2]*Y+N[2]*Q+$[2]*pe,M},Ye.bezier=function(M,R,L,N,$,H){var j=1-H,q=j*j,Y=H*H,Q=q*j,pe=3*H*q,de=3*Y*j,ue=Y*H;return M[0]=R[0]*Q+L[0]*pe+N[0]*de+$[0]*ue,M[1]=R[1]*Q+L[1]*pe+N[1]*de+$[1]*ue,M[2]=R[2]*Q+L[2]*pe+N[2]*de+$[2]*ue,M},Ye.random=function(M,R){R=R||1;var L=2*o.RANDOM()*Math.PI,N=2*o.RANDOM()-1,$=Math.sqrt(1-N*N)*R;return M[0]=Math.cos(L)*$,M[1]=Math.sin(L)*$,M[2]=N*R,M},Ye.transformMat4=function(M,R,L){var N=R[0],$=R[1],H=R[2],j=L[3]*N+L[7]*$+L[11]*H+L[15];return M[0]=(L[0]*N+L[4]*$+L[8]*H+L[12])/(j=j||1),M[1]=(L[1]*N+L[5]*$+L[9]*H+L[13])/j,M[2]=(L[2]*N+L[6]*$+L[10]*H+L[14])/j,M},Ye.transformMat3=function(M,R,L){var N=R[0],$=R[1],H=R[2];return M[0]=N*L[0]+$*L[3]+H*L[6],M[1]=N*L[1]+$*L[4]+H*L[7],M[2]=N*L[2]+$*L[5]+H*L[8],M},Ye.transformQuat=function(M,R,L){var N=L[0],$=L[1],H=L[2],j=R[0],q=R[1],Y=R[2],Q=$*Y-H*q,pe=H*j-N*Y,de=N*q-$*j,ue=$*de-H*pe,De=H*Q-N*de,fe=N*pe-$*Q,Me=2*L[3];return pe*=Me,de*=Me,De*=2,fe*=2,M[0]=j+(Q*=Me)+(ue*=2),M[1]=q+pe+De,M[2]=Y+de+fe,M},Ye.rotateX=function(M,R,L,N){var $=[],H=[];return $[0]=R[0]-L[0],$[1]=R[1]-L[1],$[2]=R[2]-L[2],H[0]=$[0],H[1]=$[1]*Math.cos(N)-$[2]*Math.sin(N),H[2]=$[1]*Math.sin(N)+$[2]*Math.cos(N),M[0]=H[0]+L[0],M[1]=H[1]+L[1],M[2]=H[2]+L[2],M},Ye.rotateY=function(M,R,L,N){var $=[],H=[];return $[0]=R[0]-L[0],$[1]=R[1]-L[1],$[2]=R[2]-L[2],H[0]=$[2]*Math.sin(N)+$[0]*Math.cos(N),H[1]=$[1],H[2]=$[2]*Math.cos(N)-$[0]*Math.sin(N),M[0]=H[0]+L[0],M[1]=H[1]+L[1],M[2]=H[2]+L[2],M},Ye.rotateZ=function(M,R,L,N){var $=[],H=[];return $[0]=R[0]-L[0],$[1]=R[1]-L[1],$[2]=R[2]-L[2],H[0]=$[0]*Math.cos(N)-$[1]*Math.sin(N),H[1]=$[0]*Math.sin(N)+$[1]*Math.cos(N),H[2]=$[2],M[0]=H[0]+L[0],M[1]=H[1]+L[1],M[2]=H[2]+L[2],M},Ye.angle=function(M,R){var L=M[0],N=M[1],$=M[2],H=R[0],j=R[1],q=R[2],Y=Math.sqrt(L*L+N*N+$*$)*Math.sqrt(H*H+j*j+q*q),Q=Y&&E(M,R)/Y;return Math.acos(Math.min(Math.max(Q,-1),1))},Ye.zero=function(M){return M[0]=0,M[1]=0,M[2]=0,M},Ye.str=function(M){return"vec3("+M[0]+", "+M[1]+", "+M[2]+")"},Ye.exactEquals=function(M,R){return M[0]===R[0]&&M[1]===R[1]&&M[2]===R[2]},Ye.equals=function(M,R){var L=M[0],N=M[1],$=M[2],H=R[0],j=R[1],q=R[2];return Math.abs(L-H)<=o.EPSILON*Math.max(1,Math.abs(L),Math.abs(H))&&Math.abs(N-j)<=o.EPSILON*Math.max(1,Math.abs(N),Math.abs(j))&&Math.abs($-q)<=o.EPSILON*Math.max(1,Math.abs($),Math.abs(q))},Ye.forEach=Ye.sqrLen=Ye.len=Ye.sqrDist=Ye.dist=Ye.div=Ye.mul=Ye.sub=void 0;var o=function(M,R){if(M&&M.__esModule)return M;if(M===null||d(M)!=="object"&&typeof M!="function")return{default:M};var L=l(void 0);if(L&&L.has(M))return L.get(M);var N={},$=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var H in M)if(H!=="default"&&Object.prototype.hasOwnProperty.call(M,H)){var j=$?Object.getOwnPropertyDescriptor(M,H):null;j&&(j.get||j.set)?Object.defineProperty(N,H,j):N[H]=M[H]}return N.default=M,L&&L.set(M,N),N}(U());function l(M){if(typeof WeakMap!="function")return null;var R=new WeakMap,L=new WeakMap;return(l=function(N){return N?L:R})(M)}function u(){var M=new o.ARRAY_TYPE(3);return o.ARRAY_TYPE!=Float32Array&&(M[0]=0,M[1]=0,M[2]=0),M}function p(M){return Math.hypot(M[0],M[1],M[2])}function h(M,R,L){return M[0]=R[0]-L[0],M[1]=R[1]-L[1],M[2]=R[2]-L[2],M}function g(M,R,L){return M[0]=R[0]*L[0],M[1]=R[1]*L[1],M[2]=R[2]*L[2],M}function x(M,R,L){return M[0]=R[0]/L[0],M[1]=R[1]/L[1],M[2]=R[2]/L[2],M}function C(M,R){return Math.hypot(R[0]-M[0],R[1]-M[1],R[2]-M[2])}function D(M,R){var L=R[0]-M[0],N=R[1]-M[1],$=R[2]-M[2];return L*L+N*N+$*$}function v(M){var R=M[0],L=M[1],N=M[2];return R*R+L*L+N*N}function E(M,R){return M[0]*R[0]+M[1]*R[1]+M[2]*R[2]}Ye.sub=h,Ye.mul=g,Ye.div=x,Ye.dist=C,Ye.sqrDist=D,Ye.len=p,Ye.sqrLen=v;var T,S=(T=u(),function(M,R,L,N,$,H){var j,q;for(R||(R=3),L||(L=0),q=N?Math.min(N*R+L,M.length):M.length,j=L;j<q;j+=R)T[0]=M[j],T[1]=M[j+1],T[2]=M[j+2],$(T,T,H),M[j]=T[0],M[j+1]=T[1],M[j+2]=T[2];return M});return Ye.forEach=S,Ye}var Bt,Ft,dt={};function Ot(){if(Bt)return dt;function d(S){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},d(S)}Bt=1,Object.defineProperty(dt,"__esModule",{value:!0}),dt.create=u,dt.clone=function(S){var M=new o.ARRAY_TYPE(4);return M[0]=S[0],M[1]=S[1],M[2]=S[2],M[3]=S[3],M},dt.fromValues=function(S,M,R,L){var N=new o.ARRAY_TYPE(4);return N[0]=S,N[1]=M,N[2]=R,N[3]=L,N},dt.copy=function(S,M){return S[0]=M[0],S[1]=M[1],S[2]=M[2],S[3]=M[3],S},dt.set=function(S,M,R,L,N){return S[0]=M,S[1]=R,S[2]=L,S[3]=N,S},dt.add=function(S,M,R){return S[0]=M[0]+R[0],S[1]=M[1]+R[1],S[2]=M[2]+R[2],S[3]=M[3]+R[3],S},dt.subtract=p,dt.multiply=h,dt.divide=g,dt.ceil=function(S,M){return S[0]=Math.ceil(M[0]),S[1]=Math.ceil(M[1]),S[2]=Math.ceil(M[2]),S[3]=Math.ceil(M[3]),S},dt.floor=function(S,M){return S[0]=Math.floor(M[0]),S[1]=Math.floor(M[1]),S[2]=Math.floor(M[2]),S[3]=Math.floor(M[3]),S},dt.min=function(S,M,R){return S[0]=Math.min(M[0],R[0]),S[1]=Math.min(M[1],R[1]),S[2]=Math.min(M[2],R[2]),S[3]=Math.min(M[3],R[3]),S},dt.max=function(S,M,R){return S[0]=Math.max(M[0],R[0]),S[1]=Math.max(M[1],R[1]),S[2]=Math.max(M[2],R[2]),S[3]=Math.max(M[3],R[3]),S},dt.round=function(S,M){return S[0]=Math.round(M[0]),S[1]=Math.round(M[1]),S[2]=Math.round(M[2]),S[3]=Math.round(M[3]),S},dt.scale=function(S,M,R){return S[0]=M[0]*R,S[1]=M[1]*R,S[2]=M[2]*R,S[3]=M[3]*R,S},dt.scaleAndAdd=function(S,M,R,L){return S[0]=M[0]+R[0]*L,S[1]=M[1]+R[1]*L,S[2]=M[2]+R[2]*L,S[3]=M[3]+R[3]*L,S},dt.distance=x,dt.squaredDistance=C,dt.length=D,dt.squaredLength=v,dt.negate=function(S,M){return S[0]=-M[0],S[1]=-M[1],S[2]=-M[2],S[3]=-M[3],S},dt.inverse=function(S,M){return S[0]=1/M[0],S[1]=1/M[1],S[2]=1/M[2],S[3]=1/M[3],S},dt.normalize=function(S,M){var R=M[0],L=M[1],N=M[2],$=M[3],H=R*R+L*L+N*N+$*$;return H>0&&(H=1/Math.sqrt(H)),S[0]=R*H,S[1]=L*H,S[2]=N*H,S[3]=$*H,S},dt.dot=function(S,M){return S[0]*M[0]+S[1]*M[1]+S[2]*M[2]+S[3]*M[3]},dt.cross=function(S,M,R,L){var N=R[0]*L[1]-R[1]*L[0],$=R[0]*L[2]-R[2]*L[0],H=R[0]*L[3]-R[3]*L[0],j=R[1]*L[2]-R[2]*L[1],q=R[1]*L[3]-R[3]*L[1],Y=R[2]*L[3]-R[3]*L[2],Q=M[0],pe=M[1],de=M[2],ue=M[3];return S[0]=pe*Y-de*q+ue*j,S[1]=-Q*Y+de*H-ue*$,S[2]=Q*q-pe*H+ue*N,S[3]=-Q*j+pe*$-de*N,S},dt.lerp=function(S,M,R,L){var N=M[0],$=M[1],H=M[2],j=M[3];return S[0]=N+L*(R[0]-N),S[1]=$+L*(R[1]-$),S[2]=H+L*(R[2]-H),S[3]=j+L*(R[3]-j),S},dt.random=function(S,M){var R,L,N,$,H,j;M=M||1;do H=(R=2*o.RANDOM()-1)*R+(L=2*o.RANDOM()-1)*L;while(H>=1);do j=(N=2*o.RANDOM()-1)*N+($=2*o.RANDOM()-1)*$;while(j>=1);var q=Math.sqrt((1-H)/j);return S[0]=M*R,S[1]=M*L,S[2]=M*N*q,S[3]=M*$*q,S},dt.transformMat4=function(S,M,R){var L=M[0],N=M[1],$=M[2],H=M[3];return S[0]=R[0]*L+R[4]*N+R[8]*$+R[12]*H,S[1]=R[1]*L+R[5]*N+R[9]*$+R[13]*H,S[2]=R[2]*L+R[6]*N+R[10]*$+R[14]*H,S[3]=R[3]*L+R[7]*N+R[11]*$+R[15]*H,S},dt.transformQuat=function(S,M,R){var L=M[0],N=M[1],$=M[2],H=R[0],j=R[1],q=R[2],Y=R[3],Q=Y*L+j*$-q*N,pe=Y*N+q*L-H*$,de=Y*$+H*N-j*L,ue=-H*L-j*N-q*$;return S[0]=Q*Y+ue*-H+pe*-q-de*-j,S[1]=pe*Y+ue*-j+de*-H-Q*-q,S[2]=de*Y+ue*-q+Q*-j-pe*-H,S[3]=M[3],S},dt.zero=function(S){return S[0]=0,S[1]=0,S[2]=0,S[3]=0,S},dt.str=function(S){return"vec4("+S[0]+", "+S[1]+", "+S[2]+", "+S[3]+")"},dt.exactEquals=function(S,M){return S[0]===M[0]&&S[1]===M[1]&&S[2]===M[2]&&S[3]===M[3]},dt.equals=function(S,M){var R=S[0],L=S[1],N=S[2],$=S[3],H=M[0],j=M[1],q=M[2],Y=M[3];return Math.abs(R-H)<=o.EPSILON*Math.max(1,Math.abs(R),Math.abs(H))&&Math.abs(L-j)<=o.EPSILON*Math.max(1,Math.abs(L),Math.abs(j))&&Math.abs(N-q)<=o.EPSILON*Math.max(1,Math.abs(N),Math.abs(q))&&Math.abs($-Y)<=o.EPSILON*Math.max(1,Math.abs($),Math.abs(Y))},dt.forEach=dt.sqrLen=dt.len=dt.sqrDist=dt.dist=dt.div=dt.mul=dt.sub=void 0;var o=function(S,M){if(S&&S.__esModule)return S;if(S===null||d(S)!=="object"&&typeof S!="function")return{default:S};var R=l(void 0);if(R&&R.has(S))return R.get(S);var L={},N=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in S)if($!=="default"&&Object.prototype.hasOwnProperty.call(S,$)){var H=N?Object.getOwnPropertyDescriptor(S,$):null;H&&(H.get||H.set)?Object.defineProperty(L,$,H):L[$]=S[$]}return L.default=S,R&&R.set(S,L),L}(U());function l(S){if(typeof WeakMap!="function")return null;var M=new WeakMap,R=new WeakMap;return(l=function(L){return L?R:M})(S)}function u(){var S=new o.ARRAY_TYPE(4);return o.ARRAY_TYPE!=Float32Array&&(S[0]=0,S[1]=0,S[2]=0,S[3]=0),S}function p(S,M,R){return S[0]=M[0]-R[0],S[1]=M[1]-R[1],S[2]=M[2]-R[2],S[3]=M[3]-R[3],S}function h(S,M,R){return S[0]=M[0]*R[0],S[1]=M[1]*R[1],S[2]=M[2]*R[2],S[3]=M[3]*R[3],S}function g(S,M,R){return S[0]=M[0]/R[0],S[1]=M[1]/R[1],S[2]=M[2]/R[2],S[3]=M[3]/R[3],S}function x(S,M){return Math.hypot(M[0]-S[0],M[1]-S[1],M[2]-S[2],M[3]-S[3])}function C(S,M){var R=M[0]-S[0],L=M[1]-S[1],N=M[2]-S[2],$=M[3]-S[3];return R*R+L*L+N*N+$*$}function D(S){return Math.hypot(S[0],S[1],S[2],S[3])}function v(S){var M=S[0],R=S[1],L=S[2],N=S[3];return M*M+R*R+L*L+N*N}dt.sub=p,dt.mul=h,dt.div=g,dt.dist=x,dt.sqrDist=C,dt.len=D,dt.sqrLen=v;var E,T=(E=u(),function(S,M,R,L,N,$){var H,j;for(M||(M=4),R||(R=0),j=L?Math.min(L*M+R,S.length):S.length,H=R;H<j;H+=M)E[0]=S[H],E[1]=S[H+1],E[2]=S[H+2],E[3]=S[H+3],N(E,E,$),S[H]=E[0],S[H+1]=E[1],S[H+2]=E[2],S[H+3]=E[3];return S});return dt.forEach=T,dt}function Kt(){if(Ft)return lt;function d(fe){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Me){return typeof Me}:function(Me){return Me&&typeof Symbol=="function"&&Me.constructor===Symbol&&Me!==Symbol.prototype?"symbol":typeof Me},d(fe)}Ft=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.create=x,lt.identity=function(fe){return fe[0]=0,fe[1]=0,fe[2]=0,fe[3]=1,fe},lt.setAxisAngle=C,lt.getAxisAngle=function(fe,Me){var Fe=2*Math.acos(Me[3]),Pe=Math.sin(Fe/2);return Pe>o.EPSILON?(fe[0]=Me[0]/Pe,fe[1]=Me[1]/Pe,fe[2]=Me[2]/Pe):(fe[0]=1,fe[1]=0,fe[2]=0),Fe},lt.getAngle=function(fe,Me){var Fe=R(fe,Me);return Math.acos(2*Fe*Fe-1)},lt.multiply=D,lt.rotateX=function(fe,Me,Fe){Fe*=.5;var Pe=Me[0],ze=Me[1],Ne=Me[2],Ge=Me[3],Ue=Math.sin(Fe),qe=Math.cos(Fe);return fe[0]=Pe*qe+Ge*Ue,fe[1]=ze*qe+Ne*Ue,fe[2]=Ne*qe-ze*Ue,fe[3]=Ge*qe-Pe*Ue,fe},lt.rotateY=function(fe,Me,Fe){Fe*=.5;var Pe=Me[0],ze=Me[1],Ne=Me[2],Ge=Me[3],Ue=Math.sin(Fe),qe=Math.cos(Fe);return fe[0]=Pe*qe-Ne*Ue,fe[1]=ze*qe+Ge*Ue,fe[2]=Ne*qe+Pe*Ue,fe[3]=Ge*qe-ze*Ue,fe},lt.rotateZ=function(fe,Me,Fe){Fe*=.5;var Pe=Me[0],ze=Me[1],Ne=Me[2],Ge=Me[3],Ue=Math.sin(Fe),qe=Math.cos(Fe);return fe[0]=Pe*qe+ze*Ue,fe[1]=ze*qe-Pe*Ue,fe[2]=Ne*qe+Ge*Ue,fe[3]=Ge*qe-Ne*Ue,fe},lt.calculateW=function(fe,Me){var Fe=Me[0],Pe=Me[1],ze=Me[2];return fe[0]=Fe,fe[1]=Pe,fe[2]=ze,fe[3]=Math.sqrt(Math.abs(1-Fe*Fe-Pe*Pe-ze*ze)),fe},lt.exp=v,lt.ln=E,lt.pow=function(fe,Me,Fe){return E(fe,Me),M(fe,fe,Fe),v(fe,fe),fe},lt.slerp=T,lt.random=function(fe){var Me=o.RANDOM(),Fe=o.RANDOM(),Pe=o.RANDOM(),ze=Math.sqrt(1-Me),Ne=Math.sqrt(Me);return fe[0]=ze*Math.sin(2*Math.PI*Fe),fe[1]=ze*Math.cos(2*Math.PI*Fe),fe[2]=Ne*Math.sin(2*Math.PI*Pe),fe[3]=Ne*Math.cos(2*Math.PI*Pe),fe},lt.invert=function(fe,Me){var Fe=Me[0],Pe=Me[1],ze=Me[2],Ne=Me[3],Ge=Fe*Fe+Pe*Pe+ze*ze+Ne*Ne,Ue=Ge?1/Ge:0;return fe[0]=-Fe*Ue,fe[1]=-Pe*Ue,fe[2]=-ze*Ue,fe[3]=Ne*Ue,fe},lt.conjugate=function(fe,Me){return fe[0]=-Me[0],fe[1]=-Me[1],fe[2]=-Me[2],fe[3]=Me[3],fe},lt.fromMat3=S,lt.fromEuler=function(fe,Me,Fe,Pe){var ze=.5*Math.PI/180;Me*=ze,Fe*=ze,Pe*=ze;var Ne=Math.sin(Me),Ge=Math.cos(Me),Ue=Math.sin(Fe),qe=Math.cos(Fe),gt=Math.sin(Pe),ft=Math.cos(Pe);return fe[0]=Ne*qe*ft-Ge*Ue*gt,fe[1]=Ge*Ue*ft+Ne*qe*gt,fe[2]=Ge*qe*gt-Ne*Ue*ft,fe[3]=Ge*qe*ft+Ne*Ue*gt,fe},lt.str=function(fe){return"quat("+fe[0]+", "+fe[1]+", "+fe[2]+", "+fe[3]+")"},lt.setAxes=lt.sqlerp=lt.rotationTo=lt.equals=lt.exactEquals=lt.normalize=lt.sqrLen=lt.squaredLength=lt.len=lt.length=lt.lerp=lt.dot=lt.scale=lt.mul=lt.add=lt.set=lt.copy=lt.fromValues=lt.clone=void 0;var o=g(U()),l=g(Te()),u=g(xt()),p=g(Ot());function h(fe){if(typeof WeakMap!="function")return null;var Me=new WeakMap,Fe=new WeakMap;return(h=function(Pe){return Pe?Fe:Me})(fe)}function g(fe,Me){if(fe&&fe.__esModule)return fe;if(fe===null||d(fe)!=="object"&&typeof fe!="function")return{default:fe};var Fe=h(Me);if(Fe&&Fe.has(fe))return Fe.get(fe);var Pe={},ze=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ne in fe)if(Ne!=="default"&&Object.prototype.hasOwnProperty.call(fe,Ne)){var Ge=ze?Object.getOwnPropertyDescriptor(fe,Ne):null;Ge&&(Ge.get||Ge.set)?Object.defineProperty(Pe,Ne,Ge):Pe[Ne]=fe[Ne]}return Pe.default=fe,Fe&&Fe.set(fe,Pe),Pe}function x(){var fe=new o.ARRAY_TYPE(4);return o.ARRAY_TYPE!=Float32Array&&(fe[0]=0,fe[1]=0,fe[2]=0),fe[3]=1,fe}function C(fe,Me,Fe){Fe*=.5;var Pe=Math.sin(Fe);return fe[0]=Pe*Me[0],fe[1]=Pe*Me[1],fe[2]=Pe*Me[2],fe[3]=Math.cos(Fe),fe}function D(fe,Me,Fe){var Pe=Me[0],ze=Me[1],Ne=Me[2],Ge=Me[3],Ue=Fe[0],qe=Fe[1],gt=Fe[2],ft=Fe[3];return fe[0]=Pe*ft+Ge*Ue+ze*gt-Ne*qe,fe[1]=ze*ft+Ge*qe+Ne*Ue-Pe*gt,fe[2]=Ne*ft+Ge*gt+Pe*qe-ze*Ue,fe[3]=Ge*ft-Pe*Ue-ze*qe-Ne*gt,fe}function v(fe,Me){var Fe=Me[0],Pe=Me[1],ze=Me[2],Ne=Me[3],Ge=Math.sqrt(Fe*Fe+Pe*Pe+ze*ze),Ue=Math.exp(Ne),qe=Ge>0?Ue*Math.sin(Ge)/Ge:0;return fe[0]=Fe*qe,fe[1]=Pe*qe,fe[2]=ze*qe,fe[3]=Ue*Math.cos(Ge),fe}function E(fe,Me){var Fe=Me[0],Pe=Me[1],ze=Me[2],Ne=Me[3],Ge=Math.sqrt(Fe*Fe+Pe*Pe+ze*ze),Ue=Ge>0?Math.atan2(Ge,Ne)/Ge:0;return fe[0]=Fe*Ue,fe[1]=Pe*Ue,fe[2]=ze*Ue,fe[3]=.5*Math.log(Fe*Fe+Pe*Pe+ze*ze+Ne*Ne),fe}function T(fe,Me,Fe,Pe){var ze,Ne,Ge,Ue,qe,gt=Me[0],ft=Me[1],Gt=Me[2],wt=Me[3],Rt=Fe[0],yt=Fe[1],mi=Fe[2],jt=Fe[3];return(Ne=gt*Rt+ft*yt+Gt*mi+wt*jt)<0&&(Ne=-Ne,Rt=-Rt,yt=-yt,mi=-mi,jt=-jt),1-Ne>o.EPSILON?(ze=Math.acos(Ne),Ge=Math.sin(ze),Ue=Math.sin((1-Pe)*ze)/Ge,qe=Math.sin(Pe*ze)/Ge):(Ue=1-Pe,qe=Pe),fe[0]=Ue*gt+qe*Rt,fe[1]=Ue*ft+qe*yt,fe[2]=Ue*Gt+qe*mi,fe[3]=Ue*wt+qe*jt,fe}function S(fe,Me){var Fe,Pe=Me[0]+Me[4]+Me[8];if(Pe>0)Fe=Math.sqrt(Pe+1),fe[3]=.5*Fe,fe[0]=(Me[5]-Me[7])*(Fe=.5/Fe),fe[1]=(Me[6]-Me[2])*Fe,fe[2]=(Me[1]-Me[3])*Fe;else{var ze=0;Me[4]>Me[0]&&(ze=1),Me[8]>Me[3*ze+ze]&&(ze=2);var Ne=(ze+1)%3,Ge=(ze+2)%3;Fe=Math.sqrt(Me[3*ze+ze]-Me[3*Ne+Ne]-Me[3*Ge+Ge]+1),fe[ze]=.5*Fe,fe[3]=(Me[3*Ne+Ge]-Me[3*Ge+Ne])*(Fe=.5/Fe),fe[Ne]=(Me[3*Ne+ze]+Me[3*ze+Ne])*Fe,fe[Ge]=(Me[3*Ge+ze]+Me[3*ze+Ge])*Fe}return fe}lt.clone=p.clone,lt.fromValues=p.fromValues,lt.copy=p.copy,lt.set=p.set,lt.add=p.add,lt.mul=D;var M=p.scale;lt.scale=M;var R=p.dot;lt.dot=R,lt.lerp=p.lerp;var L=p.length;lt.length=L,lt.len=L;var N=p.squaredLength;lt.squaredLength=N,lt.sqrLen=N;var $=p.normalize;lt.normalize=$,lt.exactEquals=p.exactEquals,lt.equals=p.equals;var H,j,q,Y=(H=u.create(),j=u.fromValues(1,0,0),q=u.fromValues(0,1,0),function(fe,Me,Fe){var Pe=u.dot(Me,Fe);return Pe<-.999999?(u.cross(H,j,Me),u.len(H)<1e-6&&u.cross(H,q,Me),u.normalize(H,H),C(fe,H,Math.PI),fe):Pe>.999999?(fe[0]=0,fe[1]=0,fe[2]=0,fe[3]=1,fe):(u.cross(H,Me,Fe),fe[0]=H[0],fe[1]=H[1],fe[2]=H[2],fe[3]=1+Pe,$(fe,fe))});lt.rotationTo=Y;var Q,pe,de=(Q=x(),pe=x(),function(fe,Me,Fe,Pe,ze,Ne){return T(Q,Me,ze,Ne),T(pe,Fe,Pe,Ne),T(fe,Q,pe,2*Ne*(1-Ne)),fe});lt.sqlerp=de;var ue,De=(ue=l.create(),function(fe,Me,Fe,Pe){return ue[0]=Fe[0],ue[3]=Fe[1],ue[6]=Fe[2],ue[1]=Pe[0],ue[4]=Pe[1],ue[7]=Pe[2],ue[2]=-Me[0],ue[5]=-Me[1],ue[8]=-Me[2],$(fe,S(fe,ue))});return lt.setAxes=De,lt}var oi,tt={};function vt(){if(oi)return tt;function d(T){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S},d(T)}oi=1,Object.defineProperty(tt,"__esModule",{value:!0}),tt.create=function(){var T=new o.ARRAY_TYPE(8);return o.ARRAY_TYPE!=Float32Array&&(T[0]=0,T[1]=0,T[2]=0,T[4]=0,T[5]=0,T[6]=0,T[7]=0),T[3]=1,T},tt.clone=function(T){var S=new o.ARRAY_TYPE(8);return S[0]=T[0],S[1]=T[1],S[2]=T[2],S[3]=T[3],S[4]=T[4],S[5]=T[5],S[6]=T[6],S[7]=T[7],S},tt.fromValues=function(T,S,M,R,L,N,$,H){var j=new o.ARRAY_TYPE(8);return j[0]=T,j[1]=S,j[2]=M,j[3]=R,j[4]=L,j[5]=N,j[6]=$,j[7]=H,j},tt.fromRotationTranslationValues=function(T,S,M,R,L,N,$){var H=new o.ARRAY_TYPE(8);H[0]=T,H[1]=S,H[2]=M,H[3]=R;var j=.5*L,q=.5*N,Y=.5*$;return H[4]=j*R+q*M-Y*S,H[5]=q*R+Y*T-j*M,H[6]=Y*R+j*S-q*T,H[7]=-j*T-q*S-Y*M,H},tt.fromRotationTranslation=g,tt.fromTranslation=function(T,S){return T[0]=0,T[1]=0,T[2]=0,T[3]=1,T[4]=.5*S[0],T[5]=.5*S[1],T[6]=.5*S[2],T[7]=0,T},tt.fromRotation=function(T,S){return T[0]=S[0],T[1]=S[1],T[2]=S[2],T[3]=S[3],T[4]=0,T[5]=0,T[6]=0,T[7]=0,T},tt.fromMat4=function(T,S){var M=l.create();u.getRotation(M,S);var R=new o.ARRAY_TYPE(3);return u.getTranslation(R,S),g(T,M,R),T},tt.copy=x,tt.identity=function(T){return T[0]=0,T[1]=0,T[2]=0,T[3]=1,T[4]=0,T[5]=0,T[6]=0,T[7]=0,T},tt.set=function(T,S,M,R,L,N,$,H,j){return T[0]=S,T[1]=M,T[2]=R,T[3]=L,T[4]=N,T[5]=$,T[6]=H,T[7]=j,T},tt.getDual=function(T,S){return T[0]=S[4],T[1]=S[5],T[2]=S[6],T[3]=S[7],T},tt.setDual=function(T,S){return T[4]=S[0],T[5]=S[1],T[6]=S[2],T[7]=S[3],T},tt.getTranslation=function(T,S){var M=S[4],R=S[5],L=S[6],N=S[7],$=-S[0],H=-S[1],j=-S[2],q=S[3];return T[0]=2*(M*q+N*$+R*j-L*H),T[1]=2*(R*q+N*H+L*$-M*j),T[2]=2*(L*q+N*j+M*H-R*$),T},tt.translate=function(T,S,M){var R=S[0],L=S[1],N=S[2],$=S[3],H=.5*M[0],j=.5*M[1],q=.5*M[2],Y=S[4],Q=S[5],pe=S[6],de=S[7];return T[0]=R,T[1]=L,T[2]=N,T[3]=$,T[4]=$*H+L*q-N*j+Y,T[5]=$*j+N*H-R*q+Q,T[6]=$*q+R*j-L*H+pe,T[7]=-R*H-L*j-N*q+de,T},tt.rotateX=function(T,S,M){var R=-S[0],L=-S[1],N=-S[2],$=S[3],H=S[4],j=S[5],q=S[6],Y=S[7],Q=H*$+Y*R+j*N-q*L,pe=j*$+Y*L+q*R-H*N,de=q*$+Y*N+H*L-j*R,ue=Y*$-H*R-j*L-q*N;return l.rotateX(T,S,M),T[4]=Q*($=T[3])+ue*(R=T[0])+pe*(N=T[2])-de*(L=T[1]),T[5]=pe*$+ue*L+de*R-Q*N,T[6]=de*$+ue*N+Q*L-pe*R,T[7]=ue*$-Q*R-pe*L-de*N,T},tt.rotateY=function(T,S,M){var R=-S[0],L=-S[1],N=-S[2],$=S[3],H=S[4],j=S[5],q=S[6],Y=S[7],Q=H*$+Y*R+j*N-q*L,pe=j*$+Y*L+q*R-H*N,de=q*$+Y*N+H*L-j*R,ue=Y*$-H*R-j*L-q*N;return l.rotateY(T,S,M),T[4]=Q*($=T[3])+ue*(R=T[0])+pe*(N=T[2])-de*(L=T[1]),T[5]=pe*$+ue*L+de*R-Q*N,T[6]=de*$+ue*N+Q*L-pe*R,T[7]=ue*$-Q*R-pe*L-de*N,T},tt.rotateZ=function(T,S,M){var R=-S[0],L=-S[1],N=-S[2],$=S[3],H=S[4],j=S[5],q=S[6],Y=S[7],Q=H*$+Y*R+j*N-q*L,pe=j*$+Y*L+q*R-H*N,de=q*$+Y*N+H*L-j*R,ue=Y*$-H*R-j*L-q*N;return l.rotateZ(T,S,M),T[4]=Q*($=T[3])+ue*(R=T[0])+pe*(N=T[2])-de*(L=T[1]),T[5]=pe*$+ue*L+de*R-Q*N,T[6]=de*$+ue*N+Q*L-pe*R,T[7]=ue*$-Q*R-pe*L-de*N,T},tt.rotateByQuatAppend=function(T,S,M){var R=M[0],L=M[1],N=M[2],$=M[3],H=S[0],j=S[1],q=S[2],Y=S[3];return T[0]=H*$+Y*R+j*N-q*L,T[1]=j*$+Y*L+q*R-H*N,T[2]=q*$+Y*N+H*L-j*R,T[3]=Y*$-H*R-j*L-q*N,T[4]=(H=S[4])*$+(Y=S[7])*R+(j=S[5])*N-(q=S[6])*L,T[5]=j*$+Y*L+q*R-H*N,T[6]=q*$+Y*N+H*L-j*R,T[7]=Y*$-H*R-j*L-q*N,T},tt.rotateByQuatPrepend=function(T,S,M){var R=S[0],L=S[1],N=S[2],$=S[3],H=M[0],j=M[1],q=M[2],Y=M[3];return T[0]=R*Y+$*H+L*q-N*j,T[1]=L*Y+$*j+N*H-R*q,T[2]=N*Y+$*q+R*j-L*H,T[3]=$*Y-R*H-L*j-N*q,T[4]=R*(Y=M[7])+$*(H=M[4])+L*(q=M[6])-N*(j=M[5]),T[5]=L*Y+$*j+N*H-R*q,T[6]=N*Y+$*q+R*j-L*H,T[7]=$*Y-R*H-L*j-N*q,T},tt.rotateAroundAxis=function(T,S,M,R){if(Math.abs(R)<o.EPSILON)return x(T,S);var L=Math.hypot(M[0],M[1],M[2]);R*=.5;var N=Math.sin(R),$=N*M[0]/L,H=N*M[1]/L,j=N*M[2]/L,q=Math.cos(R),Y=S[0],Q=S[1],pe=S[2],de=S[3];T[0]=Y*q+de*$+Q*j-pe*H,T[1]=Q*q+de*H+pe*$-Y*j,T[2]=pe*q+de*j+Y*H-Q*$,T[3]=de*q-Y*$-Q*H-pe*j;var ue=S[4],De=S[5],fe=S[6],Me=S[7];return T[4]=ue*q+Me*$+De*j-fe*H,T[5]=De*q+Me*H+fe*$-ue*j,T[6]=fe*q+Me*j+ue*H-De*$,T[7]=Me*q-ue*$-De*H-fe*j,T},tt.add=function(T,S,M){return T[0]=S[0]+M[0],T[1]=S[1]+M[1],T[2]=S[2]+M[2],T[3]=S[3]+M[3],T[4]=S[4]+M[4],T[5]=S[5]+M[5],T[6]=S[6]+M[6],T[7]=S[7]+M[7],T},tt.multiply=C,tt.scale=function(T,S,M){return T[0]=S[0]*M,T[1]=S[1]*M,T[2]=S[2]*M,T[3]=S[3]*M,T[4]=S[4]*M,T[5]=S[5]*M,T[6]=S[6]*M,T[7]=S[7]*M,T},tt.lerp=function(T,S,M,R){var L=1-R;return D(S,M)<0&&(R=-R),T[0]=S[0]*L+M[0]*R,T[1]=S[1]*L+M[1]*R,T[2]=S[2]*L+M[2]*R,T[3]=S[3]*L+M[3]*R,T[4]=S[4]*L+M[4]*R,T[5]=S[5]*L+M[5]*R,T[6]=S[6]*L+M[6]*R,T[7]=S[7]*L+M[7]*R,T},tt.invert=function(T,S){var M=E(S);return T[0]=-S[0]/M,T[1]=-S[1]/M,T[2]=-S[2]/M,T[3]=S[3]/M,T[4]=-S[4]/M,T[5]=-S[5]/M,T[6]=-S[6]/M,T[7]=S[7]/M,T},tt.conjugate=function(T,S){return T[0]=-S[0],T[1]=-S[1],T[2]=-S[2],T[3]=S[3],T[4]=-S[4],T[5]=-S[5],T[6]=-S[6],T[7]=S[7],T},tt.normalize=function(T,S){var M=E(S);if(M>0){M=Math.sqrt(M);var R=S[0]/M,L=S[1]/M,N=S[2]/M,$=S[3]/M,H=S[4],j=S[5],q=S[6],Y=S[7],Q=R*H+L*j+N*q+$*Y;T[0]=R,T[1]=L,T[2]=N,T[3]=$,T[4]=(H-R*Q)/M,T[5]=(j-L*Q)/M,T[6]=(q-N*Q)/M,T[7]=(Y-$*Q)/M}return T},tt.str=function(T){return"quat2("+T[0]+", "+T[1]+", "+T[2]+", "+T[3]+", "+T[4]+", "+T[5]+", "+T[6]+", "+T[7]+")"},tt.exactEquals=function(T,S){return T[0]===S[0]&&T[1]===S[1]&&T[2]===S[2]&&T[3]===S[3]&&T[4]===S[4]&&T[5]===S[5]&&T[6]===S[6]&&T[7]===S[7]},tt.equals=function(T,S){var M=T[0],R=T[1],L=T[2],N=T[3],$=T[4],H=T[5],j=T[6],q=T[7],Y=S[0],Q=S[1],pe=S[2],de=S[3],ue=S[4],De=S[5],fe=S[6],Me=S[7];return Math.abs(M-Y)<=o.EPSILON*Math.max(1,Math.abs(M),Math.abs(Y))&&Math.abs(R-Q)<=o.EPSILON*Math.max(1,Math.abs(R),Math.abs(Q))&&Math.abs(L-pe)<=o.EPSILON*Math.max(1,Math.abs(L),Math.abs(pe))&&Math.abs(N-de)<=o.EPSILON*Math.max(1,Math.abs(N),Math.abs(de))&&Math.abs($-ue)<=o.EPSILON*Math.max(1,Math.abs($),Math.abs(ue))&&Math.abs(H-De)<=o.EPSILON*Math.max(1,Math.abs(H),Math.abs(De))&&Math.abs(j-fe)<=o.EPSILON*Math.max(1,Math.abs(j),Math.abs(fe))&&Math.abs(q-Me)<=o.EPSILON*Math.max(1,Math.abs(q),Math.abs(Me))},tt.sqrLen=tt.squaredLength=tt.len=tt.length=tt.dot=tt.mul=tt.setReal=tt.getReal=void 0;var o=h(U()),l=h(Kt()),u=h(Pt());function p(T){if(typeof WeakMap!="function")return null;var S=new WeakMap,M=new WeakMap;return(p=function(R){return R?M:S})(T)}function h(T,S){if(T&&T.__esModule)return T;if(T===null||d(T)!=="object"&&typeof T!="function")return{default:T};var M=p(S);if(M&&M.has(T))return M.get(T);var R={},L=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var N in T)if(N!=="default"&&Object.prototype.hasOwnProperty.call(T,N)){var $=L?Object.getOwnPropertyDescriptor(T,N):null;$&&($.get||$.set)?Object.defineProperty(R,N,$):R[N]=T[N]}return R.default=T,M&&M.set(T,R),R}function g(T,S,M){var R=.5*M[0],L=.5*M[1],N=.5*M[2],$=S[0],H=S[1],j=S[2],q=S[3];return T[0]=$,T[1]=H,T[2]=j,T[3]=q,T[4]=R*q+L*j-N*H,T[5]=L*q+N*$-R*j,T[6]=N*q+R*H-L*$,T[7]=-R*$-L*H-N*j,T}function x(T,S){return T[0]=S[0],T[1]=S[1],T[2]=S[2],T[3]=S[3],T[4]=S[4],T[5]=S[5],T[6]=S[6],T[7]=S[7],T}function C(T,S,M){var R=S[0],L=S[1],N=S[2],$=S[3],H=M[4],j=M[5],q=M[6],Y=M[7],Q=S[4],pe=S[5],de=S[6],ue=S[7],De=M[0],fe=M[1],Me=M[2],Fe=M[3];return T[0]=R*Fe+$*De+L*Me-N*fe,T[1]=L*Fe+$*fe+N*De-R*Me,T[2]=N*Fe+$*Me+R*fe-L*De,T[3]=$*Fe-R*De-L*fe-N*Me,T[4]=R*Y+$*H+L*q-N*j+Q*Fe+ue*De+pe*Me-de*fe,T[5]=L*Y+$*j+N*H-R*q+pe*Fe+ue*fe+de*De-Q*Me,T[6]=N*Y+$*q+R*j-L*H+de*Fe+ue*Me+Q*fe-pe*De,T[7]=$*Y-R*H-L*j-N*q+ue*Fe-Q*De-pe*fe-de*Me,T}tt.getReal=l.copy,tt.setReal=l.copy,tt.mul=C;var D=l.dot;tt.dot=D;var v=l.length;tt.length=v,tt.len=v;var E=l.squaredLength;return tt.squaredLength=E,tt.sqrLen=E,tt}var pi,mn,_i={};function ro(){if(pi)return _i;function d(S){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},d(S)}pi=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.create=u,_i.clone=function(S){var M=new o.ARRAY_TYPE(2);return M[0]=S[0],M[1]=S[1],M},_i.fromValues=function(S,M){var R=new o.ARRAY_TYPE(2);return R[0]=S,R[1]=M,R},_i.copy=function(S,M){return S[0]=M[0],S[1]=M[1],S},_i.set=function(S,M,R){return S[0]=M,S[1]=R,S},_i.add=function(S,M,R){return S[0]=M[0]+R[0],S[1]=M[1]+R[1],S},_i.subtract=p,_i.multiply=h,_i.divide=g,_i.ceil=function(S,M){return S[0]=Math.ceil(M[0]),S[1]=Math.ceil(M[1]),S},_i.floor=function(S,M){return S[0]=Math.floor(M[0]),S[1]=Math.floor(M[1]),S},_i.min=function(S,M,R){return S[0]=Math.min(M[0],R[0]),S[1]=Math.min(M[1],R[1]),S},_i.max=function(S,M,R){return S[0]=Math.max(M[0],R[0]),S[1]=Math.max(M[1],R[1]),S},_i.round=function(S,M){return S[0]=Math.round(M[0]),S[1]=Math.round(M[1]),S},_i.scale=function(S,M,R){return S[0]=M[0]*R,S[1]=M[1]*R,S},_i.scaleAndAdd=function(S,M,R,L){return S[0]=M[0]+R[0]*L,S[1]=M[1]+R[1]*L,S},_i.distance=x,_i.squaredDistance=C,_i.length=D,_i.squaredLength=v,_i.negate=function(S,M){return S[0]=-M[0],S[1]=-M[1],S},_i.inverse=function(S,M){return S[0]=1/M[0],S[1]=1/M[1],S},_i.normalize=function(S,M){var R=M[0],L=M[1],N=R*R+L*L;return N>0&&(N=1/Math.sqrt(N)),S[0]=M[0]*N,S[1]=M[1]*N,S},_i.dot=function(S,M){return S[0]*M[0]+S[1]*M[1]},_i.cross=function(S,M,R){var L=M[0]*R[1]-M[1]*R[0];return S[0]=S[1]=0,S[2]=L,S},_i.lerp=function(S,M,R,L){var N=M[0],$=M[1];return S[0]=N+L*(R[0]-N),S[1]=$+L*(R[1]-$),S},_i.random=function(S,M){M=M||1;var R=2*o.RANDOM()*Math.PI;return S[0]=Math.cos(R)*M,S[1]=Math.sin(R)*M,S},_i.transformMat2=function(S,M,R){var L=M[0],N=M[1];return S[0]=R[0]*L+R[2]*N,S[1]=R[1]*L+R[3]*N,S},_i.transformMat2d=function(S,M,R){var L=M[0],N=M[1];return S[0]=R[0]*L+R[2]*N+R[4],S[1]=R[1]*L+R[3]*N+R[5],S},_i.transformMat3=function(S,M,R){var L=M[0],N=M[1];return S[0]=R[0]*L+R[3]*N+R[6],S[1]=R[1]*L+R[4]*N+R[7],S},_i.transformMat4=function(S,M,R){var L=M[0],N=M[1];return S[0]=R[0]*L+R[4]*N+R[12],S[1]=R[1]*L+R[5]*N+R[13],S},_i.rotate=function(S,M,R,L){var N=M[0]-R[0],$=M[1]-R[1],H=Math.sin(L),j=Math.cos(L);return S[0]=N*j-$*H+R[0],S[1]=N*H+$*j+R[1],S},_i.angle=function(S,M){var R=S[0],L=S[1],N=M[0],$=M[1],H=Math.sqrt(R*R+L*L)*Math.sqrt(N*N+$*$);return Math.acos(Math.min(Math.max(H&&(R*N+L*$)/H,-1),1))},_i.zero=function(S){return S[0]=0,S[1]=0,S},_i.str=function(S){return"vec2("+S[0]+", "+S[1]+")"},_i.exactEquals=function(S,M){return S[0]===M[0]&&S[1]===M[1]},_i.equals=function(S,M){var R=S[0],L=S[1],N=M[0],$=M[1];return Math.abs(R-N)<=o.EPSILON*Math.max(1,Math.abs(R),Math.abs(N))&&Math.abs(L-$)<=o.EPSILON*Math.max(1,Math.abs(L),Math.abs($))},_i.forEach=_i.sqrLen=_i.sqrDist=_i.dist=_i.div=_i.mul=_i.sub=_i.len=void 0;var o=function(S,M){if(S&&S.__esModule)return S;if(S===null||d(S)!=="object"&&typeof S!="function")return{default:S};var R=l(void 0);if(R&&R.has(S))return R.get(S);var L={},N=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in S)if($!=="default"&&Object.prototype.hasOwnProperty.call(S,$)){var H=N?Object.getOwnPropertyDescriptor(S,$):null;H&&(H.get||H.set)?Object.defineProperty(L,$,H):L[$]=S[$]}return L.default=S,R&&R.set(S,L),L}(U());function l(S){if(typeof WeakMap!="function")return null;var M=new WeakMap,R=new WeakMap;return(l=function(L){return L?R:M})(S)}function u(){var S=new o.ARRAY_TYPE(2);return o.ARRAY_TYPE!=Float32Array&&(S[0]=0,S[1]=0),S}function p(S,M,R){return S[0]=M[0]-R[0],S[1]=M[1]-R[1],S}function h(S,M,R){return S[0]=M[0]*R[0],S[1]=M[1]*R[1],S}function g(S,M,R){return S[0]=M[0]/R[0],S[1]=M[1]/R[1],S}function x(S,M){return Math.hypot(M[0]-S[0],M[1]-S[1])}function C(S,M){var R=M[0]-S[0],L=M[1]-S[1];return R*R+L*L}function D(S){return Math.hypot(S[0],S[1])}function v(S){var M=S[0],R=S[1];return M*M+R*R}_i.len=D,_i.sub=p,_i.mul=h,_i.div=g,_i.dist=x,_i.sqrDist=C,_i.sqrLen=v;var E,T=(E=u(),function(S,M,R,L,N,$){var H,j;for(M||(M=2),R||(R=0),j=L?Math.min(L*M+R,S.length):S.length,H=R;H<j;H+=M)E[0]=S[H],E[1]=S[H+1],N(E,E,$),S[H]=E[0],S[H+1]=E[1];return S});return _i.forEach=T,_i}function pa(){if(mn)return P;function d(S){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},d(S)}mn=1,Object.defineProperty(P,"__esModule",{value:!0}),P.vec4=P.vec3=P.vec2=P.quat2=P.quat=P.mat4=P.mat3=P.mat2d=P.mat2=P.glMatrix=void 0;var o=T(U());P.glMatrix=o;var l=T(re());P.mat2=l;var u=T(we());P.mat2d=u;var p=T(Te());P.mat3=p;var h=T(Pt());P.mat4=h;var g=T(Kt());P.quat=g;var x=T(vt());P.quat2=x;var C=T(ro());P.vec2=C;var D=T(xt());P.vec3=D;var v=T(Ot());function E(S){if(typeof WeakMap!="function")return null;var M=new WeakMap,R=new WeakMap;return(E=function(L){return L?R:M})(S)}function T(S,M){if(S&&S.__esModule)return S;if(S===null||d(S)!=="object"&&typeof S!="function")return{default:S};var R=E(M);if(R&&R.has(S))return R.get(S);var L={},N=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in S)if($!=="default"&&Object.prototype.hasOwnProperty.call(S,$)){var H=N?Object.getOwnPropertyDescriptor(S,$):null;H&&(H.get||H.set)?Object.defineProperty(L,$,H):L[$]=S[$]}return L.default=S,R&&R.set(S,L),L}return P.vec4=v,P}var Ko,Qt,Xt,li,ce=pa(),Xr=function(){if(Qt)return Ko;function d(o,l,u,p){this.cx=3*o,this.bx=3*(u-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(p-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=l,this.p2x=u,this.p2y=p}return Qt=1,Ko=d,d.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,l){if(l===void 0&&(l=1e-6),o<0)return 0;if(o>1)return 1;for(var u=o,p=0;p<8;p++){var h=this.sampleCurveX(u)-o;if(Math.abs(h)<l)return u;var g=this.sampleCurveDerivativeX(u);if(Math.abs(g)<1e-6)break;u-=h/g}var x=0,C=1;for(u=o,p=0;p<20&&(h=this.sampleCurveX(u),!(Math.abs(h-o)<l));p++)o>h?x=u:C=u,u=.5*(C-x)+x;return u},solve:function(o,l){return this.sampleCurveY(this.solveCurveX(o,l))}},Ko}(),fa=y(Xr);function ma(){if(li)return Xt;function d(o,l){this.x=o,this.y=l}return li=1,Xt=d,d.prototype={clone:function(){return new d(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,l){return this.clone()._rotateAround(o,l)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var l=o.x-this.x,u=o.y-this.y;return l*l+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,l){return Math.atan2(this.x*l-this.y*o,this.x*o+this.y*l)},_matMult:function(o){var l=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=l,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var l=Math.cos(o),u=Math.sin(o),p=u*this.x+l*this.y;return this.x=l*this.x-u*this.y,this.y=p,this},_rotateAround:function(o,l){var u=Math.cos(o),p=Math.sin(o),h=l.y+p*(this.x-l.x)+u*(this.y-l.y);return this.x=l.x+u*(this.x-l.x)-p*(this.y-l.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},d.convert=function(o){return o instanceof d?o:Array.isArray(o)?new d(o[0],o[1]):o},Xt}var At=y(ma());function To(d,o){if(Array.isArray(d)){if(!Array.isArray(o)||d.length!==o.length)return!1;for(let l=0;l<d.length;l++)if(!To(d[l],o[l]))return!1;return!0}if(typeof d=="object"&&d!==null&&o!==null){if(typeof o!="object"||Object.keys(d).length!==Object.keys(o).length)return!1;for(let l in d)if(!To(d[l],o[l]))return!1;return!0}return d===o}let mr=Math.PI/180,ho=180/Math.PI;function Qi(d){return d*mr}function Ur(d){return d*ho}let ga=[[0,0],[1,0],[1,1],[0,1]];function Ya(d){if(d<=0)return 0;if(d>=1)return 1;let o=d*d,l=o*d;return 4*(d<.5?l:3*(d-o)+l-.75)}function Za(d,o,l,u){let p=new fa(d,o,l,u);return function(h){return p.solve(h)}}let ll=Za(.25,.1,.25,1);function qi(d,o,l){return Math.min(l,Math.max(o,d))}function Vo(d,o,l){return(l=qi((l-d)/(o-d),0,1))*l*(3-2*l)}function Os(d,o,l){let u=l-o,p=((d-o)%u+u)%u+o;return p===o?l:p}function cl(d,o,l){if(!d.length)return l(null,[]);let u=d.length,p=new Array(d.length),h=null;d.forEach((g,x)=>{o(g,(C,D)=>{C&&(h=C),p[x]=D,--u==0&&l(h,p)})})}function Io(d,...o){for(let l of o)for(let u in l)d[u]=l[u];return d}let Oa=1;function ps(){return Oa++}function dl(d){return d<=1?1:Math.pow(2,Math.ceil(Math.log(d)/Math.LN2))}function Wp(d,o){d.forEach(l=>{o[l]&&(o[l]=o[l].bind(o))})}function Xd(d,o,l){let u={};for(let p in d)u[p]=o.call(this,d[p],p,d);return u}function Kd(d,o,l){let u={};for(let p in d)o.call(this,d[p],p,d)&&(u[p]=d[p]);return u}function fs(d){return Array.isArray(d)?d.map(fs):typeof d=="object"&&d?Xd(d,fs):d}let qu={};function Er(d){qu[d]||(typeof console<"u"&&console.warn(d),qu[d]=!0)}function Kn(d,o,l){return(l.y-d.y)*(o.x-d.x)>(o.y-d.y)*(l.x-d.x)}function Yp(d){let o=0;for(let l,u,p=0,h=d.length,g=h-1;p<h;g=p++)l=d[p],u=d[g],o+=(u.x-l.x)*(l.y+u.y);return o}function Wu([d,o,l]){let u=Qi(o+90),p=Qi(l);return{x:d*Math.cos(u)*Math.sin(p),y:d*Math.sin(u)*Math.sin(p),z:d*Math.cos(p),azimuthal:o,polar:l}}function Va(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Qd(d){let o={};if(d.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,u,p,h)=>{let g=p||h;return o[u]=!g||g.toLowerCase(),""}),o["max-age"]){let l=parseInt(o["max-age"],10);isNaN(l)?delete o["max-age"]:o["max-age"]=l}return o}let Zp=null;function Yu(d,o){return[d[4*o],d[4*o+1],d[4*o+2],d[4*o+3]]}function $m(d,o,l,u){for(;o<l;){let p=o+l>>1;d[p]<u?o=p+1:l=p}return o}function Gm(d,o,l,u){for(;o<l;){let p=o+l>>1;d[p]<=u?o=p+1:l=p}return o}function Xp(d){return d>0?1/(1.001-d):1+d}function nt(d){return d>0?1-1/(1.001-d):-d}let ie={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!ie.API_URL)return null;try{let d=new URL(ie.API_URL);return d.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":d.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function se(d){return ie.API_URL_REGEX.test(d)}function ye(d){return ie.API_SPRITE_REGEX.test(d)}let ke,Ie,Le,Ze,Ve,Je;function ot(){return ke==null&&(ke=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),ke}let it={now:()=>Ze!==void 0?Ze:performance.now(),setNow(d){Ze=d},restoreNow(){Ze=void 0},frame(d){let o=requestAnimationFrame(d);return{cancel:()=>cancelAnimationFrame(o)}},getImageData(d,o=0){let{width:l,height:u}=d;Ve||(Ve=document.createElement("canvas"));let p=Ve.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return(l>Ve.width||u>Ve.height)&&(Ve.width=l,Ve.height=u),p.clearRect(-o,-o,l+2*o,u+2*o),p.drawImage(d,0,0,l,u),p.getImageData(-o,-o,l+2*o,u+2*o)},resolveURL:d=>(Ie||(Ie=document.createElement("a")),Ie.href=d,Ie.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Le==null&&(Le=window.matchMedia("(prefers-reduced-motion: reduce)")),Le.matches)},hasCanvasFingerprintNoise(){if(Je!==void 0)return Je;if(!ot())return Je=!1,!1;let d=new OffscreenCanvas(85,1),o=d.getContext("2d",{willReadFrequently:!0}),l=0;for(let p=0;p<d.width;++p)o.fillStyle=`rgba(${l++},${l++},${l++}, 255)`,o.fillRect(p,0,1,1);let u=o.getImageData(0,0,d.width,d.height);l=0;for(let p=0;p<u.data.length;++p)if(p%4!=3&&l++!==u.data[p])return Je=!0,!0;return Je=!1,!1}};function Tt(d,o){let l=d.indexOf("?");if(l<0)return`${d}?${new URLSearchParams(o).toString()}`;let u=new URLSearchParams(d.slice(l));for(let p in o)u.set(p,o[p]);return`${d.slice(0,l)}?${u.toString()}`}function Ut(d,o={persistentParams:[]}){let l=d.indexOf("?");if(l<0)return d;let u=new URLSearchParams,p=new URLSearchParams(d.slice(l));for(let g of o.persistentParams){let x=p.get(g);x&&u.set(g,x)}let h=u.toString();return`${d.slice(0,l)}${h.length>0?`?${h}`:""}`}let Zt="mapbox-tiles",Pi=500,Hi=50,$i=["language","worldview","jobid"],Yi,lr;function wr(){try{return caches}catch{}}function nn(){let d=wr();d&&Yi==null&&(Yi=d.open(Zt))}let On=1/0,Fn={supported:!1,testSupport:function(d){!Ao&&Fr&&(_a?Fa(d):zn=d)}},zn,Fr,Ao=!1,_a=!1,Fs=typeof self<"u"?self:{};function Fa(d){let o=d.createTexture();d.bindTexture(d.TEXTURE_2D,o);try{if(d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,Fr),d.isContextLost())return;Fn.supported=!0}catch{}d.deleteTexture(o),Ao=!0}Fs.document&&(Fr=Fs.document.createElement("img"),Fr.onload=function(){zn&&Fa(zn),zn=null,_a=!0},Fr.onerror=function(){Ao=!0,zn=null},Fr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");let Ro={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Ro);class jo extends Error{constructor(o,l,u){l===401&&se(u)&&(o+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(o),this.status=l,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}let Zu=Va()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Ls=function(d,o){if(!(/^file:/.test(l=d.url)||/^file:/.test(Zu())&&!/^\w+:/.test(l))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(u,p){let h=new AbortController,g=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:Zu(),referrerPolicy:u.referrerPolicy,signal:h.signal}),x=!1,C=!1,D=(v=g.url).indexOf("sku=")>0&&se(v);var v;u.type==="json"&&g.headers.set("Accept","application/json");let E=(S,M,R)=>{if(C)return;if(S&&S.message!=="SecurityError"&&Er(S.toString()),M&&R)return T(M);let L=Date.now();fetch(g).then(N=>{if(N.ok){let $=D?N.clone():null;return T(N,$,L)}return p(new jo(N.statusText,N.status,u.url))}).catch(N=>{N.name!=="AbortError"&&p(new Error(`${N.message} ${u.url}`))})},T=(S,M,R)=>{(u.type==="arrayBuffer"?S.arrayBuffer():u.type==="json"?S.json():S.text()).then(L=>{C||(M&&R&&function(N,$,H){if(nn(),Yi==null)return;let j=Qd($.headers.get("Cache-Control")||"");if(j["no-store"])return;let q={status:$.status,statusText:$.statusText,headers:new Headers};$.headers.forEach((pe,de)=>q.headers.set(de,pe)),j["max-age"]&&q.headers.set("Expires",new Date(H+1e3*j["max-age"]).toUTCString());let Y=q.headers.get("Expires");if(!Y||new Date(Y).getTime()-H<42e4)return;let Q=Ut(N.url,{persistentParams:$i});if($.status===206){let pe=N.headers.get("Range");if(!pe)return;q.status=200,Q=Tt(Q,{range:pe})}(function(pe,de){if(lr===void 0)try{new Response(new ReadableStream),lr=!0}catch{lr=!1}lr?de(pe.body):pe.blob().then(de)})($,pe=>{let de=new Response((ue=$.status)!==200&&ue!==404&&[101,103,204,205,304].includes(ue)?null:pe,q);var ue;nn(),Yi?.then(De=>De.put(Q,de)).catch(De=>Er(De.message))})}(g,M,R),x=!0,p(null,L,S.headers.get("Cache-Control"),S.headers.get("Expires")))}).catch(L=>{C||p(new Error(L.message))})};return D?function(S,M){if(nn(),Yi==null)return M(null);Yi.then(R=>{let L=Ut(S.url,{persistentParams:$i}),N=S.headers.get("Range");N&&(L=Tt(L,{range:N})),R.match(L).then($=>{let H=function(j){if(!j)return!1;let q=new Date(j.headers.get("Expires")||0),Y=Qd(j.headers.get("Cache-Control")||"");return q>Date.now()&&!Y["no-cache"]}($);R.delete(L),H&&R.put(L,$.clone()),M(null,$,H)}).catch(M)}).catch(M)}(g,E):E(null,null),{cancel:()=>{C=!0,x||h.abort()}}}(d,o);if(Va()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",d,o,void 0,!0)}var l;return function(u,p){let h=new XMLHttpRequest;h.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(h.responseType="arraybuffer");for(let g in u.headers)h.setRequestHeader(g,u.headers[g]);return u.type==="json"&&(h.responseType="text",h.setRequestHeader("Accept","application/json")),h.withCredentials=u.credentials==="include",h.onerror=()=>{p(new Error(h.statusText))},h.onload=()=>{if((h.status>=200&&h.status<300||h.status===0)&&h.response!==null){let g=h.response;if(u.type==="json")try{g=JSON.parse(h.response)}catch(x){return p(x)}p(null,g,h.getResponseHeader("Cache-Control"),h.getResponseHeader("Expires"))}else p(new jo(h.statusText,h.status,u.url))},h.send(u.body),{cancel:()=>h.abort()}}(d,o)},dc=function(d,o){return Ls(Io(d,{type:"arrayBuffer"}),o)};function Uy(d){let o=document.createElement("a");return o.href=d,o.protocol===location.protocol&&o.host===location.host}let qm="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",Kp,Xu;Kp=[],Xu=0;let Hy=function(d,o){if(Fn.supported&&(d.headers||(d.headers={}),d.headers.accept="image/webp,*/*"),Xu>=ie.MAX_PARALLEL_IMAGE_REQUESTS){let h={requestParameters:d,callback:o,cancelled:!1,cancel(){this.cancelled=!0}};return Kp.push(h),h}Xu++;let l=!1,u=()=>{if(!l)for(l=!0,Xu--;Kp.length&&Xu<ie.MAX_PARALLEL_IMAGE_REQUESTS;){let h=Kp.shift(),{requestParameters:g,callback:x,cancelled:C}=h;C||(h.cancel=Hy(g,x).cancel)}},p=dc(d,(h,g,x,C)=>{u(),h?o(h):g&&(self.createImageBitmap?function(D,v){let E=new Blob([new Uint8Array(D)],{type:"image/png"});createImageBitmap(E).then(T=>{v(null,T)}).catch(T=>{v(new Error(`Could not load image because of ${T.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(g,(D,v)=>o(D,v,x,C)):function(D,v){let E=new Image;E.onload=()=>{v(null,E),URL.revokeObjectURL(E.src),E.onload=null,requestAnimationFrame(()=>{E.src=qm})},E.onerror=()=>v(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let T=new Blob([new Uint8Array(D)],{type:"image/png"});E.src=D.byteLength?URL.createObjectURL(T):qm}(g,(D,v)=>o(D,v,x,C)))});return{cancel:()=>{p.cancel(),u()}}};var Zx,Xx,$y,Ku={exports:{}},ms={exports:{}},ul={exports:{}},rd=function(){if($y)return Ku.exports;$y=1;var d=(Zx||(Zx=1,ms.exports=function(l,u){var p,h,g,x,C,D,v,E;for(h=l.length-(p=3&l.length),g=u,C=3432918353,D=461845907,E=0;E<h;)v=255&l.charCodeAt(E)|(255&l.charCodeAt(++E))<<8|(255&l.charCodeAt(++E))<<16|(255&l.charCodeAt(++E))<<24,++E,g=27492+(65535&(x=5*(65535&(g=(g^=v=(65535&(v=(v=(65535&v)*C+(((v>>>16)*C&65535)<<16)&4294967295)<<15|v>>>17))*D+(((v>>>16)*D&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(v=0,p){case 3:v^=(255&l.charCodeAt(E+2))<<16;case 2:v^=(255&l.charCodeAt(E+1))<<8;case 1:g^=v=(65535&(v=(v=(65535&(v^=255&l.charCodeAt(E)))*C+(((v>>>16)*C&65535)<<16)&4294967295)<<15|v>>>17))*D+(((v>>>16)*D&65535)<<16)&4294967295}return g^=l.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}),ms.exports),o=(Xx||(Xx=1,ul.exports=function(l,u){for(var p,h=l.length,g=u^h,x=0;h>=4;)p=1540483477*(65535&(p=255&l.charCodeAt(x)|(255&l.charCodeAt(++x))<<8|(255&l.charCodeAt(++x))<<16|(255&l.charCodeAt(++x))<<24))+((1540483477*(p>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),h-=4,++x;switch(h){case 3:g^=(255&l.charCodeAt(x+2))<<16;case 2:g^=(255&l.charCodeAt(x+1))<<8;case 1:g=1540483477*(65535&(g^=255&l.charCodeAt(x)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}),ul.exports);return Ku.exports=d,Ku.exports.murmur3=d,Ku.exports.murmur2=o,Ku.exports}(),gs=y(rd);class Xa{constructor(o,...l){Io(this,l[0]||{}),this.type=o}}class Qu extends Xa{constructor(o,l={}){super("error",Io({error:o},l))}}function Gy(d,o,l){l[d]&&l[d].indexOf(o)!==-1||(l[d]=l[d]||[],l[d].push(o))}function Wm(d,o,l){if(l&&l[d]){let u=l[d].indexOf(o);u!==-1&&l[d].splice(u,1)}}class hl{on(o,l){return this._listeners=this._listeners||{},Gy(o,l,this._listeners),this}off(o,l){return Wm(o,l,this._listeners),Wm(o,l,this._oneTimeListeners),this}once(o,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},Gy(o,l,this._oneTimeListeners),this):new Promise(u=>{this.once(o,u)})}fire(o,l){let u=typeof o=="string"?new Xa(o,l):o,p=u.type;if(this.listens(p)){u.target=this;let h=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(let C of h)C.call(this,u);let g=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(let C of g)Wm(p,C,this._oneTimeListeners),C.call(this,u);let x=this._eventedParent;x&&(Io(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(u))}else u instanceof Qu&&console.error(u.error);return this}listens(o){return!!(this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o))}setEventedParent(o,l){return this._eventedParent=o,this._eventedParentData=l,this}}class ja{constructor(o){typeof o=="string"?this.name=o:(this.name=o.name,this.iconsetId=o.iconsetId)}static from(o){return new ja(o)}static toString(o){return o.iconsetId?`${o.name}${o.iconsetId}`:o.name}static parse(o){let[l,u]=o.split("");return new ja({name:l,iconsetId:u})}static isEqual(o,l){return o.name===l.name&&o.iconsetId===l.iconsetId}toString(){return ja.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var Kx,qy={},Ns=function(){if(Kx)return qy;Kx=1;var d={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function o(h){return(h=Math.round(h))<0?0:h>255?255:h}function l(h){return o(h[h.length-1]==="%"?parseFloat(h)/100*255:parseInt(h))}function u(h){return(g=h[h.length-1]==="%"?parseFloat(h)/100:parseFloat(h))<0?0:g>1?1:g;var g}function p(h,g,x){return x<0?x+=1:x>1&&(x-=1),6*x<1?h+(g-h)*x*6:2*x<1?g:3*x<2?h+(g-h)*(2/3-x)*6:h}try{qy.parseCSSColor=function(h){var g,x=h.replace(/ /g,"").toLowerCase();if(x in d)return d[x].slice();if(x[0]==="#")return x.length===4?(g=parseInt(x.substr(1),16))>=0&&g<=4095?[(3840&g)>>4|(3840&g)>>8,240&g|(240&g)>>4,15&g|(15&g)<<4,1]:null:x.length===7&&(g=parseInt(x.substr(1),16))>=0&&g<=16777215?[(16711680&g)>>16,(65280&g)>>8,255&g,1]:null;var C=x.indexOf("("),D=x.indexOf(")");if(C!==-1&&D+1===x.length){var v=x.substr(0,C),E=x.substr(C+1,D-(C+1)).split(","),T=1;switch(v){case"rgba":if(E.length!==4)return null;T=u(E.pop());case"rgb":return E.length!==3?null:[l(E[0]),l(E[1]),l(E[2]),T];case"hsla":if(E.length!==4)return null;T=u(E.pop());case"hsl":if(E.length!==3)return null;var S=(parseFloat(E[0])%360+360)%360/360,M=u(E[1]),R=u(E[2]),L=R<=.5?R*(M+1):R+M-R*M,N=2*R-L;return[o(255*p(N,L,S+1/3)),o(255*p(N,L,S)),o(255*p(N,L,S-1/3)),T];default:return null}}return null}}catch{}return qy}();class Ln{constructor(o,l,u,p=1){this.r=o,this.g=l,this.b=u,this.a=p}static parse(o){if(!o)return;if(o instanceof Ln)return o;if(typeof o!="string")return;let l=Ns.parseCSSColor(o);return l?new Ln(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3]):void 0}toStringPremultipliedAlpha(){let[o,l,u,p]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(o)},${Math.round(l)},${Math.round(u)},${p})`}toString(){let[o,l,u,p]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*o)},${Math.round(255*l)},${Math.round(255*u)},${p})`}toRenderColor(o){let{r:l,g:u,b:p,a:h}=this;return new Wy(o,l,u,p,h)}clone(){return new Ln(this.r,this.g,this.b,this.a)}}class Wy{constructor(o,l,u,p,h){if(o){let g=o.image.height,x=g*g;l=h===0?0:l/h*(g-1),u=h===0?0:u/h*(g-1),p=h===0?0:p/h*(g-1);let C=Math.floor(l),D=Math.floor(u),v=Math.floor(p),E=Math.ceil(l),T=Math.ceil(u),S=Math.ceil(p),M=l-C,R=u-D,L=p-v,N=o.image.data,$=4*(C+D*x+v*g),H=4*(C+D*x+S*g),j=4*(C+T*x+v*g),q=4*(C+T*x+S*g),Y=4*(E+D*x+v*g),Q=4*(E+D*x+S*g),pe=4*(E+T*x+v*g),de=4*(E+T*x+S*g);if($<0||de>=N.length)throw new Error("out of range");this.r=yi(yi(yi(N[$],N[H],L),yi(N[j],N[q],L),R),yi(yi(N[Y],N[Q],L),yi(N[pe],N[de],L),R),M)/255*h,this.g=yi(yi(yi(N[$+1],N[H+1],L),yi(N[j+1],N[q+1],L),R),yi(yi(N[Y+1],N[Q+1],L),yi(N[pe+1],N[de+1],L),R),M)/255*h,this.b=yi(yi(yi(N[$+2],N[H+2],L),yi(N[j+2],N[q+2],L),R),yi(yi(N[Y+2],N[Q+2],L),yi(N[pe+2],N[de+2],L),R),M)/255*h,this.a=h}else this.r=l,this.g=u,this.b=p,this.a=h}toArray(){let{r:o,g:l,b:u,a:p}=this;return p===0?[0,0,0,0]:[255*o/p,255*l/p,255*u/p,p]}toHslaArray(){if(this.a===0)return[0,0,0,0];let{r:o,g:l,b:u,a:p}=this,h=Math.min(Math.max(o/p,0),1),g=Math.min(Math.max(l/p,0),1),x=Math.min(Math.max(u/p,0),1),C=Math.min(h,g,x),D=Math.max(h,g,x),v=(C+D)/2;if(C===D)return[0,0,100*v,p];let E=D-C,T=v>.5?E/(2-D-C):E/(D+C),S=0;return D===h?S=(g-x)/E+(g<x?6:0):D===g?S=(x-h)/E+2:D===x&&(S=(h-g)/E+4),S*=60,[Math.min(Math.max(S,0),360),Math.min(Math.max(100*T,0),100),Math.min(Math.max(100*v,0),100),p]}toArray01(){let{r:o,g:l,b:u,a:p}=this;return p===0?[0,0,0,0]:[o/p,l/p,u/p,p]}toArray01Scaled(o){let{r:l,g:u,b:p,a:h}=this;return h===0?[0,0,0]:[l/h*o,u/h*o,p/h*o]}toArray01PremultipliedAlpha(){let{r:o,g:l,b:u,a:p}=this;return[o,l,u,p]}toArray01Linear(){let{r:o,g:l,b:u,a:p}=this;return p===0?[0,0,0,0]:[Math.pow(o/p,2.2),Math.pow(l/p,2.2),Math.pow(u/p,2.2),p]}}function yi(d,o,l){return d*(1-l)+o*l}function Qx(d,o,l){return d.map((u,p)=>yi(u,o[p],l))}function Jx(d){return d*d*d*d*d}Ln.black=new Ln(0,0,0,1),Ln.white=new Ln(1,1,1,1),Ln.transparent=new Ln(0,0,0,0),Ln.red=new Ln(1,0,0,1),Ln.blue=new Ln(0,0,1,1);var Qp=Object.freeze({__proto__:null,array:Qx,color:function(d,o,l){return new Ln(yi(d.r,o.r,l),yi(d.g,o.g,l),yi(d.b,o.b,l),yi(d.a,o.a,l))},easeIn:Jx,number:yi});function wn(d,...o){for(let l of o)for(let u in l)d[u]=l[u];return d}class zs extends Error{constructor(o,l){super(l),this.message=l,this.key=o}}class Ym{constructor(o,l=[]){this.parent=o,this.bindings={};for(let[u,p]of l)this.bindings[u]=p}concat(o){return new Ym(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}let Ju={kind:"null"},ii={kind:"number"},Rn={kind:"string"},gn={kind:"boolean"},ya={kind:"color"},eh={kind:"object"},Cn={kind:"value"},uc={kind:"collator"},Jp={kind:"formatted"},hc={kind:"resolvedImage"};function Qo(d,o){return{kind:"array",itemType:d,N:o}}function Lr(d){if(d.kind==="array"){let o=Lr(d.itemType);return typeof d.N=="number"?`array<${o}, ${d.N}>`:d.itemType.kind==="value"?"array":`array<${o}>`}return d.kind}let pl=[Ju,ii,Rn,gn,ya,Jp,eh,Qo(Cn),hc];function th(d,o){if(o.kind==="error")return null;if(d.kind==="array"){if(o.kind==="array"&&(o.N===0&&o.itemType.kind==="value"||!th(d.itemType,o.itemType))&&(typeof d.N!="number"||d.N===o.N))return null}else{if(d.kind===o.kind)return null;if(d.kind==="value"){for(let l of pl)if(!th(l,o))return null}}return`Expected ${Lr(d)} but found ${Lr(o)} instead.`}function Yy(d,o){return o.some(l=>l.kind===d.kind)}function ih(d,o){return o.some(l=>l==="null"?d===null:l==="array"?Array.isArray(d):l==="object"?d&&!Array.isArray(d)&&typeof d=="object":l===typeof d)}class Zm{constructor(o,l,u){this.sensitivity=o?l?"variant":"case":l?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,l){return this.collator.compare(o,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ef{constructor(o,l,u,p,h){this.text=o.normalize?o.normalize():o,this.image=l,this.scale=u,this.fontStack=p,this.textColor=h}}class va{constructor(o){this.sections=o}static fromString(o){return new va([new ef(o,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(o=>o.text.length!==0||!!o.image&&o.image.hasPrimary())}static factory(o){return o instanceof va?o:va.fromString(o)}toString(){return this.sections.length===0?"":this.sections.map(o=>o.text).join("")}serialize(){let o=["format"];for(let l of this.sections){if(l.image){let p=l.image.getPrimary().id.toString();o.push(["image",p]);continue}o.push(l.text);let u={};l.fontStack&&(u["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(u["font-scale"]=l.scale),l.textColor&&(u["text-color"]=["rgba"].concat(l.textColor.toRenderColor(null).toArray())),o.push(u)}return o}}class Pl{constructor(o,l={}){if(this.id=ja.from(o),this.options=Object.assign({},l),l.transform){let{a:u,b:p,c:h,d:g,e:x,f:C}=l.transform;this.options.transform=new DOMMatrix([u,p,h,g,x,C])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){let{a:o,b:l,c:u,d:p,e:h,f:g}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:o,b:l,c:u,d:p,e:h,f:g}})}static parse(o){let l,u,p,h;try{({name:l,iconsetId:u,params:p,transform:h}=JSON.parse(o)||{})}catch{return null}if(!l)return null;let{a:g,b:x,c:C,d:D,e:v,f:E}=h||{};return new Pl({name:l,iconsetId:u},{params:p,transform:new DOMMatrix([g,x,C,D,v,E])})}scaleSelf(o){return this.options.transform.scaleSelf(o),this}}class ba{constructor(o,l,u,p,h=!1){this.primaryId=ja.from(o),this.primaryOptions=l,u&&(this.secondaryId=ja.from(u)),this.secondaryOptions=p,this.available=h}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new Pl(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new Pl(this.secondaryId,this.secondaryOptions):null}static from(o){return typeof o=="string"?ba.build({name:o}):o}static build(o,l,u,p){return!o||typeof o=="object"&&!("name"in o)?null:new ba(o,u,l,p)}}function tf(d,o,l,u){return typeof d=="number"&&d>=0&&d<=255&&typeof o=="number"&&o>=0&&o<=255&&typeof l=="number"&&l>=0&&l<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[d,o,l,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[d,o,l,u]:[d,o,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function fl(d){if(d===null||typeof d=="string"||typeof d=="boolean"||typeof d=="number"||d instanceof Ln||d instanceof Zm||d instanceof va||d instanceof ba)return!0;if(Array.isArray(d)){for(let o of d)if(!fl(o))return!1;return!0}if(typeof d=="object"){for(let o in d)if(!fl(d[o]))return!1;return!0}return!1}function oo(d){if(d===null)return Ju;if(typeof d=="string")return Rn;if(typeof d=="boolean")return gn;if(typeof d=="number")return ii;if(d instanceof Ln)return ya;if(d instanceof Zm)return uc;if(d instanceof va)return Jp;if(d instanceof ba)return hc;if(Array.isArray(d)){let o=d.length,l;for(let u of d){let p=oo(u);if(l){if(l===p)continue;l=Cn;break}l=p}return Qo(l||Cn,o)}return eh}function ko(d){let o=typeof d;return d===null?"":o==="string"||o==="number"||o==="boolean"?String(d):d instanceof Ln?d.toStringPremultipliedAlpha():d instanceof va||d instanceof ba?d.toString():JSON.stringify(d)}class pc{constructor(o,l){this.type=o,this.value=l}static parse(o,l){if(o.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!fl(o[1]))return l.error("invalid value");let u=o[1],p=oo(u),h=l.expectedType;return p.kind!=="array"||p.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(p=h),new pc(p,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Ln?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof va?this.value.serialize():this.value}}class Hr{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}}let Zy={string:Rn,number:ii,boolean:gn,object:eh};class _s{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");let u,p=1,h=o[0];if(h==="array"){let x,C;if(o.length>2){let D=o[1];if(typeof D!="string"||!(D in Zy)||D==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);x=Zy[D],p++}else x=Cn;if(o.length>3){if(o[2]!==null&&(typeof o[2]!="number"||o[2]<0||o[2]!==Math.floor(o[2])))return l.error('The length argument to "array" must be a positive integer literal',2);C=o[2],p++}u=Qo(x,C)}else u=Zy[h];let g=[];for(;p<o.length;p++){let x=l.parse(o[p],p,Cn);if(!x)return null;g.push(x)}return new _s(u,g)}evaluate(o){for(let l=0;l<this.args.length;l++){let u=this.args[l].evaluate(o);if(!th(this.type,oo(u)))return u;if(l===this.args.length-1)throw new Hr(`The expression ${JSON.stringify(this.args[l].serialize())} evaluated to ${Lr(oo(u))} but was expected to be of type ${Lr(this.type)}.`)}return null}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){let o=this.type,l=[o.kind];if(o.kind==="array"){let u=o.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){l.push(u.kind);let p=o.N;(typeof p=="number"||this.args.length>1)&&l.push(p)}}return l.concat(this.args.map(u=>u.serialize()))}}class nh{constructor(o){this.type=Jp,this.sections=o}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");let u=o[1];if(!Array.isArray(u)&&typeof u=="object")return l.error("First argument must be an image or text section.");let p=[],h=!1;for(let g=1;g<=o.length-1;++g){let x=o[g];if(h&&typeof x=="object"&&!Array.isArray(x)){h=!1;let C=null;if(x["font-scale"]&&(C=l.parseObjectValue(x["font-scale"],g,"font-scale",ii),!C))return null;let D=null;if(x["text-font"]&&(D=l.parseObjectValue(x["text-font"],g,"text-font",Qo(Rn)),!D))return null;let v=null;if(x["text-color"]&&(v=l.parseObjectValue(x["text-color"],g,"text-color",ya),!v))return null;let E=p[p.length-1];E.scale=C,E.font=D,E.textColor=v}else{let C=l.parse(o[g],g,Cn);if(!C)return null;let D=C.type.kind;if(D!=="string"&&D!=="value"&&D!=="null"&&D!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,p.push({content:C,scale:null,font:null,textColor:null})}}return new nh(p)}evaluate(o){return new va(this.sections.map(l=>{let u=l.content.evaluate(o);return oo(u)===hc?new ef("",u,null,null,null):new ef(ko(u),null,l.scale?l.scale.evaluate(o):null,l.font?l.font.evaluate(o).join(","):null,l.textColor?l.textColor.evaluate(o):null)}))}eachChild(o){for(let l of this.sections)o(l.content),l.scale&&o(l.scale),l.font&&o(l.font),l.textColor&&o(l.textColor)}outputDefined(){return!1}serialize(){let o=["format"];for(let l of this.sections){o.push(l.content.serialize());let u={};l.scale&&(u["font-scale"]=l.scale.serialize()),l.font&&(u["text-font"]=l.font.serialize()),l.textColor&&(u["text-color"]=l.textColor.serialize()),o.push(u)}return o}}class od{constructor(o,l,u,p){this._imageWarnHistory={},this.type=hc,this.namePrimary=o,this.nameSecondary=l,u&&(this.paramsPrimary=u.params,this.iconsetIdPrimary=u.iconset?u.iconset.id:void 0),p&&(this.paramsSecondary=p.params,this.iconsetIdSecondary=p.iconset?p.iconset.id:void 0)}static parse(o,l){if(o.length<2)return l.error("Expected two or more arguments.");let u=1,p=[];function h(){if(u<o.length){let x=l.parse(o[u],u++,Rn);return x?(p.push({image:x,options:{}}),!0):(l.error(p.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function g(){if(u<o.length){let C=o[u];if((x=C)===null||typeof x!="object"||Array.isArray(x))return!0;let D=C.params,v=C.iconset,E=l.concat(u);if(!D&&!v)return u++,!0;if(D){if(typeof D!="object"||D.constructor!==Object)return E.error('Image options "params" should be an object'),!1;let T={},S=E.concat(void 0,"params");for(let M in D){if(!M)return S.error("Image parameter name should be non-empty"),!1;let R=S.concat(void 0,M).parse(D[M],void 0,ya,void 0,{typeAnnotation:"coerce"});if(!R)return!1;T[M]=R}p[p.length-1].options.params=T}if(v){if(typeof v!="object"||v.constructor!==Object)return E.error('Image options "iconset" should be an object'),!1;if(!v.id)return E.error('Image options "iconset" should have an "id" property'),!1;p[p.length-1].options.iconset=v}return u++,!0}var x;return!0}for(let x=0;x<2;x++)if(!h()||!g())return;return new od(p[0].image,p[1]?p[1].image:void 0,p[0].options,p[1]?p[1].options:void 0)}evaluateParams(o,l){let u={};if(l){for(let p in l)if(l[p])try{u[p]=l[p].evaluate(o)}catch{continue}if(Object.keys(u).length!==0)return{params:u}}}evaluate(o){let l={name:this.namePrimary.evaluate(o),iconsetId:this.iconsetIdPrimary},u=this.nameSecondary?{name:this.nameSecondary.evaluate(o),iconsetId:this.iconsetIdSecondary}:void 0,p=ba.build(l,u,this.paramsPrimary?this.evaluateParams(o,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(o,this.paramsSecondary):void 0);if(p&&o.availableImages){let h=p.getPrimary().id;if(p.available=o.availableImages.some(g=>ja.isEqual(g,h)),p.available){let g=p.getSecondary()?p.getSecondary().id:null;g&&(p.available=o.availableImages.some(x=>ja.isEqual(x,g)))}}return p}eachChild(o){if(o(this.namePrimary),this.paramsPrimary)for(let l in this.paramsPrimary)this.paramsPrimary[l]&&o(this.paramsPrimary[l]);if(this.nameSecondary&&(o(this.nameSecondary),this.paramsSecondary))for(let l in this.paramsSecondary)this.paramsSecondary[l]&&o(this.paramsSecondary[l])}outputDefined(){return!1}serializeOptions(o,l){let u={};if(l&&(u.iconset={id:l}),o){u.params={};for(let p in o)o[p]&&(u.params[p]=o[p].serialize())}return Object.keys(u).length>0?u:void 0}serialize(){let o=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){let l=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);l&&o.push(l)}if(this.nameSecondary&&(o.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){let l=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);l&&o.push(l)}return o}}function fc(d){return d instanceof Number?"number":d instanceof String?"string":d instanceof Boolean?"boolean":Array.isArray(d)?"array":d===null?"null":typeof d}let yM={"to-boolean":gn,"to-color":ya,"to-number":ii,"to-string":Rn};class mc{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");let u=o[0],p=[],h=Ju;if(u==="to-array"){if(!Array.isArray(o[1]))return null;let g=o[1].length;if(l.expectedType){if(l.expectedType.kind!=="array")return l.error(`Expected ${l.expectedType.kind} but found array.`);h=Qo(l.expectedType.itemType,g)}else{if(!(g>0&&fl(o[1][0])))return null;h=Qo(oo(o[1][0]),g)}for(let x=0;x<g;x++){let C=o[1][x],D;if(fc(C)==="array")D=l.parse(C,void 0,h.itemType);else{let v=fc(C);if(v!==h.itemType.kind)return l.error(`Expected ${h.itemType.kind} but found ${v}.`);D=l.registry.literal.parse(["literal",C===void 0?null:C],l)}if(!D)return null;p.push(D)}}else{if((u==="to-boolean"||u==="to-string")&&o.length!==2)return l.error("Expected one argument.");h=yM[u];for(let g=1;g<o.length;g++){let x=l.parse(o[g],g,Cn);if(!x)return null;p.push(x)}}return new mc(h,p)}evaluate(o){if(this.type.kind==="boolean")return!!this.args[0].evaluate(o);if(this.type.kind==="color"){let l,u;for(let p of this.args){if(l=p.evaluate(o),u=null,l instanceof Ln)return l;if(typeof l=="string"){let h=o.parseColor(l);if(h)return h}else if(Array.isArray(l)&&(u=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:tf(l[0],l[1],l[2],l[3]),!u))return new Ln(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Hr(u||`Could not parse color from value '${typeof l=="string"?l:String(JSON.stringify(l))}'`)}if(this.type.kind==="number"){let l=null;for(let u of this.args){if(l=u.evaluate(o),l===null)return 0;let p=Number(l);if(!isNaN(p))return p}throw new Hr(`Could not convert ${JSON.stringify(l)} to number.`)}return this.type.kind==="formatted"?va.fromString(ko(this.args[0].evaluate(o))):this.type.kind==="resolvedImage"?ba.build(ko(this.args[0].evaluate(o))):this.type.kind==="array"?this.args.map(l=>l.evaluate(o)):ko(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){if(this.type.kind==="formatted")return new nh([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new od(this.args[0]).serialize();let o=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(l=>{o.push(l.serialize())}),o}}let vM=["Unknown","Point","LineString","Polygon"];class Xm{constructor(o,l){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=o,this.options=l}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?vM[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(o){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){let o=this.featureDistanceData.center,l=this.featureDistanceData.scale,{x:u,y:p}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*l-o[0])+this.featureDistanceData.bearing[1]*(p*l-o[1])}return 0}parseColor(o){let l=this._parseColorCache[o];return l||(l=this._parseColorCache[o]=Ln.parse(o)),l}getConfig(o){return this.options?this.options.get(o):null}}class La{constructor(o,l,u,p,h){this.name=o,this.type=l,this._evaluate=u,this.args=p,this._overloadIndex=h}evaluate(o){if(!this._evaluate){let l=La.definitions[this.name];this._evaluate=Array.isArray(l)?l[2]:l.overloads[this._overloadIndex][1]}return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(o=>o.serialize()))}static parse(o,l){let u=o[0],p=La.definitions[u];if(!p)return l.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);let h=Array.isArray(p)?p[0]:p.type,g=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,x=[],C=null,D=-1;for(let[v,E]of g){if(Array.isArray(v)&&v.length!==o.length-1)continue;x.push(v),D++,C=new iv(l.registry,l.path,null,l.scope,void 0,l._scope,l.options);let T=[],S=!1;for(let M=1;M<o.length;M++){let R=o[M],L=Array.isArray(v)?v[M-1]:v.type,N=C.parse(R,1+T.length,L);if(!N){S=!0;break}T.push(N)}if(!S)if(Array.isArray(v)&&v.length!==T.length)C.error(`Expected ${v.length} arguments, but found ${T.length} instead.`);else{for(let M=0;M<T.length;M++){let R=Array.isArray(v)?v[M]:v.type,L=T[M];C.concat(M+1).checkSubtype(R,L.type)}if(C.errors.length===0)return new La(u,h,E,T,D)}}if(x.length===1)l.errors.push(...C.errors);else{let v=(x.length?x:g.map(([T])=>T)).map(bM).join(" | "),E=[];for(let T=1;T<o.length;T++){let S=l.parse(o[T],1+E.length);if(!S)return null;E.push(Lr(S.type))}l.error(`Expected arguments of type ${v}, but found (${E.join(", ")}) instead.`)}return null}static register(o,l){La.definitions=l;for(let u in l)o[u]=La}}function bM(d){return Array.isArray(d)?`(${d.map(Lr).join(", ")})`:`(${Lr(d.type)}...)`}class Jd{constructor(o,l,u){this.type=uc,this.locale=u,this.caseSensitive=o,this.diacriticSensitive=l}static parse(o,l){if(o.length!==2)return l.error("Expected one argument.");let u=o[1];if(typeof u!="object"||Array.isArray(u))return l.error("Collator options argument must be an object.");let p=u["case-sensitive"]===void 0?l.parse(!1,1,gn):l.parseObjectValue(u["case-sensitive"],1,"case-sensitive",gn);if(!p)return null;let h=u["diacritic-sensitive"]===void 0?l.parse(!1,1,gn):l.parseObjectValue(u["diacritic-sensitive"],1,"diacritic-sensitive",gn);if(!h)return null;let g=null;return u.locale&&(g=l.parseObjectValue(u.locale,1,"locale",Rn),!g)?null:new Jd(p,h,g)}evaluate(o){return new Zm(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}serialize(){let o={};return o["case-sensitive"]=this.caseSensitive.serialize(),o["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(o.locale=this.locale.serialize()),["collator",o]}}function ew(d,o,l=0,u=d.length-1,p=xM){for(;u>l;){if(u-l>600){let C=u-l+1,D=o-l+1,v=Math.log(C),E=.5*Math.exp(2*v/3),T=.5*Math.sqrt(v*E*(C-E)/C)*(D-C/2<0?-1:1);ew(d,o,Math.max(l,Math.floor(o-D*E/C+T)),Math.min(u,Math.floor(o+(C-D)*E/C+T)),p)}let h=d[o],g=l,x=u;for(nf(d,l,o),p(d[u],h)>0&&nf(d,l,u);g<x;){for(nf(d,g,x),g++,x--;p(d[g],h)<0;)g++;for(;p(d[x],h)>0;)x--}p(d[l],h)===0?nf(d,l,x):(x++,nf(d,x,u)),x<=o&&(l=x+1),o<=x&&(u=x-1)}}function nf(d,o,l){let u=d[o];d[o]=d[l],d[l]=u}function xM(d,o){return d<o?-1:d>o?1:0}function wM(d){let o=0;for(let l,u,p=0,h=d.length,g=h-1;p<h;g=p++)l=d[p],u=d[g],o+=(u.x-l.x)*(l.y+u.y);return o}function rf(d,o){d[0]=Math.min(d[0],o[0]),d[1]=Math.min(d[1],o[1]),d[2]=Math.max(d[2],o[0]),d[3]=Math.max(d[3],o[1])}function of(d,o){return!(d[0]<=o[0]||d[2]>=o[2]||d[1]<=o[1]||d[3]>=o[3])}function CM(d,o,l){let u=d[0]-o[0],p=d[1]-o[1],h=d[0]-l[0],g=d[1]-l[1];return u*g-h*p==0&&u*h<=0&&p*g<=0}function eu(d,o,l=!1){let u=!1;for(let x=0,C=o.length;x<C;x++){let D=o[x];for(let v=0,E=D.length,T=E-1;v<E;T=v++){let S=D[T],M=D[v];if(CM(d,S,M))return l;(h=S)[1]>(p=d)[1]!=(g=M)[1]>p[1]&&p[0]<(g[0]-h[0])*(p[1]-h[1])/(g[1]-h[1])+h[0]&&(u=!u)}}var p,h,g;return u}function tu(d,o,l,u){let p=u[0]-l[0],h=u[1]-l[1],g=(d[0]-l[0])*h-p*(d[1]-l[1]),x=(o[0]-l[0])*h-p*(o[1]-l[1]);return g>0&&x<0||g<0&&x>0}function Km(d,o,l,u){return(p=[u[0]-l[0],u[1]-l[1]])[0]*(h=[o[0]-d[0],o[1]-d[1]])[1]-p[1]*h[0]!=0&&!(!tu(d,o,l,u)||!tu(l,u,d,o));var p,h}let ad=8192;function Xy(d,o){let l=(180+d[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d[1]*Math.PI/360)))/360,p=Math.pow(2,o.z);return[Math.round(l*p*ad),Math.round(u*p*ad)]}function EM(d,o){for(let l=0;l<o.length;l++)if(eu(d,o[l]))return!0;return!1}function SM(d,o,l){for(let u of l)for(let p=0,h=u.length,g=h-1;p<h;g=p++)if(Km(d,o,u[g],u[p]))return!0;return!1}function tw(d,o){for(let l=0;l<d.length;++l)if(!eu(d[l],o))return!1;for(let l=0;l<d.length-1;++l)if(SM(d[l],d[l+1],o))return!1;return!0}function DM(d,o){for(let l=0;l<o.length;l++)if(tw(d,o[l]))return!0;return!1}function sd(d,o,l){let u=[];for(let p=0;p<d.length;p++){let h=[];for(let g=0;g<d[p].length;g++){let x=Xy(d[p][g],l);rf(o,x),h.push(x)}u.push(h)}return u}function Ji(d,o,l){let u=[];for(let p=0;p<d.length;p++){let h=sd(d[p],o,l);u.push(h)}return u}function ci(d,o,l,u){if(d[0]<l[0]||d[0]>l[2]){let p=.5*u,h=d[0]-l[0]>p?-u:l[0]-d[0]>p?u:0;h===0&&(h=d[0]-l[2]>p?-u:l[2]-d[0]>p?u:0),d[0]+=h}rf(o,d)}function Qm(d,o,l,u){let p=Math.pow(2,u.z)*ad,h=[u.x*ad,u.y*ad],g=[];if(!d)return g;for(let x of d)for(let C of x){let D=[C.x+h[0],C.y+h[1]];ci(D,o,l,p),g.push(D)}return g}function Oi(d,o,l,u){let p=Math.pow(2,u.z)*ad,h=[u.x*ad,u.y*ad],g=[];if(!d)return g;for(let C of d){let D=[];for(let v of C){let E=[v.x+h[0],v.y+h[1]];rf(o,E),D.push(E)}g.push(D)}if(o[2]-o[0]<=p/2){(x=o)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(let C of g)for(let D of C)ci(D,o,l,p)}var x;return g}class gc{constructor(o,l){this.type=gn,this.geojson=o,this.geometries=l}static parse(o,l){if(o.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(fl(o[1])){let u=o[1];if(u.type==="FeatureCollection")for(let p=0;p<u.features.length;++p){let h=u.features[p].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new gc(u,u.features[p].geometry)}else if(u.type==="Feature"){let p=u.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new gc(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new gc(u,u)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(o.geometry()!=null&&o.canonicalID()!=null){if(o.geometryType()==="Point")return function(l,u){let p=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],g=l.canonicalID();if(!g)return!1;if(u.type==="Polygon"){let x=sd(u.coordinates,h,g),C=Qm(l.geometry(),p,h,g);if(!of(p,h))return!1;for(let D of C)if(!eu(D,x))return!1}if(u.type==="MultiPolygon"){let x=Ji(u.coordinates,h,g),C=Qm(l.geometry(),p,h,g);if(!of(p,h))return!1;for(let D of C)if(!EM(D,x))return!1}return!0}(o,this.geometries);if(o.geometryType()==="LineString")return function(l,u){let p=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],g=l.canonicalID();if(!g)return!1;if(u.type==="Polygon"){let x=sd(u.coordinates,h,g),C=Oi(l.geometry(),p,h,g);if(!of(p,h))return!1;for(let D of C)if(!tw(D,x))return!1}if(u.type==="MultiPolygon"){let x=Ji(u.coordinates,h,g),C=Oi(l.geometry(),p,h,g);if(!of(p,h))return!1;for(let D of C)if(!DM(D,x))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}let rh={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Ti=1/298.257223563,Ky=Ti*(2-Ti),iu=Math.PI/180;class oh{static fromTile(o,l,u){let p=Math.PI*(1-2*(o+.5)/Math.pow(2,l)),h=Math.atan(.5*(Math.exp(p)-Math.exp(-p)))/iu;return new oh(h,u)}static get units(){return rh}constructor(o,l){if(o===void 0)throw new Error("No latitude given.");if(l&&!rh[l])throw new Error(`Unknown unit ${l}. Use one of: ${Object.keys(rh).join(", ")}`);let u=6378.137*iu*(l?rh[l]:1),p=Math.cos(o*iu),h=1/(1-Ky*(1-p*p)),g=Math.sqrt(h);this.kx=u*g*p,this.ky=u*g*h*(1-Ky)}distance(o,l){let u=Or(o[0]-l[0])*this.kx,p=(o[1]-l[1])*this.ky;return Math.sqrt(u*u+p*p)}bearing(o,l){let u=Or(l[0]-o[0])*this.kx;return Math.atan2(u,(l[1]-o[1])*this.ky)/iu}destination(o,l,u){let p=u*iu;return this.offset(o,Math.sin(p)*l,Math.cos(p)*l)}offset(o,l,u){return[o[0]+l/this.kx,o[1]+u/this.ky]}lineDistance(o){let l=0;for(let u=0;u<o.length-1;u++)l+=this.distance(o[u],o[u+1]);return l}area(o){let l=0;for(let u=0;u<o.length;u++){let p=o[u];for(let h=0,g=p.length,x=g-1;h<g;x=h++)l+=Or(p[h][0]-p[x][0])*(p[h][1]+p[x][1])*(u?-1:1)}return Math.abs(l)/2*this.kx*this.ky}along(o,l){let u=0;if(l<=0)return o[0];for(let p=0;p<o.length-1;p++){let h=o[p],g=o[p+1],x=this.distance(h,g);if(u+=x,u>l)return ah(h,g,(l-(u-x))/x)}return o[o.length-1]}pointToSegmentDistance(o,l,u){let[p,h]=l,g=Or(u[0]-p)*this.kx,x=(u[1]-h)*this.ky;if(g!==0||x!==0){let C=(Or(o[0]-p)*this.kx*g+(o[1]-h)*this.ky*x)/(g*g+x*x);C>1?(p=u[0],h=u[1]):C>0&&(p+=g/this.kx*C,h+=x/this.ky*C)}return g=Or(o[0]-p)*this.kx,x=(o[1]-h)*this.ky,Math.sqrt(g*g+x*x)}pointOnLine(o,l){let u=1/0,p=o[0][0],h=o[0][1],g=0,x=0;for(let C=0;C<o.length-1;C++){let D=o[C][0],v=o[C][1],E=Or(o[C+1][0]-D)*this.kx,T=(o[C+1][1]-v)*this.ky,S=0;E===0&&T===0||(S=(Or(l[0]-D)*this.kx*E+(l[1]-v)*this.ky*T)/(E*E+T*T),S>1?(D=o[C+1][0],v=o[C+1][1]):S>0&&(D+=E/this.kx*S,v+=T/this.ky*S)),E=Or(l[0]-D)*this.kx,T=(l[1]-v)*this.ky;let M=E*E+T*T;M<u&&(u=M,p=D,h=v,g=C,x=S)}return{point:[p,h],index:g,t:Math.max(0,Math.min(1,x))}}lineSlice(o,l,u){let p=this.pointOnLine(u,o),h=this.pointOnLine(u,l);if(p.index>h.index||p.index===h.index&&p.t>h.t){let D=p;p=h,h=D}let g=[p.point],x=p.index+1,C=h.index;!Qy(u[x],g[0])&&x<=C&&g.push(u[x]);for(let D=x+1;D<=C;D++)g.push(u[D]);return Qy(u[C],h.point)||g.push(h.point),g}lineSliceAlong(o,l,u){let p=0,h=[];for(let g=0;g<u.length-1;g++){let x=u[g],C=u[g+1],D=this.distance(x,C);if(p+=D,p>o&&h.length===0&&h.push(ah(x,C,(o-(p-D))/D)),p>=l)return h.push(ah(x,C,(l-(p-D))/D)),h;p>o&&h.push(C)}return h}bufferPoint(o,l){let u=l/this.ky,p=l/this.kx;return[o[0]-p,o[1]-u,o[0]+p,o[1]+u]}bufferBBox(o,l){let u=l/this.ky,p=l/this.kx;return[o[0]-p,o[1]-u,o[2]+p,o[3]+u]}insideBBox(o,l){return Or(o[0]-l[0])>=0&&Or(o[0]-l[2])<=0&&o[1]>=l[1]&&o[1]<=l[3]}}function Qy(d,o){return d[0]===o[0]&&d[1]===o[1]}function ah(d,o,l){let u=Or(o[0]-d[0]);return[d[0]+u*l,d[1]+(o[1]-d[1])*l]}function Or(d){for(;d<-180;)d+=360;for(;d>180;)d-=360;return d}class af{constructor(o=[],l=(u,p)=>u<p?-1:u>p?1:0){if(this.data=o,this.length=this.data.length,this.compare=l,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(o){this.data.push(o),this._up(this.length++)}pop(){if(this.length===0)return;let o=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),o}peek(){return this.data[0]}_up(o){let{data:l,compare:u}=this,p=l[o];for(;o>0;){let h=o-1>>1,g=l[h];if(u(p,g)>=0)break;l[o]=g,o=h}l[o]=p}_down(o){let{data:l,compare:u}=this,p=this.length>>1,h=l[o];for(;o<p;){let g=1+(o<<1),x=g+1;if(x<this.length&&u(l[x],l[g])<0&&(g=x),u(l[g],h)>=0)break;l[o]=l[g],o=g}l[o]=h}}var kt=8192;function Jm(d,o){return o.dist-d.dist}let _c=100,Jo=50;function iw(d){let o=[1/0,1/0,-1/0,-1/0];if(o.length!==d.length)return!1;for(let l=0;l<o.length;l++)if(o[l]!==d[l])return!1;return!0}function eg(d){return d[1]-d[0]+1}function yc(d,o){let l=d[1]>=d[0]&&d[1]<o;return l||console.warn("Distance Expression: Index is out of range"),l}function sh(d,o){if(d[0]>d[1])return[null,null];let l=eg(d);if(o){if(l===2)return[d,null];let u=Math.floor(l/2);return[[d[0],d[0]+u],[d[0]+u,d[1]]]}{if(l===1)return[d,null];let u=Math.floor(l/2)-1;return[[d[0],d[0]+u],[d[0]+u+1,d[1]]]}}function ld(d,o){let l=[1/0,1/0,-1/0,-1/0];if(!yc(o,d.length))return l;for(let u=o[0];u<=o[1];++u)rf(l,d[u]);return l}function lh(d){let o=[1/0,1/0,-1/0,-1/0];for(let l=0;l<d.length;++l)for(let u=0;u<d[l].length;++u)rf(o,d[l][u]);return o}function ch(d,o,l){if(iw(d)||iw(o))return NaN;let u=0,p=0;return d[2]<o[0]&&(u=o[0]-d[2]),d[0]>o[2]&&(u=d[0]-o[2]),d[1]>o[3]&&(p=d[1]-o[3]),d[3]<o[1]&&(p=o[1]-d[3]),l.distance([0,0],[u,p])}function MM(d){return 360*d-180}function TM(d){return 360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90}function Jy(d,o){let l=Math.pow(2,o.z),u=(d.y/kt+o.y)/l;return[MM((d.x/kt+o.x)/l),TM(u)]}function nw(d,o){let l=[];for(let u=0;u<d.length;++u)l.push(Jy(d[u],o));return l}function rw(d,o,l){let u=l.pointOnLine(o,d).point;return l.distance(d,u)}function ow(d,o,l,u,p){let h=l.slice(u[0],u[1]+1),g=1/0;for(let x=o[0];x<=o[1];++x)if((g=Math.min(g,rw(d[x],h,p)))===0)return 0;return g}function tg(d,o,l,u,p){let h=Math.min(p.pointToSegmentDistance(d,l,u),p.pointToSegmentDistance(o,l,u)),g=Math.min(p.pointToSegmentDistance(l,d,o),p.pointToSegmentDistance(u,d,o));return Math.min(h,g)}function IM(d,o,l,u,p){if(!yc(o,d.length)||!yc(u,l.length))return NaN;let h=1/0;for(let g=o[0];g<o[1];++g)for(let x=u[0];x<u[1];++x){if(Km(d[g],d[g+1],l[x],l[x+1]))return 0;h=Math.min(h,tg(d[g],d[g+1],l[x],l[x+1],p))}return h}function nu(d,o,l,u,p){if(!yc(o,d.length)||!yc(u,l.length))return NaN;let h=1/0;for(let g=o[0];g<=o[1];++g)for(let x=u[0];x<=u[1];++x)if((h=Math.min(h,p.distance(d[g],l[x])))===0)return h;return h}function AM(d,o,l){if(eu(d,o,!0))return 0;let u=1/0;for(let p of o){let h=p.length;if(h<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(p[0]!==p[h-1]&&(u=Math.min(u,l.pointToSegmentDistance(d,p[h-1],p[0])))===0||(u=Math.min(u,rw(d,p,l)))===0)return u}return u}function RM(d,o,l,u){if(!yc(o,d.length))return NaN;for(let h=o[0];h<=o[1];++h)if(eu(d[h],l,!0))return 0;let p=1/0;for(let h=o[0];h<o[1];++h)for(let g of l)for(let x=0,C=g.length,D=C-1;x<C;D=x++){if(Km(d[h],d[h+1],g[D],g[x]))return 0;p=Math.min(p,tg(d[h],d[h+1],g[D],g[x],u))}return p}function ig(d,o){for(let l of d)for(let u=0;u<=l.length-1;++u)if(eu(l[u],o,!0))return!0;return!1}function aw(d,o,l,u=1/0){let p=lh(d),h=lh(o);if(u!==1/0&&ch(p,h,l)>=u)return u;if(of(p,h)){if(ig(d,o))return 0}else if(ig(o,d))return 0;let g=u;for(let x of d)for(let C=0,D=x.length,v=D-1;C<D;v=C++)for(let E of o)for(let T=0,S=E.length,M=S-1;T<S;M=T++){if(Km(x[v],x[C],E[M],E[T]))return 0;g=Math.min(g,tg(x[v],x[C],E[M],E[T],l))}return g}function sf(d,o,l,u,p,h,g){if(h===null||g===null)return;let x=ch(ld(u,h),ld(p,g),l);x<o&&d.push({dist:x,range1:h,range2:g})}function ml(d,o,l,u,p=1/0){let h=Math.min(u.distance(d[0],l[0][0]),p);if(h===0)return h;let g=new af([{dist:0,range1:[0,d.length-1],range2:[0,0]}],Jm),x=o?Jo:_c,C=lh(l);for(;g.length;){let D=g.pop();if(D.dist>=h)continue;let v=D.range1;if(eg(v)<=x){if(!yc(v,d.length))return NaN;if(o){let E=RM(d,v,l,u);if((h=Math.min(h,E))===0)return h}else for(let E=v[0];E<=v[1];++E){let T=AM(d[E],l,u);if((h=Math.min(h,T))===0)return h}}else{let E=sh(v,o);if(E[0]!==null){let T=ch(ld(d,E[0]),C,u);T<h&&g.push({dist:T,range1:E[0],range2:[0,0]})}if(E[1]!==null){let T=ch(ld(d,E[1]),C,u);T<h&&g.push({dist:T,range1:E[1],range2:[0,0]})}}}return h}function ev(d,o,l,u,p,h=1/0){let g=Math.min(h,p.distance(d[0],l[0]));if(g===0)return g;let x=new af([{dist:0,range1:[0,d.length-1],range2:[0,l.length-1]}],Jm),C=o?Jo:_c,D=u?Jo:_c;for(;x.length;){let v=x.pop();if(v.dist>=g)continue;let E=v.range1,T=v.range2;if(eg(E)<=C&&eg(T)<=D){if(!yc(E,d.length)||!yc(T,l.length))return NaN;if(o&&u?g=Math.min(g,IM(d,E,l,T,p)):o||u?o&&!u?g=Math.min(g,ow(l,T,d,E,p)):!o&&u&&(g=Math.min(g,ow(d,E,l,T,p))):g=Math.min(g,nu(d,E,l,T,p)),g===0)return g}else{let S=sh(E,o),M=sh(T,u);sf(x,g,p,d,l,S[0],M[0]),sf(x,g,p,d,l,S[0],M[1]),sf(x,g,p,d,l,S[1],M[0]),sf(x,g,p,d,l,S[1],M[1])}}return g}function ng(d,o,l,u,p=1/0){let h=p,g=ld(d,[0,d.length-1]);for(let x of l)if(!(h!==1/0&&ch(g,ld(x,[0,x.length-1]),u)>=h)&&(h=Math.min(h,ev(d,o,x,!0,u,h)),h===0))return h;return h}function lf(d,o,l,u,p=1/0){let h=p,g=ld(d,[0,d.length-1]);for(let x of l){if(h!==1/0&&ch(g,lh(x),u)>=h)continue;let C=ml(d,o,x,u,h);if(isNaN(C))return C;if((h=Math.min(h,C))===0)return h}return h}function rg(d){return d==="Point"||d==="MultiPoint"||d==="LineString"||d==="MultiLineString"||d==="Polygon"||d==="MultiPolygon"}class cd{constructor(o,l){this.type=ii,this.geojson=o,this.geometries=l}static parse(o,l){if(o.length!==2)return l.error(`'distance' expression requires either one argument, but found ' ${o.length-1} instead.`);if(fl(o[1])){let u=o[1];if(u.type==="FeatureCollection"){for(let p=0;p<u.features.length;++p)if(rg(u.features[p].geometry.type))return new cd(u,u.features[p].geometry)}else if(u.type==="Feature"){if(rg(u.geometry.type))return new cd(u,u.geometry)}else if(rg(u.type))return new cd(u,u)}return l.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(o){let l=o.geometry(),u=o.canonicalID();if(l!=null&&u!=null){if(o.geometryType()==="Point")return function(p,h,g){let x=[];for(let D of p)for(let v of D)x.push(Jy(v,h));let C=new oh(x[0][1],"meters");return g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString"?ev(x,!1,g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",C):g.type==="MultiLineString"?ng(x,!1,g.coordinates,C):g.type==="Polygon"||g.type==="MultiPolygon"?lf(x,!1,g.type==="Polygon"?[g.coordinates]:g.coordinates,C):null}(l,u,this.geometries);if(o.geometryType()==="LineString")return function(p,h,g){let x=[];for(let D of p){let v=[];for(let E of D)v.push(Jy(E,h));x.push(v)}let C=new oh(x[0][0][1],"meters");if(g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString")return ng(g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",x,C);if(g.type==="MultiLineString"){let D=1/0;for(let v=0;v<g.coordinates.length;v++){let E=ng(g.coordinates[v],!0,x,C,D);if(isNaN(E))return E;if((D=Math.min(D,E))===0)return D}return D}if(g.type==="Polygon"||g.type==="MultiPolygon"){let D=1/0;for(let v=0;v<x.length;v++){let E=lf(x[v],!0,g.type==="Polygon"?[g.coordinates]:g.coordinates,C,D);if(isNaN(E))return E;if((D=Math.min(D,E))===0)return D}return D}return null}(l,u,this.geometries);if(o.geometryType()==="Polygon")return function(p,h,g){let x=[];for(let D of function(v,E){let T=v.length;if(T<=1)return[v];let S=[],M,R;for(let L=0;L<T;L++){let N=wM(v[L]);N!==0&&(v[L].area=Math.abs(N),R===void 0&&(R=N<0),R===N<0?(M&&S.push(M),M=[v[L]]):M.push(v[L]))}return M&&S.push(M),S}(p)){let v=[];for(let E=0;E<D.length;++E)v.push(nw(D[E],h));x.push(v)}let C=new oh(x[0][0][0][1],"meters");if(g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString")return lf(g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",x,C);if(g.type==="MultiLineString"){let D=1/0;for(let v=0;v<g.coordinates.length;v++){let E=lf(g.coordinates[v],!0,x,C,D);if(isNaN(E))return E;if((D=Math.min(D,E))===0)return D}return D}return g.type==="Polygon"||g.type==="MultiPolygon"?function(D,v,E){let T=1/0;for(let S of D)for(let M of v){let R=aw(S,M,E,T);if(isNaN(R))return R;if((T=Math.min(T,R))===0)return T}return T}(g.type==="Polygon"?[g.coordinates]:g.coordinates,x,C):null}(l,u,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function og(d,o){switch(d){case"string":return ko(o);case"number":return+o;case"boolean":return!!o;case"color":return Ln.parse(o);case"formatted":return va.fromString(ko(o));case"resolvedImage":return ba.build(ko(o))}return o}function tv(d,o,l,u){return u!==void 0&&(d=u*Math.round(d/u)),o!==void 0&&d<o&&(d=o),l!==void 0&&d>l&&(d=l),d}class ru{constructor(o,l,u){this.type=o,this.key=l,this.scope=u}static parse(o,l){let u=l.expectedType;if(u==null&&(u=Cn),o.length<2||o.length>3)return l.error("Invalid number of arguments for 'config' expression.");let p=l.parse(o[1],1);if(!(p instanceof pc))return l.error("Key name of 'config' expression must be a string literal.");if(o.length>=3){let h=l.parse(o[2],2);return h instanceof pc?new ru(u,ko(p.value),ko(h.value)):l.error("Scope of 'config' expression must be a string literal.")}return new ru(u,ko(p.value))}evaluate(o){let l=[this.key,this.scope,o.scope].filter(Boolean).join(""),u=o.getConfig(l);if(!u)return null;let{type:p,value:h,values:g,minValue:x,maxValue:C,stepValue:D}=u,v=u.default.evaluate(o),E=v;if(h){let T=o.scope;o.scope=(T||"").split("").slice(1).join(""),E=h.evaluate(o),o.scope=T}return p&&(E=og(p,E)),E===void 0||x===void 0&&C===void 0&&D===void 0||(typeof E=="number"?E=tv(E,x,C,D):Array.isArray(E)&&(E=E.map(T=>typeof T=="number"?tv(T,x,C,D):T))),h!==void 0&&E!==void 0&&g&&!g.includes(E)&&(E=v,p&&(E=og(p,E))),(p&&p!==this.type||E!==void 0&&oo(E)!==this.type)&&(E=og(this.type.kind,E)),E}eachChild(){}outputDefined(){return!1}serialize(){let o=["config",this.key];return this.scope&&o.concat(this.key),o}}function dh(d){if(d instanceof La&&(d.name==="get"&&d.args.length===1||d.name==="feature-state"||d.name==="has"&&d.args.length===1||d.name==="properties"||d.name==="geometry-type"||d.name==="id"||/^filter-/.test(d.name))||d instanceof gc||d instanceof cd)return!1;let o=!0;return d.eachChild(l=>{o&&!dh(l)&&(o=!1)}),o}function cf(d){if(d instanceof La&&d.name==="feature-state")return!1;let o=!0;return d.eachChild(l=>{o&&!cf(l)&&(o=!1)}),o}function df(d){if(d instanceof ru)return new Set([d.key]);let o=new Set;return d.eachChild(l=>{o=new Set([...o,...df(l)])}),o}function vc(d,o){if(d instanceof La&&o.indexOf(d.name)>=0)return!1;let l=!0;return d.eachChild(u=>{l&&!vc(u,o)&&(l=!1)}),l}class ou{constructor(o,l){this.type=l.type,this.name=o,this.boundExpression=l}static parse(o,l){if(o.length!==2||typeof o[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");let u=o[1];return l.scope.has(u)?new ou(u,l.scope.get(u)):l.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class uh{constructor(o,l=[],u,p=new Ym,h=[],g,x){this.registry=o,this.path=l,this.key=l.map(C=>typeof C=="string"?`['${C}']`:`[${C}]`).join(""),this.scope=p,this.errors=h,this.expectedType=u,this._scope=g,this.options=x}parse(o,l,u,p,h={}){return l||u?this.concat(l,null,u,p)._parse(o,h):this._parse(o,h)}parseObjectValue(o,l,u,p,h,g={}){return this.concat(l,u,p,h)._parse(o,g)}_parse(o,l){function u(p,h,g){return g==="assert"?new _s(h,[p]):g==="coerce"?new mc(h,[p]):p}if(o!==null&&typeof o!="string"&&typeof o!="boolean"&&typeof o!="number"||(o=["literal",o]),Array.isArray(o)){if(o.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let p=typeof o[0]=="string"?this.registry[o[0]]:void 0;if(p){let h=p.parse(o,this);if(!h)return null;if(this.expectedType){let g=this.expectedType,x=h.type;if(g.kind!=="string"&&g.kind!=="number"&&g.kind!=="boolean"&&g.kind!=="object"&&g.kind!=="array"||x.kind!=="value")if(g.kind!=="color"&&g.kind!=="formatted"&&g.kind!=="resolvedImage"||x.kind!=="value"&&x.kind!=="string"){if(this.checkSubtype(g,x))return null}else h=u(h,g,l.typeAnnotation||"coerce");else h=u(h,g,l.typeAnnotation||"assert")}if(!(h instanceof pc)&&h.type.kind!=="resolvedImage"&&ag(h)){let g=new Xm(this._scope,this.options);try{h=new pc(h.type,h.evaluate(g))}catch(x){return this.error(x.message),null}}return h}return mc.parse(["to-array",o],this)}return this.error(o===void 0?"'undefined' value invalid. Use null instead.":typeof o=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,l,u,p){let h=typeof o=="number"?this.path.concat(o):this.path;h=typeof l=="string"?h.concat(l):h;let g=p?this.scope.concat(p):this.scope;return new uh(this.registry,h,u||null,g,this.errors,this._scope,this.options)}error(o,...l){let u=`${this.key}${l.map(p=>`[${p}]`).join("")}`;this.errors.push(new zs(u,o))}checkSubtype(o,l){let u=th(o,l);return u&&this.error(u),u}}var iv=uh;function ag(d){if(d instanceof ou)return ag(d.boundExpression);if(d instanceof La&&d.name==="error"||d instanceof Jd||d instanceof gc||d instanceof cd||d instanceof ru)return!1;let o=d instanceof mc||d instanceof _s,l=!0;return d.eachChild(u=>{l=o?l&&ag(u):l&&u instanceof pc}),!!l&&dh(d)&&vc(d,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function uf(d,o){let l=d.length-1,u,p,h=0,g=l,x=0;for(;h<=g;)if(x=Math.floor((h+g)/2),u=d[x],p=d[x+1],u<=o){if(x===l||o<p)return x;h=x+1}else{if(!(u>o))throw new Hr("Input is not a number.");g=x-1}return 0}class Ol{constructor(o,l,u){this.type=o,this.input=l,this.labels=[],this.outputs=[];for(let[p,h]of u)this.labels.push(p),this.outputs.push(h)}static parse(o,l){if(o.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return l.error("Expected an even number of arguments.");let u=l.parse(o[1],1,ii);if(!u)return null;let p=[],h=null;l.expectedType&&l.expectedType.kind!=="value"&&(h=l.expectedType);for(let g=1;g<o.length;g+=2){let x=g===1?-1/0:o[g],C=o[g+1],D=g,v=g+1;if(typeof x!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(p.length&&p[p.length-1][0]>=x)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',D);let E=l.parse(C,v,h);if(!E)return null;h=h||E.type,p.push([x,E])}return new Ol(h,u,p)}evaluate(o){let l=this.labels,u=this.outputs;if(l.length===1)return u[0].evaluate(o);let p=this.input.evaluate(o);if(p<=l[0])return u[0].evaluate(o);let h=l.length;return p>=l[h-1]?u[h-1].evaluate(o):u[uf(l,p)].evaluate(o)}eachChild(o){o(this.input);for(let l of this.outputs)o(l)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){let o=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&o.push(this.labels[l]),o.push(this.outputs[l].serialize());return o}}let sn=.95047,sw=1.08883,lw=4/29,hh=6/29,nv=3*hh*hh,kM=hh*hh*hh,gr=Math.PI/180,PM=180/Math.PI;function rv(d){return d>kM?Math.pow(d,1/3):d/nv+lw}function ov(d){return d>hh?d*d*d:nv*(d-lw)}function av(d){return 255*(d<=.0031308?12.92*d:1.055*Math.pow(d,1/2.4)-.055)}function sv(d){return(d/=255)<=.04045?d/12.92:Math.pow((d+.055)/1.055,2.4)}function cw(d){let o=sv(d.r),l=sv(d.g),u=sv(d.b),p=rv((.4124564*o+.3575761*l+.1804375*u)/sn),h=rv((.2126729*o+.7151522*l+.072175*u)/1);return{l:116*h-16,a:500*(p-h),b:200*(h-rv((.0193339*o+.119192*l+.9503041*u)/sw)),alpha:d.a}}function dw(d){let o=(d.l+16)/116,l=isNaN(d.a)?o:o+d.a/500,u=isNaN(d.b)?o:o-d.b/200;return o=1*ov(o),l=sn*ov(l),u=sw*ov(u),new Ln(av(3.2404542*l-1.5371385*o-.4985314*u),av(-.969266*l+1.8760108*o+.041556*u),av(.0556434*l-.2040259*o+1.0572252*u),d.alpha)}function OM(d,o,l){let u=o-d;return d+l*(u>180||u<-180?u-360*Math.round(u/360):u)}let hf={forward:cw,reverse:dw,interpolate:function(d,o,l){return{l:yi(d.l,o.l,l),a:yi(d.a,o.a,l),b:yi(d.b,o.b,l),alpha:yi(d.alpha,o.alpha,l)}}},pf={forward:function(d){let{l:o,a:l,b:u}=cw(d),p=Math.atan2(u,l)*PM;return{h:p<0?p+360:p,c:Math.sqrt(l*l+u*u),l:o,alpha:d.a}},reverse:function(d){let o=d.h*gr,l=d.c;return dw({l:d.l,a:Math.cos(o)*l,b:Math.sin(o)*l,alpha:d.alpha})},interpolate:function(d,o,l){return{h:OM(d.h,o.h,l),c:yi(d.c,o.c,l),l:yi(d.l,o.l,l),alpha:yi(d.alpha,o.alpha,l)}}};var uw=Object.freeze({__proto__:null,hcl:pf,lab:hf});class ys{constructor(o,l,u,p,h){this.type=o,this.operator=l,this.interpolation=u,this.input=p,this.labels=[],this.outputs=[];for(let[g,x]of h)this.labels.push(g),this.outputs.push(x)}static interpolationFactor(o,l,u,p){let h=0;if(o.name==="exponential")h=lv(l,o.base,u,p);else if(o.name==="linear")h=lv(l,1,u,p);else if(o.name==="cubic-bezier"){let g=o.controlPoints;h=new fa(g[0],g[1],g[2],g[3]).solve(lv(l,1,u,p))}return h}static parse(o,l){let[u,p,h,...g]=o;if(!Array.isArray(p)||p.length===0)return l.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){let D=p[1];if(typeof D!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:D}}else{if(p[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(p[0])}`,1,0);{let D=p.slice(1);if(D.length!==4||D.some(v=>typeof v!="number"||v<0||v>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:D}}}if(o.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length-1>3&&(o.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(h=l.parse(h,2,ii),!h)return null;let x=[],C=null;u==="interpolate-hcl"||u==="interpolate-lab"?C=ya:l.expectedType&&l.expectedType.kind!=="value"&&(C=l.expectedType);for(let D=0;D<g.length;D+=2){let v=g[D],E=g[D+1],T=D+3,S=D+4;if(typeof v!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(x.length&&x[x.length-1][0]>=v)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',T);let M=l.parse(E,S,C);if(!M)return null;C=C||M.type,x.push([v,M])}return C.kind==="number"||C.kind==="color"||C.kind==="array"&&C.itemType.kind==="number"&&typeof C.N=="number"?new ys(C,u,p,h,x):l.error(`Type ${Lr(C)} is not interpolatable.`)}evaluate(o){let l=this.labels,u=this.outputs;if(l.length===1)return u[0].evaluate(o);let p=this.input.evaluate(o);if(p<=l[0])return u[0].evaluate(o);let h=l.length;if(p>=l[h-1])return u[h-1].evaluate(o);let g=uf(l,p),x=ys.interpolationFactor(this.interpolation,p,l[g],l[g+1]),C=u[g].evaluate(o),D=u[g+1].evaluate(o);return this.operator==="interpolate"?Qp[this.type.kind.toLowerCase()](C,D,x):this.operator==="interpolate-hcl"?pf.reverse(pf.interpolate(pf.forward(C),pf.forward(D),x)):hf.reverse(hf.interpolate(hf.forward(C),hf.forward(D),x))}eachChild(o){o(this.input);for(let l of this.outputs)o(l)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){let o;o=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];let l=[this.operator,o,this.input.serialize()];for(let u=0;u<this.labels.length;u++)l.push(this.labels[u],this.outputs[u].serialize());return l}}function lv(d,o,l,u){let p=u-l,h=d-l;return p===0?0:o===1?h/p:(Math.pow(o,h)-1)/(Math.pow(o,p)-1)}class sg{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expectected at least one argument.");let u=null,p=l.expectedType;p&&p.kind!=="value"&&(u=p);let h=[];for(let x of o.slice(1)){let C=l.parse(x,1+h.length,u,void 0,{typeAnnotation:"omit"});if(!C)return null;u=u||C.type,h.push(C)}let g=p&&h.some(x=>th(p,x.type));return new sg(g?Cn:u,h)}evaluate(o){let l,u=null,p=0;for(let h of this.args){if(p++,u=h.evaluate(o),u&&u instanceof ba&&!u.available&&(l||(l=u),u=null,p===this.args.length))return l;if(u!==null)break}return u}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){let o=["coalesce"];return this.eachChild(l=>{o.push(l.serialize())}),o}}class lg{constructor(o,l){this.type=l.type,this.bindings=[].concat(o),this.result=l}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(let l of this.bindings)o(l[1]);o(this.result)}static parse(o,l){if(o.length<4)return l.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);let u=[];for(let h=1;h<o.length-1;h+=2){let g=o[h];if(typeof g!="string")return l.error(`Expected string, but found ${typeof g} instead.`,h);if(/[^a-zA-Z0-9_]/.test(g))return l.error("Variable names must contain only alphanumeric characters or '_'.",h);let x=l.parse(o[h+1],h+1);if(!x)return null;u.push([g,x])}let p=l.parse(o[o.length-1],o.length-1,l.expectedType,u);return p?new lg(u,p):null}outputDefined(){return this.result.outputDefined()}serialize(){let o=["let"];for(let[l,u]of this.bindings)o.push(l,u.serialize());return o.push(this.result.serialize()),o}}class cv{constructor(o,l,u){this.type=o,this.index=l,this.input=u}static parse(o,l){if(o.length!==3)return l.error(`Expected 2 arguments, but found ${o.length-1} instead.`);let u=l.parse(o[1],1,ii),p=l.parse(o[2],2,Qo(l.expectedType||Cn));return u&&p?new cv(p.type.itemType,u,p):null}evaluate(o){let l=this.index.evaluate(o),u=this.input.evaluate(o);if(l<0)throw new Hr(`Array index out of bounds: ${l} < 0.`);if(l>=u.length)throw new Hr(`Array index out of bounds: ${l} > ${u.length-1}.`);if(l!==Math.floor(l))throw new Hr(`Array index must be an integer, but found ${l} instead. Use at-interpolated to retrieve interpolated result with a fractional index.`);return u[l]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class dv{constructor(o,l,u){this.type=o,this.index=l,this.input=u}static parse(o,l){if(o.length!==3)return l.error(`Expected 2 arguments, but found ${o.length-1} instead.`);let u=l.parse(o[1],1,ii),p=l.parse(o[2],2,Qo(l.expectedType||Cn));return u&&p?new dv(p.type.itemType,u,p):null}evaluate(o){let l=this.index.evaluate(o),u=this.input.evaluate(o);if(l<0)throw new Hr(`Array index out of bounds: ${l} < 0.`);if(l>u.length-1)throw new Hr(`Array index out of bounds: ${l} > ${u.length-1}.`);if(l===Math.floor(l))return u[l];let p=Math.floor(l),h=Math.ceil(l),g=u[p],x=u[h];if(typeof g!="number"||typeof x!="number")throw new Hr(`Cannot interpolate between non-number values at index ${l}.`);let C=l-p;return g*(1-C)+x*C}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class uv{constructor(o,l){this.type=gn,this.needle=o,this.haystack=l}static parse(o,l){if(o.length!==3)return l.error(`Expected 2 arguments, but found ${o.length-1} instead.`);let u=l.parse(o[1],1,Cn),p=l.parse(o[2],2,Cn);return u&&p?Yy(u.type,[gn,Rn,ii,Ju,Cn])?new uv(u,p):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Lr(u.type)} instead`):null}evaluate(o){let l=this.needle.evaluate(o),u=this.haystack.evaluate(o);if(u==null)return!1;if(!ih(l,["boolean","string","number","null"]))throw new Hr(`Expected first argument to be of type boolean, string, number or null, but found ${Lr(oo(l))} instead.`);if(!ih(u,["string","array"]))throw new Hr(`Expected second argument to be of type array or string, but found ${Lr(oo(u))} instead.`);return u.indexOf(l)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class cg{constructor(o,l,u){this.type=ii,this.needle=o,this.haystack=l,this.fromIndex=u}static parse(o,l){if(o.length<=2||o.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);let u=l.parse(o[1],1,Cn),p=l.parse(o[2],2,Cn);if(!u||!p)return null;if(!Yy(u.type,[gn,Rn,ii,Ju,Cn]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Lr(u.type)} instead`);if(o.length===4){let h=l.parse(o[3],3,ii);return h?new cg(u,p,h):null}return new cg(u,p)}evaluate(o){let l=this.needle.evaluate(o),u=this.haystack.evaluate(o);if(!ih(l,["boolean","string","number","null"]))throw new Hr(`Expected first argument to be of type boolean, string, number or null, but found ${Lr(oo(l))} instead.`);if(!ih(u,["string","array"]))throw new Hr(`Expected second argument to be of type array or string, but found ${Lr(oo(u))} instead.`);if(this.fromIndex){let p=this.fromIndex.evaluate(o);return u.indexOf(l,p)}return u.indexOf(l)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){let o=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),o]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class hv{constructor(o,l,u,p,h,g){this.inputType=o,this.type=l,this.input=u,this.cases=p,this.outputs=h,this.otherwise=g}static parse(o,l){if(o.length<5)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return l.error("Expected an even number of arguments.");let u,p;l.expectedType&&l.expectedType.kind!=="value"&&(p=l.expectedType);let h={},g=[];for(let D=2;D<o.length-1;D+=2){let v=o[D],E=o[D+1];Array.isArray(v)||(v=[v]);let T=l.concat(D);if(v.length===0)return T.error("Expected at least one branch label.");for(let M of v){if(typeof M!="number"&&typeof M!="string")return T.error("Branch labels must be numbers or strings.");if(typeof M=="number"&&Math.abs(M)>Number.MAX_SAFE_INTEGER)return T.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof M=="number"&&Math.floor(M)!==M)return T.error("Numeric branch labels must be integer values.");if(u){if(T.checkSubtype(u,oo(M)))return null}else u=oo(M);if(h[String(M)]!==void 0)return T.error("Branch labels must be unique.");h[String(M)]=g.length}let S=l.parse(E,D,p);if(!S)return null;p=p||S.type,g.push(S)}let x=l.parse(o[1],1,Cn);if(!x)return null;let C=l.parse(o[o.length-1],o.length-1,p);return C?x.type.kind!=="value"&&l.concat(1).checkSubtype(u,x.type)?null:new hv(u,p,x,h,g,C):null}evaluate(o){let l=this.input.evaluate(o);return(oo(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){let o=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),u=[],p={};for(let g of l){let x=p[this.cases[g]];x===void 0?(p[this.cases[g]]=u.length,u.push([this.cases[g],[g]])):u[x][1].push(g)}let h=g=>this.inputType.kind==="number"?Number(g):g;for(let[g,x]of u)o.push(x.length===1?h(x[0]):x.map(h)),o.push(this.outputs[g].serialize());return o.push(this.otherwise.serialize()),o}}class pv{constructor(o,l,u){this.type=o,this.branches=l,this.otherwise=u}static parse(o,l){if(o.length<4)return l.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return l.error("Expected an odd number of arguments.");let u;l.expectedType&&l.expectedType.kind!=="value"&&(u=l.expectedType);let p=[];for(let g=1;g<o.length-1;g+=2){let x=l.parse(o[g],g,gn);if(!x)return null;let C=l.parse(o[g+1],g+1,u);if(!C)return null;p.push([x,C]),u=u||C.type}let h=l.parse(o[o.length-1],o.length-1,u);return h?new pv(u,p,h):null}evaluate(o){for(let[l,u]of this.branches)if(l.evaluate(o))return u.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(let[l,u]of this.branches)o(l),o(u);o(this.otherwise)}outputDefined(){return this.branches.every(([o,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){let o=["case"];return this.eachChild(l=>{o.push(l.serialize())}),o}}class dg{constructor(o,l,u,p){this.type=o,this.input=l,this.beginIndex=u,this.endIndex=p}static parse(o,l){if(o.length<=2||o.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);let u=l.parse(o[1],1,Cn),p=l.parse(o[2],2,ii);if(!u||!p)return null;if(!Yy(u.type,[Qo(Cn),Rn,Cn]))return l.error(`Expected first argument to be of type array or string, but found ${Lr(u.type)} instead`);if(o.length===4){let h=l.parse(o[3],3,ii);return h?new dg(u.type,u,p,h):null}return new dg(u.type,u,p)}evaluate(o){let l=this.input.evaluate(o),u=this.beginIndex.evaluate(o);if(!ih(l,["string","array"]))throw new Hr(`Expected first argument to be of type array or string, but found ${Lr(oo(l))} instead.`);if(this.endIndex){let p=this.endIndex.evaluate(o);return l.slice(u,p)}return l.slice(u)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){let o=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),o]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function hw(d,o){return d==="=="||d==="!="?o.kind==="boolean"||o.kind==="string"||o.kind==="number"||o.kind==="null"||o.kind==="value":o.kind==="string"||o.kind==="number"||o.kind==="value"}function pw(d,o,l,u){return u.compare(o,l)===0}function ph(d,o,l){let u=d!=="=="&&d!=="!=";return class t6{constructor(h,g,x){this.type=gn,this.lhs=h,this.rhs=g,this.collator=x,this.hasUntypedArgument=h.type.kind==="value"||g.type.kind==="value"}static parse(h,g){if(h.length!==3&&h.length!==4)return g.error("Expected two or three arguments.");let x=h[0],C=g.parse(h[1],1,Cn);if(!C)return null;if(!hw(x,C.type))return g.concat(1).error(`"${x}" comparisons are not supported for type '${Lr(C.type)}'.`);let D=g.parse(h[2],2,Cn);if(!D)return null;if(!hw(x,D.type))return g.concat(2).error(`"${x}" comparisons are not supported for type '${Lr(D.type)}'.`);if(C.type.kind!==D.type.kind&&C.type.kind!=="value"&&D.type.kind!=="value")return g.error(`Cannot compare types '${Lr(C.type)}' and '${Lr(D.type)}'.`);u&&(C.type.kind==="value"&&D.type.kind!=="value"?C=new _s(D.type,[C]):C.type.kind!=="value"&&D.type.kind==="value"&&(D=new _s(C.type,[D])));let v=null;if(h.length===4){if(C.type.kind!=="string"&&D.type.kind!=="string"&&C.type.kind!=="value"&&D.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(v=g.parse(h[3],3,uc),!v)return null}return new t6(C,D,v)}evaluate(h){let g=this.lhs.evaluate(h),x=this.rhs.evaluate(h);if(u&&this.hasUntypedArgument){let C=oo(g),D=oo(x);if(C.kind!==D.kind||C.kind!=="string"&&C.kind!=="number")throw new Hr(`Expected arguments for "${d}" to be (string, string) or (number, number), but found (${C.kind}, ${D.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){let C=oo(g),D=oo(x);if(C.kind!=="string"||D.kind!=="string")return o(h,g,x)}return this.collator?l(h,g,x,this.collator.evaluate(h)):o(h,g,x)}eachChild(h){h(this.lhs),h(this.rhs),this.collator&&h(this.collator)}outputDefined(){return!0}serialize(){let h=[d];return this.eachChild(g=>{h.push(g.serialize())}),h}}}let FM=ph("==",function(d,o,l){return o===l},pw),LM=ph("!=",function(d,o,l){return o!==l},function(d,o,l,u){return!pw(0,o,l,u)}),NM=ph("<",function(d,o,l){return o<l},function(d,o,l,u){return u.compare(o,l)<0}),zM=ph(">",function(d,o,l){return o>l},function(d,o,l,u){return u.compare(o,l)>0}),BM=ph("<=",function(d,o,l){return o<=l},function(d,o,l,u){return u.compare(o,l)<=0}),VM=ph(">=",function(d,o,l){return o>=l},function(d,o,l,u){return u.compare(o,l)>=0});class ff{constructor(o,l,u,p,h,g){this.type=Rn,this.number=o,this.locale=l,this.currency=u,this.unit=p,this.minFractionDigits=h,this.maxFractionDigits=g}static parse(o,l){if(o.length!==3)return l.error("Expected two arguments.");let u=l.parse(o[1],1,ii);if(!u)return null;let p=o[2];if(typeof p!="object"||Array.isArray(p))return l.error("NumberFormat options argument must be an object.");let h=null;if(p.locale&&(h=l.parseObjectValue(p.locale,2,"locale",Rn),!h))return null;let g=null;if(p.currency&&(g=l.parseObjectValue(p.currency,2,"currency",Rn),!g))return null;let x=null;if(p.unit&&(x=l.parseObjectValue(p.unit,2,"unit",Rn),!x))return null;let C=null;if(p["min-fraction-digits"]&&(C=l.parseObjectValue(p["min-fraction-digits"],2,"min-fraction-digits",ii),!C))return null;let D=null;return p["max-fraction-digits"]&&(D=l.parseObjectValue(p["max-fraction-digits"],2,"max-fraction-digits",ii),!D)?null:new ff(u,h,g,x,C,D)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(o):void 0,unit:this.unit?this.unit.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.unit&&o(this.unit),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}serialize(){let o={};return this.locale&&(o.locale=this.locale.serialize()),this.currency&&(o.currency=this.currency.serialize()),this.unit&&(o.unit=this.unit.serialize()),this.minFractionDigits&&(o["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(o["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),o]}}class fv{constructor(o){this.type=ii,this.input=o}static parse(o,l){if(o.length!==2)return l.error(`Expected 1 argument, but found ${o.length-1} instead.`);let u=l.parse(o[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${Lr(u.type)} instead.`):new fv(u):null}evaluate(o){let l=this.input.evaluate(o);if(typeof l=="string"||Array.isArray(l))return l.length;throw new Hr(`Expected value to be of type string or array, but found ${Lr(oo(l))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){let o=["length"];return this.eachChild(l=>{o.push(l.serialize())}),o}}function mv(d){return function(){d=1831565813+(d|=0)|0;let o=Math.imul(d^d>>>15,1|d);return o=o+Math.imul(o^o>>>7,61|o)^o,((o^o>>>14)>>>0)/4294967296}}let fh={"==":FM,"!=":LM,">":zM,"<":NM,">=":VM,"<=":BM,array:_s,at:cv,"at-interpolated":dv,boolean:_s,case:pv,coalesce:sg,collator:Jd,format:nh,image:od,in:uv,"index-of":cg,interpolate:ys,"interpolate-hcl":ys,"interpolate-lab":ys,length:fv,let:lg,literal:pc,match:hv,number:_s,"number-format":ff,object:_s,slice:dg,step:Ol,string:_s,"to-boolean":mc,"to-color":mc,"to-number":mc,"to-string":mc,var:ou,within:gc,distance:cd,config:ru};function fw(d,[o,l,u,p]){o=o.evaluate(d),l=l.evaluate(d),u=u.evaluate(d);let h=p?p.evaluate(d):1,g=tf(o,l,u,h);if(g)throw new Hr(g);return new Ln(o/255*h,l/255*h,u/255*h,h)}function mw(d,[o,l,u,p]){o=o.evaluate(d),l=l.evaluate(d),u=u.evaluate(d);let h=p?p.evaluate(d):1,g=function(D,v,E,T){return typeof D=="number"&&D>=0&&D<=360?typeof v=="number"&&v>=0&&v<=100&&typeof E=="number"&&E>=0&&E<=100?T===void 0||typeof T=="number"&&T>=0&&T<=1?null:`Invalid hsla value [${[D,v,E,T].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof T=="number"?[D,v,E,T]:[D,v,E]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof T=="number"?[D,v,E,T]:[D,v,E]).join(", ")}]: 'h' must be between 0 and 360.`}(o,l,u,h);if(g)throw new Hr(g);let x=`hsla(${o}, ${l}%, ${u}%, ${h})`,C=Ln.parse(x);if(!C)throw new Hr(`Failed to parse HSLA color: ${x}`);return C}function gv(d,o){return d in o}function ug(d,o){let l=o[d];return l===void 0?null:l}function Bs(d){return{type:d}}function _v(d){return{result:"success",value:d}}function bc(d){return{result:"error",value:d}}function yv(d,o){return!!d&&!!d.parameters&&d.parameters.indexOf(o)>-1}function mh(d){return d["property-type"]==="data-driven"}function hg(d){return yv(d.expression,"measure-light")}function gw(d){return yv(d.expression,"zoom")}function vv(d){return!!d.expression&&d.expression.interpolated}function pg(d){return typeof d=="object"&&d!==null&&!Array.isArray(d)}function _w(d){return d}function yw(d,o){let l=o.type==="color",u=d.stops&&typeof d.stops[0][0]=="object",p=u||!(u||d.property!==void 0),h=d.type||(vv(o)?"exponential":"interval");if(l&&((d=wn({},d)).stops&&(d.stops=d.stops.map(D=>[D[0],Ln.parse(D[1])])),d.default=Ln.parse(d.default?d.default:o.default)),d.colorSpace&&d.colorSpace!=="rgb"&&!uw[d.colorSpace])throw new Error(`Unknown color space: ${d.colorSpace}`);let g,x,C;if(h==="exponential")g=bv;else if(h==="interval")g=vw;else if(h==="categorical"){g=jM,x=Object.create(null);for(let D of d.stops)x[D[0]]=D[1];C=typeof d.stops[0][0]}else{if(h!=="identity")throw new Error(`Unknown function type "${h}"`);g=fg}if(u){let D={},v=[];for(let S=0;S<d.stops.length;S++){let M=d.stops[S],R=M[0].zoom;D[R]===void 0&&(D[R]={zoom:R,type:d.type,property:d.property,default:d.default,stops:[]},v.push(R)),D[R].stops.push([M[0].value,M[1]])}let E=[];for(let S of v)E.push([D[S].zoom,yw(D[S],o)]);let T={name:"linear"};return{kind:"composite",interpolationType:T,interpolationFactor:ys.interpolationFactor.bind(void 0,T),zoomStops:E.map(S=>S[0]),evaluate:({zoom:S},M)=>bv({stops:E,base:d.base},o,S).evaluate(S,M)}}if(p){let D=h==="exponential"?{name:"exponential",base:d.base!==void 0?d.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:ys.interpolationFactor.bind(void 0,D),zoomStops:d.stops.map(v=>v[0]),evaluate:({zoom:v})=>g(d,o,v,x,C)}}return{kind:"source",evaluate(D,v){let E=v&&v.properties?v.properties[d.property]:void 0;return E===void 0?mf(d.default,o.default):g(d,o,E,x,C)}}}function mf(d,o,l){return d!==void 0?d:o!==void 0?o:l!==void 0?l:void 0}function jM(d,o,l,u,p){return mf(typeof l===p?u[l]:void 0,d.default,o.default)}function vw(d,o,l){if(fc(l)!=="number")return mf(d.default,o.default);let u=d.stops.length;if(u===1||l<=d.stops[0][0])return d.stops[0][1];if(l>=d.stops[u-1][0])return d.stops[u-1][1];let p=uf(d.stops.map(h=>h[0]),l);return d.stops[p][1]}function bv(d,o,l){let u=d.base!==void 0?d.base:1;if(fc(l)!=="number")return mf(d.default,o.default);let p=d.stops.length;if(p===1||l<=d.stops[0][0])return d.stops[0][1];if(l>=d.stops[p-1][0])return d.stops[p-1][1];let h=uf(d.stops.map(v=>v[0]),l),g=function(v,E,T,S){let M=S-T,R=v-T;return M===0?0:E===1?R/M:(Math.pow(E,R)-1)/(Math.pow(E,M)-1)}(l,u,d.stops[h][0],d.stops[h+1][0]),x=d.stops[h][1],C=d.stops[h+1][1],D=Qp[o.type]||_w;if(d.colorSpace&&d.colorSpace!=="rgb"){let v=uw[d.colorSpace];D=(E,T)=>v.reverse(v.interpolate(v.forward(E),v.forward(T),g))}return typeof x.evaluate=="function"?{evaluate(...v){let E=x.evaluate.apply(void 0,v),T=C.evaluate.apply(void 0,v);if(E!==void 0&&T!==void 0)return D(E,T,g)}}:D(x,C,g)}function fg(d,o,l){return o.type==="color"?l=Ln.parse(l):o.type==="formatted"?l=va.fromString(l.toString()):o.type==="resolvedImage"?l=ba.build(l.toString()):fc(l)===o.type||o.type==="enum"&&o.values[l]||(l=void 0),mf(l,d.default,o.default)}La.register(fh,{error:[{kind:"error"},[Rn],(d,[o])=>{throw new Hr(o.evaluate(d))}],typeof:[Rn,[Cn],(d,[o])=>Lr(oo(o.evaluate(d)))],"to-rgba":[Qo(ii,4),[ya],(d,[o])=>o.evaluate(d).toRenderColor(null).toArray()],"to-hsla":[Qo(ii,4),[ya],(d,[o])=>o.evaluate(d).toRenderColor(null).toHslaArray()],rgb:[ya,[ii,ii,ii],fw],rgba:[ya,[ii,ii,ii,ii],fw],hsl:[ya,[ii,ii,ii],mw],hsla:[ya,[ii,ii,ii,ii],mw],has:{type:gn,overloads:[[[Rn],(d,[o])=>gv(o.evaluate(d),d.properties())],[[Rn,eh],(d,[o,l])=>gv(o.evaluate(d),l.evaluate(d))]]},get:{type:Cn,overloads:[[[Rn],(d,[o])=>ug(o.evaluate(d),d.properties())],[[Rn,eh],(d,[o,l])=>ug(o.evaluate(d),l.evaluate(d))]]},"feature-state":[Cn,[Rn],(d,[o])=>ug(o.evaluate(d),d.featureState||{})],properties:[eh,[],d=>d.properties()],"geometry-type":[Rn,[],d=>d.geometryType()],id:[Cn,[],d=>d.id()],zoom:[ii,[],d=>d.globals.zoom],pitch:[ii,[],d=>d.globals.pitch||0],"distance-from-center":[ii,[],d=>d.distanceFromCenter()],"measure-light":[ii,[Rn],(d,[o])=>d.measureLight(o.evaluate(d))],"heatmap-density":[ii,[],d=>d.globals.heatmapDensity||0],"line-progress":[ii,[],d=>d.globals.lineProgress||0],"raster-value":[ii,[],d=>d.globals.rasterValue||0],"raster-particle-speed":[ii,[],d=>d.globals.rasterParticleSpeed||0],"sky-radial-progress":[ii,[],d=>d.globals.skyRadialProgress||0],accumulated:[Cn,[],d=>d.globals.accumulated===void 0?null:d.globals.accumulated],"+":[ii,Bs(ii),(d,o)=>{let l=0;for(let u of o)l+=u.evaluate(d);return l}],"*":[ii,Bs(ii),(d,o)=>{let l=1;for(let u of o)l*=u.evaluate(d);return l}],"-":{type:ii,overloads:[[[ii,ii],(d,[o,l])=>o.evaluate(d)-l.evaluate(d)],[[ii],(d,[o])=>-o.evaluate(d)]]},"/":[ii,[ii,ii],(d,[o,l])=>o.evaluate(d)/l.evaluate(d)],"%":[ii,[ii,ii],(d,[o,l])=>o.evaluate(d)%l.evaluate(d)],ln2:[ii,[],()=>Math.LN2],pi:[ii,[],()=>Math.PI],e:[ii,[],()=>Math.E],"^":[ii,[ii,ii],(d,[o,l])=>Math.pow(o.evaluate(d),l.evaluate(d))],sqrt:[ii,[ii],(d,[o])=>Math.sqrt(o.evaluate(d))],log10:[ii,[ii],(d,[o])=>Math.log(o.evaluate(d))/Math.LN10],ln:[ii,[ii],(d,[o])=>Math.log(o.evaluate(d))],log2:[ii,[ii],(d,[o])=>Math.log(o.evaluate(d))/Math.LN2],sin:[ii,[ii],(d,[o])=>Math.sin(o.evaluate(d))],cos:[ii,[ii],(d,[o])=>Math.cos(o.evaluate(d))],tan:[ii,[ii],(d,[o])=>Math.tan(o.evaluate(d))],asin:[ii,[ii],(d,[o])=>Math.asin(o.evaluate(d))],acos:[ii,[ii],(d,[o])=>Math.acos(o.evaluate(d))],atan:[ii,[ii],(d,[o])=>Math.atan(o.evaluate(d))],min:[ii,Bs(ii),(d,o)=>Math.min(...o.map(l=>l.evaluate(d)))],max:[ii,Bs(ii),(d,o)=>Math.max(...o.map(l=>l.evaluate(d)))],abs:[ii,[ii],(d,[o])=>Math.abs(o.evaluate(d))],round:[ii,[ii],(d,[o])=>{let l=o.evaluate(d);return l<0?-Math.round(-l):Math.round(l)}],floor:[ii,[ii],(d,[o])=>Math.floor(o.evaluate(d))],ceil:[ii,[ii],(d,[o])=>Math.ceil(o.evaluate(d))],"filter-==":[gn,[Rn,Cn],(d,[o,l])=>d.properties()[o.value]===l.value],"filter-id-==":[gn,[Cn],(d,[o])=>d.id()===o.value],"filter-type-==":[gn,[Rn],(d,[o])=>d.geometryType()===o.value],"filter-<":[gn,[Rn,Cn],(d,[o,l])=>{let u=d.properties()[o.value],p=l.value;return typeof u==typeof p&&u<p}],"filter-id-<":[gn,[Cn],(d,[o])=>{let l=d.id(),u=o.value;return typeof l==typeof u&&l<u}],"filter->":[gn,[Rn,Cn],(d,[o,l])=>{let u=d.properties()[o.value],p=l.value;return typeof u==typeof p&&u>p}],"filter-id->":[gn,[Cn],(d,[o])=>{let l=d.id(),u=o.value;return typeof l==typeof u&&l>u}],"filter-<=":[gn,[Rn,Cn],(d,[o,l])=>{let u=d.properties()[o.value],p=l.value;return typeof u==typeof p&&u<=p}],"filter-id-<=":[gn,[Cn],(d,[o])=>{let l=d.id(),u=o.value;return typeof l==typeof u&&l<=u}],"filter->=":[gn,[Rn,Cn],(d,[o,l])=>{let u=d.properties()[o.value],p=l.value;return typeof u==typeof p&&u>=p}],"filter-id->=":[gn,[Cn],(d,[o])=>{let l=d.id(),u=o.value;return typeof l==typeof u&&l>=u}],"filter-has":[gn,[Cn],(d,[o])=>o.value in d.properties()],"filter-has-id":[gn,[],d=>d.id()!==null&&d.id()!==void 0],"filter-type-in":[gn,[Qo(Rn)],(d,[o])=>o.value.indexOf(d.geometryType())>=0],"filter-id-in":[gn,[Qo(Cn)],(d,[o])=>o.value.indexOf(d.id())>=0],"filter-in-small":[gn,[Rn,Qo(Cn)],(d,[o,l])=>l.value.indexOf(d.properties()[o.value])>=0],"filter-in-large":[gn,[Rn,Qo(Cn)],(d,[o,l])=>function(u,p,h,g){for(;h<=g;){let x=h+g>>1;if(p[x]===u)return!0;p[x]>u?g=x-1:h=x+1}return!1}(d.properties()[o.value],l.value,0,l.value.length-1)],all:{type:gn,overloads:[[[gn,gn],(d,[o,l])=>o.evaluate(d)&&l.evaluate(d)],[Bs(gn),(d,o)=>{for(let l of o)if(!l.evaluate(d))return!1;return!0}]]},any:{type:gn,overloads:[[[gn,gn],(d,[o,l])=>o.evaluate(d)||l.evaluate(d)],[Bs(gn),(d,o)=>{for(let l of o)if(l.evaluate(d))return!0;return!1}]]},"!":[gn,[gn],(d,[o])=>!o.evaluate(d)],"is-supported-script":[gn,[Rn],(d,[o])=>{let l=d.globals&&d.globals.isSupportedScript;return!l||l(o.evaluate(d))}],upcase:[Rn,[Rn],(d,[o])=>o.evaluate(d).toUpperCase()],downcase:[Rn,[Rn],(d,[o])=>o.evaluate(d).toLowerCase()],concat:[Rn,Bs(Cn),(d,o)=>o.map(l=>ko(l.evaluate(d))).join("")],"resolved-locale":[Rn,[uc],(d,[o])=>o.evaluate(d).resolvedLocale()],random:[ii,[ii,ii,Cn],(d,o)=>{let[l,u,p]=o.map(g=>g.evaluate(d));if(l>u||l===u)return l;let h;if(typeof p=="string")h=function(g){let x=0;if(g.length===0)return x;for(let C=0;C<g.length;C++)x=(x<<5)-x+g.charCodeAt(C),x|=0;return x}(p);else{if(typeof p!="number")throw new Hr(`Invalid seed input: ${p}`);h=p}return l+mv(h)()*(u-l)}]});class xv{constructor(o,l,u,p){this.expression=o,this._warningHistory={},this._evaluator=new Xm(u,p),this._defaultValue=l?function(h){return h.type==="color"&&(pg(h.default)||Array.isArray(h.default))?new Ln(0,0,0,0):h.type==="color"?Ln.parse(h.default)||null:h.default===void 0?null:h.default}(l):null,this._enumValues=l&&l.type==="enum"?l.values:null,this.configDependencies=df(o)}evaluateWithoutErrorHandling(o,l,u,p,h,g,x,C){return this._evaluator.globals=o,this._evaluator.feature=l,this._evaluator.featureState=u,this._evaluator.canonical=p||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=g,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=C||null,this.expression.evaluate(this._evaluator)}evaluate(o,l,u,p,h,g,x,C){this._evaluator.globals=o,this._evaluator.feature=l||null,this._evaluator.featureState=u||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=g||null,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=C||null;try{let D=this.expression.evaluate(this._evaluator);if(D==null||typeof D=="number"&&D!=D)return this._defaultValue;if(this._enumValues&&!(D in this._enumValues))throw new Hr(`Expected value to be one of ${Object.keys(this._enumValues).map(v=>JSON.stringify(v)).join(", ")}, but found ${JSON.stringify(D)} instead.`);return D}catch(D){return this._warningHistory[D.message]||(this._warningHistory[D.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${D.message}`)),this._defaultValue}}}function mg(d){return Array.isArray(d)&&d.length>0&&typeof d[0]=="string"&&d[0]in fh}function gh(d,o,l,u){let p=new iv(fh,[],o?function(g){let x={color:ya,string:Rn,number:ii,enum:Rn,boolean:gn,formatted:Jp,resolvedImage:hc};return g.type==="array"?Qo(x[g.value]||Cn,g.length):x[g.type]}(o):void 0,void 0,void 0,l,u),h=p.parse(d,void 0,void 0,void 0,o&&o.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?_v(new xv(h,o,l,u)):bc(p.errors)}class wv{constructor(o,l,u,p){this.kind=o,this._styleExpression=l,this.isLightConstant=u,this.isLineProgressConstant=p,this.isStateDependent=o!=="constant"&&!cf(l.expression),this.configDependencies=df(l.expression)}evaluateWithoutErrorHandling(o,l,u,p,h,g){return this._styleExpression.evaluateWithoutErrorHandling(o,l,u,p,h,g)}evaluate(o,l,u,p,h,g){return this._styleExpression.evaluate(o,l,u,p,h,g)}}class _h{constructor(o,l,u,p,h,g){this.kind=o,this.zoomStops=u,this._styleExpression=l,this.isStateDependent=o!=="camera"&&!cf(l.expression),this.isLightConstant=h,this.isLineProgressConstant=g,this.configDependencies=df(l.expression),this.interpolationType=p}evaluateWithoutErrorHandling(o,l,u,p,h,g){return this._styleExpression.evaluateWithoutErrorHandling(o,l,u,p,h,g)}evaluate(o,l,u,p,h,g){return this._styleExpression.evaluate(o,l,u,p,h,g)}interpolationFactor(o,l,u){return this.interpolationType?ys.interpolationFactor(this.interpolationType,o,l,u):0}}function Cv(d,o,l,u){if((d=gh(d,o,l,u)).result==="error")return d;let p=d.value.expression,h=dh(p);if(!h&&!mh(o))return bc([new zs("","data expressions not supported")]);let g=vc(p,["zoom","pitch","distance-from-center"]);if(!g&&!gw(o))return bc([new zs("","zoom expressions not supported")]);let x=vc(p,["measure-light"]);if(!x&&!hg(o))return bc([new zs("","measure-light expression not supported")]);let C=vc(p,["line-progress"]);if(!C&&!function(E){return yv(E.expression,"line-progress")}(o))return bc([new zs("","line-progress expression not supported")]);let D=o.expression&&o.expression.relaxZoomRestriction,v=_g(p);return v||g||D?v instanceof zs?bc([v]):v instanceof ys&&!vv(o)?bc([new zs("",'"interpolate" expressions cannot be used with this property')]):_v(v?new _h(h&&C?"camera":"composite",d.value,v.labels,v instanceof ys?v.interpolation:void 0,x,C):new wv(h&&C?"constant":"source",d.value,x,C)):bc([new zs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class gg{constructor(o,l){this._parameters=o,this._specification=l,wn(this,yw(this._parameters,this._specification))}static deserialize(o){return new gg(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function _g(d){let o=null;if(d instanceof lg)o=_g(d.result);else if(d instanceof sg){for(let l of d.args)if(o=_g(l),o)break}else(d instanceof Ol||d instanceof ys)&&d.input instanceof La&&d.input.name==="zoom"&&(o=d);return o instanceof zs||d.eachChild(l=>{let u=_g(l);u instanceof zs?o=u:o&&u&&o!==u&&(o=new zs("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}var gf,bw,xw=function(){if(bw)return gf;bw=1,gf=o;var d=3;function o(l,u,p){var h=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;var g=new Int32Array(this.arrayBuffer);l=g[0],this.d=(u=g[1])+2*(p=g[2]);for(var x=0;x<this.d*this.d;x++){var C=g[d+x],D=g[d+x+1];h.push(C===D?null:g.subarray(C,D))}var v=g[d+h.length+1];this.keys=g.subarray(g[d+h.length],v),this.bboxes=g.subarray(v),this.insert=this._insertReadonly}else{this.d=u+2*p;for(var E=0;E<this.d*this.d;E++)h.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=l,this.padding=p,this.scale=u/l,this.uid=0;var T=p/u*l;this.min=-T,this.max=l+T}return o.prototype.insert=function(l,u,p,h,g){this._forEachCell(u,p,h,g,this._insertCell,this.uid++),this.keys.push(l),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(h),this.bboxes.push(g)},o.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},o.prototype._insertCell=function(l,u,p,h,g,x){this.cells[g].push(x)},o.prototype.query=function(l,u,p,h,g){var x=this.min,C=this.max;if(l<=x&&u<=x&&C<=p&&C<=h&&!g)return Array.prototype.slice.call(this.keys);var D=[];return this._forEachCell(l,u,p,h,this._queryCell,D,{},g),D},o.prototype._queryCell=function(l,u,p,h,g,x,C,D){var v=this.cells[g];if(v!==null)for(var E=this.keys,T=this.bboxes,S=0;S<v.length;S++){var M=v[S];if(C[M]===void 0){var R=4*M;(D?D(T[R+0],T[R+1],T[R+2],T[R+3]):l<=T[R+2]&&u<=T[R+3]&&p>=T[R+0]&&h>=T[R+1])?(C[M]=!0,x.push(E[M])):C[M]=!1}}},o.prototype._forEachCell=function(l,u,p,h,g,x,C,D){for(var v=this._convertToCellCoord(l),E=this._convertToCellCoord(u),T=this._convertToCellCoord(p),S=this._convertToCellCoord(h),M=v;M<=T;M++)for(var R=E;R<=S;R++){var L=this.d*R+M;if((!D||D(this._convertFromCellCoord(M),this._convertFromCellCoord(R),this._convertFromCellCoord(M+1),this._convertFromCellCoord(R+1)))&&g.call(this,l,u,p,h,L,x,C,D))return}},o.prototype._convertFromCellCoord=function(l){return(l-this.padding)/this.scale},o.prototype._convertToCellCoord=function(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))},o.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,u=d+this.cells.length+1+1,p=0,h=0;h<this.cells.length;h++)p+=this.cells[h].length;var g=new Int32Array(u+p+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;for(var x=u,C=0;C<l.length;C++){var D=l[C];g[d+C]=x,g.set(D,x),x+=D.length}return g[d+l.length]=x,g.set(this.keys,x),g[d+l.length+1]=x+=this.keys.length,g.set(this.bboxes,x),x+=this.bboxes.length,g.buffer},gf}(),yh=y(xw);let yg={};function $t(d,o,l={}){Object.defineProperty(d,"_classRegistryKey",{value:o,writable:!1}),yg[o]={klass:d,omit:l.omit||[]}}$t(Object,"Object"),yh.serialize=function(d,o){let l=d.toArrayBuffer();return o&&o.add(l),{buffer:l}},yh.deserialize=function(d){return new yh(d.buffer)},Object.defineProperty(yh,"name",{value:"Grid"}),$t(yh,"Grid"),typeof DOMMatrix<"u"&&$t(DOMMatrix,"DOMMatrix"),$t(Ln,"Color"),$t(Error,"Error"),$t(va,"Formatted"),$t(ef,"FormattedSection"),$t(jo,"AJAXError"),$t(ba,"ResolvedImage"),$t(gg,"StylePropertyFunction"),$t(xv,"StyleExpression",{omit:["_evaluator"]}),$t(ja,"ImageId"),$t(Pl,"ImageVariant"),$t(_h,"ZoomDependentExpression"),$t(wv,"ZoomConstantExpression"),$t(La,"CompoundExpression",{omit:["_evaluate"]});for(let d in fh)yg[fh[d]._classRegistryKey]||$t(fh[d],`Expression${d}`);function Ev(d){return d&&typeof ArrayBuffer<"u"&&(d instanceof ArrayBuffer||d.constructor&&d.constructor.name==="ArrayBuffer")}function Sv(d){return self.ImageBitmap&&d instanceof ImageBitmap}function dd(d,o){if(d==null||typeof d=="boolean"||typeof d=="number"||typeof d=="string"||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp)return d;if(Ev(d)||Sv(d))return o&&o.add(d),d;if(ArrayBuffer.isView(d))return o&&o.add(d.buffer),d;if(d instanceof ImageData)return o&&o.add(d.data.buffer),d;if(Array.isArray(d)){let l=[];for(let u of d)l.push(dd(u,o));return l}if(d instanceof Map){let l={$name:"Map",entries:[]};for(let[u,p]of d.entries())l.entries.push(dd(u),dd(p));return l}if(d instanceof Set){let l={$name:"Set"},u=0;for(let p of d.values())l[++u]=dd(p);return l}if(d instanceof DOMMatrix){let l={$name:"DOMMatrix"},u=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(let p of u)l[p]=d[p];return l}if(typeof d=="bigint")return{$name:"BigInt",value:d.toString()};if(typeof d=="object"){let l=d.constructor,u=l._classRegistryKey;if(!u)throw new Error(`Can't serialize object of unregistered class "${l.name}".`);let p=l.serialize?l.serialize(d,o):{};if(!l.serialize){for(let h in d)d.hasOwnProperty(h)&&(yg[u].omit.indexOf(h)>=0||(p[h]=dd(d[h],o)));d instanceof Error&&(p.message=d.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(p.$name=u),p}throw new Error("can't serialize object of type "+typeof d)}function vs(d){if(d==null||typeof d=="boolean"||typeof d=="number"||typeof d=="string"||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp||Ev(d)||Sv(d)||ArrayBuffer.isView(d)||d instanceof ImageData)return d;if(Array.isArray(d))return d.map(vs);if(typeof d=="object"){let o=d.$name||"Object";if(o==="Map"){let p=d.entries||[],h=new Map;for(let g=0;g<p.length;g+=2)h.set(vs(p[g]),vs(p[g+1]));return h}if(o==="Set"){let p=new Set;for(let h of Object.keys(d))h!=="$name"&&p.add(vs(d[h]));return p}if(o==="DOMMatrix"){let p;return p=d.is2D?[d.a,d.b,d.c,d.d,d.e,d.f]:[d.m11,d.m12,d.m13,d.m14,d.m21,d.m22,d.m23,d.m24,d.m31,d.m32,d.m33,d.m34,d.m41,d.m42,d.m43,d.m44],new DOMMatrix(p)}if(o==="BigInt")return BigInt(d.value);let{klass:l}=yg[o];if(!l)throw new Error(`Can't deserialize unregistered class "${o}".`);if(l.deserialize)return l.deserialize(d);let u=Object.create(l.prototype);for(let p of Object.keys(d))p!=="$name"&&(u[p]=vs(d[p]));return u}throw new Error("can't deserialize object of type "+typeof d)}let fi={"Latin-1 Supplement":d=>d>=128&&d<=255,Arabic:d=>d>=1536&&d<=1791,"Arabic Supplement":d=>d>=1872&&d<=1919,"Arabic Extended-A":d=>d>=2208&&d<=2303,"Hangul Jamo":d=>d>=4352&&d<=4607,"Unified Canadian Aboriginal Syllabics":d=>d>=5120&&d<=5759,Khmer:d=>d>=6016&&d<=6143,"Unified Canadian Aboriginal Syllabics Extended":d=>d>=6320&&d<=6399,"General Punctuation":d=>d>=8192&&d<=8303,"Letterlike Symbols":d=>d>=8448&&d<=8527,"Number Forms":d=>d>=8528&&d<=8591,"Miscellaneous Technical":d=>d>=8960&&d<=9215,"Control Pictures":d=>d>=9216&&d<=9279,"Optical Character Recognition":d=>d>=9280&&d<=9311,"Enclosed Alphanumerics":d=>d>=9312&&d<=9471,"Geometric Shapes":d=>d>=9632&&d<=9727,"Miscellaneous Symbols":d=>d>=9728&&d<=9983,"Miscellaneous Symbols and Arrows":d=>d>=11008&&d<=11263,"CJK Radicals Supplement":d=>d>=11904&&d<=12031,"Kangxi Radicals":d=>d>=12032&&d<=12255,"Ideographic Description Characters":d=>d>=12272&&d<=12287,"CJK Symbols and Punctuation":d=>d>=12288&&d<=12351,Hiragana:d=>d>=12352&&d<=12447,Katakana:d=>d>=12448&&d<=12543,Bopomofo:d=>d>=12544&&d<=12591,"Hangul Compatibility Jamo":d=>d>=12592&&d<=12687,Kanbun:d=>d>=12688&&d<=12703,"Bopomofo Extended":d=>d>=12704&&d<=12735,"CJK Strokes":d=>d>=12736&&d<=12783,"Katakana Phonetic Extensions":d=>d>=12784&&d<=12799,"Enclosed CJK Letters and Months":d=>d>=12800&&d<=13055,"CJK Compatibility":d=>d>=13056&&d<=13311,"CJK Unified Ideographs Extension A":d=>d>=13312&&d<=19903,"Yijing Hexagram Symbols":d=>d>=19904&&d<=19967,"CJK Unified Ideographs":d=>d>=19968&&d<=40959,"Yi Syllables":d=>d>=40960&&d<=42127,"Yi Radicals":d=>d>=42128&&d<=42191,"Hangul Jamo Extended-A":d=>d>=43360&&d<=43391,"Hangul Syllables":d=>d>=44032&&d<=55215,"Hangul Jamo Extended-B":d=>d>=55216&&d<=55295,"Private Use Area":d=>d>=57344&&d<=63743,"CJK Compatibility Ideographs":d=>d>=63744&&d<=64255,"Arabic Presentation Forms-A":d=>d>=64336&&d<=65023,"Vertical Forms":d=>d>=65040&&d<=65055,"CJK Compatibility Forms":d=>d>=65072&&d<=65103,"Small Form Variants":d=>d>=65104&&d<=65135,"Arabic Presentation Forms-B":d=>d>=65136&&d<=65279,"Halfwidth and Fullwidth Forms":d=>d>=65280&&d<=65519,Osage:d=>d>=66736&&d<=66815,"CJK Unified Ideographs Extension B":d=>d>=131072&&d<=173791};function Dv(d){for(let o of d)if(vg(o.charCodeAt(0)))return!0;return!1}function UM(d){for(let o of d)if(!ww(o.charCodeAt(0)))return!1;return!0}function ww(d){return!(fi.Arabic(d)||fi["Arabic Supplement"](d)||fi["Arabic Extended-A"](d)||fi["Arabic Presentation Forms-A"](d)||fi["Arabic Presentation Forms-B"](d))}function vg(d){return!(d!==746&&d!==747&&(d<4352||!(fi["Bopomofo Extended"](d)||fi.Bopomofo(d)||fi["CJK Compatibility Forms"](d)&&!(d>=65097&&d<=65103)||fi["CJK Compatibility Ideographs"](d)||fi["CJK Compatibility"](d)||fi["CJK Radicals Supplement"](d)||fi["CJK Strokes"](d)||!(!fi["CJK Symbols and Punctuation"](d)||d>=12296&&d<=12305||d>=12308&&d<=12319||d===12336)||fi["CJK Unified Ideographs Extension A"](d)||fi["CJK Unified Ideographs"](d)||fi["Enclosed CJK Letters and Months"](d)||fi["Hangul Compatibility Jamo"](d)||fi["Hangul Jamo Extended-A"](d)||fi["Hangul Jamo Extended-B"](d)||fi["Hangul Jamo"](d)||fi["Hangul Syllables"](d)||fi.Hiragana(d)||fi["Ideographic Description Characters"](d)||fi.Kanbun(d)||fi["Kangxi Radicals"](d)||fi["Katakana Phonetic Extensions"](d)||fi.Katakana(d)&&d!==12540||!(!fi["Halfwidth and Fullwidth Forms"](d)||d===65288||d===65289||d===65293||d>=65306&&d<=65310||d===65339||d===65341||d===65343||d>=65371&&d<=65503||d===65507||d>=65512&&d<=65519)||!(!fi["Small Form Variants"](d)||d>=65112&&d<=65118||d>=65123&&d<=65126)||fi["Unified Canadian Aboriginal Syllabics"](d)||fi["Unified Canadian Aboriginal Syllabics Extended"](d)||fi["Vertical Forms"](d)||fi["Yijing Hexagram Symbols"](d)||fi["Yi Syllables"](d)||fi["Yi Radicals"](d))))}function Mv(d){return!(vg(d)||function(o){return!!(fi["Latin-1 Supplement"](o)&&(o===167||o===169||o===174||o===177||o===188||o===189||o===190||o===215||o===247)||fi["General Punctuation"](o)&&(o===8214||o===8224||o===8225||o===8240||o===8241||o===8251||o===8252||o===8258||o===8263||o===8264||o===8265||o===8273)||fi["Letterlike Symbols"](o)||fi["Number Forms"](o)||fi["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||o===9003||o>=9085&&o<=9114||o>=9150&&o<=9165||o===9167||o>=9169&&o<=9179||o>=9186&&o<=9215)||fi["Control Pictures"](o)&&o!==9251||fi["Optical Character Recognition"](o)||fi["Enclosed Alphanumerics"](o)||fi["Geometric Shapes"](o)||fi["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||fi["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||fi["CJK Symbols and Punctuation"](o)||fi.Katakana(o)||fi["Private Use Area"](o)||fi["CJK Compatibility Forms"](o)||fi["Small Form Variants"](o)||fi["Halfwidth and Fullwidth Forms"](o)||o===8734||o===8756||o===8757||o>=9984&&o<=10087||o>=10102&&o<=10131||o===65532||o===65533)}(d))}function Cw(d){return fi.Arabic(d)||fi["Arabic Supplement"](d)||fi["Arabic Extended-A"](d)||fi["Arabic Presentation Forms-A"](d)||fi["Arabic Presentation Forms-B"](d)}function bg(d){return d>=1424&&d<=2303||fi["Arabic Presentation Forms-A"](d)||fi["Arabic Presentation Forms-B"](d)}function Tv(d,o){return!(!o&&bg(d)||d>=2304&&d<=3583||d>=3840&&d<=4255||fi.Khmer(d))}function Ew(d){for(let o of d)if(bg(o.charCodeAt(0)))return!0;return!1}let Iv="deferred",xg="loading",Av="loaded",Rv=null,Ua="unavailable",ud=null,_f=function(d){d&&typeof d=="string"&&d.indexOf("NetworkError")>-1&&(Ua="error"),Rv&&Rv(d)};function wg(){vh.fire(new Xa("pluginStateChange",{pluginStatus:Ua,pluginURL:ud}))}let vh=new hl,Cg=function(){return Ua},Sw=function(){if(Ua!==Iv||!ud)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ua=xg,wg(),ud&&dc({url:ud},d=>{d?_f(d):(Ua=Av,wg())})},Vs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ua===Av||Vs.applyArabicShaping!=null,isLoading:()=>Ua===xg,setState(d){Ua=d.pluginStatus,ud=d.pluginURL},isParsed:()=>Vs.applyArabicShaping!=null&&Vs.processBidirectionalText!=null&&Vs.processStyledBidirectionalText!=null,getPluginURL:()=>ud};class ir{constructor(o,l){this.zoom=o,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.transition=l.transition,this.pitch=l.pitch,this.brightness=l.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(o){return function(l,u){for(let p of l)if(!Tv(p.charCodeAt(0),u))return!1;return!0}(o,Vs.isLoaded())}}class bh{constructor(o,l,u,p){this.property=o,this.value=l,this.expression=function(h,g,x,C){if(pg(h))return new gg(h,g);if(mg(h)||Array.isArray(h)&&h.length>0){let D=Cv(h,g,x,C);if(D.result==="error")throw new Error(D.value.map(v=>`${v.key}: ${v.message}`).join(", "));return D.value}{let D=h;return typeof h=="string"&&g.type==="color"&&(D=Ln.parse(h)),{kind:"constant",configDependencies:new Set,evaluate:()=>D}}}(l===void 0?o.specification.default:l,o.specification,u,p)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(o,l,u){return this.property.possiblyEvaluate(this,o,l,u)}}class kv{constructor(o,l,u){this.property=o,this.value=new bh(o,void 0,l,u)}transitioned(o,l){return new Eg(this.property,this.value,l,Io({},o.transition,this.transition),o.now)}untransitioned(){return new Eg(this.property,this.value,null,{},0)}}class Pv{constructor(o,l,u){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues),this._scope=l,this._options=u,this.configDependencies=new Set}getValue(o){return fs(this._values[o].value.value)}setValue(o,l){this._values.hasOwnProperty(o)||(this._values[o]=new kv(this._values[o].property,this._scope,this._options)),this._values[o].value=new bh(this._values[o].property,l===null?void 0:fs(l),this._scope,this._options),this._values[o].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[o].value.expression.configDependencies]))}setTransitionOrValue(o,l){l&&(this._options=l);let u=this._properties.properties;if(o)for(let p in o){let h=o[p];if(p.endsWith("-transition")){let g=p.slice(0,-11);u[g]&&this.setTransition(g,h)}else u.hasOwnProperty(p)&&this.setValue(p,h)}}getTransition(o){return fs(this._values[o].transition)}setTransition(o,l){this._values.hasOwnProperty(o)||(this._values[o]=new kv(this._values[o].property)),this._values[o].transition=fs(l)||void 0}serialize(){let o={};for(let l of Object.keys(this._values)){let u=this.getValue(l);u!==void 0&&(o[l]=u);let p=this.getTransition(l);p!==void 0&&(o[`${l}-transition`]=p)}return o}transitioned(o,l){let u=new yf(this._properties);for(let p of Object.keys(this._values))u._values[p]=this._values[p].transitioned(o,l._values[p]);return u}untransitioned(){let o=new yf(this._properties);for(let l of Object.keys(this._values))o._values[l]=this._values[l].untransitioned();return o}}class Eg{constructor(o,l,u,p,h){let g=p.delay||0,x=p.duration||0;h=h||0,this.property=o,this.value=l,this.begin=h+g,this.end=this.begin+x,o.specification.transition&&(p.delay||p.duration)&&(this.prior=u)}possiblyEvaluate(o,l,u){let p=o.now||0,h=this.value.possiblyEvaluate(o,l,u),g=this.prior;if(g){if(p>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(p<this.begin)return g.possiblyEvaluate(o,l,u);{let x=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(o,l,u),h,Ya(x))}}return h}}class yf{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,l,u){let p=new Ch(this._properties);for(let h of Object.keys(this._values))p._values[h]=this._values[h].possiblyEvaluate(o,l,u);return p}hasTransition(){for(let o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class xh{constructor(o,l,u){this._properties=o,this._values=Object.create(o.defaultPropertyValues),this._scope=l,this._options=u,this.configDependencies=new Set}getValue(o){return fs(this._values[o].value)}setValue(o,l){this._values[o]=new bh(this._values[o].property,l===null?void 0:fs(l),this._scope,this._options),this._values[o].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[o].expression.configDependencies]))}serialize(){let o={};for(let l of Object.keys(this._values)){let u=this.getValue(l);u!==void 0&&(o[l]=u)}return o}possiblyEvaluate(o,l,u){let p=new Ch(this._properties);for(let h of Object.keys(this._values))p._values[h]=this._values[h].possiblyEvaluate(o,l,u);return p}}class wh{constructor(o,l,u){this.property=o,this.value=l,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(o){return this.value.kind==="constant"?this.value.value:o}evaluate(o,l,u,p){return this.property.evaluate(this.value,this.parameters,o,l,u,p)}}class Ch{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class It{constructor(o){this.specification=o}possiblyEvaluate(o,l){return o.expression.evaluate(l)}interpolate(o,l,u){let p=Qp[this.specification.type];return p?p(o,l,u):o}}class Ht{constructor(o,l){this.specification=o,this.overrides=l}possiblyEvaluate(o,l,u,p){return new wh(this,o.expression.kind==="constant"||o.expression.kind==="camera"?{kind:"constant",value:o.expression.evaluate(l,null,{},u,p)}:o.expression,l)}interpolate(o,l,u){if(o.value.kind!=="constant"||l.value.kind!=="constant")return o;if(o.value.value===void 0||l.value.value===void 0)return new wh(this,{kind:"constant",value:void 0},o.parameters);let p=Qp[this.specification.type];return p?new wh(this,{kind:"constant",value:p(o.value.value,l.value.value,u)},o.parameters):o}evaluate(o,l,u,p,h,g){return o.kind==="constant"?o.value:o.evaluate(l,u,p,h,g)}}class Eh{constructor(o){this.specification=o}possiblyEvaluate(o,l,u,p){return!!o.expression.evaluate(l,null,{},u,p)}interpolate(){return!1}}class Sr{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];let l=new ir(0,{});for(let u in o){let p=o[u];p.specification.overridable&&this.overridableProperties.push(u);let h=this.defaultPropertyValues[u]=new bh(p,void 0),g=this.defaultTransitionablePropertyValues[u]=new kv(p);this.defaultTransitioningPropertyValues[u]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=h.possiblyEvaluate(l)}}}$t(Ht,"DataDrivenProperty"),$t(It,"DataConstantProperty"),$t(Eh,"ColorRampProperty");var We=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow","experimental":true},"rain":{"type":"rain","experimental":true},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor","experimental":true},"imports":{"type":"array","value":"import"},"iconsets":{"experimental":true,"type":"iconsets"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"experimental":true,"type":"*"},"selectors":{"experimental":true,"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"experimental":true,"type":"string","required":true},"properties":{"experimental":true,"type":"selectorProperty","required":false},"featureNamespace":{"experimental":true,"type":"string","required":false},"_uniqueFeatureID":{"experimental":true,"type":"boolean","private":true,"required":false}},"selectorProperty":{"experimental":true,"*":{"experimental":true,"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-quality":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]},"experimental":true},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"required":true,"type":"enum","values":{"sprite":1}},"url":{"required":true,"type":"string"}},"iconset_source":{"type":{"required":true,"type":"enum","values":{"source":1}},"source":{"required":true,"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant"},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","experimental":true,"private":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","experimental":true,"private":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.4,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","property-type":"data-constant","default":0.71,"minimum":0,"maximum":5,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.57,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","property-type":"data-constant","default":0.7,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}},"buildingFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","experimental":true,"private":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","transition":true,"experimental":true,"private":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"experimental":true,"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"*"}}}');function Dw(d){return d instanceof Number||d instanceof String||d instanceof Boolean?d.valueOf():d}function Sg(d){if(Array.isArray(d))return d.map(Sg);if(d instanceof Object&&!(d instanceof Number||d instanceof String||d instanceof Boolean)){let o={};for(let l in d)o[l]=Sg(d[l]);return o}return Dw(d)}function Ov(d){if(d===!0||d===!1)return!0;if(!Array.isArray(d)||d.length===0)return!1;switch(d[0]){case"has":return d.length>=2&&d[1]!=="$id"&&d[1]!=="$type";case"in":return d.length>=3&&(typeof d[1]!="string"||Array.isArray(d[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return d.length!==3||Array.isArray(d[1])||Array.isArray(d[2]);case"any":case"all":for(let o of d.slice(1))if(!Ov(o)&&typeof o!="boolean")return!1;return!0;default:return!0}}function Fv(d,o="",l=null,u="fill"){if(d==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Ov(d)||(d=Dg(d));let p=d,h=!0;try{h=function(v){if(!Sh(v))return v;let E=Sg(v);return Tw(E),E=Mw(E),E}(p)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(p,null,2)}
        `)}let g=null,x=null;if(u!=="background"&&u!=="sky"&&u!=="slot"){x=We[`filter_${u}`];let v=gh(h,x,o,l);if(v.result==="error")throw new Error(v.value.map(E=>`${E.key}: ${E.message}`).join(", "));g=(E,T,S)=>v.value.evaluate(E,T,{},S)}let C=null,D=null;if(h!==p){let v=gh(p,x,o,l);if(v.result==="error")throw new Error(v.value.map(E=>`${E.key}: ${E.message}`).join(", "));C=(E,T,S,M,R)=>v.value.evaluate(E,T,{},S,void 0,void 0,M,R),D=!dh(v.value.expression)}return{filter:g,dynamicFilter:C||void 0,needGeometry:Iw(h),needFeature:!!D}}function Mw(d){if(!Array.isArray(d))return d;let o=function(l){if(HM.has(l[0])){for(let u=1;u<l.length;u++)if(Sh(l[u]))return!0}return l}(d);return o===!0?o:o.map(l=>Mw(l))}function Tw(d){let o=!1,l=[];if(d[0]==="case"){for(let u=1;u<d.length-1;u+=2)o=o||Sh(d[u]),l.push(d[u+1]);l.push(d[d.length-1])}else if(d[0]==="match"){o=o||Sh(d[1]);for(let u=2;u<d.length-1;u+=2)l.push(d[u+1]);l.push(d[d.length-1])}else if(d[0]==="step"){o=o||Sh(d[1]);for(let u=1;u<d.length-1;u+=2)l.push(d[u+1])}o&&(d.length=0,d.push("any",...l));for(let u=1;u<d.length;u++)Tw(d[u])}function Sh(d){if(!Array.isArray(d))return!1;if((o=d[0])==="pitch"||o==="distance-from-center")return!0;var o;for(let l=1;l<d.length;l++)if(Sh(d[l]))return!0;return!1}let HM=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function $M(d,o){return d<o?-1:d>o?1:0}function Iw(d){if(!Array.isArray(d))return!1;if(d[0]==="within"||d[0]==="distance")return!0;for(let o=1;o<d.length;o++)if(Iw(d[o]))return!0;return!1}function Dg(d){if(!d)return!0;let o=d[0];return d.length<=1?o!=="any":o==="=="?hd(d[1],d[2],"=="):o==="!="?au(hd(d[1],d[2],"==")):o==="<"||o===">"||o==="<="||o===">="?hd(d[1],d[2],o):o==="any"?(l=d.slice(1),["any"].concat(l.map(Dg))):o==="all"?["all"].concat(d.slice(1).map(Dg)):o==="none"?["all"].concat(d.slice(1).map(Dg).map(au)):o==="in"?Lv(d[1],d.slice(2)):o==="!in"?au(Lv(d[1],d.slice(2))):o==="has"?Nv(d[1]):o!=="!has"||au(Nv(d[1]));var l}function hd(d,o,l){switch(d){case"$type":return[`filter-type-${l}`,o];case"$id":return[`filter-id-${l}`,o];default:return[`filter-${l}`,d,o]}}function Lv(d,o){if(o.length===0)return!1;switch(d){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(l=>typeof l!=typeof o[0])?["filter-in-large",d,["literal",o.sort($M)]]:["filter-in-small",d,["literal",o]]}}function Nv(d){switch(d){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",d]}}function au(d){return["!",d]}let Mg="";function Dh(d,o){return o?`${d}${Mg}${o}`:d}let xc="-transition",Aw=new Set(["fill","line","background","hillshade","raster"]);class Po extends hl{constructor(o,l,u,p,h){if(super(),this.id=o.id,this.fqid=Dh(this.id,u),this.type=o.type,this.scope=u,this.lut=p,this.options=h,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,o.type!=="custom"){if(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,o.type&&o.type!=="background"&&o.type!=="sky"&&o.type!=="slot"){this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter;let g=gh(this.filter,We[`filter_${o.type}`]);g.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...g.value.configDependencies]))}if(o.slot&&(this.slot=o.slot),l.layout&&(this._unevaluatedLayout=new xh(l.layout,this.scope,h),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),l.paint){this._transitionablePaint=new Pv(l.paint,this.scope,h);for(let g in o.paint)this.setPaintProperty(g,o.paint[g]);for(let g in o.layout)this.setLayoutProperty(g,o.layout[g]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ch(l.paint)}}}onAdd(o){}onRemove(o){}isDraped(o){return!this.is3D(!0)&&Aw.has(this.type)}getLayoutProperty(o){return o==="visibility"?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,l){if(this.type==="custom"&&o==="visibility")return void(this.visibility=l);let u=this._unevaluatedLayout;u._properties.properties[o]&&(u.setValue(o,l),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),o==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(o){return o.endsWith(xc)?this._transitionablePaint.getTransition(o.slice(0,-11)):this._transitionablePaint.getValue(o)}setPaintProperty(o,l){let u=this._transitionablePaint,p=u._properties.properties;if(o.endsWith(xc)){let E=o.slice(0,-11);return p[E]&&u.setTransition(E,l||void 0),!1}if(!p[o])return!1;let h=u._values[o],g=h.value.isDataDriven(),x=h.value;u.setValue(o,l),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),this._handleSpecialPaintPropertyUpdate(o);let C=u._values[o].value,D=C.isDataDriven(),v=o.endsWith("pattern")||o==="line-dasharray";return D||g||v||this._handleOverridablePaintPropertyUpdate(o,x,C)}_handleSpecialPaintPropertyUpdate(o){}getProgramIds(){return null}getDefaultProgramParams(o,l,u){return null}_handleOverridablePaintPropertyUpdate(o,l,u){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||this.visibility==="none"}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,l){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,l)}serialize(){return Kd({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(o,l)=>!(o===void 0||l==="layout"&&!Object.keys(o).length||l==="paint"&&!Object.keys(o).length))}is3D(o){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(let o in this.paint._values){let l=this.paint.get(o);if(l instanceof wh&&mh(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}compileFilter(o){this._filterCompiled||(this._featureFilter=Fv(this.filter,this.scope,o),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(o){this._stats&&(o.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(o){}queryIntersectsFeature(o,l,u,p,h,g,x,C,D){}}let GM={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class vf{constructor(o,l){this._structArray=o,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class cr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,l){return o._trim(),l&&(o.isTransferred=!0,l.add(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){let l=Object.create(this.prototype);return l.arrayBuffer=o.arrayBuffer,l.length=o.length,l.capacity=o.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...o){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...o){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function En(d,o=1){let l=0,u=0;return{members:d.map(p=>{let h=GM[p.type].BYTES_PER_ELEMENT,g=l=Rw(l,Math.max(o,h)),x=p.components||1;return u=Math.max(u,h),l+=h*x,{name:p.name,type:p.type,components:x,offset:g}}),size:Rw(l,Math.max(u,o)),alignment:o}}function Rw(d,o){return Math.ceil(d/o)*o}class wc extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l){let u=this.length;return this.resize(u+1),this.emplace(u,o,l)}emplace(o,l,u){let p=2*o;return this.int16[p+0]=l,this.int16[p+1]=u,o}}wc.prototype.bytesPerElement=4,$t(wc,"StructArrayLayout2i4");class Mh extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,u){let p=this.length;return this.resize(p+1),this.emplace(p,o,l,u)}emplace(o,l,u,p){let h=3*o;return this.int16[h+0]=l,this.int16[h+1]=u,this.int16[h+2]=p,o}}Mh.prototype.bytesPerElement=6,$t(Mh,"StructArrayLayout3i6");class Cc extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,u,p){let h=this.length;return this.resize(h+1),this.emplace(h,o,l,u,p)}emplace(o,l,u,p,h){let g=4*o;return this.int16[g+0]=l,this.int16[g+1]=u,this.int16[g+2]=p,this.int16[g+3]=h,o}}Cc.prototype.bytesPerElement=8,$t(Cc,"StructArrayLayout4i8");class su extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){let l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.float32[1*o+0]=l,o}}su.prototype.bytesPerElement=4,$t(su,"StructArrayLayout1f4");class bf extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u){let p=this.length;return this.resize(p+1),this.emplace(p,o,l,u)}emplace(o,l,u,p){let h=4*o,g=2*o;return this.int16[h+0]=l,this.int16[h+1]=u,this.float32[g+1]=p,o}}bf.prototype.bytesPerElement=8,$t(bf,"StructArrayLayout2i1f8");class zv extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,u){let p=this.length;return this.resize(p+1),this.emplace(p,o,l,u)}emplace(o,l,u,p){let h=4*o;return this.int16[h+0]=l,this.int16[h+1]=u,this.int16[h+2]=p,o}}zv.prototype.bytesPerElement=8,$t(zv,"StructArrayLayout3i8");class js extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,u,p,h){let g=this.length;return this.resize(g+1),this.emplace(g,o,l,u,p,h)}emplace(o,l,u,p,h,g){let x=5*o;return this.int16[x+0]=l,this.int16[x+1]=u,this.int16[x+2]=p,this.int16[x+3]=h,this.int16[x+4]=g,o}}js.prototype.bytesPerElement=10,$t(js,"StructArrayLayout5i10");class Bv extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,p,h,g,x){let C=this.length;return this.resize(C+1),this.emplace(C,o,l,u,p,h,g,x)}emplace(o,l,u,p,h,g,x,C){let D=6*o,v=12*o,E=3*o;return this.int16[D+0]=l,this.int16[D+1]=u,this.uint8[v+4]=p,this.uint8[v+5]=h,this.uint8[v+6]=g,this.uint8[v+7]=x,this.float32[E+2]=C,o}}Bv.prototype.bytesPerElement=12,$t(Bv,"StructArrayLayout2i4ub1f12");class gl extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u){let p=this.length;return this.resize(p+1),this.emplace(p,o,l,u)}emplace(o,l,u,p){let h=3*o;return this.float32[h+0]=l,this.float32[h+1]=u,this.float32[h+2]=p,o}}gl.prototype.bytesPerElement=12,$t(gl,"StructArrayLayout3f12");class pd extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,p,h){let g=this.length;return this.resize(g+1),this.emplace(g,o,l,u,p,h)}emplace(o,l,u,p,h,g){let x=6*o,C=3*o;return this.uint16[x+0]=l,this.uint16[x+1]=u,this.uint16[x+2]=p,this.uint16[x+3]=h,this.float32[C+2]=g,o}}pd.prototype.bytesPerElement=12,$t(pd,"StructArrayLayout4ui1f12");class Tg extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,u,p){let h=this.length;return this.resize(h+1),this.emplace(h,o,l,u,p)}emplace(o,l,u,p,h){let g=4*o;return this.uint16[g+0]=l,this.uint16[g+1]=u,this.uint16[g+2]=p,this.uint16[g+3]=h,o}}Tg.prototype.bytesPerElement=8,$t(Tg,"StructArrayLayout4ui8");class Ig extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,u,p,h,g){let x=this.length;return this.resize(x+1),this.emplace(x,o,l,u,p,h,g)}emplace(o,l,u,p,h,g,x){let C=6*o;return this.int16[C+0]=l,this.int16[C+1]=u,this.int16[C+2]=p,this.int16[C+3]=h,this.int16[C+4]=g,this.int16[C+5]=x,o}}Ig.prototype.bytesPerElement=12,$t(Ig,"StructArrayLayout6i12");class Vv extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,u,p,h,g,x,C,D,v,E,T){let S=this.length;return this.resize(S+1),this.emplace(S,o,l,u,p,h,g,x,C,D,v,E,T)}emplace(o,l,u,p,h,g,x,C,D,v,E,T,S){let M=12*o;return this.int16[M+0]=l,this.int16[M+1]=u,this.int16[M+2]=p,this.int16[M+3]=h,this.uint16[M+4]=g,this.uint16[M+5]=x,this.uint16[M+6]=C,this.uint16[M+7]=D,this.int16[M+8]=v,this.int16[M+9]=E,this.int16[M+10]=T,this.int16[M+11]=S,o}}Vv.prototype.bytesPerElement=24,$t(Vv,"StructArrayLayout4i4ui4i24");class jv extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,p,h,g){let x=this.length;return this.resize(x+1),this.emplace(x,o,l,u,p,h,g)}emplace(o,l,u,p,h,g,x){let C=10*o,D=5*o;return this.int16[C+0]=l,this.int16[C+1]=u,this.int16[C+2]=p,this.float32[D+2]=h,this.float32[D+3]=g,this.float32[D+4]=x,o}}jv.prototype.bytesPerElement=20,$t(jv,"StructArrayLayout3i3f20");class lu extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,p){let h=this.length;return this.resize(h+1),this.emplace(h,o,l,u,p)}emplace(o,l,u,p,h){let g=4*o;return this.float32[g+0]=l,this.float32[g+1]=u,this.float32[g+2]=p,this.float32[g+3]=h,o}}lu.prototype.bytesPerElement=16,$t(lu,"StructArrayLayout4f16");class Uv extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){let l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint32[1*o+0]=l,o}}Uv.prototype.bytesPerElement=4,$t(Uv,"StructArrayLayout1ul4");class fd extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l){let u=this.length;return this.resize(u+1),this.emplace(u,o,l)}emplace(o,l,u){let p=2*o;return this.uint16[p+0]=l,this.uint16[p+1]=u,o}}fd.prototype.bytesPerElement=4,$t(fd,"StructArrayLayout2ui4");class Hv extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,u,p,h,g,x,C,D,v,E,T,S){let M=this.length;return this.resize(M+1),this.emplace(M,o,l,u,p,h,g,x,C,D,v,E,T,S)}emplace(o,l,u,p,h,g,x,C,D,v,E,T,S,M){let R=20*o,L=10*o;return this.int16[R+0]=l,this.int16[R+1]=u,this.int16[R+2]=p,this.int16[R+3]=h,this.int16[R+4]=g,this.float32[L+3]=x,this.float32[L+4]=C,this.float32[L+5]=D,this.float32[L+6]=v,this.int16[R+14]=E,this.uint32[L+8]=T,this.uint16[R+18]=S,this.uint16[R+19]=M,o}}Hv.prototype.bytesPerElement=40,$t(Hv,"StructArrayLayout5i4f1i1ul2ui40");class xf extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,u,p,h,g,x){let C=this.length;return this.resize(C+1),this.emplace(C,o,l,u,p,h,g,x)}emplace(o,l,u,p,h,g,x,C){let D=8*o;return this.int16[D+0]=l,this.int16[D+1]=u,this.int16[D+2]=p,this.int16[D+4]=h,this.int16[D+5]=g,this.int16[D+6]=x,this.int16[D+7]=C,o}}xf.prototype.bytesPerElement=16,$t(xf,"StructArrayLayout3i2i2i16");class $v extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,u,p,h){let g=this.length;return this.resize(g+1),this.emplace(g,o,l,u,p,h)}emplace(o,l,u,p,h,g){let x=4*o,C=8*o;return this.float32[x+0]=l,this.float32[x+1]=u,this.float32[x+2]=p,this.int16[C+6]=h,this.int16[C+7]=g,o}}$v.prototype.bytesPerElement=16,$t($v,"StructArrayLayout2f1f2i16");class Gv extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,p,h,g){let x=this.length;return this.resize(x+1),this.emplace(x,o,l,u,p,h,g)}emplace(o,l,u,p,h,g,x){let C=20*o,D=5*o;return this.uint8[C+0]=l,this.uint8[C+1]=u,this.float32[D+1]=p,this.float32[D+2]=h,this.float32[D+3]=g,this.float32[D+4]=x,o}}Gv.prototype.bytesPerElement=20,$t(Gv,"StructArrayLayout2ub4f20");class Uo extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,u){let p=this.length;return this.resize(p+1),this.emplace(p,o,l,u)}emplace(o,l,u,p){let h=3*o;return this.uint16[h+0]=l,this.uint16[h+1]=u,this.uint16[h+2]=p,o}}Uo.prototype.bytesPerElement=6,$t(Uo,"StructArrayLayout3ui6");class Ag extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,l,u,p,h,g,x,C,D,v,E,T,S,M,R,L,N,$,H,j,q){let Y=this.length;return this.resize(Y+1),this.emplace(Y,o,l,u,p,h,g,x,C,D,v,E,T,S,M,R,L,N,$,H,j,q)}emplace(o,l,u,p,h,g,x,C,D,v,E,T,S,M,R,L,N,$,H,j,q,Y){let Q=30*o,pe=15*o,de=60*o;return this.int16[Q+0]=l,this.int16[Q+1]=u,this.int16[Q+2]=p,this.float32[pe+2]=h,this.float32[pe+3]=g,this.uint16[Q+8]=x,this.uint16[Q+9]=C,this.uint32[pe+5]=D,this.uint32[pe+6]=v,this.uint32[pe+7]=E,this.uint16[Q+16]=T,this.uint16[Q+17]=S,this.uint16[Q+18]=M,this.float32[pe+10]=R,this.float32[pe+11]=L,this.uint8[de+48]=N,this.uint8[de+49]=$,this.uint8[de+50]=H,this.uint32[pe+13]=j,this.int16[Q+28]=q,this.uint8[de+58]=Y,o}}Ag.prototype.bytesPerElement=60,$t(Ag,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Rg extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,l,u,p,h,g,x,C,D,v,E,T,S,M,R,L,N,$,H,j,q,Y,Q,pe,de,ue,De,fe,Me,Fe,Pe,ze,Ne){let Ge=this.length;return this.resize(Ge+1),this.emplace(Ge,o,l,u,p,h,g,x,C,D,v,E,T,S,M,R,L,N,$,H,j,q,Y,Q,pe,de,ue,De,fe,Me,Fe,Pe,ze,Ne)}emplace(o,l,u,p,h,g,x,C,D,v,E,T,S,M,R,L,N,$,H,j,q,Y,Q,pe,de,ue,De,fe,Me,Fe,Pe,ze,Ne,Ge){let Ue=20*o,qe=40*o,gt=80*o;return this.float32[Ue+0]=l,this.float32[Ue+1]=u,this.int16[qe+4]=p,this.int16[qe+5]=h,this.int16[qe+6]=g,this.int16[qe+7]=x,this.int16[qe+8]=C,this.int16[qe+9]=D,this.int16[qe+10]=v,this.int16[qe+11]=E,this.int16[qe+12]=T,this.uint16[qe+13]=S,this.uint16[qe+14]=M,this.uint16[qe+15]=R,this.uint16[qe+16]=L,this.uint16[qe+17]=N,this.uint16[qe+18]=$,this.uint16[qe+19]=H,this.uint16[qe+20]=j,this.uint16[qe+21]=q,this.uint16[qe+22]=Y,this.uint16[qe+23]=Q,this.uint16[qe+24]=pe,this.uint16[qe+25]=de,this.uint16[qe+26]=ue,this.uint16[qe+27]=De,this.uint32[Ue+14]=fe,this.float32[Ue+15]=Me,this.float32[Ue+16]=Fe,this.float32[Ue+17]=Pe,this.float32[Ue+18]=ze,this.uint8[gt+76]=Ne,this.uint16[qe+39]=Ge,o}}Rg.prototype.bytesPerElement=80,$t(Rg,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class Ka extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,p,h){let g=this.length;return this.resize(g+1),this.emplace(g,o,l,u,p,h)}emplace(o,l,u,p,h,g){let x=5*o;return this.float32[x+0]=l,this.float32[x+1]=u,this.float32[x+2]=p,this.float32[x+3]=h,this.float32[x+4]=g,o}}Ka.prototype.bytesPerElement=20,$t(Ka,"StructArrayLayout5f20");class kg extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,p,h,g,x){let C=this.length;return this.resize(C+1),this.emplace(C,o,l,u,p,h,g,x)}emplace(o,l,u,p,h,g,x,C){let D=7*o;return this.float32[D+0]=l,this.float32[D+1]=u,this.float32[D+2]=p,this.float32[D+3]=h,this.float32[D+4]=g,this.float32[D+5]=x,this.float32[D+6]=C,o}}kg.prototype.bytesPerElement=28,$t(kg,"StructArrayLayout7f28");class qv extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,p,h,g,x,C,D,v,E){let T=this.length;return this.resize(T+1),this.emplace(T,o,l,u,p,h,g,x,C,D,v,E)}emplace(o,l,u,p,h,g,x,C,D,v,E,T){let S=11*o;return this.float32[S+0]=l,this.float32[S+1]=u,this.float32[S+2]=p,this.float32[S+3]=h,this.float32[S+4]=g,this.float32[S+5]=x,this.float32[S+6]=C,this.float32[S+7]=D,this.float32[S+8]=v,this.float32[S+9]=E,this.float32[S+10]=T,o}}qv.prototype.bytesPerElement=44,$t(qv,"StructArrayLayout11f44");class Wv extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,p,h,g,x,C,D){let v=this.length;return this.resize(v+1),this.emplace(v,o,l,u,p,h,g,x,C,D)}emplace(o,l,u,p,h,g,x,C,D,v){let E=9*o;return this.float32[E+0]=l,this.float32[E+1]=u,this.float32[E+2]=p,this.float32[E+3]=h,this.float32[E+4]=g,this.float32[E+5]=x,this.float32[E+6]=C,this.float32[E+7]=D,this.float32[E+8]=v,o}}Wv.prototype.bytesPerElement=36,$t(Wv,"StructArrayLayout9f36");class Th extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l){let u=this.length;return this.resize(u+1),this.emplace(u,o,l)}emplace(o,l,u){let p=2*o;return this.float32[p+0]=l,this.float32[p+1]=u,o}}Th.prototype.bytesPerElement=8,$t(Th,"StructArrayLayout2f8");class wf extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,u,p){let h=this.length;return this.resize(h+1),this.emplace(h,o,l,u,p)}emplace(o,l,u,p,h){let g=6*o;return this.uint32[3*o+0]=l,this.uint16[g+2]=u,this.uint16[g+3]=p,this.uint16[g+4]=h,o}}wf.prototype.bytesPerElement=12,$t(wf,"StructArrayLayout1ul3ui12");class Pg extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){let l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint16[1*o+0]=l,o}}Pg.prototype.bytesPerElement=2,$t(Pg,"StructArrayLayout1ui2");class Og extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,p,h,g,x,C,D,v,E,T,S,M,R,L){let N=this.length;return this.resize(N+1),this.emplace(N,o,l,u,p,h,g,x,C,D,v,E,T,S,M,R,L)}emplace(o,l,u,p,h,g,x,C,D,v,E,T,S,M,R,L,N){let $=16*o;return this.float32[$+0]=l,this.float32[$+1]=u,this.float32[$+2]=p,this.float32[$+3]=h,this.float32[$+4]=g,this.float32[$+5]=x,this.float32[$+6]=C,this.float32[$+7]=D,this.float32[$+8]=v,this.float32[$+9]=E,this.float32[$+10]=T,this.float32[$+11]=S,this.float32[$+12]=M,this.float32[$+13]=R,this.float32[$+14]=L,this.float32[$+15]=N,o}}Og.prototype.bytesPerElement=64,$t(Og,"StructArrayLayout16f64");class Fg extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,p,h,g,x){let C=this.length;return this.resize(C+1),this.emplace(C,o,l,u,p,h,g,x)}emplace(o,l,u,p,h,g,x,C){let D=10*o,v=5*o;return this.uint16[D+0]=l,this.uint16[D+1]=u,this.uint16[D+2]=p,this.uint16[D+3]=h,this.float32[v+2]=g,this.float32[v+3]=x,this.float32[v+4]=C,o}}Fg.prototype.bytesPerElement=20,$t(Fg,"StructArrayLayout4ui3f20");class Lg extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o){let l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.int16[1*o+0]=l,o}}Lg.prototype.bytesPerElement=2,$t(Lg,"StructArrayLayout1i2");class Yv extends cr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(o){let l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint8[1*o+0]=l,o}}Yv.prototype.bytesPerElement=1,$t(Yv,"StructArrayLayout1ub1");class Zv extends vf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Zv.prototype.size=40;class Cf extends Hv{get(o){return new Zv(this,o)}}$t(Cf,"CollisionBoxArray");class kw extends vf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(o){this._structArray.uint8[this._pos1+49]=o}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(o){this._structArray.uint8[this._pos1+50]=o}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(o){this._structArray.uint32[this._pos4+13]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(o){this._structArray.uint8[this._pos1+58]=o}}kw.prototype.size=60;class Pw extends Ag{get(o){return new kw(this,o)}}$t(Pw,"PlacedSymbolArray");class Ow extends vf{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(o){this._structArray.uint32[this._pos4+14]=o}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(o){this._structArray.float32[this._pos4+18]=o}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}Ow.prototype.size=80;class Fw extends Rg{get(o){return new Ow(this,o)}}$t(Fw,"SymbolInstanceArray");class Lw extends su{getoffsetX(o){return this.float32[1*o+0]}}$t(Lw,"GlyphOffsetArray");class Ef extends wc{getx(o){return this.int16[2*o+0]}gety(o){return this.int16[2*o+1]}}$t(Ef,"SymbolLineVertexArray");class Sf extends vf{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Sf.prototype.size=12;class Qa extends wf{get(o){return new Sf(this,o)}}$t(Qa,"FeatureIndexArray");class Df extends fd{geta_centroid_pos0(o){return this.uint16[2*o+0]}geta_centroid_pos1(o){return this.uint16[2*o+1]}}$t(Df,"FillExtrusionCentroidArray");class Nw extends vf{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}Nw.prototype.size=6;class zw extends Mh{get(o){return new Nw(this,o)}}$t(zw,"FillExtrusionWallArray");let qM=En([{name:"a_pos",components:2,type:"Int16"}],4),WM=En([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class _r{constructor(o=[]){this.segments=o}_prepareSegment(o,l,u,p){let h=this.segments[this.segments.length-1];return o>_r.MAX_VERTEX_ARRAY_LENGTH&&Er(`Max vertices per segment is ${_r.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!h||h.vertexLength+o>_r.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==p)&&(h={vertexOffset:l,primitiveOffset:u,vertexLength:0,primitiveLength:0},p!==void 0&&(h.sortKey=p),this.segments.push(h)),h}prepareSegment(o,l,u,p){return this._prepareSegment(o,l.length,u.length,p)}get(){return this.segments}destroy(){for(let o of this.segments)for(let l in o.vaos)o.vaos[l].destroy()}static simpleSegment(o,l,u,p){return new _r([{vertexOffset:o,primitiveOffset:l,vertexLength:u,primitiveLength:p,vaos:{},sortKey:0}])}}function Bw(d,o){return 256*(d=qi(Math.floor(d),0,255))+qi(Math.floor(o),0,255)}_r.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,$t(_r,"SegmentVector");let Xv=En([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),YM=En([{name:"a_dash",components:4,type:"Uint16"}]);class Mf{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(o,l,u,p){this.ids.push(Kv(o)),this.positions.push(l,u,p)}eachPosition(o,l){let u=Kv(o),p=0,h=this.ids.length-1;for(;p<h;){let g=p+h>>1;this.ids[g]>=u?h=g:p=g+1}for(;this.ids[p]===u;)l(this.positions[3*p],this.positions[3*p+1],this.positions[3*p+2]),p++}static serialize(o,l){let u=new Float64Array(o.ids),p=new Uint32Array(o.positions);return Tf(u,p,0,u.length-1),l&&(l.add(u.buffer),l.add(p.buffer)),{ids:u,positions:p}}static deserialize(o){let l=new Mf,u;l.ids=o.ids,l.positions=o.positions;for(let p of l.ids)p!==u&&l.uniqueIds.push(p),u=p;return l.indexed=!0,l}}function Kv(d){let o=+d;return!isNaN(o)&&Number.MIN_SAFE_INTEGER<=o&&o<=Number.MAX_SAFE_INTEGER?o:gs(String(d))}function Tf(d,o,l,u){for(;l<u;){let p=d[l+u>>1],h=l-1,g=u+1;for(;;){do h++;while(d[h]<p);do g--;while(d[g]>p);if(h>=g)break;Ng(d,h,g),Ng(o,3*h,3*g),Ng(o,3*h+1,3*g+1),Ng(o,3*h+2,3*g+2)}g-l<u-g?(Tf(d,o,l,g),l=g+1):(Tf(d,o,g+1,u),u=g)}}function Ng(d,o,l){let u=d[o];d[o]=d[l],d[l]=u}$t(Mf,"FeaturePositionMap");class Fl{constructor(o){this.gl=o.gl,this.initialized=!1}fetchUniformLocation(o,l){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(o,l),this.initialized=!0),!!this.location}set(o,l,u){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class If extends Fl{constructor(o){super(o),this.current=0}set(o,l,u){this.fetchUniformLocation(o,l)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}}class $r extends Fl{constructor(o){super(o),this.current=0}set(o,l,u){this.fetchUniformLocation(o,l)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class Us extends Fl{constructor(o){super(o),this.current=[0,0]}set(o,l,u){this.fetchUniformLocation(o,l)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}}class Ih extends Fl{constructor(o){super(o),this.current=[0,0,0]}set(o,l,u){this.fetchUniformLocation(o,l)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}}class Af extends Fl{constructor(o){super(o),this.current=[0,0,0,0]}set(o,l,u){this.fetchUniformLocation(o,l)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class Vw extends Fl{constructor(o){super(o),this.current=Ln.transparent.toRenderColor(null)}set(o,l,u){this.fetchUniformLocation(o,l)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}let jw=new Float32Array(16);class Rf extends Fl{constructor(o){super(o),this.current=jw}set(o,l,u){if(this.fetchUniformLocation(o,l)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let p=1;p<16;p++)if(u[p]!==this.current[p]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}}let Qv=new Float32Array(9),ZM=new Float32Array(4);class Jv extends Fl{constructor(o){super(o),this.current=ZM}set(o,l,u){if(this.fetchUniformLocation(o,l)){for(let p=0;p<4;p++)if(u[p]!==this.current[p]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}}function e0(d){return[Bw(255*d.r,255*d.g),Bw(255*d.b,255*d.a)]}class kf{constructor(o,l,u,p){this.value=o,this.uniformNames=l.map(h=>`u_${h}`),this.type=u,this.context=p}setUniform(o,l,u,p,h){let g=p.constantOr(this.value);l.set(o,h,g instanceof Ln?g.toRenderColor(this.lutExpression&&this.lutExpression.value==="none"?null:this.context.lut):g)}getBinding(o,l){return this.type==="color"?new Vw(o):new $r(o)}}class cu{constructor(o,l){this.uniformNames=l.map(u=>`u_${u}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(o){this.pixelRatio=o.pixelRatio||1,this.pattern=o.tl.concat(o.br)}setUniform(o,l,u,p,h){let g=h==="u_pattern"||h==="u_dash"?this.pattern:h==="u_pixel_ratio"?this.pixelRatio:null;g&&l.set(o,h,g)}getBinding(o,l){return l==="u_pattern"||l==="u_dash"?new Af(o):new $r(o)}}class Ec{constructor(o,l,u,p){this.expression=o,this.type=u,this.maxValue=0,this.paintVertexAttributes=l.map(h=>({name:`a_${h}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(o,l,u,p,h,g,x){let C=this.paintVertexArray.length,D=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new ir(0,{brightness:g}),l,{},h,p,x):this.expression.kind==="constant"&&this.expression.value,v=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ir(0,{brightness:g}),l,{},h,p,x):this.lutExpression.value)==="none";this.paintVertexArray.resize(o),this._setPaintValue(C,o,D,v?null:this.context.lut)}updatePaintArray(o,l,u,p,h,g,x){let C=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:x},u,p,void 0,h):this.expression.kind==="constant"&&this.expression.value,D=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ir(0,{brightness:x}),u,p,void 0,h):this.lutExpression.value)==="none";this._setPaintValue(o,l,C,D?null:this.context.lut)}_setPaintValue(o,l,u,p){if(this.type==="color"){let h=e0(u.toRenderColor(p));for(let g=o;g<l;g++)this.paintVertexArray.emplace(g,h[0],h[1])}else{for(let h=o;h<l;h++)this.paintVertexArray.emplace(h,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class _l{constructor(o,l,u,p,h,g){this.expression=o,this.uniformNames=l.map(x=>`u_${x}_t`),this.type=u,this.useIntegerZoom=p,this.context=h,this.maxValue=0,this.paintVertexAttributes=l.map(x=>({name:`a_${x}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(o,l,u,p,h,g,x){let C=this.expression.evaluate(new ir(this.context.zoom,{brightness:g}),l,{},h,p,x),D=this.expression.evaluate(new ir(this.context.zoom+1,{brightness:g}),l,{},h,p,x),v=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ir(0,{brightness:g}),l,{},h,p,x):this.lutExpression.value)==="none",E=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(E,o,C,D,v?null:this.context.lut)}updatePaintArray(o,l,u,p,h,g,x){let C=this.expression.evaluate({zoom:this.context.zoom,brightness:x},u,p,void 0,h),D=this.expression.evaluate({zoom:this.context.zoom+1,brightness:x},u,p,void 0,h),v=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ir(0,{brightness:x}),u,p,void 0,h):this.lutExpression.value)==="none";this._setPaintValue(o,l,C,D,v?null:this.context.lut)}_setPaintValue(o,l,u,p,h){if(this.type==="color"){let g=e0(u.toRenderColor(h)),x=e0(u.toRenderColor(h));for(let C=o;C<l;C++)this.paintVertexArray.emplace(C,g[0],g[1],x[0],x[1])}else{for(let g=o;g<l;g++)this.paintVertexArray.emplace(g,u,p);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(p))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,l,u,p,h){let g=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,x=qi(this.expression.interpolationFactor(g,this.context.zoom,this.context.zoom+1),0,1);l.set(o,h,x)}getBinding(o,l){return new $r(o)}}class md{constructor(o,l,u,p,h){this.expression=o,this.layerId=h,this.paintVertexAttributes=(u==="array"?YM:Xv).members;for(let g=0;g<l.length;++g);this.paintVertexArray=new p}populatePaintArray(o,l,u,p){let h=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValues(h,o,l.patterns&&l.patterns[this.layerId],u)}updatePaintArray(o,l,u,p,h,g,x){this._setPaintValues(o,l,u.patterns&&u.patterns[this.layerId],g)}_setPaintValues(o,l,u,p){if(!p||!u)return;let h=p[u];if(!h)return;let{tl:g,br:x,pixelRatio:C}=h;for(let D=o;D<l;D++)this.paintVertexArray.emplace(D,g[0],g[1],x[0],x[1],C)}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class du{constructor(o,l,u=()=>!0){this.binders={},this._buffers=[],this.context=l;let p=[];for(let h in o.paint._values){let g=o.paint.get(h);if(h.endsWith("-use-theme")||!u(h)||!(g instanceof wh&&mh(g.property.specification)))continue;let x=KM(h,o.type),C=g.value,D=g.property.specification.type,v=!!g.property.useIntegerZoom,E=h==="line-dasharray"||h.endsWith("pattern"),T=o.paint.get(`${h}-use-theme`),S=h==="line-dasharray"&&o.layout.get("line-cap").value.kind!=="constant"||T&&T.value.kind!=="constant";if(C.kind!=="constant"||S)if(C.kind==="source"||S||E){let M=Uw(h,D,"source");this.binders[h]=E?new md(C,x,D,M,o.id):new Ec(C,x,D,M),p.push(`/a_${h}`)}else{let M=Uw(h,D,"composite");this.binders[h]=new _l(C,x,D,v,l,M),p.push(`/z_${h}`)}else this.binders[h]=E?new cu(C.value,x):new kf(C.value,x,D,l),p.push(`/u_${h}`);T&&(this.binders[h].lutExpression=T.value)}this.cacheKey=p.sort().join("")}getMaxValue(o){let l=this.binders[o];return l instanceof Ec||l instanceof _l?l.maxValue:0}populatePaintArrays(o,l,u,p,h,g,x){for(let C in this.binders){let D=this.binders[C];D.context=this.context,(D instanceof Ec||D instanceof _l||D instanceof md)&&D.populatePaintArray(o,l,u,p,h,g,x)}}setConstantPatternPositions(o){for(let l in this.binders){let u=this.binders[l];u instanceof cu&&u.setConstantPatternPositions(o)}}updatePaintArrays(o,l,u,p,h,g,x,C,D){let v=!1,E=Object.keys(o),T=E.length!==0&&!C,S=T?E:l.uniqueIds;this.context.lut=h.lut;for(let M in this.binders){let R=this.binders[M];if(R.context=this.context,(R instanceof Ec||R instanceof _l||R instanceof md)&&R.expression&&R.expression.kind&&R.expression.kind!=="constant"&&(R.expression.isStateDependent===!0||R.expression.isLightConstant===!1)){let L=h.paint.get(M);R.expression=L.value;for(let N of S){let $=o[N.toString()];l.eachPosition(N,(H,j,q)=>{let Y=p.feature(H);R.updatePaintArray(j,q,Y,$,g,x,D)})}if(!T)for(let N of u.uniqueIds){let $=o[N.toString()];u.eachPosition(N,(H,j,q)=>{let Y=p.feature(H);R.updatePaintArray(j,q,Y,$,g,x,D)})}v=!0}}return v}defines(){let o=[];for(let l in this.binders){let u=this.binders[l];(u instanceof kf||u instanceof cu)&&o.push(...u.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return o}getBinderAttributes(){let o=[];for(let l in this.binders){let u=this.binders[l];if(u instanceof Ec||u instanceof _l||u instanceof md)for(let p=0;p<u.paintVertexAttributes.length;p++)o.push(u.paintVertexAttributes[p].name)}return o}getBinderUniforms(){let o=[];for(let l in this.binders){let u=this.binders[l];if(u instanceof kf||u instanceof cu||u instanceof _l)for(let p of u.uniformNames)o.push(p)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o){let l=[];for(let u in this.binders){let p=this.binders[u];if(p instanceof kf||p instanceof cu||p instanceof _l)for(let h of p.uniformNames)l.push({name:h,property:u,binding:p.getBinding(o,h)})}return l}setUniforms(o,l,u,p,h){for(let{name:g,property:x,binding:C}of u)this.binders[x].setUniform(o,C,h,p.get(x),g)}updatePaintBuffers(){this._buffers=[];for(let o in this.binders){let l=this.binders[o];(l instanceof Ec||l instanceof _l||l instanceof md)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(o){for(let l in this.binders){let u=this.binders[l];(u instanceof Ec||u instanceof _l||u instanceof md)&&u.upload(o)}this.updatePaintBuffers()}destroy(){for(let o in this.binders){let l=this.binders[o];(l instanceof Ec||l instanceof _l||l instanceof md)&&l.destroy()}}}class gd{constructor(o,l,u=()=>!0){this.programConfigurations={};for(let p of o)this.programConfigurations[p.id]=new du(p,l,u);this.needsUpload=!1,this._featureMap=new Mf,this._featureMapWithoutIds=new Mf,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(o,l,u,p,h,g,x,C){for(let D in this.programConfigurations)this.programConfigurations[D].populatePaintArrays(o,l,p,h,g,x,C);l.id!==void 0?this._featureMap.add(l.id,u,this._bufferOffset,o):(this._featureMapWithoutIds.add(this._idlessCounter,u,this._bufferOffset,o),this._idlessCounter+=1),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,l,u,p,h,g,x){for(let C of u)this.needsUpload=this.programConfigurations[C.id].updatePaintArrays(o,this._featureMap,this._featureMapWithoutIds,l,C,p,h,g,x||0)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(let l in this.programConfigurations)this.programConfigurations[l].upload(o);this.needsUpload=!1}}destroy(){for(let o in this.programConfigurations)this.programConfigurations[o].destroy()}}let XM={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function KM(d,o){return XM[d]||[d.replace(`${o}-`,"").replace(/-/g,"_")]}let QM={"line-pattern":{source:pd,composite:pd},"fill-pattern":{source:pd,composite:pd},"fill-extrusion-pattern":{source:pd,composite:pd},"line-dasharray":{source:Tg,composite:Tg}},zg={color:{source:Th,composite:lu},number:{source:su,composite:Th}};function Uw(d,o,l){let u=QM[d];return u&&u[l]||zg[o][l]}$t(kf,"ConstantBinder"),$t(cu,"PatternConstantBinder"),$t(Ec,"SourceExpressionBinder"),$t(md,"PatternCompositeBinder"),$t(_l,"CompositeExpressionBinder"),$t(du,"ProgramConfiguration",{omit:["_buffers"]}),$t(gd,"ProgramConfigurationSet");let Na=kt/Math.PI/2,Ah=5,Hw=6,$w=16383,Rh=64,Bg=[Rh,32,16],bs=-Na,xs=Na;function kh(d,o,l,u=Na){return l=Qi(l),[d*Math.sin(l)*u,-o*u,d*Math.cos(l)*u]}function uu(d,o,l){return kh(Math.cos(Qi(d)),Math.sin(Qi(d)),o,l)}let hu=63710088e-1,t0=2*Math.PI*hu;class Sn{constructor(o,l){if(isNaN(o)||isNaN(l))throw new Error(`Invalid LngLat object: (${o}, ${l})`);if(this.lng=+o,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Sn(Os(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){let l=Math.PI/180,u=this.lat*l,p=o.lat*l,h=Math.sin(u)*Math.sin(p)+Math.cos(u)*Math.cos(p)*Math.cos((o.lng-this.lng)*l);return hu*Math.acos(Math.min(h,1))}toBounds(o=0){let l=360*o/40075017,u=l/Math.cos(Math.PI/180*this.lat);return new _d({lng:this.lng-u,lat:this.lat-l},{lng:this.lng+u,lat:this.lat+l})}toEcef(o){return uu(this.lat,this.lng,Na+o*Na/hu)}static convert(o){if(o instanceof Sn)return o;if(Array.isArray(o)&&(o.length===2||o.length===3))return new Sn(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&typeof o=="object"&&o!==null)return new Sn(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class _d{constructor(o,l){if(o)if(l)this.setSouthWest(o).setNorthEast(l);else if(o.length===4){let u=o;this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]])}else{let u=o;this.setSouthWest(u[0]).setNorthEast(u[1])}}setNorthEast(o){return this._ne=o instanceof Sn?new Sn(o.lng,o.lat):Sn.convert(o),this}setSouthWest(o){return this._sw=o instanceof Sn?new Sn(o.lng,o.lat):Sn.convert(o),this}extend(o){let l=this._sw,u=this._ne,p,h;if(o instanceof Sn)p=o,h=o;else{if(!(o instanceof _d))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(_d.convert(o)):this.extend(Sn.convert(o)):typeof o=="object"&&o!==null&&o.hasOwnProperty("lat")&&(o.hasOwnProperty("lon")||o.hasOwnProperty("lng"))?this.extend(Sn.convert(o)):this;if(p=o._sw,h=o._ne,!p||!h)return this}return l||u?(l.lng=Math.min(p.lng,l.lng),l.lat=Math.min(p.lat,l.lat),u.lng=Math.max(h.lng,u.lng),u.lat=Math.max(h.lat,u.lat)):(this._sw=new Sn(p.lng,p.lat),this._ne=new Sn(h.lng,h.lat)),this}getCenter(){return new Sn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Sn(this.getWest(),this.getNorth())}getSouthEast(){return new Sn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){let{lng:l,lat:u}=Sn.convert(o),p=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&p}static convert(o){if(o)return o instanceof _d?o:new _d(o)}}let JM=0,eT=25.5;function Vg(d){return t0*Math.cos(d*Math.PI/180)}function Ll(d){return(180+d)/360}function Ja(d){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d*Math.PI/360)))/360}function ea(d,o){return d/Vg(o)}function es(d){return 360*d-180}function Ho(d){return 360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90}function i0(d,o){return d*Vg(Ho(o))}let Nr=85.051129;function Gw(d){return Math.cos(Qi(qi(d,-Nr,Nr)))}function yd(d,o){let l=qi(o,JM,eT),u=Math.pow(2,l);return Gw(d)*t0/(512*u)}function tT(d){return 1/Math.cos(d*Math.PI/180)}function m(d,o=0){let l=Math.exp(Math.PI*(1-(d.y+o/kt)/(1<<d.z)*2));return 80150034*l/(l*l+1)/kt/(1<<d.z)}class a{constructor(o,l,u=0){this.x=+o,this.y=+l,this.z=+u}static fromLngLat(o,l=0){let u=Sn.convert(o);return new a(Ll(u.lng),Ja(u.lat),ea(l,u.lat))}toLngLat(){return new Sn(es(this.x),Ho(this.y))}toAltitude(){return i0(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/t0*tT(Ho(this.y))}}function c(d,o,l,u,p,h,g,x,C){let D=(o+u)/2,v=(l+p)/2,E=new At(D,v);x(E),function(T,S,M,R,L,N){let $=M-L,H=R-N;return Math.abs((R-S)*$-(M-T)*H)/Math.hypot($,H)}(E.x,E.y,h.x,h.y,g.x,g.y)>=C?(c(d,o,l,D,v,h,E,x,C),c(d,D,v,u,p,E,g,x,C)):d.push(g)}function f(d,o,l){let u=d[0],p=u.x,h=u.y;o(u);let g=[u];for(let x=1;x<d.length;x++){let C=d[x],{x:D,y:v}=C;o(C),c(g,p,h,D,v,u,C,o,l),p=D,h=v,u=C}return g}function _(d,o,l,u){if(u(o,l)){let p=o.add(l)._mult(.5);_(d,o,p,u),_(d,p,l,u)}else d.push(l)}function b(d,o){let l=d[0],u=[l];for(let p=1;p<d.length;p++){let h=d[p];_(u,l,h,o),l=h}return u}let w=Math.pow(2,14)-1,I=-w-1;function k(d,o){let l=Math.round(d.x*o),u=Math.round(d.y*o);return d.x=qi(l,I,w),d.y=qi(u,I,w),(l<d.x||l>d.x+1||u<d.y||u>d.y+1)&&Er("Geometry exceeds allowed extent, reduce your vector tile buffer size"),d}function O(d,o,l){let u=d.loadGeometry(),p=d.extent,h=kt/p;if(o&&l&&l.projection.isReprojectedInTileSpace){let g=1<<o.z,{scale:x,x:C,y:D,projection:v}=l,E=T=>{let S=es((o.x+T.x/p)/g),M=Ho((o.y+T.y/p)/g),R=v.project(S,M);T.x=(R.x*x-C)*p,T.y=(R.y*x-D)*p};for(let T=0;T<u.length;T++)if(d.type!==1)u[T]=f(u[T],E,1);else{let S=[];for(let M of u[T])M.x<0||M.x>=p||M.y<0||M.y>=p||(E(M),S.push(M));u[T]=S}}for(let g of u)for(let x of g)k(x,h);return u}function F(d,o){return{type:d.type,id:d.id,properties:d.properties,geometry:o?O(d):[]}}function z(d,o,l,u,p){d.emplaceBack(2*o+(u+1)/2,2*l+(p+1)/2)}function V(d,o,l){d.emplaceBack(o.x,o.y,o.z,l[0]*16384,l[1]*16384,l[2]*16384)}class G{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.hasPattern=!1,this.projection=o.projection,this.layoutVertexArray=new wc,this.indexArray=new Uo,this.segments=new _r,this.programConfigurations=new gd(o.layers,{zoom:o.zoom,lut:o.lut}),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}updateFootprints(o,l){}populate(o,l,u,p){let h=this.layers[0],g=[],x=null;h.type==="circle"&&(x=h.layout.get("circle-sort-key"));for(let{feature:D,id:v,index:E,sourceLayerIndex:T}of o){let S=this.layers[0]._featureFilter.needGeometry,M=F(D,S);if(!this.layers[0]._featureFilter.filter(new ir(this.zoom),M,u))continue;let R=x?x.evaluate(M,{},u):void 0,L={id:v,properties:D.properties,type:D.type,sourceLayerIndex:T,index:E,geometry:S?M.geometry:O(D,u,p),patterns:{},sortKey:R};g.push(L)}x&&g.sort((D,v)=>D.sortKey-v.sortKey);let C=null;p.projection.name==="globe"&&(this.globeExtVertexArray=new Ig,C=p.projection);for(let D of g){let{geometry:v,index:E,sourceLayerIndex:T}=D,S=o[E].feature;this.addFeature(D,v,E,l.availableImages,u,C,l.brightness),l.featureIndex.insert(S,v,E,T,this.index)}}update(o,l,u,p,h,g,x){this.programConfigurations.updatePaintArrays(o,l,h,u,p,g,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,qM.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,WM.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(o,l,u,p,h,g,x){for(let C of l)for(let D of C){let v=D.x,E=D.y;if(v<0||v>=kt||E<0||E>=kt)continue;if(g){let M=g.projectTilePoint(v,E,h),R=g.upVector(h,v,E),L=this.globeExtVertexArray;V(L,M,R),V(L,M,R),V(L,M,R),V(L,M,R)}let T=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),S=T.vertexLength;z(this.layoutVertexArray,v,E,-1,-1),z(this.layoutVertexArray,v,E,1,-1),z(this.layoutVertexArray,v,E,1,1),z(this.layoutVertexArray,v,E,-1,1),this.indexArray.emplaceBack(S,S+1,S+2),this.indexArray.emplaceBack(S,S+2,S+3),T.vertexLength+=4,T.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,u,{},p,h,x)}}function K(d,o){for(let l=0;l<d.length;l++)if(be(o,d[l]))return!0;for(let l=0;l<o.length;l++)if(be(d,o[l]))return!0;return!!he(d,o)}function W(d,o,l){return!!be(d,o)||!!me(o,d,l)}function te(d,o){if(d.length===1)return ve(o,d[0]);for(let l=0;l<o.length;l++){let u=o[l];for(let p=0;p<u.length;p++)if(be(d,u[p]))return!0}for(let l=0;l<d.length;l++)if(ve(o,d[l]))return!0;for(let l=0;l<o.length;l++)if(he(d,o[l]))return!0;return!1}function ne(d,o,l){if(d.length>1){if(he(d,o))return!0;for(let u=0;u<o.length;u++)if(me(o[u],d,l))return!0}for(let u=0;u<d.length;u++)if(me(d[u],o,l))return!0;return!1}function he(d,o){if(d.length===0||o.length===0)return!1;for(let l=0;l<d.length-1;l++){let u=d[l],p=d[l+1];for(let h=0;h<o.length-1;h++)if(_e(u,p,o[h],o[h+1]))return!0}return!1}function _e(d,o,l,u){return Kn(d,l,u)!==Kn(o,l,u)&&Kn(d,o,l)!==Kn(d,o,u)}function me(d,o,l){let u=l*l;if(o.length===1)return d.distSqr(o[0])<u;for(let p=1;p<o.length;p++)if(Se(d,o[p-1],o[p])<u)return!0;return!1}function Se(d,o,l){let u=o.distSqr(l);if(u===0)return d.distSqr(o);let p=((d.x-o.x)*(l.x-o.x)+(d.y-o.y)*(l.y-o.y))/u;return d.distSqr(p<0?o:p>1?l:l.sub(o)._mult(p)._add(o))}function ve(d,o){let l,u,p,h=!1;for(let g=0;g<d.length;g++){l=d[g];for(let x=0,C=l.length-1;x<l.length;C=x++)u=l[x],p=l[C],u.y>o.y!=p.y>o.y&&o.x<(p.x-u.x)*(o.y-u.y)/(p.y-u.y)+u.x&&(h=!h)}return h}function be(d,o){let l=!1;for(let u=0,p=d.length-1;u<d.length;p=u++){let h=d[u],g=d[p];h.y>o.y!=g.y>o.y&&o.x<(g.x-h.x)*(o.y-h.y)/(g.y-h.y)+h.x&&(l=!l)}return l}function xe(d,o,l,u,p){for(let g of d)if(o<=g.x&&l<=g.y&&u>=g.x&&p>=g.y)return!0;let h=[new At(o,l),new At(o,p),new At(u,p),new At(u,l)];if(d.length>2){for(let g of h)if(be(d,g))return!0}for(let g=0;g<d.length-1;g++)if(Ae(d[g],d[g+1],h))return!0;return!1}function Ae(d,o,l){let u=l[0],p=l[2];if(d.x<u.x&&o.x<u.x||d.x>p.x&&o.x>p.x||d.y<u.y&&o.y<u.y||d.y>p.y&&o.y>p.y)return!1;let h=Kn(d,o,l[0]);return h!==Kn(d,o,l[1])||h!==Kn(d,o,l[2])||h!==Kn(d,o,l[3])}function Oe(d,o,l,u,p,h){let g=o.y-d.y,x=d.x-o.x;if(h=h||0){let C=g*g+x*x;if(C===0)return!0;let D=Math.sqrt(C);g/=D,x/=D}return!((l.x-d.x)*g+(l.y-d.y)*x-h<0||(u.x-d.x)*g+(u.y-d.y)*x-h<0||(p.x-d.x)*g+(p.y-d.y)*x-h<0)}function Ke(d,o,l,u,p,h,g){return!(Oe(d,o,u,p,h,g)||Oe(o,l,u,p,h,g)||Oe(l,d,u,p,h,g)||Oe(u,p,d,o,l,g)||Oe(p,h,d,o,l,g)||Oe(h,u,d,o,l,g))}function $e(d,o,l){let u=o.paint.get(d).value;return u.kind==="constant"?u.value:l.programConfigurations.get(o.id).getMaxValue(d)}function ct(d){return Math.sqrt(d[0]*d[0]+d[1]*d[1])}function ut(d,o,l,u,p){if(!o[0]&&!o[1])return d;let h=At.convert(o)._mult(p);l==="viewport"&&h._rotate(-u);let g=[];for(let x=0;x<d.length;x++)g.push(d[x].sub(h));return g}function St(d,o,l,u){let p=At.convert(d)._mult(u);return o==="viewport"&&p._rotate(-l),p}let He,st;$t(G,"CircleBucket",{omit:["layers"]});var je,at={exports:{}},rt=(je||(je=1,function(d,o){(function(l){function u(h,g,x){var C=p(256*h,256*(g=Math.pow(2,x)-g-1),x),D=p(256*(h+1),256*(g+1),x);return C[0]+","+C[1]+","+D[0]+","+D[1]}function p(h,g,x){var C=2*Math.PI*6378137/256/Math.pow(2,x);return[h*C-2*Math.PI*6378137/2,g*C-2*Math.PI*6378137/2]}l.getURL=function(h,g,x,C,D,v){return v=v||{},h+"?"+["bbox="+u(x,C,D),"format="+(v.format||"image/png"),"service="+(v.service||"WMS"),"version="+(v.version||"1.1.1"),"request="+(v.request||"GetMap"),"srs="+(v.srs||"EPSG:3857"),"width="+(v.width||256),"height="+(v.height||256),"layers="+g].join("&")},l.getTileBBox=u,l.getMercCoords=p,Object.defineProperty(l,"__esModule",{value:!0})})(o)}(0,at.exports)),at.exports);class ht{constructor(o,l,u){this.z=o,this.x=l,this.y=u,this.key=Nt(0,o,o,l,u)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,l){let u=rt.getTileBBox(this.x,this.y,this.z),p=function(h,g,x){let C,D="";for(let v=h;v>0;v--)C=1<<v-1,D+=(g&C?1:0)+(x&C?2:0);return D}(this.z,this.x,this.y);return o[(this.x+this.y)%o.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Qe{constructor(o,l){this.wrap=o,this.canonical=l,this.key=Nt(o,l.z,l.z,l.x,l.y)}}class mt{constructor(o,l,u,p,h){this.overscaledZ=o,this.wrap=l,this.canonical=new ht(u,+p,+h),this.key=l===0&&o===u?this.canonical.key:Nt(l,o,u,p,h)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){let l=this.canonical.z-o;return o>this.canonical.z?new mt(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new mt(o,this.wrap,o,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(o,l=!0){if(this.overscaledZ===o&&l)return this.key;if(o>this.canonical.z)return Nt(this.wrap*+l,o,this.canonical.z,this.canonical.x,this.canonical.y);{let u=this.canonical.z-o;return Nt(this.wrap*+l,o,o,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(o){if(o.wrap!==this.wrap)return!1;let l=this.canonical.z-o.canonical.z;return o.overscaledZ===0||o.overscaledZ<this.overscaledZ&&o.canonical.z<this.canonical.z&&o.canonical.x===this.canonical.x>>l&&o.canonical.y===this.canonical.y>>l}children(o){if(this.overscaledZ>=o)return[new mt(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let l=this.canonical.z+1,u=2*this.canonical.x,p=2*this.canonical.y;return[new mt(l,this.wrap,l,u,p),new mt(l,this.wrap,l,u+1,p),new mt(l,this.wrap,l,u,p+1),new mt(l,this.wrap,l,u+1,p+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new mt(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new mt(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Qe(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Nt(d,o,l,u,p){let h=1<<Math.min(l,22),g=h*(p%h)+u%h;return d&&l<22&&(g+=h*h*((d<0?-2*d-1:2*d)%(1<<2*(22-l)))),16*(32*g+l)+(o-l)}let zt=[d=>{let o=d.canonical.x-1,l=d.wrap;return o<0&&(o=(1<<d.canonical.z)-1,l--),new mt(d.overscaledZ,l,d.canonical.z,o,d.canonical.y)},d=>{let o=d.canonical.x+1,l=d.wrap;return o===1<<d.canonical.z&&(o=0,l++),new mt(d.overscaledZ,l,d.canonical.z,o,d.canonical.y)},d=>new mt(d.overscaledZ,d.wrap,d.canonical.z,d.canonical.x,(d.canonical.y===0?1<<d.canonical.z:d.canonical.y)-1),d=>new mt(d.overscaledZ,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y===(1<<d.canonical.z)-1?0:d.canonical.y+1)];$t(ht,"CanonicalTileID"),$t(mt,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});let Vt=En([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:ei}=Vt,Ri=En([{name:"a_pos_3",components:3,type:"Int16"}]);var gi=En([{name:"a_pos",type:"Int16",components:2}]);class Si{constructor(o,l){this.pos=o,this.dir=l}intersectsPlane(o,l,u){let p=ce.vec2.dot(l,this.dir);if(Math.abs(p)<1e-6)return!1;let h=((o[0]-this.pos[0])*l[0]+(o[1]-this.pos[1])*l[1])/p;return u[0]=this.pos[0]+this.dir[0]*h,u[1]=this.pos[1]+this.dir[1]*h,!0}}class vi{constructor(o,l){this.pos=o,this.dir=l}intersectsPlane(o,l,u){let p=ce.vec3.dot(l,this.dir);if(Math.abs(p)<1e-6)return!1;let h=((o[0]-this.pos[0])*l[0]+(o[1]-this.pos[1])*l[1]+(o[2]-this.pos[2])*l[2])/p;return u[0]=this.pos[0]+this.dir[0]*h,u[1]=this.pos[1]+this.dir[1]*h,u[2]=this.pos[2]+this.dir[2]*h,!0}closestPointOnSphere(o,l,u){if(ce.vec3.equals(this.pos,o)||l===0)return u[0]=u[1]=u[2]=0,!1;let[p,h,g]=this.dir,x=this.pos[0]-o[0],C=this.pos[1]-o[1],D=this.pos[2]-o[2],v=p*p+h*h+g*g,E=2*(x*p+C*h+D*g),T=E*E-4*v*(x*x+C*C+D*D-l*l);if(T<0){let S=Math.max(-E/2,0),M=x+p*S,R=C+h*S,L=D+g*S,N=Math.hypot(M,R,L);return u[0]=M*l/N,u[1]=R*l/N,u[2]=L*l/N,!1}{let S=(-E-Math.sqrt(T))/(2*v);if(S<0){let M=Math.hypot(x,C,D);return u[0]=x*l/M,u[1]=C*l/M,u[2]=D*l/M,!1}return u[0]=x+p*S,u[1]=C+h*S,u[2]=D+g*S,!0}}}class on{constructor(o,l,u,p,h){this.TL=o,this.TR=l,this.BR=u,this.BL=p,this.horizon=h}static fromInvProjectionMatrix(o,l,u){let p=[-1,1,1],h=[1,1,1],g=[1,-1,1],x=[-1,-1,1],C=ce.vec3.transformMat4(p,p,o),D=ce.vec3.transformMat4(h,h,o),v=ce.vec3.transformMat4(g,g,o),E=ce.vec3.transformMat4(x,x,o);return new on(C,D,v,E,l/u)}}function Dn(d,o,l){let u=1/0,p=-1/0,h=[];for(let g of d){ce.vec3.sub(h,g,o);let x=ce.vec3.dot(h,l);u=Math.min(u,x),p=Math.max(p,x)}return[u,p]}function ar(d,o){let l=!0;for(let u=0;u<d.planes.length;u++){let p=d.planes[u],h=0;for(let g=0;g<o.length;g++)h+=ce.vec3.dot(p,o[g])+p[3]>=0;if(h===0)return 0;h!==o.length&&(l=!1)}return l?2:1}function Zi(d,o){for(let l of d.projections){let u=Dn(o,d.points[0],l.axis);if(l.projection[1]<u[0]||l.projection[0]>u[1])return 0}return 1}function yr(d,o){let l=0,u=[0,0,0,0];for(let p=0;p<d.length;p++)u[0]=d[p][0],u[1]=d[p][1],u[2]=d[p][2],u[3]=1,ce.vec4.dot(u,o)>=0&&l++;return l}class Fi{constructor(o,l){this.points=o||new Array(8).fill([0,0,0]),this.planes=l||new Array(6).fill([0,0,0,0]),this.bounds=ti.fromPoints(this.points),this.projections=[],this.frustumEdges=[ce.vec3.sub([],this.points[2],this.points[3]),ce.vec3.sub([],this.points[0],this.points[3]),ce.vec3.sub([],this.points[4],this.points[0]),ce.vec3.sub([],this.points[5],this.points[1]),ce.vec3.sub([],this.points[6],this.points[2]),ce.vec3.sub([],this.points[7],this.points[3])];for(let u of this.frustumEdges){let p=[0,-u[2],u[1]],h=[u[2],0,-u[0]];this.projections.push({axis:p,projection:Dn(this.points,this.points[0],p)}),this.projections.push({axis:h,projection:Dn(this.points,this.points[0],h)})}}static fromInvProjectionMatrix(o,l,u,p){let h=Math.pow(2,u),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(D=>{let v=ce.vec4.transformMat4([],D,o),E=1/v[3]/l*h;return ce.vec4.mul(v,v,[E,E,p?1/v[3]:E,E])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(D=>{let v=ce.vec3.sub([],g[D[0]],g[D[1]]),E=ce.vec3.sub([],g[D[2]],g[D[1]]),T=ce.vec3.normalize([],ce.vec3.cross([],v,E)),S=-ce.vec3.dot(T,g[D[1]]);return T.concat(S)}),C=[];for(let D=0;D<g.length;D++)C.push([g[D][0],g[D][1],g[D][2]]);return new Fi(C,x)}intersectsPrecise(o,l,u){for(let p=0;p<l.length;p++)if(!yr(o,l[p]))return 0;for(let p=0;p<this.planes.length;p++)if(!yr(o,this.planes[p]))return 0;for(let p of u)for(let h of this.frustumEdges){let g=ce.vec3.cross([],p,h),x=ce.vec3.length(g);if(x===0)continue;ce.vec3.scale(g,g,1/x);let C=Dn(this.points,this.points[0],g),D=Dn(o,this.points[0],g);if(C[0]>D[1]||D[0]>C[1])return 0}return 1}containsPoint(o){for(let l of this.planes){let u=l[3];if(ce.vec3.dot([l[0],l[1],l[2]],o)+u<0)return!1}return!0}}class ti{static fromPoints(o){let l=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(let p of o)ce.vec3.min(l,l,p),ce.vec3.max(u,u,p);return new ti(l,u)}static fromTileIdAndHeight(o,l,u){let p=1<<o.canonical.z,h=o.canonical.x,g=o.canonical.y;return new ti([h/p,g/p,l],[(h+1)/p,(g+1)/p,u])}static applyTransform(o,l){let u=o.getCorners();for(let p=0;p<u.length;++p)ce.vec3.transformMat4(u[p],u[p],l);return ti.fromPoints(u)}static applyTransformFast(o,l){let u=[l[12],l[13],l[14]],p=[...u];for(let h=0;h<3;h++)for(let g=0;g<3;g++){let x=l[4*g+h],C=x*o.min[g],D=x*o.max[g];u[h]+=Math.min(C,D),p[h]+=Math.max(C,D)}return new ti(u,p)}static projectAabbCorners(o,l){let u=o.getCorners();for(let p=0;p<u.length;++p)ce.vec3.transformMat4(u[p],u[p],l);return u}constructor(o,l){this.min=o,this.max=l,this.center=ce.vec3.scale([],ce.vec3.add([],this.min,this.max),.5)}quadrant(o){let l=[o%2==0,o<2],u=ce.vec3.clone(this.min),p=ce.vec3.clone(this.max);for(let h=0;h<l.length;h++)u[h]=l[h]?this.min[h]:this.center[h],p[h]=l[h]?this.center[h]:this.max[h];return p[2]=this.max[2],new ti(u,p)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}distanceZ(o){return Math.max(Math.min(this.max[2],o[2]),this.min[2])-o[2]}getCorners(){let o=this.min,l=this.max;return[[o[0],o[1],o[2]],[l[0],o[1],o[2]],[l[0],l[1],o[2]],[o[0],l[1],o[2]],[o[0],o[1],l[2]],[l[0],o[1],l[2]],[l[0],l[1],l[2]],[o[0],l[1],l[2]]]}intersects(o){return this.intersectsAabb(o.bounds)?ar(o,this.getCorners()):0}intersectsFlat(o){return this.intersectsAabb(o.bounds)?ar(o,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(o,l){return l||this.intersects(o)?Zi(o,this.getCorners()):0}intersectsPreciseFlat(o,l){return l||this.intersectsFlat(o)?Zi(o,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(o){for(let l=0;l<3;++l)if(this.min[l]>o.max[l]||o.min[l]>this.max[l])return!1;return!0}intersectsAabbXY(o){return!(this.min[0]>o.max[0]||o.min[0]>this.max[0]||this.min[1]>o.max[1]||o.min[1]>this.max[1])}encapsulate(o){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],o.min[l]),this.max[l]=Math.max(this.max[l],o.max[l])}encapsulatePoint(o){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],o[l]),this.max[l]=Math.max(this.max[l],o[l])}closestPoint(o){return[Math.max(Math.min(this.max[0],o[0]),this.min[0]),Math.max(Math.min(this.max[1],o[1]),this.min[1]),Math.max(Math.min(this.max[2],o[2]),this.min[2])]}}function ln(d){return d*Na/hu}$t(ti,"Aabb");let Nn=[new ti([bs,bs,bs],[xs,xs,xs]),new ti([bs,bs,bs],[0,0,xs]),new ti([0,bs,bs],[xs,0,xs]),new ti([bs,0,bs],[0,xs,xs]),new ti([0,0,bs],[xs,xs,xs])];function _n(d,o,l,u=!0){let p=ce.vec3.scale([],d._camera.position,d.worldSize),h=[o,l,1,1];ce.vec4.transformMat4(h,h,d.pixelMatrixInverse),ce.vec4.scale(h,h,1/h[3]);let g=ce.vec3.sub([],h,p),x=ce.vec3.normalize([],g),C=d.globeMatrix,D=[C[12],C[13],C[14]],v=ce.vec3.sub([],D,p),E=ce.vec3.length(v),T=ce.vec3.normalize([],v),S=d.worldSize/(2*Math.PI),M=ce.vec3.dot(T,x),R=Math.asin(S/E);if(R<Math.acos(M)){if(!u)return null;let De=[],fe=[];ce.vec3.scale(De,x,E/M),ce.vec3.normalize(fe,ce.vec3.sub(fe,De,v)),ce.vec3.normalize(x,ce.vec3.add(x,v,ce.vec3.scale(x,fe,Math.tan(R)*E)))}let L=[];new vi(p,x).closestPointOnSphere(D,S,L);let N=ce.vec3.normalize([],Yu(C,0)),$=ce.vec3.normalize([],Yu(C,1)),H=ce.vec3.normalize([],Yu(C,2)),j=ce.vec3.dot(N,L),q=ce.vec3.dot($,L),Y=ce.vec3.dot(H,L),Q=Ur(Math.asin(-q/S)),pe=Ur(Math.atan2(j,Y));pe=d.center.lng+function(De,fe){let Me=(fe-De+180)%360-180;return Me<-180?Me+360:Me}(d.center.lng,pe);let de=Ll(pe),ue=qi(Ja(Q),0,1);return new a(de,ue)}class Ar{constructor(o,l,u){this.a=ce.vec3.sub([],o,u),this.b=ce.vec3.sub([],l,u),this.center=u;let p=ce.vec3.normalize([],this.a),h=ce.vec3.normalize([],this.b);this.angle=Math.acos(ce.vec3.dot(p,h))}}function Kr(d,o){if(d.angle===0)return null;let l;return l=d.a[o]===0?1/d.angle*.5*Math.PI:1/d.angle*Math.atan(d.b[o]/d.a[o]/Math.sin(d.angle)-1/Math.tan(d.angle)),l<0||l>1?null:function(u,p,h,g){let x=Math.sin(h);return u*(Math.sin((1-g)*h)/x)+p*(Math.sin(g*h)/x)}(d.a[o],d.b[o],d.angle,qi(l,0,1))+d.center[o]}function po(d){if(d.z<=1)return Nn[d.z+2*d.y+d.x];let o=vr(hn(d));return ti.fromPoints(o)}function Co(d,o,l){return ce.vec3.scale(d,d,1-l),ce.vec3.scaleAndAdd(d,d,o,l)}function ws(d,o,l){for(let u of d)ce.vec3.transformMat4(u,u,o),ce.vec3.scale(u,u,l)}function xa(d,o,l,u){let p=o/d.worldSize,h=d.globeMatrix;if(l.z<=1){let de=po(l).getCorners();return ws(de,h,p),ti.fromPoints(de)}let g=hn(l,u),x=vr(g,Na+ln(d._tileCoverLift));ws(x,h,p);let C=Number.MAX_VALUE,D=[-C,-C,-C],v=[C,C,C];if(g.contains(d.center)){for(let De of x)ce.vec3.min(v,v,De),ce.vec3.max(D,D,De);D[2]=0;let de=d.point,ue=[de.x*p,de.y*p,0];return ce.vec3.min(v,v,ue),ce.vec3.max(D,D,ue),new ti(v,D)}if(d._tileCoverLift>0){for(let de of x)ce.vec3.min(v,v,de),ce.vec3.max(D,D,de);return new ti(v,D)}let E=[h[12]*p,h[13]*p,h[14]*p],T=g.getCenter(),S=qi(d.center.lat,-Nr,Nr),M=qi(T.lat,-Nr,Nr),R=Ll(d.center.lng),L=Ja(S),N=R-Ll(T.lng),$=L-Ja(M);N>.5?N-=1:N<-.5&&(N+=1);let H=0;if(Math.abs(N)>Math.abs($))H=N>=0?1:3;else{H=$>=0?0:2;let de=[h[4]*p,h[5]*p,h[6]*p],ue=-Math.sin(Qi($>=0?g.getSouth():g.getNorth()))*Na;ce.vec3.scaleAndAdd(E,E,de,ue)}let j=x[H],q=x[(H+1)%4],Y=new Ar(j,q,E),Q=[Kr(Y,0)||j[0],Kr(Y,1)||j[1],Kr(Y,2)||j[2]],pe=Ha(d.zoom);if(pe>0){let de=function({x:De,y:fe,z:Me},Fe,Pe,ze,Ne){let Ge=1/(1<<Me),Ue=De*Ge,qe=Ue+Ge,gt=fe*Ge,ft=gt+Ge,Gt=0,wt=(Ue+qe)/2-ze;return wt>.5?Gt=-1:wt<-.5&&(Gt=1),Ue=((Ue+Gt)*Fe-(ze*=Fe))*Pe+ze,qe=((qe+Gt)*Fe-ze)*Pe+ze,gt=(gt*Fe-(Ne*=Fe))*Pe+Ne,ft=(ft*Fe-Ne)*Pe+Ne,[[Ue,ft,0],[qe,ft,0],[qe,gt,0],[Ue,gt,0]]}(l,o,d._pixelsPerMercatorPixel,R,L);for(let De=0;De<x.length;De++)Co(x[De],de[De],pe);let ue=ce.vec3.add([],de[H],de[(H+1)%4]);ce.vec3.scale(ue,ue,.5),Co(Q,ue,pe)}for(let de of x)ce.vec3.min(v,v,de),ce.vec3.max(D,D,de);return v[2]=Math.min(j[2],q[2]),ce.vec3.min(v,v,Q),ce.vec3.max(D,D,Q),new ti(v,D)}function hn({x:d,y:o,z:l},u=!1){let p=1/(1<<l),h=new Sn(es(d*p),o===(1<<l)-1&&u?-90:Ho((o+1)*p)),g=new Sn(es((d+1)*p),o===0&&u?90:Ho(o*p));return new _d(h,g)}function vr(d,o=Na){let l=Qi(d.getNorth()),u=Qi(d.getSouth()),p=Math.cos(l),h=Math.cos(u),g=Math.sin(l),x=Math.sin(u),C=d.getWest(),D=d.getEast();return[kh(h,x,C,o),kh(h,x,D,o),kh(p,g,D,o),kh(p,g,C,o)]}function Mn(d,o,l,u){let p=1<<l.z,h=(d/kt+l.x)/p;return uu(Ho((o/kt+l.y)/p),es(h),u)}function Qn({min:d,max:o}){return $w/Math.max(o[0]-d[0],o[1]-d[1],o[2]-d[2])}let $o=new Float64Array(16);function hr(d){let o=Qn(d),l=ce.mat4.fromScaling($o,[o,o,o]);return ce.mat4.translate(l,l,ce.vec3.negate([],d.min))}function fo(d){let o=ce.mat4.fromTranslation($o,d.min),l=1/Qn(d);return ce.mat4.scale(o,o,[l,l,l])}function Nl(d){let o=kt/(2*Math.PI);return d/(2*Math.PI)/o}function ts(d,o){return kt/(512*Math.pow(2,d))*Qn(po(o))}function Hs(d,o,l,u,p){let h=Nl(l),g=[d,o,-l/(2*Math.PI)],x=ce.mat4.identity(new Float64Array(16));return ce.mat4.translate(x,x,g),ce.mat4.scale(x,x,[h,h,h]),ce.mat4.rotateX(x,x,Qi(-p)),ce.mat4.rotateY(x,x,Qi(-u)),x}function Ha(d){return Vo(Ah,Hw,d)}function $s(d,o){let l=uu(o.lat,o.lng),u=function(h){let g=uu(h._center.lat,h._center.lng),x=ce.vec3.fromValues(0,1,0),C=ce.vec3.cross([],x,g),D=ce.mat4.fromRotation([],-h.angle,g);C=ce.vec3.transformMat4(C,C,D),ce.mat4.fromRotation(D,-h._pitch,C);let v=ce.vec3.normalize([],g);return ce.vec3.scale(v,v,ln(h.cameraToCenterDistance/h.pixelsPerMeter)),ce.vec3.transformMat4(v,v,D),ce.vec3.add([],g,v)}(d),p=ce.vec3.subtract([],u,l);return ce.vec3.angle(p,l)}function is(d,o){return $s(d,o)>Math.PI/2*1.01}let Sc=Qi(85),zl=Math.cos(Sc),Dc=Math.sin(Sc),n0=ce.mat4.create(),Ph=d=>{let o=[];return d.paint.get("circle-pitch-alignment")==="map"&&o.push("PITCH_WITH_MAP"),d.paint.get("circle-pitch-scale")==="map"&&o.push("SCALE_WITH_MAP"),o};function jg(d,o,l,u,p,h,g,x,C){if(h&&d.queryGeometry.isAboveHorizon)return!1;h&&(C*=d.pixelToTileUnitsFactor);let D=d.tileID.canonical,v=l.projection.upVectorScale(D,l.center.lat,l.worldSize).metersToTile;for(let E of o)for(let T of E){let S=T.add(x),M=p&&l.elevation?l.elevation.exaggeration()*p.getElevationAt(S.x,S.y,!0):0,R=l.projection.projectTilePoint(S.x,S.y,D);if(M>0){let H=l.projection.upVector(D,S.x,S.y);R.x+=H[0]*v*M,R.y+=H[1]*v*M,R.z+=H[2]*v*M}let L=h?S:r0(R.x,R.y,R.z,u),N=h?d.tilespaceRays.map(H=>E8(H,M)):d.queryGeometry.screenGeometry,$=ce.vec4.transformMat4([],[R.x,R.y,R.z,1],u);if(!g&&h?C*=$[3]/l.cameraToCenterDistance:g&&!h&&(C*=l.cameraToCenterDistance/$[3]),h){let H=Ho((T.y/kt+D.y)/(1<<D.z));C/=l.projection.pixelsPerMeter(H,1)/ea(1,H)}if(W(N,L,C))return!0}return!1}function r0(d,o,l,u){let p=ce.vec4.transformMat4([],[d,o,l,1],u);return new At(p[0]/p[3],p[1]/p[3])}let vO=ce.vec3.fromValues(0,0,0),C8=ce.vec3.fromValues(0,0,1);function E8(d,o){let l=ce.vec3.create();return vO[2]=o,d.intersectsPlane(vO,C8,l),new At(l[0],l[1])}class bO extends G{}let xO,wO,CO,EO;function SO(d,{width:o,height:l},u,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==o*l*u)throw new RangeError("mismatched image size")}else p=new Uint8Array(o*l*u);return d.width=o,d.height=l,d.data=p,d}function DO(d,o,l){let{width:u,height:p}=o;u===d.width&&p===d.height||(iT(d,o,{x:0,y:0},{x:0,y:0},{width:Math.min(d.width,u),height:Math.min(d.height,p)},l,null),d.width=u,d.height=p,d.data=o.data)}function iT(d,o,l,u,p,h,g,x){if(p.width===0||p.height===0)return o;if(p.width>d.width||p.height>d.height||l.x>d.width-p.width||l.y>d.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>o.width||p.height>o.height||u.x>o.width-p.width||u.y>o.height-p.height)throw new RangeError("out of range destination coordinates for image copy");let C=d.data,D=o.data,v=h===4&&x;for(let E=0;E<p.height;E++){let T=((l.y+E)*d.width+l.x)*h,S=((u.y+E)*o.width+u.x)*h;if(v)for(let M=0;M<p.width;M++){let R=T+M*h+3,L=S+M*h;D[L+0]=255,D[L+1]=255,D[L+2]=255,D[L+3]=C[R]}else if(g)for(let M=0;M<p.width;M++){let R=T+M*h,L=S+M*h,N=C[R+3],$=new Ln(C[R+0]/255*N,C[R+1]/255*N,C[R+2]/255*N,N).toRenderColor(g).toArray();D[L+0]=$[0],D[L+1]=$[1],D[L+2]=$[2],D[L+3]=$[3]}else for(let M=0;M<p.width*h;M++)D[S+M]=C[T+M]}return o}$t(bO,"HeatmapBucket",{omit:["layers"]});class Oh{constructor(o,l){SO(this,o,1,l)}resize(o){DO(this,new Oh(o),1)}clone(){return new Oh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,l,u,p,h){iT(o,l,u,p,h,1,null)}}class ta{constructor(o,l){SO(this,o,4,l)}resize(o){DO(this,new ta(o),4)}replace(o,l){l?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new ta({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,l,u,p,h,g,x){iT(o,l,u,p,h,4,g,x)}}class MO{constructor(o,l){this.width=o.width,this.height=o.height,this.data=l instanceof Uint8Array?new Float32Array(l.buffer):l}}function o0(d){let o={},l=d.resolution||256,u=d.clips?d.clips.length:1,p=d.image||new ta({width:l,height:u}),h=(g,x,C)=>{o[d.evaluationKey]=C;let D=d.expression.evaluate(o);D&&(p.data[g+x+0]=Math.floor(255*D.r/D.a),p.data[g+x+1]=Math.floor(255*D.g/D.a),p.data[g+x+2]=Math.floor(255*D.b/D.a),p.data[g+x+3]=Math.floor(255*D.a))};if(d.clips)for(let g=0,x=0;g<u;++g,x+=4*l)for(let C=0,D=0;C<l;C++,D+=4){let v=C/(l-1),{start:E,end:T}=d.clips[g];h(x,D,E*(1-v)+T*v)}else for(let g=0,x=0;g<l;g++,x+=4)h(0,x,g/(l-1));return p}$t(Oh,"AlphaImage"),$t(ta,"RGBAImage");let S8=En([{name:"a_pos",components:2,type:"Int16"}],4),D8=En([{name:"a_road_z_offset",components:1,type:"Float32"}],4),M8=En([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),T8=En([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function a0(d,o,l=2){let u=o&&o.length,p=u?o[0]*l:d.length,h=TO(d,0,p,l,!0),g=[];if(!h||h.next===h.prev)return g;let x,C,D;if(u&&(h=function(v,E,T,S){let M=[];for(let R=0,L=E.length;R<L;R++){let N=TO(v,E[R]*S,R<L-1?E[R+1]*S:v.length,S,!1);N===N.next&&(N.steiner=!0),M.push(L8(N))}M.sort(P8);for(let R=0;R<M.length;R++)T=O8(M[R],T);return T}(d,o,h,l)),d.length>80*l){x=1/0,C=1/0;let v=-1/0,E=-1/0;for(let T=l;T<p;T+=l){let S=d[T],M=d[T+1];S<x&&(x=S),M<C&&(C=M),S>v&&(v=S),M>E&&(E=M)}D=Math.max(v-x,E-C),D=D!==0?32767/D:0}return s0(h,g,l,x,C,D,0),g}function TO(d,o,l,u,p){let h;if(p===function(g,x,C,D){let v=0;for(let E=x,T=C-D;E<C;E+=D)v+=(g[T]-g[E])*(g[E+1]+g[T+1]),T=E;return v}(d,o,l,u)>0)for(let g=o;g<l;g+=u)h=RO(g/u|0,d[g],d[g+1],h);else for(let g=l-u;g>=o;g-=u)h=RO(g/u|0,d[g],d[g+1],h);return h&&qw(h,h.next)&&(c0(h),h=h.next),h}function Pf(d,o){if(!d)return d;o||(o=d);let l,u=d;do if(l=!1,u.steiner||!qw(u,u.next)&&Eo(u.prev,u,u.next)!==0)u=u.next;else{if(c0(u),u=o=u.prev,u===u.next)break;l=!0}while(l||u!==o);return o}function s0(d,o,l,u,p,h,g){if(!d)return;!g&&h&&function(C,D,v,E){let T=C;do T.z===0&&(T.z=nT(T.x,T.y,D,v,E)),T.prevZ=T.prev,T.nextZ=T.next,T=T.next;while(T!==C);T.prevZ.nextZ=null,T.prevZ=null,function(S){let M,R=1;do{let L,N=S;S=null;let $=null;for(M=0;N;){M++;let H=N,j=0;for(let Y=0;Y<R&&(j++,H=H.nextZ,H);Y++);let q=R;for(;j>0||q>0&&H;)j!==0&&(q===0||!H||N.z<=H.z)?(L=N,N=N.nextZ,j--):(L=H,H=H.nextZ,q--),$?$.nextZ=L:S=L,L.prevZ=$,$=L;N=H}$.nextZ=null,R*=2}while(M>1)}(T)}(d,u,p,h);let x=d;for(;d.prev!==d.next;){let C=d.prev,D=d.next;if(h?A8(d,u,p,h):I8(d))o.push(C.i,d.i,D.i),c0(d),d=D.next,x=D.next;else if((d=D)===x){g?g===1?s0(d=R8(Pf(d),o),o,l,u,p,h,2):g===2&&k8(d,o,l,u,p,h):s0(Pf(d),o,l,u,p,h,1);break}}}function I8(d){let o=d.prev,l=d,u=d.next;if(Eo(o,l,u)>=0)return!1;let p=o.x,h=l.x,g=u.x,x=o.y,C=l.y,D=u.y,v=p<h?p<g?p:g:h<g?h:g,E=x<C?x<D?x:D:C<D?C:D,T=p>h?p>g?p:g:h>g?h:g,S=x>C?x>D?x:D:C>D?C:D,M=u.next;for(;M!==o;){if(M.x>=v&&M.x<=T&&M.y>=E&&M.y<=S&&Ug(p,x,h,C,g,D,M.x,M.y)&&Eo(M.prev,M,M.next)>=0)return!1;M=M.next}return!0}function A8(d,o,l,u){let p=d.prev,h=d,g=d.next;if(Eo(p,h,g)>=0)return!1;let x=p.x,C=h.x,D=g.x,v=p.y,E=h.y,T=g.y,S=x<C?x<D?x:D:C<D?C:D,M=v<E?v<T?v:T:E<T?E:T,R=x>C?x>D?x:D:C>D?C:D,L=v>E?v>T?v:T:E>T?E:T,N=nT(S,M,o,l,u),$=nT(R,L,o,l,u),H=d.prevZ,j=d.nextZ;for(;H&&H.z>=N&&j&&j.z<=$;){if(H.x>=S&&H.x<=R&&H.y>=M&&H.y<=L&&H!==p&&H!==g&&Ug(x,v,C,E,D,T,H.x,H.y)&&Eo(H.prev,H,H.next)>=0||(H=H.prevZ,j.x>=S&&j.x<=R&&j.y>=M&&j.y<=L&&j!==p&&j!==g&&Ug(x,v,C,E,D,T,j.x,j.y)&&Eo(j.prev,j,j.next)>=0))return!1;j=j.nextZ}for(;H&&H.z>=N;){if(H.x>=S&&H.x<=R&&H.y>=M&&H.y<=L&&H!==p&&H!==g&&Ug(x,v,C,E,D,T,H.x,H.y)&&Eo(H.prev,H,H.next)>=0)return!1;H=H.prevZ}for(;j&&j.z<=$;){if(j.x>=S&&j.x<=R&&j.y>=M&&j.y<=L&&j!==p&&j!==g&&Ug(x,v,C,E,D,T,j.x,j.y)&&Eo(j.prev,j,j.next)>=0)return!1;j=j.nextZ}return!0}function R8(d,o){let l=d;do{let u=l.prev,p=l.next.next;!qw(u,p)&&IO(u,l,l.next,p)&&l0(u,p)&&l0(p,u)&&(o.push(u.i,l.i,p.i),c0(l),c0(l.next),l=d=p),l=l.next}while(l!==d);return Pf(l)}function k8(d,o,l,u,p,h){let g=d;do{let x=g.next.next;for(;x!==g.prev;){if(g.i!==x.i&&N8(g,x)){let C=AO(g,x);return g=Pf(g,g.next),C=Pf(C,C.next),s0(g,o,l,u,p,h,0),void s0(C,o,l,u,p,h,0)}x=x.next}g=g.next}while(g!==d)}function P8(d,o){return d.x-o.x}function O8(d,o){let l=function(p,h){let g=h,x=p.x,C=p.y,D,v=-1/0;do{if(C<=g.y&&C>=g.next.y&&g.next.y!==g.y){let R=g.x+(C-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(R<=x&&R>v&&(v=R,D=g.x<g.next.x?g:g.next,R===x))return D}g=g.next}while(g!==h);if(!D)return null;let E=D,T=D.x,S=D.y,M=1/0;g=D;do{if(x>=g.x&&g.x>=T&&x!==g.x&&Ug(C<S?x:v,C,T,S,C<S?v:x,C,g.x,g.y)){let R=Math.abs(C-g.y)/(x-g.x);l0(g,p)&&(R<M||R===M&&(g.x>D.x||g.x===D.x&&F8(D,g)))&&(D=g,M=R)}g=g.next}while(g!==E);return D}(d,o);if(!l)return o;let u=AO(l,d);return Pf(u,u.next),Pf(l,l.next)}function F8(d,o){return Eo(d.prev,d,o.prev)<0&&Eo(o.next,d,d.next)<0}function nT(d,o,l,u,p){return(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=(d-l)*p|0)|d<<8))|d<<4))|d<<2))|d<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-u)*p|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function L8(d){let o=d,l=d;do(o.x<l.x||o.x===l.x&&o.y<l.y)&&(l=o),o=o.next;while(o!==d);return l}function Ug(d,o,l,u,p,h,g,x){return(p-g)*(o-x)>=(d-g)*(h-x)&&(d-g)*(u-x)>=(l-g)*(o-x)&&(l-g)*(h-x)>=(p-g)*(u-x)}function N8(d,o){return d.next.i!==o.i&&d.prev.i!==o.i&&!function(l,u){let p=l;do{if(p.i!==l.i&&p.next.i!==l.i&&p.i!==u.i&&p.next.i!==u.i&&IO(p,p.next,l,u))return!0;p=p.next}while(p!==l);return!1}(d,o)&&(l0(d,o)&&l0(o,d)&&function(l,u){let p=l,h=!1,g=(l.x+u.x)/2,x=(l.y+u.y)/2;do p.y>x!=p.next.y>x&&p.next.y!==p.y&&g<(p.next.x-p.x)*(x-p.y)/(p.next.y-p.y)+p.x&&(h=!h),p=p.next;while(p!==l);return h}(d,o)&&(Eo(d.prev,d,o.prev)||Eo(d,o.prev,o))||qw(d,o)&&Eo(d.prev,d,d.next)>0&&Eo(o.prev,o,o.next)>0)}function Eo(d,o,l){return(o.y-d.y)*(l.x-o.x)-(o.x-d.x)*(l.y-o.y)}function qw(d,o){return d.x===o.x&&d.y===o.y}function IO(d,o,l,u){let p=Yw(Eo(d,o,l)),h=Yw(Eo(d,o,u)),g=Yw(Eo(l,u,d)),x=Yw(Eo(l,u,o));return p!==h&&g!==x||!(p!==0||!Ww(d,l,o))||!(h!==0||!Ww(d,u,o))||!(g!==0||!Ww(l,d,u))||!(x!==0||!Ww(l,o,u))}function Ww(d,o,l){return o.x<=Math.max(d.x,l.x)&&o.x>=Math.min(d.x,l.x)&&o.y<=Math.max(d.y,l.y)&&o.y>=Math.min(d.y,l.y)}function Yw(d){return d>0?1:d<0?-1:0}function l0(d,o){return Eo(d.prev,d,d.next)<0?Eo(d,o,d.next)>=0&&Eo(d,d.prev,o)>=0:Eo(d,o,d.prev)<0||Eo(d,d.next,o)<0}function AO(d,o){let l=rT(d.i,d.x,d.y),u=rT(o.i,o.x,o.y),p=d.next,h=o.prev;return d.next=o,o.prev=d,l.next=p,p.prev=l,u.next=l,l.prev=u,h.next=u,u.prev=h,u}function RO(d,o,l,u){let p=rT(d,o,l);return u?(p.next=u.next,p.prev=u,u.next.prev=p,u.next=p):(p.prev=p,p.next=p),p}function c0(d){d.next.prev=d.prev,d.prev.next=d.next,d.prevZ&&(d.prevZ.nextZ=d.nextZ),d.nextZ&&(d.nextZ.prevZ=d.prevZ)}function rT(d,o,l){return{i:d,x:o,y:l,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Zw(d,o){let l=d.length;if(l<=1)return[d];let u=[],p,h;for(let g=0;g<l;g++){let x=Yp(d[g]);x!==0&&(d[g].area=Math.abs(x),h===void 0&&(h=x<0),h===x<0?(p&&u.push(p),p=[d[g]]):p.push(d[g]))}if(p&&u.push(p),o>1)for(let g=0;g<u.length;g++)u[g].length<=o||(ew(u[g],o,1,u[g].length-1,z8),u[g]=u[g].slice(0,o));return u}function z8(d,o){return o.area-d.area}function kO(d,o,l=1){if(!d)return null;let u=typeof d=="string"?ba.from(d).getPrimary():d.getPrimary(),p=u.id.toString();return o.has(p)||o.set(p,[]),u.scaleSelf(l),o.get(p).push(u),u.toString()}function oT(d,o,l,u){let p=u.patternDependencies,h=!1;for(let g of o){let x=g.paint.get(`${d}-pattern`);x.isConstant()||(h=!0),kO(x.constantOr(null),p,l)&&(h=!0)}return h}function aT(d,o,l,u,p,h){let g=h.patternDependencies;for(let x of o){let C=x.paint.get(`${d}-pattern`).value;if(C.kind!=="constant"){let D=C.evaluate({zoom:u},l,{},h.availableImages);D=D&&D.name?D.name:D;let v=kO(D,g,p);v&&(l.patterns[x.id]=v)}}return l}var sT,PO,lT,OO,cT,FO,LO,Xw={};function NO(){if(PO)return sT;PO=1;var d=ma();function o(p,h,g,x,C){this.properties={},this.extent=g,this.type=0,this._pbf=p,this._geometry=-1,this._keys=x,this._values=C,p.readFields(l,this,h)}function l(p,h,g){p==1?h.id=g.readVarint():p==2?function(x,C){for(var D=x.readVarint()+x.pos;x.pos<D;){var v=C._keys[x.readVarint()],E=C._values[x.readVarint()];C.properties[v]=E}}(g,h):p==3?h.type=g.readVarint():p==4&&(h._geometry=g.pos)}function u(p){for(var h,g,x=0,C=0,D=p.length,v=D-1;C<D;v=C++)x+=((g=p[v]).x-(h=p[C]).x)*(h.y+g.y);return x}return sT=o,o.types=["Unknown","Point","LineString","Polygon"],o.prototype.loadGeometry=function(){var p=this._pbf;p.pos=this._geometry;for(var h,g=p.readVarint()+p.pos,x=1,C=0,D=0,v=0,E=[];p.pos<g;){if(C<=0){var T=p.readVarint();x=7&T,C=T>>3}if(C--,x===1||x===2)D+=p.readSVarint(),v+=p.readSVarint(),x===1&&(h&&E.push(h),h=[]),h.push(new d(D,v));else{if(x!==7)throw new Error("unknown command "+x);h&&h.push(h[0].clone())}}return h&&E.push(h),E},o.prototype.bbox=function(){var p=this._pbf;p.pos=this._geometry;for(var h=p.readVarint()+p.pos,g=1,x=0,C=0,D=0,v=1/0,E=-1/0,T=1/0,S=-1/0;p.pos<h;){if(x<=0){var M=p.readVarint();g=7&M,x=M>>3}if(x--,g===1||g===2)(C+=p.readSVarint())<v&&(v=C),C>E&&(E=C),(D+=p.readSVarint())<T&&(T=D),D>S&&(S=D);else if(g!==7)throw new Error("unknown command "+g)}return[v,T,E,S]},o.prototype.toGeoJSON=function(p,h,g){var x,C,D=this.extent*Math.pow(2,g),v=this.extent*p,E=this.extent*h,T=this.loadGeometry(),S=o.types[this.type];function M(N){for(var $=0;$<N.length;$++){var H=N[$];N[$]=[360*(H.x+v)/D-180,360/Math.PI*Math.atan(Math.exp((180-360*(H.y+E)/D)*Math.PI/180))-90]}}switch(this.type){case 1:var R=[];for(x=0;x<T.length;x++)R[x]=T[x][0];M(T=R);break;case 2:for(x=0;x<T.length;x++)M(T[x]);break;case 3:for(T=function(N){var $=N.length;if($<=1)return[N];for(var H,j,q=[],Y=0;Y<$;Y++){var Q=u(N[Y]);Q!==0&&(j===void 0&&(j=Q<0),j===Q<0?(H&&q.push(H),H=[N[Y]]):H.push(N[Y]))}return H&&q.push(H),q}(T),x=0;x<T.length;x++)for(C=0;C<T[x].length;C++)M(T[x][C])}T.length===1?T=T[0]:S="Multi"+S;var L={type:"Feature",geometry:{type:S,coordinates:T},properties:this.properties};return"id"in this&&(L.id=this.id),L},sT}function zO(){if(OO)return lT;OO=1;var d=NO();function o(u,p){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(l,this,p),this.length=this._features.length}function l(u,p,h){u===15?p.version=h.readVarint():u===1?p.name=h.readString():u===5?p.extent=h.readVarint():u===2?p._features.push(h.pos):u===3?p._keys.push(h.readString()):u===4&&p._values.push(function(g){for(var x=null,C=g.readVarint()+g.pos;g.pos<C;){var D=g.readVarint()>>3;x=D===1?g.readString():D===2?g.readFloat():D===3?g.readDouble():D===4?g.readVarint64():D===5?g.readVarint():D===6?g.readSVarint():D===7?g.readBoolean():null}return x}(h))}return lT=o,o.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var p=this._pbf.readVarint()+this._pbf.pos;return new d(this._pbf,p,this.extent,this._keys,this._values)},lT}function BO(){return LO||(LO=1,Xw.VectorTile=function(){if(FO)return cT;FO=1;var d=zO();function o(l,u,p){if(l===3){var h=new d(p,p.readVarint()+p.pos);h.length&&(u[h.name]=h)}}return cT=function(l,u){this.layers=l.readFields(o,{},u)},cT}(),Xw.VectorTileFeature=NO(),Xw.VectorTileLayer=zO()),Xw}var Fh=BO();let Of="3d_elevation_id",VO="level";class B8{constructor(){this._valid=!1}reset(o){return this.feature=o,this._valid=!0,this._geometry=o.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(o,l){return this._valid&&o(l(this._geometry)),this}require(o,l,u){return this.get(o,!0,l,u)}optional(o,l,u){return this.get(o,!1,l,u)}success(){return this._valid}get(o,l,u,p){let h=this.feature.properties.hasOwnProperty(o)?+this.feature.properties[o]:void 0;return this._valid&&h!==void 0?u(p?p(h):h):l&&(this._valid=!1),this}}class jO{constructor(o,l){this.featureFunc=o,this.vertexFunc=l}parseFeature(o,l,u){return this.featureFunc(o,l,u)}parseVertex(o,l,u){return this.vertexFunc(o,l,u)}}let V8=new jO((d,o,l)=>d.reset(o).require(Of,u=>{l.id=u}).optional("fixed_height_relative",u=>{l.constantHeight=u},pu.decodeRelativeHeight).geometry(u=>{l.bounds=u},pu.computeBounds).success(),(d,o,l)=>d.reset(o).require(Of,u=>{l.id=u}).require("elevation_idx",u=>{l.idx=u}).require("extent",u=>{l.extent=u}).require("height_relative",u=>{l.height=u},pu.decodeRelativeHeight).geometry(u=>{l.position=u},pu.getPoint).success()),j8=new jO((d,o,l)=>d.reset(o).require(Of,u=>{l.id=u}).optional("fixed_height",u=>{l.constantHeight=u},pu.decodeMetricHeight).geometry(u=>{l.bounds=u},pu.computeBounds).success(),(d,o,l)=>d.reset(o).require(Of,u=>{l.id=u}).require("elevation_idx",u=>{l.idx=u}).require("extent",u=>{l.extent=u}).require("height",u=>{l.height=u},pu.decodeMetricHeight).geometry(u=>{l.position=u},pu.getPoint).success());class pu{static computeBounds(o){let l=new At(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),u=new At(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(let p of o[0])l.x>p.x&&(l.x=p.x),l.y>p.y&&(l.y=p.y),u.x<p.x&&(u.x=p.x),u.y<p.y&&(u.y=p.y);return{min:l,max:u}}static getPoint(o){return ce.vec2.fromValues(o[0][0].x,o[0][0].y)}static decodeRelativeHeight(o){return 1e-4*o*5}static decodeMetricHeight(o){return 1e-4*o}static parse(o){let l=[],u=[],p=o.length,h=new B8;for(let x=0;x<p;x++){let C=o.feature(x),D=C.properties.hasOwnProperty("version")?String(C.properties.version):void 0,v=(g=D)?g==="1.0.1"?j8:void 0:V8;if(v===void 0){Er(`Unknown elevation feature version number ${D||"(unknown)"}`);continue}let E=C.properties.hasOwnProperty("type")?C.properties.type:void 0;if(E){if(Fh.VectorTileFeature.types[C.type]==="Point"&&E==="curve_point"){let T={};v.parseVertex(h,C,T)&&l.push(T)}else if(Fh.VectorTileFeature.types[C.type]==="Polygon"&&E==="curve_meta"){let T={};v.parseFeature(h,C,T)&&u.push(T)}}}var g;return{vertices:l,features:u}}}class dT{constructor(o,l,u,p,h,g){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=o,this.heightRange={min:u,max:u},this.safeArea=l,this.constantHeight=u,this.constantHeight==null&&(this.constantHeight!=null||p.length!==0)){this.vertices=p,this.edges=h,this.edges=this.edges.filter(x=>x.a<this.vertices.length&&x.b<this.vertices.length&&!ce.vec2.exactEquals(this.vertices[x.a].position,this.vertices[x.b].position)),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(let x of this.vertices)this.vertexProps.push({dir:ce.vec2.fromValues(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,x.height),this.heightRange.max=Math.max(this.heightRange.max,x.height);for(let x of this.edges){let C=this.vertices[x.a].position,D=this.vertices[x.b].position,v=ce.vec2.subtract(ce.vec2.create(),D,C),E=ce.vec2.length(v),T=ce.vec2.scale(ce.vec2.create(),v,1/E);this.edgeProps.push({vec:v,dir:T,len:E});let S=this.vertexProps[x.a].dir,M=this.vertexProps[x.b].dir;ce.vec2.add(S,S,T),ce.vec2.add(M,M,T)}for(let x of this.vertexProps)x.dir[0]===0&&x.dir[1]===0||ce.vec2.normalize(x.dir,x.dir);this.tessellate(g)}}pointElevation(o){if(this.constantHeight!=null)return this.constantHeight;let l=this.getClosestEdge(o);if(l==null)return 0;let[u,p]=l;return((h,g,x)=>(1-x)*h+x*g)(this.vertices[this.edges[u].a].height,this.vertices[this.edges[u].b].height,p)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(o){if(this.edges.length===0)return;let l=0,u=Number.POSITIVE_INFINITY,p=0,h=ce.vec2.fromValues(o.x,o.y);for(let g=0;g<this.edges.length;g++){let x=this.edges[g],C=this.edgeProps[g].dir,D=new Si(h,this.edgeProps[g].dir),v=this.vertices[x.a].position,E=this.vertices[x.b].position,T=ce.vec2.create(),S=ce.vec2.create(),M=D.intersectsPlane(v,this.vertexProps[x.a].dir,T),R=D.intersectsPlane(E,this.vertexProps[x.b].dir,S);if(!M||!R)continue;let L=ce.vec2.subtract(ce.vec2.create(),S,T),N=ce.vec2.subtract(ce.vec2.create(),h,T),$=ce.vec2.dot(L,L),H=$>0?ce.vec2.dot(N,L)/$:0,j=qi(H,0,1),q=Math.abs((H-j)*this.edgeProps[g].len),Y=ce.vec2.subtract(ce.vec2.create(),h,v),Q=q+Math.abs(ce.vec2.dot(Y,ce.vec2.fromValues(C[1],-C[0])));Q<u&&(l=g,u=Q,p=j)}return[l,p]}tessellate(o){for(let l=this.edges.length-1;l>=0;--l){let u=this.edges[l].a,p=this.edges[l].b,{position:h,height:g,extent:x}=this.vertices[u],{position:C,height:D,extent:v}=this.vertices[p],E=this.vertexProps[u].dir,T=this.vertexProps[p].dir,S=ce.vec3.fromValues(h[0]/o,h[1]/o,g),M=ce.vec3.fromValues(C[0]/o,C[1]/o,D),R=ce.vec3.fromValues(E[1],-E[0],0);ce.vec3.scale(R,R,x);let L=ce.vec3.fromValues(T[1],-T[0],0);if(ce.vec3.scale(L,L,v),this.distSqLines(ce.vec3.fromValues(S[0]+.5*R[0],S[1]+.5*R[1],S[2]+.5*R[2]),ce.vec3.fromValues(M[0]-.5*L[0],M[1]-.5*L[1],M[2]-.5*L[2]),ce.vec3.fromValues(S[0]-.5*R[0],S[1]-.5*R[1],S[2]-.5*R[2]),ce.vec3.fromValues(M[0]+.5*L[0],M[1]+.5*L[1],M[2]+.5*L[2]))<=.05*.05)continue;let N=this.vertices.length,$=ce.vec2.add(ce.vec2.create(),h,C);this.vertices.push({position:ce.vec2.scale($,$,.5),height:.5*(g+D),extent:.5*(x+v)});let H=ce.vec2.add(ce.vec2.create(),E,T);this.vertexProps.push({dir:ce.vec2.normalize(H,H)}),this.edges.splice(l,1),this.edgeProps.splice(l,1),this.edges.push({a:u,b:N}),this.edges.push({a:N,b:p});let j=ce.vec2.subtract(ce.vec2.create(),this.vertices[N].position,h),q=ce.vec2.length(j),Y={vec:j,dir:ce.vec2.scale(ce.vec2.create(),j,1/q),len:q};this.edgeProps.push(Y),this.edgeProps.push(Y)}}distSqLines(o,l,u,p){let h=ce.vec3.subtract(ce.vec3.create(),l,o),g=ce.vec3.subtract(ce.vec3.create(),p,u),x=ce.vec3.subtract(ce.vec3.create(),o,u),C=ce.vec3.dot(h,h),D=ce.vec3.dot(h,g),v=ce.vec3.dot(h,x),E=ce.vec3.dot(g,g),T=ce.vec3.dot(g,x),S=C*E-D*D;if(S===0){let $=ce.vec3.dot(x,g)/ce.vec3.dot(g,g),H=ce.vec3.lerp(ce.vec3.create(),u,p,$);return ce.vec3.squaredDistance(H,o)}let M=(D*T-v*E)/S,R=(C*T-D*v)/S,L=ce.vec3.lerp(ce.vec3.create(),o,l,M),N=ce.vec3.lerp(ce.vec3.create(),u,p,R);return ce.vec3.squaredDistance(L,N)}}class U8{constructor(o,l){this.zScale=1,this.xOffset=0,this.yOffset=0,o.equals(l)||(this.zScale=Math.pow(2,l.z-o.z),this.xOffset=(o.x*this.zScale-l.x)*kt,this.yOffset=(o.y*this.zScale-l.y)*kt)}constantElevation(o,l){if(o.constantHeight!=null)return this.computeBiasedHeight(o.constantHeight,l)}pointElevation(o,l,u){let p=this.constantElevation(l,u);return p??(o.x=o.x*this.zScale+this.xOffset,o.y=o.y*this.zScale+this.yOffset,this.computeBiasedHeight(l.pointElevation(o),u))}computeBiasedHeight(o,l){return l<=0?o:o+l*Vo(0,l,o>=0?o:Math.abs(.5*o))}}$t(dT,"ElevationFeature");class UO{constructor(){this.polygons=new Map}add(o,...l){this.polygons.has(o)?this.polygons.get(o).push(...l):this.polygons.set(o,l)}merge(o){for(let[l,u]of o.polygons)this.add(l,...u)}}class Ff{constructor(){this.portals=[]}static evaluate(o){if(o.length===0)return new Ff;let l=[];for(let D of o)l.push(...D.portals);if(l.length===0)return new Ff;let u=(D,v)=>D<=0&&v<=0||D>=kt&&v>=kt;for(let D of l){let v=D.va,E=D.vb;(u(v.x,E.x)||u(v.y,E.y))&&(D.type="border")}let p=l.filter(D=>D.type!=="unevaluated"),h=l.filter(D=>D.type==="unevaluated");if(h.length===0)return new Ff;h.sort((D,v)=>D.hash===v.hash?D.isTunnel===v.isTunnel?0:D.isTunnel?-1:1:D.hash<v.hash?1:-1),l=p.concat(h);let g=p.length,x=g,C=g;do if(x++,x===l.length||l[g].hash!==l[x].hash){if(x-g==2){C<g&&(l[C]=l[g],l[g]=null);let D=l[C],v=l[x-1];D.type=D.isTunnel!==v.isTunnel?"tunnel":"polygon",D.connection={a:D.connection.a,b:v.connection.a},C++}g=x}while(g!==l.length);return l.splice(C),l.sort((D,v)=>D.hash<v.hash?1:-1),{portals:l}}}$t(Ff,"ElevationPortalGraph"),$t(UO,"ElevationPolygons");class H8{constructor(o,l,u){this.outPositions=o,this.outNormals=l,this.outIndices=u,this.vertexLookup=new Map,this.buffer=new ArrayBuffer(4),this.view=new DataView(this.buffer)}addVertex(o,l,u){let p=o[2];u!=null&&(p*=u);let h=this.getVec3Bits(o)<<96n|this.getVec3Bits(l),g=this.vertexLookup.get(h);if(g!=null)return g;let x=this.outPositions.length;this.vertexLookup.set(h,x);let C=Math.trunc(16384*l[0]),D=Math.trunc(16384*l[1]),v=Math.trunc(16384*l[2]);return this.outPositions.emplaceBack(o[0],o[1],p),this.outNormals.emplaceBack(C,D,v),x}addVertices(o,l,...u){let p=[];for(let h of u){let g=this.addVertex(h,o,l);p.push(g)}return p}addTriangles(o,l,u){if(l&&u){let p=u.length===1,h=ce.vec3.fromValues(0,0,0);for(let g=0;g<o.length;g+=3){let x=l[o[g+0]],C=l[o[g+1]],D=l[o[g+2]],v=p?u[0]:u[o[g+1]],E=p?u[0]:u[o[g+2]],T=this.addVertex(ce.vec3.fromValues(x.x,x.y,p?u[0]:u[o[g+0]]),h),S=this.addVertex(ce.vec3.fromValues(C.x,C.y,v),h),M=this.addVertex(ce.vec3.fromValues(D.x,D.y,E),h);this.outIndices.emplaceBack(T,S,M)}}else for(let p=0;p<o.length;p+=3)this.outIndices.emplaceBack(o[p+0],o[p+1],o[p+2])}addQuad(o,l){let u=this.addVertices(l,void 0,...o.map(C=>ce.vec3.fromValues(C.coord.x,C.coord.y,C.height))),[p,h,g,x]=u;this.addTriangles([p,h,g,g,x,p])}getBits(o){return this.view.setFloat32(0,o),BigInt(this.view.getUint32(0))}getVec3Bits(o){return this.getBits(o[0])<<64n|this.getBits(o[1])<<32n|this.getBits(o[2])}}class Mc{constructor(o){this.unevaluatedPortals=new Ff,this.portalPolygons=new UO,this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new bf,this.vertexNormals=new zv,this.indexArray=new Uo,this.tileToMeters=m(o)}addVertices(o,l){let u=this.unevalVertices.length;for(let p=0;p<o.length;p++)this.unevalVertices.push(o[p]),this.unevalHeights.push(l[p]);return u}addTriangles(o,l,u){let p=u?this.unevalTunnelTriangles:this.unevalTriangles;for(let h of o)p.push(h+l)}addRenderableRing(o,l,u,p,h){let g=[new At(h.min.x,h.min.y),new At(h.max.x,h.min.y),new At(h.max.x,h.max.y),new At(h.min.x,h.max.y)];for(let x=0;x<u-1;x++){let C=l+x,D=C+1,v=this.unevalVertices[C],E=this.unevalVertices[D];if(!(v.x>=h.min.x&&v.x<=h.max.x&&v.y>=h.min.y&&v.y<=h.max.y||E.x>=h.min.x&&E.x<=h.max.x&&E.y>=h.min.y&&E.y<=h.max.y||Ae(v,E,g))||this.isOnBorder(v.x,E.x)||this.isOnBorder(v.y,E.y))continue;let T=Mc.computeEdgeHash(this.unevalVertices[C],this.unevalVertices[D]),S,M=this.vertexHashLookup.get(Mc.computePosHash(v));M!=null?S=M.next:(M=this.vertexHashLookup.get(Mc.computePosHash(E)),S=M!=null?M.prev:T),this.unevalEdges.push({polygonIdx:o,a:C,b:D,hash:T,portalHash:S,isTunnel:p,type:"unevaluated"})}}addPortalCandidates(o,l,u,p,h){if(l.length===0)return;this.portalPolygons.add(o,{geometry:l,zLevel:h});let g=l[0];this.vertexHashLookup.clear();let x=Mc.computeEdgeHash(g[g.length-2],g[g.length-1]);for(let C=0;C<g.length-1;C++){let D=g[C+0],v=g[C+1],E=ce.vec2.fromValues(v.x-D.x,v.y-D.y),T=ce.vec2.length(E);if(T===0)continue;let S="unevaluated",M=p.pointElevation(D),R=p.pointElevation(v);Math.abs(M)<.01&&Math.abs(R)<.01?S="entrance":(this.isOnBorder(D.x,v.x)||this.isOnBorder(D.y,v.y))&&(S="border");let L=Mc.computeEdgeHash(D,v);this.unevaluatedPortals.portals.push({connection:{a:o,b:void 0},va:D,vb:v,vab:E,length:T,hash:L,isTunnel:u,type:S});let N=Mc.computePosHash(D);this.vertexHashLookup.set(N,{prev:x,next:L}),x=L}}construct(o){if(this.unevalVertices.length===0)return;let l=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),u=E=>{E.primitiveLength=this.indexArray.length-E.primitiveOffset},p=new H8(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(o.portals,this.unevalEdges);let h=l(),g=l(),x=l(),C=(E,T)=>{E.sort((M,R)=>M.type===T&&R.type!==T?-1:M.type!==T&&R.type===T?1:0);let S=E.findIndex(M=>M.type!==T);return S>=0?S:E.length},D=0;this.unevalEdges.length>0&&(D=C(this.unevalEdges,"none"),this.constructBridgeStructures(p,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:D},this.tileToMeters));let v=l();if(this.unevalEdges.length>0){let E=this.unevalEdges.splice(D),T=C(E,"tunnel")+D;this.unevalEdges.push(...E),this.constructTunnelStructures(p,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:D},{min:D,max:T})}u(x),p.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),u(v),p.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),u(g),p.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),u(h),this.maskSegments=_r.simpleSegment(0,v.primitiveOffset,0,v.primitiveLength),this.depthSegments=_r.simpleSegment(0,g.primitiveOffset,0,g.primitiveLength),this.renderableSegments=_r.simpleSegment(0,x.primitiveOffset,0,x.primitiveLength),this.shadowCasterSegments=_r.simpleSegment(0,h.primitiveOffset,0,h.primitiveLength)}upload(o){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=o.createVertexBuffer(this.vertexPositions,M8.members),this.vertexBufferNormal=o.createVertexBuffer(this.vertexNormals,T8.members),this.indexBuffer=o.createIndexBuffer(this.indexArray))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableSegments.destroy(),this.shadowCasterSegments.destroy())}computeVertexConnections(o,l,u,p){let h=new Map;for(let g=u;g<p;g++){let x=l[g],C=x.a,D=x.b;h.has(C)||h.set(C,{}),h.has(D)||h.set(D,{});let v=h.get(C),E=h.get(D);o[D]>0&&(v.to=D),o[C]>0&&(E.from=C)}return h}constructBridgeStructures(o,l,u,p,h,g){let x=this.computeVertexConnections(u,p,h.min,h.max),C=1/g,D=.5*C,v=T=>ce.vec3.fromValues(l[T].x,l[T].y,u[T]*C),E=T=>{let S=x.get(T),M=S.from,R=S.to;if(!M||!R)return;let L=v(M),N=v(T),$=v(R),H=ce.vec3.fromValues(0,0,0);if(!ce.vec3.exactEquals(L,N)){let q=ce.vec3.sub(ce.vec3.create(),N,L);ce.vec3.add(H,H,ce.vec3.normalize(q,q))}if(!ce.vec3.exactEquals($,N)){let q=ce.vec3.sub(ce.vec3.create(),$,N);ce.vec3.add(H,H,ce.vec3.normalize(q,q))}let j=ce.vec3.len(H);return j>0?ce.vec3.scale(H,H,1/j):void 0};for(let T=h.min;T<h.max;T++){let S=p[T],M=this.prepareEdgePoints(l,u,S,(yt,mi)=>yt>=mi);if(M==null)continue;let R=M[0],L=M[1],N=ce.vec3.fromValues(R.coord.x,R.coord.y,C*R.height),$=ce.vec3.fromValues(L.coord.x,L.coord.y,C*L.height);if(ce.vec3.exactEquals(N,$))continue;let H=ce.vec3.sub(ce.vec3.create(),$,N);ce.vec3.normalize(H,H);let j=yt=>ce.vec3.normalize(yt,yt),q=E(S.a)||H,Y=E(S.b)||H,Q=j(ce.vec3.fromValues(q[1],-q[0],0)),pe=j(ce.vec3.fromValues(Y[1],-Y[0],0)),de=j(ce.vec3.cross(ce.vec3.create(),Q,q)),ue=j(ce.vec3.cross(ce.vec3.create(),pe,Y)),De=ce.vec3.create(),fe=[ce.vec3.add(ce.vec3.create(),N,ce.vec3.scale(De,ce.vec3.sub(De,Q,de),D)),ce.vec3.add(ce.vec3.create(),N,ce.vec3.scale(De,ce.vec3.add(De,Q,de),D)),ce.vec3.add(ce.vec3.create(),N,ce.vec3.scale(De,de,D)),N],Me=[ce.vec3.add(ce.vec3.create(),$,ce.vec3.scale(De,ce.vec3.sub(De,pe,ue),D)),ce.vec3.add(ce.vec3.create(),$,ce.vec3.scale(De,ce.vec3.add(De,pe,ue),D)),ce.vec3.add(ce.vec3.create(),$,ce.vec3.scale(De,ue,D)),$],[Fe,Pe]=o.addVertices(Q,g,fe[0],fe[1]),[ze,Ne]=o.addVertices(pe,g,Me[0],Me[1]);o.addTriangles([Fe,Pe,ze,Pe,Ne,ze]);let[Ge,Ue]=o.addVertices(de,g,fe[1],fe[2]),[qe,gt]=o.addVertices(ue,g,Me[1],Me[2]);o.addTriangles([Ge,Ue,qe,Ue,gt,qe]);let[ft,Gt]=o.addVertices(ce.vec3.negate(Q,Q),g,fe[2],fe[3]),[wt,Rt]=o.addVertices(ce.vec3.negate(pe,pe),g,Me[2],Me[3]);o.addTriangles([ft,Gt,wt,Gt,Rt,wt])}}constructTunnelStructures(o,l,u,p,h,g){let x=C=>ce.vec3.normalize(C,C);for(let C=h.min;C<h.max;C++){let D=this.prepareEdgePoints(l,u,p[C],(S,M)=>S<=M);if(D==null)continue;let[v,E]=D,T=x(ce.vec3.fromValues(E.coord.y-v.coord.y,-(E.coord.x-v.coord.x),0));o.addQuad([v,E,{coord:E.coord,height:p[C].isTunnel?-.1:0},{coord:v.coord,height:p[C].isTunnel?-.1:0}],T)}for(let C=g.min;C<g.max;C++){let D=p[C],v=l[D.a],E=l[D.b],T=x(ce.vec3.fromValues(E.y-v.y,-(E.x-v.x),0));o.addQuad([{coord:E,height:0},{coord:v,height:0},{coord:v,height:u[D.a]+4},{coord:E,height:u[D.b]+4}],T),o.addQuad([{coord:v,height:0},{coord:E,height:0},{coord:E,height:u[D.b]+4},{coord:v,height:u[D.a]+4}],T)}}prepareEdgePoints(o,l,u,p){let h=o[u.a],g=o[u.b],x=l[u.a],C=l[u.b];if(!(x!==0&&p(x,0)||C!==0&&p(C,0)))return;let D=h.clone(),v=g.clone();if(p(x,0)){if(!p(C,0)){let E=C/(C-x);v.x=yi(v.x,D.x,E),v.y=yi(v.y,D.y,E),C=yi(C,x,E)}}else{let E=x/(x-C);D.x=yi(D.x,v.x,E),D.y=yi(D.y,v.y,E),x=yi(x,C,E)}return[{coord:D,height:x},{coord:v,height:C}]}prepareEdges(o,l){if(l.length===0)return;l.sort((x,C)=>x.hash===C.hash?C.polygonIdx-x.polygonIdx:C.hash>x.hash?1:-1);let u=0,p=0,h=0,g=l[u].polygonIdx;do p++,(p===l.length||l[u].hash!==l[p].hash)&&((p-u==1||l[p-1].polygonIdx!==g)&&(h<u&&(l[h]=l[u],l[u]=null),l[h].type="none",h++),u=p,u!==l.length&&(g=l[u].polygonIdx));while(u!==l.length);if(l.splice(h),l.length!==0&&o.length!==0){l.sort((D,v)=>D.hash<v.hash?1:-1);let x=0,C=0;for(;x!==l.length&&C!==o.length;){let D=l[x],v=o[C];D.portalHash>v.hash?x++:v.hash>D.portalHash?C++:(D.type=v.type,x++)}}}isOnBorder(o,l){return o<=0&&l<=0||o>=kt&&l>=kt}static computeEdgeHash(o,l){return(o.y===l.y&&o.x>l.x||o.y>l.y)&&([o,l]=[l,o]),BigInt(Mc.computePosHash(o))<<32n|BigInt(Mc.computePosHash(l))}static computePosHash(o){return((65535&o.x)<<16|65535&o.y)>>>0}}class uT{constructor(o,l){this.layoutVertexArray=new wc,this.indexArray=new Uo,this.lineIndexArray=new fd,this.triangleSegments=new _r,this.lineSegments=new _r,this.programConfigurations=new gd(o.layers,{zoom:o.zoom,lut:o.lut}),this.uploaded=!1,l&&(this.elevatedLayoutVertexArray=new su)}update(o,l,u,p,h,g,x){this.programConfigurations.updatePaintArrays(o,l,h,u,p,g,x)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,S8.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.lineIndexBuffer=o.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=o.createVertexBuffer(this.elevatedLayoutVertexArray,D8.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(o,l,u,p,h,g){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,l,u,p,h,g)}}class hT{constructor(o){this.zoom=o.zoom,this.pixelRatio=o.pixelRatio,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.bufferData=new uT(o,!1),this.elevationBufferData=new uT(o,!0),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.projection=o.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference")}updateFootprints(o,l){}populate(o,l,u,p){this.hasPattern=oT("fill",this.layers,this.pixelRatio,l);let h=this.layers[0].layout.get("fill-sort-key"),g=[];for(let{feature:x,id:C,index:D,sourceLayerIndex:v}of o){let E=this.layers[0]._featureFilter.needGeometry,T=F(x,E);if(!this.layers[0]._featureFilter.filter(new ir(this.zoom),T,u))continue;let S=h?h.evaluate(T,{},u,l.availableImages):void 0,M={id:C,properties:x.properties,type:x.type,sourceLayerIndex:v,index:D,geometry:E?T.geometry:O(x,u,p),patterns:{},sortKey:S};g.push(M)}h&&g.sort((x,C)=>x.sortKey-C.sortKey);for(let x of g){let{geometry:C,index:D,sourceLayerIndex:v}=x;if(this.hasPattern){let E=aT("fill",this.layers,x,this.zoom,this.pixelRatio,l);this.patternFeatures.push(E)}else this.addFeature(x,C,D,u,{},l.availableImages,l.brightness,l.elevationFeatures);l.featureIndex.insert(o[D].feature,C,D,v,this.index)}}update(o,l,u,p,h,g,x){this.bufferData.update(o,l,u,p,h,g,x),this.elevationBufferData.update(o,l,u,p,h,g,x)}addFeatures(o,l,u,p,h,g){for(let x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,l,u,p,g,o.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(o){this.bufferData.upload(o),this.elevationBufferData.upload(o),this.elevatedStructures&&this.elevatedStructures.upload(o)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(o,l,u,p,h,g=[],x,C){let D=Zw(l,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(o,D,p,u,C):this.addGeometry(D,this.bufferData),this.bufferData.populatePaintArrays(o,u,h,g,p,x),this.elevationBufferData.populatePaintArrays(o,u,h,g,p,x)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(o){this.elevatedStructures&&this.elevatedStructures.construct(o)}addElevatedRoadFeature(o,l,u,p,h){let g=new Array,x=this.getElevationFeature(o,h);if(x){g.push({polygons:l,elevationFeature:x,elevationTileID:u});for(let C of g)if(C.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new Mc(C.elevationTileID));let v=C.elevationFeature.isTunnel(),E=0;o.properties.hasOwnProperty(VO)&&(E=+o.properties[VO]);for(let T of C.polygons)this.elevatedStructures.addPortalCandidates(C.elevationFeature.id,T,v,C.elevationFeature,E)}let D=new U8(u,C.elevationTileID);this.addElevatedGeometry(C.polygons,D,C.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,p)}}else this.addGeometry(l,this.bufferData)}addElevatedGeometry(o,l,u,p,h){let g={elevation:u,elevationSampler:l,bias:p,index:h},[x,C]=this.addGeometry(o,this.elevationBufferData,g);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:x,max:C}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,x),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,C))}addGeometry(o,l,u){let p=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,g=null;u&&(g=u.elevationSampler.constantElevation(u.elevation,u.bias),g!=null&&(p=g,h=g));let x=(C,D,v)=>{if(u!=null)if(D.push(C),g!=null)l.elevatedLayoutVertexArray.emplaceBack(g),v.push(g);else{let E=u.elevationSampler.pointElevation(C,u.elevation,u.bias);l.elevatedLayoutVertexArray.emplaceBack(E),v.push(E),p=Math.min(p,E),h=Math.max(h,E)}};for(let C of o){let D=0;for(let H of C)D+=H.length;let v=l.triangleSegments.prepareSegment(D,l.layoutVertexArray,l.indexArray),E=v.vertexLength,T=[],S=[],M=[],R=[],L=[],N=l.layoutVertexArray.length;for(let H of C){if(H.length===0)continue;H!==C[0]&&S.push(T.length/2);let j=l.lineSegments.prepareSegment(H.length,l.layoutVertexArray,l.lineIndexArray),q=j.vertexLength;u&&L.push(l.layoutVertexArray.length-N),x(H[0],M,R),l.layoutVertexArray.emplaceBack(H[0].x,H[0].y),l.lineIndexArray.emplaceBack(q+H.length-1,q),T.push(H[0].x),T.push(H[0].y);for(let Y=1;Y<H.length;Y++)x(H[Y],M,R),l.layoutVertexArray.emplaceBack(H[Y].x,H[Y].y),l.lineIndexArray.emplaceBack(q+Y-1,q+Y),T.push(H[Y].x),T.push(H[Y].y);j.vertexLength+=H.length,j.primitiveLength+=H.length}let $=a0(T,S);for(let H=0;H<$.length;H+=3)l.indexArray.emplaceBack(E+$[H],E+$[H+1],E+$[H+2]);if(u&&this.elevationMode==="hd-road-base"){let H=u.elevation.isTunnel(),j=u.elevation.safeArea,q=this.elevatedStructures.addVertices(M,R);this.elevatedStructures.addTriangles($,q,H);let Y=L.length;if(Y>0){for(let Q=0;Q<Y-1;Q++)this.elevatedStructures.addRenderableRing(u.index,L[Q]+q,L[Q+1]-L[Q],H,j);this.elevatedStructures.addRenderableRing(u.index,L[Y-1]+q,M.length-L[Y-1],H,j)}}v.vertexLength+=D,v.primitiveLength+=$.length/3}return[p,h]}getElevationFeature(o,l){if(!l)return;let u=+o.properties[Of];return u!=null?l.find(p=>p.id===u):void 0}}let HO,$O,GO,qO;$t(hT,"FillBucket",{omit:["layers","patternFeatures"]}),$t(uT,"FillBufferData"),$t(Mc,"ElevatedStructures");class pT{constructor(o,l,u,p){if(this.triangleCount=l.length/3,this.min=new At(0,0),this.max=new At(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||o.length===0)return;let[h,g]=[o[0].clone(),o[0].clone()];for(let E=1;E<o.length;++E){let T=o[E];h.x=Math.min(h.x,T.x),h.y=Math.min(h.y,T.y),g.x=Math.max(g.x,T.x),g.y=Math.max(g.y,T.y)}if(p){let E=Math.ceil(Math.max(g.x-h.x,g.y-h.y)/p);u=Math.max(u,E)}if(u===0)return;this.min=h,this.max=g;let x=this.max.sub(this.min);x.x=Math.max(x.x,1),x.y=Math.max(x.y,1);let C=Math.max(x.x,x.y)/u;this.cellsX=Math.max(1,Math.ceil(x.x/C)),this.cellsY=Math.max(1,Math.ceil(x.y/C)),this.xScale=1/C,this.yScale=1/C;let D=[];for(let E=0;E<this.triangleCount;E++){let T=o[l[3*E+0]].sub(this.min),S=o[l[3*E+1]].sub(this.min),M=o[l[3*E+2]].sub(this.min),R=vd(Math.floor(Math.min(T.x,S.x,M.x)),this.xScale,this.cellsX),L=vd(Math.floor(Math.max(T.x,S.x,M.x)),this.xScale,this.cellsX),N=vd(Math.floor(Math.min(T.y,S.y,M.y)),this.yScale,this.cellsY),$=vd(Math.floor(Math.max(T.y,S.y,M.y)),this.yScale,this.cellsY),H=new At(0,0),j=new At(0,0),q=new At(0,0),Y=new At(0,0);for(let Q=N;Q<=$;++Q){H.y=j.y=Q*C,q.y=Y.y=(Q+1)*C;for(let pe=R;pe<=L;++pe)H.x=q.x=pe*C,j.x=Y.x=(pe+1)*C,(Ke(T,S,M,H,j,Y)||Ke(T,S,M,H,Y,q))&&D.push({cellIdx:Q*this.cellsX+pe,triIdx:E})}}if(D.length===0)return;D.sort((E,T)=>E.cellIdx-T.cellIdx||E.triIdx-T.triIdx);let v=0;for(;v<D.length;){let E=D[v].cellIdx,T={start:this.payload.length,len:0};for(;v<D.length&&D[v].cellIdx===E;)++T.len,this.payload.push(D[v++].triIdx);this.cells[E]=T}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(o,l){if(this.triangleCount===0||this.cells.length===0||o.x>this.max.x||this.min.x>o.x||o.y>this.max.y||this.min.y>o.y)return;let u=vd(o.x-this.min.x,this.xScale,this.cellsX),p=vd(o.y-this.min.y,this.yScale,this.cellsY),h=this.cells[p*this.cellsX+u];if(h){this._lazyInitLookup();for(let g=0;g<h.len;g++){let x=this.payload[h.start+g],C=Math.floor(x/8),D=1<<x%8;if(!(this.lookup[C]&D)&&(this.lookup[C]|=D,l.push(x),l.length===this.triangleCount))return}}}query(o,l,u){if(this.triangleCount===0||this.cells.length===0||o.x>this.max.x||this.min.x>l.x||o.y>this.max.y||this.min.y>l.y)return;this._lazyInitLookup();let p=vd(o.x-this.min.x,this.xScale,this.cellsX),h=vd(l.x-this.min.x,this.xScale,this.cellsX),g=vd(o.y-this.min.y,this.yScale,this.cellsY),x=vd(l.y-this.min.y,this.yScale,this.cellsY);for(let C=g;C<=x;C++)for(let D=p;D<=h;D++){let v=this.cells[C*this.cellsX+D];if(v)for(let E=0;E<v.len;E++){let T=this.payload[v.start+E],S=Math.floor(T/8),M=1<<T%8;if(!(this.lookup[S]&M)&&(this.lookup[S]|=M,u.push(T),u.length===this.triangleCount))return}}}}function vd(d,o,l){return Math.max(0,Math.min(l-1,Math.floor(d*o)))}$t(pT,"TriangleGridIndex");class WO{constructor(o){this.zoom=o.zoom,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.footprints=[]}updateFootprints(o,l){for(let u of this.footprints)l.push({footprint:u,id:o})}populate(o,l,u,p){let h=[];for(let{feature:g,id:x,index:C,sourceLayerIndex:D}of o){let v=this.layers[0]._featureFilter.needGeometry,E=F(g,v);if(!this.layers[0]._featureFilter.filter(new ir(this.zoom),E,u))continue;let T={id:x,properties:g.properties,type:g.type,sourceLayerIndex:D,index:C,geometry:v?E.geometry:O(g,u,p),patterns:{}};h.push(T)}for(let g of h){let{geometry:x,index:C,sourceLayerIndex:D}=g;this.addFeature(g,x,C,u,{},l.availableImages,l.brightness),l.featureIndex.insert(o[C].feature,x,C,D,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(o){}update(o,l,u,p,h,g,x){}destroy(){}addFeature(o,l,u,p,h,g=[],x){for(let C of Zw(l,2)){let D=[],v=[],E=[],T=new At(1/0,1/0),S=new At(-1/0,-1/0);for(let L of C)if(L.length!==0){L!==C[0]&&E.push(v.length/2);for(let N=0;N<L.length;N++)v.push(L[N].x),v.push(L[N].y),D.push(L[N]),T.x=Math.min(T.x,L[N].x),T.y=Math.min(T.y,L[N].y),S.x=Math.max(S.x,L[N].x),S.y=Math.max(S.y,L[N].y)}let M=a0(v,E),R=new pT(D,M,8,256);this.footprints.push({vertices:D,indices:M,grid:R,min:T,max:S})}}}$t(WO,"ClipBucket",{omit:["layers"]});let $8=En([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),G8=En([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),q8=En([{name:"a_centroid_pos",components:2,type:"Uint16"}]),W8=En([{name:"a_join_normal_inside",components:3,type:"Int16"}]),Y8=En([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Z8=En([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:X8}=$8;class Lf extends At{constructor(o,l,u){super(o,l),this.z=u}}class YO extends Lf{constructor(o,l,u,p){super(o,l,u),this.w=p}}function Kw(d,o,l,u){let p=[],h=u===0?(g,x,C,D,v,E)=>{g.push(new At(E,C+(E-x)/(D-x)*(v-C)))}:(g,x,C,D,v,E)=>{g.push(new At(x+(E-C)/(v-C)*(D-x),E))};for(let g of d){let x=[];for(let C of g){if(C.length<=2)continue;let D=[];for(let T=0;T<C.length-1;T++){let S=C[T].x,M=C[T].y,R=C[T+1].x,L=C[T+1].y,N=u===0?S:M,$=u===0?R:L;N<o?$>o&&h(D,S,M,R,L,o):N>l?$<l&&h(D,S,M,R,L,l):D.push(C[T]),$<o&&N>=o&&h(D,S,M,R,L,o),$>l&&N<=l&&h(D,S,M,R,L,l)}let v=C[C.length-1],E=u===0?v.x:v.y;E>=o&&E<=l&&D.push(v),D.length&&(v=D[D.length-1],D[0].x===v.x&&D[0].y===v.y||D.push(D[0]),x.push(D))}x.length&&p.push(x)}return p}function ZO(d,o,l,u){let p=l==="x"?"y":"x",h=(u-d[l])/(o[l]-d[l]);d[p]=d[p]+(o[p]-d[p])*h,d[l]=u,d.hasOwnProperty("z")&&(d.z=yi(d.z,o.z,h)),d.hasOwnProperty("w")&&(d.w=yi(d.w,o.w,h))}function XO(d,o,l,u){let p=l,h=u;for(let g of["x","y"]){let x=d,C=o;x[g]>=C[g]&&(x=o,C=d),x[g]<p&&C[g]>p&&ZO(x,C,g,p),x[g]<h&&C[g]>h&&ZO(C,x,g,h)}}let Qw=Number.MAX_SAFE_INTEGER;function KO(d,o,l,u){return d.order<o||d.order===Qw||!(d.clipMask&l)||function(p,h){return h.length!==0&&h.find(g=>g===p)===void 0}(u,d.clipScope)}function Jw(d,o){return d.x-o.x||d.y-o.y}function QO(d,o){return Jw(d.min,o.min)===0&&Jw(d.max,o.max)===0}function fT(d,o){return!(d.min.x>o.max.x||d.max.x<o.min.x||d.min.y>o.max.y||d.max.y<o.min.y)}function mT(d,o){if(d.length!==o.length)return!1;for(let l=0;l<d.length;l++)if(d[l].sourceId!==o[l].sourceId||!QO(d[l],o[l])||d[l].order!==o[l].order||d[l].clipMask!==o[l].clipMask||!To(d[l].clipScope,o[l].clipScope))return!1;return!0}function JO(d,o,l){let u=1/kt,p=1/(1<<l.canonical.z),h=(o.x*u+l.canonical.x)*p+l.wrap,g=(o.y*u+l.canonical.y)*p;return{min:new At((d.x*u+l.canonical.x)*p+l.wrap,(d.y*u+l.canonical.y)*p),max:new At(h,g)}}function K8(d,o,l){let u=1<<l.canonical.z,p=((o.x-l.wrap)*u-l.canonical.x)*kt,h=(o.y*u-l.canonical.y)*kt;return{min:new At(((d.x-l.wrap)*u-l.canonical.x)*kt,(d.y*u-l.canonical.y)*kt),max:new At(p,h)}}function eF(d,o,l,u,p,h,g){let x=d.indices,C=d.vertices,D=[];for(let v=u;v<u+p;v+=3){let E=o[l[v+0]+h],T=o[l[v+1]+h],S=o[l[v+2]+h],M=Math.min(E.x,T.x,S.x),R=Math.max(E.x,T.x,S.x),L=Math.min(E.y,T.y,S.y),N=Math.max(E.y,T.y,S.y);D.length=0,d.grid.query(new At(M,L),new At(R,N),D);for(let $=0;$<D.length;$++){let H=D[$];if(Ke(C[x[3*H+0]],C[x[3*H+1]],C[x[3*H+2]],E,T,S,g))return!0}}return!1}function tF(d,o,l,u){if(!d||!l)return!1;let p=d.vertices;if(!o.canonical.equals(u.canonical)||o.wrap!==u.wrap){if(l.vertices.length<d.vertices.length)return tF(l,u,d,o);let h=o.canonical,g=u.canonical,x=Math.pow(2,g.z-h.z);p=d.vertices.map(C=>new At((C.x+h.x*kt)*x-g.x*kt,(C.y+h.y*kt)*x-g.y*kt))}return eF(l,p,d.indices,0,d.indices.length,0,0)}function iF(d,o,l,u){let p=Math.pow(2,u.z-l.z);return new At((d+l.x*kt)*p-u.x*kt,(o+l.y*kt)*p-u.y*kt)}function nF(d,o){let l=[];o.grid.queryPoint(d,l);let u=o.indices,p=o.vertices;for(let h=0;h<l.length;h++){let g=l[h];if(be([p[u[3*g+0]],p[u[3*g+1]],p[u[3*g+2]]],d))return!0}return!1}let gT=[new At(0,0),new At(kt,0),new At(kt,kt),new At(0,kt)];function rF(d,o){let l=[],u=[];if(!o||d.length<2)return[d];if(d.length===2)return Ae(d[0],d[1],gT)?[d]:[];for(let p=0;p<d.length+2;p++){let h=d[p%d.length],g=d[(p+1)%d.length],x=Ae(p===0?d[d.length-1]:d[(p-1)%d.length],h,gT),C=Ae(h,g,gT),D=x||C;D&&u.push(h),D&&C||u.length>0&&(u.length>1&&l.push(u),u=[])}return u.length>1&&l.push(u),l}let _T=Fh.VectorTileFeature.types,Q8=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],J8=["fill-extrusion-flood-light-ground-radius"],e$=Math.pow(2,13),t$=Math.pow(2,15)-1,oF=new At(0,1),Lh=2147483648;function d0(d,o,l,u,p,h,g,x){d.emplaceBack((o<<1)+g,(l<<1)+h,(Math.floor(u*e$)<<1)+p,Math.round(x))}function u0(d,o,l){d.emplaceBack(o.x*kt,o.y*kt,l?1:0)}function e1(d,o,l,u,p,h){d.emplaceBack(o.x,o.y,(l.x<<1)+u,(l.y<<1)+p,h)}function h0(d,o,l){d.emplaceBack(o.x,o.y,o.z,l[0]*16384,l[1]*16384,l[2]*16384)}class aF{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class sF{constructor(){this.centroidXY=new At(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new At(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new At(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new At(this.max.x-this.min.x,this.max.y-this.min.y)}}class lF{constructor(){this.acc=new At(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(o,l){o.min.x===Number.MAX_VALUE&&(o.min.x=o.max.x=l.x,o.min.y=o.max.y=l.y)}appendEdge(o,l,u){this.accCount++,this.acc._add(l);let p=!!this.borders;l.x<o.min.x?(o.min.x=l.x,p=!0):l.x>o.max.x&&(o.max.x=l.x,p=!0),l.y<o.min.y?(o.min.y=l.y,p=!0):l.y>o.max.y&&(o.max.y=l.y,p=!0),((l.x===0||l.x===kt)&&l.x===u.x)!=((l.y===0||l.y===kt)&&l.y===u.y)&&this.processBorderOverlap(l,u),p&&this.checkBorderIntersection(l,u)}checkBorderIntersection(o,l){l.x<0!=o.x<0&&this.addBorderIntersection(0,yi(l.y,o.y,(0-l.x)/(o.x-l.x))),l.x>kt!=o.x>kt&&this.addBorderIntersection(1,yi(l.y,o.y,(kt-l.x)/(o.x-l.x))),l.y<0!=o.y<0&&this.addBorderIntersection(2,yi(l.x,o.x,(0-l.y)/(o.y-l.y))),l.y>kt!=o.y>kt&&this.addBorderIntersection(3,yi(l.x,o.x,(kt-l.y)/(o.y-l.y)))}addBorderIntersection(o,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);let u=this.borders[o];l<u[0]&&(u[0]=l),l>u[1]&&(u[1]=l)}processBorderOverlap(o,l){if(o.x===l.x){if(o.y===l.y)return;let u=o.x===0?0:1;this.addBorderIntersection(u,l.y),this.addBorderIntersection(u,o.y)}else{let u=o.y===0?2:3;this.addBorderIntersection(u,l.x),this.addBorderIntersection(u,o.x)}}centroid(){return this.accCount===0?new At(0,0):new At(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((o,l)=>o+ +(l[0]!==Number.MAX_VALUE),0):0}}function cF(d,o){let l=d.add(o)._unit(),u=qi(d.x*l.x+d.y*l.y,-1,1);var p,h,g;return g=Math.acos(u),Math.min(4,Math.max(-4,Math.tan(g)))/4*t$*((p=d).x*(h=o).y-p.y*h.x<0?-1:1)}let i$=[d=>d.x<0,d=>d.x>kt,d=>d.y<0,d=>d.y>kt];function n$(d,o,l,u){let p=[4];if(u===0)return p;l._mult(u);let h=d.sub(l),g=o.sub(l),x=[d,o,h,g];for(let C=0;C<4;C++)for(let D of x)if(i$[C](D)){p.push(C);break}return p}class dF{constructor(o){this.vertexArray=new js,this.indexArray=new Uo,this.programConfigurations=new gd(o.layers,{zoom:o.zoom,lut:o.lut},l=>J8.includes(l)),this._segments=new _r,this.hiddenByLandmarkVertexArray=new Yv,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new _r}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(o,l,u,p=!1){let h=o.length;if(h>2){let g=Math.max(0,this._segments.get().length-1),x=this._segments._prepareSegment(4*h,this.vertexArray.length,2*this._segmentToGroundQuads[g].length),C;g!==this._segments.get().length-1&&(g++,this._segmentToGroundQuads[g]=[],this._segmentToRegionTriCounts[g]=[0,0,0,0,0]);{let D=o[0],v=o[1];C=cF(D.sub(o[h-1])._perp()._unit(),v.sub(D)._perp()._unit())}for(let D=0;D<h;D++){let v=D===h-1?0:D+1,E=o[D],T=o[v],S=o[v===h-1?0:v+1],M=T.sub(E)._perp()._unit(),R=cF(M,S.sub(T)._perp()._unit()),L=C,N=R;if(yT(E,T,l)||p&&pF(E,l)&&pF(T,l)){C=R;continue}let $=x.vertexLength;e1(this.vertexArray,E,T,1,1,L),e1(this.vertexArray,E,T,1,0,L),e1(this.vertexArray,E,T,0,1,N),e1(this.vertexArray,E,T,0,0,N),x.vertexLength+=4;let H=n$(E,T,M,u);for(let j of H)this._segmentToGroundQuads[g].push({id:$,region:j}),this._segmentToRegionTriCounts[g][j]+=2,x.primitiveLength+=2;C=R}}}prepareBorderSegments(){if(!this.hasData())return;let o=this._segments.get(),l=o.length;for(let u=0;u<l;u++)this._segmentToGroundQuads[u].sort((p,h)=>p.region-h.region);for(let u=0;u<l;u++){let p=this._segmentToGroundQuads[u],h=o[u],g=this._segmentToRegionTriCounts[u];g.reduce((C,D)=>C+D,0);let x=0;for(let C=0;C<=4;C++){let D=g[C];if(D!==0){let v=this.regionSegments[C];v||(v=this.regionSegments[C]=new _r);let E={vertexOffset:h.vertexOffset,primitiveOffset:h.primitiveOffset+x,vertexLength:h.vertexLength,primitiveLength:D};v.get().push(E)}x+=D}for(let C=0;C<p.length;C++){let D=p[C].id;this.indexArray.emplaceBack(D,D+1,D+3),this.indexArray.emplaceBack(D,D+3,D+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(o,l,u,p,h,g){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,o,l,u,p,h,g)}upload(o){this.hasData()&&(this.vertexBuffer=o.createVertexBuffer(this.vertexArray,G8.members),this.indexBuffer=o.createIndexBuffer(this.indexArray))}uploadPaintProperties(o){this.hasData()&&this.programConfigurations.upload(o)}update(o,l,u,p,h,g,x){this.hasData()&&this.programConfigurations.updatePaintArrays(o,l,u,p,h,g,x)}updateHiddenByLandmark(o){if(!this.hasData())return;let l=o.groundVertexCount+o.groundVertexArrayOffset;if(o.groundVertexCount===0)return;let u=o.flags&Lh?1:0;for(let p=o.groundVertexArrayOffset;p<l;++p)this.hiddenByLandmarkVertexArray.emplace(p,u);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(o){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=o.createVertexBuffer(this.hiddenByLandmarkVertexArray,Y8.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let o=0;o<=4;o++){let l=this.regionSegments[o];l&&l.destroy()}}}}class t1{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.overscaling=o.overscaling,this.layers=o.layers,this.pixelRatio=o.pixelRatio,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=o.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Uo,this.footprintVertices=new wc,this.footprintSegments=[],this.layoutVertexArray=new Cc,this.centroidVertexArray=new Df,this.wallVertexArray=new zw,this.indexArray=new Uo,this.programConfigurations=new gd(o.layers,{zoom:o.zoom,lut:o.lut},l=>Q8.includes(l)),this.segments=new _r,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.groundEffect=new dF(o),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(o,l){}populate(o,l,u,p){this.features=[],this.hasPattern=oT("fill-extrusion",this.layers,this.pixelRatio,l),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=m(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(let{feature:h,id:g,index:x,sourceLayerIndex:C}of o){let D=this.layers[0]._featureFilter.needGeometry,v=F(h,D);if(!this.layers[0]._featureFilter.filter(new ir(this.zoom),v,u))continue;let E={id:g,sourceLayerIndex:C,index:x,geometry:D?v.geometry:O(h,u,p),properties:h.properties,type:h.type,patterns:{}},T=this.layoutVertexArray.length,S=_T[E.type]==="Polygon";if(this.hasPattern)this.features.push(aT("fill-extrusion",this.layers,E,this.zoom,this.pixelRatio,l));else if(this.wallMode)for(let M of E.geometry)for(let R of rF(M,S))this.addFeature(E,[R],x,u,{},l.availableImages,p,l.brightness);else this.addFeature(E,E.geometry,x,u,{},l.availableImages,p,l.brightness);l.featureIndex.insert(h,E.geometry,x,C,this.index,T)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(o,l,u,p,h,g){for(let x of this.features){let C=_T[x.type]==="Polygon",{geometry:D}=x;if(this.wallMode)for(let v of D)for(let E of rF(v,C))this.addFeature(x,[E],x.index,l,u,p,h,g);else this.addFeature(x,D,x.index,l,u,p,h,g)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(o,l,u,p,h,g,x){this.programConfigurations.updatePaintArrays(o,l,h,u,p,g,x),this.groundEffect.update(o,l,h,u,p,g,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,X8),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.wallVertexBuffer=o.createVertexBuffer(this.wallVertexArray,W8.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=o.createVertexBuffer(this.layoutVertexExtArray,Z8.members,!0)),this.groundEffect.upload(o)),this.groundEffect.uploadPaintProperties(o),this.programConfigurations.upload(o),this.uploaded=!0}uploadCentroid(o){this.groundEffect.uploadHiddenByLandmark(o),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,q8.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,l,u,p,h,g,x,C){let D=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(o,{})/this.tileToMeter,v=[new At(0,0),new At(kt,kt)],E=x.projection,T=E.name==="globe",S=this.wallMode||_T[o.type]==="Polygon",M=new lF;M.centroidDataIndex=this.centroidData.length;let R=new sF,L=this.layers[0].paint.get("fill-extrusion-base").evaluate(o,{},p)<=0,N=this.layers[0].paint.get("fill-extrusion-height").evaluate(o,{},p),$;if(R.height=N,R.vertexArrayOffset=this.layoutVertexArray.length,R.groundVertexArrayOffset=this.groundEffect.vertexArray.length,T&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Ig),this.wallMode){if(T)return void Er("Non zero fill-extrusion-line-width is not yet supported on globe.");if(l.length!==1)return;$=function(ue){let De=ue[0].x===ue[ue.length-1].x&&ue[0].y===ue[ue.length-1].y;(function(Rt){let yt=0,mi=Rt.length;for(let jt=0;jt<mi;jt++)yt+=(Rt[(jt+1)%mi].x-Rt[jt].x)*(Rt[(jt+1)%mi].y+Rt[jt].y);return yt>=0})(ue)||(ue=ue.reverse());let Me={geometry:[],joinNormals:[],indices:[]},Fe=[],Pe=[],ze=[],Ne=ue.length;for(;Ne>=2&&ue[Ne-1].equals(ue[Ne-2]);)Ne--;if(Ne<(De?3:2))return Me;let Ge,Ue,qe,gt,ft,Gt=0;for(;Gt<Ne-1&&ue[Gt].equals(ue[Gt+1]);)Gt++;De&&(Ge=ue[Ne-2],ft=ue[Gt].sub(Ge)._unit()._perp());for(let Rt=Gt;Rt<Ne;Rt++){if(qe=Rt===Ne-1?De?ue[Gt+1]:void 0:ue[Rt+1],qe&&ue[Rt].equals(qe))continue;ft&&(gt=ft),Ge&&(Ue=Ge),Ge=ue[Rt],ft=qe?qe.sub(Ge)._unit()._perp():gt,gt=gt||ft;let yt=gt.add(ft);yt.x===0&&yt.y===0||yt._unit();let mi=yt.x*ft.x+yt.y*ft.y,jt=mi!==0?1/mi:1/0,Jt=gt.x*ft.y-gt.y*ft.x>0,Ci="miter",Wi=2;Ci==="miter"&&jt>Wi&&(Ci="bevel"),Ci==="bevel"&&(jt>100&&(Ci="flipbevel"),jt<Wi&&(Ci="miter"));let Di=(en,Gi,rn,yn)=>{let nr=new At(en.x,en.y),Ei=new At(en.x,en.y);nr.x+=Gi.x*yn,nr.y+=Gi.y*yn,Ei.x-=Gi.x*Math.max(rn,1),Ei.y-=Gi.y*Math.max(rn,1),ze.push(Gi),Fe.push(nr),Pe.push(Ei)};if(Ci==="miter")yt._mult(jt),Di(Ge,yt,0,0);else if(Ci==="flipbevel")yt=ft.mult(-1),Di(Ge,yt,0,0),Di(Ge,yt.mult(-1),0,0);else{let en=-Math.sqrt(jt*jt-1),Gi=Jt?en:0,rn=Jt?0:en;Ue&&Di(Ge,gt,Gi,rn),qe&&Di(Ge,ft,Gi,rn)}}Me.geometry=[...Fe,...Pe.reverse(),Fe[0]],Me.joinNormals=[...ze,...ze.reverse(),ze[ze.length-1]];let wt=Me.geometry.length-1;for(let Rt=0;Rt<wt/2;Rt++)if(Rt+1<wt/2){let yt=Rt,mi=Rt+1,jt=wt-1-Rt,Jt=wt-2-Rt;yt=yt===0?wt-1:yt-1,mi=mi===0?wt-1:mi-1,jt=jt===0?wt-1:jt-1,Jt=Jt===0?wt-1:Jt-1,Me.indices.push(jt),Me.indices.push(mi),Me.indices.push(yt),Me.indices.push(jt),Me.indices.push(Jt),Me.indices.push(mi)}return Me}(l[0]),l=[$.geometry]}let H=(ue,De)=>ue<(De.length-1)/2||ue===De.length-1,j=this.wallMode?[l]:Zw(l,500);for(let ue=j.length-1;ue>=0;ue--){let De=j[ue];(De.length===0||(q=De[0]).every(fe=>fe.x<=0)||q.every(fe=>fe.x>=kt)||q.every(fe=>fe.y<=0)||q.every(fe=>fe.y>=kt))&&j.splice(ue,1)}var q;let Y;if(T)Y=_F(j,v,p);else{Y=[];for(let ue of j)Y.push({polygon:ue,bounds:v})}let Q=S?this.edgeRadius:0,pe=Q>0&&this.zoom<17,de=(ue,De)=>{if(ue.length===0)return!1;let fe=ue[ue.length-1];return De.x===fe.x&&De.y===fe.y};for(let{polygon:ue,bounds:De}of Y){let fe=0,Me=0;for(let Ne of ue)S&&!Ne[0].equals(Ne[Ne.length-1])&&Ne.push(Ne[0]),Me+=S?Ne.length-1:Ne.length;let Fe=this.segments.prepareSegment((S?5:4)*Me,this.layoutVertexArray,this.indexArray);R.footprintSegIdx<0&&(R.footprintSegIdx=this.footprintSegments.length),R.polygonSegIdx<0&&(R.polygonSegIdx=this.polygonSegments.length);let Pe={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},ze=new aF;if(ze.vertexOffset=this.footprintVertices.length,ze.indexOffset=3*this.footprintIndices.length,ze.ringIndices=[],S){let Ne=[],Ge=[];fe=Fe.vertexLength;for(let qe=0;qe<ue.length;qe++){let gt=ue[qe];gt.length&&qe!==0&&Ge.push(Ne.length/2);let ft=[],Gt,wt;Gt=gt[1].sub(gt[0])._perp()._unit(),ze.ringIndices.push(gt.length-1);for(let Rt=1;Rt<gt.length;Rt++){let yt=gt[Rt],mi=gt[Rt===gt.length-1?1:Rt+1],jt=yt.clone();if(Q){wt=mi.sub(yt)._perp()._unit();let Jt=Gt.add(wt)._unit(),Ci=Q*Math.min(4,1/(Gt.x*Jt.x+Gt.y*Jt.y));jt.x+=Ci*Jt.x,jt.y+=Ci*Jt.y,jt.x=Math.round(jt.x),jt.y=Math.round(jt.y),Gt=wt}if(!L||Q!==0&&!pe||de(ft,jt)||ft.push(jt),d0(this.layoutVertexArray,jt.x,jt.y,0,0,1,1,0),this.wallMode){let Jt=H(Rt,gt);u0(this.wallVertexArray,$.joinNormals[Rt],!Jt)}Fe.vertexLength++,this.footprintVertices.emplaceBack(yt.x,yt.y),Ne.push(yt.x,yt.y),T&&h0(this.layoutVertexExtArray,E.projectTilePoint(jt.x,jt.y,p),E.upVector(p,jt.x,jt.y))}L&&(Q===0||pe)&&(ft.length!==0&&de(ft,ft[0])&&ft.pop(),this.groundEffect.addData(ft,De,D))}let Ue=this.wallMode?$.indices:a0(Ne,Ge);for(let qe=0;qe<Ue.length;qe+=3)this.footprintIndices.emplaceBack(ze.vertexOffset+Ue[qe+0],ze.vertexOffset+Ue[qe+1],ze.vertexOffset+Ue[qe+2]),this.indexArray.emplaceBack(fe+Ue[qe],fe+Ue[qe+2],fe+Ue[qe+1]),Fe.primitiveLength++;ze.indexCount+=Ue.length,ze.vertexCount+=this.footprintVertices.length-ze.vertexOffset}for(let Ne=0;Ne<ue.length;Ne++){let Ge=ue[Ne];M.startRing(R,Ge[0]);let Ue=Ge.length>4&&fF(Ge[Ge.length-2],Ge[0],Ge[1]),qe=Q?r$(Ge[Ge.length-2],Ge[0],Ge[1],Q):0,gt=[],ft,Gt,wt;Gt=Ge[1].sub(Ge[0])._perp()._unit();let Rt=!0;for(let yt=1,mi=0;yt<Ge.length;yt++){let jt=Ge[yt-1],Jt=Ge[yt],Ci=Ge[yt===Ge.length-1?1:yt+1];if(M.appendEdge(R,Jt,jt),yT(Jt,jt,De)){Q&&(Gt=Ci.sub(Jt)._perp()._unit(),Rt=!Rt);continue}let Wi=Jt.sub(jt)._perp(),Di=Wi.x/(Math.abs(Wi.x)+Math.abs(Wi.y)),en=Wi.y>0?1:0,Gi=jt.dist(Jt);if(mi+Gi>32768&&(mi=0),Q){wt=Ci.sub(Jt)._perp()._unit();let Ei=hF(jt,Jt,Ci,uF(Gt,wt),Q);isNaN(Ei)&&(Ei=0);let cn=Jt.sub(jt)._unit();jt=jt.add(cn.mult(qe))._round(),Jt=Jt.add(cn.mult(-Ei))._round(),qe=Ei,Gt=wt,L&&this.zoom>=17&&(de(gt,jt)||gt.push(jt),de(gt,Jt)||gt.push(Jt))}let rn=Fe.vertexLength,yn=Ge.length>4&&fF(jt,Jt,Ci),nr=mF(mi,Ue,Rt);if(d0(this.layoutVertexArray,jt.x,jt.y,Di,en,0,0,nr),d0(this.layoutVertexArray,jt.x,jt.y,Di,en,0,1,nr),this.wallMode){let Ei=H(yt-1,Ge),cn=$.joinNormals[yt-1];u0(this.wallVertexArray,cn,Ei),u0(this.wallVertexArray,cn,Ei)}if(mi+=Gi,nr=mF(mi,yn,!Rt),Ue=yn,d0(this.layoutVertexArray,Jt.x,Jt.y,Di,en,0,0,nr),d0(this.layoutVertexArray,Jt.x,Jt.y,Di,en,0,1,nr),this.wallMode){let Ei=H(yt,Ge),cn=$.joinNormals[yt];u0(this.wallVertexArray,cn,Ei),u0(this.wallVertexArray,cn,Ei)}if(Fe.vertexLength+=4,this.indexArray.emplaceBack(rn+0,rn+1,rn+2),this.indexArray.emplaceBack(rn+1,rn+3,rn+2),Fe.primitiveLength+=2,Q){let Ei=fe+(yt===1?Ge.length-2:yt-2),cn=yt===1?fe:Ei+1;if(this.indexArray.emplaceBack(rn+1,Ei,rn+3),this.indexArray.emplaceBack(Ei,cn,rn+3),Fe.primitiveLength+=2,ft===void 0&&(ft=rn),!yT(Ci,Ge[yt],De)){let pr=yt===Ge.length-1?ft:Fe.vertexLength;this.indexArray.emplaceBack(rn+2,rn+3,pr),this.indexArray.emplaceBack(rn+3,pr+1,pr),this.indexArray.emplaceBack(rn+3,cn,pr+1),Fe.primitiveLength+=3}Rt=!Rt}if(T){let Ei=this.layoutVertexExtArray,cn=E.projectTilePoint(jt.x,jt.y,p),pr=E.projectTilePoint(Jt.x,Jt.y,p),br=E.upVector(p,jt.x,jt.y),Dr=E.upVector(p,Jt.x,Jt.y);h0(Ei,cn,br),h0(Ei,cn,br),h0(Ei,pr,Dr),h0(Ei,pr,Dr)}}S&&(fe+=Ge.length-1),L&&Q&&this.zoom>=17&&(gt.length!==0&&de(gt,gt[0])&&gt.pop(),this.groundEffect.addData(gt,De,D,Q>0))}this.footprintSegments.push(ze),Pe.triangleCount=this.indexArray.length-Pe.triangleArrayOffset,this.polygonSegments.push(Pe),++R.footprintSegLen,++R.polygonSegLen}if(R.vertexCount=this.layoutVertexArray.length-R.vertexArrayOffset,R.groundVertexCount=this.groundEffect.vertexArray.length-R.groundVertexArrayOffset,R.vertexCount!==0){if(R.centroidXY=M.borders?oF:this.encodeCentroid(M,R),this.centroidData.push(R),M.borders){this.featuresOnBorder.push(M);let ue=this.featuresOnBorder.length-1;for(let De=0;De<M.borders.length;De++)M.borders[De][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[De].push(ue)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,u,h,g,p,C),this.groundEffect.addPaintPropertiesData(o,u,h,g,p,C),this.maxHeight=Math.max(this.maxHeight,N)}}sortBorders(){for(let o=0;o<this.borderFeatureIndices.length;o++)this.borderFeatureIndices[o].sort((l,u)=>this.featuresOnBorder[l].borders[o][0]-this.featuresOnBorder[u].borders[o][0])}splitToSubtiles(){let o=[];for(let x=0;x<this.centroidData.length;x++){let C=this.centroidData[x],D=+(C.min.y+C.max.y>kt),v=2*D+(+(C.min.x+C.max.x>kt)^D);for(let E=0;E<C.polygonSegLen;E++){let T=C.polygonSegIdx+E;o.push({centroidIdx:x,subtile:v,polygonSegmentIdx:T,triangleSegmentIdx:this.polygonSegments[T].triangleSegIdx})}}let l=new Uo;o.sort((x,C)=>x.triangleSegmentIdx===C.triangleSegmentIdx?x.subtile-C.subtile:x.triangleSegmentIdx-C.triangleSegmentIdx);let u=0,p=0,h=0;for(let x of o){if(x.triangleSegmentIdx!==u)break;h++}let g=o.length;for(;p!==o.length;){u=o[p].triangleSegmentIdx;let x=0,C=p,D=p;for(let v=C;v<h&&o[v].subtile===x;v++)D++;for(;C!==h;){let v=o[C];x=v.subtile;let E=this.centroidData[v.centroidIdx].min.clone(),T=this.centroidData[v.centroidIdx].max.clone(),S={vertexOffset:this.segments.segments[u].vertexOffset,primitiveOffset:l.length,vertexLength:this.segments.segments[u].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let M=C;M<D;M++){let R=o[M],L=this.polygonSegments[R.polygonSegmentIdx],N=this.centroidData[R.centroidIdx].min,$=this.centroidData[R.centroidIdx].max,H=this.indexArray.uint16;for(let j=L.triangleArrayOffset;j<L.triangleArrayOffset+L.triangleCount;j++)l.emplaceBack(H[3*j],H[3*j+1],H[3*j+2]);S.primitiveLength+=L.triangleCount,E.x=Math.min(E.x,N.x),E.y=Math.min(E.y,N.y),T.x=Math.max(T.x,$.x),T.y=Math.max(T.y,$.y)}S.primitiveLength>0&&this.triangleSubSegments.push({segment:S,min:E,max:T}),C=D;for(let M=C;M<h&&o[M].subtile===o[C].subtile;M++)D++}p=h;for(let v=p;v<g&&o[v].triangleSegmentIdx===o[p].triangleSegmentIdx;v++)h++}l._trim(),this.indexArray=l}getVisibleSegments(o,l,u){let p=new _r;if(this.wallMode){for(let R of this.triangleSubSegments)p.segments.push(R.segment);return p}let h=0,g=0,x=1<<o.canonical.z;if(l){let R=l.getMinMaxForTile(o);R&&(h=R.min,g=R.max)}g+=this.maxHeight;let C=o.toUnwrapped(),D,v=[C.canonical.x/x+C.wrap,C.canonical.y/x],E=[(C.canonical.x+1)/x+C.wrap,(C.canonical.y+1)/x],T=(R,L,N)=>[R[0]*(1-N[0])+L[0]*N[0],R[1]*(1-N[1])+L[1]*N[1]],S=[],M=[];for(let R of this.triangleSubSegments){S[0]=R.min.x/kt,S[1]=R.min.y/kt,M[0]=R.max.x/kt,M[1]=R.max.y/kt;let L=T(v,E,S),N=T(v,E,M);if(new ti([L[0],L[1],h],[N[0],N[1],g]).intersectsPrecise(u)===0){D&&(p.segments.push(D),D=void 0);continue}let $=R.segment;D&&D.vertexOffset!==$.vertexOffset&&(p.segments.push(D),D=void 0),D?(D.vertexLength+=$.vertexLength,D.primitiveLength+=$.primitiveLength):D={vertexOffset:$.vertexOffset,primitiveLength:$.primitiveLength,vertexLength:$.vertexLength,primitiveOffset:$.primitiveOffset,sortKey:void 0,vaos:{}}}return D&&p.segments.push(D),p}encodeCentroid(o,l){let u=o.centroid(),p=l.span(),h=Math.min(7,Math.round(p.x*this.tileToMeter/10)),g=Math.min(7,Math.round(p.y*this.tileToMeter/10));return new At(qi(u.x,1,kt-1)<<3|h,qi(u.y,1,kt-1)<<3|g)}encodeBorderCentroid(o){if(!o.borders)return new At(0,0);let l=o.borders,u=Number.MAX_VALUE;if(l[0][0]!==u||l[1][0]!==u){let p=l[0][0]!==u?0:1;return new At(6|(l[0][0]!==u?0:65528),(l[p][0]+l[p][1])/2<<3|6)}{let p=l[2][0]!==u?2:3;return new At((l[p][0]+l[p][1])/2<<3|6,6|(l[2][0]!==u?0:65528))}}showCentroid(o){let l=this.centroidData[o.centroidDataIndex];l.flags&=Lh,l.centroidXY.x=0,l.centroidXY.y=0,this.writeCentroidToBuffer(l)}writeCentroidToBuffer(o){this.groundEffect.updateHiddenByLandmark(o);let l=o.vertexArrayOffset,u=o.vertexCount+o.vertexArrayOffset,p=o.flags&Lh?oF:o.centroidXY,h=this.centroidVertexArray.geta_centroid_pos0(l);if(this.centroidVertexArray.geta_centroid_pos1(l)!==p.y||h!==p.x){for(let g=l;g<u;++g)this.centroidVertexArray.emplace(g,p.x,p.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(let o of this.centroidData)this.writeCentroidToBuffer(o)}updateReplacement(o,l,u){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;let p=l.getReplacementRegionsForTile(o.toUnwrapped());if(mT(this.activeReplacements,p))return;if(this.activeReplacements=p,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(let g of this.centroidData)g.flags&=2147483647;let h=[];for(let g of this.activeReplacements){if(g.order<u)continue;let x=Math.max(1,Math.pow(2,g.footprintTileId.canonical.z-o.canonical.z));for(let C of this.centroidData)if(!(C.flags&Lh||g.min.x>C.max.x||C.min.x>g.max.x||g.min.y>C.max.y||C.min.y>g.max.y))for(let D=0;D<C.footprintSegLen;D++){let v=this.footprintSegments[C.footprintSegIdx+D];if(h.length=0,o$(this.footprintVertices,v.vertexOffset,v.vertexCount,g.footprintTileId.canonical,o.canonical,h),eF(g.footprint,h,this.footprintIndices.uint16,v.indexOffset,v.indexCount,-v.vertexOffset,-x)){C.flags|=Lh;break}}}for(let g of this.centroidData)this.writeCentroidToBuffer(g);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(o,l,u){let p=!1;for(let h=0;h<u.footprintSegLen;h++){let g=this.footprintSegments[u.footprintSegIdx+h],x=0;for(let C of g.ringIndices){for(let D=x,v=C+x-1;D<C+x;v=D++){let E=this.footprintVertices.int16[2*(D+g.vertexOffset)+0],T=this.footprintVertices.int16[2*(D+g.vertexOffset)+1],S=this.footprintVertices.int16[2*(v+g.vertexOffset)+1];T>l!=S>l&&o<(this.footprintVertices.int16[2*(v+g.vertexOffset)+0]-E)*(l-T)/(S-T)+E&&(p=!p)}x=C}}return p}getHeightAtTileCoord(o,l){let u=Number.NEGATIVE_INFINITY,p=!0,h=4*(o+kt)*kt+(l+kt);if(this.partLookup.hasOwnProperty(h)){let g=this.partLookup[h];return g?{height:g.height,hidden:!!(g.flags&Lh)}:void 0}for(let g of this.centroidData)o>g.max.x||g.min.x>o||l>g.max.y||g.min.y>l||this.footprintContainsPoint(o,l,g)&&g&&g.height>u&&(u=g.height,this.partLookup[h]=g,p=!!(g.flags&Lh));if(u!==Number.NEGATIVE_INFINITY)return{height:u,hidden:p};this.partLookup[h]=void 0}}function uF(d,o){let l=d.add(o)._unit();return d.x*l.x+d.y*l.y}function r$(d,o,l,u){let p=o.sub(d)._perp()._unit(),h=l.sub(o)._perp()._unit();return hF(d,o,l,uF(p,h),u)}function hF(d,o,l,u,p){let h=Math.sqrt(1-u*u);return Math.min(d.dist(o)/3,o.dist(l)/3,p*h/u)}function yT(d,o,l){return d.x<l[0].x&&o.x<l[0].x||d.x>l[1].x&&o.x>l[1].x||d.y<l[0].y&&o.y<l[0].y||d.y>l[1].y&&o.y>l[1].y}function pF(d,o){return d.x<o[0].x||d.x>o[1].x||d.y<o[0].y||d.y>o[1].y}function fF(d,o,l){if(d.x<0||d.x>=kt||o.x<0||o.x>=kt||l.x<0||l.x>=kt)return!1;let u=l.sub(o),p=u.perp(),h=d.sub(o);return(u.x*h.x+u.y*h.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(h.x*h.x+h.y*h.y))>-.866&&p.x*h.x+p.y*h.y<0}function mF(d,o,l){let u=o?2|d:-3&d;return l?1|u:-2&u}function gF(){let d=Math.PI/32,o=Math.tan(d),l=hu;return l*Math.sqrt(1+2*o*o)-l}function _F(d,o,l){let u=1<<l.z,p=es(l.x/u),h=es((l.x+1)/u),g=Ho(l.y/u),x=Ho((l.y+1)/u);return function(C,D,v,E,T=0,S){let M=[];if(!C.length||!v||!E)return M;let R=(Y,Q)=>{for(let pe of Y)M.push({polygon:pe,bounds:Q})},L=Math.ceil(Math.log2(v)),N=Math.ceil(Math.log2(E)),$=L-N,H=[];for(let Y=0;Y<Math.abs($);Y++)H.push($>0?0:1);for(let Y=0;Y<Math.min(L,N);Y++)H.push(0),H.push(1);let j=C;if(j=Kw(j,D[0].y-T,D[1].y+T,1),j=Kw(j,D[0].x-T,D[1].x+T,0),!j.length)return M;let q=[];for(H.length?q.push({polygons:j,bounds:D,depth:0}):R(j,D);q.length;){let Y=q.pop(),Q=Y.depth,pe=H[Q],de=Y.bounds[0],ue=Y.bounds[1],De=pe===0?de.x:de.y,fe=pe===0?ue.x:ue.y,Me=S?S(pe,De,fe):.5*(De+fe),Fe=Kw(Y.polygons,De-T,Me+T,pe),Pe=Kw(Y.polygons,Me-T,fe+T,pe);if(Fe.length){let ze=[de,new At(pe===0?Me:ue.x,pe===1?Me:ue.y)];H.length>Q+1?q.push({polygons:Fe,bounds:ze,depth:Q+1}):R(Fe,ze)}if(Pe.length){let ze=[new At(pe===0?Me:de.x,pe===1?Me:de.y),ue];H.length>Q+1?q.push({polygons:Pe,bounds:ze,depth:Q+1}):R(Pe,ze)}}return M}(d,o,Math.ceil((h-p)/11.25),Math.ceil((g-x)/11.25),1,(C,D,v)=>{if(C===0)return .5*(D+v);{let E=Ho((l.y+D/kt)/u);return(Ja(.5*(Ho((l.y+v/kt)/u)+E))*u-l.y)*kt}})}function o$(d,o,l,u,p,h){let g=Math.pow(2,u.z-p.z);for(let x=0;x<l;x++){let C=d.int16[2*(x+o)+0],D=d.int16[2*(x+o)+1];C=(C+p.x*kt)*g-u.x*kt,D=(D+p.y*kt)*g-u.y*kt,h.push(new At(C,D))}}let yF,vF;function p0(d,o){return d.x*o.x+d.y*o.y}function bF(d,o){if(d.length===1){let l=0,u=o[l++],p;for(;!p||u.equals(p);)if(p=o[l++],!p)return 1/0;for(;l<o.length;l++){let h=o[l],g=d[0],x=p.sub(u),C=h.sub(u),D=g.sub(u),v=p0(x,x),E=p0(x,C),T=p0(C,C),S=p0(D,x),M=p0(D,C),R=v*T-E*E,L=(T*S-E*M)/R,N=(v*M-E*S)/R,$=u.z*(1-L-N)+p.z*L+h.z*N;if(isFinite($))return $}return 1/0}{let l=1/0;for(let u of o)l=Math.min(l,u.z);return l}}function xF(d,o,l,u,p,h,g,x){let C=g*p.getElevationAt(d,o,!0,!0),D=h[0]!==0,v=D?h[1]===0?g*(h[0]/7-450):g*function(E,T,S){let M=Math.floor(T[0]/8),R=Math.floor(T[1]/8),L=10*(T[0]-8*M),N=10*(T[1]-8*R),$=E.getElevationAt(M,R,!0,!0),H=E.getMeterToDEM(S),j=Math.floor(.5*(L*H-1)),q=Math.floor(.5*(N*H-1)),Y=E.tileCoordToPixel(M,R),Q=2*j+1,pe=2*q+1,de=function(Pe,ze,Ne,Ge,Ue){return[Pe.getElevationAtPixel(ze,Ne,!0),Pe.getElevationAtPixel(ze+Ue,Ne,!0),Pe.getElevationAtPixel(ze,Ne+Ue,!0),Pe.getElevationAtPixel(ze+Ge,Ne+Ue,!0)]}(E,Y.x-j,Y.y-q,Q,pe),ue=Math.abs(de[0]-de[1]),De=Math.abs(de[2]-de[3]),fe=Math.abs(de[0]-de[2])+Math.abs(de[1]-de[3]),Me=Math.min(.25,.5*H*(ue+De)/Q),Fe=Math.min(.25,.5*H*fe/pe);return $+Math.max(Me*L,Fe*N)}(p,h,x):C;return{base:C+(l===0?-1:l),top:D?Math.max(v+u,C+l+2):C+u}}$t(t1,"FillExtrusionBucket",{omit:["layers","features"]}),$t(sF,"PartData"),$t(aF,"FootprintSegment"),$t(lF,"BorderCentroidData"),$t(dF,"GroundEffect");let a$=En([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),s$=En([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:l$}=a$,c$=En([{name:"a_packed",components:3,type:"Float32"}]),{members:d$}=c$,u$=En([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:h$}=u$;class wF{constructor(o,l){this.width=o,this.height=l,this.nextRow=0,this.image=new Oh({width:o,height:l}),this.positions={},this.uploaded=!1}getDash(o,l){let u=this.getKey(o,l);return this.positions[u]}trim(){let o=this.width,l=this.height=dl(this.nextRow);this.image.resize({width:o,height:l})}getKey(o,l){return o.join(",")+l}getDashRanges(o,l,u){let p=[],h=o.length%2==1?-o[o.length-1]*u:0,g=o[0]*u,x=!0;p.push({left:h,right:g,isDash:x,zeroLength:o[0]===0});let C=o[0];for(let D=1;D<o.length;D++){x=!x;let v=o[D];h=C*u,C+=v,g=C*u,p.push({left:h,right:g,isDash:x,zeroLength:v===0})}return p}addRoundDash(o,l,u){let p=l/2;for(let h=-u;h<=u;h++){let g=this.width*(this.nextRow+u+h),x=0,C=o[x];for(let D=0;D<this.width;D++){D/C.right>1&&(C=o[++x]);let v=Math.abs(D-C.left),E=Math.abs(D-C.right),T=Math.min(v,E),S,M=h/u*(p+1);if(C.isDash){let R=p-Math.abs(M);S=Math.sqrt(T*T+R*R)}else S=p-Math.sqrt(T*T+M*M);this.image.data[g+D]=Math.max(0,Math.min(255,S+128))}}}addRegularDash(o,l){for(let C=o.length-1;C>=0;--C){let D=o[C],v=o[C+1];D.zeroLength?o.splice(C,1):v&&v.isDash===D.isDash&&(v.left=D.left,o.splice(C,1))}let u=o[0],p=o[o.length-1];u.isDash===p.isDash&&(u.left=p.left-this.width,p.right=u.right+this.width);let h=this.width*this.nextRow,g=0,x=o[g];for(let C=0;C<this.width;C++){C/x.right>1&&(x=o[++g]);let D=Math.abs(C-x.left),v=Math.abs(C-x.right),E=Math.min(D,v);this.image.data[h+C]=Math.max(0,Math.min(255,(x.isDash?E:-E)+l+128))}}addDash(o,l){let u=this.getKey(o,l);if(this.positions[u])return this.positions[u];let p=l==="round",h=p?7:0,g=2*h+1;if(this.nextRow+g>this.height)return Er("LineAtlas out of space"),null;o.length===0&&o.push(1);let x=0;for(let v=0;v<o.length;v++)o[v]<0&&(Er("Negative value is found in line dasharray, replacing values with 0"),o[v]=0),x+=o[v];if(x!==0){let v=this.width/x,E=this.getDashRanges(o,this.width,v);p?this.addRoundDash(E,v,h):this.addRegularDash(E,l==="square"?.5*v:0)}let C=this.nextRow+h;this.nextRow+=g;let D={tl:[C,h],br:[x,0]};return this.positions[u]=D,D}}$t(wF,"LineAtlas");let p$=Fh.VectorTileFeature.types,f$=Math.cos(Math.PI/180*37.5),m$=Math.cos(Math.PI/180*5);class vT{constructor(o){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=o.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=o.overscaling,this.pixelRatio=o.pixelRatio,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.projection=o.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new Bv,this.layoutVertexArray2=new gl,this.patternVertexArray=new gl,this.indexArray=new Uo,this.programConfigurations=new gd(o.layers,{zoom:o.zoom,lut:o.lut}),this.segments=new _r,this.maxLineLength=0,this.zOffsetVertexArray=new gl,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.tessellationStep=o.tessellationStep?o.tessellationStep:kt/64}updateFootprints(o,l){}populate(o,l,u,p){this.hasPattern=oT("line",this.layers,this.pixelRatio,l);let h=this.layers[0].layout.get("line-sort-key");this.tileToMeter=m(u);let g=this.layers[0].layout.get("line-z-offset"),x=g.isConstant()&&!g.constantOr(0),C=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset=C==="sea"||C==="ground"||!x&&C==="none",this.hasZOffset&&C==="none"&&Er(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);let D=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&D!==void 0;let v=[];for(let{feature:M,id:R,index:L,sourceLayerIndex:N}of o){let $=this.layers[0]._featureFilter.needGeometry,H=F(M,$);if(!this.layers[0]._featureFilter.filter(new ir(this.zoom),H,u))continue;let j=h?h.evaluate(H,{},u):void 0,q={id:R,properties:M.properties,type:M.type,sourceLayerIndex:N,index:L,geometry:$?H.geometry:O(M,u,p),patterns:{},sortKey:j};v.push(q)}h&&v.sort((M,R)=>M.sortKey-R.sortKey);let{lineAtlas:E,featureIndex:T}=l,S=this.addConstantDashes(E);for(let M of v){let{geometry:R,index:L,sourceLayerIndex:N}=M;if(S&&this.addFeatureDashes(M,E),this.hasPattern){let $=aT("line",this.layers,M,this.zoom,this.pixelRatio,l);this.patternFeatures.push($)}else this.addFeature(M,R,L,u,E.positions,l.availableImages,l.brightness);T.insert(o[L].feature,R,L,N,this.index)}}addConstantDashes(o){let l=!1;for(let u of this.layers){let p=u.paint.get("line-dasharray").value,h=u.layout.get("line-cap").value;if(p.kind!=="constant"||h.kind!=="constant")l=!0;else{let g=h.value,x=p.value;if(!x)continue;o.addDash(x,g)}}return l}addFeatureDashes(o,l){let u=this.zoom;for(let p of this.layers){let h=p.paint.get("line-dasharray").value,g=p.layout.get("line-cap").value;if(h.kind==="constant"&&g.kind==="constant")continue;let x,C;if(h.kind==="constant"){if(x=h.value,!x)continue}else x=h.evaluate({zoom:u},o);C=g.kind==="constant"?g.value:g.evaluate({zoom:u},o),l.addDash(x,C),o.patterns[p.id]=l.getKey(x,C)}}update(o,l,u,p,h,g,x){this.programConfigurations.updatePaintArrays(o,l,h,u,p,g,x)}addFeatures(o,l,u,p,h,g){for(let x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,l,u,p,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,d$)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=o.createVertexBuffer(this.patternVertexArray,h$)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=o.createVertexBuffer(this.zOffsetVertexArray,s$.members,!0)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,l$),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&o.properties.hasOwnProperty("mapbox_clip_start")&&o.properties.hasOwnProperty("mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,l,u,p,h,g,x){let C=this.layers[0].layout,D=C.get("line-join").evaluate(o,{}),v=C.get("line-cap").evaluate(o,{}),E=C.get("line-miter-limit"),T=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(o),this.lineFeature=o,this.zOffsetValue=C.get("line-z-offset").value;let S=this.layers[0].paint.get("line-width").value;S.kind!=="constant"&&S.isLineProgressConstant===!1&&(this.variableWidthValue=S);for(let M of l)this.addLine(M,o,p,D,v,E,T);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,u,h,g,p,x)}addLine(o,l,u,p,h,g,x){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;let C=p==="none";if(this.patternJoinNone=this.hasPattern&&C,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let H=0;H<o.length-1;H++)this.totalDistance+=o[H].dist(o[H+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let D=p$[l.type]==="Polygon",v=o.length;for(;v>=2&&o[v-1].equals(o[v-2]);)v--;let E=0;for(;E<v-1&&o[E].equals(o[E+1]);)E++;if(v<(D?3:2))return;p==="bevel"&&(g=1.05);let T=this.segments.prepareSegment(10*v,this.layoutVertexArray,this.indexArray),S,M,R,L,N,$;this.e1=this.e2=-1,D&&(S=o[v-2],N=o[E].sub(S)._unit()._perp());for(let H=E;H<v;H++){if(R=H===v-1?D?o[E+1]:void 0:o[H+1],R&&o[H].equals(R))continue;N&&(L=N),S&&(M=S),S=o[H],$=this.evaluateLineProgressFeatures(M?M.dist(S):0),N=R?R.sub(S)._unit()._perp():L,L=L||N;let j=M&&R,q=j?p:D||C?"butt":h,Y=L.x*N.x+L.y*N.y;if(C){let Fe=function(Pe){if(Pe.patternJoinNone){let ze=Pe.segmentPoints.length/2,Ne=Pe.lineSoFar-Pe.segmentStart;for(let Ge=0;Ge<ze;++Ge){let Ue=Pe.segmentPoints[2*Ge+1],qe=Math.round(Pe.segmentPoints[2*Ge])+.5+.25*Ue;Pe.patternVertexArray.emplaceBack(qe,Ne,Pe.segmentStart),Pe.patternVertexArray.emplaceBack(qe,Ne,Pe.segmentStart)}Pe.segmentPoints.length=0}Pe.e1=Pe.e2=-1};if(j&&Y<m$){this.updateDistance(M,S),this.addCurrentVertex(S,L,1,1,T,$),Fe(this),this.addCurrentVertex(S,N,-1,-1,T,$);continue}if(M){if(!R){this.updateDistance(M,S),this.addCurrentVertex(S,L,1,1,T,$),Fe(this);continue}q="miter"}}let Q=L.add(N);Q.x===0&&Q.y===0||Q._unit();let pe=Q.x*N.x+Q.y*N.y,de=pe!==0?1/pe:1/0,ue=2*Math.sqrt(2-2*pe),De=pe<f$&&M&&R,fe=L.x*N.y-L.y*N.x>0,Me=this.overscaling<=16?15*kt/(512*this.overscaling):0;if(j&&q==="round"){if(de<x)q="miter";else if(de<=2){let Fe=bT(S,-10,kt+10);q=this.hasZOffset&&(Fe||this.hasCrossSlope)?"miter":"fakeround"}}if(q==="miter"&&de>g&&(q="bevel"),q==="bevel"&&(de>2&&(q="flipbevel"),de<g&&(q="miter")),M&&!(q==="miter"&&De)&&this.updateDistance(M,S),q==="miter")if(De){let Fe=S.dist(M);if(Fe>2*Me){let ze=S.sub(S.sub(M)._mult(Me/Fe)._round());this.updateDistance(M,ze),this.addCurrentVertex(ze,L,0,0,T,$),M=ze}this.updateDistance(M,S),Q._mult(de),this.addCurrentVertex(S,Q,0,0,T,$);let Pe=S.dist(R);if(Pe>2*Me){let ze=S.add(R.sub(S)._mult(Me/Pe)._round());this.updateDistance(S,ze),this.addCurrentVertex(ze,N,0,0,T,$),S=ze}}else Q._mult(de),this.addCurrentVertex(S,Q,0,0,T,$);else if(q==="flipbevel"){if(de>100)Q=N.mult(-1);else{let Fe=de*L.add(N).mag()/L.sub(N).mag();Q._perp()._mult(Fe*(fe?-1:1))}this.addCurrentVertex(S,Q,0,0,T,$),this.addCurrentVertex(S,Q.mult(-1),0,0,T,$)}else if(q==="bevel"||q==="fakeround"){$!=null&&M&&this.addCurrentVertex(S,L,-1,-1,T,$);let Fe=S.dist(M)<=2*Me&&q!=="bevel",Pe=Q.mult(fe?1:-1);Pe._mult(de);let ze=N.mult(fe?-1:1),Ne=L.mult(fe?-1:1),Ge=this.evaluateLineProgressFeatures(this.distance);if($==null&&(this.addHalfVertex(S,Pe.x,Pe.y,!1,!fe,0,T,Ge),Fe||this.addHalfVertex(S,Pe.x+2*Ne.x,Pe.y+2*Ne.y,!1,fe,0,T,Ge)),q==="fakeround"){let Ue=Math.round(180*ue/Math.PI/20);this.addHalfVertex(S,Ne.x,Ne.y,!1,fe,0,T,Ge);for(let qe=0;qe<Ue;qe++){let gt=qe/Ue;if(gt!==.5){let Gt=gt-.5;gt+=gt*Gt*(gt-1)*((1.0904+Y*(Y*(3.55645-1.43519*Y)-3.2452))*Gt*Gt+(.848013+Y*(.215638*Y-1.06021)))}let ft=ze.sub(Ne)._mult(gt)._add(Ne)._unit();this.addHalfVertex(S,ft.x,ft.y,!1,fe,0,T,Ge)}this.addHalfVertex(S,ze.x,ze.y,!1,fe,0,T,Ge)}Fe||$!=null||this.addHalfVertex(S,Pe.x+2*ze.x,Pe.y+2*ze.y,!1,fe,0,T,Ge),$!=null&&R&&this.addCurrentVertex(S,N,1,1,T,$)}else q==="butt"?this.addCurrentVertex(S,Q,0,0,T,$):q==="square"?(M||this.addCurrentVertex(S,Q,-1,-1,T,$),this.addCurrentVertex(S,Q,0,0,T,$),M&&this.addCurrentVertex(S,Q,1,1,T,$)):q==="round"&&(M&&(this.addCurrentVertex(S,L,0,0,T,$),this.addCurrentVertex(S,L,1,1,T,$,!0)),R&&(this.addCurrentVertex(S,N,-1,-1,T,$,!0),this.addCurrentVertex(S,N,0,0,T,$)))}}addVerticesTo(o,l,u,p,h,g,x,C,D,v){let E=(l.w-o.w)/this.tessellationStep|0,T=0,S=this.scaledDistance;if(E>1){this.lineSoFar=o.w;let R=(l.x-o.x)/E,L=(l.y-o.y)/E,N=(l.z-o.z)/E,$=(l.w-o.w)/E;for(let H=1;H<E;++H){o.x+=R,o.y+=L,o.z+=N,this.lineSoFar+=$,T+=$;let j=this.evaluateLineProgressFeatures(this.prevDistance+T);this.scaledDistance=(this.prevDistance+T)/this.totalDistance,this.addHalfVertex(o,u,p,v,!1,x,D,j),this.addHalfVertex(o,h,g,v,!0,-C,D,j)}}this.lineSoFar=l.w,this.scaledDistance=S;let M=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(l,u,p,v,!1,x,D,M),this.addHalfVertex(l,h,g,v,!0,-C,D,M)}evaluateLineProgressFeatures(o){if(!this.variableWidthValue&&!this.hasZOffset)return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+o)/this.totalFeatureLength):Er(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let l=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(l=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.hasZOffset?this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:l}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:l}:{zOffset:0,variableWidth:l}}addCurrentVertex(o,l,u,p,h,g,x=!1){let C=l.x+l.y*u,D=l.y-l.x*u,v=l.y*p-l.x,E=-l.y-l.x*p;if(g!=null){let T=this.hasZOffset,S=-10,M=kt+10,R=g.zOffset,L=new YO(o.x,o.y,R,this.lineSoFar),N=!!T&&bT(o,S,M),$=this.lineSoFar,H=this.distance;if(this.currentVertex)if(N){let j=this.currentVertexIsOutside,q=this.currentVertex,Y=new YO(o.x,o.y,R,this.lineSoFar);if(XO(q,Y,S,M),!bT(Y,S,M)){if(j){this.e1=this.e2=-1,this.distance-=q.dist(L),this.lineSoFar=q.w;let Q=this.evaluateLineProgressFeatures(q.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(q,C,D,x,!1,u,h,Q),this.addHalfVertex(q,v,E,x,!0,-p,h,Q),this.prevDistance=this.distance}this.distance=this.prevDistance+q.dist(Y),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(q,Y,C,D,v,E,u,p,h,x),this.distance=H,this.scaledDistance=this.distance/this.totalDistance}}else{let j=this.currentVertex;if(this.currentVertexIsOutside){XO(j,L,S,M),this.e1=this.e2=-1,this.distance-=j.dist(L),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=j.w;let q=this.evaluateLineProgressFeatures(j.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(j,C,D,x,!1,u,h,q),this.addHalfVertex(j,v,E,x,!0,-p,h,q),this.prevDistance=this.distance,this.distance=H,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(j,L,C,D,v,E,u,p,h,x)}else N||(this.addHalfVertex(o,C,D,x,!1,u,h,g),this.addHalfVertex(o,v,E,x,!0,-p,h,g));this.currentVertex=L,this.currentVertexIsOutside=N,this.lineSoFar=$}else this.addHalfVertex(o,C,D,x,!1,u,h,g),this.addHalfVertex(o,v,E,x,!0,-p,h,g)}addHalfVertex({x:o,y:l},u,p,h,g,x,C,D){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),g||this.segmentPoints.push(this.lineSoFar-this.segmentStart,x)),this.layoutVertexArray.emplaceBack((o<<1)+(h?1:0),(l<<1)+(g?1:0),Math.round(63*u)+128,Math.round(63*p)+128,1+(x===0?0:x<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){let E=yi(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,E)}let v=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,v),C.primitiveLength++),g?this.e2=v:this.e1=v,D!=null&&this.zOffsetVertexArray.emplaceBack(D.zOffset,D.variableWidth,D.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(o,l){this.prevDistance=this.distance,this.distance+=o.dist(l),this.updateScaledDistance()}}function bT(d,o,l){return d.x<o||d.x>l||d.y<o||d.y>l}let CF,EF;function SF(d,o,l){return o*(kt/(d.tileSize*Math.pow(2,l-d.tileID.overscaledZ)))}$t(vT,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});let DF=(d,o,l)=>(1-l)*d+l*o;function MF(d,o){return 1/SF(d,1,o.tileZoom)}function TF(d,o,l,u){return d.translatePosMatrix(u||o.tileID.projMatrix,o,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}let IF=d=>{let o=[];AF(d)&&o.push("RENDER_LINE_DASH"),d.paint.get("line-gradient")&&o.push("RENDER_LINE_GRADIENT");let l=d.paint.get("line-trim-offset");l[0]===0&&l[1]===0||o.push("RENDER_LINE_TRIM_OFFSET"),d.paint.get("line-border-width").constantOr(1)!==0&&o.push("RENDER_LINE_BORDER");let u=d.layout.get("line-join").constantOr("miter")==="none",p=!!d.paint.get("line-pattern").constantOr(1);return u&&p&&o.push("LINE_JOIN_NONE"),o};function AF(d){let o=d.paint.get("line-dasharray").value;return o.value||o.kind!=="constant"}let xT,RF=()=>xT||(xT={layout:CF||(CF=new Sr({"line-cap":new Ht(We.layout_line["line-cap"]),"line-join":new Ht(We.layout_line["line-join"]),"line-miter-limit":new It(We.layout_line["line-miter-limit"]),"line-round-limit":new It(We.layout_line["line-round-limit"]),"line-sort-key":new Ht(We.layout_line["line-sort-key"]),"line-z-offset":new Ht(We.layout_line["line-z-offset"]),"line-elevation-reference":new It(We.layout_line["line-elevation-reference"]),"line-cross-slope":new It(We.layout_line["line-cross-slope"]),visibility:new It(We.layout_line.visibility),"line-width-unit":new It(We.layout_line["line-width-unit"])})),paint:EF||(EF=new Sr({"line-opacity":new Ht(We.paint_line["line-opacity"]),"line-color":new Ht(We.paint_line["line-color"]),"line-translate":new It(We.paint_line["line-translate"]),"line-translate-anchor":new It(We.paint_line["line-translate-anchor"]),"line-width":new Ht(We.paint_line["line-width"]),"line-gap-width":new Ht(We.paint_line["line-gap-width"]),"line-offset":new Ht(We.paint_line["line-offset"]),"line-blur":new Ht(We.paint_line["line-blur"]),"line-dasharray":new Ht(We.paint_line["line-dasharray"]),"line-pattern":new Ht(We.paint_line["line-pattern"]),"line-gradient":new Eh(We.paint_line["line-gradient"]),"line-trim-offset":new It(We.paint_line["line-trim-offset"]),"line-trim-fade-range":new It(We.paint_line["line-trim-fade-range"]),"line-trim-color":new It(We.paint_line["line-trim-color"]),"line-emissive-strength":new It(We.paint_line["line-emissive-strength"]),"line-border-width":new Ht(We.paint_line["line-border-width"]),"line-border-color":new Ht(We.paint_line["line-border-color"]),"line-occlusion-opacity":new It(We.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},xT);class g$ extends Ht{possiblyEvaluate(o,l){return l=new ir(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,transition:l.transition}),super.possiblyEvaluate(o,l)}evaluate(o,l,u,p){return l=Io({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(o,l,u,p)}}let f0;function kF(d,o){return o>0?o+2*d:d}let _$=En([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),y$=En([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),v$=En([{name:"a_projected_pos",components:4,type:"Float32"}],4);En([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);let b$=En([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),x$=En([{name:"a_texb",components:2,type:"Uint16"}]),w$=En([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),C$=En([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);En([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);let PF=En([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),E$=En([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);En([{name:"triangle",components:3,type:"Uint16"}]),En([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),En([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),En([{type:"Float32",name:"offsetX"}]),En([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var ia=24;let Tc=128;function OF(d,o,l,u,p){if(d.kind==="camera")return d.maxSize;if(d.kind==="composite"){let h=o.possiblyEvaluate(new ir(d.maxZoom),l).evaluate(p,{},l),g=o.possiblyEvaluate(new ir(d.minZoom),l).evaluate(p,{},l);return Math.max(h,g)}return o.possiblyEvaluate(new ir(u)).evaluate(p,{},l)}function wT(d,o){let{expression:l}=o;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new ir(d+1))};if(l.kind==="source")return{kind:"source"};{let{zoomStops:u,interpolationType:p}=l,h=0;for(;h<u.length&&u[h]<=d;)h++;h=Math.max(0,h-1);let g=h;for(;g<u.length&&u[g]<d+1;)g++;g=Math.min(u.length-1,g);let x=u[h],C=u[g];return l.kind==="composite"?{kind:"composite",minZoom:x,maxZoom:C,interpolationType:p}:{kind:"camera",minZoom:x,maxZoom:C,minSize:l.evaluate(new ir(x)),maxSize:l.evaluate(new ir(C)),interpolationType:p}}}function i1(d,{uSize:o,uSizeT:l},{lowerSize:u,upperSize:p}){return d.kind==="source"?u/Tc:d.kind==="composite"?yi(u/Tc,p/Tc,l):o}function Hg(d,o,l=1){let u=0,p=0;if(d.kind==="constant")p=d.layoutSize*l;else if(d.kind!=="source"){let{interpolationType:h,minZoom:g,maxZoom:x}=d,C=h?qi(ys.interpolationFactor(h,o,g,x),0,1):0;d.kind==="camera"?p=yi(d.minSize,d.maxSize,C)*l:u=C*l}return{uSizeT:u,uSize:p}}var S$=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Tc,evaluateSizeForFeature:i1,evaluateSizeForZoom:Hg,getRasterizedIconSize:OF,getSizeData:wT});function D$(d,o,l){return d.sections.forEach(u=>{u.text=function(p,h,g){let x=h.layout.get("text-transform").evaluate(g,{});return x==="uppercase"?p=p.toLocaleUpperCase():x==="lowercase"&&(p=p.toLocaleLowerCase()),Vs.applyArabicShaping&&(p=Vs.applyArabicShaping(p)),p}(u.text,o,l)}),d}let m0={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42","\u2190":"\u2191","\u2192":"\u2193"};function M$(d){return d==="\uFE36"||d==="\uFE48"||d==="\uFE38"||d==="\uFE44"||d==="\uFE42"||d==="\uFE3E"||d==="\uFE3C"||d==="\uFE3A"||d==="\uFE18"||d==="\uFE40"||d==="\uFE10"||d==="\uFE13"||d==="\uFE14"||d==="\uFF40"||d==="\uFFE3"||d==="\uFE11"||d==="\uFE12"}function T$(d){return d==="\uFE35"||d==="\uFE47"||d==="\uFE37"||d==="\uFE43"||d==="\uFE41"||d==="\uFE3D"||d==="\uFE3B"||d==="\uFE39"||d==="\uFE17"||d==="\uFE3F"}var FF,CT,LF,ET={};function I$(){return FF||(FF=1,ET.read=function(d,o,l,u,p){var h,g,x=8*p-u-1,C=(1<<x)-1,D=C>>1,v=-7,E=l?p-1:0,T=l?-1:1,S=d[o+E];for(E+=T,h=S&(1<<-v)-1,S>>=-v,v+=x;v>0;h=256*h+d[o+E],E+=T,v-=8);for(g=h&(1<<-v)-1,h>>=-v,v+=u;v>0;g=256*g+d[o+E],E+=T,v-=8);if(h===0)h=1-D;else{if(h===C)return g?NaN:1/0*(S?-1:1);g+=Math.pow(2,u),h-=D}return(S?-1:1)*g*Math.pow(2,h-u)},ET.write=function(d,o,l,u,p,h){var g,x,C,D=8*h-p-1,v=(1<<D)-1,E=v>>1,T=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,S=u?0:h-1,M=u?1:-1,R=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(x=isNaN(o)?1:0,g=v):(g=Math.floor(Math.log(o)/Math.LN2),o*(C=Math.pow(2,-g))<1&&(g--,C*=2),(o+=g+E>=1?T/C:T*Math.pow(2,1-E))*C>=2&&(g++,C/=2),g+E>=v?(x=0,g=v):g+E>=1?(x=(o*C-1)*Math.pow(2,p),g+=E):(x=o*Math.pow(2,E-1)*Math.pow(2,p),g=0));p>=8;d[l+S]=255&x,S+=M,x/=256,p-=8);for(g=g<<p|x,D+=p;D>0;d[l+S]=255&g,S+=M,g/=256,D-=8);d[l+S-M]|=128*R}),ET}function NF(){if(LF)return CT;LF=1,CT=o;var d=I$();function o(j){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(j)?j:new Uint8Array(j||0),this.pos=0,this.type=0,this.length=this.buf.length}o.Varint=0,o.Fixed64=1,o.Bytes=2,o.Fixed32=5;var l=4294967296,u=1/l,p=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function h(j){return j.type===o.Bytes?j.readVarint()+j.pos:j.pos+1}function g(j,q,Y){return Y?4294967296*q+(j>>>0):4294967296*(q>>>0)+(j>>>0)}function x(j,q,Y){var Q=q<=16383?1:q<=2097151?2:q<=268435455?3:Math.floor(Math.log(q)/(7*Math.LN2));Y.realloc(Q);for(var pe=Y.pos-1;pe>=j;pe--)Y.buf[pe+Q]=Y.buf[pe]}function C(j,q){for(var Y=0;Y<j.length;Y++)q.writeVarint(j[Y])}function D(j,q){for(var Y=0;Y<j.length;Y++)q.writeSVarint(j[Y])}function v(j,q){for(var Y=0;Y<j.length;Y++)q.writeFloat(j[Y])}function E(j,q){for(var Y=0;Y<j.length;Y++)q.writeDouble(j[Y])}function T(j,q){for(var Y=0;Y<j.length;Y++)q.writeBoolean(j[Y])}function S(j,q){for(var Y=0;Y<j.length;Y++)q.writeFixed32(j[Y])}function M(j,q){for(var Y=0;Y<j.length;Y++)q.writeSFixed32(j[Y])}function R(j,q){for(var Y=0;Y<j.length;Y++)q.writeFixed64(j[Y])}function L(j,q){for(var Y=0;Y<j.length;Y++)q.writeSFixed64(j[Y])}function N(j,q){return(j[q]|j[q+1]<<8|j[q+2]<<16)+16777216*j[q+3]}function $(j,q,Y){j[Y]=q,j[Y+1]=q>>>8,j[Y+2]=q>>>16,j[Y+3]=q>>>24}function H(j,q){return(j[q]|j[q+1]<<8|j[q+2]<<16)+(j[q+3]<<24)}return o.prototype={destroy:function(){this.buf=null},readFields:function(j,q,Y){for(Y=Y||this.length;this.pos<Y;){var Q=this.readVarint(),pe=Q>>3,de=this.pos;this.type=7&Q,j(pe,q,this),this.pos===de&&this.skip(Q)}return q},readMessage:function(j,q){return this.readFields(j,q,this.readVarint()+this.pos)},readFixed32:function(){var j=N(this.buf,this.pos);return this.pos+=4,j},readSFixed32:function(){var j=H(this.buf,this.pos);return this.pos+=4,j},readFixed64:function(){var j=N(this.buf,this.pos)+N(this.buf,this.pos+4)*l;return this.pos+=8,j},readSFixed64:function(){var j=N(this.buf,this.pos)+H(this.buf,this.pos+4)*l;return this.pos+=8,j},readFloat:function(){var j=d.read(this.buf,this.pos,!0,23,4);return this.pos+=4,j},readDouble:function(){var j=d.read(this.buf,this.pos,!0,52,8);return this.pos+=8,j},readVarint:function(j){var q,Y,Q=this.buf;return q=127&(Y=Q[this.pos++]),Y<128?q:(q|=(127&(Y=Q[this.pos++]))<<7,Y<128?q:(q|=(127&(Y=Q[this.pos++]))<<14,Y<128?q:(q|=(127&(Y=Q[this.pos++]))<<21,Y<128?q:function(pe,de,ue){var De,fe,Me=ue.buf;if(De=(112&(fe=Me[ue.pos++]))>>4,fe<128||(De|=(127&(fe=Me[ue.pos++]))<<3,fe<128)||(De|=(127&(fe=Me[ue.pos++]))<<10,fe<128)||(De|=(127&(fe=Me[ue.pos++]))<<17,fe<128)||(De|=(127&(fe=Me[ue.pos++]))<<24,fe<128)||(De|=(1&(fe=Me[ue.pos++]))<<31,fe<128))return g(pe,De,de);throw new Error("Expected varint not more than 10 bytes")}(q|=(15&(Y=Q[this.pos]))<<28,j,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var j=this.readVarint();return j%2==1?(j+1)/-2:j/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var j=this.readVarint()+this.pos,q=this.pos;return this.pos=j,j-q>=12&&p?function(Y,Q,pe){return p.decode(Y.subarray(Q,pe))}(this.buf,q,j):function(Y,Q,pe){for(var de="",ue=Q;ue<pe;){var De,fe,Me,Fe=Y[ue],Pe=null,ze=Fe>239?4:Fe>223?3:Fe>191?2:1;if(ue+ze>pe)break;ze===1?Fe<128&&(Pe=Fe):ze===2?(192&(De=Y[ue+1]))==128&&(Pe=(31&Fe)<<6|63&De)<=127&&(Pe=null):ze===3?(fe=Y[ue+2],(192&(De=Y[ue+1]))==128&&(192&fe)==128&&((Pe=(15&Fe)<<12|(63&De)<<6|63&fe)<=2047||Pe>=55296&&Pe<=57343)&&(Pe=null)):ze===4&&(fe=Y[ue+2],Me=Y[ue+3],(192&(De=Y[ue+1]))==128&&(192&fe)==128&&(192&Me)==128&&((Pe=(15&Fe)<<18|(63&De)<<12|(63&fe)<<6|63&Me)<=65535||Pe>=1114112)&&(Pe=null)),Pe===null?(Pe=65533,ze=1):Pe>65535&&(Pe-=65536,de+=String.fromCharCode(Pe>>>10&1023|55296),Pe=56320|1023&Pe),de+=String.fromCharCode(Pe),ue+=ze}return de}(this.buf,q,j)},readBytes:function(){var j=this.readVarint()+this.pos,q=this.buf.subarray(this.pos,j);return this.pos=j,q},readPackedVarint:function(j,q){if(this.type!==o.Bytes)return j.push(this.readVarint(q));var Y=h(this);for(j=j||[];this.pos<Y;)j.push(this.readVarint(q));return j},readPackedSVarint:function(j){if(this.type!==o.Bytes)return j.push(this.readSVarint());var q=h(this);for(j=j||[];this.pos<q;)j.push(this.readSVarint());return j},readPackedBoolean:function(j){if(this.type!==o.Bytes)return j.push(this.readBoolean());var q=h(this);for(j=j||[];this.pos<q;)j.push(this.readBoolean());return j},readPackedFloat:function(j){if(this.type!==o.Bytes)return j.push(this.readFloat());var q=h(this);for(j=j||[];this.pos<q;)j.push(this.readFloat());return j},readPackedDouble:function(j){if(this.type!==o.Bytes)return j.push(this.readDouble());var q=h(this);for(j=j||[];this.pos<q;)j.push(this.readDouble());return j},readPackedFixed32:function(j){if(this.type!==o.Bytes)return j.push(this.readFixed32());var q=h(this);for(j=j||[];this.pos<q;)j.push(this.readFixed32());return j},readPackedSFixed32:function(j){if(this.type!==o.Bytes)return j.push(this.readSFixed32());var q=h(this);for(j=j||[];this.pos<q;)j.push(this.readSFixed32());return j},readPackedFixed64:function(j){if(this.type!==o.Bytes)return j.push(this.readFixed64());var q=h(this);for(j=j||[];this.pos<q;)j.push(this.readFixed64());return j},readPackedSFixed64:function(j){if(this.type!==o.Bytes)return j.push(this.readSFixed64());var q=h(this);for(j=j||[];this.pos<q;)j.push(this.readSFixed64());return j},skip:function(j){var q=7&j;if(q===o.Varint)for(;this.buf[this.pos++]>127;);else if(q===o.Bytes)this.pos=this.readVarint()+this.pos;else if(q===o.Fixed32)this.pos+=4;else{if(q!==o.Fixed64)throw new Error("Unimplemented type: "+q);this.pos+=8}},writeTag:function(j,q){this.writeVarint(j<<3|q)},realloc:function(j){for(var q=this.length||16;q<this.pos+j;)q*=2;if(q!==this.length){var Y=new Uint8Array(q);Y.set(this.buf),this.buf=Y,this.length=q}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(j){this.realloc(4),$(this.buf,j,this.pos),this.pos+=4},writeSFixed32:function(j){this.realloc(4),$(this.buf,j,this.pos),this.pos+=4},writeFixed64:function(j){this.realloc(8),$(this.buf,-1&j,this.pos),$(this.buf,Math.floor(j*u),this.pos+4),this.pos+=8},writeSFixed64:function(j){this.realloc(8),$(this.buf,-1&j,this.pos),$(this.buf,Math.floor(j*u),this.pos+4),this.pos+=8},writeVarint:function(j){(j=+j||0)>268435455||j<0?function(q,Y){var Q,pe;if(q>=0?(Q=q%4294967296|0,pe=q/4294967296|0):(pe=~(-q/4294967296),4294967295^(Q=~(-q%4294967296))?Q=Q+1|0:(Q=0,pe=pe+1|0)),q>=18446744073709552e3||q<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Y.realloc(10),function(de,ue,De){De.buf[De.pos++]=127&de|128,de>>>=7,De.buf[De.pos++]=127&de|128,de>>>=7,De.buf[De.pos++]=127&de|128,de>>>=7,De.buf[De.pos++]=127&de|128,De.buf[De.pos]=127&(de>>>=7)}(Q,0,Y),function(de,ue){var De=(7&de)<<4;ue.buf[ue.pos++]|=De|((de>>>=3)?128:0),de&&(ue.buf[ue.pos++]=127&de|((de>>>=7)?128:0),de&&(ue.buf[ue.pos++]=127&de|((de>>>=7)?128:0),de&&(ue.buf[ue.pos++]=127&de|((de>>>=7)?128:0),de&&(ue.buf[ue.pos++]=127&de|((de>>>=7)?128:0),de&&(ue.buf[ue.pos++]=127&de)))))}(pe,Y)}(j,this):(this.realloc(4),this.buf[this.pos++]=127&j|(j>127?128:0),j<=127||(this.buf[this.pos++]=127&(j>>>=7)|(j>127?128:0),j<=127||(this.buf[this.pos++]=127&(j>>>=7)|(j>127?128:0),j<=127||(this.buf[this.pos++]=j>>>7&127))))},writeSVarint:function(j){this.writeVarint(j<0?2*-j-1:2*j)},writeBoolean:function(j){this.writeVarint(!!j)},writeString:function(j){j=String(j),this.realloc(4*j.length),this.pos++;var q=this.pos;this.pos=function(Q,pe,de){for(var ue,De,fe=0;fe<pe.length;fe++){if((ue=pe.charCodeAt(fe))>55295&&ue<57344){if(!De){ue>56319||fe+1===pe.length?(Q[de++]=239,Q[de++]=191,Q[de++]=189):De=ue;continue}if(ue<56320){Q[de++]=239,Q[de++]=191,Q[de++]=189,De=ue;continue}ue=De-55296<<10|ue-56320|65536,De=null}else De&&(Q[de++]=239,Q[de++]=191,Q[de++]=189,De=null);ue<128?Q[de++]=ue:(ue<2048?Q[de++]=ue>>6|192:(ue<65536?Q[de++]=ue>>12|224:(Q[de++]=ue>>18|240,Q[de++]=ue>>12&63|128),Q[de++]=ue>>6&63|128),Q[de++]=63&ue|128)}return de}(this.buf,j,this.pos);var Y=this.pos-q;Y>=128&&x(q,Y,this),this.pos=q-1,this.writeVarint(Y),this.pos+=Y},writeFloat:function(j){this.realloc(4),d.write(this.buf,j,this.pos,!0,23,4),this.pos+=4},writeDouble:function(j){this.realloc(8),d.write(this.buf,j,this.pos,!0,52,8),this.pos+=8},writeBytes:function(j){var q=j.length;this.writeVarint(q),this.realloc(q);for(var Y=0;Y<q;Y++)this.buf[this.pos++]=j[Y]},writeRawMessage:function(j,q){this.pos++;var Y=this.pos;j(q,this);var Q=this.pos-Y;Q>=128&&x(Y,Q,this),this.pos=Y-1,this.writeVarint(Q),this.pos+=Q},writeMessage:function(j,q,Y){this.writeTag(j,o.Bytes),this.writeRawMessage(q,Y)},writePackedVarint:function(j,q){q.length&&this.writeMessage(j,C,q)},writePackedSVarint:function(j,q){q.length&&this.writeMessage(j,D,q)},writePackedBoolean:function(j,q){q.length&&this.writeMessage(j,T,q)},writePackedFloat:function(j,q){q.length&&this.writeMessage(j,v,q)},writePackedDouble:function(j,q){q.length&&this.writeMessage(j,E,q)},writePackedFixed32:function(j,q){q.length&&this.writeMessage(j,S,q)},writePackedSFixed32:function(j,q){q.length&&this.writeMessage(j,M,q)},writePackedFixed64:function(j,q){q.length&&this.writeMessage(j,R,q)},writePackedSFixed64:function(j,q){q.length&&this.writeMessage(j,L,q)},writeBytesField:function(j,q){this.writeTag(j,o.Bytes),this.writeBytes(q)},writeFixed32Field:function(j,q){this.writeTag(j,o.Fixed32),this.writeFixed32(q)},writeSFixed32Field:function(j,q){this.writeTag(j,o.Fixed32),this.writeSFixed32(q)},writeFixed64Field:function(j,q){this.writeTag(j,o.Fixed64),this.writeFixed64(q)},writeSFixed64Field:function(j,q){this.writeTag(j,o.Fixed64),this.writeSFixed64(q)},writeVarintField:function(j,q){this.writeTag(j,o.Varint),this.writeVarint(q)},writeSVarintField:function(j,q){this.writeTag(j,o.Varint),this.writeSVarint(q)},writeStringField:function(j,q){this.writeTag(j,o.Bytes),this.writeString(q)},writeFloatField:function(j,q){this.writeTag(j,o.Fixed32),this.writeFloat(q)},writeDoubleField:function(j,q){this.writeTag(j,o.Fixed64),this.writeDouble(q)},writeBooleanField:function(j,q){this.writeVarintField(j,!!q)}},CT}var n1=y(NF());let ST=3;function A$(d,o,l){o.glyphs=[],d===1&&l.readMessage(R$,o)}function R$(d,o,l){if(d===3){let{id:u,bitmap:p,width:h,height:g,left:x,top:C,advance:D}=l.readMessage(k$,{});o.glyphs.push({id:u,bitmap:new Oh({width:h+2*ST,height:g+2*ST},p),metrics:{width:h,height:g,left:x,top:C,advance:D}})}else d===4?o.ascender=l.readSVarint():d===5&&(o.descender=l.readSVarint())}function k$(d,o,l){d===1?o.id=l.readVarint():d===2?o.bitmap=l.readBytes():d===3?o.width=l.readVarint():d===4?o.height=l.readVarint():d===5?o.left=l.readSVarint():d===6?o.top=l.readSVarint():d===7&&(o.advance=l.readVarint())}let zF=ST,Cs={horizontal:1,vertical:2,horizontalOnly:3};class g0{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(o,l){let u=new g0;return u.scale=o||1,u.fontStack=l,u}static forImage(o){let l=new g0;return l.image=o,l}}class $g{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,l,u){let p=new $g;for(let h=0;h<o.sections.length;h++){let g=o.sections[h];g.image?p.addImageSection(g,u):p.addTextSection(g,l)}return p}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSections(){return this.sections}getSectionIndex(o){return this.sectionIndex[o]}getCodePoint(o){return this.text.codePointAt(o)}verticalizePunctuation(o){this.text=function(l,u){let p="";for(let h=0;h<l.length;h++){let g=l.charCodeAt(h+1)||null,x=l.charCodeAt(h-1)||null;p+=!u&&(g&&Mv(g)&&!m0[l[h+1]]||x&&Mv(x)&&!m0[l[h-1]])||!m0[l[h]]?l[h]:m0[l[h]]}return p}(this.text,o)}trim(){let o=0;for(let u=0;u<this.text.length&&r1[this.text.charCodeAt(u)];u++)o++;let l=this.text.length;for(let u=this.text.length-1;u>=0&&u>=o&&r1[this.text.charCodeAt(u)];u--)l--;this.text=this.text.substring(o,l),this.sectionIndex=this.sectionIndex.slice(o,l)}substring(o,l){let u=new $g;return u.text=this.text.substring(o,l),u.sectionIndex=this.sectionIndex.slice(o,l),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,l)=>Math.max(o,this.sections[l].scale),0)}addTextSection(o,l){this.text+=o.text,this.sections.push(g0.forText(o.scale,o.fontStack||l));let u=this.sections.length-1;for(let p=0;p<o.text.length;++p)this.sectionIndex.push(u)}addImageSection(o,l){let u=o.image?o.image.getPrimary():null;if(!u)return void Er("Can't add FormattedSection with an empty image.");u.scaleSelf(l);let p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCodePoint(p),this.sections.push(g0.forImage(u)),this.sectionIndex.push(this.sections.length-1)):Er("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function DT(d,o,l,u,p,h,g,x,C,D,v,E,T,S,M,R=1){let L=$g.fromFeature(d,p,R);E===Cs.vertical&&L.verticalizePunctuation(T);let N=[],$=function(Q,pe,de,ue,De,fe){if(!Q)return[];let Me=[],Fe=function(Ge,Ue,qe,gt,ft,Gt){let wt=0;for(let Rt=0;Rt<Ge.length();Rt++){let yt=Ge.getSection(Rt);wt+=BF(Ge.getCodePoint(Rt),yt,gt,ft,Ue,Gt)}return wt/Math.max(1,Math.ceil(wt/qe))}(Q,pe,de,ue,De,fe),Pe=Q.text.indexOf("\u200B")>=0,ze=0;for(let Ge=0;Ge<Q.length();Ge++){let Ue=Q.getSection(Ge),qe=Q.getCodePoint(Ge);if(r1[qe]||(ze+=BF(qe,Ue,ue,De,pe,fe)),Ge<Q.length()-1){let gt=!((Ne=qe)<11904||!(fi["Bopomofo Extended"](Ne)||fi.Bopomofo(Ne)||fi["CJK Compatibility Forms"](Ne)||fi["CJK Compatibility Ideographs"](Ne)||fi["CJK Compatibility"](Ne)||fi["CJK Radicals Supplement"](Ne)||fi["CJK Strokes"](Ne)||fi["CJK Symbols and Punctuation"](Ne)||fi["CJK Unified Ideographs Extension A"](Ne)||fi["CJK Unified Ideographs"](Ne)||fi["Enclosed CJK Letters and Months"](Ne)||fi["Halfwidth and Fullwidth Forms"](Ne)||fi.Hiragana(Ne)||fi["Ideographic Description Characters"](Ne)||fi["Kangxi Radicals"](Ne)||fi["Katakana Phonetic Extensions"](Ne)||fi.Katakana(Ne)||fi["Vertical Forms"](Ne)||fi["Yi Radicals"](Ne)||fi["Yi Syllables"](Ne)));(P$[qe]||gt||Ue.image)&&Me.push(jF(Ge+1,ze,Fe,Me,O$(qe,Q.getCodePoint(Ge+1),gt&&Pe),!1))}}var Ne;return UF(jF(Q.length(),ze,Fe,Me,0,!0))}(L,D,h,o,u,S),{processBidirectionalText:H,processStyledBidirectionalText:j}=Vs;if(H&&L.sections.length===1){let Q=H(L.toString(),$);for(let pe of Q){let de=new $g;de.text=pe,de.sections=L.sections;for(let ue=0;ue<pe.length;ue++)de.sectionIndex.push(0);N.push(de)}}else if(j){let Q=j(L.text,L.sectionIndex,$);for(let pe of Q){let de=new $g;de.text=pe[0],de.sectionIndex=pe[1],de.sections=L.sections,N.push(de)}}else N=function(Q,pe){let de=[],ue=Q.text,De=0;for(let fe of pe)de.push(Q.substring(De,fe)),De=fe;return De<ue.length&&de.push(Q.substring(De,ue.length)),de}(L,$);let q=[],Y={positionedLines:q,text:L.toString(),top:v[1],bottom:v[1],left:v[0],right:v[0],writingMode:E,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if(function(Q,pe,de,ue,De,fe,Me,Fe,Pe,ze,Ne,Ge){let Ue=0,qe=0,gt=0,ft=Fe==="right"?1:Fe==="left"?0:.5,Gt=!1;for(let Jt of De){let Ci=Jt.getSections();for(let Wi of Ci){if(Wi.image)continue;let Di=pe[Wi.fontStack];if(Di&&(Gt=Di.ascender!==void 0&&Di.descender!==void 0,!Gt))break}if(!Gt)break}let wt=0;for(let Jt of De){Jt.trim();let Ci=Jt.getMaxScale(),Wi=(Ci-1)*ia,Di={positionedGlyphs:[],lineOffset:0};Q.positionedLines[wt]=Di;let en=Di.positionedGlyphs,Gi=0;if(!Jt.length()){qe+=fe,++wt;continue}let rn=0,yn=0;for(let Ei=0;Ei<Jt.length();Ei++){let cn=Jt.getSection(Ei),pr=Jt.getSectionIndex(Ei),br=Jt.getCodePoint(Ei),Dr=cn.scale,Rr=null,Jn=null,So=null,$a=ia,Qr=0;Pe===Cs.vertical&&((Rt=br)===12312||Rt===12313||Rt===12316||Rt===12540||Rt===12448)&&(Pe=Cs.horizontal);let so=!(Pe===Cs.horizontal||!Ne&&!vg(br)||Ne&&(r1[br]||Cw(br)));if(cn.image){let wa=ue.get(cn.image.toString());if(!wa)continue;So=cn.image,Q.iconsInText=Q.iconsInText||!0,Jn=wa.paddedRect;let Go=wa.displaySize;Dr=Dr*ia/Ge,Rr={width:Go[0],height:Go[1],left:0,top:-zF,advance:so?Go[1]:Go[0],localGlyph:!1},Qr=Gt?-Rr.height*Dr:Ci*ia-17-Go[1]*Dr,$a=Rr.advance;let vl=(so?Go[0]:Go[1])*Dr-ia*Ci;vl>0&&vl>Gi&&(Gi=vl)}else{let wa=de[cn.fontStack];if(!wa)continue;wa[br]&&(Jn=wa[br]);let Go=pe[cn.fontStack];if(!Go)continue;let vl=Go.glyphs[br];if(!vl)continue;if(Rr=vl.metrics,$a=br!==8203?ia:0,Gt){let Uh=Go.ascender!==void 0?Math.abs(Go.ascender):0,Vl=Go.descender!==void 0?Math.abs(Go.descender):0,Pc=(Uh+Vl)*Dr;rn<Pc&&(rn=Pc,yn=(Uh-Vl)/2*Dr),Qr=-Uh*Dr}else Qr=(Ci-Dr)*ia-17}so?(Q.verticalizable=!0,en.push({glyph:br,image:So,x:Ue,y:qe+Qr,vertical:so,scale:Dr,localGlyph:Rr.localGlyph,fontStack:cn.fontStack,sectionIndex:pr,metrics:Rr,rect:Jn}),Ue+=$a*Dr+ze):(en.push({glyph:br,image:So,x:Ue,y:qe+Qr,vertical:so,scale:Dr,localGlyph:Rr.localGlyph,fontStack:cn.fontStack,sectionIndex:pr,metrics:Rr,rect:Jn}),Ue+=Rr.advance*Dr+ze)}en.length!==0&&(gt=Math.max(Ue-ze,gt),Gt?HF(en,ft,Gi,yn,fe*Ci/2):HF(en,ft,Gi,0,fe/2)),Ue=0;let nr=fe*Ci+Gi;Di.lineOffset=Math.max(Gi,Wi),qe+=nr,++wt}var Rt;let yt=qe,{horizontalAlign:mi,verticalAlign:jt}=MT(Me);(function(Jt,Ci,Wi,Di,en,Gi){let rn=(Ci-Wi)*en,yn=-Gi*Di;for(let nr of Jt)for(let Ei of nr.positionedGlyphs)Ei.x+=rn,Ei.y+=yn})(Q.positionedLines,ft,mi,jt,gt,yt),Q.top+=-jt*yt,Q.bottom=Q.top+yt,Q.left+=-mi*gt,Q.right=Q.left+gt,Q.hasBaseline=Gt}(Y,o,l,u,N,g,x,C,E,D,T,M),!function(Q){for(let pe of Q)if(pe.positionedGlyphs.length!==0)return!1;return!0}(q))return Y}let r1={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},P$={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function BF(d,o,l,u,p,h){if(o.image){let g=u.get(o.image.toString());return g?g.displaySize[0]*o.scale*ia/h+p:0}{let g=l[o.fontStack],x=g&&g.glyphs[d];return x?x.metrics.advance*o.scale+p:0}}function VF(d,o,l,u){let p=Math.pow(d-o,2);return u?d<o?p/2:2*p:p+Math.abs(l)*l}function O$(d,o,l){let u=0;return d===10&&(u-=1e4),l&&(u+=150),d!==40&&d!==65288||(u+=50),o!==41&&o!==65289||(u+=50),u}function jF(d,o,l,u,p,h){let g=null,x=VF(o,l,p,h);for(let C of u){let D=VF(o-C.x,l,p,h)+C.badness;D<=x&&(g=C,x=D)}return{index:d,x:o,priorBreak:g,badness:x}}function UF(d){return d?UF(d.priorBreak).concat(d.index):[]}function MT(d){let o=.5,l=.5;switch(d){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(d){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:o,verticalAlign:l}}function HF(d,o,l,u,p){if(!(o||l||u||p))return;let h=d.length-1,g=d[h],x=(g.x+g.metrics.advance*g.scale)*o;for(let C=0;C<=h;C++)d[C].x-=x,d[C].y+=l+u+p}function F$(d,o,l,u){let{horizontalAlign:p,verticalAlign:h}=MT(u),g=l[0]-d.displaySize[0]*p,x=l[1]-d.displaySize[1]*h;return{imagePrimary:d,imageSecondary:o,top:x,bottom:x+d.displaySize[1],left:g,right:g+d.displaySize[0]}}function $F(d,o,l,u,p,h){let g=d.imagePrimary,x;if(g.content){let L=g.content,N=g.pixelRatio||1;x=[L[0]/N,L[1]/N,g.displaySize[0]-L[2]/N,g.displaySize[1]-L[3]/N]}let C=o.left*h,D=o.right*h,v,E,T,S;l==="width"||l==="both"?(S=p[0]+C-u[3],E=p[0]+D+u[1]):(S=p[0]+(C+D-g.displaySize[0])/2,E=S+g.displaySize[0]);let M=o.top*h,R=o.bottom*h;return l==="height"||l==="both"?(v=p[1]+M-u[0],T=p[1]+R+u[2]):(v=p[1]+(M+R-g.displaySize[1])/2,T=v+g.displaySize[1]),{imagePrimary:g,imageSecondary:void 0,top:v,right:E,bottom:T,left:S,collisionPadding:x}}class fu extends At{constructor(o,l,u,p,h){super(o,l),this.angle=p,this.z=u,h!==void 0&&(this.segment=h)}clone(){return new fu(this.x,this.y,this.z,this.angle,this.segment)}}function GF(d,o,l,u,p){if(o.segment===void 0)return!0;let h=o,g=o.segment+1,x=0;for(;x>-l/2;){if(g--,g<0)return!1;x-=d[g].dist(h),h=d[g]}x+=d[g].dist(d[g+1]),g++;let C=[],D=0;for(;x<l/2;){let v=d[g],E=d[g+1];if(!E)return!1;let T=d[g-1].angleTo(v)-v.angleTo(E);for(T=Math.abs((T+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:x,angleDelta:T}),D+=T;x-C[0].distance>u;)D-=C.shift().angleDelta;if(D>p)return!1;g++,x+=v.dist(E)}return!0}function qF(d){let o=0;for(let l=0;l<d.length-1;l++)o+=d[l].dist(d[l+1]);return o}function WF(d,o,l){return d?.6*o*l:0}function YF(d,o){return Math.max(d?d.right-d.left:0,o?o.right-o.left:0)}function L$(d,o,l,u,p,h){let g=WF(l,p,h),x=YF(l,u)*h,C=0,D=qF(d)/2;for(let v=0;v<d.length-1;v++){let E=d[v],T=d[v+1],S=E.dist(T);if(C+S>D){let M=(D-C)/S,R=yi(E.x,T.x,M),L=yi(E.y,T.y,M),N=new fu(R,L,0,T.angleTo(E),v);return!g||GF(d,N,x,g,o)?N:void 0}C+=S}}function N$(d,o,l,u,p,h,g,x,C){let D=WF(u,h,g),v=YF(u,p),E=v*g,T=d[0].x===0||d[0].x===C||d[0].y===0||d[0].y===C;return o-E<o/4&&(o=E+o/4),ZF(d,T?o/2*x%o:(v/2+2*h)*g*x%o,o,D,l,E,T,!1,C)}function ZF(d,o,l,u,p,h,g,x,C){let D=h/2,v=qF(d),E=0,T=o-l,S=[];for(let M=0;M<d.length-1;M++){let R=d[M],L=d[M+1],N=R.dist(L),$=L.angleTo(R);for(;T+l<E+N;){T+=l;let H=(T-E)/N,j=yi(R.x,L.x,H),q=yi(R.y,L.y,H);if(j>=0&&j<C&&q>=0&&q<C&&T-D>=0&&T+D<=v){let Y=new fu(j,q,0,$,M);u&&!GF(d,Y,h,u,p)||S.push(Y)}}E+=N}return x||S.length||g||(S=ZF(d,E/2,l,u,p,h,g,!0,C)),S}function XF(d,o,l,u,p){let h=[];for(let g=0;g<d.length;g++){let x=d[g],C;for(let D=0;D<x.length-1;D++){let v=x[D],E=x[D+1];v.x<o&&E.x<o||(v.x<o?v=new At(o,v.y+(o-v.x)/(E.x-v.x)*(E.y-v.y))._round():E.x<o&&(E=new At(o,v.y+(o-v.x)/(E.x-v.x)*(E.y-v.y))._round()),v.y<l&&E.y<l||(v.y<l?v=new At(v.x+(l-v.y)/(E.y-v.y)*(E.x-v.x),l)._round():E.y<l&&(E=new At(v.x+(l-v.y)/(E.y-v.y)*(E.x-v.x),l)._round()),v.x>=u&&E.x>=u||(v.x>=u?v=new At(u,v.y+(u-v.x)/(E.x-v.x)*(E.y-v.y))._round():E.x>=u&&(E=new At(u,v.y+(u-v.x)/(E.x-v.x)*(E.y-v.y))._round()),v.y>=p&&E.y>=p||(v.y>=p?v=new At(v.x+(p-v.y)/(E.y-v.y)*(E.x-v.x),p)._round():E.y>=p&&(E=new At(v.x+(p-v.y)/(E.y-v.y)*(E.x-v.x),p)._round()),C&&v.equals(C[C.length-1])||(C=[v],h.push(C)),C.push(E)))))}}return h}function KF(d){let o=0,l=0;for(let g of d)o+=g.w*g.h,l=Math.max(l,g.w);d.sort((g,x)=>x.h-g.h);let u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),l),h:1/0}],p=0,h=0;for(let g of d)for(let x=u.length-1;x>=0;x--){let C=u[x];if(!(g.w>C.w||g.h>C.h)){if(g.x=C.x,g.y=C.y,h=Math.max(h,g.y+g.h),p=Math.max(p,g.x+g.w),g.w===C.w&&g.h===C.h){let D=u.pop();x<u.length&&(u[x]=D)}else g.h===C.h?(C.x+=g.w,C.w-=g.w):g.w===C.w?(C.y+=g.h,C.h-=g.h):(u.push({x:C.x+g.w,y:C.y,w:C.w-g.w,h:g.h}),C.y+=g.h,C.h-=g.h);break}}return{w:p,h,fill:o/(p*h)||0}}$t(fu,"Anchor");let Gg=1;class _0{static getImagePositionScale(o,l,u){if(l&&o&&o.options&&o.options.transform){let p=o.options.transform;return{x:p.a,y:p.d}}return{x:u,y:u}}constructor(o,l,u,p){this.paddedRect=o;let{pixelRatio:h,version:g,stretchX:x,stretchY:C,content:D,sdf:v,usvg:E}=l;this.pixelRatio=h,this.stretchX=x,this.stretchY=C,this.content=D,this.version=g,this.padding=u,this.sdf=v,this.scale=_0.getImagePositionScale(p,E,h)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function QF(d,o,l){let u=Pl.parse(d),p=function(h,g,x=[1,1]){return{x:0,y:0,w:(h.data?h.data.width:h.width*x[0])+2*g,h:(h.data?h.data.height:h.height*x[1])+2*g}}(o,l,[u.options.transform.a,u.options.transform.d]);return{bin:p,imagePosition:new _0(p,o,l,u),imageVariant:u}}class JF{constructor(o,l,u){let p=new Map,h=new Map;this.haveRenderCallbacks=[];let g=[];this.addImages(o,p,Gg,g),this.addImages(l,h,2,g);let{w:x,h:C}=KF(g),D=new ta({width:x||1,height:C||1});for(let[v,E]of o.entries()){let T=p.get(v).paddedRect;ta.copy(E.data,D,{x:0,y:0},{x:T.x+Gg,y:T.y+Gg},E.data,u,E.sdf)}for(let[v,E]of l.entries()){let T=h.get(v),S=T.paddedRect,M=T.padding,R=S.x+M,L=S.y+M,N=E.data.width,$=E.data.height;M=M>1?M-1:M,ta.copy(E.data,D,{x:0,y:0},{x:R,y:L},E.data,u),ta.copy(E.data,D,{x:0,y:$-M},{x:R,y:L-M},{width:N,height:M},u),ta.copy(E.data,D,{x:0,y:0},{x:R,y:L+$},{width:N,height:M},u),ta.copy(E.data,D,{x:N-M,y:0},{x:R-M,y:L},{width:M,height:$},u),ta.copy(E.data,D,{x:0,y:0},{x:R+N,y:L},{width:M,height:$},u),ta.copy(E.data,D,{x:N-M,y:$-M},{x:R-M,y:L-M},{width:M,height:M},u),ta.copy(E.data,D,{x:0,y:$-M},{x:R+N,y:L-M},{width:M,height:M},u),ta.copy(E.data,D,{x:0,y:0},{x:R+N,y:L+$},{width:M,height:M},u),ta.copy(E.data,D,{x:N-M,y:0},{x:R-M,y:L+$},{width:M,height:M},u)}this.lut=u,this.image=D,this.iconPositions=p,this.patternPositions=h}addImages(o,l,u,p){for(let[h,g]of o.entries()){let{bin:x,imagePosition:C,imageVariant:D}=QF(h,g,u);l.set(h,C),p.push(x),g.hasRenderCallback&&this.haveRenderCallbacks.push(D.id)}}patchUpdatedImages(o,l,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(p=>o.hasImage(p,u)),o.dispatchRenderCallbacks(this.haveRenderCallbacks,u);for(let p of o.getUpdatedImages(u)){for(let h of this.iconPositions.keys()){let g=Pl.parse(h);if(ja.isEqual(g.id,p)){let x=o.getImage(p,u);this.patchUpdatedImage(this.iconPositions.get(h),x,l)}}for(let h of this.patternPositions.keys()){let g=Pl.parse(h);if(ja.isEqual(g.id,p)){let x=o.getImage(p,u);this.patchUpdatedImage(this.patternPositions.get(h),x,l)}}}}patchUpdatedImage(o,l,u){if(!o||!l||o.version===l.version)return;o.version=l.version;let[p,h]=o.tl,g=o.sdf;if(this.lut||g){let x={width:l.data.width,height:l.data.height},C=new ta(x);ta.copy(l.data,C,{x:0,y:0},{x:0,y:0},x,this.lut,g),u.update(C,{position:{x:p,y:h}})}else u.update(l.data,{position:{x:p,y:h}})}}$t(_0,"ImagePosition"),$t(JF,"ImageAtlas");let y0=1e20;function eL(d,o,l,u,p,h,g,x,C){for(let D=o;D<o+u;D++)tL(d,l*h+D,h,p,g,x,C);for(let D=l;D<l+p;D++)tL(d,D*h+o,1,u,g,x,C)}function tL(d,o,l,u,p,h,g){h[0]=0,g[0]=-y0,g[1]=y0,p[0]=d[o];for(let x=1,C=0,D=0;x<u;x++){p[x]=d[o+x*l];let v=x*x;do{let E=h[C];D=(p[x]-p[E]+v-E*E)/(x-E)/2}while(D<=g[C]&&--C>-1);C++,h[C]=x,g[C]=D,g[C+1]=y0}for(let x=0,C=0;x<u;x++){for(;g[C+1]<x;)C++;let D=h[C],v=x-D;d[o+x*l]=p[D]+v*v}}let Ic=2,TT={none:0,ideographs:1,all:2};class qg{constructor(o,l,u){this.requestManager=o,this.localGlyphMode=l,this.localFontFamily=u,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(o,l){this.urls[l]=o}getGlyphs(o,l,u){let p=[],h=this.urls[l]||ie.GLYPHS_URL;for(let g in o)for(let x of o[g])p.push({stack:g,id:x});cl(p,({stack:g,id:x},C)=>{let D=this.entries[g];D||(D=this.entries[g]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let v=D.glyphs[x];if(v!==void 0)return void C(null,{stack:g,id:x,glyph:v});if(v=this._tinySDF(D,g,x),v)return D.glyphs[x]=v,void C(null,{stack:g,id:x,glyph:v});let E=Math.floor(x/256);if(256*E>65535)return Er("glyphs > 65535 not supported"),void C(null,{stack:g,id:x,glyph:v});if(D.ranges[E])return void C(null,{stack:g,id:x,glyph:v});let T=D.requests[E];T||(T=D.requests[E]=[],qg.loadGlyphRange(g,E,h,this.requestManager,(S,M)=>{if(M){D.ascender=M.ascender,D.descender=M.descender;for(let R in M.glyphs)this._doesCharSupportLocalGlyph(+R)||(D.glyphs[+R]=M.glyphs[+R]);D.ranges[E]=!0}for(let R of T)R(S,M);delete D.requests[E]})),T.push((S,M)=>{S?C(S):M&&C(null,{stack:g,id:x,glyph:M.glyphs[x]||null})})},(g,x)=>{if(g)u(g);else if(x){let C={};for(let{stack:D,id:v,glyph:E}of x)C[D]===void 0&&(C[D]={}),C[D].glyphs===void 0&&(C[D].glyphs={}),C[D].glyphs[v]=E&&{id:E.id,bitmap:E.bitmap.clone(),metrics:E.metrics},C[D].ascender=this.entries[D].ascender,C[D].descender=this.entries[D].descender;u(null,C)}})}_doesCharSupportLocalGlyph(o){return this.localGlyphMode!==TT.none&&(this.localGlyphMode===TT.all?!!this.localFontFamily:!!this.localFontFamily&&(fi["CJK Unified Ideographs"](o)||fi["Hangul Syllables"](o)||fi.Hiragana(o)||fi.Katakana(o)||fi["CJK Symbols and Punctuation"](o)||fi["CJK Unified Ideographs Extension A"](o)||fi["CJK Unified Ideographs Extension B"](o)||fi.Osage(o)))}_tinySDF(o,l,u){let p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(u))return;let h=o.tinySDF;if(!h){let R="400";/bold/i.test(l)?R="900":/medium/i.test(l)?R="500":/light/i.test(l)&&(R="200"),h=o.tinySDF=new qg.TinySDF({fontFamily:p,fontWeight:R,fontSize:24*Ic,buffer:3*Ic,radius:8*Ic}),h.fontWeight=R}if(this.localGlyphs[h.fontWeight][u])return this.localGlyphs[h.fontWeight][u];let g=String.fromCodePoint(u),{data:x,width:C,height:D,glyphWidth:v,glyphHeight:E,glyphLeft:T,glyphTop:S,glyphAdvance:M}=h.draw(g);return this.localGlyphs[h.fontWeight][u]={id:u,bitmap:new Oh({width:C,height:D},x),metrics:{width:v/Ic,height:E/Ic,left:T/Ic,top:S/Ic-27,advance:M/Ic,localGlyph:!0}}}}qg.loadGlyphRange=function(d,o,l,u,p){let h=256*o,g=h+255,x=u.transformRequest(u.normalizeGlyphsURL(l).replace("{fontstack}",d).replace("{range}",`${h}-${g}`),Ro.Glyphs);dc(x,(C,D)=>{if(C)p(C);else if(D){let v={},E=function(T){return new n1(T).readFields(A$,{})}(D);for(let T of E.glyphs)v[T.id]=T;p(null,{glyphs:v,ascender:E.ascender,descender:E.descender})}})},qg.TinySDF=class{constructor({fontSize:d=24,buffer:o=3,radius:l=8,cutoff:u=.25,fontFamily:p="sans-serif",fontWeight:h="normal",fontStyle:g="normal"}={}){this.buffer=o,this.cutoff=u,this.radius=l;let x=this.size=d+4*o,C=this._createCanvas(x),D=this.ctx=C.getContext("2d",{willReadFrequently:!0});D.font=`${g} ${h} ${d}px ${p}`,D.textBaseline="alphabetic",D.textAlign="left",D.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Uint16Array(x)}_createCanvas(d){let o=document.createElement("canvas");return o.width=o.height=d,o}draw(d){let{width:o,actualBoundingBoxAscent:l,actualBoundingBoxDescent:u,actualBoundingBoxLeft:p,actualBoundingBoxRight:h}=this.ctx.measureText(d),g=Math.ceil(l),x=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(h-p))),C=Math.min(this.size-this.buffer,g+Math.ceil(u)),D=x+2*this.buffer,v=C+2*this.buffer,E=Math.max(D*v,0),T=new Uint8ClampedArray(E),S={data:T,width:D,height:v,glyphWidth:x,glyphHeight:C,glyphTop:g,glyphLeft:0,glyphAdvance:o};if(x===0||C===0)return S;let{ctx:M,buffer:R,gridInner:L,gridOuter:N}=this;M.clearRect(R,R,x,C),M.fillText(d,R,R+g);let $=M.getImageData(R,R,x,C);N.fill(y0,0,E),L.fill(0,0,E);for(let H=0;H<C;H++)for(let j=0;j<x;j++){let q=$.data[4*(H*x+j)+3]/255;if(q===0)continue;let Y=(H+R)*D+j+R;if(q===1)N[Y]=0,L[Y]=y0;else{let Q=.5-q;N[Y]=Q>0?Q*Q:0,L[Y]=Q<0?Q*Q:0}}eL(N,0,0,D,v,D,this.f,this.v,this.z),eL(L,R,R,x,C,D,this.f,this.v,this.z);for(let H=0;H<E;H++){let j=Math.sqrt(N[H])-Math.sqrt(L[H]);T[H]=Math.round(255-255*(j/this.radius+this.cutoff))}return S}};let Nh=Gg;function iL(d,o){return d+o[1]-o[0]}function nL(d,o,l,u,p=1){let h=[],g=d.imagePrimary,x=g.pixelRatio,C=g.paddedRect.w-2*Nh,D=g.paddedRect.h-2*Nh,v=(d.right-d.left)*p,E=(d.bottom-d.top)*p,T=g.stretchX||[[0,C]],S=g.stretchY||[[0,D]],M=T.reduce(iL,0),R=S.reduce(iL,0),L=C-M,N=D-R,$=0,H=M,j=0,q=R,Y=0,Q=L,pe=0,de=N;if(g.content&&u){let De=g.content;$=o1(T,0,De[0]),j=o1(S,0,De[1]),H=o1(T,De[0],De[2]),q=o1(S,De[1],De[3]),Y=De[0]-$,pe=De[1]-j,Q=De[2]-De[0]-H,de=De[3]-De[1]-q}let ue=(De,fe,Me,Fe)=>{let Pe=a1(De.stretch-$,H,v,d.left*p),ze=s1(De.fixed-Y,Q,De.stretch,M),Ne=a1(fe.stretch-j,q,E,d.top*p),Ge=s1(fe.fixed-pe,de,fe.stretch,R),Ue=a1(Me.stretch-$,H,v,d.left*p),qe=s1(Me.fixed-Y,Q,Me.stretch,M),gt=a1(Fe.stretch-j,q,E,d.top*p),ft=s1(Fe.fixed-pe,de,Fe.stretch,R),Gt=new At(Pe,Ne),wt=new At(Ue,Ne),Rt=new At(Ue,gt),yt=new At(Pe,gt),mi=new At(ze/x,Ge/x),jt=new At(qe/x,ft/x),Jt=o*Math.PI/180;if(Jt){let rn=Math.sin(Jt),yn=Math.cos(Jt),nr=[yn,-rn,rn,yn];Gt._matMult(nr),wt._matMult(nr),yt._matMult(nr),Rt._matMult(nr)}let Ci=De.stretch+De.fixed,Wi=Me.stretch+Me.fixed,Di=fe.stretch+fe.fixed,en=Fe.stretch+Fe.fixed,Gi=d.imageSecondary;return{tl:Gt,tr:wt,bl:yt,br:Rt,texPrimary:{x:g.paddedRect.x+Nh+Ci,y:g.paddedRect.y+Nh+Di,w:Wi-Ci,h:en-Di},texSecondary:Gi?{x:Gi.paddedRect.x+Nh+Ci,y:Gi.paddedRect.y+Nh+Di,w:Wi-Ci,h:en-Di}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:mi,pixelOffsetBR:jt,minFontScaleX:Q/x/v,minFontScaleY:de/x/E,isSDF:l}};if(u&&(g.stretchX||g.stretchY)){let De=rL(T,L,M),fe=rL(S,N,R);for(let Me=0;Me<De.length-1;Me++){let Fe=De[Me],Pe=De[Me+1];for(let ze=0;ze<fe.length-1;ze++)h.push(ue(Fe,fe[ze],Pe,fe[ze+1]))}}else h.push(ue({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:D+1}));return h}function o1(d,o,l){let u=0;for(let p of d)u+=Math.max(o,Math.min(l,p[1]))-Math.max(o,Math.min(l,p[0]));return u}function rL(d,o,l){let u=[{fixed:-Nh,stretch:0}];for(let[p,h]of d){let g=u[u.length-1];u.push({fixed:p-g.stretch,stretch:g.stretch}),u.push({fixed:p-g.stretch,stretch:g.stretch+(h-p)})}return u.push({fixed:o+Nh,stretch:l}),u}function a1(d,o,l,u){return d/o*l+u}function s1(d,o,l,u){return d-o*l/u}function z$(d,o,l,u){let p=o+d.positionedLines[u].lineOffset;return u===0?l+p/2:l+(p+(o+d.positionedLines[u-1].lineOffset))/2}function B$(d,o=1,l=!1){let u=1/0,p=1/0,h=-1/0,g=-1/0,x=d[0];for(let S=0;S<x.length;S++){let M=x[S];(!S||M.x<u)&&(u=M.x),(!S||M.y<p)&&(p=M.y),(!S||M.x>h)&&(h=M.x),(!S||M.y>g)&&(g=M.y)}let C=Math.min(h-u,g-p),D=C/2,v=new af([],V$);if(C===0)return new At(u,p);for(let S=u;S<h;S+=C)for(let M=p;M<g;M+=C)v.push(new Wg(S+D,M+D,D,d));let E=function(S){let M=0,R=0,L=0,N=S[0];for(let $=0,H=N.length,j=H-1;$<H;j=$++){let q=N[$],Y=N[j],Q=q.x*Y.y-Y.x*q.y;R+=(q.x+Y.x)*Q,L+=(q.y+Y.y)*Q,M+=3*Q}return new Wg(R/M,L/M,0,S)}(d),T=v.length;for(;v.length;){let S=v.pop();(S.d>E.d||!E.d)&&(E=S,l&&console.log("found best %d after %d probes",Math.round(1e4*S.d)/1e4,T)),S.max-E.d<=o||(D=S.h/2,v.push(new Wg(S.p.x-D,S.p.y-D,D,d)),v.push(new Wg(S.p.x+D,S.p.y-D,D,d)),v.push(new Wg(S.p.x-D,S.p.y+D,D,d)),v.push(new Wg(S.p.x+D,S.p.y+D,D,d)),T+=4)}return l&&(console.log(`num probes: ${T}`),console.log(`best distance: ${E.d}`)),E.p}function V$(d,o){return o.max-d.max}class Wg{constructor(o,l,u,p){this.p=new At(o,l),this.h=u,this.d=function(h,g){let x=!1,C=1/0;for(let D=0;D<g.length;D++){let v=g[D];for(let E=0,T=v.length,S=T-1;E<T;S=E++){let M=v[E],R=v[S];M.y>h.y!=R.y>h.y&&h.x<(R.x-M.x)*(h.y-M.y)/(R.y-M.y)+M.x&&(x=!x),C=Math.min(C,Se(h,M,R))}}return(x?1:-1)*Math.sqrt(C)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}}let IT=Number.POSITIVE_INFINITY,j$=Math.sqrt(2);function oL(d,[o,l]){let u=0,p=0;if(l===IT){o<0&&(o=0);let h=o/j$;switch(d){case"top-right":case"top-left":p=h-7;break;case"bottom-right":case"bottom-left":p=7-h;break;case"bottom":p=7-o;break;case"top":p=o-7}switch(d){case"top-right":case"bottom-right":u=-h;break;case"top-left":case"bottom-left":u=h;break;case"left":u=o;break;case"right":u=-o}}else{switch(o=Math.abs(o),l=Math.abs(l),d){case"top-right":case"top-left":case"top":p=l-7;break;case"bottom-right":case"bottom-left":case"bottom":p=7-l}switch(d){case"top-right":case"bottom-right":case"right":u=-o;break;case"top-left":case"bottom-left":case"left":u=o}}return[u,p]}function aL(d,o,l,u,p,h,g,x){if(!d)return;let C=OF(o,l,u,p,h);return d.scaleSelf(C*x*g)}function sL(d,o,l,u,p,h,g,x){return{iconPrimary:aL(d.getPrimary(),o,l,u,p,h,g,x),iconSecondary:aL(d.getSecondary(),o,l,u,p,h,g,x)}}function lL(d,o,l,u){if(!d)return;let p=o.get(l.toString());if(d.imagePrimary=p,u){let h=o.get(u.toString());d.imageSecondary=h}}function U$(d,o){for(let l in d.horizontal)cL(d.horizontal[l],o);cL(d.vertical,o)}function cL(d,o){if(d){for(let l of d.positionedLines)for(let u of l.positionedGlyphs)if(u.image!==null){let p=u.image.toString();u.rect=o.get(p).paddedRect}}}function AT(d){switch(d){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function H$(d,o,l,u,p,h,g,x,C){let D=RT(h.horizontal)||h.vertical,v=l.get("icon-text-fit-padding").evaluate(u,{},p),E,T=o;return o&&C!=="none"&&(d.allowVerticalPlacement&&h.vertical&&(E=$F(o,h.vertical,C,v,x,g)),D&&(T=$F(o,D,C,v,x,g))),{defaultShapedIcon:T,verticallyShapedIcon:E}}function $$(d,o,l,u,p,h,g,x,C,D,v,E,T,S,M,R,L,N,$,H){let j=g.textMaxSize.evaluate(o,{},T);j===void 0?j=x*g.textScaleFactor:j*=g.textScaleFactor;let q=d.layers[0].layout,Y=RT(l.horizontal)||l.vertical,Q=S.name==="globe",pe=ia,de=d.tilePixelRatio*j/pe,ue=(ze=d.overscaling,d.zoom>18&&ze>2&&(ze>>=1),Math.max(kt/(512*ze),1)*q.get("symbol-spacing")),De=q.get("text-padding")*d.tilePixelRatio,fe=q.get("icon-padding")*d.tilePixelRatio,Me=Qi(q.get("text-max-angle")),Fe=q.get("icon-rotation-alignment")==="map"&&H!=="point",Pe=ue/2;var ze;d.hasAnyIconTextFit===!1&&L!=="none"&&(d.hasAnyIconTextFit=!0);let Ne=o.properties?+o.properties[Of]:null,Ge=Ne&&d.elevationFeatureIdToIndex?d.elevationFeatureIdToIndex.get(Ne):65535,Ue=(qe,gt,ft)=>{if(gt.x<0||gt.x>=kt||gt.y<0||gt.y>=kt)return;let Gt=null;if(Q){let{x:wt,y:Rt,z:yt}=S.projectTilePoint(gt.x,gt.y,ft);Gt={anchor:new fu(wt,Rt,yt,0,void 0),up:S.upVector(ft,gt.x,gt.y)}}(function(wt,Rt,yt,mi,jt,Jt,Ci,Wi,Di,en,Gi,rn,yn,nr,Ei,cn,pr,br,Dr,Rr,Jn,So,$a,Qr,so,wa,Go,vl,Uh){let Vl=wt.addToLineVertexArray(Rt,mi),Pc,Hh,$h,Vf,GN,qN,WN,YN=0,ZN=0,XN=0,KN=0,dI=-1,uI=-1,bd={},QN=gs(""),jf=yt?yt.anchor:Rt,hI=vl!=="none",pI=0,fI=0;if(Di._unevaluatedLayout.getValue("text-radial-offset")===void 0?[pI,fI]=Di.layout.get("text-offset").evaluate(Jn,{},so).map(bl=>bl*ia):(pI=Di.layout.get("text-radial-offset").evaluate(Jn,{},so)*ia,fI=IT),wt.allowVerticalPlacement&&jt.vertical){let bl=jt.vertical;if(Ei)qN=kT(bl),Wi&&(WN=kT(Wi));else{let Es=Di.layout.get("text-rotate").evaluate(Jn,{},so)+90;$h=l1(en,jf,Rt,Gi,rn,yn,bl,nr,Es,cn),Wi&&(Vf=l1(en,jf,Rt,Gi,rn,yn,Wi,br,Es))}}if(Jt){let bl=wt.iconSizeData,Es=Di.layout.get("icon-rotate").evaluate(Jn,{},so),N0=nL(Jt,Es,$a,hI,So.iconScaleFactor),gI=Wi?nL(Wi,Es,$a,hI,So.iconScaleFactor):void 0;Hh=l1(en,jf,Rt,Gi,rn,yn,Jt,br,Es,null),YN=4*N0.length;let Uf=null;bl.kind==="source"?(Uf=[Tc*Di.layout.get("icon-size").evaluate(Jn,{},so)*So.iconScaleFactor],Uf[0]>zh&&Er(`${wt.layerIds[0]}: Value for "icon-size" is >= ${v0}. Reduce your "icon-size".`)):bl.kind==="composite"&&(Uf=[Tc*So.compositeIconSizes[0].evaluate(Jn,{},so)*So.iconScaleFactor,Tc*So.compositeIconSizes[1].evaluate(Jn,{},so)*So.iconScaleFactor],(Uf[0]>zh||Uf[1]>zh)&&Er(`${wt.layerIds[0]}: Value for "icon-size" is >= ${v0}. Reduce your "icon-size".`)),wt.addSymbols(wt.icon,N0,Uf,Rr,Dr,Jn,!1,yt,Rt,Vl.lineStartIndex,Vl.lineLength,-1,Qr,so,wa,Go),dI=wt.icon.placedSymbolArray.length-1,gI&&(ZN=4*gI.length,wt.addSymbols(wt.icon,gI,Uf,Rr,Dr,Jn,Cs.vertical,yt,Rt,Vl.lineStartIndex,Vl.lineLength,-1,Qr,so,wa,Go),uI=wt.icon.placedSymbolArray.length-1)}for(let bl in jt.horizontal){let Es=jt.horizontal[bl];Pc||(QN=gs(Es.text),Ei?GN=kT(Es):Pc=l1(en,jf,Rt,Gi,rn,yn,Es,nr,Di.layout.get("text-rotate").evaluate(Jn,{},so),cn));let N0=Es.positionedLines.length===1;if(XN+=dL(wt,yt,Rt,Es,Ci,Di,Ei,Jn,cn,Vl,jt.vertical?Cs.horizontal:Cs.horizontalOnly,N0?Object.keys(jt.horizontal):[bl],bd,dI,So,Qr,so,wa),N0)break}jt.vertical&&(KN+=dL(wt,yt,Rt,jt.vertical,Ci,Di,Ei,Jn,cn,Vl,Cs.vertical,["vertical"],bd,uI,So,Qr,so,wa));let Gh=-1,mI=(bl,Es)=>bl?Math.max(bl,Es):Es;Gh=mI(GN,Gh),Gh=mI(qN,Gh),Gh=mI(WN,Gh);let wq=Gh>-1?1:0;wt.glyphOffsetArray.length>=65535&&Er("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Jn.sortKey!==void 0&&wt.addToSortKeyRanges(wt.symbolInstances.length,Jn.sortKey),wt.symbolInstances.emplaceBack(Rt.x,Rt.y,jf.x,jf.y,jf.z,bd.right>=0?bd.right:-1,bd.center>=0?bd.center:-1,bd.left>=0?bd.left:-1,bd.vertical>=0?bd.vertical:-1,dI,uI,QN,Pc!==void 0?Pc:wt.collisionBoxArray.length,Pc!==void 0?Pc+1:wt.collisionBoxArray.length,$h!==void 0?$h:wt.collisionBoxArray.length,$h!==void 0?$h+1:wt.collisionBoxArray.length,Hh!==void 0?Hh:wt.collisionBoxArray.length,Hh!==void 0?Hh+1:wt.collisionBoxArray.length,Vf||wt.collisionBoxArray.length,Vf?Vf+1:wt.collisionBoxArray.length,Gi,XN,KN,YN,ZN,wq,0,pI,fI,Gh,0,hI?1:0,Uh)})(d,gt,Gt,qe,l,u,h,p,d.layers[0],d.collisionBoxArray,o.index,o.sourceLayerIndex,d.index,De,$,D,0,fe,Fe,N,o,g,v,E,T,M,R,L,Ge)};if(H==="line")for(let qe of XF(o.geometry,0,0,kt,kt)){let gt=N$(qe,ue,Me,l.vertical||Y,u,pe,de,d.overscaling,kt);for(let ft of gt)Y&&G$(d,Y.text,Pe,ft)||Ue(qe,ft,T)}else if(H==="line-center"){for(let qe of o.geometry)if(qe.length>1){let gt=L$(qe,Me,l.vertical||Y,u,pe,de);gt&&Ue(qe,gt,T)}}else if(o.type==="Polygon")for(let qe of Zw(o.geometry,0)){let gt=B$(qe,16);Ue(qe[0],new fu(gt.x,gt.y,0,0,void 0),T)}else if(o.type==="LineString")for(let qe of o.geometry)Ue(qe,new fu(qe[0].x,qe[0].y,0,0,void 0),T);else if(o.type==="Point")for(let qe of o.geometry)for(let gt of qe)Ue([gt],new fu(gt.x,gt.y,0,0,void 0),T)}let v0=255,zh=v0*Tc;function dL(d,o,l,u,p,h,g,x,C,D,v,E,T,S,M,R,L,N){let $=function(q,Y,Q,pe,de,ue,De,fe){let Me=[];if(Y.positionedLines.length===0)return Me;let Fe=pe.layout.get("text-rotate").evaluate(ue,{})*Math.PI/180,Pe=function(qe){let gt=qe[0],ft=qe[1],Gt=gt*ft;return Gt>0?[gt,-ft]:Gt<0?[-gt,ft]:gt===0?[ft,gt]:[ft,-gt]}(Q),ze=Math.abs(Y.top-Y.bottom);for(let qe of Y.positionedLines)ze-=qe.lineOffset;let Ne=Y.positionedLines.length,Ge=ze/Ne,Ue=Y.top-Q[1];for(let qe=0;qe<Ne;++qe){let gt=Y.positionedLines[qe];Ue=z$(Y,Ge,Ue,qe);for(let ft of gt.positionedGlyphs){if(!ft.rect)continue;let Gt=ft.rect||{},wt=zF+1,Rt=!0,yt=1,mi=0;if(ft.image){let Jn=De.get(ft.image.toString());if(!Jn)continue;if(Jn.sdf){Er("SDF images are not supported in formatted text and will be ignored.");continue}Rt=!1,yt=Jn.pixelRatio,wt=Gg/yt}let jt=(de||fe)&&ft.vertical,Jt=ft.metrics.advance*ft.scale/2,Ci=ft.metrics,Wi=ft.rect;if(Wi===null)continue;fe&&Y.verticalizable&&(mi=ft.image?Jt-ft.metrics.width*ft.scale/2:0);let Di=de?[ft.x+Jt,ft.y]:[0,0],en=[0,0],Gi=[0,0],rn=!1;de||(jt?(Gi=[ft.x+Jt+Pe[0],ft.y+Pe[1]-mi],rn=!0):en=[ft.x+Jt+Q[0],ft.y+Q[1]-mi]);let yn=Wi.w*ft.scale/(yt*(ft.localGlyph?Ic:1)),nr=Wi.h*ft.scale/(yt*(ft.localGlyph?Ic:1)),Ei,cn,pr,br;if(jt){let Jn=ft.y-Ue,So=new At(-Jt,Jt-Jn),$a=-Math.PI/2,Qr=new At(...Gi);Ei=new At(-Jt+en[0],en[1]),Ei._rotateAround($a,So)._add(Qr),Ei.x+=-Jn+Jt,Ei.y-=(Ci.left-wt)*ft.scale;let so=ft.image?Ci.advance*ft.scale:ia*ft.scale,wa=String.fromCodePoint(ft.glyph);M$(wa)?Ei.x+=(1-wt)*ft.scale:T$(wa)?Ei.x+=so-Ci.height*ft.scale+(-wt-1)*ft.scale:Ei.x+=ft.image||Ci.width+2*wt===Wi.w&&Ci.height+2*wt===Wi.h?(so-nr)/2:(so-(Ci.height+2*wt)*ft.scale)/2,cn=new At(Ei.x,Ei.y-yn),pr=new At(Ei.x+nr,Ei.y),br=new At(Ei.x+nr,Ei.y-yn)}else{let Jn=(Ci.left-wt)*ft.scale-Jt+en[0],So=(-Ci.top-wt)*ft.scale+en[1],$a=Jn+yn,Qr=So+nr;Ei=new At(Jn,So),cn=new At($a,So),pr=new At(Jn,Qr),br=new At($a,Qr)}if(Fe){let Jn;Jn=de?new At(0,0):rn?new At(Pe[0],Pe[1]):new At(Q[0],Q[1]),Ei._rotateAround(Fe,Jn),cn._rotateAround(Fe,Jn),pr._rotateAround(Fe,Jn),br._rotateAround(Fe,Jn)}let Dr=new At(0,0),Rr=new At(0,0);Me.push({tl:Ei,tr:cn,bl:pr,br,texPrimary:Gt,texSecondary:void 0,writingMode:Y.writingMode,glyphOffset:Di,sectionIndex:ft.sectionIndex,isSDF:Rt,pixelOffsetTL:Dr,pixelOffsetBR:Rr,minFontScaleX:0,minFontScaleY:0})}}return Me}(0,u,C,h,g,x,p,d.allowVerticalPlacement),H=d.textSizeData,j=null;H.kind==="source"?(j=[Tc*h.layout.get("text-size").evaluate(x,{},L)*M.textScaleFactor],j[0]>zh&&Er(`${d.layerIds[0]}: Value for "text-size" is >= ${v0}. Reduce your "text-size".`)):H.kind==="composite"&&(j=[Tc*M.compositeTextSizes[0].evaluate(x,{},L)*M.textScaleFactor,Tc*M.compositeTextSizes[1].evaluate(x,{},L)*M.textScaleFactor],(j[0]>zh||j[1]>zh)&&Er(`${d.layerIds[0]}: Value for "text-size" is >= ${v0}. Reduce your "text-size".`)),d.addSymbols(d.text,$,j,C,g,x,v,o,l,D.lineStartIndex,D.lineLength,S,R,L,N,!1);for(let q of E)T[q]=d.text.placedSymbolArray.length-1;return 4*$.length}function RT(d){for(let o in d)return d[o];return null}function l1(d,o,l,u,p,h,g,x,C,D){let v=g.top,E=g.bottom,T=g.left,S=g.right,M=g.collisionPadding;if(M&&(T-=M[0],v-=M[1],S+=M[2],E+=M[3]),C){let R=new At(T,v),L=new At(S,v),N=new At(T,E),$=new At(S,E),H=Qi(C),j=new At(0,0);D&&(j=new At(D[0],D[1])),R._rotateAround(H,j),L._rotateAround(H,j),N._rotateAround(H,j),$._rotateAround(H,j),T=Math.min(R.x,L.x,N.x,$.x),S=Math.max(R.x,L.x,N.x,$.x),v=Math.min(R.y,L.y,N.y,$.y),E=Math.max(R.y,L.y,N.y,$.y)}return d.emplaceBack(o.x,o.y,o.z,l.x,l.y,T,v,S,E,x,u,p,h),d.length-1}function kT(d){d.collisionPadding&&(d.top-=d.collisionPadding[1],d.bottom+=d.collisionPadding[3]);let o=d.bottom-d.top;return o>0?Math.max(10,o):null}function G$(d,o,l,u){let p=d.compareText;if(o in p){let h=p[o];for(let g=h.length-1;g>=0;g--)if(u.dist(h[g])<l)return!0}else p[o]=[];return p[o].push(u),!1}function uL(d,o){let l=d.fovAboveCenter,u=d.elevation?d.elevation.getMinElevationBelowMSL()*o:0,p=(d._camera.position[2]*d.worldSize-u)/Math.cos(d._pitch),h=Math.sin(l)*p/Math.sin(Math.max(Math.PI/2-d._pitch-l,.01)),g=Math.sin(d._pitch)*h+p,x=p*(1/d._horizonShift);if(!d.elevation||d.elevation.exaggeration()===0){let C=Math.max(d.zoom-17,0);d.isOrthographic&&(C/=10),g*=1+C}return Math.min(1.01*g,x)}function b0(d,o){if(!o.isReprojectedInTileSpace)return{scale:1<<d.z,x:d.x,y:d.y,x2:d.x+1,y2:d.y+1,projection:o};let l=Math.pow(2,-d.z),u=d.x*l,p=(d.x+1)*l,h=d.y*l,g=(d.y+1)*l,x=es(u),C=es(p),D=Ho(h),v=Ho(g),E=o.project(x,D),T=o.project(C,D),S=o.project(C,v),M=o.project(x,v),R=Math.min(E.x,T.x,S.x,M.x),L=Math.min(E.y,T.y,S.y,M.y),N=Math.max(E.x,T.x,S.x,M.x),$=Math.max(E.y,T.y,S.y,M.y),H=l/16;function j(Y,Q,pe,de,ue,De){let fe=(pe+ue)/2,Me=(de+De)/2,Fe=o.project(es(fe),Ho(Me)),Pe=Math.max(0,R-Fe.x,L-Fe.y,Fe.x-N,Fe.y-$);R=Math.min(R,Fe.x),N=Math.max(N,Fe.x),L=Math.min(L,Fe.y),$=Math.max($,Fe.y),Pe>H&&(j(Y,Fe,pe,de,fe,Me),j(Fe,Q,fe,Me,ue,De))}j(E,T,u,h,p,h),j(T,S,p,h,p,g),j(S,M,p,g,u,g),j(M,E,u,g,u,h),R-=H,L-=H,N+=H,$+=H;let q=1/Math.max(N-R,$-L);return{scale:q,x:R*q,y:L*q,x2:N*q,y2:$*q,projection:o}}function hL(d,{x:o,y:l},u=0){return new At(((o-u)*d.scale-d.x)*kt,(l*d.scale-d.y)*kt)}let q$=ce.mat4.identity(new Float32Array(16));class Bh{constructor(o){this.spec=o,this.name=o.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(o,l){return{x:0,y:0,z:0}}unproject(o,l){return new Sn(0,0)}projectTilePoint(o,l,u){return{x:o,y:l,z:0}}locationPoint(o,l,u,p=!0){return o._coordinatePoint(o.locationCoordinate(l,u),p)}pixelsPerMeter(o,l){return ea(1,o)*l}pixelSpaceConversion(o,l,u){return 1}farthestPixelDistance(o){return uL(o,o.pixelsPerMeter)}pointCoordinate(o,l,u,p){let h=o.horizonLineFromTop(!1),g=new At(l,Math.max(h,u));return o.rayIntersectionCoordinate(o.pointRayIntersection(g,p))}pointCoordinate3D(o,l,u){let p=new At(l,u);if(o.elevation)return o.elevation.pointCoordinate(p);{let h=this.pointCoordinate(o,p.x,p.y,0);return[h.x,h.y,h.z]}}isPointAboveHorizon(o,l){if(o.elevation&&o.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(o,l.x,l.y);let u=o.horizonLineFromTop();return l.y<u}createInversionMatrix(o,l){return q$}createTileMatrix(o,l,u){let p,h,g,x=u.canonical,C=ce.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){let D=b0(x,this);p=1,h=D.x+u.wrap*D.scale,g=D.y,ce.mat4.scale(C,C,[p/D.scale,p/D.scale,o.pixelsPerMeter/l])}else p=l/o.zoomScale(x.z),h=(x.x+Math.pow(2,x.z)*u.wrap)*p,g=x.y*p;return ce.mat4.translate(C,C,[h,g,0]),ce.mat4.scale(C,C,[p/kt,p/kt,1]),C}upVector(o,l,u){return[0,0,1]}upVectorScale(o,l,u){return{metersToTile:1}}}class W$ extends Bh{constructor(o){super(o),this.range=[4,7],this.center=o.center||[-96,37.5];let[l,u]=this.parallels=o.parallels||[29.5,45.5],p=Math.sin(Qi(l));this.n=(p+Math.sin(Qi(u)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(o,l){let{n:u,c:p,r0:h}=this,g=Qi(o-this.center[0]),x=Qi(l),C=Math.sqrt(p-2*u*Math.sin(x))/u;return{x:C*Math.sin(g*u),y:C*Math.cos(g*u)-h,z:0}}unproject(o,l){let{n:u,c:p,r0:h}=this,g=h+l,x=Math.atan2(o,Math.abs(g))*Math.sign(g);g*u<0&&(x-=Math.PI*Math.sign(o)*Math.sign(g));let C=Qi(this.center[0])*u;x=Os(x,-Math.PI-C,Math.PI-C);let D=qi(Ur(x/u)+this.center[0],-180,180),v=Math.asin(qi((p-(o*o+g*g)*u*u)/(2*u),-1,1)),E=qi(Ur(v),-Nr,Nr);return new Sn(D,E)}}let x0=1.340264,w0=-.081106,C0=893e-6,E0=.003796,c1=Math.sqrt(3)/2;class Y$ extends Bh{project(o,l){l=l/180*Math.PI,o=o/180*Math.PI;let u=Math.asin(c1*Math.sin(l)),p=u*u,h=p*p*p;return{x:.5*(o*Math.cos(u)/(c1*(x0+3*w0*p+h*(7*C0+9*E0*p)))/Math.PI+.5),y:1-.5*(u*(x0+w0*p+h*(C0+E0*p))/Math.PI+1),z:0}}unproject(o,l){o=(2*o-.5)*Math.PI;let u=l=(2*(1-l)-1)*Math.PI,p=u*u,h=p*p*p;for(let v,E,T,S=0;S<12&&(E=u*(x0+w0*p+h*(C0+E0*p))-l,T=x0+3*w0*p+h*(7*C0+9*E0*p),v=E/T,u=qi(u-v,-Math.PI/3,Math.PI/3),p=u*u,h=p*p*p,!(Math.abs(v)<1e-12));++S);let g=c1*o*(x0+3*w0*p+h*(7*C0+9*E0*p))/Math.cos(u),x=Math.asin(Math.sin(u)/c1),C=qi(180*g/Math.PI,-180,180),D=qi(180*x/Math.PI,-Nr,Nr);return new Sn(C,D)}}class Z$ extends Bh{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0}project(o,l){return{x:.5+o/360,y:.5-l/360,z:0}}unproject(o,l){let u=360*(o-.5),p=qi(360*(.5-l),-Nr,Nr);return new Sn(u,p)}}let Yg=Math.PI/2;function d1(d){return Math.tan((Yg+d)/2)}class X$ extends Bh{constructor(o){super(o),this.center=o.center||[0,30];let[l,u]=this.parallels=o.parallels||[30,30],p=Qi(l),h=Qi(u);this.southernCenter=p+h<0,this.southernCenter&&(p=-p,h=-h);let g=Math.cos(p),x=d1(p);this.n=p===h?Math.sin(p):Math.log(g/Math.cos(h))/Math.log(d1(h)/x),this.f=g*Math.pow(d1(p),this.n)/this.n}project(o,l){l=Qi(l),this.southernCenter&&(l=-l),o=Qi(o-this.center[0]);let u=1e-6,{n:p,f:h}=this;h>0?l<-Yg+u&&(l=-Yg+u):l>Yg-u&&(l=Yg-u);let g=h/Math.pow(d1(l),p),x=g*Math.sin(p*o),C=h-g*Math.cos(p*o);return x=.5*(x/Math.PI+.5),C=.5*(C/Math.PI+.5),{x,y:this.southernCenter?C:1-C,z:0}}unproject(o,l){o=(2*o-.5)*Math.PI,this.southernCenter&&(l=1-l),l=(2*(1-l)-.5)*Math.PI;let{n:u,f:p}=this,h=p-l,g=Math.sign(h),x=Math.sign(u)*Math.sqrt(o*o+h*h),C=Math.atan2(o,Math.abs(h))*g;h*u<0&&(C-=Math.PI*Math.sign(o)*g);let D=qi(Ur(C/u)+this.center[0],-180,180),v=qi(Ur(2*Math.atan(Math.pow(p/x,1/u))-Yg),-Nr,Nr);return new Sn(D,this.southernCenter?-v:v)}}class pL extends Bh{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(o,l){return{x:Ll(o),y:Ja(l),z:0}}unproject(o,l){let u=es(o),p=Ho(l);return new Sn(u,p)}}let fL=Qi(Nr);class K$ extends Bh{project(o,l){let u=(l=Qi(l))*l,p=u*u;return{x:.5*((o=Qi(o))*(.8707-.131979*u+p*(p*(.003971*u-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(l*(1.007226+u*(.015085+p*(.028874*u-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(o,l){o=(2*o-.5)*Math.PI;let u=l=(2*(1-l)-1)*Math.PI,p=25,h=0,g=u*u;do{g=u*u;let D=g*g;h=(u*(1.007226+g*(.015085+D*(.028874*g-.044475-.005916*D)))-l)/(1.007226+g*(.045255+D*(.259866*g-.311325-.005916*11*D))),u=qi(u-h,-fL,fL)}while(Math.abs(h)>1e-6&&--p>0);g=u*u;let x=qi(Ur(o/(.8707+g*(g*(g*g*g*(.003971-.001529*g)-.013791)-.131979))),-180,180),C=Ur(u);return new Sn(x,C)}}let mL=Qi(Nr);class Q$ extends Bh{project(o,l){l=Qi(l),o=Qi(o);let u=Math.cos(l),p=2/Math.PI,h=Math.acos(u*Math.cos(o/2)),g=Math.sin(h)/h,x=.5*(o*p+2*u*Math.sin(o/2)/g)||0,C=.5*(l+Math.sin(l)/g)||0;return{x:.5*(x/Math.PI+.5),y:1-.5*(C/Math.PI+1),z:0}}unproject(o,l){let u=o=(2*o-.5)*Math.PI,p=l=(2*(1-l)-1)*Math.PI,h=25,g=1e-6,x=0,C=0;do{let D=Math.cos(p),v=Math.sin(p),E=2*v*D,T=v*v,S=D*D,M=Math.cos(u/2),R=Math.sin(u/2),L=2*M*R,N=R*R,$=1-S*M*M,H=$?1/$:0,j=$?Math.acos(D*M)*Math.sqrt(1/$):0,q=.5*(2*j*D*R+2*u/Math.PI)-o,Y=.5*(j*v+p)-l,Q=.5*H*(S*N+j*D*M*T)+1/Math.PI,pe=H*(L*E/4-j*v*R),de=.125*H*(E*R-j*v*S*L),ue=.5*H*(T*M+j*N*D)+.5,De=pe*de-ue*Q;x=(Y*pe-q*ue)/De,C=(q*de-Y*Q)/De,u=qi(u-x,-Math.PI,Math.PI),p=qi(p-C,-mL,mL)}while((Math.abs(x)>g||Math.abs(C)>g)&&--h>0);return new Sn(Ur(u),Ur(p))}}class gL extends Bh{constructor(o){super(o),this.center=o.center||[0,0],this.parallels=o.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Qi(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(o,l){let{scale:u,cosPhi:p}=this;return{x:Qi(o)*p*u+.5,y:-Math.sin(Qi(l))/p*u+.5,z:0}}unproject(o,l){let{scale:u,cosPhi:p}=this,h=-(l-.5)/u,g=qi(Ur((o-.5)/u)/p,-180,180),x=Math.asin(qi(h*p,-1,1)),C=qi(Ur(x),-Nr,Nr);return new Sn(g,C)}}class J$ extends pL{constructor(o){super(o),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(o,l,u){let p=Mn(o,l,u),h=hr(po(u));return ce.vec3.transformMat4(p,p,h),{x:p[0],y:p[1],z:p[2]}}locationPoint(o,l,u){let p=uu(l.lat,l.lng),h=ce.vec3.normalize([],p),g=u?o._centerAltitude+u:o.elevation?o.elevation.getAtPointOrZero(o.locationCoordinate(l),o._centerAltitude):o._centerAltitude,x=ea(1,0)*kt*g;ce.vec3.scaleAndAdd(p,p,h,x);let C=ce.mat4.identity(new Float64Array(16));return ce.mat4.multiply(C,o.pixelMatrix,o.globeMatrix),ce.vec3.transformMat4(p,p,C),new At(p[0],p[1])}pixelsPerMeter(o,l){return ea(1,0)*l}pixelSpaceConversion(o,l,u){let p=ea(1,o)*l,h=yi(ea(1,45)*l,p,u);return this.pixelsPerMeter(o,l)/h}createTileMatrix(o,l,u){let p=fo(po(u.canonical));return ce.mat4.multiply(new Float64Array(16),o.globeMatrix,p)}createInversionMatrix(o,l){let{center:u}=o,p=hr(po(l));return ce.mat4.rotateY(p,p,Qi(u.lng)),ce.mat4.rotateX(p,p,Qi(u.lat)),ce.mat4.scale(p,p,[o._pixelsPerMercatorPixel,o._pixelsPerMercatorPixel,1]),Float32Array.from(p)}pointCoordinate(o,l,u,p){return _n(o,l,u,!0)||new a(0,0)}pointCoordinate3D(o,l,u){let p=this.pointCoordinate(o,l,u,0);return[p.x,p.y,p.z]}isPointAboveHorizon(o,l){return!_n(o,l.x,l.y,!1)}farthestPixelDistance(o){let l=function(p,h){let g=p.cameraToCenterDistance,x=p._centerAltitude*h,C=p._camera,D=p._camera.forward(),v=ce.vec3.add([],ce.vec3.scale([],D,-g),[0,0,x]),E=p.worldSize/(2*Math.PI),T=[0,0,-E],S=p.width/p.height,M=Math.tan(p.fovAboveCenter),R=ce.vec3.scale([],C.up(),M),L=ce.vec3.scale([],C.right(),M*S),N=ce.vec3.normalize([],ce.vec3.add([],ce.vec3.add([],D,R),L)),$=[],H;if(new vi(v,N).closestPointOnSphere(T,E,$)){let j=ce.vec3.add([],$,T),q=ce.vec3.sub([],j,v);H=Math.cos(p.fovAboveCenter)*ce.vec3.length(q)}else{let j=ce.vec3.sub([],v,T),q=ce.vec3.sub([],T,v);ce.vec3.normalize(q,q);let Y=ce.vec3.length(j)-E;H=Math.sqrt(Y*(Y+2*E));let Q=Math.acos(H/(E+Y))-Math.acos(ce.vec3.dot(D,q));H*=Math.cos(Q)}return 1.01*H}(o,this.pixelsPerMeter(o.center.lat,o.worldSize)),u=Ha(o.zoom);if(u>0){let p=uL(o,ea(1,o.center.lat)*o.worldSize),h=o.worldSize/(2*Math.PI),g=Math.max(o.width,o.height)/o.worldSize*Math.PI;return yi(l,p+h*(1-Math.cos(g)),Math.pow(u,10))}return l}upVector(o,l,u){return Mn(l,u,o,1)}upVectorScale(o){return{metersToTile:ln(Qn(po(o)))}}}function _L(d){let o=d.parallels,l=!!o&&Math.abs(o[0]+o[1])<.01;switch(d.name){case"mercator":return new pL(d);case"equirectangular":return new Z$(d);case"naturalEarth":return new K$(d);case"equalEarth":return new Y$(d);case"winkelTripel":return new Q$(d);case"albers":return l?new gL(d):new W$(d);case"lambertConformalConic":return l?new gL(d):new X$(d);case"globe":return new J$(d)}throw new Error(`Invalid projection name: ${d.name}`)}let eG=Fh.VectorTileFeature.types,tG=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function u1(d,o,l,u,p,h,g,x,C,D,v,E,T){let S=x?Math.min(zh,Math.round(x[0])):0,M=x?Math.min(zh,Math.round(x[1])):0;d.emplaceBack(o,l,Math.round(32*u),Math.round(32*p),h,g,(S<<1)+(C?1:0),M,16*D,16*v,256*E,256*T)}function h1(d,o,l){d.emplaceBack(o,l)}function p1(d,o,l,u,p,h,g){d.emplaceBack(o,l,u,p,h,g)}function f1(d,o,l,u,p){d.emplaceBack(o,l,u,p),d.emplaceBack(o,l,u,p),d.emplaceBack(o,l,u,p),d.emplaceBack(o,l,u,p)}function iG(d){for(let o of d.sections)if(Ew(o.text))return!0;return!1}class PT{constructor(o){this.layoutVertexArray=new Vv,this.indexArray=new Uo,this.programConfigurations=o,this.segments=new _r,this.dynamicLayoutVertexArray=new lu,this.opacityVertexArray=new Uv,this.placedSymbolArray=new Pw,this.iconTransitioningVertexArray=new fd,this.globeExtVertexArray=new jv,this.zOffsetVertexArray=new su}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(o,l,u,p,h){this.isEmpty()||(u&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,_$.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,v$.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,tG,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=o.createVertexBuffer(this.iconTransitioningVertexArray,x$.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,y$.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||h)&&(this.zOffsetVertexBuffer=o.createVertexBuffer(this.zOffsetVertexArray,b$.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||p)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}$t(PT,"SymbolBuffers");class OT{constructor(o,l,u){this.layoutVertexArray=new o,this.layoutAttributes=l,this.indexArray=new u,this.segments=new _r,this.collisionVertexArray=new Gv,this.collisionVertexArrayExt=new lu}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,w$.members,!0),this.collisionVertexBufferExt=o.createVertexBuffer(this.collisionVertexArrayExt,C$.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}$t(OT,"CollisionBuffers");class m1{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.lut=o.lut,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(g=>g.fqid),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ce.mat4.identity([]),this.placementViewportMatrix=ce.mat4.identity([]);let l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=wT(this.zoom,l["text-size"]),this.iconSizeData=wT(this.zoom,l["icon-size"]);let u=this.layers[0].layout,p=u.get("symbol-sort-key"),h=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=h!=="viewport-y"&&p.constantOr(1)!==void 0,this.sortFeaturesByY=(h==="viewport-y"||h==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(g=>Cs[g]),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=o.sourceID,this.projection=o.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new PT(new gd(this.layers,{zoom:this.zoom,lut:this.lut},o=>o.startsWith("text")||o.startsWith("symbol"))),this.icon=new PT(new gd(this.layers,{zoom:this.zoom,lut:this.lut},o=>o.startsWith("icon")||o.startsWith("symbol"))),this.glyphOffsetArray=new Lw,this.lineVertexArray=new Ef,this.symbolInstances=new Fw}calculateGlyphDependencies(o,l,u,p,h){for(let g of o){let x=g.codePointAt(0);if(x===void 0)break;if(l[x]=!0,p&&h&&x<=65535){let C=m0[g];C&&(l[C.charCodeAt(0)]=!0)}}}updateFootprints(o,l){}updateReplacement(o,l){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;let u=l.getReplacementRegionsForTile(o.toUnwrapped(),!0);return!mT(this.activeReplacements,u)&&(this.activeReplacements=u,!0)}populate(o,l,u,p){let h=this.layers[0],g=h.layout,x=this.projection.name==="globe",C=g.get("text-font"),D=g.get("text-field"),v=g.get("icon-image"),[E,T]=g.get("icon-size-scale-range"),S=qi(l.scaleFactor||1,E,T),M=(D.value.kind!=="constant"||D.value.value instanceof va&&!D.value.value.isEmpty()||D.value.value.toString().length>0)&&(C.value.kind!=="constant"||C.value.value.length>0),R=v.value.kind!=="constant"||!!v.value.value||Object.keys(v.parameters).length>0,L=g.get("symbol-sort-key");if(this.features=[],!M&&!R)return;let N=l.iconDependencies,$=l.glyphDependencies,H=l.availableImages,j=new ir(this.zoom);for(let{feature:q,id:Y,index:Q,sourceLayerIndex:pe}of o){let de=h._featureFilter.needGeometry,ue=F(q,de);if(!h._featureFilter.filter(j,ue,u))continue;if(de||(ue.geometry=O(q,u,p)),x&&q.type!==1&&u.z<=5){let Pe=ue.geometry,ze=.98078528056,Ne=(Ge,Ue)=>{let qe=Mn(Ge.x,Ge.y,u,1),gt=Mn(Ue.x,Ue.y,u,1);return ce.vec3.dot(qe,gt)<ze};for(let Ge=0;Ge<Pe.length;Ge++)Pe[Ge]=b(Pe[Ge],Ne)}let De,fe;if(M){let Pe=h.getValueAndResolveTokens("text-field",ue,u,H),ze=va.factory(Pe);iG(ze)&&(this.hasRTLText=!0),(!this.hasRTLText||Cg()==="unavailable"||this.hasRTLText&&Vs.isParsed())&&(De=D$(ze,h,ue))}if(R){let Pe=h.getValueAndResolveTokens("icon-image",ue,u,H);fe=Pe instanceof ba?Pe:ba.build(Pe)}if(!De&&!fe)continue;let Me=this.sortFeaturesByKey?L.evaluate(ue,{},u):void 0,Fe={id:Y,text:De,icon:fe,index:Q,sourceLayerIndex:pe,geometry:ue.geometry,properties:q.properties,type:eG[q.type],sortKey:Me};if(this.features.push(Fe),fe){let Pe=this.layers[0]._unevaluatedLayout._values,{iconPrimary:ze,iconSecondary:Ne}=sL(fe,this.iconSizeData,Pe["icon-size"],u,this.zoom,Fe,this.pixelRatio,S),Ge=ze.id.toString();if(N.has(Ge)?N.get(Ge).push(ze):N.set(Ge,[ze]),Ne){let Ue=Ne.id.toString();N.has(Ue)?N.get(Ue).push(Ne):N.set(Ue,[Ne])}}if(De){let Pe=C.evaluate(ue,{},u).join(","),ze=g.get("text-rotation-alignment")==="map"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Cs.vertical)>=0;for(let Ne of De.sections)if(Ne.image){let Ge=Ne.image.getPrimary().scaleSelf(this.pixelRatio),Ue=Ge.id.toString(),qe=N.get(Ue)||[];qe.push(Ge),N.set(Ue,qe)}else{let Ge=Dv(De.toString()),Ue=Ne.fontStack||Pe,qe=$[Ue]=$[Ue]||{};this.calculateGlyphDependencies(Ne.text,qe,ze,this.allowVerticalPlacement,Ge)}}}if(g.get("symbol-placement")==="line"&&(this.features=function(q){let Y={},Q={},pe=[],de=0;function ue(Fe){pe.push(q[Fe]),de++}function De(Fe,Pe,ze){let Ne=Q[Fe];return delete Q[Fe],Q[Pe]=Ne,pe[Ne].geometry[0].pop(),pe[Ne].geometry[0]=pe[Ne].geometry[0].concat(ze[0]),Ne}function fe(Fe,Pe,ze){let Ne=Y[Pe];return delete Y[Pe],Y[Fe]=Ne,pe[Ne].geometry[0].shift(),pe[Ne].geometry[0]=ze[0].concat(pe[Ne].geometry[0]),Ne}function Me(Fe,Pe,ze){let Ne=ze?Pe[0][Pe[0].length-1]:Pe[0][0];return`${Fe}:${Ne.x}:${Ne.y}`}for(let Fe=0;Fe<q.length;Fe++){let Pe=q[Fe],ze=Pe.geometry,Ne=Pe.text?Pe.text.toString():null;if(!Ne){ue(Fe);continue}let Ge=Me(Ne,ze),Ue=Me(Ne,ze,!0);if(Ge in Q&&Ue in Y&&Q[Ge]!==Y[Ue]){let qe=fe(Ge,Ue,ze),gt=De(Ge,Ue,pe[qe].geometry);delete Y[Ge],delete Q[Ue],Q[Me(Ne,pe[gt].geometry,!0)]=gt,pe[qe].geometry=null}else Ge in Q?De(Ge,Ue,ze):Ue in Y?fe(Ge,Ue,ze):(ue(Fe),Y[Ge]=de-1,Q[Ue]=de-1)}return pe.filter(Fe=>Fe.geometry)}(this.features)),g.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",l.elevationFeatures){!this.elevationFeatures&&l.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(let q of l.elevationFeatures)this.elevationFeatureIdToIndex.set(q.id,this.elevationFeatures.length),this.elevationFeatures.push(q)}}else g.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((q,Y)=>q.sortKey-Y.sortKey)}update(o,l,u,p,h,g,x){this.text.programConfigurations.updatePaintArrays(o,l,h,u,p,g,x),this.icon.programConfigurations.updatePaintArrays(o,l,h,u,p,g,x)}updateRoadElevation(){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let o=!1;for(let l=0;l<this.symbolInstances.length;l++){let u=this.symbolInstances.get(l);if(u.elevationFeatureIndex===65535)continue;let p=this.elevationFeatures[u.elevationFeatureIndex];if(p){let h=.05+p.pointElevation(new At(u.tileAnchorX,u.tileAnchorY));u.zOffset!==h&&(o=!0,u.zOffset=h)}}o&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){let o=(h,g,x)=>{u+=g,u>h.length&&h.resize(u);for(let C=-g;C<0;C++)h.emplace(C+u,x)},l=(h,g,x)=>{p+=g,p>h.length&&h.resize(p);for(let C=-g;C<0;C++)h.emplace(C+p,x)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let u=0,p=0;for(let h=0;h<this.symbolInstances.length;h++){let g=this.symbolInstances.get(h),{numHorizontalGlyphVertices:x,numVerticalGlyphVertices:C,numIconVertices:D}=g,v=g.zOffset,E=D>0;if((x>0||C>0)&&(o(this.text.zOffsetVertexArray,x,v),o(this.text.zOffsetVertexArray,C,v)),E){let{placedIconSymbolIndex:T,verticalPlacedIconSymbolIndex:S}=g;T>=0&&l(this.icon.zOffsetVertexArray,D,v),S>=0&&l(this.icon.zOffsetVertexArray,g.numVerticalIconVertices,v)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=_L(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,l){let u=this.lineVertexArray.length;if(o.segment!==void 0)for(let{x:p,y:h}of l)this.lineVertexArray.emplaceBack(p,h);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(o,l,u,p,h,g,x,C,D,v,E,T,S,M,R,L){let N=o.indexArray,$=o.layoutVertexArray,H=o.globeExtVertexArray,j=o.segments.prepareSegment(4*l.length,$,N,this.canOverlap?g.sortKey:void 0),q=this.glyphOffsetArray.length,Y=j.vertexLength,Q=this.allowVerticalPlacement&&x===Cs.vertical?Math.PI/2:0,pe=g.text&&g.text.sections;for(let ue=0;ue<l.length;ue++){let{tl:De,tr:fe,bl:Me,br:Fe,texPrimary:Pe,texSecondary:ze,pixelOffsetTL:Ne,pixelOffsetBR:Ge,minFontScaleX:Ue,minFontScaleY:qe,glyphOffset:gt,isSDF:ft,sectionIndex:Gt}=l[ue],wt=j.vertexLength,Rt=gt[1];if(u1($,D.x,D.y,De.x,Rt+De.y,Pe.x,Pe.y,u,ft,Ne.x,Ne.y,Ue,qe),u1($,D.x,D.y,fe.x,Rt+fe.y,Pe.x+Pe.w,Pe.y,u,ft,Ge.x,Ne.y,Ue,qe),u1($,D.x,D.y,Me.x,Rt+Me.y,Pe.x,Pe.y+Pe.h,u,ft,Ne.x,Ge.y,Ue,qe),u1($,D.x,D.y,Fe.x,Rt+Fe.y,Pe.x+Pe.w,Pe.y+Pe.h,u,ft,Ge.x,Ge.y,Ue,qe),C){let{x:yt,y:mi,z:jt}=C.anchor,[Jt,Ci,Wi]=C.up;p1(H,yt,mi,jt,Jt,Ci,Wi),p1(H,yt,mi,jt,Jt,Ci,Wi),p1(H,yt,mi,jt,Jt,Ci,Wi),p1(H,yt,mi,jt,Jt,Ci,Wi),f1(o.dynamicLayoutVertexArray,yt,mi,jt,Q)}else f1(o.dynamicLayoutVertexArray,D.x,D.y,D.z,Q);if(L){let yt=ze||Pe;h1(o.iconTransitioningVertexArray,yt.x,yt.y),h1(o.iconTransitioningVertexArray,yt.x+yt.w,yt.y),h1(o.iconTransitioningVertexArray,yt.x,yt.y+yt.h),h1(o.iconTransitioningVertexArray,yt.x+yt.w,yt.y+yt.h)}N.emplaceBack(wt,wt+1,wt+2),N.emplaceBack(wt+1,wt+2,wt+3),j.vertexLength+=4,j.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(gt[0]),ue!==l.length-1&&Gt===l[ue+1].sectionIndex||o.programConfigurations.populatePaintArrays($.length,g,g.index,{},S,M,R,pe&&pe[Gt])}let de=C?C.anchor:D;o.placedSymbolArray.emplaceBack(de.x,de.y,de.z,D.x,D.y,q,this.glyphOffsetArray.length-q,Y,v,E,D.segment,u?u[0]:0,u?u[1]:0,p[0],p[1],x,0,!1,0,T,0)}_commitLayoutVertex(o,l,u,p,h,g,x){o.emplaceBack(l,u,p,h,g,Math.round(x.x),Math.round(x.y))}_addCollisionDebugVertices(o,l,u,p,h,g,x){let C=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),D=C.vertexLength,v=x.tileAnchorX,E=x.tileAnchorY;for(let S=0;S<4;S++)u.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(u.collisionVertexArrayExt,l,o.padding,x.zOffset),this._commitLayoutVertex(u.layoutVertexArray,p,h,g,v,E,new At(o.x1,o.y1)),this._commitLayoutVertex(u.layoutVertexArray,p,h,g,v,E,new At(o.x2,o.y1)),this._commitLayoutVertex(u.layoutVertexArray,p,h,g,v,E,new At(o.x2,o.y2)),this._commitLayoutVertex(u.layoutVertexArray,p,h,g,v,E,new At(o.x1,o.y2)),C.vertexLength+=4;let T=u.indexArray;T.emplaceBack(D,D+1),T.emplaceBack(D+1,D+2),T.emplaceBack(D+2,D+3),T.emplaceBack(D+3,D),C.primitiveLength+=4}_addTextDebugCollisionBoxes(o,l,u,p,h,g){for(let x=p;x<h;x++){let C=u.get(x),D=this.getSymbolInstanceTextSize(o,g,l,x);this._addCollisionDebugVertices(C,D,this.textCollisionBox,C.projectedAnchorX,C.projectedAnchorY,C.projectedAnchorZ,g)}}_addIconDebugCollisionBoxes(o,l,u,p,h,g){for(let x=p;x<h;x++){let C=u.get(x),D=this.getSymbolInstanceIconSize(o,l,g.placedIconSymbolIndex);this._addCollisionDebugVertices(C,D,this.iconCollisionBox,C.projectedAnchorX,C.projectedAnchorY,C.projectedAnchorZ,g)}}generateCollisionDebugBuffers(o,l,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new OT(xf,PF.members,fd),this.iconCollisionBox=new OT(xf,PF.members,fd);let p=Hg(this.iconSizeData,o),h=Hg(this.textSizeData,o,u);for(let g=0;g<this.symbolInstances.length;g++){let x=this.symbolInstances.get(g);this._addTextDebugCollisionBoxes(h,o,l,x.textBoxStartIndex,x.textBoxEndIndex,x),this._addTextDebugCollisionBoxes(h,o,l,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._addIconDebugCollisionBoxes(p,o,l,x.iconBoxStartIndex,x.iconBoxEndIndex,x),this._addIconDebugCollisionBoxes(p,o,l,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x)}}getSymbolInstanceTextSize(o,l,u,p){let h=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:p),g=i1(this.textSizeData,o,h)/ia;return this.tilePixelRatio*g}getSymbolInstanceIconSize(o,l,u){let p=this.icon.placedSymbolArray.get(u),h=i1(this.iconSizeData,o,p);return this.tilePixelRatio*h}_commitDebugCollisionVertexUpdate(o,l,u,p){o.emplaceBack(l,-u,-u,p),o.emplaceBack(l,u,-u,p),o.emplaceBack(l,u,u,p),o.emplaceBack(l,-u,u,p)}_updateTextDebugCollisionBoxes(o,l,u,p,h,g,x){for(let C=p;C<h;C++){let D=u.get(C),v=this.getSymbolInstanceTextSize(o,g,l,C);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,v,D.padding,g.zOffset)}}_updateIconDebugCollisionBoxes(o,l,u,p,h,g,x){for(let C=p;C<h;C++){let D=u.get(C),v=this.getSymbolInstanceIconSize(o,l,g.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,v,D.padding,g.zOffset)}}updateCollisionDebugBuffers(o,l,u,p){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();let h=Hg(this.iconSizeData,o,p),g=Hg(this.textSizeData,o,u);for(let x=0;x<this.symbolInstances.length;x++){let C=this.symbolInstances.get(x);this._updateTextDebugCollisionBoxes(g,o,l,C.textBoxStartIndex,C.textBoxEndIndex,C,u),this._updateTextDebugCollisionBoxes(g,o,l,C.verticalTextBoxStartIndex,C.verticalTextBoxEndIndex,C,u),this._updateIconDebugCollisionBoxes(h,o,l,C.iconBoxStartIndex,C.iconBoxEndIndex,C,p),this._updateIconDebugCollisionBoxes(h,o,l,C.verticalIconBoxStartIndex,C.verticalIconBoxEndIndex,C,p)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(o,l,u,p,h,g,x,C,D){let v={};if(l<u){let{x1:E,y1:T,x2:S,y2:M,padding:R,projectedAnchorX:L,projectedAnchorY:N,projectedAnchorZ:$,tileAnchorX:H,tileAnchorY:j,featureIndex:q}=o.get(l);v.textBox={x1:E,y1:T,x2:S,y2:M,padding:R,projectedAnchorX:L,projectedAnchorY:N,projectedAnchorZ:$,tileAnchorX:H,tileAnchorY:j},v.textFeatureIndex=q}if(p<h){let{x1:E,y1:T,x2:S,y2:M,padding:R,projectedAnchorX:L,projectedAnchorY:N,projectedAnchorZ:$,tileAnchorX:H,tileAnchorY:j,featureIndex:q}=o.get(p);v.verticalTextBox={x1:E,y1:T,x2:S,y2:M,padding:R,projectedAnchorX:L,projectedAnchorY:N,projectedAnchorZ:$,tileAnchorX:H,tileAnchorY:j},v.verticalTextFeatureIndex=q}if(g<x){let{x1:E,y1:T,x2:S,y2:M,padding:R,projectedAnchorX:L,projectedAnchorY:N,projectedAnchorZ:$,tileAnchorX:H,tileAnchorY:j,featureIndex:q}=o.get(g);v.iconBox={x1:E,y1:T,x2:S,y2:M,padding:R,projectedAnchorX:L,projectedAnchorY:N,projectedAnchorZ:$,tileAnchorX:H,tileAnchorY:j},v.iconFeatureIndex=q}if(C<D){let{x1:E,y1:T,x2:S,y2:M,padding:R,projectedAnchorX:L,projectedAnchorY:N,projectedAnchorZ:$,tileAnchorX:H,tileAnchorY:j,featureIndex:q}=o.get(C);v.verticalIconBox={x1:E,y1:T,x2:S,y2:M,padding:R,projectedAnchorX:L,projectedAnchorY:N,projectedAnchorZ:$,tileAnchorX:H,tileAnchorY:j},v.verticalIconFeatureIndex=q}return v}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){let u=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(o,l){let u=o.placedSymbolArray.get(l),p=u.vertexStartIndex+4*u.numGlyphs;for(let h=u.vertexStartIndex;h<p;h+=4)o.indexArray.emplaceBack(h,h+1,h+2),o.indexArray.emplaceBack(h+1,h+2,h+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let l=Math.sin(o),u=Math.cos(o),p=[],h=[],g=[];for(let x=0;x<this.symbolInstances.length;++x){g.push(x);let C=this.symbolInstances.get(x);p.push(0|Math.round(l*C.tileAnchorX+u*C.tileAnchorY)),h.push(C.featureIndex)}return g.sort((x,C)=>p[x]-p[C]||h[C]-h[x]),g}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let o=0;o<this.symbolInstances.length;++o)this.symbolInstanceIndexesSortedZOffset.push(o)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((o,l)=>this.symbolInstances.get(l).zOffset-this.symbolInstances.get(o).zOffset)}addToSortKeyRanges(o,l){let u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===l?u.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let l of this.symbolInstanceIndexes){let u=this.symbolInstances.get(l);this.featureSortOrder.push(u.featureIndex);let{rightJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:h,leftJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:x,placedIconSymbolIndex:C,verticalPlacedIconSymbolIndex:D}=u;p>=0&&this.addIndicesForPlacedSymbol(this.text,p),h>=0&&h!==p&&this.addIndicesForPlacedSymbol(this.text,h),g>=0&&g!==h&&g!==p&&this.addIndicesForPlacedSymbol(this.text,g),x>=0&&this.addIndicesForPlacedSymbol(this.text,x),C>=0&&this.addIndicesForPlacedSymbol(this.icon,C),D>=0&&this.addIndicesForPlacedSymbol(this.icon,D)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let yL,vL,FT;$t(m1,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),m1.addDynamicAttributes=f1;class bL{constructor(o){this.type=o.property.overrides?o.property.overrides.runtimeType:Ju,this.defaultValue=o}evaluate(o){if(o.formattedSection){let l=this.defaultValue.property.overrides;if(l&&l.hasOverride(o.formattedSection))return l.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}$t(bL,"FormatSectionOverride",{omit:["defaultValue"]});let LT=()=>FT||(FT={layout:yL||(yL=new Sr({"symbol-placement":new It(We.layout_symbol["symbol-placement"]),"symbol-spacing":new It(We.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new It(We.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ht(We.layout_symbol["symbol-sort-key"]),"symbol-z-order":new It(We.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new It(We.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new It(We.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new It(We.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new It(We.layout_symbol["icon-ignore-placement"]),"icon-optional":new It(We.layout_symbol["icon-optional"]),"icon-rotation-alignment":new It(We.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ht(We.layout_symbol["icon-size"]),"icon-size-scale-range":new It(We.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new Ht(We.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ht(We.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ht(We.layout_symbol["icon-image"]),"icon-rotate":new Ht(We.layout_symbol["icon-rotate"]),"icon-padding":new It(We.layout_symbol["icon-padding"]),"icon-keep-upright":new It(We.layout_symbol["icon-keep-upright"]),"icon-offset":new Ht(We.layout_symbol["icon-offset"]),"icon-anchor":new Ht(We.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new It(We.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new It(We.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new It(We.layout_symbol["text-rotation-alignment"]),"text-field":new Ht(We.layout_symbol["text-field"]),"text-font":new Ht(We.layout_symbol["text-font"]),"text-size":new Ht(We.layout_symbol["text-size"]),"text-size-scale-range":new It(We.layout_symbol["text-size-scale-range"]),"text-max-width":new Ht(We.layout_symbol["text-max-width"]),"text-line-height":new Ht(We.layout_symbol["text-line-height"]),"text-letter-spacing":new Ht(We.layout_symbol["text-letter-spacing"]),"text-justify":new Ht(We.layout_symbol["text-justify"]),"text-radial-offset":new Ht(We.layout_symbol["text-radial-offset"]),"text-variable-anchor":new It(We.layout_symbol["text-variable-anchor"]),"text-anchor":new Ht(We.layout_symbol["text-anchor"]),"text-max-angle":new It(We.layout_symbol["text-max-angle"]),"text-writing-mode":new It(We.layout_symbol["text-writing-mode"]),"text-rotate":new Ht(We.layout_symbol["text-rotate"]),"text-padding":new It(We.layout_symbol["text-padding"]),"text-keep-upright":new It(We.layout_symbol["text-keep-upright"]),"text-transform":new Ht(We.layout_symbol["text-transform"]),"text-offset":new Ht(We.layout_symbol["text-offset"]),"text-allow-overlap":new It(We.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new It(We.layout_symbol["text-ignore-placement"]),"text-optional":new It(We.layout_symbol["text-optional"]),visibility:new It(We.layout_symbol.visibility)})),paint:vL||(vL=new Sr({"icon-opacity":new Ht(We.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Ht(We.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Ht(We.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Ht(We.paint_symbol["text-emissive-strength"]),"icon-color":new Ht(We.paint_symbol["icon-color"]),"icon-halo-color":new Ht(We.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ht(We.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ht(We.paint_symbol["icon-halo-blur"]),"icon-translate":new It(We.paint_symbol["icon-translate"]),"icon-translate-anchor":new It(We.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Ht(We.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Ht(We.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Ht(We.paint_symbol["text-occlusion-opacity"]),"text-color":new Ht(We.paint_symbol["text-color"],{runtimeType:ya,getOverride:d=>d.textColor,hasOverride:d=>!!d.textColor}),"text-halo-color":new Ht(We.paint_symbol["text-halo-color"]),"text-halo-width":new Ht(We.paint_symbol["text-halo-width"]),"text-halo-blur":new Ht(We.paint_symbol["text-halo-blur"]),"text-translate":new It(We.paint_symbol["text-translate"]),"text-translate-anchor":new It(We.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new It(We.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new It(We.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new It(We.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new It(We.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new Ht(We.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},FT);class g1 extends Po{constructor(o,l,u,p){super(o,LT(),l,u,p),this._colorAdjustmentMatrix=ce.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=o.paint!==void 0&&("icon-occlusion-opacity"in o.paint||"text-occlusion-opacity"in o.paint)}recalculate(o,l){super.recalculate(o,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));let u=this.layout.get("text-writing-mode");if(u){let p=[];for(let h of u)p.indexOf(h)<0&&p.push(h);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(o,l,u,p){return this._saturation===o&&this._contrast===l&&this._brightnessMin===u&&this._brightnessMax===p||(this._colorAdjustmentMatrix=function(h,g,x,C){h=nt(h),g=Xp(g);let D=ce.mat4.create(),v=h/3,E=1-2*v,T=[E,v,v,0,v,E,v,0,v,v,E,0,0,0,0,1],S=.5-.5*g,M=C-x;return ce.mat4.multiply(D,[M,0,0,0,0,M,0,0,0,0,M,0,x,x,x,1],[g,0,0,0,0,g,0,0,0,0,g,0,S,S,S,1]),ce.mat4.multiply(D,D,T),D}(o,l,u,p),this._saturation=o,this._contrast=l,this._brightnessMin=u,this._brightnessMax=p),this._colorAdjustmentMatrix}getValueAndResolveTokens(o,l,u,p){let h=this.layout.get(o).evaluate(l,{},u,p),g=this._unevaluatedLayout._values[o];return g.isDataDriven()||mg(g.value)||!h?h:function(x,C){return C.replace(/{([^{}]+)}/g,(D,v)=>v in x?String(x[v]):"")}(l.properties,h)}createBucket(o){return new m1(o)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(let o of LT().paint.overridableProperties){if(!g1.hasPaintOverride(this.layout,o))continue;let l=this.paint.get(o),u=new bL(l),p=new xv(u,l.property.specification,this.scope,this.options),h=null;h=l.value.kind==="constant"||l.value.kind==="source"?new wv("source",p):new _h("composite",p,l.value.zoomStops,l.value._interpolationType),this.paint._values[o]=new wh(l.property,h,l.parameters)}}_handleOverridablePaintPropertyUpdate(o,l,u){return!(!this.layout||l.isDataDriven()||u.isDataDriven())&&g1.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,l){let u=o.get("text-field"),p=LT().paint.properties[l],h=!1,g=x=>{for(let C of x)if(p.overrides&&p.overrides.hasOverride(C))return void(h=!0)};if(u.value.kind==="constant"&&u.value.value instanceof va)g(u.value.value.sections);else if(u.value.kind==="source"){let x=D=>{h||(D instanceof pc&&oo(D.value)===Jp?g(D.value.sections):D instanceof nh?g(D.sections):D.eachChild(x))},C=u.value;C._styleExpression&&x(C._styleExpression.expression)}return h}getProgramIds(){return["symbol"]}getDefaultProgramParams(o,l,u){return{config:new du(this,{zoom:l,lut:u}),overrideFog:!1}}}let xL,wL,CL,EL;var NT=En([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function zT(d){switch(d){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function BT(d){switch(d){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class VT{constructor(o,l,u,p){this.context=o,this.format=u,this.useMipmap=p&&p.useMipmap,this.texture=o.gl.createTexture(),this.update(l,{premultiply:p&&p.premultiply})}update(o,l){let u=o&&o instanceof HTMLVideoElement&&o.width===0?o.videoWidth:o.width,p=o&&o instanceof HTMLVideoElement&&o.height===0?o.videoHeight:o.height,{context:h}=this,{gl:g}=h,{x,y:C}=l&&l.position?l.position:{x:0,y:0},D=x+u,v=C+p;!this.size||this.size[0]===D&&this.size[1]===v||(g.bindTexture(g.TEXTURE_2D,null),g.deleteTexture(this.texture),this.texture=g.createTexture(),this.size=null),g.bindTexture(g.TEXTURE_2D,this.texture),h.pixelStoreUnpackFlipY.set(!1),h.pixelStoreUnpack.set(1),h.pixelStoreUnpackPremultiplyAlpha.set(this.format===g.RGBA8&&(!l||l.premultiply!==!1));let E=o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||ImageBitmap&&o instanceof ImageBitmap;if(!this.size&&D>0&&v>0){let T=this.useMipmap?Math.floor(Math.log2(Math.max(D,v)))+1:1;g.texStorage2D(g.TEXTURE_2D,T,this.format,D,v),this.size=[D,v]}if(this.size)if(E)g.texSubImage2D(g.TEXTURE_2D,0,x,C,zT(this.format),BT(this.format),o);else{let T=o.data;T&&g.texSubImage2D(g.TEXTURE_2D,0,x,C,u,p,zT(this.format),BT(this.format),T)}this.useMipmap&&g.generateMipmap(g.TEXTURE_2D)}bind(o,l,u=!1){let{context:p}=this,{gl:h}=p;h.bindTexture(h.TEXTURE_2D,this.texture),o!==this.minFilter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,o),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap&&!u?o===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_LINEAR:o),this.minFilter=o),l!==this.wrapS&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,l),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,l),this.wrapS=l)}bindExtraParam(o,l,u,p){let{context:h}=this,{gl:g}=h;g.bindTexture(g.TEXTURE_2D,this.texture),l!==this.magFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,l),this.magFilter=l),o!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,this.useMipmap?o===g.NEAREST?g.NEAREST_MIPMAP_NEAREST:g.LINEAR_MIPMAP_LINEAR:o),this.minFilter=o),u!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,u),this.wrapS=u),p!==this.wrapT&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,p),this.wrapT=p)}destroy(){let{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}class _1{constructor(o,l){this.context=o,this.texture=l}bind(o,l){let{context:u}=this,{gl:p}=u;p.bindTexture(p.TEXTURE_2D,this.texture),o!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,o),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,o),this.minFilter=o),l!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,l),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,l),this.wrapS=l)}}function y1(d,o,l,u,p,h,g,x){let C=[d,o,1,l,u,1,p,h,1],D=[g,x,1],v=ce.mat3.adjoint([],C),[E,T,S]=ce.vec3.transformMat3(D,D,v);return ce.mat3.multiply(C,C,[E,0,0,0,T,0,0,0,S])}function SL(d,o,l,u,p,h,g,x){let C=function(D,v,E,T,S,M,R,L){let N=y1(0,0,1,0,1,1,0,1),$=y1(D,v,E,T,S,M,R,L),H=ce.mat3.adjoint([],N);return ce.mat3.multiply($,$,H)}(d,o,l,u,p,h,g,x);return[C[2]/C[8]/kt,C[5]/C[8]/kt]}function v1(d){return[d[0],Math.min(Math.max(d[1],-Nr),Nr)]}class DL extends hl{constructor(o,l,u,p){super(),this.id=o,this.dispatcher=u,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(p),this.options=l,this._dirty=!1}load(o,l){if(this._loaded=l||!1,this.fire(new Xa("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return o&&(this.coordinates=o),this._loaded=!0,void this._finishLoading();this._imageRequest=Hy(this.map._requestManager.transformRequest(this.url,Ro.Image),(u,p)=>{this._imageRequest=null,this._loaded=!0,u?this.fire(new Qu(u)):p&&(this.image=p instanceof HTMLImageElement?it.getImageData(p):p,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),this._finishLoading())})}loaded(){return this._loaded}updateImage(o){return o.url?(this._imageRequest&&o.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=o.url,this.load(o.coordinates,this._loaded),this):this}setTexture(o){if(!(o.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new _1(this.map.painter.context,o.handle),this.width=o.dimensions[0],this.height=o.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Xa("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(o){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof _1||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(o){if(this.coordinates=o,this._boundsArray=void 0,this._unsupportedCoords=!1,!o.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let l=o[0][1],u=o[0][1];for(let h of o)h[1]>u&&(u=h[1]),h[1]<l&&(l=h[1]);let p=(u+l)/2;if(p>Nr?this.onNorthPole=!0:p<-Nr&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){let h=o.map(a.fromLngLat);this.tileID=function(g){let x=1/0,C=1/0,D=-1/0,v=-1/0;for(let R of g)x=Math.min(x,R.x),C=Math.min(C,R.y),D=Math.max(D,R.x),v=Math.max(v,R.y);let E=Math.max(D-x,v-C),T=Math.max(0,Math.floor(-Math.log(E)/Math.LN2)),S=Math.pow(2,T),M=Math.floor((x+D)/2*S);return M>1&&(M-=1),new ht(T,M,Math.floor((C+v)/2*S))}(h),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Xa("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(o){for(let N in this.tiles){let $=this.tiles[N];$.state!=="loaded"&&($.state="loaded",$.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;let l=b0(new ht(0,0,0),this.map.transform.projection),u=[l.projection.project(this.coordinates[0][0],this.coordinates[0][1]),l.projection.project(this.coordinates[1][0],this.coordinates[1][1]),l.projection.project(this.coordinates[2][0],this.coordinates[2][1]),l.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(N){let $=N[1].x-N[0].x,H=N[1].y-N[0].y,j=N[2].x-N[1].x,q=N[2].y-N[1].y,Y=N[3].x-N[2].x,Q=N[3].y-N[2].y,pe=N[0].x-N[3].x,de=N[0].y-N[3].y,ue=$*q-j*H,De=j*Q-Y*q,fe=Y*de-pe*Q,Me=pe*H-$*de;return ue>0&&De>0&&fe>0&&Me>0||ue<0&&De<0&&fe<0&&Me<0}(u))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);let p=b0(this.tileID,this.map.transform.projection),[h,g,x,C]=this.coordinates.map(N=>{let $=p.projection.project(N[0],N[1]);return hL(p,$)._round()});this.perspectiveTransform=SL(h.x,h.y,g.x,g.y,x.x,x.y,C.x,C.y);let D=this._boundsArray=new Cc;D.emplaceBack(h.x,h.y,0,0),D.emplaceBack(g.x,g.y,kt,0),D.emplaceBack(C.x,C.y,0,kt),D.emplaceBack(x.x,x.y,kt,kt),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=o.createVertexBuffer(D,NT.members),this.boundsSegments=_r.simpleSegment(0,0,4,2);let v=[],E=[v1((T=this.coordinates)[0]),v1(T[1]),v1(T[2]),v1(T[3])];var T;let[S,M,R,L]=function(N){let $=N[0][0],H=$,j=N[0][1],q=j;for(let Y=1;Y<N.length;Y++)N[Y][0]<$?$=N[Y][0]:N[Y][0]>H&&(H=N[Y][0]),N[Y][1]<j?j=N[Y][1]:N[Y][1]>q&&(q=N[Y][1]);return[$,j,H-$,q-j]}(E);{let N=new Cc,[$,H,j,q]=function(Ne){let Ge=Ne[0].x,Ue=Ge,qe=Ne[0].y,gt=qe;for(let ft=1;ft<Ne.length;ft++)Ne[ft].x<Ge?Ge=Ne[ft].x:Ne[ft].x>Ue&&(Ue=Ne[ft].x),Ne[ft].y<qe?qe=Ne[ft].y:Ne[ft].y>gt&&(gt=Ne[ft].y);return[Ge,qe,Ue-Ge,gt-qe]}(u),Y=Ne=>[(Ne.x-$)/j,(Ne.y-H)/q],[Q,pe,de,ue]=u.map(Y),De=function(Ne,Ge,Ue,qe,gt,ft,Gt,wt){let Rt=y1(0,0,1,0,1,1,0,1),yt=y1(Ne,Ge,Ue,qe,gt,ft,Gt,wt),mi=ce.mat3.adjoint([],yt);return ce.mat3.multiply(Rt,Rt,mi)}(Q[0],Q[1],pe[0],pe[1],de[0],de[1],ue[0],ue[1]);this.elevatedGlobePerspectiveTransform=SL(Q[0],Q[1],pe[0],pe[1],de[0],de[1],ue[0],ue[1]);let fe=(Ne,Ge)=>{v.push(Ne.lng);let Ue=Math.round((Ne.lng-S)/R*kt),qe=Math.round((Ne.lat-M)/L*kt),gt=Y(Ge),ft=ce.vec3.transformMat3([],[gt[0],gt[1],1],De),Gt=Math.round(ft[0]/ft[2]*kt),wt=Math.round(ft[1]/ft[2]*kt);N.emplaceBack(Ue,qe,Gt,wt)},Me=u[3].x-u[0].x,Fe=u[3].y-u[0].y,Pe=u[2].x-u[1].x,ze=u[2].y-u[1].y;for(let Ne=0;Ne<65;Ne++){let Ge=Ne/64,Ue=[u[0].x+Ge*Me,u[0].y+Ge*Fe],qe=[u[1].x+Ge*Pe,u[1].y+Ge*ze],gt=qe[0]-Ue[0],ft=qe[1]-Ue[1];for(let Gt=0;Gt<65;Gt++){let wt=Gt/64,Rt={x:Ue[0]+gt*wt,y:Ue[1]+ft*wt,z:0};fe(l.projection.unproject(Rt.x,Rt.y),Rt)}}this.elevatedGlobeVertexBuffer=o.createVertexBuffer(N,NT.members)}{this.maxLongitudeTriangleSize=0;let N=[],$=new Uo,H=(j,q,Y)=>{$.emplaceBack(j,q,Y);let Q=v[j],pe=v[q],de=v[Y],ue=Math.min(Math.min(Q,pe),de),De=Math.max(Math.max(Q,pe),de)-ue;De>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=De),N.push(ue+De/2)};for(let j=0;j<64;j++)for(let q=0;q<64;q++){let Y=65*j+q,Q=Y+1,pe=Y+65,de=pe+1;H(Y,pe,Q),H(Q,pe,de)}[N,$]=function(j,q){let Y=Array.from({length:j.length},(de,ue)=>ue);Y.sort((de,ue)=>j[de]-j[ue]);let Q=[],pe=new Uo;for(let de=0;de<Y.length;de++){let ue=Y[de];Q.push(j[ue]);let De=3*ue,fe=De+1;pe.emplaceBack(q.uint16[De],q.uint16[fe],q.uint16[fe+1])}return[Q,pe]}(N,$),this.elevatedGlobeTrianglesCenterLongitudes=N,this.elevatedGlobeIndexBuffer=o.createIndexBuffer($)}this.elevatedGlobeSegments=_r.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,R/kt,0,L/kt,0,0,M,S,0])}prepare(){let o=Object.keys(this.tiles).length!==0;if(this.tileID&&!o)return;let l=this.map.painter.context,u=l.gl;!this._dirty||this.texture instanceof _1||(this.texture?this.texture.update(this.image):(this.texture=new VT(l,this.image,u.RGBA8),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),o&&this._prepareData(l)}loadTile(o,l){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},l(null)):(o.state="errored",l(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(o){let l=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!l)return null;let u=this.elevatedGlobeTrianglesCenterLongitudes,p=(h=o+180)+360*Math.round((u[0]-h)/360);var h;let g=new _r,x=(E,T)=>{g.segments.push({vertexOffset:0,primitiveOffset:E,vertexLength:l.segments[0].vertexLength,primitiveLength:T,sortKey:void 0,vaos:{}})},C=.51*this.maxLongitudeTriangleSize;if(Math.abs(u[0]-p)<=C){let E=Gm(u,0,u.length,p+C);return E===u.length||x(E,$m(u,E+1,u.length,p+360-C)-E),g}p<u[0]&&(p+=360);let D=$m(u,0,u.length,p-C);if(D===u.length)return x(0,u.length),g;x(0,D-0);let v=Gm(u,D+1,u.length,p+C);return v!==u.length&&x(v,u.length-v),g}}let nG=(Math.pow(256,2)-1)/16907520;class ML extends Po{constructor(o,l,u,p){super(o,{layout:CL||(CL=new Sr({visibility:new It(We.layout_raster.visibility)})),paint:EL||(EL=new Sr({"raster-opacity":new It(We.paint_raster["raster-opacity"]),"raster-color":new Eh(We.paint_raster["raster-color"]),"raster-color-mix":new It(We.paint_raster["raster-color-mix"]),"raster-color-range":new It(We.paint_raster["raster-color-range"]),"raster-hue-rotate":new It(We.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new It(We.paint_raster["raster-brightness-min"]),"raster-brightness-max":new It(We.paint_raster["raster-brightness-max"]),"raster-saturation":new It(We.paint_raster["raster-saturation"]),"raster-contrast":new It(We.paint_raster["raster-contrast"]),"raster-resampling":new It(We.paint_raster["raster-resampling"]),"raster-fade-duration":new It(We.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new It(We.paint_raster["raster-emissive-strength"]),"raster-array-band":new It(We.paint_raster["raster-array-band"]),"raster-elevation":new It(We.paint_raster["raster-elevation"]),"raster-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},l,u,p),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(o){return!(o&&o._source instanceof DL&&(o._source.onNorthPole||o._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(o){o!=="raster-color"&&o!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(o){if(!this.hasColorMap()||!this._curRampRange)return;let l=this._transitionablePaint._values["raster-color"].value.expression,[u,p]=o||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(u)&&isNaN(p)||u===this._curRampRange[0]&&p===this._curRampRange[1]||(this.colorRamp=o0({expression:l,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:u,end:p}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[u,p])}}let TL,IL,AL,RL,kL;class PL extends Po{constructor(o,l,u,p){super(o,{layout:TL||(TL=new Sr({visibility:new It(We["layout_raster-particle"].visibility)})),paint:IL||(IL=new Sr({"raster-particle-array-band":new It(We["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new It(We["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Eh(We["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new It(We["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new It(We["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new It(We["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new It(We["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new It(We["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},l,u,p),this._updateColorRamp(),this.lastInvalidatedAt=it.now()}onRemove(o){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(o){return!1}_handleSpecialPaintPropertyUpdate(o){o!=="raster-particle-color"&&o!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),o==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;let o=this._transitionablePaint._values["raster-particle-color"].value.expression,l=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=o0({expression:o,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:l}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=it.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class rG extends Po{constructor(o,l){super(o,{},l,null),this.implementation=o,o.slot&&(this.slot=o.slot)}is3D(o){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(o){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(o){this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)}onRemove(o){this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)}}function jT(d,o,l){let u=[0,0,1],p=ce.quat.identity([]);return ce.quat.rotateY(p,p,l?-Qi(d)+Math.PI:Qi(d)),ce.quat.rotateX(p,p,-Qi(o)),ce.vec3.transformQuat(u,u,p),ce.vec3.normalize(u,u)}function OL(d,o){let l=b1(d.projection,d.zoom,d.width,d.height),u=function(h,g,x,C,D){let v=new Sn(x.lng-180*Vh,x.lat),E=new Sn(x.lng+180*Vh,x.lat),T=h.project(v.lng,v.lat),S=h.project(E.lng,E.lat),M=-Math.atan2(S.y-T.y,S.x-T.x),R=a.fromLngLat(x);R.y=qi(R.y,-1+Vh,1-Vh);let L=R.toLngLat(),N=h.project(L.lng,L.lat),$=a.fromLngLat(L);$.x+=Vh;let H=$.toLngLat(),j=h.project(H.lng,H.lat),q=LL(j.x-N.x,j.y-N.y,M),Y=a.fromLngLat(L);Y.y+=Vh;let Q=Y.toLngLat(),pe=h.project(Q.lng,Q.lat),de=LL(pe.x-N.x,pe.y-N.y,M),ue=Math.abs(q.x)/Math.abs(de.y),De=ce.mat4.identity([]);ce.mat4.rotateZ(De,De,-M*(1-(D?0:C)));let fe=ce.mat4.identity([]);return ce.mat4.scale(fe,fe,[1,1-(1-ue)*C,1]),fe[4]=-de.x/de.y*C,ce.mat4.rotateZ(fe,fe,M),ce.mat4.multiply(fe,De,fe),fe}(d.projection,0,d.center,l,o),p=FL(d);return ce.mat4.scale(u,u,[p,p,1]),u}function FL(d){let o=d.projection,l=b1(d.projection,d.zoom,d.width,d.height),u=UT(o,d.center),p=UT(o,Sn.convert(o.center));return Math.pow(2,u*l+(1-l)*p)}function b1(d,o,l,u,p=1/0){let h=d.range;if(!h)return 0;let g=Math.min(p,Math.max(l,u)),x=Math.log(g/1024)/Math.LN2;return Vo(h[0]+x,h[1]+x,o)}let Vh=1/4e4;function UT(d,o){let l=qi(o.lat,-Nr,Nr),u=new Sn(o.lng-180*Vh,l),p=new Sn(o.lng+180*Vh,l),h=d.project(u.lng,l),g=d.project(p.lng,l),x=a.fromLngLat(u),C=a.fromLngLat(p),D=g.x-h.x,v=g.y-h.y,E=C.x-x.x,T=C.y-x.y,S=Math.sqrt((E*E+T*T)/(D*D+v*v));return Math.log(S)/Math.LN2}function LL(d,o,l){let u=Math.cos(l),p=Math.sin(l);return{x:d*u-o*p,y:d*p+o*u}}function NL(d,o,l){ce.mat4.identity(d),ce.mat4.rotateZ(d,d,Qi(o[2])),ce.mat4.rotateX(d,d,Qi(o[0])),ce.mat4.rotateY(d,d,Qi(o[1])),ce.mat4.scale(d,d,l),ce.mat4.multiply(d,d,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function x1(d,o,l,u,p,h,g,x){let C=[l[0]-o[0],l[1]-o[1],0],D=[u[0]-o[0],u[1]-o[1],0];if(ce.vec3.length(C)<1e-12||ce.vec3.length(D)<1e-12)return ce.quat.identity(d);let v=ce.vec3.cross([],C,D);ce.vec3.normalize(v,v),ce.vec3.subtract(D,u,o),C[2]=(h-p)*x,D[2]=(g-p)*x;let E=C;return ce.vec3.cross(E,C,D),ce.vec3.normalize(E,E),ce.quat.rotationTo(d,v,E)}function HT(d,o,l=!1){let u=Ha(o.zoom),p=function(h,g,x){let C=g.worldSize,D=[h[12],h[13],h[14]],v=Ho(D[1]/C),E=es(D[0]/C),T=ce.mat4.identity([]),S=ea(1,v)*C,M=ea(1,0)*C*yd(v,g.zoom),R=1/Nl(C),L=M*R;if(x){let j=b1(g.projection,g.zoom,g.width,g.height,1024);L=R*g.projection.pixelSpaceConversion(g.center.lat,C,j)}let N=uu(v,E);ce.vec3.add(N,N,ce.vec3.scale([],ce.vec3.normalize([],N),S*L*D[2]));let $=function(j){let q=[j[0],j[1],j[2]],Y=[0,1,0],Q=ce.vec3.cross([],Y,q);return ce.vec3.cross(Y,q,Q),ce.vec3.squaredLength(Y)===0&&(Y=[0,1,0],ce.vec3.cross(Q,q,Y)),ce.vec3.normalize(Q,Q),ce.vec3.normalize(Y,Y),ce.vec3.normalize(q,q),[Q[0],Q[1],Q[2],0,Y[0],Y[1],Y[2],0,q[0],q[1],q[2],0,j[0],j[1],j[2],1]}(N);ce.mat4.scale(T,T,[L,L,L*S]),ce.mat4.translate(T,T,[-D[0],-D[1],-D[2]]);let H=ce.mat4.multiply([],g.globeMatrix,$);return ce.mat4.multiply(H,H,T),ce.mat4.multiply(H,H,h),H}(d,o,l);if(u>0){let h=function(g,x){let C=x.worldSize,D=ea(1,0)*C*yd(x.center.lat,x.zoom)/Nl(C),v=ea(1,x.center.lat)*C,E=ce.mat4.identity([]);return ce.mat4.rotateY(E,E,Qi(x.center.lng)),ce.mat4.rotateX(E,E,Qi(x.center.lat)),ce.mat4.translate(E,E,[0,0,Na]),ce.mat4.scale(E,E,[D,D,D*v]),ce.mat4.translate(E,E,[x.point.x-.5*C,x.point.y-.5*C,0]),ce.mat4.multiply(E,E,g),ce.mat4.multiply(E,x.globeMatrix,E)}(d,o);return function(g,x,C){let D=(M,R,L)=>{let N=ce.vec3.length(M),$=ce.vec3.length(R),H=Co(M,R,L);return ce.vec3.scale(H,H,1/ce.vec3.length(H)*yi(N,$,L))},v=D([g[0],g[1],g[2]],[x[0],x[1],x[2]],C),E=D([g[4],g[5],g[6]],[x[4],x[5],x[6]],C),T=D([g[8],g[9],g[10]],[x[8],x[9],x[10]],C),S=Co([g[12],g[13],g[14]],[x[12],x[13],x[14]],C);return[v[0],v[1],v[2],0,E[0],E[1],E[2],0,T[0],T[1],T[2],0,S[0],S[1],S[2],1]}(p,h,u)}return p}function zL(d,o,l,u){let p=ti.projectAabbCorners(u,l),h=Number.MAX_VALUE,g=-1;for(let D=0;D<p.length;++D){let v=p[D];v[0]=(.5*v[0]+.5)*o.width,v[1]=(.5-.5*v[1])*o.height,v[2]<h&&(g=D,h=v[2])}let x=D=>new At(p[D][0],p[D][1]),C;switch(g){case 0:case 6:C=[x(1),x(5),x(4),x(7),x(3),x(2),x(1)];break;case 1:case 7:C=[x(0),x(4),x(5),x(6),x(2),x(3),x(0)];break;case 3:case 5:C=[x(1),x(0),x(4),x(7),x(6),x(2),x(1)];break;default:C=[x(1),x(5),x(6),x(7),x(3),x(0),x(1)]}if(K(d,C))return h}let oG=En([{name:"a_pos_3f",components:3,type:"Float32"}]),aG=En([{name:"a_color_3f",components:3,type:"Float32"}]),sG=En([{name:"a_color_4f",components:4,type:"Float32"}]),lG=En([{name:"a_uv_2f",components:2,type:"Float32"}]),cG=En([{name:"a_normal_3f",components:3,type:"Float32"}]),dG=En([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),uG=En([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),BL={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class w1{constructor(o,l,u,p){this.message=(o?`${o}: `:"")+u,p&&(this.identifier=p),l!=null&&l.__line__&&(this.line=l.__line__)}}function VL(d,o){let l=d.indexOf("://")===-1;try{return new URL(d,l&&o?"http://example.com":void 0),!0}catch{return!1}}class jL{constructor(o,l){this.feature=o,this.instancedDataOffset=l,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class UL{constructor(){this.instancedDataArray=new Og,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class $T{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.projection=o.projection,this.index=o.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(o,l){}populate(o,l,u,p){this.tileToMeter=m(u);let h=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(let{feature:g,id:x,index:C,sourceLayerIndex:D}of o){let v=x??(g.properties&&g.properties.hasOwnProperty("id")?g.properties.id:void 0),E=F(g,h);if(!this.layers[0]._featureFilter.filter(new ir(this.zoom),E,u))continue;let T={id:v,sourceLayerIndex:D,index:C,geometry:h?E.geometry:O(g,u,p),properties:g.properties,type:g.type,patterns:{}},S=this.addFeature(T,T.geometry,E);S&&l.featureIndex.insert(g,T.geometry,C,D,this.index,this.instancesPerModel[S].instancedDataArray.length,kt/32)}this.lookup=null}update(o,l,u,p){for(let h in this.instancesPerModel){let g=this.instancesPerModel[h];for(let x in o)g.idToFeaturesIndex.hasOwnProperty(x)&&(this.evaluate(g.features[g.idToFeaturesIndex[x]],o[x],g,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let o=!1;for(let l in this.instancesPerModel){let u=this.instancesPerModel[l];for(let p of u.features){let h=this.layers[0],g=p.feature,x=this.canonical,C=h.paint.get("model-rotation").evaluate(g,{},x),D=h.paint.get("model-scale").evaluate(g,{},x),v=h.paint.get("model-translation").evaluate(g,{},x);ce.vec3.exactEquals(p.rotation,C)&&ce.vec3.exactEquals(p.scale,D)&&ce.vec3.exactEquals(p.translation,v)||(this.evaluate(p,p.featureStates,u,!0),o=!0)}}return o}updateReplacement(o,l,u,p){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;let h=l.getReplacementRegionsForTile(o.toUnwrapped(),!0);if(mT(this.activeReplacements,h))return!1;this.activeReplacements=h;let g=!1;for(let x in this.instancesPerModel){let C=this.instancesPerModel[x],D=C.instancedDataArray;for(let v of C.features){let E=v.instancedDataOffset,T=v.instancedDataCount;for(let S=0;S<T;S++){let M=16*(S+E),R=D.float32[M+0],L=R>kt;R=L?R-kt:R;let N=Math.floor(R),$=D.float32[M+1],H=!1;for(let j of this.activeReplacements)if(!KO(j,u,BL.Model,p)&&!(j.min.x>N||N>j.max.x||j.min.y>$||$>j.max.y)&&(H=nF(iF(N,$,o.canonical,j.footprintTileId.canonical),j.footprint),H))break;D.float32[M]=H?R+kt:R,g=g||H!==L}}}return g}isEmpty(){for(let o in this.instancesPerModel)if(this.instancesPerModel[o].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(o){if(!this.uploaded)for(let l in this.instancesPerModel){let u=this.instancesPerModel[l];u.instancedDataArray.length<0||u.instancedDataArray.length===0||(u.instancedDataBuffer?u.instancedDataBuffer.updateData(u.instancedDataArray):u.instancedDataBuffer=o.createVertexBuffer(u.instancedDataArray,dG.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(let l in this.instancesPerModel){let u=this.instancesPerModel[l];u.instancedDataArray.length!==0&&u.instancedDataBuffer&&u.instancedDataBuffer.destroy()}let o=this.layers[0].modelManager;if(o&&this.modelUris)for(let l of this.modelUris)o.removeModel(l,"")}addFeature(o,l,u){let p=this.layers[0],h=p.layout.get("model-id").evaluate(u,{},this.canonical);if(!h)return Er(`modelId is not evaluated for layer ${p.id} and it is not going to get rendered.`),h;VL(h,!1)&&(this.modelUris.includes(h)||this.modelUris.push(h)),this.instancesPerModel[h]||(this.instancesPerModel[h]=new UL);let g=this.instancesPerModel[h],x=g.instancedDataArray,C=new jL(u,x.length);for(let D of l)for(let v of D){if(v.x<0||v.x>=kt||v.y<0||v.y>=kt)continue;let E=(this.lookupDim-1)/kt,T=this.lookupDim*(v.y*E|0)+v.x*E|0;if(this.lookup){if(this.lookup[T]!==0)continue;this.lookup[T]=1}this.instanceCount++;let S=x.length;x.resize(S+1),g.instancesEvaluatedElevation.push(0),x.float32[16*S]=v.x,x.float32[16*S+1]=v.y}return C.instancedDataCount=g.instancedDataArray.length-C.instancedDataOffset,C.instancedDataCount>0&&(o.id&&(g.idToFeaturesIndex[o.id]=g.features.length),g.features.push(C),this.evaluate(C,{},g,!1)),h}getModelUris(){return this.modelUris}evaluate(o,l,u,p){let h=this.layers[0],g=o.feature,x=this.canonical,C=o.rotation=h.paint.get("model-rotation").evaluate(g,l,x),D=o.scale=h.paint.get("model-scale").evaluate(g,l,x),v=o.translation=h.paint.get("model-translation").evaluate(g,l,x),E=h.paint.get("model-color").evaluate(g,l,x);E.a=h.paint.get("model-color-mix-intensity").evaluate(g,l,x);let T=[];this.maxVerticalOffset<v[2]&&(this.maxVerticalOffset=v[2]),this.maxScale=Math.max(Math.max(this.maxScale,D[0]),Math.max(D[1],D[2])),NL(T,C,D);let S=Math.round(100*E.a)+E.b/1.05;for(let M=0;M<o.instancedDataCount;++M){let R=o.instancedDataOffset+M,L=16*R,N=u.instancedDataArray.float32,$=0;p&&($=N[L+6]-u.instancesEvaluatedElevation[R]);let H=0|N[L+1];N[L]=(0|N[L])+E.r/1.05,N[L+1]=H+E.g/1.05,N[L+2]=S,N[L+3]=1/(x.z>10?this.tileToMeter:m(x,H)),N[L+4]=v[0],N[L+5]=v[1],N[L+6]=v[2]+$,N[L+7]=T[0],N[L+8]=T[1],N[L+9]=T[2],N[L+10]=T[4],N[L+11]=T[5],N[L+12]=T[6],N[L+13]=T[8],N[L+14]=T[9],N[L+15]=T[10],u.instancesEvaluatedElevation[R]=v[2]}}}let HL,$L;$t($T,"ModelBucket",{omit:["layers"]}),$t(UL,"PerModelAttributes"),$t(jL,"ModelFeature");let Nf=64,Zg={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function GL(d,o,l,u,p,h,g,x,C,D=!1){let v=l.zoom,E=l.project(u),T=yd(u.lat,v),S=1/T;ce.mat4.identity(d),ce.mat4.translate(d,d,[E.x+g[0]*S,E.y+g[1]*S,g[2]]);let M=1,R=1,L=l.worldSize;if(D){if(l.projection.name==="mercator"){let j=0;l.elevation&&(j=l.elevation.getAtPointOrZero(new a(E.x/L,E.y/L),0));let q=ce.vec4.transformMat4([],[E.x,E.y,j,1],l.projMatrix)[3]/l.cameraToCenterDistance;M=q,R=q*yd(l.center.lat,v)}else if(l.projection.name==="globe"){let j=HT(d,l),q=ce.mat4.multiply([],l.projMatrix,j),Y=[0,0,0,1];ce.vec4.transformMat4(Y,Y,q);let Q=Y[3]/l.cameraToCenterDistance,pe=Ha(v),de=l.projection.pixelsPerMeter(u.lat,L)*yd(u.lat,v),ue=l.projection.pixelsPerMeter(l.center.lat,L)*yd(l.center.lat,v);M=Q/yi(de,Gw(l.center.lat),pe),R=Q*T/de,M*=ue,R*=ue}}else M=S;ce.mat4.scale(d,d,[M,M,R]);let N=[...d],$=o.orientation,H=[];if(NL(H,[$[0]+p[0],$[1]+p[1],$[2]+p[2]],h),ce.mat4.multiply(d,N,H),x&&l.elevation){let j=0,q=[];if(C&&l.elevation){j=function(pe,de,ue,De,fe){let Me=de.elevation;if(!Me)return 0;let Fe=ti.projectAabbCorners(ue,De),Pe=ea(1,fe.lat)*de.worldSize,ze=function(mi,jt){let Jt=[0,0,1],Ci=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(let Wi of Ci){let Di=mi[Wi.corners[0]],en=mi[Wi.corners[1]],Gi=mi[Wi.corners[2]],rn=[en[0]-Di[0],en[1]-Di[1],jt*(en[2]-Di[2])],yn=ce.vec3.cross(rn,rn,[Gi[0]-Di[0],Gi[1]-Di[1],jt*(Gi[2]-Di[2])]);ce.vec3.normalize(yn,yn),Wi.dotProductWithUp=ce.vec3.dot(yn,Jt)}return Ci.sort((Wi,Di)=>Wi.dotProductWithUp-Di.dotProductWithUp),Ci[0].corners}(Fe,Pe),Ne=Fe[ze[0]],Ge=Fe[ze[1]],Ue=Fe[ze[2]],qe=Fe[ze[3]],gt=Me.getAtPointOrZero(new a(Ne[0]/de.worldSize,Ne[1]/de.worldSize),0),ft=Me.getAtPointOrZero(new a(Ge[0]/de.worldSize,Ge[1]/de.worldSize),0),Gt=Me.getAtPointOrZero(new a(Ue[0]/de.worldSize,Ue[1]/de.worldSize),0),wt=Me.getAtPointOrZero(new a(qe[0]/de.worldSize,qe[1]/de.worldSize),0),Rt=(gt+wt)/2,yt=(ft+Gt)/2;return Rt>yt?ft<Gt?x1(pe,Ge,qe,Ne,ft,wt,gt,Pe):x1(pe,Ue,Ne,qe,Gt,gt,wt,Pe):gt<wt?x1(pe,Ne,Ge,Ue,gt,ft,Gt,Pe):x1(pe,qe,Ue,Ge,wt,Gt,ft,Pe),Math.max(Rt,yt)}(q,l,o.aabb,d,u);let Y=ce.mat4.fromQuat([],q),Q=ce.mat4.multiply([],Y,H);ce.mat4.multiply(d,N,Q)}else j=l.elevation.getAtPointOrZero(new a(E.x/L,E.y/L),0);j!==0&&(d[14]+=j)}}function S0(d,o,l=!1){d.uploaded||(d.gfxTexture=new VT(o,d.image,l?o.gl.R8:o.gl.RGBA8,{useMipmap:d.sampler.minFilter>=o.gl.NEAREST_MIPMAP_NEAREST}),d.uploaded=!0,d.image=null)}function hG(d,o,l){d.indexBuffer=o.createIndexBuffer(d.indexArray,!1,!0),d.vertexBuffer=o.createVertexBuffer(d.vertexArray,oG.members,!1,!0),d.normalArray&&(d.normalBuffer=o.createVertexBuffer(d.normalArray,cG.members,!1,!0)),d.texcoordArray&&(d.texcoordBuffer=o.createVertexBuffer(d.texcoordArray,lG.members,!1,!0)),d.colorArray&&(d.colorBuffer=o.createVertexBuffer(d.colorArray,(d.colorArray.bytesPerElement===12?aG:sG).members,!1,!0)),d.featureArray&&(d.pbrBuffer=o.createVertexBuffer(d.featureArray,uG.members,!0)),d.segments=_r.simpleSegment(0,0,d.vertexArray.length,d.indexArray.length);let u=d.material;u.pbrMetallicRoughness.baseColorTexture&&S0(u.pbrMetallicRoughness.baseColorTexture,o),u.pbrMetallicRoughness.metallicRoughnessTexture&&S0(u.pbrMetallicRoughness.metallicRoughnessTexture,o),u.normalTexture&&S0(u.normalTexture,o),u.occlusionTexture&&S0(u.occlusionTexture,o,l),u.emissionTexture&&S0(u.emissionTexture,o)}function GT(d,o,l){if(d.meshes)for(let u of d.meshes)hG(u,o,l);if(d.children)for(let u of d.children)GT(u,o,l)}function C1(d){if(d.meshes)for(let o of d.meshes)o.indexArray.destroy(),o.vertexArray.destroy(),o.colorArray&&o.colorArray.destroy(),o.normalArray&&o.normalArray.destroy(),o.texcoordArray&&o.texcoordArray.destroy(),o.featureArray&&o.featureArray.destroy();if(d.children)for(let o of d.children)C1(o)}function qT(d){if(d.meshes)for(let l of d.meshes)l.vertexBuffer&&(l.vertexBuffer.destroy(),l.indexBuffer.destroy(),l.normalBuffer&&l.normalBuffer.destroy(),l.texcoordBuffer&&l.texcoordBuffer.destroy(),l.colorBuffer&&l.colorBuffer.destroy(),l.pbrBuffer&&l.pbrBuffer.destroy(),l.segments.destroy(),l.material&&((o=l.material).pbrMetallicRoughness.baseColorTexture&&o.pbrMetallicRoughness.baseColorTexture.gfxTexture&&o.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),o.pbrMetallicRoughness.metallicRoughnessTexture&&o.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&o.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),o.normalTexture&&o.normalTexture.gfxTexture&&o.normalTexture.gfxTexture.destroy(),o.emissionTexture&&o.emissionTexture.gfxTexture&&o.emissionTexture.gfxTexture.destroy(),o.occlusionTexture&&o.occlusionTexture.gfxTexture&&o.occlusionTexture.gfxTexture.destroy()));var o;if(d.children)for(let l of d.children)qT(l)}class Xg{constructor(o,l,u){this._demTile=o,this._dem=this._demTile.dem,this._scale=l,this._offset=u}static create(o,l,u){let p=u||o.findDEMTileFor(l);if(!p||!p.dem)return;let h=p.dem,g=p.tileID,x=1<<l.canonical.z-g.canonical.z;return new Xg(p,h.dim/kt/x,[(l.canonical.x/x-g.canonical.x)*h.dim,(l.canonical.y/x-g.canonical.y)*h.dim])}tileCoordToPixel(o,l){let u=l*this._scale+this._offset[1],p=Math.floor(o*this._scale+this._offset[0]),h=Math.floor(u);return new At(p,h)}getElevationAt(o,l,u,p){let h=o*this._scale+this._offset[0],g=l*this._scale+this._offset[1],x=Math.floor(h),C=Math.floor(g),D=this._dem;return p=!!p,u?yi(yi(D.get(x,C,p),D.get(x,C+1,p),g-C),yi(D.get(x+1,C,p),D.get(x+1,C+1,p),g-C),h-x):D.get(x,C,p)}getElevationAtPixel(o,l,u){return this._dem.get(o,l,!!u)}getMeterToDEM(o){return(1<<this._demTile.tileID.canonical.z)*ea(1,o)*this._dem.stride}}let WT=new Float32Array(262144),zf=new Uint8Array(262144);function qL(d){let o=0;if(d.meshes)for(let l of d.meshes)o=Math.max(o,l.aabb.max[2]);if(d.children)for(let l of d.children)o=Math.max(o,qL(l));return o}function WL(d,o,l){if(d.meshes)for(let u of d.meshes){if(u.aabb.min[0]===1/0)continue;let p=ti.applyTransform(u.aabb,d.matrix);l.insert(o,p.min[0],p.min[1],p.max[0],p.max[1])}if(d.children)for(let u of d.children)WL(u,o,l)}let YL=["","wall","door","roof","window","lamp","logo"];class ZL{constructor(o){this.node=o,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:o.id,geometry:[],properties:{height:qL(o)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new ti([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let o=0,l=new ti([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(let u of this.node.meshes)this.node.lightMeshIndex!==o&&(u.transformedAabb=ti.applyTransformFast(u.aabb,this.node.matrix),l.encapsulate(u.transformedAabb)),o++;this.aabb=l}return this.aabb}}class E1{constructor(o,l,u,p,h,g,x){this.id=u,this.layers=o,this.layerIds=this.layers.map(C=>C.fqid),this.stateDependentLayerIds=this.layers.filter(C=>C.isStateDependent()).map(C=>C.id),this.modelTraits|=Zg.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,p&&(this.modelTraits|=Zg.HasMapboxMeshFeatures),h&&(this.modelTraits|=Zg.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=g,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(let C of l)this.nodesInfo.push(new ZL(C)),WL(C,x.featureIndexArray.length,x.grid),x.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,x.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(o,l){for(let u of this.getNodesInfo()){let p=u.node;p.footprint&&l.push({footprint:p.footprint,id:o})}}update(o){let l=Object.keys(o).length!==0;if(l&&!this.stateDependentLayers.length)return;let u=l?this.stateDependentLayers:this.layers;if(!To(o,this.states))for(let p of u)this.evaluate(p,o);this.states=structuredClone(o)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(o){if(!this.needsUpload)return;let l=this.getNodesInfo();for(let u of l){let p=u.node;this.uploaded?this.updatePbrBuffer(p):GT(p,o,!0)}for(let u of l)C1(u.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(o){let l=!1;if(!o.meshes)return l;for(let u of o.meshes)u.pbrBuffer&&(u.pbrBuffer.updateData(u.featureArray),l=!0);return l}needsReEvaluation(o,l,u){let p=o.transform.projectionOptions,h=o.style.getBrightness(),g=this.brightness!==h;if(!this.uploaded||this.dirty||p.name!==this.projection.name||D0(u.paint.get("model-color").value,g)||D0(u.paint.get("model-color-mix-intensity").value,g)||D0(u.paint.get("model-roughness").value,g)||D0(u.paint.get("model-emissive-strength").value,g)||D0(u.paint.get("model-height-based-emissive-strength-multiplier").value,g)){this.projection=p,this.brightness=h;let x=this.getNodesInfo();for(let C of x)C.state=null;return!0}return!1}evaluateScale(o,l){if(o.transform.zoom===this.zoom)return;this.zoom=o.transform.zoom;let u=this.getNodesInfo(),p=this.id.canonical;for(let h of u){let g=h.feature;h.evaluatedScale=l.paint.get("model-scale").evaluate(g,{},p)}}evaluate(o,l){let u=this.getNodesInfo();for(let p of u){if(!p.node.meshes)continue;let h=p.feature,g=l&&l[h.id];if(To(g,p.state))continue;p.state=structuredClone(g);let x=p.node.meshes&&p.node.meshes[0].featureData,C=p.evaluatedColor[2],D=p.evaluatedRMEA[2],v=this.id.canonical;if(p.hasTranslucentParts=!1,x){for(let E=0;E<YL.length;E++){let T=YL[E];T.length&&(h.properties.part=T);let S=o.paint.get("model-color").evaluate(h,g,v).toRenderColor(null),M=o.paint.get("model-color-mix-intensity").evaluate(h,g,v);p.evaluatedColor[E]=[S.r,S.g,S.b,M],p.evaluatedRMEA[E][0]=o.paint.get("model-roughness").evaluate(h,g,v),p.evaluatedRMEA[E][2]=o.paint.get("model-emissive-strength").evaluate(h,g,v),p.evaluatedRMEA[E][3]=S.a,p.emissionHeightBasedParams[E]=o.paint.get("model-height-based-emissive-strength-multiplier").evaluate(h,g,v),!p.hasTranslucentParts&&S.a<1&&(p.hasTranslucentParts=!0)}delete h.properties.part,fG(p,C!==p.evaluatedColor[2]||D!==p.evaluatedRMEA[2],this.modelTraits)}else p.evaluatedRMEA[0][2]=o.paint.get("model-emissive-strength").evaluate(h,g,v);p.evaluatedScale=o.paint.get("model-scale").evaluate(h,g,v),this.updatePbrBuffer(p.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(o,l,u,p){let h=o.findDEMTileFor(u);if(h&&(h.tileID.canonical!==this.terrainTile||l!==this.terrainExaggeration)){if(h.dem&&h.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=h.tileID.overscaledZ;let g=Xg.create(o,u,h);if(!g)return;this.modelTraits&Zg.HasMapboxMeshFeatures&&this.updateDEM(o,g,u,p);for(let x of this.getNodesInfo()){let C=x.node;if(!C.footprint||!C.footprint.vertices||!C.footprint.vertices.length)continue;let D=C.footprint.vertices,v=g.getElevationAt(D[0].x,D[0].y,!0,!0);for(let E=1;E<D.length;E++)v=Math.min(v,g.getElevationAt(D[E].x,D[E].y,!0,!0));C.elevation=v}}this.terrainTile=h.tileID.canonical,this.terrainExaggeration=l}}updateDEM(o,l,u,p){let h=l._dem._modifiedForSources[p];if(h===void 0&&(l._dem._modifiedForSources[p]=[],h=l._dem._modifiedForSources[p]),h.includes(u.canonical))return;let g=l._dem.dim;h.push(u.canonical);let x=!1;for(let C of this.getNodesInfo()){let D=C.node;if(!D.footprint||!D.footprint.grid)continue;let v=D.footprint.grid,E=l.tileCoordToPixel(v.min.x,v.min.y),T=l.tileCoordToPixel(v.max.x,v.max.y),S=Math.min(Math.min(g-T.y,E.x),Math.min(E.y,g-T.x));if(S<0)continue;let M=qi(S,2,5),R=Math.max(0,E.x-M),L=Math.max(0,E.y-M),N=Math.min(T.x+M,g-1),$=Math.min(T.y+M,g-1);for(let Y=L;Y<=$;++Y)for(let Q=R;Q<=N;++Q)zf[Y*g+Q]=255;let H=0,j=0;for(let Y=0;Y<v.cellsY;++Y)for(let Q=0;Q<v.cellsX;++Q){if(!v.cells[Y*v.cellsX+Q])continue;let pe=l.tileCoordToPixel(v.min.x+Q/v.xScale,v.min.y+Y/v.yScale),de=l.tileCoordToPixel(v.min.x+(Q+1)/v.xScale,v.min.y+(Y+1)/v.yScale);for(let ue=pe.y;ue<=Math.min(de.y+1,g-1);++ue)for(let De=pe.x;De<=Math.min(de.x+1,g-1);++De)zf[ue*g+De]===255&&(zf[ue*g+De]=0,H+=l.getElevationAtPixel(De,ue),j++)}let q=H/j;R=Math.max(1,E.x-M),L=Math.max(1,E.y-M),N=Math.min(T.x+M,g-2),$=Math.min(T.y+M,g-2),x=!0;for(let Y=L;Y<=$;++Y)for(let Q=R;Q<=N;++Q)zf[Y*g+Q]===0&&(WT[Y*g+Q]=l._dem.set(Q,Y,q));for(let Y=1;Y<M;++Y){R=Math.max(1,E.x-Y),L=Math.max(1,E.y-Y),N=Math.min(T.x+Y,g-2),$=Math.min(T.y+Y,g-2);for(let Q=L;Q<=$;++Q)for(let pe=R;pe<=N;++pe){let de=Q*g+pe;if(zf[de]===255){let ue=0,De=0,fe=-1,Me=-1;for(let Fe=-1;Fe<=1;++Fe)for(let Pe=-1;Pe<=1;++Pe){let ze=(Q+Fe)*g+pe+Pe;if(zf[ze]>=Y)continue;let Ne=WT[ze],Ge=Math.abs(Ne);Ge>De&&(ue=Ne,De=Ge,fe=Pe,Me=Fe)}if(De>.1){let Fe=1-(Y+.5*Math.abs(fe*Me))/M,Pe=l._dem.get(pe,Q)+ue*Fe,ze=l._dem.get(pe+fe,Q+Me),Ne=l._dem.get(pe-fe,Q-Me,!0);(Pe-ze)*(Pe-Ne)>0&&(Pe=(ze+Ne)/2),WT[de]=l._dem.set(pe,Q,Pe),zf[de]=Y}}}}}x&&(l._demTile.needsDEMTextureUpload=!0,l._dem._timestamp=it.now())}setFilter(o){this.filter=o?Fv(o):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(o=>this.filter.filter(new ir(this.id.overscaledZ),o.feature,this.id.canonical)):this.nodesInfo}destroy(){let o=this.getNodesInfo();for(let l of o)C1(l.node),qT(l.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(o,l){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;let u=l.getReplacementRegionsForTile(o.toUnwrapped()),p=this.getNodesInfo();for(let h=0;h<this.nodesInfo.length;h++){let g=p[h].node;p[h].hiddenByReplacement=!!g.footprint&&!u.find(x=>x.footprint===g.footprint)}}getHeightAtTileCoord(o,l){let u=this.getNodesInfo(),p=[],h=[0,0,0],g=ce.mat4.identity([]);for(let x=0;x<this.nodesInfo.length;x++){let C=u[x],D=C.node.meshes[0],v=D.transformedAabb;if(o<v.min[0]||l<v.min[1]||o>v.max[0]||l>v.max[1])continue;if(C.node.hidden===!0)return{height:1/0,maxHeight:C.feature.properties.height,hidden:!1,verticalScale:C.evaluatedScale[2]};ce.mat4.invert(g,C.node.matrix),h[0]=o,h[1]=l,ce.vec3.transformMat4(h,h,g);let E=(h[0]-D.aabb.min[0])/(D.aabb.max[0]-D.aabb.min[0])*Nf|0,T=Math.min(63,(h[1]-D.aabb.min[1])/(D.aabb.max[1]-D.aabb.min[1])*Nf|0)*Nf+Math.min(63,E),S=D.heightmap[T];if(!(S<0&&C.node.footprint))return C.hiddenByReplacement?void 0:{height:S,maxHeight:C.feature.properties.height,hidden:!1,verticalScale:C.evaluatedScale[2]};if(C.node.footprint.grid.query(new At(o,l),new At(o,l),p),p.length>0)return{height:void 0,maxHeight:C.feature.properties.height,hidden:C.hiddenByReplacement,verticalScale:C.evaluatedScale[2]}}}}function D0(d,o){return!d.isLightConstant&&o}function pG(d,o,l,u,p,h,g,x){let C=(61440&o|(61440&o)>>4)>>8,D=(3840&o|(3840&o)>>4)>>4,v=240&o|(240&o)>>4;l[3]>0&&(C=yi(C,255*l[0],l[3]),D=yi(D,255*l[1],l[3]),v=yi(v,255*l[2],l[3]));let E=C<<8|D,T=v<<8|Math.floor(255*u[3]),S=function(Y){let Q=qi(Y,0,2);return Math.min(Math.round(.5*Q*255),255)}(u[2])<<8|15*u[0]<<4|15*u[1],M=qi(p[0],0,1),R=qi(p[1],0,1),L=qi(p[2],0,1),N=qi(p[3],0,1),$,H,j,q;if(M!==R&&g!==h&&R!==M){let Y=g-h;H=1/(Y*(R-M)),j=-(h+Y*M)/(Y*(R-M));let Q=qi(p[4],-1,1);q=Math.pow(10,Q),$=255*L<<8|255*N}else $=65535,H=0,j=1,q=1;if(d.emplaceBack(E,T,S,$,H,j,q),x){let Y=x.length;x.clear();for(let Q=0;Q<Y;Q++)x.emplaceBack(E,T,S,$,H,j,q)}}function fG(d,o,l){let u=d.node,p=0,h=l&Zg.HasMeshoptCompression;for(let g of u.meshes){if(u.lights&&u.lightMeshIndex===p||!g.featureData)continue;g.featureArray=new Fg,g.featureArray.reserve(g.featureData.length);let x=o;for(let C of g.featureData){let D=h?65535&C:C>>16&65535,v=h?C>>16&65535:65535&C,E=(15&v)<8?15&v:0,T=d.evaluatedRMEA[E],S=d.evaluatedColor[E],M=d.emissionHeightBasedParams[E],R;if(x&&E===2&&u.lights&&(R=new Fg,R.resize(10*u.lights.length)),pG(g.featureArray,D,S,T,M,g.aabb.min[2],g.aabb.max[2],R),R&&x){x=!1;let L=u.meshes[u.lightMeshIndex];L.featureArray=R,L.featureArray._trim()}}g.featureArray._trim(),p++}}function XL(d,o,l,u){let p=1<<d.z;o.lat=Ho((u/kt+d.y)/p),o.lng=es((l/kt+d.x)/p)}$t(E1,"Tiled3dModelBucket",{omit:["layers"]}),$t(ZL,"Tiled3dModelFeature");let mG={circle:class extends Po{constructor(d,o,l,u){super(d,{layout:He||(He=new Sr({"circle-sort-key":new Ht(We.layout_circle["circle-sort-key"]),"circle-elevation-reference":new It(We.layout_circle["circle-elevation-reference"]),visibility:new It(We.layout_circle.visibility)})),paint:st||(st=new Sr({"circle-radius":new Ht(We.paint_circle["circle-radius"]),"circle-color":new Ht(We.paint_circle["circle-color"]),"circle-blur":new Ht(We.paint_circle["circle-blur"]),"circle-opacity":new Ht(We.paint_circle["circle-opacity"]),"circle-translate":new It(We.paint_circle["circle-translate"]),"circle-translate-anchor":new It(We.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new It(We.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new It(We.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ht(We.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ht(We.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ht(We.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new It(We.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},o,l,u)}createBucket(d){return new G(d)}queryRadius(d){let o=d;return $e("circle-radius",this,o)+$e("circle-stroke-width",this,o)+ct(this.paint.get("circle-translate"))}queryIntersectsFeature(d,o,l,u,p,h,g,x){let C=St(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),h.angle,d.pixelToTileUnitsFactor),D=this.paint.get("circle-radius").evaluate(o,l)+this.paint.get("circle-stroke-width").evaluate(o,l);return jg(d,u,h,g,x,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",C,D)}getProgramIds(){return["circle"]}getDefaultProgramParams(d,o,l){let u=Ph(this);return{config:new du(this,{zoom:o,lut:l}),defines:u,overrideFog:!1}}},heatmap:class extends Po{createBucket(d){return new bO(d)}constructor(d,o,l,u){super(d,{layout:xO||(xO=new Sr({visibility:new It(We.layout_heatmap.visibility)})),paint:wO||(wO=new Sr({"heatmap-radius":new Ht(We.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ht(We.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new It(We.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Eh(We.paint_heatmap["heatmap-color"]),"heatmap-opacity":new It(We.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},o,l,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(d){d==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=o0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(d){return $e("heatmap-radius",this,d)}queryIntersectsFeature(d,o,l,u,p,h,g,x){let C=this.paint.get("heatmap-radius").evaluate(o,l);return jg(d,u,h,g,x,!0,!0,new At(0,0),C)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(d,o,l){return d==="heatmap"?{config:new du(this,{zoom:o,lut:l}),overrideFog:!1}:{}}},hillshade:class extends Po{constructor(d,o,l,u){super(d,{layout:CO||(CO=new Sr({visibility:new It(We.layout_hillshade.visibility)})),paint:EO||(EO=new Sr({"hillshade-illumination-direction":new It(We.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new It(We.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new It(We.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new It(We.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new It(We.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new It(We.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new It(We.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},o,l,u)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(d,o,l){return{overrideFog:!1}}},fill:class extends Po{constructor(d,o,l,u){super(d,{layout:HO||(HO=new Sr({"fill-sort-key":new Ht(We.layout_fill["fill-sort-key"]),visibility:new It(We.layout_fill.visibility),"fill-elevation-reference":new It(We.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new Ht(We.layout_fill["fill-construct-bridge-guard-rail"])})),paint:$O||($O=new Sr({"fill-antialias":new It(We.paint_fill["fill-antialias"]),"fill-opacity":new Ht(We.paint_fill["fill-opacity"]),"fill-color":new Ht(We.paint_fill["fill-color"]),"fill-outline-color":new Ht(We.paint_fill["fill-outline-color"]),"fill-translate":new It(We.paint_fill["fill-translate"]),"fill-translate-anchor":new It(We.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ht(We.paint_fill["fill-pattern"]),"fill-emissive-strength":new It(We.paint_fill["fill-emissive-strength"]),"fill-z-offset":new Ht(We.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new Ht(We.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new Ht(We.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},o,l,u)}getProgramIds(){let d=this.paint.get("fill-pattern"),o=d&&d.constantOr(1),l=[o?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(o&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getDefaultProgramParams(d,o,l){return{config:new du(this,{zoom:o,lut:l}),overrideFog:!1}}recalculate(d,o){super.recalculate(d,o);let l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(d){return new hT(d)}queryRadius(){return ct(this.paint.get("fill-translate"))}queryIntersectsFeature(d,o,l,u,p,h){return!d.queryGeometry.isAboveHorizon&&te(ut(d.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),h.angle,d.pixelToTileUnitsFactor),u)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(d){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;let o=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return d!=null?o&&!d:o}},"fill-extrusion":class extends Po{constructor(d,o,l,u){super(d,{layout:yF||(yF=new Sr({visibility:new It(We["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new It(We["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:vF||(vF=new Sr({"fill-extrusion-opacity":new It(We["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ht(We["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new It(We["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new It(We["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ht(We["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ht(We["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ht(We["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new It(We["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new It(We["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new It(We["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new It(We["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new It(We["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new It(We["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new It(We["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new It(We["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new It(We["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new It(We["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Ht(We["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Ht(We["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new It(We["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new It(We["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new It(We["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new It(We["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Ht(We["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Ht(We["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new It(We["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},o,l,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(d){return new t1(d)}queryRadius(){return ct(this.paint.get("fill-extrusion-translate"))}is3D(d){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(d,o,l,u,p,h,g,x,C){let D=St(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),h.angle,d.pixelToTileUnitsFactor),v=this.paint.get("fill-extrusion-height").evaluate(o,l),E=this.paint.get("fill-extrusion-base").evaluate(o,l),T=[0,0],S=x&&h.elevation,M=h.elevation?h.elevation.exaggeration():1,R=d.tile.getBucket(this);if(S&&R instanceof t1){let j=R.centroidVertexArray,q=C+1;q<j.length&&(T[0]=j.geta_centroid_pos0(q),T[1]=j.geta_centroid_pos1(q))}if(T[0]===0&&T[1]===1)return!1;h.projection.name==="globe"&&(u=_F([u],[new At(0,0),new At(kt,kt)],d.tileID.canonical).map(j=>j.polygon).flat());let L=S?x:null,[N,$]=function(j,q,Y,Q,pe,de,ue,De,fe,Me,Fe){return j.projection.name==="globe"?function(Pe,ze,Ne,Ge,Ue,qe,gt,ft,Gt,wt,Rt){let yt=[],mi=[],jt=Pe.projection.upVectorScale(Rt,Pe.center.lat,Pe.worldSize).metersToTile,Jt=[0,0,0,1],Ci=[0,0,0,1],Wi=(en,Gi,rn,yn)=>{en[0]=Gi,en[1]=rn,en[2]=yn,en[3]=1},Di=gF();Ne>0&&(Ne+=Di),Ge+=Di;for(let en of ze){let Gi=[],rn=[];for(let yn of en){let nr=yn.x+Ue.x,Ei=yn.y+Ue.y,cn=Pe.projection.projectTilePoint(nr,Ei,Rt),pr=Pe.projection.upVector(Rt,yn.x,yn.y),br=Ne,Dr=Ge;if(gt){let Rr=xF(nr,Ei,Ne,Ge,gt,ft,Gt,wt);br+=Rr.base,Dr+=Rr.top}Ne!==0?Wi(Jt,cn.x+pr[0]*jt*br,cn.y+pr[1]*jt*br,cn.z+pr[2]*jt*br):Wi(Jt,cn.x,cn.y,cn.z),Wi(Ci,cn.x+pr[0]*jt*Dr,cn.y+pr[1]*jt*Dr,cn.z+pr[2]*jt*Dr),ce.vec3.transformMat4(Jt,Jt,qe),ce.vec3.transformMat4(Ci,Ci,qe),Gi.push(new Lf(Jt[0],Jt[1],Jt[2])),rn.push(new Lf(Ci[0],Ci[1],Ci[2]))}yt.push(Gi),mi.push(rn)}return[yt,mi]}(j,q,Y,Q,pe,de,ue,De,fe,Me,Fe):ue?function(Pe,ze,Ne,Ge,Ue,qe,gt,ft,Gt){let wt=[],Rt=[],yt=[0,0,0,1];for(let mi of Pe){let jt=[],Jt=[];for(let Ci of mi){let Wi=Ci.x+Ge.x,Di=Ci.y+Ge.y,en=xF(Wi,Di,ze,Ne,qe,gt,ft,Gt);yt[0]=Wi,yt[1]=Di,yt[2]=en.base,yt[3]=1,ce.vec4.transformMat4(yt,yt,Ue),yt[3]=Math.max(yt[3],1e-5);let Gi=new Lf(yt[0]/yt[3],yt[1]/yt[3],yt[2]/yt[3]);yt[0]=Wi,yt[1]=Di,yt[2]=en.top,yt[3]=1,ce.vec4.transformMat4(yt,yt,Ue),yt[3]=Math.max(yt[3],1e-5);let rn=new Lf(yt[0]/yt[3],yt[1]/yt[3],yt[2]/yt[3]);jt.push(Gi),Jt.push(rn)}wt.push(jt),Rt.push(Jt)}return[wt,Rt]}(q,Y,Q,pe,de,ue,De,fe,Me):function(Pe,ze,Ne,Ge,Ue){let qe=[],gt=[],ft=Ue[8]*ze,Gt=Ue[9]*ze,wt=Ue[10]*ze,Rt=Ue[11]*ze,yt=Ue[8]*Ne,mi=Ue[9]*Ne,jt=Ue[10]*Ne,Jt=Ue[11]*Ne;for(let Ci of Pe){let Wi=[],Di=[];for(let en of Ci){let Gi=en.x+Ge.x,rn=en.y+Ge.y,yn=Ue[0]*Gi+Ue[4]*rn+Ue[12],nr=Ue[1]*Gi+Ue[5]*rn+Ue[13],Ei=Ue[2]*Gi+Ue[6]*rn+Ue[14],cn=Ue[3]*Gi+Ue[7]*rn+Ue[15],pr=yn+ft,br=nr+Gt,Dr=Ei+wt,Rr=Math.max(cn+Rt,1e-5),Jn=yn+yt,So=nr+mi,$a=Ei+jt,Qr=Math.max(cn+Jt,1e-5);Wi.push(new Lf(pr/Rr,br/Rr,Dr/Rr)),Di.push(new Lf(Jn/Qr,So/Qr,$a/Qr))}qe.push(Wi),gt.push(Di)}return[qe,gt]}(q,Y,Q,pe,de)}(h,u,E,v,D,g,L,T,M,h.center.lat,d.tileID.canonical),H=d.queryGeometry;return function(j,q,Y){let Q=1/0;te(Y,q)&&(Q=bF(Y,q[0]));for(let pe=0;pe<q.length;pe++){let de=q[pe],ue=j[pe];for(let De=0;De<de.length-1;De++){let fe=de[De],Me=[fe,de[De+1],ue[De+1],ue[De],fe];K(Y,Me)&&(Q=Math.min(Q,bF(Y,Me)))}}return Q!==1/0&&Q}(N,$,H.isPointQuery()?H.screenBounds:H.screenGeometry)}},line:class extends Po{constructor(d,o,l,u){let p=RF();super(d,p,o,l,u),p.layout&&(this.layout=new Ch(p.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(d){if(d==="line-gradient"){let o=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=o._styleExpression&&o._styleExpression.expression instanceof Ol,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(d,o){super.recalculate(d,o),this.paint._values["line-floorwidth"]=(()=>{if(f0)return f0;let l=RF();return f0=new g$(l.paint.properties["line-width"].specification),f0.useIntegerZoom=!0,f0})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,d)}createBucket(d){return new vT(d)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(d,o,l){let u=IF(this);return{config:new du(this,{zoom:o,lut:l}),defines:u,overrideFog:!1}}queryRadius(d){let o=d,l=kF($e("line-width",this,o),$e("line-gap-width",this,o)),u=$e("line-offset",this,o);return l/2+Math.abs(u)+ct(this.paint.get("line-translate"))}queryIntersectsFeature(d,o,l,u,p,h){if(d.queryGeometry.isAboveHorizon)return!1;let g=ut(d.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),h.angle,d.pixelToTileUnitsFactor),x=d.pixelToTileUnitsFactor/2*kF(this.paint.get("line-width").evaluate(o,l),this.paint.get("line-gap-width").evaluate(o,l)),C=this.paint.get("line-offset").evaluate(o,l);return C&&(u=function(D,v){let E=[],T=new At(0,0);for(let S=0;S<D.length;S++){let M=D[S],R=[];for(let L=0;L<M.length;L++){let N=M[L],$=M[L+1],H=L===0?T:N.sub(M[L-1])._unit()._perp(),j=L===M.length-1?T:$.sub(N)._unit()._perp(),q=H._add(j)._unit();q._mult(1/(q.x*j.x+q.y*j.y)),R.push(q._mult(v)._add(N))}E.push(R)}return E}(u,C*d.pixelToTileUnitsFactor)),function(D,v,E){for(let T=0;T<v.length;T++){let S=v[T];if(D.length>=3){for(let M=0;M<S.length;M++)if(be(D,S[M]))return!0}if(ne(D,S,E))return!0}return!1}(g,u,x)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(d){return!this.hasElevatedBuckets}},symbol:g1,background:class extends Po{constructor(d,o,l,u){super(d,{layout:xL||(xL=new Sr({visibility:new It(We.layout_background.visibility)})),paint:wL||(wL=new Sr({"background-pitch-alignment":new It(We.paint_background["background-pitch-alignment"]),"background-color":new It(We.paint_background["background-color"]),"background-pattern":new It(We.paint_background["background-pattern"]),"background-opacity":new It(We.paint_background["background-opacity"]),"background-emissive-strength":new It(We.paint_background["background-emissive-strength"]),"background-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},o,l,u)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(d,o,l){return{overrideFog:!1}}is3D(d){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:ML,"raster-particle":PL,sky:class extends Po{constructor(d,o,l,u){super(d,{layout:AL||(AL=new Sr({visibility:new It(We.layout_sky.visibility)})),paint:RL||(RL=new Sr({"sky-type":new It(We.paint_sky["sky-type"]),"sky-atmosphere-sun":new It(We.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new It(We.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new It(We.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new It(We.paint_sky["sky-gradient-radius"]),"sky-gradient":new Eh(We.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new It(We.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new It(We.paint_sky["sky-atmosphere-color"]),"sky-opacity":new It(We.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},o,l,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(d){d==="sky-gradient"?this._updateColorRamp():d!=="sky-atmosphere-sun"&&d!=="sky-atmosphere-halo-color"&&d!=="sky-atmosphere-color"&&d!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=o0({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(d){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){let o=d.style.light.properties.get("position");return this._lightPosition.azimuthal!==o.azimuthal||this._lightPosition.polar!==o.polar}return!1}getCenter(d,o){if(this.paint.get("sky-type")==="atmosphere"){let u=this.paint.get("sky-atmosphere-sun"),p=!u,h=d.style.light,g=h.properties.get("position");return p&&h.properties.get("anchor")==="viewport"&&Er("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?jT(g.azimuthal,90-g.polar,o):jT(u[0],90-u[1],o)}let l=this.paint.get("sky-gradient-center");return jT(l[0],90-l[1],o)}isSky(){return!0}markSkyboxValid(d){this._skyboxInvalidated=!1,this._lightPosition=d.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){let d=this.paint.get("sky-type");return d==="atmosphere"?["skyboxCapture","skybox"]:d==="gradient"?["skyboxGradient"]:null}},slot:class extends Po{constructor(d,o,l,u){super(d,{paint:kL||(kL=new Sr({}))},o,null)}},model:class extends Po{constructor(d,o,l,u){super(d,{layout:HL||(HL=new Sr({visibility:new It(We.layout_model.visibility),"model-id":new Ht(We.layout_model["model-id"])})),paint:$L||($L=new Sr({"model-opacity":new Ht(We.paint_model["model-opacity"]),"model-rotation":new Ht(We.paint_model["model-rotation"]),"model-scale":new Ht(We.paint_model["model-scale"]),"model-translation":new Ht(We.paint_model["model-translation"]),"model-color":new Ht(We.paint_model["model-color"]),"model-color-mix-intensity":new Ht(We.paint_model["model-color-mix-intensity"]),"model-type":new It(We.paint_model["model-type"]),"model-cast-shadows":new It(We.paint_model["model-cast-shadows"]),"model-receive-shadows":new It(We.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new It(We.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Ht(We.paint_model["model-emissive-strength"]),"model-roughness":new Ht(We.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Ht(We.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new It(We.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new It(We.paint_model["model-front-cutoff"]),"model-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},o,l,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(d){return new $T(d)}getProgramIds(){return["model"]}is3D(d){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(d){return d instanceof E1?kt-1:0}queryIntersectsFeature(d,o,l,u,p,h){if(!this.modelManager)return!1;let g=this.modelManager,x=d.tile.getBucket(this);if(!(x&&x instanceof $T))return!1;for(let C in x.instancesPerModel){let D=x.instancesPerModel[C],v=o.id!==void 0?o.id:o.properties&&o.properties.hasOwnProperty("id")?o.properties.id:void 0;if(D.idToFeaturesIndex.hasOwnProperty(v)){let E=D.features[D.idToFeaturesIndex[v]],T=g.getModel(C,this.scope);if(!T)return!1;let S=ce.mat4.create(),M=new Sn(0,0),R=x.canonical,L=Number.MAX_VALUE;for(let N=0;N<E.instancedDataCount;++N){let $=16*(E.instancedDataOffset+N),H=D.instancedDataArray.float32,j=[H[$+4],H[$+5],H[$+6]];XL(R,M,H[$],0|H[$+1]),GL(S,T,h,M,E.rotation,E.scale,j,!1,!1,!1),h.projection.name==="globe"&&(S=HT(S,h));let q=ce.mat4.multiply([],h.projMatrix,S),Y=d.queryGeometry,Q=zL(Y.isPointQuery()?Y.screenBounds:Y.screenGeometry,h,q,T.aabb);Q!=null&&(L=Math.min(Q,L))}return L!==Number.MAX_VALUE&&L}}return!1}_handleOverridablePaintPropertyUpdate(d,o,l){return!(!this.layout||o.isDataDriven()||l.isDataDriven()||d!=="model-color"&&d!=="model-color-mix-intensity"&&d!=="model-rotation"&&d!=="model-scale"&&d!=="model-translation"&&d!=="model-emissive-strength")}_isPropertyZoomDependent(d){let o=this._transitionablePaint._values[d];return o!=null&&o.value!=null&&o.value.expression!=null&&o.value.expression instanceof _h}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends Po{constructor(d,o,l,u){super(d,{layout:GO||(GO=new Sr({"clip-layer-types":new It(We.layout_clip["clip-layer-types"]),"clip-layer-scope":new It(We.layout_clip["clip-layer-scope"])})),paint:qO||(qO=new Sr({}))},o,l,u)}recalculate(d,o){super.recalculate(d,o)}createBucket(d){return new WO(d)}is3D(d){return!0}}};class gG{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class _G{constructor(){this.tasks={},this.taskQueue=[],Wp(["process"],this),this.invoker=new gG(this.process),this.nextId=0}add(o,l){let u=this.nextId++,p=function({type:h,isSymbolTile:g,zoom:x}){return x=x||0,h==="message"?0:h!=="maybePrepare"||g?h!=="parseTile"||g?h==="parseTile"&&g?300-x:h==="maybePrepare"&&g?400-x:500:200-x:100-x}(l);if(p===0){try{o()}finally{}return null}return this.tasks[u]={fn:o,metadata:l,priority:p,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;let o=this.pick();if(o===null)return;let l=this.tasks[o];if(delete this.tasks[o],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let o=null,l=1/0;for(let p=0;p<this.taskQueue.length;p++){let h=this.tasks[this.taskQueue[p]];h.priority<l&&(l=h.priority,o=p)}if(o===null)return null;let u=this.taskQueue[o];return this.taskQueue.splice(o,1),u}remove(){this.invoker.remove()}}class KL{constructor(o,l,u){this.target=o,this.parent=l,this.mapId=u,this.callbacks={},this.cancelCallbacks={},Wp(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new _G}send(o,l,u,p,h=!1,g){let x=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=g,this.callbacks[x]=u);let C=new Set;return this.target.postMessage({id:x,type:o,hasCallback:!!u,targetMapId:p,mustQueue:h,sourceMapId:this.mapId,data:dd(l,C)},C),{cancel:()=>{u&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(o){let l=o.data;if(!l)return;let u=l.id;if(u&&(!l.targetMapId||this.mapId===l.targetMapId))if(l.type==="<cancel>"){let p=this.cancelCallbacks[u];delete this.cancelCallbacks[u],p&&p.cancel()}else if(l.mustQueue||Va()){let p=this.callbacks[u],h=this.scheduler.add(()=>this.processTask(u,l),p&&p.metadata||{type:"message"});h&&(this.cancelCallbacks[u]=h)}else this.processTask(u,l)}processTask(o,l){if(delete this.cancelCallbacks[o],l.type==="<response>"){let u=this.callbacks[o];delete this.callbacks[o],u&&(l.error?u(vs(l.error)):u(null,vs(l.data)))}else{let u=new Set,p=l.hasCallback?(g,x)=>{this.target.postMessage({id:o,type:"<response>",sourceMapId:this.mapId,error:g?dd(g):null,data:dd(x,u)},u)}:()=>{},h=vs(l.data);if(this.parent[l.type])this.parent[l.type](l.sourceMapId,h,p);else if(this.parent.getWorkerSource){let g=l.type.split(".");this.parent.getWorkerSource(l.sourceMapId,g[0],h.source,h.scope)[g[1]](h,p)}else p(new Error(`Could not find function ${l.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var M0={workerUrl:"",workerClass:null,workerParams:void 0};let YT="mapboxgl_preloaded_worker_pool",S1=(()=>{class d{constructor(){this.active={}}acquire(l,u=d.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<u;)this.workers.push(M0.workerClass!=null?new M0.workerClass:new self.Worker(M0.workerUrl,M0.workerParams));return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.workers&&this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[YT]}numActive(){return Object.keys(this.active).length}}return d.workerCount=2,d})();class Kg{constructor(o,l,u="Worker",p=S1.workerCount){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=ps();let h=this.workerPool.acquire(this.id,p);for(let g=0;g<h.length;g++){let x=new Kg.Actor(h[g],l,this.id);x.name=`${u} ${g}`,this.actors.push(x)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(o,l,u){cl(this.actors,(p,h)=>{p.send(o,l,h)},u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}let T0,ZT;function D1(){return T0||(T0=new S1),T0}Kg.Actor=KL;let XT=new Ln(0,0,0);var KT=(d=>(d[d.PATH_RULE_UNSPECIFIED=0]="PATH_RULE_UNSPECIFIED",d[d.PATH_RULE_NON_ZERO=1]="PATH_RULE_NON_ZERO",d[d.PATH_RULE_EVEN_ODD=2]="PATH_RULE_EVEN_ODD",d))(KT||{}),M1=(d=>(d[d.LINE_CAP_UNSPECIFIED=0]="LINE_CAP_UNSPECIFIED",d[d.LINE_CAP_BUTT=1]="LINE_CAP_BUTT",d[d.LINE_CAP_ROUND=2]="LINE_CAP_ROUND",d[d.LINE_CAP_SQUARE=3]="LINE_CAP_SQUARE",d))(M1||{}),I0=(d=>(d[d.LINE_JOIN_UNSPECIFIED=0]="LINE_JOIN_UNSPECIFIED",d[d.LINE_JOIN_MITER=1]="LINE_JOIN_MITER",d[d.LINE_JOIN_MITER_CLIP=2]="LINE_JOIN_MITER_CLIP",d[d.LINE_JOIN_ROUND=3]="LINE_JOIN_ROUND",d[d.LINE_JOIN_BEVEL=4]="LINE_JOIN_BEVEL",d))(I0||{}),QL=(d=>(d[d.PAINT_ORDER_UNSPECIFIED=0]="PAINT_ORDER_UNSPECIFIED",d[d.PAINT_ORDER_FILL_AND_STROKE=1]="PAINT_ORDER_FILL_AND_STROKE",d[d.PAINT_ORDER_STROKE_AND_FILL=2]="PAINT_ORDER_STROKE_AND_FILL",d))(QL||{}),Qg=(d=>(d[d.PATH_COMMAND_UNSPECIFIED=0]="PATH_COMMAND_UNSPECIFIED",d[d.PATH_COMMAND_MOVE=1]="PATH_COMMAND_MOVE",d[d.PATH_COMMAND_LINE=2]="PATH_COMMAND_LINE",d[d.PATH_COMMAND_QUAD=3]="PATH_COMMAND_QUAD",d[d.PATH_COMMAND_CUBIC=4]="PATH_COMMAND_CUBIC",d[d.PATH_COMMAND_CLOSE=5]="PATH_COMMAND_CLOSE",d))(Qg||{}),JL=(d=>(d[d.MASK_TYPE_UNSPECIFIED=0]="MASK_TYPE_UNSPECIFIED",d[d.MASK_TYPE_LUMINANCE=1]="MASK_TYPE_LUMINANCE",d[d.MASK_TYPE_ALPHA=2]="MASK_TYPE_ALPHA",d))(JL||{});function yG(d,o,l){d===1&&o.icons.push(function(u,p){return function(h){if(h.usvg_tree.height||(h.usvg_tree.height=h.usvg_tree.width),!h.metadata)return h;let{metadata:g}=h;if(g.content_area){let{content_area:x}=g;x.top==null&&(x.top=x.left),x.width==null&&(x.width=h.usvg_tree.width),x.height==null&&(x.height=x.width)}return g.stretch_x&&g.stretch_x.length&&eN(g,"x"),g.stretch_y&&g.stretch_y.length&&eN(g,"y"),h}(u.readFields(vG,{name:void 0},p))}(l,l.readVarint()+l.pos))}function eN(d,o){let l=[],u=d[`stretch_${o}`],p=null;for(let h=0;h<u.length;h++)p===null?p=l.length===0?u[0]:l[l.length-1][1]+u[h]:(l.push([p,p+u[h]]),p=null);d[`stretch_${o}_areas`]=l}function vG(d,o,l){d===1?o.name=l.readString():d===2?o.metadata=function(u,p){return u.readFields(bG,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},p)}(l,l.readVarint()+l.pos):d===3&&(o.usvg_tree=function(u,p){return u.readFields(CG,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},p)}(l,l.readVarint()+l.pos),o.data="usvg_tree")}function bG(d,o,l){d===1?o.stretch_x=l.readPackedVarint():d===2?o.stretch_y=l.readPackedVarint():d===3?o.content_area=function(u,p){return u.readFields(xG,{left:0},p)}(l,l.readVarint()+l.pos):d===4&&o.variables.push(function(u,p){return u.readFields(wG,{name:void 0},p)}(l,l.readVarint()+l.pos))}function xG(d,o,l){d===1?o.left=l.readVarint():d===2?o.width=l.readVarint():d===3?o.top=l.readVarint():d===4&&(o.height=l.readVarint())}function wG(d,o,l){d===1?o.name=l.readString():d===2&&(o.rgb_color=A1(l.readVarint()),o.value="rgb_color")}function CG(d,o,l){d===1?o.width=o.height=l.readVarint():d===2?o.height=l.readVarint():d===3?o.children.push(T1(l,l.readVarint()+l.pos)):d===4?o.linear_gradients.push(function(u,p){return u.readFields(AG,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},p)}(l,l.readVarint()+l.pos)):d===5?o.radial_gradients.push(function(u,p){return u.readFields(kG,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},p)}(l,l.readVarint()+l.pos)):d===7?o.clip_paths.push(function(u,p){return u.readFields(PG,{children:[]},p)}(l,l.readVarint()+l.pos)):d===8&&o.masks.push(function(u,p){let h=u.readFields(OG,{left:0,width:20,mask_type:1,children:[]},p);return h.height==null&&(h.height=h.width),h.top==null&&(h.top=h.left),h}(l,l.readVarint()+l.pos))}function T1(d,o){return d.readFields(EG,{},o)}function EG(d,o,l){d===1?(o.group=function(u,p){return u.readFields(SG,{opacity:255,children:[]},p)}(l,l.readVarint()+l.pos),o.node="group"):d===2&&(o.path=function(u,p){return u.readFields(MG,{paint_order:1,commands:[],step:1,diffs:[],rule:1},p)}(l,l.readVarint()+l.pos),o.node="path")}function SG(d,o,l){d===1?o.transform=I1(l,l.readVarint()+l.pos):d===2?o.opacity=l.readVarint():d===5?o.clip_path_idx=l.readVarint():d===6?o.mask_idx=l.readVarint():d===7&&o.children.push(T1(l,l.readVarint()+l.pos))}function I1(d,o){return d.readFields(DG,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},o)}function DG(d,o,l){d===1?o.sx=l.readFloat():d===2?o.ky=l.readFloat():d===3?o.kx=l.readFloat():d===4?o.sy=l.readFloat():d===5?o.tx=l.readFloat():d===6&&(o.ty=l.readFloat())}function MG(d,o,l){d===1?o.fill=function(u,p){return u.readFields(TG,{rgb_color:XT,paint:"rgb_color",opacity:255},p)}(l,l.readVarint()+l.pos):d===2?o.stroke=function(u,p){return u.readFields(IG,{rgb_color:XT,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},p)}(l,l.readVarint()+l.pos):d===3?o.paint_order=l.readVarint():d===5?l.readPackedVarint(o.commands):d===6?o.step=l.readFloat():d===7?l.readPackedSVarint(o.diffs):d===8&&(o.rule=l.readVarint())}function TG(d,o,l){d===1?(o.rgb_color=A1(l.readVarint()),o.paint="rgb_color"):d===2?(o.linear_gradient_idx=l.readVarint(),o.paint="linear_gradient_idx"):d===3?(o.radial_gradient_idx=l.readVarint(),o.paint="radial_gradient_idx"):d===5&&(o.opacity=l.readVarint())}function A1(d){return new Ln((d>>16&255)/255,(d>>8&255)/255,(255&d)/255,1)}function IG(d,o,l){d===1?(o.rgb_color=A1(l.readVarint()),o.paint="rgb_color"):d===2?(o.linear_gradient_idx=l.readVarint(),o.paint="linear_gradient_idx"):d===3?(o.radial_gradient_idx=l.readVarint(),o.paint="radial_gradient_idx"):d===5?l.readPackedFloat(o.dasharray):d===6?o.dashoffset=l.readFloat():d===7?o.miterlimit=l.readFloat():d===8?o.opacity=l.readVarint():d===9?o.width=l.readFloat():d===10?o.linecap=l.readVarint():d===11&&(o.linejoin=l.readVarint())}function AG(d,o,l){d===1?o.transform=I1(l,l.readVarint()+l.pos):d===2?o.spread_method=l.readVarint():d===3?o.stops.push(tN(l,l.readVarint()+l.pos)):d===4?o.x1=l.readFloat():d===5?o.y1=l.readFloat():d===6?o.x2=l.readFloat():d===7&&(o.y2=l.readFloat())}function tN(d,o){return d.readFields(RG,{offset:0,opacity:255,rgb_color:XT},o)}function RG(d,o,l){d===1?o.offset=l.readFloat():d===2?o.opacity=l.readVarint():d===3&&(o.rgb_color=A1(l.readVarint()))}function kG(d,o,l){d===1?o.transform=I1(l,l.readVarint()+l.pos):d===2?o.spread_method=l.readVarint():d===3?o.stops.push(tN(l,l.readVarint()+l.pos)):d===4?o.cx=l.readFloat():d===5?o.cy=l.readFloat():d===6?o.r=l.readFloat():d===7?o.fx=l.readFloat():d===8?o.fy=l.readFloat():d===9&&(o.fr=l.readFloat())}function PG(d,o,l){d===1?o.transform=I1(l,l.readVarint()+l.pos):d===2?o.clip_path_idx=l.readVarint():d===3&&o.children.push(T1(l,l.readVarint()+l.pos))}function OG(d,o,l){d===1?o.left=o.top=l.readFloat():d===2?o.width=o.height=l.readFloat():d===3?o.top=l.readFloat():d===4?o.height=l.readFloat():d===5?o.mask_type=l.readVarint():d===6?o.mask_idx=l.readVarint():d===7&&o.children.push(T1(l,l.readVarint()+l.pos))}class FG{static calculate(o={},l=[]){let u=new Map,p=new Map;if(Object.keys(o).length===0)return u;l.forEach(h=>{p.set(h.name,h.rgb_color||new Ln(0,0,0))});for(let[h,g]of Object.entries(o))p.has(h)?u.set(p.get(h).toStringPremultipliedAlpha(),g):console.warn(`Ignoring unknown image variable "${h}"`);return u}}function Jg(d,o=255,l){let u=o/255,p=d.toStringPremultipliedAlpha(),h=l.has(p)?l.get(p).clone():d.clone();return h.a*=u,h.toString()}function A0(d,o){if(!ot()){let l=document.createElement("canvas");return l.width=d,l.height=o,l}return new OffscreenCanvas(d,o)}function LG(d,o){let l=FG.calculate(o.params,d.metadata?d.metadata.variables:[]),u=d.usvg_tree,p=u.width,h=u.height,g=o.transform?o.transform:new DOMMatrix,x=Math.max(1,Math.round(p*g.a)),C=Math.max(1,Math.round(h*g.d)),D=new DOMMatrix([x/p,0,0,C/h,0,0]),v=A0(x,C).getContext("2d");return QT(v,D,u,u,l),v.getImageData(0,0,x,C)}function QT(d,o,l,u,p){for(let h of u.children)iN(d,o,l,h,p)}function iN(d,o,l,u,p){u.group?(d.save(),function(h,g,x,C,D){let v=C.mask_idx!=null?x.masks[C.mask_idx]:null,E=C.clip_path_idx!=null?x.clip_paths[C.clip_path_idx]:null;if(C.transform&&(g=R1(C.transform).preMultiplySelf(g)),!function(M,R,L){return M.opacity!==255||R||L}(C,E!=null,v!=null))return void QT(h,g,x,C,D);let T=A0(h.canvas.width,h.canvas.height),S=T.getContext("2d");QT(S,g,x,C,D),E&&cN(S,g,x,E),v&&dN(S,g,x,v,D),h.globalAlpha=C.opacity/255,h.drawImage(T,0,0)}(d,o,l,u.group,p),d.restore()):u.path&&(d.save(),function(h,g,x,C,D){let v=uN(C);h.setTransform(g),C.paint_order===QL.PAINT_ORDER_FILL_AND_STROKE?(nN(h,x,C,v,D),oN(h,x,C,v,D)):(oN(h,x,C,v,D),nN(h,x,C,v,D))}(d,o,l,u.path,p),d.restore())}function nN(d,o,l,u,p){let h=l.fill;if(!h)return;let g=h.opacity/255;switch(h.paint){case"rgb_color":d.fillStyle=Jg(h.rgb_color,h.opacity,p);break;case"linear_gradient_idx":d.fillStyle=aN(d,o.linear_gradients[h.linear_gradient_idx],g,p);break;case"radial_gradient_idx":d.fillStyle=sN(d,o.radial_gradients[h.radial_gradient_idx],g,p)}d.fill(u,rN(l))}function rN(d){return d.rule===KT.PATH_RULE_NON_ZERO?"nonzero":d.rule===KT.PATH_RULE_EVEN_ODD?"evenodd":void 0}function oN(d,o,l,u,p){let h=l.stroke;if(!h)return;d.lineWidth=h.width,d.miterLimit=h.miterlimit,d.setLineDash(h.dasharray),d.lineDashOffset=h.dashoffset;let g=h.opacity/255;switch(h.paint){case"rgb_color":d.strokeStyle=Jg(h.rgb_color,h.opacity,p);break;case"linear_gradient_idx":d.strokeStyle=aN(d,o.linear_gradients[h.linear_gradient_idx],g,p);break;case"radial_gradient_idx":d.strokeStyle=sN(d,o.radial_gradients[h.radial_gradient_idx],g,p)}switch(h.linejoin){case I0.LINE_JOIN_MITER_CLIP:case I0.LINE_JOIN_MITER:d.lineJoin="miter";break;case I0.LINE_JOIN_ROUND:d.lineJoin="round";break;case I0.LINE_JOIN_BEVEL:d.lineJoin="bevel"}switch(h.linecap){case M1.LINE_CAP_BUTT:d.lineCap="butt";break;case M1.LINE_CAP_ROUND:d.lineCap="round";break;case M1.LINE_CAP_SQUARE:d.lineCap="square"}d.stroke(u)}function aN(d,o,l,u){if(o.stops.length===1){let T=o.stops[0];return Jg(T.rgb_color,T.opacity*l,u)}let p=R1(o.transform),{x1:h,y1:g,x2:x,y2:C}=o,D=p.transformPoint(new DOMPoint(h,g)),v=p.transformPoint(new DOMPoint(x,C)),E=d.createLinearGradient(D.x,D.y,v.x,v.y);for(let T of o.stops)E.addColorStop(T.offset,Jg(T.rgb_color,T.opacity*l,u));return E}function sN(d,o,l,u){if(o.stops.length===1){let T=o.stops[0];return Jg(T.rgb_color,T.opacity*l,u)}let p=R1(o.transform),{fx:h,fy:g,cx:x,cy:C}=o,D=p.transformPoint(new DOMPoint(h,g)),v=p.transformPoint(new DOMPoint(x,C)),E=d.createRadialGradient(D.x,D.y,0,v.x,v.y,o.r*((p.a+p.d)/2));for(let T of o.stops)E.addColorStop(T.offset,Jg(T.rgb_color,T.opacity*l,u));return E}function lN(d,o,l,u){let p=u.transform?R1(u.transform).preMultiplySelf(o):o,h=A0(d.canvas.width,d.canvas.height),g=h.getContext("2d");for(let C of u.children)if(C.group)lN(g,p,l,C.group);else if(C.path){let D=C.path,v=new Path2D;v.addPath(uN(D),p),g.fill(v,rN(D))}let x=u.clip_path_idx!=null?l.clip_paths[u.clip_path_idx]:null;x&&cN(g,p,l,x),d.globalCompositeOperation="source-over",d.drawImage(h,0,0)}function cN(d,o,l,u){let p=A0(d.canvas.width,d.canvas.height);lN(p.getContext("2d"),o,l,u),d.globalCompositeOperation="destination-in",d.drawImage(p,0,0)}function dN(d,o,l,u,p){if(u.children.length===0)return;let h=u.mask_idx!=null?l.masks[u.mask_idx]:null;h&&dN(d,o,l,h,p);let g=d.canvas.width,x=d.canvas.height,C=A0(g,x),D=C.getContext("2d"),v=u.width,E=u.height,T=u.left,S=u.top,M=new Path2D,R=new Path2D;R.rect(T,S,v,E),M.addPath(R,o),D.clip(M);for(let $ of u.children)iN(D,o,l,$,p);let L=D.getImageData(0,0,g,x),N=L.data;if(u.mask_type===JL.MASK_TYPE_LUMINANCE)for(let $=0;$<N.length;$+=4)N[$+3]=N[$+3]/255*(.2126*N[$]+.7152*N[$+1]+.0722*N[$+2]);D.putImageData(L,0,0),d.globalCompositeOperation="destination-in",d.drawImage(C,0,0)}function R1(d){return d?new DOMMatrix([d.sx,d.ky,d.kx,d.sy,d.tx,d.ty]):new DOMMatrix}function uN(d){let o=new Path2D,l=d.step,u=d.diffs[0]*l,p=d.diffs[1]*l;o.moveTo(u,p);for(let h=0,g=2;h<d.commands.length;h++)switch(d.commands[h]){case Qg.PATH_COMMAND_MOVE:u+=d.diffs[g++]*l,p+=d.diffs[g++]*l,o.moveTo(u,p);break;case Qg.PATH_COMMAND_LINE:u+=d.diffs[g++]*l,p+=d.diffs[g++]*l,o.lineTo(u,p);break;case Qg.PATH_COMMAND_QUAD:{let x=u+d.diffs[g++]*l,C=p+d.diffs[g++]*l;u=x+d.diffs[g++]*l,p=C+d.diffs[g++]*l,o.quadraticCurveTo(x,C,u,p);break}case Qg.PATH_COMMAND_CUBIC:{let x=u+d.diffs[g++]*l,C=p+d.diffs[g++]*l,D=x+d.diffs[g++]*l,v=C+d.diffs[g++]*l;u=D+d.diffs[g++]*l,p=v+d.diffs[g++]*l,o.bezierCurveTo(x,C,D,v,u,p);break}case Qg.PATH_COMMAND_CLOSE:o.closePath()}return o}class k1{constructor(o){this.capacity=o,this.cache=new Map}get(o){if(!this.cache.has(o))return;let l=this.cache.get(o);return this.cache.delete(o),this.cache.set(o,l),l}put(o,l){this.cache.has(o)?this.cache.delete(o):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(o,l)}delete(o){this.cache.delete(o)}}$t(k1,"LRUCache");class JT{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(o){return new ta(o,o.data)}getFromCache(o,l,u){return this.cacheMap.has(u)||this.cacheMap.set(u,new k1(150)),this.cacheMap.get(u).get(Dh(o.toString(),l))}setInCache(o,l,u,p){this.cacheDependenciesMap.has(p)||this.cacheDependenciesMap.set(p,new Map),this.cacheMap.has(p)||this.cacheMap.set(p,new k1(150));let h=this.cacheDependenciesMap.get(p),g=Dh(o.id.toString(),u);h.get(g)||h.set(g,new Set);let x=this.cacheMap.get(p),C=o.toString();h.get(g).add(C),x.put(Dh(o.toString(),u),l)}removeImagesFromCacheByIds(o,l,u=0){if(!this.cacheMap.has(u)||!this.cacheDependenciesMap.has(u))return;let p=this.cacheMap.get(u),h=this.cacheDependenciesMap.get(u);for(let g of o){let x=Dh(g.toString(),l);if(h.has(x)){for(let C of h.get(x))p.delete(C);h.delete(x)}}}rasterize(o,l,u,p,h=LG){let g=this.getFromCache(o,u,p);if(g)return g.clone();let x=h(l.icon,o.options),C=JT._getImage(x);return this.setInCache(o,C,u,p),C.clone()}}class hN{constructor(o){this.size=o,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(o,l){let u=this.toIdx(o,l);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(o,l){return this.leaves[this.toIdx(o,l)]}toIdx(o,l){return l*this.size+o}}function pN(d,o,l,u){let p=0,h=Number.MAX_VALUE;for(let g=0;g<3;g++)if(Math.abs(u[g])<1e-15){if(l[g]<d[g]||l[g]>o[g])return null}else{let x=1/u[g],C=(d[g]-l[g])*x,D=(o[g]-l[g])*x;if(C>D){let v=C;C=D,D=v}if(C>p&&(p=C),D<h&&(h=D),p>h)return null}return p}function fN(d,o,l,u,p,h,g,x,C,D,v){let E=u-d,T=p-o,S=h-l,M=g-d,R=x-o,L=C-l,N=v[1]*L-v[2]*R,$=v[2]*M-v[0]*L,H=v[0]*R-v[1]*M,j=E*N+T*$+S*H;if(Math.abs(j)<1e-15)return null;let q=1/j,Y=D[0]-d,Q=D[1]-o,pe=D[2]-l,de=(Y*N+Q*$+pe*H)*q;if(de<0||de>1)return null;let ue=Q*S-pe*T,De=pe*E-Y*S,fe=Y*T-Q*E,Me=(v[0]*ue+v[1]*De+v[2]*fe)*q;return Me<0||de+Me>1?null:(M*ue+R*De+L*fe)*q}function mN(d,o,l){return(d-o)/(l-o)}function gN(d,o,l,u,p,h,g,x,C){let D=1<<l,v=h-u,E=g-p,T=(d+1)/D*v+u,S=(o+0)/D*E+p,M=(o+1)/D*E+p;x[0]=(d+0)/D*v+u,x[1]=S,C[0]=T,C[1]=M}class _N{constructor(o){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=o,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;let l=function(h){let g=Math.ceil(Math.log2(h.dim/8)),x=[],C=Math.ceil(Math.pow(2,g)),D=1/C,v=(S,M,R,L,N)=>{let $=L?1:0,H=(S+1)*R-$,j=M*R,q=(M+1)*R-$;N[0]=S*R,N[1]=j,N[2]=H,N[3]=q},E=new hN(C),T=[];for(let S=0;S<C*C;S++){v(S%C,Math.floor(S/C),D,!1,T);let M=jh(T[0],T[1],h),R=jh(T[2],T[1],h),L=jh(T[2],T[3],h),N=jh(T[0],T[3],h);E.minimums.push(Math.min(M,R,L,N)),E.maximums.push(Math.max(M,R,L,N)),E.leaves.push(1)}for(x.push(E),C/=2;C>=1;C/=2){let S=x[x.length-1];E=new hN(C);for(let M=0;M<C*C;M++){v(M%C,Math.floor(M/C),2,!0,T);let R=S.getElevation(T[0],T[1]),L=S.getElevation(T[2],T[1]),N=S.getElevation(T[2],T[3]),$=S.getElevation(T[0],T[3]),H=S.isLeaf(T[0],T[1]),j=S.isLeaf(T[2],T[1]),q=S.isLeaf(T[2],T[3]),Y=S.isLeaf(T[0],T[3]),Q=Math.min(R.min,L.min,N.min,$.min),pe=Math.max(R.max,L.max,N.max,$.max),de=H&&j&&q&&Y;E.maximums.push(pe),E.minimums.push(Q),E.leaves.push(pe-Q<=5&&de?1:0)}x.push(E)}return x}(this.dem),u=l.length-1,p=l[u];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(l,0,0,u,0)}raycastRoot(o,l,u,p,h,g,x=1){return pN([o,l,-100],[u,p,this.maximums[0]*x],h,g)}raycast(o,l,u,p,h,g,x=1){if(!this.nodeCount)return null;let C=this.raycastRoot(o,l,u,p,h,g,x);if(C==null)return null;let D=[],v=[],E=[],T=[],S=[{idx:0,t:C,nodex:0,nodey:0,depth:0}];for(;S.length>0;){let{idx:M,t:R,nodex:L,nodey:N,depth:$}=S.pop();if(this.leaves[M]){gN(L,N,$,o,l,u,p,E,T);let j=1<<$,q=(L+0)/j,Y=(L+1)/j,Q=(N+0)/j,pe=(N+1)/j,de=jh(q,Q,this.dem)*x,ue=jh(Y,Q,this.dem)*x,De=jh(Y,pe,this.dem)*x,fe=jh(q,pe,this.dem)*x,Me=fN(E[0],E[1],de,T[0],E[1],ue,T[0],T[1],De,h,g),Fe=fN(T[0],T[1],De,E[0],T[1],fe,E[0],E[1],de,h,g),Pe=Math.min(Me!==null?Me:Number.MAX_VALUE,Fe!==null?Fe:Number.MAX_VALUE);if(Pe!==Number.MAX_VALUE)return Pe;{let ze=ce.vec3.scaleAndAdd([],h,g,R);if(yN(de,ue,fe,De,mN(ze[0],E[0],T[0]),mN(ze[1],E[1],T[1]))>=ze[2])return R}continue}let H=0;for(let j=0;j<this._siblingOffset.length;j++){gN((L<<1)+this._siblingOffset[j][0],(N<<1)+this._siblingOffset[j][1],$+1,o,l,u,p,E,T),E[2]=-100,T[2]=this.maximums[this.childOffsets[M]+j]*x;let q=pN(E,T,h,g);if(q!=null){let Y=q;D[j]=Y;let Q=!1;for(let pe=0;pe<H&&!Q;pe++)Y>=D[v[pe]]&&(v.splice(pe,0,j),Q=!0);Q||(v[H]=j),H++}}for(let j=0;j<H;j++){let q=v[j];S.push({idx:this.childOffsets[M]+q,t:D[q],nodex:(L<<1)+this._siblingOffset[q][0],nodey:(N<<1)+this._siblingOffset[q][1],depth:$+1})}}return null}_addNode(o,l,u){return this.minimums.push(o),this.maximums.push(l),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(o,l,u,p,h){if(o[p].isLeaf(l,u)===1)return;this.childOffsets[h]||(this.childOffsets[h]=this.nodeCount);let g=p-1,x=o[g],C=0,D=0;for(let v=0;v<this._siblingOffset.length;v++){let E=2*l+this._siblingOffset[v][0],T=2*u+this._siblingOffset[v][1],S=x.getElevation(E,T),M=x.isLeaf(E,T),R=this._addNode(S.min,S.max,M);M&&(C|=1<<v),D||(D=R)}for(let v=0;v<this._siblingOffset.length;v++)C&1<<v||this._construct(o,2*l+this._siblingOffset[v][0],2*u+this._siblingOffset[v][1],g,D+v)}}function yN(d,o,l,u,p,h){return yi(yi(d,l,h),yi(o,u,h),p)}function jh(d,o,l){let u=l.dim,p=qi(d*u-.5,0,u-1),h=qi(o*u-.5,0,u-1),g=Math.floor(p),x=Math.floor(h),C=Math.min(g+1,u-1),D=Math.min(x+1,u-1);return yN(l.get(g,x),l.get(C,x),l.get(g,D),l.get(C,D),p-g,h-x)}let NG={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function zG(d,o,l){return(256*d*256+256*o+l)/10-1e4}function BG(d,o,l){return 256*d+o+l/256-32768}class P1{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(o,l,u,p=!1){if(this.uid=o,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return void Er(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;let h=this.dim=l.height-2,g=new Uint32Array(l.data.buffer);if(this.pixels=new Uint8Array(l.data.buffer),this.floatView=new Float32Array(l.data.buffer),this.borderReady=p,this._modifiedForSources={},!p){for(let C=0;C<h;C++)g[this._idx(-1,C)]=g[this._idx(0,C)],g[this._idx(h,C)]=g[this._idx(h-1,C)],g[this._idx(C,-1)]=g[this._idx(C,0)],g[this._idx(C,h)]=g[this._idx(C,h-1)];g[this._idx(-1,-1)]=g[this._idx(0,0)],g[this._idx(h,-1)]=g[this._idx(h-1,0)],g[this._idx(-1,h)]=g[this._idx(0,h-1)],g[this._idx(h,h)]=g[this._idx(h-1,h-1)]}let x=u==="terrarium"?BG:zG;for(let C=0;C<g.length;++C){let D=4*C;this.floatView[C]=x(this.pixels[D],this.pixels[D+1],this.pixels[D+2])}this._timestamp=it.now()}_buildQuadTree(){this._tree=new _N(this)}get(o,l,u=!1){u&&(o=qi(o,-1,this.dim),l=qi(l,-1,this.dim));let p=this._idx(o,l);return this.floatView[p]}set(o,l,u){let p=this._idx(o,l),h=this.floatView[p];return this.floatView[p]=u,u-h}static getUnpackVector(o){return NG[o]}_idx(o,l){if(o<-1||o>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(o+1)}static pack(o,l){let u=[0,0,0,0],p=P1.getUnpackVector(l),h=Math.floor((o+p[3])/p[2]);return u[2]=h%256,h=Math.floor(h/256),u[1]=h%256,h=Math.floor(h/256),u[0]=h,u}getPixels(){return new MO({width:this.stride,height:this.stride},this.pixels)}backfillBorder(o,l,u){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let p=l*this.dim,h=l*this.dim+this.dim,g=u*this.dim,x=u*this.dim+this.dim;switch(l){case-1:p=h-1;break;case 1:h=p+1}switch(u){case-1:g=x-1;break;case 1:x=g+1}let C=-l*this.dim,D=-u*this.dim;for(let v=g;v<x;v++)for(let E=p;E<h;E++){let T=4*this._idx(E,v),S=4*this._idx(E+C,v+D);this.pixels[T+0]=o.pixels[S+0],this.pixels[T+1]=o.pixels[S+1],this.pixels[T+2]=o.pixels[S+2],this.pixels[T+3]=o.pixels[S+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function VG(d,o,l){d===1?o.headerLength=l.readFixed32():d===2?o.x=l.readVarint():d===3?o.y=l.readVarint():d===4?o.z=l.readVarint():d===5&&o.layers.push(function(u,p){return u.readFields(GG,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},p)}(l,l.readVarint()+l.pos))}function jG(d,o,l){d===1?(o.delta_filter=function(u,p){return u.readFields(UG,{blockSize:0},p)}(l,l.readVarint()+l.pos),o.filter="delta_filter"):d===2?(l.readVarint(),o.filter="zigzag_filter"):d===3?(l.readVarint(),o.filter="bitshuffle_filter"):d===4&&(l.readVarint(),o.filter="byteshuffle_filter")}function UG(d,o,l){d===1&&(o.blockSize=l.readVarint())}function HG(d,o,l){d===1?(l.readVarint(),o.codec="gzip_data"):d===2?(l.readVarint(),o.codec="jpeg_image"):d===3?(l.readVarint(),o.codec="webp_image"):d===4&&(l.readVarint(),o.codec="png_image")}function $G(d,o,l){let u=0,p=0;d===1?o.firstByte=l.readFixed64():d===2?o.lastByte=l.readFixed64():d===3?o.filters.push(function(h,g){return h.readFields(jG,{},g)}(l,l.readVarint()+l.pos)):d===4?o.codec=function(h,g){return h.readFields(HG,{},g)}(l,l.readVarint()+l.pos):d===5?p=l.readFloat():d===6?u=l.readFloat():d===7?o.bands.push(l.readString()):d===8?o.offset=l.readDouble():d===9&&(o.scale=l.readDouble()),o.offset===0&&(o.offset=p),o.scale===0&&(o.scale=u)}function GG(d,o,l){d===1?o.version=l.readVarint():d===2?o.name=l.readString():d===3?o.units=l.readString():d===4?o.tileSize=l.readVarint():d===5?o.buffer=l.readVarint():d===6?o.pixelFormat=l.readVarint():d===7&&o.dataIndex.push(function(u,p){return u.readFields($G,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},p)}(l,l.readVarint()+l.pos))}function qG(d,o,l){if(d===2)(function(u,p,h){u.readFields(WG,h,p)})(l,l.readVarint()+l.pos,o);else if(d===3)throw new Error("Not implemented")}function WG(d,o,l){if(d===1){let u=0,p=l.readVarint()+l.pos;for(;l.pos<p;)o[u++]=l.readVarint()}}function YG(d,o){if(o.length!==4)throw new Error(`Expected data of dimension 4 but got ${o.length}.`);let l=o[3];for(let u=2;u>=1;u--){let p=u===1?1:0,h=u===2?1:0;for(let g=0;g<o[0];g++){let x=o[1]*g;for(let C=p;C<o[1];C++){let D=o[2]*(C+x);for(let v=h;v<o[2];v++){let E=o[3]*(v+D);for(let T=0;T<o[3];T++){let S=E+T;d[S]+=d[S-l]}}}}l*=o[u]}return d}function ZG(d){for(let o=0,l=d.length;o<l;o++)d[o]=d[o]>>>1^-(1&d[o]);return d}function XG(d,o){switch(o){case"uint32":return d;case"uint16":for(let l=0;l<d.length;l+=2){let u=d[l],p=d[l+1];d[l]=(240&u)>>4|(61440&u)>>8|(240&p)<<4|61440&p,d[l+1]=15&u|(3840&u)>>4|(15&p)<<8|(3840&p)<<4}return d;case"uint8":for(let l=0;l<d.length;l+=4){let u=d[l],p=d[l+1],h=d[l+2],g=d[l+3];d[l+0]=(192&u)>>6|(192&p)>>4|(192&h)>>2|192&g,d[l+1]=(48&u)>>4|(48&p)>>2|48&h|(48&g)<<2,d[l+2]=(12&u)>>2|12&p|(12&h)<<2|(12&g)<<4,d[l+3]=3&u|(3&p)<<2|(3&h)<<4|(3&g)<<6}return d;default:throw new Error(`Invalid pixel format, "${o}"`)}}$t(P1,"DEMData"),$t(_N,"DemMinMaxQuadTree",{omit:["dem"]});var yl=Uint8Array,R0=Uint16Array,KG=Int32Array,vN=new yl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),bN=new yl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),QG=new yl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),xN=function(d,o){for(var l=new R0(31),u=0;u<31;++u)l[u]=o+=1<<d[u-1];var p=new KG(l[30]);for(u=1;u<30;++u)for(var h=l[u];h<l[u+1];++h)p[h]=h-l[u]<<5|u;return{b:l,r:p}},wN=xN(vN,2),CN=wN.b,JG=wN.r;CN[28]=258,JG[258]=28;for(var eq=xN(bN,0).b,EN=new R0(32768),ao=0;ao<32768;++ao){var e_=(43690&ao)>>1|(21845&ao)<<1;EN[ao]=((65280&(e_=(61680&(e_=(52428&e_)>>2|(13107&e_)<<2))>>4|(3855&e_)<<4))>>8|(255&e_)<<8)>>1}var k0=function(d,o,l){for(var u=d.length,p=0,h=new R0(o);p<u;++p)d[p]&&++h[d[p]-1];var g,x=new R0(o);for(p=1;p<o;++p)x[p]=x[p-1]+h[p-1]<<1;g=new R0(1<<o);var C=15-o;for(p=0;p<u;++p)if(d[p])for(var D=p<<4|d[p],v=o-d[p],E=x[d[p]-1]++<<v,T=E|(1<<v)-1;E<=T;++E)g[EN[E]>>C]=D;return g},P0=new yl(288);for(ao=0;ao<144;++ao)P0[ao]=8;for(ao=144;ao<256;++ao)P0[ao]=9;for(ao=256;ao<280;++ao)P0[ao]=7;for(ao=280;ao<288;++ao)P0[ao]=8;var SN=new yl(32);for(ao=0;ao<32;++ao)SN[ao]=5;var tq=k0(P0,9),iq=k0(SN,5),eI=function(d){for(var o=d[0],l=1;l<d.length;++l)d[l]>o&&(o=d[l]);return o},Ac=function(d,o,l){var u=o/8|0;return(d[u]|d[u+1]<<8)>>(7&o)&l},tI=function(d,o){var l=o/8|0;return(d[l]|d[l+1]<<8|d[l+2]<<16)>>(7&o)},nq=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Rc=function(d,o,l){var u=new Error(o||nq[d]);if(u.code=d,Error.captureStackTrace&&Error.captureStackTrace(u,Rc),!l)throw u;return u},rq=new yl(0),oq=typeof TextDecoder<"u"&&new TextDecoder;try{oq.decode(rq,{stream:!0})}catch{}let aq={gzip_data:"gzip"};class Bl extends Error{constructor(o){super(o),this.name="MRTError"}}let sq={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},DN={uint32:1,uint16:2,uint8:4},lq={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array},iI;class O1{constructor(o=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=o}getLayer(o){let l=this.layers[o];if(!l)throw new Bl(`Layer '${o}' not found`);return l}getHeaderLength(o){let l=new Uint8Array(o),u=new DataView(o);if(l[0]!==13)throw new Bl("File is not a valid MRT.");return u.getUint32(1,!0)}parseHeader(o){let l=new Uint8Array(o),u=this.getHeaderLength(o);if(l.length<u)throw new Bl(`Expected header with length >= ${u} but got buffer of length ${l.length}`);let p=function(h,g){return h.readFields(VG,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new iI(l.subarray(0,u)));if(!isNaN(this.x)&&(this.x!==p.x||this.y!==p.y||this.z!==p.z))throw new Bl(`Invalid attempt to parse header ${p.z}/${p.x}/${p.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=p.x,this.y=p.y,this.z=p.z;for(let h of p.layers)this.layers[h.name]=new MN(h,{cacheSize:this._cacheSize});return this}createDecodingTask(o){let l=[],u=this.getLayer(o.layerName);for(let p of o.blockIndices){let h=u.dataIndex[p],g=h.firstByte-o.firstByte,x=h.lastByte-o.firstByte;if(u._blocksInProgress.has(p))continue;let C={layerName:u.name,firstByte:g,lastByte:x,pixelFormat:u.pixelFormat,blockIndex:p,blockShape:[h.bands.length].concat(u.bandShape),buffer:u.buffer,codec:h.codec.codec,filters:h.filters.map(D=>D.filter)};u._blocksInProgress.add(p),l.push(C)}return new TN(l,()=>{l.forEach(p=>u._blocksInProgress.delete(p.blockIndex))},(p,h)=>{if(l.forEach(g=>u._blocksInProgress.delete(g.blockIndex)),p)throw p;h.forEach(g=>{this.getLayer(g.layerName).processDecodedData(g)})})}}class MN{constructor({version:o,name:l,units:u,tileSize:p,pixelFormat:h,buffer:g,dataIndex:x},C){if(this.version=o,this.version!==1)throw new Bl(`Cannot parse raster layer encoded with MRT version ${o}`);this.name=l,this.units=u,this.tileSize=p,this.buffer=g,this.pixelFormat=sq[h],this.dataIndex=x,this.bandShape=[p+2*g,p+2*g,DN[this.pixelFormat]],this._decodedBlocks=new k1(C?C.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return DN[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:o})=>o).flat()}processDecodedData(o){let l=o.blockIndex.toString();this._decodedBlocks.get(l)||this._decodedBlocks.put(l,o.data)}getBlockForBand(o){let l=0;switch(typeof o){case"string":for(let[u,p]of this.dataIndex.entries()){for(let[h,g]of p.bands.entries())if(g===o)return{bandIndex:l+h,blockIndex:u,blockBandIndex:h};l+=p.bands.length}break;case"number":for(let[u,p]of this.dataIndex.entries()){if(o>=l&&o<l+p.bands.length)return{bandIndex:o,blockIndex:u,blockBandIndex:o-l};l+=p.bands.length}break;default:throw new Bl(`Invalid band \`${JSON.stringify(o)}\`. Expected string or integer.`)}throw new Bl(`Band not found: ${JSON.stringify(o)}`)}getDataRange(o){let l=1/0,u=-1/0,p=[],h=new Set;for(let g of o){let{blockIndex:x}=this.getBlockForBand(g);if(x<0)throw new Bl(`Invalid band: ${JSON.stringify(g)}`);let C=this.dataIndex[x];p.includes(x)||p.push(x),h.add(x),l=Math.min(l,C.firstByte),u=Math.max(u,C.lastByte)}if(h.size>this.cacheSize)throw new Bl(`Number of blocks to decode (${h.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:l,lastByte:u,blockIndices:p}}hasBand(o){let{blockIndex:l}=this.getBlockForBand(o);return l>=0}hasDataForBand(o){let{blockIndex:l}=this.getBlockForBand(o);return l>=0&&!!this._decodedBlocks.get(l.toString())}getBandView(o){let{blockIndex:l,blockBandIndex:u}=this.getBlockForBand(o),p=this._decodedBlocks.get(l.toString());if(!p)throw new Bl(`Data for band ${JSON.stringify(o)} of layer "${this.name}" not decoded.`);let h=this.dataIndex[l],g=this.bandShape.reduce((D,v)=>D*v,1),x=u*g,C=p.subarray(x,x+g);return{data:C,bytes:new Uint8Array(C.buffer).subarray(C.byteOffset,C.byteOffset+C.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:h.offset,scale:h.scale}}}O1.setPbf=function(d){iI=d};class TN{constructor(o,l,u){this.tasks=o,this._onCancel=l,this._onComplete=u,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(o,l){this._finalized||(this._onComplete(o,l),this._finalized=!0)}}O1.performDecoding=function(d,o){let l=new Uint8Array(d);return Promise.all(o.tasks.map(u=>{let{layerName:p,firstByte:h,lastByte:g,pixelFormat:x,blockShape:C,blockIndex:D,filters:v,codec:E}=u,T=l.subarray(h,g+1),S=new Uint32Array(C[0]*C[1]*C[2]),M;if(E!=="gzip_data")throw new Bl(`Unhandled codec: ${E}`);return M=function(R,L){if(!globalThis.DecompressionStream&&L==="gzip_data")return Promise.resolve(((j=function(Q){Q[0]==31&&Q[1]==139&&Q[2]==8||Rc(6,"invalid gzip data");var pe=Q[3],de=10;4&pe&&(de+=2+(Q[10]|Q[11]<<8));for(var ue=(pe>>3&1)+(pe>>4&1);ue>0;ue-=!Q[de++]);return de+(2&pe)}(H=R))+8>H.length&&Rc(6,"invalid gzip data"),function(Q,pe,de,ue){var De=Q.length;if(!De||pe.f&&!pe.l)return de||new yl(0);var fe=!de,Me=fe||pe.i!=2,Fe=pe.i;fe&&(de=new yl(3*De));var Pe,ze,Ne=function(Hh){var $h=de.length;if(Hh>$h){var Vf=new yl(Math.max(2*$h,Hh));Vf.set(de),de=Vf}},Ge=pe.f||0,Ue=pe.p||0,qe=pe.b||0,gt=pe.l,ft=pe.d,Gt=pe.m,wt=pe.n,Rt=8*De;do{if(!gt){Ge=Ac(Q,Ue,1);var yt=Ac(Q,Ue+1,3);if(Ue+=3,!yt){var mi=Q[(Ei=4+((Ue+7)/8|0))-4]|Q[Ei-3]<<8,jt=Ei+mi;if(jt>De){Fe&&Rc(0);break}Me&&Ne(qe+mi),de.set(Q.subarray(Ei,jt),qe),pe.b=qe+=mi,pe.p=Ue=8*jt,pe.f=Ge;continue}if(yt==1)gt=tq,ft=iq,Gt=9,wt=5;else if(yt==2){var Jt=Ac(Q,Ue,31)+257,Ci=Ac(Q,Ue+10,15)+4,Wi=Jt+Ac(Q,Ue+5,31)+1;Ue+=14;for(var Di=new yl(Wi),en=new yl(19),Gi=0;Gi<Ci;++Gi)en[QG[Gi]]=Ac(Q,Ue+3*Gi,7);Ue+=3*Ci;var rn=eI(en),yn=(1<<rn)-1,nr=k0(en,rn);for(Gi=0;Gi<Wi;){var Ei,cn=nr[Ac(Q,Ue,yn)];if(Ue+=15&cn,(Ei=cn>>4)<16)Di[Gi++]=Ei;else{var pr=0,br=0;for(Ei==16?(br=3+Ac(Q,Ue,3),Ue+=2,pr=Di[Gi-1]):Ei==17?(br=3+Ac(Q,Ue,7),Ue+=3):Ei==18&&(br=11+Ac(Q,Ue,127),Ue+=7);br--;)Di[Gi++]=pr}}var Dr=Di.subarray(0,Jt),Rr=Di.subarray(Jt);Gt=eI(Dr),wt=eI(Rr),gt=k0(Dr,Gt),ft=k0(Rr,wt)}else Rc(1);if(Ue>Rt){Fe&&Rc(0);break}}Me&&Ne(qe+131072);for(var Jn=(1<<Gt)-1,So=(1<<wt)-1,$a=Ue;;$a=Ue){var Qr=(pr=gt[tI(Q,Ue)&Jn])>>4;if((Ue+=15&pr)>Rt){Fe&&Rc(0);break}if(pr||Rc(2),Qr<256)de[qe++]=Qr;else{if(Qr==256){$a=Ue,gt=null;break}var so=Qr-254;Qr>264&&(so=Ac(Q,Ue,(1<<(vl=vN[Gi=Qr-257]))-1)+CN[Gi],Ue+=vl);var wa=ft[tI(Q,Ue)&So],Go=wa>>4;if(wa||Rc(3),Ue+=15&wa,Rr=eq[Go],Go>3){var vl=bN[Go];Rr+=tI(Q,Ue)&(1<<vl)-1,Ue+=vl}if(Ue>Rt){Fe&&Rc(0);break}Me&&Ne(qe+131072);var Uh=qe+so;if(qe<Rr){var Vl=0-Rr,Pc=Math.min(Rr,Uh);for(Vl+qe<0&&Rc(3);qe<Pc;++qe)de[qe]=(void 0)[Vl+qe]}for(;qe<Uh;++qe)de[qe]=de[qe-Rr]}}pe.l=gt,pe.p=$a,pe.b=qe,pe.f=Ge,gt&&(Ge=1,pe.m=Gt,pe.d=ft,pe.n=wt)}while(!Ge);return qe!=de.length&&fe?(Pe=de,((ze=qe)==null||ze>Pe.length)&&(ze=Pe.length),new yl(Pe.subarray(0,ze))):de.subarray(0,qe)}(H.subarray(j,-8),{i:2},new yl(((N=H)[($=N.length)-4]|N[$-3]<<8|N[$-2]<<16|N[$-1]<<24)>>>0))));var N,$,H,j;let q=aq[L];if(!q)throw new Error(`Unhandled codec: ${L}`);let Y=new globalThis.DecompressionStream(q);return new Response(new Blob([R]).stream().pipeThrough(Y)).arrayBuffer().then(Q=>new Uint8Array(Q))}(T,E).then(R=>(function(L,N){L.readFields(qG,N)}(new iI(R),S),new lq[x](S.buffer))),M.then(R=>{for(let L=v.length-1;L>=0;L--)switch(v[L]){case"delta_filter":YG(R,C);break;case"zigzag_filter":ZG(R);break;case"bitshuffle_filter":XG(R,x);break;default:throw new Bl(`Unhandled filter "${v[L]}"`)}return{layerName:p,blockIndex:D,data:R}}).catch(R=>{throw R})}))},$t(TN,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),$t(O1,"MapboxRasterTile"),$t(MN,"MapboxRasterLayer",{omit:["_blocksInProgress"]});let O0,nI,kc,t_,rI,i_=null;function IN(){return Va()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:nI||ie.DRACO_URL}function AN(){if(Va()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(t_)return t_;let d=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return t_=WebAssembly.validate(d)?ie.MESHOPT_SIMD_URL:ie.MESHOPT_URL,t_}let F1={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},cq={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},F0={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function RN(d,o,l){let u=l.json.bufferViews.length,p=l.buffers.length;o.bufferView=u,l.json.bufferViews[u]={buffer:p,byteLength:d.byteLength},l.buffers[p]=d}let oI="KHR_draco_mesh_compression";function dq(d,o){let l=d.extensions&&d.extensions[oI];if(!l)return;let u=new kc.Decoder,p=FN(o,l.bufferView),h=new kc.Mesh;if(!u.DecodeArrayToMesh(p,p.byteLength,h))throw new Error("Failed to decode Draco mesh");let g=o.json.accessors[d.indices],x=F1[g.componentType],C=g.count*x.BYTES_PER_ELEMENT,D=kc._malloc(C);x===Uint16Array?u.GetTrianglesUInt16Array(h,C,D):u.GetTrianglesUInt32Array(h,C,D),RN(kc.memory.buffer.slice(D,D+C),g,o),kc._free(D);for(let v of Object.keys(l.attributes)){let E=u.GetAttributeByUniqueId(h,l.attributes[v]),T=o.json.accessors[d.attributes[v]],S=cq[T.componentType],M=T.count*F0[T.type]*F1[T.componentType].BYTES_PER_ELEMENT,R=kc._malloc(M);u.GetAttributeDataArrayForAllPoints(h,E,kc[S],M,R),RN(kc.memory.buffer.slice(R,R+M),T,o),kc._free(R)}u.destroy(),h.destroy(),delete d.extensions[oI]}let L1="EXT_meshopt_compression";function uq(d,o){if(!d.extensions||!d.extensions[L1])return;let l=d.extensions[L1],u=new Uint8Array(o.buffers[l.buffer],l.byteOffset||0,l.byteLength||0),p=new Uint8Array(l.count*l.byteStride);rI.decodeGltfBuffer(p,l.count,l.byteStride,u,l.mode,l.filter),d.buffer=o.buffers.length,d.byteOffset=0,o.buffers[d.buffer]=p.buffer,delete d.extensions[L1]}let kN=1179937895,PN=new TextDecoder("utf8");function ON(d,o){return new URL(d,o).href}function hq(d,o,l,u){return fetch(ON(d.uri,u)).then(p=>p.arrayBuffer()).then(p=>{o.buffers[l]=p})}function FN(d,o){let l=d.json.bufferViews[o];return new Uint8Array(d.buffers[l.buffer],l.byteOffset||0,l.byteLength)}function pq(d,o,l,u){if(d.uri){let p=ON(d.uri,u);return fetch(p).then(h=>h.blob()).then(h=>createImageBitmap(h)).then(h=>{o.images[l]=h})}if(d.bufferView!==void 0){let p=FN(o,d.bufferView),h=new Blob([p],{type:d.mimeType});return createImageBitmap(h).then(g=>{o.images[l]=g})}}function LN(d,o=0,l){let u={json:null,images:[],buffers:[]};if(new Uint32Array(d,o,1)[0]===kN){let v=new Uint32Array(d,o),E=2,T=(v[E++]>>2)-3,S=v[E++]>>2;if(E++,u.json=JSON.parse(PN.decode(v.subarray(E,E+S))),E+=S,E<T){let M=v[E++];E++;let R=o+(E<<2);u.buffers[0]=d.slice(R,R+M)}}else u.json=JSON.parse(PN.decode(new Uint8Array(d,o)));let{buffers:p,images:h,meshes:g,extensionsUsed:x,bufferViews:C}=u.json,D=Promise.resolve();if(p){let v=[];for(let E=0;E<p.length;E++){let T=p[E];T.uri?v.push(hq(T,u,E,l)):u.buffers[E]||(u.buffers[E]=null)}D=Promise.all(v)}return D.then(()=>{let v=[],E=x&&x.includes(oI),T=x&&x.includes(L1);if(E&&v.push(function(){if(!kc)return O0??(O0=function(S){let M,R=null;function L(){M=new Uint8Array(R.buffer)}function N(){throw new Error("Unexpected Draco error.")}let $={a:{a:N,d:function(H,j,q){return M.copyWithin(H,j,j+q)},c:function(H){let j=M.length,q=Math.max(H>>>0,Math.ceil(1.2*j)),Y=Math.ceil((q-j)/65536);try{return R.grow(Y),L(),!0}catch{return!1}},b:N}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(S,$):S.then(H=>H.arrayBuffer()).then(H=>WebAssembly.instantiate(H,$))).then(H=>{let{Rb:j,Qb:q,P:Y,T:Q,X:pe,Ja:de,La:ue,Qa:De,Va:fe,Wa:Me,eb:Fe,jb:Pe,f:ze,e:Ne,yb:Ge,zb:Ue,Ab:qe,Bb:gt,Db:ft,Gb:Gt}=H.instance.exports;R=Ne;let wt=(()=>{let Rt=0,yt=0,mi=0,jt=0;return Jt=>{mi&&(j(jt),j(Rt),yt+=mi,mi=Rt=0),Rt||(yt+=128,Rt=q(yt));let Ci=Jt.length+7&-8,Wi=Rt;Ci>=yt&&(mi=Ci,Wi=jt=q(Ci));for(let Di=0;Di<Jt.length;Di++)M[Wi+Di]=Jt[Di];return Wi}})();return L(),ze(),{memory:Ne,_free:j,_malloc:q,Mesh:class{constructor(){this.ptr=Y()}destroy(){Q(this.ptr)}},Decoder:class{constructor(){this.ptr=de()}destroy(){Pe(this.ptr)}DecodeArrayToMesh(Rt,yt,mi){let jt=wt(Rt),Jt=ue(this.ptr,jt,yt,mi.ptr);return!!pe(Jt)}GetAttributeByUniqueId(Rt,yt){return{ptr:De(this.ptr,Rt.ptr,yt)}}GetTrianglesUInt16Array(Rt,yt,mi){fe(this.ptr,Rt.ptr,yt,mi)}GetTrianglesUInt32Array(Rt,yt,mi){Me(this.ptr,Rt.ptr,yt,mi)}GetAttributeDataArrayForAllPoints(Rt,yt,mi,jt,Jt){Fe(this.ptr,Rt.ptr,yt.ptr,mi,jt,Jt)}},DT_INT8:Ge(),DT_UINT8:Ue(),DT_INT16:qe(),DT_UINT16:gt(),DT_UINT32:ft(),DT_FLOAT32:Gt()}})}(fetch(IN())),O0.then(S=>{kc=S,O0=void 0}))}()),T&&v.push(function(){if(rI)return;let S=function(M){let R,L=WebAssembly.instantiateStreaming(M,{}).then(H=>{R=H.instance,R.exports.__wasm_call_ctors()}),N={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},$={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:L,supported:!0,decodeGltfBuffer(H,j,q,Y,Q,pe){(function(de,ue,De,fe,Me,Fe,Pe){let ze=de.exports.sbrk,Ne=fe+3&-4,Ge=ze(Ne*Me),Ue=ze(Fe.length),qe=new Uint8Array(de.exports.memory.buffer);qe.set(Fe,Ue);let gt=ue(Ge,fe,Me,Ue,Fe.length);if(gt===0&&Pe&&Pe(Ge,Ne,Me),De.set(qe.subarray(Ge,Ge+fe*Me)),ze(Ge-ze(0)),gt!==0)throw new Error(`Malformed buffer data: ${gt}`)})(R,R.exports[$[Q]],H,j,q,Y,R.exports[N[pe]])}}}(fetch(AN()));return S.ready.then(()=>{rI=S})}()),h)for(let S=0;S<h.length;S++)v.push(pq(h[S],u,S,l));return(v.length?Promise.all(v):Promise.resolve()).then(()=>{if(E&&g)for(let{primitives:S}of g)for(let M of S)dq(M,u);if(T&&g&&C)for(let S of C)uq(S,u);return u})})}function Bf(d,o){let l=d.json.bufferViews[o.bufferView],u=F1[o.componentType];return new u(d.buffers[l.buffer],(o.byteOffset||0)+(l.byteOffset||0),o.count*(l.byteStride&&l.byteStride!==F0[o.type]*u.BYTES_PER_ELEMENT?l.byteStride/u.BYTES_PER_ELEMENT:F0[o.type]))}function aI(d,o,l,u){let p=F1[o.componentType],h=function(v){switch(v){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(p),g=d.json.bufferViews[o.bufferView],x=g.byteStride?g.byteStride/p.BYTES_PER_ELEMENT:F0[o.type],C=l.float32,D=C.length/l.capacity;for(let v=0,E=0;v<o.count*x;v+=x,E+=D)for(let T=0;T<D;T++)C[E+T]=u[v+T]*h;l._trim()}function fq(d,o,l){let u=d.indices,p=d.attributes,h={};h.indexArray=new Uo;let g=o.json.accessors[u],x=g.count/3;h.indexArray.reserve(x);let C=Bf(o,g);for(let T=0;T<x;T++)h.indexArray.emplaceBack(C[3*T],C[3*T+1],C[3*T+2]);h.indexArray._trim(),h.vertexArray=new gl;let D=o.json.accessors[p.POSITION];h.vertexArray.reserve(D.count);let v=Bf(o,D);for(let T=0;T<D.count;T++)h.vertexArray.emplaceBack(v[3*T],v[3*T+1],v[3*T+2]);if(h.vertexArray._trim(),h.aabb=new ti(D.min,D.max),h.centroid=function(T,S){let M=[0,0,0],R=T.length;if(R>0){for(let L=0;L<R;L++){let N=3*T[L];M[0]+=S[N],M[1]+=S[N+1],M[2]+=S[N+2]}M[0]/=R,M[1]/=R,M[2]/=R}return M}(C,v),p.COLOR_0!==void 0){let T=o.json.accessors[p.COLOR_0],S=F0[T.type],M=Bf(o,T);h.colorArray=S===3?new gl:new lu,h.colorArray.resize(T.count),aI(o,T,h.colorArray,M)}if(p.NORMAL!==void 0){h.normalArray=new gl;let T=o.json.accessors[p.NORMAL];h.normalArray.resize(T.count);let S=Bf(o,T);aI(o,T,h.normalArray,S)}if(p.TEXCOORD_0!==void 0&&l.length>0){h.texcoordArray=new Th;let T=o.json.accessors[p.TEXCOORD_0];h.texcoordArray.resize(T.count);let S=Bf(o,T);aI(o,T,h.texcoordArray,S)}if(p._FEATURE_ID_RGBA4444!==void 0){let T=o.json.accessors[p._FEATURE_ID_RGBA4444];o.json.extensionsUsed&&o.json.extensionsUsed.includes("EXT_meshopt_compression")&&(h.featureData=Bf(o,T))}p._FEATURE_RGBA4444!==void 0&&(h.featureData=new Uint32Array(Bf(o,o.json.accessors[p._FEATURE_RGBA4444]).buffer));let E=d.material;return h.material=function(T,S){let{emissiveFactor:M=[0,0,0],alphaMode:R="OPAQUE",alphaCutoff:L=.5,normalTexture:N,occlusionTexture:$,emissiveTexture:H,doubleSided:j}=T,{baseColorFactor:q=[1,1,1,1],metallicFactor:Y=1,roughnessFactor:Q=1,baseColorTexture:pe,metallicRoughnessTexture:de}=T.pbrMetallicRoughness||{},ue=$?S[$.index]:void 0;if($&&$.extensions&&$.extensions.KHR_texture_transform&&ue){let De=$.extensions.KHR_texture_transform;ue.offsetScale=[De.offset[0],De.offset[1],De.scale[0],De.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Ln(...q),metallicFactor:Y,roughnessFactor:Q,baseColorTexture:pe?S[pe.index]:void 0,metallicRoughnessTexture:de?S[de.index]:void 0},doubleSided:j,emissiveFactor:M,alphaMode:R,alphaCutoff:L,normalTexture:N?S[N.index]:void 0,occlusionTexture:ue,emissionTexture:H?S[H.index]:void 0,defined:T.defined===void 0}}(E!==void 0?o.json.materials[E]:{defined:!1},l),h}function NN(d,o,l){let{matrix:u,rotation:p,translation:h,scale:g,mesh:x,extras:C,children:D}=d,v={};if(v.matrix=u||ce.mat4.fromRotationTranslationScale([],p||[0,0,0,1],h||[0,0,0],g||[1,1,1]),x!==void 0){v.meshes=l[x];let E=v.anchor=[0,0];for(let T of v.meshes){let{min:S,max:M}=T.aabb;E[0]+=S[0]+M[0],E[1]+=S[1]+M[1]}E[0]=Math.floor(E[0]/v.meshes.length/2),E[1]=Math.floor(E[1]/v.meshes.length/2)}if(C&&(C.id&&(v.id=C.id),C.lights&&(v.lights=function(E){if(!E.length)return[];let T=function(N){let $=atob(N),H=new Uint8Array($.length);for(let j=0;j<$.length;j++)H[j]=$.codePointAt(j);return H}(E),S=[],M=T.length/24,R=new Uint16Array(T.buffer),L=new Float32Array(T.buffer);for(let N=0;N<M;N++){let $=R[2*N*6]/30,H=R[2*N*6+1]/30,j=R[2*N*6+10]/100,q=L[6*N+1],Y=L[6*N+2],Q=L[6*N+3],pe=L[6*N+4],de=Q-q,ue=pe-Y,De=Math.hypot(de,ue);S.push({pos:[q+.5*de,Y+.5*ue,H],normal:[ue/De,-de/De,0],width:De,height:$,depth:j,points:[q,Y,Q,pe]})}return S}(C.lights))),D){let E=[];for(let T of D)E.push(NN(o.json.nodes[T],o,l));v.children=E}return v}function mq(d){if(d.vertices.length===0||d.indices.length===0)return null;let o=new pT(d.vertices,d.indices,8,256),[l,u]=[o.min.clone(),o.max.clone()];return{vertices:d.vertices,indices:d.indices,grid:o,min:l,max:u}}function gq(d){if(!d.extras||!d.extras.ground)return null;let o=d.extras.ground;if(!o||!Array.isArray(o)||o.length===0)return null;let l=o[0];if(!l||!Array.isArray(l)||l.length===0)return null;let u=[];for(let g of l){if(!Array.isArray(g)||g.length!==2)continue;let x=g[0],C=g[1];typeof x=="number"&&typeof C=="number"&&u.push(new At(x,C))}if(u.length<3)return null;u.length>1&&u[u.length-1].equals(u[0])&&u.pop();let p=0;for(let g=0;g<u.length;g++){let x=u[g],C=u[(g+1)%u.length],D=u[(g+2)%u.length];p+=(x.x-C.x)*(D.y-C.y)-(D.x-C.x)*(x.y-C.y)}p>0&&u.reverse();let h=a0(u.flatMap(g=>[g.x,g.y]),[]);return h.length===0?null:{vertices:u,indices:h}}function _q(d,o){let l=[],u=[],p=0,h=[];for(let g of d){p=l.length;let x=g.vertexArray.float32,C=g.indexArray.uint16;for(let D=0;D<g.vertexArray.length;D++)h[0]=x[3*D+0],h[1]=x[3*D+1],h[2]=x[3*D+2],ce.vec3.transformMat4(h,h,o),l.push(new At(h[0],h[1]));for(let D=0;D<3*g.indexArray.length;D++)u.push(C[D]+p)}if(u.length%3!=0)return null;for(let g=0;g<u.length;g+=3){let x=l[u[g+0]],C=l[u[g+1]],D=l[u[g+2]];(x.x-C.x)*(D.y-C.y)-(D.x-C.x)*(x.y-C.y)>0&&([u[g+1],u[g+2]]=[u[g+2],u[g+1]])}return{vertices:l,indices:u}}function zN(d){let o=function(C,D){let v=[],E=WebGL2RenderingContext;if(C.json.textures)for(let T of C.json.textures){let S={magFilter:E.LINEAR,minFilter:E.NEAREST,wrapS:E.REPEAT,wrapT:E.REPEAT};T.sampler!==void 0&&Object.assign(S,C.json.samplers[T.sampler]),v.push({image:D[T.source],sampler:S,uploaded:!1})}return v}(d,d.images),l=function(C,D){let v=[];for(let E of C.json.meshes){let T=[];for(let S of E.primitives)T.push(fq(S,C,D));v.push(T)}return v}(d,o),{scenes:u,scene:p,nodes:h}=d.json,g=u?u[p||0].nodes:h,x=[];for(let C of g)x.push(NN(h[C],d,l));return function(C,D,v){let E={},T=new Set;for(let S=0;S<C.length;S++){let M=v[D[S]];if(!M.extras)continue;let R=M.extras["mapbox:footprint:version"],L=M.extras["mapbox:footprint:id"];(R||L)&&T.add(S),R==="1.0.0"&&L&&(E[L]=S)}for(let S=0;S<C.length;S++){if(T.has(S))continue;let M=C[S],R=v[D[S]];if(!R.extras)continue;let L=null;M.id in E&&(L=_q(C[E[M.id]].meshes,M.matrix)),L||(L=gq(R)),L&&(M.footprint=mq(L))}if(T.size>0){let S=Array.from(T.values()).sort((M,R)=>M-R);for(let M=S.length-1;M>=0;M--)C.splice(S[M],1)}}(x,g,d.json.nodes),x}function yq(d){d.heightmap=new Float32Array(4096),d.heightmap.fill(-1);let o=d.vertexArray.float32,l=d.aabb.min[0]-1,u=d.aabb.min[1]-1,p=Nf/(d.aabb.max[0]-l+2),h=Nf/(d.aabb.max[1]-u+2);for(let g=0;g<o.length;g+=3){let x=o[g+2],C=(o[g+0]-l)*p|0,D=(o[g+1]-u)*h|0;x>d.heightmap[D*Nf+C]&&(d.heightmap[D*Nf+C]=x)}}function vq(d,o){let l={};l.indexArray=new Uo,l.indexArray.reserve(4*d.length),l.vertexArray=new gl,l.vertexArray.reserve(10*d.length),l.colorArray=new lu,l.vertexArray.reserve(10*d.length);let u=0;for(let g of d){let x=Math.min(10,Math.max(4,1.3*g.height))*o,C=[-g.normal[1],g.normal[0],0],D=Math.min(.29,.1*g.width/g.depth),v=g.width-2*g.depth*o*(D+.01),E=ce.vec3.scaleAndAdd([],g.pos,C,v/2),T=ce.vec3.scaleAndAdd([],g.pos,C,-v/2),S=[E[0],E[1],E[2]+g.height],M=[T[0],T[1],T[2]+g.height],R=ce.vec3.scaleAndAdd([],g.normal,C,D);ce.vec3.scale(R,R,x);let L=ce.vec3.scaleAndAdd([],g.normal,C,-D);ce.vec3.scale(L,L,x),ce.vec3.add(R,E,R),ce.vec3.add(L,T,L),E[2]+=.1,T[2]+=.1,l.vertexArray.emplaceBack(R[0],R[1],R[2]),l.vertexArray.emplaceBack(L[0],L[1],L[2]),l.vertexArray.emplaceBack(E[0],E[1],E[2]),l.vertexArray.emplaceBack(T[0],T[1],T[2]),l.vertexArray.emplaceBack(S[0],S[1],S[2]),l.vertexArray.emplaceBack(M[0],M[1],M[2]),l.vertexArray.emplaceBack(E[0],E[1],E[2]),l.vertexArray.emplaceBack(T[0],T[1],T[2]),l.vertexArray.emplaceBack(R[0],R[1],R[2]),l.vertexArray.emplaceBack(L[0],L[1],L[2]);let N=v/x/2;l.colorArray.emplaceBack(-N-D,-1,N,.8),l.colorArray.emplaceBack(N+D,-1,N,.8),l.colorArray.emplaceBack(-N,0,N,1.3),l.colorArray.emplaceBack(N,0,N,1.3),l.colorArray.emplaceBack(N+D,-.8,N,.7),l.colorArray.emplaceBack(N+D,-.8,N,.7),l.colorArray.emplaceBack(0,0,N,1.3),l.colorArray.emplaceBack(0,0,N,1.3),l.colorArray.emplaceBack(N+D,-1.2,N,.8),l.colorArray.emplaceBack(N+D,-1.2,N,.8),l.indexArray.emplaceBack(6+u,4+u,8+u),l.indexArray.emplaceBack(7+u,9+u,5+u),l.indexArray.emplaceBack(0+u,1+u,2+u),l.indexArray.emplaceBack(1+u,3+u,2+u),u+=10}let p={defined:!0,emissiveFactor:[0,0,0]},h={};return h.baseColorFactor=Ln.white,p.pbrMetallicRoughness=h,l.material=p,l.aabb=new ti([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),l}class BN{constructor(o){this._stringToNumber={},this._numberToString=[];for(let l=0;l<o.length;l++){let u=o[l];this._stringToNumber[u]=l,this._numberToString[l]=u}}encode(o){return this._stringToNumber[o]}decode(o){return this._numberToString[o]}}let bq=["id","tile","layer","source","sourceLayer","state"];class n_{constructor(o,l,u,p,h){this.type="Feature",this._vectorTileFeature=o,this._z=l,this._x=u,this._y=p,this.properties=o.properties,this.id=h}clone(){let o=new n_(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(o.state=Object.assign({},this.state)),this.layer&&(o.layer=Object.assign({},this.layer)),this.source&&(o.source=this.source),this.sourceLayer&&(o.sourceLayer=this.sourceLayer),o}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){let o={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(let l of bq)this[l]!==void 0&&(o[l]=this[l]);return o}}class VN{constructor(o,l){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new yh(kt,16,0),this.featureIndexArray=new Qa,this.promoteId=l,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(o,l,u,p,h,g=0,x=0){let C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,p,h,g);let D=this.grid;for(let v=0;v<l.length;v++){let E=l[v],T=[1/0,1/0,-1/0,-1/0];for(let S=0;S<E.length;S++){let M=E[S];T[0]=Math.min(T[0],M.x),T[1]=Math.min(T[1],M.y),T[2]=Math.max(T[2],M.x),T[3]=Math.max(T[3],M.y)}x!==0&&(T[0]-=x,T[1]-=x,T[2]+=x,T[3]+=x),T[0]<kt&&T[1]<kt&&T[2]>=0&&T[3]>=0&&D.insert(C,T[0],T[1],T[2],T[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Fh.VectorTile(new n1(this.rawTileData)).layers,this.sourceLayerCoder=new BN(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(let o in this.vtLayers)this.vtFeatures[o]=[]}return this.vtLayers}query(o,l){let{tilespaceGeometry:u,transform:p,tileTransform:h,pixelPosMatrix:g,availableImages:x}=l;this.loadVTLayers(),this.serializedLayersCache.clear();let C=u.bufferedTilespaceBounds,D=this.grid.query(C.min.x,C.min.y,C.max.x,C.max.y,(S,M,R,L)=>xe(u.bufferedTilespaceGeometry,S,M,R,L));D.sort(xq);let v=null;p.elevation&&D.length>0&&(v=Xg.create(p.elevation,this.tileID));let E={},T;for(let S=0;S<D.length;S++){let M=D[S];if(M===T)continue;T=M;let R=this.featureIndexArray.get(M),L=null;this.is3DTile?this.loadMatchingModelFeature(E,R,o,u,p):this.loadMatchingFeature(E,R,o,x,(N,$,H,j=0)=>(L||(L=O(N,this.tileID.canonical,h)),$.queryIntersectsFeature(u,N,H,L,this.z,p,g,v,j)))}return E}loadMatchingFeature(o,l,u,p,h){let{featureIndex:g,bucketIndex:x,sourceLayerIndex:C,layoutVertexArrayOffset:D}=l,v=this.bucketLayerIDs[x],E=u.layers,T=Object.keys(E);if(T.length&&!function(N,$){for(let H=0;H<N.length;H++)if($.indexOf(N[H])>=0)return!0;return!1}(T,v))return;let S=u.sourceCache,M=this.sourceLayerCoder.decode(C),R=this.vtLayers[M].feature(g),L=this.getId(R,M);for(let N=0;N<v.length;N++){let $=v[N];if(!E[$])continue;let{styleLayer:H,targets:j}=E[$],q={};L!==void 0&&(q=S.getFeatureState(H.sourceLayer,L));let Y=!h||h(R,H,q,D);if(!Y)continue;let Q=new n_(R,this.z,this.x,this.y,L);Q.tile=this.tileID.canonical,Q.state=q;let pe=this.serializedLayersCache.get($);pe||(pe=H.serialize(),pe.id=$,this.serializedLayersCache.set($,pe)),Q.source=pe.source,Q.sourceLayer=pe["source-layer"],Q.layer=Io({},pe),Q.layer.paint=jN(pe.paint,H.paint,R,q,p),Q.layer.layout=jN(pe.layout,H.layout,R,q,p);let de=!1;for(let ue of j){this.updateFeatureProperties(Q,ue);let{filter:De}=ue;if(De){if(R.properties=Q.properties,De.needGeometry){let fe=F(R,!0);if(!De.filter(new ir(this.tileID.overscaledZ),fe,this.tileID.canonical))continue}else if(!De.filter(new ir(this.tileID.overscaledZ),R))continue}de=!0,ue.targetId&&this.addFeatureVariant(Q,ue)}de&&this.appendToResult(o,$,g,Q,Y)}}loadMatchingModelFeature(o,l,u,p,h){let g=this.bucketLayerIDs[0][0],x=u.layers;if(!x[g])return;let{styleLayer:C,targets:D}=x[g];if(C.type!=="model")return;let v=p.tile,E=l.featureIndex,T=v.getBucket(C);if(!(T&&T instanceof E1))return;let S=function(pe,de,ue,De){let fe=pe.getNodesInfo()[de];if(fe.hiddenByReplacement||!fe.node.meshes)return;let Me=Number.MAX_VALUE,Fe=fe.node,Pe=ue.tile,ze=De.calculatePosMatrix(Pe.tileID.toUnwrapped(),De.worldSize),Ne=fe.evaluatedScale,Ge=0;De.elevation&&Fe.elevation&&(Ge=Fe.elevation*De.elevation.exaggeration()),ce.mat4.translate(ze,ze,[(Fe.anchor?Fe.anchor[0]:0)*(Ne[0]-1),(Fe.anchor?Fe.anchor[1]:0)*(Ne[1]-1),Ge]),ce.mat4.scale(ze,ze,Ne);let Ue=ue.queryGeometry,qe=Ue.isPointQuery()?Ue.screenBounds:Ue.screenGeometry,gt=function(Gt){let wt=ce.mat4.multiply([],ze,Gt.matrix);ce.mat4.multiply(wt,De.expandedFarZProjMatrix,wt);for(let Rt=0;Rt<Gt.meshes.length;++Rt){let yt=Gt.meshes[Rt];if(Rt===Gt.lightMeshIndex)continue;let mi=zL(qe,De,wt,yt.aabb);mi!=null&&(Me=Math.min(mi,Me))}if(Gt.children)for(let Rt of Gt.children)gt(Rt)};if(gt(Fe),Me===Number.MAX_VALUE)return;let ft=new Sn(0,0);return XL(Pe.tileID.canonical,ft,fe.node.anchor[0],fe.node.anchor[1]),{intersectionZ:Me,position:ft,feature:fe.feature}}(T,E,p,h);if(!S)return;let{z:M,x:R,y:L}=v.tileID.canonical,{feature:N,intersectionZ:$,position:H}=S,j={};N.id!==void 0&&(j=u.sourceCache.getFeatureState(C.sourceLayer,N.id));let q=new n_({},M,R,L,N.id);q.tile=this.tileID.canonical,q.state=j,q.properties=N.properties,q.geometry={type:"Point",coordinates:[H.lng,H.lat]};let Y=this.serializedLayersCache.get(g);Y||(Y=C.serialize(),Y.id=g,this.serializedLayersCache.set(g,Y)),q.source=Y.source,q.sourceLayer=Y["source-layer"],q.layer=Io({},Y);let Q=!1;for(let pe of D){this.updateFeatureProperties(q,pe);let{filter:de}=pe;if(de){if(N.properties=q.properties,de.needGeometry){if(!de.filter(new ir(this.tileID.overscaledZ),N,this.tileID.canonical))continue}else if(!de.filter(new ir(this.tileID.overscaledZ),N))continue}Q=!0,pe.targetId&&this.addFeatureVariant(q,pe)}Q&&this.appendToResult(o,g,E,q,$)}updateFeatureProperties(o,l,u){if(l.properties){let p={};for(let h in l.properties){let g=l.properties[h].evaluate({zoom:this.z},o._vectorTileFeature,o.state,o.tile,u);g!=null&&(p[h]=g)}o.properties=p}}addFeatureVariant(o,l,u){let p={target:l.target,namespace:l.namespace,uniqueFeatureID:l.uniqueFeatureID};l.properties&&(p.properties=o.properties),o.variants=o.variants||{},o.variants[l.targetId]=o.variants[l.targetId]||[],o.variants[l.targetId].push(p)}appendToResult(o,l,u,p,h){let g=o[l];g===void 0&&(g=o[l]=[]),g.push({featureIndex:u,feature:p,intersectionZ:h})}lookupSymbolFeatures(o,l,u,p,h){let g={};this.loadVTLayers();for(let x of o)this.loadMatchingFeature(g,{bucketIndex:l,sourceLayerIndex:u,featureIndex:x,layoutVertexArrayOffset:0},p,h);return g}loadFeature(o){let{featureIndex:l,sourceLayerIndex:u}=o;this.loadVTLayers();let p=this.sourceLayerCoder.decode(u),h=this.vtFeatures[p];if(h[l])return h[l];let g=this.vtLayers[p].feature(l);return h[l]=g,g}hasLayer(o){for(let l of this.bucketLayerIDs)for(let u of l)if(o===u)return!0;return!1}getId(o,l){let u=o.id;if(this.promoteId){let p=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[l];if(p!=null)if(Array.isArray(p)){if(!this.promoteIdExpression){let h=gh(p);if(h.result!=="success"){let g=h.value.map(x=>`${x.key}: ${x.message}`).join(", ");return void Er(`Failed to create expression for promoteId: ${g}`)}this.promoteIdExpression=h.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new Xm),u=this.promoteIdExpression.evaluate({zoom:0},o)}else u=o.properties[p];typeof u=="boolean"&&(u=Number(u))}return u}}function jN(d,o,l,u,p){return Xd(d,(h,g)=>{let x=o instanceof Ch?o.get(g):null;return x&&x.evaluate?x.evaluate(l,u,p):x})}function xq(d,o){return o-d}$t(VN,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});let UN=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class sI{static from(o){if(!(o instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[l,u]=new Uint8Array(o,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");let p=u>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);let h=UN[15&u];if(!h)throw new Error("Unrecognized array type.");let[g]=new Uint16Array(o,2,1),[x]=new Uint32Array(o,4,1);return new sI(x,g,h,o)}constructor(o,l=64,u=Float64Array,p){if(isNaN(o)||o<0)throw new Error(`Unpexpected numItems value: ${o}.`);this.numItems=+o,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=u,this.IndexArrayType=o<65536?Uint16Array:Uint32Array;let h=UN.indexOf(this.ArrayType),g=2*o*this.ArrayType.BYTES_PER_ELEMENT,x=o*this.IndexArrayType.BYTES_PER_ELEMENT,C=(8-x%8)%8;if(h<0)throw new Error(`Unexpected typed array class: ${u}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+x+C,2*o),this._pos=2*o,this._finished=!0):(this.data=new ArrayBuffer(8+g+x+C),this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+x+C,2*o),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+h]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=o)}add(o,l){let u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=o,this.coords[this._pos++]=l,u}finish(){let o=this._pos>>1;if(o!==this.numItems)throw new Error(`Added ${o} items when expected ${this.numItems}.`);return lI(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(o,l,u,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:h,coords:g,nodeSize:x}=this,C=[0,h.length-1,0],D=[];for(;C.length;){let v=C.pop()||0,E=C.pop()||0,T=C.pop()||0;if(E-T<=x){for(let L=T;L<=E;L++){let N=g[2*L],$=g[2*L+1];N>=o&&N<=u&&$>=l&&$<=p&&D.push(h[L])}continue}let S=T+E>>1,M=g[2*S],R=g[2*S+1];M>=o&&M<=u&&R>=l&&R<=p&&D.push(h[S]),(v===0?o<=M:l<=R)&&(C.push(T),C.push(S-1),C.push(1-v)),(v===0?u>=M:p>=R)&&(C.push(S+1),C.push(E),C.push(1-v))}return D}within(o,l,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:p,coords:h,nodeSize:g}=this,x=[0,p.length-1,0],C=[],D=u*u;for(;x.length;){let v=x.pop()||0,E=x.pop()||0,T=x.pop()||0;if(E-T<=g){for(let L=T;L<=E;L++)$N(h[2*L],h[2*L+1],o,l)<=D&&C.push(p[L]);continue}let S=T+E>>1,M=h[2*S],R=h[2*S+1];$N(M,R,o,l)<=D&&C.push(p[S]),(v===0?o-u<=M:l-u<=R)&&(x.push(T),x.push(S-1),x.push(1-v)),(v===0?o+u>=M:l+u>=R)&&(x.push(S+1),x.push(E),x.push(1-v))}return C}}function lI(d,o,l,u,p,h){if(p-u<=l)return;let g=u+p>>1;HN(d,o,g,u,p,h),lI(d,o,l,u,g-1,1-h),lI(d,o,l,g+1,p,1-h)}function HN(d,o,l,u,p,h){for(;p>u;){if(p-u>600){let D=p-u+1,v=l-u+1,E=Math.log(D),T=.5*Math.exp(2*E/3),S=.5*Math.sqrt(E*T*(D-T)/D)*(v-D/2<0?-1:1);HN(d,o,l,Math.max(u,Math.floor(l-v*T/D+S)),Math.min(p,Math.floor(l+(D-v)*T/D+S)),h)}let g=o[2*l+h],x=u,C=p;for(L0(d,o,u,l),o[2*p+h]>g&&L0(d,o,u,p);x<C;){for(L0(d,o,x,C),x++,C--;o[2*x+h]<g;)x++;for(;o[2*C+h]>g;)C--}o[2*u+h]===g?L0(d,o,u,C):(C++,L0(d,o,C,p)),C<=l&&(u=C+1),l<=C&&(p=C-1)}}function L0(d,o,l,u){cI(d,l,u),cI(o,2*l,2*u),cI(o,2*l+1,2*u+1)}function cI(d,o,l){let u=d[o];d[o]=d[l],d[l]=u}function $N(d,o,l,u){let p=d-l,h=o-u;return p*p+h*h}r.$=La,r.A=Xa,r.B=Pl,r.C=Dh,r.D=Kg,r.E=hl,r.F=2,r.G=_0,r.H=KF,r.I=ja,r.J=class extends w1{},r.K=fc,r.L=wn,r.M=Dw,r.N=vv,r.O=mh,r.P=At,r.Q=gw,r.R=Ro,r.S=mg,r.T=VT,r.U=Sg,r.V=w1,r.W=Cv,r.X=gh,r.Y=cf,r.Z=vc,r._=dh,r.a=function(d){return ie.API_CDN_URL_REGEX.test(d)},r.a$=F,r.a0=Ns,r.a1=Ov,r.a2=pg,r.a3=hg,r.a4=function(d){let o=d.value,l=[];if(!o)return l;let u=fc(o);return u!=="string"?(l=l.concat([new w1(d.key,o,`string expected, "${u}" found`)]),l):(VL(o,!0)||(l=l.concat([new w1(d.key,o,`invalid url "${o}"`)])),l)},r.a5=We,r.a6=Pv,r.a7=Sr,r.a8=It,r.a9=class{constructor(d){this.specification=d}possiblyEvaluate(d,o){return Wu(d.expression.evaluate(o))}interpolate(d,o,l){return{x:yi(d.x,o.x,l),y:yi(d.y,o.y,l),z:yi(d.z,o.z,l),azimuthal:yi(d.azimuthal,o.azimuthal,l),polar:yi(d.polar,o.polar,l)}}},r.aA=function(d,o){let l={};for(let u=0;u<o.length;u++){let p=o[u];p in d&&(l[p]=d[p])}return l},r.aB=_d,r.aC=Ja,r.aD=class{constructor(d){this.entries={},this.scheduler=d}request(d,o,l,u){let p=this.entries[d]=this.entries[d]||{callbacks:[]};if(p.result){let[h,g]=p.result;return this.scheduler?this.scheduler.add(()=>{u(h,g)},o):u(h,g),()=>{}}return p.callbacks.push(u),p.cancel||(p.cancel=l((h,g)=>{p.result=[h,g];for(let x of p.callbacks)this.scheduler?this.scheduler.add(()=>{x(h,g)},o):x(h,g);setTimeout(()=>delete this.entries[d],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(h=>h!==u),p.callbacks.length||(p.cancel(),delete this.entries[d]))}}},r.aE=function(d,o,l){let u=JSON.stringify(d.request);return d.data&&(this.deduped.entries[u]={result:[null,d.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:d.isSymbolTile,zoom:d.tileZoom},p=>{let h=dc(d.request,(g,x,C,D)=>{g?p(g):x&&p(null,{vectorTile:l?void 0:new Fh.VectorTile(new n1(x)),rawData:x,cacheControl:C,expires:D})});return()=>{h.cancel(),p()}},o)},r.aF=function(d){On++,On>Hi&&(d.getActor().send("enforceCacheSizeLimit",Pi),On=0)},r.aG=function(d){return d<=1?1:Math.pow(2,Math.floor(Math.log(d)/Math.LN2))},r.aH=mt,r.aI=ML,r.aJ=PL,r.aK=DL,r.aL=function(d,o){let l=document.createElement("video");l.muted=!0,l.onloadstart=function(){o(null,l)};for(let u=0;u<d.length;u++){let p=document.createElement("source");Uy(d[u])||(l.crossOrigin="Anonymous"),p.src=d[u],l.appendChild(p)}return{cancel:()=>{}}},r.aM=_1,r.aN=function(d){return fetch(d).then(o=>o.arrayBuffer()).then(o=>LN(o,0,d))},r.aO=zN,r.aP=class{constructor(d,o,l,u){this.id=d,this.position=o!=null?new Sn(o[0],o[1]):new Sn(0,0),this.orientation=l??[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new ti([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(d,o){if(ce.mat4.multiply(d.matrix,o,d.matrix),d.meshes)for(let l of d.meshes){let u=ti.applyTransformFast(l.aabb,d.matrix);this.aabb.encapsulate(u)}if(d.children)for(let l of d.children)this._applyTransformations(l,d.matrix)}computeBoundsAndApplyParent(){let d=ce.mat4.identity([]);for(let o of this.nodes)this._applyTransformations(o,d)}computeModelMatrix(d,o,l,u,p,h,g=!1){GL(this.matrix,this,d.transform,this.position,o,l,u,p,h,g)}upload(d){if(!this.uploaded){for(let o of this.nodes)GT(o,d);for(let o of this.nodes)C1(o);this.uploaded=!0}}destroy(){for(let d of this.nodes)qT(d)}},r.aQ=Wp,r.aR=b0,r.aS=es,r.aT=Ho,r.aU=Cc,r.aV=Uo,r.aW=ps,r.aX=Cf,r.aY=m1,r.aZ=function(){Vs.isLoading()||Vs.isLoaded()||Cg()!=="deferred"||Sw()},r.a_=Fv,r.aa=ir,r.ab=_h,r.ac=a,r.ad=ce,r.ae=Vo,r.af=Ch,r.ag=Ha,r.ah=yi,r.ai=kt,r.aj=Qx,r.ak=Qi,r.al=Ln,r.am=class{constructor(d){this.specification=d}possiblyEvaluate(d,o){return function([l,u]){let p=Wu([1,l,u]);return{x:p.x,y:p.y,z:p.z}}(d.expression.evaluate(o))}interpolate(d,o,l){return{x:yi(d.x,o.x,l),y:yi(d.y,o.y,l),z:yi(d.z,o.z,l)}}},r.an=function(d,o,l=0,u=!0){let p=new At(l,l),h=d.sub(p),g=o.add(p),x=[h,new At(g.x,h.y),g,new At(h.x,g.y)];return u&&x.push(h.clone()),x},r.ao=function(d,o){let l=[];for(let u=0;u<d.length;u++){let p=Os(u-1,-1,d.length-1),h=Os(u+1,-1,d.length-1),g=d[u],x=d[h],C=d[p].sub(g).unit(),D=x.sub(g).unit(),v=D.angleWithSep(C.x,C.y),E=C.add(D).unit().mult(-1*o/Math.sin(v/2));l.push(g.add(E))}return l},r.ap=hL,r.aq=xe,r.ar=function(d,o,l=0){return ce.vec3.fromValues(((o.x-l)*d.scale-d.x)*kt,(o.y*d.scale-d.y)*kt,i0(o.z,o.y))},r.as=vi,r.at=SF,r.au=function(d){let o=1/0,l=1/0,u=-1/0,p=-1/0;for(let h of d)o=Math.min(o,h.x),l=Math.min(l,h.y),u=Math.max(u,h.x),p=Math.max(p,h.y);return{min:new At(o,l),max:new At(u,p)}},r.av=Ll,r.aw=be,r.ax=f,r.ay=qi,r.az=Na,r.b=function(d){return ie.API_FONTS_REGEX.test(d)},r.b$=b1,r.b0=n_,r.b1=Qd,r.b2=vT,r.b3=hT,r.b4=O,r.b5=wc,r.b6=Pg,r.b7=gi,r.b8=_r,r.b9=a0,r.bA=nF,r.bB=AT,r.bC=oL,r.bD=MT,r.bE=sI,r.bF=Os,r.bG=Yu,r.bH=ea,r.bI=function(d,o,l){d[4*o+0]=l[0],d[4*o+1]=l[1],d[4*o+2]=l[2],d[4*o+3]=l[3]},r.bJ=Rf,r.bK=Us,r.bL=Ih,r.bM=$r,r.bN=If,r.bO=Sn,r.bP=_L,r.bQ=Qe,r.bR=Fi,r.bS=FL,r.bT=ht,r.bU=xa,r.bV=function(d,o,l,u,p,h,g,x,C){if(C.name==="globe")return xa(d,o,new ht(l,u,p),!1);let D=b0({z:l,x:u,y:p},C);return new ti([(h+D.x/D.scale)*o,o*(D.y/D.scale),g],[(h+D.x2/D.scale)*o,o*(D.y2/D.scale),x])},r.bW=function(d,o,l){let u=0;for(let p=0;p<2;++p)d[p]>0&&(u+=(d[p]-0)*(d[p]-0)),o[p]<0&&(u+=(0-o[p])*(0-o[p]));return u},r.bX=Nr,r.bY=Hw,r.bZ=function(d){let o=ce.mat4.identity(new Float64Array(16));ce.mat4.multiply(o,d.pixelMatrix,d.globeMatrix);let l=[0,bs,0],u=[0,xs,0];return ce.vec3.transformMat4(l,l,o),ce.vec3.transformMat4(u,u,o),[l[0]>0&&l[0]<=d.width&&l[1]>0&&l[1]<=d.height&&!is(d,new Sn(d.center.lat,90)),u[0]>0&&u[0]<=d.width&&u[1]>0&&u[1]<=d.height&&!is(d,new Sn(d.center.lat,-90))]},r.b_=function(d,o){let{scale:l}=d.tileTransform,u=l*kt/(d.tileSize*Math.pow(2,o.zoom-d.tileID.overscaledZ+d.tileID.canonical.z));return ce.mat2.scale(new Float32Array(4),o.inverseAdjustmentMatrix,[u,u])},r.ba=NT,r.bb=function(d,o){let l=Ha(o.zoom);if(l===0)return po(d);let u=hn(d),p=vr(u),h=Ll(u.getWest())*o.worldSize,g=Ll(u.getEast())*o.worldSize,x=Ja(u.getNorth())*o.worldSize,C=Ja(u.getSouth())*o.worldSize,D=[h,x,0],v=[g,x,0],E=[h,C,0],T=[g,C,0],S=ce.mat4.invert([],o.globeMatrix);return ce.vec3.transformMat4(D,D,S),ce.vec3.transformMat4(v,v,S),ce.vec3.transformMat4(E,E,S),ce.vec3.transformMat4(T,T,S),p[0]=Co(p[0],E,l),p[1]=Co(p[1],T,l),p[2]=Co(p[2],v,l),p[3]=Co(p[3],D,l),ti.fromPoints(p)},r.bc=hr,r.bd=Mn,r.be=Co,r.bf=Mh,r.bg=Ri,r.bh=O1,r.bi=n1,r.bj=dc,r.bk=function(d,o){let l=[];for(let u in d)u in o||l.push(u);return l},r.bl=cl,r.bm=["type","source","source-layer","minzoom","maxzoom","filter","layout"],r.bn=To,r.bo=function(d,o){let{x:l,y:u}=d.point,p=Hs(l,u,d.worldSize/d._pixelsPerMercatorPixel,0,0);return ce.mat4.multiply(p,p,fo(po(o)))},r.bp=Hg,r.bq=Cs,r.br=i1,r.bs=function(d,o,l,u,p){let h=5*o+2;d.float32[h+0]=l,d.float32[h+1]=u,d.float32[h+2]=p},r.bt=f1,r.bu=XF,r.bv=K,r.bw=ia,r.bx=KO,r.by=BL,r.bz=iF,r.c=ye,r.c$=IF,r.c0=OL,r.c1=function(d){let o=OL(d,!0);return ce.mat2.invert([],[o[0],o[1],o[4],o[5]])},r.c2=on,r.c3=function(d){let{x:o,y:l}=d.point,{lng:u,lat:p}=d._center;return Hs(o,l,d.worldSize,u,p)},r.c4=Ur,r.c5=Nt,r.c6=Ah,r.c7=function(d){let o=Math.round((d+45+360)%360/90)%4;return ga[o]},r.c8=45,r.c9=Jx,r.cA=Vw,r.cB=class extends Fl{constructor(d){super(d),this.current=Qv}set(d,o,l){if(this.fetchUniformLocation(d,o)){for(let u=0;u<9;u++)if(l[u]!==this.current[u]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}}},r.cC=Ya,r.cD=function(d,o,l){let u=Ha(l.zoom),p=d.style.map._antialias,h=d.terrain&&d.terrain.exaggeration()>0;return u===0&&!p&&!h},r.cE=function(d){let o=d.pixelsPerMeter,l=o/ea(1,d.center.lat),u=ce.mat4.identity(new Float64Array(16));return ce.mat4.translate(u,u,[d.point.x,d.point.y,0]),ce.mat4.scale(u,u,[l,l,o]),Float32Array.from(u)},r.cF=hn,r.cG=function(d){let o=Nr-5;d=qi(d,-o,o)/o*90;let l=Math.pow(Math.abs(Math.sin(Qi(d))),3);return Math.round(l*(Bg.length-1))},r.cH=function(d,o,l,u){let p=o.getNorth(),h=o.getSouth(),g=o.getWest(),x=o.getEast(),C=1<<d.z,D=x-g,v=p-h,E=D/Rh,T=-v/Bg[l],S=[0,E,0,T,0,0,p,g,0];if(d.z>0){let M=180/u;ce.mat3.multiply(S,S,[M/D+1,0,0,0,M/v+1,0,-.5*M/E,.5*M/T,1])}return S[2]=C,S[5]=d.x,S[8]=d.y,S},r.cI=po,r.cJ=function(d,o,l){let u=ce.mat4.identity(new Float64Array(16)),p=(o/(1<<d)-.5)*Math.PI*2;return ce.mat4.rotateY(u,l.globeMatrix,p),Float32Array.from(u)},r.cK=class{isDataAvailableAtPoint(d){let o=this._source();if(this.isUsingMockSource()||!o||d.y<0||d.y>1)return!1;let l=o.getSource().maxzoom,u=1<<l,p=Math.floor(d.x),h=Math.floor((d.x-p)*u),g=Math.floor(d.y*u),x=this.findDEMTileFor(new mt(l,p,l,h,g));return!(!x||!x.dem)}getAtPointOrZero(d,o=0){return this.getAtPoint(d,o)||0}getAtPoint(d,o,l=!0){if(this.isUsingMockSource())return null;o==null&&(o=null);let u=this._source();if(!u||d.y<0||d.y>1)return o;let p=u.getSource().maxzoom,h=1<<p,g=Math.floor(d.x),x=d.x-g,C=new mt(p,g,p,Math.floor(x*h),Math.floor(d.y*h)),D=this.findDEMTileFor(C);if(!D||!D.dem)return o;let v=D.dem,E=1<<D.tileID.canonical.z,T=(x*E-D.tileID.canonical.x)*v.dim,S=(d.y*E-D.tileID.canonical.y)*v.dim,M=Math.floor(T),R=Math.floor(S);return(l?this.exaggeration():1)*yi(yi(v.get(M,R),v.get(M,R+1),S-R),yi(v.get(M+1,R),v.get(M+1,R+1),S-R),T-M)}getAtTileOffset(d,o,l){let u=1<<d.canonical.z;return this.getAtPointOrZero(new a(d.wrap+(d.canonical.x+o/kt)/u,(d.canonical.y+l/kt)/u))}getAtTileOffsetFunc(d,o,l,u){return p=>{let h=this.getAtTileOffset(d,p.x,p.y),g=u.upVector(d.canonical,p.x,p.y),x=u.upVectorScale(d.canonical,o,l).metersToTile;return ce.vec3.scale(g,g,h*x),g}}getForTilePoints(d,o,l,u){if(this.isUsingMockSource())return!1;let p=Xg.create(this,d,u);return!!p&&(o.forEach(h=>{h[2]=this.exaggeration()*p.getElevationAt(h[0],h[1],l)}),!0)}getMinMaxForTile(d){if(this.isUsingMockSource())return null;let o=this.findDEMTileFor(d);if(!o||!o.dem)return null;let l=o.dem.tree,u=o.tileID,p=1<<d.canonical.z-u.canonical.z,h=d.canonical.x/p-u.canonical.x,g=d.canonical.y/p-u.canonical.y,x=0;for(let C=0;C<d.canonical.z-u.canonical.z&&!l.leaves[x];C++){h*=2,g*=2;let D=2*Math.floor(g)+Math.floor(h);x=l.childOffsets[x]+D,h%=1,g%=1}return{min:this.exaggeration()*l.minimums[x],max:this.exaggeration()*l.maximums[x]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(d,o,l){throw new Error("Pure virtual method called.")}pointCoordinate(d){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(d){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){let d=this.visibleDemTiles;if(d.length===0)return null;let o=!1,l=Number.MAX_VALUE,u=Number.MIN_VALUE;for(let p of d){let h=this.getMinMaxForTile(p.tileID);h&&(l=Math.min(l,h.min),u=Math.max(u,h.max),o=!0)}return o?{min:l,max:u}:null}},r.cL=MO,r.cM=ln,r.cN=function(d,o){return[Math.pow(d[0],2.2)*o,Math.pow(d[1],2.2)*o,Math.pow(d[2],2.2)*o]},r.cO=ts,r.cP=nt,r.cQ=Xp,r.cR=256,r.cS=function(d,o){let l=[0,0,0],u=hr(po(o.canonical));return ce.vec3.transformMat4(l,l,u),ce.vec3.transformMat4(l,l,d),l},r.cT=d=>({u_camera_to_center_distance:new $r(d),u_extrude_scale:new Jv(d),u_device_pixel_ratio:new $r(d),u_matrix:new Rf(d),u_inv_rot_matrix:new Rf(d),u_merc_center:new Us(d),u_tile_id:new Ih(d),u_zoom_transition:new $r(d),u_up_dir:new Ih(d),u_emissive_strength:new $r(d)}),r.cU=d=>({u_matrix:new Rf(d),u_pixels_to_tile_units:new Jv(d),u_device_pixel_ratio:new $r(d),u_width_scale:new $r(d),u_floor_width_scale:new $r(d),u_units_to_pixels:new Us(d),u_dash_image:new If(d),u_gradient_image:new If(d),u_image_height:new $r(d),u_texsize:new Us(d),u_tile_units_to_pixels:new $r(d),u_alpha_discard_threshold:new $r(d),u_trim_offset:new Us(d),u_trim_fade_range:new Us(d),u_trim_color:new Af(d),u_emissive_strength:new $r(d),u_zbias_factor:new $r(d),u_tile_to_meter:new $r(d)}),r.cV=d=>({u_matrix:new Rf(d),u_texsize:new Us(d),u_pixels_to_tile_units:new Jv(d),u_device_pixel_ratio:new $r(d),u_width_scale:new $r(d),u_floor_width_scale:new $r(d),u_image:new If(d),u_units_to_pixels:new Us(d),u_tile_units_to_pixels:new $r(d),u_alpha_discard_threshold:new $r(d),u_trim_offset:new Us(d),u_trim_fade_range:new Us(d),u_trim_color:new Af(d),u_emissive_strength:new $r(d),u_zbias_factor:new $r(d),u_tile_to_meter:new $r(d)}),r.cW=$v,r.cX=E$,r.cY=S$,r.cZ=Ph,r.c_=(d,o,l,u,p,h)=>{let g=d.transform,x=g.projection.name==="globe",C;if(h.paint.get("circle-pitch-alignment")==="map")if(x){let v=ts(g.zoom,o.canonical)*g._pixelsPerMercatorPixel;C=Float32Array.from([v,0,0,v])}else C=g.calculatePixelsToTileUnitsMatrix(l);else C=new Float32Array([g.pixelsToGLUnits[0],0,0,g.pixelsToGLUnits[1]]);let D={u_camera_to_center_distance:d.transform.getCameraToCenterDistance(g.projection),u_matrix:d.translatePosMatrix(o.projMatrix,l,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_device_pixel_ratio:it.devicePixelRatio,u_extrude_scale:C,u_inv_rot_matrix:n0,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:h.paint.get("circle-emissive-strength")};if(x){D.u_inv_rot_matrix=u,D.u_merc_center=p,D.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],D.u_zoom_transition=Ha(g.zoom);let v=p[0]*kt,E=p[1]*kt;D.u_up_dir=g.projection.upVector(new ht(0,0,0),v,E)}return D},r.ca=Vg,r.cb=Af,r.cc=function(d,o,l){let u=Math.sqrt(d*d+o*o+l*l),p=u>0?Math.acos(l/u)*ho:0,h=d!==0||o!==0?Math.atan2(-o,-d)*ho+90:0;return h<0&&(h+=360),[u,h,p]},r.cd=m,r.ce=ti,r.cf=Wu,r.cg=function(d){return[Math.pow(d[0],1/2.2),Math.pow(d[1],1/2.2),Math.pow(d[2],1/2.2)]},r.ch=function(d,o){return d.readFields(yG,{icons:[]},o)},r.ci=function(d){return d({pluginStatus:Ua,pluginURL:ud}),vh.on("pluginStateChange",d),d},r.cj=D1,r.ck=qg,r.cl=TT,r.cm=Zu,r.cn=_f,r.co=Ut,r.cp=gs,r.cq=fs,r.cr=function(d){let o=d.indexOf(Mg);return o>=0?d.slice(0,o):d},r.cs=function(d){return d.indexOf(Mg)>=0},r.ct=function(d){let o=d.indexOf(Mg);return o>=0?d.slice(o+1):""},r.cu=function(d){let o=[],l=d.id;return l===void 0&&o.push({message:`layers.${l}: missing required property "id"`}),d.render===void 0&&o.push({message:`layers.${l}: missing required method "render"`}),d.renderingMode&&d.renderingMode!=="2d"&&d.renderingMode!=="3d"&&o.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),o},r.cv=function(d,o,l,u){return d.type==="custom"?new rG(d,o):new mG[d.type](d,o,l,u)},r.cw=Kd,r.cx=class extends n_{constructor(d,o){super(d._vectorTileFeature,d._z,d._x,d._y,d.id),d.state&&(this.state=Object.assign({},d.state)),this.target=o.target,this.namespace=o.namespace,o.properties&&(this.properties=o.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=d.source,this.sourceLayer=d.sourceLayer,this.layer=d.layer)}toJSON(){let d=super.toJSON();return d.target=this.target,d.namespace=this.namespace,d}},r.cy=vh,r.cz=Ls,r.d=function(d){return ie.API_TILEJSON_REGEX.test(d)},r.d$=BN,r.d0=ba,r.d1=(d,o,l,u,p,h,g,x)=>{let C=d.transform,D=C.pitch<15?DF(.07,.7,qi((14-C.zoom)/5,0,1)):.07,v=l.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:TF(d,o,l,u),u_texsize:o.imageAtlasTexture?o.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:C.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:p,u_width_scale:h,u_floor_width_scale:g,u_image:0,u_tile_units_to_pixels:MF(o,C),u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:x,u_trim_fade_range:l.paint.get("line-trim-fade-range"),u_trim_color:l.paint.get("line-trim-color").toRenderColor(v?null:l.lut).toArray01(),u_emissive_strength:l.paint.get("line-emissive-strength"),u_zbias_factor:D,u_tile_to_meter:m(o.tileID.canonical,0)}},r.d2=(d,o,l,u,p,h,g,x,C)=>{let D=d.transform,v=D.calculatePixelsToTileUnitsMatrix(o),E=l.paint.get("line-trim-color-use-theme").constantOr("default")==="none",T=D.pitch<15?DF(.07,.7,qi((14-D.zoom)/5,0,1)):.07;return{u_matrix:TF(d,o,l,u),u_pixels_to_tile_units:v,u_device_pixel_ratio:h,u_width_scale:g,u_floor_width_scale:x,u_units_to_pixels:[1/D.pixelsToGLUnits[0],1/D.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:p,u_texsize:AF(l)&&o.lineAtlasTexture?o.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:MF(o,d.transform),u_alpha_discard_threshold:0,u_trim_offset:C,u_trim_fade_range:l.paint.get("line-trim-fade-range"),u_trim_color:l.paint.get("line-trim-color").toRenderColor(E?null:l.lut).toArray01(),u_emissive_strength:l.paint.get("line-emissive-strength"),u_zbias_factor:T,u_tile_to_meter:m(o.tileID.canonical,0)}},r.d3=dl,r.d4=o0,r.d5=i0,r.d6=gF,r.d7=zt,r.d8=t1,r.d9=Lh,r.dA=Qw,r.dB=Za,r.dC=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},r.dD=ll,r.dE=tT,r.dF=uu,r.dG=function([d,o,l]){let u=Math.hypot(d,o,l),p=Math.atan2(d,l),h=.5*Math.PI-Math.acos(-o/u);return new Sn(Ur(p),Ur(h))},r.dH=UT,r.dI=function(d){let o=d.navigator?d.navigator.userAgent:null;return!!function(l){if(Zp==null){let u=l.navigator?l.navigator.userAgent:null;Zp=!!l.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return Zp}(d)&&o&&(o.match("Version/15.4")||o.match("Version/15.5")||o.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},r.dJ=function(d,o){Pi=d,Hi=o},r.dK=is,r.dL=$s,r.dM=function(d){let o=[0,0,0],l=ce.mat4.identity(new Float64Array(16));return ce.mat4.multiply(l,d.pixelMatrix,d.globeMatrix),ce.vec3.transformMat4(o,o,l),new At(o[0],o[1])},r.dN=function(d,o,l=!1){if(Ua===Iv||Ua===xg||Ua===Av)throw new Error("setRTLTextPlugin cannot be called multiple times.");ud=it.resolveURL(d),Ua=Iv,Rv=o,wg(),l||Sw()},r.dO=Cg,r.dP=function(){D1().acquire(YT)},r.dQ=function(){let d=T0;d&&(d.isPreloaded()&&d.numActive()===1?(d.release(YT),T0=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},r.dR=S1,r.dS=function(d){let o=wr();if(!o)return;let l=o.delete(Zt);d&&l.catch(d).then(()=>d())},r.dT=M0,r.dU=IN,r.dV=function(d){nI=it.resolveURL(d),i_||(i_=new Kg(D1(),new hl)),i_.broadcast("setDracoUrl",nI)},r.dW=AN,r.dX=function(d){t_=it.resolveURL(d),i_||(i_=new Kg(D1(),new hl)),i_.broadcast("setMeshoptUrl",t_)},r.dY=$t,r.dZ=Oh,r.d_=Ic,r.da=450,r.db=7,r.dc=nG,r.dd=En,r.de=Lg,r.df=256,r.dg=fo,r.dh=gl,r.di=Ka,r.dj=kg,r.dk=function(d,o,l,u,p){return qi((d-o)/(l-o)*(p-u)+u,u,p)},r.dl=mv,r.dm=yd,r.dn=class{constructor(d,o,l,u){this.context=d,this.format=u,this.size=l,this.texture=d.gl.createTexture();let[p,h,g]=this.size,{gl:x}=d;x.bindTexture(x.TEXTURE_3D,this.texture),d.pixelStoreUnpackFlipY.set(!1),d.pixelStoreUnpack.set(1),d.pixelStoreUnpackPremultiplyAlpha.set(!1),x.texImage3D(x.TEXTURE_3D,0,this.format,p,h,g,0,zT(this.format),BT(this.format),o.data)}bind(d,o){let{context:l}=this,{gl:u}=l;u.bindTexture(u.TEXTURE_3D,this.texture),d!==this.minFilter&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MAG_FILTER,d),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MIN_FILTER,d),this.minFilter=d),o!==this.wrapS&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_S,o),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_T,o),this.wrapS=o)}destroy(){let{gl:d}=this.context;d.deleteTexture(this.texture),this.texture=null}},r.dp=HT,r.dq=[1,1,1],r.dr=Xg,r.ds=Zg,r.dt=fd,r.du=Th,r.dv=hu,r.dw=Wv,r.dx=qv,r.dy=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new At(1/0,1/0),max:new At(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(d,o=!1){let l=JO(new At(0,0),new At(kt,kt),d),u=[];if(o&&!fT(l,this._globalClipBounds))return u;for(let p of this._activeRegions){if(p.hiddenByOverlap||!fT(l,p))continue;let h=K8(p.min,p.max,d);u.push({min:h.min,max:h.max,sourceId:this._sourceIds[p.priority],footprint:p.footprint,footprintTileId:p.tileId,order:p.order,clipMask:p.clipMask,clipScope:p.clipScope})}return u}setSources(d){this._setSources(d.map(o=>({getSourceId:()=>o.cache.id,getFootprints:()=>{let l=[];for(let u of o.cache.getVisibleCoordinates()){let p=o.cache.getTile(u).buckets[o.layer];p&&p.updateFootprints(u.toUnwrapped(),l)}return l},getOrder:()=>o.order,getClipMask:()=>o.clipMask,getClipScope:()=>o.clipScope})))}_addSource(d){let o=d.getFootprints();if(o.length===0)return;let l=d.getOrder(),u=d.getClipMask(),p=d.getClipScope();for(let h of o){if(!h.footprint)continue;let g=JO(h.footprint.min,h.footprint.max,h.id);this._activeRegions.push({min:g.min,max:g.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:h.id,footprint:h.footprint,order:l,clipMask:u,clipScope:p})}this._sourceIds.push(d.getSourceId())}_computeReplacement(){this._activeRegions.sort((o,l)=>o.priority-l.priority||Jw(o.min,l.min)||Jw(o.max,l.max)||o.order-l.order||o.clipMask-l.clipMask||function(u,p){let h=(g,x)=>g+x;return u.length-p.length||u.reduce(h,"").localeCompare(p.reduce(h,""))}(o.clipScope,l.clipScope));let d=this._activeRegions.length!==this._prevRegions.length;if(!d){let o=0;for(;!d&&o!==this._activeRegions.length;){let l=this._activeRegions[o],u=this._prevRegions[o];d=l.priority!==u.priority||!QO(l,u)||l.order!==u.order||l.clipMask!==u.clipMask||!To(l.clipScope,u.clipScope),++o}}if(d){++this._updateTime;for(let l of this._activeRegions)l.order!==Qw&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,l.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,l.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,l.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,l.max.y));let o=l=>{let u=this._activeRegions;if(l>=u.length)return l;let p=u[l].priority;for(;l<u.length&&u[l].priority===p;)++l;return l};if(this._sourceIds.length>1){let l=0,u=o(l);for(;l!==u;){let p=l,h=l;for(;p!==u;){let g=this._activeRegions[p];g.hiddenByOverlap=!1;for(let x=0;x<h;x++){let C=this._activeRegions[x];if(!C.hiddenByOverlap&&g.order===Qw&&fT(g,C)&&(g.hiddenByOverlap=tF(g.footprint,g.tileId,C.footprint,C.tileId),g.hiddenByOverlap))break}++p}l=u,u=o(l)}}}}_setSources(d){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let o=d.length-1;o>=0;o--)this._addSource(d[o]);this._computeReplacement()}},r.dz=class{constructor(d){this._createGrid(d),this._createPoles(d)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(let d of this._poleSegments)d.destroy();for(let d of this._gridSegments)d.withSkirts.destroy(),d.withoutSkirts.destroy()}_fillGridMeshWithLods(d,o){let l=new wc,u=new Uo,p=[],h=d+1+2,g=o[0]+1,x=o[0]+1+(1+o.length),C=(D,v,E)=>{let T=D===h-1?D-2:D===0?D:D-1;return T+=E?24575:0,[T,v]};for(let D=0;D<h;++D)l.emplaceBack(...C(D,0,!0));for(let D=0;D<g;++D)for(let v=0;v<h;++v)l.emplaceBack(...C(v,D,(v===0||v===h-1)&&!0));for(let D=0;D<o.length;++D){let v=o[D];for(let E=0;E<h;++E)l.emplaceBack(...C(E,v,!0))}for(let D=0;D<o.length;++D){let v=u.length,E=o[D]+1+2,T=new Uo;for(let R=0;R<E-1;R++){let L=R===E-2,N=L?h*(x-o.length+D-R):h;for(let $=0;$<h-1;$++){let H=R*h+$;R===0||L||$===0||$===h-2?(T.emplaceBack(H+1,H,H+N),T.emplaceBack(H+N,H+N+1,H+1)):(u.emplaceBack(H+1,H,H+N),u.emplaceBack(H+N,H+N+1,H+1))}}let S=_r.simpleSegment(0,v,l.length,u.length-v);for(let R=0;R<T.uint16.length;R+=3)u.emplaceBack(T.uint16[R],T.uint16[R+1],T.uint16[R+2]);let M=_r.simpleSegment(0,v,l.length,u.length-v);p.push({withoutSkirts:S,withSkirts:M})}return{vertices:l,indices:u,segments:p}}_createGrid(d){let o=this._fillGridMeshWithLods(Rh,Bg);this._gridSegments=o.segments,this._gridBuffer=d.createVertexBuffer(o.vertices,gi.members),this._gridIndexBuffer=d.createIndexBuffer(o.indices,!0)}_createPoles(d){let o=new Uo;for(let g=0;g<=Rh;g++)o.emplaceBack(0,g+1,g+2);this._poleIndexBuffer=d.createIndexBuffer(o,!0);let l=new Ka,u=new Ka,p=new Ka,h=new Ka;this._poleSegments=[];for(let g=0,x=0;g<Ah;g++){let C=360/(1<<g);l.emplaceBack(0,-Na,0,.5,0),u.emplaceBack(0,-Na,0,.5,1),p.emplaceBack(0,-Na,0,.5,.5),h.emplaceBack(0,-Na,0,.5,.5);for(let D=0;D<=Rh;D++){let v=D/Rh,E=0,T=yi(0,C,v),[S,M,R]=kh(zl,Dc,T,Na);l.emplaceBack(S,M,R,v,E),u.emplaceBack(S,M,R,v,1-E);let L=Qi(T);v=.5+.5*Math.sin(L),E=.5+.5*Math.cos(L),p.emplaceBack(S,M,R,v,E),h.emplaceBack(S,M,R,v,1-E)}this._poleSegments.push(_r.simpleSegment(x,0,66,64)),x+=66}this._poleNorthVertexBuffer=d.createVertexBuffer(l,ei,!1),this._poleSouthVertexBuffer=d.createVertexBuffer(u,ei,!1),this._texturedPoleNorthVertexBuffer=d.createVertexBuffer(p,ei,!1),this._texturedPoleSouthVertexBuffer=d.createVertexBuffer(h,ei,!1)}getGridBuffers(d,o){return[this._gridBuffer,this._gridIndexBuffer,o?this._gridSegments[d].withSkirts:this._gridSegments[d].withoutSkirts]}getPoleBuffers(d,o){return[o?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,o?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[d]]}},r.e=ie,r.e0=VN,r.e1=wF,r.e2=Of,r.e3="hd_road_elevation",r.e4=class{static parseFrom(d,o){let l=pu.parse(d);if(!l)return[];let{vertices:u,features:p}=l,h=1/m(o);p.sort((D,v)=>D.id-v.id),u.sort((D,v)=>D.id-v.id||D.idx-v.idx),u=u.filter((D,v,E)=>v===E.findIndex(T=>T.id===D.id&&T.idx===D.idx));let g=new Array,x=0,C=u.length;for(let D of p){if(D.constantHeight){g.push(new dT(D.id,D.bounds,D.constantHeight));continue}for(;x!==C&&u[x].id<D.id;)x++;if(x===C||u[x].id!==D.id)continue;let v=new Array,E=new Array,T=x;for(;x!==C&&u[x].id===D.id;){let S=u[x];if(v.push({position:S.position,height:S.height,extent:S.extent}),x!==T&&u[x-1].idx===S.idx-1){let M=x-T;E.push({a:M-1,b:M})}x++}g.push(new dT(D.id,D.bounds,void 0,v,E,h))}return g}},r.e5=Xd,r.e6=Ff,r.e7=QF,r.e8=Gg,r.e9=function(d,o,l,u,p,h,g,x=1,C){d.createArrays(),d.tilePixelRatio=kt/(512*d.overscaling),d.compareText={},d.iconsNeedLinear=!1;let D=d.layers[0].layout,v=d.layers[0]._unevaluatedLayout._values,E={};E.scaleFactor=x,E.textSizeScaleRange=D.get("text-size-scale-range"),E.iconSizeScaleRange=D.get("icon-size-scale-range");let[T,S]=E.textSizeScaleRange,[M,R]=E.iconSizeScaleRange;E.textScaleFactor=qi(E.scaleFactor,T,S),E.iconScaleFactor=qi(E.scaleFactor,M,R);let L=v["text-size"],N=v["icon-size"];if(d.textSizeData.kind==="composite"){let{minZoom:Q,maxZoom:pe}=d.textSizeData;E.compositeTextSizes=[L.possiblyEvaluate(new ir(Q),h),L.possiblyEvaluate(new ir(pe),h)]}if(d.iconSizeData.kind==="composite"){let{minZoom:Q,maxZoom:pe}=d.iconSizeData;E.compositeIconSizes=[N.possiblyEvaluate(new ir(Q),h),N.possiblyEvaluate(new ir(pe),h)]}E.layoutTextSize=L.possiblyEvaluate(new ir(g+1),h),E.layoutIconSize=N.possiblyEvaluate(new ir(g+1),h),E.textMaxSize=L.possiblyEvaluate(new ir(18),h);let $=D.get("symbol-placement"),H=D.get("text-rotation-alignment")==="map"&&$!=="point",j=D.get("text-size"),q=!1,Y=[];for(let Q of d.features){let pe=D.get("text-font").evaluate(Q,{},h).join(","),de=j.evaluate(Q,{},h)*E.textScaleFactor,ue=E.layoutTextSize.evaluate(Q,{},h)*E.textScaleFactor,De=E.layoutIconSize.evaluate(Q,{},h)*E.iconScaleFactor,fe={horizontal:{},vertical:void 0},Me=Q.text,Fe,Pe=[0,0];if(Me){let yt=Me.toString(),mi=D.get("text-letter-spacing").evaluate(Q,{},h)*ia,jt=D.get("text-line-height").evaluate(Q,{},h)*ia,Jt=UM(yt)?mi:0,Ci=D.get("text-anchor").evaluate(Q,{},h),Wi=D.get("text-variable-anchor");if(!Wi){let yn=D.get("text-radial-offset").evaluate(Q,{},h);Pe=yn?oL(Ci,[yn*ia,IT]):D.get("text-offset").evaluate(Q,{},h).map(nr=>nr*ia)}let Di=H?"center":D.get("text-justify").evaluate(Q,{},h),en=$==="point",Gi=en?D.get("text-max-width").evaluate(Q,{},h)*ia:1/0,rn=yn=>{d.allowVerticalPlacement&&Dv(yt)&&(fe.vertical=DT(Me,o,l,p,pe,Gi,jt,Ci,yn,Jt,Pe,Cs.vertical,!0,ue,de,C))};if(!H&&Wi){let yn=Di==="auto"?Wi.map(Ei=>AT(Ei)):[Di],nr=!1;for(let Ei=0;Ei<yn.length;Ei++){let cn=yn[Ei];if(!fe.horizontal[cn])if(nr)fe.horizontal[cn]=fe.horizontal[0];else{let pr=DT(Me,o,l,p,pe,Gi,jt,"center",cn,Jt,Pe,Cs.horizontal,!1,ue,de,C);pr&&(fe.horizontal[cn]=pr,nr=pr.positionedLines.length===1)}}rn("left")}else{if(Di==="auto"&&(Di=AT(Ci)),en||D.get("text-writing-mode").indexOf("horizontal")>=0||!Dv(yt)){let yn=DT(Me,o,l,p,pe,Gi,jt,Ci,Di,Jt,Pe,Cs.horizontal,!1,ue,de,C);yn&&(fe.horizontal[Di]=yn)}rn(en?"left":Di)}}let ze,Ne,Ge,Ue,qe,gt=!1;if(Q.icon&&Q.icon.hasPrimary()){let yt=sL(Q.icon,d.iconSizeData,v["icon-size"],h,d.zoom,Q,C,E.iconScaleFactor);ze=yt.iconPrimary,Ne=yt.iconSecondary;let mi=ze.toString(),jt=u.get(mi);jt&&(Ge=D.get("icon-offset").evaluate(Q,{},h),Ue=D.get("icon-anchor").evaluate(Q,{},h),qe=D.get("icon-text-fit").evaluate(Q,{},h),Fe=F$(p.get(mi),Ne?p.get(Ne.toString()):void 0,Ge,Ue),gt=jt.sdf,d.sdfIcons===void 0?d.sdfIcons=jt.sdf:d.sdfIcons!==jt.sdf&&Er("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(jt.pixelRatio!==d.pixelRatio||D.get("icon-rotate").constantOr(1)!==0)&&(d.iconsNeedLinear=!0))}q=q||!(!Q.icon||!Q.icon.hasSecondary());let ft=RT(fe.horizontal)||fe.vertical;d.iconsInText||(d.iconsInText=!!ft&&ft.iconsInText);let Gt=ue*E.textScaleFactor/ia,{defaultShapedIcon:wt,verticallyShapedIcon:Rt}=H$(d,Fe,D,Q,h,fe,Gt,Ge,qe);Fe=wt,Y.push({feature:Q,shapedTextOrientations:fe,shapedText:ft,shapedIcon:Fe,iconPrimary:ze,iconSecondary:Ne,iconOffset:Ge,iconAnchor:Ue,verticallyShapedIcon:Rt,layoutTextSize:ue,layoutIconSize:De,textOffset:Pe,isSDFIcon:gt,iconTextFit:qe})}return{featureData:Y,sizes:E,hasAnySecondaryIcon:q,textAlongLine:H,symbolPlacement:$}},r.ea=JF,r.eb=function(d,o,l,u,p,h,g,x,C,D){let{featureData:v,hasAnySecondaryIcon:E,sizes:T,textAlongLine:S,symbolPlacement:M}=o;for(let R of v){let{shapedIcon:L,verticallyShapedIcon:N,feature:$,shapedTextOrientations:H,shapedText:j,layoutTextSize:q,textOffset:Y,isSDFIcon:Q,iconPrimary:pe,iconSecondary:de,iconTextFit:ue,iconOffset:De}=R;lL(L,D.iconPositions,pe,de),lL(N,D.iconPositions,pe,de),U$(H,D.iconPositions),(j||L)&&$$(d,$,H,L,N,C,T,q,0,Y,Q,u,p,g,x,E,ue,De,S,M)}l&&d.generateCollisionDebugBuffers(h,d.collisionBoxArray,T.textScaleFactor)},r.ec=Fh,r.ed=P1,r.ee=ma,r.ef=BO,r.eg=NF,r.eh=y,r.ei=function(d){let o=0;if(new Uint32Array(d,0,1)[0]!==kN){let l=new Uint32Array(d,0,7),[,,u,p,h,g]=l;o=l.byteLength+p+h+g+h,(u!==d.byteLength||o>=d.byteLength)&&Er("Invalid b3dm header information.")}return LN(d,o)},r.ej=function(d,o){let l=zN(d);for(let u of l){for(let p of u.meshes)yq(p);u.lights&&(u.lightMeshIndex=u.meshes.length,u.meshes.push(vq(u.lights,o)))}return l},r.ek=E1,r.el=KL,r.em=Vs,r.en=function(d){nn(),Yi?.then(o=>{o.keys().then(l=>{for(let u=0;u<l.length-d;u++)o.delete(l[u])})})},r.f=function(d){return d.indexOf("mapbox:")===0},r.g=function(d,o){return Ls(Io(d,{method:"GET"}),o)},r.h=se,r.i=function(d){return ie.API_STYLE_REGEX.test(d)&&!ye(d)},r.j=function(d){return decodeURIComponent(atob(d).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join(""))},r.k=function(d){return btoa(encodeURIComponent(d).replace(/%([0-9A-F]{2})/g,(o,l)=>String.fromCharCode(+("0x"+l))))},r.l=Io,r.m=Fn,r.n=function(d,o){return Ls(Io(d,{type:"json"}),o)},r.o=Hy,r.p=function(d,o){return Ls(Io(d,{method:"POST"}),o)},r.q=it,r.r=ta,r.s=function(d){try{let o=self[d];return o.setItem("_mapbox_test_",1),o.removeItem("_mapbox_test_"),!0}catch{return!1}},r.t=ot,r.u=function(){return function d(o){return o?(o^Math.random()*(16>>o/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,d)}()},r.v=function(d){return!!d&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(d)},r.w=Er,r.x=function(){return ZT||(ZT=new S1),ZT},r.y=JT,r.z=Qu}),n(["./shared"],function(r){function y(nt){let ie=nt?nt.url.toString():void 0;return ie?performance.getEntriesByName(ie):[]}function A(nt){if(typeof nt=="number"||typeof nt=="boolean"||typeof nt=="string"||nt==null)return JSON.stringify(nt);if(Array.isArray(nt)){let se="[";for(let ye of nt)se+=`${A(ye)},`;return`${se}]`}let ie="{";for(let se of Object.keys(nt).sort())ie+=`${se}:${A(nt[se])},`;return`${ie}}`}function P(nt){let ie="";for(let se of r.bm)(nt.type!=="model"||se!=="minzoom"&&se!=="maxzoom")&&(ie+=`/${A(nt[se])}`);return ie}class B{constructor(ie){this.keyCache={},this._layers={},this._layerConfigs={},ie&&this.replace(ie)}replace(ie,se){this._layerConfigs={},this._layers={},this.update(ie,[],se)}update(ie,se,ye){this._options=ye;for(let Ie of ie)this._layerConfigs[Ie.id]=Ie,(this._layers[Ie.id]=r.cv(Ie,this.scope,null,this._options)).compileFilter(ye),this.keyCache[Ie.id]&&delete this.keyCache[Ie.id];for(let Ie of se)delete this.keyCache[Ie],delete this._layerConfigs[Ie],delete this._layers[Ie];this.familiesBySource={};let ke=function(Ie,Le){let Ze={};for(let Je=0;Je<Ie.length;Je++){let ot=Ie[Je],it=Le&&Le[ot.id];!it&&(it=P(ot),ot.type==="line"&&ot.paint)&&function Ut(Zt){return typeof Zt=="string"&&Zt==="line-progress"||(Array.isArray(Zt)?Zt.some(Ut):!(!Zt||typeof Zt!="object")&&Object.values(Zt).some(Ut))}(ot.paint["line-width"])&&(it+=`/${A(ot.paint["line-width"])}`),Le&&(Le[ot.id]=it);let Tt=Ze[it];Tt||(Tt=Ze[it]=[]),Tt.push(ot)}let Ve=[];for(let Je in Ze)Ve.push(Ze[Je]);return Ve}(Object.values(this._layerConfigs),this.keyCache);for(let Ie of ke){let Le=Ie.map(Tt=>this._layers[Tt.id]),Ze=Le[0];if(Ze.visibility==="none")continue;let Ve=Ze.source||"",Je=this.familiesBySource[Ve];Je||(Je=this.familiesBySource[Ve]={});let ot=Ze.sourceLayer||"_geojsonTileLayer",it=Je[ot];it||(it=Je[ot]=[]),it.push(Le)}}}let U=1*r.d_;class J{constructor(ie){let se={},ye=[];for(let Ze in ie){let Ve=ie[Ze],Je=se[Ze]={};for(let ot in Ve.glyphs){let it=Ve.glyphs[+ot];if(!it||it.bitmap.width===0||it.bitmap.height===0)continue;let Tt=it.metrics.localGlyph?U:1,Ut={x:0,y:0,w:it.bitmap.width+2*Tt,h:it.bitmap.height+2*Tt};ye.push(Ut),Je[ot]=Ut}}let{w:ke,h:Ie}=r.H(ye),Le=new r.dZ({width:ke||1,height:Ie||1});for(let Ze in ie){let Ve=ie[Ze];for(let Je in Ve.glyphs){let ot=Ve.glyphs[+Je];if(!ot||ot.bitmap.width===0||ot.bitmap.height===0)continue;let it=se[Ze][Je],Tt=ot.metrics.localGlyph?U:1;r.dZ.copy(ot.bitmap,Le,{x:0,y:0},{x:it.x+Tt,y:it.y+Tt},ot.bitmap)}}this.image=Le,this.positions=se}}r.dY(J,"GlyphAtlas");class le{constructor(ie){this.tileID=new r.aH(ie.tileID.overscaledZ,ie.tileID.wrap,ie.tileID.canonical.z,ie.tileID.canonical.x,ie.tileID.canonical.y),this.tileZoom=ie.tileZoom,this.uid=ie.uid,this.zoom=ie.zoom,this.lut=ie.lut,this.canonical=ie.tileID.canonical,this.pixelRatio=ie.pixelRatio,this.tileSize=ie.tileSize,this.source=ie.source,this.scope=ie.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ie.showCollisionBoxes,this.collectResourceTiming=!!ie.request&&ie.request.collectResourceTiming,this.promoteId=ie.promoteId,this.isSymbolTile=ie.isSymbolTile,this.tileTransform=r.aR(ie.tileID.canonical,ie.projection),this.projection=ie.projection,this.worldview=ie.worldview,this.localizableLayerIds=ie.localizableLayerIds,this.brightness=ie.brightness,this.extraShadowCaster=!!ie.extraShadowCaster,this.tessellationStep=ie.tessellationStep,this.scaleFactor=ie.scaleFactor}parse(ie,se,ye,ke,Ie){this.status="parsing",this.data=ie,this.collisionBoxArray=new r.aX;let Le=new r.d$(Object.keys(ie.layers).sort()),Ze=new r.e0(this.tileID,this.promoteId);Ze.bucketLayerIDs=[];let Ve={},Je=new r.e1(256,256),ot={featureIndex:Ze,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:Je,availableImages:ye,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},it=se.familiesBySource[this.source];for(let nn in it){let On=ie.layers[nn];if(!On)continue;let Fn=!1,zn=!1,Fr=!1;for(let Fa of it[nn])Fa[0].type==="symbol"?Fn=!0:zn=!0,Fa[0].is3D()&&Fa[0].type!=="model"&&(Fr=!0);if(this.extraShadowCaster&&!Fr||this.isSymbolTile===!0&&!Fn||this.isSymbolTile===!1&&!zn)continue;On.version===1&&r.w(`Vector tile source "${this.source}" layer "${nn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let Ao=Le.encode(nn),_a=[],Fs=!1;for(let Fa=0,Ro=0;Fa<On.length;Fa++){let jo=On.feature(Fa),Zu=Ze.getId(jo,nn);if(this.localizableLayerIds&&this.localizableLayerIds.has(nn)){let Ls=jo.properties?jo.properties.worldview:null;if(this.worldview&&typeof Ls=="string")if(Ls==="all")jo.properties.$localized=!0;else{if(!Ls.split(",").includes(this.worldview))continue;jo.properties.$localized=!0,jo.properties.worldview=this.worldview}}!Fs&&jo.properties&&jo.properties.hasOwnProperty(r.e2)&&(Fs=!0),_a.push({feature:jo,id:Zu,index:Ro,sourceLayerIndex:Ao}),Ro++}Fs&&!ot.elevationFeatures&&ie.layers.hasOwnProperty(r.e3)&&(ot.elevationFeatures=r.e4.parseFrom(ie.layers[r.e3],this.canonical));for(let Fa of it[nn]){let Ro=Fa[0];(!this.extraShadowCaster||Ro.is3D()&&Ro.type!=="model")&&(this.isSymbolTile!==void 0&&Ro.type==="symbol"!==this.isSymbolTile||Ro.minzoom&&this.zoom<Math.floor(Ro.minzoom)||Ro.maxzoom&&this.zoom>=Ro.maxzoom||Ro.visibility!=="none"&&(re(Fa,this.zoom,ot.brightness,ye),(Ve[Ro.id]=Ro.createBucket({index:Ze.bucketLayerIDs.length,layers:Fa,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ao,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(_a,ot,this.tileID.canonical,this.tileTransform),Ze.bucketLayerIDs.push(Fa.map(jo=>r.C(jo.id,jo.scope)))))}}let Tt,Ut,Zt,Pi,Hi,$i;Je.trim();let Yi={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},lr=()=>{if(Tt)return this.status="done",Ie(Tt);if(this.extraShadowCaster)this.status="done",Ie(null,{buckets:Object.values(Ve).filter(nn=>!nn.isEmpty()),featureIndex:Ze,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:ot.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Ut&&Zt&&Pi){let nn=new J(Ut),On=new Map;for(let[Fr,Ao]of Zt.entries()){let{imagePosition:_a}=r.e7(Fr,Ao,r.e8);On.set(Fr,_a)}let Fn={};for(let Fr in Ve){let Ao=Ve[Fr];Ao instanceof r.aY&&(re(Ao.layers,this.zoom,ot.brightness,ye),Fn[Fr]=r.e9(Ao,Ut,nn.positions,Zt,On,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio))}let zn={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(ke,Zt,Hi,()=>{zn.iconsPending=!1,wr(Fn,nn,zn)}),this.rasterizeIfNeeded(ke,Pi,$i,()=>{zn.patternsPending=!1,wr(Fn,nn,zn)})}},wr=(nn,On,Fn,zn)=>{if(Fn.iconsPending||Fn.patternsPending)return;let Fr=new r.ea(Zt,Pi,this.lut);for(let Ao in Ve){let _a=Ve[Ao];if(Ao in nn)r.eb(_a,nn[Ao],this.showCollisionBoxes,ye,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,Zt,Fr);else if(_a.hasPattern&&(_a instanceof r.b2||_a instanceof r.b3||_a instanceof r.d8)){re(_a.layers,this.zoom,ot.brightness,ye);let Fs=Object.fromEntries(Fr.patternPositions);_a.addFeatures(ot,this.tileID.canonical,Fs,ye,this.tileTransform,this.brightness)}}this.status="done",Ie(null,{buckets:Object.values(Ve).filter(Ao=>!Ao.isEmpty()),featureIndex:Ze,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:On.image,lineAtlas:Je,imageAtlas:Fr,brightness:ot.brightness})};if(!this.extraShadowCaster){let nn=r.e5(ot.glyphDependencies,zn=>Object.keys(zn).map(Number));Object.keys(nn).length?ke.send("getGlyphs",{uid:this.uid,stacks:nn,scope:this.scope},(zn,Fr)=>{Tt||(Tt=zn,Ut=Fr,lr())},void 0,!1,Yi):Ut={};let On=Array.from(ot.iconDependencies.keys()).map(zn=>r.I.parse(zn));On.length?ke.send("getImages",{images:On,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(zn,Fr)=>{Tt||(Tt=zn,Zt=new Map,Hi=this.updateImageMapAndGetImageTaskQueue(Zt,Fr,ot.iconDependencies),lr())},void 0,!1,Yi):(Zt=new Map,Hi=new Map);let Fn=Array.from(ot.patternDependencies.keys()).map(zn=>r.I.parse(zn));Fn.length?ke.send("getImages",{images:Fn,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(zn,Fr)=>{Tt||(Tt=zn,Pi=new Map,$i=this.updateImageMapAndGetImageTaskQueue(Pi,Fr,ot.patternDependencies),lr())},void 0,!1,Yi):(Pi=new Map,$i=new Map)}if(ot.elevationFeatures&&ot.elevationFeatures.length>0){let nn=[];for(let Fn of Object.values(Ve))if(Fn instanceof r.b3){let zn=Fn.getUnevaluatedPortalGraph();zn&&nn.push(zn)}let On=r.e6.evaluate(nn);for(let Fn of Object.values(Ve))Fn instanceof r.b3&&Fn.setEvaluatedPortalGraph(On)}lr()}rasterizeIfNeeded(ie,se,ye,ke){Array.from(se.values()).some(Ie=>Ie.usvg)?this.rasterize(ie,se,ye,ke):ke()}updateImageMapAndGetImageTaskQueue(ie,se,ye){let ke=new Map;for(let Ie of se.keys()){let Le=ye.get(Ie)||[];for(let Ze of Le){let Ve=Ze.toString(),Je=se.get(Ze.id.toString());Je.usvg?ke.has(Ve)||(ke.set(Ve,Ze),ie.set(Ve,Object.assign({},Je))):ie.set(Ve,Je)}}return ke}rasterize(ie,se,ye,ke){this.rasterizeTask=ie.send("rasterizeImages",{scope:this.scope,tasks:ye},(Ie,Le)=>{if(!Ie)for(let[Ze,Ve]of Le.entries()){let Je=Object.assign(se.get(Ze),{data:Ve});se.set(Ze,Je)}ke()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function re(nt,ie,se,ye){let ke=new r.aa(ie,{brightness:se});for(let Ie of nt)Ie.recalculate(ke,ye)}class X extends r.E{constructor(ie,se,ye,ke,Ie,Le){super(),this.actor=ie,this.layerIndex=se,this.availableImages=ye,this.loadVectorData=Ie||r.aE,this.loading={},this.loaded={},this.deduped=new r.aD(ie.scheduler),this.isSpriteLoaded=ke,this.scheduler=ie.scheduler,this.brightness=Le}loadTile(ie,se){let ye=ie.uid,ke=ie&&ie.request,Ie=ke&&ke.collectResourceTiming,Le=this.loading[ye]=new le(ie);Le.abort=this.loadVectorData(ie,(Ze,Ve)=>{let Je=!this.loading[ye];if(delete this.loading[ye],Le.cancelRasterize(),Je||Ze||!Ve)return Le.status="done",Je||(this.loaded[ye]=Le),se(Ze);let ot=Ve.rawData,it={};Ve.expires&&(it.expires=Ve.expires),Ve.cacheControl&&(it.cacheControl=Ve.cacheControl),Le.vectorTile=Ve.vectorTile||new r.ec.VectorTile(new r.bi(ot));let Tt=()=>{Le.parse(Le.vectorTile,this.layerIndex,this.availableImages,this.actor,(Ut,Zt)=>{if(Ut||!Zt)return se(Ut);let Pi={};if(Ie){let Hi=y(ke);Hi.length>0&&(Pi.resourceTiming=JSON.parse(JSON.stringify(Hi)))}se(null,r.l({rawTileData:ot.slice(0)},Zt,it,Pi))})};this.isSpriteLoaded?Tt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Tt,{type:"parseTile",isSymbolTile:ie.isSymbolTile,zoom:ie.tileZoom}):Tt()}),this.loaded=this.loaded||{},this.loaded[ye]=Le})}reloadTile(ie,se){let ye=this.loaded,ke=ie.uid;if(ye&&ye[ke]){let Ie=ye[ke];Ie.scaleFactor=ie.scaleFactor,Ie.showCollisionBoxes=ie.showCollisionBoxes,Ie.projection=ie.projection,Ie.brightness=ie.brightness,Ie.tileTransform=r.aR(ie.tileID.canonical,ie.projection),Ie.extraShadowCaster=ie.extraShadowCaster,Ie.lut=ie.lut;let Le=(Ze,Ve)=>{let Je=Ie.reloadCallback;Je&&(delete Ie.reloadCallback,Ie.parse(Ie.vectorTile,this.layerIndex,this.availableImages,this.actor,Je)),se(Ze,Ve)};Ie.status==="parsing"?Ie.reloadCallback=Le:Ie.status==="done"&&(Ie.vectorTile?Ie.parse(Ie.vectorTile,this.layerIndex,this.availableImages,this.actor,Le):Le())}else se(null,void 0)}abortTile(ie,se){let ye=ie.uid,ke=this.loading[ye];ke&&(ke.abort&&ke.abort(),delete this.loading[ye]),se()}removeTile(ie,se){let ye=this.loaded,ke=ie.uid;ye&&ye[ke]&&delete ye[ke],se()}}class ee{loadTile(ie,se){let{uid:ye,encoding:ke,rawImageData:Ie,padding:Le}=ie,Ze=ImageBitmap&&Ie instanceof ImageBitmap?this.getImageData(Ie,Le):Ie;se(null,new r.ed(ye,Ze,ke,Le<1))}reloadTile(ie,se){se(null,null)}abortTile(ie,se){se()}removeTile(ie,se){se()}getImageData(ie,se){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ie.width,ie.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ie.width,this.offscreenCanvas.height=ie.height,this.offscreenCanvasContext.drawImage(ie,0,0,ie.width,ie.height);let ye=this.offscreenCanvasContext.getImageData(-se,-se,ie.width+2*se,ie.height+2*se);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ye}}r.bh.setPbf(r.bi);class we{constructor(ie){this._mrt=new r.bh(ie.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=ie.uid,this.tileID=ie.tileID,this.source=ie.source}parse(ie,se){let ye=this._mrt;this.status="parsing",this._entireBuffer=ie;try{ye.parseHeader(ie),this._isHeaderLoaded=!0;let ke=[];for(let Ie in ye.layers){let Le=ye.getLayer(Ie),Ze=Le.getDataRange(Le.getBandList()),Ve=ye.createDecodingTask(Ze),Je=ie.slice(Ze.firstByte,Ze.lastByte+1),ot=r.bh.performDecoding(Je,Ve).then(it=>Ve.complete(null,it)).catch(it=>Ve.complete(it,null));ke.push(ot)}Promise.allSettled(ke).then(()=>se(null,ye))}catch(ke){se(ke)}}}class Re{constructor(ie){this.actor=ie,this.loading={},this.loaded={}}loadTile(ie,se){let ye=ie.uid,ke=ie.request,Ie=this.loading[ye]=new we(ie),{cancel:Le}=r.bj(ke,(Ze,Ve,Je,ot)=>{let it=!this.loading[ye];if(delete this.loading[ye],it||Ze||!Ve)return Ie.status="done",it||(this.loaded[ye]=Ie),se(Ze);Ie.parse(Ve,(Tt,Ut)=>{if(Tt||!Ut)return se(Tt);se(null,Ut,Je,ot)}),this.loaded[ye]=Ie});Ie.abort=Le}reloadTile(ie,se){se(null,void 0)}abortTile(ie,se){let ye=ie.uid,ke=this.loading[ye];ke&&(ke.abort&&ke.abort(),delete this.loading[ye]),se()}removeTile(ie,se){let ye=ie.uid;this.loaded[ye]&&delete this.loaded[ye],se()}decodeRasterArray({task:ie,buffer:se},ye){r.bh.performDecoding(se,ie).then(ke=>ye(null,ke)).catch(ke=>ye(ke))}}let Ce=r.ec.VectorTileFeature.prototype.toGeoJSON;class Te{constructor(ie){this._feature=ie,this.extent=r.ai,this.type=ie.type,this.properties=ie.tags,"id"in ie&&!isNaN(ie.id)&&(this.id=parseInt(ie.id,10))}loadGeometry(){if(this._feature.type===1){let ie=[];for(let se of this._feature.geometry)ie.push([new r.P(se[0],se[1])]);return ie}{let ie=[];for(let se of this._feature.geometry){let ye=[];for(let ke of se)ye.push(new r.P(ke[0],ke[1]));ie.push(ye)}return ie}}toGeoJSON(ie,se,ye){return Ce.call(this,ie,se,ye)}}class Xe{constructor(ie){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=r.ai,this.length=ie.length,this._features=ie}feature(ie){return new Te(this._features[ie])}}let et=64/4096,Pt=128;class Lt{constructor(){this.features=new Map}clear(){this.features.clear()}load(ie=[],se){for(let ye of ie){let ke=ye.id;if(ke==null)continue;let Ie=this.features.get(ke);Ie&&this.updateCache(Ie,se),ye.geometry?(Ie=Ye(ye),this.updateCache(Ie,se),this.features.set(ke,Ie)):this.features.delete(ke),this.updateCache(Ie,se)}}updateCache(ie,se){for(let{canonical:ye,uid:ke}of Object.values(se)){let{z:Ie,x:Le,y:Ze}=ye;lt(ie,Math.pow(2,Ie),Le,Ze)&&delete se[ke]}}getTile(ie,se,ye){let ke=Math.pow(2,ie),Ie=[];for(let Le of this.features.values())lt(Le,ke,se,ye)&&Ie.push(dt(Le,ke,se,ye));return{features:Ie}}getFeatures(){return[...this.features.values()]}}function lt({minX:nt,minY:ie,maxX:se,maxY:ye},ke,Ie,Le){return nt<(Ie+1+et)/ke&&ie<(Le+1+et)/ke&&se>(Ie-et)/ke&&ye>(Le-et)/ke}function Ye(nt){let{id:ie,geometry:se,properties:ye}=nt;if(!se)return;if(se.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");let{type:ke,coordinates:Ie}=se,Le={id:ie,type:1,geometry:[],tags:ye,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Ze=Le.geometry;if(ke==="Point")xt(Ie,Ze,Le);else if(ke==="MultiPoint")for(let Ve of Ie)xt(Ve,Ze,Le);else if(ke==="LineString")Le.type=2,Bt(Ie,Ze,Le);else if(ke==="MultiLineString")Le.type=2,Ft(Ie,Ze,Le);else if(ke==="Polygon")Le.type=3,Ft(Ie,Ze,Le,!0);else{if(ke!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");Le.type=3;for(let Ve of Ie)Ft(Ve,Ze,Le,!0)}return Le}function xt([nt,ie],se,ye){let ke=r.av(nt),Ie=r.aC(ie);Ie=Ie<0?0:Ie>1?1:Ie,se.push(ke,Ie),ye.minX=Math.min(ye.minX,ke),ye.minY=Math.min(ye.minY,Ie),ye.maxX=Math.max(ye.maxX,ke),ye.maxY=Math.max(ye.maxY,Ie)}function Bt(nt,ie,se,ye=!1,ke=!1){let Ie=[];for(let Le of nt)xt(Le,Ie,se);ie.push(Ie),ye&&function(Le,Ze){let Ve=0;for(let Je=0,ot=Le.length,it=ot-2;Je<ot;it=Je,Je+=2)Ve+=(Le[Je]-Le[it])*(Le[Je+1]+Le[it+1]);if(Ve>0===Ze)for(let Je=0,ot=Le.length;Je<ot/2;Je+=2){let it=Le[Je],Tt=Le[Je+1];Le[Je]=Le[ot-2-Je],Le[Je+1]=Le[ot-1-Je],Le[ot-2-Je]=it,Le[ot-1-Je]=Tt}}(Ie,ke)}function Ft(nt,ie,se,ye=!1){for(let ke=0;ke<nt.length;ke++)Bt(nt[ke],ie,se,ye,ke===0)}function dt(nt,ie,se,ye){let{id:ke,type:Ie,geometry:Le,tags:Ze}=nt,Ve=[];if(Ie===1)(function(Je,ot,it,Tt,Ut){for(let Zt=0;Zt<Je.length;Zt+=2){let Pi=Math.round(r.ai*(Je[Zt+0]*ot-it)),Hi=Math.round(r.ai*(Je[Zt+1]*ot-Tt));Ut.push([Pi,Hi])}})(Le,ie,se,ye,Ve);else for(let Je of Le)Ot(Je,ie,se,ye,Ve);return{id:ke,type:Ie,geometry:Ve,tags:Ze}}function Ot(nt,ie,se,ye,ke){let Ie=-Pt,Le=r.ai+Pt,Ze;for(let Ve=0;Ve<nt.length-2;Ve+=2){let Je=Math.round(r.ai*(nt[Ve+0]*ie-se)),ot=Math.round(r.ai*(nt[Ve+1]*ie-ye)),it=Math.round(r.ai*(nt[Ve+2]*ie-se)),Tt=Math.round(r.ai*(nt[Ve+3]*ie-ye)),Ut=it-Je,Zt=Tt-ot;Je<Ie&&it<Ie||(Je<Ie?(ot+=Math.round(Zt*((Ie-Je)/Ut)),Je=Ie):it<Ie&&(Tt=ot+Math.round(Zt*((Ie-Je)/Ut)),it=Ie),ot<Ie&&Tt<Ie||(ot<Ie?(Je+=Math.round(Ut*((Ie-ot)/Zt)),ot=Ie):Tt<Ie&&(it=Je+Math.round(Ut*((Ie-ot)/Zt)),Tt=Ie),Je>=Le&&it>=Le||(Je>=Le?(ot+=Math.round(Zt*((Le-Je)/Ut)),Je=Le):it>=Le&&(Tt=ot+Math.round(Zt*((Le-Je)/Ut)),it=Le),ot>=Le&&Tt>=Le||(ot>=Le?(Je+=Math.round(Ut*((Le-ot)/Zt)),ot=Le):Tt>=Le&&(it=Je+Math.round(Ut*((Le-ot)/Zt)),Tt=Le),Ze&&Je===Ze[Ze.length-1][0]&&ot===Ze[Ze.length-1][1]||(Ze=[[Je,ot]],ke.push(Ze)),Ze.push([it,Tt])))))}}var Kt,oi,tt,vt={exports:{}},pi=function(){if(tt)return vt.exports;tt=1;var nt=r.eg(),ie=function(){if(oi)return Kt;oi=1;var ot=r.ee(),it=r.ef().VectorTileFeature;function Tt(Zt,Pi){this.options=Pi||{},this.features=Zt,this.length=Zt.length}function Ut(Zt,Pi){this.id=typeof Zt.id=="number"?Zt.id:void 0,this.type=Zt.type,this.rawGeometry=Zt.type===1?[Zt.geometry]:Zt.geometry,this.properties=Zt.tags,this.extent=Pi||4096}return Kt=Tt,Tt.prototype.feature=function(Zt){return new Ut(this.features[Zt],this.options.extent)},Ut.prototype.loadGeometry=function(){var Zt=this.rawGeometry;this.geometry=[];for(var Pi=0;Pi<Zt.length;Pi++){for(var Hi=Zt[Pi],$i=[],Yi=0;Yi<Hi.length;Yi++)$i.push(new ot(Hi[Yi][0],Hi[Yi][1]));this.geometry.push($i)}return this.geometry},Ut.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Zt=this.geometry,Pi=1/0,Hi=-1/0,$i=1/0,Yi=-1/0,lr=0;lr<Zt.length;lr++)for(var wr=Zt[lr],nn=0;nn<wr.length;nn++){var On=wr[nn];Pi=Math.min(Pi,On.x),Hi=Math.max(Hi,On.x),$i=Math.min($i,On.y),Yi=Math.max(Yi,On.y)}return[Pi,$i,Hi,Yi]},Ut.prototype.toGeoJSON=it.prototype.toGeoJSON,Kt}();function se(ot){var it=new nt;return function(Tt,Ut){for(var Zt in Tt.layers)Ut.writeMessage(3,ye,Tt.layers[Zt])}(ot,it),it.finish()}function ye(ot,it){var Tt;it.writeVarintField(15,ot.version||1),it.writeStringField(1,ot.name||""),it.writeVarintField(5,ot.extent||4096);var Ut={keys:[],values:[],keycache:{},valuecache:{}};for(Tt=0;Tt<ot.length;Tt++)Ut.feature=ot.feature(Tt),it.writeMessage(2,ke,Ut);var Zt=Ut.keys;for(Tt=0;Tt<Zt.length;Tt++)it.writeStringField(3,Zt[Tt]);var Pi=Ut.values;for(Tt=0;Tt<Pi.length;Tt++)it.writeMessage(4,Je,Pi[Tt])}function ke(ot,it){var Tt=ot.feature;Tt.id!==void 0&&it.writeVarintField(1,Tt.id),it.writeMessage(2,Ie,ot),it.writeVarintField(3,Tt.type),it.writeMessage(4,Ve,Tt)}function Ie(ot,it){var Tt=ot.feature,Ut=ot.keys,Zt=ot.values,Pi=ot.keycache,Hi=ot.valuecache;for(var $i in Tt.properties){var Yi=Tt.properties[$i],lr=Pi[$i];if(Yi!==null){lr===void 0&&(Ut.push($i),Pi[$i]=lr=Ut.length-1),it.writeVarint(lr);var wr=typeof Yi;wr!=="string"&&wr!=="boolean"&&wr!=="number"&&(Yi=JSON.stringify(Yi));var nn=wr+":"+Yi,On=Hi[nn];On===void 0&&(Zt.push(Yi),Hi[nn]=On=Zt.length-1),it.writeVarint(On)}}}function Le(ot,it){return(it<<3)+(7&ot)}function Ze(ot){return ot<<1^ot>>31}function Ve(ot,it){for(var Tt=ot.loadGeometry(),Ut=ot.type,Zt=0,Pi=0,Hi=Tt.length,$i=0;$i<Hi;$i++){var Yi=Tt[$i],lr=1;Ut===1&&(lr=Yi.length),it.writeVarint(Le(1,lr));for(var wr=Ut===3?Yi.length-1:Yi.length,nn=0;nn<wr;nn++){nn===1&&Ut!==1&&it.writeVarint(Le(2,wr-1));var On=Yi[nn].x-Zt,Fn=Yi[nn].y-Pi;it.writeVarint(Ze(On)),it.writeVarint(Ze(Fn)),Zt+=On,Pi+=Fn}Ut===3&&it.writeVarint(Le(7,1))}}function Je(ot,it){var Tt=typeof ot;Tt==="string"?it.writeStringField(1,ot):Tt==="boolean"?it.writeBooleanField(7,ot):Tt==="number"&&(ot%1!=0?it.writeDoubleField(3,ot):ot<0?it.writeSVarintField(6,ot):it.writeVarintField(5,ot))}return vt.exports=se,vt.exports.fromVectorTileJs=se,vt.exports.fromGeojsonVt=function(ot,it){it=it||{};var Tt={};for(var Ut in ot)Tt[Ut]=new ie(ot[Ut].features,it),Tt[Ut].name=Ut,Tt[Ut].version=it.version,Tt[Ut].extent=it.extent;return se({layers:Tt})},vt.exports.GeoJSONWrapper=ie,vt.exports}(),mn=r.eh(pi);let _i={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:nt=>nt},ro=Math.fround||(pa=new Float32Array(1),nt=>(pa[0]=+nt,pa[0]));var pa;let Ko=3,Qt=5,Xt=6;class li{constructor(ie){this.options=Object.assign(Object.create(_i),ie),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ie){let{log:se,minZoom:ye,maxZoom:ke}=this.options;se&&console.time("total time");let Ie=`prepare ${ie.length} points`;se&&console.time(Ie),this.points=ie;let Le=[];for(let Ve=0;Ve<ie.length;Ve++){let Je=ie[Ve];if(!Je.geometry)continue;let[ot,it]=Je.geometry.coordinates,Tt=ro(fa(ot)),Ut=ro(ma(it));Le.push(Tt,Ut,1/0,Ve,-1,1),this.options.reduce&&Le.push(0)}let Ze=this.trees[ke+1]=this._createTree(Le);se&&console.timeEnd(Ie);for(let Ve=ke;Ve>=ye;Ve--){let Je=+Date.now();Ze=this.trees[Ve]=this._createTree(this._cluster(Ze,Ve)),se&&console.log("z%d: %d clusters in %dms",Ve,Ze.numItems,+Date.now()-Je)}return se&&console.timeEnd("total time"),this}getClusters(ie,se){let ye=((ie[0]+180)%360+360)%360-180,ke=Math.max(-90,Math.min(90,ie[1])),Ie=ie[2]===180?180:((ie[2]+180)%360+360)%360-180,Le=Math.max(-90,Math.min(90,ie[3]));if(ie[2]-ie[0]>=360)ye=-180,Ie=180;else if(ye>Ie){let it=this.getClusters([ye,ke,180,Le],se),Tt=this.getClusters([-180,ke,Ie,Le],se);return it.concat(Tt)}let Ze=this.trees[this._limitZoom(se)],Ve=Ze.range(fa(ye),ma(Le),fa(Ie),ma(ke)),Je=Ze.data,ot=[];for(let it of Ve){let Tt=this.stride*it;ot.push(Je[Tt+Qt]>1?ce(Je,Tt,this.clusterProps):this.points[Je[Tt+Ko]])}return ot}getChildren(ie){let se=this._getOriginId(ie),ye=this._getOriginZoom(ie),ke="No cluster with the specified id.",Ie=this.trees[ye];if(!Ie)throw new Error(ke);let Le=Ie.data;if(se*this.stride>=Le.length)throw new Error(ke);let Ze=this.options.radius/(this.options.extent*Math.pow(2,ye-1)),Ve=Ie.within(Le[se*this.stride],Le[se*this.stride+1],Ze),Je=[];for(let ot of Ve){let it=ot*this.stride;Le[it+4]===ie&&Je.push(Le[it+Qt]>1?ce(Le,it,this.clusterProps):this.points[Le[it+Ko]])}if(Je.length===0)throw new Error(ke);return Je}getLeaves(ie,se,ye){let ke=[];return this._appendLeaves(ke,ie,se=se||10,ye=ye||0,0),ke}getTile(ie,se,ye){let ke=this.trees[this._limitZoom(ie)],Ie=Math.pow(2,ie),{extent:Le,radius:Ze}=this.options,Ve=Ze/Le,Je=(ye-Ve)/Ie,ot=(ye+1+Ve)/Ie,it={features:[]};return this._addTileFeatures(ke.range((se-Ve)/Ie,Je,(se+1+Ve)/Ie,ot),ke.data,se,ye,Ie,it),se===0&&this._addTileFeatures(ke.range(1-Ve/Ie,Je,1,ot),ke.data,Ie,ye,Ie,it),se===Ie-1&&this._addTileFeatures(ke.range(0,Je,Ve/Ie,ot),ke.data,-1,ye,Ie,it),it.features.length?it:null}getClusterExpansionZoom(ie){let se=this._getOriginZoom(ie)-1;for(;se<=this.options.maxZoom;){let ye=this.getChildren(ie);if(se++,ye.length!==1)break;ie=ye[0].properties.cluster_id}return se}_appendLeaves(ie,se,ye,ke,Ie){let Le=this.getChildren(se);for(let Ze of Le){let Ve=Ze.properties;if(Ve&&Ve.cluster?Ie+Ve.point_count<=ke?Ie+=Ve.point_count:Ie=this._appendLeaves(ie,Ve.cluster_id,ye,ke,Ie):Ie<ke?Ie++:ie.push(Ze),ie.length===ye)break}return Ie}_createTree(ie){let se=new r.bE(ie.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ye=0;ye<ie.length;ye+=this.stride)se.add(ie[ye],ie[ye+1]);return se.finish(),se.data=ie,se}_addTileFeatures(ie,se,ye,ke,Ie,Le){for(let Ze of ie){let Ve=Ze*this.stride,Je=se[Ve+Qt]>1,ot,it,Tt;if(Je)ot=Xr(se,Ve,this.clusterProps),it=se[Ve],Tt=se[Ve+1];else{let Pi=this.points[se[Ve+Ko]];ot=Pi.properties;let[Hi,$i]=Pi.geometry.coordinates;it=fa(Hi),Tt=ma($i)}let Ut={type:1,geometry:[[Math.round(this.options.extent*(it*Ie-ye)),Math.round(this.options.extent*(Tt*Ie-ke))]],tags:ot},Zt;Zt=Je||this.options.generateId?se[Ve+Ko]:this.points[se[Ve+Ko]].id,Zt!==void 0&&(Ut.id=Zt),Le.features.push(Ut)}}_limitZoom(ie){return Math.max(this.options.minZoom,Math.min(Math.floor(+ie),this.options.maxZoom+1))}_cluster(ie,se){let{radius:ye,extent:ke,reduce:Ie,minPoints:Le}=this.options,Ze=ye/(ke*Math.pow(2,se)),Ve=ie.data,Je=[],ot=this.stride;for(let it=0;it<Ve.length;it+=ot){if(Ve[it+2]<=se)continue;Ve[it+2]=se;let Tt=Ve[it],Ut=Ve[it+1],Zt=ie.within(Ve[it],Ve[it+1],Ze),Pi=Ve[it+Qt],Hi=Pi;for(let $i of Zt){let Yi=$i*ot;Ve[Yi+2]>se&&(Hi+=Ve[Yi+Qt])}if(Hi>Pi&&Hi>=Le){let $i,Yi=Tt*Pi,lr=Ut*Pi,wr=-1,nn=(it/ot<<5)+(se+1)+this.points.length;for(let On of Zt){let Fn=On*ot;if(Ve[Fn+2]<=se)continue;Ve[Fn+2]=se;let zn=Ve[Fn+Qt];Yi+=Ve[Fn]*zn,lr+=Ve[Fn+1]*zn,Ve[Fn+4]=nn,Ie&&($i||($i=this._map(Ve,it,!0),wr=this.clusterProps.length,this.clusterProps.push($i)),Ie($i,this._map(Ve,Fn)))}Ve[it+4]=nn,Je.push(Yi/Hi,lr/Hi,1/0,nn,-1,Hi),Ie&&Je.push(wr)}else{for(let $i=0;$i<ot;$i++)Je.push(Ve[it+$i]);if(Hi>1)for(let $i of Zt){let Yi=$i*ot;if(!(Ve[Yi+2]<=se)){Ve[Yi+2]=se;for(let lr=0;lr<ot;lr++)Je.push(Ve[Yi+lr])}}}}return Je}_getOriginId(ie){return ie-this.points.length>>5}_getOriginZoom(ie){return(ie-this.points.length)%32}_map(ie,se,ye){if(ie[se+Qt]>1){let Le=this.clusterProps[ie[se+Xt]];return ye?Object.assign({},Le):Le}let ke=this.points[ie[se+Ko]].properties,Ie=this.options.map(ke);return ye&&Ie===ke?Object.assign({},Ie):Ie}}function ce(nt,ie,se){return{type:"Feature",id:nt[ie+Ko],properties:Xr(nt,ie,se),geometry:{type:"Point",coordinates:[(ye=nt[ie],360*(ye-.5)),At(nt[ie+1])]}};var ye}function Xr(nt,ie,se){let ye=nt[ie+Qt],ke=ye>=1e4?`${Math.round(ye/1e3)}k`:ye>=1e3?Math.round(ye/100)/10+"k":ye,Ie=nt[ie+Xt],Le=Ie===-1?{}:Object.assign({},se[Ie]);return Object.assign(Le,{cluster:!0,cluster_id:nt[ie+Ko],point_count:ye,point_count_abbreviated:ke})}function fa(nt){return nt/360+.5}function ma(nt){let ie=Math.sin(nt*Math.PI/180),se=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return se<0?0:se>1?1:se}function At(nt){let ie=(180-360*nt)*Math.PI/180;return 360*Math.atan(Math.exp(ie))/Math.PI-90}function To(nt,ie,se,ye){let ke=ye,Ie=ie+(se-ie>>1),Le,Ze=se-ie,Ve=nt[ie],Je=nt[ie+1],ot=nt[se],it=nt[se+1];for(let Tt=ie+3;Tt<se;Tt+=3){let Ut=mr(nt[Tt],nt[Tt+1],Ve,Je,ot,it);if(Ut>ke)Le=Tt,ke=Ut;else if(Ut===ke){let Zt=Math.abs(Tt-Ie);Zt<Ze&&(Le=Tt,Ze=Zt)}}ke>ye&&(Le-ie>3&&To(nt,ie,Le,ye),nt[Le+2]=ke,se-Le>3&&To(nt,Le,se,ye))}function mr(nt,ie,se,ye,ke,Ie){let Le=ke-se,Ze=Ie-ye;if(Le!==0||Ze!==0){let Ve=((nt-se)*Le+(ie-ye)*Ze)/(Le*Le+Ze*Ze);Ve>1?(se=ke,ye=Ie):Ve>0&&(se+=Le*Ve,ye+=Ze*Ve)}return Le=nt-se,Ze=ie-ye,Le*Le+Ze*Ze}function ho(nt,ie,se,ye){let ke={id:nt??null,type:ie,geometry:se,tags:ye,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ie==="Point"||ie==="MultiPoint"||ie==="LineString")Qi(ke,se);else if(ie==="Polygon")Qi(ke,se[0]);else if(ie==="MultiLineString")for(let Ie of se)Qi(ke,Ie);else if(ie==="MultiPolygon")for(let Ie of se)Qi(ke,Ie[0]);return ke}function Qi(nt,ie){for(let se=0;se<ie.length;se+=3)nt.minX=Math.min(nt.minX,ie[se]),nt.minY=Math.min(nt.minY,ie[se+1]),nt.maxX=Math.max(nt.maxX,ie[se]),nt.maxY=Math.max(nt.maxY,ie[se+1])}function Ur(nt,ie,se,ye){if(!ie.geometry)return;let ke=ie.geometry.coordinates;if(ke&&ke.length===0)return;let Ie=ie.geometry.type,Le=Math.pow(se.tolerance/((1<<se.maxZoom)*se.extent),2),Ze=[],Ve=ie.id;if(se.promoteId?Ve=ie.properties[se.promoteId]:se.generateId&&(Ve=ye||0),Ie==="Point")ga(ke,Ze);else if(Ie==="MultiPoint")for(let Je of ke)ga(Je,Ze);else if(Ie==="LineString")Ya(ke,Ze,Le,!1);else if(Ie==="MultiLineString"){if(se.lineMetrics){for(let Je of ke)Ze=[],Ya(Je,Ze,Le,!1),nt.push(ho(Ve,"LineString",Ze,ie.properties));return}Za(ke,Ze,Le,!1)}else if(Ie==="Polygon")Za(ke,Ze,Le,!0);else{if(Ie!=="MultiPolygon"){if(Ie==="GeometryCollection"){for(let Je of ie.geometry.geometries)Ur(nt,{id:Ve,geometry:Je,properties:ie.properties},se,ye);return}throw new Error("Input data is not a valid GeoJSON object.")}for(let Je of ke){let ot=[];Za(Je,ot,Le,!0),Ze.push(ot)}}nt.push(ho(Ve,Ie,Ze,ie.properties))}function ga(nt,ie){ie.push(ll(nt[0]),qi(nt[1]),0)}function Ya(nt,ie,se,ye){let ke,Ie,Le=0;for(let Ve=0;Ve<nt.length;Ve++){let Je=ll(nt[Ve][0]),ot=qi(nt[Ve][1]);ie.push(Je,ot,0),Ve>0&&(Le+=ye?(ke*ot-Je*Ie)/2:Math.sqrt(Math.pow(Je-ke,2)+Math.pow(ot-Ie,2))),ke=Je,Ie=ot}let Ze=ie.length-3;ie[2]=1,To(ie,0,Ze,se),ie[Ze+2]=1,ie.size=Math.abs(Le),ie.start=0,ie.end=ie.size}function Za(nt,ie,se,ye){for(let ke=0;ke<nt.length;ke++){let Ie=[];Ya(nt[ke],Ie,se,ye),ie.push(Ie)}}function ll(nt){return nt/360+.5}function qi(nt){let ie=Math.sin(nt*Math.PI/180),se=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return se<0?0:se>1?1:se}function Vo(nt,ie,se,ye,ke,Ie,Le,Ze){if(ye/=ie,Ie>=(se/=ie)&&Le<ye)return nt;if(Le<se||Ie>=ye)return null;let Ve=[];for(let Je of nt){let ot=Je.geometry,it=Je.type,Tt=ke===0?Je.minX:Je.minY,Ut=ke===0?Je.maxX:Je.maxY;if(Tt>=se&&Ut<ye){Ve.push(Je);continue}if(Ut<se||Tt>=ye)continue;let Zt=[];if(it==="Point"||it==="MultiPoint")Os(ot,Zt,se,ye,ke);else if(it==="LineString")cl(ot,Zt,se,ye,ke,!1,Ze.lineMetrics);else if(it==="MultiLineString")Oa(ot,Zt,se,ye,ke,!1);else if(it==="Polygon")Oa(ot,Zt,se,ye,ke,!0);else if(it==="MultiPolygon")for(let Pi of ot){let Hi=[];Oa(Pi,Hi,se,ye,ke,!0),Hi.length&&Zt.push(Hi)}if(Zt.length){if(Ze.lineMetrics&&it==="LineString"){for(let Pi of Zt)Ve.push(ho(Je.id,it,Pi,Je.tags));continue}it!=="LineString"&&it!=="MultiLineString"||(Zt.length===1?(it="LineString",Zt=Zt[0]):it="MultiLineString"),it!=="Point"&&it!=="MultiPoint"||(it=Zt.length===3?"Point":"MultiPoint"),Ve.push(ho(Je.id,it,Zt,Je.tags))}}return Ve.length?Ve:null}function Os(nt,ie,se,ye,ke){for(let Ie=0;Ie<nt.length;Ie+=3){let Le=nt[Ie+ke];Le>=se&&Le<=ye&&ps(ie,nt[Ie],nt[Ie+1],nt[Ie+2])}}function cl(nt,ie,se,ye,ke,Ie,Le){let Ze=Io(nt),Ve=ke===0?dl:Wp,Je,ot,it=nt.start;for(let Hi=0;Hi<nt.length-3;Hi+=3){let $i=nt[Hi],Yi=nt[Hi+1],lr=nt[Hi+2],wr=nt[Hi+3],nn=nt[Hi+4],On=ke===0?$i:Yi,Fn=ke===0?wr:nn,zn=!1;Le&&(Je=Math.sqrt(Math.pow($i-wr,2)+Math.pow(Yi-nn,2))),On<se?Fn>se&&(ot=Ve(Ze,$i,Yi,wr,nn,se),Le&&(Ze.start=it+Je*ot)):On>ye?Fn<ye&&(ot=Ve(Ze,$i,Yi,wr,nn,ye),Le&&(Ze.start=it+Je*ot)):ps(Ze,$i,Yi,lr),Fn<se&&On>=se&&(ot=Ve(Ze,$i,Yi,wr,nn,se),zn=!0),Fn>ye&&On<=ye&&(ot=Ve(Ze,$i,Yi,wr,nn,ye),zn=!0),!Ie&&zn&&(Le&&(Ze.end=it+Je*ot),ie.push(Ze),Ze=Io(nt)),Le&&(it+=Je)}let Tt=nt.length-3,Ut=nt[Tt],Zt=nt[Tt+1],Pi=ke===0?Ut:Zt;Pi>=se&&Pi<=ye&&ps(Ze,Ut,Zt,nt[Tt+2]),Tt=Ze.length-3,Ie&&Tt>=3&&(Ze[Tt]!==Ze[0]||Ze[Tt+1]!==Ze[1])&&ps(Ze,Ze[0],Ze[1],Ze[2]),Ze.length&&ie.push(Ze)}function Io(nt){let ie=[];return ie.size=nt.size,ie.start=nt.start,ie.end=nt.end,ie}function Oa(nt,ie,se,ye,ke,Ie){for(let Le of nt)cl(Le,ie,se,ye,ke,Ie,!1)}function ps(nt,ie,se,ye){nt.push(ie,se,ye)}function dl(nt,ie,se,ye,ke,Ie){let Le=(Ie-ie)/(ye-ie);return ps(nt,Ie,se+(ke-se)*Le,1),Le}function Wp(nt,ie,se,ye,ke,Ie){let Le=(Ie-se)/(ke-se);return ps(nt,ie+(ye-ie)*Le,Ie,1),Le}function Xd(nt,ie){let se=[];for(let ye=0;ye<nt.length;ye++){let ke=nt[ye],Ie=ke.type,Le;if(Ie==="Point"||Ie==="MultiPoint"||Ie==="LineString")Le=Kd(ke.geometry,ie);else if(Ie==="MultiLineString"||Ie==="Polygon"){Le=[];for(let Ze of ke.geometry)Le.push(Kd(Ze,ie))}else if(Ie==="MultiPolygon"){Le=[];for(let Ze of ke.geometry){let Ve=[];for(let Je of Ze)Ve.push(Kd(Je,ie));Le.push(Ve)}}se.push(ho(ke.id,Ie,Le,ke.tags))}return se}function Kd(nt,ie){let se=[];se.size=nt.size,nt.start!==void 0&&(se.start=nt.start,se.end=nt.end);for(let ye=0;ye<nt.length;ye+=3)se.push(nt[ye]+ie,nt[ye+1],nt[ye+2]);return se}function fs(nt,ie){if(nt.transformed)return nt;let se=1<<nt.z,ye=nt.x,ke=nt.y;for(let Ie of nt.features){let Le=Ie.geometry,Ze=Ie.type;if(Ie.geometry=[],Ze===1)for(let Ve=0;Ve<Le.length;Ve+=2)Ie.geometry.push(qu(Le[Ve],Le[Ve+1],ie,se,ye,ke));else for(let Ve=0;Ve<Le.length;Ve++){let Je=[];for(let ot=0;ot<Le[Ve].length;ot+=2)Je.push(qu(Le[Ve][ot],Le[Ve][ot+1],ie,se,ye,ke));Ie.geometry.push(Je)}}return nt.transformed=!0,nt}function qu(nt,ie,se,ye,ke,Ie){return[Math.round(se*(nt*ye-ke)),Math.round(se*(ie*ye-Ie))]}function Er(nt,ie,se,ye,ke){let Ie=ie===ke.maxZoom?0:ke.tolerance/((1<<ie)*ke.extent),Le={features:[],numPoints:0,numSimplified:0,numFeatures:nt.length,source:null,x:se,y:ye,z:ie,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(let Ze of nt)Kn(Le,Ze,Ie,ke);return Le}function Kn(nt,ie,se,ye){let ke=ie.geometry,Ie=ie.type,Le=[];if(nt.minX=Math.min(nt.minX,ie.minX),nt.minY=Math.min(nt.minY,ie.minY),nt.maxX=Math.max(nt.maxX,ie.maxX),nt.maxY=Math.max(nt.maxY,ie.maxY),Ie==="Point"||Ie==="MultiPoint")for(let Ze=0;Ze<ke.length;Ze+=3)Le.push(ke[Ze],ke[Ze+1]),nt.numPoints++,nt.numSimplified++;else if(Ie==="LineString")Yp(Le,ke,nt,se,!1,!1);else if(Ie==="MultiLineString"||Ie==="Polygon")for(let Ze=0;Ze<ke.length;Ze++)Yp(Le,ke[Ze],nt,se,Ie==="Polygon",Ze===0);else if(Ie==="MultiPolygon")for(let Ze=0;Ze<ke.length;Ze++){let Ve=ke[Ze];for(let Je=0;Je<Ve.length;Je++)Yp(Le,Ve[Je],nt,se,!0,Je===0)}if(Le.length){let Ze=ie.tags||null;if(Ie==="LineString"&&ye.lineMetrics){Ze={};for(let Je in ie.tags)Ze[Je]=ie.tags[Je];Ze.mapbox_clip_start=ke.start/ke.size,Ze.mapbox_clip_end=ke.end/ke.size}let Ve={geometry:Le,type:Ie==="Polygon"||Ie==="MultiPolygon"?3:Ie==="LineString"||Ie==="MultiLineString"?2:1,tags:Ze};ie.id!==null&&(Ve.id=ie.id),nt.features.push(Ve)}}function Yp(nt,ie,se,ye,ke,Ie){let Le=ye*ye;if(ye>0&&ie.size<(ke?Le:ye))return void(se.numPoints+=ie.length/3);let Ze=[];for(let Ve=0;Ve<ie.length;Ve+=3)(ye===0||ie[Ve+2]>Le)&&(se.numSimplified++,Ze.push(ie[Ve],ie[Ve+1])),se.numPoints++;ke&&function(Ve,Je){let ot=0;for(let it=0,Tt=Ve.length,Ut=Tt-2;it<Tt;Ut=it,it+=2)ot+=(Ve[it]-Ve[Ut])*(Ve[it+1]+Ve[Ut+1]);if(ot>0===Je)for(let it=0,Tt=Ve.length;it<Tt/2;it+=2){let Ut=Ve[it],Zt=Ve[it+1];Ve[it]=Ve[Tt-2-it],Ve[it+1]=Ve[Tt-1-it],Ve[Tt-2-it]=Ut,Ve[Tt-1-it]=Zt}}(Ze,Ie),nt.push(Ze)}let Wu={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Va{constructor(ie,se){let ye=(se=this.options=function(Ie,Le){for(let Ze in Le)Ie[Ze]=Le[Ze];return Ie}(Object.create(Wu),se)).debug;if(ye&&console.time("preprocess data"),se.maxZoom<0||se.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(se.promoteId&&se.generateId)throw new Error("promoteId and generateId cannot be used together.");let ke=function(Ie,Le){let Ze=[];if(Ie.type==="FeatureCollection")for(let Ve=0;Ve<Ie.features.length;Ve++)Ur(Ze,Ie.features[Ve],Le,Ve);else Ur(Ze,Ie.type==="Feature"?Ie:{geometry:Ie},Le);return Ze}(ie,se);this.tiles={},this.tileCoords=[],ye&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",se.indexMaxZoom,se.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ke=function(Ie,Le){let Ze=Le.buffer/Le.extent,Ve=Ie,Je=Vo(Ie,1,-1-Ze,Ze,0,-1,2,Le),ot=Vo(Ie,1,1-Ze,2+Ze,0,-1,2,Le);return(Je||ot)&&(Ve=Vo(Ie,1,-Ze,1+Ze,0,-1,2,Le)||[],Je&&(Ve=Xd(Je,1).concat(Ve)),ot&&(Ve=Ve.concat(Xd(ot,-1)))),Ve}(ke,se),ke.length&&this.splitTile(ke,0,0,0),ye&&(ke.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ie,se,ye,ke,Ie,Le,Ze){let Ve=[ie,se,ye,ke],Je=this.options,ot=Je.debug;for(;Ve.length;){ke=Ve.pop(),ye=Ve.pop(),se=Ve.pop(),ie=Ve.pop();let it=1<<se,Tt=Qd(se,ye,ke),Ut=this.tiles[Tt];if(!Ut&&(ot>1&&console.time("creation"),Ut=this.tiles[Tt]=Er(ie,se,ye,ke,Je),this.tileCoords.push({z:se,x:ye,y:ke}),ot)){ot>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",se,ye,ke,Ut.numFeatures,Ut.numPoints,Ut.numSimplified),console.timeEnd("creation"));let zn=`z${se}`;this.stats[zn]=(this.stats[zn]||0)+1,this.total++}if(Ut.source=ie,Ie==null){if(se===Je.indexMaxZoom||Ut.numPoints<=Je.indexMaxPoints)continue}else{if(se===Je.maxZoom||se===Ie)continue;if(Ie!=null){let zn=Ie-se;if(ye!==Le>>zn||ke!==Ze>>zn)continue}}if(Ut.source=null,ie.length===0)continue;ot>1&&console.time("clipping");let Zt=.5*Je.buffer/Je.extent,Pi=.5-Zt,Hi=.5+Zt,$i=1+Zt,Yi=null,lr=null,wr=null,nn=null,On=Vo(ie,it,ye-Zt,ye+Hi,0,Ut.minX,Ut.maxX,Je),Fn=Vo(ie,it,ye+Pi,ye+$i,0,Ut.minX,Ut.maxX,Je);ie=null,On&&(Yi=Vo(On,it,ke-Zt,ke+Hi,1,Ut.minY,Ut.maxY,Je),lr=Vo(On,it,ke+Pi,ke+$i,1,Ut.minY,Ut.maxY,Je),On=null),Fn&&(wr=Vo(Fn,it,ke-Zt,ke+Hi,1,Ut.minY,Ut.maxY,Je),nn=Vo(Fn,it,ke+Pi,ke+$i,1,Ut.minY,Ut.maxY,Je),Fn=null),ot>1&&console.timeEnd("clipping"),Ve.push(Yi||[],se+1,2*ye,2*ke),Ve.push(lr||[],se+1,2*ye,2*ke+1),Ve.push(wr||[],se+1,2*ye+1,2*ke),Ve.push(nn||[],se+1,2*ye+1,2*ke+1)}}getTile(ie,se,ye){ie=+ie,se=+se,ye=+ye;let ke=this.options,{extent:Ie,debug:Le}=ke;if(ie<0||ie>24)return null;let Ze=1<<ie,Ve=Qd(ie,se=se+Ze&Ze-1,ye);if(this.tiles[Ve])return fs(this.tiles[Ve],Ie);Le>1&&console.log("drilling down to z%d-%d-%d",ie,se,ye);let Je,ot=ie,it=se,Tt=ye;for(;!Je&&ot>0;)ot--,it>>=1,Tt>>=1,Je=this.tiles[Qd(ot,it,Tt)];return Je&&Je.source?(Le>1&&(console.log("found parent tile z%d-%d-%d",ot,it,Tt),console.time("drilling down")),this.splitTile(Je.source,ot,it,Tt,ie,se,ye),Le>1&&console.timeEnd("drilling down"),this.tiles[Ve]?fs(this.tiles[Ve],Ie):null):null}}function Qd(nt,ie,se){return 32*((1<<nt)*se+ie)+nt}function Zp(nt,ie){let se=nt.tileID.canonical;if(!this._geoJSONIndex)return void ie(null,null);let ye=this._geoJSONIndex.getTile(se.z,se.x,se.y);if(!ye)return void ie(null,null);let ke=new Xe(ye.features),Ie=mn(ke);Ie.byteOffset===0&&Ie.byteLength===Ie.buffer.byteLength||(Ie=new Uint8Array(Ie)),ie(null,{vectorTile:ke,rawData:Ie.buffer})}class Yu extends X{constructor(ie,se,ye,ke,Ie,Le){super(ie,se,ye,ke,Zp,Le),Ie&&(this.loadGeoJSON=Ie),this._dynamicIndex=new Lt}loadData(ie,se){let ye=ie&&ie.request,ke=ye&&ye.collectResourceTiming;this.loadGeoJSON(ie,(Ie,Le)=>{if(Ie||!Le)return se(Ie);if(typeof Le!="object")return se(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`));{try{if(ie.filter){let Ve=r.X(ie.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ve.result==="error")throw new Error(Ve.value.map(Je=>`${Je.key}: ${Je.message}`).join(", "));Le.features=Le.features.filter(Je=>Ve.value.evaluate({zoom:0},Je))}ie.dynamic?(Le.type==="Feature"&&(Le={type:"FeatureCollection",features:[Le]}),ie.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(Le.features,this.loaded),ie.cluster&&(Le.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=ie.cluster?new li(function({superclusterOptions:Ve,clusterProperties:Je}){if(!Je||!Ve)return Ve;let ot={},it={},Tt={accumulated:null,zoom:0},Ut={properties:null},Zt=Object.keys(Je);for(let Pi of Zt){let[Hi,$i]=Je[Pi],Yi=r.X($i),lr=r.X(typeof Hi=="string"?[Hi,["accumulated"],["get",Pi]]:Hi);ot[Pi]=Yi.value,it[Pi]=lr.value}return Ve.map=Pi=>{Ut.properties=Pi;let Hi={};for(let $i of Zt)Hi[$i]=ot[$i].evaluate(Tt,Ut);return Hi},Ve.reduce=(Pi,Hi)=>{Ut.properties=Hi;for(let $i of Zt)Tt.accumulated=Pi[$i],Pi[$i]=it[$i].evaluate(Tt,Ut)},Ve}(ie)).load(Le.features):ie.dynamic?this._dynamicIndex:function(Ve,Je){return new Va(Ve,Je)}(Le,ie.geojsonVtOptions)}catch(Ve){return se(Ve)}let Ze={};if(ke){let Ve=y(ye);Ve&&(Ze.resourceTiming={},Ze.resourceTiming[ie.source]=JSON.parse(JSON.stringify(Ve)))}se(null,Ze)}})}reloadTile(ie,se){let ye=this.loaded;return ye&&ye[ie.uid]?ie.partial?se(null,void 0):super.reloadTile(ie,se):this.loadTile(ie,se)}loadGeoJSON(ie,se){if(ie.request)r.n(ie.request,se);else{if(typeof ie.data!="string")return se(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`));try{return se(null,JSON.parse(ie.data))}catch{return se(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ie,se){try{se(null,this._geoJSONIndex.getClusterExpansionZoom(ie.clusterId))}catch(ye){se(ye)}}getClusterChildren(ie,se){try{se(null,this._geoJSONIndex.getChildren(ie.clusterId))}catch(ye){se(ye)}}getClusterLeaves(ie,se){try{se(null,this._geoJSONIndex.getLeaves(ie.clusterId,ie.limit,ie.offset))}catch(ye){se(ye)}}}class $m{constructor(ie,se){this.tileID=new r.aH(ie.tileID.overscaledZ,ie.tileID.wrap,ie.tileID.canonical.z,ie.tileID.canonical.x,ie.tileID.canonical.y),this.tileZoom=ie.tileZoom,this.uid=ie.uid,this.zoom=ie.zoom,this.canonical=ie.tileID.canonical,this.pixelRatio=ie.pixelRatio,this.tileSize=ie.tileSize,this.source=ie.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ie.projection,this.brightness=se}parse(ie,se,ye,ke){this.status="parsing";let Ie=new r.aH(ye.tileID.overscaledZ,ye.tileID.wrap,ye.tileID.canonical.z,ye.tileID.canonical.x,ye.tileID.canonical.y),Le=[],Ze=se.familiesBySource[ye.source],Ve=new r.e0(Ie,ye.promoteId);return Ve.bucketLayerIDs=[],Ve.is3DTile=!0,r.ei(ie).then(Je=>{if(!Je)return ke(new Error("Could not parse tile"));let ot=r.ej(Je,1/r.cd(ye.tileID.canonical)),it=Je.json.extensionsUsed&&Je.json.extensionsUsed.includes("MAPBOX_mesh_features")||Je.json.asset.extras&&Je.json.asset.extras.MAPBOX_mesh_features,Tt=Je.json.extensionsUsed&&Je.json.extensionsUsed.includes("EXT_meshopt_compression"),Ut=new r.aa(this.zoom,{brightness:this.brightness});for(let Zt in Ze)for(let Pi of Ze[Zt]){let Hi=Pi[0];Ve.bucketLayerIDs.push(Pi.map(Yi=>r.C(Yi.id,Yi.scope))),Hi.recalculate(Ut,[]);let $i=new r.ek(Pi,ot,Ie,it,Tt,this.brightness,Ve);it||($i.needsUpload=!0),Le.push($i),$i.evaluate(Hi)}this.status="done",ke(null,{buckets:Le,featureIndex:Ve,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(Je=>ke(new Error(Je.message)))}}class Gm{constructor(ie,se,ye,ke,Ie,Le){this.actor=ie,this.layerIndex=se,this.availableImages=ye,this.brightness=Le,this.loading={},this.loaded={}}loadTile(ie,se){let ye=ie.uid,ke=this.loading[ye]=new $m(ie,this.brightness);r.bj(ie.request,(Ie,Le)=>{let Ze=!this.loading[ye];return delete this.loading[ye],Ze||Ie?(ke.status="done",Ze||(this.loaded[ye]=ke),se(Ie)):Le&&Le.byteLength!==0?void ke.parse(Le,this.layerIndex,ie,(Ve,Je)=>{ke.status="done",this.loaded=this.loaded||{},this.loaded[ye]=ke,Ve||!Je?se(Ve):se(null,Je)}):(ke.status="done",this.loaded[ye]=ke,se())})}reloadTile(ie,se){let ye=this.loaded,ke=ie.uid;if(ye&&ye[ke]){let Ie=ye[ke];Ie.projection=ie.projection,Ie.brightness=ie.brightness;let Le=(Ze,Ve)=>{Ie.reloadCallback&&(delete Ie.reloadCallback,this.loadTile(ie,se)),se(Ze,Ve)};Ie.status==="parsing"?Ie.reloadCallback=Le:Ie.status==="done"&&this.loadTile(ie,se)}}abortTile(ie,se){let ye=ie.uid;this.loading[ye]&&delete this.loading[ye],se()}removeTile(ie,se){let ye=this.loaded,ke=ie.uid;ye&&ye[ke]&&delete ye[ke],se()}}class Xp{constructor(ie){this.self=ie,this.actor=new r.el(ie,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.imageRasterizer=new r.y,this.projections={},this.defaultProjection=r.bP({name:"mercator"}),this.workerSourceTypes={vector:X,geojson:Yu,"raster-dem":ee,"raster-array":Re,"batched-model":Gm},this.workerSources={},this.self.registerWorkerSource=(se,ye)=>{if(this.workerSourceTypes[se])throw new Error(`Worker source with name "${se}" already registered.`);this.workerSourceTypes[se]=ye},this.self.registerRTLTextPlugin=se=>{if(r.em.isParsed())throw new Error("RTL text plugin already registered.");r.em.applyArabicShaping=se.applyArabicShaping,r.em.processBidirectionalText=se.processBidirectionalText,r.em.processStyledBidirectionalText=se.processStyledBidirectionalText}}clearCaches(ie,se,ye){delete this.layerIndexes[ie],delete this.availableImages[ie],delete this.workerSources[ie],ye()}checkIfReady(ie,se,ye){ye()}setReferrer(ie,se){this.referrer=se}spriteLoaded(ie,{scope:se,isLoaded:ye}){if(this.isSpriteLoaded[ie]||(this.isSpriteLoaded[ie]={}),this.isSpriteLoaded[ie][se]=ye,this.workerSources[ie]&&this.workerSources[ie][se])for(let ke in this.workerSources[ie][se]){let Ie=this.workerSources[ie][se][ke];for(let Le in Ie){let Ze=Ie[Le];Ze instanceof X&&(Ze.isSpriteLoaded=ye,Ze.fire(new r.A("isSpriteLoaded")))}}}setImages(ie,{scope:se,images:ye},ke){if(this.availableImages[ie]||(this.availableImages[ie]={}),this.availableImages[ie][se]=ye,this.workerSources[ie]&&this.workerSources[ie][se]){for(let Ie in this.workerSources[ie][se]){let Le=this.workerSources[ie][se][Ie];for(let Ze in Le)Le[Ze].availableImages=ye}ke()}else ke()}setProjection(ie,se){this.projections[ie]=r.bP(se)}setBrightness(ie,se,ye){this.brightness=se,ye()}setLayers(ie,se,ye){this.getLayerIndex(ie,se.scope).replace(se.layers,se.options),ye()}updateLayers(ie,se,ye){this.getLayerIndex(ie,se.scope).update(se.layers,se.removedIds,se.options),ye()}loadTile(ie,se,ye){se.projection=this.projections[ie]||this.defaultProjection,this.getWorkerSource(ie,se.type,se.source,se.scope).loadTile(se,ye)}decodeRasterArray(ie,se,ye){this.getWorkerSource(ie,se.type,se.source,se.scope).decodeRasterArray(se,ye)}reloadTile(ie,se,ye){se.projection=this.projections[ie]||this.defaultProjection,this.getWorkerSource(ie,se.type,se.source,se.scope).reloadTile(se,ye)}abortTile(ie,se,ye){this.getWorkerSource(ie,se.type,se.source,se.scope).abortTile(se,ye)}removeTile(ie,se,ye){this.getWorkerSource(ie,se.type,se.source,se.scope).removeTile(se,ye)}removeSource(ie,se,ye){if(!(this.workerSources[ie]&&this.workerSources[ie][se.scope]&&this.workerSources[ie][se.scope][se.type]&&this.workerSources[ie][se.scope][se.type][se.source]))return;let ke=this.workerSources[ie][se.scope][se.type][se.source];delete this.workerSources[ie][se.scope][se.type][se.source],ke.removeSource!==void 0?ke.removeSource(se,ye):ye()}loadWorkerSource(ie,se,ye){try{this.self.importScripts(se.url),ye()}catch(ke){ye(ke.toString())}}syncRTLPluginState(ie,se,ye){try{r.em.setState(se);let ke=r.em.getPluginURL();if(r.em.isLoaded()&&!r.em.isParsed()&&ke!=null){this.self.importScripts(ke);let Ie=r.em.isParsed();ye(Ie?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ke}`),Ie)}}catch(ke){ye(ke.toString())}}setDracoUrl(ie,se){this.dracoUrl=se}getAvailableImages(ie,se){this.availableImages[ie]||(this.availableImages[ie]={});let ye=this.availableImages[ie][se];return ye||(ye=[]),ye}getLayerIndex(ie,se){this.layerIndexes[ie]||(this.layerIndexes[ie]={});let ye=this.layerIndexes[ie][se];return ye||(ye=this.layerIndexes[ie][se]=new B,ye.scope=se),ye}getWorkerSource(ie,se,ye,ke){let Ie=this.workerSources;return Ie[ie]||(Ie[ie]={}),Ie[ie][ke]||(Ie[ie][ke]={}),Ie[ie][ke][se]||(Ie[ie][ke][se]={}),this.isSpriteLoaded[ie]||(this.isSpriteLoaded[ie]={}),Ie[ie][ke][se][ye]||(Ie[ie][ke][se][ye]=new this.workerSourceTypes[se]({send:(Le,Ze,Ve,Je,ot,it)=>{this.actor.send(Le,Ze,Ve,ie,ot,it)},scheduler:this.actor.scheduler},this.getLayerIndex(ie,ke),this.getAvailableImages(ie,ke),this.isSpriteLoaded[ie][ke],void 0,this.brightness)),Ie[ie][ke][se][ye]}rasterizeImages(ie,se,ye){let ke=new Map;for(let[Ie,{image:Le,imageVariant:Ze}]of se.tasks.entries()){let Ve=this.imageRasterizer.rasterize(Ze,Le,se.scope,ie);ke.set(Ie,Ve)}ye(void 0,ke)}removeRasterizedImages(ie,se,ye){this.imageRasterizer.removeImagesFromCacheByIds(se.imageIds,se.scope,ie),ye()}enforceCacheSizeLimit(ie,se){r.en(se)}getWorkerPerformanceMetrics(ie,se,ye){ye(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Xp(self)),Xp}),n(["./shared"],function(r){var y="3.11.0";let A={create:"create",load:"load",fullLoad:"fullLoad"},P={mark(m){performance.mark(m)},measure(m,a,c){performance.measure(m,a,c)}};function B(m){let a=m.name.split("?")[0];return r.a(a)&&a.includes("mapbox-gl.js")?"javascript":r.a(a)&&a.includes("mapbox-gl.css")?"css":r.b(a)?"fontRange":r.c(a)?"sprite":r.i(a)?"style":r.d(a)?"tilejson":"other"}var U,J={},le=function(){if(U)return J;function m(f){return!a(f)}function a(f){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var b,w,I=new Blob([""],{type:"text/javascript"}),k=URL.createObjectURL(I);try{w=new Worker(k),b=!0}catch{b=!1}return w&&w.terminate(),URL.revokeObjectURL(k),b}()?function(){var b=document.createElement("canvas");b.width=b.height=1;var w=b.getContext("2d");if(!w)return!1;var I=w.getImageData(0,0,1,1);return I&&I.width===b.width}()?(c[_=f&&f.failIfMajorPerformanceCaveat]===void 0&&(c[_]=function(b){var w,I=function(k){var O=document.createElement("canvas"),F=Object.create(m.webGLContextAttributes);return F.failIfMajorPerformanceCaveat=k,O.getContext("webgl2",F)}(b);if(!I)return!1;try{w=I.createShader(I.VERTEX_SHADER)}catch{return!1}return!(!w||I.isContextLost())&&(I.shaderSource(w,"void main() {}"),I.compileShader(w),I.getShaderParameter(w,I.COMPILE_STATUS)===!0)}(_)),c[_]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var _}U=1,J.supported=m,J.notSupportedReason=a;var c={};return m.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},J}();function re(m,a,c){let f=document.createElement(m);return a!=null&&(f.className=a),c&&c.appendChild(f),f}function X(m,a,c){let f=document.createElementNS("http://www.w3.org/2000/svg",m);for(let _ of Object.keys(a))f.setAttributeNS(null,_,String(a[_]));return c&&c.appendChild(f),f}let ee=typeof document<"u"?document.documentElement&&document.documentElement.style:null,we=ee&&ee.userSelect!==void 0?"userSelect":"WebkitUserSelect",Re;function Ce(){ee&&we&&(Re=ee[we],ee[we]="none")}function Te(){ee&&we&&(ee[we]=Re)}function Xe(m){m.preventDefault(),m.stopPropagation(),window.removeEventListener("click",Xe,!0)}function et(){window.addEventListener("click",Xe,!0),window.setTimeout(()=>{window.removeEventListener("click",Xe,!0)},0)}function Pt(m,a){let c=m.getBoundingClientRect();return Ye(m,c,a)}function Lt(m,a){let c=m.getBoundingClientRect(),f=[];for(let _=0;_<a.length;_++)f.push(Ye(m,c,a[_]));return f}function lt(m){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&m.button===2&&m.ctrlKey?0:m.button}function Ye(m,a,c){let f=m.offsetWidth===a.width?1:m.offsetWidth/a.width;return new r.P((c.clientX-a.left)*f,(c.clientY-a.top)*f)}let xt="01",Bt="NO_ACCESS_TOKEN";class Ft{constructor(a,c,f){this._transformRequestFn=a,this._customAccessToken=c,this._silenceAuthErrors=!!f,this._createSkuToken()}_createSkuToken(){let a=function(){let c="";for(let f=0;f<10;f++)c+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",xt,c].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(a,c){return this._transformRequestFn&&this._transformRequestFn(a,c)||{url:a}}normalizeStyleURL(a,c){if(!r.f(a))return a;let f=Ot(a);return f.params.push(`sdk=js-${y}`),f.path=`/styles/v1${f.path}`,this._makeAPIURL(f,this._customAccessToken||c)}normalizeGlyphsURL(a,c){if(!r.f(a))return a;let f=Ot(a);return f.path=`/fonts/v1${f.path}`,this._makeAPIURL(f,this._customAccessToken||c)}normalizeModelURL(a,c){if(!r.f(a))return a;let f=Ot(a);return f.path=`/models/v1${f.path}`,this._makeAPIURL(f,this._customAccessToken||c)}normalizeSourceURL(a,c,f,_){if(!r.f(a))return a;let b=Ot(a);return b.path=`/v4/${b.authority}.json`,b.params.push("secure"),f&&b.params.push(`language=${f}`),_&&b.params.push(`worldview=${_}`),this._makeAPIURL(b,this._customAccessToken||c)}normalizeIconsetURL(a,c){let f=Ot(a);return r.f(a)?(f.path=`/styles/v1${f.path}/iconset.pbf`,this._makeAPIURL(f,this._customAccessToken||c)):Kt(f)}normalizeSpriteURL(a,c,f,_){let b=Ot(a);return r.f(a)?(b.path=`/styles/v1${b.path}/sprite${c}${f}`,this._makeAPIURL(b,this._customAccessToken||_)):(b.path+=`${c}${f}`,Kt(b))}normalizeTileURL(a,c,f){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!r.f(a))return a;let _=Ot(a);_.path=_.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${c||f&&_.authority!=="raster"&&f===512?"@2x":""}${r.m.supported?".webp":"$1"}`),_.authority==="raster"?_.path=`/${r.e.RASTER_URL_PREFIX}${_.path}`:_.authority==="rasterarrays"?_.path=`/${r.e.RASTERARRAYS_URL_PREFIX}${_.path}`:_.authority==="3dtiles"?_.path=`/${r.e.TILES3D_URL_PREFIX}${_.path}`:(_.path=_.path.replace(/^.+\/v4\//,"/"),_.path=`/${r.e.TILE_URL_VERSION}${_.path}`);let b=this._customAccessToken||function(w){for(let I of w){let k=I.match(/^access_token=(.*)$/);if(k)return k[1]}return null}(_.params)||r.e.ACCESS_TOKEN;return r.e.REQUIRE_ACCESS_TOKEN&&b&&this._skuToken&&_.params.push(`sku=${this._skuToken}`),this._makeAPIURL(_,b)}canonicalizeTileURL(a,c){let f=Ot(a);if(!f.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!f.path.match(/\.[\w]+$/))return a;let _="mapbox://";f.path.match(/^\/raster\/v1\//)?_+=`raster/${f.path.replace(`/${r.e.RASTER_URL_PREFIX}/`,"")}`:f.path.match(/^\/rasterarrays\/v1\//)?_+=`rasterarrays/${f.path.replace(`/${r.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:_+=`tiles/${f.path.replace(`/${r.e.TILE_URL_VERSION}/`,"")}`;let b=f.params;return c&&(b=b.filter(w=>!w.match(/^access_token=/))),b.length&&(_+=`?${b.join("&")}`),_}canonicalizeTileset(a,c){let f=!!c&&r.f(c),_=[];for(let b of a.tiles||[])r.h(b)?_.push(this.canonicalizeTileURL(b,f)):_.push(b);return _}_makeAPIURL(a,c){let f="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",_=Ot(r.e.API_URL);if(a.protocol=_.protocol,a.authority=_.authority,a.protocol==="http"){let b=a.params.indexOf("secure");b>=0&&a.params.splice(b,1)}if(_.path!=="/"&&(a.path=`${_.path}${a.path}`),!r.e.REQUIRE_ACCESS_TOKEN)return Kt(a);if(c=c||r.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!c)throw new Error(`An API access token is required to use Mapbox GL. ${f}`);if(c[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${f}`)}return a.params=a.params.filter(b=>b.indexOf("access_token")===-1),a.params.push(`access_token=${c||""}`),Kt(a)}}let dt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ot(m){let a=m.match(dt);if(!a)throw new Error("Unable to parse URL object");return{protocol:a[1],authority:a[2],path:a[3]||"/",params:a[4]?a[4].split("&"):[]}}function Kt(m){let a=m.params.length?`?${m.params.join("&")}`:"";return`${m.protocol}://${m.authority}${m.path}${a}`}let oi="mapbox.eventData";function tt(m){if(!m)return null;let a=m.split(".");if(!a||a.length!==3)return null;try{return JSON.parse(r.j(a[1]))}catch{return null}}class vt{constructor(a){this.type=a,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(a){let c=tt(r.e.ACCESS_TOKEN),f="";return f=c&&c.u?r.k(c.u):r.e.ACCESS_TOKEN||"",a?`${oi}.${a}:${f}`:`${oi}:${f}`}fetchEventData(){let a=r.s("localStorage"),c=this.getStorageKey(),f=this.getStorageKey("uuid");if(a)try{let _=localStorage.getItem(c);_&&(this.eventData=JSON.parse(_));let b=localStorage.getItem(f);b&&(this.anonId=b)}catch{r.w("Unable to read from LocalStorage")}}saveEventData(){let a=r.s("localStorage"),c=this.getStorageKey(),f=this.getStorageKey("uuid"),_=this.anonId;if(a&&_)try{localStorage.setItem(f,_),Object.keys(this.eventData).length>=1&&localStorage.setItem(c,JSON.stringify(this.eventData))}catch{r.w("Unable to write to LocalStorage")}}processRequests(a){}postEvent(a,c,f,_){if(!r.e.EVENTS_URL)return;let b=Ot(r.e.EVENTS_URL);b.params.push(`access_token=${_||r.e.ACCESS_TOKEN||""}`);let w={event:this.type,created:new Date(a).toISOString()},I=c?r.l(w,c):w,k={url:Kt(b),headers:{"Content-Type":"text/plain"},body:JSON.stringify([I])};this.pendingRequest=r.p(k,O=>{this.pendingRequest=null,f(O),this.saveEventData(),this.processRequests(_)})}queueRequest(a,c){this.queue.push(a),this.processRequests(c)}}let pi=new class extends vt{constructor(m){super("appUserTurnstile"),this._customAccessToken=m}postTurnstileEvent(m,a){r.e.EVENTS_URL&&r.e.ACCESS_TOKEN&&Array.isArray(m)&&m.some(c=>r.f(c)||r.h(c))&&this.queueRequest(Date.now(),a)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();let a=tt(r.e.ACCESS_TOKEN),c=a?a.u:r.e.ACCESS_TOKEN,f=c!==this.eventData.tokenU;r.v(this.anonId)||(this.anonId=r.u(),f=!0);let _=this.queue.shift();if(this.eventData.lastSuccess){let b=new Date(this.eventData.lastSuccess),w=new Date(_),I=(_-this.eventData.lastSuccess)/864e5;f=f||I>=1||I<-1||b.getDate()!==w.getDate()}else f=!0;f?this.postEvent(_,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:xt,"enabled.telemetry":!1,userId:this.anonId},b=>{b||(this.eventData.lastSuccess=_,this.eventData.tokenU=c)},m):this.processRequests()}},mn=pi.postTurnstileEvent.bind(pi),_i=new class extends vt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(m,a,c,f){this.skuToken=a,this.errorCb=f,r.e.EVENTS_URL&&(c||r.e.ACCESS_TOKEN?this.queueRequest({id:m,timestamp:Date.now()},c):this.errorCb(new Error(Bt)))}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;let{id:a,timestamp:c}=this.queue.shift();a&&this.success[a]||(this.anonId||this.fetchEventData(),r.v(this.anonId)||(this.anonId=r.u()),this.postEvent(c,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:xt,skuToken:this.skuToken,userId:this.anonId},f=>{f?this.errorCb(f):a&&(this.success[a]=!0)},m))}remove(){this.errorCb=null}},ro=_i.postMapLoadEvent.bind(_i),pa=new class extends vt{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(m){let a=this.mapInstanceIdMap.get(m);return a||(a=r.u(),this.mapInstanceIdMap.set(m,a)),a}getEventId(m){let a=this.eventIdPerMapInstanceMap.get(m)||0;return this.eventIdPerMapInstanceMap.set(m,a+1),a}postStyleLoadEvent(m,a){let{map:c,style:f,importedStyles:_}=a;if(!r.e.EVENTS_URL||!m&&!r.e.ACCESS_TOKEN)return;let b=this.getMapInstanceId(c),w={mapInstanceId:b,eventId:this.getEventId(b),style:f};_.length&&(w.importedStyles=_),this.queueRequest({timestamp:Date.now(),payload:w},m)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;let{timestamp:a,payload:c}=this.queue.shift();this.postEvent(a,c,()=>{},m)}},Ko=pa.postStyleLoadEvent.bind(pa),Qt=new class extends vt{constructor(){super("gljs.performance")}postPerformanceEvent(m,a){r.e.EVENTS_URL&&(m||r.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:a},m)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;let{timestamp:a,performanceData:c}=this.queue.shift(),f=function(_){let b=performance.getEntriesByType("resource"),w=performance.getEntriesByType("mark"),I=function(G){let K={};if(G){for(let W in G)if(W!=="other")for(let te of G[W]){let ne=`${W}ResolveRangeMin`,he=`${W}ResolveRangeMax`,_e=`${W}RequestCount`,me=`${W}RequestCachedCount`;K[ne]=Math.min(K[ne]||1/0,te.startTime),K[he]=Math.max(K[he]||-1/0,te.responseEnd);let Se=ve=>{K[ve]===void 0&&(K[ve]=0),++K[ve]};te.transferSize!==void 0&&te.transferSize===0&&Se(me),Se(_e)}}return K}(function(G,K){let W={};if(G)for(let te of G){let ne=K(te);W[ne]===void 0&&(W[ne]=[]),W[ne].push(te)}return W}(b,B)),k=window.devicePixelRatio,O=navigator.connection||navigator.mozConnection||navigator.webkitConnection,F=O?O.effectiveType:void 0,z={counters:[],metadata:[],attributes:[]},V=(G,K,W)=>{W!=null&&G.push({name:K,value:W.toString()})};for(let G in I)V(z.counters,G,I[G]);if(_.interactionRange[0]!==1/0&&_.interactionRange[1]!==-1/0&&(V(z.counters,"interactionRangeMin",_.interactionRange[0]),V(z.counters,"interactionRangeMax",_.interactionRange[1])),w)for(let G of Object.keys(A)){let K=A[G],W=w.find(te=>te.name===K);W&&V(z.counters,K,W.startTime)}return V(z.counters,"visibilityHidden",_.visibilityHidden),V(z.attributes,"style",function(G){if(G)for(let K of G){let W=K.name.split("?")[0];if(r.i(W)){let te=W.split("/").slice(-2);if(te.length===2)return`mapbox://styles/${te[0]}/${te[1]}`}}}(b)),V(z.attributes,"terrainEnabled",_.terrainEnabled?"true":"false"),V(z.attributes,"fogEnabled",_.fogEnabled?"true":"false"),V(z.attributes,"projection",_.projection),V(z.attributes,"zoom",_.zoom),V(z.metadata,"devicePixelRatio",k),V(z.metadata,"connectionEffectiveType",F),V(z.metadata,"navigatorUserAgent",navigator.userAgent),V(z.metadata,"screenWidth",window.screen.width),V(z.metadata,"screenHeight",window.screen.height),V(z.metadata,"windowWidth",window.innerWidth),V(z.metadata,"windowHeight",window.innerHeight),V(z.metadata,"mapWidth",_.width/k),V(z.metadata,"mapHeight",_.height/k),V(z.metadata,"webglRenderer",_.renderer),V(z.metadata,"webglVendor",_.vendor),V(z.metadata,"sdkVersion",y),V(z.metadata,"sdkIdentifier","mapbox-gl-js"),z}(c);for(let _ of f.metadata);for(let _ of f.counters);for(let _ of f.attributes);this.postEvent(a,f,()=>{},m)}},Xt=Qt.postPerformanceEvent.bind(Qt),li=new class extends vt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(m,a,c,f){if(!r.e.API_URL||!r.e.SESSION_PATH)return;let _=Ot(r.e.API_URL+r.e.SESSION_PATH);_.params.push(`sku=${a||""}`),_.params.push(`access_token=${f||r.e.ACCESS_TOKEN||""}`);let b={url:Kt(_),headers:{"Content-Type":"text/plain"}};this.pendingRequest=r.g(b,w=>{this.pendingRequest=null,c(w),this.saveEventData(),this.processRequests(f)})}getSessionAPI(m,a,c,f){this.skuToken=a,this.errorCb=f,r.e.SESSION_PATH&&r.e.API_URL&&(c||r.e.ACCESS_TOKEN?this.queueRequest({id:m,timestamp:Date.now()},c):this.errorCb(new Error(Bt)))}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;let{id:a,timestamp:c}=this.queue.shift();a&&this.success[a]||this.getSession(c,this.skuToken,f=>{f?this.errorCb(f):a&&(this.success[a]=!0)},m)}remove(){this.errorCb=null}},ce=li.getSessionAPI.bind(li),Xr=new Set;function fa(m,a){a?Xr.add(m):Xr.delete(m)}class ma{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(a,c){this._updatedSourceCaches[a]=c,this.setDirty()}discardSourceCacheUpdate(a){delete this._updatedSourceCaches[a]}updateLayer(a){let c=a.scope;this._updatedLayers[c]=this._updatedLayers[c]||new Set,this._updatedLayers[c].add(a.id),this.setDirty()}removeLayer(a){let c=a.scope;this._removedLayers[c]=this._removedLayers[c]||{},this._updatedLayers[c]=this._updatedLayers[c]||new Set,this._removedLayers[c][a.id]=a,this._updatedLayers[c].delete(a.id),this._updatedPaintProps.delete(a.fqid),this.setDirty()}getRemovedLayer(a){return this._removedLayers[a.scope]?this._removedLayers[a.scope][a.id]:null}discardLayerRemoval(a){this._removedLayers[a.scope]&&delete this._removedLayers[a.scope][a.id]}getLayerUpdatesByScope(){let a={};for(let c in this._updatedLayers)a[c]=a[c]||{},a[c].updatedIds=Array.from(this._updatedLayers[c].values());for(let c in this._removedLayers)a[c]=a[c]||{},a[c].removedIds=Object.keys(this._removedLayers[c]);return a}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(a){this._updatedPaintProps.add(a.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(a){this._updatedImages.add(r.I.toString(a)),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function At(m){let{userImage:a}=m;return!!(a&&a.render&&a.render())&&(m.data.replace(new Uint8Array(a.data.buffer)),!0)}class To extends r.E{constructor(a){super(),this._images={},this._iconsets={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.patternsInFlight=new Set,this.atlasImage={},this.atlasTexture={},this.dirty=!0,this.spriteFormat=a,a!=="raster"&&r.t()&&(this.imageRasterizerDispatcher=new r.D(r.x(),this,"Image Rasterizer Worker",1))}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new r.y),this._imageRasterizer}createScope(a){this._images[a]={},this._iconsets[a]={},this.loaded[a]=!1,this.updatedImages[a]=new Set,this.patterns[a]={},this.callbackDispatchedThisFrame[a]=new Set,this.atlasImage[a]=new r.r({width:1,height:1})}createIconset(a,c){this._iconsets[a][c]={}}isLoaded(){for(let a in this.loaded)if(!this.loaded[a])return!1;return!0}setLoaded(a,c){if(this.loaded[c]!==a&&(this.loaded[c]=a,a)){for(let{ids:f,callback:_}of this.requestors)this._notify(f,c,_);this.requestors=[]}}hasImage(a,c){return!!this.getImage(a,c)}getImage(a,c){return(a.iconsetId?this._iconsets[c][a.iconsetId]:this._images[c])[a.name]}addImage(a,c,f){let _=a.iconsetId?this._iconsets[c][a.iconsetId]:this._images[c];this._validate(a,f)&&(_[a.name]=f)}_validate(a,c){let f=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new r.z(new Error(`Image "${a.name}" has invalid "stretchX" value`))),f=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new r.z(new Error(`Image "${a.name}" has invalid "stretchY" value`))),f=!1),this._validateContent(c.content,c)||(this.fire(new r.z(new Error(`Image "${a.name}" has invalid "content" value`))),f=!1),f}_validateStretch(a,c){if(!a)return!0;let f=0;for(let _ of a){if(_[0]<f||_[1]<_[0]||c<_[1])return!1;f=_[1]}return!0}_validateContent(a,c){return a?a.length!==4||!c.usvg&&(a[0]<0||c.data.width<a[0]||a[1]<0||c.data.height<a[1]||a[2]<0||c.data.width<a[2]||a[3]<0||c.data.height<a[3])?!1:!(a[2]<a[0]||a[3]<a[1]):!0}updateImage(a,c,f){let _=a.iconsetId?this._iconsets[c][a.iconsetId]:this._images[c];f.version=_[a.name].version+1,_[a.name]=f,this.updatedImages[c].add(a),this.removeFromImageRasterizerCache(a,c)}clearUpdatedImages(a){this.updatedImages[a].clear()}removeFromImageRasterizerCache(a,c){if(this.spriteFormat!=="raster")if(r.t()){let f={imageIds:[a],scope:c};this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",f)}else this.imageRasterizer.removeImagesFromCacheByIds([a],c)}removeImage(a,c){let f=a.iconsetId?this._iconsets[c][a.iconsetId]:this._images[c],_=f[a.name];delete f[a.name],delete this.patterns[c][a.name],this.removeFromImageRasterizerCache(a,c),_.userImage&&_.userImage.onRemove&&_.userImage.onRemove()}listImages(a){let c=[];for(let f of Object.keys(this._images[a]))c.push(new r.I(f));for(let f in this._iconsets[a])for(let _ of Object.keys(this._iconsets[a][f]))c.push(new r.I({name:_,iconsetId:f}));return c}getImages(a,c,f){let _=!0,b=!!this.loaded[c];if(!b)for(let w of a)(w.iconsetId?this._iconsets[c][w.iconsetId]:this._images[c])[w.name]||(_=!1);b||_?this._notify(a,c,f):this.requestors.push({ids:a,scope:c,callback:f})}rasterizeImages({scope:a,tasks:c},f){let _=new Map;for(let[b,w]of c.entries()){let I=this.getImage(w.id,a);I&&_.set(b,{image:I,imageVariant:w})}this._rasterizeImages(a,_,f)}_rasterizeImages(a,c,f){if(r.t())this.imageRasterizerDispatcher.getActor().send("rasterizeImages",{tasks:c,scope:a},f);else{let _=new Map;for(let[b,{image:w,imageVariant:I}]of c.entries())_.set(b,this.imageRasterizer.rasterize(I,w,a,0));f(void 0,_)}}getUpdatedImages(a){return this.updatedImages[a]||new Set}_notify(a,c,f){let _=new Map;for(let b of a){b.iconsetId&&(this._iconsets[c][b.iconsetId]=this._iconsets[c][b.iconsetId]||{});let w=(b.iconsetId?this._iconsets[c][b.iconsetId]:this._images[c])[b.name];if(!w){if(b.iconsetId)continue;r.w(`Image "${b.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`),this.fire(new r.A("styleimagemissing",{id:b.name}));continue}let I={data:w.usvg?null:w.data.clone(),pixelRatio:w.pixelRatio,sdf:w.sdf,usvg:w.usvg,version:w.version,stretchX:w.stretchX,stretchY:w.stretchY,content:w.content,hasRenderCallback:!!(w.userImage&&w.userImage.render)};w.usvg&&Object.assign(I,{width:w.icon.usvg_tree.width,height:w.icon.usvg_tree.height}),_.set(r.I.toString(b),I)}f(null,_)}getPixelSize(a){let{width:c,height:f}=this.atlasImage[a];return{width:c,height:f}}getPattern(a,c,f){let _=this.patterns[c][a.name],b=this.getImage(a,c);if(!b)return null;if(_){if(_.position.version===b.version)return _.position;_.position.version=b.version}else{if(b.usvg&&!b.data){let w=this.getPatternInFlightId(a.toString(),c);if(this.patternsInFlight.has(w))return null;this.patternsInFlight.add(w);let I=new r.B(a).scaleSelf(r.q.devicePixelRatio),k=new Map([[I.toString(),{image:b,imageVariant:I}]]);return this._rasterizeImages(c,k,(O,F)=>this.storePatternImage(I,c,b,f,F)),null}this.storePattern(a,c,b)}return this._updatePatternAtlas(c,f),this.patterns[c][a.name].position}getPatternInFlightId(a,c){return r.C(a,c)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(a,c,f,_,b){let w=a.toString(),I=b?b.get(w):void 0;I&&(f.data=I,this.storePattern(a.id,c,f),this._updatePatternAtlas(c,_),this.patternsInFlight.delete(this.getPatternInFlightId(a.id.toString(),c)))}storePattern(a,c,f){let _={w:f.data.width+2*r.F,h:f.data.height+2*r.F,x:0,y:0},b=new r.G(_,f,r.F);this.patterns[c][a.name]={bin:_,position:b}}bind(a,c){let f=a.gl,_=this.atlasTexture[c];_?this.dirty&&(_.update(this.atlasImage[c]),this.dirty=!1):(_=new r.T(a,this.atlasImage[c],f.RGBA8),this.atlasTexture[c]=_),_.bind(f.LINEAR,f.CLAMP_TO_EDGE)}_updatePatternAtlas(a,c){let f=[];for(let I in this.patterns[a])f.push(this.patterns[a][I].bin);let{w:_,h:b}=r.H(f),w=this.atlasImage[a];w.resize({width:_||1,height:b||1});for(let I in this.patterns[a]){let{bin:k,position:O}=this.patterns[a][I],F=O.padding,z=k.x+F,V=k.y+F,G=this._images[a][I].data,K=G.width,W=G.height;F=F>1?F-1:F,r.r.copy(G,w,{x:0,y:0},{x:z,y:V},{width:K,height:W},c),r.r.copy(G,w,{x:0,y:W-F},{x:z,y:V-F},{width:K,height:F},c),r.r.copy(G,w,{x:0,y:0},{x:z,y:V+W},{width:K,height:F},c),r.r.copy(G,w,{x:K-F,y:0},{x:z-F,y:V},{width:F,height:W},c),r.r.copy(G,w,{x:0,y:0},{x:z+K,y:V},{width:F,height:W},c),r.r.copy(G,w,{x:K-F,y:W-F},{x:z-F,y:V-F},{width:F,height:F},c),r.r.copy(G,w,{x:0,y:W-F},{x:z+K,y:V-F},{width:F,height:F},c),r.r.copy(G,w,{x:0,y:0},{x:z+K,y:V+W},{width:F,height:F},c),r.r.copy(G,w,{x:K-F,y:0},{x:z-F,y:V+W},{width:F,height:F},c)}this.dirty=!0}beginFrame(){for(let a in this._images)this.callbackDispatchedThisFrame[a]=new Set}dispatchRenderCallbacks(a,c){for(let f of a){if(this.callbackDispatchedThisFrame[c].has(f.toString()))continue;this.callbackDispatchedThisFrame[c].add(f.toString());let _=(f.iconsetId?this._iconsets[c][f.iconsetId]:this._images[c])[f.name];At(_)&&this.updateImage(f,c,_)}}}function mr(m){let a=m.key,c=m.value,f=m.valueSpec||{},_=m.objectElementValidators||{},b=m.style,w=m.styleSpec,I=[],k=r.K(c);if(k!=="object")return[new r.V(a,c,`object expected, ${k} found`)];for(let O in c){let F=O.split(".")[0],z;_[F]?z=_[F]:f[F]?z=Kn:_["*"]?z=_["*"]:f["*"]&&(z=Kn),z?I=I.concat(z({key:(a&&`${a}.`)+O,value:c[O],valueSpec:f[F]||f["*"],style:b,styleSpec:w,object:c,objectKey:O},c)):I.push(new r.J(a,c[O],`unknown property "${O}"`))}for(let O in f)_[O]||f[O].required&&f[O].default===void 0&&c[O]===void 0&&I.push(new r.V(a,c,`missing required property "${O}"`));return I}function ho(m){let a=m.value,c=m.valueSpec,f=m.style,_=m.styleSpec,b=m.key,w=m.arrayElementValidator||Kn;if(r.K(a)!=="array")return[new r.V(b,a,`array expected, ${r.K(a)} found`)];if(c.length&&a.length!==c.length)return[new r.V(b,a,`array length ${c.length} expected, length ${a.length} found`)];if(c["min-length"]&&a.length<c["min-length"])return[new r.V(b,a,`array length at least ${c["min-length"]} expected, length ${a.length} found`)];let I={type:c.value,values:c.values,minimum:c.minimum,maximum:c.maximum,function:void 0};_.$version<7&&(I.function=c.function),r.K(c.value)==="object"&&(I=c.value);let k=[];for(let O=0;O<a.length;O++)k=k.concat(w({array:a,arrayIndex:O,value:a[O],valueSpec:I,style:f,styleSpec:_,key:`${b}[${O}]`},!0));return k}function Qi(m){let a=m.key,c=m.value,f=m.valueSpec,_=r.K(c);if(_==="number"&&c!=c&&(_="NaN"),_!=="number")return[new r.V(a,c,`number expected, ${_} found`)];if("minimum"in f){let b=f.minimum;if(r.K(f.minimum)==="array"&&(b=f.minimum[m.arrayIndex]),c<b)return[new r.V(a,c,`${c} is less than the minimum value ${b}`)]}if("maximum"in f){let b=f.maximum;if(r.K(f.maximum)==="array"&&(b=f.maximum[m.arrayIndex]),c>b)return[new r.V(a,c,`${c} is greater than the maximum value ${b}`)]}return[]}function Ur(m){let a=m.valueSpec,c=r.M(m.value.type),f,_,b,w={},I=c!=="categorical"&&m.value.property===void 0,k=!I,O=r.K(m.value.stops)==="array"&&r.K(m.value.stops[0])==="array"&&r.K(m.value.stops[0][0])==="object",F=mr({key:m.key,value:m.value,valueSpec:m.styleSpec.function,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{stops:function(G){if(c==="identity")return[new r.V(G.key,G.value,'identity function may not have a "stops" property')];let K=[],W=G.value;return K=K.concat(ho({key:G.key,value:W,valueSpec:G.valueSpec,style:G.style,styleSpec:G.styleSpec,arrayElementValidator:z})),r.K(W)==="array"&&W.length===0&&K.push(new r.V(G.key,W,"array must have at least one stop")),K},default:function(G){return Kn({key:G.key,value:G.value,valueSpec:a,style:G.style,styleSpec:G.styleSpec})}}});return c==="identity"&&I&&F.push(new r.V(m.key,m.value,'missing required property "property"')),c==="identity"||m.value.stops||F.push(new r.V(m.key,m.value,'missing required property "stops"')),c==="exponential"&&m.valueSpec.expression&&!r.N(m.valueSpec)&&F.push(new r.V(m.key,m.value,"exponential functions not supported")),m.styleSpec.$version>=8&&(k&&!r.O(m.valueSpec)?F.push(new r.V(m.key,m.value,"property functions not supported")):I&&!r.Q(m.valueSpec)&&F.push(new r.V(m.key,m.value,"zoom functions not supported"))),c!=="categorical"&&!O||m.value.property!==void 0||F.push(new r.V(m.key,m.value,'"property" property is required')),F;function z(G){let K=[],W=G.value,te=G.key;if(r.K(W)!=="array")return[new r.V(te,W,`array expected, ${r.K(W)} found`)];if(W.length!==2)return[new r.V(te,W,`array length 2 expected, length ${W.length} found`)];if(O){if(r.K(W[0])!=="object")return[new r.V(te,W,`object expected, ${r.K(W[0])} found`)];if(W[0].zoom===void 0)return[new r.V(te,W,"object stop key must have zoom")];if(W[0].value===void 0)return[new r.V(te,W,"object stop key must have value")];let ne=r.M(W[0].zoom);if(typeof ne!="number")return[new r.V(te,W[0].zoom,"stop zoom values must be numbers")];if(b&&b>ne)return[new r.V(te,W[0].zoom,"stop zoom values must appear in ascending order")];ne!==b&&(b=ne,_=void 0,w={}),K=K.concat(mr({key:`${te}[0]`,value:W[0],valueSpec:{zoom:{}},style:G.style,styleSpec:G.styleSpec,objectElementValidators:{zoom:Qi,value:V}}))}else K=K.concat(V({key:`${te}[0]`,value:W[0],valueSpec:{},style:G.style,styleSpec:G.styleSpec},W));return r.S(r.U(W[1]))?K.concat([new r.V(`${te}[1]`,W[1],"expressions are not allowed in function stops.")]):K.concat(Kn({key:`${te}[1]`,value:W[1],valueSpec:a,style:G.style,styleSpec:G.styleSpec}))}function V(G,K){let W=r.K(G.value),te=r.M(G.value),ne=G.value!==null?G.value:K;if(f){if(W!==f)return[new r.V(G.key,ne,`${W} stop domain type must match previous stop domain type ${f}`)]}else f=W;if(W!=="number"&&W!=="string"&&W!=="boolean"&&typeof te!="number"&&typeof te!="string"&&typeof te!="boolean")return[new r.V(G.key,ne,"stop domain value must be a number, string, or boolean")];if(W!=="number"&&c!=="categorical"){let he=`number expected, ${W} found`;return r.O(a)&&c===void 0&&(he+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new r.V(G.key,ne,he)]}return c!=="categorical"||W!=="number"||typeof te=="number"&&isFinite(te)&&Math.floor(te)===te?c!=="categorical"&&W==="number"&&typeof te=="number"&&typeof _=="number"&&_!==void 0&&te<_?[new r.V(G.key,ne,"stop domain values must appear in ascending order")]:(_=te,c==="categorical"&&te in w?[new r.V(G.key,ne,"stop domain values must be unique")]:(w[te]=!0,[])):[new r.V(G.key,ne,`integer expected, found ${String(te)}`)]}}function ga(m){let a=(m.expressionContext==="property"?r.W:r.X)(r.U(m.value),m.valueSpec);if(a.result==="error")return a.value.map(f=>new r.V(`${m.key}${f.key}`,m.value,f.message));let c=a.value.expression||a.value._styleExpression.expression;if(m.expressionContext==="property"&&m.propertyKey==="text-font"&&!c.outputDefined())return[new r.V(m.key,m.value,`Invalid data expression for "${m.propertyKey}". Output values must be contained as literals within the expression.`)];if(m.expressionContext==="property"&&m.propertyType==="layout"&&!r.Y(c))return[new r.V(m.key,m.value,'"feature-state" data expressions are not supported with layout properties.')];if(m.expressionContext==="filter")return Ya(c,m);if(m.expressionContext&&m.expressionContext.indexOf("cluster")===0){if(!r.Z(c,["zoom","feature-state"]))return[new r.V(m.key,m.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(m.expressionContext==="cluster-initial"&&!r._(c))return[new r.V(m.key,m.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ya(m,a){let c=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(a.valueSpec&&a.valueSpec.expression)for(let _ of a.valueSpec.expression.parameters)c.delete(_);if(c.size===0)return[];let f=[];return m instanceof r.$&&c.has(m.name)?[new r.V(a.key,a.value,`["${m.name}"] expression is not supported in a filter for a ${a.object.type} layer with id: ${a.object.id}`)]:(m.eachChild(_=>{f.push(...Ya(_,a))}),f)}function Za(m){let a=m.key,c=m.value,f=m.valueSpec,_=[];return Array.isArray(f.values)?f.values.indexOf(r.M(c))===-1&&_.push(new r.V(a,c,`expected one of [${f.values.join(", ")}], ${JSON.stringify(c)} found`)):Object.keys(f.values).indexOf(r.M(c))===-1&&_.push(new r.V(a,c,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(c)} found`)),_}function ll(m){return r.a1(r.U(m.value))?ga(r.L({},m,{expressionContext:"filter",valueSpec:m.styleSpec[`filter_${m.layerType||"fill"}`]})):qi(m)}function qi(m){let a=m.value,c=m.key;if(r.K(a)!=="array")return[new r.V(c,a,`array expected, ${r.K(a)} found`)];let f=m.styleSpec,_,b=[];if(a.length<1)return[new r.V(c,a,"filter array must have at least 1 element")];switch(b=b.concat(Za({key:`${c}[0]`,value:a[0],valueSpec:f.filter_operator,style:m.style,styleSpec:m.styleSpec})),r.M(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&r.M(a[1])==="$type"&&b.push(new r.V(c,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&b.push(new r.V(c,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(_=r.K(a[1]),_!=="string"&&b.push(new r.V(`${c}[1]`,a[1],`string expected, ${_} found`)));for(let w=2;w<a.length;w++)_=r.K(a[w]),r.M(a[1])==="$type"?b=b.concat(Za({key:`${c}[${w}]`,value:a[w],valueSpec:f.geometry_type,style:m.style,styleSpec:m.styleSpec})):_!=="string"&&_!=="number"&&_!=="boolean"&&b.push(new r.V(`${c}[${w}]`,a[w],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let w=1;w<a.length;w++)b=b.concat(qi({key:`${c}[${w}]`,value:a[w],style:m.style,styleSpec:m.styleSpec}));break;case"has":case"!has":_=r.K(a[1]),a.length!==2?b.push(new r.V(c,a,`filter array for "${a[0]}" operator must have 2 elements`)):_!=="string"&&b.push(new r.V(`${c}[1]`,a[1],`string expected, ${_} found`))}return b}function Vo(m,a){let c=m.key,f=m.style,_=m.layer,b=m.styleSpec,w=m.value,I=m.objectKey,k=b[`${a}_${m.layerType}`];if(!k)return[];let O=I.match(/^(.*)-use-theme$/);if(a==="paint"&&O&&k[O[1]])return r.S(w)?[].concat(Kn({key:m.key,value:w,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:f,styleSpec:b,expressionContext:"property",propertyType:a,propertyKey:I})):Kn({key:c,value:w,valueSpec:{type:"string"},style:f,styleSpec:b});let F=I.match(/^(.*)-transition$/);if(a==="paint"&&F&&k[F[1]]&&k[F[1]].transition)return Kn({key:c,value:w,valueSpec:b.transition,style:f,styleSpec:b});let z=m.valueSpec||k[I];if(!z)return[new r.J(c,w,`unknown property "${I}"`)];let V;if(r.K(w)==="string"&&r.O(z)&&!z.tokens&&(V=/^{([^}]+)}$/.exec(w))){let K=`\`{ "type": "identity", "property": ${V?JSON.stringify(V[1]):'"_"'} }\``;return[new r.V(c,w,`"${I}" does not support interpolation syntax
Use an identity property function instead: ${K}.`)]}let G=[];if(m.layerType==="symbol")I!=="text-field"||!f||f.glyphs||f.imports||G.push(new r.V(c,w,'use of "text-field" requires a style "glyphs" property')),I==="text-font"&&r.a2(r.U(w))&&r.M(w.type)==="identity"&&G.push(new r.V(c,w,'"text-font" does not support identity functions'));else if(m.layerType==="model"&&a==="paint"&&_&&_.layout&&_.layout.hasOwnProperty("model-id")&&r.O(z)&&(r.a3(z)||r.Q(z))){let K=r.W(r.U(w),z),W=K.value.expression||K.value._styleExpression.expression;W&&!r.Z(W,["measure-light"])&&(I==="model-emissive-strength"&&r._(W)&&r.Y(W)||G.push(new r.V(c,w,`${I} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return G.concat(Kn({key:m.key,value:w,valueSpec:z,style:f,styleSpec:b,expressionContext:"property",propertyType:a,propertyKey:I}))}function Os(m){return Vo(m,"paint")}function cl(m){return Vo(m,"layout")}function Io(m){let a=[],c=m.value,f=m.key,_=m.style,b=m.styleSpec;c.type||c.ref||a.push(new r.V(f,c,'either "type" or "ref" is required'));let w=r.M(c.type),I=r.M(c.ref);if(c.id){let k=r.M(c.id);for(let O=0;O<m.arrayIndex;O++){let F=_.layers[O];r.M(F.id)===k&&a.push(new r.V(f,c.id,`duplicate layer id "${c.id}", previously used at line ${F.id.__line__}`))}}if("ref"in c){let k;["type","source","source-layer","filter","layout"].forEach(O=>{O in c&&a.push(new r.V(f,c[O],`"${O}" is prohibited for ref layers`))}),_.layers.forEach(O=>{r.M(O.id)===I&&(k=O)}),k?k.ref?a.push(new r.V(f,c.ref,"ref cannot reference another ref layer")):w=r.M(k.type):typeof I=="string"&&a.push(new r.V(f,c.ref,`ref layer "${I}" not found`))}else if(w!=="background"&&w!=="sky"&&w!=="slot")if(c.source){let k=_.sources&&_.sources[c.source],O=k&&r.M(k.type);k?O==="vector"&&w==="raster"?a.push(new r.V(f,c.source,`layer "${c.id}" requires a raster source`)):O==="raster"&&w!=="raster"?a.push(new r.V(f,c.source,`layer "${c.id}" requires a vector source`)):O!=="vector"||c["source-layer"]?O==="raster-dem"&&w!=="hillshade"?a.push(new r.V(f,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):O!=="raster-array"||["raster","raster-particle"].includes(w)?w!=="line"||!c.paint||!c.paint["line-gradient"]&&!c.paint["line-trim-offset"]||O==="geojson"&&k.lineMetrics?w==="raster-particle"&&O!=="raster-array"&&a.push(new r.V(f,c.source,`layer "${c.id}" requires a 'raster-array' source.`)):a.push(new r.V(f,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new r.V(f,c.source,"raster-array source can only be used with layer type 'raster'.")):a.push(new r.V(f,c,`layer "${c.id}" must specify a "source-layer"`)):a.push(new r.V(f,c.source,`source "${c.source}" not found`))}else a.push(new r.V(f,c,'missing required property "source"'));return a=a.concat(mr({key:f,value:c,valueSpec:b.layer,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Kn({key:`${f}.type`,value:c.type,valueSpec:b.layer.type,style:m.style,styleSpec:m.styleSpec,object:c,objectKey:"type"}),filter:k=>ll(r.L({layerType:w},k)),layout:k=>mr({layer:c,key:k.key,value:k.value,valueSpec:{},style:k.style,styleSpec:k.styleSpec,objectElementValidators:{"*":O=>cl(r.L({layerType:w},O))}}),paint:k=>mr({layer:c,key:k.key,value:k.value,valueSpec:{},style:k.style,styleSpec:k.styleSpec,objectElementValidators:{"*":O=>Os(r.L({layerType:w,layer:c},O))}})}})),a}function Oa(m){let a=m.value,c=m.key,f=r.K(a);return f!=="string"?[new r.V(c,a,`string expected, ${f} found`)]:[]}let ps={promoteId:function m({key:a,value:c}){if(r.K(c)==="string")return Oa({key:a,value:c});if(Array.isArray(c)){let f=[],_=r.U(c),b=r.X(_);return b.result==="error"&&b.value.forEach(w=>{f.push(new r.V(`${a}${w.key}`,null,`${w.message}`))}),r.Z(b.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||f.push(new r.V(`${a}`,null,"promoteId expression should be only feature dependent")),f}{let f=[];for(let _ in c)f.push(...m({key:`${a}.${_}`,value:c[_]}));return f}}};function dl(m){let a=m.value,c=m.key,f=m.styleSpec,_=m.style;if(!a.type)return[new r.V(c,a,'"type" is required')];let b=r.M(a.type),w=[];switch(["vector","raster","raster-dem","raster-array"].includes(b)&&(a.url||a.tiles||w.push(new r.J(c,a,'Either "url" or "tiles" is required.'))),b){case"vector":case"raster":case"raster-dem":case"raster-array":return w=w.concat(mr({key:c,value:a,valueSpec:f[`source_${b.replace("-","_")}`],style:m.style,styleSpec:f,objectElementValidators:ps})),w;case"geojson":if(w=mr({key:c,value:a,valueSpec:f.source_geojson,style:_,styleSpec:f,objectElementValidators:ps}),a.cluster)for(let I in a.clusterProperties){let[k,O]=a.clusterProperties[I],F=typeof k=="string"?[k,["accumulated"],["get",I]]:k;w.push(...ga({key:`${c}.${I}.map`,value:O,expressionContext:"cluster-map"})),w.push(...ga({key:`${c}.${I}.reduce`,value:F,expressionContext:"cluster-reduce"}))}return w;case"video":return mr({key:c,value:a,valueSpec:f.source_video,style:_,styleSpec:f});case"image":return mr({key:c,value:a,valueSpec:f.source_image,style:_,styleSpec:f});case"canvas":return[new r.V(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Za({key:`${c}.type`,value:a.type,valueSpec:{values:Wp(f)},style:_,styleSpec:f})}}function Wp(m){return m.source.reduce((a,c)=>{let f=m[c];return f.type.type==="enum"&&(a=a.concat(Object.keys(f.type.values))),a},[])}function Xd(m){let a=m.value,c=m.styleSpec,f=c.light,_=m.style,b=[],w=r.K(a);if(a===void 0)return b;if(w!=="object")return b=b.concat([new r.V("light",a,`object expected, ${w} found`)]),b;for(let I in a){let k=I.match(/^(.*)-transition$/),O=I.match(/^(.*)-use-theme$/);b=b.concat(O&&f[O[1]]?Kn({key:I,value:a[I],valueSpec:{type:"string"},style:_,styleSpec:c}):k&&f[k[1]]&&f[k[1]].transition?Kn({key:I,value:a[I],valueSpec:c.transition,style:_,styleSpec:c}):f[I]?Kn({key:I,value:a[I],valueSpec:f[I],style:_,styleSpec:c}):[new r.V(I,a[I],`unknown property "${I}"`)])}return b}function Kd(m){let a=m.value,c=[];if(!a)return c;let f=r.K(a);if(f!=="object")return c=c.concat([new r.V("light-3d",a,`object expected, ${f} found`)]),c;let _=m.styleSpec,b=_["light-3d"],w=m.key,I=m.style,k=m.style.lights;for(let z of["type","id"])if(!(z in a))return c=c.concat([new r.V("light-3d",a,`missing property ${z} on light`)]),c;if(a.type&&k)for(let z=0;z<m.arrayIndex;z++){let V=r.M(a.type),G=k[z];r.M(G.type)===V&&c.push(new r.V(w,a.id,`duplicate light type "${a.type}", previously defined at line ${G.id.__line__}`))}let O=`properties_light_${a.type}`;if(!(O in _))return c=c.concat([new r.V("light-3d",a,`Invalid light type ${a.type}`)]),c;let F=_[O];for(let z in a)if(z==="properties"){let V=a[z],G=r.K(V);if(G!=="object")return c=c.concat([new r.V("properties",V,`object expected, ${G} found`)]),c;for(let K in V)c=c.concat(F[K]?Kn({key:K,value:V[K],valueSpec:F[K],style:I,styleSpec:_}):[new r.J(m.key,V[K],`unknown property "${K}"`)])}else{let V=z.match(/^(.*)-transition$/),G=z.match(/^(.*)-use-theme$/);c=c.concat(G&&b[G[1]]?Kn({key:z,value:a[z],valueSpec:{type:"string"},style:I,styleSpec:_}):V&&b[V[1]]&&b[V[1]].transition?Kn({key:z,value:a[z],valueSpec:_.transition,style:I,styleSpec:_}):b[z]?Kn({key:z,value:a[z],valueSpec:b[z],style:I,styleSpec:_}):[new r.J(z,a[z],`unknown property "${z}"`)])}return c}function fs(m){let a=m.value,c=m.key,f=m.style,_=m.styleSpec,b=_.terrain,w=[],I=r.K(a);if(a===void 0||I==="null")return w;if(I!=="object")return w=w.concat([new r.V("terrain",a,`object expected, ${I} found`)]),w;for(let k in a){let O=k.match(/^(.*)-transition$/),F=k.match(/^(.*)-use-theme$/);w=w.concat(F&&b[F[1]]?Kn({key:k,value:a[k],valueSpec:{type:"string"},style:f,styleSpec:_}):O&&b[O[1]]&&b[O[1]].transition?Kn({key:k,value:a[k],valueSpec:_.transition,style:f,styleSpec:_}):b[k]?Kn({key:k,value:a[k],valueSpec:b[k],style:f,styleSpec:_}):[new r.J(k,a[k],`unknown property "${k}"`)])}if(a.source){let k=f.sources&&f.sources[a.source],O=k&&r.M(k.type);k?O!=="raster-dem"&&w.push(new r.V(c,a.source,`terrain cannot be used with a source of type ${String(O)}, it only be used with a "raster-dem" source type`)):w.push(new r.V(c,a.source,`source "${a.source}" not found`))}else w.push(new r.V(c,a,'terrain is missing required property "source"'));return w}function qu(m){let a=m.value,c=m.style,f=m.styleSpec,_=f.fog,b=[],w=r.K(a);if(a===void 0)return b;if(w!=="object")return b=b.concat([new r.V("fog",a,`object expected, ${w} found`)]),b;for(let I in a){let k=I.match(/^(.*)-transition$/),O=I.match(/^(.*)-use-theme$/);b=b.concat(O&&_[O[1]]?Kn({key:I,value:a[I],valueSpec:{type:"string"},style:c,styleSpec:f}):k&&_[k[1]]&&_[k[1]].transition?Kn({key:I,value:a[I],valueSpec:f.transition,style:c,styleSpec:f}):_[I]?Kn({key:I,value:a[I],valueSpec:_[I],style:c,styleSpec:f}):[new r.J(I,a[I],`unknown property "${I}"`)])}return b}let Er={"*":()=>[],array:ho,boolean:function(m){let a=m.value,c=m.key,f=r.K(a);return f!=="boolean"?[new r.V(c,a,`boolean expected, ${f} found`)]:[]},number:Qi,color:function(m){let a=m.key,c=m.value,f=r.K(c);return f!=="string"?[new r.V(a,c,`color expected, ${f} found`)]:r.a0.parseCSSColor(c)===null?[new r.V(a,c,`color expected, "${c}" found`)]:[]},enum:Za,filter:ll,function:Ur,layer:Io,object:mr,source:dl,model:r.a4,light:Xd,"light-3d":Kd,terrain:fs,fog:qu,string:Oa,formatted:function(m){return Oa(m).length===0?[]:ga(m)},resolvedImage:function(m){return Oa(m).length===0?[]:ga(m)},projection:function(m){let a=m.value,c=m.styleSpec,f=c.projection,_=m.style,b=[],w=r.K(a);if(w==="object")for(let I in a)b=b.concat(Kn({key:I,value:a[I],valueSpec:f[I],style:_,styleSpec:c}));else w!=="string"&&(b=b.concat([new r.V("projection",a,`object or string expected, ${w} found`)]));return b},import:function(m){let{value:a,styleSpec:c}=m,w=a,{data:f}=w,_=r_(w,["data"]);Object.defineProperty(_,"__line__",{value:a.__line__,enumerable:!1});let b=mr(r.L({},m,{value:_,valueSpec:c.import}));return r.M(_.id)===""&&b.push(new r.V(`${m.key}.id`,_,"import id can't be an empty string")),f&&(b=b.concat(Wu(f,c,{key:`${m.key}.data`}))),b},iconset:function(m){let a=m.value,c=m.key,f=m.styleSpec,_=m.style;if(!a.type)return[new r.V(c,a,'"type" is required')];let b=r.M(a.type),w=[];if(w=w.concat(mr({key:c,value:a,valueSpec:f[`iconset_${b}`],style:_,styleSpec:f})),b==="source"&&a.source){let I=_.sources&&_.sources[a.source],k=I&&r.M(I.type);I?k!=="raster-array"&&w.push(new r.V(c,a.source,`iconset cannot be used with a source of type ${String(k)}, it only be used with a "raster-array" source type`)):w.push(new r.V(c,a.source,`source "${a.source}" not found`))}return w}};function Kn(m,a=!1){let c=m.value,f=m.valueSpec,_=m.styleSpec;if(f.expression&&r.a2(r.M(c)))return Ur(m);if(f.expression&&r.S(r.U(c)))return ga(m);if(f.type&&Er[f.type]){let b=Er[f.type](m);return a===!0&&b.length>0&&r.K(m.value)==="array"?ga(m):b}return mr(r.L({},m,{valueSpec:f.type?_[f.type]:f}))}function Yp(m){let a=m.value,c=m.key,f=Oa(m);return f.length||(a.indexOf("{fontstack}")===-1&&f.push(new r.V(c,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&f.push(new r.V(c,a,'"glyphs" url must include a "{range}" token'))),f}function Wu(m,a=r.a5,c={}){return Kn({key:c.key||"",value:m,valueSpec:a.$root,styleSpec:a,style:m,objectElementValidators:{glyphs:Yp,"*":()=>[]}})}function Va(m,a=r.a5){return Le(Wu(m,a))}let Qd=m=>Le(dl(m)),Zp=m=>Le(Xd(m)),Yu=m=>Le(Kd(m)),$m=m=>Le(fs(m)),Gm=m=>Le(qu(m)),Xp=m=>Le(function(a){let c=a.value,f=a.style,_=a.styleSpec,b=_.snow,w=[],I=r.K(c);if(c===void 0)return w;if(I!=="object")return w=w.concat([new r.V("snow",c,`object expected, ${I} found`)]),w;for(let k in c){let O=k.match(/^(.*)-transition$/);w=w.concat(O&&b[O[1]]&&b[O[1]].transition?Kn({key:k,value:c[k],valueSpec:_.transition,style:f,styleSpec:_}):b[k]?Kn({key:k,value:c[k],valueSpec:b[k],style:f,styleSpec:_}):[new r.J(k,c[k],`unknown property "${k}"`)])}return w}(m)),nt=m=>Le(function(a){let c=a.value,f=a.style,_=a.styleSpec,b=_.rain,w=[],I=r.K(c);if(c===void 0)return w;if(I!=="object")return w=w.concat([new r.V("rain",c,`object expected, ${I} found`)]),w;for(let k in c){let O=k.match(/^(.*)-transition$/);w=w.concat(O&&b[O[1]]&&b[O[1]].transition?Kn({key:k,value:c[k],valueSpec:_.transition,style:f,styleSpec:_}):b[k]?Kn({key:k,value:c[k],valueSpec:b[k],style:f,styleSpec:_}):[new r.J(k,c[k],`unknown property "${k}"`)])}return w}(m)),ie=m=>Le(Io(m)),se=m=>Le(ll(m)),ye=m=>Le(Os(m)),ke=m=>Le(cl(m)),Ie=m=>Le(r.a4(m));function Le(m){return m.slice().sort((a,c)=>a.line&&c.line?a.line-c.line:0)}function Ze(m,a){let c=!1;if(a&&a.length)for(let f of a)f instanceof r.J?r.w(f.message):(m.fire(new r.z(new Error(f.message))),c=!0);return c}let Ve;class Je extends r.E{constructor(a,c="flat"){super(),this._transitionable=new r.a6(Ve||(Ve=new r.a7({anchor:new r.a8(r.a5.light.anchor),position:new r.a9(r.a5.light.position),color:new r.a8(r.a5.light.color),intensity:new r.a8(r.a5.light.intensity)}))),this.setLight(a,c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(a,c,f={}){this._validate(Zp,a,f)||(this._transitionable.setTransitionOrValue(a),this.id=c)}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,c,f){return(!f||f.validate!==!1)&&Ze(this,a.call(Va,r.l({value:c,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}}let ot=class extends r.E{constructor(m,a,c,f){super(),this.scope=c,this._transitionable=new r.a6(new r.a7({source:new r.a8(r.a5.terrain.source),exaggeration:new r.a8(r.a5.terrain.exaggeration)}),c,f),this._transitionable.setTransitionOrValue(m,f),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=a}get(){return this._transitionable.serialize()}set(m,a){this._transitionable.setTransitionOrValue(m,a)}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}getExaggeration(m){return this._transitioning.possiblyEvaluate(new r.aa(m)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;let m=this._transitionable._values.exaggeration;if(!m)return null;let a=m.value.expression;if(!a)return null;let c=-1,f=-1,_=1;for(let b of a.zoomStops)_=a.evaluate(new r.aa(b)),_>.01?(c=b,f=-1):f=b;return _<.01&&c>0&&f>c?[c,f]:null}isZoomDependent(){let m=this._transitionable._values.exaggeration;return m!=null&&m.value!=null&&m.value.expression!=null&&m.value.expression instanceof r.ab}},it=45,Tt=65,Ut=.05;function Zt(m,a,c,f){let _=r.ae(it,Tt,c),[b,w]=Pi(m,f),I=1-Math.min(1,Math.exp((a-b)/(w-b)*-6));return I*=I*I,I=Math.min(1,1.00747*I),I*_*m.alpha}function Pi(m,a){let c=.5/Math.tan(.5*a);return[m.range[0]+c,m.range[1]+c]}function Hi(m,a,c,f,_){let b=r.ad.vec3.transformMat4([],[a,c,f],_.mercatorFogMatrix);return Zt(m,r.ad.vec3.length(b),_.pitch,_._fov)}function $i(m,a,c,f,_,b,w){let I=[[c,f,0],[_,f,0],[_,b,0],[c,b,0]],k=Number.MAX_VALUE,O=-Number.MAX_VALUE;for(let F of I){let z=r.ad.vec3.transformMat4([],F,a),V=r.ad.vec3.length(z);k=Math.min(k,V),O=Math.max(O,V)}return[Zt(m,k,w.pitch,w._fov),Zt(m,O,w.pitch,w._fov)]}class Yi extends r.E{constructor(a,c,f,_){super();let b=new r.a7({range:new r.a8(r.a5.fog.range),color:new r.a8(r.a5.fog.color),"color-use-theme":new r.a8({type:"string","property-type":"data-constant",default:"default"}),"high-color":new r.a8(r.a5.fog["high-color"]),"high-color-use-theme":new r.a8({type:"string","property-type":"data-constant",default:"default"}),"space-color":new r.a8(r.a5.fog["space-color"]),"space-color-use-theme":new r.a8({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new r.a8(r.a5.fog["horizon-blend"]),"star-intensity":new r.a8(r.a5.fog["star-intensity"]),"vertical-range":new r.a8(r.a5.fog["vertical-range"])});this._transitionable=new r.a6(b,f,new Map(_)),this.set(a,_),this._transitioning=this._transitionable.untransitioned(),this._transform=c,this.properties=new r.af(b),this.scope=f}get state(){let a=this._transform,c=a.projection.name==="globe",f=r.ag(a.zoom),_=this.properties.get("range"),b=[.5,3];return{range:c?[r.ah(b[0],_[0],f),r.ah(b[1],_[1],f)]:_,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(a,c,f={}){if(this._validate(Gm,a,f))return;let _=r.l({},a);for(let b of Object.keys(r.a5.fog))_[b]===void 0&&(_[b]=r.a5.fog[b].default);this._options=_,this._transitionable.setTransitionOrValue(this._options,c)}getOpacity(a){if(!this._transform.projection.supportsFog)return 0;let c=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:r.ae(it,Tt,a))*c.a}getOpacityAtLatLng(a,c){return this._transform.projection.supportsFog?function(f,_,b){let w=r.ac.fromLngLat(_),I=b.elevation?b.elevation.getAtPointOrZero(w):0;return Hi(f,w.x,w.y,I,b)}(this.state,a,c):0}getOpacityForTile(a){if(!this._transform.projection.supportsFog)return[1,1];let c=this._transform.calculateFogTileMatrix(a.toUnwrapped());return $i(this.state,c,0,0,r.ai,r.ai,this._transform)}getOpacityForBounds(a,c,f,_,b){return this._transform.projection.supportsFog?$i(this.state,a,c,f,_,b,this._transform):[1,1]}getFovAdjustedRange(a){return this._transform.projection.supportsFog?Pi(this.state,a):[0,1]}isVisibleOnFrustum(a){if(!this._transform.projection.supportsFog)return!1;let c=[4,5,6,7];for(let f of c){let _=a.points[f],b;if(_[2]>=0)b=_;else{let w=a.points[f-4];b=r.aj(w,_,w[2]/(w[2]-_[2]))}if(Hi(this.state,b[0],b[1],0,this._transform)>=Ut)return!0}return!1}updateConfig(a){this._transitionable.setTransitionOrValue(this._options,new Map(a))}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,c,f){return(!f||f.validate!==!1)&&Ze(this,a.call(Va,r.l({value:c,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}}let lr,wr,nn,On,Fn=class extends r.E{constructor(m,a,c,f){super();let _=lr||(lr=new r.a7({density:new r.a8(r.a5.snow.density),intensity:new r.a8(r.a5.snow.intensity),color:new r.a8(r.a5.snow.color),opacity:new r.a8(r.a5.snow.opacity),vignette:new r.a8(r.a5.snow.vignette),"vignette-color":new r.a8(r.a5.snow["vignette-color"]),"center-thinning":new r.a8(r.a5.snow["center-thinning"]),direction:new r.a8(r.a5.snow.direction),"flake-size":new r.a8(r.a5.snow["flake-size"])}));this._transitionable=new r.a6(_,c,new Map(f)),this.set(m,f),this._transitioning=this._transitionable.untransitioned(),this.properties=new r.af(_),this.scope=c}get state(){let m=this.properties.get("opacity"),a=this.properties.get("color"),c=this.properties.get("direction"),f=r.ak(c[0]),_=-Math.max(r.ak(c[1]),.01),b=[Math.cos(f)*Math.cos(_),Math.sin(f)*Math.cos(_),Math.sin(_)],w=this.properties.get("vignette"),I=this.properties.get("vignette-color");return I.a=w,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new r.al(a.r,a.g,a.b,a.a*m),direction:b,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:I}}get(){return this._transitionable.serialize()}set(m,a,c={}){if(this._validate(Xp,m,c))return;let f=r.l({},m);for(let _ of Object.keys(r.a5.snow))f[_]===void 0&&(f[_]=r.a5.snow[_].default);this._options=f,this._transitionable.setTransitionOrValue(this._options,a)}updateConfig(m){this._transitionable.setTransitionOrValue(this._options,new Map(m))}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}_validate(m,a,c){return(!c||c.validate!==!1)&&Ze(this,m.call(Va,r.l({value:a,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}},zn=class extends r.E{constructor(m,a,c,f){super();let _=wr||(wr=new r.a7({density:new r.a8(r.a5.rain.density),intensity:new r.a8(r.a5.rain.intensity),color:new r.a8(r.a5.rain.color),opacity:new r.a8(r.a5.rain.opacity),vignette:new r.a8(r.a5.rain.vignette),"vignette-color":new r.a8(r.a5.rain["vignette-color"]),"center-thinning":new r.a8(r.a5.rain["center-thinning"]),direction:new r.a8(r.a5.rain.direction),"droplet-size":new r.a8(r.a5.rain["droplet-size"]),"distortion-strength":new r.a8(r.a5.rain["distortion-strength"])}));this._transitionable=new r.a6(_,c,new Map(f)),this.set(m,f),this._transitioning=this._transitionable.untransitioned(),this.properties=new r.af(_),this.scope=c}get state(){let m=this.properties.get("opacity"),a=this.properties.get("color"),c=this.properties.get("direction"),f=r.ak(c[0]),_=-Math.max(r.ak(c[1]),.01),b=[Math.cos(f)*Math.cos(_),Math.sin(f)*Math.cos(_),Math.sin(_)],w=this.properties.get("vignette-color");return w.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new r.al(a.r,a.g,a.b,a.a*m),direction:b,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:w}}get(){return this._transitionable.serialize()}set(m,a,c={}){if(this._validate(nt,m,c))return;let f=r.l({},m);for(let _ of Object.keys(r.a5.rain))f[_]===void 0&&(f[_]=r.a5.rain[_].default);this._options=f,this._transitionable.setTransitionOrValue(this._options,a)}updateConfig(m){this._transitionable.setTransitionOrValue(this._options,new Map(m))}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}_validate(m,a,c){return(!c||c.validate!==!1)&&Ze(this,m.call(Va,r.l({value:a,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}};class Fr extends r.E{constructor(a,c,f,_){super(),this.scope=f,this._options=a,this.properties=new r.af(c),this._transitionable=new r.a6(c,f,new Map(_)),this._transitionable.setTransitionOrValue(a.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(a){this._transitionable.setTransitionOrValue(this._options.properties,new Map(a))}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(a,c){this._options=a,this._transitionable.setTransitionOrValue(a.properties,c)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Ao{constructor(a,c,f,_){this.screenBounds=a,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=f,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,_)}static createFromScreenPoints(a,c){let f,_;if(a instanceof r.P||typeof a[0]=="number"){let b=r.P.convert(a);f=[b],_=c.isPointAboveHorizon(b)}else{let b=r.P.convert(a[0]),w=r.P.convert(a[1]);f=[b,w],_=r.an(b,w).every(I=>c.isPointAboveHorizon(I))}return new Ao(f,c.getCameraPoint(),_,c)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(a){return r.an(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],a)}bufferedCameraGeometry(a){let c=this.screenBounds[0],f=this.screenBounds.length===1?this.screenBounds[0].add(new r.P(1,1)):this.screenBounds[1],_=r.an(c,f,0,!1);return this.cameraPoint.y>f.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<f.x?_.splice(3,0,this.cameraPoint):this.cameraPoint.x>=f.x?_[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(_[3]=this.cameraPoint)),r.ao(_,a)}bufferedCameraGeometryGlobe(a){let c=this.screenBounds[0],f=this.screenBounds.length===1?this.screenBounds[0].add(new r.P(1,1)):this.screenBounds[1],_=r.an(c,f,a),b=this.cameraPoint.clone();switch(3*((b.y>c.y)+(b.y>f.y))+((b.x>c.x)+(b.x>f.x))){case 0:_[0]=b,_[4]=b.clone();break;case 1:_.splice(1,0,b);break;case 2:_[1]=b;break;case 3:_.splice(4,0,b);break;case 5:_.splice(2,0,b);break;case 6:_[3]=b;break;case 7:_.splice(3,0,b);break;case 8:_[2]=b}return _}containsTile(a,c,f,_=0){let b=a.queryPadding/c._pixelsPerMercatorPixel+1,w=f?this._bufferedCameraMercator(b,c):this._bufferedScreenMercator(b,c),I=a.tileID.wrap+(w.unwrapped?_:0),k=w.polygon.map(te=>r.ap(a.tileTransform,te,I));if(!r.aq(k,0,0,r.ai,r.ai))return;I=a.tileID.wrap+(this.screenGeometryMercator.unwrapped?_:0);let O=this.screenGeometryMercator.polygon.map(te=>r.ar(a.tileTransform,te,I)),F=O.map(te=>new r.P(te[0],te[1])),z=c.getFreeCameraOptions().position||new r.ac(0,0,0),V=r.ar(a.tileTransform,z,I),G=O.map(te=>{let ne=r.ad.vec3.sub(te,te,V);return r.ad.vec3.normalize(ne,ne),new r.as(V,ne)}),K=r.at(a,1,c.zoom)*c._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:F,tilespaceRays:G,bufferedTilespaceGeometry:k,bufferedTilespaceBounds:(W=r.au(k),W.min.x=r.ay(W.min.x,0,r.ai),W.min.y=r.ay(W.min.y,0,r.ai),W.max.x=r.ay(W.max.x,0,r.ai),W.max.y=r.ay(W.max.y,0,r.ai),W),tile:a,tileID:a.tileID,pixelToTileUnitsFactor:K};var W}_bufferedScreenMercator(a,c){let f=Fa(a);if(this._screenRaycastCache[f])return this._screenRaycastCache[f];{let _;return _=c.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(a),c):{polygon:this.bufferedScreenGeometry(a).map(b=>c.pointCoordinate3D(b)),unwrapped:!0},this._screenRaycastCache[f]=_,_}}_bufferedCameraMercator(a,c){let f=Fa(a);if(this._cameraRaycastCache[f])return this._cameraRaycastCache[f];{let _;return _=c.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(a),c):{polygon:this.bufferedCameraGeometry(a).map(b=>c.pointCoordinate3D(b)),unwrapped:!0},this._cameraRaycastCache[f]=_,_}}_projectAndResample(a,c){let f=function(b,w){let I=r.ad.mat4.multiply([],w.pixelMatrix,w.globeMatrix),k=[0,-r.az,0,1],O=[0,r.az,0,1],F=[0,0,0,1];r.ad.vec4.transformMat4(k,k,I),r.ad.vec4.transformMat4(O,O,I),r.ad.vec4.transformMat4(F,F,I);let z=new r.P(k[0]/k[3],k[1]/k[3]),V=new r.P(O[0]/O[3],O[1]/O[3]),G=r.aw(b,z)&&k[3]<F[3],K=r.aw(b,V)&&O[3]<F[3];if(!G&&!K)return null;let W=function(be,xe,Ae){for(let Oe=1;Oe<be.length;Oe++){let Ke=Fs(xe.pointCoordinate3D(be[Oe-1]).x),$e=Fs(xe.pointCoordinate3D(be[Oe]).x);if(Ae<0){if(Ke<$e)return{idx:Oe,t:-Ke/($e-1-Ke)}}else if($e<Ke)return{idx:Oe,t:(1-Ke)/($e+1-Ke)}}return null}(b,w,G?-1:1);if(!W)return null;let{idx:te,t:ne}=W,he=te>1?_a(b.slice(0,te),w):[],_e=te<b.length?_a(b.slice(te),w):[];he=he.map(be=>new r.P(Fs(be.x),be.y)),_e=_e.map(be=>new r.P(Fs(be.x),be.y));let me=[...he];me.length===0&&me.push(_e[_e.length-1]);let Se=r.ah(me[me.length-1].y,(_e.length===0?he[0]:_e[0]).y,ne),ve;return ve=G?[new r.P(0,Se),new r.P(0,0),new r.P(1,0),new r.P(1,Se)]:[new r.P(1,Se),new r.P(1,1),new r.P(0,1),new r.P(0,Se)],me.push(...ve),_e.length===0?me.push(he[0]):me.push(..._e),{polygon:me.map(be=>new r.ac(be.x,be.y)),unwrapped:!1}}(a,c);if(f)return f;let _=function(b,w){let I=!1,k=-1/0,O=0;for(let z=0;z<b.length-1;z++)b[z].x>k&&(k=b[z].x,O=z);for(let z=0;z<b.length-1;z++){let V=(O+z)%(b.length-1),G=b[V],K=b[V+1];Math.abs(G.x-K.x)>.5&&(G.x<K.x?(G.x+=1,V===0&&(b[b.length-1].x+=1)):(K.x+=1,V+1===b.length-1&&(b[0].x+=1)),I=!0)}let F=r.av(w.center.lng);return I&&F<Math.abs(F-1)&&b.forEach(z=>{z.x-=1}),{polygon:b,unwrapped:I}}(_a(a,c).map(b=>new r.P(Fs(b.x),b.y)),c);return{polygon:_.polygon.map(b=>new r.ac(b.x,b.y)),unwrapped:_.unwrapped}}}function _a(m,a){return r.ax(m,c=>{let f=a.pointCoordinate3D(c);c.x=f.x,c.y=f.y},1/256)}function Fs(m){return m<0?1+m%1:m%1}function Fa(m){return 100*m|0}function Ro(m,a,c,f,_){let b=function(I,k){if(I)return _(I);if(k){if(m.url&&k.tiles&&m.tiles&&delete m.tiles,k.variants){if(!Array.isArray(k.variants))return _(new Error("variants must be an array"));for(let F of k.variants){if(F==null||typeof F!="object"||F.constructor!==Object)return _(new Error("variant must be an object"));if(!Array.isArray(F.capabilities))return _(new Error("capabilities must be an array"));if(F.capabilities.length===1&&F.capabilities[0]==="meshopt"){k=r.l(k,F);break}}}let O=r.aA(r.l({},k,m),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);O.tiles=a.canonicalizeTileset(O,m.url),_(null,O)}},w=function(I,k,O){if(!I)return null;if(!k&&!O)return I;O=O||I.worldview_default;let F=Object.values(I.language||{});if(F.length===0)return null;let z=Object.values(I.worldview||{});if(z.length===0)return null;let V=F.every(K=>K===k),G=z.every(K=>K===O);return V&&G?I:k in(I.language_options||{})||O in(I.worldview_options||{})?null:I.language_options&&I.worldview_options?I:null}(m.data,c,f);return w?r.q.frame(()=>b(null,w)):m.url?r.n(a.transformRequest(a.normalizeSourceURL(m.url,null,c,f),r.R.Source),b):r.q.frame(()=>{let O=m,{data:I}=O,k=r_(O,["data"]);b(null,k)})}class jo{constructor(a,c,f){this.bounds=r.aB.convert(this.validateBounds(a)),this.minzoom=c||0,this.maxzoom=f||24}validateBounds(a){return Array.isArray(a)&&a.length===4?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]}contains(a){let c=Math.pow(2,a.z),f=Math.floor(r.av(this.bounds.getWest())*c),_=Math.floor(r.aC(this.bounds.getNorth())*c),b=Math.ceil(r.av(this.bounds.getEast())*c),w=Math.ceil(r.aC(this.bounds.getSouth())*c);return a.x>=f&&a.x<b&&a.y>=_&&a.y<w}}class Zu extends r.E{constructor(a,c,f,_){if(super(),this.id=a,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,r.l(this,r.aA(c,["url","scheme","tileSize","promoteId"])),this._options=r.l({type:"vector"},c),this._collectResourceTiming=!!c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_),this._tileWorkers={},this._deduped=new r.aD}load(a){this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"}));let c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,f=this.map.getWorldview();this._tileJSONRequest=Ro(this._options,this.map._requestManager,c,f,(_,b)=>{if(this._tileJSONRequest=null,this._loaded=!0,_)c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),f&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${f}`),this.fire(new r.z(_));else if(b){if(r.l(this,b),this.hasWorldviews=!!b.worldview_options,b.worldview_default&&(this.worldviewDefault=b.worldview_default),b.vector_layers){this.vectorLayers=b.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(let w of b.vector_layers)this.vectorLayerIds.push(w.id),b.worldview&&b.worldview[w.source]&&this.localizableLayerIds.add(w.id)}b.bounds&&(this.tileBounds=new jo(b.bounds,this.minzoom,this.maxzoom)),mn(b.tiles,this.map._requestManager._customAccessToken),this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))}a&&a(_)})}loaded(){return this._loaded}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}onAdd(a){this.map=a,this.load()}reload(){this.cancelTileJSONRequest();let a=r.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(a))}setTiles(a){return this._options.tiles=a,this.reload(),this}setUrl(a){return this.url=a,this._options.url=a,this.reload(),this}onRemove(a){this.cancelTileJSONRequest()}serialize(){return r.l({},this._options)}loadTile(a,c){let f=a.tileID.canonical.url(this.tiles,this.scheme),_=this.map._requestManager.normalizeTileURL(f),b=this.map._requestManager.transformRequest(_,r.R.Tile),w=this.map.style?this.map.style.getLut(this.scope):null,I=w?{image:w.image.clone()}:null,k={request:b,data:void 0,uid:a.uid,tileID:a.tileID,tileZoom:a.tileZoom,zoom:a.tileID.overscaledZ,maxZoom:this.maxzoom,lut:I,tileSize:this.tileSize*a.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:r.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:a.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:a.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&r.f(f)&&(k.worldview=this.map.getWorldview()||this.worldviewDefault,k.localizableLayerIds=this.localizableLayerIds),k.request.collectResourceTiming=this._collectResourceTiming,a.actor&&a.state!=="expired")a.state==="loading"?a.reloadCallback=c:a.request=a.actor.send("reloadTile",k,O.bind(this));else if(a.actor=this._tileWorkers[_]=this._tileWorkers[_]||this.dispatcher.getActor(),this.dispatcher.ready)a.request=a.actor.send("loadTile",k,O.bind(this),void 0,!0);else{let F=r.aE.call({deduped:this._deduped},k,(z,V)=>{z||!V?O.call(this,z):(k.data={cacheControl:V.cacheControl,expires:V.expires,rawData:V.rawData.slice(0)},a.actor&&a.actor.send("loadTile",k,O.bind(this),void 0,!0))},!0);a.request={cancel:F}}function O(F,z){return delete a.request,a.aborted?c(null):F&&F.status!==404?c(F):(z&&z.resourceTiming&&(a.resourceTiming=z.resourceTiming),this.map._refreshExpiredTiles&&z&&a.setExpiryData(z),a.loadVectorData(z,this.map.painter),r.aF(this.dispatcher),c(null),void(a.reloadCallback&&(this.loadTile(a,a.reloadCallback),a.reloadCallback=null)))}}abortTile(a){a.request&&(a.request.cancel(),delete a.request),a.actor&&a.actor.send("abortTile",{uid:a.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(a,c){a.actor&&a.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id,scope:this.scope}),a.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ls extends r.E{constructor(a,c,f,_){super(),this.id=a,this.dispatcher=f,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=r.l({type:"raster"},c),r.l(this,r.aA(c,["url","scheme","tileSize"]))}load(a){this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"})),this._tileJSONRequest=Ro(this._options,this.map._requestManager,null,null,(c,f)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new r.z(c)):f&&(r.l(this,f),f.raster_layers&&(this.rasterLayers=f.raster_layers,this.rasterLayerIds=this.rasterLayers.map(_=>_.id)),f.bounds&&(this.tileBounds=new jo(f.bounds,this.minzoom,this.maxzoom)),mn(f.tiles),this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))),a&&a(c)})}loaded(){return this._loaded}onAdd(a){this.map=a,this.load()}reload(){this.cancelTileJSONRequest();let a=r.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(a))}setTiles(a){return this._options.tiles=a,this.reload(),this}setUrl(a){return this.url=a,this._options.url=a,this.reload(),this}onRemove(a){this.cancelTileJSONRequest()}serialize(){return r.l({},this._options)}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}loadTile(a,c){let f=r.q.devicePixelRatio>=2,_=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme),f,this.tileSize);a.request=r.o(this.map._requestManager.transformRequest(_,r.R.Tile),(b,w,I,k)=>(delete a.request,a.aborted?(a.state="unloaded",c(null)):b?(a.state="errored",c(b)):w?(this.map._refreshExpiredTiles&&a.setExpiryData({cacheControl:I,expires:k}),a.setTexture(w,this.map.painter),a.state="loaded",r.aF(this.dispatcher),void c(null)):c(null)))}abortTile(a,c){a.request&&(a.request.cancel(),delete a.request),c&&c()}unloadTile(a,c){a.texture&&a.texture instanceof r.T?(a.destroy(!0),a.texture&&a.texture instanceof r.T&&this.map.painter.saveTileTexture(a.texture)):a.destroy(),c&&c()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class dc extends Ls{constructor(a,c,f,_){super(a,c,f,_),this.type="raster-array",this.maxzoom=22,this.partial=!0,this.iconsets={},this._options=r.l({type:"raster-array"},c)}triggerRepaint(a){let c=this.map.painter._terrain,f=this.map.style.getSourceCache(this.id);c&&c.enabled&&f&&c._clearRenderCacheForTile(f.id,a.tileID),this.map.triggerRepaint()}loadTile(a,c){let f=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),_=this.map._requestManager.transformRequest(f,r.R.Tile),b={request:_,uid:a.uid,tileID:a.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};a.source=this.id,a.scope=this.scope,a.requestParams=_,a.actor||(a.actor=this.dispatcher.getActor());let w=(I,k,O,F)=>{if(delete a.request,a.aborted)return a.state="unloaded",c(null);if(I)return I.name==="AbortError"?void 0:(a.state="errored",c(I));if(this.map._refreshExpiredTiles&&k&&a.setExpiryData({cacheControl:O,expires:F}),this.partial)a.state="empty";else{if(!k)return c(null);a.state="loaded",a._isHeaderLoaded=!0,a._mrt=k;let z=new Map;for(let V in a._mrt.layers){let G=a.getLayer(V);if(G)for(let K of G.getBandList()){let{bytes:W,tileSize:te,buffer:ne}=G.getBandView(K),he=te+2*ne,_e={data:new r.r({width:he,height:he},W),pixelRatio:2,sdf:!1,usvg:!1,version:0};z.set(`${V}/${K}`,_e)}}for(let V in this.iconsets)this.iconsets[V].addIcons(z)}c(null)};a.request=this.partial?a.fetchHeader(void 0,w.bind(this)):a.actor.send("loadTile",b,w.bind(this),void 0,!0)}abortTile(a){a.request&&(a.request.cancel(),delete a.request),a.actor&&a.actor.send("abortTile",{uid:a.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(a,c){let f=a.texture;f&&f instanceof r.T?(a.destroy(!0),this.map.painter.saveTileTexture(f)):(a.destroy(),a.flushQueues(),a._isHeaderLoaded=!1,delete a._mrt,delete a.textureDescriptor),a.fbo&&(a.fbo.destroy(),delete a.fbo),delete a.request,delete a.requestParams,delete a.neighboringTiles,a.state="unloaded"}prepareTile(a,c,f){a._isHeaderLoaded&&(a.state!=="empty"&&(a.state="reloading"),a.fetchBand(c,f,(_,b)=>{if(_)return a.state="errored",this.fire(new r.z(_)),void this.triggerRepaint(a);b&&(a._isHeaderLoaded=!0,a.setTexture(b,this.map.painter),a.state="loaded",this.triggerRepaint(a))}))}getInitialBand(a){if(!this.rasterLayers)return 0;let c=this.rasterLayers.find(({id:b})=>b===a),f=c&&c.fields,_=f&&f.bands&&f.bands;return _?_[0]:0}getTextureDescriptor(a,c,f){if(!a)return;let _=c.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!_)return;let b=null;c instanceof r.aI?b=c.paint.get("raster-array-band"):c instanceof r.aJ&&(b=c.paint.get("raster-particle-array-band"));let w=b||this.getInitialBand(_);if(w!=null)if(a.textureDescriptor){if(!a.updateNeeded(_,w)||f)return Object.assign({},a.textureDescriptor,{texture:a.texture})}else this.prepareTile(a,_,w)}addIconset(a,c){this.iconsets[a]=c,this.partial=!1}}let Uy={vector:Zu,raster:Ls,"raster-dem":class extends Ls{constructor(m,a,c,f){super(m,a,c,f),this.type="raster-dem",this.maxzoom=22,this._options=r.l({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox"}loadTile(m,a){let c=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function f(_,b){_&&(m.state="errored",a(_)),b&&(m.dem=b,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",a(null))}m.request=r.o(this.map._requestManager.transformRequest(c,r.R.Tile),function(_,b,w,I){if(delete m.request,m.aborted)m.state="unloaded",a(null);else if(_)m.state="errored",a(_);else if(b){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:w,expires:I});let k=ImageBitmap&&b instanceof ImageBitmap&&r.t(),O=1-(b.width-r.aG(b.width))/2;O<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));let F=k?b:r.q.getImageData(b,O),z={uid:m.uid,tileID:m.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:F,encoding:this.encoding,padding:O};m.actor&&m.state!=="expired"||(m.actor=this.dispatcher.getActor(),m.actor.send("loadTile",z,f.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(m){let a=m.canonical,c=Math.pow(2,a.z),f=(a.x-1+c)%c,_=a.x===0?m.wrap-1:m.wrap,b=(a.x+1+c)%c,w=a.x+1===c?m.wrap+1:m.wrap,I={};return I[new r.aH(m.overscaledZ,_,a.z,f,a.y).key]={backfilled:!1},I[new r.aH(m.overscaledZ,w,a.z,b,a.y).key]={backfilled:!1},a.y>0&&(I[new r.aH(m.overscaledZ,_,a.z,f,a.y-1).key]={backfilled:!1},I[new r.aH(m.overscaledZ,m.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},I[new r.aH(m.overscaledZ,w,a.z,b,a.y-1).key]={backfilled:!1}),a.y+1<c&&(I[new r.aH(m.overscaledZ,_,a.z,f,a.y+1).key]={backfilled:!1},I[new r.aH(m.overscaledZ,m.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},I[new r.aH(m.overscaledZ,w,a.z,b,a.y+1).key]={backfilled:!1}),I}},"raster-array":dc,geojson:class extends r.E{constructor(m,a,c,f){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(f),this._data=a.data,this._options=r.l({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.minzoom!==void 0&&(this.minzoom=a.minzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;let _=r.ai/this.tileSize;this.workerOptions=r.l({source:this.id,scope:this.scope,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*_,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*_,extent:r.ai,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:r.ai,radius:(a.clusterRadius!==void 0?a.clusterRadius:50)*_,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter,dynamic:a.dynamic},a.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}updateData(m){if(!this._options.dynamic)return this.fire(new r.z(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof m!="string"&&(m.type==="Feature"&&(m={type:"FeatureCollection",features:[m]}),m.type!=="FeatureCollection"))return this.fire(new r.z(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof m!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){let a=new Map;for(let c of this._data.features)a.set(c.id,c);for(let c of m.features)a.set(c.id,c);this._data.features=[...a.values()]}else this._data=m;return this._updateWorkerData(!0),this}getClusterExpansionZoom(m,a){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id,scope:this.scope},a),this}getClusterChildren(m,a){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id,scope:this.scope},a),this}getClusterLeaves(m,a,c,f){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:m,limit:a,offset:c},f),this}_updateWorkerData(m=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new r.A("dataloading",{dataType:"source"})),this._loaded=!1;let a=r.l({append:m},this.workerOptions);a.scope=this.scope;let c=this._data;typeof c=="string"?(a.request=this.map._requestManager.transformRequest(r.q.resolveURL(c),r.R.Source),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(c),this._pendingLoad=this.actor.send(`${this.type}.loadData`,a,(f,_)=>{if(this._loaded=!0,this._pendingLoad=null,f)this.fire(new r.z(f));else{let b={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&_&&_.resourceTiming&&_.resourceTiming[this.id]&&(b.resourceTiming=_.resourceTiming[this.id]),m&&(this._partialReload=!0),this.fire(new r.A("data",b)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(m),this._coalesce=!1)})}loaded(){return this._loaded}reload(){let m=r.C(this.id,this.scope);this.map.style.clearSource(m),this._updateWorkerData()}loadTile(m,a){let c=m.actor?"reloadTile":"loadTile";m.actor=this.actor;let f=this.map.style?this.map.style.getLut(this.scope):null,_=f?{image:f.image.clone()}:null,b=this._partialReload,w={type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:_,scope:this.scope,pixelRatio:r.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:b};m.request=this.actor.send(c,w,(I,k)=>b&&!k?(m.state="loaded",a(null)):(delete m.request,m.destroy(),m.aborted?a(null):I?a(I):(m.loadVectorData(k,this.map.painter,c==="reloadTile"),a(null))),void 0,c==="loadTile")}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m,a){this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id,scope:this.scope}),m.destroy()}onRemove(m){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return r.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends r.aK{constructor(m,a,c,f){super(m,a,c,f),this.roundZoom=!0,this.type="video",this.options=a}load(){this._loaded=!1;let m=this.options;this.urls=[];for(let a of m.urls)this.urls.push(this.map._requestManager.transformRequest(a,r.R.Source).url);r.aL(this.urls,(a,c)=>{this._loaded=!0,a?this.fire(new r.z(a)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){let a=this.video.seekable;m<a.start(0)||m>a.end(0)?this.fire(new r.z(new r.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let m=this.map.painter.context,a=m.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new r.T(m,this.video,a.RGBA8),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:r.aK,model:class extends r.E{constructor(m,a,c,f){super(),this.id=m,this.type="model",this.models=[],this._loaded=!1,this._options=a}load(){let m=[];for(let a in this._options.models){let c=this._options.models[a],f=r.aN(this.map._requestManager.transformRequest(c.uri,r.R.Model).url).then(_=>{if(!_)return;let b=r.aO(_),w=new r.aP(a,c.position,c.orientation,b);w.computeBoundsAndApplyParent(),this.models.push(w)}).catch(_=>{this.fire(new r.z(new Error(`Could not load model ${a} from ${c.uri}: ${_.message}`)))});m.push(f)}return Promise.allSettled(m).then(()=>{this._loaded=!0,this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(a=>{this.fire(new r.z(new Error(`Could not load models: ${a.message}`)))})}onAdd(m){this.map=m,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(m,a){}serialize(){return{type:"model"}}},"batched-model":class extends r.E{constructor(m,a,c,f){super(),this.type="batched-model",this.id=m,this.tileSize=512,this._options=a,this.tiles=this._options.tiles,this.maxzoom=a.maxzoom||19,this.minzoom=a.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=c,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(f)}onAdd(m){this.map=m,this.load()}reload(){this.cancelTileJSONRequest();let m=r.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(m))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(m){this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"}));let a=Array.isArray(this.map._language)?this.map._language.join():this.map._language,c=this.map.getWorldview();this._tileJSONRequest=Ro(this._options,this.map._requestManager,a,c,(f,_)=>{this._tileJSONRequest=null,this._loaded=!0,f?(a&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${a}`),c&&c.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${c}`),this.fire(new r.z(f))):_&&(r.l(this,_),_.bounds&&(this.tileBounds=new jo(_.bounds,this.minzoom,this.maxzoom)),mn(_.tiles,this.map._requestManager._customAccessToken),this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))),m&&m(f)})}hasTransition(){return!1}hasTile(m){return!this.tileBounds||this.tileBounds.contains(m.canonical)}loaded(){return this._loaded}loadTile(m,a){let c=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme)),f={request:this.map._requestManager.transformRequest(c,r.R.Tile),data:void 0,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,tileSize:this.tileSize*m.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:m.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:r.q.devicePixelRatio,promoteId:this.promoteId};if(m.actor&&m.state!=="expired")if(m.state==="loading")m.reloadCallback=a;else{if(m.buckets){let b=Object.values(m.buckets);for(let w of b)w.dirty=!0;return void(m.state="loaded")}m.request=m.actor.send("reloadTile",f,_.bind(this))}else m.actor=this.dispatcher.getActor(),m.request=m.actor.send("loadTile",f,_.bind(this),void 0,!0);function _(b,w){return m.aborted?a(null):b&&b.status!==404?a(b):(this.map._refreshExpiredTiles&&w&&m.setExpiryData(w),m.loadModelData(w,this.map.painter),m.state="loaded",void a(null))}}serialize(){return r.l({},this._options)}},canvas:class extends r.aK{constructor(m,a,c,f){super(m,a,c,f),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(b=>typeof b!="number"))||this.fire(new r.z(new r.V(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new r.z(new r.V(`sources.${m}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new r.z(new r.V(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new r.z(new r.V(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new r.z(new r.V(`sources.${m}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new r.z(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(m){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let a=this.map.painter.context;this.texture?!m&&!this._playing||this.texture instanceof r.aM||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new r.T(a,this.canvas,a.gl.RGBA8,{premultiply:!0}),this._prepareData(a)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends r.E{constructor(m,a,c,f){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=a,this.setEventedParent(f),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new r.z(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new r.z(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new jo(this._implementation.bounds,this.minzoom,this.maxzoom)),a.update=this._update.bind(this),a.clearTiles=this._clearTiles.bind(this),a.coveringTiles=this._coveringTiles.bind(this),r.l(this,r.aA(a,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return r.aA(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this.map=m,this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){let{x:a,y:c,z:f}=m.canonical;return this._implementation.hasTile({x:a,y:c,z:f})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,a){let{x:c,y:f,z:_}=m.tileID.canonical,b=new AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:c,y:f,z:_},{signal:b.signal})).then(function(w){return delete m.request,m.aborted?(m.state="unloaded",a(null)):w===void 0?(m.state="errored",a(null)):w===null?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",a(null)):function(I){return I instanceof ImageData||I instanceof HTMLCanvasElement||I instanceof ImageBitmap||I instanceof HTMLImageElement}(w)?(this.loadTileData(m,w),m.state="loaded",void a(null)):(m.state="errored",a(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch(w=>{w.name!=="AbortError"&&(m.state="errored",a(w))}),m.request.cancel=()=>b.abort()}loadTileData(m,a){m.setTexture(a,this.map.painter)}unloadTile(m,a){if(m.texture&&m.texture instanceof r.T?(m.destroy(!0),m.texture&&m.texture instanceof r.T&&this.map.painter.saveTileTexture(m.texture)):m.destroy(),this._implementation.unloadTile){let{x:c,y:f,z:_}=m.tileID.canonical;this._implementation.unloadTile({x:c,y:f,z:_})}a&&a()}abortTile(m,a){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),a&&a()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_clearTiles(){let m=r.C(this.id,this.scope);this.map.style.clearSource(m)}_update(){this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))}}},qm=function(m,a,c,f){let _=new Uy[a.type](m,a,c,f);if(_.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${_.id}`);return r.aQ(["load","abort","unload","serialize","prepare"],_),_};function Kp(m,a,c=""){return`${c}:${a.id||""}:${a.layer.id}:${function(f){if("layerId"in f)return`layer:${f.layerId}`;{let{featuresetId:_,importId:b}=f;return`featureset:${_}${b?`:import:${b}`:""}`}}(m.target)}`}function Xu(m,a,c,f=""){if(m.uniqueFeatureID){let _=Kp(m,a,f);if(c.has(_))return!0;c.add(_)}return!1}function Hy(m,a,c,f,_=!1){let b=a.sourceCache.transform,w=a.sourceCache.tilesIn(m,a.has3DLayers,_);w.sort($y);let I=[];for(let k of w){let O=k.tile.queryRenderedFeatures(a,k,c,f,b,_);Object.keys(O).length&&I.push({wrappedTileID:k.tile.tileID.wrapped().key,queryResults:O})}return I.length===0?{}:function(k){let O={},F={};for(let z of k){let V=z.queryResults,G=z.wrappedTileID,K=F[G]=F[G]||{};for(let W in V){let te=V[W],ne=K[W]=K[W]||{},he=O[W]=O[W]||[];for(let _e of te)ne[_e.featureIndex]||(ne[_e.featureIndex]=!0,he.push(_e))}}return O}(I)}function Zx(m,a,c,f,_){let b={},w=f.queryRenderedSymbols(m),I=[];for(let k of Object.keys(w).map(Number))I.push(_[k]);I.sort($y);for(let k of I){let O=k.featureIndex.lookupSymbolFeatures(w[k.bucketInstanceId],k.bucketIndex,k.sourceLayerIndex,a,c);for(let F in O){let z=b[F]=b[F]||[],V=O[F];V.sort((G,K)=>{let W=k.featureSortOrder;if(W){let te=W.indexOf(G.featureIndex);return W.indexOf(K.featureIndex)-te}return K.featureIndex-G.featureIndex});for(let G of V)z.push(G)}}return b}function Xx(m,a){let c=m.getRenderableIds().map(b=>m.getTileByID(b)),f=[],_={};for(let b=0;b<c.length;b++){let w=c[b],I=w.tileID.canonical.key;_[I]||(_[I]=!0,w.querySourceFeatures(f,a))}return f}function $y(m,a){let c=m.tileID,f=a.tileID;return c.overscaledZ-f.overscaledZ||c.canonical.y-f.canonical.y||c.wrap-f.wrap||c.canonical.x-f.canonical.x}function Ku(m,a){let c={};if(!a)return c;for(let f of m){let _=f.layerIds.map(b=>a.getLayer(b)).filter(Boolean);if(_.length!==0){f.layers=_,f.stateDependentLayerIds&&(f.stateDependentLayers=f.stateDependentLayerIds.map(b=>_.filter(w=>w.id===b)[0]));for(let b of _)c[b.fqid]=f}}return c}let ms=32,ul=33,rd=new Uint16Array(8184);for(let m=0;m<2046;m++){let a=m+2,c=0,f=0,_=0,b=0,w=0,I=0;for(1&a?_=b=w=ms:c=f=I=ms;(a>>=1)>1;){let O=c+_>>1,F=f+b>>1;1&a?(_=c,b=f,c=w,f=I):(c=_,f=b,_=w,b=I),w=O,I=F}let k=4*m;rd[k+0]=c,rd[k+1]=f,rd[k+2]=_,rd[k+3]=b}let gs=new Uint16Array(2178),Xa=new Uint8Array(1089),Qu=new Uint16Array(1089);function Gy(m){return m===0?-.03125:m===32?.03125:0}let Wm={type:2,extent:r.ai,loadGeometry:()=>[[new r.P(0,0),new r.P(r.ai+1,0),new r.P(r.ai+1,r.ai+1),new r.P(0,r.ai+1),new r.P(0,0)]]};class hl{constructor(a,c,f,_,b){this.tileID=a,this.uid=r.aW(),this.uses=0,this.tileSize=c,this.tileZoom=f,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=b,_&&_.style&&(this._lastUpdatedBrightness=_.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",_&&_.transform&&(this.projection=_.transform.projection)}registerFadeDuration(a){let c=a+this.timeAdded;c<r.q.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=r.aR(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(a,c,f){if(this.unloadVectorData(),this.state="loaded",a){a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=Ku(a.buckets,c.style),this.hasSymbolBuckets=!1;for(let _ in this.buckets){let b=this.buckets[_];if(b instanceof r.aY){if(this.hasSymbolBuckets=!0,!f)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let _ in this.buckets){let b=this.buckets[_];if(b instanceof r.aY&&b.hasRTLText){this.hasRTLText=!0,r.aZ();break}}this.queryPadding=0;for(let _ in this.buckets){let b=this.buckets[_],w=c.style.getOwnLayer(_);if(!w)continue;let I=w.queryRadius(b);this.queryPadding=Math.max(this.queryPadding,I)}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage),a.lineAtlas&&(this.lineAtlas=a.lineAtlas),this._lastUpdatedBrightness=a.brightness}else this.collisionBoxArray=new r.aX}unloadVectorData(){if(this.hasData()){for(let a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(a,c,f){a&&(a.resourceTiming&&(this.resourceTiming=a.resourceTiming),this.buckets=Object.assign({},this.buckets,Ku(a.buckets,c.style)),a.featureIndex&&(this.latestFeatureIndex=a.featureIndex))}getBucket(a){return this.buckets[a.fqid]}upload(a){for(let _ in this.buckets){let b=this.buckets[_];b.uploadPending()&&b.upload(a)}let c=a.gl,f=this.imageAtlas;f&&!f.uploaded&&(this.imageAtlasTexture=new r.T(a,f.image,c.RGBA8,{useMipmap:!!f.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new r.T(a,this.glyphAtlasImage,c.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new r.T(a,this.lineAtlas.image,c.R8),this.lineAtlas.uploaded=!0)}prepare(a,c,f){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture,f),!c||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;let _=c.style.getBrightness();(this._lastUpdatedBrightness||_)&&(this._lastUpdatedBrightness&&_&&Math.abs(this._lastUpdatedBrightness-_)<.001||(this.updateBuckets(c,this._lastUpdatedBrightness!==_),this._lastUpdatedBrightness=_))}queryRenderedFeatures(a,c,f,_,b,w){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};let I=function(k,O){let F=r.ad.mat4.fromScaling([],[.5*k.width,.5*-k.height,1]);return r.ad.mat4.translate(F,F,[1,-1,0]),r.ad.mat4.multiply(F,F,k.calculateProjMatrix(O.toUnwrapped())),Float32Array.from(F)}(b,this.tileID);return this.latestFeatureIndex.query(a,{tilespaceGeometry:c,pixelPosMatrix:I,transform:_,availableImages:f,tileTransform:this.tileTransform})}querySourceFeatures(a,c){let f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;let _=f.loadVTLayers(),b=c?c.sourceLayer:"",w=_._geojsonTileLayer||_[b];if(!w)return;let I=r.a_(c&&c.filter),{z:k,x:O,y:F}=this.tileID.canonical,z={z:k,x:O,y:F};for(let V=0;V<w.length;V++){let G=w.feature(V);if(I.needGeometry){let te=r.a$(G,!0);if(!I.filter(new r.aa(this.tileID.overscaledZ),te,this.tileID.canonical))continue}else if(!I.filter(new r.aa(this.tileID.overscaledZ),G))continue;let K=f.getId(G,b),W=new r.b0(G,k,O,F,K);W.tile=z,a.push(W)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(a){let c=this.expirationTime;if(a.cacheControl){let f=r.b1(a.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){let f=Date.now(),_=!1;if(this.expirationTime>f)_=!1;else if(c)if(this.expirationTime<c)_=!0;else{let b=this.expirationTime-c;b?this.expirationTime=f+Math.max(b,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(a){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&a&&this.updateBuckets(a)}updateBuckets(a,c){if(!this.latestFeatureIndex||!a.style)return;let f=this.latestFeatureIndex.loadVTLayers(),_=a.style.listImages(),b=a.style.getBrightness();for(let w in this.buckets){if(!a.style.hasLayer(w))continue;let I=this.buckets[w],k=I.layers[0],O=k.sourceLayer||"_geojsonTileLayer",F=f[O],z=a.style.getLayerSourceCache(k),V={};z&&(V=z._state.getState(O,void 0));let G=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},K=Object.keys(V).length>0&&!c;K&&!I.stateDependentLayers.length&&!c||I.update(V,F,_,G,K?I.stateDependentLayers:I.layers,c,b),(I instanceof r.b2||I instanceof r.b3)&&a._terrain&&a._terrain.enabled&&z&&I.uploadPending()&&a._terrain._clearRenderCacheForTile(z.id,this.tileID);let W=a&&a.style&&a.style.getOwnLayer(w);W&&(this.queryPadding=Math.max(this.queryPadding,W.queryRadius(I)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<r.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(a){this.symbolFadeHoldUntil=r.q.now()+a}setTexture(a,c){let f=c.context,_=f.gl;this.texture=this.texture||c.getTileTexture(a.width),this.texture&&this.texture instanceof r.T?this.texture.update(a):(this.texture=new r.T(f,a,_.RGBA8,{useMipmap:!0}),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE))}setDependencies(a,c){let f={};for(let _ of c)f[_]=!0;this.dependencies[a]=f}hasDependency(a,c){for(let f of a){let _=this.dependencies[f];if(_){for(let b of c)if(_[b])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(a,c){if(!c||c.name==="mercator"||this._tileDebugBuffer)return;let f=r.b4(Wm,this.tileID.canonical,this.tileTransform)[0],_=new r.b5,b=new r.b6;for(let w=0;w<f.length;w++){let{x:I,y:k}=f[w];_.emplaceBack(I,k),b.emplaceBack(w)}b.emplaceBack(0),this._tileDebugIndexBuffer=a.createIndexBuffer(b),this._tileDebugBuffer=a.createVertexBuffer(_,r.b7.members),this._tileDebugSegments=r.b8.simpleSegment(0,0,_.length,b.length)}_makeTileBoundsBuffers(a,c){if(this._tileBoundsBuffer||!c||c.name==="mercator")return;let f=r.b4(Wm,this.tileID.canonical,this.tileTransform)[0],_,b;if(this.isRaster){let w=function(I,k){let O=r.aR(I,k),F=Math.pow(2,I.z);for(let te=0;te<ul;te++)for(let ne=0;ne<ul;ne++){let he=r.aS((I.x+(ne+Gy(ne))/ms)/F),_e=r.aT((I.y+(te+Gy(te))/ms)/F),me=k.project(he,_e),Se=te*ul+ne;gs[2*Se+0]=Math.round((me.x*O.scale-O.x)*r.ai),gs[2*Se+1]=Math.round((me.y*O.scale-O.y)*r.ai)}Xa.fill(0),Qu.fill(0);for(let te=2045;te>=0;te--){let ne=4*te,he=rd[ne+0],_e=rd[ne+1],me=rd[ne+2],Se=rd[ne+3],ve=he+me>>1,be=_e+Se>>1,xe=ve+be-_e,Ae=be+he-ve,Oe=_e*ul+he,Ke=Se*ul+me,$e=be*ul+ve,ct=Math.hypot((gs[2*Oe+0]+gs[2*Ke+0])/2-gs[2*$e+0],(gs[2*Oe+1]+gs[2*Ke+1])/2-gs[2*$e+1])>=16;Xa[$e]=Xa[$e]||(ct?1:0),te<1022&&(Xa[$e]=Xa[$e]||Xa[(_e+Ae>>1)*ul+(he+xe>>1)]||Xa[(Se+Ae>>1)*ul+(me+xe>>1)])}let z=new r.aU,V=new r.aV,G=0;function K(te,ne){let he=ne*ul+te;return Qu[he]===0&&(z.emplaceBack(gs[2*he+0],gs[2*he+1],te*r.ai/ms,ne*r.ai/ms),Qu[he]=++G),Qu[he]-1}function W(te,ne,he,_e,me,Se){let ve=te+he>>1,be=ne+_e>>1;if(Math.abs(te-me)+Math.abs(ne-Se)>1&&Xa[be*ul+ve])W(me,Se,te,ne,ve,be),W(he,_e,me,Se,ve,be);else{let xe=K(te,ne),Ae=K(he,_e),Oe=K(me,Se);V.emplaceBack(xe,Ae,Oe)}}return W(0,0,ms,ms,ms,0),W(ms,ms,0,0,0,ms),{vertices:z,indices:V}}(this.tileID.canonical,c);_=w.vertices,b=w.indices}else{_=new r.aU,b=new r.aV;for(let{x:I,y:k}of f)_.emplaceBack(I,k,0,0);let w=r.b9(_.int16,void 0,4);for(let I=0;I<w.length;I+=3)b.emplaceBack(w[I],w[I+1],w[I+2])}this._tileBoundsBuffer=a.createVertexBuffer(_,r.ba.members),this._tileBoundsIndexBuffer=a.createIndexBuffer(b),this._tileBoundsSegments=r.b8.simpleSegment(0,0,_.length,b.length)}_makeGlobeTileDebugBuffers(a,c){let f=c.projection;if(!f||f.name!=="globe"||c.freezeTileCoverage)return;let _=this.tileID.canonical,b=r.bb(_,c),w=r.bc(b),I=r.ag(c.zoom),k;I>0&&(k=r.ad.mat4.invert(new Float64Array(16),c.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(a,_,c,w,k,I),this._makeGlobeTileDebugTextBuffer(a,_,c,w,k,I)}_globePoint(a,c,f,_,b,w,I){let k=r.bd(a,c,f);if(w){let O=1<<f.z,F=r.av(_.center.lng),z=r.aC(_.center.lat),V=(f.x+.5)/O-F,G=0;V>.5?G=-1:V<-.5&&(G=1);let K=(a/r.ai+f.x)/O+G,W=(c/r.ai+f.y)/O;K=(K-F)*_._pixelsPerMercatorPixel+F,W=(W-z)*_._pixelsPerMercatorPixel+z;let te=[K*_.worldSize,W*_.worldSize,0];r.ad.vec3.transformMat4(te,te,w),k=r.be(k,te,I)}return r.ad.vec3.transformMat4(k,k,b)}_makeGlobeTileDebugBorderBuffer(a,c,f,_,b,w){let I=new r.b5,k=new r.b6,O=new r.bf,F=(V,G,K,W,te)=>{let ne=(K-V)/(te-1),he=(W-G)/(te-1),_e=I.length;for(let me=0;me<te;me++){let Se=V+me*ne,ve=G+me*he;I.emplaceBack(Se,ve);let be=this._globePoint(Se,ve,c,f,_,b,w);O.emplaceBack(be[0],be[1],be[2]),k.emplaceBack(_e+me)}},z=r.ai;F(0,0,z,0,16),F(z,0,z,z,16),F(z,z,0,z,16),F(0,z,0,0,16),this._tileDebugIndexBuffer=a.createIndexBuffer(k),this._tileDebugBuffer=a.createVertexBuffer(I,r.b7.members),this._globeTileDebugBorderBuffer=a.createVertexBuffer(O,r.bg.members),this._tileDebugSegments=r.b8.simpleSegment(0,0,I.length,k.length)}_makeGlobeTileDebugTextBuffer(a,c,f,_,b,w){let I=r.ai/4,k=new r.b5,O=new r.aV,F=new r.bf,z=25;O.reserve(32),k.reserve(z),F.reserve(z);let V=(G,K)=>z*G+K;for(let G=0;G<z;G++){let K=G*I;for(let W=0;W<z;W++){let te=W*I;k.emplaceBack(te,K);let ne=this._globePoint(te,K,c,f,_,b,w);F.emplaceBack(ne[0],ne[1],ne[2])}}for(let G=0;G<4;G++)for(let K=0;K<4;K++){let W=V(G,K),te=V(G,K+1),ne=V(G+1,K),he=V(G+1,K+1);O.emplaceBack(W,te,ne),O.emplaceBack(ne,te,he)}this._tileDebugTextIndexBuffer=a.createIndexBuffer(O),this._tileDebugTextBuffer=a.createVertexBuffer(k,r.b7.members),this._globeTileDebugTextBuffer=a.createVertexBuffer(F,r.bg.members),this._tileDebugTextSegments=r.b8.simpleSegment(0,0,z,32)}destroy(a=!1){for(let c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!a&&this.texture&&this.texture instanceof r.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}r.bh.setPbf(r.bi);class ja extends hl{constructor(a,c,f,_,b){super(a,c,f,_,b),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(a){return this._mrt&&this._mrt.getLayer(a)}setTexture(a,c){let f=c.context,_=f.gl;this.texture=this.texture||c.getTileTexture(a.width),this.texture&&this.texture instanceof r.T?this.texture.update(a,{premultiply:!1}):this.texture=new r.T(f,a,_.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(a=16384,c){let f=this._mrt=new r.bh(30),_=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(a-1)}});return this.entireBuffer=null,this.request=r.bj(_,(b,w,I,k)=>{if(b)c(b);else try{let O=f.getHeaderLength(w);if(O>a)return void(this.request=this.fetchHeader(O,c));f.parseHeader(w),this._isHeaderLoaded=!0;let F=0;for(let z of Object.values(f.layers))F=Math.max(F,z.dataIndex[z.dataIndex.length-1].lastByte);w.byteLength>=F&&(this.entireBuffer=w),c(null,this.entireBuffer||w,I,k)}catch(O){c(O)}}),this.request}fetchBand(a,c,f){let _=this._mrt;if(!this._isHeaderLoaded||!_)return void f(new Error("Tile header is not ready"));let b=this.actor;if(!b)return void f(new Error("Can't fetch tile band without an actor"));let w,I=(z,V)=>{w.complete(z,V),z?f(z):(this.updateTextureDescriptor(a,c),f(null,this.textureDescriptor&&this.textureDescriptor.img))},k=(z,V)=>{if(z)return f(z);let G=b.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:V,task:w},I,void 0,!0);this._workQueue.push(()=>{G&&G.cancel(),w.cancel()})},O=_.getLayer(a);if(!O)return void f(new Error(`Unknown sourceLayer "${a}"`));if(O.hasDataForBand(c))return this.updateTextureDescriptor(a,c),void f(null,this.textureDescriptor?this.textureDescriptor.img:null);let F=O.getDataRange([c]);if(w=_.createDecodingTask(F),!w||w.tasks.length)if(this.flushQueues(),this.entireBuffer)k(null,this.entireBuffer.slice(F.firstByte,F.lastByte+1));else{let z=Object.assign({},this.requestParams,{headers:{Range:`bytes=${F.firstByte}-${F.lastByte}`}}),V=r.bj(z,k);this._fetchQueue.push(()=>{V.cancel(),w.cancel()})}else f(null)}updateNeeded(a,c){return(!this.textureDescriptor||this.textureDescriptor.band!==c||this.textureDescriptor.layer!==a)&&this.state!=="errored"}updateTextureDescriptor(a,c){if(!this._mrt)return;let f=this._mrt.getLayer(a);if(!f||!f.hasBand(c)||!f.hasDataForBand(c))return;let{bytes:_,tileSize:b,buffer:w,offset:I,scale:k}=f.getBandView(c),O=b+2*w,F=new r.r({width:O,height:O},_),z=this.texture;z&&z instanceof r.T&&z.update(F,{premultiply:!1}),this.textureDescriptor={layer:a,band:c,img:F,buffer:w,offset:I,tileSize:b,format:f.pixelFormat,mix:[k,256*k,65536*k,16777216*k]}}}class Kx{constructor(a,c){this.max=a,this.onRemove=c,this.reset()}reset(){for(let a in this.data)for(let c of this.data[a])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(a,c,f){let _=a.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);let b={value:c,timeout:void 0};if(f!==void 0&&(b.timeout=setTimeout(()=>{this.remove(a,b)},f)),this.data[_].push(b),this.order.push(_),this.order.length>this.max){let w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(a){return a.wrapped().key in this.data}getAndRemove(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null}_getAndRemoveByKey(a){let c=this.data[a].shift();return c.timeout&&clearTimeout(c.timeout),this.data[a].length===0&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),c.value}getByKey(a){let c=this.data[a];return c?c[0].value:null}get(a){return this.has(a)?this.data[a.wrapped().key][0].value:null}remove(a,c){if(!this.has(a))return this;let f=a.wrapped().key,_=c===void 0?0:this.data[f].indexOf(c),b=this.data[f][_];return this.data[f].splice(_,1),b.timeout&&clearTimeout(b.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(b.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(a){for(this.max=a;this.order.length>this.max;){let c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(a){let c=[];for(let f in this.data)for(let _ of this.data[f])a(_.value)||c.push(_);for(let f of c)this.remove(f.value.tileID,f)}}class qy{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(a,c,f){let _=String(c);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][_]=this.stateChanges[a][_]||{},r.l(this.stateChanges[a][_],f),this.deletedStates[a]===null){this.deletedStates[a]={};for(let b in this.state[a])b!==_&&(this.deletedStates[a][b]=null)}else if(this.deletedStates[a]&&this.deletedStates[a][_]===null){this.deletedStates[a][_]={};for(let b in this.state[a][_])f[b]||(this.deletedStates[a][_][b]=null)}else for(let b in f)this.deletedStates[a]&&this.deletedStates[a][_]&&this.deletedStates[a][_][b]===null&&delete this.deletedStates[a][_][b]}removeFeatureState(a,c,f){if(this.deletedStates[a]===null)return;let _=String(c);if(this.deletedStates[a]=this.deletedStates[a]||{},f&&c!==void 0)this.deletedStates[a][_]!==null&&(this.deletedStates[a][_]=this.deletedStates[a][_]||{},this.deletedStates[a][_][f]=null);else if(c!==void 0)if(this.stateChanges[a]&&this.stateChanges[a][_])for(f in this.deletedStates[a][_]={},this.stateChanges[a][_])this.deletedStates[a][_][f]=null;else this.deletedStates[a][_]=null;else this.deletedStates[a]=null}getState(a,c){let f=this.state[a]||{},_=this.stateChanges[a]||{},b=this.deletedStates[a];if(b===null)return{};if(c!==void 0){let I=String(c),k=r.l({},f[I],_[I]);if(b){let O=b[c];if(O===null)return{};for(let F in O)delete k[F]}return k}let w=r.l({},f,_);if(b)for(let I in b)delete w[I];return w}initializeTileState(a,c){a.refreshFeatureState(c)}coalesceChanges(a,c){let f={};for(let _ in this.stateChanges){this.state[_]=this.state[_]||{};let b={};for(let w in this.stateChanges[_])this.state[_][w]||(this.state[_][w]={}),r.l(this.state[_][w],this.stateChanges[_][w]),b[w]=this.state[_][w];f[_]=b}for(let _ in this.deletedStates){this.state[_]=this.state[_]||{};let b={};if(this.deletedStates[_]===null)for(let w in this.state[_])b[w]={},this.state[_][w]={};else for(let w in this.deletedStates[_]){if(this.deletedStates[_][w]===null)this.state[_][w]={};else if(this.state[_][w])for(let I of Object.keys(this.deletedStates[_][w]))delete this.state[_][w][I];b[w]=this.state[_][w]}f[_]=f[_]||{},r.l(f[_],b)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(let _ in a)a[_].refreshFeatureState(c)}}class Ns extends r.E{constructor(a,c,f){super(),this.id=a,this._onlySymbols=f,c.on("data",_=>{_.dataType==="source"&&_.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&_.dataType==="source"&&_.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),c.on("error",()=>{this._sourceErrored=!0}),this._source=c,this._tiles={},this._cache=new Kx(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=c.minTileCacheSize,this._maxTileCacheSize=c.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new qy,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(a){this.map=a,this._minTileCacheSize=this._minTileCacheSize===void 0&&a?a._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&a?a._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(let a in this._tiles)if(!this._tiles[a].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(a,c){return a.isSymbolTile=this._onlySymbols,a.isExtraShadowCaster=this._shadowCasterTiles[a.tileID.key],this._source.loadTile(a,c)}_unloadTile(a){if(this._source.unloadTile)return this._source.unloadTile(a)}_abortTile(a){if(this._source.abortTile)return this._source.abortTile(a)}serialize(){return this._source.serialize()}prepare(a){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let c in this._tiles){let f=this._tiles[c];f.upload(a),f.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(a=>a.tileID).sort(Ln).map(a=>a.key)}getRenderableIds(a,c){let f=[];for(let _ in this._tiles)this._isIdRenderable(+_,a,c)&&f.push(this._tiles[_]);return a?f.sort((_,b)=>{let w=_.tileID,I=b.tileID,k=new r.P(w.canonical.x,w.canonical.y)._rotate(this.transform.angle),O=new r.P(I.canonical.x,I.canonical.y)._rotate(this.transform.angle);return w.overscaledZ-I.overscaledZ||O.y-k.y||O.x-k.x}).map(_=>_.tileID.key):f.map(_=>_.tileID).sort(Ln).map(_=>_.key)}hasRenderableParent(a){let c=this.findLoadedParent(a,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(a,c,f){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(c||!this._tiles[a].holdingForFade())&&(f||!this._shadowCasterTiles[a])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(let a in this._tiles)this._tiles[a].state!=="errored"&&this._reloadTile(+a,"reloading")}}_reloadTile(a,c){let f=this._tiles[a];f&&(f.state!=="loading"&&(f.state=c),this._loadTile(f,this._tileLoaded.bind(this,f,a,c)))}_tileLoaded(a,c,f,_){if(_)if(a.state="errored",_.status!==404)this._source.fire(new r.z(_,{tile:a}));else{if(this._source.fire(new r.A("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:a})),!(a.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){let b=this.map.painter.terrain;this.update(this.transform,b.getScaledDemTileSize(),!0),b.resetTileLookupCache(this.id)}else this.update(this.transform)}else a.timeAdded=r.q.now(),f==="expired"&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(c,a),this._source.type==="raster-dem"&&a.dem&&this._backfillDEM(a),this._state.initializeTileState(a,this.map?this.map.painter:null),this._source.fire(new r.A("data",{dataType:"source",tile:a,coord:a.tileID,sourceCacheId:this.id}))}_backfillDEM(a){let c=this.getRenderableIds();for(let _=0;_<c.length;_++){let b=c[_];if(a.neighboringTiles&&a.neighboringTiles[b]){let w=this.getTileByID(b);f(a,w),f(w,a)}}function f(_,b){if(!_.dem||_.dem.borderReady)return;_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0;let w=b.tileID.canonical.x-_.tileID.canonical.x,I=b.tileID.canonical.y-_.tileID.canonical.y,k=Math.pow(2,_.tileID.canonical.z),O=b.tileID.key;w===0&&I===0||Math.abs(I)>1||(Math.abs(w)>1&&(Math.abs(w+k)===1?w+=k:Math.abs(w-k)===1&&(w-=k)),b.dem&&_.dem&&(_.dem.backfillBorder(b.dem,w,I),_.neighboringTiles&&_.neighboringTiles[O]&&(_.neighboringTiles[O].backfilled=!0)))}}getTile(a){return this.getTileByID(a.key)}getTileByID(a){return this._tiles[a]}_retainLoadedChildren(a,c,f,_){for(let b in this._tiles){let w=this._tiles[b];if(_[b]||!w.hasData()||w.tileID.overscaledZ<=c||w.tileID.overscaledZ>f)continue;let I=w.tileID;for(;w&&w.tileID.overscaledZ>c+1;){let O=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[O.key],w&&w.hasData()&&(I=O)}let k=I;for(;k.overscaledZ>c;)if(k=k.scaledTo(k.overscaledZ-1),a[k.key]){_[I.key]=I;break}}}findLoadedParent(a,c){if(a.key in this._loadedParentTiles){let f=this._loadedParentTiles[a.key];return f&&f.tileID.overscaledZ>=c?f:null}for(let f=a.overscaledZ-1;f>=c;f--){let _=a.scaledTo(f),b=this._getLoadedTile(_);if(b)return b}}_getLoadedTile(a){let c=this._tiles[a.key];return c&&c.hasData()?c:this._cache.getByKey(this._source.reparseOverscaled?a.wrapped().key:a.canonical.key)}updateCacheSize(a,c){c=c||this._source.tileSize;let f=Math.ceil(a.width/c)+1,_=Math.ceil(a.height/c)+1,b=Math.floor(f*_*5),w=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,b):b,I=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(I)}handleWrapJump(a){let c=Math.round((a-(this._prevLng===void 0?a:this._prevLng))/360);if(this._prevLng=a,c){let f={};for(let _ in this._tiles){let b=this._tiles[_];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+c),f[b.tileID.key]=b}this._tiles=f;for(let _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(let _ in this._tiles)this._setTileReloadTimer(+_,this._tiles[_])}}update(a,c,f,_){if(this.transform=a,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!f)return;this.updateCacheSize(a,c),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};let b=this._source.type==="batched-model",w,I=this._source.maxzoom,k=this.map&&this.map.painter?this.map.painter._terrain:null;if(k&&k.sourceCache===this&&k.attenuationRange()){let z=k.attenuationRange()[0],V=Math.floor(z)-Math.log2(k.getDemUpscale());I>V&&(I=V)}if(this.used||this.usedForTerrain){if(this._source.tileID)w=a.getVisibleUnwrappedCoordinates(this._source.tileID).map(z=>new r.aH(z.canonical.z,z.wrap,z.canonical.z,z.canonical.x,z.canonical.y));else if(this.tileCoverLift!==0){let z=a.clone();z.tileCoverLift=this.tileCoverLift,w=z.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:I,roundZoom:this._source.roundZoom&&!f,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:b}),this._source.minzoom<=1&&a.projection.name==="globe"&&(w.push(new r.aH(1,0,1,0,0)),w.push(new r.aH(1,0,1,1,0)),w.push(new r.aH(1,0,1,0,1)),w.push(new r.aH(1,0,1,1,1)))}else if(w=a.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:I,roundZoom:this._source.roundZoom&&!f,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:b}),this._source.hasTile){let z=this._source.hasTile.bind(this._source);w=w.filter(V=>z(V))}}else w=[];if(w.length>0&&this.castsShadows&&_&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Wy(this._source.type)){let z=a.coveringZoomLevel({tileSize:c||this._source.tileSize,roundZoom:this._source.roundZoom&&!f}),V=Math.min(z,this._source.maxzoom);if(b){let G=a.extendTileCover(w,V);for(let K of G)w.push(K)}else{let G=a.extendTileCover(w,V,_);for(let K of G)this._shadowCasterTiles[K.key]=!0,w.push(K)}}let O=this._updateRetainedTiles(w);if(Wy(this._source.type)&&w.length!==0){let z={},V={},G=Object.keys(O);for(let W of G){let te=O[W],ne=this._tiles[W];if(!ne||ne.fadeEndTime&&ne.fadeEndTime<=r.q.now())continue;let he=this.findLoadedParent(te,Math.max(te.overscaledZ-Ns.maxOverzooming,this._source.minzoom));he&&(this._addTile(he.tileID),z[he.tileID.key]=he.tileID),V[W]=te}let K=w[w.length-1].overscaledZ;for(let W in this._tiles){let te=this._tiles[W];if(O[W]||!te.hasData())continue;let ne=te.tileID;for(;ne.overscaledZ>K;){ne=ne.scaledTo(ne.overscaledZ-1);let he=this._tiles[ne.key];if(he&&he.hasData()&&V[ne.key]){O[W]=te.tileID;break}}}for(let W in z)O[W]||(this._coveredTiles[W]=!0,O[W]=z[W])}for(let z in O)this._tiles[z].clearFadeHold();let F=r.bk(this._tiles,O);for(let z of F){let V=this._tiles[z];V.hasSymbolBuckets&&!V.holdingForFade()?V.setHoldDuration(this.map._fadeDuration):V.hasSymbolBuckets&&!V.symbolFadeFinished()||this._removeTile(+z)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(let a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(+a)}_updateRetainedTiles(a){let c={};if(a.length===0)return c;let f={},_=a.reduce((O,F)=>Math.min(O,F.overscaledZ),1/0),b=a[0].overscaledZ,w=Math.max(b-Ns.maxOverzooming,this._source.minzoom),I=Math.max(b+Ns.maxUnderzooming,this._source.minzoom),k={};for(let O of a){let F=this._addTile(O);c[O.key]=O,F.hasData()||_<this._source.maxzoom&&(k[O.key]=O)}this._retainLoadedChildren(k,_,I,c);for(let O of a){let F=this._tiles[O.key];if(F.hasData())continue;if(O.canonical.z>=this._source.maxzoom){let V=O.children(this._source.maxzoom)[0],G=this.getTile(V);if(G&&G.hasData()){c[V.key]=V;continue}}else{let V=O.children(this._source.maxzoom);if(c[V[0].key]&&c[V[1].key]&&c[V[2].key]&&c[V[3].key])continue}let z=F.wasRequested();for(let V=O.overscaledZ-1;V>=w;--V){let G=O.scaledTo(V);if(f[G.key]||(f[G.key]=!0,F=this.getTile(G),!F&&z&&(F=this._addTile(G)),F&&(c[G.key]=G,z=F.wasRequested(),F.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let a in this._tiles){let c=[],f,_=this._tiles[a].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){f=this._loadedParentTiles[_.key];break}c.push(_.key);let b=_.scaledTo(_.overscaledZ-1);if(f=this._getLoadedTile(b),f)break;_=b}for(let b of c)this._loadedParentTiles[b]=f}}_addTile(a){let c=this._tiles[a.key];if(c)return c.isExtraShadowCaster!==!0||this._shadowCasterTiles[a.key]||this._reloadTile(a.key,"reloading"),c;c=this._cache.getAndRemove(a),c&&(this._setTileReloadTimer(a.key,c),c.tileID=a,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,c)));let f=!!c;if(!f){let _=this.map?this.map.painter:null,b=this._source.tileSize*a.overscaleFactor();c=this._source.type==="raster-array"?new ja(a,b,this.transform.tileZoom,_,this._isRaster):new hl(a,b,this.transform.tileZoom,_,this._isRaster),this._loadTile(c,this._tileLoaded.bind(this,c,a.key,c.state))}return c?(c.uses++,this._tiles[a.key]=c,f||this._source.fire(new r.A("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null}_setTileReloadTimer(a,c){a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);let f=c.getExpiryTimeout();f&&(this._timers[a]=setTimeout(()=>{this._reloadTile(a,"expired"),delete this._timers[a]},f))}_removeTile(a){let c=this._tiles[a];c&&(c.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),c.uses>0||(c.hasData()&&c.state!=="reloading"||c.state==="empty"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let a in this._tiles)this._removeTile(+a);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(a,c,f){let _=[],b=this.transform;if(!b)return _;let w=b.projection.name==="globe",I=r.av(b.center.lng);for(let k in this._tiles){let O=this._tiles[k];if(f&&O.clearQueryDebugViz(),O.holdingForFade())continue;let F;if(w){let z=O.tileID.canonical;if(z.z===0){let V=[Math.abs(r.ay(I,...yi(z,-1))-I),Math.abs(r.ay(I,...yi(z,1))-I)];F=[0,2*V.indexOf(Math.min(...V))-1]}else{let V=[Math.abs(r.ay(I,...yi(z,-1))-I),Math.abs(r.ay(I,...yi(z,0))-I),Math.abs(r.ay(I,...yi(z,1))-I)];F=[V.indexOf(Math.min(...V))-1]}}else F=[0];for(let z of F){let V=a.containsTile(O,b,c,z);V&&_.push(V)}}return _}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(a){return this._getRenderableCoordinates(a)}_getRenderableCoordinates(a,c){let f=this.getRenderableIds(a,c).map(b=>this._tiles[b].tileID),_=this.transform.projection.name==="globe";for(let b of f)b.projMatrix=this.transform.calculateProjMatrix(b.toUnwrapped()),b.expandedProjMatrix=_?this.transform.calculateProjMatrix(b.toUnwrapped(),!1,!0):b.projMatrix;return f}sortCoordinatesByDistance(a){let c=a.slice(),f=this.transform._camera.position,_=this.transform._camera.forward(),b={};for(let w of c){let I=1/(1<<w.canonical.z);b[w.key]=((w.canonical.x+.5)*I+w.wrap-f[0])*_[0]+((w.canonical.y+.5)*I-f[1])*_[1]-f[2]*_[2]}return c.sort((w,I)=>b[w.key]-b[I.key]),c}hasTransition(){if(this._source.hasTransition())return!0;if(Wy(this._source.type))for(let a in this._tiles){let c=this._tiles[a];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=r.q.now())return!0}return!1}setFeatureState(a,c,f){this._state.updateState(a=a||"_geojsonTileLayer",c,f)}removeFeatureState(a,c,f){this._state.removeFeatureState(a=a||"_geojsonTileLayer",c,f)}getFeatureState(a,c){return this._state.getState(a=a||"_geojsonTileLayer",c)}setDependencies(a,c,f){let _=this._tiles[a];_&&_.setDependencies(c,f)}reloadTilesForDependencies(a,c){for(let f in this._tiles)this._tiles[f].hasDependency(a,c)&&this._reloadTile(+f,"reloading");this._cache.filter(f=>!f.hasDependency(a,c))}_preloadTiles(a,c){if(!this._sourceLoaded){let k=()=>{this._sourceLoaded&&(this._source.off("data",k),this._preloadTiles(a,c))};return void this._source.on("data",k)}let f=new Map,_=Array.isArray(a)?a:[a],b=this.map.painter.terrain,w=this.usedForTerrain&&b?b.getScaledDemTileSize():this._source.tileSize;for(let k of _){let O=k.coveringTiles({tileSize:w,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(let F of O)f.set(F.key,F);this.usedForTerrain&&k.updateElevation(!1)}let I=Array.from(f.values());r.bl(I,(k,O)=>{let F=new hl(k,this._source.tileSize*k.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(F,z=>{this._source.type==="raster-dem"&&F.dem&&this._backfillDEM(F),O(z,F)})},c)}}function Ln(m,a){let c=Math.abs(2*m.wrap)-+(m.wrap<0),f=Math.abs(2*a.wrap)-+(a.wrap<0);return m.overscaledZ-a.overscaledZ||f-c||a.canonical.y-m.canonical.y||a.canonical.x-m.canonical.x}function Wy(m){return m==="raster"||m==="image"||m==="video"||m==="custom"}function yi(m,a){let c=1<<m.z;return[m.x/c+a,(m.x+1)/c+a]}Ns.maxOverzooming=10,Ns.maxUnderzooming=3;class Qx{constructor(a){this.style=a,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];let a=!1,c=!1;for(let f in this.style._mergedLayers){let _=this.style._mergedLayers[f];if(_.type==="fill-extrusion")this.layers.push({layer:_,visible:a,visibilityChanged:c});else if(_.type==="model"){let b=this.style.getLayerSource(_);b&&b.type==="batched-model"&&this.layers.push({layer:_,visible:a,visibilityChanged:c})}}}onNewFrame(a){this.layersGotHidden=!1;for(let c of this.layers){let f=c.layer,_=!1;f.type==="fill-extrusion"?_=!f.isHidden(a)&&f.paint.get("fill-extrusion-opacity")>0:f.type==="model"&&(_=!f.isHidden(a)&&f.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!_&&c.visible,c.visible=_}}updateZOffset(a,c){this.currentBuildingBuckets=[];for(let _ of this.layers){let b=_.layer,w=this.style.getLayerSourceCache(b),I=1;b.type==="fill-extrusion"&&(I=_.visible?b.paint.get("fill-extrusion-vertical-scale"):0);let k=w?w.getTile(c):null;if(!k&&w&&c.canonical.z>w.getSource().minzoom){let O=c.scaledTo(Math.min(w.getSource().maxzoom,c.overscaledZ-1));for(;O.overscaledZ>=w.getSource().minzoom&&(k=w.getTile(O),!k&&O.overscaledZ!==0);)O=O.scaledTo(O.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:k?k.getBucket(b):null,tileID:k?k.tileID:c,verticalScale:I})}a.hasAnyZOffset=!1;let f=!1;for(let _=0;_<a.symbolInstances.length;_++){let b=a.symbolInstances.get(_),w=b.zOffset,I=this._getHeightAtTileOffset(c,b.tileAnchorX,b.tileAnchorY);b.zOffset=I!==Number.NEGATIVE_INFINITY?I:w,f||w===b.zOffset||(f=!0),a.hasAnyZOffset||b.zOffset===0||(a.hasAnyZOffset=!0)}f&&(a.zOffsetBuffersNeedUpload=!0,a.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(a,c,f,_){let b=c,w=f;if(a.canonical.z!==_.canonical.z){let I=_.canonical,k=1/(1<<a.canonical.z-I.z);b=(c+a.canonical.x*r.ai)*k-I.x*r.ai|0,w=(f+a.canonical.y*r.ai)*k-I.y*r.ai|0}return{tileX:b,tileY:w}}_getHeightAtTileOffset(a,c,f){let _,b;for(let w=0;w<this.layers.length;++w){if(this.layers[w].layer.type!=="fill-extrusion")continue;let{bucket:I,tileID:k,verticalScale:O}=this.currentBuildingBuckets[w];if(!I)continue;let{tileX:F,tileY:z}=this._mapCoordToOverlappingTile(a,c,f,k),V=I.getHeightAtTileCoord(F,z);V&&V.height!==void 0&&(V.hidden?_=V.height:b=Math.max(V.height*O,b||0))}if(b!==void 0)return b;for(let w=0;w<this.layers.length;++w){let I=this.layers[w];if(I.layer.type!=="model"||!I.visible)continue;let{bucket:k,tileID:O}=this.currentBuildingBuckets[w];if(!k)continue;let{tileX:F,tileY:z}=this._mapCoordToOverlappingTile(a,c,f,O),V=k.getHeightAtTileCoord(F,z);if(V&&!V.hidden)return V.height===void 0&&_!==void 0?Math.min(V.maxHeight,_)*V.verticalScale:V.height?V.height*V.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Jx(m,a){let c={};for(let f in m)f!=="ref"&&(c[f]=m[f]);return r.bm.forEach(f=>{f in a&&(c[f]=a[f])}),c}function Qp(m){m=m.slice();let a=Object.create(null);for(let c=0;c<m.length;c++)a[m[c].id]=m[c];for(let c=0;c<m.length;c++)"ref"in m[c]&&(m[c]=Jx(m[c],a[m[c].ref]));return m}let wn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function zs(m,a,c){c.push({command:wn.addSource,args:[m,a[m]]})}function Ym(m,a,c){a.push({command:wn.removeSource,args:[m]}),c[m]=!0}function Ju(m,a,c,f){Ym(m,c,f),zs(m,a,c)}function ii(m,a,c){let f;for(f in m[c])if(m[c].hasOwnProperty(f)&&f!=="data"&&!r.bn(m[c][f],a[c][f]))return!1;for(f in a[c])if(a[c].hasOwnProperty(f)&&f!=="data"&&!r.bn(m[c][f],a[c][f]))return!1;return!0}function Rn(m,a,c,f,_,b){let w;for(w in a=a||{},m=m||{})m.hasOwnProperty(w)&&(r.bn(m[w],a[w])||c.push({command:b,args:[f,w,a[w],_]}));for(w in a)a.hasOwnProperty(w)&&!m.hasOwnProperty(w)&&(r.bn(m[w],a[w])||c.push({command:b,args:[f,w,a[w],_]}))}function gn(m){return m.id}function ya(m,a){return m[a.id]=a,m}class eh{constructor(a,c){this.reset(a,c)}reset(a,c){this.points=a||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(a){if(this.points.length===1)return this.points[0];a=r.ay(a,0,1);let c=1,f=this._distances[c],_=a*this.paddedLength+this.padding;for(;f<_&&c<this._distances.length;)f=this._distances[++c];let b=c-1,w=this._distances[b],I=f-w,k=I>0?(_-w)/I:0;return this.points[b].mult(1-k).add(this.points[c].mult(k))}}class Cn{constructor(a,c,f){let _=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(a/f),this.yCellCount=Math.ceil(c/f);for(let w=0;w<this.xCellCount*this.yCellCount;w++)_.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=c,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(a,c,f,_,b){this._forEachCell(c,f,_,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(_),this.bboxes.push(b)}insertCircle(a,c,f,_){this._forEachCell(c-_,f-_,c+_,f+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(c),this.circles.push(f),this.circles.push(_)}_insertBoxCell(a,c,f,_,b,w){this.boxCells[b].push(w)}_insertCircleCell(a,c,f,_,b,w){this.circleCells[b].push(w)}_query(a,c,f,_,b,w){if(f<0||a>this.width||_<0||c>this.height)return!b&&[];let I=[];if(a<=0&&c<=0&&this.width<=f&&this.height<=_){if(b)return!0;for(let k=0;k<this.boxKeys.length;k++)I.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){let O=this.circles[3*k],F=this.circles[3*k+1],z=this.circles[3*k+2];I.push({key:this.circleKeys[k],x1:O-z,y1:F-z,x2:O+z,y2:F+z})}return w?I.filter(w):I}return this._forEachCell(a,c,f,_,this._queryCell,I,{hitTest:b,seenUids:{box:{},circle:{}}},w),b?I.length>0:I}_queryCircle(a,c,f,_,b){let w=a-f,I=a+f,k=c-f,O=c+f;if(I<0||w>this.width||O<0||k>this.height)return!_&&[];let F=[];return this._forEachCell(w,k,I,O,this._queryCellCircle,F,{hitTest:_,circle:{x:a,y:c,radius:f},seenUids:{box:{},circle:{}}},b),_?F.length>0:F}query(a,c,f,_,b){return this._query(a,c,f,_,!1,b)}hitTest(a,c,f,_,b){return this._query(a,c,f,_,!0,b)}hitTestCircle(a,c,f,_){return this._queryCircle(a,c,f,!0,_)}_queryCell(a,c,f,_,b,w,I,k){let O=I.seenUids,F=this.boxCells[b];if(F!==null){let V=this.bboxes;for(let G of F)if(!O.box[G]){O.box[G]=!0;let K=4*G;if(a<=V[K+2]&&c<=V[K+3]&&f>=V[K+0]&&_>=V[K+1]&&(!k||k(this.boxKeys[G]))){if(I.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[G],x1:V[K],y1:V[K+1],x2:V[K+2],y2:V[K+3]})}}}let z=this.circleCells[b];if(z!==null){let V=this.circles;for(let G of z)if(!O.circle[G]){O.circle[G]=!0;let K=3*G;if(this._circleAndRectCollide(V[K],V[K+1],V[K+2],a,c,f,_)&&(!k||k(this.circleKeys[G]))){if(I.hitTest)return w.push(!0),!0;{let W=V[K],te=V[K+1],ne=V[K+2];w.push({key:this.circleKeys[G],x1:W-ne,y1:te-ne,x2:W+ne,y2:te+ne})}}}}}_queryCellCircle(a,c,f,_,b,w,I,k){let O=I.circle,F=I.seenUids,z=this.boxCells[b];if(z!==null){let G=this.bboxes;for(let K of z)if(!F.box[K]){F.box[K]=!0;let W=4*K;if(this._circleAndRectCollide(O.x,O.y,O.radius,G[W+0],G[W+1],G[W+2],G[W+3])&&(!k||k(this.boxKeys[K])))return w.push(!0),!0}}let V=this.circleCells[b];if(V!==null){let G=this.circles;for(let K of V)if(!F.circle[K]){F.circle[K]=!0;let W=3*K;if(this._circlesCollide(G[W],G[W+1],G[W+2],O.x,O.y,O.radius)&&(!k||k(this.circleKeys[K])))return w.push(!0),!0}}}_forEachCell(a,c,f,_,b,w,I,k){let O=this._convertToXCellCoord(a),F=this._convertToYCellCoord(c),z=this._convertToXCellCoord(f),V=this._convertToYCellCoord(_);for(let G=O;G<=z;G++)for(let K=F;K<=V;K++)if(b.call(this,a,c,f,_,this.xCellCount*K+G,w,I,k))return}_convertToXCellCoord(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))}_convertToYCellCoord(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))}_circlesCollide(a,c,f,_,b,w){let I=_-a,k=b-c,O=f+w;return O*O>I*I+k*k}_circleAndRectCollide(a,c,f,_,b,w,I){let k=(w-_)/2,O=Math.abs(a-(_+k));if(O>k+f)return!1;let F=(I-b)/2,z=Math.abs(c-(b+F));if(z>F+f)return!1;if(O<=k||z<=F)return!0;let V=O-k,G=z-F;return V*V+G*G<=f*f}}let uc={unknown:0,flipRequired:1,flipNotRequired:2},Jp=Math.tan(85*Math.PI/180);function hc(m,a,c,f,_,b,w){let I=r.ad.mat4.create();if(c)if(b.name==="globe"){let k=r.bo(_,a);r.ad.mat4.multiply(I,I,k)}else{let k=r.ad.mat2.invert([],w);I[0]=k[0],I[1]=k[1],I[4]=k[2],I[5]=k[3],f||r.ad.mat4.rotateZ(I,I,_.angle)}else r.ad.mat4.multiply(I,_.labelPlaneMatrix,m);return I}function Qo(m,a,c,f,_,b,w){let I=hc(m,a,c,f,_,b,w);return b.name==="globe"&&c||(I[2]=I[6]=I[10]=I[14]=0),I}function Lr(m,a,c,f,_,b,w){if(c){if(b.name==="globe"){let I=hc(m,a,c,f,_,b,w);return r.ad.mat4.invert(I,I),r.ad.mat4.multiply(I,m,I),I}{let I=r.ad.mat4.clone(m),k=r.ad.mat4.identity([]);return k[0]=w[0],k[1]=w[1],k[4]=w[2],k[5]=w[3],r.ad.mat4.multiply(I,I,k),f||r.ad.mat4.rotateZ(I,I,-_.angle),I}}return _.glCoordMatrix}function pl(m,a,c,f){let _=[m,a,c,1];c?r.ad.vec4.transformMat4(_,_,f):oo(_,_,f);let b=_[3];return _[0]/=b,_[1]/=b,_[2]/=b,_}function th(m,a){return Math.min(.5+m/a*.5,1.5)}function Yy(m,a){let c=m[0]/m[3],f=m[1]/m[3];return c>=-a[0]&&c<=a[0]&&f>=-a[1]&&f<=a[1]}function ih(m,a,c,f,_,b,w,I,k,O){let F=c.transform,z=f?m.textSizeData:m.iconSizeData,V=r.bp(z,c.transform.zoom),G=F.projection.name==="globe",K=[256/c.width*2+1,256/c.height*2+1],W=f?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;W.clear();let te=null;G&&(te=f?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);let ne=m.lineVertexArray,he=f?m.text.placedSymbolArray:m.icon.placedSymbolArray,_e=c.transform.width/c.transform.height,me,Se=!1;for(let ve=0;ve<he.length;ve++){let be=he.get(ve),{numGlyphs:xe,writingMode:Ae}=be;if(Ae!==r.bq.vertical||Se||me===r.bq.horizontal||(Se=!0),me=Ae,(be.hidden||Ae===r.bq.vertical)&&!Se){fl(xe,W);continue}Se=!1;let Oe=new r.P(be.tileAnchorX,be.tileAnchorY),{x:Ke,y:$e,z:ct}=F.projection.projectTilePoint(Oe.x,Oe.y,O.canonical);if(k){let[zt,Vt,ei]=k(Oe);Ke+=zt,$e+=Vt,ct+=ei}let ut=[Ke,$e,ct,1];if(r.ad.vec4.transformMat4(ut,ut,a),!Yy(ut,K)){fl(xe,W);continue}let St=ut[3],He=th(c.transform.getCameraToCenterDistance(F.projection),St),st=r.br(z,V,be),je=w?st/He:st*He,at=pl(Ke,$e,ct,_);if(at[3]<=0){fl(xe,W);continue}let rt={},ht=r.ak(m.layers[0].layout.get("text-max-angle")),Qe=Math.cos(ht),mt=w?null:k,Nt=va(be,je,!1,I,a,_,b,m.glyphOffsetArray,ne,W,te,at,Oe,rt,_e,mt,F.projection,O,w,Qe);Se=Nt.useVertical,mt&&Nt.needsFlipping&&(rt={}),(Nt.notEnoughRoom||Se||Nt.needsFlipping&&va(be,je,!0,I,a,_,b,m.glyphOffsetArray,ne,W,te,at,Oe,rt,_e,mt,F.projection,O,w,Qe).notEnoughRoom)&&fl(xe,W)}f?(m.text.dynamicLayoutVertexBuffer.updateData(W),te&&m.text.globeExtVertexBuffer&&m.text.globeExtVertexBuffer.updateData(te)):(m.icon.dynamicLayoutVertexBuffer.updateData(W),te&&m.icon.globeExtVertexBuffer&&m.icon.globeExtVertexBuffer.updateData(te))}function Zm(m,a,c,f,_,b,w,I,k,O,F,z,V,G,K,W,te){let{lineStartIndex:ne,glyphStartIndex:he,segment:_e}=I,me=he+I.numGlyphs,Se=ne+I.lineLength,ve=a.getoffsetX(he),be=a.getoffsetX(me-1),xe=tf(m*ve,c,f,_,b,w,_e,ne,Se,k,O,F,z,V,!0,G,K,W,te);if(!xe)return null;let Ae=tf(m*be,c,f,_,b,w,_e,ne,Se,k,O,F,z,V,!0,G,K,W,te);return Ae?{first:xe,last:Ae}:null}function ef(m,a,c,f){return m===r.bq.horizontal&&Math.abs(f)>Math.abs(c)?{useVertical:!0}:m===r.bq.vertical?f>0?{needsFlipping:!0}:null:a!==uc.unknown&&function(_,b){return _===0||Math.abs(b/_)>Jp}(c,f)?a===uc.flipRequired?{needsFlipping:!0}:null:c<0?{needsFlipping:!0}:null}function va(m,a,c,f,_,b,w,I,k,O,F,z,V,G,K,W,te,ne,he,_e){let me=a/24,Se=m.lineOffsetX*me,ve=m.lineOffsetY*me,{lineStartIndex:be,glyphStartIndex:xe,numGlyphs:Ae,segment:Oe,writingMode:Ke,flipState:$e}=m,ct=be+m.lineLength,ut=St=>{if(F){let[at,rt,ht]=St.up,Qe=O.length;r.bs(F,Qe+0,at,rt,ht),r.bs(F,Qe+1,at,rt,ht),r.bs(F,Qe+2,at,rt,ht),r.bs(F,Qe+3,at,rt,ht)}let[He,st,je]=St.point;r.bt(O,He,st,je,St.angle)};if(Ae>1){let St=Zm(me,I,Se,ve,c,z,V,m,k,b,G,W,!1,te,ne,he,_e);if(!St)return{notEnoughRoom:!0};if(f&&!c){let[He,st,je]=St.first.point,[at,rt,ht]=St.last.point;[He,st]=pl(He,st,je,w),[at,rt]=pl(at,rt,ht,w);let Qe=ef(Ke,$e,(at-He)*K,rt-st);if(m.flipState=Qe&&Qe.needsFlipping?uc.flipRequired:uc.flipNotRequired,Qe)return Qe}ut(St.first);for(let He=xe+1;He<xe+Ae-1;He++){let st=tf(me*I.getoffsetX(He),Se,ve,c,z,V,Oe,be,ct,k,b,G,W,!1,!1,te,ne,he,_e);if(!st)return O.length-=4*(He-xe),{notEnoughRoom:!0};ut(st)}ut(St.last)}else{if(f&&!c){let He=pl(V.x,V.y,0,_),st=be+Oe+1,je=new r.P(k.getx(st),k.gety(st)),at=pl(je.x,je.y,0,_),rt=at[3]>0?at:ba(V,je,He,1,_,void 0,te,ne.canonical),ht=ef(Ke,$e,(rt[0]-He[0])*K,rt[1]-He[1]);if(m.flipState=ht&&ht.needsFlipping?uc.flipRequired:uc.flipNotRequired,ht)return ht}let St=tf(me*I.getoffsetX(xe),Se,ve,c,z,V,Oe,be,ct,k,b,G,W,!1,!1,te,ne,he,_e);if(!St)return{notEnoughRoom:!0};ut(St)}return{}}function Pl(m,a,c,f,_){let{x:b,y:w,z:I}=f.projectTilePoint(m.x,m.y,a);if(!_)return pl(b,w,I,c);let[k,O,F]=_(m);return pl(b+k,w+O,I+F,c)}function ba(m,a,c,f,_,b,w,I){let k=Pl(m.sub(a)._unit()._add(m),I,_,w,b);return r.ad.vec3.sub(k,c,k),r.ad.vec3.normalize(k,k),r.ad.vec3.scaleAndAdd(k,c,k,f)}function tf(m,a,c,f,_,b,w,I,k,O,F,z,V,G,K,W,te,ne,he){let _e=f?m-a:m+a,me=_e>0?1:-1,Se=0;f&&(me*=-1,Se=Math.PI),me<0&&(Se+=Math.PI);let ve=I+w+(me>0?0:1)|0,be=_,xe=_,Ae=0,Oe=0,Ke=Math.abs(_e),$e=[],ct=[],ut=b,St=ut,He=r.ad.vec3.zero([]),st=()=>ba(St,ut,xe,Ke-Ae+1,F,V,W,te.canonical);for(;Ae+Oe<=Ke;){if(ve+=me,ve<I||ve>=k)return null;if(xe=be,St=ut,$e.push(xe),G&&ct.push(St),ut=new r.P(O.getx(ve),O.gety(ve)),be=z[ve],!be){let ei=Pl(ut,te.canonical,F,W,V);be=ei[3]>0?z[ve]=ei:st()}Ae+=Oe;let zt=r.ad.vec3.sub([],be,xe),Vt=r.ad.vec3.distance(xe,be);if(c&&Vt>0&&Oe>0&&r.ad.vec3.dot(He,zt)/(Oe*Vt)<he)return null;Oe=Vt,He=zt}K&&V&&(z[ve]&&(be=st(),Oe=r.ad.vec3.distance(xe,be),He=r.ad.vec3.sub([],be,xe)),z[ve]=be);let je=(Ke-Ae)/Oe,at=ut.sub(St)._mult(je)._add(St),rt=r.ad.vec3.scaleAndAdd([],xe,He,je),ht=[0,0,1],Qe=He[0],mt=He[1];if(ne&&(ht=W.upVector(te.canonical,at.x,at.y),ht[0]!==0||ht[1]!==0||ht[2]!==1)){let zt=[ht[2],0,-ht[0]],Vt=r.ad.vec3.cross([],ht,zt);r.ad.vec3.normalize(zt,zt),r.ad.vec3.normalize(Vt,Vt),Qe=r.ad.vec3.dot(He,zt),mt=r.ad.vec3.dot(He,Vt)}if(c){let zt=r.ad.vec3.cross([],ht,He);r.ad.vec3.normalize(zt,zt),r.ad.vec3.scaleAndAdd(rt,rt,zt,c*me)}let Nt=Se+Math.atan2(mt,Qe);return $e.push(rt),G&&ct.push(at),{point:rt,angle:Nt,path:$e,tilePath:ct,up:ht}}function fl(m,a){let c=a.length,f=c+4*m;a.resize(f),a.float32.fill(-1/0,4*c,4*f)}function oo(m,a,c){let f=a[0],_=a[1];return m[0]=c[0]*f+c[4]*_+c[12],m[1]=c[1]*f+c[5]*_+c[13],m[3]=c[3]*f+c[7]*_+c[15],m}let ko=100;class pc{constructor(a,c,f=new Cn(a.width+200,a.height+200,25),_=new Cn(a.width+200,a.height+200,25)){this.transform=a,this.grid=f,this.ignoredGrid=_,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+ko,this.screenBottomBoundary=a.height+ko,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200,this.fogState=c}placeCollisionBox(a,c,f,_,b,w,I,k){let O=f.projectedAnchorX,F=f.projectedAnchorY,z=f.projectedAnchorZ,V=f.elevation,G=f.tileID,K=a.getProjection();if(V&&G){let[ve,be,xe]=K.upVector(G.canonical,f.tileAnchorX,f.tileAnchorY),Ae=K.upVectorScale(G.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;O+=ve*V*Ae,F+=be*V*Ae,z+=xe*V*Ae}let W=this.projectAndGetPerspectiveRatio(I,O,F,z,f.tileID,K.name==="globe"||!!V||this.transform.pitch>0,K),te=w*W.perspectiveRatio,ne=(f.x1*c+_.x-f.padding)*te+W.point.x,he=(f.y1*c+_.y-f.padding)*te+W.point.y,_e=(f.x2*c+_.x+f.padding)*te+W.point.x,me=(f.y2*c+_.y+f.padding)*te+W.point.y,Se=W.perspectiveRatio<=.55||W.occluded;return!this.isInsideGrid(ne,he,_e,me)||!b&&this.grid.hitTest(ne,he,_e,me,k)||Se?{box:[],offscreen:!1,occluded:W.occluded}:{box:[ne,he,_e,me],offscreen:this.isOffscreen(ne,he,_e,me),occluded:!1}}placeCollisionCircles(a,c,f,_,b,w,I,k,O,F,z,V,G,K,W){let te=[],ne=this.transform.elevation,he=a.getProjection(),_e=ne?ne.getAtTileOffsetFunc(W,this.transform.center.lat,this.transform.worldSize,he):null,me=new r.P(f.tileAnchorX,f.tileAnchorY),{x:Se,y:ve,z:be}=he.projectTilePoint(me.x,me.y,W.canonical);if(_e){let[ht,Qe,mt]=_e(me);Se+=ht,ve+=Qe,be+=mt}let xe=he.name==="globe",Ae=this.projectAndGetPerspectiveRatio(I,Se,ve,be,W,xe||!!ne||this.transform.pitch>0,he),{perspectiveRatio:Oe}=Ae,Ke=(z?w/Oe:w*Oe)/r.bw,$e=pl(Se,ve,be,k),ct=f.lineOffsetX*Ke,ut=f.lineOffsetY*Ke,St=r.ak(a.layers[0].layout.get("text-max-angle")),He=Math.cos(St),st=Ae.signedDistanceFromCamera>0?Zm(Ke,b,ct,ut,!1,$e,me,f,_,k,{},ne&&!z?_e:null,z&&!!ne,he,W,z,He):null,je=!1,at=!1,rt=!0;if(st&&!Ae.occluded){let ht=.5*G*Oe+K,Qe=new r.P(-100,-100),mt=new r.P(this.screenRightBoundary,this.screenBottomBoundary),Nt=new eh,{first:zt,last:Vt}=st,ei=zt.path.length,Ri=[];for(let vi=ei-1;vi>=1;vi--)Ri.push(zt.path[vi]);for(let vi=1;vi<Vt.path.length;vi++)Ri.push(Vt.path[vi]);let gi=2.5*ht;O&&(Ri=Ri.map(([vi,on,Dn],ar)=>(_e&&!xe&&(Dn=_e(ar<ei-1?zt.tilePath[ei-1-ar]:Vt.tilePath[ar-ei+2])[2]),pl(vi,on,Dn,O))),Ri.some(vi=>vi[3]<=0)&&(Ri=[]));let Si=[];if(Ri.length>0){let vi=1/0,on=-1/0,Dn=1/0,ar=-1/0;for(let Zi of Ri)vi=Math.min(vi,Zi[0]),Dn=Math.min(Dn,Zi[1]),on=Math.max(on,Zi[0]),ar=Math.max(ar,Zi[1]);on>=Qe.x&&vi<=mt.x&&ar>=Qe.y&&Dn<=mt.y&&(Si=[Ri.map(Zi=>new r.P(Zi[0],Zi[1]))],(vi<Qe.x||on>mt.x||Dn<Qe.y||ar>mt.y)&&(Si=r.bu(Si,Qe.x,Qe.y,mt.x,mt.y)))}for(let vi of Si){Nt.reset(vi,.25*ht);let on=0;on=Nt.length<=.5*ht?1:Math.ceil(Nt.paddedLength/gi)+1;for(let Dn=0;Dn<on;Dn++){let ar=Dn/Math.max(on-1,1),Zi=Nt.lerp(ar),yr=Zi.x+ko,Fi=Zi.y+ko;te.push(yr,Fi,ht,0);let ti=yr-ht,ln=Fi-ht,Nn=yr+ht,_n=Fi+ht;if(rt=rt&&this.isOffscreen(ti,ln,Nn,_n),at=at||this.isInsideGrid(ti,ln,Nn,_n),!c&&this.grid.hitTestCircle(yr,Fi,ht,V)&&(je=!0,!F))return{circles:[],offscreen:!1,collisionDetected:je,occluded:!1}}}}return{circles:!F&&je||!at?[]:te,offscreen:rt,collisionDetected:je,occluded:Ae.occluded}}queryRenderedSymbols(a){if(a.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let c=[],f=1/0,_=1/0,b=-1/0,w=-1/0;for(let F of a){let z=new r.P(F.x+ko,F.y+ko);f=Math.min(f,z.x),_=Math.min(_,z.y),b=Math.max(b,z.x),w=Math.max(w,z.y),c.push(z)}let I=this.grid.query(f,_,b,w).concat(this.ignoredGrid.query(f,_,b,w)),k={},O={};for(let F of I){let z=F.key;if(k[z.bucketInstanceId]===void 0&&(k[z.bucketInstanceId]={}),k[z.bucketInstanceId][z.featureIndex])continue;let V=[new r.P(F.x1,F.y1),new r.P(F.x2,F.y1),new r.P(F.x2,F.y2),new r.P(F.x1,F.y2)];r.bv(c,V)&&(k[z.bucketInstanceId][z.featureIndex]=!0,O[z.bucketInstanceId]===void 0&&(O[z.bucketInstanceId]=[]),O[z.bucketInstanceId].push(z.featureIndex))}return O}insertCollisionBox(a,c,f,_,b){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:_,collisionGroupID:b},a[0],a[1],a[2],a[3])}insertCollisionCircles(a,c,f,_,b){let w=c?this.ignoredGrid:this.grid,I={bucketInstanceId:f,featureIndex:_,collisionGroupID:b};for(let k=0;k<a.length;k+=4)w.insertCircle(I,a[k],a[k+1],a[k+2])}projectAndGetPerspectiveRatio(a,c,f,_,b,w,I){let k=[c,f,_,1],O=!1;_||this.transform.pitch>0?(r.ad.vec4.transformMat4(k,k,a),this.fogState&&b&&I.name!=="globe"&&(O=function(V,G,K,W,te,ne){let he=ne.calculateFogTileMatrix(te),_e=[G,K,W];return r.ad.vec3.transformMat4(_e,_e,he),Zt(V,r.ad.vec3.length(_e),ne.pitch,ne._fov)}(this.fogState,c,f,_,b.toUnwrapped(),this.transform)>.9)):oo(k,k,a);let F=k[3];return{point:new r.P((k[0]/F+1)/2*this.transform.width+ko,(-k[1]/F+1)/2*this.transform.height+ko),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(I)/F*.5,1.5),signedDistanceFromCamera:F,occluded:w&&k[2]>F||O}}isOffscreen(a,c,f,_){return f<ko||a>=this.screenRightBoundary||_<ko||c>this.screenBottomBoundary}isInsideGrid(a,c,f,_){return f>=0&&a<this.gridRightBoundary&&_>=0&&c<this.gridBottomBoundary}getViewportMatrix(){let a=r.ad.mat4.identity([]);return r.ad.mat4.translate(a,a,[-100,-100,0]),a}}function Hr(m,a,c){let f=a.createTileMatrix(m,m.worldSize,c.toUnwrapped());return r.ad.mat4.multiply(new Float32Array(16),m.projMatrix,f)}function Zy(m,a,c){if(a.projection.name===c.projection.name)return m.projMatrix;let f=c.clone();return f.setProjection(a.projection),Hr(f,a.getProjection(),m)}function _s(m,a,c){return a.name===c.projection.name?m.projMatrix:Hr(c,a,m)}class nh{constructor(a,c,f,_){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?c:-c))):_&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class od{constructor(a,c,f,_,b,w=!1){this.text=new nh(a?a.text:null,c,f,b),this.icon=new nh(a?a.icon:null,c,_,b),this.clipped=w}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class fc{constructor(a,c,f,_=!1){this.text=a,this.icon=c,this.skipFade=f,this.clipped=_}}class yM{constructor(){this.invProjMatrix=r.ad.mat4.create(),this.viewportMatrix=r.ad.mat4.create(),this.circles=[]}}class mc{constructor(a,c,f,_,b){this.bucketInstanceId=a,this.featureIndex=c,this.sourceLayerIndex=f,this.bucketIndex=_,this.tileID=b}}class vM{constructor(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}}get(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){let c=++this.maxGroupID;this.collisionGroups[a]={ID:c,predicate:f=>f.collisionGroupID===c}}return this.collisionGroups[a]}}function Xm(m,a,c,f,_){let{horizontalAlign:b,verticalAlign:w}=r.bD(m),I=-(b-.5)*a,k=-(w-.5)*c,O=r.bC(m,f);return new r.P(I+O[0]*_,k+O[1]*_)}function La(m,a,c,f,_){let b=new r.P(m,a);return c&&b._rotate(f?_:-_),b}class bM{constructor(a,c,f,_,b,w){this.transform=a.clone(),this.projection=a.projection.name,this.collisionIndex=new pc(this.transform,b),this.buildingIndex=w,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new vM(f),this.collisionCircleArrays={},this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(a,c,f,_,b=1){let w=f.getBucket(c),I=f.latestFeatureIndex;if(!w||!I||c.fqid!==w.layerIds[0])return;let k=w.layers[0].layout,O=w.layers[0].paint,F=f.collisionBoxArray,z=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),V=f.tileSize/r.ai,G=f.tileID.toUnwrapped();this.transform.setProjection(w.projection);let K=(W=f.tileID,te=w.getProjection(),ne=this.transform,te.name===this.projection?ne.calculateProjMatrix(W.toUnwrapped()):Hr(ne,te,W));var W,te,ne;let he=k.get("text-pitch-alignment")==="map",_e=k.get("text-rotation-alignment")==="map";c.compileFilter(c.options);let me=c.dynamicFilter(),Se=c.dynamicFilterNeedsFeature(),ve=this.transform.calculatePixelsToTileUnitsMatrix(f),be=Qo(K,f.tileID.canonical,he,_e,this.transform,w.getProjection(),ve),xe=null;if(he){let st=Lr(K,f.tileID.canonical,he,_e,this.transform,w.getProjection(),ve);xe=r.ad.mat4.multiply([],this.transform.labelPlaneMatrix,st)}let Ae=null;me&&f.latestFeatureIndex&&(Ae={unwrappedTileID:G,dynamicFilter:me,dynamicFilterNeedsFeature:Se}),this.retainedQueryData[w.bucketInstanceId]=new mc(w.bucketInstanceId,I,w.sourceLayerIndex,w.index,f.tileID);let[Oe,Ke]=w.layers[0].layout.get("text-size-scale-range"),$e=r.ay(b,Oe,Ke),[ct,ut]=k.get("icon-size-scale-range"),St=r.ay(b,ct,ut),He={bucket:w,layout:k,paint:O,posMatrix:K,textLabelPlaneMatrix:be,labelToScreenMatrix:xe,clippingData:Ae,scale:z,textPixelRatio:V,holdingForFade:f.holdingForFade(),collisionBoxArray:F,partiallyEvaluatedTextSize:r.bp(w.textSizeData,this.transform.zoom,$e),partiallyEvaluatedIconSize:r.bp(w.iconSizeData,this.transform.zoom,St),collisionGroup:this.collisionGroups.get(w.sourceID),latestFeatureIndex:f.latestFeatureIndex};if(_)for(let st of w.sortKeyRanges){let{sortKey:je,symbolInstanceStart:at,symbolInstanceEnd:rt}=st;a.push({sortKey:je,symbolInstanceStart:at,symbolInstanceEnd:rt,parameters:He})}else a.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:He})}attemptAnchorPlacement(a,c,f,_,b,w,I,k,O,F,z,V,G,K,W,te,ne,he){let{textOffset0:_e,textOffset1:me,crossTileID:Se}=V,ve=[_e,me],be=Xm(a,f,_,ve,b),xe=this.collisionIndex.placeCollisionBox(K,b,c,La(be.x,be.y,w,I,this.transform.angle),z,k,O,F.predicate);if(te){let Ae=K.getSymbolInstanceIconSize(he,this.transform.zoom,V.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(K,Ae,te,La(be.x,be.y,w,I,this.transform.angle),z,k,O,F.predicate).box.length===0)return}if(xe.box.length>0){let Ae;return this.prevPlacement&&this.prevPlacement.variableOffsets[Se]&&this.prevPlacement.placements[Se]&&this.prevPlacement.placements[Se].text&&(Ae=this.prevPlacement.variableOffsets[Se].anchor),this.variableOffsets[Se]={textOffset:ve,width:f,height:_,anchor:a,textScale:b,prevAnchor:Ae},this.markUsedJustification(K,a,V,W),K.allowVerticalPlacement&&(this.markUsedOrientation(K,W,V),this.placedOrientations[Se]=W),{shift:be,placedGlyphBoxes:xe}}}placeLayerBucketPart(a,c,f,_,b=1){let{bucket:w,layout:I,paint:k,posMatrix:O,textLabelPlaneMatrix:F,labelToScreenMatrix:z,clippingData:V,textPixelRatio:G,holdingForFade:K,collisionBoxArray:W,partiallyEvaluatedTextSize:te,partiallyEvaluatedIconSize:ne,collisionGroup:he,latestFeatureIndex:_e}=a.parameters,me=I.get("text-optional"),Se=I.get("icon-optional"),ve=I.get("text-allow-overlap"),be=I.get("icon-allow-overlap"),xe=I.get("text-rotation-alignment")==="map",Ae=I.get("text-pitch-alignment")==="map",Oe=k.get("symbol-z-offset"),Ke=I.get("symbol-elevation-reference")==="sea",[$e,ct]=I.get("text-size-scale-range"),[ut,St]=I.get("icon-size-scale-range"),He=r.ay(b,$e,ct),st=r.ay(b,ut,St);this.transform.setProjection(w.projection);let je=ve&&(be||!w.hasIconData()||Se),at=be&&(ve||!w.hasTextData()||me),rt=!Oe.isConstant();!w.collisionArrays&&W&&w.deserializeCollisionBoxes(W),f&&_&&w.updateCollisionDebugBuffers(this.transform.zoom,W,He,st);let ht=(Qe,mt,Nt)=>{let{crossTileID:zt,numVerticalGlyphVertices:Vt}=Qe,ei=null;if(V&&V.dynamicFilterNeedsFeature||rt){let hn=this.retainedQueryData[w.bucketInstanceId];ei=_e.loadFeature({featureIndex:Qe.featureIndex,bucketIndex:hn.bucketIndex,sourceLayerIndex:hn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(V&&!(0,V.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},ei,this.retainedQueryData[w.bucketInstanceId].tileID.canonical,new r.P(Qe.tileAnchorX,Qe.tileAnchorY),this.transform.calculateDistanceTileData(V.unwrappedTileID)))return this.placements[zt]=new fc(!1,!1,!1,!0),void c.add(zt);let Ri=Oe.evaluate(ei,{});if(c.has(zt))return;if(K)return void(this.placements[zt]=new fc(!1,!1,!1));let gi=!1,Si=!1,vi=!0,on=!1,Dn=!1,ar=null,Zi={box:null,offscreen:null,occluded:null},yr={box:null,offscreen:null,occluded:null},Fi=null,ti=null,ln=null,Nn=0,_n=0,Ar=0;Nt.textFeatureIndex?Nn=Nt.textFeatureIndex:Qe.useRuntimeCollisionCircles&&(Nn=Qe.featureIndex),Nt.verticalTextFeatureIndex&&(_n=Nt.verticalTextFeatureIndex);let Kr=hn=>{hn.tileID=this.retainedQueryData[w.bucketInstanceId].tileID;let vr=this.transform.elevation;hn.elevation=Ke?Ri:Ri+(vr?vr.getAtTileOffset(hn.tileID,hn.tileAnchorX,hn.tileAnchorY):0),hn.elevation+=Qe.zOffset},po=Nt.textBox;if(po){Kr(po);let hn=Mn=>{let Qn=r.bq.horizontal;if(w.allowVerticalPlacement&&!Mn&&this.prevPlacement){let $o=this.prevPlacement.placedOrientations[zt];$o&&(this.placedOrientations[zt]=$o,Qn=$o,this.markUsedOrientation(w,Qn,Qe))}return Qn},vr=(Mn,Qn)=>{if(w.allowVerticalPlacement&&Vt>0&&Nt.verticalTextBox){for(let $o of w.writingModes)if($o===r.bq.vertical?(Zi=Qn(),yr=Zi):Zi=Mn(),Zi&&Zi.box&&Zi.box.length)break}else Zi=Mn()};if(I.get("text-variable-anchor")){let Mn=I.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[zt]){let hr=this.prevPlacement.variableOffsets[zt];Mn.indexOf(hr.anchor)>0&&(Mn=Mn.filter(fo=>fo!==hr.anchor),Mn.unshift(hr.anchor))}let Qn=(hr,fo,Nl)=>{let ts=w.getSymbolInstanceTextSize(te,Qe,this.transform.zoom,mt),Hs=(hr.x2-hr.x1)*ts+2*hr.padding,Ha=(hr.y2-hr.y1)*ts+2*hr.padding,$s=Qe.hasIconTextFit&&!be?fo:null;$s&&Kr($s);let is={box:[],offscreen:!1,occluded:!1},Sc=ve?2*Mn.length:Mn.length;for(let zl=0;zl<Sc;++zl){let Dc=this.attemptAnchorPlacement(Mn[zl%Mn.length],hr,Hs,Ha,ts,xe,Ae,G,O,he,zl>=Mn.length,Qe,mt,w,Nl,$s,te,ne);if(Dc&&(is=Dc.placedGlyphBoxes,is&&is.box&&is.box.length)){gi=!0,ar=Dc.shift;break}}return is};vr(()=>Qn(po,Nt.iconBox,r.bq.horizontal),()=>{let hr=Nt.verticalTextBox;return hr&&Kr(hr),w.allowVerticalPlacement&&!(Zi&&Zi.box&&Zi.box.length)&&Vt>0&&hr?Qn(hr,Nt.verticalIconBox,r.bq.vertical):{box:null,offscreen:null,occluded:null}}),Zi&&(gi=Zi.box,vi=Zi.offscreen,on=Zi.occluded);let $o=hn(!(!Zi||!Zi.box));if(!gi&&this.prevPlacement){let hr=this.prevPlacement.variableOffsets[zt];hr&&(this.variableOffsets[zt]=hr,this.markUsedJustification(w,hr.anchor,Qe,$o))}}else{let Mn=(Qn,$o)=>{let hr=w.getSymbolInstanceTextSize(te,Qe,this.transform.zoom,mt,b),fo=this.collisionIndex.placeCollisionBox(w,hr,Qn,new r.P(0,0),ve,G,O,he.predicate);return fo&&fo.box&&fo.box.length&&(this.markUsedOrientation(w,$o,Qe),this.placedOrientations[zt]=$o),fo};vr(()=>Mn(po,r.bq.horizontal),()=>{let Qn=Nt.verticalTextBox;return w.allowVerticalPlacement&&Vt>0&&Qn?(Kr(Qn),Mn(Qn,r.bq.vertical)):{box:null,offscreen:null,occluded:null}}),hn(!!(Zi&&Zi.box&&Zi.box.length))}}if(Fi=Zi,gi=Fi&&Fi.box&&Fi.box.length>0,vi=Fi&&Fi.offscreen,on=Fi&&Fi.occluded,Qe.useRuntimeCollisionCircles){let hn=w.text.placedSymbolArray.get(Qe.centerJustifiedTextSymbolIndex>=0?Qe.centerJustifiedTextSymbolIndex:Qe.verticalPlacedTextSymbolIndex),vr=r.br(w.textSizeData,te,hn),Mn=I.get("text-padding");ti=this.collisionIndex.placeCollisionCircles(w,ve,hn,w.lineVertexArray,w.glyphOffsetArray,vr,O,F,z,f,Ae,he.predicate,Qe.collisionCircleDiameter*vr/r.bw,Mn,this.retainedQueryData[w.bucketInstanceId].tileID),gi=ve||ti.circles.length>0&&!ti.collisionDetected,vi=vi&&ti.offscreen,on=ti.occluded}if(Nt.iconFeatureIndex&&(Ar=Nt.iconFeatureIndex),Nt.iconBox){let hn=vr=>{Kr(vr);let Mn=Qe.hasIconTextFit&&ar?La(ar.x,ar.y,xe,Ae,this.transform.angle):new r.P(0,0),Qn=w.getSymbolInstanceIconSize(ne,this.transform.zoom,Qe.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(w,Qn,vr,Mn,be,G,O,he.predicate)};yr&&yr.box&&yr.box.length&&Nt.verticalIconBox?(ln=hn(Nt.verticalIconBox),Si=ln.box.length>0):(ln=hn(Nt.iconBox),Si=ln.box.length>0),vi=vi&&ln.offscreen,Dn=ln.occluded}let Co=me||Qe.numHorizontalGlyphVertices===0&&Vt===0,ws=Se||Qe.numIconVertices===0;if(Co||ws?ws?Co||(Si=Si&&gi):gi=Si&&gi:Si=gi=Si&&gi,gi&&Fi&&Fi.box&&this.collisionIndex.insertCollisionBox(Fi.box,I.get("text-ignore-placement"),w.bucketInstanceId,yr&&yr.box&&_n?_n:Nn,he.ID),Si&&ln&&this.collisionIndex.insertCollisionBox(ln.box,I.get("icon-ignore-placement"),w.bucketInstanceId,Ar,he.ID),ti&&(gi&&this.collisionIndex.insertCollisionCircles(ti.circles,I.get("text-ignore-placement"),w.bucketInstanceId,Nn,he.ID),f)){let hn=w.bucketInstanceId,vr=this.collisionCircleArrays[hn];vr===void 0&&(vr=this.collisionCircleArrays[hn]=new yM);for(let Mn=0;Mn<ti.circles.length;Mn+=4)vr.circles.push(ti.circles[Mn+0]),vr.circles.push(ti.circles[Mn+1]),vr.circles.push(ti.circles[Mn+2]),vr.circles.push(ti.collisionDetected?1:0)}let xa=w.projection.name!=="globe";je=je&&(xa||!on),at=at&&(xa||!Dn),this.placements[zt]=new fc(gi||je,Si||at,vi||w.justReloaded),c.add(zt)};if(w.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(w,this.retainedQueryData[w.bucketInstanceId].tileID),w.elevationType==="road"&&w.updateRoadElevation(),w.updateZOffset(),w.sortFeaturesByY){let Qe=w.getSortedSymbolIndexes(this.transform.angle);for(let mt=Qe.length-1;mt>=0;--mt){let Nt=Qe[mt];ht(w.symbolInstances.get(Nt),Nt,w.collisionArrays[Nt])}w.hasAnyZOffset&&r.w(`${w.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(w.hasAnyZOffset){let Qe=w.getSortedIndexesByZOffset();for(let mt=0;mt<Qe.length;++mt){let Nt=Qe[mt];ht(w.symbolInstances.get(Nt),Nt,w.collisionArrays[Nt])}}else for(let Qe=a.symbolInstanceStart;Qe<a.symbolInstanceEnd;Qe++)ht(w.symbolInstances.get(Qe),Qe,w.collisionArrays[Qe]);if(f&&w.bucketInstanceId in this.collisionCircleArrays){let Qe=this.collisionCircleArrays[w.bucketInstanceId];r.ad.mat4.invert(Qe.invProjMatrix,O),Qe.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1}markUsedJustification(a,c,f,_){let{leftJustifiedTextSymbolIndex:b,centerJustifiedTextSymbolIndex:w,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:k,crossTileID:O}=f,F=r.bB(c),z=_===r.bq.vertical?k:F==="left"?b:F==="center"?w:F==="right"?I:-1;b>=0&&(a.text.placedSymbolArray.get(b).crossTileID=z>=0&&b!==z?0:O),w>=0&&(a.text.placedSymbolArray.get(w).crossTileID=z>=0&&w!==z?0:O),I>=0&&(a.text.placedSymbolArray.get(I).crossTileID=z>=0&&I!==z?0:O),k>=0&&(a.text.placedSymbolArray.get(k).crossTileID=z>=0&&k!==z?0:O)}markUsedOrientation(a,c,f){let _=c===r.bq.horizontal||c===r.bq.horizontalOnly?c:0,b=c===r.bq.vertical?c:0,{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:k,verticalPlacedTextSymbolIndex:O}=f,F=a.text.placedSymbolArray;w>=0&&(F.get(w).placedOrientation=_),I>=0&&(F.get(I).placedOrientation=_),k>=0&&(F.get(k).placedOrientation=_),O>=0&&(F.get(O).placedOrientation=b)}commit(a){this.commitTime=a,this.zoomAtLastRecencyCheck=this.transform.zoom;let c=this.prevPlacement,f=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;let _=c?c.symbolFadeChange(a):1,b=c?c.opacities:{},w=c?c.variableOffsets:{},I=c?c.placedOrientations:{};for(let k in this.placements){let O=this.placements[k],F=b[k];F?(this.opacities[k]=new od(F,_,O.text,O.icon,null,O.clipped),f=f||O.text!==F.text.placed||O.icon!==F.icon.placed):(this.opacities[k]=new od(null,_,O.text,O.icon,O.skipFade,O.clipped),f=f||O.text||O.icon)}for(let k in b){let O=b[k];if(!this.opacities[k]){let F=new od(O,_,!1,!1);F.isHidden()||(this.opacities[k]=F,f=f||O.text.placed||O.icon.placed)}}for(let k in w)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=w[k]);for(let k in I)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=I[k]);f?this.lastPlacementChangeTime=a:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:a)}updateLayerOpacities(a,c,f,_){let b=new Set;for(let w of c){let I=w.getBucket(a);I&&w.latestFeatureIndex&&a.fqid===I.layerIds[0]&&(this.updateBucketOpacities(I,b,w,w.collisionBoxArray,f,_,w.tileID,a.scope),I.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(I,w.tileID),I.elevationType==="road"&&I.updateRoadElevation(),I.updateZOffset())}}updateBucketOpacities(a,c,f,_,b,w,I,k){a.hasTextData()&&a.text.opacityVertexArray.clear(),a.hasIconData()&&a.icon.opacityVertexArray.clear(),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexArray.clear(),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexArray.clear();let O=a.layers[0].layout,F=a.layers[0].paint,z=!!a.layers[0].dynamicFilter(),V=new od(null,0,!1,!1,!0),G=O.get("text-allow-overlap"),K=O.get("icon-allow-overlap"),W=O.get("text-variable-anchor"),te=O.get("text-rotation-alignment")==="map",ne=O.get("text-pitch-alignment")==="map",he=F.get("symbol-z-offset"),_e=O.get("symbol-elevation-reference")==="sea",me=!he.isConstant(),Se=new od(null,0,G&&(K||!a.hasIconData()||O.get("icon-optional")),K&&(G||!a.hasTextData()||O.get("text-optional")),!0);!a.collisionArrays&&_&&(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData())&&a.deserializeCollisionBoxes(_);let ve=(xe,Ae,Oe)=>{for(let Ke=0;Ke<Ae/4;Ke++)xe.opacityVertexArray.emplaceBack(Oe)},be=0;w&&a.updateReplacement(I,w);for(let xe=0;xe<a.symbolInstances.length;xe++){let Ae=a.symbolInstances.get(xe),{numHorizontalGlyphVertices:Oe,numVerticalGlyphVertices:Ke,crossTileID:$e,numIconVertices:ct,tileAnchorX:ut,tileAnchorY:St}=Ae,He=null,st=this.retainedQueryData[a.bucketInstanceId];me&&Ae&&st&&(He=f.latestFeatureIndex.loadFeature({featureIndex:Ae.featureIndex,bucketIndex:st.bucketIndex,sourceLayerIndex:st.sourceLayerIndex,layoutVertexArrayOffset:0}));let je=he.evaluate(He,{}),at=c.has($e),rt=this.opacities[$e];at?rt=V:rt||(rt=Se,this.opacities[$e]=rt),c.add($e);let ht=Oe>0||Ke>0,Qe=ct>0,mt=this.placedOrientations[$e],Nt=mt===r.bq.vertical,zt=mt===r.bq.horizontal||mt===r.bq.horizontalOnly;!ht&&!Qe||rt.isHidden()||be++;let Vt=!1;if((ht||Qe)&&w)for(let ei of a.activeReplacements){if(r.bx(ei,b,r.by.Symbol,k)||ei.min.x>ut||ut>ei.max.x||ei.min.y>St||St>ei.max.y)continue;let Ri=r.bz(ut,St,I.canonical,ei.footprintTileId.canonical);if(Vt=r.bA(Ri,ei.footprint),Vt)break}if(ht){let ei=Vt?tu:eu(rt.text);ve(a.text,Oe,Nt?tu:ei),ve(a.text,Ke,zt?tu:ei);let Ri=rt.text.isHidden(),{leftJustifiedTextSymbolIndex:gi,centerJustifiedTextSymbolIndex:Si,rightJustifiedTextSymbolIndex:vi,verticalPlacedTextSymbolIndex:on}=Ae,Dn=a.text.placedSymbolArray,ar=Ri||Nt?1:0;gi>=0&&(Dn.get(gi).hidden=ar),Si>=0&&(Dn.get(Si).hidden=ar),vi>=0&&(Dn.get(vi).hidden=ar),on>=0&&(Dn.get(on).hidden=Ri||zt?1:0);let Zi=this.variableOffsets[$e];Zi&&this.markUsedJustification(a,Zi.anchor,Ae,mt);let yr=this.placedOrientations[$e];yr&&(this.markUsedJustification(a,"left",Ae,yr),this.markUsedOrientation(a,yr,Ae))}if(Qe){let ei=Vt?tu:eu(rt.icon),{placedIconSymbolIndex:Ri,verticalPlacedIconSymbolIndex:gi}=Ae,Si=a.icon.placedSymbolArray,vi=rt.icon.isHidden()?1:0;Ri>=0&&(ve(a.icon,ct,Nt?tu:ei),Si.get(Ri).hidden=vi),gi>=0&&(ve(a.icon,Ae.numVerticalIconVertices,zt?tu:ei),Si.get(gi).hidden=vi)}if(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData()){let ei=a.collisionArrays[xe];if(ei){let Ri=new r.P(0,0),gi=!0;if(ei.textBox||ei.verticalTextBox){if(W){let vi=this.variableOffsets[$e];vi?(Ri=Xm(vi.anchor,vi.width,vi.height,vi.textOffset,vi.textScale),te&&Ri._rotate(ne?this.transform.angle:-this.transform.angle)):gi=!1}z&&(gi=!rt.clipped),ei.textBox&&Jd(a.textCollisionBox.collisionVertexArray,rt.text.placed,!gi||Nt,je,_e,Ri.x,Ri.y),ei.verticalTextBox&&Jd(a.textCollisionBox.collisionVertexArray,rt.text.placed,!gi||zt,je,_e,Ri.x,Ri.y)}let Si=gi&&!!(!zt&&ei.verticalIconBox);ei.iconBox&&Jd(a.iconCollisionBox.collisionVertexArray,rt.icon.placed,Si,je,_e,Ae.hasIconTextFit?Ri.x:0,Ae.hasIconTextFit?Ri.y:0),ei.verticalIconBox&&Jd(a.iconCollisionBox.collisionVertexArray,rt.icon.placed,!Si,je,_e,Ae.hasIconTextFit?Ri.x:0,Ae.hasIconTextFit?Ri.y:0)}}}if(a.fullyClipped=be===0,a.sortFeatures(this.transform.angle),this.retainedQueryData[a.bucketInstanceId]&&(this.retainedQueryData[a.bucketInstanceId].featureSortOrder=a.featureSortOrder),a.hasTextData()&&a.text.opacityVertexBuffer&&a.text.opacityVertexBuffer.updateData(a.text.opacityVertexArray),a.hasIconData()&&a.icon.opacityVertexBuffer&&a.icon.opacityVertexBuffer.updateData(a.icon.opacityVertexArray),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexBuffer&&a.iconCollisionBox.collisionVertexBuffer.updateData(a.iconCollisionBox.collisionVertexArray),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexBuffer&&a.textCollisionBox.collisionVertexBuffer.updateData(a.textCollisionBox.collisionVertexArray),a.bucketInstanceId in this.collisionCircleArrays){let xe=this.collisionCircleArrays[a.bucketInstanceId];a.placementInvProjMatrix=xe.invProjMatrix,a.placementViewportMatrix=xe.viewportMatrix,a.collisionCircleArray=xe.circles,delete this.collisionCircleArrays[a.bucketInstanceId]}}symbolFadeChange(a){return this.fadeDuration===0?1:(a-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(a){return Math.max(0,(this.transform.zoom-a)/1.5)}hasTransitions(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(a,c){let f=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*f>a}setStale(){this.stale=!0}}function Jd(m,a,c,f,_,b,w){m.emplaceBack(a?1:0,c?1:0,b||0,w||0,f,_?1:0),m.emplaceBack(a?1:0,c?1:0,b||0,w||0,f,_?1:0),m.emplaceBack(a?1:0,c?1:0,b||0,w||0,f,_?1:0),m.emplaceBack(a?1:0,c?1:0,b||0,w||0,f,_?1:0)}let ew=Math.pow(2,25),nf=Math.pow(2,24),xM=Math.pow(2,17),wM=Math.pow(2,16),rf=Math.pow(2,9),of=Math.pow(2,8),CM=Math.pow(2,1);function eu(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;let a=m.placed?1:0,c=Math.floor(127*m.opacity);return c*ew+a*nf+c*xM+a*wM+c*rf+a*of+c*CM+a}let tu=0;class Km{constructor(a){this._sortAcrossTiles=a.layout.get("symbol-z-order")!=="viewport-y"&&a.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(a,c,f,_,b,w){let I=this._bucketParts;for(;this._currentTileIndex<a.length;)if(c.getBucketParts(I,_,a[this._currentTileIndex],this._sortAcrossTiles,w),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,I.sort((k,O)=>k.sortKey-O.sortKey));this._currentPartIndex<I.length;){let k=I[this._currentPartIndex];if(c.placeLayerBucketPart(k,this._seenCrossTileIDs,f,k.symbolInstanceStart===0,w),this._currentPartIndex++,b())return!0}return!1}}class ad{constructor(a,c,f,_,b,w,I,k,O){this.placement=new bM(a,b,w,I,k,O),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(a,c,f,_,b){let w=r.q.now(),I=()=>{let k=r.q.now()-w;return!this._forceFullPlacement&&k>2};for(;this._currentPlacementIndex>=0;){let k=c[a[this._currentPlacementIndex]],O=this.placement.collisionIndex.transform.zoom;if(k.type==="symbol"&&(!k.minzoom||k.minzoom<=O)&&(!k.maxzoom||k.maxzoom>O)){let F=k,z=F.layout.get("symbol-z-elevate"),V=F.layout.get("symbol-sort-key").constantOr(1)!==void 0,G=F.layout.get("symbol-z-order"),K=G==="viewport-y"||G==="auto"&&!(G!=="viewport-y"&&V),W=F.layout.get("text-allow-overlap")||F.layout.get("icon-allow-overlap")||F.layout.get("text-ignore-placement")||F.layout.get("icon-ignore-placement"),te=K&&W,ne=this._inProgressLayer=this._inProgressLayer||new Km(F),he=r.C(k.source,k.scope);if(ne.continuePlacement(z||te?_[he]:f[he],this.placement,this._showCollisionBoxes,k,I,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(a){return this.placement.commit(a),this.placement}}let Xy=512/r.ai/2;class EM{constructor(a,c,f){this.tileID=a,this.bucketInstanceId=f,this.index=new r.bE(c.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];let _=a.canonical.x*r.ai,b=a.canonical.y*r.ai;for(let w=0;w<c.length;w++){let{key:I,crossTileID:k,tileAnchorX:O,tileAnchorY:F}=c.get(w),z=Math.floor((_+O)*Xy),V=Math.floor((b+F)*Xy);this.index.add(z,V),this.keys.push(I),this.crossTileIDs.push(k)}this.index.finish()}findMatches(a,c,f){let _=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z),b=Xy/Math.pow(2,c.canonical.z-this.tileID.canonical.z),w=c.canonical.x*r.ai,I=c.canonical.y*r.ai;for(let k=0;k<a.length;k++){let O=a.get(k);if(O.crossTileID)continue;let{key:F,tileAnchorX:z,tileAnchorY:V}=O,G=Math.floor((w+z)*b),K=Math.floor((I+V)*b),W=this.index.range(G-_,K-_,G+_,K+_);for(let te of W){let ne=this.crossTileIDs[te];if(this.keys[te]===F&&!f.has(ne)){f.add(ne),O.crossTileID=ne;break}}}}}class SM{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class tw{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(a){let c=Math.round((a-this.lng)/360);if(c!==0)for(let f in this.indexes){let _=this.indexes[f],b={};for(let w in _){let I=_[w];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+c),b[I.tileID.key]=I}this.indexes[f]=b}this.lng=a}addBucket(a,c,f){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(let b=0;b<c.symbolInstances.length;b++)c.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]=new Set);let _=this.usedCrossTileIDs[a.overscaledZ];for(let b in this.indexes){let w=this.indexes[b];if(Number(b)>a.overscaledZ)for(let I in w){let k=w[I];k.tileID.isChildOf(a)&&k.findMatches(c.symbolInstances,a,_)}else{let I=w[a.scaledTo(Number(b)).key];I&&I.findMatches(c.symbolInstances,a,_)}}for(let b=0;b<c.symbolInstances.length;b++){let w=c.symbolInstances.get(b);w.crossTileID||(w.crossTileID=f.generate(),_.add(w.crossTileID))}return this.indexes[a.overscaledZ]===void 0&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new EM(a,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(a,c){for(let f of c.crossTileIDs)this.usedCrossTileIDs[a].delete(f)}removeStaleBuckets(a){let c=!1;for(let f in this.indexes){let _=this.indexes[f];for(let b in _)a[_[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,_[b]),delete _[b],c=!0)}return c}}class DM{constructor(){this.layerIndexes={},this.crossTileIDs=new SM,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(a,c,f,_){let b=this.layerIndexes[a.fqid];b===void 0&&(b=this.layerIndexes[a.fqid]=new tw);let w=!1,I={};_.name!=="globe"&&b.handleWrapJump(f);for(let k of c){let O=k.getBucket(a);O&&a.fqid===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(k.tileID,O,this.crossTileIDs)&&(w=!0),I[O.bucketInstanceId]=!0)}return b.removeStaleBuckets(I)&&(w=!0),w}pruneUnusedLayers(a){let c={};a.forEach(f=>{c[f]=!0});for(let f in this.layerIndexes)c[f]||delete this.layerIndexes[f]}}let sd=771;class Ji{constructor(a,c,f,_){this.blendFunction=a,this.blendColor=c,this.mask=f,this.blendEquation=_}}Ji.Replace=[1,0,1,0],Ji.disabled=new Ji(Ji.Replace,r.al.transparent,[!1,!1,!1,!1]),Ji.unblended=new Ji(Ji.Replace,r.al.transparent,[!0,!0,!0,!0]),Ji.alphaBlended=new Ji([1,sd,1,sd],r.al.transparent,[!0,!0,!0,!0]),Ji.alphaBlendedNonPremultiplied=new Ji([770,sd,770,sd],r.al.transparent,[!0,!0,!0,!0]),Ji.multiply=new Ji([774,0,774,0],r.al.transparent,[!0,!0,!0,!0]);class ci{constructor(a,c,f){this.func=a,this.mask=c,this.range=f}}ci.ReadOnly=!1,ci.ReadWrite=!0,ci.disabled=new ci(519,ci.ReadOnly,[0,1]);let Qm=7680;class Oi{constructor(a,c,f,_,b,w){this.test=a,this.ref=c,this.mask=f,this.fail=_,this.depthFail=b,this.pass=w}}Oi.disabled=new Oi({func:519,mask:0},0,0,Qm,Qm,Qm);let gc=1029,rh=2305;class Ti{constructor(a,c,f){this.enable=a,this.mode=c,this.frontFace=f}}function Ky(m,a){let c=r.bG(m,3);r.ad.mat4.fromQuat(m,a),r.bI(m,3,c)}function iu(m,a){let c=r.ad.quat.identity([]);return r.ad.quat.rotateZ(c,c,-a),r.ad.quat.rotateX(c,c,-m),c}function oh(m,a){let c=[m[0],m[1],0],f=[a[0],a[1],0];if(r.ad.vec3.length(c)>=1e-15){let w=r.ad.vec3.normalize([],c);r.ad.vec3.scale(f,w,r.ad.vec3.dot(f,w)),a[0]=f[0],a[1]=f[1]}let _=r.ad.vec3.cross([],a,m);if(r.ad.vec3.len(_)<1e-15)return null;let b=Math.atan2(-_[1],_[0]);return iu(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),b)}Ti.disabled=new Ti(!1,gc,rh),Ti.backCCW=new Ti(!0,gc,rh),Ti.backCW=new Ti(!0,gc,2304),Ti.frontCW=new Ti(!0,1028,2304),Ti.frontCCW=new Ti(!0,1028,rh);class Qy{constructor(a,c){this.position=a,this.orientation=c}get position(){return this._position}set position(a){if(a){let c=a instanceof r.ac?a:new r.ac(a[0],a[1],a[2]);this._renderWorldCopies&&(c.x=r.bF(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(a,c){if(this.orientation=null,!this.position)return;let f=this.position,_=this._elevation?this._elevation.getAtPointOrZero(r.ac.fromLngLat(a)):0,b=r.ac.fromLngLat(a,_),w=[b.x-f.x,b.y-f.y,b.z-f.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=oh(w,c)}setPitchBearing(a,c){this.orientation=iu(r.ak(a),r.ak(-c))}}class ah{constructor(a,c){this._transform=r.ad.mat4.identity([]),this.orientation=c,this.position=a}get mercatorPosition(){let a=this.position;return new r.ac(a[0],a[1],a[2])}get position(){let a=r.bG(this._transform,3);return[a[0],a[1],a[2]]}set position(a){var c;a&&r.bI(this._transform,3,[(c=a)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(a){this._orientation=a||r.ad.quat.identity([]),a&&Ky(this._transform,this._orientation)}getPitchBearing(){let a=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(a[0]*a[0]+a[1]*a[1]),-a[2])}}setPitchBearing(a,c){this._orientation=iu(a,c),Ky(this._transform,this._orientation)}forward(){let a=r.bG(this._transform,2);return[-a[0],-a[1],-a[2]]}up(){let a=r.bG(this._transform,1);return[-a[0],-a[1],-a[2]]}right(){let a=r.bG(this._transform,0);return[a[0],a[1],a[2]]}getCameraToWorld(a,c){let f=new Float64Array(16);return r.ad.mat4.invert(f,this.getWorldToCamera(a,c)),f}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(a,c,f){let _=this.position;r.ad.vec3.scale(_,_,-a);let b=new Float64Array(16);return r.ad.mat4.fromScaling(b,[f,f,f]),r.ad.mat4.translate(b,b,_),b[10]*=c,b}getWorldToCamera(a,c){let f=new Float64Array(16),_=new Float64Array(4),b=this.position;return r.ad.quat.conjugate(_,this._orientation),r.ad.vec3.scale(b,b,-a),r.ad.mat4.fromQuat(f,_),r.ad.mat4.translate(f,f,b),f[1]*=-1,f[5]*=-1,f[9]*=-1,f[13]*=-1,f[8]*=c,f[9]*=c,f[10]*=c,f[11]*=c,f}getCameraToClipPerspective(a,c,f,_){let b=new Float64Array(16);return r.ad.mat4.perspective(b,a,c,f,_),b}getCameraToClipOrthographic(a,c,f,_,b,w){let I=new Float64Array(16);return r.ad.mat4.ortho(I,a,c,f,_,b,w),I}getDistanceToElevation(a,c=!1){let f=a===0?0:r.bH(a,c?r.aT(this.position[1]):this.position[1]),_=this.forward();return(f-this.position[2])/_[2]}clone(){return new ah([...this.position],[...this.orientation])}}let Or={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class af{constructor(a=0,c=0,f=0,_=0){if(isNaN(a)||a<0||isNaN(c)||c<0||isNaN(f)||f<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=c,this.left=f,this.right=_}interpolate(a,c,f){return c.top!=null&&a.top!=null&&(this.top=r.ah(a.top,c.top,f)),c.bottom!=null&&a.bottom!=null&&(this.bottom=r.ah(a.bottom,c.bottom,f)),c.left!=null&&a.left!=null&&(this.left=r.ah(a.left,c.left,f)),c.right!=null&&a.right!=null&&(this.right=r.ah(a.right,c.right,f)),this}getCenter(a,c){let f=r.ay((this.left+a-this.right)/2,0,a),_=r.ay((this.top+c-this.bottom)/2,0,c);return new r.P(f,_)}equals(a){return this.top===a.top&&this.bottom===a.bottom&&this.left===a.left&&this.right===a.right}clone(){return new af(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}let kt=15;class Jm{constructor(a,c,f,_,b,w,I){this.tileSize=512,this._renderWorldCopies=b===void 0||b,this._minZoom=a||0,this._maxZoom=c||22,this._minPitch=f??0,this._maxPitch=_??60,this.setProjection(w),this.setMaxBounds(I),this.width=0,this.height=0,this._center=new r.bO(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new af,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new ah,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){let a=new Jm(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return a._elevation=this._elevation,a._centerAltitude=this._centerAltitude,a._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,a.tileSize=this.tileSize,a.mercatorFromTransition=this.mercatorFromTransition,a.width=this.width,a.height=this.height,a.cameraElevationReference=this.cameraElevationReference,a._center=this._center,a._setZoom(this.zoom),a._seaLevelZoom=this._seaLevelZoom,a.angle=this.angle,a._fov=this._fov,a._pitch=this._pitch,a._nearZ=this._nearZ,a._farZ=this._farZ,a._averageElevation=this._averageElevation,a._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,a._unmodified=this._unmodified,a._edgeInsets=this._edgeInsets.clone(),a._camera=this._camera.clone(),a._calcMatrices(),a.freezeTileCoverage=this.freezeTileCoverage,a.frustumCorners=this.frustumCorners,a._allowWorldUnderZoom=this._allowWorldUnderZoom,a}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<kt}get elevation(){return this._elevation}set elevation(a){this._elevation!==a&&(this._elevation=a,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(a,c=!1){let f=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||f)&&this._updateCameraOnTerrain(),(a||f)&&this._constrainCamera(c),this._calcMatrices()}getProjection(){return r.aA(this.projection,["name","center","parallels"])}setProjection(a){this.projectionOptions=a||{name:"mercator"};let c=this.projection?this.getProjection():void 0;this.projection=r.bP(this.projectionOptions);let f=this.getProjection(),_=!r.bn(c,f);return _&&this._calcMatrices(),this.mercatorFromTransition=!1,_}setOrthographicProjectionAtLowPitch(a){return this._orthographicProjectionAtLowPitch!==a&&(this._orthographicProjectionAtLowPitch=a,this._calcMatrices(),!0)}setMercatorFromTransition(){let a=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=r.bP({name:"mercator"});let c=a!==this.projection.name;return c&&this._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))}get maxZoom(){return this._maxZoom}set maxZoom(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))}get minPitch(){return this._minPitch}set minPitch(a){this._minPitch!==a&&(this._minPitch=a,this.pitch=Math.max(this.pitch,a))}get maxPitch(){return this._maxPitch}set maxPitch(a){this._maxPitch!==a&&(this._maxPitch=a,this.pitch=Math.min(this.pitch,a))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(a){a===void 0?a=!0:a===null&&(a=!1),this._renderWorldCopies=a}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){let a=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(a))}get cameraWorldSize(){let a=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(a))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return r.bH(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new r.P(this.width,this.height)}get bearing(){return r.bF(this.rotation,-180,180)}set bearing(a){this.rotation=a}get rotation(){return-this.angle/Math.PI*180}set rotation(a){let c=-a*Math.PI/180;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=r.ad.mat2.create(),r.ad.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(a){let c=r.ay(a,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=r.ak(a),this._calcMatrices())}get fovX(){return this._fov}get fovY(){let a=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/a)}get averageElevation(){return this._averageElevation}set averageElevation(a){this._averageElevation=a,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(a){let c=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(a){this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(a){this._tileCoverLift!==a&&(this._tileCoverLift=a)}_updateCameraOnTerrain(){let a=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,c=this.elevation&&a===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||a===Number.NEGATIVE_INFINITY&&(!c||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);let f=this._elevation;c||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&f.exaggeration()&&this._centerAltitudeValidForExaggeration!==f.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*f.exaggeration(),this._centerAltitudeValidForExaggeration=f.exaggeration()):(this._centerAltitude=a||0,this._centerAltitudeValidForExaggeration=f.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;let a=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],f=this.horizonLineFromTop(),_=0,b=0;for(let w=0;w<c.length;w++){let I=new r.P(c[w][0]*this.width,f+c[w][1]*(this.height-f)),k=a.pointCoordinate(I);if(!k)continue;let O=1/Math.hypot(k[0]-this._camera.position[0],k[1]-this._camera.position[1]);_+=k[3]*O,b+=O}return b===0?NaN:_/b}get center(){return this._center}set center(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;let a=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),f=this.pixelsPerMeter/this.worldSize*c,_=this._mercatorZfromZoom(a),b=this._mercatorZfromZoom(this._maxZoom),w=Math.max(_-f,b);this._setZoom(this._zoomFromMercatorZ(w))}get padding(){return this._edgeInsets.toJSON()}set padding(a){this._edgeInsets.equals(a)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,a,1),this._calcMatrices())}computeZoomRelativeTo(a){let c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,a.toAltitude())),f;f=a.z<this._camera.position[2]?[c.x,c.y,c.z]:[a.x,a.y,a.z];let _=r.ad.vec3.length(r.ad.vec3.sub([],this._camera.position,f));return r.ay(this._zoomFromMercatorZ(_),this._minZoom,this._maxZoom)}setFreeCameraOptions(a){if(!this.height||!a.position&&!a.orientation)return;this._updateCameraState();let c=!1;if(a.orientation&&!r.ad.quat.exactEquals(a.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(a.orientation)),a.position){let f=[a.position.x,a.position.y,a.position.z];r.ad.vec3.exactEquals(f,this._camera.position)||(this._setCameraPosition(f),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();let a=this._camera.position,c=new Qy;return c.position=new r.ac(a[0],a[1],a[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(a){if(!r.ad.quat.length(a))return!1;r.ad.quat.normalize(a,a);let c=r.ad.vec3.transformQuat([],[0,0,-1],a),f=r.ad.vec3.transformQuat([],[0,-1,0],a);if(f[2]<0)return!1;let _=oh(c,f);return!!_&&(this._camera.orientation=_,!0)}_setCameraPosition(a){let c=this.zoomScale(this.minZoom)*this.tileSize,f=this.zoomScale(this.maxZoom)*this.tileSize,_=this.cameraToCenterDistance;a[2]=r.ay(a[2],_/f,_/c),this._camera.position=a}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(a){return this._edgeInsets.equals(a)}interpolatePadding(a,c,f){this._unmodified=!1,this._edgeInsets.interpolate(a,c,f),this._constrain(),this._calcMatrices()}coveringZoomLevel(a){let c=(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(a){let c=[new r.bQ(0,a)];if(this.renderWorldCopies){let f=this.pointCoordinate(new r.P(0,0)),_=this.pointCoordinate(new r.P(this.width,0)),b=this.pointCoordinate(new r.P(this.width,this.height)),w=this.pointCoordinate(new r.P(0,this.height)),I=Math.floor(Math.min(f.x,_.x,b.x,w.x)),k=Math.floor(Math.max(f.x,_.x,b.x,w.x)),O=1;for(let F=I-O;F<=k+O;F++)F!==0&&c.push(new r.bQ(F,a))}return c}isLODDisabled(a){return(!a||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(a,c,f){let _=[],b=f!==void 0,w=!b;if(w&&this.zoom<c||b&&f[0]===0&&f[1]===0)return _;let I=new Set,k=(F,z,V,G,K)=>{let W=r.c5(z,F,V,G,K);I.has(W)||(_.push(new r.aH(F,z,V,G,K)),I.add(W))};for(let F=0;F<a.length;F++){let z=a[F];if(w&&z.canonical.z!==c)continue;let V=z.canonical,G=z.overscaledZ,K=z.wrap,W=1<<V.z,te=V.x+1<W,ne=V.x>0,he=V.y+1<W,_e=V.y>0,me=z.wrap-(ne?0:1),Se=z.wrap+(te?0:1),ve=ne?V.x-1:W-1,be=te?V.x+1:0;if(b)f[0]<0?(k(G,Se,V.z,be,V.y),f[1]<0&&he&&(k(G,K,V.z,V.x,V.y+1),k(G,Se,V.z,be,V.y+1)),f[1]>0&&_e&&(k(G,K,V.z,V.x,V.y-1),k(G,Se,V.z,be,V.y-1))):f[0]>0?(k(G,me,V.z,ve,V.y),f[1]<0&&he&&(k(G,K,V.z,V.x,V.y+1),k(G,me,V.z,ve,V.y+1)),f[1]>0&&_e&&(k(G,K,V.z,V.x,V.y-1),k(G,me,V.z,ve,V.y-1))):f[1]<0&&he?k(G,K,V.z,V.x,V.y+1):_e&&k(G,K,V.z,V.x,V.y-1);else{let xe=z.visibleQuadrants;1&xe&&(k(G,me,V.z,ve,V.y),_e&&(k(G,K,V.z,V.x,V.y-1),k(G,me,V.z,ve,V.y-1))),2&xe&&(k(G,Se,V.z,be,V.y),_e&&(k(G,K,V.z,V.x,V.y-1),k(G,Se,V.z,be,V.y-1))),4&xe&&(k(G,me,V.z,ve,V.y),he&&(k(G,K,V.z,V.x,V.y+1),k(G,me,V.z,ve,V.y+1))),8&xe&&(k(G,Se,V.z,be,V.y),he&&(k(G,K,V.z,V.x,V.y+1),k(G,Se,V.z,be,V.y+1)))}}let O=[];for(let F of _)_.some(z=>F.isChildOf(z))||O.push(F);if(_=O.filter(F=>!a.some(z=>!!(F.overscaledZ<c&&z.isChildOf(F))||F.equals(z)||F.isChildOf(z))),w){let F=1<<c,z=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),V=[F*z.x,F*z.y],G=4,K=G*G;_=_.filter(W=>{let te=W.canonical.x+.5-V[0],ne=W.canonical.y+.5-V[1];return te*te+ne*ne<K})}return _}coveringTiles(a){let c=this.coveringZoomLevel(a),f=c,_=this.elevation&&this.elevation.exaggeration(),b=_&&!a.isTerrainDEM,w=this.projection.name==="mercator";if(a.minzoom!==void 0&&c<a.minzoom)return[];a.maxzoom!==void 0&&c>a.maxzoom&&(c=a.maxzoom);let I=this.locationCoordinate(this.center),k=this.center.lat,O=1<<c,F=[O*I.x,O*I.y,0],z=this.projection.name==="globe",V=!z,G=r.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,V),K=z?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),W=O*r.bH(1,this.center.lat),te=this._camera.position[2]/r.bH(1,this.center.lat),ne=[O*K.x,O*K.y,te*(V?1:W)],he=z||_,_e=this.cameraToCenterDistance/a.tileSize*(a.roundZoom?1:.502),me=this.isLODDisabled(!0)?c:0,Se;if(this._elevation&&a.isTerrainDEM)Se=1e4*this._elevation.exaggeration();else if(this._elevation){let je=this._elevation.getMinMaxForVisibleTiles();Se=je?je.max:this._centerAltitude}else Se=this._centerAltitude;let ve=a.isTerrainDEM?-Se:this._elevation?this._elevation.getMinElevationBelowMSL():0,be=this.projection.isReprojectedInTileSpace?r.bS(this):1,xe=je=>{let rt=new r.ac(je.x+25e-6,je.y,je.z),ht=new r.ac(je.x,je.y+25e-6,je.z),Qe=je.toLngLat(),mt=rt.toLngLat(),Nt=ht.toLngLat(),zt=this.locationCoordinate(Qe),Vt=this.locationCoordinate(mt),ei=this.locationCoordinate(Nt),Ri=Math.hypot(Vt.x-zt.x,Vt.y-zt.y),gi=Math.hypot(ei.x-zt.x,ei.y-zt.y);return Math.sqrt(Ri*gi)*be/25e-6},Ae=je=>{let at=Se,rt=ve;return{aabb:r.bV(this,O,0,0,0,je,rt,at,this.projection),zoom:0,x:0,y:0,minZ:rt,maxZ:at,wrap:je,fullyVisible:!1}},Oe=[],Ke=[],$e=c,ct=a.reparseOverscaled?f:c,ut=(te-this._centerAltitude)*W,St=je=>{if(!this._elevation||!je.tileID||!w)return;let at=this._elevation.getMinMaxForTile(je.tileID),rt=je.aabb;at?(rt.min[2]=at.min,rt.max[2]=at.max,rt.center[2]=(rt.min[2]+rt.max[2])/2):(je.shouldSplit=st(je),je.shouldSplit||(rt.min[2]=rt.max[2]=rt.center[2]=this._centerAltitude))},He=(je,at)=>{if(.707*at<je)return 1;let rt=at/je;return rt/(1.4144271570014144+(Math.pow(1.1,rt-1.4144271570014144+1)-1)/(1.1-1)-1)},st=je=>{if(je.zoom<me)return!0;if(je.zoom===$e)return!1;if(je.shouldSplit!=null)return je.shouldSplit;let at=je.aabb.distanceX(ne),rt=je.aabb.distanceY(ne),ht=ut,Qe=1;if(z){ht=je.aabb.distanceZ(ne);let gi=Math.pow(2,je.zoom),Si=r.aT((je.y+1)/gi),vi=r.aT(je.y/gi),on=Math.min(Math.max(k,Si),vi),Dn=r.ca(on)/r.ca(k);if(Qe=on===k?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Dn/this._mercatorScaleRatio),this.zoom<=r.c6&&je.zoom===$e-1&&Dn>=.9)return!0}else if(b&&(ht=je.aabb.distanceZ(ne)*W),this.projection.isReprojectedInTileSpace&&f<=5){let gi=Math.pow(2,je.zoom),Si=xe(new r.ac((je.x+.5)/gi,(je.y+.5)/gi));Qe=Si>.85?1:Si}if(!w){let gi=Math.sqrt(at*at+rt*rt+ht*ht),Si=(1<<$e-je.zoom)*_e*Qe;return Si*=He(Math.max(ht,ut),gi),gi<Si}let mt=Number.MAX_VALUE,Nt=0,zt=je.aabb.getCorners(),Vt=[];for(let gi of zt){r.ad.vec3.sub(Vt,gi,ne),z||(b?Vt[2]*=W:Vt[2]=ut);let Si=r.ad.vec3.dot(Vt,this._camera.forward());Si<mt&&(mt=Si,Nt=Math.abs(Vt[2]))}let ei=(1<<$e-je.zoom)*_e*Qe;if(ei*=He(Math.max(Nt,ut),mt),mt<ei)return!0;let Ri=je.aabb.closestPoint(F);return Ri[0]===F[0]&&Ri[1]===F[1]};if(this.renderWorldCopies)for(let je=1;je<=3;je++)Oe.push(Ae(-je)),Oe.push(Ae(je));for(Oe.push(Ae(0));Oe.length>0;){let je=Oe.pop(),at=je.x,rt=je.y,ht=je.fullyVisible,Qe=()=>this.projection.name==="globe"&&(je.y===0||je.y===(1<<je.zoom)-1);if(!ht){let mt=he?je.aabb.intersects(G):je.aabb.intersectsFlat(G);if(mt===0&&Qe()){let Nt=new r.bT(je.zoom,at,rt);mt=r.bU(this,O,Nt,!0).intersects(G)}if(mt===0)continue;ht=mt===2}if(je.zoom!==$e&&st(je))for(let mt=0;mt<4;mt++){let Nt=(at<<1)+mt%2,zt=(rt<<1)+(mt>>1),Vt={aabb:w?je.aabb.quadrant(mt):r.bV(this,O,je.zoom+1,Nt,zt,je.wrap,je.minZ,je.maxZ,this.projection),zoom:je.zoom+1,x:Nt,y:zt,wrap:je.wrap,fullyVisible:ht,tileID:void 0,shouldSplit:void 0,minZ:je.minZ,maxZ:je.maxZ};b&&!z&&(Vt.tileID=new r.aH(je.zoom+1===$e?ct:je.zoom+1,je.wrap,je.zoom+1,Nt,zt),St(Vt)),Oe.push(Vt)}else{let mt=je.zoom===$e?ct:je.zoom;if(a.minzoom&&a.minzoom>mt)continue;let Nt=0;if(!ht){let Ri=he?je.aabb.intersectsPrecise(G):je.aabb.intersectsPreciseFlat(G);if(Ri===0&&Qe()){let gi=new r.bT(je.zoom,at,rt);Ri=r.bU(this,O,gi,!0).intersectsPrecise(G)}if(Ri===0)continue;if(a.calculateQuadrantVisibility)if(G.containsPoint(je.aabb.center))Nt=15;else for(let gi=0;gi<4;gi++)je.aabb.quadrant(gi).intersects(G)!==0&&(Nt|=1<<gi)}let zt=F[0]-(.5+at+(je.wrap<<je.zoom))*(1<<c-je.zoom),Vt=F[1]-.5-rt,ei=je.tileID?je.tileID:new r.aH(mt,je.wrap,je.zoom,at,rt);a.calculateQuadrantVisibility&&(ei.visibleQuadrants=Nt),Ke.push({tileID:ei,distanceSq:zt*zt+Vt*Vt})}}if(this.fogCullDistSq){let je=this.fogCullDistSq,at=this.horizonLineFromTop();Ke=Ke.filter(rt=>{let ht=[0,0,0,1],Qe=[r.ai,r.ai,0,1],mt=this.calculateFogTileMatrix(rt.tileID.toUnwrapped());r.ad.vec4.transformMat4(ht,ht,mt),r.ad.vec4.transformMat4(Qe,Qe,mt);let Nt=r.ad.vec4.min([],ht,Qe),zt=r.ad.vec4.max([],ht,Qe),Vt=r.bW(Nt,zt);if(Vt===0)return!0;let ei=!1,Ri=this._elevation;if(Ri&&Vt>je&&at!==0){let gi=this.calculateProjMatrix(rt.tileID.toUnwrapped()),Si;a.isTerrainDEM||(Si=Ri.getMinMaxForTile(rt.tileID)),Si||(Si={min:ve,max:Se});let vi=r.c7(this.rotation),on=[vi[0]*r.ai,vi[1]*r.ai,Si.max];r.ad.vec3.transformMat4(on,on,gi),ei=(1-on[1])*this.height*.5<at}return Vt<je||ei})}return Ke.sort((je,at)=>je.distanceSq-at.distanceSq).map(je=>je.tileID)}resize(a,c){this.width=a,this.height=c,this.pixelsToGLUnits=[2/a,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(a){return Math.pow(2,a)}scaleZoom(a){return Math.log(a)/Math.LN2}project(a){let c=r.ay(a.lat,-r.bX,r.bX),f=this.projection.project(a.lng,c);return new r.P(f.x*this.worldSize,f.y*this.worldSize)}unproject(a){return this.projection.unproject(a.x/this.worldSize,a.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/r.bH(1,this.center.lat)/this.worldSize}setLocationAtPoint(a,c){let f,_,b=this.centerPoint;if(this.projection.name==="globe"){let I=this.worldSize;f=(c.x-b.x)/I,_=(c.y-b.y)/I}else{let I=this.pointCoordinate(c),k=this.pointCoordinate(b);f=I.x-k.x,_=I.y-k.y}let w=this.locationCoordinate(a);this.setLocation(new r.ac(w.x-f,w.y-_))}setLocation(a){this.center=this.coordinateLocation(a),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(a,c){return this.projection.locationPoint(this,a,c)}locationPoint3D(a,c){return this.projection.locationPoint(this,a,c,!0)}pointLocation(a){return this.coordinateLocation(this.pointCoordinate(a))}pointLocation3D(a,c){return this.coordinateLocation(this.pointCoordinate3D(a,c))}locationCoordinate(a,c){let f=c?r.bH(c,a.lat):void 0,_=this.projection.project(a.lng,a.lat);return new r.ac(_.x,_.y,f)}coordinateLocation(a){return this.projection.unproject(a.x,a.y)}pointRayIntersection(a,c){let f=c??this._centerAltitude,_=[a.x,a.y,0,1],b=[a.x,a.y,1,1];r.ad.vec4.transformMat4(_,_,this.pixelMatrixInverse),r.ad.vec4.transformMat4(b,b,this.pixelMatrixInverse);let w=b[3];r.ad.vec4.scale(_,_,1/_[3]),r.ad.vec4.scale(b,b,1/w);let I=_[2],k=b[2];return{p0:_,p1:b,t:I===k?0:(f-I)/(k-I)}}screenPointToMercatorRay(a){let c=[a.x,a.y,0,1],f=[a.x,a.y,1,1];return r.ad.vec4.transformMat4(c,c,this.pixelMatrixInverse),r.ad.vec4.transformMat4(f,f,this.pixelMatrixInverse),r.ad.vec4.scale(c,c,1/c[3]),r.ad.vec4.scale(f,f,1/f[3]),c[2]=r.bH(c[2],this._center.lat)*this.worldSize,f[2]=r.bH(f[2],this._center.lat)*this.worldSize,r.ad.vec4.scale(c,c,1/this.worldSize),r.ad.vec4.scale(f,f,1/this.worldSize),new r.as([c[0],c[1],c[2]],r.ad.vec3.normalize([],r.ad.vec3.sub([],f,c)))}rayIntersectionCoordinate(a){let{p0:c,p1:f,t:_}=a,b=r.bH(c[2],this._center.lat),w=r.bH(f[2],this._center.lat);return new r.ac(r.ah(c[0],f[0],_)/this.worldSize,r.ah(c[1],f[1],_)/this.worldSize,r.ah(b,w,_))}pointCoordinate(a,c=this._centerAltitude){return this.projection.pointCoordinate(this,a.x,a.y,c)}pointCoordinate3D(a,c){if(!this.elevation)return this.pointCoordinate(a,c);let f=this.projection.pointCoordinate3D(this,a.x,a.y);if(f)return new r.ac(f[0],f[1],f[2]);let _=0,b=this.horizonLineFromTop();if(a.y>b)return this.pointCoordinate(a,c);let w=.02*b,I=a.clone();for(let k=0;k<10&&b-_>w;k++){I.y=r.ah(_,b,.66);let O=this.projection.pointCoordinate3D(this,I.x,I.y);O?(b=I.y,f=O):_=I.y}return f?new r.ac(f[0],f[1],f[2]):this.pointCoordinate(a)}isPointAboveHorizon(a){return this.projection.isPointAboveHorizon(this,a)}isPointOnSurface(a){if(a.y<0||a.y>this.height||a.x<0||a.x>this.width)return!1;if(this.elevation||this.zoom>=r.bY)return!this.isPointAboveHorizon(a);let c=this.pointCoordinate(a);return c.y>=0&&c.y<=1}_coordinatePoint(a,c){let f=c&&this.elevation?this.elevation.getAtPointOrZero(a,this._centerAltitude):this._centerAltitude,_=[a.x*this.worldSize,a.y*this.worldSize,f+a.toAltitude(),1];return r.ad.vec4.transformMat4(_,_,this.pixelMatrix),_[3]>0?new r.P(_[0]/_[3],_[1]/_[3]):new r.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){let{top:a,left:c}=this._edgeInsets,f=this.height-this._edgeInsets.bottom,_=this.width-this._edgeInsets.right,b=this.pointLocation3D(new r.P(c,a)),w=this.pointLocation3D(new r.P(_,a)),I=this.pointLocation3D(new r.P(_,f)),k=this.pointLocation3D(new r.P(c,f)),O=Math.min(b.lng,w.lng,I.lng,k.lng),F=Math.max(b.lng,w.lng,I.lng,k.lng),z=Math.min(b.lat,w.lat,I.lat,k.lat),V=Math.max(b.lat,w.lat,I.lat,k.lat),G=Math.pow(2,-this.zoom)/16*270,K=this.projection.name==="globe"?1:4,W=(te,ne,he,_e,me)=>{let Se=(te+he)/2,ve=(ne+_e)/2,be=new r.P(Se,ve),{lng:xe,lat:Ae}=this.pointLocation3D(be),Oe=Math.max(0,O-xe,z-Ae,xe-F,Ae-V);O=Math.min(O,xe),F=Math.max(F,xe),z=Math.min(z,Ae),V=Math.max(V,Ae),(me<K||Oe>G)&&(W(te,ne,Se,ve,me+1),W(Se,ve,he,_e,me+1))};if(W(c,a,_,a,1),W(_,a,_,f,1),W(_,f,c,f,1),W(c,f,c,a,1),this.projection.name==="globe"){let[te,ne]=r.bZ(this);te?(V=90,F=180,O=-180):ne&&(z=-90,F=180,O=-180)}return new r.aB(new r.bO(O,z),new r.bO(F,V))}_getBoundsRectangular(a,c){let{top:f,left:_}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,I=new r.P(_,f),k=new r.P(w,f),O=new r.P(w,b),F=new r.P(_,b),z=this.pointCoordinate(I,a),V=this.pointCoordinate(k,a),G=this.pointCoordinate(O,c),K=this.pointCoordinate(F,c),W=(te,ne)=>(ne.y-te.y)/(ne.x-te.x);return z.y>1&&V.y>=0?z=new r.ac((1-K.y)/W(K,z)+K.x,1):z.y<0&&V.y<=1&&(z=new r.ac(-K.y/W(K,z)+K.x,0)),V.y>1&&z.y>=0?V=new r.ac((1-G.y)/W(G,V)+G.x,1):V.y<0&&z.y<=1&&(V=new r.ac(-G.y/W(G,V)+G.x,0)),new r.aB().extend(this.coordinateLocation(z)).extend(this.coordinateLocation(V)).extend(this.coordinateLocation(K)).extend(this.coordinateLocation(G))}_getBoundsRectangularTerrain(){let a=this.elevation;if(!a.visibleDemTiles.length||a.isUsingMockSource())return this._getBoundsRectangular(0,0);let c=a.visibleDemTiles.reduce((f,_)=>{if(_.dem){let b=_.dem.tree;f.min=Math.min(f.min,b.minimums[0]),f.max=Math.max(f.max,b.maximums[0])}return f},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(c.min*a.exaggeration(),c.max*a.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(a=!0){let c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,f=this.height/2-c*(1-this._horizonShift);return a?Math.max(0,f):f}getMaxBounds(){return this.maxBounds}setMaxBounds(a){this.maxBounds=a,this.minLat=-r.bX,this.maxLat=r.bX,this.minLng=-180,this.maxLng=180,a&&(this.minLat=a.getSouth(),this.maxLat=a.getNorth(),this.minLng=a.getWest(),this.maxLng=a.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=r.av(this.minLng)*this.tileSize,this.worldMaxX=r.av(this.maxLng)*this.tileSize,this.worldMinY=r.aC(this.maxLat)*this.tileSize,this.worldMaxY=r.aC(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(a,c){return this.projection.createTileMatrix(this,c,a)}calculateDistanceTileData(a){let c=a.key,f=this._distanceTileDataCache;if(f[c])return f[c];let _=a.canonical,b=1/this.height,w=this.cameraWorldSize,I=w/this.zoomScale(_.z),k=(_.x+Math.pow(2,_.z)*a.wrap)*I,O=_.y*I,F=this.point;F.x*=w/this.worldSize,F.y*=w/this.worldSize;let z=this.angle,V=Math.sin(-z),G=-Math.cos(-z);return f[c]={bearing:[V,G],center:[(F.x-k)*b,(F.y-O)*b],scale:I/r.ai*b},f[c]}calculateFogTileMatrix(a){let c=a.key,f=this._fogTileMatrixCache;if(f[c])return f[c];let _=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,a);return r.ad.mat4.multiply(_,this.worldToFogMatrix,_),f[c]=new Float32Array(_),f[c]}calculateProjMatrix(a,c=!1,f=!1){let _=a.key,b;if(b=f?this._expandedProjMatrixCache:c?this._alignedProjMatrixCache:this._projMatrixCache,b[_])return b[_];let w=this.calculatePosMatrix(a,this.worldSize),I;return I=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:f?this.expandedFarZProjMatrix:c?this.alignedProjMatrix:this.projMatrix,r.ad.mat4.multiply(w,I,w),b[_]=new Float32Array(w),b[_]}calculatePixelsToTileUnitsMatrix(a){let c=a.tileID.key,f=this._pixelsToTileUnitsCache;if(f[c])return f[c];let _=r.b_(a,this);return f[c]=_,f[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){let a=1/this.worldSize,c=r.ad.mat4.fromScaling([],[a,a,a]);return r.ad.mat4.multiply(c,c,this.globeMatrix),c}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;let a=this._elevation;this._updateCameraState();let c=r.bH(1,this._center.lat)*this.worldSize,f=this._computeCameraPosition(c),_=this._camera.forward(),b=r.bH(1,this._center.lat);f[2]/=b,_[2]/=b,r.ad.vec3.normalize(_,_);let w=a.raycast(f,_,a.exaggeration());if(w){let I=r.ad.vec3.scaleAndAdd([],f,_,w),k=new r.ac(I[0],I[1],r.bH(I[2],r.aT(I[1]))),O=(k.z+r.ad.vec3.length([k.x-f[0],k.y-f[1],k.z-f[2]*b]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(O),this._centerAltitude=k.toAltitude(),this._center=this.coordinateLocation(k),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(a=!1){if(!this._elevation)return;let c=this._elevation,f=r.bH(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(f),b=c.getAtPointOrZero(new r.ac(..._)),w=this.pixelsPerMeter/this.worldSize*b,I=this._minimumHeightOverTerrain(),k=_[2]-w;if(k<=I)if(k<0||a){let O=this.locationCoordinate(this._center,this._centerAltitude),F=[_[0],_[1],O.z-_[2]],z=r.ad.vec3.length(F);F[2]-=(I-k)/this._pixelsPerMercatorPixel;let V=r.ad.vec3.length(F);if(V===0)return;r.ad.vec3.scale(F,F,z/V*this._pixelsPerMercatorPixel),this._camera.position=[_[0],_[1],O.z*this._pixelsPerMercatorPixel-F[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let a=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||a){let V=this.center;return V.lat=r.ay(V.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!a)&&(V.lng=r.ay(V.lng,this.minLng,this.maxLng)),this.center=V,void(this._constraining=!1)}let c=this._unmodified,{x:f,y:_}=this.point,b=0,w=f,I=_,k=this.width/2,O=this.height/2,F=this.worldMinY*this.scale,z=this.worldMaxY*this.scale;if(_-O<F&&(I=F+O),_+O>z&&(I=z-O),z-F<this.height&&(b=Math.max(b,this.height/(z-F)),I=(z+F)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){let V=this.worldMinX*this.scale,G=this.worldMaxX*this.scale,K=this.worldSize/2-(V+G)/2;w=(f+K+this.worldSize)%this.worldSize-K,w-k<V&&(w=V+k),w+k>G&&(w=G-k),G-V<this.width&&(b=Math.max(b,this.width/(G-V)),w=(G+V)/2)}w===f&&I===_||this._allowWorldUnderZoom||(this.center=this.unproject(new r.P(w,I))),b&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(b)),this._constrainCamera(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){let a=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(a=Math.max(a,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),a}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;let a=this.centerOffset,c=this.projection.name==="globe",f=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=r.bH(1,this.center.lat)/r.bH(1,r.c8));let _=r.b$(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,_),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;let b=this.projection.zAxisUnit==="meters"?f:1,w=this._camera.getWorldToCamera(this.worldSize,b),I,k=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(k[8]=2*-a.x/this.width,k[9]=2*a.y/this.height,this.isOrthographic){let Ae=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Oe=Ae*this.aspect,Ke=-Oe,$e=-Ae;Oe-=a.x,Ke-=a.x,Ae+=a.y,$e+=a.y,I=this._camera.getCameraToClipOrthographic(Ke,Oe,$e,Ae,this._nearZ,this._farZ),((ct,ut,St,He)=>{for(let st=0;st<16;st++)ct[st]=r.ah(ut[st],St[st],He)})(I,I,k,r.c9(this.pitch>=kt?1:this.pitch/kt))}else I=k;let O=r.ad.mat4.mul([],k,w),F=r.ad.mat4.mul([],I,w);if(this.projection.isReprojectedInTileSpace){let Ae=this.locationCoordinate(this.center),Oe=r.ad.mat4.identity([]);r.ad.mat4.translate(Oe,Oe,[Ae.x*this.worldSize,Ae.y*this.worldSize,0]),r.ad.mat4.multiply(Oe,Oe,r.c0(this)),r.ad.mat4.translate(Oe,Oe,[-Ae.x*this.worldSize,-Ae.y*this.worldSize,0]),r.ad.mat4.multiply(F,F,Oe),r.ad.mat4.multiply(O,O,Oe),this.inverseAdjustmentMatrix=r.c1(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=r.ad.mat4.scale([],F,[this.worldSize,this.worldSize,this.worldSize/b,1]),this.projMatrix=F,this.invProjMatrix=r.ad.mat4.invert(new Float64Array(16),this.projMatrix),c){let Ae=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Ae[8]=2*-a.x/this.width,Ae[9]=2*a.y/this.height,this.expandedFarZProjMatrix=r.ad.mat4.mul([],Ae,w)}else this.expandedFarZProjMatrix=this.projMatrix;let z=r.ad.mat4.invert([],I);this.frustumCorners=r.c2.fromInvProjectionMatrix(z,this.horizonLineFromTop(),this.height),this.cameraFrustum=r.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!c);let V=new Float32Array(16);r.ad.mat4.identity(V),r.ad.mat4.scale(V,V,[1,-1,1]),r.ad.mat4.rotateX(V,V,this._pitch),r.ad.mat4.rotateZ(V,V,this.angle);let G=r.ad.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=r.ad.mat4.clone(G);let K=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;G[8]=2*-a.x/this.width,G[9]=2*(a.y+K)/this.height,this.skyboxMatrix=r.ad.mat4.multiply(V,G,V);let W=this.point,te=W.x,ne=W.y,he=this.width%2/2,_e=this.height%2/2,me=Math.cos(this.angle),Se=Math.sin(this.angle),ve=te-Math.round(te)+me*he+Se*_e,be=ne-Math.round(ne)+me*_e+Se*he,xe=new Float64Array(F);if(r.ad.mat4.translate(xe,xe,[ve>.5?ve-1:ve,be>.5?be-1:be,0]),this.alignedProjMatrix=xe,F=r.ad.mat4.create(),r.ad.mat4.scale(F,F,[this.width/2,-this.height/2,1]),r.ad.mat4.translate(F,F,[1,-1,0]),this.labelPlaneMatrix=F,F=r.ad.mat4.create(),r.ad.mat4.scale(F,F,[1,-1,1]),r.ad.mat4.translate(F,F,[-1,-1,0]),r.ad.mat4.scale(F,F,[2/this.width,2/this.height,1]),this.glCoordMatrix=F,this.pixelMatrix=r.ad.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,O),this._calcFogMatrices(),this._distanceTileDataCache={},F=r.ad.mat4.invert(new Float64Array(16),this.pixelMatrix),!F)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=F,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=r.c3(this);let Ae=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=r.ad.vec3.transformMat4(Ae,Ae,w),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=F;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};let a=this.cameraWorldSizeForFog,c=this.cameraPixelsPerMeter,f=this._camera.position,_=1/this.height/this._pixelsPerMercatorPixel,b=[a,a,c];r.ad.vec3.scale(b,b,_),r.ad.vec3.scale(f,f,-1),r.ad.vec3.multiply(f,f,b);let w=r.ad.mat4.create();r.ad.mat4.translate(w,w,f),r.ad.mat4.scale(w,w,b),this.mercatorFogMatrix=w,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(a,c,_)}_computeCameraPosition(a){let c=(a=a||this.pixelsPerMeter)/this.pixelsPerMeter,f=this._camera.forward(),_=this.point,b=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-a/this.worldSize*this._centerAltitude;return[_.x/this.worldSize-f[0]*b,_.y/this.worldSize-f[1]*b,a/this.worldSize*this._centerAltitude-f[2]*b]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(a){let c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),f=this._camera.position[2],_=a[2],b=1;this.projection.wrap&&(this.center=this.center.wrap()),_>0&&(b=Math.min((c-f)/_,1)),this._camera.position=r.ad.vec3.scaleAndAdd([],this._camera.position,a,b),this._updateStateFromCamera()}_updateStateFromCamera(){let a=this._camera.position,c=this._camera.forward(),{pitch:f,bearing:_}=this._camera.getPitchBearing(),b=r.bH(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,w=this._mercatorZfromZoom(this._maxZoom)*Math.cos(r.ak(this._maxPitch)),I=Math.max((a[2]-b)/Math.cos(f),w),k=this._zoomFromMercatorZ(I);r.ad.vec3.scaleAndAdd(a,a,c,I),this._pitch=r.ay(f,r.ak(this.minPitch),r.ak(this.maxPitch)),this.angle=r.bF(_,-Math.PI,Math.PI),this._setZoom(r.ay(k,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new r.ac(a[0],a[1],a[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(a){return Math.pow(2,a)*this.tileSize}_mercatorZfromZoom(a){return this.cameraToCenterDistance/this._worldSizeFromZoom(a)}_minimumHeightOverTerrain(){let a=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(a)}_zoomFromMercatorZ(a){return this.scaleZoom(this.cameraToCenterDistance/(a*this.tileSize))}zoomFromMercatorZAdjusted(a){let c=0,f=r.bY,_=0,b=1/0;for(;f-c>1e-6&&f>c;){let w=c+.5*(f-c),I=this.tileSize*Math.pow(2,w),k=this.getCameraToCenterDistance(this.projection,w,I),O=this.scaleZoom(k/(a*this.tileSize)),F=Math.abs(w-O);F<b&&(b=F,_=w),w<O?c=w:f=w}return _}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(r.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(a,c){let f=Math.min(a.x,c.x),_=Math.max(a.x,c.x),b=Math.min(a.y,c.y),w=Math.max(a.y,c.y);if(b<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;let I=[new r.P(f,b),new r.P(_,w),new r.P(f,w),new r.P(_,b)],k=this.renderWorldCopies?-3:0,O=this.renderWorldCopies?4:1;for(let F of I){let z=this.pointRayIntersection(F);if(z.t<0)return!0;let V=this.rayIntersectionCoordinate(z);if(V.x<k||V.y<0||V.x>O||V.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+r.c4(this.fovAboveCenter)>88||this.anyCornerOffEdge(new r.P(0,0),new r.P(this.width,this.height))}zoomDeltaToMovement(a,c){let f=r.ad.vec3.length(r.ad.vec3.sub([],this._camera.position,a)),_=this._zoomFromMercatorZ(f)+c;return f-this._mercatorZfromZoom(_)}getCameraPoint(){if(this.projection.name==="globe"){let a=function([c,f,_],b){let w=[c,f,_,1];r.ad.vec4.transformMat4(w,w,b);let I=w[3]=Math.max(w[3],1e-6);return w[0]/=I,w[1]/=I,w[2]/=I,w}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new r.P(a[0],a[1])}{let a=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new r.P(0,a))}}getCameraToCenterDistance(a,c=this.zoom,f=this.worldSize){let _=r.b$(a,c,this.width,this.height,1024),b=a.pixelSpaceConversion(this.center.lat,f,_),w=.5/Math.tan(.5*this._fov)*this.height*b;return this.isOrthographic&&(w=r.ah(1,w,r.c9(this.pitch>=kt?1:this.pitch/kt))),w}getWorldToCameraMatrix(){let a=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&r.ad.mat4.multiply(a,a,this.globeMatrix),a}getFrustum(a){return r.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a,this.projection.zAxisUnit==="meters")}}let _c=(m,a)=>{if(a>0&&m.terrain&&r.w("Cutoff is currently disabled on terrain"),a<=0||m.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};let c=m.transform,f=Math.max(Math.abs(c._zoom-(m.minCutoffZoom-1)),1),_=c.isLODDisabled(!1)?r.ae(60,45,c.pitch):r.ae(30,15,c.pitch),b=c._farZ-c._nearZ,w=a*c.height,I=((1-(k=_))*c.cameraToCenterDistance+k*(c._farZ+w))*f;var k;return{shouldRenderCutoff:_<1,uniformValues:{u_cutoff_params:[c._nearZ,c._farZ,(I-c._nearZ)/b,(I-w-c._nearZ)/b]}}},Jo={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class iw{constructor(a,c){this.aabb=a,this.lastCascade=c}}class eg{add(a,c){let f=this.receivers[a.key];f!==void 0?(f.aabb.min[0]=Math.min(f.aabb.min[0],c.min[0]),f.aabb.min[1]=Math.min(f.aabb.min[1],c.min[1]),f.aabb.min[2]=Math.min(f.aabb.min[2],c.min[2]),f.aabb.max[0]=Math.max(f.aabb.max[0],c.max[0]),f.aabb.max[1]=Math.max(f.aabb.max[1],c.max[1]),f.aabb.max[2]=Math.max(f.aabb.max[2],c.max[2])):this.receivers[a.key]=new iw(c,null)}clear(){this.receivers={}}get(a){return this.receivers[a.key]}computeRequiredCascades(a,c,f){let _=r.ce.fromPoints(a.points),b=0;for(let w in this.receivers){let I=this.receivers[w];if(!I||!_.intersectsAabb(I.aabb))continue;I.aabb.min=_.closestPoint(I.aabb.min),I.aabb.max=_.closestPoint(I.aabb.max);let k=I.aabb.getCorners();for(let O=0;O<f.length;O++){let F=!0;for(let z of k){let V=[z[0]*c,z[1]*c,z[2]];if(r.ad.vec3.transformMat4(V,V,f[O].matrix),V[0]<-1||V[0]>1||V[1]<-1||V[1]>1){F=!1;break}}if(I.lastCascade=O,b=Math.max(b,O),F)break}}return b+1}}class yc{constructor(a){this.painter=a,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new eg,this._depthMode=new ci(a.context.gl.LEQUAL,ci.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,a.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),a.tp.registerParameter(Jo,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),a.tp.registerParameter(Jo,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),a.tp.registerParameter(Jo,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),a.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(let a of this._cascades)a.texture.destroy(),a.framebuffer.destroy();this._cascades=[]}updateShadowParameters(a,c){let f=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!c||!c.properties)return;let _=c.properties.get("shadow-intensity");if(!c.shadowsEnabled()||_<=0||(this._shadowLayerCount=f.style.order.reduce((K,W)=>{let te=f.style._mergedLayers[W];return K+(te.hasShadowPass()&&!te.isHidden(a.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;let b=f.context,w=Jo.shadowMapResolution,I=Jo.shadowMapResolution;if(this._cascades.length===0||Jo.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let K=0;K<Jo.cascadeCount;++K){let W=f._shadowMapDebug,te=b.gl,ne=b.createFramebuffer(w,I,W,"texture"),he=new r.T(b,{width:w,height:I,data:null},te.DEPTH_COMPONENT16);if(ne.depthAttachment.set(he.texture),W){let _e=new r.T(b,{width:w,height:I,data:null},te.RGBA8);ne.colorAttachment.set(_e.texture)}this._cascades.push({framebuffer:ne,texture:he,matrix:[],far:0,boundingSphereRadius:0,frustum:new r.bR,scale:0})}}this.shadowDirection=ld(c);let k=0;if(a.elevation){let K=a.elevation,W=[1e4,-1e4];K.visibleDemTiles.filter(te=>te.dem).forEach(te=>{let ne=te.dem.tree;W[0]=Math.min(W[0],ne.minimums[0]),W[1]=Math.max(W[1],ne.maximums[0])}),W[0]!==1e4&&(k=(W[1]-W[0])*K.exaggeration())}let O=1.5*a.cameraToCenterDistance,F=3*O,z=new Float64Array(16);for(let K=0;K<this._cascades.length;++K){let W=this._cascades[K],te=a.height/50,ne=1;Jo.cascadeCount===1?ne=F:K===0?ne=O:(te=O,ne=F);let[he,_e]=ch(a,this.shadowDirection,te,ne,Jo.shadowMapResolution,k);W.scale=a.scale,W.matrix=he,W.boundingSphereRadius=_e,r.ad.mat4.invert(z,W.matrix),W.frustum=r.bR.fromInvProjectionMatrix(z,1,0,!0),W.far=ne}let V=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[V].far,this._cascades[V].far],this._uniformValues.u_shadow_intensity=_,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Jo.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Jo.shadowMapResolution,this._uniformValues.u_shadowmap_0=Or.ShadowMap0,this._uniformValues.u_shadowmap_1=Or.ShadowMap0+1,this._groundShadowTiles=f.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});let G=f.transform.elevation;for(let K of this._groundShadowTiles){let W={min:0,max:0};if(G){let te=G.getMinMaxForTile(K);te&&(W=te)}this.addShadowReceiver(K.toUnwrapped(),W.min,W.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(a){this._enabled=a}drawShadowPass(a,c){if(!this.enabled)return;let f=this.painter,_=f.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(f.transform.getFrustum(0),f.transform.worldSize,this._cascades),_.viewport.set([0,0,Jo.shadowMapResolution,Jo.shadowMapResolution]);for(let b=0;b<this._numCascadesToRender;++b){f.currentShadowCascade=b,_.bindFramebuffer.set(this._cascades[b].framebuffer.framebuffer),_.clear({color:r.al.white,depth:1});for(let w of a.order){let I=a._mergedLayers[w];if(!I.hasShadowPass()||I.isHidden(f.transform.zoom))continue;let k=a.getLayerSourceCache(I),O=k?c[k.id]:void 0;(I.type==="model"||O&&O.length)&&f.renderLayer(f,k,I,O)}}f.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;let a=this.painter,c=a.style,f=a.context,_=c.directionalLight,b=c.ambientLight;if(!_||!b)return;let w=[],I=_c(a,a.longestCutoffRange);I.shouldRenderCutoff&&w.push("RENDER_CUTOFF"),w.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&w.push("NORMAL_OFFSET");let k=lh(c,_,b),O=new ci(f.gl.LEQUAL,ci.ReadOnly,a.depthRangeFor3D);for(let F of this._groundShadowTiles){let z=F.toUnwrapped(),V=a.isTileAffectedByFog(F),G=a.getOrCreateProgram("groundShadow",{defines:w,overrideFog:V});this.setupShadows(z,G),a.uploadCommonUniforms(f,G,z,null,I);let K={u_matrix:a.transform.calculateProjMatrix(z),u_ground_shadow_factor:k};G.draw(a,f.gl.TRIANGLES,O,Oi.disabled,Ji.multiply,Ti.disabled,K,"ground_shadow",a.tileExtentBuffer,a.quadTriangleIndexBuffer,a.tileExtentSegments,null,a.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Ji.unblended:Ji.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(a){let c=this.painter.transform,f=c.calculatePosMatrix(a,c.worldSize);return r.ad.mat4.multiply(f,this._cascades[this.painter.currentShadowCascade].matrix,f),Float32Array.from(f)}calculateShadowPassMatrixFromMatrix(a){return r.ad.mat4.multiply(a,this._cascades[this.painter.currentShadowCascade].matrix,a),Float32Array.from(a)}setupShadows(a,c,f,_=0){if(!this.enabled)return;let b=this.painter.transform,w=this.painter.context,I=w.gl,k=this._uniformValues,O=new Float64Array(16),F=b.calculatePosMatrix(a,b.worldSize);for(let z=0;z<this._cascades.length;z++)r.ad.mat4.multiply(O,this._cascades[z].matrix,F),k[z===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(O),w.activeTexture.set(I.TEXTURE0+Or.ShadowMap0+z),this._cascades[z].texture.bind(I.NEAREST,I.CLAMP_TO_EDGE);if(this.useNormalOffset=!!f,this.useNormalOffset){let z=r.cd(a.canonical),V=2/b.tileSize*r.ai/Jo.shadowMapResolution,G=V*this._cascades[0].boundingSphereRadius,K=V*this._cascades[this._cascades.length-1].boundingSphereRadius,W=(f==="vector-tile"?1:3)/Math.pow(2,_-a.canonical.z-(1-b.zoom+Math.floor(b.zoom)));k.u_shadow_normal_offset=[z,G*W,K*W],k.u_shadow_bias=[6e-5,.0012,.012]}else k.u_shadow_bias=[36e-5,.0012,.012];c.setShadowUniformValues(w,k)}setupShadowsFromMatrix(a,c,f=!1){if(!this.enabled)return;let _=this.painter.context,b=_.gl,w=this._uniformValues,I=new Float64Array(16);for(let k=0;k<Jo.cascadeCount;k++)r.ad.mat4.multiply(I,this._cascades[k].matrix,a),w[k===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(I),_.activeTexture.set(b.TEXTURE0+Or.ShadowMap0+k),this._cascades[k].texture.bind(b.NEAREST,b.CLAMP_TO_EDGE);if(this.useNormalOffset=f,f){let k=Jo.normalOffset;w.u_shadow_normal_offset=[1,k,k],w.u_shadow_bias=[6e-5,.0012,.012]}else w.u_shadow_bias=[36e-5,.0012,.012];c.setShadowUniformValues(_,w)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(a,c,f,_){if(_[2]>=0)return{};let b=function(k,O,F){let z=F/(1<<k.canonical.z);return new r.ce([k.canonical.x*z+k.wrap*F,k.canonical.y*z+k.wrap*F,0],[(k.canonical.x+1)*z+k.wrap*F,(k.canonical.y+1)*z+k.wrap*F,O])}(a,c,f).getCorners(),w=c/-_[2];_[0]<0?(r.ad.vec3.add(b[0],b[0],[_[0]*w,0,0]),r.ad.vec3.add(b[3],b[3],[_[0]*w,0,0])):_[0]>0&&(r.ad.vec3.add(b[1],b[1],[_[0]*w,0,0]),r.ad.vec3.add(b[2],b[2],[_[0]*w,0,0])),_[1]<0?(r.ad.vec3.add(b[0],b[0],[0,_[1]*w,0]),r.ad.vec3.add(b[1],b[1],[0,_[1]*w,0])):_[1]>0&&(r.ad.vec3.add(b[2],b[2],[0,_[1]*w,0]),r.ad.vec3.add(b[3],b[3],[0,_[1]*w,0]));let I={};return I.vertices=b,I.planes=[sh(b[1],b[0],b[4]),sh(b[2],b[1],b[5]),sh(b[3],b[2],b[6]),sh(b[0],b[3],b[7])],I}addShadowReceiver(a,c,f){this._receivers.add(a,r.ce.fromTileIdAndHeight(a,c,f))}getMaxCascadeForTile(a){let c=this._receivers.get(a);return c&&c.lastCascade?c.lastCascade:0}}function sh(m,a,c){let f=r.ad.vec3.sub([],c,a),_=r.ad.vec3.sub([],m,a),b=r.ad.vec3.cross([],f,_),w=r.ad.vec3.length(b);return w===0?[0,0,1,0]:(r.ad.vec3.scale(b,b,1/w),[b[0],b[1],b[2],-r.ad.vec3.dot(b,a)])}function ld(m){let a=m.properties.get("direction"),c=r.cc(a.x,a.y,a.z);c[2]=r.ay(c[2],0,75);let f=r.cf([c[0],c[1],c[2]]);return r.ad.vec3.fromValues(f.x,f.y,f.z)}function lh(m,a,c){let f=a.properties.get("color-use-theme")==="none",_=a.properties.get("color"),b=a.properties.get("intensity"),w=a.properties.get("direction"),I=[w.x,w.y,w.z],k=c.properties.get("color-use-theme")==="none",O=c.properties.get("color"),F=c.properties.get("intensity"),z=Math.max(r.ad.vec3.dot([0,0,1],I),0),V=[0,0,0];r.ad.vec3.scale(V,O.toRenderColor(k?null:m.getLut(a.scope)).toArray01Linear().slice(0,3),F);let G=[0,0,0];return r.ad.vec3.scale(G,_.toRenderColor(f?null:m.getLut(c.scope)).toArray01Linear().slice(0,3),z*b),r.cg([V[0]>0?V[0]/(V[0]+G[0]):0,V[1]>0?V[1]/(V[1]+G[1]):0,V[2]>0?V[2]/(V[2]+G[2]):0])}function ch(m,a,c,f,_,b){let w=m.zoom,I=m.scale,k=m.worldSize,O=1/k,F=m.aspect,z=Math.sqrt(1+F*F)*Math.tan(.5*m.fovX),V=z*z,G=f-c,K=f+c,W,te;V>G/K?(W=f,te=f*z):(W=.5*K*(1+V),te=.5*Math.sqrt(G*G+2*(f*f+c*c)*V+K*K*V*V));let ne=m.projection.pixelsPerMeter(m.center.lat,k),he=m._camera.getCameraToWorldMercator(),_e=[0,0,-W*O];r.ad.vec3.transformMat4(_e,_e,he);let me=te*O,Se=m._edgeInsets;if(!(Se.left===0&&Se.top===0&&Se.right===0&&Se.bottom===0||Se.left===Se.right&&Se.top===Se.bottom)){let ht=m._camera.getWorldToCamera(m.worldSize,m.projection.zAxisUnit==="meters"?ne:1),Qe=m._camera.getCameraToClipPerspective(m._fov,m.width/m.height,c,f);Qe[8]=2*-m.centerOffset.x/m.width,Qe[9]=2*m.centerOffset.y/m.height;let mt=new Float64Array(16);r.ad.mat4.mul(mt,Qe,ht);let Nt=new Float64Array(16);r.ad.mat4.invert(Nt,mt);let zt=r.bR.fromInvProjectionMatrix(Nt,k,w,!0);for(let Vt of zt.points){let ei=((ve=Vt)[0]/=I,ve[1]/=I,ve[2]=r.bH(ve[2],m._center.lat),ve);me=Math.max(me,r.ad.vec3.len(r.ad.vec3.subtract([],_e,ei)))}}var ve;me*=_/(_-1);let be=Math.acos(a[2]),xe=Math.atan2(-a[0],-a[1]),Ae=new ah;Ae.position=_e,Ae.setPitchBearing(be,xe);let Oe=Ae.getWorldToCamera(k,ne),Ke=me*k,$e=Math.min(m._mercatorZfromZoom(17)*k*-2,-2*Ke),ct=Ae.getCameraToClipOrthographic(-Ke,Ke,-Ke,Ke,$e,(Ke+b*ne)/a[2]),ut=new Float64Array(16);r.ad.mat4.multiply(ut,ct,Oe);let St=r.ad.vec3.fromValues(Math.floor(1e6*_e[0])/1e6*k,Math.floor(1e6*_e[1])/1e6*k,0),He=.5*_,st=[0,0,0];r.ad.vec3.transformMat4(st,St,ut),r.ad.vec3.scale(st,st,He);let je=[Math.floor(st[0]),Math.floor(st[1]),Math.floor(st[2])],at=[0,0,0];r.ad.vec3.sub(at,st,je),r.ad.vec3.scale(at,at,-1/He);let rt=new Float64Array(16);return r.ad.mat4.identity(rt),r.ad.mat4.translate(rt,rt,at),r.ad.mat4.multiply(ut,rt,ut),[ut,Ke]}class MM extends r.E{constructor(a){super(),this.requestManager=a,this.models={"":{}},this.modelUris={"":{}},this.numModelsLoading={}}loadModel(a,c){return r.aN(this.requestManager.transformRequest(c,r.R.Model).url).then(f=>{if(!f)return;let _=r.aO(f),b=new r.aP(a,void 0,void 0,_);return b.computeBoundsAndApplyParent(),b}).catch(f=>{if(f&&f.status===404)return null;this.fire(new r.z(new Error(`Could not load model ${a} from ${c}: ${f.message}`)))})}load(a,c,f={keepNumReferences:!1}){this.models[c]||(this.models[c]={});let _=Object.keys(a);this.numModelsLoading[c]=(this.numModelsLoading[c]||0)+_.length;let b=[];for(let w of _)b.push(this.loadModel(w,a[w]));Promise.allSettled(b).then(w=>{for(let I=0;I<w.length;I++){let{status:k,value:O}=w[I];if(k==="fulfilled"&&O){let F=this.models[c][_[I]];this.models[c][_[I]]={model:O,numReferences:f.keepNumReferences&&F?F.numReferences:1}}}this.numModelsLoading[c]-=_.length,this.fire(new r.A("data",{dataType:"style"}))}).catch(w=>{this.fire(new r.z(new Error(`Could not load models: ${w.message}`)))})}isLoaded(){for(let a in this.numModelsLoading)if(this.numModelsLoading[a]>0)return!1;return!0}hasModel(a,c){return!!this.getModel(a,c)}getModel(a,c){return this.models[c]||(this.models[c]={}),this.models[c][a]?this.models[c][a].model:void 0}addModel(a,c,f){this.models[f]||(this.models[f]={}),this.modelUris[f]||(this.modelUris[f]={}),this.hasModel(a,f)&&this.models[f][a].numReferences++,this.modelUris[f][a]=this.requestManager.normalizeModelURL(c),this.load({[a]:this.modelUris[f][a]},f)}addModels(a,c){this.models[c]||(this.models[c]={}),this.modelUris[c]||(this.modelUris[c]={});let f=this.modelUris[c];for(let _ in a)this.models[c][_]={},f[_]=this.requestManager.normalizeModelURL(a[_]);this.load(f,c,{keepNumReferences:!0})}reloadModels(a){this.load(this.modelUris[a],a)}addModelsFromBucket(a,c){this.models[c]||(this.models[c]={}),this.modelUris[c]||(this.modelUris[c]={});let f={};for(let _ of a)this.hasModel(_,c)?this.models[c][_].numReferences++:(this.modelUris[c][_]=this.requestManager.normalizeModelURL(_),f[_]=this.modelUris[c][_]);this.load(f,c)}removeModel(a,c){if(this.models[c]&&this.models[c][a]&&(this.models[c][a].numReferences--,this.models[c][a].numReferences===0)){let f=this.models[c][a].model;delete this.models[c][a],delete this.modelUris[c][a],f.destroy()}}listModels(a){return this.models[a]||(this.models[a]={}),Object.keys(this.models[a])}upload(a,c){this.models[c]||(this.models[c]={});for(let f in this.models[c])this.models[c][f].model&&this.models[c][f].model.upload(a.context)}}let TM=new r.a7({data:new r.a8(r.a5.colorTheme.data)}),Jy={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function nw(m){return m=m||{},Object.assign(m,Jy)}class rw extends r.E{constructor(a){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},r.aQ(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=a,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(a=>{a.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new r.z(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=a.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=a.stylesheet.indoor.buildingFeaturesetId,this._scope=a.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:a=>(a.feature&&a.feature.properties.floorplan&&this.selectFloorplan(a.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(a){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(w,I){let[k,O]=w,{center:F,radius:z}=I,[V,G]=F,K=Math.abs(k-V);return Math.sqrt((K>180?360-K:K)**2+(O-G)**2)<=z}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new r.A("floorplangone")));let c={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},f=new r.P(this._map.transform.width/2,this._map.transform.height/2),_=[new r.P(0,0),new r.P(this._map.transform.width,this._map.transform.height)],b=this._map.queryRenderedFeatures(a?_:f,c);b.length>0&&(this._selectedFloorplan&&b[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=b[0],this._floorplanSelected(!1)))}_floorplanSelected(a){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(b){let[[w,I],[k,O]]=b,F=(k-w+360)%360,z=F>180?360-F:F;return{center:[(w+z/2+360)%360,(I+O)/2],radius:Math.sqrt(z**2+(O-I)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});let c=this._floorplanStates[this._indoorData.id].selectedBuilding,f=this._floorplanStates[this._indoorData.id].selectedLevel,_;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(let b of this._indoorData.levels)b.id===this._selectedLevel.id&&(_=b.id);if(this.fire(new r.A("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:_})),c){let b=this._indoorData.buildings.find(w=>w.id===c);this._buildingSelected(b,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(f){let b=this._indoorData.levels.find(w=>w.id===f);this._updateLevels(b,a)}else a&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(a,c){c&&a&&a.extent&&this._map.fitBounds(a.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=a?a.id:void 0;let f=this._indoorData.levels.filter(_=>a.levels.includes(_.id));this.fire(new r.A("buildingselected",{buildingId:a.id,levels:f}))}_levelSelected(a){if(a==="overview")this._updateLevels(void 0,!0);else{let c=this._indoorData.levels.find(f=>f.id===a);this._updateLevels(c,!0)}this.fire(new r.A("levelselected",{levelId:a==="overview"?void 0:a}))}_updateLevels(a,c){if(!a)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(c&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function f(O){let F=O.indexOf("/floor/");if(F===-1)return O;let z=F+7,V=O.indexOf("/",z);return V===-1?O.slice(z):O.slice(z,V)}this._selectedLevel=a,this._floorplanStates[this._indoorData.id].selectedLevel=a?a.id:void 0;let _=[],b={},w={},I={},k={};for(let O of this._indoorData.levels)if(_.push(O.id),b[O.id]=O.height,w[O.id]=O.base,a){if(this.mergeFloors){let F=f(a.id),z=f(O.id);I[O.id]=z===F?"true":"false"}else I[O.id]=O.id===a.id?"true":"false";k[O.id]=O.base<a.base?"true":"false"}else k[O.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",_]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",b]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",w]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",I]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",k]),a&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!a.isUnderground),c&&a.extent)){let O=this._map.cameraForBounds(a.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),F=this._map.getZoom(),z=O.zoom?Math.abs(F-O.zoom):0;this._map.fitBounds(a.extent,z>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:F})}}selectFloorplan(a){let c={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},f=[new r.P(0,0),new r.P(this._map.transform.width,this._map.transform.height)],_=this._map.queryRenderedFeatures(f,c);if(_.length>0){for(let b of _)if(JSON.parse(b.properties["indoor-data"]).floorplanIDs.includes(a)){this._selectedFloorplan=b,this._floorplanSelected(!0);break}}}selectBuilding(a){let c=this._indoorData.buildings.find(f=>f.id===a);this._buildingSelected(c,!0)}selectLevel(a){this._levelSelected(a)}}function ow(m){if(!m.metadata||!m.metadata.content_area)return;let a=r.q.devicePixelRatio,{left:c,top:f,width:_,height:b}=m.metadata.content_area,w=c*a,I=f*a;return[w,I,w+_*a,I+b*a]}function tg(m){if(m)return m.map(([a,c])=>[a*r.q.devicePixelRatio,c*r.q.devicePixelRatio])}class IM{constructor(a,c){this.id=a,this.style=c}addIcons(a){let c=new Map;for(let[f,_]of a.entries()){let b=r.I.from({name:f,iconsetId:this.id});c.set(b,_)}this.style.addImages(c)}}let nu=(m,a)=>Ze(m,a&&a.filter(c=>c.identifier!=="source.canvas")),AM=r.aA(wn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport"]),RM=r.aA(wn,["setCenter","setZoom","setBearing","setPitch"]),ig=new Set(["background","sky","slot","custom"]),aw={version:8,layers:[],sources:{}},sf={duration:300,delay:0};class ml extends r.E{constructor(a,c={}){super(),this.map=a,this.scope=c.scope||"",this.globalId=null,this.fragments=[],this.importDepth=c.importDepth||0,this.importsCache=c.importsCache||new Map,this.resolvedImports=c.resolvedImports||new Set,this.transition=r.l({},sf),this._buildingIndex=new Qx(this),this.crossTileSymbolIndex=new DM,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=c.styleChanges||new ma,this.dispatcher=c.dispatcher?c.dispatcher:new r.D(r.cj(),this),c.imageManager?this.imageManager=c.imageManager:(this.imageManager=new To(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=c.glyphManager?c.glyphManager:new r.ck(a._requestManager,c.localFontFamily?r.cl.all:c.localIdeographFontFamily?r.cl.ideographs:r.cl.none,c.localFontFamily||c.localIdeographFontFamily),c.modelManager?this.modelManager=c.modelManager:(this.modelManager=new MM(a._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=c.configOptions?c.configOptions:new Map,this._configDependentLayers=c.configDependentLayers?c.configDependentLayers:new Set,this._config=c.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:c.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=c.initialConfig,this.dispatcher.broadcast("setReferrer",r.cm());let f=this;this._rtlTextPluginCallback=ml.registerForPluginStateChange(_=>{f.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(b,w)=>{if(r.cn(b),w&&w.every(I=>I))for(let I in f._sourceCaches){let k=f._sourceCaches[I],O=k.getSource().type;O!=="vector"&&O!=="geojson"||k.reload()}})}),this.on("data",_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;let b=this.getOwnSource(_.sourceId);if(b&&b.vectorLayerIds)for(let w in this._layers){let I=this._layers[w];I.source===b.id&&this._validateLayer(I)}})}load(a){return a?(typeof a=="string"?this.loadURL(a):this.loadJSON(a),this):this}_getGlobalId(a){if(!a)return null;if(typeof a=="string"){if(r.f(a))return a;let c=r.co(a);if(!c.startsWith("http"))try{return new URL(c,location.href).toString()}catch{return c}return c}return`json://${r.cp(JSON.stringify(a))}`}_diffStyle(a,c,f){this.globalId=this._getGlobalId(a);let _=(b,w)=>{try{w(null,this.setState(b,f))}catch(I){w(I,!1)}};if(typeof a=="string"){let b=this.map._requestManager.normalizeStyleURL(a),w=this.map._requestManager.transformRequest(b,r.R.Style);r.n(w,(I,k)=>{I?this.fire(new r.z(I)):k&&_(k,c)})}else typeof a=="object"&&_(a,c)}loadURL(a,c={}){this.fire(new r.A("dataloading",{dataType:"style"}));let f=typeof c.validate=="boolean"?c.validate:!r.f(a);this.globalId=this._getGlobalId(a),a=this.map._requestManager.normalizeStyleURL(a,c.accessToken),this.resolvedImports.add(a);let _=this.importsCache.get(a);if(_)return this._load(_,f);let b=this.map._requestManager.transformRequest(a,r.R.Style);this._request=r.n(b,(w,I)=>{if(this._request=null,w)this.fire(new r.z(w));else if(I)return this.importsCache.set(a,I),this._load(I,f)})}loadJSON(a,c={}){this.fire(new r.A("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(a),this._request=r.q.frame(()=>{this._request=null,this._load(a,c.validate!==!1)})}loadEmpty(){this.fire(new r.A("dataloading",{dataType:"style"})),this._load(aw,!1)}_loadImports(a,c,f){if(this.importDepth>=4)return r.w("Style doesn't support nesting deeper than 5"),Promise.resolve();let _=[];for(let b of a){let w=this._createFragmentStyle(b),I=new Promise(F=>{w.once("style.import.load",F),w.once("error",F)}).then(()=>this.mergeAll());if(_.push(I),this.resolvedImports.has(b.url)){w.loadEmpty();continue}let k=b.data||this.importsCache.get(b.url);k?(w.loadJSON(k,{validate:c}),this._isInternalStyle(k)&&(w.globalId=null)):b.url?w.loadURL(b.url,{validate:c}):w.loadEmpty();let O={style:w,id:b.id,config:b.config};if(f){let F=this.fragments.findIndex(({id:z})=>z===f);this.fragments=this.fragments.slice(0,F).concat(O).concat(this.fragments.slice(F))}else this.fragments.push(O)}return Promise.allSettled(_)}getImportGlobalIds(a=this,c=new Set){for(let f of a.fragments)f.style.globalId&&c.add(f.style.globalId),this.getImportGlobalIds(f.style,c);return[...c.values()]}_createFragmentStyle(a){let c=this.scope?r.C(a.id,this.scope):a.id,f,_=this._initialConfig&&this._initialConfig[c];(a.config||_)&&(f=r.l({},a.config,_));let b=new ml(this.map,{scope:c,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:f,configOptions:this.options,colorThemeOverride:a["color-theme"],configDependentLayers:this._configDependentLayers});return b.setEventedParent(this.map,{style:b}),b}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(a){return this.isRootStyle()&&(a.fragment||!!a.schema&&a.fragment!==!1)}_load(a,c){let f=a.indoor?nw(a.schema):a.schema;if(this._isInternalStyle(a)){let w=r.l({},aw,{imports:[{id:"basemap",data:a,url:""}]});return void this._load(w,c)}if(this.updateConfig(this._config,f),c&&nu(this,Va(a)))return;this._loaded=!0,this.stylesheet=r.cq(a);let _=()=>{for(let O in a.sources)this.addSource(O,a.sources[O],{validate:!1,isInitialLoad:!0});if(a.iconsets)for(let O in a.iconsets)this.addIconset(O,a.iconsets[O]);a.sprite?this._loadIconset(a.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.setGlyphsUrl(a.glyphs);let w=Qp(this.stylesheet.layers);if(this._order=w.map(O=>O.id),this.stylesheet.light&&r.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){let O=this.stylesheet.lights[0];this.light=new Je(O.properties,O.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Je(this.stylesheet.light)),this._layers={};for(let O of w){let F=r.cv(O,this.scope,this._styleColorTheme.lut,this.options);F.configDependencies.size!==0&&this._configDependentLayers.add(F.fqid),F.setEventedParent(this,{layer:{id:F.id}}),this._layers[F.id]=F;let z=this.getOwnLayerSourceCache(F),V=!!this.directionalLight&&this.directionalLight.shadowsEnabled();z&&F.canCastShadows()&&V&&(z.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);let I=this.stylesheet.terrain;I&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(I,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new r.A("data",{dataType:"style"}));let k=this.isRootStyle();a.imports?this._loadImports(a.imports,c).then(()=>{this._reloadImports(),this.fire(new r.A(k?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new r.A(k?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];let b=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(b){let w=this._evaluateColorThemeData(b);this._loadColorTheme(w).then(()=>{_()}).catch(I=>{r.w(`Couldn't load color theme from the stylesheet: ${I}`),_()})}else this._styleColorTheme.lut=null,_()}isRootStyle(){return this.importDepth===0}mergeAll(){let a,c,f,_,b,w,I,k,O,F,z={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(V=>{if(V.stylesheet){if(V.light!=null&&(a=V.light),V.stylesheet.lights)for(let G of V.stylesheet.lights)G.type==="ambient"&&V.ambientLight!=null&&(c=V.ambientLight),G.type==="directional"&&V.directionalLight!=null&&(f=V.directionalLight);_=this._prioritizeTerrain(_,V.terrain,V.stylesheet.terrain),V.stylesheet.fog&&V.fog!=null&&(b=V.fog),V.stylesheet.snow&&V.snow!=null&&(w=V.snow),V.stylesheet.rain&&V.rain!=null&&(I=V.rain),V.stylesheet.camera!=null&&(F=V.stylesheet.camera),V.stylesheet.projection!=null&&(k=V.stylesheet.projection),V.stylesheet.transition!=null&&(O=V.stylesheet.transition),z[V.scope]=V._styleColorTheme}}),this.light=a,this.ambientLight=c,this.directionalLight=f,this.fog=b,this.snow=w,this.rain=I,this._styleColorThemeForScope=z,_===null?delete this.terrain:this.terrain=_,this.camera=F||{"camera-projection":"perspective"},this.projection=k||{name:"mercator"},this.transition=r.l({},sf,O),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(a){let c=f=>{for(let _ of f.fragments)c(_.style);a(f)};c(this)}_prioritizeTerrain(a,c,f){let _=a&&a.drapeRenderMode===0;return f===null?c&&c.drapeRenderMode===0?c:_?a:null:c!=null&&(!a||_||c&&c.drapeRenderMode===1)?c:a}mergeTerrain(){let a;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(c=>{a=this._prioritizeTerrain(a,c.terrain,c.stylesheet.terrain)}),a===null?delete this.terrain:this.terrain=a}mergeProjection(){let a;this.forEachFragmentStyle(c=>{c.stylesheet.projection!=null&&(a=c.stylesheet.projection)}),this.projection=a||{name:"mercator"}}mergeSources(){let a={},c={},f={};this.forEachFragmentStyle(_=>{for(let b in _._sourceCaches){let w=r.C(b,_.scope);a[w]=_._sourceCaches[b]}for(let b in _._otherSourceCaches){let w=r.C(b,_.scope);c[w]=_._otherSourceCaches[b]}for(let b in _._symbolSourceCaches){let w=r.C(b,_.scope);f[w]=_._symbolSourceCaches[b]}}),this._mergedSourceCaches=a,this._mergedOtherSourceCaches=c,this._mergedSymbolSourceCaches=f}mergeLayers(){let a={},c=[],f={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(b=>{for(let w of b._order){let I=b._layers[w];if(I.type==="slot"){let k=r.cr(w);if(a[k])continue;a[k]=[]}I.slot&&a[I.slot]?a[I.slot].push(I):c.push(I)}}),this._mergedOrder=[];let _=(b=[])=>{for(let w of b)if(w.type==="slot"){let I=r.cr(w.id);a[I]&&_(a[I]),this._mergedSlots.push(I)}else{let I=r.C(w.id,w.scope);this._mergedOrder.push(I),f[I]=w,w.is3D(!!this.terrain)&&(this._has3DLayers=!0),w.type==="circle"&&(this._hasCircleLayers=!0),w.type==="symbol"&&(this._hasSymbolLayers=!0),w.type==="clip"&&(this._clipLayerPresent=!0)}};_(c),this._mergedOrder.sort((b,w)=>{let I=f[b],k=f[w];return I.hasInitialOcclusionOpacityProperties?k.is3D(!!this.terrain)?1:0:I.is3D(!!this.terrain)&&k.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=f,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(a){return this.stylesheet.camera=r.l({},this.stylesheet.camera,a),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(a){return a.data?function(c,f,_){let b=r.l({},f);for(let I of Object.keys(r.a5.colorTheme))b[I]===void 0&&(b[I]=r.a5.colorTheme[I].default);let w=new r.a6(TM,c,new Map(_));return w.setTransitionOrValue(b,_),w.untransitioned().possiblyEvaluate(new r.aa(0))}(this.scope,a,this.options).get("data"):null}_loadColorTheme(a){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;let c=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((f,_)=>{let b="data:image/png;base64,";if(!a||a.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void f();let w=a;w.startsWith(b)||(w=b+w);let I=r.I.from("mapbox-reserved-lut"),k=new Image;k.src=w,k.onerror=()=>{this._styleColorTheme.lutLoading=!1,_(new Error("Failed to load image data"))},k.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==c)return void f();this._styleColorTheme.lutLoading=!1;let{width:O,height:F,data:z}=r.q.getImageData(k);if(F>32)return void _(new Error("The height of the image must be less than or equal to 32 pixels."));if(O!==F*F)return void _(new Error("The width of the image must be equal to the height squared."));this.getImage(I)&&this.removeImage(I),this.addImage(I,{data:new r.r({width:O,height:F},z),pixelRatio:1,sdf:!1,usvg:!1,version:0});let V=this.imageManager.getImage(I,this.scope);V?(this._styleColorTheme.lut={image:V.data,data:a},f()):_(new Error("Missing LUT image."))}})}getLut(a){let c=this._styleColorThemeForScope[a];return c?c.lut:null}setProjection(a){a?this.stylesheet.projection=a:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(a){this._spriteRequest=function(c,f,_){let b,w,I,k=r.q.devicePixelRatio>1?"@2x":"",O=r.n(f.transformRequest(f.normalizeSpriteURL(c,k,".json"),r.R.SpriteJSON),(V,G)=>{O=null,I||(I=V,b=G,z())}),F=r.o(f.transformRequest(f.normalizeSpriteURL(c,k,".png"),r.R.SpriteImage),(V,G)=>{F=null,I||(I=V,w=G,z())});function z(){if(I)_(I);else if(b&&w){let V=r.q.getImageData(w),G={};for(let K in b){let{width:W,height:te,x:ne,y:he,sdf:_e,pixelRatio:me,stretchX:Se,stretchY:ve,content:be}=b[K],xe=new r.r({width:W,height:te});r.r.copy(V,xe,{x:ne,y:he},{x:0,y:0},{width:W,height:te},null),G[K]={data:xe,pixelRatio:me,sdf:_e,stretchX:Se,stretchY:ve,content:be,usvg:!1}}_(null,G)}}return{cancel(){O&&(O.cancel(),O=null),F&&(F.cancel(),F=null)}}}(a,this.map._requestManager,(c,f)=>{if(this._spriteRequest=null,c)this.fire(new r.z(c));else if(f){let _=new Map;for(let b in f)_.set(r.I.from(b),f[b]);this.addImages(_)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new r.A("data",{dataType:"style"}))})}addIconset(a,c){if(c.type==="sprite")return void this._loadSprite(c.url);let f=this.getOwnSource(c.source);if(!f)return void this.fire(new r.z(new Error(`Source "${c.source}" as specified by iconset "${a}" does not exist and cannot be used as an iconset source`)));if(f.type!=="raster-array")return void this.fire(new r.z(new Error(`Source "${c.source}" as specified by iconset "${a}" is not a "raster-array" source and cannot be used as an iconset source`)));this.imageManager.createIconset(this.scope,a);let _=new IM(a,this);f.addIconset(a,_)}_loadIconset(a){if(!r.f(a)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(a);let c=this.map._spriteFormat==="auto";var f,_;this._spriteRequest=(_=(b,w)=>{if(this._spriteRequest=null,b)c?this._loadSprite(a):this.fire(new r.z(b));else if(w){let I=new Map;for(let k in w)I.set(r.I.from(k),w[k]);this.addImages(I)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new r.A("data",{dataType:"style"}))},r.bj((f=this.map._requestManager).transformRequest(f.normalizeIconsetURL(a),r.R.Iconset),(b,w)=>{if(b)return void _(b);let I={},k=r.ch(new r.bi(w));for(let O of k.icons){let F={version:1,pixelRatio:r.q.devicePixelRatio,content:ow(O),stretchX:O.metadata?tg(O.metadata.stretch_x_areas):void 0,stretchY:O.metadata?tg(O.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:O};I[O.name]=F}_(null,I)}))}_validateLayer(a){let c=this.getOwnSource(a.source);if(!c)return;let f=a.sourceLayer;f&&(c.type==="geojson"||c.vectorLayerIds&&c.vectorLayerIds.indexOf(f)===-1)&&this.fire(new r.z(new Error(`Source layer "${f}" does not exist on source "${c.id}" as specified by style layer "${a.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(let a in this._sourceCaches)if(!this._sourceCaches[a].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(let{style:a}of this.fragments)if(!a.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((a,c)=>{let f=this.fragments[c];return f&&f.style&&(a.data=f.style.serialize()),a})}_serializeSources(){let a={};for(let c in this._sourceCaches){let f=this._sourceCaches[c].getSource();a[f.id]||(a[f.id]=f.serialize())}return a}_serializeLayers(a){let c=[];for(let f of a){let _=this._layers[f];_&&_.type!=="custom"&&c.push(_.serialize())}return c}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(let a in this._sourceCaches)if(this._sourceCaches[a].hasTransition())return!0;for(let a in this._layers)if(this._layers[a].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(a){return a?this.order:this._mergedOrder}isLayerDraped(a){return!!this.terrain&&a.isDraped(this.getLayerSourceCache(a))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(a){let c=this.getOwnLayer(a);if(c)return c;this.fire(new r.z(new Error(`The layer '${a}' does not exist in the map's style.`)))}_checkSource(a){let c=this.getOwnSource(a);if(c)return c;this.fire(new r.z(new Error(`The source '${a}' does not exist in the map's style.`)))}precompilePrograms(a,c){let f=this.map.painter;if(f)for(let _=a.minzoom||0;_<(a.maxzoom||25.5);_++){let b=a.getProgramIds();if(b)for(let w of b){let I=a.getDefaultProgramParams(w,c.zoom,this._styleColorTheme.lut);I&&(f.style=this,this.fog&&(f._fogVisible=!0,I.overrideFog=!0,f.getOrCreateProgram(w,I)),f._fogVisible=!1,I.overrideFog=!1,f.getOrCreateProgram(w,I),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(I.overrideRtt=!0,f.getOrCreateProgram(w,I)))}}}update(a){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(a),this.directionalLight&&this.directionalLight.recalculate(a);let c=this.calculateLightsBrightness();a.brightness=c||0,c!==this._brightness&&(this._brightness=c,this.dispatcher.broadcast("setBrightness",c));let f=this._changes.isDirty(),_=!1;if(this._changes.isDirty()){let w=this._changes.getLayerUpdatesByScope();for(let I in w){let{updatedIds:k,removedIds:O}=w[I];(k||O)&&(this._updateWorkerLayers(I,k,O),_=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(a),this.light&&this.light.updateTransitions(a),this.ambientLight&&this.ambientLight.updateTransitions(a),this.directionalLight&&this.directionalLight.updateTransitions(a),this.fog&&this.fog.updateTransitions(a),this.snow&&this.snow.updateTransitions(a),this.rain&&this.rain.updateTransitions(a),this._changes.reset()}let b={};for(let w in this._mergedSourceCaches){let I=this._mergedSourceCaches[w];b[w]=I.used,I.used=!1,I.tileCoverLift=0}for(let w of this._mergedOrder){let I=this._mergedLayers[w];if(I.recalculate(a,this._availableImages),!I.isHidden(a.zoom)){let k=this.getLayerSourceCache(I);k&&(k.used=!0,k.tileCoverLift=Math.max(k.tileCoverLift,I.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(I,a)}):this.precompilePrograms(I,a))}for(let w in this._mergedSourceCaches){let I=this._mergedSourceCaches[w];if(!I)continue;let k=I._source;k.type==="raster-array"&&k.iconsets&&(I.used=!0)}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&_&&this.mergeLayers();for(let w in b){let I=this._mergedSourceCaches[w];b[w]!==I.used&&I.getSource().fire(new r.A("data",{sourceDataType:"visibility",dataType:"source",sourceId:I.getSource().id}))}this.light&&this.light.recalculate(a),this.terrain&&this.terrain.recalculate(a),this.fog&&this.fog.recalculate(a),this.snow&&this.snow.recalculate(a),this.rain&&this.rain.recalculate(a),this.z=a.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),f&&this.fire(new r.A("data",{dataType:"style"}))}_updateTilesForChangedImages(){let a=this._changes.getUpdatedImages();if(a.length){for(let c in this._mergedSourceCaches)this._mergedSourceCaches[c].reloadTilesForDependencies(["icons","patterns"],a);this._changes.resetUpdatedImages()}}_updateWorkerLayers(a,c,f){let _=this.getFragmentStyle(a);_&&this.dispatcher.broadcast("updateLayers",{layers:c?_._serializeLayers(c):[],scope:a,removedIds:f||[],options:_.options})}setState(a,c){if(this._checkLoaded(),nu(this,Va(a)))return!1;(a=r.cq(a)).layers=Qp(a.layers);let f=function(w,I){if(!w)return[{command:wn.setStyle,args:[I]}];let k=[];try{if(!r.bn(w.version,I.version))return[{command:wn.setStyle,args:[I]}];if(r.bn(w.center,I.center)||k.push({command:wn.setCenter,args:[I.center]}),r.bn(w.zoom,I.zoom)||k.push({command:wn.setZoom,args:[I.zoom]}),r.bn(w.bearing,I.bearing)||k.push({command:wn.setBearing,args:[I.bearing]}),r.bn(w.pitch,I.pitch)||k.push({command:wn.setPitch,args:[I.pitch]}),r.bn(w.sprite,I.sprite)||k.push({command:wn.setSprite,args:[I.sprite]}),r.bn(w.glyphs,I.glyphs)||k.push({command:wn.setGlyphs,args:[I.glyphs]}),r.bn(w.imports,I.imports)||function(G=[],K=[],W){K=K||[];let te=(G=G||[]).map(gn),ne=K.map(gn),he=G.reduce(ya,{}),_e=K.reduce(ya,{}),me=te.slice(),Se,ve,be,xe;for(Se=0,ve=0;Se<te.length;Se++)be=te[Se],_e.hasOwnProperty(be)?ve++:(W.push({command:wn.removeImport,args:[be]}),me.splice(me.indexOf(be,ve),1));for(Se=0,ve=0;Se<ne.length;Se++)be=ne[ne.length-1-Se],me[me.length-1-Se]!==be&&(he.hasOwnProperty(be)?(W.push({command:wn.removeImport,args:[be]}),me.splice(me.lastIndexOf(be,me.length-ve),1)):ve++,xe=me[me.length-Se],W.push({command:wn.addImport,args:[_e[be],xe]}),me.splice(me.length-Se,0,be));for(let Ae of K){let Oe=he[Ae.id];Oe&&!r.bn(Oe,Ae)&&W.push({command:wn.updateImport,args:[Ae.id,Ae]})}}(w.imports,I.imports,k),r.bn(w.transition,I.transition)||k.push({command:wn.setTransition,args:[I.transition]}),r.bn(w.light,I.light)||k.push({command:wn.setLight,args:[I.light]}),r.bn(w.fog,I.fog)||k.push({command:wn.setFog,args:[I.fog]}),r.bn(w.snow,I.snow)||k.push({command:wn.setSnow,args:[I.snow]}),r.bn(w.rain,I.rain)||k.push({command:wn.setRain,args:[I.rain]}),r.bn(w.projection,I.projection)||k.push({command:wn.setProjection,args:[I.projection]}),r.bn(w.lights,I.lights)||k.push({command:wn.setLights,args:[I.lights]}),r.bn(w.camera,I.camera)||k.push({command:wn.setCamera,args:[I.camera]}),!r.bn(w["color-theme"],I["color-theme"]))return[{command:wn.setStyle,args:[I]}];let O={},F=[];(function(G,K,W,te){let ne;for(ne in K=K||{},G=G||{})G.hasOwnProperty(ne)&&(K.hasOwnProperty(ne)||Ym(ne,W,te));for(ne in K){if(!K.hasOwnProperty(ne))continue;let he=K[ne];G.hasOwnProperty(ne)?r.bn(G[ne],he)||(G[ne].type==="geojson"&&he.type==="geojson"&&ii(G,K,ne)?W.push({command:wn.setGeoJSONSourceData,args:[ne,he.data]}):Ju(ne,K,W,te)):zs(ne,K,W)}})(w.sources,I.sources,F,O);let z=[];w.layers&&w.layers.forEach(G=>{G.source&&O[G.source]?k.push({command:wn.removeLayer,args:[G.id]}):z.push(G)});let V=w.terrain;V&&O[V.source]&&(k.push({command:wn.setTerrain,args:[void 0]}),V=void 0),k=k.concat(F),r.bn(V,I.terrain)||k.push({command:wn.setTerrain,args:[I.terrain]}),function(G,K,W){K=K||[];let te=(G=G||[]).map(gn),ne=K.map(gn),he=G.reduce(ya,{}),_e=K.reduce(ya,{}),me=te.slice(),Se=Object.create(null),ve,be,xe,Ae,Oe,Ke,$e;for(ve=0,be=0;ve<te.length;ve++)xe=te[ve],_e.hasOwnProperty(xe)?be++:(W.push({command:wn.removeLayer,args:[xe]}),me.splice(me.indexOf(xe,be),1));for(ve=0,be=0;ve<ne.length;ve++)xe=ne[ne.length-1-ve],me[me.length-1-ve]!==xe&&(he.hasOwnProperty(xe)?(W.push({command:wn.removeLayer,args:[xe]}),me.splice(me.lastIndexOf(xe,me.length-be),1)):be++,Ke=me[me.length-ve],W.push({command:wn.addLayer,args:[_e[xe],Ke]}),me.splice(me.length-ve,0,xe),Se[xe]=!0);for(ve=0;ve<ne.length;ve++)if(xe=ne[ve],Ae=he[xe],Oe=_e[xe],!Se[xe]&&!r.bn(Ae,Oe))if(r.bn(Ae.source,Oe.source)&&r.bn(Ae["source-layer"],Oe["source-layer"])&&r.bn(Ae.type,Oe.type)){for($e in Rn(Ae.layout,Oe.layout,W,xe,null,wn.setLayoutProperty),Rn(Ae.paint,Oe.paint,W,xe,null,wn.setPaintProperty),r.bn(Ae.slot,Oe.slot)||W.push({command:wn.setSlot,args:[xe,Oe.slot]}),r.bn(Ae.filter,Oe.filter)||W.push({command:wn.setFilter,args:[xe,Oe.filter]}),r.bn(Ae.minzoom,Oe.minzoom)&&r.bn(Ae.maxzoom,Oe.maxzoom)||W.push({command:wn.setLayerZoomRange,args:[xe,Oe.minzoom,Oe.maxzoom]}),Ae)Ae.hasOwnProperty($e)&&$e!=="layout"&&$e!=="paint"&&$e!=="filter"&&$e!=="metadata"&&$e!=="minzoom"&&$e!=="maxzoom"&&$e!=="slot"&&($e.indexOf("paint.")===0?Rn(Ae[$e],Oe[$e],W,xe,$e.slice(6),wn.setPaintProperty):r.bn(Ae[$e],Oe[$e])||W.push({command:wn.setLayerProperty,args:[xe,$e,Oe[$e]]}));for($e in Oe)Oe.hasOwnProperty($e)&&!Ae.hasOwnProperty($e)&&$e!=="layout"&&$e!=="paint"&&$e!=="filter"&&$e!=="metadata"&&$e!=="minzoom"&&$e!=="maxzoom"&&$e!=="slot"&&($e.indexOf("paint.")===0?Rn(Ae[$e],Oe[$e],W,xe,$e.slice(6),wn.setPaintProperty):r.bn(Ae[$e],Oe[$e])||W.push({command:wn.setLayerProperty,args:[xe,$e,Oe[$e]]}))}else W.push({command:wn.removeLayer,args:[xe]}),Ke=me[me.lastIndexOf(xe)+1],W.push({command:wn.addLayer,args:[Oe,Ke]})}(z,I.layers,k)}catch(O){console.warn("Unable to compute style diff:",O),k=[{command:wn.setStyle,args:[I]}]}return k}(this.serialize(),a).filter(w=>!(w.command in RM));if(f.length===0)return!1;let _=f.filter(w=>!(w.command in AM));if(_.length>0)throw new Error(`Unimplemented: ${_.map(w=>w.command).join(", ")}.`);let b=[];return f.forEach(w=>{b.push(this[w.command].apply(this,w.args))}),c&&Promise.all(b).then(c),this.stylesheet=a,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}addImages(a){for(let[c,f]of a.entries()){if(this.getImage(c)&&!c.iconsetId)return this.fire(new r.z(new Error(`An image with the name "${c.name}" already exists.`)));this.imageManager.addImage(c,this.scope,f),this._changes.updateImage(c)}return this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})),this}addImage(a,c){return this.getImage(a)&&!a.iconsetId?this.fire(new r.z(new Error(`An image with the name "${a.name}" already exists.`))):(this.imageManager.addImage(a,this.scope,c),this._changes.updateImage(a),this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})),this)}updateImage(a,c,f=!1){this.imageManager.updateImage(a,this.scope,c),f&&(this._changes.updateImage(a),this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})))}getImage(a){return this.imageManager.getImage(a,this.scope)}removeImage(a){return this.getImage(a)?(this.imageManager.removeImage(a,this.scope),this._changes.updateImage(a),this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})),this):this.fire(new r.z(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(a,c,f={}){return this._checkLoaded(),this._validate(Ie,`models.${a}`,c,null,f)||(this.modelManager.addModel(a,c,this.scope),this._changes.setDirty()),this}hasModel(a){return this.modelManager.hasModel(a,this.scope)}removeModel(a){return this.hasModel(a)?(this.modelManager.removeModel(a,this.scope),this):this.fire(new r.z(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(a,c,f={}){if(this._checkLoaded(),this.getOwnSource(a)!==void 0)throw new Error(`There is already a source with ID "${a}".`);if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(Qd,`sources.${a}`,c,null,f))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);let _=qm(a,c,this.dispatcher,this);_.scope=this.scope,_.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(_.id),source:_.serialize(),sourceId:_.id}));let b=w=>{let I=(w?"symbol:":"other:")+_.id,k=r.C(I,this.scope),O=this._sourceCaches[I]=new Ns(k,_,w);(w?this._symbolSourceCaches:this._otherSourceCaches)[_.id]=O,O.onAdd(this.map)};b(!1),c.type!=="vector"&&c.type!=="geojson"||b(!0),_.onAdd&&_.onAdd(this.map),f.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(a){this._checkLoaded();let c=this.getOwnSource(a);if(!c)throw new Error("There is no source with this ID");for(let _ in this._layers)if(this._layers[_].source===a)return this.fire(new r.z(new Error(`Source "${a}" cannot be removed while layer "${_}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===a)return this.fire(new r.z(new Error(`Source "${a}" cannot be removed while terrain is using it.`)));let f=this.getOwnSourceCaches(a);for(let _ of f){let b=r.cr(_.id);delete this._sourceCaches[b],this._changes.discardSourceCacheUpdate(_.id),_.fire(new r.A("data",{sourceDataType:"metadata",dataType:"source",sourceId:_.getSource().id})),_.setEventedParent(null),_.clearTiles()}return delete this._otherSourceCaches[a],delete this._symbolSourceCaches[a],this.mergeSources(),c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(a,c){this._checkLoaded(),this.getOwnSource(a).setData(c),this._changes.setDirty()}getOwnSource(a){let c=this.getOwnSourceCache(a);return c&&c.getSource()}getOwnSources(){let a=[];for(let c in this._otherSourceCaches){let f=this.getOwnSourceCache(c);f&&a.push(f.getSource())}return a}areTilesLoaded(){let a=this._mergedSourceCaches;for(let c in a){let f=a[c]._tiles;for(let _ in f){let b=f[_];if(b.state!=="loaded"&&b.state!=="errored")return!1}}return!0}setLights(a){if(this._checkLoaded(),!a)return delete this.ambientLight,void delete this.directionalLight;let c=this._getTransitionParameters();for(let _ of a){if(this._validate(Yu,"lights",_))return;switch(_.type){case"ambient":if(this.ambientLight){let b=this.ambientLight;b.set(_),b.updateTransitions(c)}else this.ambientLight=new Fr(_,nn||(nn=new r.a7({color:new r.a8(r.a5.properties_light_ambient.color),"color-use-theme":new r.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new r.a8(r.a5.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){let b=this.directionalLight;b.set(_),b.updateTransitions(c)}else this.directionalLight=new Fr(_,On||(On=new r.a7({direction:new r.am(r.a5.properties_light_directional.direction),color:new r.a8(r.a5.properties_light_directional.color),"color-use-theme":new r.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new r.a8(r.a5.properties_light_directional.intensity),"cast-shadows":new r.a8(r.a5.properties_light_directional["cast-shadows"]),"shadow-quality":new r.a8(r.a5.properties_light_directional["shadow-quality"]),"shadow-intensity":new r.a8(r.a5.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}let f=new r.aa(this.z||0,c);this.ambientLight&&this.ambientLight.recalculate(f),this.directionalLight&&this.directionalLight.recalculate(f),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){let a=this.directionalLight,c=this.ambientLight;if(!a||!c)return;let f=V=>.2126*(V[0]<=.03928?V[0]/12.92:Math.pow((V[0]+.055)/1.055,2.4))+.7152*(V[1]<=.03928?V[1]/12.92:Math.pow((V[1]+.055)/1.055,2.4))+.0722*(V[2]<=.03928?V[2]/12.92:Math.pow((V[2]+.055)/1.055,2.4)),_=a.properties.get("color").toRenderColor(null).toArray01(),b=a.properties.get("intensity"),w=a.properties.get("direction"),I=1-r.cc(w.x,w.y,w.z)[2]/90,k=f(_)*b*I,O=c.properties.get("color").toRenderColor(null).toArray01(),F=c.properties.get("intensity"),z=f(O)*F;return Number(((k+z)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;let a=[];return this.directionalLight&&a.push(this.directionalLight.get()),this.ambientLight&&a.push(this.ambientLight.get()),a}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(a){if(!a)return this;if(r.cs(a)){let c=r.ct(a),f=this.fragments.find(({id:b})=>b===c);if(!f)throw new Error(`Style import '${a}' not found`);let _=r.cr(a);return f.style.getFragmentStyle(_)}{let c=this.fragments.find(({id:f})=>f===a);return c?c.style:void 0}}setFeaturesetSelectors(a){if(!a)return;let c={},f=(_,b="")=>`${_}::${b}`;this._featuresetSelectors={};for(let _ in a){let b=this._featuresetSelectors[_]=[];for(let w of a[_].selectors){if(w.featureNamespace){let k=this.getOwnLayer(w.layer);if(!k){r.w(`Layer is undefined for selector: ${w.layer}`);continue}let O=f(k.source,k.sourceLayer);if(O in c&&c[O]!==w.featureNamespace){r.w(`"featureNamespace ${w.featureNamespace} of featureset ${_}'s selector is not associated to the same source, skip this selector`);continue}c[O]=w.featureNamespace}let I;if(w.properties)for(let k in w.properties){let O=r.X(w.properties[k]);O.result==="success"&&(I=I||{},I[k]=O.value)}b.push({layerId:w.layer,namespace:w.featureNamespace,properties:I,uniqueFeatureID:w._uniqueFeatureID})}}}getFeaturesetDescriptors(a){let c=this.getFragmentStyle(a);if(!c||!c.stylesheet.featuresets)return[];let f=[];for(let _ in c.stylesheet.featuresets)f.push({featuresetId:_,importId:c.scope?c.scope:void 0});return f}getFeaturesetLayers(a,c){let f=this.getFragmentStyle(c),_=f.stylesheet.featuresets;if(!_||!_[a])return this.fire(new r.z(new Error(`The featureset '${a}' does not exist in the map's style and cannot be queried.`))),[];let b=[];for(let w of _[a].selectors){let I=f.getOwnLayer(w.layer);I&&b.push(I)}return b}getConfigProperty(a,c){let f=this.getFragmentStyle(a);if(!f)return null;let _=r.C(c,f.scope),b=f.options.get(_),w=b?b.value||b.default:null;return w?w.serialize():null}setConfigProperty(a,c,f){let _=this.getFragmentStyle(a);if(!_)return;let b=_.stylesheet.indoor?nw(_.stylesheet.schema):_.stylesheet.schema;if(!b||!b[c])return;let w=r.X(f);if(w.result!=="success")return void nu(this,w.value);let I=w.value.expression,k=r.C(c,_.scope),O=_.options.get(k);if(!O)return;let F,{minValue:z,maxValue:V,stepValue:G,type:K,values:W}=b[c],te=r.X(b[c].default);te.result==="success"&&(F=te.value.expression),F?(this.options.set(k,Object.assign({},O,{value:I,default:F,minValue:z,maxValue:V,stepValue:G,type:K,values:W})),this.updateConfigDependencies(c)):this.fire(new r.z(new Error(`No schema defined for the config option "${c}" in the "${a}" fragment.`)))}getConfig(a){let c=this.getFragmentStyle(a);if(!c)return null;let f=c.stylesheet.schema;if(!f)return null;let _={};for(let b in f){let w=r.C(b,c.scope),I=c.options.get(w),k=I?I.value||I.default:null;_[b]=k?k.serialize():null}return _}setConfig(a,c){let f=this.getFragmentStyle(a);f&&(f.updateConfig(c,f.stylesheet.schema),this.updateConfigDependencies())}getSchema(a){let c=this.getFragmentStyle(a);return c?c.stylesheet.schema:null}setSchema(a,c){let f=this.getFragmentStyle(a);f&&(f.stylesheet.schema=c,f.updateConfig(f._config,c),this.updateConfigDependencies())}updateConfig(a,c){if(this._config=a,a||c)if(c)for(let f in c){let _,b,w=r.X(c[f].default);if(w.result==="success"&&(_=w.value.expression),a&&a[f]!==void 0){let V=r.X(a[f]);V.result==="success"&&(b=V.value.expression)}let{minValue:I,maxValue:k,stepValue:O,type:F,values:z}=c[f];if(_){let V=r.C(f,this.scope);this.options.set(V,{default:_,value:b,minValue:I,maxValue:k,stepValue:O,type:F,values:z})}else this.fire(new r.z(new Error(`No schema defined for config option "${f}".`)))}else this.fire(new r.z(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(a){for(let c of this._configDependentLayers){let f=this.getLayer(c);if(f){if(a&&!f.configDependencies.has(a))continue;f.possiblyEvaluateVisibility(),this._updateLayer(f)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(c=>{let f=c._styleColorTheme.colorThemeOverride?c._styleColorTheme.colorThemeOverride:c._styleColorTheme.colorTheme;if(f){let _=c._evaluateColorThemeData(f);(!c._styleColorTheme.lut&&_!==""||c._styleColorTheme.lut&&_!==c._styleColorTheme.lut.data)&&c.setColorTheme(f)}}),this._changes.setDirty()}addLayer(a,c,f={}){this._checkLoaded();let _=a.id;if(this._layers[_])return void this.fire(new r.z(new Error(`Layer with id "${_}" already exists on this map`)));let b;if(a.type==="custom"){if(nu(this,r.cu(a)))return;b=r.cv(a,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof a.source=="object"&&(this.addSource(_,a.source),a=r.cq(a),a=r.l(a,{source:_})),this._validate(ie,`layers.${_}`,a,{arrayIndex:-1},f))return;b=r.cv(a,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(b),b.setEventedParent(this,{layer:{id:_}})}b.configDependencies.size!==0&&this._configDependentLayers.add(b.fqid);let w=this._order.length;if(c){let F=this._order.indexOf(c);if(F===-1)return void this.fire(new r.z(new Error(`Layer with id "${c}" does not exist on this map.`)));b.slot===this._layers[c].slot?w=F:r.w(`Layer with id "${c}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(w,0,_),this._layerOrderChanged=!0,this._layers[_]=b;let I=this.getOwnLayerSourceCache(b),k=!!this.directionalLight&&this.directionalLight.shadowsEnabled();I&&b.canCastShadows()&&k&&(I.castsShadows=!0);let O=this._changes.getRemovedLayer(b);if(O&&b.source&&I&&b.type!=="custom"){this._changes.discardLayerRemoval(b);let F=r.C(b.source,b.scope);O.type!==b.type?this._changes.updateSourceCache(F,"clear"):(this._changes.updateSourceCache(F,"reload"),I.pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map),b.scope=this.scope,this.mergeLayers()}moveLayer(a,c){this._checkLoaded();let f=this._checkLayer(a);if(!f||a===c)return;let _=this._order.indexOf(a);this._order.splice(_,1);let b=this._order.length;if(c){let w=this._order.indexOf(c);if(w===-1)return void this.fire(new r.z(new Error(`Layer with id "${c}" does not exist on this map.`)));f.slot===this._layers[c].slot?b=w:r.w(`Layer with id "${c}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(b,0,a),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(a){this._checkLoaded();let c=this._checkLayer(a);if(!c)return;c.setEventedParent(null);let f=this._order.indexOf(a);this._order.splice(f,1),delete this._layers[a],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(c.fqid),this._changes.removeLayer(c);let _=this.getOwnLayerSourceCache(c);if(_&&_.castsShadows){let b=!1;for(let w in this._layers)if(this._layers[w].source===c.source&&this._layers[w].canCastShadows()){b=!0;break}_.castsShadows=b}c.onRemove&&c.onRemove(this.map),this.mergeLayers()}getOwnLayer(a){return this._layers[a]}hasLayer(a){return a in this._mergedLayers}hasLayerType(a){for(let c in this._layers)if(this._layers[c].type===a)return!0;return!1}setLayerZoomRange(a,c,f){this._checkLoaded();let _=this._checkLayer(a);_&&(_.minzoom===c&&_.maxzoom===f||(c!=null&&(_.minzoom=c),f!=null&&(_.maxzoom=f),this._updateLayer(_)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(a,c){this._checkLoaded();let f=this._checkLayer(a);f&&f.slot!==c&&(f.slot=c,this._updateLayer(f))}setFilter(a,c,f={}){this._checkLoaded();let _=this._checkLayer(a);if(_&&!r.bn(_.filter,c))return c==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(se,`layers.${_.id}.filter`,c,{layerType:_.type},f)||(_.filter=r.cq(c),this._updateLayer(_)))}getFilter(a){let c=this._checkLayer(a);if(c)return r.cq(c.filter)}setLayoutProperty(a,c,f,_={}){this._checkLoaded();let b=this._checkLayer(a);if(b&&!r.bn(b.getLayoutProperty(c),f)){if(f!=null&&(!_||_.validate!==!1)&&nu(b,ke.call(Va,{key:`layers.${a}.layout.${c}`,layerType:b.type,objectKey:c,value:f,styleSpec:r.a5,style:{glyphs:!0,sprite:!0}})))return;b.setLayoutProperty(c,f),b.configDependencies.size!==0&&this._configDependentLayers.add(b.fqid),this._updateLayer(b)}}getLayoutProperty(a,c){let f=this._checkLayer(a);if(f)return f.getLayoutProperty(c)}setPaintProperty(a,c,f,_={}){this._checkLoaded();let b=this._checkLayer(a);if(!b||r.bn(b.getPaintProperty(c),f)||f!=null&&(!_||_.validate!==!1)&&nu(b,ye.call(Va,{key:`layers.${a}.paint.${c}`,layerType:b.type,objectKey:c,value:f,styleSpec:r.a5})))return;let w=b.setPaintProperty(c,f);b.configDependencies.size!==0&&this._configDependentLayers.add(b.fqid),w&&this._updateLayer(b),this._changes.updatePaintProperties(b)}getPaintProperty(a,c){let f=this._checkLayer(a);if(f)return f.getPaintProperty(c)}setFeatureState(a,c){if(this._checkLoaded(),"target"in a){if("featuresetId"in a.target){let{featuresetId:k,importId:O}=a.target,F=this.getFragmentStyle(O),z=F.getFeaturesetLayers(k);for(let{source:V,sourceLayer:G}of z)F.setFeatureState({id:a.id,source:V,sourceLayer:G},c)}else if("layerId"in a.target){let{layerId:k}=a.target,O=this.getLayer(k);this.setFeatureState({id:a.id,source:O.source,sourceLayer:O.sourceLayer},c)}return}let f=a.source,_=a.sourceLayer,b=this._checkSource(f);if(!b)return;let w=b.type;if(w==="geojson"&&_)return void this.fire(new r.z(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(w==="vector"&&!_)return void this.fire(new r.z(new Error("The sourceLayer parameter must be provided for vector source types.")));a.id===void 0&&this.fire(new r.z(new Error("The feature id parameter must be provided.")));let I=this.getOwnSourceCaches(f);for(let k of I)k.setFeatureState(_,a.id,c)}removeFeatureState(a,c){if(this._checkLoaded(),"target"in a){if("featuresetId"in a.target){let{featuresetId:k,importId:O}=a.target,F=this.getFragmentStyle(O),z=F.getFeaturesetLayers(k);for(let{source:V,sourceLayer:G}of z)F.removeFeatureState({id:a.id,source:V,sourceLayer:G},c)}else if("layerId"in a.target){let{layerId:k}=a.target,O=this.getLayer(k);this.removeFeatureState({id:a.id,source:O.source,sourceLayer:O.sourceLayer},c)}return}let f=a.source,_=this._checkSource(f);if(!_)return;let b=_.type,w=b==="vector"?a.sourceLayer:void 0;if(b==="vector"&&!w)return void this.fire(new r.z(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&typeof a.id!="string"&&typeof a.id!="number")return void this.fire(new r.z(new Error("A feature id is required to remove its specific state property.")));let I=this.getOwnSourceCaches(f);for(let k of I)k.removeFeatureState(w,a.id,c)}getFeatureState(a){if(this._checkLoaded(),"target"in a){let b;if("featuresetId"in a.target){let{featuresetId:w,importId:I}=a.target,k=this.getFragmentStyle(I),O=k.getFeaturesetLayers(w);for(let{source:F,sourceLayer:z}of O){let V=k.getFeatureState({id:a.id,source:F,sourceLayer:z});if(V&&!b)b=V;else if(!r.bn(b,V))return void this.fire(new r.z(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in a.target){let{layerId:w}=a.target,I=this.getLayer(w);b=this.getFeatureState({id:a.id,source:I.source,sourceLayer:I.sourceLayer})}return b}let c=a.source,f=a.sourceLayer,_=this._checkSource(c);if(_){if(_.type!=="vector"||f)return a.id===void 0&&this.fire(new r.z(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(c)[0].getFeatureState(f,a.id);this.fire(new r.z(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(a){return this.stylesheet.transition=r.l({},this.stylesheet.transition,a),this.transition=this.stylesheet.transition,this}getTransition(){return r.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();let a=this.getTerrain(),c=a&&this.terrain&&this.terrain.scope===this.scope?a:this.stylesheet.terrain;return r.cw({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:c,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},f=>f!==void 0)}_updateFilteredLayers(a){for(let c of Object.values(this._mergedLayers))a(c)&&this._updateLayer(c)}_updateLayer(a){this._changes.updateLayer(a);let c=this.getLayerSourceCache(a),f=r.C(a.source,a.scope),_=this._changes.getUpdatedSourceCaches();a.source&&!_[f]&&c&&c.getSource().type!=="raster"&&(this._changes.updateSourceCache(f,"reload"),c.pause()),a.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(a){let c=I=>this._mergedLayers[I].is3D(!!this.terrain),f=this.order,_={},b=[];for(let I=f.length-1;I>=0;I--){let k=f[I];if(c(k)){_[k]=I;for(let O of a){let F=O[k];if(F)for(let z of F)b.push(z)}}}b.sort((I,k)=>k.intersectionZ-I.intersectionZ);let w=[];for(let I=f.length-1;I>=0;I--){let k=f[I];if(c(k))for(let O=b.length-1;O>=0;O--){let F=b[O].feature;if(F.layer&&_[F.layer.id]<I)break;w.push(F),b.pop()}else for(let O of a){let F=O[k];if(F)for(let z of F)w.push(z.feature)}}return w}queryRenderedFeatures(a,c,f){let _;c&&!Array.isArray(c)&&c.filter&&(this._validate(se,"queryRenderedFeatures.filter",c.filter,null,c),_=r.a_(c.filter));let b={},w=F=>{if(ig.has(F.type))return;let z=this.getOwnLayerSourceCache(F),V=b[z.id]=b[z.id]||{sourceCache:z,layers:{},has3DLayers:!1};F.is3D(!!this.terrain)&&(V.has3DLayers=!0),V.layers[F.fqid]=V.layers[F.fqid]||{styleLayer:F,targets:[]},V.layers[F.fqid].targets.push({filter:_})};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new r.z(new Error("parameters.layers must be an Array."))),[];for(let F of c.layers){let z=this._layers[F];if(!z)return this.fire(new r.z(new Error(`The layer '${F}' does not exist in the map's style and cannot be queried for features.`))),[];w(z)}}else for(let F in this._layers)w(this._layers[F]);let I=this._queryRenderedFeatures(a,b,f),k=this._flattenAndSortRenderedFeatures(I),O=[];for(let F of k)r.ct(F.layer.id)===this.scope&&O.push(F);return O}queryRenderedFeatureset(a,c,f){let _;c&&!Array.isArray(c)&&c.filter&&(this._validate(se,"queryRenderedFeatures.filter",c.filter,null,c),_=r.a_(c.filter));let b="mock",w=[];if(c&&c.target)w.push(Object.assign({},c,{targetId:b,filter:_}));else{let F=this.getFeaturesetDescriptors();for(let z of F)w.push({targetId:b,filter:_,target:z});for(let{style:z}of this.fragments){let V=z.getFeaturesetDescriptors();for(let G of V)w.push({targetId:b,filter:_,target:G})}}let I=this.queryRenderedTargets(a,w,f),k=[],O=new Set;for(let F of I)for(let z of F.variants[b])Xu(z,F,O)||k.push(new r.cx(F,z));return k}queryRenderedTargets(a,c,f){let _={},b=(I,k,O,F)=>{let z=_[k.id]=_[k.id]||{sourceCache:k,layers:{},has3DLayers:!1};if(z.layers[I.fqid]=z.layers[I.fqid]||{styleLayer:I,targets:[]},I.is3D(!!this.terrain)&&(z.has3DLayers=!0),!F)return O.uniqueFeatureID=!1,void z.layers[I.fqid].targets.push(O);z.layers[I.fqid].targets.push(Object.assign({},O,{namespace:F.namespace,properties:F.properties,uniqueFeatureID:F.uniqueFeatureID}))};for(let I of c)if("featuresetId"in I.target){let{featuresetId:k,importId:O}=I.target,F=this.getFragmentStyle(O);if(!F||!F._featuresetSelectors)continue;let z=F._featuresetSelectors[k];if(!z){this.fire(new r.z(new Error(`The featureset '${k}' does not exist in the map's style and cannot be queried for features.`)));continue}for(let V of z){let G=F.getOwnLayer(V.layerId);G&&!ig.has(G.type)&&b(G,F.getOwnLayerSourceCache(G),I,V)}}else if("layerId"in I.target){let{layerId:k}=I.target,O=this.getLayer(k);if(!O||ig.has(O.type))continue;b(O,this.getLayerSourceCache(O),I)}let w=this._queryRenderedFeatures(a,_,f);return this._flattenAndSortRenderedFeatures(w)}_queryRenderedFeatures(a,c,f){let _=[],b=!!this.map._showQueryGeometry,w=Ao.createFromScreenPoints(a,f);for(let I in c){let k=Hy(w,c[I],this._availableImages,f,b);Object.keys(k).length&&_.push(k)}if(this.placement)for(let I in c){if(!c[I].sourceCache._onlySymbols)continue;let k=Zx(w.screenGeometry,c[I],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(k).length&&_.push(k)}return _}querySourceFeatures(a,c){let f=c&&c.filter;f&&this._validate(se,"querySourceFeatures.filter",f,null,c);let _=[],b=this.getOwnSourceCaches(a);for(let w of b)_=_.concat(Xx(w,c));return _}addSourceType(a,c,f){return ml.getSourceType(a)?f(new Error(`A source type called "${a}" already exists.`)):(ml.setSourceType(a,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:c.workerSourceURL},f):f(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(a,c,f={}){this._checkLoaded();let _=this.light.getLight(),b=!1;for(let I in a)if(!r.bn(a[I],_[I])){b=!0;break}if(!b)return;let w=this._getTransitionParameters();this.light.setLight(a,c,f),this.light.updateTransitions(w)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=r.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&r.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(a,c=1){if(this._checkLoaded(),!a)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),c===0&&delete this.terrain,a===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let f=a,_=a.source==null;if(c===1){if(this.disableElevatedTerrain)return;if(typeof f.source=="object"){let I="terrain-dem-src";this.addSource(I,f.source),f=r.cq(f),f=r.l(f,{source:I})}let b=r.l({},f),w={};if(this.terrain&&_){b.source=this.terrain.get().source;let I=this.terrain?this.getFragmentStyle(this.terrain.scope):null;I&&(w.style=I.serialize())}if(this._validate($m,"terrain",b,w))return}if(!this.terrain||this.terrain.scope!==this.scope&&!_||this.terrain&&c!==this.terrain.drapeRenderMode){if(!f)return;this._createTerrain(f,c),this.fire(new r.A("data",{dataType:"style"}))}else{let b=this.terrain,w=b.get();for(let I of Object.keys(r.a5.terrain))!f.hasOwnProperty(I)&&r.a5.terrain[I].default&&(f[I]=r.a5.terrain[I].default);for(let I in a)if(!r.bn(a[I],w[I])){b.set(a,this.options),this.stylesheet.terrain=a;let k=this._getTransitionParameters({duration:0});b.updateTransitions(k),this.fire(new r.A("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(a){let c=this.fog=new Yi(a,this.map.transform,this.scope,this.options);this.stylesheet.fog=c.get();let f=this._getTransitionParameters({duration:0});c.updateTransitions(f)}_createSnow(a){let c=this.snow=new Fn(a,this.map.transform,this.scope,this.options);this.stylesheet.snow=c.get();let f=this._getTransitionParameters({duration:0});c.updateTransitions(f)}_createRain(a){let c=this.rain=new zn(a,this.map.transform,this.scope,this.options);this.stylesheet.rain=c.get();let f=this._getTransitionParameters({duration:0});c.updateTransitions(f)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(let a of this.map._markers)a._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(a){if(this._checkLoaded(),!a)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){let c=this.fog;if(!r.bn(c.get(),a)){c.set(a,this.options),this.stylesheet.fog=c.get();let f=this._getTransitionParameters({duration:0});c.updateTransitions(f)}}else this._createFog(a);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(a){if(this._checkLoaded(),!a)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){let c=this.snow;if(!r.bn(c.get(),a)){c.set(a,this.options),this.stylesheet.snow=c.get();let f=this._getTransitionParameters({duration:0});c.updateTransitions(f)}}else this._createSnow(a);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(a){if(this._checkLoaded(),!a)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){let c=this.rain;if(!r.bn(c.get(),a)){c.set(a,this.options),this.stylesheet.rain=c.get();let f=this._getTransitionParameters({duration:0});c.updateTransitions(f)}}else this._createRain(a);this._markersNeedUpdate=!0}_reloadColorTheme(){let a=()=>{for(let _ in this._layers)this._layers[_].lut=this._styleColorTheme.lut;for(let _ in this._sourceCaches)this._sourceCaches[_].clearTiles()},c=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!c)return this._styleColorTheme.lut=null,void a();let f=this._evaluateColorThemeData(c);this._loadColorTheme(f).then(()=>{this.fire(new r.A("colorthemeset")),a()}).catch(_=>{r.w(`Couldn't set color theme: ${_}`)})}setColorTheme(a){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&r.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=a,this._reloadColorTheme()}setImportColorTheme(a,c){let f=this.getFragmentStyle(a);f&&(f._styleColorTheme.colorThemeOverride=c,f._reloadColorTheme())}_getTransitionParameters(a){return{now:r.q.now(),transition:r.l(this.transition,a)}}updateDrapeFirstLayers(){if(!this.terrain)return;let a=[],c=[];for(let f of this._mergedOrder)this.isLayerDraped(this._mergedLayers[f])?a.push(f):c.push(f);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...a),this._drapedFirstOrder.push(...c)}_createTerrain(a,c){let f=this.terrain=new ot(a,c,this.scope,this.options);c===1&&(this.stylesheet.terrain=a),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();let _=this._getTransitionParameters({duration:0});f.updateTransitions(_)}_force3DLayerUpdate(){for(let a in this._layers){let c=this._layers[a];c.type==="fill-extrusion"&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(let a in this._layers){let c=this._layers[a];c.type==="symbol"&&this._updateLayer(c)}}_validate(a,c,f,_,b={}){if(b&&b.validate===!1)return!1;let w=r.l({},this.serialize());return nu(this,a.call(Va,r.l({key:c,style:w,value:f,styleSpec:r.a5},_)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),r.cy.off("pluginStateChange",this._rtlTextPluginCallback);for(let a in this._mergedLayers)this._mergedLayers[a].setEventedParent(null);for(let a in this._mergedSourceCaches)this._mergedSourceCaches[a].clearTiles(),this._mergedSourceCaches[a].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(a){let c=this.getSourceCaches(a);for(let f of c)f.clearTiles()}clearSources(){for(let a in this._mergedSourceCaches)this._mergedSourceCaches[a].clearTiles()}reloadSource(a){let c=this.getSourceCaches(a);for(let f of c)f.resume(),f.reload()}reloadSources(){for(let a of this.getSources())a.reload&&a.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(a=>{a.modelManager.reloadModels(a.scope)})}updateSources(a){let c;this.directionalLight&&(c=ld(this.directionalLight));for(let f in this._mergedSourceCaches)this._mergedSourceCaches[f].update(a,void 0,void 0,c)}_generateCollisionBoxes(){for(let a in this._sourceCaches){let c=this._sourceCaches[a];c.resume(),c.reload()}}_updatePlacement(a,c,f,_,b,w,I=!1){let k=!1,O=!1,F={},z={};for(let V of this._mergedOrder){let G=this._mergedLayers[V];if(G.type!=="symbol")continue;let K=r.C(G.source,G.scope),W=F[K];if(!W){let ne=this.getLayerSourceCache(G);if(!ne)continue;let he=ne.getRenderableIds(!0).map(_e=>ne.getTileByID(_e));z[K]=he.slice(),W=F[K]=he.sort((_e,me)=>me.tileID.overscaledZ-_e.tileID.overscaledZ||(_e.tileID.isLessThan(me.tileID)?-1:1))}let te=this.crossTileSymbolIndex.addLayer(G,W,c.center.lng,c.projection);k=k||te}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),I=I||this._layerOrderChanged||_===0,this._layerOrderChanged&&this.fire(new r.A("neworder")),(I||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(r.q.now(),c.zoom))&&(this.pauseablePlacement=new ad(c,this._mergedOrder,I,f,_,b,this.placement,this.fog&&c.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,F,z,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(r.q.now()),O=!0),k&&this.pauseablePlacement.placement.setStale()),O||k){this._buildingIndex.onNewFrame(c.zoom);for(let V=0;V<this._mergedOrder.length;V++){let G=this._mergedLayers[this._mergedOrder[V]];if(G.type!=="symbol")continue;let K=this.isLayerClipped(G);this.placement.updateLayerOpacities(G,F[r.C(G.source,G.scope)],V,K?w:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(r.q.now())}}_releaseSymbolFadeTiles(){for(let a in this._sourceCaches)this._sourceCaches[a].releaseSymbolFadeTiles()}addImport(a,c){this._checkLoaded();let f=this.stylesheet.imports=this.stylesheet.imports||[];if(f.findIndex(({id:b})=>b===a.id)!==-1)return void this.fire(new r.z(new Error(`Import with id '${a.id}' already exists in the map's style.`)));if(!c)return f.push(a),this._loadImports([a],!0);let _=f.findIndex(({id:b})=>b===c);return _===-1&&this.fire(new r.z(new Error(`Import with id "${c}" does not exist on this map.`))),this.stylesheet.imports=f.slice(0,_).concat(a).concat(f.slice(_)),this._loadImports([a],!0,c)}updateImport(a,c){this._checkLoaded();let f=this.stylesheet.imports||[],_=this.getImportIndex(a);return _===-1?this:typeof c=="string"?(this.setImportUrl(a,c),this):(c.url&&c.url!==f[_].url&&this.setImportUrl(a,c.url),r.bn(c.config,f[_].config)||this.setImportConfig(a,c.config,c.data.schema),r.bn(c.data,f[_].data)||this.setImportData(a,c.data),this)}moveImport(a,c){this._checkLoaded();let f=this.stylesheet.imports||[],_=this.getImportIndex(a);if(_===-1)return this;let b=this.getImportIndex(c);if(b===-1)return this;let w=f[_],I=this.fragments[_];return f=f.filter(({id:k})=>k!==a),this.fragments=this.fragments.filter(({id:k})=>k!==a),this.stylesheet.imports=f.slice(0,b).concat(w).concat(f.slice(b)),this.fragments=this.fragments.slice(0,b).concat(I).concat(this.fragments.slice(b)),this.mergeLayers(),this}setImportUrl(a,c){this._checkLoaded();let f=this.stylesheet.imports||[],_=this.getImportIndex(a);if(_===-1)return this;f[_].url=c;let b=this.fragments[_];return b.style=this._createFragmentStyle(f[_]),b.style.on("style.import.load",()=>this.mergeAll()),b.style.loadURL(c),this}setImportData(a,c){this._checkLoaded();let f=this.getImportIndex(a),_=this.stylesheet.imports||[];return f===-1?this:c?(this.fragments[f].style.setState(c),this._reloadImports(),this):(delete _[f].data,this.setImportUrl(a,_[f].url))}setImportConfig(a,c,f){this._checkLoaded();let _=this.getImportIndex(a),b=this.stylesheet.imports||[];if(_===-1)return this;c?b[_].config=c:delete b[_].config;let w=this.fragments[_];f&&w.style.stylesheet&&(w.style.stylesheet.schema=f);let I=w.style.stylesheet&&w.style.stylesheet.schema;return w.config=c,w.style.updateConfig(c,I),this.updateConfigDependencies(),this}removeImport(a){this._checkLoaded();let c=this.stylesheet.imports||[],f=this.getImportIndex(a);f!==-1&&(c.splice(f,1),this.fragments[f].style._remove(),this.fragments.splice(f,1),this._reloadImports())}getImportIndex(a){let c=(this.stylesheet.imports||[]).findIndex(f=>f.id===a);return c===-1&&this.fire(new r.z(new Error(`Import '${a}' does not exist in the map's style and cannot be updated.`))),c}getLayer(a){return this._mergedLayers[a]}getSources(){let a=[];for(let c in this._mergedOtherSourceCaches){let f=this._mergedOtherSourceCaches[c];f&&a.push(f.getSource())}return a}getSource(a,c){let f=this.getSourceCache(a,c);return f&&f.getSource()}getLayerSource(a){let c=this.getLayerSourceCache(a);return c&&c.getSource()}getSourceCache(a,c){let f=r.C(a,c);return this._mergedOtherSourceCaches[f]}getLayerSourceCache(a){let c=r.C(a.source,a.scope);return a.type==="symbol"?this._mergedSymbolSourceCaches[c]:this._mergedOtherSourceCaches[c]}getSourceCaches(a){if(a==null)return Object.values(this._mergedSourceCaches);let c=[];return this._mergedOtherSourceCaches[a]&&c.push(this._mergedOtherSourceCaches[a]),this._mergedSymbolSourceCaches[a]&&c.push(this._mergedSymbolSourceCaches[a]),c}updateSourceCaches(){let a=this._changes.getUpdatedSourceCaches();for(let c in a){let f=a[c];f==="reload"?this.reloadSource(c):f==="clear"&&this.clearSource(c)}}updateLayers(a){let c=this._changes.getUpdatedPaintProperties();for(let f of c){let _=this.getLayer(f);_&&_.updateTransitions(a)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(a){this.stylesheet.glyphs=a,this.glyphManager.setURL(a,this.scope)}getImages(a,c,f){this.imageManager.getImages(c.images,c.scope,f),this._updateTilesForChangedImages();let _=w=>{if(w){let I=c.images.map(k=>r.I.toString(k));w.setDependencies(c.tileID.key,c.type,I)}},b=r.C(c.source,c.scope);_(this._mergedOtherSourceCaches[b]),_(this._mergedSymbolSourceCaches[b])}rasterizeImages(a,c,f){this.imageManager.rasterizeImages(c,f)}getGlyphs(a,c,f){this.glyphManager.getGlyphs(c.stacks,c.scope,f)}getResource(a,c,f){return r.cz(c,f)}getOwnSourceCache(a){return this._otherSourceCaches[a]}getOwnLayerSourceCache(a){return a.type==="symbol"?this._symbolSourceCaches[a.source]:this._otherSourceCaches[a.source]}getOwnSourceCaches(a){let c=[];return this._otherSourceCaches[a]&&c.push(this._otherSourceCaches[a]),this._symbolSourceCaches[a]&&c.push(this._symbolSourceCaches[a]),c}_isSourceCacheLoaded(a){let c=this.getOwnSourceCaches(a);return c.length===0?(this.fire(new r.z(new Error(`There is no source with ID '${a}'`))),!1):c.every(f=>f.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(a,c){if(!this._clipLayerPresent&&a.type!=="fill-extrusion")return!1;let f=a.type==="fill-extrusion"&&a.sourceLayer==="building";if(a.is3D(!!this.terrain)){if(f||c&&c.type==="batched-model"||a.type==="model")return!0}else if(a.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(a=>{a.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ml.getSourceType=function(m){return Uy[m]},ml.setSourceType=function(m,a){Uy[m]=a},ml.registerForPluginStateChange=r.ci;var ev=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,ng=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,lf=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,rg="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",cd=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,og=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,tv=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,ru=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,dh=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,cf=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,df=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return clamp(mix(lerpx.x,lerpx.y,f.y),0.0,1.0);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;let vc=[];Ol(ev,vc),Ol(lf,vc),Ol(ng,vc);let ou={"_prelude_fog.vertex.glsl":og,"_prelude_terrain.vertex.glsl":cd,"_prelude_shadow.vertex.glsl":cf,"_prelude_fog.fragment.glsl":tv,"_prelude_shadow.fragment.glsl":df,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":ru,"_prelude_raster_particle.glsl":dh},uh={};sn("",cd),sn(tv,og),sn(df,cf),sn(ru,""),sn(dh,"");let iv=sn(ng,lf),ag=ev;var uf={background:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:sn("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:sn(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:sn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:sn("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:sn("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:sn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:sn(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:sn(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
void main() {vec3 color=vec3(241.0/255.0,236.0/255.0,225.0/255.0);
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,normal);
#endif
if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(v_normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:sn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:sn(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:sn(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:sn(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),0.001);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:sn("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:sn("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:sn(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:sn(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#endif
}`),terrainRaster:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:sn("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:sn(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,rg),skyboxGradient:sn(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,rg),skyboxCapture:sn(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:sn(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:sn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:sn(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:sn("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:sn("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:sn("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:sn("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Ol(m,a){let c=m.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let f of c)if(f=f.trim(),f[0]==="#"&&f.includes("if")&&!f.includes("endif")){f=f.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();let _=f.split(" ");for(let b of _)a.includes(b)||a.push(b)}}function sn(m,a){let c=/#include\s+"([^"]+)"/g,f=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g,_=a.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);_&&(_=_.map(O=>{let F=O.split(" ");return F[F.length-1]}),_=[...new Set(_)]);let b={},w=[],I=[];if(m=m.replace(c,(O,F)=>(I.push(F),"")),(a=a.replace(c,(O,F)=>(w.push(F),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let k=[...vc];Ol(m,k),Ol(a,k);for(let O of[...w,...I])ou[O]||console.error(`Undefined include: ${O}`),uh[O]||(uh[O]=[],Ol(ou[O],uh[O])),k=[...k,...uh[O]];return{fragmentSource:m=m.replace(f,(O,F,z,V,G)=>(b[G]=!0,F==="define"?`
#ifndef HAS_UNIFORM_u_${G}
in ${z} ${V} ${G};
#else
uniform ${z} ${V} u_${G};
#endif
`:F==="initialize"?`
#ifdef HAS_UNIFORM_u_${G}
    ${z} ${V} ${G} = u_${G};
#endif
`:F==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${G}
    in ${z} ${V} ${G};
#endif
`:F==="initialize-attribute"?"":void 0)),vertexSource:a=a.replace(f,(O,F,z,V,G)=>{let K=V==="float"?"vec2":V,W=G.match(/color/)?"color":K;return F==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${G}
in ${z} ${V} a_${G};
#endif
`:b[G]?F==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
in ${z} ${K} a_${G};
out ${z} ${V} ${G};
#else
uniform ${z} ${V} u_${G};
#endif
`:F==="initialize"?W==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = a_${G};
#else
    ${z} ${V} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = unpack_mix_${W}(a_${G}, u_${G}_t);
#else
    ${z} ${V} ${G} = u_${G};
#endif
`:F==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${G}
    in ${z} ${V} a_${G};
    out ${z} ${V} ${G};
#endif
`:F==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${G}
    ${G} = a_${G};
#endif
`:void 0:F==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
in ${z} ${K} a_${G};
#else
uniform ${z} ${V} u_${G};
#endif
`:F==="define-instanced"?W==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${G}0;
in vec4 a_${G}1;
in vec4 a_${G}2;
in vec4 a_${G}3;
#else
uniform ${z} ${V} u_${G};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${z} ${K} a_${G};
#else
uniform ${z} ${V} u_${G};
#endif
`:F==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${G}
    ${z} ${V} ${G} = a_${G};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${z} ${V} ${G} = a_${G};
#else
    ${z} ${V} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${z} ${V} ${G} = unpack_mix_${W}(a_${G}, u_${G}_t);
#else
    ${z} ${V} ${G} = u_${G};
#endif
`}),staticAttributes:_,usedDefines:k,vertexIncludes:w,fragmentIncludes:I}}class sw{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(a,c,f,_,b,w,I,k){this.context=a;let O=this.boundPaintVertexBuffers.length!==_.length;for(let z=0;!O&&z<_.length;z++)this.boundPaintVertexBuffers[z]!==_[z]&&(O=!0);let F=this.boundDynamicVertexBuffers.length!==I.length;for(let z=0;!F&&z<I.length;z++)this.boundDynamicVertexBuffers[z]!==I[z]&&(F=!0);if(!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==f||O||F||this.boundIndexBuffer!==b||this.boundVertexOffset!==w)this.freshBind(c,f,_,b,w,I,k);else{a.bindVertexArrayOES.set(this.vao);for(let z of I)z&&(z.bind(),k&&z.instanceCount&&z.setVertexAttribDivisor(a.gl,c,k));b&&b.dynamicDraw&&b.bind()}}freshBind(a,c,f,_,b,w,I){let k=a.numAttributes,O=this.context,F=O.gl;this.vao&&this.destroy(),this.vao=O.gl.createVertexArray(),O.bindVertexArrayOES.set(this.vao),this.boundProgram=a,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=_,this.boundVertexOffset=b,this.boundDynamicVertexBuffers=w,c.enableAttributes(F,a),c.bind(),c.setVertexAttribPointers(F,a,b);for(let z of f)z.enableAttributes(F,a),z.bind(),z.setVertexAttribPointers(F,a,b);for(let z of w)z&&(z.enableAttributes(F,a),z.bind(),z.setVertexAttribPointers(F,a,b),I&&z.instanceCount&&z.setVertexAttribDivisor(F,a,I));_&&_.bind(),O.currentNumAttributes=k}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function lw(m,a){let c=Math.pow(2,a.canonical.z),f=a.canonical.y;return[new r.ac(0,f/c).toLngLat().lat,new r.ac(0,(f+1)/c).toLngLat().lat]}function hh(m,a,c,f,_,b,w){let I=m.context,k=I.gl,O=c.hillshadeFBO;if(!O)return;m.prepareDrawTile();let F=m.isTileAffectedByFog(a),z=m.getOrCreateProgram("hillshade",{overrideFog:F});I.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,O.colorAttachment.get());let V=((te,ne,he,_e)=>{let me=he.paint.get("hillshade-shadow-color"),Se=he.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",ve=he.paint.get("hillshade-highlight-color"),be=he.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",xe=he.paint.get("hillshade-accent-color"),Ae=he.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",Oe=he.paint.get("hillshade-emissive-strength"),Ke=r.ak(he.paint.get("hillshade-illumination-direction"));if(he.paint.get("hillshade-illumination-anchor")==="viewport")Ke-=te.transform.angle;else if(te.style&&te.style.enable3dLights()&&te.style.directionalLight){let ct=te.style.directionalLight.properties.get("direction"),ut=r.cc(ct.x,ct.y,ct.z);Ke=r.ak(ut[1])}let $e=!te.options.moving;return{u_matrix:_e||te.transform.calculateProjMatrix(ne.tileID.toUnwrapped(),$e),u_image:0,u_latrange:lw(0,ne.tileID),u_light:[he.paint.get("hillshade-exaggeration"),Ke],u_shadow:me.toRenderColor(Se?null:he.lut),u_highlight:ve.toRenderColor(be?null:he.lut),u_emissive_strength:Oe,u_accent:xe.toRenderColor(Ae?null:he.lut)}})(m,c,f,m.terrain?a.projMatrix:null);m.uploadCommonUniforms(I,z,a.toUnwrapped());let{tileBoundsBuffer:G,tileBoundsIndexBuffer:K,tileBoundsSegments:W}=m.getTileBoundsBuffers(c);z.draw(m,k.TRIANGLES,_,b,w,Ti.disabled,V,f.id,G,K,W)}function nv(m,a,c){if(!a.needsDEMTextureUpload)return;let f=m.context,_=f.gl;f.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||m.getTileTexture(c.stride);let b=c.getPixels();a.demTexture?a.demTexture.update(b,{premultiply:!1}):a.demTexture=new r.T(f,b,_.R32F,{premultiply:!1}),a.needsDEMTextureUpload=!1}function kM(m,a,c){let f=m.context,_=f.gl;if(!a.dem)return;let b=a.dem;if(f.activeTexture.set(_.TEXTURE1),nv(m,a,b),!a.demTexture)return;a.demTexture.bind(_.NEAREST,_.CLAMP_TO_EDGE);let w=b.dim;f.activeTexture.set(_.TEXTURE0);let I=a.hillshadeFBO;if(!I){let V=new r.T(f,{width:w,height:w,data:null},_.RGBA8);V.bind(_.LINEAR,_.CLAMP_TO_EDGE),I=a.hillshadeFBO=f.createFramebuffer(w,w,!0,"renderbuffer"),I.colorAttachment.set(V.texture)}f.bindFramebuffer.set(I.framebuffer),f.viewport.set([0,0,w,w]);let{tileBoundsBuffer:k,tileBoundsIndexBuffer:O,tileBoundsSegments:F}=m.getMercatorTileBoundsBuffers(),z=[];m.linearFloatFilteringSupported()&&z.push("TERRAIN_DEM_FLOAT_FORMAT"),m.getOrCreateProgram("hillshadePrepare",{defines:z}).draw(m,_.TRIANGLES,ci.disabled,Oi.disabled,Ji.unblended,Ti.disabled,((V,G)=>{let K=G.stride,W=r.ad.mat4.create();return r.ad.mat4.ortho(W,0,r.ai,-r.ai,0,0,1),r.ad.mat4.translate(W,W,[0,-r.ai,0]),{u_matrix:W,u_image:1,u_dimension:[K,K],u_zoom:V.overscaledZ}})(a.tileID,b),c.id,k,O,F),a.needsHillshadePrepare=!1}class gr{constructor(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(a){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class PM extends gr{getDefault(){return r.al.transparent}set(a){let c=this.current;(a.r!==c.r||a.g!==c.g||a.b!==c.b||a.a!==c.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class rv extends gr{getDefault(){return 1}set(a){(a!==this.current||this.dirty)&&(this.gl.clearDepth(a),this.current=a,this.dirty=!1)}}class ov extends gr{getDefault(){return 0}set(a){(a!==this.current||this.dirty)&&(this.gl.clearStencil(a),this.current=a,this.dirty=!1)}}class av extends gr{getDefault(){return[!0,!0,!0,!0]}set(a){let c=this.current;(a[0]!==c[0]||a[1]!==c[1]||a[2]!==c[2]||a[3]!==c[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class sv extends gr{getDefault(){return!0}set(a){(a!==this.current||this.dirty)&&(this.gl.depthMask(a),this.current=a,this.dirty=!1)}}class cw extends gr{getDefault(){return 255}set(a){(a!==this.current||this.dirty)&&(this.gl.stencilMask(a),this.current=a,this.dirty=!1)}}class dw extends gr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(a){let c=this.current;(a.func!==c.func||a.ref!==c.ref||a.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)}}class OM extends gr{getDefault(){let a=this.gl;return[a.KEEP,a.KEEP,a.KEEP]}set(a){let c=this.current;(a[0]!==c[0]||a[1]!==c[1]||a[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)}}class hf extends gr{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;let c=this.gl;a?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=a,this.dirty=!1}}class pf extends gr{getDefault(){return[0,1]}set(a){let c=this.current;(a[0]!==c[0]||a[1]!==c[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)}}class uw extends gr{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;let c=this.gl;a?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=a,this.dirty=!1}}class ys extends gr{getDefault(){return this.gl.LESS}set(a){(a!==this.current||this.dirty)&&(this.gl.depthFunc(a),this.current=a,this.dirty=!1)}}class lv extends gr{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;let c=this.gl;a?c.enable(c.BLEND):c.disable(c.BLEND),this.current=a,this.dirty=!1}}class sg extends gr{getDefault(){let a=this.gl;return[a.ONE,a.ZERO,a.ONE,a.ZERO]}set(a){let c=this.current;(a[0]!==c[0]||a[1]!==c[1]||a[2]!==c[2]||a[3]!==c[3]||this.dirty)&&(this.gl.blendFuncSeparate(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class lg extends gr{getDefault(){return r.al.transparent}set(a){let c=this.current;(a.r!==c.r||a.g!==c.g||a.b!==c.b||a.a!==c.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class cv extends gr{getDefault(){return this.gl.FUNC_ADD}set(a){(a!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(a,a),this.current=a,this.dirty=!1)}}class dv extends gr{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;let c=this.gl;a?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=a,this.dirty=!1}}class uv extends gr{getDefault(){return this.gl.BACK}set(a){(a!==this.current||this.dirty)&&(this.gl.cullFace(a),this.current=a,this.dirty=!1)}}class cg extends gr{getDefault(){return this.gl.CCW}set(a){(a!==this.current||this.dirty)&&(this.gl.frontFace(a),this.current=a,this.dirty=!1)}}let hv=class extends gr{getDefault(){return null}set(m){(m!==this.current||this.dirty)&&(this.gl.useProgram(m),this.current=m,this.dirty=!1)}};class pv extends gr{getDefault(){return this.gl.TEXTURE0}set(a){(a!==this.current||this.dirty)&&(this.gl.activeTexture(a),this.current=a,this.dirty=!1)}}class dg extends gr{getDefault(){let a=this.gl;return[0,0,a.drawingBufferWidth,a.drawingBufferHeight]}set(a){let c=this.current;(a[0]!==c[0]||a[1]!==c[1]||a[2]!==c[2]||a[3]!==c[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class hw extends gr{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;let c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,a),this.current=a,this.dirty=!1}}class pw extends gr{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;let c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class ph extends gr{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;let c=this.gl;c.bindTexture(c.TEXTURE_2D,a),this.current=a,this.dirty=!1}}class FM extends gr{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;let c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class LM extends gr{getDefault(){return null}set(a){let c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class NM extends gr{getDefault(){return null}set(a){this.gl&&(a!==this.current||this.dirty)&&(this.gl.bindVertexArray(a),this.current=a,this.dirty=!1)}}class zM extends gr{getDefault(){return 4}set(a){if(a===this.current&&!this.dirty)return;let c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}}class BM extends gr{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;let c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}}class VM extends gr{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;let c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}}class ff extends gr{constructor(a,c){super(a),this.context=a,this.parent=c}getDefault(){return null}}class fv extends ff{setDirty(){this.dirty=!0}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}}class mv extends ff{attachment(){return this.gl.DEPTH_ATTACHMENT}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class fh extends ff{attachment(){return this.gl.DEPTH_ATTACHMENT}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,this.attachment(),c.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}}class fw extends mv{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}let mw=(m,a,c)=>({u_matrix:m,u_image0:0,u_skirt_height:a,u_ground_shadow_factor:c}),gv=(m,a,c,f,_,b,w,I,k,O,F,z,V,G,K,W)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:a,u_normalize_matrix:Float32Array.from(f),u_merc_matrix:c,u_zoom_transition:_,u_merc_center:b,u_image0:0,u_frustum_tl:w,u_frustum_tr:I,u_frustum_br:k,u_frustum_bl:O,u_globe_pos:F,u_globe_radius:z,u_viewport:V,u_grid_matrix:W?Float32Array.from(W):new Float32Array(9),u_skirt_height:G,u_far_z_cutoff:K});function ug(m,a){return m!=null&&a!=null&&!(!m.hasData()||!a.hasData())&&m.demTexture!=null&&a.demTexture!=null&&m.tileID.key!==a.tileID.key}let Bs=new class{constructor(){this.operations={}}newMorphing(m,a,c,f,_){if(m in this.operations){let b=this.operations[m];b.to.tileID.key!==c.tileID.key&&(b.queued=c)}else this.operations[m]={startTime:f,phase:0,duration:_,from:a,to:c,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;let a=this.operations[m];return{from:a.from,to:a.to,phase:a.phase}}update(m){for(let a in this.operations){let c=this.operations[a];for(c.phase=(m-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,m)){delete this.operations[a];break}}}_nextOp(m,a){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=a,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},_v={0:null,1:"TERRAIN_VERTEX_MORPHING"};function bc(m,a,c){if(a===0)return 0;let f=a<1&&c===514?.25/a:1;return 6*Math.pow(1.5,22-m)*Math.max(a,1)*f}function yv(m,a){let c=1<<m.z;return!a&&(m.x===0||m.x===c-1)||m.y===0||m.y===c-1}let mh=m=>({u_matrix:m});function hg(m,a,c,f,_){if(_>0){let b=r.q.now(),w=(b-m.timeAdded)/_,I=a?(b-a.timeAdded)/_:-1,k=c.getSource(),O=f.coveringZoomLevel({tileSize:k.tileSize,roundZoom:k.roundZoom}),F=!a||Math.abs(a.tileID.overscaledZ-O)>Math.abs(m.tileID.overscaledZ-O),z=F&&m.refreshedUponExpiration?1:r.ay(F?w:1-I,0,1);return m.refreshedUponExpiration&&w>=1&&(m.refreshedUponExpiration=!1),a?{opacity:1,mix:1-z}:{opacity:z,mix:0}}return{opacity:1,mix:0}}class gw extends Ns{constructor(a){let c={type:"raster-dem",maxzoom:a.transform.maxZoom},f=new r.D(r.cj(),null),_=qm("mock-dem",c,f,a.style);super("mock-dem",_,!1),_.setEventedParent(this),this._sourceLoaded=!0}_loadTile(a,c){a.state="loaded",c(null)}}class vv extends Ns{constructor(a){let c=qm("proxy",{type:"geojson",maxzoom:a.transform.maxZoom},new r.D(r.cj(),null),a.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=a,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(a,c,f){if(a.freezeTileCoverage)return;this.transform=a;let _=a.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((b,w)=>{if(b[w.key]="",!this._tiles[w.key]){let I=new hl(w,this._source.tileSize*w.overscaleFactor(),a.tileZoom);I.state="loaded",this._tiles[w.key]=I}return b},{});for(let b in this._tiles)b in _||(this.freeFBO(b),this._tiles[b].unloadVectorData(),delete this._tiles[b])}freeFBO(a){let c=this.proxyCachedFBO[a];if(c!==void 0){let f=Object.values(c);this.renderCachePool.push(...f),delete this.proxyCachedFBO[a]}}deallocRenderCache(){this.renderCache.forEach(a=>a.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class pg extends r.aH{constructor(a,c,f){super(a.overscaledZ,a.wrap,a.canonical.z,a.canonical.x,a.canonical.y),this.proxyTileKey=c,this.projMatrix=f}}class _w extends r.cK{constructor(a,c){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},a.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),a.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),a.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=a,this.terrainTileForTile={},this.prevTerrainTileForTile={};let[f,_,b]=function(k){let O=new r.b5,F=new r.aV,z=131;O.reserve(17161),F.reserve(33800);let V=r.ai/128,G=r.ai+V/2,K=G+V;for(let te=-V;te<K;te+=V)for(let ne=-V;ne<K;ne+=V){let he=ne<0||ne>G||te<0||te>G?24575:0,_e=r.ay(Math.round(ne),0,r.ai),me=r.ay(Math.round(te),0,r.ai);O.emplaceBack(_e+he,me)}let W=(te,ne)=>{let he=ne*z+te;F.emplaceBack(he+1,he,he+z),F.emplaceBack(he+z,he+z+1,he+1)};for(let te=1;te<129;te++)for(let ne=1;ne<129;ne++)W(ne,te);return[0,129].forEach(te=>{for(let ne=0;ne<130;ne++)W(ne,te),W(te,ne)}),[O,F,32768]}(),w=a.context;this.gridBuffer=w.createVertexBuffer(f,r.b7.members),this.gridIndexBuffer=w.createIndexBuffer(_),this.gridSegments=r.b8.simpleSegment(0,0,f.length,_.length),this.gridNoSkirtSegments=r.b8.simpleSegment(0,0,f.length,b),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new vv(c.map),this.orthoMatrix=r.ad.mat4.create(),r.ad.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,r.ai,0,r.ai,0,1);let I=w.gl;this._overlapStencilMode=new Oi({func:I.GEQUAL,mask:255},0,255,I.KEEP,I.KEEP,I.REPLACE),this._previousZoom=a.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new gw(c.map),this._pendingGroundEffectLayers=[]}set style(a){a.on("data",this._onStyleDataEvent.bind(this)),this._style=a,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(a,c,f){if(a&&a.terrain){this._style!==a&&(this.style=a,this._evaluationZoom=void 0);let _=a.terrain.properties,b=a.terrain.drapeRenderMode===0,w=a.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=r.q.now();let I=a.terrain&&a.terrain.scope,k=_.get("source"),O=b?this._mockSourceCache:a.getSourceCache(k,I);if(!O)return void r.w(`Couldn't find terrain source "${k}".`);if(this.sourceCache=O,this._attenuationRange=a.terrain.getAttenuationRange(),this._exaggeration=w?this.calculateExaggeration(c):_.get("exaggeration"),!c.projection.requiresDraping&&w&&this._exaggeration===0)return void this._disable();this.enabled=!0;let F=()=>{this.sourceCache.used&&r.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);let z=this.getScaledDemTileSize();this.sourceCache.update(c,z,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,F(),this._initializing=!0),F(),c.updateElevation(!0,f),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0,this._previousZoom=c.zoom}else this._disable()}calculateExaggeration(a){if(this._attenuationRange&&a.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(a.zoom);let c=this._previousCameraAltitude,f=a.getFreeCameraOptions().position.z/a.pixelsPerMeter*a.worldSize;this._previousCameraAltitude=f;let _=c!=null?f-c:Number.MAX_VALUE;if(Math.abs(_)<2)return this._exaggeration;let b=a.zoom,w=this._style.terrain;if(!this._previousUpdateTimestamp)return w.getExaggeration(b);let I=b-this._previousZoom,k=this._previousUpdateTimestamp,O=b;this._evaluationZoom!=null&&(O=this._evaluationZoom,Math.abs(b-O)>.5&&(I=.5*(b-O+I)),I*_<0&&(O+=I)),this._evaluationZoom=O;let F=w.getExaggeration(O),z=F===w.getExaggeration(Math.max(0,O-.1));if(z&&Math.abs(F-this._exaggeration)<.01)return F;let V=Math.min(.1,.00375*(this._updateTimestamp-k));return(z||F<.1||Math.abs(I)<1e-4)&&(V=Math.min(.2,4*V)),r.ah(this._exaggeration,F,V)}resetTileLookupCache(a){this._findCoveringTileCache[a]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(a){a.coord&&a.dataType==="source"?this._clearRenderCacheForTile(a.sourceCacheId,a.coord):a.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(let a in this._style._mergedSourceCaches)this._style._mergedSourceCaches[a].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(a=>a.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){let a=2*this.proxySourceCache.getSource().tileSize;return[a,a]}set useVertexMorphing(a){this._useVertexMorphing=a}updateTileBinding(a){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;let c=this.proxySourceCache,f=this.painter.transform;this._initializing&&(this._initializing=f._centerAltitude===0&&this.getAtPointOrZero(r.ac.fromLngLat(f.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);let _=this.proxyCoords=c.getIds().map(k=>{let O=c.getTileByID(k).tileID;return O.projMatrix=f.calculateProjMatrix(O.toUnwrapped()),O});(function(k,O){let F=O.transform.pointCoordinate(O.transform.getCameraPoint()),z=new r.P(F.x,F.y);k.sort((V,G)=>{if(G.overscaledZ-V.overscaledZ)return G.overscaledZ-V.overscaledZ;let K=new r.P(V.canonical.x+(1<<V.canonical.z)*V.wrap,V.canonical.y),W=new r.P(G.canonical.x+(1<<G.canonical.z)*G.wrap,G.canonical.y),te=z.mult(1<<V.canonical.z);return te.x-=.5,te.y-=.5,te.distSqr(K)-te.distSqr(W)})})(_,this.painter);let b=this.proxyToSource||{};this.proxyToSource={},_.forEach(k=>{this.proxyToSource[k.key]={}}),this.terrainTileForTile={};let w=this._style._mergedSourceCaches;for(let k in w){let O=w[k];if(!O.used||(O!==this.sourceCache&&this.resetTileLookupCache(O.id),this._setupProxiedCoordsForOrtho(O,a[k],b),O.usedForTerrain))continue;let F=a[k];O.getSource().reparseOverscaled&&this._assignTerrainTiles(F)}this.proxiedCoords[c.id]=_.map(k=>new pg(k,k.key,this.orthoMatrix)),this._assignTerrainTiles(_),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(b),this.renderingToTexture=!1;let I={};this._visibleDemTiles=[];for(let k of this.proxyCoords){let O=this.terrainTileForTile[k.key];if(!O)continue;let F=O.tileID.key;F in I||(this._visibleDemTiles.push(O),I[F]=F)}}_assignTerrainTiles(a){this._initializing||a.forEach(c=>{if(this.terrainTileForTile[c.key])return;let f=this._findTileCoveringTileID(c,this.sourceCache);f&&(this.terrainTileForTile[c.key]=f)})}_prepareDEMTextures(){let a=this.painter.context,c=a.gl;for(let f in this.terrainTileForTile){let _=this.terrainTileForTile[f],b=_.dem;!b||_.demTexture&&!_.needsDEMTextureUpload||(a.activeTexture.set(c.TEXTURE1),nv(this.painter,_,b))}}_prepareDemTileUniforms(a,c,f,_){if(!c||c.demTexture==null)return!1;let b=a.tileID.canonical,w=Math.pow(2,c.tileID.canonical.z-b.z),I=_||"";return f[`u_dem_tl${I}`]=[b.x*w%1,b.y*w%1],f[`u_dem_scale${I}`]=w,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let a=0,c=this._visibleDemTiles.reduce((f,_)=>{if(!_.dem)return f;let b=_.dem.tree.minimums[0];return b>0&&a++,f+b},0);return a?c/a:0}_updateEmptyDEMTexture(){let a=this.painter.context,c=a.gl;a.activeTexture.set(c.TEXTURE2);let f=this._getLoadedAreaMinimum(),_=new r.cL({width:1,height:1},new Float32Array([f]));this._emptyDEMTextureDirty=!1;let b=this._emptyDEMTexture;return b?b.update(_,{premultiply:!1}):b=this._emptyDEMTexture=new r.T(a,_,c.R32F,{premultiply:!1}),b}setupElevationDraw(a,c,f){let _=this.painter.context,b=_.gl,w={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};w.u_exaggeration=this.exaggeration();let I=null,k=null,O=1;if(f&&f.morphing&&this._useVertexMorphing){let G=f.morphing.srcDemTile,K=f.morphing.dstDemTile;O=f.morphing.phase,G&&K&&(this._prepareDemTileUniforms(a,G,w,"_prev")&&(k=G),this._prepareDemTileUniforms(a,K,w)&&(I=K))}let F=G=>G&&G.demTexture&&this.painter.linearFloatFilteringSupported()?b.LINEAR:b.NEAREST,z=null;var V;if(this.enabled?k&&I?(z=I.demTexture,_.activeTexture.set(b.TEXTURE4),k.demTexture.bind(F(k),b.CLAMP_TO_EDGE),w.u_dem_lerp=O):(I=this.terrainTileForTile[a.tileID.key],z=this._prepareDemTileUniforms(a,I,w)?I.demTexture:this.emptyDEMTexture):z=this.emptyDEMTexture,_.activeTexture.set(b.TEXTURE2),z&&(w.u_dem_size=(V=z).size[0]===1?1:V.size[0]-2,z.bind(F(I),b.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(f&&f.useDepthForOcclusion,c,w),f&&f.useMeterToDem&&I){let G=(1<<I.tileID.canonical.z)*r.bH(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;w.u_meter_to_dem=G}if(f&&f.labelPlaneMatrixInv&&(w.u_label_plane_matrix_inv=f.labelPlaneMatrixInv),c.setTerrainUniformValues(_,w),this.painter.transform.projection.name==="globe"){let G=this.globeUniformValues(this.painter.transform,a.tileID.canonical,f&&f.useDenormalizedUpVectorScale);c.setGlobeUniformValues(_,G)}}globeUniformValues(a,c,f){let _=a.projection;return{u_tile_tl_up:_.upVector(c,0,0),u_tile_tr_up:_.upVector(c,r.ai,0),u_tile_br_up:_.upVector(c,r.ai,r.ai),u_tile_bl_up:_.upVector(c,0,r.ai),u_tile_up_scale:f?r.cM(1):_.upVectorScale(c,a.center.lat,a.worldSize).metersToTile}}renderToBackBuffer(a){let c=this.painter,f=this.painter.context;a.length!==0&&(f.bindFramebuffer.set(null),f.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(_,b,w,I,k){if(_.transform.projection.name==="globe")(function(O,F,z,V,G){let K=O.context,W=K.gl,te,ne,he=O.transform,_e=r.cD(O,K,he),me=(ct,ut)=>{if(ne===ut)return;let St=[_v[ut],"PROJECTION_GLOBE_VIEW"];_e&&St.push("CUSTOM_ANTIALIASING");let He=O.isTileAffectedByFog(ct);te=O.getOrCreateProgram("globeRaster",{defines:St,overrideFog:He}),ne=ut},Se=O.colorModeForRenderPass(),ve=new ci(W.LEQUAL,ci.ReadWrite,O.depthRangeFor3D);Bs.update(G);let be=r.cE(he),xe=[r.av(he.center.lng),r.aC(he.center.lat)],Ae=O.globeSharedBuffers,Oe=[he.width*r.q.devicePixelRatio,he.height*r.q.devicePixelRatio],Ke=Float32Array.from(he.globeMatrix),$e={useDenormalizedUpVectorScale:!0};{let ct=O.transform,ut=bc(ct.zoom,F.exaggeration(),F.sourceCache._source.tileSize);ne=-1;let St=W.TRIANGLES;for(let He of V){let st=z.getTile(He),je=Oi.disabled,at=F.prevTerrainTileForTile[He.key],rt=F.terrainTileForTile[He.key];ug(at,rt)&&Bs.newMorphing(He.key,at,rt,G,250),K.activeTexture.set(W.TEXTURE0),st.texture&&st.texture.bind(W.LINEAR,W.CLAMP_TO_EDGE);let ht=Bs.getMorphValuesForProxy(He.key),Qe=ht?1:0;ht&&r.L($e,{morphing:{srcDemTile:ht.from,dstDemTile:ht.to,phase:r.cC(ht.phase)}});let mt=r.cF(He.canonical),Nt=r.cG(mt.getCenter().lat),zt=r.cH(He.canonical,mt,Nt,ct.worldSize/ct._pixelsPerMercatorPixel),Vt=r.bc(r.cI(He.canonical)),ei=gv(ct.expandedFarZProjMatrix,Ke,be,Vt,r.ag(ct.zoom),xe,ct.frustumCorners.TL,ct.frustumCorners.TR,ct.frustumCorners.BR,ct.frustumCorners.BL,ct.globeCenterInViewSpace,ct.globeRadius,Oe,ut,ct._farZ,zt);if(me(He,Qe),te&&(F.setupElevationDraw(st,te,$e),O.uploadCommonUniforms(K,te,He.toUnwrapped()),Ae)){let[Ri,gi,Si]=Ae.getGridBuffers(Nt,ut!==0);te.draw(O,St,ve,je,Se,Ti.backCCW,ei,"globe_raster",Ri,gi,Si)}}}if(Ae&&(O.renderDefaultNorthPole||O.renderDefaultSouthPole)){let ct=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];_e&&ct.push("CUSTOM_ANTIALIASING"),te=O.getOrCreateProgram("globeRaster",{defines:ct});for(let ut of V){let{x:St,y:He,z:st}=ut.canonical,je=He===0,at=He===(1<<st)-1,[rt,ht,Qe,mt]=Ae.getPoleBuffers(st,!1);if(mt&&(je||at)){let Nt=z.getTile(ut);K.activeTexture.set(W.TEXTURE0),Nt.texture&&Nt.texture.bind(W.LINEAR,W.CLAMP_TO_EDGE);let zt=r.cJ(st,St,he),Vt=r.bc(r.cI(ut.canonical)),ei=(Ri,gi)=>Ri.draw(O,W.TRIANGLES,ve,Oi.disabled,Se,Ti.disabled,gv(he.expandedFarZProjMatrix,zt,zt,Vt,0,xe,he.frustumCorners.TL,he.frustumCorners.TR,he.frustumCorners.BR,he.frustumCorners.BL,he.globeCenterInViewSpace,he.globeRadius,Oe,0,he._farZ),"globe_pole_raster",gi,Qe,mt);F.setupElevationDraw(Nt,te,$e),O.uploadCommonUniforms(K,te,ut.toUnwrapped()),je&&O.renderDefaultNorthPole&&ei(te,rt),at&&O.renderDefaultSouthPole&&(zt=r.ad.mat4.scale(r.ad.mat4.create(),zt,[1,-1,1]),ei(te,ht))}}}})(_,b,w,I,k);else{let O=_.context,F=O.gl,z,V,G=_.shadowRenderer,K=_c(_,_.longestCutoffRange),W=Se=>{if(V===Se)return;let ve=[];ve.push(_v[Se]),K.shouldRenderCutoff&&ve.push("RENDER_CUTOFF"),G&&(ve.push("RENDER_SHADOWS","DEPTH_TEXTURE"),G.useNormalOffset&&ve.push("NORMAL_OFFSET")),z=_.getOrCreateProgram("terrainRaster",{defines:ve}),V=Se},te=_.colorModeForRenderPass(),ne=new ci(F.LEQUAL,ci.ReadWrite,_.depthRangeFor3D);Bs.update(k);let he=_.transform,_e=bc(he.zoom,b.exaggeration(),b.sourceCache._source.tileSize),me=[0,0,0];if(G){let Se=_.style.directionalLight,ve=_.style.ambientLight;Se&&ve&&(me=lh(_.style,Se,ve))}{V=-1;let Se=F.TRIANGLES,[ve,be]=[b.gridIndexBuffer,b.gridSegments];for(let xe of I){let Ae=w.getTile(xe),Oe=Oi.disabled,Ke=b.prevTerrainTileForTile[xe.key],$e=b.terrainTileForTile[xe.key];ug(Ke,$e)&&Bs.newMorphing(xe.key,Ke,$e,k,250),O.activeTexture.set(F.TEXTURE0),Ae.texture&&Ae.texture.bind(F.LINEAR,F.CLAMP_TO_EDGE);let ct=Bs.getMorphValuesForProxy(xe.key),ut=ct?1:0,St;ct&&(St={morphing:{srcDemTile:ct.from,dstDemTile:ct.to,phase:r.cC(ct.phase)}});let He=mw(xe.projMatrix,yv(xe.canonical,he.renderWorldCopies)?_e/10:_e,me);if(W(ut),!z)continue;b.setupElevationDraw(Ae,z,St);let st=xe.toUnwrapped();G&&G.setupShadows(st,z),_.uploadCommonUniforms(O,z,st,null,K),z.draw(_,Se,ne,Oe,te,Ti.backCCW,He,"terrain_raster",b.gridBuffer,ve,be)}}}}(c,this,this.proxySourceCache,a,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),a.splice(0,a.length))}renderBatch(a){if(this._drapedRenderBatches.length===0)return a+1;this.renderingToTexture=!0;let c=this.painter,f=this.painter.context,_=this.proxySourceCache,b=this.proxiedCoords[_.id],w=this._drapedRenderBatches.shift(),I=c.style.order,k=[],O=0;for(let F of b){let z=_.getTileByID(F.proxyTileKey),V=_.proxyCachedFBO[F.key]?_.proxyCachedFBO[F.key][a]:void 0,G=V!==void 0?_.renderCache[V]:this.pool[O++],K=V!==void 0;if(z.texture=G.tex,K&&!G.dirty){k.push(z.tileID);continue}let W;f.bindFramebuffer.set(G.fb.framebuffer),this.renderedToTile=!1,G.dirty&&(f.clear({color:r.al.transparent,stencil:0}),G.dirty=!1);for(let te=w.start;te<=w.end;++te){let ne=c.style._mergedLayers[I[te]];if(ne.isHidden(c.transform.zoom))continue;let he=c.style.getLayerSourceCache(ne),_e=he?this.proxyToSource[F.key][he.id]:[F];if(!_e)continue;let me=_e;f.viewport.set([0,0,G.fb.width,G.fb.height]),W!==(he?he.id:null)&&(this._setupStencil(G,_e,ne,he),W=he?he.id:null),c.renderLayer(c,he,ne,me)}if(this._drapedRenderBatches.length===0)for(let te of this._pendingGroundEffectLayers){let ne=c.style._mergedLayers[I[te]];if(ne.isHidden(c.transform.zoom))continue;let he=c.style.getLayerSourceCache(ne),_e=he?this.proxyToSource[F.key][he.id]:[F];if(!_e)continue;let me=_e;f.viewport.set([0,0,G.fb.width,G.fb.height]),W!==(he?he.id:null)&&(this._setupStencil(G,_e,ne,he),W=he?he.id:null),c.renderLayer(c,he,ne,me)}this.renderedToTile?(G.dirty=!0,k.push(z.tileID)):K||--O,O===5&&(O=0,this.renderToBackBuffer(k))}return this.renderToBackBuffer(k),this.renderingToTexture=!1,f.bindFramebuffer.set(null),f.viewport.set([0,0,c.width,c.height]),w.end+1}postRender(){}isLayerOrderingCorrect(a){let c=a.order.length,f=-1,_=c;for(let b=0;b<c;++b)this._style.isLayerDraped(a._mergedLayers[a.order[b]])?f=Math.max(f,b):_=Math.min(_,b);return _>f}getMinElevationBelowMSL(){let a=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{a=Math.min(a,c.dem.tree.minimums[0])}),a===0?a:(a-30)*this._exaggeration}raycast(a,c,f){if(!this._visibleDemTiles)return null;let _=this._visibleDemTiles.filter(b=>b.dem).map(b=>{let w=b.tileID,I=1<<w.overscaledZ,{x:k,y:O}=w.canonical,F=k/I,z=(k+1)/I,V=O/I,G=(O+1)/I;return{minx:F,miny:V,maxx:z,maxy:G,t:b.dem.tree.raycastRoot(F,V,z,G,a,c,f),tile:b}});_.sort((b,w)=>(b.t!==null?b.t:Number.MAX_VALUE)-(w.t!==null?w.t:Number.MAX_VALUE));for(let b of _){if(b.t==null)return null;let w=b.tile.dem.tree.raycast(b.minx,b.miny,b.maxx,b.maxy,a,c,f);if(w!=null)return w}return null}_createFBO(){let a=this.painter.context,c=a.gl,f=this.drapeBufferSize;a.activeTexture.set(c.TEXTURE0);let _=new r.T(a,{width:f[0],height:f[1],data:null},c.RGBA8);_.bind(c.LINEAR,c.CLAMP_TO_EDGE);let b=a.createFramebuffer(f[0],f[1],!0,null);return b.colorAttachment.set(_.texture),b.depthAttachment=new fw(a,b.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=a.createRenderbuffer(a.gl.DEPTH_STENCIL,f[0],f[1]),this._stencilRef=0,b.depthAttachment.set(this._sharedDepthStencil),a.clear({stencil:0})):b.depthAttachment.set(this._sharedDepthStencil),a.extTextureFilterAnisotropic&&c.texParameterf(c.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax),{fb:b,tex:_,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(let a in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[a].hasTransition())return!0;return this._style.order.some(a=>{let c=this._style._mergedLayers[a],f=c.isHidden(this.painter.transform.zoom);return c.type==="hillshade"||c.type==="custom"?!f&&c.shouldRedrape():!f&&c.hasTransition()})}_clearLineLayersFromRenderCache(){let a=!1;for(let f of this._style.getSources())if(f instanceof Zu){a=!0;break}if(!a)return;let c={};for(let f=0;f<this._style.order.length;++f){let _=this._style._mergedLayers[this._style.order[f]],b=this._style.getLayerSourceCache(_);if(b&&!c[b.id]&&!_.isHidden(this.painter.transform.zoom)&&_.type==="line"&&_.widthExpression()instanceof r.ab){c[b.id]=!0;for(let w of this.proxyCoords){let I=this.proxyToSource[w.key][b.id];if(I)for(let k of I)this._clearRenderCacheForTile(b.id,k)}}}}_clearRasterLayersFromRenderCache(){let a=!1;for(let f in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[f]._source instanceof Ls){a=!0;break}if(!a)return;let c={};for(let f=0;f<this._style.order.length;++f){let _=this._style._mergedLayers[this._style.order[f]],b=this._style.getLayerSourceCache(_);if(!b||c[b.id]||_.isHidden(this.painter.transform.zoom)||_.type!=="raster")continue;let w=_.paint.get("raster-fade-duration");for(let I of this.proxyCoords){let k=this.proxyToSource[I.key][b.id];if(k)for(let O of k){let F=hg(b.getTile(O),b.findLoadedParent(O,0),b,this.painter.transform,w);(F.opacity!==1||F.mix!==0)&&this._clearRenderCacheForTile(b.id,O)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();let a=this._style.order,c=a.length;if(c===0)return;let f=[];this._pendingGroundEffectLayers=[];let _,b=0,w=this._style._mergedLayers[a[b]];for(;!this._style.isLayerDraped(w)&&w.isHidden(this.painter.transform.zoom)&&++b<c;)w=this._style._mergedLayers[a[b]];for(;b<c;++b){let I=this._style._mergedLayers[a[b]];I.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(I)?_===void 0&&(_=b):(I.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(b),_!==void 0&&(f.push({start:_,end:b-1}),_=void 0)))}if(_!==void 0&&f.push({start:_,end:b-1}),f.length!==0){let I=f[f.length-1];this._pendingGroundEffectLayers.every(k=>k>I.end)||r.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=f}_setupRenderCache(a){let c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){let w=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let I=0;I<w.length;++I){let k=Object.values(w[I]);c.renderCachePool.push(...k)}}return}this._clearRasterLayersFromRenderCache();let f=this.proxyCoords,_=this._tilesDirty;for(let w=f.length-1;w>=0;w--){let I=f[w];if(c.getTileByID(I.key),c.proxyCachedFBO[I.key]!==void 0){let k=a[I.key],O=this.proxyToSource[I.key],F=0;for(let z in O){let V=O[z],G=k[z];if(!G||G.length!==V.length||V.some((K,W)=>K!==G[W]||_[z]&&_[z].hasOwnProperty(K.key))){F=-1;break}++F}for(let z in c.proxyCachedFBO[I.key])c.renderCache[c.proxyCachedFBO[I.key][z]].dirty=F<0||F!==Object.values(k).length}}let b=[...this._drapedRenderBatches];b.sort((w,I)=>I.end-I.start-(w.end-w.start));for(let w of b)for(let I of f){if(c.proxyCachedFBO[I.key])continue;let k=c.renderCachePool.pop();k===void 0&&c.renderCache.length<50&&(k=c.renderCache.length,c.renderCache.push(this._createFBO())),k!==void 0&&(c.proxyCachedFBO[I.key]={},c.proxyCachedFBO[I.key][w.start]=k,c.renderCache[k].dirty=!0)}this._tilesDirty={}}_setupStencil(a,c,f,_){if(!_||!this._sourceTilesOverlap[_.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));let b=this.painter.context,w=b.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let I;if(f.isTileClipped())I=c.length,this._overlapStencilMode.test={func:w.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);I=1,this._overlapStencilMode.test={func:w.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+I>255&&(b.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=I,this._overlapStencilMode.ref=this._stencilRef,f.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(a){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[a.key]),this._overlapStencilMode):Oi.disabled}_renderTileClippingMasks(a,c){let f=this.painter,_=this.painter.context,b=_.gl;f._tileClippingMaskIDs={},_.setColorMode(Ji.disabled),_.setDepthMode(ci.disabled);let w=f.getOrCreateProgram("clippingMask");for(let I of a){let k=f._tileClippingMaskIDs[I.key]=--c;w.draw(f,b.TRIANGLES,ci.disabled,new Oi({func:b.ALWAYS,mask:0},k,255,b.KEEP,b.KEEP,b.REPLACE),Ji.disabled,Ti.disabled,mh(I.projMatrix),"$clipping",f.tileExtentBuffer,f.quadTriangleIndexBuffer,f.tileExtentSegments)}}pointCoordinate(a){let c=this.painter.transform;if(a.x<0||a.x>c.width||a.y<0||a.y>c.height)return null;let f=[a.x,a.y,1,1];r.ad.vec4.transformMat4(f,f,c.pixelMatrixInverse),r.ad.vec4.scale(f,f,1/f[3]),f[0]/=c.worldSize,f[1]/=c.worldSize;let _=c._camera.position,b=r.bH(1,c.center.lat),w=[_[0],_[1],_[2]/b,0],I=r.ad.vec3.subtract([],f.slice(0,3),w);r.ad.vec3.normalize(I,I);let k=this.raycast(w,I,this._exaggeration);return k!==null&&k?(r.ad.vec3.scaleAndAdd(w,w,I,k),w[3]=w[2],w[2]*=b,w):null}_setupProxiedCoordsForOrtho(a,c,f){if(a.getSource()instanceof r.aK)return this._setupProxiedCoordsForImageSource(a,c,f);this._findCoveringTileCache[a.id]=this._findCoveringTileCache[a.id]||{};let _=this.proxiedCoords[a.id]=[],b=this.proxyCoords;for(let k=0;k<b.length;k++){let O=b[k],F=this._findTileCoveringTileID(O,a);if(F){let z=this._createProxiedId(O,F,f[O.key]&&f[O.key][a.id]);_.push(z),this.proxyToSource[O.key][a.id]=[z]}}let w=!1,I=new Set;for(let k=0;k<c.length;k++){let O=a.getTile(c[k]);if(!O||!O.hasData())continue;let F=this._findTileCoveringTileID(O.tileID,this.proxySourceCache);if(F&&F.tileID.canonical.z!==O.tileID.canonical.z){let z=this.proxyToSource[F.tileID.key][a.id],V=this._createProxiedId(F.tileID,O,f[F.tileID.key]&&f[F.tileID.key][a.id]);z?z.splice(z.length-1,0,V):this.proxyToSource[F.tileID.key][a.id]=[V];let G=this.proxyToSource[F.tileID.key][a.id];I.has(G)||I.add(G),_.push(V),w=!0}}if(this._sourceTilesOverlap[a.id]=w,w&&this._debugParams.sortTilesHiZFirst)for(let k of I)k.sort((O,F)=>F.overscaledZ-O.overscaledZ)}_setupProxiedCoordsForImageSource(a,c,f){if(!a.getSource().loaded())return;let _=this.proxiedCoords[a.id]=[],b=this.proxyCoords,w=a.getSource(),I=w.tileID;if(!I)return;let k=new r.P(I.x,I.y)._div(1<<I.z),O=w.coordinates.map(r.ac.fromLngLat).reduce((z,V)=>(z.min.x=Math.min(z.min.x,V.x-k.x),z.min.y=Math.min(z.min.y,V.y-k.y),z.max.x=Math.max(z.max.x,V.x-k.x),z.max.y=Math.max(z.max.y,V.y-k.y),z),{min:new r.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new r.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),F=(z,V)=>{let G=z.wrap+z.canonical.x/(1<<z.canonical.z),K=z.canonical.y/(1<<z.canonical.z),W=r.ai/(1<<z.canonical.z),te=V.wrap+V.canonical.x/(1<<V.canonical.z),ne=V.canonical.y/(1<<V.canonical.z);return G+W<te+O.min.x||G>te+O.max.x||K+W<ne+O.min.y||K>ne+O.max.y};for(let z=0;z<b.length;z++){let V=b[z];for(let G=0;G<c.length;G++){let K=a.getTile(c[G]);if(!K||!K.hasData()||F(V,K.tileID))continue;let W=this._createProxiedId(V,K,f[V.key]&&f[V.key][a.id]),te=this.proxyToSource[V.key][a.id];te?te.push(W):this.proxyToSource[V.key][a.id]=[W],_.push(W)}}}_createProxiedId(a,c,f){let _=this.orthoMatrix;if(f){let b=f.find(w=>w.key===c.tileID.key);if(b)return b}if(c.tileID.key!==a.key){let b=a.canonical.z-c.tileID.canonical.z,w,I,k;_=r.ad.mat4.create();let O=c.tileID.wrap-a.wrap<<a.overscaledZ;b>0?(w=r.ai>>b,I=w*((c.tileID.canonical.x<<b)-a.canonical.x+O),k=w*((c.tileID.canonical.y<<b)-a.canonical.y)):(w=r.ai<<-b,I=r.ai*(c.tileID.canonical.x-(a.canonical.x+O<<-b)),k=r.ai*(c.tileID.canonical.y-(a.canonical.y<<-b))),r.ad.mat4.ortho(_,0,w,0,w,0,1),r.ad.mat4.translate(_,_,[I,k,0])}return new pg(c.tileID,a.key,_)}_findTileCoveringTileID(a,c){let f=c.getTile(a);if(f&&f.hasData())return f;let _=this._findCoveringTileCache[c.id],b=_[a.key];if(f=b?c.getTileByID(b):null,f&&f.hasData()||b===null)return f;let w=f?f.tileID:a,I=w.overscaledZ,k=c.getSource().minzoom,O=[];if(!b){let z=c.getSource().maxzoom;if(a.canonical.z>=z){let V=a.canonical.z-z;c.getSource().reparseOverscaled?(I=Math.max(a.canonical.z+2,c.transform.tileZoom),w=new r.aH(I,a.wrap,z,a.canonical.x>>V,a.canonical.y>>V)):V!==0&&(I=z,w=new r.aH(I,a.wrap,z,a.canonical.x>>V,a.canonical.y>>V))}w.key!==a.key&&(O.push(w.key),f=c.getTile(w))}let F=z=>{O.forEach(V=>{_[V]=z}),O.length=0};for(I-=1;I>=k&&(!f||!f.hasData());I--){f&&F(f.tileID.key);let z=w.calculateScaledKey(I);if(f=c.getTileByID(z),f&&f.hasData())break;let V=_[z];if(V===null)break;V===void 0?O.push(z):f=c.getTileByID(V)}return F(f?f.tileID.key:null),f&&f.hasData()?f:null}findDEMTileFor(a){return this.enabled?this._findTileCoveringTileID(a,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(a,c){let f=this._tilesDirty[a];f||(f=this._tilesDirty[a]={}),f[c.key]=!0}}function yw(m,a,c){let f=function(I,k,O){let F=r.ad.vec3.dot(k,I),z=r.ad.vec3.dot(O,[.2126,.7152,.0722]),V=(K,W,te)=>(1-te)*K+te*W,G=V(1-.3*Math.min(z,1),1,Math.min(F+1,1));return V(.92,1,Math.asin(r.ay(k[2],-1,1))/Math.PI+.5)*G}(m,[0,0,1],a),_=[0,0,0];r.ad.vec3.scale(_,c.slice(0,3),f);let b=[0,0,0];r.ad.vec3.scale(b,a.slice(0,3),m[2]);let w=[0,0,0];return r.ad.vec3.add(w,_,b),r.cg(w)}let mf=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],jM=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class vw{static cacheKey(a,c,f,_){let b=`${c}${_?_.cacheKey:""}`;for(let w of f)a.usedDefines.includes(w)&&(b+=`/${w}`);return b}constructor(a,c,f,_,b,w){let I=a.gl;this.program=I.createProgram(),this.configuration=_,this.name=c,this.fixedDefines=[...w];let k=_?_.getBinderAttributes():[],O=(f.staticAttributes||[]).concat(k),F=_?_.defines():[];F=F.concat(w.map(te=>`#define ${te}`));let z=`#version 300 es
`,V=z+F.concat("precision mediump float;",ag,iv.fragmentSource).join(`
`);for(let te of f.fragmentIncludes)V+=`
${ou[te]}`;V+=`
${f.fragmentSource}`;let G=z+F.concat("precision highp float;",ag,iv.vertexSource).join(`
`);for(let te of f.vertexIncludes)G+=`
${ou[te]}`;this.forceManualRenderingForInstanceIDShaders=a.forceManualRenderingForInstanceIDShaders&&f.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(G+=`
uniform int u_instanceID;
`),G+=`
${f.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(G=G.replaceAll("gl_InstanceID","u_instanceID"));let K=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(K,V),I.compileShader(K),I.attachShader(this.program,K);let W=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())this.failedToCreate=!0;else{I.shaderSource(W,G),I.compileShader(W),I.attachShader(this.program,W),this.attributes={},this.numAttributes=O.length;for(let te=0;te<this.numAttributes;te++)if(O[te]){let ne=O[te].startsWith("a_")?O[te]:`a_${O[te]}`;I.bindAttribLocation(this.program,te,ne),this.attributes[ne]=te}I.linkProgram(this.program),I.deleteShader(W),I.deleteShader(K),this.fixedUniforms=b(a),this.binderUniforms=_?_.getUniforms(a):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(te=>({u_instanceID:new r.bN(te)}))(a)),(w.includes("TERRAIN")||c.indexOf("symbol")!==-1||c.indexOf("circle")!==-1)&&(this.terrainUniforms=(te=>({u_dem:new r.bN(te),u_dem_prev:new r.bN(te),u_dem_tl:new r.bK(te),u_dem_scale:new r.bM(te),u_dem_tl_prev:new r.bK(te),u_dem_scale_prev:new r.bM(te),u_dem_size:new r.bM(te),u_dem_lerp:new r.bM(te),u_exaggeration:new r.bM(te),u_depth:new r.bN(te),u_depth_size_inv:new r.bK(te),u_depth_range_unpack:new r.bK(te),u_occluder_half_size:new r.bM(te),u_occlusion_depth_offset:new r.bM(te),u_meter_to_dem:new r.bM(te),u_label_plane_matrix_inv:new r.bJ(te)}))(a)),w.includes("GLOBE")&&(this.globeUniforms=(te=>({u_tile_tl_up:new r.bL(te),u_tile_tr_up:new r.bL(te),u_tile_br_up:new r.bL(te),u_tile_bl_up:new r.bL(te),u_tile_up_scale:new r.bM(te)}))(a)),w.includes("FOG")&&(this.fogUniforms=(te=>({u_fog_matrix:new r.bJ(te),u_fog_range:new r.bK(te),u_fog_color:new r.cb(te),u_fog_horizon_blend:new r.bM(te),u_fog_vertical_limit:new r.bK(te),u_fog_temporal_offset:new r.bM(te),u_frustum_tl:new r.bL(te),u_frustum_tr:new r.bL(te),u_frustum_br:new r.bL(te),u_frustum_bl:new r.bL(te),u_globe_pos:new r.bL(te),u_globe_radius:new r.bM(te),u_globe_transition:new r.bM(te),u_is_globe:new r.bN(te),u_viewport:new r.bK(te)}))(a)),w.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(te=>({u_cutoff_params:new r.cb(te)}))(a)),w.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(te=>({u_lighting_ambient_color:new r.bL(te),u_lighting_directional_dir:new r.bL(te),u_lighting_directional_color:new r.bL(te),u_ground_radiance:new r.bL(te)}))(a)),w.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(te=>({u_light_matrix_0:new r.bJ(te),u_light_matrix_1:new r.bJ(te),u_fade_range:new r.bK(te),u_shadow_normal_offset:new r.bL(te),u_shadow_intensity:new r.bM(te),u_shadow_texel_size:new r.bM(te),u_shadow_map_resolution:new r.bM(te),u_shadow_direction:new r.bL(te),u_shadow_bias:new r.bL(te),u_shadowmap_0:new r.bN(te),u_shadowmap_1:new r.bN(te)}))(a))}}setTerrainUniformValues(a,c){if(!this.terrainUniforms)return;let f=this.terrainUniforms;if(!this.failedToCreate){a.program.set(this.program);for(let _ in c)f[_]&&f[_].set(this.program,_,c[_])}}setGlobeUniformValues(a,c){if(!this.globeUniforms)return;let f=this.globeUniforms;if(!this.failedToCreate){a.program.set(this.program);for(let _ in c)f[_]&&f[_].set(this.program,_,c[_])}}setFogUniformValues(a,c){if(!this.fogUniforms)return;let f=this.fogUniforms;if(!this.failedToCreate){a.program.set(this.program);for(let _ in c)f[_].set(this.program,_,c[_])}}setCutoffUniformValues(a,c){if(!this.cutoffUniforms)return;let f=this.cutoffUniforms;if(!this.failedToCreate){a.program.set(this.program);for(let _ in c)f[_].set(this.program,_,c[_])}}setLightsUniformValues(a,c){if(!this.lightsUniforms)return;let f=this.lightsUniforms;if(!this.failedToCreate){a.program.set(this.program);for(let _ in c)f[_].set(this.program,_,c[_])}}setShadowUniformValues(a,c){if(this.failedToCreate||!this.shadowUniforms)return;let f=this.shadowUniforms;a.program.set(this.program);for(let _ in c)f[_].set(this.program,_,c[_])}_drawDebugWireframe(a,c,f,_,b,w,I,k,O,F){let z=a.options.wireframe;if(z.terrain===!1&&z.layers2D===!1&&z.layers3D===!1)return;let V=a.context;if(!(!(!z.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!z.layers2D||a._terrain&&a._terrain.renderingToTexture||!mf.includes(this.name))||!(!z.layers3D||!jM.includes(this.name))))return;let G=V.gl,K=a.wireframeDebugCache.getLinesFromTrianglesBuffer(a.frameCounter,b,V);if(!K)return;let W=[...this.fixedDefines];W.push("DEBUG_WIREFRAME");let te=a.getOrCreateProgram(this.name,{config:this.configuration,defines:W});V.program.set(te.program);let ne=(me,Se,ve)=>{if(Se[me]&&ve[me])for(let be in Se[me])ve[me][be]&&ve[me][be].set(ve.program,be,Se[me][be].current)};O&&O.setUniforms(te.program,V,te.binderUniforms,I,{zoom:k}),ne("fixedUniforms",this,te),ne("terrainUniforms",this,te),ne("globeUniforms",this,te),ne("fogUniforms",this,te),ne("lightsUniforms",this,te),ne("shadowUniforms",this,te),K.bind(),V.setColorMode(new Ji([G.ONE,G.ONE_MINUS_SRC_ALPHA,G.ZERO,G.ONE],r.al.transparent,[!0,!0,!0,!1])),V.setDepthMode(new ci(c.func===G.LESS?G.LEQUAL:c.func,ci.ReadOnly,c.range)),V.setStencilMode(Oi.disabled);let he=3*w.primitiveLength*2,_e=3*w.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){let me=F||1;for(let Se=0;Se<me;++Se)te.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Se),G.drawElements(G.LINES,he,G.UNSIGNED_SHORT,_e)}else F&&F>1?G.drawElementsInstanced(G.LINES,he,G.UNSIGNED_SHORT,_e,F):G.drawElements(G.LINES,he,G.UNSIGNED_SHORT,_e);b.bind(),V.program.set(this.program),V.setDepthMode(c),V.setStencilMode(f),V.setColorMode(_)}checkUniforms(a,c,f){if(this.fixedDefines.includes(c)){for(let _ of Object.keys(f))if(!f[_].initialized)throw new Error(`Program '${this.name}', from draw '${a}': uniform ${_} not set but required by ${c} being defined`)}}draw(a,c,f,_,b,w,I,k,O,F,z,V,G,K,W,te){let ne=a.context,he=ne.gl;if(this.failedToCreate)return;ne.program.set(this.program),ne.setDepthMode(f),ne.setStencilMode(_),ne.setColorMode(b),ne.setCullFace(w);for(let Se of Object.keys(this.fixedUniforms))this.fixedUniforms[Se].set(this.program,Se,I[Se]);K&&K.setUniforms(this.program,ne,this.binderUniforms,V,{zoom:G});let _e={[he.POINTS]:1,[he.LINES]:2,[he.TRIANGLES]:3,[he.LINE_STRIP]:1}[c];this.checkUniforms(k,"RENDER_SHADOWS",this.shadowUniforms);let me=te&&te>0?1:void 0;for(let Se of z.get()){let ve=Se.vaos||(Se.vaos={});if((ve[k]||(ve[k]=new sw)).bind(ne,this,O,K?K.getPaintVertexBuffers():[],F,Se.vertexOffset,W||[],me),this.forceManualRenderingForInstanceIDShaders){let be=te||1;for(let xe=0;xe<be;++xe)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",xe),F?he.drawElements(c,Se.primitiveLength*_e,he.UNSIGNED_SHORT,Se.primitiveOffset*_e*2):he.drawArrays(c,Se.vertexOffset,Se.vertexLength)}else te&&te>1?he.drawElementsInstanced(c,Se.primitiveLength*_e,he.UNSIGNED_SHORT,Se.primitiveOffset*_e*2,te):F?he.drawElements(c,Se.primitiveLength*_e,he.UNSIGNED_SHORT,Se.primitiveOffset*_e*2):he.drawArrays(c,Se.vertexOffset,Se.vertexLength);c===he.TRIANGLES&&F&&this._drawDebugWireframe(a,f,_,b,F,Se,V,G,K,te)}}}function bv(m,a){let c=Math.pow(2,a.tileID.overscaledZ),f=a.tileSize*Math.pow(2,m.transform.tileZoom)/c,_=f*(a.tileID.canonical.x+a.tileID.wrap*c),b=f*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture?a.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/r.at(a,1,m.transform.tileZoom),u_pixel_coord_upper:[_>>16,b>>16],u_pixel_coord_lower:[65535&_,65535&b]}}let fg={terrain:0,flat:1},xv=r.ad.mat4.create(),mg=(m,a,c,f,_,b,w,I,k,O,F,z,V,G,K,W,te,ne)=>{let he=a.style.light,_e=he.properties.get("position"),me=[_e.x,_e.y,_e.z],Se=r.ad.mat3.create();he.properties.get("anchor")==="viewport"&&(r.ad.mat3.fromRotation(Se,-a.transform.angle),r.ad.vec3.transformMat3(me,me,Se));let ve=he.properties.get("color"),be=a.transform,xe={u_matrix:m,u_lightpos:me,u_lightintensity:he.properties.get("intensity"),u_lightcolor:[ve.r,ve.g,ve.b],u_vertical_gradient:+c,u_opacity:f,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:xv,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:fg[O],u_base_type:fg[F],u_ao:_,u_edge_radius:b,u_width_scale:w,u_flood_light_color:K,u_vertical_scale:W,u_flood_light_intensity:te,u_ground_shadow_factor:ne};return be.projection.name==="globe"&&(xe.u_tile_id=[I.canonical.x,I.canonical.y,1<<I.canonical.z],xe.u_zoom_transition=z,xe.u_inv_rot_matrix=G,xe.u_merc_center=V,xe.u_up_dir=be.projection.upVector(new r.bT(0,0,0),V[0]*r.ai,V[1]*r.ai),xe.u_height_lift=k),xe},gh=(m,a,c,f,_,b)=>({u_matrix:m,u_edge_radius:a,u_width_scale:c,u_vertical_scale:f,u_height_type:fg[_],u_base_type:fg[b]}),wv=(m,a,c,f,_,b,w,I,k,O,F,z,V,G,K,W,te)=>{let ne=mg(m,a,c,f,_,b,w,I,O,F,z,V,G,K,W,te,1,[0,0,0]),he={u_height_factor:-Math.pow(2,I.overscaledZ)/k.tileSize/8};return r.l(ne,bv(a,k),he)},_h=(m,a)=>({u_matrix:m,u_emissive_strength:a}),Cv=(m,a,c,f)=>r.l(_h(m,a),bv(c,f)),gg=(m,a,c)=>({u_matrix:m,u_world:c,u_emissive_strength:a}),_g=(m,a,c,f,_)=>r.l(Cv(m,a,c,f),{u_world:_}),gf=(m,a,c,f,_)=>({u_matrix:m,u_camera_pos:[a[0],a[1],a[2]],u_depth_bias:c,u_height_scale:f,u_reset_depth:_}),bw=(m,a,c,f)=>{let _=r.ai/c.tileSize;return{u_matrix:m,u_camera_to_center_distance:a.getCameraToCenterDistance(f),u_extrude_scale:[a.pixelsToGLUnits[0]/_,a.pixelsToGLUnits[1]/_]}},xw=(m,a,c=1)=>({u_matrix:m,u_color:a.toRenderColor(null),u_overlay:0,u_overlay_scale:c}),yh=r.ad.mat4.create(),yg=(m,a,c,f,_,b,w)=>{let I=m.transform,k=I.projection.name==="globe",O=k?r.cO(I.zoom,a.canonical)*I._pixelsPerMercatorPixel:r.at(c,1,b),F={u_matrix:a.projMatrix,u_extrude_scale:O,u_intensity:w,u_inv_rot_matrix:yh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(k){F.u_inv_rot_matrix=f,F.u_merc_center=_,F.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],F.u_zoom_transition=r.ag(I.zoom);let z=_[0]*r.ai,V=_[1]*r.ai;F.u_up_dir=I.projection.upVector(new r.bT(0,0,0),z,V)}return F};function $t(m,[a,c,f,_],[b,w]){if(b===w)return[0,0,0,0];let I=255*(m-1)/(m*(w-b));return[a*I,c*I,f*I,_*I]}function Ev(m,a,[c,f]){return c===f?0:.5/m+(a-c)*(m-1)/(m*(f-c))}let Sv=(m,a,c,f,_,b,w,I,k,O,F,z,V,G,K,W,te,ne,he,_e,me)=>({u_matrix:m,u_normalize_matrix:a,u_globe_matrix:c,u_merc_matrix:f,u_grid_matrix:_,u_tl_parent:b,u_scale_parent:O,u_fade_t:F.mix,u_opacity:F.opacity*z.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:z.paint.get("raster-brightness-min"),u_brightness_high:z.paint.get("raster-brightness-max"),u_saturation_factor:r.cP(z.paint.get("raster-saturation")),u_contrast_factor:r.cQ(z.paint.get("raster-contrast")),u_spin_weights:dd(z.paint.get("raster-hue-rotate")),u_perspective_transform:V,u_raster_elevation:G,u_zoom_transition:w,u_merc_center:I,u_cutoff_params:k,u_colorization_mix:$t(r.cR,W,ne),u_colorization_offset:Ev(r.cR,te,ne),u_color_ramp:K,u_texture_offset:[_e/(he+2*_e),he/(he+2*_e)],u_texture_res:[he+2*_e,he+2*_e],u_emissive_strength:me});function dd(m){m*=Math.PI/180;let a=Math.sin(m),c=Math.cos(m);return[(2*c+1)/3,(-Math.sqrt(3)*a-c+1)/3,(Math.sqrt(3)*a-c+1)/3]}let vs=.05,fi=(m,a,c,f,_,b,w,I,k,O,F,z)=>({u_matrix:m,u_normalize_matrix:a,u_globe_matrix:c,u_merc_matrix:f,u_grid_matrix:_,u_tl_parent:b,u_scale_parent:O,u_fade_t:F.mix,u_opacity:F.opacity,u_image0:0,u_image1:1,u_raster_elevation:z,u_zoom_transition:w,u_merc_center:I,u_cutoff_params:k}),Dv=(m,a,c,f,_,b,w,I,k,O)=>({u_particle_texture:m,u_particle_texture_side_len:a,u_tile_offset:c,u_velocity:f,u_color_ramp:b,u_velocity_res:_,u_max_speed:w,u_uv_offset:I,u_data_scale:[255*k[0],255*k[1]],u_data_offset:O,u_particle_pos_scale:1.1,u_particle_pos_offset:[vs,vs]}),UM=(m,a,c,f,_,b,w,I,k,O)=>({u_particle_texture:m,u_particle_texture_side_len:a,u_velocity:c,u_velocity_res:f,u_max_speed:_,u_speed_factor:b,u_reset_rate:w,u_rand_seed:Math.random(),u_uv_offset:I,u_data_scale:[255*k[0],255*k[1]],u_data_offset:O,u_particle_pos_scale:1.1,u_particle_pos_offset:[vs,vs]}),ww=r.ad.mat4.create(),vg=(m,a,c,f,_,b,w,I,k,O,F,z,V,G,K,W,te,ne,he,_e,me,Se)=>{let ve=_.transform,be={u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:ve.getCameraToCenterDistance(he),u_rotate_symbol:+c,u_aspect_ratio:ve.width/ve.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:w,u_coord_matrix:I,u_is_text:+O,u_elevation_from_sea:k?1:0,u_pitch_with_map:+f,u_texsize:F,u_texsize_icon:z,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ww,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:ww,u_up_vector:[0,-1,0],u_color_adj_mat:_e,u_icon_transition:me||0,u_gamma_scale:f?_.transform.getCameraToCenterDistance(he)*Math.cos(_.terrain?0:_.transform._pitch):1,u_device_pixel_ratio:r.q.devicePixelRatio,u_is_halo:+V,u_scale_factor:Se||1};return he.name==="globe"&&(be.u_tile_id=[G.canonical.x,G.canonical.y,1<<G.canonical.z],be.u_zoom_transition=K,be.u_inv_rot_matrix=te,be.u_merc_center=W,be.u_camera_forward=ve._camera.forward(),be.u_ecef_origin=r.cS(ve.globeMatrix,G.toUnwrapped()),be.u_tile_matrix=Float32Array.from(ve.globeMatrix),be.u_up_vector=ne),be},Mv=(m,a,c,f)=>({u_matrix:m,u_emissive_strength:a,u_opacity:c,u_color:f}),Cw=(m,a,c,f,_,b,w,I,k)=>r.l(function(O,F,z,V,G,K){let{width:W,height:te}=V.imageManager.getPixelSize(F),ne=Math.pow(2,K.tileID.overscaledZ),he=K.tileSize*Math.pow(2,V.transform.tileZoom)/ne,_e=he*(K.tileID.canonical.x+K.tileID.wrap*ne),me=he*K.tileID.canonical.y;return{u_image:0,u_pattern_tl:z.tl,u_pattern_br:z.br,u_texsize:[W,te],u_pattern_size:z.displaySize,u_pattern_units_to_pixels:G?[V.transform.width,-1*V.transform.height]:[1/r.at(K,1,V.transform.tileZoom),1/r.at(K,1,V.transform.tileZoom)],u_pixel_coord_upper:[_e>>16,me>>16],u_pixel_coord_lower:[65535&_e,65535&me]}}(0,b,w,f,I,k),{u_matrix:m,u_emissive_strength:a,u_opacity:c}),bg=new Float32Array(r.ad.mat4.identity([])),Tv=(m,a,c,f,_,b,w,I,k,O,F,z,V,G=[0,0,0],K)=>{let W=_.style.light,te=W.properties.get("position"),ne=[-te.x,-te.y,te.z],he=r.ad.mat3.create();W.properties.get("anchor")==="viewport"&&(r.ad.mat3.fromRotation(he,-_.transform.angle),r.ad.vec3.transformMat3(ne,ne,he));let _e=F.alphaMode==="MASK",me=W.properties.get("color").toRenderColor(null),Se=V.paint.get("model-ambient-occlusion-intensity"),ve=V.paint.get("model-color").constantOr(r.al.white).toRenderColor(null),be=V.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:m,u_lighting_matrix:a,u_normal_matrix:c,u_node_matrix:f||bg,u_lightpos:ne,u_lightintensity:W.properties.get("intensity"),u_lightcolor:[me.r,me.g,me.b],u_camera_pos:G,u_opacity:b,u_baseTextureIsAlpha:0,u_alphaMask:+_e,u_alphaCutoff:F.alphaCutoff,u_baseColorFactor:[w.r,w.g,w.b,w.a],u_emissiveFactor:[I[0],I[1],I[2],1],u_metallicFactor:k,u_roughnessFactor:O,u_baseColorTexture:Or.BaseColor,u_metallicRoughnessTexture:Or.MetallicRoughness,u_normalTexture:Or.Normal,u_occlusionTexture:Or.Occlusion,u_emissionTexture:Or.Emission,u_lutTexture:Or.LUT,u_color_mix:[ve.r,ve.g,ve.b,be],u_aoIntensity:Se,u_emissive_strength:z,u_occlusionTextureTransform:K||[0,0,0,0]}},Ew=(m,a=bg,c=bg)=>({u_matrix:m,u_instance:a,u_node_matrix:c}),Iv={fillExtrusion:m=>({u_matrix:new r.bJ(m),u_lightpos:new r.bL(m),u_lightintensity:new r.bM(m),u_lightcolor:new r.bL(m),u_vertical_gradient:new r.bM(m),u_opacity:new r.bM(m),u_edge_radius:new r.bM(m),u_width_scale:new r.bM(m),u_ao:new r.bK(m),u_height_type:new r.bN(m),u_base_type:new r.bN(m),u_tile_id:new r.bL(m),u_zoom_transition:new r.bM(m),u_inv_rot_matrix:new r.bJ(m),u_merc_center:new r.bK(m),u_up_dir:new r.bL(m),u_height_lift:new r.bM(m),u_flood_light_color:new r.bL(m),u_vertical_scale:new r.bM(m),u_flood_light_intensity:new r.bM(m),u_ground_shadow_factor:new r.bL(m)}),fillExtrusionDepth:m=>({u_matrix:new r.bJ(m),u_edge_radius:new r.bM(m),u_width_scale:new r.bM(m),u_vertical_scale:new r.bM(m),u_height_type:new r.bN(m),u_base_type:new r.bN(m)}),fillExtrusionPattern:m=>({u_matrix:new r.bJ(m),u_lightpos:new r.bL(m),u_lightintensity:new r.bM(m),u_lightcolor:new r.bL(m),u_vertical_gradient:new r.bM(m),u_height_factor:new r.bM(m),u_edge_radius:new r.bM(m),u_width_scale:new r.bM(m),u_ao:new r.bK(m),u_height_type:new r.bN(m),u_base_type:new r.bN(m),u_tile_id:new r.bL(m),u_zoom_transition:new r.bM(m),u_inv_rot_matrix:new r.bJ(m),u_merc_center:new r.bK(m),u_up_dir:new r.bL(m),u_height_lift:new r.bM(m),u_image:new r.bN(m),u_texsize:new r.bK(m),u_pixel_coord_upper:new r.bK(m),u_pixel_coord_lower:new r.bK(m),u_tile_units_to_pixels:new r.bM(m),u_opacity:new r.bM(m)}),fillExtrusionGroundEffect:m=>({u_matrix:new r.bJ(m),u_opacity:new r.bM(m),u_ao_pass:new r.bM(m),u_meter_to_tile:new r.bM(m),u_ao:new r.bK(m),u_flood_light_intensity:new r.bM(m),u_flood_light_color:new r.bL(m),u_attenuation:new r.bM(m),u_edge_radius:new r.bM(m),u_fb:new r.bN(m),u_fb_size:new r.bM(m),u_dynamic_offset:new r.bM(m)}),fill:m=>({u_matrix:new r.bJ(m),u_emissive_strength:new r.bM(m)}),fillPattern:m=>({u_matrix:new r.bJ(m),u_emissive_strength:new r.bM(m),u_image:new r.bN(m),u_texsize:new r.bK(m),u_pixel_coord_upper:new r.bK(m),u_pixel_coord_lower:new r.bK(m),u_tile_units_to_pixels:new r.bM(m)}),fillOutline:m=>({u_matrix:new r.bJ(m),u_emissive_strength:new r.bM(m),u_world:new r.bK(m)}),fillOutlinePattern:m=>({u_matrix:new r.bJ(m),u_emissive_strength:new r.bM(m),u_world:new r.bK(m),u_image:new r.bN(m),u_texsize:new r.bK(m),u_pixel_coord_upper:new r.bK(m),u_pixel_coord_lower:new r.bK(m),u_tile_units_to_pixels:new r.bM(m)}),elevatedStructures:m=>({u_matrix:new r.bJ(m)}),elevatedStructuresDepthReconstruct:m=>({u_matrix:new r.bJ(m),u_camera_pos:new r.bL(m),u_depth_bias:new r.bM(m),u_height_scale:new r.bM(m),u_reset_depth:new r.bM(m)}),circle:r.cT,collisionBox:m=>({u_matrix:new r.bJ(m),u_camera_to_center_distance:new r.bM(m),u_extrude_scale:new r.bK(m)}),collisionCircle:m=>({u_matrix:new r.bJ(m),u_inv_matrix:new r.bJ(m),u_camera_to_center_distance:new r.bM(m),u_viewport_size:new r.bK(m)}),debug:m=>({u_color:new r.cA(m),u_matrix:new r.bJ(m),u_overlay:new r.bN(m),u_overlay_scale:new r.bM(m)}),clippingMask:m=>({u_matrix:new r.bJ(m)}),heatmap:m=>({u_extrude_scale:new r.bM(m),u_intensity:new r.bM(m),u_matrix:new r.bJ(m),u_inv_rot_matrix:new r.bJ(m),u_merc_center:new r.bK(m),u_tile_id:new r.bL(m),u_zoom_transition:new r.bM(m),u_up_dir:new r.bL(m)}),heatmapTexture:m=>({u_image:new r.bN(m),u_color_ramp:new r.bN(m),u_opacity:new r.bM(m)}),hillshade:m=>({u_matrix:new r.bJ(m),u_image:new r.bN(m),u_latrange:new r.bK(m),u_light:new r.bK(m),u_shadow:new r.cA(m),u_highlight:new r.cA(m),u_emissive_strength:new r.bM(m),u_accent:new r.cA(m)}),hillshadePrepare:m=>({u_matrix:new r.bJ(m),u_image:new r.bN(m),u_dimension:new r.bK(m),u_zoom:new r.bM(m)}),line:r.cU,linePattern:r.cV,raster:m=>({u_matrix:new r.bJ(m),u_normalize_matrix:new r.bJ(m),u_globe_matrix:new r.bJ(m),u_merc_matrix:new r.bJ(m),u_grid_matrix:new r.cB(m),u_tl_parent:new r.bK(m),u_scale_parent:new r.bM(m),u_fade_t:new r.bM(m),u_opacity:new r.bM(m),u_image0:new r.bN(m),u_image1:new r.bN(m),u_brightness_low:new r.bM(m),u_brightness_high:new r.bM(m),u_saturation_factor:new r.bM(m),u_contrast_factor:new r.bM(m),u_spin_weights:new r.bL(m),u_perspective_transform:new r.bK(m),u_raster_elevation:new r.bM(m),u_zoom_transition:new r.bM(m),u_merc_center:new r.bK(m),u_cutoff_params:new r.cb(m),u_colorization_mix:new r.cb(m),u_colorization_offset:new r.bM(m),u_color_ramp:new r.bN(m),u_texture_offset:new r.bK(m),u_texture_res:new r.bK(m),u_emissive_strength:new r.bM(m)}),rasterParticle:m=>({u_matrix:new r.bJ(m),u_normalize_matrix:new r.bJ(m),u_globe_matrix:new r.bJ(m),u_merc_matrix:new r.bJ(m),u_grid_matrix:new r.cB(m),u_tl_parent:new r.bK(m),u_scale_parent:new r.bM(m),u_fade_t:new r.bM(m),u_opacity:new r.bM(m),u_image0:new r.bN(m),u_image1:new r.bN(m),u_raster_elevation:new r.bM(m),u_zoom_transition:new r.bM(m),u_merc_center:new r.bK(m),u_cutoff_params:new r.cb(m)}),rasterParticleTexture:m=>({u_texture:new r.bN(m),u_opacity:new r.bM(m)}),rasterParticleDraw:m=>({u_particle_texture:new r.bN(m),u_particle_texture_side_len:new r.bM(m),u_tile_offset:new r.bK(m),u_velocity:new r.bN(m),u_color_ramp:new r.bN(m),u_velocity_res:new r.bK(m),u_max_speed:new r.bM(m),u_uv_offset:new r.bK(m),u_data_scale:new r.bK(m),u_data_offset:new r.bM(m),u_particle_pos_scale:new r.bM(m),u_particle_pos_offset:new r.bK(m)}),rasterParticleUpdate:m=>({u_particle_texture:new r.bN(m),u_particle_texture_side_len:new r.bM(m),u_velocity:new r.bN(m),u_velocity_res:new r.bK(m),u_max_speed:new r.bM(m),u_speed_factor:new r.bM(m),u_reset_rate:new r.bM(m),u_rand_seed:new r.bM(m),u_uv_offset:new r.bK(m),u_data_scale:new r.bK(m),u_data_offset:new r.bM(m),u_particle_pos_scale:new r.bM(m),u_particle_pos_offset:new r.bK(m)}),symbol:m=>({u_is_size_zoom_constant:new r.bN(m),u_is_size_feature_constant:new r.bN(m),u_size_t:new r.bM(m),u_size:new r.bM(m),u_camera_to_center_distance:new r.bM(m),u_rotate_symbol:new r.bN(m),u_aspect_ratio:new r.bM(m),u_fade_change:new r.bM(m),u_matrix:new r.bJ(m),u_label_plane_matrix:new r.bJ(m),u_coord_matrix:new r.bJ(m),u_is_text:new r.bN(m),u_elevation_from_sea:new r.bN(m),u_pitch_with_map:new r.bN(m),u_texsize:new r.bK(m),u_texsize_icon:new r.bK(m),u_texture:new r.bN(m),u_texture_icon:new r.bN(m),u_gamma_scale:new r.bM(m),u_device_pixel_ratio:new r.bM(m),u_tile_id:new r.bL(m),u_zoom_transition:new r.bM(m),u_inv_rot_matrix:new r.bJ(m),u_merc_center:new r.bK(m),u_camera_forward:new r.bL(m),u_tile_matrix:new r.bJ(m),u_up_vector:new r.bL(m),u_ecef_origin:new r.bL(m),u_is_halo:new r.bN(m),u_icon_transition:new r.bM(m),u_color_adj_mat:new r.bJ(m),u_scale_factor:new r.bM(m)}),background:m=>({u_matrix:new r.bJ(m),u_emissive_strength:new r.bM(m),u_opacity:new r.bM(m),u_color:new r.cA(m)}),backgroundPattern:m=>({u_matrix:new r.bJ(m),u_emissive_strength:new r.bM(m),u_opacity:new r.bM(m),u_image:new r.bN(m),u_pattern_tl:new r.bK(m),u_pattern_br:new r.bK(m),u_texsize:new r.bK(m),u_pattern_size:new r.bK(m),u_pixel_coord_upper:new r.bK(m),u_pixel_coord_lower:new r.bK(m),u_pattern_units_to_pixels:new r.bK(m)}),terrainRaster:m=>({u_matrix:new r.bJ(m),u_image0:new r.bN(m),u_skirt_height:new r.bM(m),u_ground_shadow_factor:new r.bL(m)}),skybox:m=>({u_matrix:new r.bJ(m),u_sun_direction:new r.bL(m),u_cubemap:new r.bN(m),u_opacity:new r.bM(m),u_temporal_offset:new r.bM(m)}),skyboxGradient:m=>({u_matrix:new r.bJ(m),u_color_ramp:new r.bN(m),u_center_direction:new r.bL(m),u_radius:new r.bM(m),u_opacity:new r.bM(m),u_temporal_offset:new r.bM(m)}),skyboxCapture:m=>({u_matrix_3f:new r.cB(m),u_sun_direction:new r.bL(m),u_sun_intensity:new r.bM(m),u_color_tint_r:new r.cb(m),u_color_tint_m:new r.cb(m),u_luminance:new r.bM(m)}),globeRaster:m=>({u_proj_matrix:new r.bJ(m),u_globe_matrix:new r.bJ(m),u_normalize_matrix:new r.bJ(m),u_merc_matrix:new r.bJ(m),u_zoom_transition:new r.bM(m),u_merc_center:new r.bK(m),u_image0:new r.bN(m),u_grid_matrix:new r.cB(m),u_skirt_height:new r.bM(m),u_far_z_cutoff:new r.bM(m),u_frustum_tl:new r.bL(m),u_frustum_tr:new r.bL(m),u_frustum_br:new r.bL(m),u_frustum_bl:new r.bL(m),u_globe_pos:new r.bL(m),u_globe_radius:new r.bM(m),u_viewport:new r.bK(m)}),globeAtmosphere:m=>({u_frustum_tl:new r.bL(m),u_frustum_tr:new r.bL(m),u_frustum_br:new r.bL(m),u_frustum_bl:new r.bL(m),u_horizon:new r.bM(m),u_transition:new r.bM(m),u_fadeout_range:new r.bM(m),u_color:new r.cb(m),u_high_color:new r.cb(m),u_space_color:new r.cb(m),u_temporal_offset:new r.bM(m),u_horizon_angle:new r.bM(m)}),model:m=>({u_matrix:new r.bJ(m),u_lighting_matrix:new r.bJ(m),u_normal_matrix:new r.bJ(m),u_node_matrix:new r.bJ(m),u_lightpos:new r.bL(m),u_lightintensity:new r.bM(m),u_lightcolor:new r.bL(m),u_camera_pos:new r.bL(m),u_opacity:new r.bM(m),u_baseColorFactor:new r.cb(m),u_emissiveFactor:new r.cb(m),u_metallicFactor:new r.bM(m),u_roughnessFactor:new r.bM(m),u_baseTextureIsAlpha:new r.bN(m),u_alphaMask:new r.bN(m),u_alphaCutoff:new r.bM(m),u_baseColorTexture:new r.bN(m),u_metallicRoughnessTexture:new r.bN(m),u_normalTexture:new r.bN(m),u_occlusionTexture:new r.bN(m),u_emissionTexture:new r.bN(m),u_lutTexture:new r.bN(m),u_color_mix:new r.cb(m),u_aoIntensity:new r.bM(m),u_emissive_strength:new r.bM(m),u_occlusionTextureTransform:new r.cb(m)}),modelDepth:m=>({u_matrix:new r.bJ(m),u_instance:new r.bJ(m),u_node_matrix:new r.bJ(m)}),groundShadow:m=>({u_matrix:new r.bJ(m),u_ground_shadow_factor:new r.bL(m)}),stars:m=>({u_matrix:new r.bJ(m),u_up:new r.bL(m),u_right:new r.bL(m),u_intensity_multiplier:new r.bM(m)}),snowParticle:m=>({u_modelview:new r.bJ(m),u_projection:new r.bJ(m),u_time:new r.bM(m),u_cam_pos:new r.bL(m),u_velocityConeAperture:new r.bM(m),u_velocity:new r.bM(m),u_horizontalOscillationRadius:new r.bM(m),u_horizontalOscillationRate:new r.bM(m),u_boxSize:new r.bM(m),u_billboardSize:new r.bM(m),u_simpleShapeParameters:new r.bK(m),u_screenSize:new r.bK(m),u_thinningCenterPos:new r.bK(m),u_thinningShape:new r.bL(m),u_thinningAffectedRatio:new r.bM(m),u_thinningParticleOffset:new r.bM(m),u_particleColor:new r.cb(m),u_direction:new r.bL(m)}),rainParticle:m=>({u_modelview:new r.bJ(m),u_projection:new r.bJ(m),u_time:new r.bM(m),u_cam_pos:new r.bL(m),u_texScreen:new r.bN(m),u_velocityConeAperture:new r.bM(m),u_velocity:new r.bM(m),u_boxSize:new r.bM(m),u_rainDropletSize:new r.bK(m),u_distortionStrength:new r.bM(m),u_rainDirection:new r.bL(m),u_color:new r.cb(m),u_screenSize:new r.bK(m),u_thinningCenterPos:new r.bK(m),u_thinningShape:new r.bL(m),u_thinningAffectedRatio:new r.bM(m),u_thinningParticleOffset:new r.bM(m),u_shapeDirectionalPower:new r.bM(m),u_shapeNormalPower:new r.bM(m),u_mode:new r.bM(m)}),vignette:m=>({u_vignetteShape:new r.bL(m),u_vignetteColor:new r.cb(m)}),occlusion:m=>({u_matrix:new r.bJ(m),u_anchorPos:new r.bL(m),u_screenSizePx:new r.bK(m),u_occluderSizePx:new r.bK(m),u_color:new r.cb(m)})},xg=(()=>{class m{constructor(c,f,_,b){this.id=m.uniqueIdxCounter,m.uniqueIdxCounter++,this.context=c;let w=c.gl;this.buffer=w.createBuffer(),this.dynamicDraw=!!_,this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||b||f.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){this.id=m.uniqueIdxCounter,m.uniqueIdxCounter++;let f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}return m.uniqueIdxCounter=0,m})(),Av={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Rv{constructor(a,c,f,_,b,w){this.length=c.length,this.attributes=f,this.itemSize=c.bytesPerElement,this.dynamicDraw=_,this.instanceCount=w,this.context=a;let I=a.gl;this.buffer=I.createBuffer(),a.bindVertexBuffer.set(this.buffer),I.bufferData(I.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?I.DYNAMIC_DRAW:I.STATIC_DRAW),this.dynamicDraw||b||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(a){let c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,a.arrayBuffer)}enableAttributes(a,c){for(let f=0;f<this.attributes.length;f++){let _=c.attributes[this.attributes[f].name];_!==void 0&&a.enableVertexAttribArray(_)}}setVertexAttribPointers(a,c,f){for(let _=0;_<this.attributes.length;_++){let b=this.attributes[_],w=c.attributes[b.name];w!==void 0&&a.vertexAttribPointer(w,b.components,a[Av[b.type]],!1,this.itemSize,b.offset+this.itemSize*(f||0))}}setVertexAttribDivisor(a,c,f){for(let _=0;_<this.attributes.length;_++){let b=c.attributes[this.attributes[_].name];b!==void 0&&this.instanceCount&&this.instanceCount>0&&a.vertexAttribDivisor(b,f)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ua{constructor(a,c,f,_,b){this.context=a,this.width=c,this.height=f;let w=this.framebuffer=a.gl.createFramebuffer();_&&(this.colorAttachment=new fv(a,w)),b&&(this.depthAttachmentType=b,this.depthAttachment=b==="renderbuffer"?new mv(a,w):new fh(a,w))}destroy(){let a=this.context.gl;if(this.colorAttachment){let c=this.colorAttachment.get();c&&a.deleteTexture(c)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){let c=this.depthAttachment.get();c&&a.deleteRenderbuffer(c)}else{let c=this.depthAttachment.get();c&&a.deleteTexture(c)}a.deleteFramebuffer(this.framebuffer)}}class ud{constructor(a,c){this.gl=a,this.clearColor=new PM(this),this.clearDepth=new rv(this),this.clearStencil=new ov(this),this.colorMask=new av(this),this.depthMask=new sv(this),this.stencilMask=new cw(this),this.stencilFunc=new dw(this),this.stencilOp=new OM(this),this.stencilTest=new hf(this),this.depthRange=new pf(this),this.depthTest=new uw(this),this.depthFunc=new ys(this),this.blend=new lv(this),this.blendFunc=new sg(this),this.blendColor=new lg(this),this.blendEquation=new cv(this),this.cullFace=new dv(this),this.cullFaceSide=new uv(this),this.frontFace=new cg(this),this.program=new hv(this),this.activeTexture=new pv(this),this.viewport=new dg(this),this.bindFramebuffer=new hw(this),this.bindRenderbuffer=new pw(this),this.bindTexture=new ph(this),this.bindVertexBuffer=new FM(this),this.bindElementBuffer=new LM(this),this.bindVertexArrayOES=new NM(this),this.pixelStoreUnpack=new zM(this),this.pixelStoreUnpackPremultiplyAlpha=new BM(this),this.pixelStoreUnpackFlipY=new VM(this),this.options=c?Object.assign({},c):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=a.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=a.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=a.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=c&&!!c.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=a.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE),this.maxPointSize=a.getParameter(a.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(a,c,f){return new xg(this,a,c,f)}createVertexBuffer(a,c,f,_,b){return new Rv(this,a,c,f,_,b)}createRenderbuffer(a,c,f){let _=this.gl,b=_.createRenderbuffer();return this.bindRenderbuffer.set(b),_.renderbufferStorage(_.RENDERBUFFER,a,c,f),this.bindRenderbuffer.set(null),b}createFramebuffer(a,c,f,_){return new Ua(this,a,c,f,_)}clear({color:a,depth:c,stencil:f,colorMask:_}){let b=this.gl,w=0;a&&(w|=b.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set(_||[!0,!0,!0,!0])),c!==void 0&&(w|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),f!==void 0&&(w|=b.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),b.clear(w)}setCullFace(a){a.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))}setDepthMode(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)}setStencilMode(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)}setColorMode(a){r.bn(a.blendFunction,Ji.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(a.blendFunction),this.blendColor.set(a.blendColor),a.blendEquation?this.blendEquation.set(a.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(a.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let _f;function wg(m,a,c,f,_,b,w){let I=m.context,k=I.gl,O=m.transform,F=m.getOrCreateProgram("collisionBox"),z=[],V=0,G=0;for(let me=0;me<f.length;me++){let Se=f[me],ve=a.getTile(Se),be=ve.getBucket(c);if(!be)continue;let xe=Zy(Se,be,O),Ae=xe;_[0]===0&&_[1]===0||(Ae=m.translatePosMatrix(xe,ve,_,b));let Oe=w?be.textCollisionBox:be.iconCollisionBox,Ke=be.collisionCircleArray;if(Ke.length>0){let $e=r.ad.mat4.create(),ct=Ae;r.ad.mat4.mul($e,be.placementInvProjMatrix,O.glCoordMatrix),r.ad.mat4.mul($e,$e,be.placementViewportMatrix),z.push({circleArray:Ke,circleOffset:G,transform:ct,invTransform:$e,projection:be.getProjection()}),V+=Ke.length/4,G=V}Oe&&(m.terrain&&m.terrain.setupElevationDraw(ve,F),F.draw(m,k.LINES,ci.disabled,Oi.disabled,m.colorModeForRenderPass(),Ti.disabled,bw(Ae,O,ve,be.getProjection()),c.id,Oe.layoutVertexBuffer,Oe.indexBuffer,Oe.segments,null,O.zoom,null,[Oe.collisionVertexBuffer,Oe.collisionVertexBufferExt]))}if(!w||!z.length)return;let K=m.getOrCreateProgram("collisionCircle"),W=new r.cW;W.resize(4*V),W._trim();let te=0;for(let me of z)for(let Se=0;Se<me.circleArray.length/4;Se++){let ve=4*Se,be=me.circleArray[ve+0],xe=me.circleArray[ve+1],Ae=me.circleArray[ve+2],Oe=me.circleArray[ve+3];W.emplace(te++,be,xe,Ae,Oe,0),W.emplace(te++,be,xe,Ae,Oe,1),W.emplace(te++,be,xe,Ae,Oe,2),W.emplace(te++,be,xe,Ae,Oe,3)}(!_f||_f.length<2*V)&&(_f=function(me){let Se=2*me,ve=new r.aV;ve.resize(Se),ve._trim();for(let be=0;be<Se;be++){let xe=6*be;ve.uint16[xe+0]=4*be+0,ve.uint16[xe+1]=4*be+1,ve.uint16[xe+2]=4*be+2,ve.uint16[xe+3]=4*be+2,ve.uint16[xe+4]=4*be+3,ve.uint16[xe+5]=4*be+0}return ve}(V));let ne=I.createIndexBuffer(_f,!0),he=I.createVertexBuffer(W,r.cX.members,!0);for(let me of z){let Se={u_matrix:me.transform,u_inv_matrix:me.invTransform,u_camera_to_center_distance:(_e=O).getCameraToCenterDistance(me.projection),u_viewport_size:[_e.width,_e.height]};K.draw(m,k.TRIANGLES,ci.disabled,Oi.disabled,m.colorModeForRenderPass(),Ti.disabled,Se,c.id,he,ne,r.b8.simpleSegment(0,2*me.circleOffset,me.circleArray.length,me.circleArray.length/2),null,O.zoom)}var _e;he.destroy(),ne.destroy()}let vh=r.ad.mat4.create();function Cg(m){let a=m._camera.getWorldToCamera(m.worldSize,1),c=r.ad.mat4.multiply([],a,m.globeMatrix);r.ad.mat4.invert(c,c);let f=[0,0,0],_=[0,1,0,0];return r.ad.vec4.transformMat4(_,_,c),f[0]=_[0],f[1]=_[1],f[2]=_[2],r.ad.vec3.normalize(f,f),f}function Sw({width:m,height:a,anchor:c,textOffset:f,textScale:_},b){let{horizontalAlign:w,verticalAlign:I}=r.bD(c),k=-(w-.5)*m,O=-(I-.5)*a,F=r.bC(c,f);return new r.P((k/_+F[0])*b,(O/_+F[1])*b)}function Vs(m,a,c,f,_,b,w,I,k,O,F){let z=m.text.placedSymbolArray,V=m.text.dynamicLayoutVertexArray,G=m.icon.dynamicLayoutVertexArray,K={},W=m.getProjection(),te=_s(I,W,b),ne=b.elevation,he=W.upVectorScale(I.canonical,b.center.lat,b.worldSize).metersToTile;V.clear();for(let _e=0;_e<z.length;_e++){let me=z.get(_e),{tileAnchorX:Se,tileAnchorY:ve,numGlyphs:be}=me,xe=me.hidden||!me.crossTileID||m.allowVerticalPlacement&&!me.placedOrientation?null:f[me.crossTileID];if(xe){let Ae=0,Oe=0,Ke=0;if(ne){let rt=ne?ne.getAtTileOffset(I,Se,ve):0,[ht,Qe,mt]=W.upVector(I.canonical,Se,ve);Ae=rt*ht*he,Oe=rt*Qe*he,Ke=rt*mt*he}let[$e,ct,ut,St]=pl(me.projectedAnchorX+Ae,me.projectedAnchorY+Oe,me.projectedAnchorZ+Ke,c?te:w),He=th(b.getCameraToCenterDistance(W),St),st=_.evaluateSizeForFeature(m.textSizeData,O,me)*He/r.bw;c&&(st*=m.tilePixelRatio/k);let je=Sw(xe,st);c?({x:$e,y:ct,z:ut}=W.projectTilePoint(Se+je.x,ve+je.y,I.canonical),[$e,ct,ut]=pl($e+Ae,ct+Oe,ut+Ke,w)):(a&&je._rotate(-b.angle),$e+=je.x,ct+=je.y,ut=0);let at=m.allowVerticalPlacement&&me.placedOrientation===r.bq.vertical?Math.PI/2:0;for(let rt=0;rt<be;rt++)r.bt(V,$e,ct,ut,at);F&&me.associatedIconIndex>=0&&(K[me.associatedIconIndex]={x:$e,y:ct,z:ut,angle:at})}else fl(be,V)}if(F){G.clear();let _e=m.icon.placedSymbolArray;for(let me=0;me<_e.length;me++){let Se=_e.get(me),{numGlyphs:ve}=Se,be=K[me];if(Se.hidden||!be)fl(ve,G);else{let{x:xe,y:Ae,z:Oe,angle:Ke}=be;for(let $e=0;$e<ve;$e++)r.bt(G,xe,Ae,Oe,Ke)}}m.icon.dynamicLayoutVertexBuffer.updateData(G)}m.text.dynamicLayoutVertexBuffer.updateData(V)}function ir(m,a,c,f,_,b,w={}){let I=c.paint.get("icon-translate"),k=c.paint.get("text-translate"),O=c.paint.get("icon-translate-anchor"),F=c.paint.get("text-translate-anchor"),z=c.layout.get("icon-rotation-alignment"),V=c.layout.get("text-rotation-alignment"),G=c.layout.get("icon-pitch-alignment"),K=c.layout.get("text-pitch-alignment"),W=c.layout.get("icon-keep-upright"),te=c.layout.get("text-keep-upright"),ne=c.paint.get("icon-color-saturation"),he=c.paint.get("icon-color-contrast"),_e=c.paint.get("icon-color-brightness-min"),me=c.paint.get("icon-color-brightness-max"),Se=c.layout.get("symbol-elevation-reference")==="sea",ve=m.context,be=ve.gl,xe=m.transform,Ae=z==="map",Oe=V==="map",Ke=G==="map",$e=K==="map",ct=c.layout.get("symbol-sort-key").constantOr(1)!==void 0,ut=!1,St=m.depthModeForSublayer(0,ci.ReadOnly),He=[r.av(xe.center.lng),r.aC(xe.center.lat)],st=c.layout.get("text-variable-anchor"),je=xe.projection.name==="globe",at=[],rt=[0,-1,0];for(let ht of f){let Qe=a.getTile(ht),mt=Qe.getBucket(c);if(!mt||mt.projection.name==="mercator"&&je||mt.fullyClipped)continue;let Nt=mt.projection.name==="globe",zt=Nt?r.ag(xe.zoom):0,Vt=_s(ht,mt.getProjection(),xe),ei=xe.calculatePixelsToTileUnitsMatrix(Qe),Ri=st&&mt.hasTextData(),gi=mt.hasIconTextFit()&&Ri&&mt.hasIconData(),Si=mt.getProjection().createInversionMatrix(xe,ht.canonical),vi=Nn=>{xe.depthOcclusionForSymbolsAndCircles&&(c.hasInitialOcclusionOpacityProperties||m.terrain)&&(Nn.push("DEPTH_D24"),Nn.push("DEPTH_OCCLUSION"))},on=()=>{let Nn=Ae&&c.layout.get("symbol-placement")!=="point",_n=[];vi(_n);let Ar=Nn||gi,Kr=c.paint.get("icon-image-cross-fade").constantOr(0);m.terrainRenderModeElevated()&&Ke&&_n.push("PITCH_WITH_MAP_TERRAIN"),Nt&&(_n.push("PROJECTION_GLOBE_VIEW"),Ar&&_n.push("PROJECTED_POS_ON_VIEWPORT")),Kr>0&&_n.push("ICON_TRANSITION"),mt.icon.zOffsetVertexBuffer&&_n.push("Z_OFFSET"),ne===0&&he===0&&_e===0&&me===1||_n.push("COLOR_ADJUSTMENT"),mt.sdfIcons&&_n.push("RENDER_SDF");let po=mt.icon.programConfigurations.get(c.id),Co=m.getOrCreateProgram("symbol",{config:po,defines:_n}),ws=Qe.imageAtlasTexture?Qe.imageAtlasTexture.size:[0,0],xa=mt.iconSizeData,hn=r.bp(xa,xe.zoom),vr=Ke||xe.pitch!==0,Mn=hc(Vt,Qe.tileID.canonical,Ke,Ae,xe,mt.getProjection(),ei),Qn=Lr(Vt,Qe.tileID.canonical,Ke,Ae,xe,mt.getProjection(),ei),$o=m.translatePosMatrix(Qn,Qe,I,O,!0),hr=m.translatePosMatrix(Vt,Qe,I,O),fo=Ar?vh:Mn,Nl=Ae&&!Ke&&!Nn,ts=rt;!je&&!xe.mercatorFromTransition||Ae||(ts=Cg(xe));let Hs=Nt?ts:rt,Ha=c.getColorAdjustmentMatrix(ne,he,_e,me),$s=vg(xa.kind,hn,Nl,Ke,m,hr,fo,$o,Se,!1,ws,[0,0],!0,ht,zt,He,Si,Hs,mt.getProjection(),Ha,Kr),is=Qe.imageAtlasTexture?Qe.imageAtlasTexture:null,Sc=c.layout.get("icon-size").constantOr(0)!==1||mt.iconsNeedLinear,zl=mt.sdfIcons||m.options.rotating||m.options.zooming||Sc||vr?be.LINEAR:be.NEAREST,Dc=mt.sdfIcons&&c.paint.get("icon-halo-width").constantOr(1)!==0,n0=m.terrain&&Ke&&Nn?r.ad.mat4.invert(r.ad.mat4.create(),Mn):vh;if(Nn&&mt.icon){let Ph=xe.elevation,jg=Ph?Ph.getAtTileOffsetFunc(ht,xe.center.lat,xe.worldSize,mt.getProjection()):null,r0=Qo(Vt,Qe.tileID.canonical,Ke,Ae,xe,mt.getProjection(),ei);ih(mt,Vt,m,!1,r0,Qn,Ke,W,jg,ht)}return{program:Co,buffers:mt.icon,uniformValues:$s,atlasTexture:is,atlasTextureIcon:null,atlasInterpolation:zl,atlasInterpolationIcon:null,isSDF:mt.sdfIcons,hasHalo:Dc,tile:Qe,labelPlaneMatrixInv:n0}},Dn=()=>{let Nn=Oe&&c.layout.get("symbol-placement")!=="point",_n=[],Ar=Nn||st||gi;m.terrainRenderModeElevated()&&$e&&_n.push("PITCH_WITH_MAP_TERRAIN"),Nt&&(_n.push("PROJECTION_GLOBE_VIEW"),Ar&&_n.push("PROJECTED_POS_ON_VIEWPORT")),mt.text.zOffsetVertexBuffer&&_n.push("Z_OFFSET"),mt.iconsInText&&_n.push("RENDER_TEXT_AND_SYMBOL"),_n.push("RENDER_SDF"),vi(_n);let Kr=mt.text.programConfigurations.get(c.id),po=m.getOrCreateProgram("symbol",{config:Kr,defines:_n}),Co,ws=[0,0],xa=null,hn=mt.textSizeData;mt.iconsInText&&(ws=Qe.imageAtlasTexture?Qe.imageAtlasTexture.size:[0,0],xa=Qe.imageAtlasTexture?Qe.imageAtlasTexture:null,Co=$e||xe.pitch!==0||m.options.rotating||m.options.zooming||hn.kind==="composite"||hn.kind==="camera"?be.LINEAR:be.NEAREST);let vr=Qe.glyphAtlasTexture?Qe.glyphAtlasTexture.size:[0,0],Mn=c.layout.get("text-size-scale-range"),Qn=r.ay(m.scaleFactor,Mn[0],Mn[1]),$o=r.bp(hn,xe.zoom,Qn),hr=hc(Vt,Qe.tileID.canonical,$e,Oe,xe,mt.getProjection(),ei),fo=Lr(Vt,Qe.tileID.canonical,$e,Oe,xe,mt.getProjection(),ei),Nl=m.translatePosMatrix(fo,Qe,k,F,!0),ts=m.translatePosMatrix(Vt,Qe,k,F),Hs=Ar?vh:hr,Ha=Oe&&!$e&&!Nn,$s=rt;!je&&!xe.mercatorFromTransition||Oe||($s=Cg(xe));let is=vg(hn.kind,$o,Ha,$e,m,ts,Hs,Nl,Se,!0,vr,ws,!0,ht,zt,He,Si,Nt?$s:rt,mt.getProjection(),null,null,Qn),Sc=Qe.glyphAtlasTexture?Qe.glyphAtlasTexture:null,zl=be.LINEAR,Dc=c.paint.get("text-halo-width").constantOr(1)!==0,n0=m.terrain&&$e&&Nn?r.ad.mat4.invert(r.ad.mat4.create(),hr):vh;if(Nn&&mt.text){let Ph=xe.elevation,jg=Ph?Ph.getAtTileOffsetFunc(ht,xe.center.lat,xe.worldSize,mt.getProjection()):null,r0=Qo(Vt,Qe.tileID.canonical,$e,Oe,xe,mt.getProjection(),ei);ih(mt,Vt,m,!0,r0,fo,$e,te,jg,ht)}return{program:po,buffers:mt.text,uniformValues:is,atlasTexture:Sc,atlasTextureIcon:xa,atlasInterpolation:zl,atlasInterpolationIcon:Co,isSDF:!0,hasHalo:Dc,tile:Qe,labelPlaneMatrixInv:n0}},ar=mt.icon.segments.get().length,Zi=mt.text.segments.get().length,yr=ar&&!w.onlyText?on():null,Fi=Zi&&!w.onlyIcons?Dn():null,ti=c.paint.get("icon-opacity").constantOr(1),ln=c.paint.get("text-opacity").constantOr(1);if(ct&&mt.canOverlap){ut=!0;let Nn=ti&&!w.onlyText?mt.icon.segments.get():[],_n=ln&&!w.onlyIcons?mt.text.segments.get():[];for(let Ar of Nn)at.push({segments:new r.b8([Ar]),sortKey:Ar.sortKey,state:yr});for(let Ar of _n)at.push({segments:new r.b8([Ar]),sortKey:Ar.sortKey,state:Fi})}else w.onlyText||at.push({segments:ti?mt.icon.segments:new r.b8([]),sortKey:0,state:yr}),w.onlyIcons||at.push({segments:ln?mt.text.segments:new r.b8([]),sortKey:0,state:Fi})}ut&&at.sort((ht,Qe)=>ht.sortKey-Qe.sortKey);for(let ht of at){let Qe=ht.state;if(Qe)if(m.terrain?m.terrain.setupElevationDraw(Qe.tile,Qe.program,{useDepthForOcclusion:xe.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Qe.labelPlaneMatrixInv}):m.setupDepthForOcclusion(xe.depthOcclusionForSymbolsAndCircles,Qe.program),ve.activeTexture.set(be.TEXTURE0),Qe.atlasTexture&&Qe.atlasTexture.bind(Qe.atlasInterpolation,be.CLAMP_TO_EDGE,!0),Qe.atlasTextureIcon&&(ve.activeTexture.set(be.TEXTURE1),Qe.atlasTextureIcon&&Qe.atlasTextureIcon.bind(Qe.atlasInterpolationIcon,be.CLAMP_TO_EDGE,!0)),m.uploadCommonLightUniforms(m.context,Qe.program),Qe.hasHalo){let mt=Qe.uniformValues;mt.u_is_halo=1,bh(Qe.buffers,ht.segments,c,m,Qe.program,St,_,b,mt,2),mt.u_is_halo=0}else{if(Qe.isSDF){let mt=Qe.uniformValues;Qe.hasHalo&&(mt.u_is_halo=1,bh(Qe.buffers,ht.segments,c,m,Qe.program,St,_,b,mt,1)),mt.u_is_halo=0}bh(Qe.buffers,ht.segments,c,m,Qe.program,St,_,b,Qe.uniformValues,1)}}}function bh(m,a,c,f,_,b,w,I,k,O){let F=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.iconTransitioningVertexBuffer,m.globeExtVertexBuffer,m.zOffsetVertexBuffer];_.draw(f,f.context.gl.TRIANGLES,b,w,I,Ti.disabled,k,c.id,m.layoutVertexBuffer,m.indexBuffer,a,c.paint,f.transform.zoom,m.programConfigurations.get(c.id),F,O)}function kv(m,a){let c=1<<m.canonical.z,f=(a.x*c-m.canonical.x-m.wrap*c)*r.ai,_=(a.y*c-m.canonical.y)*r.ai,b=r.d5(a.z,a.y);return r.ad.vec3.fromValues(f,_,b)}function Pv(m,a,c,f,_){if(!c.layout||c.layout.get("fill-elevation-reference")==="none")return;let b=m.context.gl,w=new ci(m.context.gl.LEQUAL,ci.ReadWrite,m.depthRangeFor3D),I=new ci(m.context.gl.GREATER,ci.ReadWrite,m.depthRangeFor3D),k=function(G){let K=r.c4(G.pitch),W=.01;return G.isOrthographic&&(W=r.ah(1e-4,W,r.c9(K>=kt?1:K/kt))),2*W}(m.transform),O=m.transform.getFreeCameraOptions().position,F="elevatedStructuresDepthReconstruct",z=m.getOrCreateProgram(F,{defines:["DEPTH_RECONSTRUCTION"]}),V=m.getOrCreateProgram(F);for(let G of f){let K=a.getTile(G),W=K.getBucket(c);if(!W)continue;let te=W.elevatedStructures;if(!te)continue;let ne=W.elevationBufferData.heightRange,he=kv(G.toUnwrapped(),O),_e=m.translatePosMatrix(G.projMatrix,K,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor")),me,Se,ve,be;if(_==="initialize"){if(!ne||ne.min>=1||te.depthSegments.segments[0].primitiveLength===0)continue;me=gf(_e,he,k,1,0),Se=w,ve=te.depthSegments,be=z}else if(_==="reset"){if(!ne||ne.min>=0||te.maskSegments.segments[0].primitiveLength===0)continue;me=gf(_e,he,0,0,1),Se=I,ve=te.maskSegments,be=z}else if(_==="geometry"){if(te.depthSegments.segments[0].primitiveLength===0)continue;me=gf(_e,he,k,1,0),Se=w,ve=te.depthSegments,be=V}be.draw(m,b.TRIANGLES,Se,Oi.disabled,Ji.disabled,Ti.disabled,me,c.id,te.vertexBuffer,te.indexBuffer,ve,c.paint,m.transform.zoom)}}function Eg(m,a,c){let{painter:f,sourceCache:_,layer:b,coords:w,colorMode:I,elevationType:k,terrainEnabled:O,pass:F}=m,z=f.context.gl,V=b.paint.get("fill-pattern"),G=k;k!=="road"||a&&!O||(G="none");let K=G==="road",W=new ci(f.context.gl.LEQUAL,ci.ReadWrite,f.depthRangeFor3D),te=V&&V.constantOr(1),ne=(he,_e)=>{let me,Se,ve,be,xe;_e?(Se=te&&!b.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",me=z.LINES):(Se=te?"fillPattern":"fill",me=z.TRIANGLES);for(let Ae of w){let Oe=_.getTile(Ae);if(te&&!Oe.patternsLoaded())continue;let Ke=Oe.getBucket(b);if(!Ke)continue;let $e=a?Ke.elevationBufferData:Ke.bufferData;if($e.isEmpty())continue;f.prepareDrawTile();let ct=$e.programConfigurations.get(b.id),ut=f.isTileAffectedByFog(Ae),St=[],He=[];K&&(St.push("ELEVATED_ROADS"),He.push($e.elevatedLayoutVertexBuffer));let st=f.getOrCreateProgram(Se,{config:ct,overrideFog:ut,defines:St});te&&(f.context.activeTexture.set(z.TEXTURE0),Oe.imageAtlasTexture&&Oe.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),ct.updatePaintBuffers());let je=V.constantOr(null);if(je&&Oe.imageAtlas){let ht=Oe.imageAtlas,Qe=r.d0.from(je).getPrimary().scaleSelf(r.q.devicePixelRatio).toString(),mt=ht.patternPositions.get(Qe);mt&&ct.setConstantPatternPositions(mt)}let at=f.translatePosMatrix(Ae.projMatrix,Oe,b.paint.get("fill-translate"),b.paint.get("fill-translate-anchor")),rt=b.paint.get("fill-emissive-strength");if(_e){be=$e.lineIndexBuffer,xe=$e.lineSegments;let ht=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[z.drawingBufferWidth,z.drawingBufferHeight];ve=Se==="fillOutlinePattern"&&te?_g(at,rt,f,Oe,ht):gg(at,rt,ht)}else be=$e.indexBuffer,xe=$e.triangleSegments,ve=te?Cv(at,rt,f,Oe):_h(at,rt);f.uploadCommonUniforms(f.context,st,Ae.toUnwrapped()),st.draw(f,me,G!=="none"?W:he,c||f.stencilModeForClipping(Ae),I,Ti.disabled,ve,b.id,$e.layoutVertexBuffer,be,xe,b.paint,f.transform.zoom,ct,He)}};f.renderPass===F&&ne(f.depthModeForSublayer(1,f.renderPass==="opaque"?ci.ReadWrite:ci.ReadOnly),!1),G==="none"&&f.renderPass==="translucent"&&b.paint.get("fill-antialias")&&ne(f.depthModeForSublayer(b.getPaintProperty("fill-outline-color")?2:0,ci.ReadOnly),!0)}function yf(m,a,c,f,_,b,w,I){c.resetLayerRenderingStats(m);let k=m.context,O=k.gl,F=m.transform,z=c.paint.get("fill-extrusion-pattern"),V=z.constantOr(1),G=c.paint.get("fill-extrusion-opacity"),K=m.style.enable3dLights(),W=c.paint.get(K&&!V?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),te=[c.paint.get("fill-extrusion-ambient-occlusion-intensity"),W],ne=c.layout.get("fill-extrusion-edge-radius"),he=ne>0&&!c.paint.get("fill-extrusion-rounded-roof"),_e=he?0:ne,me=F.projection.name==="globe"?r.d6():0,Se=F.projection.name==="globe",ve=Se?r.ag(F.zoom):0,be=[r.av(F.center.lng),r.aC(F.center.lat)],xe=c.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Ae=c.paint.get("fill-extrusion-flood-light-color").toRenderColor(xe?null:c.lut).toArray01().slice(0,3),Oe=c.paint.get("fill-extrusion-flood-light-intensity"),Ke=c.paint.get("fill-extrusion-vertical-scale"),$e=c.paint.get("fill-extrusion-line-width").constantOr(1)!==0,ct=c.paint.get("fill-extrusion-height-alignment"),ut=c.paint.get("fill-extrusion-base-alignment"),St=_c(m,c.paint.get("fill-extrusion-cutoff-fade-range")),He=[],st;Se&&He.push("PROJECTION_GLOBE_VIEW"),te[0]>0&&He.push("FAUX_AO"),he&&He.push("ZERO_ROOF_RADIUS"),I&&He.push("HAS_CENTROID"),Oe>0&&He.push("FLOOD_LIGHT"),St.shouldRenderCutoff&&He.push("RENDER_CUTOFF"),$e&&He.push("RENDER_WALL_MODE");let je=m.renderPass==="shadow",at=m.shadowRenderer,rt=je&&!!at;m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!0);let ht=[0,0,0];if(at){let Nt=m.style.directionalLight,zt=m.style.ambientLight;Nt&&zt&&(ht=lh(m.style,Nt,zt)),je||(He.push("RENDER_SHADOWS","DEPTH_TEXTURE"),at.useNormalOffset&&He.push("NORMAL_OFFSET")),st=He.concat(["SHADOWS_SINGLE_CASCADE"])}let Qe=rt?"fillExtrusionDepth":V?"fillExtrusionPattern":"fillExtrusion",mt=c.getLayerRenderingStats();for(let Nt of f){let zt=a.getTile(Nt),Vt=zt.getBucket(c);if(!Vt||Vt.projection.name!==F.projection.name)continue;let ei=!1;at&&(ei=at.getMaxCascadeForTile(Nt.toUnwrapped())===0);let Ri=m.isTileAffectedByFog(Nt),gi=Vt.programConfigurations.get(c.id),Si=m.getOrCreateProgram(Qe,{config:gi,defines:ei?st:He,overrideFog:Ri});if(m.terrain&&m.terrain.setupElevationDraw(zt,Si,{useMeterToDem:!0}),!Vt.centroidVertexBuffer){let Fi=Si.attributes.a_centroid_pos;Fi!==void 0&&O.vertexAttrib2f(Fi,0,0)}!je&&at&&at.setupShadows(zt.tileID.toUnwrapped(),Si,"vector-tile",zt.tileID.overscaledZ),V&&(m.context.activeTexture.set(O.TEXTURE0),zt.imageAtlasTexture&&zt.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),gi.updatePaintBuffers());let vi=z.constantOr(null);if(vi&&zt.imageAtlas){let Fi=zt.imageAtlas,ti=r.d0.from(vi).getPrimary().scaleSelf(r.q.devicePixelRatio),ln=Fi.patternPositions.get(ti.toString());ln&&gi.setConstantPatternPositions(ln)}let on=c.paint.get("fill-extrusion-vertical-gradient"),Dn=1/Vt.tileToMeter,ar;if(je&&at){if(Eh(zt.tileID,Vt,m))continue;let Fi=at.calculateShadowPassMatrixFromTile(zt.tileID.toUnwrapped());ar=gh(Fi,_e,Dn,Ke,ct,ut)}else{let Fi=m.translatePosMatrix(Nt.expandedProjMatrix,zt,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),ti=F.projection.createInversionMatrix(F,Nt.canonical);ar=V?wv(Fi,m,on,G,te,_e,Dn,Nt,zt,me,ct,ut,ve,be,ti,Ae,Ke):mg(Fi,m,on,G,te,_e,Dn,Nt,me,ct,ut,ve,be,ti,Ae,Ke,Oe,ht)}m.uploadCommonUniforms(k,Si,Nt.toUnwrapped(),null,St);let Zi=Vt.segments;if(F.projection.name==="mercator"&&!je&&(Zi=Vt.getVisibleSegments(zt.tileID,m.terrain,m.transform.getFrustum(0)),!Zi.get().length))continue;if(mt)if(je)for(let Fi of Zi.get())mt.numRenderedVerticesInShadowPass+=Fi.primitiveLength;else for(let Fi of Zi.get())mt.numRenderedVerticesInTransparentPass+=Fi.primitiveLength;let yr=[];(m.terrain||I)&&yr.push(Vt.centroidVertexBuffer),Se&&yr.push(Vt.layoutVertexExtBuffer),$e&&yr.push(Vt.wallVertexBuffer),Si.draw(m,k.gl.TRIANGLES,_,b,w,Ti.backCCW,ar,c.id,Vt.layoutVertexBuffer,Vt.indexBuffer,Zi,c.paint,m.transform.zoom,gi,yr)}m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!1)}function xh(m,a,c,f,_,b,w,I,k,O,F,z,V,G,K,W,te,ne,he){let _e=m.context,me=_e.gl,Se=m.transform,ve=m.transform.zoom,be=[],xe=_c(m,c.paint.get("fill-extrusion-cutoff-fade-range"));O==="clear"?(be.push("CLEAR_SUBPASS"),he&&(be.push("CLEAR_FROM_TEXTURE"),_e.activeTexture.set(me.TEXTURE0),he.bind(me.LINEAR,me.CLAMP_TO_EDGE))):O==="sdf"&&be.push("SDF_SUBPASS"),te&&be.push("HAS_CENTROID"),xe.shouldRenderCutoff&&be.push("RENDER_CUTOFF");let Ae=c.layout.get("fill-extrusion-edge-radius"),Oe=(Ke,$e,ct,ut,St)=>{let He=$e.programConfigurations.get(c.id),st=m.isTileAffectedByFog(Ke),je=m.getOrCreateProgram("fillExtrusionGroundEffect",{config:He,defines:be,overrideFog:st}),at=((ht,Qe,mt,Nt,zt,Vt,ei,Ri,gi,Si,vi)=>({u_matrix:Qe,u_opacity:mt,u_ao_pass:Nt?1:0,u_meter_to_tile:zt,u_ao:Vt,u_flood_light_intensity:ei,u_flood_light_color:Ri,u_attenuation:gi,u_edge_radius:Si,u_fb:0,u_fb_size:vi,u_dynamic_offset:1}))(0,ut,F,k,St,[z,V*St],G,K,W,ve>=17?0:Ae*St,he?he.size[0]:0),rt=[];te&&rt.push($e.hiddenByLandmarkVertexBuffer),m.uploadCommonUniforms(_e,je,Ke.toUnwrapped(),null,xe),je.draw(m,_e.gl.TRIANGLES,_,b,w,I,at,c.id,$e.vertexBuffer,$e.indexBuffer,ct,c.paint,ve,He,rt)};for(let Ke of f){let $e=a.getTile(Ke),ct=$e.getBucket(c);if(!ct||ct.projection.name!==Se.projection.name||!ct.groundEffect||ct.groundEffect&&!ct.groundEffect.hasData())continue;let ut=ct.groundEffect,St=1/ct.tileToMeter;{let He=m.translatePosMatrix(Ke.projMatrix,$e,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),st=ut.getDefaultSegment();Oe(Ke,ut,st,He,St)}if(ne)for(let He=0;He<4;He++){let st=r.d7[He](Ke),je=a.getTile(st);if(!je)continue;let at=je.getBucket(c);if(!at||at.projection.name!==Se.projection.name||!at.groundEffect||at.groundEffect&&!at.groundEffect.hasData())continue;let rt=at.groundEffect,ht,Qe;He===0?(ht=[-r.ai,0,0],Qe=1):He===1?(ht=[r.ai,0,0],Qe=0):He===2?(ht=[0,-r.ai,0],Qe=3):(ht=[0,r.ai,0],Qe=2);let mt=rt.regionSegments[Qe];if(!mt)continue;let Nt=new Float32Array(16);r.ad.mat4.translate(Nt,Ke.projMatrix,ht),Oe(Ke,rt,mt,m.translatePosMatrix(Nt,$e,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),St)}}}function wh(m,a,c,f,_,b,w){f.centroidVertexArray.length===0&&f.createCentroidsBuffer();let I=b?b.findDEMTileFor(c):null;if(!(I&&I.dem||w))return;b&&I&&I.dem&&f.selfDEMTileTimestamp!==I.dem._timestamp&&(f.borderDoneWithNeighborZ=[-1,-1,-1,-1],f.selfDEMTileTimestamp=I.dem._timestamp);let k=ne=>new r.P(Math.ceil((ne+r.da)*r.db),0),O=ne=>{let he=a.getSource().minzoom,_e=Se=>{let ve=a.getTileByID(Se);if(ve&&ve.hasData())return ve.getBucket(_)},me=[0,-1,1];for(let Se of me){if(ne.overscaledZ+Se<he)continue;let ve=_e(ne.calculateScaledKey(ne.overscaledZ+Se));if(ve)return ve}},F=[0,0,0],z=(ne,he)=>(F[0]=Math.min(ne.min.y,he.min.y),F[1]=Math.max(ne.max.y,he.max.y),F[2]=r.ai-he.min.x>ne.max.x?he.min.x-r.ai:ne.max.x,F),V=(ne,he)=>(F[0]=Math.min(ne.min.x,he.min.x),F[1]=Math.max(ne.max.x,he.max.x),F[2]=r.ai-he.min.y>ne.max.y?he.min.y-r.ai:ne.max.y,F),G=[(ne,he)=>z(ne,he),(ne,he)=>z(he,ne),(ne,he)=>V(ne,he),(ne,he)=>V(he,ne)],K=(ne,he,_e,me,Se,ve,be)=>{if(!b)return 0;let xe=[[ve?_e:ne,ve?ne:_e,0],[ve?_e:he,ve?he:_e,0]],Ae=be<0?r.ai+be:be,Oe=[ve?Ae:(ne+he)/2,ve?(ne+he)/2:Ae,0];return _e===0&&be<0||_e!==0&&be>0?b.getForTilePoints(Se,[Oe],!0,me):xe.push(Oe),b.getForTilePoints(c,xe,!0,I),Math.max(xe[0][2],xe[1][2],Oe[2])/b.exaggeration()};for(let ne=0;ne<4;ne++){let he=f.borderFeatureIndices[ne];if(he.length===0)continue;let _e=r.d7[ne](c),me=O(_e);if(!(me&&me instanceof r.d8))continue;let Se=b?b.findDEMTileFor(_e):null;if(!(Se&&Se.dem||w)||(b&&Se&&Se.dem&&f.borderDEMTileTimestamp[ne]!==Se.dem._timestamp&&(f.borderDoneWithNeighborZ[ne]=-1,f.borderDEMTileTimestamp[ne]=Se.dem._timestamp),f.borderDoneWithNeighborZ[ne]===me.canonical.z))continue;me.centroidVertexArray.length===0&&me.createCentroidsBuffer();let ve=(ne<2?1:5)-ne,be=me.borderDoneWithNeighborZ[ve]!==f.canonical.z,xe=me.borderFeatureIndices[ve],Ae=0;if(f.canonical.z!==me.canonical.z){for(let Oe of he)f.showCentroid(f.featuresOnBorder[Oe]);if(be)for(let Oe of xe)me.showCentroid(me.featuresOnBorder[Oe]);f.borderDoneWithNeighborZ[ne]=me.canonical.z,me.borderDoneWithNeighborZ[ve]=f.canonical.z}for(let Oe of he){let Ke=f.featuresOnBorder[Oe],$e=f.centroidData[Ke.centroidDataIndex],ct=Ke.borders[ne],ut;for(;Ae<xe.length;){ut=me.featuresOnBorder[xe[Ae]];let St=ut.borders[ve];if(St[1]>ct[0]+3||St[0]>ct[0]-3)break;me.showCentroid(ut),Ae++}if(ut&&Ae<xe.length){let St=Ae,He=0;for(;!(ut.borders[ve][0]>ct[1]-3)&&(He++,++Ae!==xe.length);)ut=me.featuresOnBorder[xe[Ae]];ut=me.featuresOnBorder[xe[St]];let st=!1;if(He>=1){let rt=ut.borders[ve];Math.abs(ct[0]-rt[0])<3&&Math.abs(ct[1]-rt[1])<3&&(He=1,st=!0,Ae=St+1)}else if(He===0){f.showCentroid(Ke);continue}let je=me.centroidData[ut.centroidDataIndex];w&&st&&(((W=$e).flags|(te=je).flags)&r.d9?(W.flags|=r.d9,te.flags|=r.d9):(W.flags&=~r.d9,te.flags&=~r.d9));let at=Ke.intersectsCount()>1||ut.intersectsCount()>1;if(He>1)Ae=St,$e.centroidXY=je.centroidXY=new r.P(0,0);else if(Se&&Se.dem&&!at){let rt=G[ne]($e,je),ht=ne%2?r.ai-1:0,Qe=K(rt[0],Math.min(r.ai-1,rt[1]),ht,Se,_e,ne<2,rt[2]);$e.centroidXY=je.centroidXY=k(Qe)}else at?$e.centroidXY=je.centroidXY=new r.P(0,0):($e.centroidXY=f.encodeBorderCentroid(Ke),je.centroidXY=me.encodeBorderCentroid(ut));f.writeCentroidToBuffer($e),me.writeCentroidToBuffer(je)}else f.showCentroid(Ke)}f.borderDoneWithNeighborZ[ne]=me.canonical.z,me.borderDoneWithNeighborZ[ve]=f.canonical.z}var W,te;(f.needsCentroidUpdate||!f.centroidVertexBuffer&&f.centroidVertexArray.length!==0)&&f.uploadCentroid(m)}let Ch=[1,0,0],It=[0,1,0],Ht=[0,0,1];function Eh(m,a,c){let f=c.transform,_=c.shadowRenderer;if(!_)return!0;let b=m.toUnwrapped(),w=f.tileSize*_._cascades[c.currentShadowCascade].scale,I=a.maxHeight;if(f.elevation){let W=f.elevation.getMinMaxForTile(m);W&&(I+=W.max)}let k=[..._.shadowDirection];k[2]=-k[2];let O=_.computeSimplifiedTileShadowVolume(b,I,w,k);if(!O)return!1;let F=[Ch,It,Ht,k,[k[0],0,k[2]],[0,k[1],k[2]]],z=f.projection.name==="globe",V=f.scaleZoom(w),G=r.bR.fromInvProjectionMatrix(f.invProjMatrix,f.worldSize,V,!z),K=_.getCurrentCascadeFrustum();return G.intersectsPrecise(O.vertices,O.planes,F)===0||K.intersectsPrecise(O.vertices,O.planes,F)===0}function Sr(m){return[m[0]*r.dc,m[1]*r.dc,m[2]*r.dc,0]}function We(m,a,c,f,_,b,w,I,k){let O=f.getSource(),F=c.globeSharedBuffers;if(!F)return;let z,V,G;if(a&&(z=f.getTile(a)),O instanceof r.aK?(V=O.texture,G=r.cJ(0,0,c.transform)):z&&a&&(V=z.texture,G=r.cJ(a.canonical.z,a.canonical.x,c.transform)),!V||!G)return;m||(G=r.ad.mat4.scale(r.ad.mat4.create(),G,[1,-1,1]));let K=c.context,W=K.gl,te=_.paint.get("raster-resampling")==="nearest"?W.NEAREST:W.LINEAR,ne=c.colorModeForDrapableLayerRenderPass(b),he=w.defines;he.push("GLOBE_POLES");let _e=new ci(W.LEQUAL,ci.ReadWrite,c.depthRangeFor3D),me=Float32Array.from(c.transform.expandedFarZProjMatrix),Se=Float32Array.from(r.bc(r.cI(new r.bT(0,0,0))));c.terrain&&c.terrain.prepareDrawTile(),K.activeTexture.set(W.TEXTURE0),V.bind(te,W.CLAMP_TO_EDGE),K.activeTexture.set(W.TEXTURE1),V.bind(te,W.CLAMP_TO_EDGE),"useMipmap"in V&&K.extTextureFilterAnisotropic&&c.transform.pitch>20&&W.texParameterf(W.TEXTURE_2D,K.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,K.extTextureFilterAnisotropicMax);let[ve,be,xe,Ae]=a?F.getPoleBuffers(a.canonical.z,!1):F.getPoleBuffers(0,!0),Oe=_.paint.get("raster-elevation"),Ke;m?(Ke=ve,c.renderDefaultNorthPole=Oe!==0):(Ke=be,c.renderDefaultSouthPole=Oe!==0);let $e=Sr(w.mix),ct=((St,He,st,je,at,rt,ht,Qe,mt,Nt,zt,Vt,ei)=>Sv(St,He,st,new Float32Array(16),new Float32Array(9),[0,0],je,[0,0],[0,0,0,0],1,{opacity:1,mix:0},rt,[0,0],Qe,2,Nt,zt,Vt,1,0,ei))(me,Se,G,r.ag(c.transform.zoom),0,_,0,Oe,0,$e,w.offset,w.range,b),ut=c.getOrCreateProgram("raster",{defines:he});c.uploadCommonUniforms(K,ut,null),ut.draw(c,W.TRIANGLES,_e,k,ne,I,ct,_.id,Ke,xe,Ae)}function Dw(m){let a=m._nearZ,c=m.projection.farthestPixelDistance(m),f=c-a,_=.2*m.height,b=a+_;return[a,c,(b-_-a)/f,(b-a)/f]}function Sg(m,a,c,f){if(m)return a instanceof dc&&m instanceof ja?a.getTextureDescriptor(m,c,!0):{texture:m.texture,mix:Sr(f.mix),offset:f.offset,buffer:0,tileSize:1}}var Ov=r.dd([{name:"a_index",type:"Int16",components:1}]);class Fv{constructor(a,c,f,_){let b={width:f[0],height:f[1],data:null},w=a.gl;this.targetColorTexture=new r.T(a,b,w.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new r.T(a,b,w.RGBA8,{useMipmap:!1}),this.context=a,this.updateParticleTexture(c,_),this.lastInvalidatedAt=0}updateParticleTexture(a,c){if(this.particleTextureDimension===c.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());let f=this.context.gl,_=c.width*c.height;this.particleTexture0=new r.T(this.context,c,f.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new r.T(this.context,c,f.RGBA8,{premultiply:!1,useMipmap:!1});let b=new r.de;b.reserve(_);for(let w=0;w<_;w++)b.emplaceBack(w);this.particleIndexBuffer=this.context.createVertexBuffer(b,Ov.members,!0),this.particleSegment=r.b8.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=c.width}update(a){return!(this.lastInvalidatedAt<a&&(this.lastInvalidatedAt=r.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Mw(m,a,c){if(!m)return null;let f=a.getTextureDescriptor(m,c,!0);if(!f)return null;let{texture:_,mix:b,offset:w,tileSize:I,buffer:k,format:O}=f;if(!_||!O)return null;let F=!1;return O==="uint32"&&(F=!0,b[3]=0,b=$t(r.df,b,[0,c.paint.get("raster-particle-max-speed")]),w=Ev(r.df,w,[0,c.paint.get("raster-particle-max-speed")])),{texture:_,textureOffset:[k/(I+2*k),I/(I+2*k)],tileSize:I,scalarData:F,scale:b,offset:w,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[O]]}}function Tw(m){let a=m._nearZ,c=m.projection.farthestPixelDistance(m),f=c-a,_=.2*m.height,b=a+_;return[a,c,(b-_-a)/f,(b-a)/f]}let Sh=new r.al(1,0,0,1),HM=new r.al(0,1,0,1),$M=new r.al(0,0,1,1),Iw=new r.al(1,0,1,1),Dg=new r.al(0,1,1,1);function hd(m,a,c,f,_,b,w){let I=m.context,k=m.transform,O=I.gl,F=k.projection.name==="globe",z=F?["PROJECTION_GLOBE_VIEW"]:[],V=r.ad.mat4.clone(c.projMatrix);if(F&&r.ag(k.zoom)>0){let $e=r.bb(c.canonical,k),ct=r.dg($e);V=r.ad.mat4.multiply(new Float32Array(16),k.globeMatrix,ct),r.ad.mat4.multiply(V,k.projMatrix,V)}let G=r.ad.mat4.create();G[12]+=2*_/(r.q.devicePixelRatio*k.width),G[13]+=2*b/(r.q.devicePixelRatio*k.height),r.ad.mat4.multiply(V,G,V);let K=m.getOrCreateProgram("debug",{defines:z}),W=a.getTileByID(c.key);m.terrain&&m.terrain.setupElevationDraw(W,K);let te=ci.disabled,ne=Oi.disabled,he=m.colorModeForRenderPass(),_e="$debug";I.activeTexture.set(O.TEXTURE0),m.emptyTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),F?W._makeGlobeTileDebugBuffers(m.context,k):W._makeDebugTileBoundsBuffers(m.context,k.projection);let me=W._tileDebugBuffer||m.debugBuffer,Se=W._tileDebugIndexBuffer||m.debugIndexBuffer,ve=W._tileDebugSegments||m.debugSegments;if(K.draw(m,O.LINE_STRIP,te,ne,he,Ti.disabled,xw(V,f),_e,me,Se,ve,null,null,null,[W._globeTileDebugBorderBuffer]),w){let $e=W.latestRawTileData,ct=Math.floor(($e&&$e.byteLength||0)/1024),ut=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(ut+=` => ${c.overscaledZ}`),ut+=` ${W.state}`,ut+=` ${ct}kb`,function(St,He){St.initDebugOverlayCanvas();let st=St.debugOverlayCanvas,je=St.context.gl,at=St.debugOverlayCanvas.getContext("2d");at.clearRect(0,0,st.width,st.height),at.shadowColor="white",at.shadowBlur=2,at.lineWidth=1.5,at.strokeStyle="white",at.textBaseline="top",at.font="bold 36px Open Sans, sans-serif",at.fillText(He,5,5),at.strokeText(He,5,5),St.debugOverlayTexture.update(st),St.debugOverlayTexture.bind(je.LINEAR,je.CLAMP_TO_EDGE)}(m,ut)}let be=a.getTile(c).tileSize,xe=512/Math.min(be,512)*(c.overscaledZ/k.zoom)*.5,Ae=W._tileDebugTextBuffer||m.debugBuffer,Oe=W._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,Ke=W._tileDebugTextSegments||m.debugSegments;K.draw(m,O.TRIANGLES,te,ne,Ji.alphaBlended,Ti.disabled,xw(V,r.al.transparent,xe),_e,Ae,Oe,Ke,null,null,null,[W._globeTileDebugTextBuffer])}function Lv(m,a,c,f){au(m,0,a+c/2,m.transform.width,c,f)}function Nv(m,a,c,f){au(m,a-c/2,0,c,m.transform.height,f)}function au(m,a,c,f,_,b){let w=m.context,I=w.gl;I.enable(I.SCISSOR_TEST),I.scissor(a*r.q.devicePixelRatio,c*r.q.devicePixelRatio,f*r.q.devicePixelRatio,_*r.q.devicePixelRatio),w.clear({color:b}),I.disable(I.SCISSOR_TEST)}let Mg=r.dd([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Dh}=Mg;function xc(m,a,c,f){m.emplaceBack(a,c,f)}class Aw{constructor(a){this.vertexArray=new r.dh,this.indices=new r.aV,xc(this.vertexArray,-1,-1,1),xc(this.vertexArray,1,-1,1),xc(this.vertexArray,-1,1,1),xc(this.vertexArray,1,1,1),xc(this.vertexArray,-1,-1,-1),xc(this.vertexArray,1,-1,-1),xc(this.vertexArray,-1,1,-1),xc(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=a.createVertexBuffer(this.vertexArray,Dh),this.indexBuffer=a.createIndexBuffer(this.indices),this.segment=r.b8.simpleSegment(0,0,36,12)}}function Po(m,a,c,f,_,b){let w=m.context.gl,I=a.paint.get("sky-atmosphere-color"),k=a.paint.get("sky-atmosphere-halo-color"),O=a.paint.get("sky-atmosphere-sun-intensity"),F=((z,V,G,K,W)=>({u_matrix_3f:z,u_sun_direction:V,u_sun_intensity:G,u_color_tint_r:[K.r,K.g,K.b,K.a],u_color_tint_m:[W.r,W.g,W.b,W.a],u_luminance:5e-5}))(r.ad.mat3.fromMat4(r.ad.mat3.create(),f),_,O,I,k);w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.TEXTURE_CUBE_MAP_POSITIVE_X+b,a.skyboxTexture,0),c.draw(m,w.TRIANGLES,ci.disabled,Oi.disabled,Ji.unblended,Ti.frontCW,F,"skyboxCapture",a.skyboxGeometry.vertexBuffer,a.skyboxGeometry.indexBuffer,a.skyboxGeometry.segment)}let GM=r.dd([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class vf{constructor(a){let c=new r.di;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);let f=new r.aV;f.emplaceBack(0,1,2),f.emplaceBack(2,3,0),this.vertexBuffer=a.createVertexBuffer(c,GM.members),this.indexBuffer=a.createIndexBuffer(f),this.segments=r.b8.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}let cr=r.dd([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class En{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Rw{constructor(a){this.colorModeAlphaBlendedWriteRGB=new Ji([1,sd,1,sd],r.al.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Ji([1,0,1,0],r.al.transparent,[!1,!1,!1,!0]),this.params=new En,this.updateNeeded=!0,a.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),a.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),a.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),a.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(a){let c=a.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new vf(c);let f=this.params.sizeRange,_=this.params.intensityRange,b=function(F){let z=r.dl(30),V=[];for(let G=0;G<F;++G){let K=2*Math.PI*z(),W=Math.acos(1-2*z())-.5*Math.PI;V.push(r.ad.vec3.fromValues(Math.cos(W)*Math.cos(K),Math.cos(W)*Math.sin(K),Math.sin(W)))}return V}(this.params.starsCount),w=r.dl(300),I=new r.dj,k=new r.aV,O=0;for(let F=0;F<b.length;++F){let z=r.ad.vec3.scale([],b[F],200),V=Math.max(0,1+.01*f*(1*w()-.5)),G=Math.max(0,1+.01*_*(1*w()-.5));I.emplaceBack(z[0],z[1],z[2],-1,-1,V,G),I.emplaceBack(z[0],z[1],z[2],1,-1,V,G),I.emplaceBack(z[0],z[1],z[2],1,1,V,G),I.emplaceBack(z[0],z[1],z[2],-1,1,V,G),k.emplaceBack(O+0,O+1,O+2),k.emplaceBack(O+0,O+2,O+3),O+=4}this.starsVx=c.createVertexBuffer(I,cr.members),this.starsIdx=c.createIndexBuffer(k),this.starsSegments=r.b8.simpleSegment(0,0,I.length,k.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(a,c){let f=a.context,_=f.gl,b=a.transform,w=new ci(_.LEQUAL,ci.ReadOnly,[0,1]),I=r.ag(b.zoom),k=a.style.getLut(c.scope),O=c.properties.get("color-use-theme")==="none",F=c.properties.get("color").toRenderColor(O?null:k).toArray01(),z=c.properties.get("high-color-use-theme")==="none",V=c.properties.get("high-color").toRenderColor(z?null:k).toArray01(),G=c.properties.get("space-color-use-theme")==="none",K=c.properties.get("space-color").toRenderColor(G?null:k).toArray01PremultipliedAlpha(),W=5e-4,te=r.dk(c.properties.get("horizon-blend"),0,1,W,.25),ne=r.cD(a,f,b)&&te===W?b.worldSize/(2*Math.PI*1.025)-1:b.globeRadius,he=a.frameCounter/1e3%1,_e=r.ad.vec3.length(b.globeCenterInViewSpace),me=Math.sqrt(Math.pow(_e,2)-Math.pow(ne,2)),Se=Math.acos(me/_e),ve=be=>{let xe=b.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];be&&xe.push("ALPHA_PASS");let Ae=a.getOrCreateProgram("globeAtmosphere",{defines:xe}),Oe=(($e,ct,ut,St,He,st,je,at,rt,ht,Qe,mt)=>({u_frustum_tl:$e,u_frustum_tr:ct,u_frustum_br:ut,u_frustum_bl:St,u_horizon:He,u_transition:st,u_fadeout_range:je,u_color:at,u_high_color:rt,u_space_color:ht,u_temporal_offset:Qe,u_horizon_angle:mt}))(b.frustumCorners.TL,b.frustumCorners.TR,b.frustumCorners.BR,b.frustumCorners.BL,b.frustumCorners.horizon,I,te,F,V,K,he,Se);a.uploadCommonUniforms(f,Ae);let Ke=this.atmosphereBuffer;Ke&&Ae.draw(a,_.TRIANGLES,w,Oi.disabled,be?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Ti.backCW,Oe,be?"atmosphere_glow_alpha":"atmosphere_glow",Ke.vertexBuffer,Ke.indexBuffer,Ke.segments)};ve(!1),ve(!0)}drawStars(a,c){let f=r.ay(c.properties.get("star-intensity"),0,1);if(f===0)return;let _=a.context,b=_.gl,w=a.transform,I=a.getOrCreateProgram("stars"),k=r.ad.quat.identity([]);r.ad.quat.rotateX(k,k,-w._pitch),r.ad.quat.rotateZ(k,k,-w.angle),r.ad.quat.rotateX(k,k,r.ak(w._center.lat)),r.ad.quat.rotateY(k,k,-r.ak(w._center.lng));let O=r.ad.mat4.fromQuat(new Float32Array(16),k),F=r.ad.mat4.multiply([],w.starsProjMatrix,O),z=r.ad.mat3.fromMat4([],O),V=r.ad.mat3.invert([],z),G=[0,1,0];r.ad.vec3.transformMat3(G,G,V),r.ad.vec3.scale(G,G,this.params.sizeMultiplier);let K=[1,0,0];r.ad.vec3.transformMat3(K,K,V),r.ad.vec3.scale(K,K,this.params.sizeMultiplier);let W=(te=G,ne=K,he=f,{u_matrix:Float32Array.from(F),u_up:te,u_right:ne,u_intensity_multiplier:he});var te,ne,he;a.uploadCommonUniforms(_,I),this.starsVx&&this.starsIdx&&I.draw(a,b.TRIANGLES,ci.disabled,Oi.disabled,this.colorModeAlphaBlendedWriteRGB,Ti.disabled,W,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function wc(m,a){let c=[...m],f=a.cameraWorldSizeForFog/a.worldSize,_=r.ad.mat4.identity([]);return r.ad.mat4.scale(_,_,[f,f,1]),r.ad.mat4.multiply(c,_,c),r.ad.mat4.multiply(c,a.worldToFogMatrix,c),c}function Mh(m,a,c,f,_){let b=c.material,w=f.context,{baseColorTexture:I,metallicRoughnessTexture:k}=b.pbrMetallicRoughness,{normalTexture:O,occlusionTexture:F,emissionTexture:z}=b;function V(K,W,te){if(K&&(m.push(W),w.activeTexture.set(w.gl.TEXTURE0+te),K.gfxTexture)){let{minFilter:ne,magFilter:he,wrapS:_e,wrapT:me}=K.sampler;K.gfxTexture.bindExtraParam(ne,he,_e,me)}}V(I,"HAS_TEXTURE_u_baseColorTexture",Or.BaseColor),V(k,"HAS_TEXTURE_u_metallicRoughnessTexture",Or.MetallicRoughness),V(O,"HAS_TEXTURE_u_normalTexture",Or.Normal),V(F,"HAS_TEXTURE_u_occlusionTexture",Or.Occlusion),V(z,"HAS_TEXTURE_u_emissionTexture",Or.Emission),_&&(_.texture||(_.texture=new r.dn(f.context,_.image,[_.image.height,_.image.height,_.image.height],w.gl.RGBA8)),w.activeTexture.set(w.gl.TEXTURE0+Or.LUT),_.texture&&_.texture.bind(w.gl.LINEAR,w.gl.CLAMP_TO_EDGE),m.push("APPLY_LUT_ON_GPU")),c.texcoordBuffer&&(m.push("HAS_ATTRIBUTE_a_uv_2f"),a.push(c.texcoordBuffer)),c.colorBuffer&&(m.push(c.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),a.push(c.colorBuffer)),c.normalBuffer&&(m.push("HAS_ATTRIBUTE_a_normal_3f"),a.push(c.normalBuffer)),c.pbrBuffer&&(m.push("HAS_ATTRIBUTE_a_pbr"),m.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),a.push(c.pbrBuffer)),b.alphaMode!=="OPAQUE"&&b.alphaMode!=="MASK"||m.push("UNPREMULT_TEXTURE_IN_SHADER"),b.defined||m.push("DIFFUSE_SHADED");let G=f.shadowRenderer;G&&(m.push("RENDER_SHADOWS","DEPTH_TEXTURE"),G.useNormalOffset&&m.push("NORMAL_OFFSET"))}function Cc(m,a,c,f,_,b){let w=c.paint.get("model-opacity").constantOr(1),I=a.context,k=new ci(a.context.gl.LEQUAL,ci.ReadWrite,a.depthRangeFor3D),O=a.transform,F=m.mesh,z=F.material,V=z.pbrMetallicRoughness,G=a.style.fog,K;K=a.transform.projection.zAxisUnit==="pixels"?[...m.nodeModelMatrix]:r.ad.mat4.multiply([],f.zScaleMatrix,m.nodeModelMatrix),r.ad.mat4.multiply(K,f.negCameraPosMatrix,K);let W=r.ad.mat4.invert([],K);r.ad.mat4.transpose(W,W);let te=c.paint.get("model-color-use-theme").constantOr("default")==="none",ne=c.paint.get("model-emissive-strength").constantOr(0),he=Tv(new Float32Array(m.worldViewProjection),new Float32Array(K),new Float32Array(W),null,a,w,V.baseColorFactor.toRenderColor(null),z.emissiveFactor,V.metallicFactor,V.roughnessFactor,z,ne,c),_e={defines:[]},me=[],Se=a.shadowRenderer;Se&&(Se.useNormalOffset=!1),Mh(_e.defines,me,F,a,te?null:c.lut);let ve=null;if(G){let Ae=wc(m.nodeModelMatrix,a.transform);if(ve=new Float32Array(Ae),O.projection.name!=="globe"){let Oe=F.aabb.min,Ke=F.aabb.max,[$e,ct]=G.getOpacityForBounds(Ae,Oe[0],Oe[1],Ke[0],Ke[1]);_e.overrideFog=$e>=Ut||ct>=Ut}}let be=_c(a,c.paint.get("model-cutoff-fade-range"));be.shouldRenderCutoff&&_e.defines.push("RENDER_CUTOFF");let xe=a.getOrCreateProgram("model",_e);a.uploadCommonUniforms(I,xe,null,ve,be),a.renderPass!=="shadow"&&Se&&Se.setupShadowsFromMatrix(m.nodeModelMatrix,xe),xe.draw(a,I.gl.TRIANGLES,k,_,b,F.material.doubleSided?Ti.disabled:Ti.backCCW,he,c.id,F.vertexBuffer,F.indexBuffer,F.segments,c.paint,a.transform.zoom,void 0,me)}function su(m,a,c,f,_,b,w){let I;I=m.projection.name==="globe"?r.dp(c,m):[...c],r.ad.mat4.multiply(I,I,a.matrix);let k=r.ad.mat4.multiply([],f,I);if(a.meshes)for(let O of a.meshes){if(O.material.alphaMode!=="BLEND"){w.push({mesh:O,depth:0,modelIndex:_,worldViewProjection:k,nodeModelMatrix:I});continue}let F=r.ad.vec3.transformMat4([],O.centroid,k);!m.isOrthographic&&F[2]<=0||b.push({mesh:O,depth:F[2],modelIndex:_,worldViewProjection:k,nodeModelMatrix:I})}if(a.children)for(let O of a.children)su(m,O,c,f,_,b,w)}function bf(m,a,c,f){let _=c.shadowRenderer;if(!_)return;let b=_.getShadowPassDepthMode(),w=_.getShadowPassColorMode(),I=_.calculateShadowPassMatrixFromMatrix(a),k=Ew(I);c.getOrCreateProgram("modelDepth",{defines:c._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(c,c.context.gl.TRIANGLES,b,Oi.disabled,w,Ti.backCCW,k,f.id,m.vertexBuffer,m.indexBuffer,m.segments,f.paint,c.transform.zoom,void 0,void 0)}function zv(m,a,c){let f=a.updateZoomBasedPaintProperties(),_=function(b,w,I){let k,O,F,z=b.terrain?b.terrain.exaggeration():0;if(b.terrain&&z>0){let V=b.terrain,G=V.findDEMTileFor(I);G&&G.dem?k=r.dr.create(V,I,G):z=0}if(z===0&&(w.terrainElevationMin=0,w.terrainElevationMax=0),z===w.validForExaggeration&&(z===0||k&&k._demTile&&k._demTile.tileID===w.validForDEMTile.id&&k._dem._timestamp===w.validForDEMTile.timestamp))return!1;for(let V in w.instancesPerModel){let G=w.instancesPerModel[V];for(let K=0;K<G.instancedDataArray.length;++K){let W=(k?z*k.getElevationAt(0|G.instancedDataArray.float32[16*K],0|G.instancedDataArray.float32[16*K+1],!0,!0):0)+G.instancesEvaluatedElevation[K];G.instancedDataArray.float32[16*K+6]=W,O=O?Math.min(w.terrainElevationMin,W):W,F=F?Math.max(w.terrainElevationMax,W):W}}return w.terrainElevationMin=O||0,w.terrainElevationMax=F||0,w.validForExaggeration=z,w.validForDEMTile=k&&k._demTile?{id:k._demTile.tileID,timestamp:k._dem._timestamp}:{id:void 0,timestamp:0},!0}(m,a,c);(f||_)&&(a.uploaded=!1,a.upload(m.context))}let js={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new r.ce([0,0,0],[r.ai,r.ai,0])};function Bv(m,a){let c=1<<m.canonical.z,f=a.getFreeCameraOptions().position,_=a.elevation,b=m.canonical.x/c,w=(m.canonical.x+1)/c,I=m.canonical.y/c,k=(m.canonical.y+1)/c,O=a._centerAltitude;if(_){let G=_.getMinMaxForTile(m);G&&G.max>O&&(O=G.max)}let F=r.ay(f.x,b,w)-f.x,z=r.ay(f.y,I,k)-f.y,V=r.bH(O,a.center.lat)-f.z;return a._zoomFromMercatorZ(Math.sqrt(F*F+z*z+V*V))}function gl(m,a,c,f,_,b,w){let I=m.context,k=m.renderPass==="shadow",O=m.shadowRenderer,F=k&&O?O.getShadowPassDepthMode():new ci(I.gl.LEQUAL,ci.ReadWrite,m.depthRangeFor3D),z=m.isTileAffectedByFog(b);if(c.meshes)for(let V of c.meshes){let G=["MODEL_POSITION_ON_GPU"],K=[],W,te,ne;f.instancedDataArray.length>20&&G.push("INSTANCED_ARRAYS");let he=_c(m,a.paint.get("model-cutoff-fade-range"));if(he.shouldRenderCutoff&&G.push("RENDER_CUTOFF"),k&&O)W=m.getOrCreateProgram("modelDepth",{defines:G}),te=Ew(w.shadowTileMatrix,w.shadowTileMatrix,Float32Array.from(c.matrix)),ne=O.getShadowPassColorMode();else{Mh(G,K,V,m,a.paint.get("model-color-use-theme").constantOr("default")==="none"?null:a.lut),W=m.getOrCreateProgram("model",{defines:G,overrideFog:z});let me=V.material,Se=me.pbrMetallicRoughness,ve=a.paint.get("model-opacity").constantOr(1),be=a.paint.get("model-emissive-strength").constantOr(0);te=Tv(b.expandedProjMatrix,Float32Array.from(c.matrix),new Float32Array(16),null,m,ve,Se.baseColorFactor.toRenderColor(null),me.emissiveFactor,Se.metallicFactor,Se.roughnessFactor,me,be,a,_),O&&(w.shadowUniformsInitialized?W.setShadowUniformValues(I,O.getShadowUniformValues()):(O.setupShadows(b.toUnwrapped(),W,"model-tile",b.overscaledZ),w.shadowUniformsInitialized=!0)),ne=he.shouldRenderCutoff||ve<1||me.alphaMode!=="OPAQUE"?Ji.alphaBlended:Ji.unblended}m.uploadCommonUniforms(I,W,b.toUnwrapped(),null,he);let _e=V.material.doubleSided?Ti.disabled:Ti.backCCW;if(f.instancedDataArray.length>20)K.push(f.instancedDataBuffer),W.draw(m,I.gl.TRIANGLES,F,Oi.disabled,ne,_e,te,a.id,V.vertexBuffer,V.indexBuffer,V.segments,a.paint,m.transform.zoom,void 0,K,f.instancedDataArray.length);else{let me=k?"u_instance":"u_normal_matrix";for(let Se=0;Se<f.instancedDataArray.length;++Se)te[me]=new Float32Array(f.instancedDataArray.arrayBuffer,64*Se,16),W.draw(m,I.gl.TRIANGLES,F,Oi.disabled,ne,_e,te,a.id,V.vertexBuffer,V.indexBuffer,V.segments,a.paint,m.transform.zoom,void 0,K)}}if(c.children)for(let V of c.children)gl(m,a,V,f,_,b,w)}let pd=[1,-1,1];function Tg(m,a,c,f){if(!c.modelManager)return!0;let _=c.modelManager;if(!c.shadowRenderer)return!0;let b=c.shadowRenderer,w=a.aabb,I=!0,k=m.maxHeight;if(k===0){let F=0;for(let z in m.instancesPerModel){let V=_.getModel(z,f);V?F=Math.max(F,Math.max(Math.max(V.aabb.max[0],V.aabb.max[1]),V.aabb.max[2])):I=!1}k=m.maxScale*F*1.41+m.maxVerticalOffset,I&&(m.maxHeight=k)}w.max[2]=k,w.min[2]+=m.terrainElevationMin,w.max[2]+=m.terrainElevationMax,r.ad.vec3.transformMat4(w.min,w.min,a.tileMatrix),r.ad.vec3.transformMat4(w.max,w.max,a.tileMatrix);let O=w.intersects(b.getCurrentCascadeFrustum());return c.currentShadowCascade===0&&(m.isInsideFirstShadowMapFrustum=O===2),O===0}function Ig(m,a){let c=m.uniformValues.u_cutoff_params[0],f=m.uniformValues.u_cutoff_params[1],_=m.uniformValues.u_cutoff_params[2],b=m.uniformValues.u_cutoff_params[3];return f===c||b===_?1:r.ay(((a-c)/(f-c)-_)/(b-_),0,1)}function Vv(m,a,c,f){if(a.pitch<20)return 1;let _=a.getWorldToCameraMatrix();r.ad.mat4.multiply(_,_,m);let b=r.ad.vec4.fromValues(c.min[0],c.min[1],c.min[2],1),w=r.ad.vec4.transformMat4(r.ad.vec4.create(),b,_),I=w,k=w;b[1]=c.max[1],w=r.ad.vec4.transformMat4(r.ad.vec4.create(),b,_),I=w[1]<I[1]?w:I,k=w[1]>k[1]?w:k,b[0]=c.max[0],w=r.ad.vec4.transformMat4(r.ad.vec4.create(),b,_),I=w[1]<I[1]?w:I,k=w[1]>k[1]?w:k,b[1]=c.min[1],w=r.ad.vec4.transformMat4(r.ad.vec4.create(),b,_),I=w[1]<I[1]?w:I,k=w[1]>k[1]?w:k;let O=r.ay(f[0],0,1),F=100*a.pixelsPerMeter*r.ay(f[1],0,1),z=r.ay(f[2],0,1),V=r.ad.vec4.lerp(r.ad.vec4.create(),I,k,O),G=Math.tan(.5*a.fovX),K=-V[2]*G;if(F===0)return V[1]<-Math.abs(K)?z:1;let W=(-Math.abs(K)-V[1])/F,te=(he,_e,me)=>(1-me)*he+me*_e,ne=r.ay(te(1,z,W),z,1);return te(1,ne,r.ay((a.pitch-20)/20,0,1))}class jv{}class lu{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(a,c,f){{let z=this._storage.get(c.id);if(z)return z.lastUsedFrameIdx=a,z.buf}let _=f.gl,b=_.getBufferParameter(_.ELEMENT_ARRAY_BUFFER,_.BUFFER_SIZE),w=new ArrayBuffer(b),I=new Int16Array(w);_.getBufferSubData(_.ELEMENT_ARRAY_BUFFER,0,new Int16Array(w));let k=new r.dt;for(let z=0;z<b/2;z+=3){let V=I[z],G=I[z+1],K=I[z+2];k.emplaceBack(V,G),k.emplaceBack(G,K),k.emplaceBack(K,V)}let O=f.bindVertexArrayOES.current,F=new jv;return F.buf=new xg(f,k),F.lastUsedFrameIdx=a,this._storage.set(c.id,F),f.bindVertexArrayOES.set(O),F.buf}update(a){for(let[c,f]of this._storage)a-f.lastUsedFrameIdx>30&&(f.buf.destroy(),this._storage.delete(c))}destroy(){for(let[a,c]of this._storage)c.buf.destroy(),this._storage.delete(a)}}class Uv{constructor(a){this.occluderSize=30,this.depthOffset=-1e-4,a.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),a.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}let fd=r.dd([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class Hv{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class xf{constructor(a,c){this.revealStart=11,this.revealRange=2,a.registerParameter(this,[...c,"Reveal"],"revealStart",{min:0,max:17,step:.05}),a.registerParameter(this,[...c,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}let $v=r.dd([{type:"Float32",name:"a_pos_2f",components:2}]);class Gv{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(a,c){let f=a.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){let w=new r.du,I=new r.aV;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(1,1),w.emplaceBack(-1,1),I.emplaceBack(0,1,2),I.emplaceBack(0,2,3),this.vignetteVx=a.context.createVertexBuffer(w,$v.members),this.vignetteIdx=a.context.createIndexBuffer(I)}let _=r.b8.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){a.uploadCommonUniforms(a.context,f);let w={u_vignetteShape:(b={vignetteShape:[c.start,c.range,Math.pow(10,c.fadePower)],vignetteColor:[c.color.r,c.color.g,c.color.b,c.color.a*c.strength]}).vignetteShape,u_vignetteColor:b.vignetteColor};f.draw(a,a.context.gl.TRIANGLES,ci.disabled,Oi.disabled,Ji.alphaBlended,Ti.disabled,w,"vignette",this.vignetteVx,this.vignetteIdx,_)}var b}}class Uo{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(a,c){let f=a.getFreeCameraOptions().position,_=f.toAltitude(),b=f.toLngLat(),w=r.ak(b.lng),I=r.ak(b.lat),k=a.pixelsPerMeter/c,O=w*r.dv,F=r.dv*Math.log(Math.tan(Math.PI/4+I/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{let z=-this._offsetYPrev+F,V=-this._elevationPrev+_;this._accumulatedOffsetX+=(-this._offsetXPrev+O)*k,this._accumulatedOffsetY+=z*k,this._accumulatedElevation+=V*k,this._offsetXPrev=O,this._offsetYPrev=F,this._elevationPrev=_}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function Ag(m,a){return[-(m[0]-Math.floor(m[0]/a)*a),-(m[1]-Math.floor(m[1]/a)*a),-(m[2]-Math.floor(m[2]/a)*a)]}function Rg(m){let a=r.dl(1323123451230),c=[];for(let f=0;f<m;++f){let _=2*a()-1,b=2*a()-1,w=2*a()-1;c.push(r.ad.vec3.fromValues(_,b,w))}return c}function Ka(m,a,c,f,_){let b=r.ay((_-c)/(f-c),0,1);return(1-b)*m+b*a}class kg{constructor(a){this._movement=new Uo,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new Gv,this._ppmScaleFactor=a}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(a,c){let f=a.transform;this._movement.update(f,this._ppmScaleFactor);let _=f.starsProjMatrix,b=r.ad.quat.identity([]);r.ad.quat.rotateX(b,b,r.ak(90)-f._pitch),r.ad.quat.rotateZ(b,b,-f.angle);let w=r.ad.mat4.fromQuat(new Float32Array(16),b),I=r.ad.mat4.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),k=r.ad.mat4.transpose([],I),O=r.ad.mat4.multiply([],k,w),F=Date.now()/1e3;return this._accumulatedTimeFromStart+=(F-this._prevTime)*c,this._prevTime=F,{projectionMatrix:_,modelviewMatrix:O}}}class qv extends kg{constructor(a){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new xf(a.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(a){let c=a.context;if(!this.particlesVx){let f=Rg(this.particlesCount),_=new r.dw,b=new r.aV,w=0,I=r.dl(1323123451230);for(let k=0;k<f.length;++k){let O=f[k],F=[2*I()-1,I(),I(),I()];_.emplaceBack(O[0],O[1],O[2],-1,-1,...F),_.emplaceBack(O[0],O[1],O[2],1,-1,...F),_.emplaceBack(O[0],O[1],O[2],1,1,...F),_.emplaceBack(O[0],O[1],O[2],-1,1,...F),b.emplaceBack(w+0,w+1,w+2),b.emplaceBack(w+0,w+2,w+3),w+=4}this.particlesVx=c.createVertexBuffer(_,fd.members),this.particlesIdx=c.createIndexBuffer(b)}}draw(a){if(!this._params.overrideStyleParameters&&!a.style.rain)return;let c=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},f=a.transform.zoom;if(c.revealStart>f)return;let _=Ka(0,1,c.revealStart,c.revealStart+c.revealRange,f);if(!this.particlesVx||!this.particlesIdx)return;let b=structuredClone(this._params),w=[-b.direction.x,b.direction.y,-100];r.ad.vec3.normalize(w,w);let I=structuredClone(this._vignetteParams);I.strength*=_,b.overrideStyleParameters||(b.intensity=a.style.rain.state.density,b.timeFactor=a.style.rain.state.intensity,b.color=structuredClone(a.style.rain.state.color),w=structuredClone(a.style.rain.state.direction),b.screenThinning.intensity=a.style.rain.state.centerThinning,b.dropletSizeX=a.style.rain.state.dropletSize[0],b.dropletSizeYScale=a.style.rain.state.dropletSize[1]/a.style.rain.state.dropletSize[0],b.distortionStrength=100*a.style.rain.state.distortionStrength,I.strength=1,I.color=structuredClone(a.style.rain.state.vignetteColor));let k=this.updateOnRender(a,b.timeFactor),O=a.context,F=O.gl,z=a.transform;this.screenTexture&&this.screenTexture.size[0]===a.width&&this.screenTexture.size[1]===a.height||(this.screenTexture=new r.T(O,{width:a.width,height:a.height,data:null},F.RGBA8)),b.distortionStrength>0&&(O.activeTexture.set(F.TEXTURE0),this.screenTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),F.copyTexSubImage2D(F.TEXTURE_2D,0,0,0,0,0,a.width,a.height));let V=a.getOrCreateProgram("rainParticle");a.uploadCommonUniforms(O,V),O.activeTexture.set(F.TEXTURE0),this.screenTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE);let G=[b.color.r,b.color.g,b.color.b,b.color.a],K=(W,te)=>{let ne=Ag(this._movement.getPosition(),W),he=b.dropletSizeX,_e=b.dropletSizeX*b.dropletSizeYScale,me=a.width/2,Se=a.height/2,ve=Ka(0,b.screenThinning.start,0,1,b.screenThinning.intensity),be=Ka(.001,b.screenThinning.range,0,1,b.screenThinning.intensity),xe=Ka(0,b.screenThinning.particleOffset,0,1,b.screenThinning.intensity),Ae=(Oe={modelview:k.modelviewMatrix,projection:k.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ne,velocityConeAperture:b.velocityConeAperture,velocity:b.velocity,boxSize:W,rainDropletSize:[he,_e],distortionStrength:b.distortionStrength,rainDirection:w,color:G,screenSize:[z.width,z.height],thinningCenterPos:[me,Se],thinningShape:[ve,be,Math.pow(10,b.screenThinning.fadePower)],thinningAffectedRatio:b.screenThinning.affectedRatio,thinningParticleOffset:xe,shapeDirectionalPower:b.shapeDirPower,shapeNormalPower:b.shapeNormalPower,mode:te?0:1},{u_modelview:Float32Array.from(Oe.modelview),u_projection:Float32Array.from(Oe.projection),u_time:Oe.time,u_cam_pos:Oe.camPos,u_texScreen:0,u_velocityConeAperture:Oe.velocityConeAperture,u_velocity:Oe.velocity,u_boxSize:Oe.boxSize,u_rainDropletSize:Oe.rainDropletSize,u_distortionStrength:Oe.distortionStrength,u_rainDirection:Oe.rainDirection,u_color:Oe.color,u_screenSize:Oe.screenSize,u_thinningCenterPos:Oe.thinningCenterPos,u_thinningShape:Oe.thinningShape,u_thinningAffectedRatio:Oe.thinningAffectedRatio,u_thinningParticleOffset:Oe.thinningParticleOffset,u_shapeDirectionalPower:Oe.shapeDirectionalPower,u_shapeNormalPower:Oe.shapeNormalPower,u_mode:Oe.mode});var Oe;let Ke=Math.round(b.intensity*this.particlesCount),$e=r.b8.simpleSegment(0,0,4*Ke,2*Ke);V.draw(a,F.TRIANGLES,ci.disabled,Oi.disabled,Ji.alphaBlended,Ti.disabled,Ae,"rain_particles",this.particlesVx,this.particlesIdx,$e)};b.distortionStrength>0&&K(b.boxSize,!0),K(b.boxSize,!1),this._vignette.draw(a,I)}}let Wv=r.dd([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class Th extends kg{constructor(a){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new xf(a.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(a){let c=a.context;if(!this.particlesVx){let f=Rg(this.particlesCount),_=new r.dx,b=new r.aV,w=0,I=r.dl(1323123451230);for(let k=0;k<f.length;++k){let O=f[k],F=I(),z=I(),V=I(),G=[k/f.length,F,z,V],K=[I(),I()];_.emplaceBack(O[0],O[1],O[2],-1,-1,...G,...K),_.emplaceBack(O[0],O[1],O[2],1,-1,...G,...K),_.emplaceBack(O[0],O[1],O[2],1,1,...G,...K),_.emplaceBack(O[0],O[1],O[2],-1,1,...G,...K),b.emplaceBack(w+0,w+1,w+2),b.emplaceBack(w+0,w+2,w+3),w+=4}this.particlesVx=c.createVertexBuffer(_,Wv.members),this.particlesIdx=c.createIndexBuffer(b)}}draw(a){if(!this._params.overrideStyleParameters&&!a.style.snow)return;let c=structuredClone(this._params),f=[-c.direction.x,c.direction.y,-100];r.ad.vec3.normalize(f,f);let _=structuredClone(this._vignetteParams),b=c.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},w=a.transform.zoom;if(b.revealStart>w)return;let I=Ka(0,1,b.revealStart,b.revealStart+b.revealRange,w);_.strength*=I,c.overrideStyleParameters||(c.intensity=a.style.snow.state.density,c.timeFactor=a.style.snow.state.intensity,c.color=structuredClone(a.style.snow.state.color),f=structuredClone(a.style.snow.state.direction),c.screenThinning.intensity=a.style.snow.state.centerThinning,c.billboardSize=2.79*a.style.snow.state.flakeSize,_.strength=1,_.color=structuredClone(a.style.snow.state.vignetteColor));let k=this.updateOnRender(a,c.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;let O=a.context,F=O.gl,z=a.transform,V=a.getOrCreateProgram("snowParticle");a.uploadCommonUniforms(O,V),((G,K,W)=>{let te=Ag(this._movement.getPosition(),G),ne=z.width/2,he=z.height/2,_e=Ka(0,W.screenThinning.start,0,1,W.screenThinning.intensity),me=Ka(.001,W.screenThinning.range,0,1,W.screenThinning.intensity),Se=Ka(0,W.screenThinning.particleOffset,0,1,W.screenThinning.intensity),ve=(be={modelview:k.modelviewMatrix,projection:k.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:te,velocityConeAperture:W.velocityConeAperture,velocity:W.velocity,horizontalOscillationRadius:W.horizontalOscillationRadius,horizontalOscillationRate:W.horizontalOscillationRate,boxSize:G,billboardSize:1*W.billboardSize,simpleShapeParameters:[W.shapeFadeStart,W.shapeFadePower],screenSize:[z.width,z.height],thinningCenterPos:[ne,he],thinningShape:[_e,me,Math.pow(10,W.screenThinning.fadePower)],thinningAffectedRatio:W.screenThinning.affectedRatio,thinningParticleOffset:Se,color:[W.color.r,W.color.g,W.color.b,W.color.a],direction:f},{u_modelview:Float32Array.from(be.modelview),u_projection:Float32Array.from(be.projection),u_time:be.time,u_cam_pos:be.camPos,u_velocityConeAperture:be.velocityConeAperture,u_velocity:be.velocity,u_horizontalOscillationRadius:be.horizontalOscillationRadius,u_horizontalOscillationRate:be.horizontalOscillationRate,u_boxSize:be.boxSize,u_billboardSize:be.billboardSize,u_simpleShapeParameters:be.simpleShapeParameters,u_screenSize:be.screenSize,u_thinningCenterPos:be.thinningCenterPos,u_thinningShape:be.thinningShape,u_thinningAffectedRatio:be.thinningAffectedRatio,u_thinningParticleOffset:be.thinningParticleOffset,u_particleColor:be.color,u_direction:be.direction});var be;let xe=Math.round(W.intensity*this.particlesCount),Ae=r.b8.simpleSegment(0,0,4*xe,2*xe);this.particlesVx&&this.particlesIdx&&V.draw(a,F.TRIANGLES,ci.disabled,Oi.disabled,Ji.alphaBlended,Ti.disabled,ve,"snow_particles",this.particlesVx,this.particlesIdx,Ae)})(c.boxSize,0,c),this._vignette.draw(a,_)}}let wf={symbol:function(m,a,c,f,_){if(m.renderPass!=="translucent")return;let b=Oi.disabled,w=m.colorModeForRenderPass(),I=c.layout.get("text-variable-anchor"),k=c.layout.get("text-size-scale-range"),O=r.ay(m.scaleFactor,k[0],k[1]);I&&function(V,G,K,W,te,ne,he,_e){let me=G.transform,Se=te==="map",ve=ne==="map";for(let be of V){let xe=W.getTile(be),Ae=xe.getBucket(K);if(!Ae||!Ae.text||!Ae.text.segments.get().length)continue;let Oe=r.bp(Ae.textSizeData,me.zoom,_e),Ke=_s(be,Ae.getProjection(),me),$e=me.calculatePixelsToTileUnitsMatrix(xe),ct=hc(Ke,xe.tileID.canonical,ve,Se,me,Ae.getProjection(),$e),ut=Ae.hasIconTextFit()&&Ae.hasIconData();if(Oe){let St=Math.pow(2,me.zoom-xe.tileID.overscaledZ);Vs(Ae,Se,ve,he,r.cY,me,ct,be,St,Oe,ut)}}}(f,m,c,a,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),_,O);let F=c.paint.get("icon-opacity").constantOr(1)!==0,z=c.paint.get("text-opacity").constantOr(1)!==0;c.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(F||z)?ir(m,a,c,f,b,w):(F&&ir(m,a,c,f,b,w,{onlyIcons:!0}),z&&ir(m,a,c,f,b,w,{onlyText:!0})),a.map.showCollisionBoxes&&(wg(m,a,c,f,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),wg(m,a,c,f,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(m,a,c,f){if(m.renderPass!=="translucent")return;let _=c.paint.get("circle-opacity"),b=c.paint.get("circle-stroke-width"),w=c.paint.get("circle-stroke-opacity"),I=c.layout.get("circle-sort-key").constantOr(1)!==void 0,k=c.paint.get("circle-emissive-strength");if(_.constantOr(1)===0&&(b.constantOr(1)===0||w.constantOr(1)===0))return;let O=m.context,F=O.gl,z=m.transform,V=m.depthModeForSublayer(0,ci.ReadOnly),G=Oi.disabled,K=m.colorModeForDrapableLayerRenderPass(k),W=z.projection.name==="globe",te=[r.av(z.center.lng),r.aC(z.center.lat)],ne=[];for(let _e=0;_e<f.length;_e++){let me=f[_e],Se=a.getTile(me),ve=Se.getBucket(c);if(!ve||ve.projection.name!==z.projection.name)continue;let be=ve.programConfigurations.get(c.id),xe=r.cZ(c),Ae=m.isTileAffectedByFog(me);W&&xe.push("PROJECTION_GLOBE_VIEW"),xe.push("DEPTH_D24"),m.terrain&&z.depthOcclusionForSymbolsAndCircles&&xe.push("DEPTH_OCCLUSION");let Oe=m.getOrCreateProgram("circle",{config:be,defines:xe,overrideFog:Ae}),Ke=ve.layoutVertexBuffer,$e=ve.globeExtVertexBuffer,ct=ve.indexBuffer,ut=z.projection.createInversionMatrix(z,me.canonical),St={programConfiguration:be,program:Oe,layoutVertexBuffer:Ke,globeExtVertexBuffer:$e,indexBuffer:ct,uniformValues:r.c_(m,me,Se,ut,te,c),tile:Se};if(I){let He=ve.segments.get();for(let st of He)ne.push({segments:new r.b8([st]),sortKey:st.sortKey,state:St})}else ne.push({segments:ve.segments,sortKey:0,state:St})}I&&ne.sort((_e,me)=>_e.sortKey-me.sortKey);let he={useDepthForOcclusion:z.depthOcclusionForSymbolsAndCircles};for(let _e of ne){let{programConfiguration:me,program:Se,layoutVertexBuffer:ve,globeExtVertexBuffer:be,indexBuffer:xe,uniformValues:Ae,tile:Oe}=_e.state,Ke=_e.segments;m.terrain&&m.terrain.setupElevationDraw(Oe,Se,he),m.uploadCommonUniforms(O,Se,Oe.tileID.toUnwrapped()),Se.draw(m,F.TRIANGLES,V,G,K,Ti.disabled,Ae,c.id,ve,xe,Ke,c.paint,z.zoom,me,[be])}},heatmap:function(m,a,c,f){if(c.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){let _=m.context,b=_.gl,w=Oi.disabled,I=new Ji([b.ONE,b.ONE,b.ONE,b.ONE],r.al.transparent,[!0,!0,!0,!0]);(function(G,K,W,te){let ne=G.gl,he=K.width*te,_e=K.height*te;G.activeTexture.set(ne.TEXTURE1),G.viewport.set([0,0,he,_e]);let me=W.heatmapFbo;if(!me||me&&(me.width!==he||me.height!==_e)){me&&me.destroy();let Se=ne.createTexture();ne.bindTexture(ne.TEXTURE_2D,Se),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_WRAP_S,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_WRAP_T,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MIN_FILTER,ne.LINEAR),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MAG_FILTER,ne.LINEAR),me=W.heatmapFbo=G.createFramebuffer(he,_e,!0,null),function(ve,be,xe,Ae,Oe,Ke){let $e=ve.gl;$e.texImage2D($e.TEXTURE_2D,0,ve.extRenderToTextureHalfFloat?$e.RGBA16F:$e.RGBA,Oe,Ke,0,$e.RGBA,ve.extRenderToTextureHalfFloat?$e.HALF_FLOAT:$e.UNSIGNED_BYTE,null),Ae.colorAttachment.set(xe)}(G,0,Se,me,he,_e)}else ne.bindTexture(ne.TEXTURE_2D,me.colorAttachment.get()),G.bindFramebuffer.set(me.framebuffer)})(_,m,c,m.transform.projection.name==="globe"?.5:.25),_.clear({color:r.al.transparent});let k=m.transform,O=k.projection.name==="globe",F=O?["PROJECTION_GLOBE_VIEW"]:[],z=O?Ti.frontCCW:Ti.disabled,V=[r.av(k.center.lng),r.aC(k.center.lat)];for(let G=0;G<f.length;G++){let K=f[G];if(a.hasRenderableParent(K))continue;let W=a.getTile(K),te=W.getBucket(c);if(!te||te.projection.name!==k.projection.name)continue;let ne=m.isTileAffectedByFog(K),he=te.programConfigurations.get(c.id),_e=m.getOrCreateProgram("heatmap",{config:he,defines:F,overrideFog:ne}),{zoom:me}=m.transform;m.terrain&&m.terrain.setupElevationDraw(W,_e),m.uploadCommonUniforms(_,_e,K.toUnwrapped());let Se=k.projection.createInversionMatrix(k,K.canonical);_e.draw(m,b.TRIANGLES,ci.disabled,w,I,z,yg(m,K,W,Se,V,me,c.paint.get("heatmap-intensity")),c.id,te.layoutVertexBuffer,te.indexBuffer,te.segments,c.paint,m.transform.zoom,he,O?[te.globeExtVertexBuffer]:null)}_.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(_,b){let w=_.context,I=w.gl,k=b.heatmapFbo;if(!k)return;w.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,k.colorAttachment.get()),w.activeTexture.set(I.TEXTURE1);let O=b.colorRampTexture;O||(O=b.colorRampTexture=new r.T(w,b.colorRamp,I.RGBA8)),O.bind(I.LINEAR,I.CLAMP_TO_EDGE),_.getOrCreateProgram("heatmapTexture").draw(_,I.TRIANGLES,ci.disabled,Oi.disabled,_.colorModeForRenderPass(),Ti.disabled,((F,z,V,G)=>({u_image:0,u_color_ramp:1,u_opacity:z.paint.get("heatmap-opacity")}))(0,b),b.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,b.paint,_.transform.zoom)}(m,c))},line:function(m,a,c,f){if(m.renderPass!=="translucent")return;let _=c.paint.get("line-opacity"),b=c.paint.get("line-width");if(_.constantOr(1)===0||b.constantOr(1)===0)return;let w=c.paint.get("line-emissive-strength"),I=c.paint.get("line-occlusion-opacity"),k=c.layout.get("line-elevation-reference"),O=c.layout.get("line-width-unit")==="meters",F=k==="sea",z=m.context,V=z.gl;if(c.hasElevatedBuckets&&m.transform.projection.name==="globe")return;let G=c.layout.get("line-cross-slope"),K=G!==void 0,W=G<1,te=m.colorModeForDrapableLayerRenderPass(w),ne=m.terrain&&m.terrain.renderingToTexture,he=ne?1:r.q.devicePixelRatio,_e=c.paint.get("line-dasharray"),me=_e.constantOr(1),Se=c.layout.get("line-cap"),ve=_e.constantOr(null),be=Se.constantOr(null),xe=c.paint.get("line-pattern"),Ae=xe.constantOr(1),Oe=xe.constantOr(null),Ke=c.paint.get("line-opacity").constantOr(1),$e=!Ae&&Ke!==1||m.depthOcclusion&&I>0&&I<1,ct=c.paint.get("line-gradient"),ut=Ae?"linePattern":"line",St=r.c$(c),He;if(ne&&m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&($e=!1),I!==0&&m.depthOcclusion){let je=c.paint._values["line-opacity"];je&&je.value&&je.value.kind==="constant"?He=je.value:r.w(`Occlusion opacity for layer ${c.id} is supported only when line-opacity isn't data-driven.`)}b.value.kind!=="constant"&&b.value.isLineProgressConstant===!1&&St.push("VARIABLE_LINE_WIDTH");let st=(je,at,rt,ht,Qe,mt)=>{for(let Nt of je){let zt=a.getTile(Nt);if(Ae&&!zt.patternsLoaded())continue;let Vt=zt.getBucket(c);if(!Vt||Vt.hasZOffset&&!Qe||!Vt.hasZOffset&&Qe)continue;m.prepareDrawTile();let ei=Vt.programConfigurations.get(c.id),Ri=m.isTileAffectedByFog(Nt),gi=m.getOrCreateProgram(ut,{config:ei,defines:at,overrideFog:Ri,overrideRtt:!Qe&&void 0});if(Oe&&zt.imageAtlas){let Fi=r.d0.from(Oe).getPrimary().scaleSelf(he).toString(),ti=zt.imageAtlas.patternPositions.get(Fi);ti&&ei.setConstantPatternPositions(ti)}if(!Ae&&ve&&be&&zt.lineAtlas){let Fi=zt.lineAtlas.getDash(ve,be);Fi&&ei.setConstantPatternPositions(Fi)}let[Si,vi]=c.paint.get("line-trim-offset");(be==="round"||be==="square")&&Si!==vi&&(Si===0&&(Si-=1),vi===1&&(vi+=1));let on=ne?Nt.projMatrix:null,Dn=O?1/Vt.tileToMeter/r.at(zt,1,m.transform.zoom):1,ar=O?1/Vt.tileToMeter/r.at(zt,1,Math.floor(m.transform.zoom)):1,Zi=Ae?r.d1(m,zt,c,on,he,Dn,ar,[Si,vi]):r.d2(m,zt,c,on,Vt.lineClipsArray.length,he,Dn,ar,[Si,vi]);if(ct){let Fi=Vt.gradients[c.id],ti=Fi.texture;if(c.gradientVersion!==Fi.version){let ln=256;if(c.stepInterpolant){let Nn=a.getSource().maxzoom,_n=Nt.canonical.z===Nn?Math.ceil(1<<m.transform.maxZoom-Nt.canonical.z):1;ln=r.ay(r.d3(Vt.maxLineLength/r.ai*1024*_n),256,z.maxTextureSize)}Fi.gradient=r.d4({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:ln,image:Fi.gradient||void 0,clips:Vt.lineClipsArray}),Fi.texture?Fi.texture.update(Fi.gradient):Fi.texture=new r.T(z,Fi.gradient,V.RGBA8),Fi.version=c.gradientVersion,ti=Fi.texture}z.activeTexture.set(V.TEXTURE1),ti.bind(c.stepInterpolant?V.NEAREST:V.LINEAR,V.CLAMP_TO_EDGE)}me&&(z.activeTexture.set(V.TEXTURE0),zt.lineAtlasTexture&&zt.lineAtlasTexture.bind(V.LINEAR,V.REPEAT),ei.updatePaintBuffers()),Ae&&(z.activeTexture.set(V.TEXTURE0),zt.imageAtlasTexture&&zt.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),ei.updatePaintBuffers()),Qe&&!F&&m.terrain.setupElevationDraw(zt,gi),m.uploadCommonUniforms(z,gi,Nt.toUnwrapped());let yr=Fi=>{He!=null&&(He.value=Ke*I),gi.draw(m,V.TRIANGLES,rt,Fi,te,Ti.disabled,Zi,c.id,Vt.layoutVertexBuffer,Vt.indexBuffer,Vt.segments,c.paint,m.transform.zoom,ei,[Vt.layoutVertexBuffer2,Vt.patternVertexBuffer,Vt.zOffsetVertexBuffer]),He!=null&&(He.value=Ke)};if($e&&!Qe){let Fi=m.stencilModeForClipping(Nt).ref;Fi===0&&ne&&z.clear({stencil:0});let ti={func:V.EQUAL,mask:255};Zi.u_alpha_discard_threshold=.8,yr(new Oi(ti,Fi,255,V.KEEP,V.KEEP,V.INVERT)),Zi.u_alpha_discard_threshold=0,yr(new Oi(ti,Fi,255,V.KEEP,V.KEEP,V.KEEP))}else Zi.u_alpha_discard_threshold=$e&&Qe&&mt?.8:0,yr(Qe?ht:m.stencilModeForClipping(Nt))}};if(c.hasNonElevatedBuckets){let je=!ne&&m.terrain;I!==0&&je?r.w(`Occlusion opacity for layer ${c.id} is supported on terrain only if the layer has line-z-offset enabled.`):je?r.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${c.id}.`):st(f,St,m.depthModeForSublayer(0,ci.ReadOnly),Oi.disabled,!1,!0)}if(c.hasElevatedBuckets){St.push("ELEVATED"),K&&St.push(W?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),F&&St.push("ELEVATION_REFERENCE_SEA");let je=$e?m.stencilModeFor3D():Oi.disabled,at=new ci(m.depthOcclusion?V.GREATER:V.LEQUAL,ci.ReadOnly,m.depthRangeFor3D);m.forceTerrainMode=!0,st(f,St,at,je,!0,!0),$e&&st(f,St,at,je,!0,!1),m.forceTerrainMode=!1}$e&&(m.resetStencilClippingMasks(),ne&&z.clear({stencil:0})),I===0||m.depthOcclusion||ne||m.layersWithOcclusionOpacity.push(m.currentLayer)},fill:function(m,a,c,f){let _=c.paint.get("fill-color"),b=c.paint.get("fill-opacity");if(b.constantOr(1)===0)return;let w=c.paint.get("fill-emissive-strength"),I=m.colorModeForDrapableLayerRenderPass(w),k=c.paint.get("fill-pattern"),O=m.opaquePassEnabledForLayer()&&!k.constantOr(1)&&_.constantOr(r.al.transparent).a===1&&b.constantOr(0)===1?"opaque":"translucent",F="none";c.layout.get("fill-elevation-reference")!=="none"?F="road":c.paint.get("fill-z-offset").constantOr(1)!==0&&(F="offset");let z=!(!m.terrain||!m.terrain.enabled),V={painter:m,sourceCache:a,layer:c,coords:f,colorMode:I,elevationType:F,terrainEnabled:z,pass:O};if(F!=="offset"){if(Eg(V,!1),F==="road"){let G=!z&&m.renderPass==="translucent";G&&Pv(m,a,c,f,"geometry"),Eg(V,!0,Oi.disabled),G&&function(K){let{painter:W,sourceCache:te,layer:ne,coords:he,colorMode:_e}=K,me=W.context.gl,Se=new ci(W.context.gl.LEQUAL,ci.ReadOnly,W.depthRangeFor3D);for(let ve of he){let be=te.getTile(ve),xe=be.getBucket(ne);if(!xe)continue;let Ae=xe.elevatedStructures;if(!Ae||!Ae.renderableSegments||Ae.renderableSegments.segments[0].primitiveLength===0)continue;W.prepareDrawTile();let Oe=xe.bufferData.programConfigurations.get(ne.id),Ke=W.isTileAffectedByFog(ve),$e=W.getOrCreateProgram("elevatedStructures",{config:Oe,overrideFog:Ke,defines:["NORMAL_OFFSET"]}),ct={u_matrix:W.translatePosMatrix(ve.projMatrix,be,ne.paint.get("fill-translate"),ne.paint.get("fill-translate-anchor"))};W.uploadCommonUniforms(W.context,$e,ve.toUnwrapped()),$e.draw(W,me.TRIANGLES,Se,Oi.disabled,_e,Ti.backCCW,ct,ne.id,Ae.vertexBuffer,Ae.indexBuffer,Ae.renderableSegments,ne.paint,W.transform.zoom,Oe,[Ae.vertexBufferNormal])}}(V)}}else Eg(V,!1,m.stencilModeFor3D())},"fill-extrusion":function(m,a,c,f){let _=c.paint.get("fill-extrusion-opacity"),b=m.context,w=b.gl,I=m.terrain,k=I&&I.renderingToTexture;if(_===0)return;let O=m.conflationActive&&m.style.isLayerClipped(c,a.getSource()),F=m.style.order.indexOf(c.fqid);if(O&&function(z,V,G,K,W){for(let te of K){let ne=V.getTile(te).getBucket(G);ne&&(ne.updateReplacement(te,z.replacementSource,W),ne.uploadCentroid(z.context))}}(m,a,c,f,F),I||O)for(let z of f){let V=a.getTile(z).getBucket(c);V&&wh(m.context,a,z,V,c,I,O)}if(m.renderPass==="shadow"&&m.shadowRenderer){let z=m.shadowRenderer;if(I&&_<.65&&c._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof r.ab)return;let V=z.getShadowPassDepthMode(),G=z.getShadowPassColorMode();yf(m,a,c,f,V,Oi.disabled,G,O)}else if(m.renderPass==="translucent"){let z=!c.paint.get("fill-extrusion-pattern").constantOr(1),V=c.paint.get("fill-extrusion-color").constantOr(r.al.white);if(!k&&V.a!==0){let G=new ci(m.context.gl.LEQUAL,ci.ReadWrite,m.depthRangeFor3D);_===1&&z?yf(m,a,c,f,G,Oi.disabled,Ji.unblended,O):(yf(m,a,c,f,G,Oi.disabled,Ji.disabled,O),yf(m,a,c,f,G,m.stencilModeFor3D(),m.colorModeForRenderPass(),O),m.resetStencilClippingMasks())}if(m.style.enable3dLights()&&z&&(!I&&m.transform.projection.name!=="globe"||k)){let G=c.paint.get("fill-extrusion-opacity"),K=c.paint.get("fill-extrusion-ambient-occlusion-intensity"),W=c.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),te=c.paint.get("fill-extrusion-flood-light-intensity"),ne=c.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",he=c.paint.get("fill-extrusion-flood-light-color").toRenderColor(ne?null:c.lut).toArray01().slice(0,3),_e=K>0&&W>0,me=te>0,Se=(be,xe,Ae)=>(1-Ae)*be+Ae*xe,ve=be=>{let xe=m.depthModeForSublayer(1,ci.ReadOnly,w.LEQUAL,!0),Ae=c.paint.get(be?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Oe=Se(.1,3,Ae),Ke=m._showOverdrawInspector;if(!Ke){let $e=new Oi({func:w.ALWAYS,mask:255},255,255,w.KEEP,w.KEEP,w.REPLACE),ct=new Ji([w.ONE,w.ONE,w.ONE,w.ONE],r.al.transparent,[!1,!1,!1,!0],w.MIN);xh(m,a,c,f,xe,$e,ct,Ti.disabled,be,"sdf",G,K,W,te,he,Oe,O,!1)}{let $e=Ke?Oi.disabled:new Oi({func:w.EQUAL,mask:255},255,255,w.KEEP,w.DECR,w.DECR),ct=Ke?m.colorModeForRenderPass():new Ji([w.ONE_MINUS_DST_ALPHA,w.DST_ALPHA,w.ONE,w.ONE],r.al.transparent,[!0,!0,!0,!0]);xh(m,a,c,f,xe,$e,ct,Ti.disabled,be,"color",G,K,W,te,he,Oe,O,!1)}};if(k){let be=(xe,Ae,Oe)=>{let Ke=m.depthModeForSublayer(1,ci.ReadOnly,w.LEQUAL,!1),$e=c.paint.get(xe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),ct=Se(.1,3,$e);{let ut=new Ji([w.ONE,w.ONE,w.ONE,w.ONE],r.al.transparent,[!1,!1,!1,!0]);xh(m,a,c,f,Ke,Oi.disabled,ut,Ti.disabled,xe,"clear",G,K,W,te,he,ct,O,Ae)}{let ut=new Oi({func:w.ALWAYS,mask:255},255,255,w.KEEP,w.KEEP,w.REPLACE),St=new Ji([w.ONE,w.ONE,w.ONE,w.ONE],r.al.transparent,[!1,!1,!1,!0],w.MIN);xh(m,a,c,f,Ke,ut,St,Ti.disabled,xe,"sdf",G,K,W,te,he,ct,O,Ae)}{let ut=xe?w.ZERO:w.ONE_MINUS_DST_ALPHA,St=new Oi({func:w.EQUAL,mask:255},255,255,w.KEEP,w.DECR,w.DECR),He=new Ji([ut,w.DST_ALPHA,w.ONE_MINUS_DST_ALPHA,w.ZERO],r.al.transparent,[!0,!0,!0,!0]);xh(m,a,c,f,Ke,St,He,Ti.disabled,xe,"color",G,K,W,te,he,ct,O,Ae)}{let ut=new Ji([w.ONE,w.ONE,w.ONE,xe?w.ZERO:w.ONE],r.al.transparent,[!1,!1,!1,!0],xe?w.FUNC_ADD:w.MAX);xh(m,a,c,f,Ke,Oi.disabled,ut,Ti.disabled,xe,"clear",G,K,W,te,he,ct,O,Ae,Oe)}};if(_e||me){let xe;if(m.prepareDrawTile(),I){let Ae=I.drapeBufferSize[0],Oe=I.drapeBufferSize[1];xe=I.framebufferCopyTexture,xe&&(!xe||xe.size[0]===Ae&&xe.size[1]===Oe)||(xe&&xe.destroy(),xe=I.framebufferCopyTexture=new r.T(b,new r.r({width:Ae,height:Oe}),w.RGBA8)),xe.bind(w.LINEAR,w.CLAMP_TO_EDGE),w.copyTexSubImage2D(w.TEXTURE_2D,0,0,0,0,0,Ae,Oe)}_e&&be(!0,!1,xe),me&&be(!1,!0,xe)}}else _e&&ve(!0),me&&ve(!1),(_e||me)&&m.resetStencilClippingMasks()}}},hillshade:function(m,a,c,f){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent"||m.style.disableElevatedTerrain)return;let _=m.context,b=m.terrain&&m.terrain.renderingToTexture,[w,I]=m.renderPass!=="translucent"||b?[{},f]:m.stencilConfigForOverlap(f);for(let k of I){let O=a.getTile(k);if(O.needsHillshadePrepare&&m.renderPass==="offscreen")kM(m,O,c);else if(m.renderPass==="translucent"){let F=m.depthModeForSublayer(0,ci.ReadOnly),z=c.paint.get("hillshade-emissive-strength"),V=m.colorModeForDrapableLayerRenderPass(z),G=b&&m.terrain?m.terrain.stencilModeForRTTOverlap(k):w[k.overscaledZ];hh(m,k,O,c,F,G,V)}}_.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,a,c,f,_,b){if(m.renderPass!=="translucent"||c.paint.get("raster-opacity")===0)return;let w=m.transform.projection.name==="globe",I=c.paint.get("raster-elevation")!==0,k=I&&w;if(m.renderElevatedRasterBackface&&!k)return;let O=m.context,F=O.gl,z=a.getSource(),V=function(ve,be,xe,Ae){let Oe=be.paint.get("raster-color"),Ke=ve.type==="raster-array",$e=[],ct=be.paint.get("raster-resampling"),ut=be.paint.get("raster-color-mix"),St=be.paint.get("raster-color-range"),He=[ut[0],ut[1],ut[2],0],st=ut[3],je=ct==="nearest"?Ae.NEAREST:Ae.LINEAR;if(Ke&&($e.push("RASTER_ARRAY"),Oe||$e.push("RASTER_COLOR"),ct==="linear"&&$e.push("RASTER_ARRAY_LINEAR"),je=Ae.NEAREST,!St&&ve.rasterLayers)){let at=ve.rasterLayers.find(({id:rt})=>rt===be.sourceLayer);at&&at.fields&&at.fields.range&&(St=at.fields.range)}if(St=St||[0,1],Oe){$e.push("RASTER_COLOR"),xe.activeTexture.set(Ae.TEXTURE2),be.updateColorRamp(St);let at=be.colorRampTexture;at||(at=be.colorRampTexture=new r.T(xe,be.colorRamp,Ae.RGBA8)),at.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE)}return{mix:He,range:St,offset:st,defines:$e,resampling:je}}(z,c,O,F);if(z instanceof r.aK&&!f.length&&!w)return;let G=c.paint.get("raster-emissive-strength"),K=m.colorModeForDrapableLayerRenderPass(G),W=m.terrain&&m.terrain.renderingToTexture,te=!m.options.moving,ne=c.paint.get("raster-resampling")==="nearest"?F.NEAREST:F.LINEAR;if(z instanceof r.aK&&!f.length&&(z.onNorthPole||z.onSouthPole)){let ve=I?m.stencilModeFor3D():Oi.disabled;return void We(!!z.onNorthPole,null,m,a,c,G,V,Ti.disabled,ve)}if(!f.length)return;let[he,_e]=z instanceof r.aK||W?[{},f]:m.stencilConfigForOverlap(f),me=_e[_e.length-1].overscaledZ;k&&V.defines.push("PROJECTION_GLOBE_VIEW"),I&&V.defines.push("RENDER_CUTOFF");let Se=(ve,be,xe)=>{for(let Ae of ve){let Oe=Ae.toUnwrapped(),Ke=a.getTile(Ae);if(W&&(!Ke||!Ke.hasData()))continue;O.activeTexture.set(F.TEXTURE0);let $e=Sg(Ke,z,c,V);if(!$e||!$e.texture)continue;let{texture:ct,mix:ut,offset:St,tileSize:He,buffer:st}=$e,je,at;W?(je=ci.disabled,at=Ae.projMatrix):I?(je=new ci(F.LEQUAL,ci.ReadWrite,m.depthRangeFor3D),at=w?Float32Array.from(m.transform.expandedFarZProjMatrix):m.transform.calculateProjMatrix(Oe,te)):(je=m.depthModeForSublayer(Ae.overscaledZ-me,c.paint.get("raster-opacity")===1?ci.ReadWrite:ci.ReadOnly,F.LESS),at=m.transform.calculateProjMatrix(Oe,te));let rt=m.terrain&&W?m.terrain.stencilModeForRTTOverlap(Ae):he[Ae.overscaledZ],ht=b?0:c.paint.get("raster-fade-duration");Ke.registerFadeDuration(ht);let Qe=a.findLoadedParent(Ae,0),mt=hg(Ke,Qe,a,m.transform,ht),Nt,zt;m.terrain&&m.terrain.prepareDrawTile(),O.activeTexture.set(F.TEXTURE0),ct.bind(ne,F.CLAMP_TO_EDGE),O.activeTexture.set(F.TEXTURE1),Qe?(Qe.texture&&Qe.texture.bind(ne,F.CLAMP_TO_EDGE),Nt=Math.pow(2,Qe.tileID.overscaledZ-Ke.tileID.overscaledZ),zt=[Ke.tileID.canonical.x*Nt%1,Ke.tileID.canonical.y*Nt%1]):ct.bind(ne,F.CLAMP_TO_EDGE),"useMipmap"in ct&&O.extTextureFilterAnisotropic&&m.transform.pitch>20&&F.texParameterf(F.TEXTURE_2D,O.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,O.extTextureFilterAnisotropicMax);let Vt=m.transform,ei,Ri=I?Dw(Vt):[0,0,0,0],gi,Si,vi,on,Dn,ar=0;if(k&&z instanceof r.aK&&z.coordinates.length>3)gi=Float32Array.from(r.bc(r.cI(new r.bT(0,0,0)))),Si=Float32Array.from(Vt.globeMatrix),vi=Float32Array.from(r.cE(Vt)),on=[r.av(Vt.center.lng),r.aC(Vt.center.lat)],ei=z.elevatedGlobePerspectiveTransform,Dn=z.elevatedGlobeGridMatrix||new Float32Array(9);else if(k){let ti=r.cF(Ae.canonical);ar=r.cG(ti.getCenter().lat),gi=Float32Array.from(r.bc(r.cI(Ae.canonical))),Si=Float32Array.from(Vt.globeMatrix),vi=Float32Array.from(r.cE(Vt)),on=[r.av(Vt.center.lng),r.aC(Vt.center.lat)],ei=[0,0],Dn=Float32Array.from(r.cH(Ae.canonical,ti,ar,Vt.worldSize/Vt._pixelsPerMercatorPixel))}else ei=z instanceof r.aK?z.perspectiveTransform:[0,0],gi=new Float32Array(16),Si=new Float32Array(9),vi=new Float32Array(16),on=[0,0],Dn=new Float32Array(9);let Zi=Sv(at,gi,Si,vi,Dn,zt||[0,0],r.ag(m.transform.zoom),on,Ri,Nt||1,mt,c,ei,I?c.paint.get("raster-elevation"):0,2,ut,St,V.range,He,st,G),yr=m.isTileAffectedByFog(Ae),Fi=m.getOrCreateProgram("raster",{defines:V.defines,overrideFog:yr});if(m.uploadCommonUniforms(O,Fi,Oe),z instanceof r.aK){let ti=z.elevatedGlobeVertexBuffer,ln=z.elevatedGlobeIndexBuffer;if(W||!w)z.boundsBuffer&&z.boundsSegments&&Fi.draw(m,F.TRIANGLES,je,Oi.disabled,K,Ti.disabled,Zi,c.id,z.boundsBuffer,m.quadTriangleIndexBuffer,z.boundsSegments);else if(ti&&ln){let Nn=Vt.zoom<=r.c6?z.elevatedGlobeSegments:z.getSegmentsForLongitude(Vt.center.lng);Nn&&Fi.draw(m,F.TRIANGLES,je,Oi.disabled,K,be,Zi,c.id,ti,ln,Nn)}}else if(k){je=new ci(F.LEQUAL,ci.ReadOnly,m.depthRangeFor3D);let ti=m.globeSharedBuffers;if(ti){let[ln,Nn,_n]=ti.getGridBuffers(ar,!1);Fi.draw(m,F.TRIANGLES,je,xe||rt,m.colorModeForRenderPass(),be,Zi,c.id,ln,Nn,_n)}}else{let{tileBoundsBuffer:ti,tileBoundsIndexBuffer:ln,tileBoundsSegments:Nn}=m.getTileBoundsBuffers(Ke);Fi.draw(m,F.TRIANGLES,je,rt,K,Ti.disabled,Zi,c.id,ti,ln,Nn)}}if(!(z instanceof r.aK)&&k)for(let Ae of ve){let Oe=Ae.canonical.y===(1<<Ae.canonical.z)-1;Ae.canonical.y===0&&We(!0,Ae,m,a,c,G,V,be,xe||Oi.disabled),Oe&&We(!1,Ae,m,a,c,G,V,be===Ti.frontCW?Ti.backCW:Ti.frontCW,xe||Oi.disabled)}};k?Se(_e,m.renderElevatedRasterBackface?Ti.backCW:Ti.frontCW,m.stencilModeFor3D()):Se(_e,Ti.disabled,void 0),m.resetStencilClippingMasks()},"raster-particle":function(m,a,c,f,_,b){m.renderPass==="offscreen"&&function(w,I,k,O){if(!O.length)return;let F=w.context,z=F.gl,V=I.getSource();if(!(V instanceof dc))return;let G=Math.ceil(Math.sqrt(k.paint.get("raster-particle-count"))),K=k.particlePositionRGBAImage;if(!K||K.width!==G){let _e=function(me){let Se=me*me,ve=new Uint8Array(4*Se),be=function(Ae){return Ae|=0,Ae=Math.imul(2747636419^Ae,2654435769),Ae=Math.imul(Ae^Ae>>>16,2654435769),((Ae=Math.imul(Ae^Ae>>>16,2654435769))>>>0)/4294967296},xe=1/1.1;for(let Ae=0;Ae<Se;Ae++){let Oe=xe*(be(2*Ae+0)+vs),Ke=xe*(be(2*Ae+1)+vs),$e=255*Oe%1,ct=255*Ke%1,ut=$e,St=Ke-ct/255,He=ct;ve[4*Ae+0]=255*(Oe-$e/255),ve[4*Ae+1]=255*ut,ve[4*Ae+2]=255*St,ve[4*Ae+3]=255*He}return ve}(G);K=k.particlePositionRGBAImage=new r.r({width:G,height:G},_e)}let W=k.particleFramebuffer;W?W.width!==G&&(W.destroy(),W=k.particleFramebuffer=F.createFramebuffer(G,G,!0,null)):W=k.particleFramebuffer=F.createFramebuffer(G,G,!0,null);let te=[];for(let _e of O){let me=I.getTile(_e);if(!(me instanceof ja))continue;let Se=Mw(me,V,k);if(!Se)continue;let ve=[me.tileSize,me.tileSize],be=k.tileFramebuffer;be||(be=k.tileFramebuffer=F.createFramebuffer(ve[0],ve[1],!0,null));let xe=me.rasterParticleState;xe||(xe=me.rasterParticleState=new Fv(F,_e,ve,K));let Ae=xe.update(k.lastInvalidatedAt);xe.particleTextureDimension!==G&&xe.updateParticleTexture(_e,K);let Oe=xe.targetColorTexture;xe.targetColorTexture=xe.backgroundColorTexture,xe.backgroundColorTexture=Oe;let Ke=xe.particleTexture0;xe.particleTexture0=xe.particleTexture1,xe.particleTexture1=Ke,te.push([_e,Se,xe,Ae])}if(te.length===0)return;let ne=r.q.now(),he=k.previousDrawTimestamp?.001*(ne-k.previousDrawTimestamp):.0167;if(k.previousDrawTimestamp=ne,k.hasColorMap()){F.activeTexture.set(z.TEXTURE0+2);let _e=k.colorRampTexture;_e||(_e=k.colorRampTexture=new r.T(F,k.colorRamp,z.RGBA8)),_e.bind(z.LINEAR,z.CLAMP_TO_EDGE)}F.bindFramebuffer.set(k.tileFramebuffer.framebuffer),function(_e,me,Se){let ve=_e.context,be=ve.gl,xe=me.tileFramebuffer;ve.activeTexture.set(be.TEXTURE0);let Ae={u_texture:0,u_opacity:1.05*(Ke=me.paint.get("raster-particle-fade-opacity-factor"))/(Ke+.05)},Oe=_e.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var Ke;for(let $e of Se){let[,,ct,ut]=$e;xe.colorAttachment.set(ct.targetColorTexture.texture),ve.viewport.set([0,0,xe.width,xe.height]),ve.clear({color:r.al.transparent}),ut&&(ct.backgroundColorTexture.bind(be.NEAREST,be.CLAMP_TO_EDGE),Oe.draw(_e,be.TRIANGLES,ci.disabled,Oi.disabled,Ji.alphaBlended,Ti.disabled,Ae,me.id,_e.viewportBuffer,_e.quadTriangleIndexBuffer,_e.viewportSegments))}}(w,k,te),function(_e,me,Se,ve){let be=_e.context,xe=be.gl,Ae=Se.tileFramebuffer,Oe=_e.transform.projection.name==="globe",Ke=Se.paint.get("raster-particle-max-speed");for(let $e of ve){let[ct,ut,St]=$e;be.activeTexture.set(xe.TEXTURE0+0),ut.texture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE),Ae.colorAttachment.set(St.targetColorTexture.texture);let He=_e.getOrCreateProgram("rasterParticleDraw",{defines:ut.defines,overrideFog:!1});be.activeTexture.set(xe.TEXTURE0+1);let st=ut.scalarData?[]:[0,1,2,3].map(rt=>r.d7[rt](ct));st.push(ct);let je=ct.canonical.x,at=ct.canonical.y;for(let rt of st){let ht=me.getTile(Oe?rt.wrapped():rt);if(!ht)continue;let Qe=ht.rasterParticleState;if(!Qe)continue;let mt=rt.canonical.x+(1<<rt.canonical.z)*(rt.wrap-ct.wrap),Nt=rt.canonical.y;Qe.particleTexture0.bind(xe.NEAREST,xe.CLAMP_TO_EDGE);let zt=Dv(1,Qe.particleTexture0.size[0],[mt-je,Nt-at],0,ut.texture.size,2,Ke,ut.textureOffset,ut.scale,ut.offset);He.draw(_e,xe.POINTS,ci.disabled,Oi.disabled,Ji.alphaBlended,Ti.disabled,zt,Se.id,Qe.particleIndexBuffer,void 0,Qe.particleSegment)}}}(w,I,k,te),F.bindFramebuffer.set(k.particleFramebuffer.framebuffer),function(_e,me,Se,ve){let be=_e.context,xe=be.gl,Ae=me.paint.get("raster-particle-max-speed"),Oe=ve*me.paint.get("raster-particle-speed-factor")*.15,Ke=function(ct){return Math.pow(ct,6)}(.01+1*me.paint.get("raster-particle-reset-rate-factor")),$e=me.particleFramebuffer;be.viewport.set([0,0,$e.width,$e.height]);for(let ct of Se){let[,ut,St]=ct;be.activeTexture.set(xe.TEXTURE0+0),ut.texture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE),be.activeTexture.set(xe.TEXTURE0+1);let He=St.particleTexture0;He.bind(xe.NEAREST,xe.CLAMP_TO_EDGE);let st=UM(1,He.size[0],0,ut.texture.size,Ae,Oe,Ke,ut.textureOffset,ut.scale,ut.offset);$e.colorAttachment.set(St.particleTexture1.texture),be.clear({color:r.al.transparent}),_e.getOrCreateProgram("rasterParticleUpdate",{defines:ut.defines}).draw(_e,xe.TRIANGLES,ci.disabled,Oi.disabled,Ji.unblended,Ti.disabled,st,me.id,_e.viewportBuffer,_e.quadTriangleIndexBuffer,_e.viewportSegments)}}(w,k,te,he)}(m,a,c,f),m.renderPass==="translucent"&&(function(w,I,k,O,F){let z=w.context,V=z.gl,G=I.getSource().tileSize,K=5*(1-r.ae(r.bY,r.bY+1,w.transform.zoom))*G+k.paint.get("raster-particle-elevation"),W=!w.options.moving,te=w.transform.projection.name==="globe";if(!O.length)return;let[ne,he]=w.stencilConfigForOverlap(O),_e=[];te&&_e.push("PROJECTION_GLOBE_VIEW");let me=w.stencilModeFor3D();for(let Se of he){let ve=Se.toUnwrapped(),be=I.getTile(Se);if(!be.rasterParticleState)continue;let xe=be.rasterParticleState,Ae=100;be.registerFadeDuration(Ae);let Oe=I.findLoadedParent(Se,0),Ke=hg(be,Oe,I,w.transform,Ae),$e,ct;w.terrain&&w.terrain.prepareDrawTile(),z.activeTexture.set(V.TEXTURE0),xe.targetColorTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),z.activeTexture.set(V.TEXTURE1),Oe&&Oe.rasterParticleState?(Oe.rasterParticleState.targetColorTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),$e=Math.pow(2,Oe.tileID.overscaledZ-be.tileID.overscaledZ),ct=[be.tileID.canonical.x*$e%1,be.tileID.canonical.y*$e%1]):xe.targetColorTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE);let ut=te?Float32Array.from(w.transform.expandedFarZProjMatrix):w.transform.calculateProjMatrix(ve,W),St=w.transform,He=Tw(St),st=r.cF(Se.canonical),je=r.cG(st.getCenter().lat),at,rt,ht,Qe,mt;te?(at=Float32Array.from(r.bc(r.cI(Se.canonical))),rt=Float32Array.from(St.globeMatrix),ht=Float32Array.from(r.cE(St)),Qe=[r.av(St.center.lng),r.aC(St.center.lat)],mt=Float32Array.from(r.cH(Se.canonical,st,je,St.worldSize/St._pixelsPerMercatorPixel))):(at=new Float32Array(16),rt=new Float32Array(9),ht=new Float32Array(16),Qe=[0,0],mt=new Float32Array(9));let Nt=fi(ut,at,rt,ht,mt,ct||[0,0],r.ag(w.transform.zoom),Qe,He,$e||1,Ke,K),zt=w.isTileAffectedByFog(Se),Vt=w.getOrCreateProgram("rasterParticle",{defines:_e,overrideFog:zt});if(w.uploadCommonUniforms(z,Vt,ve),te){let ei=new ci(V.LEQUAL,ci.ReadOnly,w.depthRangeFor3D),Ri=0,gi=w.globeSharedBuffers;if(gi){let[Si,vi,on]=gi.getGridBuffers(je,Ri!==0);Vt.draw(w,V.TRIANGLES,ei,me,Ji.alphaBlended,w.renderElevatedRasterBackface?Ti.frontCCW:Ti.backCCW,Nt,k.id,Si,vi,on)}}else{let ei=w.depthModeForSublayer(0,ci.ReadOnly),Ri=ne[Se.overscaledZ],{tileBoundsBuffer:gi,tileBoundsIndexBuffer:Si,tileBoundsSegments:vi}=w.getTileBoundsBuffers(be);Vt.draw(w,V.TRIANGLES,ei,Ri,Ji.alphaBlended,Ti.disabled,Nt,k.id,gi,Si,vi)}}w.resetStencilClippingMasks()}(m,a,c,f),m.style.map.triggerRepaint())},background:function(m,a,c,f){let _=c.paint.get("background-color"),b=c.paint.get("background-color-use-theme").constantOr("default")==="none",w=c.paint.get("background-opacity"),I=c.paint.get("background-emissive-strength"),k=c.paint.get("background-pitch-alignment")==="viewport";if(w===0)return;let O=m.context,F=O.gl,z=m.transform,V=z.tileSize,G=c.paint.get("background-pattern"),K;if(G!==void 0&&(G===null||(K=m.imageManager.getPattern(r.I.from(G.toString()),c.scope,m.style.getLut(c.scope)),!K)))return;let W=!G&&_.a===1&&w===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==W)return;let te=Oi.disabled,ne=m.depthModeForSublayer(0,W==="opaque"?ci.ReadWrite:ci.ReadOnly),he=m.colorModeForDrapableLayerRenderPass(I),_e=G?"backgroundPattern":"background",me,Se=f;if(Se||(me=m.getBackgroundTiles(),Se=Object.values(me).map(ve=>ve.tileID)),G&&(O.activeTexture.set(F.TEXTURE0),m.imageManager.bind(m.context,c.scope)),k){let ve=m.getOrCreateProgram(_e,{overrideFog:!1,overrideRtt:!0}),be=new Float32Array(r.ad.mat4.identity([])),xe=new r.aH(0,0,0,0,0),Ae=G?Cw(be,I,w,m,0,c.scope,K,k,{tileID:xe,tileSize:V}):Mv(be,I,w,_.toRenderColor(b?null:c.lut));ve.draw(m,F.TRIANGLES,ne,te,he,Ti.disabled,Ae,c.id,m.viewportBuffer,m.quadTriangleIndexBuffer,m.viewportSegments)}else for(let ve of Se){let be=m.isTileAffectedByFog(ve),xe=m.getOrCreateProgram(_e,{overrideFog:be}),Ae=ve.toUnwrapped(),Oe=f?ve.projMatrix:m.transform.calculateProjMatrix(Ae);m.prepareDrawTile();let Ke=a?a.getTile(ve):me?me[ve.key]:new hl(ve,V,z.zoom,m),$e=G?Cw(Oe,I,w,m,0,c.scope,K,k,{tileID:ve,tileSize:V}):Mv(Oe,I,w,_.toRenderColor(b?null:c.lut));m.uploadCommonUniforms(O,xe,Ae);let{tileBoundsBuffer:ct,tileBoundsIndexBuffer:ut,tileBoundsSegments:St}=m.getTileBoundsBuffers(Ke);xe.draw(m,F.TRIANGLES,ne,te,he,Ti.disabled,$e,c.id,ct,ut,St)}},sky:function(m,a,c){let f=m._atmosphere?r.ag(m.transform.zoom):1,_=c.paint.get("sky-opacity")*f;if(_===0)return;let b=m.context,w=c.paint.get("sky-type"),I=new ci(b.gl.LEQUAL,ci.ReadOnly,[0,1]),k=m.frameCounter/1e3%1;w==="atmosphere"?m.renderPass==="offscreen"?c.needsSkyboxCapture(m)&&(function(O,F,z,V){let G=O.context,K=G.gl,W=F.skyboxFbo;if(!W){W=F.skyboxFbo=G.createFramebuffer(32,32,!0,null),F.skyboxGeometry=new Aw(G),F.skyboxTexture=G.gl.createTexture(),K.bindTexture(K.TEXTURE_CUBE_MAP,F.skyboxTexture),K.texParameteri(K.TEXTURE_CUBE_MAP,K.TEXTURE_WRAP_S,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_CUBE_MAP,K.TEXTURE_WRAP_T,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_CUBE_MAP,K.TEXTURE_MIN_FILTER,K.LINEAR),K.texParameteri(K.TEXTURE_CUBE_MAP,K.TEXTURE_MAG_FILTER,K.LINEAR);for(let _e=0;_e<6;++_e)K.texImage2D(K.TEXTURE_CUBE_MAP_POSITIVE_X+_e,0,K.RGBA,32,32,0,K.RGBA,K.UNSIGNED_BYTE,null)}G.bindFramebuffer.set(W.framebuffer),G.viewport.set([0,0,32,32]);let te=F.getCenter(O,!0),ne=O.getOrCreateProgram("skyboxCapture"),he=new Float64Array(16);r.ad.mat4.identity(he),r.ad.mat4.rotateY(he,he,.5*-Math.PI),Po(O,F,ne,he,te,0),r.ad.mat4.identity(he),r.ad.mat4.rotateY(he,he,.5*Math.PI),Po(O,F,ne,he,te,1),r.ad.mat4.identity(he),r.ad.mat4.rotateX(he,he,.5*-Math.PI),Po(O,F,ne,he,te,2),r.ad.mat4.identity(he),r.ad.mat4.rotateX(he,he,.5*Math.PI),Po(O,F,ne,he,te,3),r.ad.mat4.identity(he),Po(O,F,ne,he,te,4),r.ad.mat4.identity(he),r.ad.mat4.rotateY(he,he,Math.PI),Po(O,F,ne,he,te,5),G.viewport.set([0,0,O.width,O.height])}(m,c),c.markSkyboxValid(m)):m.renderPass==="sky"&&function(O,F,z,V,G){let K=O.context,W=K.gl,te=O.transform,ne=O.getOrCreateProgram("skybox");K.activeTexture.set(W.TEXTURE0),W.bindTexture(W.TEXTURE_CUBE_MAP,F.skyboxTexture);let he=((_e,me,Se,ve,be)=>({u_matrix:_e,u_sun_direction:me,u_cubemap:0,u_opacity:ve,u_temporal_offset:be}))(te.skyboxMatrix,F.getCenter(O,!1),0,V,G);O.uploadCommonUniforms(K,ne),ne.draw(O,W.TRIANGLES,z,Oi.disabled,O.colorModeForRenderPass(),Ti.backCW,he,"skybox",F.skyboxGeometry.vertexBuffer,F.skyboxGeometry.indexBuffer,F.skyboxGeometry.segment)}(m,c,I,_,k):w==="gradient"&&m.renderPass==="sky"&&function(O,F,z,V,G){let K=O.context,W=K.gl,te=O.transform,ne=O.getOrCreateProgram("skyboxGradient");F.skyboxGeometry||(F.skyboxGeometry=new Aw(K)),K.activeTexture.set(W.TEXTURE0);let he=F.colorRampTexture;he||(he=F.colorRampTexture=new r.T(K,F.colorRamp,W.RGBA8)),he.bind(W.LINEAR,W.CLAMP_TO_EDGE);let _e=((me,Se,ve,be,xe)=>({u_matrix:me,u_color_ramp:0,u_center_direction:Se,u_radius:r.ak(ve),u_opacity:be,u_temporal_offset:xe}))(te.skyboxMatrix,F.getCenter(O,!1),F.paint.get("sky-gradient-radius"),V,G);O.uploadCommonUniforms(K,ne),ne.draw(O,W.TRIANGLES,z,Oi.disabled,O.colorModeForRenderPass(),Ti.backCW,_e,"skyboxGradient",F.skyboxGeometry.vertexBuffer,F.skyboxGeometry.indexBuffer,F.skyboxGeometry.segment)}(m,c,I,_,k)},debug:function(m,a,c,f,_,b){for(let w=0;w<c.length;w++)if(_){let O=new r.al(f.r*.8,f.g*.8,f.b*.8,1);hd(m,a,c[w],f,-1,-1,b),hd(m,a,c[w],f,-1,1,b),hd(m,a,c[w],f,1,1,b),hd(m,a,c[w],f,1,-1,b),hd(m,a,c[w],O,0,0,b)}else hd(m,a,c[w],f,0,0,b)},custom:function(m,a,c,f){let _=m.context,b=c.implementation;if(!m.transform.projection.unsupportedLayers||!m.transform.projection.unsupportedLayers.includes("custom")||m.terrain&&(m.terrain.renderingToTexture||m.renderPass==="offscreen")&&c.isDraped(a)){if(m.renderPass==="offscreen"){let w=b.prerender;if(w){if(m.setCustomLayerDefaults(),_.setColorMode(m.colorModeForRenderPass()),m.transform.projection.name==="globe"){let I=m.transform.pointMerc;w.call(b,_.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),r.ag(m.transform.zoom),[I.x,I.y],m.transform.pixelsPerMeterRatio)}else w.call(b,_.gl,m.transform.customLayerMatrix());_.setDirty(),m.setBaseState()}}else if(m.renderPass==="translucent"){if(m.terrain&&m.terrain.renderingToTexture){let I=b.renderToTile;if(I){let k=f[0].canonical,O=new r.ac(k.x+f[0].wrap*(1<<k.z),k.y,k.z);_.setDepthMode(ci.disabled),_.setStencilMode(Oi.disabled),_.setColorMode(m.colorModeForRenderPass()),m.setCustomLayerDefaults(),I.call(b,_.gl,O),_.setDirty(),m.setBaseState()}return}m.setCustomLayerDefaults(),_.setColorMode(m.colorModeForRenderPass()),_.setStencilMode(Oi.disabled);let w=b.renderingMode==="3d"?new ci(m.context.gl.LEQUAL,ci.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,ci.ReadOnly);if(_.setDepthMode(w),m.transform.projection.name==="globe"){let I=m.transform.pointMerc;b.render(_.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),r.ag(m.transform.zoom),[I.x,I.y],m.transform.pixelsPerMeterRatio)}else b.render(_.gl,m.transform.customLayerMatrix());_.setDirty(),m.setBaseState(),_.bindFramebuffer.set(null)}}else r.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(m,a,c,f){if(m.renderPass==="opaque")return;let _=c.paint.get("model-opacity").constantOr(1);if(_===0)return;let b=c.paint.get("model-cast-shadows");if(m.renderPass==="shadow"&&(!b||m.terrain&&_<.65&&c._transitionablePaint._values["model-opacity"].value.expression instanceof r.ab))return;let w=m.shadowRenderer,I=c.paint.get("model-receive-shadows");w&&(w.useNormalOffset=!0,I||(w.enabled=!1));let k=()=>{w&&(w.useNormalOffset=!0,I||(w.enabled=!0))},O=a.getSource();if(m.renderPass==="light-beam"&&O.type!=="batched-model")return;if(O.type==="vector"||O.type==="geojson")return function(ne,he,_e,me,Se){let ve=ne.transform;if(ve.projection.name!=="mercator")return void r.w(`Drawing 3D models for ${ve.projection.name} projection is not yet implemented`);let be=ve.getFreeCameraOptions().position;if(!ne.modelManager)return;let xe=ne.modelManager;_e.modelManager=xe;let Ae=ne.shadowRenderer;if(!_e._unevaluatedLayout._values.hasOwnProperty("model-id"))return;let Oe=_e._unevaluatedLayout._values["model-id"],Ke=Object.assign({},_e.layout.get("model-id").parameters),$e=ne.style.order.indexOf(_e.fqid);for(let ct of me){let ut=he.getTile(ct).getBucket(_e);if(!ut||ut.projection.name!==ve.projection.name)continue;let St=ut.getModelUris();St&&!ut.modelsRequested&&(xe.addModelsFromBucket(St,Se),ut.modelsRequested=!0);let He=Bv(ct,ve);Ke.zoom=He;let st=Oe.possiblyEvaluate(Ke);if(zv(ne,ut,ct),js.shadowUniformsInitialized=!1,js.useSingleShadowCascade=!!Ae&&Ae.getMaxCascadeForTile(ct.toUnwrapped())===0,ne.renderPass==="shadow"&&Ae){if(ne.currentShadowCascade===1&&ut.isInsideFirstShadowMapFrustum)continue;let rt=ve.calculatePosMatrix(ct.toUnwrapped(),ve.worldSize);if(js.tileMatrix.set(rt),js.shadowTileMatrix=Float32Array.from(Ae.calculateShadowPassMatrixFromMatrix(rt)),js.aabb.min.fill(0),js.aabb.max[0]=js.aabb.max[1]=r.ai,js.aabb.max[2]=0,Tg(ut,js,ne,_e.scope))continue}let je=1<<ct.canonical.z,at=[((be.x-ct.wrap)*je-ct.canonical.x)*r.ai,(be.y*je-ct.canonical.y)*r.ai,be.z*je*r.ai];ne.conflationActive&&Object.keys(ut.instancesPerModel).length>0&&ne.style.isLayerClipped(_e,he.getSource())&&ut.updateReplacement(ct,ne.replacementSource,$e,Se)&&(ut.uploaded=!1,ut.upload(ne.context));for(let rt in ut.instancesPerModel){let ht=ut.instancesPerModel[rt];ht.features.length>0&&(rt=st.evaluate(ht.features[0].feature,{}));let Qe=xe.getModel(rt,Se);if(Qe&&Qe.uploaded)for(let mt of Qe.nodes)gl(ne,_e,mt,ht,at,ct,js)}}}(m,a,c,f,O.type==="vector"?c.scope:""),void k();if(!O.loaded())return;if(O.type==="batched-model")return function(ne,he,_e,me){_e.resetLayerRenderingStats(ne);let Se=ne.context,ve=ne.transform,be=ne.style.fog,xe=ne.shadowRenderer;if(ve.projection.name!=="mercator")return void r.w(`Drawing 3D landmark models for ${ve.projection.name} projection is not yet implemented`);let Ae=ne.transform.getFreeCameraOptions().position,Oe=r.ad.vec3.scale([],[Ae.x,Ae.y,Ae.z],ne.transform.worldSize),Ke=r.ad.vec3.negate([],Oe),$e=r.ad.mat4.identity([]),ct=r.dm(ve.center.lat,ve.zoom),ut=r.ad.mat4.fromScaling([],[1,1,1/ct]);r.ad.mat4.translate($e,$e,Ke);let St=_e.paint.get("model-opacity").constantOr(1),He=new ci(Se.gl.LEQUAL,ci.ReadWrite,ne.depthRangeFor3D),st=new ci(Se.gl.LEQUAL,ci.ReadOnly,ne.depthRangeFor3D),je=new r.ce([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),at=ne.renderPass==="shadow",rt=at&&xe?xe.getCurrentCascadeFrustum():ve.getFrustum(ve.scaleZoom(ve.worldSize)),ht=_e.paint.get("model-front-cutoff"),Qe=ht[2]<1,mt=_c(ne,_e.paint.get("model-cutoff-fade-range")),Nt=_e.getLayerRenderingStats();(function(zt,Vt,ei,Ri){let gi=zt.terrain?zt.terrain.exaggeration():0,Si=zt.transform.zoom;for(let vi of Ri){let on=Vt.getTile(vi).getBucket(ei);on&&(on.setFilter(ei.filter),zt.conflationActive&&on.updateReplacement(vi,zt.replacementSource),on.evaluateScale(zt,ei),zt.terrain&&gi>0&&on.elevationUpdate(zt.terrain,gi,vi,ei.source),on.needsReEvaluation(zt,Si,ei)&&on.evaluate(ei))}})(ne,he,_e,me),function(){let zt,Vt,ei;Qe?(zt=me.length-1,Vt=-1,ei=-1):(zt=0,Vt=me.length,ei=1);let Ri=new Float64Array(16),gi=r.ad.vec3.create(),Si=new r.P(0,0);for(let vi=zt;vi!==Vt;vi+=ei){let on=me[vi],Dn=he.getTile(on).getBucket(_e);if(!Dn||!Dn.uploaded)continue;let ar=!1;xe&&(ar=xe.getMaxCascadeForTile(on.toUnwrapped())===0);let Zi=ve.calculatePosMatrix(on.toUnwrapped(),ve.worldSize),yr=Dn.modelTraits;!at&&Qe&&(r.ad.mat4.invert(Ri,Zi),r.ad.vec3.transformMat4(gi,Oe,Ri),Si.x=gi[0],Si.y=gi[1]);let Fi=[];Dn.setFilter(_e.filter);for(let ti of Dn.getNodesInfo()){if(ti.hiddenByReplacement||!ti.node.meshes)continue;let ln=ti.node,Nn=0;ne.terrain&&ln.elevation&&(Nn=ln.elevation*ne.terrain.exaggeration());let _n=(()=>{let Qn=ti.aabb;return je.min=[...Qn.min],je.max=[...Qn.max],je.min[2]+=Nn,je.max[2]+=Nn,r.ad.vec3.transformMat4(je.min,je.min,Zi),r.ad.vec3.transformMat4(je.max,je.max,Zi),je})(),Ar=ti.evaluatedScale;if(Ar[0]<=1&&Ar[1]<=1&&Ar[2]<=1&&_n.intersects(rt)===0)continue;if(!at&&Qe){let Qn=.16666666666666666;ti.cameraCollisionOpacity=Oe[0]>_n.min[0]&&Oe[0]<_n.max[0]&&Oe[1]>_n.min[1]&&Oe[1]<_n.max[1]&&Oe[2]*ct<_n.max[2]&&ln.footprint&&r.bA(Si,ln.footprint)?Math.max(ti.cameraCollisionOpacity-Qn,0):Math.min(1,ti.cameraCollisionOpacity+Qn)}let Kr=[...Zi],po=ln.anchor?ln.anchor[0]:0,Co=ln.anchor?ln.anchor[1]:0;r.ad.mat4.translate(Kr,Kr,[po*(Ar[0]-1),Co*(Ar[1]-1),Nn]),r.ad.vec3.exactEquals(Ar,r.dq)||r.ad.mat4.scale(Kr,Kr,Ar);let ws=r.ad.mat4.multiply([],Kr,ln.matrix),xa=r.ad.mat4.multiply([],ve.expandedFarZProjMatrix,ws),hn=r.ad.mat4.multiply([],ve.expandedFarZProjMatrix,Kr),vr=r.ad.vec4.transformMat4([],[po,Co,Nn,1],xa)[2];ln.hidden=!1;let Mn=St;at||(Qe&&(Mn*=ti.cameraCollisionOpacity,Mn*=Vv(Kr,ve,ti.aabb,ht)),Mn*=Ig(mt,vr)),Mn!==0?Fi.push({nodeInfo:ti,depth:vr,opacity:Mn,wvpForNode:xa,wvpForTile:hn,nodeModelMatrix:ws,tileModelMatrix:Kr}):ln.hidden=!0}at||Fi.sort((ti,ln)=>!Qe||ti.opacity===1&&ln.opacity===1?ti.depth<ln.depth?-1:1:ti.opacity===1?-1:ln.opacity===1?1:ti.depth>ln.depth?-1:1);for(let ti of Fi){let ln=ti.nodeInfo,Nn=ln.node,_n=r.ad.mat4.multiply([],ut,ti.tileModelMatrix);r.ad.mat4.multiply(_n,$e,_n);let Ar=r.ad.mat4.invert([],_n);r.ad.mat4.transpose(Ar,Ar),r.ad.mat4.scale(Ar,Ar,pd),_n=r.ad.mat4.multiply(_n,_n,Nn.matrix);let Kr=ne.renderPass==="light-beam",po=_e.paint.get("model-color-use-theme").constantOr("default")==="none",Co=yr&r.ds.HasMapboxMeshFeatures,ws=Co?0:ln.evaluatedRMEA[0][2];for(let xa=0;xa<Nn.meshes.length;++xa){let hn=Nn.meshes[xa],vr=xa===Nn.lightMeshIndex,Mn=ti.wvpForNode;if(vr){if(!Kr&&!ne.terrain&&ne.shadowRenderer){ne.currentLayer<ne.firstLightBeamLayer&&(ne.firstLightBeamLayer=ne.currentLayer);continue}Mn=ti.wvpForTile}else if(Kr)continue;let Qn={defines:[]},$o=[];if(!at&&xe&&(xe.useNormalOffset=!!hn.normalBuffer),Mh(Qn.defines,$o,hn,ne,po?null:_e.lut),Co||Qn.defines.push("DIFFUSE_SHADED"),ar&&Qn.defines.push("SHADOWS_SINGLE_CASCADE"),Nt&&(at?Nt.numRenderedVerticesInShadowPass+=hn.vertexArray.length:Nt.numRenderedVerticesInTransparentPass+=hn.vertexArray.length),at){bf(hn,ti.nodeModelMatrix,ne,_e);continue}let hr=null;if(be){let $s=wc(ti.nodeModelMatrix,ne.transform);if(hr=new Float32Array($s),ve.projection.name!=="globe"){let is=hn.aabb.min,Sc=hn.aabb.max,[zl,Dc]=be.getOpacityForBounds($s,is[0],is[1],Sc[0],Sc[1]);Qn.overrideFog=zl>=Ut||Dc>=Ut}}let fo=hn.material,Nl;fo.occlusionTexture&&fo.occlusionTexture.offsetScale&&(Nl=fo.occlusionTexture.offsetScale,Qn.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));let ts=ne.getOrCreateProgram("model",Qn);!at&&xe&&xe.setupShadowsFromMatrix(ti.tileModelMatrix,ts,xe.useNormalOffset),ne.uploadCommonUniforms(Se,ts,null,hr);let Hs=fo.pbrMetallicRoughness;Hs.metallicFactor=.9,Hs.roughnessFactor=.5;let Ha=Tv(new Float32Array(Mn),new Float32Array(_n),new Float32Array(Ar),new Float32Array(Nn.matrix),ne,ti.opacity,Hs.baseColorFactor.toRenderColor(null),fo.emissiveFactor,Hs.metallicFactor,Hs.roughnessFactor,fo,ws,_e,[0,0,0],Nl);!vr&&(ln.hasTranslucentParts||ti.opacity<1)&&ts.draw(ne,Se.gl.TRIANGLES,He,Oi.disabled,Ji.disabled,Ti.backCCW,Ha,_e.id,hn.vertexBuffer,hn.indexBuffer,hn.segments,_e.paint,ne.transform.zoom,void 0,$o),ts.draw(ne,Se.gl.TRIANGLES,vr?st:He,Oi.disabled,vr||ti.opacity<1||ln.hasTranslucentParts?Ji.alphaBlended:Ji.unblended,Ti.backCCW,Ha,_e.id,hn.vertexBuffer,hn.indexBuffer,hn.segments,_e.paint,ne.transform.zoom,void 0,$o)}}}}()}(m,a,c,f),void k();if(O.type!=="model")return;let F=O.getModels(),z=[],V=m.transform.getFreeCameraOptions().position,G=r.ad.vec3.scale([],[V.x,V.y,V.z],m.transform.worldSize);r.ad.vec3.negate(G,G);let K=[],W=[],te=0;for(let ne of F){let he=c.paint.get("model-rotation").constantOr(null),_e=c.paint.get("model-scale").constantOr(null),me=c.paint.get("model-translation").constantOr(null);ne.computeModelMatrix(m,he,_e,me,!0,!0,!1);let Se=r.ad.mat4.identity([]),ve=r.dm(ne.position.lat,m.transform.zoom),be=r.ad.mat4.fromScaling([],[1,1,1/ve]);r.ad.mat4.translate(Se,Se,G),z.push({zScaleMatrix:be,negCameraPosMatrix:Se});for(let xe of ne.nodes)su(m.transform,xe,ne.matrix,m.transform.expandedFarZProjMatrix,te,K,W);te++}if(K.sort((ne,he)=>he.depth-ne.depth),m.renderPass!=="shadow"){if(_===1)for(let ne of W)Cc(ne,m,c,z[ne.modelIndex],Oi.disabled,m.colorModeForRenderPass());else{for(let ne of W)Cc(ne,m,c,z[ne.modelIndex],Oi.disabled,Ji.disabled);for(let ne of W)Cc(ne,m,c,z[ne.modelIndex],m.stencilModeFor3D(),m.colorModeForRenderPass());m.resetStencilClippingMasks()}for(let ne of K)Cc(ne,m,c,z[ne.modelIndex],Oi.disabled,m.colorModeForRenderPass());k()}else{for(let ne of W)bf(ne.mesh,ne.nodeModelMatrix,m,c);for(let ne of K)bf(ne.mesh,ne.nodeModelMatrix,m,c);k()}}},Pg={line:function(m,a,c){if(m.hasElevatedBuckets=!1,m.hasNonElevatedBuckets=!1,m._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||m._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(a){let f=a.getVisibleCoordinates();for(let _ of f){let b=a.getTile(_).getBucket(m);if(b&&(b.hasZOffset?m.hasElevatedBuckets=!0:m.hasNonElevatedBuckets=!0,m.hasElevatedBuckets&&m.hasNonElevatedBuckets))break}}}else m.hasNonElevatedBuckets=!0},model:function(m,a,c){let f=a.getSource();if(!f.loaded())return;if(f.type==="vector"||f.type==="geojson")return void(c.modelManager&&c.modelManager.upload(c,f.type==="vector"?m.scope:""));if(f.type==="batched-model"||f.type!=="model")return;let _=f.getModels();for(let b of _)b.upload(c.context)},raster:function(m,a,c){let f=a.getSource();if(!(f instanceof dc&&f.loaded()))return;let _=m.sourceLayer||f.rasterLayerIds&&f.rasterLayerIds[0];if(!_)return;let b=m.paint.get("raster-array-band")||f.getInitialBand(_);if(b==null)return;let w=a.getIds().map(I=>a.getTileByID(I));for(let I of w)I.updateNeeded(_,b)&&f.prepareTile(I,_,b)},"raster-particle":function(m,a,c){let f=a.getSource();if(!(f instanceof dc&&f.loaded()))return;let _=m.sourceLayer||f.rasterLayerIds&&f.rasterLayerIds[0];if(!_)return;let b=m.paint.get("raster-particle-array-band")||f.getInitialBand(_);if(b==null)return;let w=a.getIds().map(I=>a.getTileByID(I));for(let I of w)I.updateNeeded(_,b)&&f.prepareTile(I,_,b)}},Og={fill:Pv};class Fg{constructor(a,c,f,_,b){this.context=new ud(a,c),this.transform=f,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=b,this._timeStamp=r.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};let w=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(let k of w)this._debugParams.enabledLayers[k]=!0;b.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),b.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),b.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),b.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),b.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),b.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(let k of w)b.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],k);this.occlusionParams=new Uv(b),this.setup(),this.numSublayers=Ns.maxUnderzooming+Ns.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new r.dy,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new yc(this),this._wireframeDebugCache=new lu,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];let I=new r.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new r.T(this.context,I,a.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=_}updateTerrain(a,c){let f=!!a&&!!a.terrain&&this.transform.projection.supportsTerrain;if(!(f||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new _w(this,a));let _=this._terrain;this.transform.elevation=f?_:null,_.update(a,this.transform,c),this.transform.elevation&&!_.enabled&&(this.transform.elevation=null)}_updateFog(a){let c=a.fog;if(!c||this.transform.projection.name==="globe"||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);let[f,_]=c.getFovAdjustedRange(this.transform._fov);if(f>_)return void(this.transform.fogCullDistSq=null);let b=f+.78*(_-f);this.transform.fogCullDistSq=b*b}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(a){a&&!this._terrain&&(this._terrain=new _w(this,this.style)),this._forceTerrainMode=a}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(a,c){if(this.width=a*r.q.devicePixelRatio,this.height=c*r.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let f of this.style.order)this.style._mergedLayers[f].resize()}setup(){let a=this.context,c=new r.b5;c.emplaceBack(0,0),c.emplaceBack(r.ai,0),c.emplaceBack(0,r.ai),c.emplaceBack(r.ai,r.ai),this.tileExtentBuffer=a.createVertexBuffer(c,r.b7.members),this.tileExtentSegments=r.b8.simpleSegment(0,0,4,2);let f=new r.b5;f.emplaceBack(0,0),f.emplaceBack(r.ai,0),f.emplaceBack(0,r.ai),f.emplaceBack(r.ai,r.ai),this.debugBuffer=a.createVertexBuffer(f,r.b7.members),this.debugSegments=r.b8.simpleSegment(0,0,4,5);let _=new r.b5;_.emplaceBack(-1,-1),_.emplaceBack(1,-1),_.emplaceBack(-1,1),_.emplaceBack(1,1),this.viewportBuffer=a.createVertexBuffer(_,r.b7.members),this.viewportSegments=r.b8.simpleSegment(0,0,4,2);let b=new r.aU;b.emplaceBack(0,0,0,0),b.emplaceBack(r.ai,0,r.ai,0),b.emplaceBack(0,r.ai,0,r.ai),b.emplaceBack(r.ai,r.ai,r.ai,r.ai),this.mercatorBoundsBuffer=a.createVertexBuffer(b,r.ba.members),this.mercatorBoundsSegments=r.b8.simpleSegment(0,0,4,2);let w=new r.aV;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=a.createIndexBuffer(w);let I=new r.b6;for(let O of[0,1,3,2,0])I.emplaceBack(O);this.debugIndexBuffer=a.createIndexBuffer(I),this.emptyTexture=new r.T(a,new r.r({width:1,height:1},Uint8Array.of(0,0,0,0)),a.gl.RGBA8),this.identityMat=r.ad.mat4.create();let k=this.context.gl;this.stencilClearMode=new Oi({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(a){return a._makeTileBoundsBuffers(this.context,this.transform.projection),a._tileBoundsBuffer?{tileBoundsBuffer:a._tileBoundsBuffer,tileBoundsIndexBuffer:a._tileBoundsIndexBuffer,tileBoundsSegments:a._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){let a=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,a.TRIANGLES,ci.disabled,this.stencilClearMode,Ji.disabled,Ti.disabled,mh(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(a,c,f){if(!c||this.currentStencilSource===c.id||!a.isTileClipped()||!f||f.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let I=!1;for(let k of f)if(this._tileClippingMaskIDs[k.key]===void 0){I=!0;break}if(!I)return}this.currentStencilSource=c.id;let _=this.context,b=_.gl;this.nextStencilID+f.length>256&&this.clearStencil(),_.setColorMode(Ji.disabled),_.setDepthMode(ci.disabled);let w=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(let I of f){let k=c.getTile(I),O=this._tileClippingMaskIDs[I.key]=this.nextStencilID++,{tileBoundsBuffer:F,tileBoundsIndexBuffer:z,tileBoundsSegments:V}=this.getTileBoundsBuffers(k);w.draw(this,b.TRIANGLES,ci.disabled,new Oi({func:b.ALWAYS,mask:0},O,255,b.KEEP,b.KEEP,b.REPLACE),Ji.disabled,Ti.disabled,mh(I.projMatrix),"$clipping",F,z,V)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let a=this.nextStencilID++,c=this.context.gl;return new Oi({func:c.NOTEQUAL,mask:255},a,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(a){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(a);let c=this.context.gl;return new Oi({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(a){let c=this.context.gl,f=a.sort((w,I)=>I.overscaledZ-w.overscaledZ),_=f[f.length-1].overscaledZ,b=f[0].overscaledZ-_+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();let w={};for(let I=0;I<b;I++)w[I+_]=new Oi({func:c.GEQUAL,mask:255},I+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=b,[w,f]}return[{[_]:Oi.disabled},f]}colorModeForRenderPass(){let a=this.context.gl;return this._showOverdrawInspector?new Ji([a.CONSTANT_COLOR,a.ONE,a.CONSTANT_COLOR,a.ONE],new r.al(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ji.unblended:Ji.alphaBlended}colorModeForDrapableLayerRenderPass(a){let c=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Ji([c.ONE,c.ONE_MINUS_SRC_ALPHA,c.CONSTANT_ALPHA,c.ONE_MINUS_SRC_ALPHA],new r.al(0,0,0,a===void 0?0:a),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(a,c,f,_=!1){if(this.depthOcclusion)return new ci(this.context.gl.GREATER,ci.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!_)return ci.disabled;let b=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new ci(f||this.context.gl.LEQUAL,c,[b,b])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){let a=this.context.gl,c=Math.ceil(this.width),f=Math.ceil(this.height),_=this.context.bindFramebuffer.get(),b=a.getParameter(a.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===c&&this.depthFBO.height===f||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),c!==0&&f!==0&&(this.depthFBO=new Ua(this.context,c,f,!1,"texture"),this.depthTexture=new r.T(this.context,{width:c,height:f,data:null},a.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(_),a.bindTexture(a.TEXTURE_2D,b),this.depthFBO&&(a.bindFramebuffer(a.READ_FRAMEBUFFER,null),a.bindFramebuffer(a.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),a.blitFramebuffer(0,0,c,f,0,0,c,f,a.DEPTH_BUFFER_BIT,a.NEAREST),a.bindFramebuffer(a.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((a,c)=>a+c/this._fpsHistory.length,0))}render(a,c){let f=r.q.now();this._dt=f-this._timeStamp,this._timeStamp=f,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=a.map.repaint,this.style=a,this.options=c;let _=this.style._mergedLayers,b=!(!this.terrain||!this.terrain.enabled),w=()=>this.style._getOrder(b).filter(He=>{let st=_[He];return!(st.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[st.type]}),I=w(),k=!1,O=!1;for(let He of I){let st=_[He];st.type==="circle"&&(k=!0),st.type==="symbol"&&(st.hasInitialOcclusionOpacityProperties?O=!0:k=!0)}let F=I.map(He=>_[He]),z=this.style._mergedSourceCaches;this.imageManager=a.imageManager,this.modelManager=a.modelManager,this.symbolFadeChange=a.placement.symbolFadeChange(r.q.now()),this.imageManager.beginFrame();let V=0,G=!1;for(let He in z){let st=z[He];st.used&&(st.prepare(this.context),st.getSource().usedInConflation&&++V)}let K=!1;for(let He of F)He.isHidden(this.transform.zoom)||(He.type==="clip"&&(K=!0),this.prepareLayer(He));let W={},te={},ne={},he={},_e={};for(let He in z){let st=z[He];W[He]=st.getVisibleCoordinates(),te[He]=W[He].slice().reverse(),ne[He]=st.getVisibleCoordinates(!0).reverse(),he[He]=st.getShadowCasterCoordinates(),_e[He]=st.sortCoordinatesByDistance(W[He])}let me=He=>{let st=this.style.getLayerSourceCache(He);return st&&st.used?st.getSource():null};if(V||K||this._clippingActiveLastFrame){let He=[],st=[],je=0;for(let at of F)this.isSourceForClippingOrConflation(at,me(at))&&(He.push(at),st.push(je)),je++;if(He&&(K||He.length>1)||this._clippingActiveLastFrame){K=!1;let at=[];for(let rt=0;rt<He.length;rt++){let ht=He[rt],Qe=st[rt],mt=this.style.getLayerSourceCache(ht);if(!mt||!mt.used||!mt.getSource().usedInConflation&&ht.type!=="clip")continue;let Nt=r.dA,zt=r.by.None,Vt=[],ei=!0;if(ht.type==="clip"){Nt=Qe;for(let Ri of ht.layout.get("clip-layer-types"))zt|=Ri==="model"?r.by.Model:Ri==="symbol"?r.by.Symbol:r.by.FillExtrusion;for(let Ri of ht.layout.get("clip-layer-scope"))Vt.push(Ri);ht.isHidden(this.transform.zoom)?ei=!1:K=!0}ei&&at.push({layer:ht.fqid,cache:mt,order:Nt,clipMask:zt,clipScope:Vt})}this.replacementSource.setSources(at),G=!0}}this._clippingActiveLastFrame=K,G||this.replacementSource.clear(),this.conflationActive=G,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let He=0;He<F.length;He++){let st=F[He],je=st.cutoffRange();if(this.longestCutoffRange=Math.max(je,this.longestCutoffRange),je>0){let at=me(st);at&&(this.minCutoffZoom=Math.max(at.minzoom,this.minCutoffZoom)),st.minzoom&&(this.minCutoffZoom=Math.max(st.minzoom,this.minCutoffZoom))}st.is3D(b)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=He),this._lastOcclusionLayer=He)}let Se=this.style&&this.style.fog;Se?(this._fogVisible=Se.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Se.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(ne),this.opaquePassCutoff=0,I=w(),F=I.map(He=>_[He]));let ve=this._shadowRenderer;if(ve){ve.updateShadowParameters(this.transform,this.style.directionalLight);for(let He in z)for(let st of W[He]){let je={min:0,max:0};this.terrain&&(je=this.terrain.getMinMaxForTile(st)||je),ve.addShadowReceiver(st.toUnwrapped(),je.min,je.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new r.dz(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Rw(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);let be=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),xe=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(be&&!this._snow&&(this._snow=new Th(this)),!be&&this._snow&&(this._snow.destroy(),delete this._snow),xe&&!this._rain&&(this._rain=new qv(this)),!xe&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!Xr.has(this.context.gl))return;this.renderPass="offscreen";for(let He of F){let st=a.getLayerSourceCache(He);if(!He.hasOffscreenPass()||He.isHidden(this.transform.zoom))continue;let je=st?te[st.id]:void 0;(He.type==="custom"||He.type==="raster"||He.type==="raster-particle"||He.isSky()||je&&je.length)&&this.renderLayer(this,st,He,je)}this.depthRangeFor3D=[0,1-(F.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,he)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let Ae=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Oe=(()=>{if(c.showOverdrawInspector)return r.al.black;let He=this.style.fog;if(He&&this.transform.projection.supportsFog){let st=this.style.getLut(He.scope);if(!Ae){let je=He.properties.get("color-use-theme")==="none",at=He.properties.get("color").toRenderColor(je?null:st).toArray01();return new r.al(...at)}if(Ae){let je=He.properties.get("space-color-use-theme")==="none",at=He.properties.get("space-color").toRenderColor(je?null:st).toArray01();return new r.al(...at)}}return r.al.transparent})();if(this.context.clear({color:Oe,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ae&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=I.length-1;this.currentLayer>=0;this.currentLayer--){let He=F[this.currentLayer],st=a.getLayerSourceCache(He);if(He.isSky())continue;let je=st?(He.is3D(b)?_e:te)[st.id]:void 0;this._renderTileClippingMasks(He,st,je),this.renderLayer(this,st,He,je)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ae&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||r.ag(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<I.length;this.currentLayer++){let He=F[this.currentLayer],st=a.getLayerSourceCache(He);He.isSky()&&this.renderLayer(this,st,He,st?te[st.id]:void 0)}function Ke(He,st){let je;return st&&(je=(He.type==="symbol"?ne:He.is3D(b)?_e:te)[st.id]),je}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<I.length;){let He=F[this.currentLayer];if(He.type==="raster"||He.type==="raster-particle"){let st=a.getLayerSourceCache(He);this.renderLayer(this,st,He,Ke(He,st))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let $e=0;ve&&($e=ve.getShadowCastingLayerCount());let ct=!1,ut=-1;for(let He=0;He<I.length;++He){let st=F[He];st.isHidden(this.transform.zoom)||st.is3D(b)&&(ut=He)}O&&ut===-1&&(k=!0);let St=!1;for(;this.currentLayer<I.length;){let He=F[this.currentLayer],st=a.getLayerSourceCache(He);if(He.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(He)){if(He.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!St&&He.is3D(b)&&!b){let je=this.currentLayer,at=rt=>{for(this.currentLayer=0;this.currentLayer<F.length;this.currentLayer++){let ht=F[this.currentLayer];if(Og[ht.type]){let Qe=this.style.getLayerSourceCache(ht);Og[ht.type](this,Qe,ht,Ke(ht,Qe),rt)}}};at("initialize"),at("reset"),this.currentLayer=je,St=!0}if(k&&!ct&&this.terrain&&!this.transform.isOrthographic&&(ct=!0,this.blitDepth()),O&&ut!==-1&&this.currentLayer===ut+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(He,st,st?W[st.id]:void 0),this.renderLayer(this,st,He,Ke(He,st)),!this.terrain&&ve&&$e>0&&He.hasShadowPass()&&--$e==0&&(ve.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){let je=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=je;this.currentLayer++){let at=F[this.currentLayer];if(!at.hasLightBeamPass())continue;let rt=a.getLayerSourceCache(at);this.renderLayer(this,rt,at,rt?te[rt.id]:void 0)}this.currentLayer=je,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){let je=this.currentLayer;this.depthOcclusion=!0;for(let at of this.layersWithOcclusionOpacity){this.currentLayer=at;let rt=F[this.currentLayer],ht=a.getLayerSourceCache(rt),Qe=ht?te[ht.id]:void 0;this.terrain||this._renderTileClippingMasks(rt,ht,ht?W[ht.id]:void 0),this.renderLayer(this,ht,rt,Qe)}this.depthOcclusion=!1,this.currentLayer=je,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let He=null;F.forEach(st=>{let je=a.getLayerSourceCache(st);je&&!st.isHidden(this.transform.zoom)&&je.getVisibleCoordinates().length&&(!He||He.getSource().maxzoom<je.getSource().maxzoom)&&(He=je)}),He&&this.options.showTileBoundaries&&wf.debug(this,He,He.getVisibleCoordinates(),r.al.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&wf.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new r.al(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(He){let st=He.transform.padding;Lv(He,He.transform.height-(st.top||0),3,Sh),Lv(He,st.bottom||0,3,HM),Nv(He,st.left||0,3,$M),Nv(He,He.transform.width-(st.right||0),3,Iw);let je=He.transform.centerPoint;(function(at,rt,ht,Qe){au(at,rt-1,ht-10,2,20,Qe),au(at,rt-10,ht-1,20,2,Qe)})(He,je.x,He.transform.height-je.y,Dg)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),G||(this.conflationActive=!1)}prepareLayer(a){this.gpuTimingStart(a);let{unsupportedLayers:c}=this.transform.projection,f=!c||!c.includes(a.type);if(Pg[a.type]&&(f||this.terrain&&a.type==="custom")){let _=this.style.getLayerSourceCache(a);Pg[a.type](a,_,this)}this.gpuTimingEnd()}renderLayer(a,c,f,_){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="sky"||f.type==="custom"||f.type==="model"||f.type==="raster"||f.type==="raster-particle"||_&&_.length)&&(this.id=f.id,this.gpuTimingStart(f),a.transform.projection.unsupportedLayers&&a.transform.projection.unsupportedLayers.includes(f.type)&&(!a.terrain||f.type!=="custom")||f.type==="clip"||wf[f.type](a,c,f,_,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(a){if(!this.options.gpuTiming)return;let c=this.context.extTimerQuery,f=this.context.gl,_=this.gpuTimers[a.id];_||(_=this.gpuTimers[a.id]={calls:0,cpuTime:0,query:f.createQuery()}),_.calls++,f.beginQuery(c.TIME_ELAPSED_EXT,_.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){let a=this.context.extTimerQuery,c=this.context.gl,f=c.createQuery();this.deferredRenderGpuTimeQueries.push(f),c.beginQuery(a.TIME_ELAPSED_EXT,f)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){let a=this.gpuTimers;return this.gpuTimers={},a}collectDeferredRenderGpuQueries(){let a=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],a}queryGpuTimers(a){let c={};for(let f in a){let _=a[f],b=this.context.extTimerQuery,w=b.getQueryParameter(_.query,this.context.gl.QUERY_RESULT)/1e6;b.deleteQueryEXT(_.query),c[f]=w}return c}queryGpuTimeDeferredRender(a){if(!this.options.gpuTimingDeferredRender)return 0;let c=this.context.gl,f=0;for(let _ of a)f+=c.getQueryParameter(_,c.QUERY_RESULT)/1e6,c.deleteQuery(_);return f}translatePosMatrix(a,c,f,_,b){if(!f[0]&&!f[1])return a;let w=b?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(w){let O=Math.sin(w),F=Math.cos(w);f=[f[0]*F-f[1]*O,f[0]*O+f[1]*F]}let I=[b?f[0]:r.at(c,f[0],this.transform.zoom),b?f[1]:r.at(c,f[1],this.transform.zoom),0],k=new Float32Array(16);return r.ad.mat4.translate(k,a,I),k}saveTileTexture(a){let c=a.size[0],f=this._tileTextures[c];f?f.push(a):this._tileTextures[c]=[a]}getTileTexture(a){let c=this._tileTextures[a];return c&&c.length>0?c.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(a,c,f){let _=f===void 0?this.terrain&&this.terrain.renderingToTexture:f,b=[];return this.style&&this.style.enable3dLights()&&(a==="globeRaster"||a==="terrainRaster"?(b.push("LIGHTING_3D_MODE"),b.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):_||b.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||b.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(b.push("TERRAIN"),this.linearFloatFilteringSupported()&&b.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&b.push("GLOBE"),!this._fogVisible||_||c!==void 0&&!c||b.push("FOG","FOG_DITHERING"),_&&b.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&b.push("OVERDRAW_INSPECTOR"),b}getOrCreateProgram(a,c){this.cache=this.cache||{};let f=c&&c.defines||[],_=c&&c.config,b=this.currentGlobalDefines(a,c&&c.overrideFog,c&&c.overrideRtt).concat(f),w=vw.cacheKey(uf[a],a,b,_);return this.cache[w]||(this.cache[w]=new vw(this.context,a,uf[a],_,Iv[a],b)),this.cache[w]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new r.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(a,c){if(this.style.enable3dLights()){let f=this.style.directionalLight,_=this.style.ambientLight;if(f&&_){let b=((w,I,k)=>{let O=w.properties.get("direction"),F=w.properties.get("color-use-theme")==="none",z=w.properties.get("color").toRenderColor(F?null:k.getLut(w.scope)).toArray01(),V=w.properties.get("intensity"),G=I.properties.get("color-use-theme")==="none",K=I.properties.get("color").toRenderColor(G?null:k.getLut(I.scope)).toArray01(),W=I.properties.get("intensity"),te=[O.x,O.y,O.z],ne=r.cN(K,W),he=r.cN(z,V);return{u_lighting_ambient_color:ne,u_lighting_directional_dir:te,u_lighting_directional_color:he,u_ground_radiance:yw(te,he,ne)}})(f,_,this.style);c.setLightsUniformValues(a,b)}}}uploadCommonUniforms(a,c,f,_,b){if(this.uploadCommonLightUniforms(a,c),this.terrain&&this.terrain.renderingToTexture)return;let w=this.style.fog;if(w){let I=w.getOpacity(this.transform.pitch),k=((O,F,z,V,G,K,W,te,ne,he,_e,me)=>{let Se=O.transform,ve=F.properties.get("color-use-theme")==="none",be=F.properties.get("color").toRenderColor(ve?null:O.style.getLut(F.scope)).toArray01();be[3]=V;let xe=O.frameCounter/1e3%1,[Ae,Oe]=F.properties.get("vertical-range");return{u_fog_matrix:z?Se.calculateFogTileMatrix(z):me||O.identityMat,u_fog_range:F.getFovAdjustedRange(Se._fov),u_fog_color:be,u_fog_horizon_blend:F.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Ae,Oe),Oe],u_fog_temporal_offset:xe,u_frustum_tl:G,u_frustum_tr:K,u_frustum_br:W,u_frustum_bl:te,u_globe_pos:ne,u_globe_radius:he,u_viewport:_e,u_globe_transition:r.ag(Se.zoom),u_is_globe:+(Se.projection.name==="globe")}})(this,w,f,I,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*r.q.devicePixelRatio,this.transform.height*r.q.devicePixelRatio],_);c.setFogUniformValues(a,k)}b&&c.setCutoffUniformValues(a,b.uniformValues)}setTileLoadedFlag(a){this.tileLoaded=a}saveCanvasCopy(){let a=this.canvasCopy();a&&(this.frameCopies.push(a),this.tileLoaded=!1)}canvasCopy(){let a=this.context.gl,c=a.createTexture();return a.bindTexture(a.TEXTURE_2D,c),a.copyTexImage2D(a.TEXTURE_2D,0,a.RGBA,0,0,a.drawingBufferWidth,a.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;let a=this.style&&this.style.fog;return!!a&&a.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){let a=this._backgroundTiles,c=this._backgroundTiles={},f=this.transform.coveringTiles({tileSize:512});for(let _ of f)c[_.key]=a[_.key]||new hl(_,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(a,c){return!(!a.is3D(!(!this.terrain||!this.terrain.enabled))||a.type!=="clip"&&(a.minzoom&&a.minzoom>this.transform.zoom||(this.style._clipLayerPresent||a.sourceLayer!=="building")&&(!c||c.type!=="batched-model")))}isTileAffectedByFog(a){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let c=this._cachedTileFogOpacities[a.key];return c||(this._cachedTileFogOpacities[a.key]=c=this.style.fog.getOpacityForTile(a)),c[0]>=Ut||c[1]>=Ut}setupDepthForOcclusion(a,c,f){let _=this.context,b=_.gl,w=!!f;var I;f||(f={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),_.activeTexture.set(b.TEXTURE3),a&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),f.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],f.u_depth_range_unpack=[2/((I=this.depthRangeFor3D)[1]-I[0]),-1-2*I[0]/(I[1]-I[0])],f.u_occluder_half_size=.5*this.occlusionParams.occluderSize,f.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),_.activeTexture.set(b.TEXTURE0),w||c.setTerrainUniformValues(_,f)}}function Lg(m,a){let c=!1,f=null,_=()=>{f=null,c&&(m(),f=setTimeout(_,a),c=!1)};return()=>(c=!0,f||_(),f)}class Yv{constructor(a){this._hashName=a&&encodeURIComponent(a),r.aQ(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Lg(this._updateHashUnthrottled.bind(this),300)}addTo(a){return this._map=a,window.addEventListener("hashchange",this._onHashChange,!1),a.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){let a=this._map;if(!a)return"";let c=Zv(a);if(this._hashName){let f=this._hashName,_=!1,b=location.hash.slice(1).split("&").map(w=>{let I=w.split("=")[0];return I===f?(_=!0,`${I}=${c}`):w}).filter(w=>w);return _||b.push(`${f}=${c}`),`#${b.join("&")}`}return`#${c}`}_getCurrentHash(){let a=location.hash.replace("#","");if(this._hashName){let c;return a.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(c=f)}),(c&&c[1]||"").split("/")}return a.split("/")}_onHashChange(){let a=this._map;if(!a)return!1;let c=this._getCurrentHash();if(c.length>=3&&!c.some(f=>isNaN(f))){let f=a.dragRotate.isEnabled()&&a.touchZoomRotate.isEnabled()?+(c[3]||0):a.getBearing();return a.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:f,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Zv(m,a){let c=m.getCenter(),f=Math.round(100*m.getZoom())/100,_=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,_),w=Math.round(c.lng*b)/b,I=Math.round(c.lat*b)/b,k=m.getBearing(),O=m.getPitch(),F=a?`/${w}/${I}/${f}`:`${f}/${I}/${w}`;return(k||O)&&(F+="/"+Math.round(10*k)/10),O&&(F+=`/${Math.round(O)}`),F}let Cf={linearity:.3,easing:r.dB(0,0,.3,1)},kw=r.l({deceleration:2500,maxSpeed:1400},Cf),Pw=r.l({deceleration:20,maxSpeed:1400},Cf),Ow=r.l({deceleration:1e3,maxSpeed:360},Cf),Fw=r.l({deceleration:1e3,maxSpeed:90},Cf);class Lw{constructor(a){this._map=a,this.clear()}clear(){this._inertiaBuffer=[]}record(a){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:r.q.now(),settings:a})}_drainInertiaBuffer(){let a=this._inertiaBuffer,c=r.q.now();for(;a.length>0&&c-a[0].time>160;)a.shift()}_onMoveEnd(a){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;let c={zoom:0,bearing:0,pitch:0,pan:new r.P(0,0),pinchAround:void 0,around:void 0};for(let{settings:b}of this._inertiaBuffer)c.zoom+=b.zoomDelta||0,c.bearing+=b.bearingDelta||0,c.pitch+=b.pitchDelta||0,b.panDelta&&c.pan._add(b.panDelta),b.around&&(c.around=b.around),b.pinchAround&&(c.pinchAround=b.pinchAround);let f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(c.pan.mag()){let b=Sf(c.pan.mag(),f,r.l({},kw,a||{}));_.offset=c.pan.mult(b.amount/c.pan.mag()),_.center=this._map.transform.center,Ef(_,b)}if(c.zoom){let b=Sf(c.zoom,f,Pw);_.zoom=this._map.transform.zoom+b.amount,Ef(_,b)}if(c.bearing){let b=Sf(c.bearing,f,Ow);_.bearing=this._map.transform.bearing+r.ay(b.amount,-179,179),Ef(_,b)}if(c.pitch){let b=Sf(c.pitch,f,Fw);_.pitch=this._map.transform.pitch+b.amount,Ef(_,b)}if(_.zoom||_.bearing){let b=c.pinchAround===void 0?c.around:c.pinchAround;_.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),_.noMoveStart=!0,_}}function Ef(m,a){(!m.duration||m.duration<a.duration)&&(m.duration=a.duration,m.easing=a.easing)}function Sf(m,a,c){let{maxSpeed:f,linearity:_,deceleration:b}=c,w=r.ay(m*_/(a/1e3),-f,f),I=Math.abs(w)/(b*_);return{easing:c.easing,duration:1e3*I,amount:w*(I/2)}}class Qa extends r.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,c,f,_={}){let b=Pt(c.getCanvasContainer(),f),w=c.unproject(b);super(a,r.l({point:b,lngLat:w,originalEvent:f},_)),this._defaultPrevented=!1,this.target=c}}class Df extends r.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,c,f){let _=a==="touchend"?f.changedTouches:f.touches,b=Lt(c.getCanvasContainer(),_),w=b.map(k=>c.unproject(k)),I=b.reduce((k,O,F,z)=>k.add(O.div(z.length)),new r.P(0,0));super(a,{points:b,point:I,lngLats:w,lngLat:c.unproject(I),originalEvent:f}),this._defaultPrevented=!1}}class Nw extends r.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,c){super("wheel",{originalEvent:c}),this._defaultPrevented=!1}}class zw{constructor(a,c){this._map=a,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(a){return this._firePreventable(new Nw(this._map,a))}mousedown(a,c){return this._mousedownPos=c,this._firePreventable(new Qa(a.type,this._map,a))}mouseup(a){this._map.fire(new Qa(a.type,this._map,a))}preclick(a){let c=r.l({},a);c.type="preclick",this._map.fire(new Qa(c.type,this._map,c))}click(a,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(a),this._map.fire(new Qa(a.type,this._map,a)))}dblclick(a){return this._firePreventable(new Qa(a.type,this._map,a))}mouseover(a){this._map.fire(new Qa(a.type,this._map,a))}mouseout(a){this._map.fire(new Qa(a.type,this._map,a))}touchstart(a){return this._firePreventable(new Df(a.type,this._map,a))}touchmove(a){this._map.fire(new Df(a.type,this._map,a))}touchend(a){this._map.fire(new Df(a.type,this._map,a))}touchcancel(a){this._map.fire(new Df(a.type,this._map,a))}_firePreventable(a){if(this._map.fire(a),a.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class qM{constructor(a){this._map=a}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(a){this._map.fire(new Qa(a.type,this._map,a))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Qa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(a){this._delayContextMenu?this._contextMenuEvent=a:this._map.fire(new Qa(a.type,this._map,a)),this._map.listens("contextmenu")&&a.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class WM{constructor(a,c){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(a,c){this.isEnabled()&&a.shiftKey&&a.button===0&&(Ce(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(a,c){if(!this._active)return;let f=c,_=this._startPos,b=this._lastPos;if(!_||!b||b.equals(f)||!this._box&&f.dist(_)<this._clickTolerance)return;this._lastPos=f,this._box||(this._box=re("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",a));let w=Math.min(_.x,f.x),I=Math.max(_.x,f.x),k=Math.min(_.y,f.y),O=Math.max(_.y,f.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${w}px,${k}px)`,this._box.style.width=I-w+"px",this._box.style.height=O-k+"px")})}mouseupWindow(a,c){if(!this._active)return;let f=this._startPos,_=c;if(f&&a.button===0){if(this.reset(),et(),f.x!==_.x||f.y!==_.y)return this._map.fire(new r.A("boxzoomend",{originalEvent:a})),{cameraAnimation:b=>b.fitScreenCoordinates(f,_,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",a)}}keydown(a){this._active&&a.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",a))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Te(),delete this._startPos,delete this._lastPos}_fireEvent(a,c){return this._map.fire(new r.A(a,{originalEvent:c}))}}function _r(m,a){let c={};for(let f=0;f<m.length;f++)c[m[f].identifier]=a[f];return c}class Bw{constructor(a){this.reset(),this.numTouches=a.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(a,c,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=a.timeStamp),f.length===this.numTouches&&(this.centroid=function(_){let b=new r.P(0,0);for(let w of _)b._add(w);return b.div(_.length)}(c),this.touches=_r(f,c)))}touchmove(a,c,f){if(this.aborted||!this.centroid)return;let _=_r(f,c);for(let b in this.touches){let w=_[b];(!w||w.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(a,c,f){if((!this.centroid||a.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){let _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class Xv{constructor(a){this.singleTap=new Bw(a),this.numTaps=a.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(a,c,f){this.singleTap.touchstart(a,c,f)}touchmove(a,c,f){this.singleTap.touchmove(a,c,f)}touchend(a,c,f){let _=this.singleTap.touchend(a,c,f);if(_){let b=a.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(_)<30;if(b&&w||this.reset(),this.count++,this.lastTime=a.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class YM{constructor(){this._zoomIn=new Xv({numTouches:1,numTaps:2}),this._zoomOut=new Xv({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(a,c,f){this._zoomIn.touchstart(a,c,f),this._zoomOut.touchstart(a,c,f)}touchmove(a,c,f){this._zoomIn.touchmove(a,c,f),this._zoomOut.touchmove(a,c,f)}touchend(a,c,f){let _=this._zoomIn.touchend(a,c,f),b=this._zoomOut.touchend(a,c,f);return _?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()+1,around:w.unproject(_)},{originalEvent:a})}):b?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()-1,around:w.unproject(b)},{originalEvent:a})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}let Mf={0:1,2:2},Kv={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class Tf{constructor(a){this.reset(),this._clickTolerance=a.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(a,c){return!1}_move(a,c){return{}}mousedown(a,c){if(this._lastPoint)return;let f=lt(a);this._correctButton(a,f)&&(this._lastPoint=c,this._eventButton=f)}mousemoveWindow(a,c){let f=this._lastPoint;if(f){if(a.preventDefault(),this._eventButton!=null&&function(_,b){let w=Mf[b];return _.buttons===void 0||(_.buttons&w)!==w}(a,this._eventButton))this.reset();else if(this._moved||!(c.dist(f)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(f,c)}}mouseupWindow(a){this._lastPoint&&lt(a)===this._eventButton&&(this._moved&&et(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ng extends Tf{mousedown(a,c){super.mousedown(a,c),this._lastPoint&&(this._active=!0)}_correctButton(a,c){return c===0&&!a.ctrlKey}_move(a,c){return{around:c,panDelta:c.sub(a)}}}class Fl extends Tf{constructor(a){super(a),this._pitchRotateKey=a.pitchRotateKey?Kv[a.pitchRotateKey]:void 0}_correctButton(a,c){return this._pitchRotateKey?c===0&&a[this._pitchRotateKey]:c===0&&a.ctrlKey||c===2}_move(a,c){let f=.8*(c.x-a.x);if(f)return this._active=!0,{bearingDelta:f}}contextmenu(a){this._pitchRotateKey||a.preventDefault()}}class If extends Tf{constructor(a){super(a),this._pitchRotateKey=a.pitchRotateKey?Kv[a.pitchRotateKey]:void 0}_correctButton(a,c){return this._pitchRotateKey?c===0&&a[this._pitchRotateKey]:c===0&&a.ctrlKey||c===2}_move(a,c){let f=-.5*(c.y-a.y);if(f)return this._active=!0,{pitchDelta:f}}contextmenu(a){this._pitchRotateKey||a.preventDefault()}}class $r{constructor(a,c){this._map=a,this._el=a.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),r.aQ(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new r.P(0,0)}touchstart(a,c,f){return this._calculateTransform(a,c,f)}touchmove(a,c,f){if(this._active&&!(f.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(f.length===1&&!r.dC())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return a.cancelable&&a.preventDefault(),this._calculateTransform(a,c,f)}}touchend(a,c,f){this._calculateTransform(a,c,f),this._active&&f.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(a,c,f){f.length>0&&(this._active=!0);let _=_r(f,c),b=new r.P(0,0),w=new r.P(0,0),I=0;for(let O in _){let F=_[O],z=this._touches[O];z&&(b._add(F),w._add(F.sub(z)),I++,_[O]=F)}if(this._touches=_,I<this._minTouches||!w.mag())return;let k=w.div(I);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(I),panDelta:k}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=re("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Us{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(a){}_move(a,c,f){return{}}touchstart(a,c,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([c[0],c[1]]))}touchmove(a,c,f){let _=this._firstTwoTouches;if(!_)return;a.preventDefault();let[b,w]=_,I=Ih(f,c,b),k=Ih(f,c,w);if(!I||!k)return;let O=this._aroundCenter?null:I.add(k).div(2);return this._move([I,k],O,a)}touchend(a,c,f){if(!this._firstTwoTouches)return;let[_,b]=this._firstTwoTouches,w=Ih(f,c,_),I=Ih(f,c,b);w&&I||(this._active&&et(),this.reset())}touchcancel(){this.reset()}enable(a){this._enabled=!0,this._aroundCenter=!!a&&a.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ih(m,a,c){for(let f=0;f<m.length;f++)if(m[f].identifier===c)return a[f]}function Af(m,a){return Math.log(m/a)/Math.LN2}class Vw extends Us{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(a){this._startDistance=this._distance=a[0].dist(a[1])}_move(a,c){let f=this._distance;if(this._distance=a[0].dist(a[1]),this._active||!(Math.abs(Af(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Af(this._distance,f),pinchAround:c}}}function jw(m,a){return 180*m.angleWith(a)/Math.PI}class Rf extends Us{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(a){this._startVector=this._vector=a[0].sub(a[1]),this._minDiameter=a[0].dist(a[1])}_move(a,c){let f=this._vector;if(this._vector=a[0].sub(a[1]),f&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:jw(this._vector,f),pinchAround:c}}_isBelowThreshold(a){this._minDiameter=Math.min(this._minDiameter,a.mag());let c=25/(Math.PI*this._minDiameter)*360,f=this._startVector;if(!f)return!1;let _=jw(a,f);return Math.abs(_)<c}}function Qv(m){return Math.abs(m.y)>Math.abs(m.x)}class ZM extends Us{constructor(a){super(),this._map=a}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(a){this._lastPoints=a,Qv(a[0].sub(a[1]))&&(this._valid=!1)}_move(a,c,f){let _=this._lastPoints;if(!_)return;let b=a[0].sub(_[0]),w=a[1].sub(_[1]);return this._map._cooperativeGestures&&!r.dC()&&f.touches.length<3||(this._valid=this.gestureBeginsVertically(b,w,f.timeStamp),!this._valid)?void 0:(this._lastPoints=a,this._active=!0,{pitchDelta:(b.y+w.y)/2*-.5})}gestureBeginsVertically(a,c,f){if(this._valid!==void 0)return this._valid;let _=a.mag()>=2,b=c.mag()>=2;if(!_&&!b)return;if(!_||!b)return this._firstMove==null&&(this._firstMove=f),f-this._firstMove<100&&void 0;let w=a.y>0==c.y>0;return Qv(a)&&Qv(c)&&w}}let Jv={panStep:100,bearingStep:15,pitchStep:10};class e0{constructor(){let a=Jv;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(a){if(a.altKey||a.ctrlKey||a.metaKey)return;let c=0,f=0,_=0,b=0,w=0;switch(a.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:a.shiftKey?f=-1:(a.preventDefault(),b=-1);break;case 39:a.shiftKey?f=1:(a.preventDefault(),b=1);break;case 38:a.shiftKey?_=1:(a.preventDefault(),w=-1);break;case 40:a.shiftKey?_=-1:(a.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(f=0,_=0),{cameraAnimation:I=>{let k=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:kf,zoom:c?Math.round(k)+c*(a.shiftKey?2:1):k,bearing:I.getBearing()+f*this._bearingStep,pitch:I.getPitch()+_*this._pitchStep,offset:[-b*this._panStep,-w*this._panStep],center:I.getCenter()},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function kf(m){return m*(2-m)}let cu=4.000244140625,Ec=1/450;class _l{constructor(a,c){this._map=a,this._el=a.getCanvasContainer(),this._handler=c,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Ec,r.aQ(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(a){this._defaultZoomRate=a}setWheelZoomRate(a){this._wheelZoomRate=a}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!a&&a.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(a){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(a.ctrlKey||a.metaKey||this.isZooming()||r.dC()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=a.deltaMode===WheelEvent.DOM_DELTA_LINE?40*a.deltaY:a.deltaY,f=r.q.now(),_=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,c!==0&&c%cu==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=c,this._timeout=window.setTimeout(this._onTimeout,40,a)):this._type||(this._type=Math.abs(_*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),a.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=a,this._delta-=c,this._active||this._start(a)),a.preventDefault()}_onTimeout(a){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(a)}_start(a){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let c=Pt(this._el,a);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let a=this._map.transform;this._type==="wheel"&&a.projection.wrap&&(a._center.lng>=180||a._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);let c=()=>a._terrainEnabled()&&this._aroundCoord?a.computeZoomRelativeTo(this._aroundCoord):a.zoom;if(this._delta!==0){let O=this._type==="wheel"&&Math.abs(this._delta)>cu?this._wheelZoomRate:this._defaultZoomRate,F=2/(1+Math.exp(-Math.abs(this._delta*O)));this._delta<0&&F!==0&&(F=1/F);let z=c(),V=Math.pow(2,z),G=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):V;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(G*F))),this._type==="wheel"&&(this._startZoom=z,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}let f=typeof this._targetZoom=="number"?this._targetZoom:c(),_=this._startZoom,b=this._easing,w,I=!1;if(this._type==="wheel"&&_&&b){let O=Math.min((r.q.now()-this._lastWheelEventTime)/200,1),F=b(O);w=r.ah(_,f,F),O<1?this._frameId||(this._frameId=!0):I=!0}else w=f,I=!0;this._active=!0,I&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let k=w-c();return k*this._lastDelta<0&&(k=0),{noInertia:!0,needsRenderFrame:!I,zoomDelta:k,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(a){let c=r.dD;if(this._prevEase){let f=this._prevEase,_=(r.q.now()-f.start)/f.duration,b=f.easing(_+.01)-f.easing(_),w=.27/Math.sqrt(b*b+1e-4)*.01,I=Math.sqrt(.0729-w*w);c=r.dB(w,I,.25,1)}return this._prevEase={start:r.q.now(),duration:a,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=re("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class md{constructor(a,c){this._clickZoom=a,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class du{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(a,c){return a.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:f.getZoom()+(a.shiftKey?-1:1),around:f.unproject(c)},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gd{constructor(){this._tap=new Xv({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(a,c,f){this._swipePoint||(this._tapTime&&a.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?f.length>0&&(this._swipePoint=c[0],this._swipeTouch=f[0].identifier):this._tap.touchstart(a,c,f))}touchmove(a,c,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;let _=c[0],b=_.y-this._swipePoint.y;return this._swipePoint=_,a.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(a,c,f)}touchend(a,c,f){this._tapTime?this._swipePoint&&f.length===0&&this.reset():this._tap.touchend(a,c,f)&&(this._tapTime=a.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class XM{constructor(a,c,f){this._el=a,this._mousePan=c,this._touchPan=f}enable(a){this._inertiaOptions=a||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class KM{constructor(a,c,f){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=c,this._mousePitch=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class QM{constructor(a,c,f,_){this._el=a,this._touchZoom=c,this._touchRotate=f,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(a){this._touchZoom.enable(a),this._rotationDisabled||this._touchRotate.enable(a),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}let zg=m=>m.zoom||m.drag||m.pitch||m.rotate;class Uw extends r.A{}class Na{constructor(){this.constants=[1,1,.01],this.radius=0}setup(a,c){let f=r.ad.vec3.sub([],c,a);this.radius=r.ad.vec3.length(f[2]<0?r.ad.vec3.div([],f,this.constants):[f[0],f[1],0])}projectRay(a){r.ad.vec3.div(a,a,this.constants),r.ad.vec3.normalize(a,a),r.ad.vec3.mul(a,a,this.constants);let c=r.ad.vec3.scale([],a,this.radius);if(c[2]>0){let f=r.ad.vec3.scale([],[0,0,1],r.ad.vec3.dot(c,[0,0,1])),_=r.ad.vec3.scale([],r.ad.vec3.normalize([],[c[0],c[1],0]),this.radius),b=r.ad.vec3.add([],c,r.ad.vec3.scale([],r.ad.vec3.sub([],r.ad.vec3.add([],_,f),c),2));c[0]=b[0],c[1]=b[1]}return c}}function Ah(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class Hw{constructor(a,c){this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Lw(a),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Na,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),r.aQ(["handleEvent","handleWindowEvent"],this);let f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(let[_,b,w]of this._listeners){let I=_===document?this.handleWindowEvent:this.handleEvent;_.addEventListener(b,I,w)}}destroy(){for(let[a,c,f]of this._listeners){let _=a===document?this.handleWindowEvent:this.handleEvent;a.removeEventListener(c,_,f)}}_addDefaultHandlers(a){let c=this._map,f=c.getCanvasContainer();this._add("mapEvent",new zw(c,a));let _=c.boxZoom=new WM(c,a);this._add("boxZoom",_);let b=new YM,w=new du;c.doubleClickZoom=new md(w,b),this._add("tapZoom",b),this._add("clickZoom",w);let I=new gd;this._add("tapDragZoom",I);let k=c.touchPitch=new ZM(c);this._add("touchPitch",k);let O=new Fl(a),F=new If(a);c.dragRotate=new KM(a,O,F),this._add("mouseRotate",O,["mousePitch"]),this._add("mousePitch",F,["mouseRotate"]);let z=new Ng(a),V=new $r(c,a);c.dragPan=new XM(f,z,V),this._add("mousePan",z),this._add("touchPan",V,["touchZoom","touchRotate"]);let G=new Rf,K=new Vw;c.touchZoomRotate=new QM(f,K,G,I),this._add("touchRotate",G,["touchPan","touchZoom"]),this._add("touchZoom",K,["touchPan","touchRotate"]),this._add("blockableMapEvent",new qM(c));let W=c.scrollZoom=new _l(c,this);this._add("scrollZoom",W,["mousePan"]);let te=c.keyboard=new e0;this._add("keyboard",te);for(let ne of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])a.interactive&&a[ne]&&c[ne].enable(a[ne])}_add(a,c,f){this._handlers.push({handlerName:a,handler:c,allowed:f}),this._handlersById[a]=c}stop(a){if(!this._updatingCamera){for(let{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},a),this._changes=[],this._originalZoom=void 0}}isActive(){for(let{handler:a}of this._handlers)if(a.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!zg(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(a,c,f){for(let _ in a)if(_!==f&&(!c||c.indexOf(_)<0))return!0;return!1}handleWindowEvent(a){this.handleEvent(a,`${a.type}Window`)}_getMapTouches(a){let c=[];for(let f of a)this._el.contains(f.target)&&c.push(f);return c}handleEvent(a,c){this._updatingCamera=!0;let f=a.type==="renderFrame",_=f?void 0:a,b={needsRenderFrame:!1},w={},I={},k=a.touches?this._getMapTouches(a.touches):void 0,O=k?Lt(this._el,k):f?void 0:Pt(this._el,a);for(let{handlerName:V,handler:G,allowed:K}of this._handlers){if(!G.isEnabled())continue;let W;this._blockedByActive(I,K,V)?G.reset():G[c||a.type]&&(W=G[c||a.type](a,O,k),this.mergeHandlerResult(b,w,W,V,_),W&&W.needsRenderFrame&&this._triggerRenderFrame()),(W||G.isActive())&&(I[V]=G)}let F={};for(let V in this._previousActiveHandlers)I[V]||(F[V]=_);this._previousActiveHandlers=I,(Object.keys(F).length||Ah(b))&&(this._changes.push([b,w,F]),this._triggerRenderFrame()),(Object.keys(I).length||Ah(b))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:z}=b;z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],z(this._map))}mergeHandlerResult(a,c,f,_,b){if(!f)return;r.l(a,f);let w={handlerName:_,originalEvent:f.originalEvent||b};f.zoomDelta!==void 0&&(c.zoom=w),f.panDelta!==void 0&&(c.drag=w),f.pitchDelta!==void 0&&(c.pitch=w),f.bearingDelta!==void 0&&(c.rotate=w)}_applyChanges(){let a={},c={},f={};for(let[_,b,w]of this._changes)_.panDelta&&(a.panDelta=(a.panDelta||new r.P(0,0))._add(_.panDelta)),_.zoomDelta&&(a.zoomDelta=(a.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(a.bearingDelta=(a.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(a.pitchDelta=(a.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(a.around=_.around),_.aroundCoord!==void 0&&(a.aroundCoord=_.aroundCoord),_.pinchAround!==void 0&&(a.pinchAround=_.pinchAround),_.noInertia&&(a.noInertia=_.noInertia),r.l(c,b),r.l(f,w);this._updateMapTransform(a,c,f),this._changes=[]}_updateMapTransform(a,c,f){let _=this._map,b=_.transform,w=he=>[he.x,he.y,he.z];if((he=>{let _e=this._eventsInProgress.drag;return _e&&!this._handlersById[_e.handlerName].isActive()})()&&!Ah(a)){let he=b.zoom;b.cameraElevationReference="sea",this._originalZoom!=null&&b._orthographicProjectionAtLowPitch&&b.projection.name!=="globe"&&b.pitch===0?(b.cameraElevationReference="ground",b.zoom=this._originalZoom):(b.recenterOnTerrain(),b.cameraElevationReference="ground"),he!==b.zoom&&this._map._update(!0)}if(b._isCameraConstrained&&_._stop(!0),!Ah(a))return void this._fireEvents(c,f,!0);let{panDelta:I,zoomDelta:k,bearingDelta:O,pitchDelta:F,around:z,aroundCoord:V,pinchAround:G}=a;b._isCameraConstrained&&(k>0&&(k=0),b._isCameraConstrained=!1),G!==void 0&&(z=G),(k||(he=>c[he]&&!this._eventsInProgress[he])("drag"))&&z&&(this._dragOrigin=w(b.pointCoordinate3D(z)),this._originalZoom=b.zoom,this._trackingEllipsoid.setup(b._camera.position,this._dragOrigin)),b.cameraElevationReference="sea",_._stop(!0),z=z||_.transform.centerPoint,O&&(b.bearing+=O),F&&(b.pitch+=F),b._updateCameraState();let K=[0,0,0];if(I)if(b.projection.name==="mercator"){let he=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(z).dir),_e=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(z.sub(I)).dir);K[0]=_e[0]-he[0],K[1]=_e[1]-he[1]}else{let he=b.pointCoordinate(z);if(b.projection.name==="globe"){I=I.rotate(-b.angle);let _e=b._pixelsPerMercatorPixel/b.worldSize;K[0]=-I.x*r.dE(r.aT(he.y))*_e,K[1]=-I.y*r.dE(b.center.lat)*_e}else{let _e=b.pointCoordinate(z.sub(I));he&&_e&&(K[0]=_e.x-he.x,K[1]=_e.y-he.y)}}let W=b.zoom,te=[0,0,0];if(k){let he=w(V||b.pointCoordinate3D(z)),_e={dir:r.ad.vec3.normalize([],r.ad.vec3.sub([],he,b._camera.position))};if(_e.dir[2]<0){let me=b.zoomDeltaToMovement(he,k);r.ad.vec3.scale(te,_e.dir,me)}}let ne=r.ad.vec3.add(K,K,te);b._translateCameraConstrained(ne),k&&Math.abs(b.zoom-W)>1e-4&&b.recenterOnTerrain(),b.cameraElevationReference="ground",this._map._update(),a.noInertia||this._inertia.record(a),this._fireEvents(c,f,!0)}_fireEvents(a,c,f){let _=zg(this._eventsInProgress),b=zg(a),w={};for(let F in a){let{originalEvent:z}=a[F];this._eventsInProgress[F]||(w[`${F}start`]=z),this._eventsInProgress[F]=a[F]}!_&&b&&this._fireEvent("movestart",b.originalEvent);for(let F in w)this._fireEvent(F,w[F]);b&&this._fireEvent("move",b.originalEvent);for(let F in a){let{originalEvent:z}=a[F];this._fireEvent(F,z)}let I={},k;for(let F in this._eventsInProgress){let{handlerName:z,originalEvent:V}=this._eventsInProgress[F];this._handlersById[z].isActive()||(delete this._eventsInProgress[F],k=c[z]||V,I[`${F}end`]=k)}for(let F in I)this._fireEvent(F,I[F]);let O=zg(this._eventsInProgress);if(f&&(_||b)&&!O){this._updatingCamera=!0;let F=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),z=V=>V!==0&&-this._bearingSnap<V&&V<this._bearingSnap;F?(z(F.bearing||this._map.getBearing())&&(F.bearing=0),this._map.easeTo(F,{originalEvent:k})):(this._map.fire(new r.A("moveend",{originalEvent:k})),z(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(a,c){this._map.fire(new r.A(a,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(a=>{this._frameId=void 0,this.handleEvent(new Uw("renderFrame",{timeStamp:a})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}let $w="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Rh extends r.E{constructor(a,c){super(),this._moving=!1,this._zooming=!1,this.transform=a,this._bearingSnap=c.bearingSnap,this._respectPrefersReducedMotion=c.respectPrefersReducedMotion!==!1,r.aQ(["_renderFrameCallback"],this)}getCenter(){return new r.bO(this.transform.center.lng,this.transform.center.lat)}setCenter(a,c){return this.jumpTo({center:a},c)}panBy(a,c,f){return a=r.P.convert(a).mult(-1),this.panTo(this.transform.center,r.l({offset:a},c),f)}panTo(a,c,f){return this.easeTo(r.l({center:a},c),f)}getZoom(){return this.transform.zoom}setZoom(a,c){return this.jumpTo({zoom:a},c),this}zoomTo(a,c,f){return this.easeTo(r.l({zoom:a},c),f)}zoomIn(a,c){return this.zoomTo(this.getZoom()+1,a,c),this}zoomOut(a,c){return this.zoomTo(this.getZoom()-1,a,c),this}getBearing(){return this.transform.bearing}setBearing(a,c){return this.jumpTo({bearing:a},c),this}getPadding(){return this.transform.padding}setPadding(a,c){return this.jumpTo({padding:a},c),this}rotateTo(a,c,f){return this.easeTo(r.l({bearing:a},c),f)}resetNorth(a,c){return this.rotateTo(0,r.l({duration:1e3},a),c),this}resetNorthPitch(a,c){return this.easeTo(r.l({bearing:0,pitch:0,duration:1e3},a),c),this}snapToNorth(a,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,c):this}getPitch(){return this.transform.pitch}setPitch(a,c){return this.jumpTo({pitch:a},c),this}cameraForBounds(a,c){a=r.aB.convert(a);let f=c&&c.bearing||0,_=c&&c.pitch||0,b=a.getNorthWest(),w=a.getSouthEast();return this._cameraForBounds(this.transform,b,w,f,_,c)}_extendPadding(a){let c={top:0,right:0,bottom:0,left:0};return a==null?r.l({},c,this.transform.padding):typeof a=="number"?{top:a,bottom:a,right:a,left:a}:r.l({},c,a)}_extendCameraOptions(a){return(a=r.l({offset:[0,0],maxZoom:this.transform.maxZoom},a)).padding=this._extendPadding(a.padding),a}_minimumAABBFrustumDistance(a,c){let f=c.max[0]-c.min[0],_=c.max[1]-c.min[1];return f/_>a.aspect?f/(2*Math.tan(.5*a.fovX)*a.aspect):_/(2*Math.tan(.5*a.fovY)*a.aspect)}_cameraForBoundsOnGlobe(a,c,f,_,b,w){let I=a.clone(),k=this._extendCameraOptions(w);I.bearing=_,I.pitch=b;let O=r.bO.convert(c),F=r.bO.convert(f),z=.5*(O.lat+F.lat),V=.5*(O.lng+F.lng),G=r.dF(z,V),K=r.ad.vec3.normalize([],G),W=r.ad.vec3.normalize([],r.ad.vec3.cross([],K,[0,1,0])),te=r.ad.vec3.cross([],W,K),ne=[W[0],W[1],W[2],0,te[0],te[1],te[2],0,K[0],K[1],K[2],0,0,0,0,1],he=[G,r.dF(O.lat,O.lng),r.dF(F.lat,O.lng),r.dF(F.lat,F.lng),r.dF(O.lat,F.lng),r.dF(z,O.lng),r.dF(z,F.lng),r.dF(O.lat,V),r.dF(F.lat,V)],_e=r.ce.fromPoints(he.map(rt=>[r.ad.vec3.dot(W,rt),r.ad.vec3.dot(te,rt),r.ad.vec3.dot(K,rt)])),me=r.ad.vec3.transformMat4([],_e.center,ne);r.ad.vec3.squaredLength(me)===0&&r.ad.vec3.set(me,0,0,1),r.ad.vec3.normalize(me,me),r.ad.vec3.scale(me,me,r.az),I.center=r.dG(me);let Se=I.getWorldToCameraMatrix(),ve=r.ad.mat4.invert(new Float64Array(16),Se);_e=r.ce.applyTransform(_e,r.ad.mat4.multiply([],Se,ne));let be=this._extendAABB(_e,I,k,_);if(!be)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");_e=be,r.ad.vec3.transformMat4(me,me,Se);let xe=.5*(_e.max[2]-_e.min[2]),Ae=this._minimumAABBFrustumDistance(I,_e),Oe=r.ad.vec3.scale([],[0,0,1],xe),Ke=r.ad.vec3.add(Oe,me,Oe),$e=Ae+(I.pitch===0?0:r.ad.vec3.distance(me,Ke)),ct=I.globeCenterInViewSpace,ut=r.ad.vec3.sub([],me,[ct[0],ct[1],ct[2]]);r.ad.vec3.normalize(ut,ut),r.ad.vec3.scale(ut,ut,$e);let St=r.ad.vec3.add([],me,ut);r.ad.vec3.transformMat4(St,St,ve);let He=r.dv/r.az,st=r.ad.vec3.length(St),je=r.bH(Math.max(st*He-r.dv,Number.EPSILON),0),at=Math.min(I.zoomFromMercatorZAdjusted(je),k.maxZoom);return at>.5*(r.c6+r.bY)?(I.setProjection({name:"mercator"}),I.zoom=at,this._cameraForBounds(I,c,f,_,b,w)):{center:I.center,zoom:at,bearing:_,pitch:b}}_extendAABB(a,c,f,_){let b=.5*((f.padding.left||0)+(f.padding.right||0)),w=.5*((f.padding.top||0)+(f.padding.bottom||0)),I=w,k=b,O=b,F=w,z=c.width-(k+O),V=c.height-(I+F),G=r.ad.vec3.sub([],a.max,a.min),K=Math.min(z/G[0],V/G[1]),W=Math.min(c.scaleZoom(c.scale*K),f.maxZoom);if(isNaN(W))return null;let te=c.scale/c.zoomScale(W),ne=new r.ce([a.min[0]-k*te,a.min[1]-F*te,a.min[2]],[a.max[0]+O*te,a.max[1]+I*te,a.max[2]]),he=(typeof f.offset.x=="number"&&typeof f.offset.y=="number"?new r.P(f.offset.x,f.offset.y):r.P.convert(f.offset)).rotate(-r.ak(_));return ne.center[0]-=he.x*te,ne.center[1]+=he.y*te,ne}queryTerrainElevation(a,c){let f=this.transform.elevation;return f?(c=r.l({},{exaggerated:!0},c),f.getAtPoint(r.ac.fromLngLat(a),null,c.exaggerated)):null}_cameraForBounds(a,c,f,_,b,w){if(a.projection.name==="globe")return this._cameraForBoundsOnGlobe(a,c,f,_,b,w);let I=a.clone(),k=this._extendCameraOptions(w);I.bearing=_,I.pitch=b;let O=r.bO.convert(c),F=r.bO.convert(f),z=new r.bO(O.lng,F.lat),V=new r.bO(F.lng,O.lat),G=I.project(O),K=I.project(F),W=this.queryTerrainElevation(O),te=this.queryTerrainElevation(F),ne=this.queryTerrainElevation(z),he=this.queryTerrainElevation(V),_e=[[G.x,G.y,Math.min(W||0,te||0,ne||0,he||0)],[K.x,K.y,Math.max(W||0,te||0,ne||0,he||0)]],me=r.ce.fromPoints(_e),Se=I.getWorldToCameraMatrix(),ve=r.ad.mat4.invert(new Float64Array(16),Se);me=r.ce.applyTransform(me,Se);let be=this._extendAABB(me,I,k,_);if(!be)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");me=be;let xe=.5*r.ad.vec3.sub([],me.max,me.min)[2],Ae=this._minimumAABBFrustumDistance(I,me),Oe=[0,0,1,0];r.ad.vec4.transformMat4(Oe,Oe,Se),r.ad.vec4.normalize(Oe,Oe);let Ke=r.ad.vec3.scale([],Oe,Ae+xe),$e=r.ad.vec3.add([],me.center,Ke);r.ad.vec3.transformMat4(me.center,me.center,ve),r.ad.vec3.transformMat4($e,$e,ve);let ct=I.unproject(new r.P(me.center[0],me.center[1])),ut=r.dH(I.projection,ct),St=Math.pow(2,ut),He=Math.min(I._zoomFromMercatorZ($e[2]*I.pixelsPerMeter*St/I.worldSize),k.maxZoom);return I.mercatorFromTransition&&He<.5*(r.c6+r.bY)?(I.setProjection({name:"globe"}),I.zoom=He,this._cameraForBounds(I,c,f,_,b,w)):{center:ct,zoom:He,bearing:_,pitch:b}}fitBounds(a,c,f){let _=this.cameraForBounds(a,c);return this._fitInternal(_,c,f)}fitScreenCoordinates(a,c,f,_,b){let w=r.P.convert(a),I=r.P.convert(c),k=new r.P(Math.min(w.x,I.x),Math.min(w.y,I.y)),O=new r.P(Math.max(w.x,I.x),Math.max(w.y,I.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(w,I))return this;let F=this.transform.pointLocation3D(k),z=this.transform.pointLocation3D(O),V=this.transform.pointLocation3D(new r.P(k.x,O.y)),G=this.transform.pointLocation3D(new r.P(O.x,k.y)),K=[Math.min(F.lng,z.lng,V.lng,G.lng),Math.min(F.lat,z.lat,V.lat,G.lat)],W=[Math.max(F.lng,z.lng,V.lng,G.lng),Math.max(F.lat,z.lat,V.lat,G.lat)],te=_&&_.pitch?_.pitch:this.getPitch(),ne=this._cameraForBounds(this.transform,K,W,f,te,_);return this._fitInternal(ne,_,b)}_fitInternal(a,c,f){return a?(c=r.l(a,c)).linear?this.easeTo(c,f):this.flyTo(c,f):this}jumpTo(a,c){this.stop();let f=a.preloadOnly?this.transform.clone():this.transform,_=!1,b=!1,w=!1;"zoom"in a&&f.zoom!==+a.zoom&&(_=!0,f.zoom=+a.zoom),a.center!==void 0&&(f.center=r.bO.convert(a.center)),"bearing"in a&&f.bearing!==+a.bearing&&(b=!0,f.bearing=+a.bearing),"pitch"in a&&f.pitch!==+a.pitch&&(w=!0,f.pitch=+a.pitch);let I=typeof a.padding=="number"?this._extendPadding(a.padding):a.padding;if(a.padding!=null&&!f.isPaddingEqual(I))if(a.retainPadding===!1){let k=f.clone();k.padding=I,f.setLocationAtPoint(f.center,k.centerPoint)}else f.padding=I;return a.preloadOnly?(this._preloadTiles(f),this):(this.fire(new r.A("movestart",c)).fire(new r.A("move",c)),_&&this.fire(new r.A("zoomstart",c)).fire(new r.A("zoom",c)).fire(new r.A("zoomend",c)),b&&this.fire(new r.A("rotatestart",c)).fire(new r.A("rotate",c)).fire(new r.A("rotateend",c)),w&&this.fire(new r.A("pitchstart",c)).fire(new r.A("pitch",c)).fire(new r.A("pitchend",c)),this.fire(new r.A("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||r.w($w),this.transform.getFreeCameraOptions()}setFreeCameraOptions(a,c){let f=this.transform;if(!f.projection.supportsFreeCamera)return r.w($w),this;this.stop();let _=f.zoom,b=f.pitch,w=f.bearing;f.setFreeCameraOptions(a);let I=_!==f.zoom,k=b!==f.pitch,O=w!==f.bearing;return this.fire(new r.A("movestart",c)).fire(new r.A("move",c)),I&&this.fire(new r.A("zoomstart",c)).fire(new r.A("zoom",c)).fire(new r.A("zoomend",c)),O&&this.fire(new r.A("rotatestart",c)).fire(new r.A("rotate",c)).fire(new r.A("rotateend",c)),k&&this.fire(new r.A("pitchstart",c)).fire(new r.A("pitch",c)).fire(new r.A("pitchend",c)),this.fire(new r.A("moveend",c)),this}easeTo(a,c){this._stop(!1,a.easeId),((a=r.l({offset:[0,0],duration:500,easing:r.dD},a)).animate===!1||this._prefersReducedMotion(a))&&(a.duration=0);let f=this.transform,_=this.getZoom(),b=this.getBearing(),w=this.getPitch(),I=this.getPadding(),k="zoom"in a?+a.zoom:_,O="bearing"in a?this._normalizeBearing(a.bearing,b):b,F="pitch"in a?+a.pitch:w,z=this._extendPadding(a.padding),V=r.P.convert(a.offset),G,K,W;if(f.projection.name==="globe"){let Oe=r.ac.fromLngLat(f.center),Ke=V.rotate(-f.angle);Oe.x+=Ke.x/f.worldSize,Oe.y+=Ke.y/f.worldSize;let $e=Oe.toLngLat(),ct=r.bO.convert(a.center||$e);this._normalizeCenter(ct),G=f.centerPoint.add(Ke),K=new r.P(Oe.x,Oe.y).mult(f.worldSize),W=new r.P(r.av(ct.lng),r.aC(ct.lat)).mult(f.worldSize).sub(K)}else{G=f.centerPoint.add(V);let Oe=f.pointLocation(G),Ke=r.bO.convert(a.center||Oe);this._normalizeCenter(Ke),K=f.project(Oe),W=f.project(Ke).sub(K)}let te=f.zoomScale(k-_),ne,he;a.around&&(ne=r.bO.convert(a.around),he=f.locationPoint(ne));let _e=this._zooming||k!==_,me=this._rotating||b!==O,Se=this._pitching||F!==w,ve=!f.isPaddingEqual(z),be=a.retainPadding===!1?f.clone():f,xe=Oe=>Ke=>{if(_e&&(Oe.zoom=r.ah(_,k,Ke)),me&&(Oe.bearing=r.ah(b,O,Ke)),Se&&(Oe.pitch=r.ah(w,F,Ke)),ve&&(be.interpolatePadding(I,z,Ke),G=be.centerPoint.add(V)),ne)Oe.setLocationAtPoint(ne,he);else{let $e=Oe.zoomScale(Oe.zoom-_),ct=k>_?Math.min(2,te):Math.max(.5,te),ut=Math.pow(ct,1-Ke),St=Oe.unproject(K.add(W.mult(Ke*ut)).mult($e));Oe.setLocationAtPoint(Oe.renderWorldCopies?St.wrap():St,G)}return a.preloadOnly||this._fireMoveEvents(c),Oe};if(a.preloadOnly){let Oe=this._emulate(xe,a.duration,f);return this._preloadTiles(Oe),this}let Ae={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=_e,this._rotating=me,this._pitching=Se,this._padding=ve,this._easeId=a.easeId,this._prepareEase(c,a.noMoveStart,Ae),this._ease(xe(f),Oe=>{f.cameraElevationReference==="sea"&&f.recenterOnTerrain(),this._afterEase(c,Oe)},a),this}_prepareEase(a,c,f={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),c||f.moving||this.fire(new r.A("movestart",a)),this._zooming&&!f.zooming&&this.fire(new r.A("zoomstart",a)),this._rotating&&!f.rotating&&this.fire(new r.A("rotatestart",a)),this._pitching&&!f.pitching&&this.fire(new r.A("pitchstart",a))}_fireMoveEvents(a){this.fire(new r.A("move",a)),this._zooming&&this.fire(new r.A("zoom",a)),this._rotating&&this.fire(new r.A("rotate",a)),this._pitching&&this.fire(new r.A("pitch",a))}_afterEase(a,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";let f=this._zooming,_=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new r.A("zoomend",a)),_&&this.fire(new r.A("rotateend",a)),b&&this.fire(new r.A("pitchend",a)),this.fire(new r.A("moveend",a))}flyTo(a,c){if(this._prefersReducedMotion(a)){let rt=r.aA(a,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(rt,c)}this.stop(),a=r.l({offset:[0,0],speed:1.2,curve:1.42,easing:r.dD},a);let f=this.transform,_=this.getZoom(),b=this.getBearing(),w=this.getPitch(),I=this.getPadding(),k="zoom"in a?r.ay(+a.zoom,f.minZoom,f.maxZoom):_,O="bearing"in a?this._normalizeBearing(a.bearing,b):b,F="pitch"in a?+a.pitch:w,z=this._extendPadding(a.padding),V=f.zoomScale(k-_),G=r.P.convert(a.offset),K=f.centerPoint.add(G),W=f.pointLocation(K),te=r.bO.convert(a.center||W);this._normalizeCenter(te);let ne=f.project(W),he=f.project(te).sub(ne),_e=a.curve,me=Math.max(f.width,f.height),Se=me/V,ve=he.mag();if("minZoom"in a){let rt=r.ay(Math.min(a.minZoom,_,k),f.minZoom,f.maxZoom),ht=me/f.zoomScale(rt-_);_e=Math.sqrt(ht/ve*2)}let be=_e*_e;function xe(rt){let ht=(Se*Se-me*me+(rt?-1:1)*be*be*ve*ve)/(2*(rt?Se:me)*be*ve);return Math.log(Math.sqrt(ht*ht+1)-ht)}function Ae(rt){return(Math.exp(rt)-Math.exp(-rt))/2}function Oe(rt){return(Math.exp(rt)+Math.exp(-rt))/2}let Ke=xe(0),$e=function(rt){return Oe(Ke)/Oe(Ke+_e*rt)},ct=function(rt){return me*((Oe(Ke)*(Ae(ht=Ke+_e*rt)/Oe(ht))-Ae(Ke))/be)/ve;var ht},ut=(xe(1)-Ke)/_e;if(Math.abs(ve)<1e-6||!isFinite(ut)){if(Math.abs(me-Se)<1e-6)return this.easeTo(a,c);let rt=Se<me?-1:1;ut=Math.abs(Math.log(Se/me))/_e,ct=function(){return 0},$e=function(ht){return Math.exp(rt*_e*ht)}}a.duration="duration"in a?+a.duration:1e3*ut/("screenSpeed"in a?+a.screenSpeed/_e:+a.speed),a.maxDuration&&a.duration>a.maxDuration&&(a.duration=0);let St=b!==O,He=F!==w,st=!f.isPaddingEqual(z),je=a.retainPadding===!1?f.clone():f,at=rt=>ht=>{let Qe=ht*ut,mt=1/$e(Qe);rt.zoom=ht===1?k:_+rt.scaleZoom(mt),St&&(rt.bearing=r.ah(b,O,ht)),He&&(rt.pitch=r.ah(w,F,ht)),st&&(je.interpolatePadding(I,z,ht),K=je.centerPoint.add(G));let Nt=ht===1?te:rt.unproject(ne.add(he.mult(ct(Qe))).mult(mt));return rt.setLocationAtPoint(rt.renderWorldCopies?Nt.wrap():Nt,K),rt._updateCameraOnTerrain(),a.preloadOnly||this._fireMoveEvents(c),rt};if(a.preloadOnly){let rt=this._emulate(at,a.duration,f);return this._preloadTiles(rt),this}return this._zooming=!0,this._rotating=St,this._pitching=He,this._padding=st,this._prepareEase(c,!1),this._ease(at(f),()=>this._afterEase(c),a),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(a){}_cancelRenderFrame(a){}_stop(a,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){let f=this._onEaseEnd;this._onEaseEnd=void 0,f.call(this,c)}if(!a){let f=this.handlers;f&&f.stop(!1)}return this}_ease(a,c,f){f.animate===!1||f.duration===0?(a(1),c()):(this._easeStart=r.q.now(),this._easeOptions=f,this._onEaseFrame=a,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){let a=Math.min((r.q.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(a)),a<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(a,c){a=r.bF(a,-180,180);let f=Math.abs(a-c);return Math.abs(a-360-c)<f&&(a-=360),Math.abs(a+360-c)<f&&(a+=360),a}_normalizeCenter(a){let c=this.transform;if(c.maxBounds||c.projection.name!=="globe"&&!c.renderWorldCopies)return;let f=a.lng-c.center.lng;a.lng+=f>180?-360:f<-180?360:0}_prefersReducedMotion(a){return this._respectPrefersReducedMotion&&r.q.prefersReducedMotion&&!(a&&a.essential)}_emulate(a,c,f){let _=Math.ceil(15*c/1e3),b=[],w=a(f.clone());for(let I=0;I<=_;I++){let k=w(I/_);b.push(k.clone())}return b}_preloadTiles(a,c){}}class Bg{constructor(a={}){this.options=a,r.aQ(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(a){let c=this.options&&this.options.compact,f=a._getUIString("AttributionControl.ToggleAttribution");this._map=a,this._container=re("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=re("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",f);let _=re("span","mapboxgl-ctrl-icon",this._compactButton);return _.setAttribute("aria-hidden","true"),_.setAttribute("title",f),this._innerContainer=re("div","mapboxgl-ctrl-attrib-inner",this._container),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),c===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let a=this._editLink;a||(a=this._editLink=this._container.querySelector(".mapbox-improve-map"));let c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||r.e.ACCESS_TOKEN}];if(a){let f=c.reduce((_,b,w)=>(b.value&&(_+=`${b.key}=${b.value}${w<c.length-1?"&":""}`),_),"?");a.href=`${r.e.FEEDBACK_URL}/${f}#${Zv(this._map,!0)}`,a.rel="noopener nofollow"}}_updateData(a){!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let a=[];if(this._map.style.stylesheet){let _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}let c=this._map.style._mergedSourceCaches;for(let _ in c){let b=c[_];if(b.used){let w=b.getSource();w.attribution&&a.indexOf(w.attribution)<0&&a.push(w.attribution)}}a.sort((_,b)=>_.length-b.length),a=a.filter((_,b)=>{for(let w=b+1;w<a.length;w++)if(a[w].indexOf(_)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=[...this.options.customAttribution,...a]:a.unshift(this.options.customAttribution));let f=a.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,a.length?(this._innerContainer.innerHTML=f,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class bs{constructor(){r.aQ(["_updateLogo","_updateCompact"],this)}onAdd(a){this._map=a,this._container=re("div","mapboxgl-ctrl");let c=re("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(a){a&&a.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;let a=this._map.style._sourceCaches;if(Object.entries(a).length===0)return!0;for(let c in a){let f=a[c].getSource();if(f.hasOwnProperty("mapbox_logo")&&!f.mapbox_logo)return!1}return!0}_updateCompact(){let a=this._container.children;if(a.length){let c=a[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class xs{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(a){let c=++this._id;return this._queue.push({callback:a,id:c,cancelled:!1}),c}remove(a){let c=this._currentlyRunning,f=c?this._queue.concat(c):this._queue;for(let _ of f)if(_.id===a)return void(_.cancelled=!0)}run(a=0){let c=this._currentlyRunning=this._queue;this._queue=[];for(let f of c)if(!f.cancelled&&(f.callback(a),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class kh{constructor(a){this.jumpTo(a)}getValue(a){if(a<=this._startTime)return this._start;if(a>=this._endTime)return this._end;let c=r.cC((a-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(a){return a>=this._startTime&&a<=this._endTime}jumpTo(a){this._startTime=-1/0,this._endTime=-1/0,this._start=a,this._end=a}easeTo(a,c,f){this._start=this.getValue(c),this._end=a,this._startTime=c,this._endTime=c+f}}let uu={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class hu extends r.A{constructor(a,c,f,_){let{point:b,lngLat:w,originalEvent:I,target:k}=a;super(a.type,{point:b,lngLat:w,originalEvent:I,target:k}),this.preventDefault=()=>{a.preventDefault()},this.id=c,this.interaction=f,this.feature=_}}class t0{constructor(a){this.map=a,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(a,c){if(this.typeById.has(a))throw new Error(`Interaction id "${a}" already exists.`);let f=c.filter,_=c.type;f&&this.filters.set(a,r.a_(f)),_==="mouseover"&&(_="mouseenter"),_==="mouseout"&&(_="mouseleave");let b=this.interactionsByType.get(_)||new Map;_==="mouseenter"||_==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(a,c)):b.size===0&&this.map.on(_,this.handleType),b.size===0&&this.interactionsByType.set(_,b),b.set(a,c),this.typeById.set(a,_)}get(a){let c=this.typeById.get(a);if(!c)return;let f=this.interactionsByType.get(c);return f?f.get(a):void 0}remove(a){let c=this.typeById.get(a);if(!c)return;this.typeById.delete(a),this.filters.delete(a);let f=this.interactionsByType.get(c);f&&(f.delete(a),c==="mouseenter"||c==="mouseleave"?(this.delegatedInteractions.delete(a),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):f.size===0&&this.map.off(c,this.handleType))}queryTargets(a,c){let f=[];for(let[_,b]of c)b.target&&f.push({targetId:_,target:b.target,filter:this.filters.get(_)});return this.map.style.queryRenderedTargets(a,f,this.map.transform)}handleMove(a){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;let c=this.queryTargets(a.point,Array.from(this.delegatedInteractions).reverse());c.length&&(a.type="mouseenter",this.handleType(a,c));let f=new Map;for(let[_,{feature:b}]of this.prevHoveredFeatures)this.hoveredFeatures.has(_)||f.set(b.id,b);f.size&&(a.type="mouseleave",this.handleType(a,Array.from(f.values())))}handleOut(a){let c=Array.from(this.hoveredFeatures.values()).map(({feature:f})=>f);c.length&&(a.type="mouseleave",this.handleType(a,c)),this.hoveredFeatures.clear()}handleType(a,c){let f=Array.from(this.interactionsByType.get(a.type)).reverse(),_=!!c;c=c||this.queryTargets(a.point,f);let b=a.type==="mouseenter",w=!1,I=new Set;for(let k of c){for(let[O,F]of f){if(!F.target)continue;let z=k.variants?k.variants[O]:null;if(z){for(let V of z){if(Xu(V,k,I,O))continue;let G=new r.cx(k,V),K=Kp(V,k,O);_&&(G.state=this.map.getFeatureState(G));let W=b?this.prevHoveredFeatures.get(K):null,te=new hu(a,O,F,G),ne=W?W.stop:F.handler(te);if(b&&this.hoveredFeatures.set(K,{feature:k,stop:ne}),ne!==!1){w=!0;break}}if(w)break}}if(w)break}if(!w)for(let[k,O]of f){let{handler:F,target:z}=O;if(!z&&F(new hu(a,k,O,null))!==!1)break}}}function Sn(m,a){if(Array.isArray(m)&&Array.isArray(a)){let c=new Set(m),f=new Set(a);return c.size===f.size&&m.every(_=>f.has(_))}return r.bn(m,a)}let _d={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},JM={showCompass:!0,showZoom:!0,visualizePitch:!1};class eT{constructor(a,c,f=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new Fl({clickTolerance:a.dragRotate._mouseRotate._clickTolerance}),this.map=a,f&&(this.mousePitch=new If({clickTolerance:a.dragRotate._mousePitch._clickTolerance})),r.aQ(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(a,c){this.mouseRotate.mousedown(a,c),this.mousePitch&&this.mousePitch.mousedown(a,c),Ce()}move(a,c){let f=this.map,_=this.mouseRotate.mousemoveWindow(a,c),b=_&&_.bearingDelta;if(b&&f.setBearing(f.getBearing()+b),this.mousePitch){let w=this.mousePitch.mousemoveWindow(a,c),I=w&&w.pitchDelta;I&&f.setPitch(f.getPitch()+I)}}off(){let a=this.element;a.removeEventListener("mousedown",this.mousedown),a.removeEventListener("touchstart",this.touchstart,{passive:!1}),a.removeEventListener("touchmove",this.touchmove),a.removeEventListener("touchend",this.touchend),a.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Te(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(a){this.down(r.l({},a,{ctrlKey:!0,preventDefault:()=>a.preventDefault()}),Pt(this.element,a)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(a){this.move(a,Pt(this.element,a))}mouseup(a){this.mouseRotate.mouseupWindow(a),this.mousePitch&&this.mousePitch.mouseupWindow(a),this.offTemp()}touchstart(a){a.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Lt(this.element,a.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>a.preventDefault()},this._startPos))}touchmove(a){a.targetTouches.length!==1?this.reset():(this._lastPos=Lt(this.element,a.targetTouches)[0],this.move({preventDefault:()=>a.preventDefault()},this._lastPos))}touchend(a){a.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Vg(m,a,c){if(m=new r.bO(m.lng,m.lat),a){let f=new r.bO(m.lng-360,m.lat),_=new r.bO(m.lng+360,m.lat),b=360*Math.ceil(Math.abs(m.lng-c.center.lng)/360),w=c.locationPoint3D(m).distSqr(a),I=a.x<0||a.y<0||a.x>c.width||a.y>c.height;c.locationPoint3D(f).distSqr(a)<w&&(I||Math.abs(f.lng-c.center.lng)<b)?m=f:c.locationPoint3D(_).distSqr(a)<w&&(I||Math.abs(_.lng-c.center.lng)<b)&&(m=_)}for(;Math.abs(m.lng-c.center.lng)>180;){let f=c.locationPoint3D(m);if(f.x>=0&&f.y>=0&&f.x<=c.width&&f.y<=c.height)break;m.lng>c.center.lng?m.lng-=360:m.lng+=360}return m}let Ll={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},Ja={anchor:"center",color:"#3FB1CE",scale:1,draggable:!1,clickTolerance:0,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class ea extends r.E{constructor(a,c){super(),(a instanceof HTMLElement||c)&&(a=r.l({element:a},c)),r.aQ(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),a=r.l({},Ja,a),this._anchor=a.anchor,this._color=a.color,this._scale=a.scale,this._draggable=a.draggable,this._clickTolerance=a.clickTolerance,this._rotation=a.rotation,this._rotationAlignment=a.rotationAlignment,this._pitchAlignment=a.pitchAlignment,this._occludedOpacity=a.occludedOpacity,this._altitude=a.altitude,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),a&&a.element?(this._element=a.element,this._offset=r.P.convert(a&&a.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=r.P.convert(a&&a.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",b=>{b.preventDefault()}),this._element.addEventListener("mousedown",b=>{b.preventDefault()});let f=this._element.classList;for(let b in Ll)f.remove(`mapboxgl-marker-anchor-${b}`);f.add(`mapboxgl-marker-anchor-${this._anchor}`);let _=a&&a.className?a.className.trim().split(/\s+/):[];f.add(..._),this._popup=null}_createDefaultMarker(){let a=re("div"),c=X("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},a);if(this._altitude===0){let f=X("radialGradient",{id:"shadowGradient"},X("defs",{},c));X("stop",{offset:"10%","stop-opacity":.4},f),X("stop",{offset:"100%","stop-opacity":.05},f),X("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},c)}return X("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},c),X("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},c),X("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},c),a}addTo(a){return a===this._map||(this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._updateMoving),a.on("moveend",this._update),a.on("remove",this._clearFadeTimer),a._addMarker(this),this.setDraggable(this._draggable),this._update(),a.on("click",this._onMapClick)),this}remove(){let a=this._map;return a&&(a.off("click",this._onMapClick),a.off("move",this._updateMoving),a.off("moveend",this._update),a.off("mousedown",this._addDragHandler),a.off("touchstart",this._addDragHandler),a.off("mouseup",this._onUp),a.off("touchend",this._onUp),a.off("mousemove",this._onMove),a.off("touchmove",this._onMove),a.off("remove",this._clearFadeTimer),a._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(a){return this._lngLat=r.bO.convert(a),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(a){return a===this._altitude||(this._defaultMarker&&(this._altitude===0&&a!==0||this._altitude!==0&&a===0)&&(this._element=this._createDefaultMarker()),this._altitude=a||Ja.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(a){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),a){if(!("offset"in a.options)){let _=Math.sqrt(Math.pow(13.5,2)/2);a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=a,a._marker=this,a._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(a){let c=a.code,f=a.charCode||a.keyCode;c!=="Space"&&c!=="Enter"&&f!==32&&f!==13||this.togglePopup()}_onMapClick(a){let c=a.originalEvent.target,f=this._element;this._popup&&(c===f||f.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){let a=this._popup;return a?(a.isOpen()?(a.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(a.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){let a=this._map,c=this._pos;if(!a||!c)return!1;let f=a.unproject(c,this._altitude),_=a.getFreeCameraOptions();if(!_.position)return!1;let b=_.position.toLngLat();return b.distanceTo(f)<.9*b.distanceTo(this._lngLat)}_evaluateOpacity(){let a=this._map;if(!a)return;let c=this._pos;if(!c||c.x<0||c.x>a.transform.width||c.y<0||c.y>a.transform.height)return void this._clearFadeTimer();let f=a.unproject(c,this._altitude),_;a._showingGlobe()&&r.dK(a.transform,this._lngLat)?_=0:(_=1-a._queryFogOpacity(f),a.transform._terrainEnabled()&&a.getTerrain()&&this._behindTerrain()&&(_*=this._occludedOpacity)),this._element.style.opacity=`${_}`,this._element.style.pointerEvents=_>0?"auto":"none",this._popup&&this._popup._setOpacity(_),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){let a=this._pos;if(!a||!this._map)return;let c=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${a.x}px,${a.y}px)
            ${Ll[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${c.x}px,${c.y}px)
        `}_calculateXYTransform(){let a=this._pos,c=this._map,f=this.getPitchAlignment();if(!c||!a||f!=="map")return"";if(!c._showingGlobe()){let k=c.getPitch();return k?`rotateX(${k}deg)`:""}let _=r.c4(r.dL(c.transform,this._lngLat)),b=a.sub(r.dM(c.transform)),w=Math.abs(b.x)+Math.abs(b.y);if(w===0)return"";let I=_/w;return`rotateX(${-b.y*I}deg) rotateY(${b.x*I}deg)`}_calculateZTransform(){let a=this._pos,c=this._map;if(!c||!a)return"";let f=0,_=this.getRotationAlignment();if(_==="map")if(c._showingGlobe()){let b=c.project(new r.bO(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),w=c.project(new r.bO(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(b);f=r.c4(Math.atan2(w.y,w.x))-90}else f=-c.getBearing();else if(_==="horizon"){let b=r.ae(4,6,c.getZoom()),w=r.dM(c.transform);w.y+=b*c.transform.height;let I=a.sub(w),k=r.c4(Math.atan2(I.y,I.x));f=(k>90?k-270:k+90)*(1-b)}return f+=this._rotation,f?`rotateZ(${f}deg)`:""}_update(a){cancelAnimationFrame(this._updateFrameId);let c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=Vg(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat,this._altitude),a===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),c._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._showingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(a){return this._offset=r.P.convert(a),this._update(),this}addClassName(a){return this._element.classList.add(a),this}removeClassName(a){return this._element.classList.remove(a),this}toggleClassName(a){return this._element.classList.toggle(a)}_onMove(a){let c=this._map;if(!c)return;let f=this._pointerdownPos,_=this._positionDelta;if(f&&_){if(!this._isDragging){let b=this._clickTolerance||c._clickTolerance;if(a.point.dist(f)<b)return;this._isDragging=!0}this._pos=a.point.sub(_),this._lngLat=c.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new r.A("dragstart"))),this.fire(new r.A("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;let a=this._map;a&&(a.off("mousemove",this._onMove),a.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new r.A("dragend")),this._state="inactive"}_addDragHandler(a){let c=this._map,f=this._pos;c&&f&&this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(f),this._pointerdownPos=a.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(a){this._draggable=!!a;let c=this._map;return c&&(a?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(a){return this._rotation=a||Ja.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(a){return this._rotationAlignment=a||Ja.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(a){return this._pitchAlignment=a||Ja.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(a){return this._occludedOpacity=a||Ja.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}let es={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Ho={maxWidth:100,unit:"metric"},i0={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Nr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},Gw=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function yd(m=new r.P(0,0),a="bottom"){if(typeof m=="number"){let c=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(a){case"top":return new r.P(0,m);case"top-left":return new r.P(c,c);case"top-right":return new r.P(-c,c);case"bottom":return new r.P(0,-m);case"bottom-left":return new r.P(c,-c);case"bottom-right":return new r.P(-c,-c);case"left":return new r.P(m,0);case"right":return new r.P(-m,0)}return new r.P(0,0)}return m instanceof r.P||Array.isArray(m)?r.P.convert(m):r.P.convert(m[a]||[0,0])}return{version:y,supported:le.supported,setRTLTextPlugin:r.dN,getRTLTextPluginStatus:r.dO,Map:class extends Rh{constructor(m){P.mark(A.create);let a=m;if((m=r.l({},_d,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&r.dI(window)&&(m.antialias=!1,r.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Jm(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies,null,null),m),this._repaint=!!m.repaint,this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new xs,this._domRenderTaskQueue=new xs,this._controls=[],this._markers=[],this._popups=[],this._mapId=r.aW(),this._locale=r.l({},uu,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._tessellationStep=m.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=m.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new kh(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=m.scaleFactor,this._requestManager=new Ft(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,this._contextCreateOptions=m.contextCreateOptions?Object.assign({},m.contextCreateOptions):{},typeof m.container=="string"){let c=document.getElementById(m.container);if(!c)throw new Error(`Container '${m.container.toString()}' not found.`);this._container=c}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&r.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),this._spriteFormat=m.spriteFormat,r.aQ(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Hv),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Hw(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,(m.style||!m.testMode)&&this.setStyle(m.style||r.e.DEFAULT_STYLE,{config:m.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),this.indoor=new rw(this),m.hash&&(this._hash=new Yv(typeof m.hash=="string"&&m.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){a.center==null&&a.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch});let c=m.bounds;c&&(this.resize(),this.fitBounds(c,r.l({},m.fitBoundsOptions,{duration:0})))}this.resize(),m.attributionControl&&this.addControl(new Bg({customAttribution:m.customAttribution})),this._logoControl=new bs,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",c=>{this._update(c.dataType==="style"),this.fire(new r.A(`${c.dataType}data`,c))}),this.on("dataloading",c=>{this.fire(new r.A(`${c.dataType}dataloading`,c))}),this._interactions=new t0(this)}_getMapId(){return this._mapId}addControl(m,a){if(a===void 0&&(a=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new r.z(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let c=m.onAdd(this);this._controls.push(m);let f=this._controlPositions[a];return a.indexOf("bottom")!==-1?f.insertBefore(c,f.firstChild):f.appendChild(c),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new r.z(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let a=this._controls.indexOf(m);return a>-1&&this._controls.splice(a,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));let a=!this._moving;return a&&this.fire(new r.A("movestart",m)).fire(new r.A("move",m)),this.fire(new r.A("resize",m)),a&&this.fire(new r.A("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(r.aB.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new r.A("zoomstart")).fire(new r.A("zoom")).fire(new r.A("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new r.A("zoomstart")).fire(new r.A("zoom")).fire(new r.A("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new r.A("pitchstart")).fire(new r.A("pitch")).fire(new r.A("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new r.A("pitchstart")).fire(new r.A("pitch")).fire(new r.A("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(m){return this._scaleFactor=m,this.painter.scaleFactor=m,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(a=>a.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return m==="auto"?navigator.language:Array.isArray(m)?m.length===0?void 0:m.map(a=>a==="auto"?navigator.language:a):m}setLanguage(m){let a=this._parseLanguage(m);if(!this.style||a===this._language)return this;this._language=a,this.style.reloadSources();for(let c of this._controls)c._setLanguage&&c._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(m){return this._lazyInitEmptyStyle(),m?typeof m=="string"&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;let m=this.transform,a=m.projection.name,c;a==="globe"&&m.zoom>=r.bY?(m.setMercatorFromTransition(),c=!0):a==="mercator"&&m.zoom<r.bY&&(m.setProjection({name:"globe"}),c=!0),c&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(m,a){return this._updateProjection(m||a||{name:"mercator"})}_updateProjection(m){let a;return a=m.name==="globe"&&this.transform.zoom>=r.bY?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),a&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(m,a){return this.transform.locationPoint3D(r.bO.convert(m),a)}unproject(m,a){return this.transform.pointLocation3D(r.P.convert(m),a)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,a,c){let f=_=>{let b=[];if(Array.isArray(a)){let w=a.filter(I=>this.getLayer(I));b=w.length?this.queryRenderedFeatures(_,{layers:w}):[]}else b=this.queryRenderedFeatures(_,{target:a});return b};if(m==="mouseenter"||m==="mouseover"){let _=!1;return{listener:c,targets:a,delegates:{mousemove:w=>{let I=f(w.point);I.length?_||(_=!0,c.call(this,new Qa(m,this,w.originalEvent,{features:I}))):_=!1},mouseout:()=>{_=!1}}}}if(m==="mouseleave"||m==="mouseout"){let _=!1;return{listener:c,targets:a,delegates:{mousemove:I=>{f(I.point).length?_=!0:_&&(_=!1,c.call(this,new Qa(m,this,I.originalEvent)))},mouseout:I=>{_&&(_=!1,c.call(this,new Qa(m,this,I.originalEvent)))}}}}{let _=b=>{let w=f(b.point);w.length&&(b.features=w,c.call(this,b),delete b.features)};return{listener:c,targets:a,delegates:{[m]:_}}}}on(m,a,c){if(typeof a=="function"||c===void 0)return super.on(m,a);if(typeof a=="string"&&(a=[a]),!this._areTargetsValid(a))return this;let f=this._createDelegatedListener(m,a,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(f);for(let _ in f.delegates)this.on(_,f.delegates[_]);return this}once(m,a,c){if(typeof a=="function"||c===void 0)return super.once(m,a);if(typeof a=="string"&&(a=[a]),!this._areTargetsValid(a))return this;let f=this._createDelegatedListener(m,a,c);for(let _ in f.delegates)this.once(_,f.delegates[_]);return this}off(m,a,c){if(typeof a=="function"||c===void 0)return super.off(m,a);if(typeof a=="string"&&(a=[a]),!this._areTargetsValid(a))return this;let f=this._delegatedListeners?this._delegatedListeners[m]:void 0;return f&&(_=>{for(let b=0;b<_.length;b++){let w=_[b];if(w.listener===c&&Sn(w.targets,a)){for(let I in w.delegates)this.off(I,w.delegates[I]);return _.splice(b,1),this}}})(f),this}queryRenderedFeatures(m,a){if(!this.style)return[];if(m===void 0||m instanceof r.P||Array.isArray(m)||a!==void 0||(a=m,m=void 0),m=m||[[0,0],[this.transform.width,this.transform.height]],!a){let b=this.style.queryRenderedFeatures(m,void 0,this.transform),w=this.style.queryRenderedFeatureset(m,void 0,this.transform);return b.concat(w)}let c=!0;if(a.target&&(c=this._isTargetValid(a.target),c&&!a.layers))return this.style.queryRenderedFeatureset(m,a,this.transform);let f=!0;if(a.layers&&Array.isArray(a.layers)){for(let b of a.layers)if(!this._isValidId(b)){f=!1;break}if(f&&!a.target)return this.style.queryRenderedFeatures(m,a,this.transform)}let _=[];return f&&(_=_.concat(this.style.queryRenderedFeatures(m,a,this.transform))),c&&(_=_.concat(this.style.queryRenderedFeatureset(m,a,this.transform))),_}querySourceFeatures(m,a){return!m||typeof m=="string"&&!this._isValidId(m)?[]:this.style.querySourceFeatures(m,a)}isPointOnSurface(m){let{name:a}=this.transform.projection;return a!=="globe"&&a!=="mercator"&&r.w(`${a} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(r.P.convert(m))}addInteraction(m,a){return this._interactions.add(m,a),this}removeInteraction(m){return this._interactions.remove(m),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(m){return this._cooperativeGestures=m,this}setStyle(m,a){return a=r.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},a),this.style&&m&&a.diff!==!1&&a.localFontFamily===this._localFontFamily&&a.localIdeographFontFamily===this._localIdeographFontFamily&&!a.config?(this.style._diffStyle(m,(c,f)=>{c?(r.w(`Unable to perform style diff: ${String(c.message||c.error||c)}. Rebuilding the style from scratch.`),this._updateStyle(m,a)):f&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=a.localIdeographFontFamily,this._localFontFamily=a.localFontFamily,this._updateStyle(m,a))}_getUIString(m){let a=this._locale[m];if(a==null)throw new Error(`Missing UI string '${m}'`);return a}_updateStyle(m,a){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m){let c=r.l({},a);a&&a.config&&(c.initialConfig=a.config,delete c.config),this.style=new ml(this,c).load(m),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ml(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(r.w("There is no style added to the map."),!1)}_isValidId(m){return m==null?(this.fire(new r.z(new Error("IDs can't be empty."))),!1):!r.cs(m)||(this.fire(new r.z(new Error(`IDs can't contain special symbols: "${m}".`))),!1)}_isTargetValid(m){return"featuresetId"in m?this._isValidId("importId"in m?m.importId:m.featuresetId):"layerId"in m&&this._isValidId(m.layerId)}_areTargetsValid(m){if(Array.isArray(m)){for(let a of m)if(!this._isValidId(a))return!1;return!0}return this._isTargetValid(m)}addSource(m,a){return this._isValidId(m)?(this._lazyInitEmptyStyle(),this.style.addSource(m,a),this._update(!0)):this}isSourceLoaded(m){return!!this._isValidId(m)&&!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(m,a,c){this._lazyInitEmptyStyle(),this.style.addSourceType(m,a,c)}removeSource(m){return this._isValidId(m)?(this.style.removeSource(m),this._updateTerrain(),this._update(!0)):this}getSource(m){return this._isValidId(m)?this.style.getOwnSource(m):null}addImage(m,a,{pixelRatio:c=1,sdf:f=!1,stretchX:_,stretchY:b,content:w}={}){this._lazyInitEmptyStyle();let I=r.I.from(m);if(a instanceof HTMLImageElement||ImageBitmap&&a instanceof ImageBitmap){let{width:k,height:O,data:F}=r.q.getImageData(a);this.style.addImage(I,{data:new r.r({width:k,height:O},F),pixelRatio:c,stretchX:_,stretchY:b,content:w,sdf:f,version:0,usvg:!1})}else if(a.width===void 0||a.height===void 0)this.fire(new r.z(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{let{width:k,height:O}=a,F=a;this.style.addImage(I,{data:new r.r({width:k,height:O},new Uint8Array(F.data)),pixelRatio:c,stretchX:_,stretchY:b,content:w,sdf:f,usvg:!1,version:0,userImage:F}),F.onAdd&&F.onAdd(this,m)}}updateImage(m,a){this._lazyInitEmptyStyle();let c=r.I.from(m),f=this.style.getImage(c);if(!f)return void this.fire(new r.z(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let _=a instanceof HTMLImageElement||ImageBitmap&&a instanceof ImageBitmap?r.q.getImageData(a):a,{width:b,height:w,data:I}=_;if(b===void 0||w===void 0)return void this.fire(new r.z(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(b!==(f.usvg?f.icon.usvg_tree.width:f.data.width)||w!==(f.usvg?f.icon.usvg_tree.height:f.data.height))return void this.fire(new r.z(new Error(`The width and height of the updated image (${b}, ${w})
                must be that same as the previous version of the image
                (${f.data.width}, ${f.data.height})`)));let k=!(a instanceof HTMLImageElement||ImageBitmap&&a instanceof ImageBitmap),O=!1;f.usvg?(f.data=new r.r({width:b,height:w},new Uint8Array(I)),f.usvg=!1,f.icon=void 0,O=!0):f.data.replace(I,k),this.style.updateImage(c,f,O)}hasImage(m){return m?!!this.style&&!!this.style.getImage(r.I.from(m)):(this.fire(new r.z(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(r.I.from(m))}loadImage(m,a){r.o(this._requestManager.transformRequest(m,r.R.Image),(c,f)=>{a(c,f instanceof HTMLImageElement?r.q.getImageData(f):f)})}listImages(){return this.style.listImages().map(m=>m.name)}addModel(m,a){this._lazyInitEmptyStyle(),this.style.addModel(m,a)}hasModel(m){return m?this.style.hasModel(m):(this.fire(new r.z(new Error("Missing required model id"))),!1)}removeModel(m){this.style.removeModel(m)}listModels(){return this.style.listModels()}addLayer(m,a){return this._isValidId(m.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(m,a),this._update(!0)):this}getSlot(m){let a=this.getLayer(m);return a&&a.slot||null}setSlot(m,a){return this.style.setSlot(m,a),this.style.mergeLayers(),this._update(!0)}addImport(m,a){return this.style.addImport(m,a),this}updateImport(m,a){return typeof a!="string"&&a.id!==m?(this.removeImport(m),this.addImport(a)):(this.style.updateImport(m,a),this._update(!0))}removeImport(m){return this.style.removeImport(m),this}moveImport(m,a){return this.style.moveImport(m,a),this._update(!0)}moveLayer(m,a){return this._isValidId(m)?(this.style.moveLayer(m,a),this._update(!0)):this}removeLayer(m){return this._isValidId(m)?(this.style.removeLayer(m),this._update(!0)):this}getLayer(m){if(!this._isValidId(m))return null;let a=this.style.getOwnLayer(m);return a?a.type==="custom"?a.implementation:a.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(m,a,c){return this._isValidId(m)?(this.style.setLayerZoomRange(m,a,c),this._update(!0)):this}setFilter(m,a,c={}){return this._isValidId(m)?(this.style.setFilter(m,a,c),this._update(!0)):this}getFilter(m){return this._isValidId(m)?this.style.getFilter(m):null}setPaintProperty(m,a,c,f={}){return this._isValidId(m)?(this.style.setPaintProperty(m,a,c,f),this._update(!0)):this}getPaintProperty(m,a){return this._isValidId(m)?this.style.getPaintProperty(m,a):null}setLayoutProperty(m,a,c,f={}){return this._isValidId(m)?(this.style.setLayoutProperty(m,a,c,f),this._update(!0)):this}getLayoutProperty(m,a){return this._isValidId(m)?this.style.getLayoutProperty(m,a):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(m){return this.style.setGlyphsUrl(m),this._update(!0)}getSchema(m){return this.style.getSchema(m)}setSchema(m,a){return this.style.setSchema(m,a),this._update(!0)}getConfig(m){return this.style.getConfig(m)}setConfig(m,a){return this.style.setConfig(m,a),this._update(!0)}getConfigProperty(m,a){return this.style.getConfigProperty(m,a)}setConfigProperty(m,a,c){return this.style.setConfigProperty(m,a,c),this._update(!0)}getFeaturesetDescriptors(m){return this.style.getFeaturesetDescriptors(m)}setLights(m){if(this._lazyInitEmptyStyle(),m&&m.length===1&&m[0].type==="flat"){let a=m[0];a.properties?this.style.setFlatLight(a.properties,a.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(m),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){let m=this.style.getLights()||[];return m.length===0&&m.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),m}setLight(m,a={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:m}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(m){return this._lazyInitEmptyStyle(),this.style.setSnow(m),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(m){return this._lazyInitEmptyStyle(),this.style.setRain(m),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(m){return this._lazyInitEmptyStyle(),this.style.setColorTheme(m),this._update(!0)}setImportColorTheme(m,a){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(m,a),this._update(!0)}setCamera(m){return this.style.setCamera(m),this._triggerCameraUpdate(m)}_triggerCameraUpdate(m){return this._update(this.transform.setOrthographicProjectionAtLowPitch(m["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(r.bO.convert(m),this.transform):0}setFeatureState(m,a){return m.source&&!this._isValidId(m.source)?this:(this.style.setFeatureState(m,a),this._update())}removeFeatureState(m,a){return m.source&&!this._isValidId(m.source)?this:(this.style.removeFeatureState(m,a),this._update())}getFeatureState(m){return m.source&&!this._isValidId(m.source)?null:this.style.getFeatureState(m)}_updateContainerDimensions(){if(!this._container)return;let m=this._container.getBoundingClientRect().width||400,a=this._container.getBoundingClientRect().height||300,c,f,_,b=this._container;for(;b&&(!f||!_);){let w=window.getComputedStyle(b).transform;w&&w!=="none"&&(c=w.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&c[0]!=="0"&&c[0]!=="1"&&(f=c[0]),c[3]&&c[3]!=="0"&&c[3]!=="1"&&(_=c[3])),b=b.parentElement}this._containerWidth=f?Math.abs(m/f):m,this._containerHeight=_?Math.abs(a/_):a}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&r.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){let m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=re("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();let a=this._canvasContainer=re("div","mapboxgl-canvas-container",m);this._canvas=re("canvas","mapboxgl-canvas",a),this._interactive&&(a.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);let c=this._controlContainer=re("div","mapboxgl-control-container",m),f=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(_=>{f[_]=re("div",`mapboxgl-ctrl-${_}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,a){let c=r.q.devicePixelRatio||1;this._canvas.width=c*Math.ceil(m),this._canvas.height=c*Math.ceil(a),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${a}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){let a=this._markers.indexOf(m);a!==-1&&this._markers.splice(a,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){let a=this._popups.indexOf(m);a!==-1&&this._popups.splice(a,1)}_setupPainter(){let m=r.l({},le.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),a=this._canvas.getContext("webgl2",m);a?(fa(a,!0),this.painter=new Fg(a,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",c=>{c.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),r.m.testSupport(a)):this.fire(new r.z(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new r.A("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style.reloadModels(),this.style.clearSources(),this._update(),this.fire(new r.A("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let a;this.fire(new r.A("renderstart")),++this._frameId;let c=this.painter.context.extTimerQuery,f=r.q.now(),_=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(a=_.createQuery(),_.beginQuery(c.TIME_ELAPSED_EXT,a)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();let b=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;let O=this.transform.zoom,F=this.transform.pitch,z=r.q.now(),V=new r.aa(O,{now:z,fadeDuration:b,pitch:F,transition:this.style.transition});this.style.update(V)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let w=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),w=this._updateAverageElevation(f),this.style.updateSources(this.transform),this.isMoving()||this._forceMarkerAndPopupUpdate()):w=this._updateAverageElevation(f);let I=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,b,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),I&&(this._placementDirty=I.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new r.A("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,P.mark(A.load),this.fire(new r.A("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),a){let O=r.q.now()-f;_.endQuery(c.TIME_ELAPSED_EXT),setTimeout(()=>{let F=_.getQueryParameter(a,_.QUERY_RESULT)/1e6;_.deleteQuery(a),this.fire(new r.A("gpu-timing-frame",{cpuTime:O,gpuTime:F}))},50)}if(this.listens("gpu-timing-layer")){let O=this.painter.collectGpuTimers();setTimeout(()=>{let F=this.painter.queryGpuTimers(O);this.fire(new r.A("gpu-timing-layer",{layerTimes:F}))},50)}if(this.listens("gpu-timing-deferred-render")){let O=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{let F=this.painter.queryGpuTimeDeferredRender(O);this.fire(new r.A("gpu-timing-deferred-render",{gpuTime:F}))},50)}let k=this._sourcesDirty||this._styleDirty||this._placementDirty||w;if(k||this._repaint)this.triggerRepaint();else{let O=this.idle();if(O&&(w=this._updateAverageElevation(f,!0)),w)this.triggerRepaint();else if(this._triggerFrame(!1),O&&(this.fire(new r.A("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){let F=this._calculateSpeedIndex();this.fire(new r.A("speedindexcompleted",{speedIndex:F})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||k||(this._fullyLoaded=!0,P.mark(A.fullLoad),this._performanceMetricsCollection&&Xt(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(let a of this._markers)m&&!this.getRenderWorldCopies()&&(a._lngLat=a._lngLat.wrap()),a._update();for(let a of this._popups)!m||this.getRenderWorldCopies()||a._trackPointer||(a._lngLat=a._lngLat.wrap()),a._update()}_updateAverageElevation(m,a=!1){let c=_=>(this.transform.averageElevation=_,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&c(0);let f=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(f||(a||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){let _=this.transform.averageElevation,b=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(b)?b=0:this._averageElevationLastSampledAt=m;let w=Math.abs(_-b);if(w>1){if(this._isInitialLoad||f)return this._averageElevation.jumpTo(b),c(b);this._averageElevation.easeTo(b,m,300)}else if(w>1e-4)return this._averageElevation.jumpTo(b),c(b)}return!!this._averageElevation.isEasing(m)&&c(this._averageElevation.getValue(m))}_authenticate(){ce(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===Bt||m.status===401)){let a=this.painter.context.gl;fa(a,!1),this._logoControl instanceof bs&&this._logoControl._updateLogo(),a&&a.clear(a.DEPTH_BUFFER_BIT|a.COLOR_BUFFER_BIT|a.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new r.z(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),ro(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&Ko(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){let m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){let m=this.painter.canvasCopy(),a=this.painter.getCanvasCopiesAndTimestamps();a.timeStamps.push(performance.now());let c=this.painter.context.gl,f=c.createFramebuffer();function _(b){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,b,0);let w=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,w),w}return c.bindFramebuffer(c.FRAMEBUFFER,f),this._canvasPixelComparison(_(m),a.canvasCopies.map(_),a.timeStamps)}_canvasPixelComparison(m,a,c){let f=c[1]-c[0],_=m.length/4;for(let b=0;b<a.length;b++){let w=a[b],I=0;for(let k=0;k<w.length;k+=4)w[k]===m[k]&&w[k+1]===m[k+1]&&w[k+2]===m[k+2]&&w[k+3]===m[k+3]&&(I+=1);f+=(c[b+2]-c[b+1])*(1-I/_)}return f}remove(){this._hash&&this._hash.remove();for(let a of this._controls)a.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);let m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Xr.delete(this.painter.context.gl),li.remove(),_i.remove(),this._removed=!0,this.fire(new r.A("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=r.q.frame(a=>{let c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(a)}))}_preloadTiles(m){let a=this.style?this.style.getSourceCaches():[];return r.bl(a,(c,f)=>c._preloadTiles(m,f),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(m){this._showParseStatus!==m&&(this._showParseStatus=m,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(m){this._showLayers2DWireframe!==m&&(this._showLayers2DWireframe=m,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(m){this._showLayers3DWireframe!==m&&(this._showLayers3DWireframe=m,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,this._tp.refreshUI(),m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,this._tp.refreshUI(),m&&this._update())}_setCacheLimits(m,a){r.dJ(m,a)}get version(){return y}},NavigationControl:class{constructor(m={}){this.options=r.l({},JM,m),this._container=re("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",a=>a.preventDefault()),this.options.showZoom&&(r.aQ(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",a=>{this._map&&this._map.zoomIn({},{originalEvent:a})}),re("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",a=>{this._map&&this._map.zoomOut({},{originalEvent:a})}),re("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(r.aQ(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",a=>{let c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:a}):c.resetNorth({},{originalEvent:a}))}),this._compassIcon=re("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){let m=this._map;if(!m)return;let a=m.getZoom(),c=a===m.getMaxZoom(),f=a===m.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())}_rotateCompassArrow(){let m=this._map;if(!m)return;let a=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=a)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new eT(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){let m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,a){let c=re("button",m,this._container);return c.type="button",c.addEventListener("click",a),c}_setButtonTitle(m,a){if(!this._map)return;let c=this._map._getUIString(`NavigationControl.${a}`);m.setAttribute("aria-label",c),m.firstElementChild&&m.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends r.E{constructor(m={}){super();let a=navigator.geolocation;this.options=r.l({geolocation:a},es,m),r.aQ(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Lg(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=re("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){let a=(c=!!this.options.geolocation)=>{this._supportsGeolocation=c,m(c)};this._supportsGeolocation!==void 0?m(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(c=>a(c.state!=="denied")).catch(()=>a()):a()}_isOutOfMapMaxBounds(m){let a=this._map.getMaxBounds(),c=m.coords;return!!a&&(c.longitude<a.getWest()||c.longitude>a.getEast()||c.latitude<a.getSouth()||c.latitude>a.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new r.A("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new r.A("geolocate",m)),this._finish()}}_updateCamera(m){let a=new r.bO(m.coords.longitude,m.coords.latitude),c=m.coords.accuracy,f=this._map.getBearing(),_=r.l({bearing:f},this.options.fitBoundsOptions);this._map.fitBounds(a.toBounds(c),_,{geolocateSource:!0})}_updateMarker(m){if(m){let a=new r.bO(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){let m=this._map.transform,a=r.bH(1,m._center.lat)*m.worldSize,c=Math.ceil(2*this._accuracy*a);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new r.A("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",a=>a.preventDefault()),this._geolocateButton=re("button","mapboxgl-ctrl-geolocate",this._container),re("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){r.w("Geolocation support is not available so the GeolocateControl will be disabled.");let a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a)}else{let a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=re("div","mapboxgl-user-location"),this._dotElement.appendChild(re("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(re("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new ea({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=re("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ea({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new r.A("trackuserlocationend")))})}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:m.absolute===!0&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return r.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new r.A("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new r.A("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new r.A("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){let m=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(a=>{a==="granted"&&m()}).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Bg,ScaleControl:class{constructor(m={}){this.options=r.l({},Ho,m),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),r.aQ(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){let m=this.options.maxWidth||100,a=this._map,c=a._containerHeight/2,f=a._containerWidth/2-m/2,_=a.unproject([f,c]),b=a.unproject([f+m,c]),w=_.distanceTo(b);if(this.options.unit==="imperial"){let I=3.2808*w;I>5280?this._setScale(m,I/5280,"mile"):this._setScale(m,I,"foot")}else this.options.unit==="nautical"?this._setScale(m,w/1852,"nautical-mile"):w>=1e3?this._setScale(m,w/1e3,"kilometer"):this._setScale(m,w,"meter")}_setScale(m,a,c){this._map._requestDomTask(()=>{let f=function(b){let w=Math.pow(10,`${Math.floor(b)}`.length-1),I=b/w;return I=I>=10?10:I>=5?5:I>=3?3:I>=2?2:I>=1?1:function(k){let O=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*O)/O}(I),w*I}(a),_=f/a;this._container.innerHTML=this._isNumberFormatSupported&&c!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:c}).format(f):`${f}&nbsp;${i0[c]}`,this._container.style.width=m*_+"px"})}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=re("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m={}){this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:r.w("Full screen control 'container' must be a DOM element.")),r.aQ(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=re("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",r.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){let m=this._fullscreenButton=re("button","mapboxgl-ctrl-fullscreen",this._controlContainer);re("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){let m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends r.E{constructor(m){super(),this.options=r.l(Object.create(Nr),m),this._altitude=this.options.altitude,r.aQ(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new r.A("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);let m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new r.A("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=r.bO.convert(m),this._pos=null,this._trackPointer=!1,this._update();let a=this._map;return a&&(a.on("move",this._update),a.off("mousemove",this._onMouseEvent),a._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(m){return this._altitude=m,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();let m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){let a=document.createDocumentFragment(),c=document.createElement("body"),f;for(c.innerHTML=m;f=c.firstChild,f;)a.appendChild(f);return this.setDOMContent(a)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let a=this._content;if(a)for(;a.hasChildNodes();)a.firstChild&&a.removeChild(a.firstChild);else a=this._content=re("div","mapboxgl-popup-content",this._container||void 0);if(a.appendChild(m),this.options.closeButton){let c=this._closeButton=re("button","mapboxgl-popup-close-button",a);c.type="button",c.setAttribute("aria-label","Close popup"),c.innerHTML='<span aria-hidden="true">&#215;</span>',c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let a;return this._classList.delete(m)?a=!1:(this._classList.add(m),a=!0),this._updateClassList(),a}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;let a=this._map,c=this._container,f=this._pos;if(!a||!c||!f)return"bottom";let _=c.offsetWidth,b=c.offsetHeight,w=f.x<_/2,I=f.x>a.transform.width-_/2;if(f.y+m<b)return w?"top-left":I?"top-right":"top";if(f.y>a.transform.height-b){if(w)return"bottom-left";if(I)return"bottom-right"}return w?"left":I?"right":"bottom"}_updateClassList(){let m=this._container;if(!m)return;let a=[...this._classList];a.push("mapboxgl-popup"),this._anchor&&a.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&a.push("mapboxgl-popup-track-pointer"),m.className=a.join(" ")}_update(m){let a=this._map,c=this._content;if(!a||!this._lngLat&&!this._trackPointer||!c)return;let f=this._container;if(f||(f=this._container=re("div","mapboxgl-popup",a.getContainer()),this._tip=re("div","mapboxgl-popup-tip",f),f.appendChild(c)),this.options.maxWidth&&f.style.maxWidth!==this.options.maxWidth&&(f.style.maxWidth=this.options.maxWidth),a.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Vg(this._lngLat,this._pos,a.transform)),!this._trackPointer||m){let _=this._pos=this._trackPointer&&m instanceof r.P?m:a.project(this._lngLat,this._altitude),b=yd(this.options.offset),w=this._anchor=this._getAnchor(b.y),I=yd(this.options.offset,w),k=_.add(I).round();a._requestDomTask(()=>{this._container&&w&&(this._container.style.transform=`${Ll[w]} translate(${k.x}px,${k.y}px)`)})}if(!this._marker&&a._showingGlobe()){let _=r.dK(a.transform,this._lngLat)?0:1;this._setOpacity(_)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let m=this._container.querySelector(Gw);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:ea,Style:ml,LngLat:r.bO,LngLatBounds:r.aB,Point:r.P,MercatorCoordinate:r.ac,FreeCameraOptions:Qy,Evented:r.E,config:r.e,prewarm:r.dP,clearPrewarmedResources:r.dQ,get accessToken(){return r.e.ACCESS_TOKEN},set accessToken(m){r.e.ACCESS_TOKEN=m},get baseApiUrl(){return r.e.API_URL},set baseApiUrl(m){r.e.API_URL=m},get workerCount(){return r.dR.workerCount},set workerCount(m){r.dR.workerCount=m},get maxParallelImageRequests(){return r.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){r.e.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){r.dS(m)},get workerUrl(){return r.dT.workerUrl},set workerUrl(m){r.dT.workerUrl=m},get workerClass(){return r.dT.workerClass},set workerClass(m){r.dT.workerClass=m},get workerParams(){return r.dT.workerParams},set workerParams(m){r.dT.workerParams=m},get dracoUrl(){return r.dU()},set dracoUrl(m){r.dV(m)},get meshoptUrl(){return r.dW()},set meshoptUrl(m){r.dX(m)},setNow:r.q.setNow,restoreNow:r.q.restoreNow}});var s=e;return s})});var SH=t3((rO,oO)=>{"use strict";(function(i,t){typeof define=="function"&&define.amd?define([],t):typeof rO<"u"?t():(t(),i.FileSaver={})})(rO,function(){"use strict";function i(A,P){return typeof P>"u"?P={autoBom:!1}:typeof P!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),P={autoBom:!P}),P.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(A.type)?new Blob(["\uFEFF",A],{type:A.type}):A}function t(A,P,B){var U=new XMLHttpRequest;U.open("GET",A),U.responseType="blob",U.onload=function(){y(U.response,P,B)},U.onerror=function(){console.error("could not download file")},U.send()}function e(A){var P=new XMLHttpRequest;P.open("HEAD",A,!1);try{P.send()}catch{}return 200<=P.status&&299>=P.status}function n(A){try{A.dispatchEvent(new MouseEvent("click"))}catch{var P=document.createEvent("MouseEvents");P.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),A.dispatchEvent(P)}}var s=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,r=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),y=s.saveAs||(typeof window!="object"||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!r?function(A,P,B){var U=s.URL||s.webkitURL,J=document.createElement("a");P=P||A.name||"download",J.download=P,J.rel="noopener",typeof A=="string"?(J.href=A,J.origin===location.origin?n(J):e(J.href)?t(A,P,B):n(J,J.target="_blank")):(J.href=U.createObjectURL(A),setTimeout(function(){U.revokeObjectURL(J.href)},4e4),setTimeout(function(){n(J)},0))}:"msSaveOrOpenBlob"in navigator?function(A,P,B){if(P=P||A.name||"download",typeof A!="string")navigator.msSaveOrOpenBlob(i(A,B),P);else if(e(A))t(A,P,B);else{var U=document.createElement("a");U.href=A,U.target="_blank",setTimeout(function(){n(U)})}}:function(A,P,B,U){if(U=U||open("","_blank"),U&&(U.document.title=U.document.body.innerText="downloading..."),typeof A=="string")return t(A,P,B);var J=A.type==="application/octet-stream",le=/constructor/i.test(s.HTMLElement)||s.safari,re=/CriOS\/[\d]+/.test(navigator.userAgent);if((re||J&&le||r)&&typeof FileReader<"u"){var X=new FileReader;X.onloadend=function(){var Re=X.result;Re=re?Re:Re.replace(/^data:[^;]*;/,"data:attachment/file;"),U?U.location.href=Re:location=Re,U=null},X.readAsDataURL(A)}else{var ee=s.URL||s.webkitURL,we=ee.createObjectURL(A);U?U.location=we:location.href=we,U=null,setTimeout(function(){ee.revokeObjectURL(we)},4e4)}});s.saveAs=y.saveAs=y,typeof oO<"u"&&(oO.exports=y)})});function wI(i,t){return Object.is(i,t)}var Ca=null,z1=!1,CI=1,Gs=Symbol("SIGNAL");function er(i){let t=Ca;return Ca=i,t}function EI(){return Ca}var a_={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function B0(i){if(z1)throw new Error("");if(Ca===null)return;Ca.consumerOnSignalRead(i);let t=Ca.nextProducerIndex++;if(H1(Ca),t<Ca.producerNode.length&&Ca.producerNode[t]!==i&&z0(Ca)){let e=Ca.producerNode[t];U1(e,Ca.producerIndexOfThis[t])}Ca.producerNode[t]!==i&&(Ca.producerNode[t]=i,Ca.producerIndexOfThis[t]=z0(Ca)?n3(i,Ca,t):0),Ca.producerLastReadVersion[t]=i.version}function i3(){CI++}function SI(i){if(!(z0(i)&&!i.dirty)&&!(!i.dirty&&i.lastCleanEpoch===CI)){if(!i.producerMustRecompute(i)&&!j1(i)){xI(i);return}i.producerRecomputeValue(i),xI(i)}}function DI(i){if(i.liveConsumerNode===void 0)return;let t=z1;z1=!0;try{for(let e of i.liveConsumerNode)e.dirty||Aq(e)}finally{z1=t}}function MI(){return Ca?.consumerAllowSignalWrites!==!1}function Aq(i){i.dirty=!0,DI(i),i.consumerMarkedDirty?.(i)}function xI(i){i.dirty=!1,i.lastCleanEpoch=CI}function V0(i){return i&&(i.nextProducerIndex=0),er(i)}function V1(i,t){if(er(t),!(!i||i.producerNode===void 0||i.producerIndexOfThis===void 0||i.producerLastReadVersion===void 0)){if(z0(i))for(let e=i.nextProducerIndex;e<i.producerNode.length;e++)U1(i.producerNode[e],i.producerIndexOfThis[e]);for(;i.producerNode.length>i.nextProducerIndex;)i.producerNode.pop(),i.producerLastReadVersion.pop(),i.producerIndexOfThis.pop()}}function j1(i){H1(i);for(let t=0;t<i.producerNode.length;t++){let e=i.producerNode[t],n=i.producerLastReadVersion[t];if(n!==e.version||(SI(e),n!==e.version))return!0}return!1}function j0(i){if(H1(i),z0(i))for(let t=0;t<i.producerNode.length;t++)U1(i.producerNode[t],i.producerIndexOfThis[t]);i.producerNode.length=i.producerLastReadVersion.length=i.producerIndexOfThis.length=0,i.liveConsumerNode&&(i.liveConsumerNode.length=i.liveConsumerIndexOfThis.length=0)}function n3(i,t,e){if(r3(i),i.liveConsumerNode.length===0&&o3(i))for(let n=0;n<i.producerNode.length;n++)i.producerIndexOfThis[n]=n3(i.producerNode[n],i,n);return i.liveConsumerIndexOfThis.push(e),i.liveConsumerNode.push(t)-1}function U1(i,t){if(r3(i),i.liveConsumerNode.length===1&&o3(i))for(let n=0;n<i.producerNode.length;n++)U1(i.producerNode[n],i.producerIndexOfThis[n]);let e=i.liveConsumerNode.length-1;if(i.liveConsumerNode[t]=i.liveConsumerNode[e],i.liveConsumerIndexOfThis[t]=i.liveConsumerIndexOfThis[e],i.liveConsumerNode.length--,i.liveConsumerIndexOfThis.length--,t<i.liveConsumerNode.length){let n=i.liveConsumerIndexOfThis[t],s=i.liveConsumerNode[t];H1(s),s.producerIndexOfThis[n]=t}}function z0(i){return i.consumerIsAlwaysLive||(i?.liveConsumerNode?.length??0)>0}function H1(i){i.producerNode??=[],i.producerIndexOfThis??=[],i.producerLastReadVersion??=[]}function r3(i){i.liveConsumerNode??=[],i.liveConsumerIndexOfThis??=[]}function o3(i){return i.producerNode!==void 0}function $1(i,t){let e=Object.create(Rq);e.computation=i,t!==void 0&&(e.equal=t);let n=()=>{if(SI(e),B0(e),e.value===B1)throw e.error;return e.value};return n[Gs]=e,n}var vI=Symbol("UNSET"),bI=Symbol("COMPUTING"),B1=Symbol("ERRORED"),Rq=Xi(Ct({},a_),{value:vI,dirty:!0,error:null,equal:wI,kind:"computed",producerMustRecompute(i){return i.value===vI||i.value===bI},producerRecomputeValue(i){if(i.value===bI)throw new Error("Detected cycle in computations.");let t=i.value;i.value=bI;let e=V0(i),n,s=!1;try{n=i.computation(),er(null),s=t!==vI&&t!==B1&&n!==B1&&i.equal(t,n)}catch(r){n=B1,i.error=r}finally{V1(i,e)}if(s){i.value=t;return}i.value=n,i.version++}});function kq(){throw new Error}var a3=kq;function s3(i){a3(i)}function TI(i){a3=i}var Pq=null;function II(i,t){let e=Object.create(G1);e.value=i,t!==void 0&&(e.equal=t);let n=()=>(B0(e),e.value);return n[Gs]=e,n}function U0(i,t){MI()||s3(i),i.equal(i.value,t)||(i.value=t,Oq(i))}function AI(i,t){MI()||s3(i),U0(i,t(i.value))}var G1=Xi(Ct({},a_),{equal:wI,value:void 0,kind:"signal"});function Oq(i){i.version++,i3(),DI(i),Pq?.()}function RI(i){let t=er(null);try{return i()}finally{er(t)}}var kI;function H0(){return kI}function mu(i){let t=kI;return kI=i,t}var q1=Symbol("NotFound");function jn(i){return typeof i=="function"}function s_(i){let e=i(n=>{Error.call(n),n.stack=new Error().stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var W1=s_(i=>function(e){i(this),this.message=e?`${e.length} errors occurred during unsubscription:
${e.map((n,s)=>`${s+1}) ${n.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=e});function Hf(i,t){if(i){let e=i.indexOf(t);0<=e&&i.splice(e,1)}}var Tn=class i{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;let{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(let r of e)r.remove(this);else e.remove(this);let{initialTeardown:n}=this;if(jn(n))try{n()}catch(r){t=r instanceof W1?r.errors:[r]}let{_finalizers:s}=this;if(s){this._finalizers=null;for(let r of s)try{l3(r)}catch(y){t=t??[],y instanceof W1?t=[...t,...y.errors]:t.push(y)}}if(t)throw new W1(t)}}add(t){var e;if(t&&t!==this)if(this.closed)l3(t);else{if(t instanceof i){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(e=this._finalizers)!==null&&e!==void 0?e:[]).push(t)}}_hasParent(t){let{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){let{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){let{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&Hf(e,t)}remove(t){let{_finalizers:e}=this;e&&Hf(e,t),t instanceof i&&t._removeParent(this)}};Tn.EMPTY=(()=>{let i=new Tn;return i.closed=!0,i})();var PI=Tn.EMPTY;function Y1(i){return i instanceof Tn||i&&"closed"in i&&jn(i.remove)&&jn(i.add)&&jn(i.unsubscribe)}function l3(i){jn(i)?i():i.unsubscribe()}var Oc={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var l_={setTimeout(i,t,...e){let{delegate:n}=l_;return n?.setTimeout?n.setTimeout(i,t,...e):setTimeout(i,t,...e)},clearTimeout(i){let{delegate:t}=l_;return(t?.clearTimeout||clearTimeout)(i)},delegate:void 0};function Z1(i){l_.setTimeout(()=>{let{onUnhandledError:t}=Oc;if(t)t(i);else throw i})}function $0(){}var c3=OI("C",void 0,void 0);function d3(i){return OI("E",void 0,i)}function u3(i){return OI("N",i,void 0)}function OI(i,t,e){return{kind:i,value:t,error:e}}var $f=null;function c_(i){if(Oc.useDeprecatedSynchronousErrorHandling){let t=!$f;if(t&&($f={errorThrown:!1,error:null}),i(),t){let{errorThrown:e,error:n}=$f;if($f=null,e)throw n}}else i()}function h3(i){Oc.useDeprecatedSynchronousErrorHandling&&$f&&($f.errorThrown=!0,$f.error=i)}var Gf=class extends Tn{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,Y1(t)&&t.add(this)):this.destination=Vq}static create(t,e,n){return new gu(t,e,n)}next(t){this.isStopped?LI(u3(t),this):this._next(t)}error(t){this.isStopped?LI(d3(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?LI(c3,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},zq=Function.prototype.bind;function FI(i,t){return zq.call(i,t)}var NI=class{constructor(t){this.partialObserver=t}next(t){let{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(n){X1(n)}}error(t){let{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(n){X1(n)}else X1(t)}complete(){let{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){X1(e)}}},gu=class extends Gf{constructor(t,e,n){super();let s;if(jn(t)||!t)s={next:t??void 0,error:e??void 0,complete:n??void 0};else{let r;this&&Oc.useDeprecatedNextContext?(r=Object.create(t),r.unsubscribe=()=>this.unsubscribe(),s={next:t.next&&FI(t.next,r),error:t.error&&FI(t.error,r),complete:t.complete&&FI(t.complete,r)}):s=t}this.destination=new NI(s)}};function X1(i){Oc.useDeprecatedSynchronousErrorHandling?h3(i):Z1(i)}function Bq(i){throw i}function LI(i,t){let{onStoppedNotification:e}=Oc;e&&l_.setTimeout(()=>e(i,t))}var Vq={closed:!0,next:$0,error:Bq,complete:$0};var d_=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Ss(i){return i}function zI(...i){return BI(i)}function BI(i){return i.length===0?Ss:i.length===1?i[0]:function(e){return i.reduce((n,s)=>s(n),e)}}var Yn=(()=>{class i{constructor(e){e&&(this._subscribe=e)}lift(e){let n=new i;return n.source=this,n.operator=e,n}subscribe(e,n,s){let r=Uq(e)?e:new gu(e,n,s);return c_(()=>{let{operator:y,source:A}=this;r.add(y?y.call(r,A):A?this._subscribe(r):this._trySubscribe(r))}),r}_trySubscribe(e){try{return this._subscribe(e)}catch(n){e.error(n)}}forEach(e,n){return n=p3(n),new n((s,r)=>{let y=new gu({next:A=>{try{e(A)}catch(P){r(P),y.unsubscribe()}},error:r,complete:s});this.subscribe(y)})}_subscribe(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)}[d_](){return this}pipe(...e){return BI(e)(this)}toPromise(e){return e=p3(e),new e((n,s)=>{let r;this.subscribe(y=>r=y,y=>s(y),()=>n(r))})}}return i.create=t=>new i(t),i})();function p3(i){var t;return(t=i??Oc.Promise)!==null&&t!==void 0?t:Promise}function jq(i){return i&&jn(i.next)&&jn(i.error)&&jn(i.complete)}function Uq(i){return i&&i instanceof Gf||jq(i)&&Y1(i)}function VI(i){return jn(i?.lift)}function kn(i){return t=>{if(VI(t))return t.lift(function(e){try{return i(e,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function In(i,t,e,n,s){return new jI(i,t,e,n,s)}var jI=class extends Gf{constructor(t,e,n,s,r,y){super(t),this.onFinalize=r,this.shouldUnsubscribe=y,this._next=e?function(A){try{e(A)}catch(P){t.error(P)}}:super._next,this._error=s?function(A){try{s(A)}catch(P){t.error(P)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(A){t.error(A)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:e}=this;super.unsubscribe(),!e&&((t=this.onFinalize)===null||t===void 0||t.call(this))}}};function u_(){return kn((i,t)=>{let e=null;i._refCount++;let n=In(t,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount){e=null;return}let s=i._connection,r=e;e=null,s&&(!r||s===r)&&s.unsubscribe(),t.unsubscribe()});i.subscribe(n),n.closed||(e=i.connect())})}var qh=class extends Yn{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,VI(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){let t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new Tn;let e=this.getSubject();t.add(this.source.subscribe(In(e,void 0,()=>{this._teardown(),e.complete()},n=>{this._teardown(),e.error(n)},()=>this._teardown()))),t.closed&&(this._connection=null,t=Tn.EMPTY)}return t}refCount(){return u_()(this)}};var f3=s_(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ni=(()=>{class i extends Yn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){let n=new K1(this,this);return n.operator=e,n}_throwIfClosed(){if(this.closed)throw new f3}next(e){c_(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let n of this.currentObservers)n.next(e)}})}error(e){c_(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;let{observers:n}=this;for(;n.length;)n.shift().error(e)}})}complete(){c_(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){let{hasError:n,isStopped:s,observers:r}=this;return n||s?PI:(this.currentObservers=null,r.push(e),new Tn(()=>{this.currentObservers=null,Hf(r,e)}))}_checkFinalizedStatuses(e){let{hasError:n,thrownError:s,isStopped:r}=this;n?e.error(s):r&&e.complete()}asObservable(){let e=new Yn;return e.source=this,e}}return i.create=(t,e)=>new K1(t,e),i})(),K1=class extends ni{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.next)===null||n===void 0||n.call(e,t)}error(t){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.error)===null||n===void 0||n.call(e,t)}complete(){var t,e;(e=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||e===void 0||e.call(t)}_subscribe(t){var e,n;return(n=(e=this.source)===null||e===void 0?void 0:e.subscribe(t))!==null&&n!==void 0?n:PI}};var Cr=class extends ni{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){let e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){let{hasError:t,thrownError:e,_value:n}=this;if(t)throw e;return this._throwIfClosed(),n}next(t){super.next(this._value=t)}};var G0={now(){return(G0.delegate||Date).now()},delegate:void 0};var qf=class extends ni{constructor(t=1/0,e=1/0,n=G0){super(),this._bufferSize=t,this._windowTime=e,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,e)}next(t){let{isStopped:e,_buffer:n,_infiniteTimeWindow:s,_timestampProvider:r,_windowTime:y}=this;e||(n.push(t),!s&&n.push(r.now()+y)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();let e=this._innerSubscribe(t),{_infiniteTimeWindow:n,_buffer:s}=this,r=s.slice();for(let y=0;y<r.length&&!t.closed;y+=n?1:2)t.next(r[y]);return this._checkFinalizedStatuses(t),e}_trimBuffer(){let{_bufferSize:t,_timestampProvider:e,_buffer:n,_infiniteTimeWindow:s}=this,r=(s?1:2)*t;if(t<1/0&&r<n.length&&n.splice(0,n.length-r),!s){let y=e.now(),A=0;for(let P=1;P<n.length&&n[P]<=y;P+=2)A=P;A&&n.splice(0,A+1)}}};var Q1=class extends Tn{constructor(t,e){super()}schedule(t,e=0){return this}};var q0={setInterval(i,t,...e){let{delegate:n}=q0;return n?.setInterval?n.setInterval(i,t,...e):setInterval(i,t,...e)},clearInterval(i){let{delegate:t}=q0;return(t?.clearInterval||clearInterval)(i)},delegate:void 0};var J1=class extends Q1{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var n;if(this.closed)return this;this.state=t;let s=this.id,r=this.scheduler;return s!=null&&(this.id=this.recycleAsyncId(r,s,e)),this.pending=!0,this.delay=e,this.id=(n=this.id)!==null&&n!==void 0?n:this.requestAsyncId(r,this.id,e),this}requestAsyncId(t,e,n=0){return q0.setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(n!=null&&this.delay===n&&this.pending===!1)return e;e!=null&&q0.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let n=this._execute(t,e);if(n)return n;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let n=!1,s;try{this.work(t)}catch(r){n=!0,s=r||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){let{id:t,scheduler:e}=this,{actions:n}=e;this.work=this.state=this.scheduler=null,this.pending=!1,Hf(n,this),t!=null&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}};var h_=class i{constructor(t,e=i.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,n){return new this.schedulerActionCtor(this,t).schedule(n,e)}};h_.now=G0.now;var eC=class extends h_{constructor(t,e=h_.now){super(t,e),this.actions=[],this._active=!1}flush(t){let{actions:e}=this;if(this._active){e.push(t);return}let n;this._active=!0;do if(n=t.execute(t.state,t.delay))break;while(t=e.shift());if(this._active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}};var Wf=new eC(J1),m3=Wf;var za=new Yn(i=>i.complete());function tC(i){return i&&jn(i.schedule)}function UI(i){return i[i.length-1]}function iC(i){return jn(UI(i))?i.pop():void 0}function xd(i){return tC(UI(i))?i.pop():void 0}function g3(i,t){return typeof UI(i)=="number"?i.pop():t}function y3(i,t,e,n){function s(r){return r instanceof e?r:new e(function(y){y(r)})}return new(e||(e=Promise))(function(r,y){function A(U){try{B(n.next(U))}catch(J){y(J)}}function P(U){try{B(n.throw(U))}catch(J){y(J)}}function B(U){U.done?r(U.value):s(U.value).then(A,P)}B((n=n.apply(i,t||[])).next())})}function _3(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],n=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Yf(i){return this instanceof Yf?(this.v=i,this):new Yf(i)}function v3(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(i,t||[]),s,r=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),A("next"),A("throw"),A("return",y),s[Symbol.asyncIterator]=function(){return this},s;function y(re){return function(X){return Promise.resolve(X).then(re,J)}}function A(re,X){n[re]&&(s[re]=function(ee){return new Promise(function(we,Re){r.push([re,ee,we,Re])>1||P(re,ee)})},X&&(s[re]=X(s[re])))}function P(re,X){try{B(n[re](X))}catch(ee){le(r[0][3],ee)}}function B(re){re.value instanceof Yf?Promise.resolve(re.value.v).then(U,J):le(r[0][2],re)}function U(re){P("next",re)}function J(re){P("throw",re)}function le(re,X){re(X),r.shift(),r.length&&P(r[0][0],r[0][1])}}function b3(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=i[Symbol.asyncIterator],e;return t?t.call(i):(i=typeof _3=="function"?_3(i):i[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=i[r]&&function(y){return new Promise(function(A,P){y=i[r](y),s(A,P,y.done,y.value)})}}function s(r,y,A,P){Promise.resolve(P).then(function(B){r({value:B,done:A})},y)}}var nC=i=>i&&typeof i.length=="number"&&typeof i!="function";function rC(i){return jn(i?.then)}function oC(i){return jn(i[d_])}function aC(i){return Symbol.asyncIterator&&jn(i?.[Symbol.asyncIterator])}function sC(i){return new TypeError(`You provided ${i!==null&&typeof i=="object"?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function Hq(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var lC=Hq();function cC(i){return jn(i?.[lC])}function dC(i){return v3(this,arguments,function*(){let e=i.getReader();try{for(;;){let{value:n,done:s}=yield Yf(e.read());if(s)return yield Yf(void 0);yield yield Yf(n)}}finally{e.releaseLock()}})}function uC(i){return jn(i?.getReader)}function Gr(i){if(i instanceof Yn)return i;if(i!=null){if(oC(i))return $q(i);if(nC(i))return Gq(i);if(rC(i))return qq(i);if(aC(i))return x3(i);if(cC(i))return Wq(i);if(uC(i))return Yq(i)}throw sC(i)}function $q(i){return new Yn(t=>{let e=i[d_]();if(jn(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Gq(i){return new Yn(t=>{for(let e=0;e<i.length&&!t.closed;e++)t.next(i[e]);t.complete()})}function qq(i){return new Yn(t=>{i.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,Z1)})}function Wq(i){return new Yn(t=>{for(let e of i)if(t.next(e),t.closed)return;t.complete()})}function x3(i){return new Yn(t=>{Zq(i,t).catch(e=>t.error(e))})}function Yq(i){return x3(dC(i))}function Zq(i,t){var e,n,s,r;return y3(this,void 0,void 0,function*(){try{for(e=b3(i);n=yield e.next(),!n.done;){let y=n.value;if(t.next(y),t.closed)return}}catch(y){s={error:y}}finally{try{n&&!n.done&&(r=e.return)&&(yield r.call(e))}finally{if(s)throw s.error}}t.complete()})}function qs(i,t,e,n=0,s=!1){let r=t.schedule(function(){e(),s?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(r),!s)return r}function hC(i,t=0){return kn((e,n)=>{e.subscribe(In(n,s=>qs(n,i,()=>n.next(s),t),()=>qs(n,i,()=>n.complete(),t),s=>qs(n,i,()=>n.error(s),t)))})}function pC(i,t=0){return kn((e,n)=>{n.add(i.schedule(()=>e.subscribe(n),t))})}function w3(i,t){return Gr(i).pipe(pC(t),hC(t))}function C3(i,t){return Gr(i).pipe(pC(t),hC(t))}function E3(i,t){return new Yn(e=>{let n=0;return t.schedule(function(){n===i.length?e.complete():(e.next(i[n++]),e.closed||this.schedule())})})}function S3(i,t){return new Yn(e=>{let n;return qs(e,t,()=>{n=i[lC](),qs(e,t,()=>{let s,r;try{({value:s,done:r}=n.next())}catch(y){e.error(y);return}r?e.complete():e.next(s)},0,!0)}),()=>jn(n?.return)&&n.return()})}function fC(i,t){if(!i)throw new Error("Iterable cannot be null");return new Yn(e=>{qs(e,t,()=>{let n=i[Symbol.asyncIterator]();qs(e,t,()=>{n.next().then(s=>{s.done?e.complete():e.next(s.value)})},0,!0)})})}function D3(i,t){return fC(dC(i),t)}function M3(i,t){if(i!=null){if(oC(i))return w3(i,t);if(nC(i))return E3(i,t);if(rC(i))return C3(i,t);if(aC(i))return fC(i,t);if(cC(i))return S3(i,t);if(uC(i))return D3(i,t)}throw sC(i)}function zr(i,t){return t?M3(i,t):Gr(i)}function wi(...i){let t=xd(i);return zr(i,t)}function lo(i,t){let e=jn(i)?i:()=>i,n=s=>s.error(e());return new Yn(t?s=>t.schedule(n,0,s):n)}function p_(i){return!!i&&(i instanceof Yn||jn(i.lift)&&jn(i.subscribe))}var _u=s_(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"});function T3(i){return i instanceof Date&&!isNaN(i)}function Ui(i,t){return kn((e,n)=>{let s=0;e.subscribe(In(n,r=>{n.next(i.call(t,r,s++))}))})}var{isArray:Xq}=Array;function Kq(i,t){return Xq(t)?i(...t):i(t)}function mC(i){return Ui(t=>Kq(i,t))}var{isArray:Qq}=Array,{getPrototypeOf:Jq,prototype:eW,keys:tW}=Object;function gC(i){if(i.length===1){let t=i[0];if(Qq(t))return{args:t,keys:null};if(iW(t)){let e=tW(t);return{args:e.map(n=>t[n]),keys:e}}}return{args:i,keys:null}}function iW(i){return i&&typeof i=="object"&&Jq(i)===eW}function _C(i,t){return i.reduce((e,n,s)=>(e[n]=t[s],e),{})}function Zf(...i){let t=xd(i),e=iC(i),{args:n,keys:s}=gC(i);if(n.length===0)return zr([],t);let r=new Yn(nW(n,t,s?y=>_C(s,y):Ss));return e?r.pipe(mC(e)):r}function nW(i,t,e=Ss){return n=>{I3(t,()=>{let{length:s}=i,r=new Array(s),y=s,A=s;for(let P=0;P<s;P++)I3(t,()=>{let B=zr(i[P],t),U=!1;B.subscribe(In(n,J=>{r[P]=J,U||(U=!0,A--),A||n.next(e(r.slice()))},()=>{--y||n.complete()}))},n)},n)}}function I3(i,t,e){i?qs(e,i,t):t()}function A3(i,t,e,n,s,r,y,A){let P=[],B=0,U=0,J=!1,le=()=>{J&&!P.length&&!B&&t.complete()},re=ee=>B<n?X(ee):P.push(ee),X=ee=>{r&&t.next(ee),B++;let we=!1;Gr(e(ee,U++)).subscribe(In(t,Re=>{s?.(Re),r?re(Re):t.next(Re)},()=>{we=!0},void 0,()=>{if(we)try{for(B--;P.length&&B<n;){let Re=P.shift();y?qs(t,y,()=>X(Re)):X(Re)}le()}catch(Re){t.error(Re)}}))};return i.subscribe(In(t,re,()=>{J=!0,le()})),()=>{A?.()}}function qo(i,t,e=1/0){return jn(t)?qo((n,s)=>Ui((r,y)=>t(n,r,s,y))(Gr(i(n,s))),e):(typeof t=="number"&&(e=t),kn((n,s)=>A3(n,s,i,e)))}function Wh(i=1/0){return qo(Ss,i)}function R3(){return Wh(1)}function Yh(...i){return R3()(zr(i,xd(i)))}function wd(i){return new Yn(t=>{Gr(i()).subscribe(t)})}function W0(...i){let t=iC(i),{args:e,keys:n}=gC(i),s=new Yn(r=>{let{length:y}=e;if(!y){r.complete();return}let A=new Array(y),P=y,B=y;for(let U=0;U<y;U++){let J=!1;Gr(e[U]).subscribe(In(r,le=>{J||(J=!0,B--),A[U]=le},()=>P--,void 0,()=>{(!P||!J)&&(B||r.next(n?_C(n,A):A),r.complete())}))}});return t?s.pipe(mC(t)):s}function yC(i=0,t,e=m3){let n=-1;return t!=null&&(tC(t)?e=t:n=t),new Yn(s=>{let r=T3(i)?+i-e.now():i;r<0&&(r=0);let y=0;return e.schedule(function(){s.closed||(s.next(y++),0<=n?this.schedule(void 0,n):s.complete())},r)})}function Y0(i=0,t=Wf){return i<0&&(i=0),yC(i,i,t)}function Ba(...i){let t=xd(i),e=g3(i,1/0),n=i;return n.length?n.length===1?Gr(n[0]):Wh(e)(zr(n,t)):za}function dr(i,t){return kn((e,n)=>{let s=0;e.subscribe(In(n,r=>i.call(t,r,s++)&&n.next(r)))})}function k3(i){return kn((t,e)=>{let n=!1,s=null,r=null,y=!1,A=()=>{if(r?.unsubscribe(),r=null,n){n=!1;let B=s;s=null,e.next(B)}y&&e.complete()},P=()=>{r=null,y&&e.complete()};t.subscribe(In(e,B=>{n=!0,s=B,r||Gr(i(B)).subscribe(r=In(e,A,P))},()=>{y=!0,(!n||!r||r.closed)&&e.complete()}))})}function vC(i,t=Wf){return k3(()=>yC(i,t))}function tr(i){return kn((t,e)=>{let n=null,s=!1,r;n=t.subscribe(In(e,void 0,void 0,y=>{r=Gr(i(y,tr(i)(t))),n?(n.unsubscribe(),n=null,r.subscribe(e)):s=!0})),s&&(n.unsubscribe(),n=null,r.subscribe(e))})}function P3(i,t,e,n,s){return(r,y)=>{let A=e,P=t,B=0;r.subscribe(In(y,U=>{let J=B++;P=A?i(P,U,J):(A=!0,U),n&&y.next(P)},s&&(()=>{A&&y.next(P),y.complete()})))}}function Cd(i,t){return jn(t)?qo(i,t,1):qo(i,1)}function Z0(i,t=Wf){return kn((e,n)=>{let s=null,r=null,y=null,A=()=>{if(s){s.unsubscribe(),s=null;let B=r;r=null,n.next(B)}};function P(){let B=y+i,U=t.now();if(U<B){s=this.schedule(void 0,B-U),n.add(s);return}A()}e.subscribe(In(n,B=>{r=B,y=t.now(),s||(s=t.schedule(P,i),n.add(s))},()=>{A(),n.complete()},void 0,()=>{r=s=null}))})}function Zh(i){return kn((t,e)=>{let n=!1;t.subscribe(In(e,s=>{n=!0,e.next(s)},()=>{n||e.next(i),e.complete()}))})}function mo(i){return i<=0?()=>za:kn((t,e)=>{let n=0;t.subscribe(In(e,s=>{++n<=i&&(e.next(s),i<=n&&e.complete())}))})}function bC(i,t=Ss){return i=i??rW,kn((e,n)=>{let s,r=!0;e.subscribe(In(n,y=>{let A=t(y);(r||!i(s,A))&&(r=!1,s=A,n.next(y))}))})}function rW(i,t){return i===t}function xC(i=oW){return kn((t,e)=>{let n=!1;t.subscribe(In(e,s=>{n=!0,e.next(s)},()=>n?e.complete():e.error(i())))})}function oW(){return new _u}function jl(i){return kn((t,e)=>{try{t.subscribe(e)}finally{e.add(i)}})}function yu(i,t){let e=arguments.length>=2;return n=>n.pipe(i?dr((s,r)=>i(s,r,n)):Ss,mo(1),e?Zh(t):xC(()=>new _u))}function f_(i){return i<=0?()=>za:kn((t,e)=>{let n=[];t.subscribe(In(e,s=>{n.push(s),i<n.length&&n.shift()},()=>{for(let s of n)e.next(s);e.complete()},void 0,()=>{n=null}))})}function HI(i,t){let e=arguments.length>=2;return n=>n.pipe(i?dr((s,r)=>i(s,r,n)):Ss,f_(1),e?Zh(t):xC(()=>new _u))}function wC(){return kn((i,t)=>{let e,n=!1;i.subscribe(In(t,s=>{let r=e;e=s,n&&t.next([r,s]),n=!0}))})}function $I(i,t){return kn(P3(i,t,arguments.length>=2,!0))}function X0(i={}){let{connector:t=()=>new ni,resetOnError:e=!0,resetOnComplete:n=!0,resetOnRefCountZero:s=!0}=i;return r=>{let y,A,P,B=0,U=!1,J=!1,le=()=>{A?.unsubscribe(),A=void 0},re=()=>{le(),y=P=void 0,U=J=!1},X=()=>{let ee=y;re(),ee?.unsubscribe()};return kn((ee,we)=>{B++,!J&&!U&&le();let Re=P=P??t();we.add(()=>{B--,B===0&&!J&&!U&&(A=GI(X,s))}),Re.subscribe(we),!y&&B>0&&(y=new gu({next:Ce=>Re.next(Ce),error:Ce=>{J=!0,le(),A=GI(re,e,Ce),Re.error(Ce)},complete:()=>{U=!0,le(),A=GI(re,n),Re.complete()}}),Gr(ee).subscribe(y))})(r)}}function GI(i,t,...e){if(t===!0){i();return}if(t===!1)return;let n=new gu({next:()=>{n.unsubscribe(),i()}});return Gr(t(...e)).subscribe(n)}function CC(i,t,e){let n,s=!1;return i&&typeof i=="object"?{bufferSize:n=1/0,windowTime:t=1/0,refCount:s=!1,scheduler:e}=i:n=i??1/0,X0({connector:()=>new qf(n,t,e),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:s})}function K0(i){return dr((t,e)=>i<=e)}function go(...i){let t=xd(i);return kn((e,n)=>{(t?Yh(i,e,t):Yh(i,e)).subscribe(n)})}function Oo(i,t){return kn((e,n)=>{let s=null,r=0,y=!1,A=()=>y&&!s&&n.complete();e.subscribe(In(n,P=>{s?.unsubscribe();let B=0,U=r++;Gr(i(P,U)).subscribe(s=In(n,J=>n.next(t?t(P,J,U,B++):J),()=>{s=null,A()}))},()=>{y=!0,A()}))})}function Un(i){return kn((t,e)=>{Gr(i).subscribe(In(e,()=>e.complete(),$0)),!e.closed&&t.subscribe(e)})}function Xf(i,t=!1){return kn((e,n)=>{let s=0;e.subscribe(In(n,r=>{let y=i(r,s++);(y||t)&&n.next(r),!y&&n.complete()}))})}function Gn(i,t,e){let n=jn(i)||t||e?{next:i,error:t,complete:e}:i;return n?kn((s,r)=>{var y;(y=n.subscribe)===null||y===void 0||y.call(n);let A=!0;s.subscribe(In(r,P=>{var B;(B=n.next)===null||B===void 0||B.call(n,P),r.next(P)},()=>{var P;A=!1,(P=n.complete)===null||P===void 0||P.call(n),r.complete()},P=>{var B;A=!1,(B=n.error)===null||B===void 0||B.call(n,P),r.error(P)},()=>{var P,B;A&&((P=n.unsubscribe)===null||P===void 0||P.call(n)),(B=n.finalize)===null||B===void 0||B.call(n)}))}):Ss}var Dz="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",Mi=class extends Error{code;constructor(t,e){super(gR(t,e)),this.code=t}};function aW(i){return`NG0${Math.abs(i)}`}function gR(i,t){return`${aW(i)}${t?": "+t:""}`}var Mz=Symbol("InputSignalNode#UNSET"),sW=Xi(Ct({},G1),{transformFn:void 0,applyValueToInputSignal(i,t){U0(i,t)}});function Tz(i,t){let e=Object.create(sW);e.value=i,e.transformFn=t?.transform;function n(){if(B0(e),e.value===Mz){let s=null;throw new Mi(-950,s)}return e.value}return n[Gs]=e,n}function cb(i){return{toString:i}.toString()}var EC="__parameters__";function lW(i){return function(...e){if(i){let n=i(...e);for(let s in n)this[s]=n[s]}}}function _R(i,t,e){return cb(()=>{let n=lW(t);function s(...r){if(this instanceof s)return n.apply(this,r),this;let y=new s(...r);return A.annotation=y,A;function A(P,B,U){let J=P.hasOwnProperty(EC)?P[EC]:Object.defineProperty(P,EC,{value:[]})[EC];for(;J.length<=U;)J.push(null);return(J[U]=J[U]||[]).push(y),P}}return s.prototype.ngMetadataName=i,s.annotationCls=s,s})}var Ed=globalThis;function qr(i){for(let t in i)if(i[t]===qr)return t;throw Error("Could not find renamed property on target object.")}function cW(i,t){for(let e in t)t.hasOwnProperty(e)&&!i.hasOwnProperty(e)&&(i[e]=t[e])}function Ys(i){if(typeof i=="string")return i;if(Array.isArray(i))return`[${i.map(Ys).join(", ")}]`;if(i==null)return""+i;let t=i.overriddenName||i.name;if(t)return`${t}`;let e=i.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n>=0?e.slice(0,n):e}function sA(i,t){return i?t?`${i} ${t}`:i:t||""}var dW=qr({__forward_ref__:qr});function ra(i){return i.__forward_ref__=ra,i.toString=function(){return Ys(this())},i}function Ga(i){return Iz(i)?i():i}function Iz(i){return typeof i=="function"&&i.hasOwnProperty(dW)&&i.__forward_ref__===ra}function Mt(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function Li(i){return{providers:i.providers||[],imports:i.imports||[]}}function lE(i){return O3(i,Rz)||O3(i,kz)}function Az(i){return lE(i)!==null}function O3(i,t){return i.hasOwnProperty(t)?i[t]:null}function uW(i){let t=i&&(i[Rz]||i[kz]);return t||null}function F3(i){return i&&(i.hasOwnProperty(L3)||i.hasOwnProperty(hW))?i[L3]:null}var Rz=qr({\u0275prov:qr}),L3=qr({\u0275inj:qr}),kz=qr({ngInjectableDef:qr}),hW=qr({ngInjectorDef:qr}),Dt=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(t,e){this._desc=t,this.\u0275prov=void 0,typeof e=="number"?this.__NG_ELEMENT_ID__=e:e!==void 0&&(this.\u0275prov=Mt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Pz(i){return i&&!!i.\u0275providers}var pW=qr({\u0275cmp:qr}),fW=qr({\u0275dir:qr}),mW=qr({\u0275pipe:qr}),gW=qr({\u0275mod:qr}),FC=qr({\u0275fac:qr}),tb=qr({__NG_ELEMENT_ID__:qr}),N3=qr({__NG_ENV_ID__:qr});function x_(i){return typeof i=="string"?i:i==null?"":String(i)}function _W(i){return typeof i=="function"?i.name||i.toString():typeof i=="object"&&i!=null&&typeof i.type=="function"?i.type.name||i.type.toString():x_(i)}function Oz(i,t){throw new Mi(-200,i)}function yR(i,t){throw new Mi(-201,!1)}var rr=function(i){return i[i.Default=0]="Default",i[i.Host=1]="Host",i[i.Self=2]="Self",i[i.SkipSelf=4]="SkipSelf",i[i.Optional=8]="Optional",i}(rr||{}),lA;function Fz(){return lA}function Ws(i){let t=lA;return lA=i,t}function Lz(i,t,e){let n=lE(i);if(n&&n.providedIn=="root")return n.value===void 0?n.value=n.factory():n.value;if(e&rr.Optional)return null;if(t!==void 0)return t;yR(i,"Injector")}var yW={},Qf=yW,cA="__NG_DI_FLAG__",LC=class{injector;constructor(t){this.injector=t}retrieve(t,e){let n=e;return this.injector.get(t,n.optional?q1:Qf,n)}},NC="ngTempTokenPath",vW="ngTokenPath",bW=/\n/gm,xW="\u0275",z3="__source";function wW(i,t=rr.Default){if(H0()===void 0)throw new Mi(-203,!1);if(H0()===null)return Lz(i,void 0,t);{let e=H0(),n;return e instanceof LC?n=e.injector:n=e,n.get(i,t&rr.Optional?null:void 0,t)}}function hi(i,t=rr.Default){return(Fz()||wW)(Ga(i),t)}function Z(i,t=rr.Default){return hi(i,cE(t))}function cE(i){return typeof i>"u"||typeof i=="number"?i:0|(i.optional&&8)|(i.host&&1)|(i.self&&2)|(i.skipSelf&&4)}function dA(i){let t=[];for(let e=0;e<i.length;e++){let n=Ga(i[e]);if(Array.isArray(n)){if(n.length===0)throw new Mi(900,!1);let s,r=rr.Default;for(let y=0;y<n.length;y++){let A=n[y],P=CW(A);typeof P=="number"?P===-1?s=A.token:r|=P:s=A}t.push(hi(s,r))}else t.push(hi(n))}return t}function vR(i,t){return i[cA]=t,i.prototype[cA]=t,i}function CW(i){return i[cA]}function EW(i,t,e,n){let s=i[NC];throw t[z3]&&s.unshift(t[z3]),i.message=SW(`
`+i.message,s,e,n),i[vW]=s,i[NC]=null,i}function SW(i,t,e,n=null){i=i&&i.charAt(0)===`
`&&i.charAt(1)==xW?i.slice(2):i;let s=Ys(t);if(Array.isArray(t))s=t.map(Ys).join(" -> ");else if(typeof t=="object"){let r=[];for(let y in t)if(t.hasOwnProperty(y)){let A=t[y];r.push(y+":"+(typeof A=="string"?JSON.stringify(A):Ys(A)))}s=`{${r.join(", ")}}`}return`${e}${n?"("+n+")":""}[${s}]: ${i.replace(bW,`
  `)}`}var bR=vR(_R("Inject",i=>({token:i})),-1),tp=vR(_R("Optional"),8);var R_=vR(_R("SkipSelf"),4);function em(i,t){let e=i.hasOwnProperty(FC);return e?i[FC]:null}function DW(i,t,e){if(i.length!==t.length)return!1;for(let n=0;n<i.length;n++){let s=i[n],r=t[n];if(e&&(s=e(s),r=e(r)),r!==s)return!1}return!0}function MW(i){return i.flat(Number.POSITIVE_INFINITY)}function xR(i,t){i.forEach(e=>Array.isArray(e)?xR(e,t):t(e))}function Nz(i,t,e){t>=i.length?i.push(e):i.splice(t,0,e)}function zC(i,t){return t>=i.length-1?i.pop():i.splice(t,1)[0]}function TW(i,t){let e=[];for(let n=0;n<i;n++)e.push(t);return e}function IW(i,t,e,n){let s=i.length;if(s==t)i.push(e,n);else if(s===1)i.push(n,i[0]),i[0]=e;else{for(s--,i.push(i[s-1],i[s]);s>t;){let r=s-2;i[s]=i[r],s--}i[t]=e,i[t+1]=n}}function dE(i,t,e){let n=db(i,t);return n>=0?i[n|1]=e:(n=~n,IW(i,n,t,e)),n}function qI(i,t){let e=db(i,t);if(e>=0)return i[e|1]}function db(i,t){return AW(i,t,1)}function AW(i,t,e){let n=0,s=i.length>>e;for(;s!==n;){let r=n+(s-n>>1),y=i[r<<e];if(t===y)return r<<e;y>t?s=r:n=r+1}return~(s<<e)}var Dd={},Ds=[],w_=new Dt(""),zz=new Dt("",-1),Bz=new Dt(""),BC=class{get(t,e=Qf){if(e===Qf){let n=new Error(`NullInjectorError: No provider for ${Ys(t)}!`);throw n.name="NullInjectorError",n}return e}};function Vz(i,t){let e=i[gW]||null;if(!e&&t===!0)throw new Error(`Type ${Ys(i)} does not have '\u0275mod' property.`);return e}function Qh(i){return i[pW]||null}function jz(i){return i[fW]||null}function RW(i){return i[mW]||null}function k_(i){return{\u0275providers:i}}function kW(...i){return{\u0275providers:Uz(!0,i),\u0275fromNgModule:!0}}function Uz(i,...t){let e=[],n=new Set,s,r=y=>{e.push(y)};return xR(t,y=>{let A=y;uA(A,r,[],n)&&(s||=[],s.push(A))}),s!==void 0&&Hz(s,r),e}function Hz(i,t){for(let e=0;e<i.length;e++){let{ngModule:n,providers:s}=i[e];wR(s,r=>{t(r,n)})}}function uA(i,t,e,n){if(i=Ga(i),!i)return!1;let s=null,r=F3(i),y=!r&&Qh(i);if(!r&&!y){let P=i.ngModule;if(r=F3(P),r)s=P;else return!1}else{if(y&&!y.standalone)return!1;s=i}let A=n.has(s);if(y){if(A)return!1;if(n.add(s),y.dependencies){let P=typeof y.dependencies=="function"?y.dependencies():y.dependencies;for(let B of P)uA(B,t,e,n)}}else if(r){if(r.imports!=null&&!A){n.add(s);let B;try{xR(r.imports,U=>{uA(U,t,e,n)&&(B||=[],B.push(U))})}finally{}B!==void 0&&Hz(B,t)}if(!A){let B=em(s)||(()=>new s);t({provide:s,useFactory:B,deps:Ds},s),t({provide:Bz,useValue:s,multi:!0},s),t({provide:w_,useValue:()=>hi(s),multi:!0},s)}let P=r.providers;if(P!=null&&!A){let B=i;wR(P,U=>{t(U,B)})}}else return!1;return s!==i&&i.providers!==void 0}function wR(i,t){for(let e of i)Pz(e)&&(e=e.\u0275providers),Array.isArray(e)?wR(e,t):t(e)}var PW=qr({provide:String,useValue:qr});function $z(i){return i!==null&&typeof i=="object"&&PW in i}function OW(i){return!!(i&&i.useExisting)}function FW(i){return!!(i&&i.useFactory)}function C_(i){return typeof i=="function"}function LW(i){return!!i.useClass}var uE=new Dt(""),IC={},B3={},WI;function hE(){return WI===void 0&&(WI=new BC),WI}var Fo=class{},ib=class extends Fo{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(t,e,n,s){super(),this.parent=e,this.source=n,this.scopes=s,pA(t,y=>this.processProvider(y)),this.records.set(zz,m_(void 0,this)),s.has("environment")&&this.records.set(Fo,m_(void 0,this));let r=this.records.get(uE);r!=null&&typeof r.value=="string"&&this.scopes.add(r.value),this.injectorDefTypes=new Set(this.get(Bz,Ds,rr.Self))}retrieve(t,e){let n=e;return this.get(t,n.optional?q1:Qf,n)}destroy(){J0(this),this._destroyed=!0;let t=er(null);try{for(let n of this._ngOnDestroyHooks)n.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let n of e)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),er(t)}}onDestroy(t){return J0(this),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){J0(this);let e=mu(this),n=Ws(void 0),s;try{return t()}finally{mu(e),Ws(n)}}get(t,e=Qf,n=rr.Default){if(J0(this),t.hasOwnProperty(N3))return t[N3](this);n=cE(n);let s,r=mu(this),y=Ws(void 0);try{if(!(n&rr.SkipSelf)){let P=this.records.get(t);if(P===void 0){let B=jW(t)&&lE(t);B&&this.injectableDefInScope(B)?P=m_(hA(t),IC):P=null,this.records.set(t,P)}if(P!=null)return this.hydrate(t,P)}let A=n&rr.Self?hE():this.parent;return e=n&rr.Optional&&e===Qf?null:e,A.get(t,e)}catch(A){if(A.name==="NullInjectorError"){if((A[NC]=A[NC]||[]).unshift(Ys(t)),r)throw A;return EW(A,t,"R3InjectorError",this.source)}else throw A}finally{Ws(y),mu(r)}}resolveInjectorInitializers(){let t=er(null),e=mu(this),n=Ws(void 0),s;try{let r=this.get(w_,Ds,rr.Self);for(let y of r)y()}finally{mu(e),Ws(n),er(t)}}toString(){let t=[],e=this.records;for(let n of e.keys())t.push(Ys(n));return`R3Injector[${t.join(", ")}]`}processProvider(t){t=Ga(t);let e=C_(t)?t:Ga(t&&t.provide),n=zW(t);if(!C_(t)&&t.multi===!0){let s=this.records.get(e);s||(s=m_(void 0,IC,!0),s.factory=()=>dA(s.multi),this.records.set(e,s)),e=t,s.multi.push(t)}this.records.set(e,n)}hydrate(t,e){let n=er(null);try{return e.value===B3?Oz(Ys(t)):e.value===IC&&(e.value=B3,e.value=e.factory()),typeof e.value=="object"&&e.value&&VW(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}finally{er(n)}}injectableDefInScope(t){if(!t.providedIn)return!1;let e=Ga(t.providedIn);return typeof e=="string"?e==="any"||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(t){let e=this._onDestroyHooks.indexOf(t);e!==-1&&this._onDestroyHooks.splice(e,1)}};function hA(i){let t=lE(i),e=t!==null?t.factory:em(i);if(e!==null)return e;if(i instanceof Dt)throw new Mi(204,!1);if(i instanceof Function)return NW(i);throw new Mi(204,!1)}function NW(i){if(i.length>0)throw new Mi(204,!1);let e=uW(i);return e!==null?()=>e.factory(i):()=>new i}function zW(i){if($z(i))return m_(void 0,i.useValue);{let t=Gz(i);return m_(t,IC)}}function Gz(i,t,e){let n;if(C_(i)){let s=Ga(i);return em(s)||hA(s)}else if($z(i))n=()=>Ga(i.useValue);else if(FW(i))n=()=>i.useFactory(...dA(i.deps||[]));else if(OW(i))n=()=>hi(Ga(i.useExisting));else{let s=Ga(i&&(i.useClass||i.provide));if(BW(i))n=()=>new s(...dA(i.deps));else return em(s)||hA(s)}return n}function J0(i){if(i.destroyed)throw new Mi(205,!1)}function m_(i,t,e=!1){return{factory:i,value:t,multi:e?[]:void 0}}function BW(i){return!!i.deps}function VW(i){return i!==null&&typeof i=="object"&&typeof i.ngOnDestroy=="function"}function jW(i){return typeof i=="function"||typeof i=="object"&&i instanceof Dt}function pA(i,t){for(let e of i)Array.isArray(e)?pA(e,t):e&&Pz(e)?pA(e.\u0275providers,t):t(e)}function Zs(i,t){let e;i instanceof ib?(J0(i),e=i):e=new LC(i);let n,s=mu(e),r=Ws(void 0);try{return t()}finally{mu(s),Ws(r)}}function qz(){return Fz()!==void 0||H0()!=null}function CR(i){if(!qz())throw new Mi(-203,!1)}function UW(i){return typeof i=="function"}var Eu=0,Hn=1,Pn=2,rs=3,Nc=4,Xs=5,E_=6,VC=7,Ea=8,S_=9,vu=10,_o=11,nb=12,V3=13,P_=14,xl=15,tm=16,g_=17,bu=18,pE=19,Wz=20,Xh=21,YI=22,im=23,Ul=24,v_=25,na=26,Yz=1;var nm=7,jC=8,D_=9,ns=10;function Kh(i){return Array.isArray(i)&&typeof i[Yz]=="object"}function Su(i){return Array.isArray(i)&&i[Yz]===!0}function ER(i){return(i.flags&4)!==0}function O_(i){return i.componentOffset>-1}function fE(i){return(i.flags&1)===1}function Md(i){return!!i.template}function UC(i){return(i[Pn]&512)!==0}function ub(i){return(i[Pn]&256)===256}var fA=class{previousValue;currentValue;firstChange;constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}};function Zz(i,t,e,n){t!==null?t.applyValueToInputSignal(t,n):i[e]=n}var fr=(()=>{let i=()=>Xz;return i.ngInherit=!0,i})();function Xz(i){return i.type.prototype.ngOnChanges&&(i.setInput=$W),HW}function HW(){let i=Qz(this),t=i?.current;if(t){let e=i.previous;if(e===Dd)i.previous=t;else for(let n in t)e[n]=t[n];i.current=null,this.ngOnChanges(t)}}function $W(i,t,e,n,s){let r=this.declaredInputs[n],y=Qz(i)||GW(i,{previous:Dd,current:null}),A=y.current||(y.current={}),P=y.previous,B=P[r];A[r]=new fA(B&&B.currentValue,e,P===Dd),Zz(i,t,s,e)}var Kz="__ngSimpleChanges__";function Qz(i){return i[Kz]||null}function GW(i,t){return i[Kz]=t}var j3=null;var Br=function(i,t=null,e){j3?.(i,t,e)},Jz="svg",qW="math";function Td(i){for(;Array.isArray(i);)i=i[Eu];return i}function eB(i,t){return Td(t[i])}function Rd(i,t){return Td(t[i.index])}function SR(i,t){return i.data[t]}function DR(i,t){return i[t]}function Id(i,t){let e=t[i];return Kh(e)?e:e[Eu]}function WW(i){return(i[Pn]&4)===4}function MR(i){return(i[Pn]&128)===128}function YW(i){return Su(i[rs])}function Jh(i,t){return t==null?null:i[t]}function tB(i){i[g_]=0}function iB(i){i[Pn]&1024||(i[Pn]|=1024,MR(i)&&F_(i))}function ZW(i,t){for(;i>0;)t=t[P_],i--;return t}function mE(i){return!!(i[Pn]&9216||i[Ul]?.dirty)}function mA(i){i[vu].changeDetectionScheduler?.notify(8),i[Pn]&64&&(i[Pn]|=1024),mE(i)&&F_(i)}function F_(i){i[vu].changeDetectionScheduler?.notify(0);let t=rm(i);for(;t!==null&&!(t[Pn]&8192||(t[Pn]|=8192,!MR(t)));)t=rm(t)}function nB(i,t){if(ub(i))throw new Mi(911,!1);i[Xh]===null&&(i[Xh]=[]),i[Xh].push(t)}function XW(i,t){if(i[Xh]===null)return;let e=i[Xh].indexOf(t);e!==-1&&i[Xh].splice(e,1)}function rm(i){let t=i[rs];return Su(t)?t[rs]:t}function TR(i){return i[VC]??=[]}function IR(i){return i.cleanup??=[]}function KW(i,t,e,n){let s=TR(t);s.push(e),i.firstCreatePass&&IR(i).push(n,s.length-1)}var qn={lFrame:cB(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var gA=!1;function QW(){return qn.lFrame.elementDepthCount}function JW(){qn.lFrame.elementDepthCount++}function e9(){qn.lFrame.elementDepthCount--}function AR(){return qn.bindingsEnabled}function rB(){return qn.skipHydrationRootTNode!==null}function t9(i){return qn.skipHydrationRootTNode===i}function i9(){qn.skipHydrationRootTNode=null}function pn(){return qn.lFrame.lView}function uo(){return qn.lFrame.tView}function qt(i){return qn.lFrame.contextLView=i,i[Ea]}function Wt(i){return qn.lFrame.contextLView=null,i}function os(){let i=oB();for(;i!==null&&i.type===64;)i=i.parent;return i}function oB(){return qn.lFrame.currentTNode}function n9(){let i=qn.lFrame,t=i.currentTNode;return i.isParent?t:t.parent}function ip(i,t){let e=qn.lFrame;e.currentTNode=i,e.isParent=t}function RR(){return qn.lFrame.isParent}function kR(){qn.lFrame.isParent=!1}function r9(){return qn.lFrame.contextLView}function aB(){return gA}function HC(i){let t=gA;return gA=i,t}function L_(){let i=qn.lFrame,t=i.bindingRootIndex;return t===-1&&(t=i.bindingRootIndex=i.tView.bindingStartIndex),t}function o9(){return qn.lFrame.bindingIndex}function a9(i){return qn.lFrame.bindingIndex=i}function um(){return qn.lFrame.bindingIndex++}function PR(i){let t=qn.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+i,e}function s9(){return qn.lFrame.inI18n}function l9(i,t){let e=qn.lFrame;e.bindingIndex=e.bindingRootIndex=i,_A(t)}function c9(){return qn.lFrame.currentDirectiveIndex}function _A(i){qn.lFrame.currentDirectiveIndex=i}function d9(i){let t=qn.lFrame.currentDirectiveIndex;return t===-1?null:i[t]}function OR(){return qn.lFrame.currentQueryIndex}function gE(i){qn.lFrame.currentQueryIndex=i}function u9(i){let t=i[Hn];return t.type===2?t.declTNode:t.type===1?i[Xs]:null}function sB(i,t,e){if(e&rr.SkipSelf){let s=t,r=i;for(;s=s.parent,s===null&&!(e&rr.Host);)if(s=u9(r),s===null||(r=r[P_],s.type&10))break;if(s===null)return!1;t=s,i=r}let n=qn.lFrame=lB();return n.currentTNode=t,n.lView=i,!0}function FR(i){let t=lB(),e=i[Hn];qn.lFrame=t,t.currentTNode=e.firstChild,t.lView=i,t.tView=e,t.contextLView=i,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function lB(){let i=qn.lFrame,t=i===null?null:i.child;return t===null?cB(i):t}function cB(i){let t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return i!==null&&(i.child=t),t}function dB(){let i=qn.lFrame;return qn.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}var uB=dB;function LR(){let i=dB();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function h9(i){return(qn.lFrame.contextLView=ZW(i,qn.lFrame.contextLView))[Ea]}function Du(){return qn.lFrame.selectedIndex}function om(i){qn.lFrame.selectedIndex=i}function hb(){let i=qn.lFrame;return SR(i.tView,i.selectedIndex)}function Da(){qn.lFrame.currentNamespace=Jz}function hm(){p9()}function p9(){qn.lFrame.currentNamespace=null}function f9(){return qn.lFrame.currentNamespace}var hB=!0;function _E(){return hB}function yE(i){hB=i}function m9(i,t,e){let{ngOnChanges:n,ngOnInit:s,ngDoCheck:r}=t.type.prototype;if(n){let y=Xz(t);(e.preOrderHooks??=[]).push(i,y),(e.preOrderCheckHooks??=[]).push(i,y)}s&&(e.preOrderHooks??=[]).push(0-i,s),r&&((e.preOrderHooks??=[]).push(i,r),(e.preOrderCheckHooks??=[]).push(i,r))}function NR(i,t){for(let e=t.directiveStart,n=t.directiveEnd;e<n;e++){let r=i.data[e].type.prototype,{ngAfterContentInit:y,ngAfterContentChecked:A,ngAfterViewInit:P,ngAfterViewChecked:B,ngOnDestroy:U}=r;y&&(i.contentHooks??=[]).push(-e,y),A&&((i.contentHooks??=[]).push(e,A),(i.contentCheckHooks??=[]).push(e,A)),P&&(i.viewHooks??=[]).push(-e,P),B&&((i.viewHooks??=[]).push(e,B),(i.viewCheckHooks??=[]).push(e,B)),U!=null&&(i.destroyHooks??=[]).push(e,U)}}function AC(i,t,e){pB(i,t,3,e)}function RC(i,t,e,n){(i[Pn]&3)===e&&pB(i,t,e,n)}function ZI(i,t){let e=i[Pn];(e&3)===t&&(e&=16383,e+=1,i[Pn]=e)}function pB(i,t,e,n){let s=n!==void 0?i[g_]&65535:0,r=n??-1,y=t.length-1,A=0;for(let P=s;P<y;P++)if(typeof t[P+1]=="number"){if(A=t[P],n!=null&&A>=n)break}else t[P]<0&&(i[g_]+=65536),(A<r||r==-1)&&(g9(i,e,t,P),i[g_]=(i[g_]&4294901760)+P+2),P++}function U3(i,t){Br(4,i,t);let e=er(null);try{t.call(i)}finally{er(e),Br(5,i,t)}}function g9(i,t,e,n){let s=e[n]<0,r=e[n+1],y=s?-e[n]:e[n],A=i[y];s?i[Pn]>>14<i[g_]>>16&&(i[Pn]&3)===t&&(i[Pn]+=16384,U3(A,r)):U3(A,r)}var b_=-1,am=class{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(t,e,n){this.factory=t,this.canSeeViewProviders=e,this.injectImpl=n}};function _9(i){return(i.flags&8)!==0}function y9(i){return(i.flags&16)!==0}function v9(i,t,e){let n=0;for(;n<e.length;){let s=e[n];if(typeof s=="number"){if(s!==0)break;n++;let r=e[n++],y=e[n++],A=e[n++];i.setAttribute(t,y,A,r)}else{let r=s,y=e[++n];b9(r)?i.setProperty(t,r,y):i.setAttribute(t,r,y),n++}}return n}function fB(i){return i===3||i===4||i===6}function b9(i){return i.charCodeAt(0)===64}function M_(i,t){if(!(t===null||t.length===0))if(i===null||i.length===0)i=t.slice();else{let e=-1;for(let n=0;n<t.length;n++){let s=t[n];typeof s=="number"?e=s:e===0||(e===-1||e===2?H3(i,e,s,null,t[++n]):H3(i,e,s,null,null))}}return i}function H3(i,t,e,n,s){let r=0,y=i.length;if(t===-1)y=-1;else for(;r<i.length;){let A=i[r++];if(typeof A=="number"){if(A===t){y=-1;break}else if(A>t){y=r-1;break}}}for(;r<i.length;){let A=i[r];if(typeof A=="number")break;if(A===e){s!==null&&(i[r+1]=s);return}r++,s!==null&&r++}y!==-1&&(i.splice(y,0,t),r=y+1),i.splice(r++,0,e),s!==null&&i.splice(r++,0,s)}function mB(i){return i!==b_}function $C(i){return i&32767}function x9(i){return i>>16}function GC(i,t){let e=x9(i),n=t;for(;e>0;)n=n[P_],e--;return n}var yA=!0;function qC(i){let t=yA;return yA=i,t}var w9=256,gB=w9-1,_B=5,C9=0,Sd={};function E9(i,t,e){let n;typeof e=="string"?n=e.charCodeAt(0)||0:e.hasOwnProperty(tb)&&(n=e[tb]),n==null&&(n=e[tb]=C9++);let s=n&gB,r=1<<s;t.data[i+(s>>_B)]|=r}function WC(i,t){let e=yB(i,t);if(e!==-1)return e;let n=t[Hn];n.firstCreatePass&&(i.injectorIndex=t.length,XI(n.data,i),XI(t,null),XI(n.blueprint,null));let s=zR(i,t),r=i.injectorIndex;if(mB(s)){let y=$C(s),A=GC(s,t),P=A[Hn].data;for(let B=0;B<8;B++)t[r+B]=A[y+B]|P[y+B]}return t[r+8]=s,r}function XI(i,t){i.push(0,0,0,0,0,0,0,0,t)}function yB(i,t){return i.injectorIndex===-1||i.parent&&i.parent.injectorIndex===i.injectorIndex||t[i.injectorIndex+8]===null?-1:i.injectorIndex}function zR(i,t){if(i.parent&&i.parent.injectorIndex!==-1)return i.parent.injectorIndex;let e=0,n=null,s=t;for(;s!==null;){if(n=CB(s),n===null)return b_;if(e++,s=s[P_],n.injectorIndex!==-1)return n.injectorIndex|e<<16}return b_}function vA(i,t,e){E9(i,t,e)}function S9(i,t){if(t==="class")return i.classes;if(t==="style")return i.styles;let e=i.attrs;if(e){let n=e.length,s=0;for(;s<n;){let r=e[s];if(fB(r))break;if(r===0)s=s+2;else if(typeof r=="number")for(s++;s<n&&typeof e[s]=="string";)s++;else{if(r===t)return e[s+1];s=s+2}}}return null}function vB(i,t,e){if(e&rr.Optional||i!==void 0)return i;yR(t,"NodeInjector")}function bB(i,t,e,n){if(e&rr.Optional&&n===void 0&&(n=null),(e&(rr.Self|rr.Host))===0){let s=i[S_],r=Ws(void 0);try{return s?s.get(t,n,e&rr.Optional):Lz(t,n,e&rr.Optional)}finally{Ws(r)}}return vB(n,t,e)}function xB(i,t,e,n=rr.Default,s){if(i!==null){if(t[Pn]&2048&&!(n&rr.Self)){let y=I9(i,t,e,n,Sd);if(y!==Sd)return y}let r=wB(i,t,e,n,Sd);if(r!==Sd)return r}return bB(t,e,n,s)}function wB(i,t,e,n,s){let r=M9(e);if(typeof r=="function"){if(!sB(t,i,n))return n&rr.Host?vB(s,e,n):bB(t,e,n,s);try{let y;if(y=r(n),y==null&&!(n&rr.Optional))yR(e);else return y}finally{uB()}}else if(typeof r=="number"){let y=null,A=yB(i,t),P=b_,B=n&rr.Host?t[xl][Xs]:null;for((A===-1||n&rr.SkipSelf)&&(P=A===-1?zR(i,t):t[A+8],P===b_||!G3(n,!1)?A=-1:(y=t[Hn],A=$C(P),t=GC(P,t)));A!==-1;){let U=t[Hn];if($3(r,A,U.data)){let J=D9(A,t,e,y,n,B);if(J!==Sd)return J}P=t[A+8],P!==b_&&G3(n,t[Hn].data[A+8]===B)&&$3(r,A,t)?(y=U,A=$C(P),t=GC(P,t)):A=-1}}return s}function D9(i,t,e,n,s,r){let y=t[Hn],A=y.data[i+8],P=n==null?O_(A)&&yA:n!=y&&(A.type&3)!==0,B=s&rr.Host&&r===A,U=kC(A,y,e,P,B);return U!==null?rb(t,y,U,A):Sd}function kC(i,t,e,n,s){let r=i.providerIndexes,y=t.data,A=r&1048575,P=i.directiveStart,B=i.directiveEnd,U=r>>20,J=n?A:A+U,le=s?A+U:B;for(let re=J;re<le;re++){let X=y[re];if(re<P&&e===X||re>=P&&X.type===e)return re}if(s){let re=y[P];if(re&&Md(re)&&re.type===e)return P}return null}function rb(i,t,e,n){let s=i[e],r=t.data;if(s instanceof am){let y=s;y.resolving&&Oz(_W(r[e]));let A=qC(y.canSeeViewProviders);y.resolving=!0;let P,B=y.injectImpl?Ws(y.injectImpl):null,U=sB(i,n,rr.Default);try{s=i[e]=y.factory(void 0,r,i,n),t.firstCreatePass&&e>=n.directiveStart&&m9(e,r[e],t)}finally{B!==null&&Ws(B),qC(A),y.resolving=!1,uB()}}return s}function M9(i){if(typeof i=="string")return i.charCodeAt(0)||0;let t=i.hasOwnProperty(tb)?i[tb]:void 0;return typeof t=="number"?t>=0?t&gB:T9:t}function $3(i,t,e){let n=1<<i;return!!(e[t+(i>>_B)]&n)}function G3(i,t){return!(i&rr.Self)&&!(i&rr.Host&&t)}var Jf=class{_tNode;_lView;constructor(t,e){this._tNode=t,this._lView=e}get(t,e,n){return xB(this._tNode,this._lView,t,cE(n),e)}};function T9(){return new Jf(os(),pn())}function ur(i){return cb(()=>{let t=i.prototype.constructor,e=t[FC]||bA(t),n=Object.prototype,s=Object.getPrototypeOf(i.prototype).constructor;for(;s&&s!==n;){let r=s[FC]||bA(s);if(r&&r!==e)return r;s=Object.getPrototypeOf(s)}return r=>new r})}function bA(i){return Iz(i)?()=>{let t=bA(Ga(i));return t&&t()}:em(i)}function I9(i,t,e,n,s){let r=i,y=t;for(;r!==null&&y!==null&&y[Pn]&2048&&!UC(y);){let A=wB(r,y,e,n|rr.Self,Sd);if(A!==Sd)return A;let P=r.parent;if(!P){let B=y[Wz];if(B){let U=B.get(e,Sd,n);if(U!==Sd)return U}P=CB(y),y=y[P_]}r=P}return s}function CB(i){let t=i[Hn],e=t.type;return e===2?t.declTNode:e===1?i[Xs]:null}function vE(i){return S9(os(),i)}function q3(i,t=null,e=null,n){let s=EB(i,t,e,n);return s.resolveInjectorInitializers(),s}function EB(i,t=null,e=null,n,s=new Set){let r=[e||Ds,kW(i)];return n=n||(typeof i=="object"?void 0:Ys(i)),new ib(r,t||hE(),n||null,s)}var vn=class i{static THROW_IF_NOT_FOUND=Qf;static NULL=new BC;static create(t,e){if(Array.isArray(t))return q3({name:""},e,t,"");{let n=t.name??"";return q3({name:n},t.parent,t.providers,n)}}static \u0275prov=Mt({token:i,providedIn:"any",factory:()=>hi(zz)});static __NG_ELEMENT_ID__=-1};var Hl=class{attributeName;constructor(t){this.attributeName=t}__NG_ELEMENT_ID__=()=>vE(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}},A9=new Dt("");A9.__NG_ELEMENT_ID__=i=>{let t=os();if(t===null)throw new Mi(204,!1);if(t.type&2)return t.value;if(i&rr.Optional)return null;throw new Mi(204,!1)};var SB=!1,N_=(()=>{class i{static __NG_ELEMENT_ID__=R9;static __NG_ENV_ID__=e=>e}return i})(),YC=class extends N_{_lView;constructor(t){super(),this._lView=t}onDestroy(t){return nB(this._lView,t),()=>XW(this._lView,t)}};function R9(){return new YC(pn())}var sm=class{},BR=new Dt("",{providedIn:"root",factory:()=>!1});var DB=new Dt(""),MB=new Dt(""),Mu=(()=>{class i{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new Cr(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let e=this.taskId++;return this.pendingTasks.add(e),e}has(e){return this.pendingTasks.has(e)}remove(e){this.pendingTasks.delete(e),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=Mt({token:i,providedIn:"root",factory:()=>new i})}return i})();var xA=class extends ni{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(t=!1){super(),this.__isAsync=t,qz()&&(this.destroyRef=Z(N_,{optional:!0})??void 0,this.pendingTasks=Z(Mu,{optional:!0})??void 0)}emit(t){let e=er(null);try{super.next(t)}finally{er(e)}}subscribe(t,e,n){let s=t,r=e||(()=>null),y=n;if(t&&typeof t=="object"){let P=t;s=P.next?.bind(P),r=P.error?.bind(P),y=P.complete?.bind(P)}this.__isAsync&&(r=this.wrapInTimeout(r),s&&(s=this.wrapInTimeout(s)),y&&(y=this.wrapInTimeout(y)));let A=super.subscribe({next:s,error:r,complete:y});return t instanceof Tn&&t.add(A),A}wrapInTimeout(t){return e=>{let n=this.pendingTasks?.add();setTimeout(()=>{t(e),n!==void 0&&this.pendingTasks?.remove(n)})}}},ui=xA;function ob(...i){}function TB(i){let t,e;function n(){i=ob;try{e!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(e),t!==void 0&&clearTimeout(t)}catch{}}return t=setTimeout(()=>{i(),n()}),typeof requestAnimationFrame=="function"&&(e=requestAnimationFrame(()=>{i(),n()})),()=>n()}function W3(i){return queueMicrotask(()=>i()),()=>{i=ob}}var VR="isAngularZone",ZC=VR+"_ID",k9=0,ki=class i{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new ui(!1);onMicrotaskEmpty=new ui(!1);onStable=new ui(!1);onError=new ui(!1);constructor(t){let{enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:s=!1,scheduleInRootZone:r=SB}=t;if(typeof Zone>"u")throw new Mi(908,!1);Zone.assertZonePatched();let y=this;y._nesting=0,y._outer=y._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(y._inner=y._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(y._inner=y._inner.fork(Zone.longStackTraceZoneSpec)),y.shouldCoalesceEventChangeDetection=!s&&n,y.shouldCoalesceRunChangeDetection=s,y.callbackScheduled=!1,y.scheduleInRootZone=r,F9(y)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(VR)===!0}static assertInAngularZone(){if(!i.isInAngularZone())throw new Mi(909,!1)}static assertNotInAngularZone(){if(i.isInAngularZone())throw new Mi(909,!1)}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,s){let r=this._inner,y=r.scheduleEventTask("NgZoneEvent: "+s,t,P9,ob,ob);try{return r.runTask(y,e,n)}finally{r.cancelTask(y)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}},P9={};function jR(i){if(i._nesting==0&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function O9(i){if(i.isCheckStableRunning||i.callbackScheduled)return;i.callbackScheduled=!0;function t(){TB(()=>{i.callbackScheduled=!1,wA(i),i.isCheckStableRunning=!0,jR(i),i.isCheckStableRunning=!1})}i.scheduleInRootZone?Zone.root.run(()=>{t()}):i._outer.run(()=>{t()}),wA(i)}function F9(i){let t=()=>{O9(i)},e=k9++;i._inner=i._inner.fork({name:"angular",properties:{[VR]:!0,[ZC]:e,[ZC+e]:!0},onInvokeTask:(n,s,r,y,A,P)=>{if(L9(P))return n.invokeTask(r,y,A,P);try{return Y3(i),n.invokeTask(r,y,A,P)}finally{(i.shouldCoalesceEventChangeDetection&&y.type==="eventTask"||i.shouldCoalesceRunChangeDetection)&&t(),Z3(i)}},onInvoke:(n,s,r,y,A,P,B)=>{try{return Y3(i),n.invoke(r,y,A,P,B)}finally{i.shouldCoalesceRunChangeDetection&&!i.callbackScheduled&&!N9(P)&&t(),Z3(i)}},onHasTask:(n,s,r,y)=>{n.hasTask(r,y),s===r&&(y.change=="microTask"?(i._hasPendingMicrotasks=y.microTask,wA(i),jR(i)):y.change=="macroTask"&&(i.hasPendingMacrotasks=y.macroTask))},onHandleError:(n,s,r,y)=>(n.handleError(r,y),i.runOutsideAngular(()=>i.onError.emit(y)),!1)})}function wA(i){i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&i.callbackScheduled===!0?i.hasPendingMicrotasks=!0:i.hasPendingMicrotasks=!1}function Y3(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function Z3(i){i._nesting--,jR(i)}var CA=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new ui;onMicrotaskEmpty=new ui;onStable=new ui;onError=new ui;run(t,e,n){return t.apply(e,n)}runGuarded(t,e,n){return t.apply(e,n)}runOutsideAngular(t){return t()}runTask(t,e,n,s){return t.apply(e,n)}};function L9(i){return IB(i,"__ignore_ng_zone__")}function N9(i){return IB(i,"__scheduler_tick__")}function IB(i,t){return!Array.isArray(i)||i.length!==1?!1:i[0]?.data?.[t]===!0}var Ms=class{_console=console;handleError(t){this._console.error("ERROR",t)}},z9=new Dt("",{providedIn:"root",factory:()=>{let i=Z(ki),t=Z(Ms);return e=>i.runOutsideAngular(()=>t.handleError(e))}});function X3(i,t){return Tz(i,t)}function B9(i){return Tz(Mz,i)}var AB=(X3.required=B9,X3);function V9(){return z_(os(),pn())}function z_(i,t){return new Ii(Rd(i,t))}var Ii=(()=>{class i{nativeElement;constructor(e){this.nativeElement=e}static __NG_ELEMENT_ID__=V9}return i})();function RB(i){return i instanceof Ii?i.nativeElement:i}function np(i){return typeof i=="function"&&i[Gs]!==void 0}function Lo(i,t){let e=II(i,t?.equal),n=e[Gs];return e.set=s=>U0(n,s),e.update=s=>AI(n,s),e.asReadonly=j9.bind(e),e}function j9(){let i=this[Gs];if(i.readonlyFn===void 0){let t=()=>this();t[Gs]=i,i.readonlyFn=t}return i.readonlyFn}function kB(i){return np(i)&&typeof i.set=="function"}function U9(){return this._results[Symbol.iterator]()}var ep=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new ni}constructor(t=!1){this._emitDistinctChangesOnly=t}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){this.dirty=!1;let n=MW(t);(this._changesDetected=!DW(this._results,n,e))&&(this._results=n,this.length=n.length,this.last=n[this.length-1],this.first=n[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(t){this._onDirty=t}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=U9};function PB(i){return(i.flags&128)===128}var OB=function(i){return i[i.OnPush=0]="OnPush",i[i.Default=1]="Default",i}(OB||{}),FB=new Map,H9=0;function $9(){return H9++}function G9(i){FB.set(i[pE],i)}function EA(i){FB.delete(i[pE])}var K3="__ngContext__";function B_(i,t){Kh(t)?(i[K3]=t[pE],G9(t)):i[K3]=t}function LB(i){return zB(i[nb])}function NB(i){return zB(i[Nc])}function zB(i){for(;i!==null&&!Su(i);)i=i[Nc];return i}var SA;function BB(i){SA=i}function q9(){if(SA!==void 0)return SA;if(typeof document<"u")return document;throw new Mi(210,!1)}var pm=new Dt("",{providedIn:"root",factory:()=>W9}),W9="ng",UR=new Dt(""),as=new Dt("",{providedIn:"platform",factory:()=>"unknown"});var Vr=new Dt(""),pb=new Dt("",{providedIn:"root",factory:()=>q9().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var Y9="h",Z9="b";var VB=!1,X9=new Dt("",{providedIn:"root",factory:()=>VB});var HR=function(i){return i[i.CHANGE_DETECTION=0]="CHANGE_DETECTION",i[i.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",i}(HR||{}),V_=new Dt(""),Q3=new Set;function rp(i){Q3.has(i)||(Q3.add(i),performance?.mark?.("mark_feature_usage",{detail:{feature:i}}))}var $R=(()=>{class i{view;node;constructor(e,n){this.view=e,this.node=n}static __NG_ELEMENT_ID__=K9}return i})();function K9(){return new $R(pn(),os())}var __=function(i){return i[i.EarlyRead=0]="EarlyRead",i[i.Write=1]="Write",i[i.MixedReadWrite=2]="MixedReadWrite",i[i.Read=3]="Read",i}(__||{}),jB=(()=>{class i{impl=null;execute(){this.impl?.execute()}static \u0275prov=Mt({token:i,providedIn:"root",factory:()=>new i})}return i})(),Q9=[__.EarlyRead,__.Write,__.MixedReadWrite,__.Read],J9=(()=>{class i{ngZone=Z(ki);scheduler=Z(sm);errorHandler=Z(Ms,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){Z(V_,{optional:!0})}execute(){let e=this.sequences.size>0;e&&Br(16),this.executing=!0;for(let n of Q9)for(let s of this.sequences)if(!(s.erroredOrDestroyed||!s.hooks[n]))try{s.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let r=s.hooks[n];return r(s.pipelinedValue)},s.snapshot))}catch(r){s.erroredOrDestroyed=!0,this.errorHandler?.handleError(r)}this.executing=!1;for(let n of this.sequences)n.afterRun(),n.once&&(this.sequences.delete(n),n.destroy());for(let n of this.deferredRegistrations)this.sequences.add(n);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),e&&Br(17)}register(e){let{view:n}=e;n!==void 0?((n[v_]??=[]).push(e),F_(n),n[Pn]|=8192):this.executing?this.deferredRegistrations.add(e):this.addSequence(e)}addSequence(e){this.sequences.add(e),this.scheduler.notify(7)}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}maybeTrace(e,n){return n?n.run(HR.AFTER_NEXT_RENDER,e):e()}static \u0275prov=Mt({token:i,providedIn:"root",factory:()=>new i})}return i})(),DA=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(t,e,n,s,r,y=null){this.impl=t,this.hooks=e,this.view=n,this.once=s,this.snapshot=y,this.unregisterOnDestroy=r?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let t=this.view?.[v_];t&&(this.view[v_]=t.filter(e=>e!==this))}};function fm(i,t){!t?.injector&&CR(fm);let e=t?.injector??Z(vn);return rp("NgAfterRender"),UB(i,e,t,!1)}function Ma(i,t){!t?.injector&&CR(Ma);let e=t?.injector??Z(vn);return rp("NgAfterNextRender"),UB(i,e,t,!0)}function e7(i,t){if(i instanceof Function){let e=[void 0,void 0,void 0,void 0];return e[t]=i,e}else return[i.earlyRead,i.write,i.mixedReadWrite,i.read]}function UB(i,t,e,n){let s=t.get(jB);s.impl??=t.get(J9);let r=t.get(V_,null,{optional:!0}),y=e?.phase??__.MixedReadWrite,A=e?.manualCleanup!==!0?t.get(N_):null,P=t.get($R,null,{optional:!0}),B=new DA(s.impl,e7(i,y),P?.view,n,A,r?.snapshot(null));return s.impl.register(B),B}var t7=()=>null;function HB(i,t,e=!1){return t7(i,t,e)}function $B(i,t){let e=i.contentQueries;if(e!==null){let n=er(null);try{for(let s=0;s<e.length;s+=2){let r=e[s],y=e[s+1];if(y!==-1){let A=i.data[y];gE(r),A.contentQueries(2,t[y],y)}}}finally{er(n)}}}function MA(i,t,e){gE(0);let n=er(null);try{t(i,e)}finally{er(n)}}function GR(i,t,e){if(ER(t)){let n=er(null);try{let s=t.directiveStart,r=t.directiveEnd;for(let y=s;y<r;y++){let A=i.data[y];if(A.contentQueries){let P=e[y];A.contentQueries(1,P,y)}}}finally{er(n)}}}var Ad=function(i){return i[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",i}(Ad||{}),SC;function i7(){if(SC===void 0&&(SC=null,Ed.trustedTypes))try{SC=Ed.trustedTypes.createPolicy("angular",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch{}return SC}function bE(i){return i7()?.createHTML(i)||i}var DC;function n7(){if(DC===void 0&&(DC=null,Ed.trustedTypes))try{DC=Ed.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch{}return DC}function J3(i){return n7()?.createScriptURL(i)||i}var xu=class{changingThisBreaksApplicationSecurity;constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Dz})`}},TA=class extends xu{getTypeName(){return"HTML"}},IA=class extends xu{getTypeName(){return"Style"}},AA=class extends xu{getTypeName(){return"Script"}},RA=class extends xu{getTypeName(){return"URL"}},kA=class extends xu{getTypeName(){return"ResourceURL"}};function zc(i){return i instanceof xu?i.changingThisBreaksApplicationSecurity:i}function op(i,t){let e=r7(i);if(e!=null&&e!==t){if(e==="ResourceURL"&&t==="URL")return!0;throw new Error(`Required a safe ${t}, got a ${e} (see ${Dz})`)}return e===t}function r7(i){return i instanceof xu&&i.getTypeName()||null}function GB(i){return new TA(i)}function qB(i){return new IA(i)}function WB(i){return new AA(i)}function YB(i){return new RA(i)}function ZB(i){return new kA(i)}function o7(i){let t=new OA(i);return a7()?new PA(t):t}var PA=class{inertDocumentHelper;constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{let e=new window.DOMParser().parseFromString(bE(t),"text/html").body;return e===null?this.inertDocumentHelper.getInertBodyElement(t):(e.firstChild?.remove(),e)}catch{return null}}},OA=class{defaultDoc;inertDocument;constructor(t){this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(t){let e=this.inertDocument.createElement("template");return e.innerHTML=bE(t),e}};function a7(){try{return!!new window.DOMParser().parseFromString(bE(""),"text/html")}catch{return!1}}var s7=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function xE(i){return i=String(i),i.match(s7)?i:"unsafe:"+i}function Tu(i){let t={};for(let e of i.split(","))t[e]=!0;return t}function fb(...i){let t={};for(let e of i)for(let n in e)e.hasOwnProperty(n)&&(t[n]=!0);return t}var XB=Tu("area,br,col,hr,img,wbr"),KB=Tu("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),QB=Tu("rp,rt"),l7=fb(QB,KB),c7=fb(KB,Tu("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),d7=fb(QB,Tu("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ez=fb(XB,c7,d7,l7),JB=Tu("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),u7=Tu("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),h7=Tu("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext"),p7=fb(JB,u7,h7),f7=Tu("script,style,template"),FA=class{sanitizedSomething=!1;buf=[];sanitizeChildren(t){let e=t.firstChild,n=!0,s=[];for(;e;){if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild){s.push(e),e=_7(e);continue}for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let r=g7(e);if(r){e=r;break}e=s.pop()}}return this.buf.join("")}startElement(t){let e=tz(t).toLowerCase();if(!ez.hasOwnProperty(e))return this.sanitizedSomething=!0,!f7.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);let n=t.attributes;for(let s=0;s<n.length;s++){let r=n.item(s),y=r.name,A=y.toLowerCase();if(!p7.hasOwnProperty(A)){this.sanitizedSomething=!0;continue}let P=r.value;JB[A]&&(P=xE(P)),this.buf.push(" ",y,'="',iz(P),'"')}return this.buf.push(">"),!0}endElement(t){let e=tz(t).toLowerCase();ez.hasOwnProperty(e)&&!XB.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(iz(t))}};function m7(i,t){return(i.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}function g7(i){let t=i.nextSibling;if(t&&i!==t.previousSibling)throw eV(t);return t}function _7(i){let t=i.firstChild;if(t&&m7(i,t))throw eV(t);return t}function tz(i){let t=i.nodeName;return typeof t=="string"?t:"FORM"}function eV(i){return new Error(`Failed to sanitize html because the element is clobbered: ${i.outerHTML}`)}var y7=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,v7=/([^\#-~ |!])/g;function iz(i){return i.replace(/&/g,"&amp;").replace(y7,function(t){let e=t.charCodeAt(0),n=t.charCodeAt(1);return"&#"+((e-55296)*1024+(n-56320)+65536)+";"}).replace(v7,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var MC;function tV(i,t){let e=null;try{MC=MC||o7(i);let n=t?String(t):"";e=MC.getInertBodyElement(n);let s=5,r=n;do{if(s===0)throw new Error("Failed to sanitize html because the input is unstable");s--,n=r,r=e.innerHTML,e=MC.getInertBodyElement(n)}while(n!==r);let A=new FA().sanitizeChildren(nz(e)||e);return bE(A)}finally{if(e){let n=nz(e)||e;for(;n.firstChild;)n.firstChild.remove()}}}function nz(i){return"content"in i&&b7(i)?i.content:null}function b7(i){return i.nodeType===Node.ELEMENT_NODE&&i.nodeName==="TEMPLATE"}var ss=function(i){return i[i.NONE=0]="NONE",i[i.HTML=1]="HTML",i[i.STYLE=2]="STYLE",i[i.SCRIPT=3]="SCRIPT",i[i.URL=4]="URL",i[i.RESOURCE_URL=5]="RESOURCE_URL",i}(ss||{});function mm(i){let t=nV();return t?t.sanitize(ss.URL,i)||"":op(i,"URL")?zc(i):xE(x_(i))}function x7(i){let t=nV();if(t)return J3(t.sanitize(ss.RESOURCE_URL,i)||"");if(op(i,"ResourceURL"))return J3(zc(i));throw new Mi(904,!1)}function w7(i,t){return t==="src"&&(i==="embed"||i==="frame"||i==="iframe"||i==="media"||i==="script")||t==="href"&&(i==="base"||i==="link")?x7:mm}function iV(i,t,e){return w7(t,e)(i)}function nV(){let i=pn();return i&&i[vu].sanitizer}var C7=/^>|^->|<!--|-->|--!>|<!-$/g,E7=/(<|>)/g,S7="\u200B$1\u200B";function D7(i){return i.replace(C7,t=>t.replace(E7,S7))}function rV(i){return i instanceof Function?i():i}function M7(i,t,e){let n=i.length;for(;;){let s=i.indexOf(t,e);if(s===-1)return s;if(s===0||i.charCodeAt(s-1)<=32){let r=t.length;if(s+r===n||i.charCodeAt(s+r)<=32)return s}e=s+1}}var oV="ng-template";function T7(i,t,e,n){let s=0;if(n){for(;s<t.length&&typeof t[s]=="string";s+=2)if(t[s]==="class"&&M7(t[s+1].toLowerCase(),e,0)!==-1)return!0}else if(qR(i))return!1;if(s=t.indexOf(1,s),s>-1){let r;for(;++s<t.length&&typeof(r=t[s])=="string";)if(r.toLowerCase()===e)return!0}return!1}function qR(i){return i.type===4&&i.value!==oV}function I7(i,t,e){let n=i.type===4&&!e?oV:i.value;return t===n}function A7(i,t,e){let n=4,s=i.attrs,r=s!==null?P7(s):0,y=!1;for(let A=0;A<t.length;A++){let P=t[A];if(typeof P=="number"){if(!y&&!Fc(n)&&!Fc(P))return!1;if(y&&Fc(P))continue;y=!1,n=P|n&1;continue}if(!y)if(n&4){if(n=2|n&1,P!==""&&!I7(i,P,e)||P===""&&t.length===1){if(Fc(n))return!1;y=!0}}else if(n&8){if(s===null||!T7(i,s,P,e)){if(Fc(n))return!1;y=!0}}else{let B=t[++A],U=R7(P,s,qR(i),e);if(U===-1){if(Fc(n))return!1;y=!0;continue}if(B!==""){let J;if(U>r?J="":J=s[U+1].toLowerCase(),n&2&&B!==J){if(Fc(n))return!1;y=!0}}}}return Fc(n)||y}function Fc(i){return(i&1)===0}function R7(i,t,e,n){if(t===null)return-1;let s=0;if(n||!e){let r=!1;for(;s<t.length;){let y=t[s];if(y===i)return s;if(y===3||y===6)r=!0;else if(y===1||y===2){let A=t[++s];for(;typeof A=="string";)A=t[++s];continue}else{if(y===4)break;if(y===0){s+=4;continue}}s+=r?1:2}return-1}else return O7(t,i)}function aV(i,t,e=!1){for(let n=0;n<t.length;n++)if(A7(i,t[n],e))return!0;return!1}function k7(i){let t=i.attrs;if(t!=null){let e=t.indexOf(5);if((e&1)===0)return t[e+1]}return null}function P7(i){for(let t=0;t<i.length;t++){let e=i[t];if(fB(e))return t}return i.length}function O7(i,t){let e=i.indexOf(4);if(e>-1)for(e++;e<i.length;){let n=i[e];if(typeof n=="number")return-1;if(n===t)return e;e++}return-1}function F7(i,t){e:for(let e=0;e<t.length;e++){let n=t[e];if(i.length===n.length){for(let s=0;s<i.length;s++)if(i[s]!==n[s])continue e;return!0}}return!1}function rz(i,t){return i?":not("+t.trim()+")":t}function L7(i){let t=i[0],e=1,n=2,s="",r=!1;for(;e<i.length;){let y=i[e];if(typeof y=="string")if(n&2){let A=i[++e];s+="["+y+(A.length>0?'="'+A+'"':"")+"]"}else n&8?s+="."+y:n&4&&(s+=" "+y);else s!==""&&!Fc(y)&&(t+=rz(r,s),s=""),n=y,r=r||!Fc(n);e++}return s!==""&&(t+=rz(r,s)),t}function N7(i){return i.map(L7).join(",")}function z7(i){let t=[],e=[],n=1,s=2;for(;n<i.length;){let r=i[n];if(typeof r=="string")s===2?r!==""&&t.push(r,i[++n]):s===8&&e.push(r);else{if(!Fc(s))break;s=r}n++}return e.length&&t.push(1,...e),t}var Ks={};function B7(i,t){return i.createText(t)}function V7(i,t,e){i.setValue(t,e)}function j7(i,t){return i.createComment(D7(t))}function sV(i,t,e){return i.createElement(t,e)}function XC(i,t,e,n,s){i.insertBefore(t,e,n,s)}function lV(i,t,e){i.appendChild(t,e)}function oz(i,t,e,n,s){n!==null?XC(i,t,e,n,s):lV(i,t,e)}function U7(i,t,e){i.removeChild(null,t,e)}function H7(i,t,e){i.setAttribute(t,"style",e)}function $7(i,t,e){e===""?i.removeAttribute(t,"class"):i.setAttribute(t,"class",e)}function cV(i,t,e){let{mergedAttrs:n,classes:s,styles:r}=e;n!==null&&v9(i,t,n),s!==null&&$7(i,t,s),r!==null&&H7(i,t,r)}function WR(i,t,e,n,s,r,y,A,P,B,U){let J=na+n,le=J+s,re=G7(J,le),X=typeof B=="function"?B():B;return re[Hn]={type:i,blueprint:re,template:e,queries:null,viewQuery:A,declTNode:t,data:re.slice().fill(null,J),bindingStartIndex:J,expandoStartIndex:le,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof r=="function"?r():r,pipeRegistry:typeof y=="function"?y():y,firstChild:null,schemas:P,consts:X,incompleteFirstPass:!1,ssrId:U}}function G7(i,t){let e=[];for(let n=0;n<t;n++)e.push(n<i?null:Ks);return e}function q7(i){let t=i.tView;return t===null||t.incompleteFirstPass?i.tView=WR(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts,i.id):t}function YR(i,t,e,n,s,r,y,A,P,B,U){let J=t.blueprint.slice();return J[Eu]=s,J[Pn]=n|4|128|8|64|1024,(B!==null||i&&i[Pn]&2048)&&(J[Pn]|=2048),tB(J),J[rs]=J[P_]=i,J[Ea]=e,J[vu]=y||i&&i[vu],J[_o]=A||i&&i[_o],J[S_]=P||i&&i[S_]||null,J[Xs]=r,J[pE]=$9(),J[E_]=U,J[Wz]=B,J[xl]=t.type==2?i[xl]:J,J}function W7(i,t,e){let n=Rd(t,i),s=q7(e),r=i[vu].rendererFactory,y=ZR(i,YR(i,s,null,dV(e),n,t,null,r.createRenderer(n,e),null,null,null));return i[t.index]=y}function dV(i){let t=16;return i.signals?t=4096:i.onPush&&(t=64),t}function uV(i,t,e,n){if(e===0)return-1;let s=t.length;for(let r=0;r<e;r++)t.push(n),i.blueprint.push(n),i.data.push(null);return s}function ZR(i,t){return i[nb]?i[V3][Nc]=t:i[nb]=t,i[V3]=t,t}function ge(i=1){hV(uo(),pn(),Du()+i,!1)}function hV(i,t,e,n){if(!n)if((t[Pn]&3)===3){let r=i.preOrderCheckHooks;r!==null&&AC(t,r,e)}else{let r=i.preOrderHooks;r!==null&&RC(t,r,0,e)}om(e)}var wE=function(i){return i[i.None=0]="None",i[i.SignalBased=1]="SignalBased",i[i.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",i}(wE||{});function LA(i,t,e,n){let s=er(null);try{let[r,y,A]=i.inputs[e],P=null;(y&wE.SignalBased)!==0&&(P=t[r][Gs]),P!==null&&P.transformFn!==void 0?n=P.transformFn(n):A!==null&&(n=A.call(t,n)),i.setInput!==null?i.setInput(t,P,n,e,r):Zz(t,P,r,n)}finally{er(s)}}function pV(i,t,e,n,s){let r=Du(),y=n&2;try{om(-1),y&&t.length>na&&hV(i,t,na,!1),Br(y?2:0,s),e(n,s)}finally{om(r),Br(y?3:1,s)}}function CE(i,t,e){J7(i,t,e),(e.flags&64)===64&&eY(i,t,e)}function XR(i,t,e=Rd){let n=t.localNames;if(n!==null){let s=t.index+1;for(let r=0;r<n.length;r+=2){let y=n[r+1],A=y===-1?e(t,i):i[y];i[s++]=A}}}function Y7(i,t,e,n){let r=n.get(X9,VB)||e===Ad.ShadowDom,y=i.selectRootElement(t,r);return Z7(y),y}function Z7(i){X7(i)}var X7=()=>null;function K7(i){return i==="class"?"className":i==="for"?"htmlFor":i==="formaction"?"formAction":i==="innerHtml"?"innerHTML":i==="readonly"?"readOnly":i==="tabindex"?"tabIndex":i}function EE(i,t,e,n,s,r,y,A){if(!A&&QR(t,i,e,n,s)){O_(t)&&Q7(e,t.index);return}if(t.type&3){let P=Rd(t,e);n=K7(n),s=y!=null?y(s,t.value||"",n):s,r.setProperty(P,n,s)}else t.type&12}function Q7(i,t){let e=Id(t,i);e[Pn]&16||(e[Pn]|=64)}function J7(i,t,e){let n=e.directiveStart,s=e.directiveEnd;O_(e)&&W7(t,e,i.data[n+e.componentOffset]),i.firstCreatePass||WC(e,t);let r=e.initialInputs;for(let y=n;y<s;y++){let A=i.data[y],P=rb(t,i,y,e);if(B_(P,t),r!==null&&rY(t,y-n,P,A,e,r),Md(A)){let B=Id(e.index,t);B[Ea]=rb(t,i,y,e)}}}function eY(i,t,e){let n=e.directiveStart,s=e.directiveEnd,r=e.index,y=c9();try{om(r);for(let A=n;A<s;A++){let P=i.data[A],B=t[A];_A(A),(P.hostBindings!==null||P.hostVars!==0||P.hostAttrs!==null)&&tY(P,B)}}finally{om(-1),_A(y)}}function tY(i,t){i.hostBindings!==null&&i.hostBindings(1,t)}function KR(i,t){let e=i.directiveRegistry,n=null;if(e)for(let s=0;s<e.length;s++){let r=e[s];aV(t,r.selectors,!1)&&(n??=[],Md(r)?n.unshift(r):n.push(r))}return n}function iY(i,t,e,n,s,r){let y=Rd(i,t);nY(t[_o],y,r,i.value,e,n,s)}function nY(i,t,e,n,s,r,y){if(r==null)i.removeAttribute(t,s,e);else{let A=y==null?x_(r):y(r,n||"",s);i.setAttribute(t,s,A,e)}}function rY(i,t,e,n,s,r){let y=r[t];if(y!==null)for(let A=0;A<y.length;A+=2){let P=y[A],B=y[A+1];LA(n,e,P,B)}}function oY(i,t){let e=i[S_],n=e?e.get(Ms,null):null;n&&n.handleError(t)}function QR(i,t,e,n,s){let r=i.inputs?.[n],y=i.hostDirectiveInputs?.[n],A=!1;if(y)for(let P=0;P<y.length;P+=2){let B=y[P],U=y[P+1],J=t.data[B];LA(J,e[B],U,s),A=!0}if(r)for(let P of r){let B=e[P],U=t.data[P];LA(U,B,n,s),A=!0}return A}function aY(i,t){let e=Id(t,i),n=e[Hn];sY(n,e);let s=e[Eu];s!==null&&e[E_]===null&&(e[E_]=HB(s,e[S_])),Br(18),JR(n,e,e[Ea]),Br(19,e[Ea])}function sY(i,t){for(let e=t.length;e<i.blueprint.length;e++)t.push(i.blueprint[e])}function JR(i,t,e){FR(t);try{let n=i.viewQuery;n!==null&&MA(1,n,e);let s=i.template;s!==null&&pV(i,t,s,1,e),i.firstCreatePass&&(i.firstCreatePass=!1),t[bu]?.finishViewCreation(i),i.staticContentQueries&&$B(i,t),i.staticViewQueries&&MA(2,i.viewQuery,e);let r=i.components;r!==null&&lY(t,r)}catch(n){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),n}finally{t[Pn]&=-5,LR()}}function lY(i,t){for(let e=0;e<t.length;e++)aY(i,t[e])}function mb(i,t,e,n){let s=er(null);try{let r=t.tView,A=i[Pn]&4096?4096:16,P=YR(i,r,e,A,null,t,null,null,n?.injector??null,n?.embeddedViewInjector??null,n?.dehydratedView??null),B=i[t.index];P[tm]=B;let U=i[bu];return U!==null&&(P[bu]=U.createEmbeddedView(r)),JR(r,P,e),P}finally{er(s)}}function T_(i,t){return!t||t.firstChild===null||PB(i)}var cY;function ek(i,t){return cY(i,t)}var wu=function(i){return i[i.Important=1]="Important",i[i.DashCase=2]="DashCase",i}(wu||{});function tk(i){return(i.flags&32)===32}function y_(i,t,e,n,s){if(n!=null){let r,y=!1;Su(n)?r=n:Kh(n)&&(y=!0,n=n[Eu]);let A=Td(n);i===0&&e!==null?s==null?lV(t,e,A):XC(t,e,A,s||null,!0):i===1&&e!==null?XC(t,e,A,s||null,!0):i===2?U7(t,A,y):i===3&&t.destroyNode(A),r!=null&&vY(t,i,r,e,s)}}function dY(i,t){fV(i,t),t[Eu]=null,t[Xs]=null}function uY(i,t,e,n,s,r){n[Eu]=s,n[Xs]=t,ME(i,n,e,1,s,r)}function fV(i,t){t[vu].changeDetectionScheduler?.notify(9),ME(i,t,t[_o],2,null,null)}function hY(i){let t=i[nb];if(!t)return KI(i[Hn],i);for(;t;){let e=null;if(Kh(t))e=t[nb];else{let n=t[ns];n&&(e=n)}if(!e){for(;t&&!t[Nc]&&t!==i;)Kh(t)&&KI(t[Hn],t),t=t[rs];t===null&&(t=i),Kh(t)&&KI(t[Hn],t),e=t&&t[Nc]}t=e}}function ik(i,t){let e=i[D_],n=e.indexOf(t);e.splice(n,1)}function SE(i,t){if(ub(t))return;let e=t[_o];e.destroyNode&&ME(i,t,e,3,null,null),hY(t)}function KI(i,t){if(ub(t))return;let e=er(null);try{t[Pn]&=-129,t[Pn]|=256,t[Ul]&&j0(t[Ul]),fY(i,t),pY(i,t),t[Hn].type===1&&t[_o].destroy();let n=t[tm];if(n!==null&&Su(t[rs])){n!==t[rs]&&ik(n,t);let s=t[bu];s!==null&&s.detachView(i)}EA(t)}finally{er(e)}}function pY(i,t){let e=i.cleanup,n=t[VC];if(e!==null)for(let y=0;y<e.length-1;y+=2)if(typeof e[y]=="string"){let A=e[y+3];A>=0?n[A]():n[-A].unsubscribe(),y+=2}else{let A=n[e[y+1]];e[y].call(A)}n!==null&&(t[VC]=null);let s=t[Xh];if(s!==null){t[Xh]=null;for(let y=0;y<s.length;y++){let A=s[y];A()}}let r=t[im];if(r!==null){t[im]=null;for(let y of r)y.destroy()}}function fY(i,t){let e;if(i!=null&&(e=i.destroyHooks)!=null)for(let n=0;n<e.length;n+=2){let s=t[e[n]];if(!(s instanceof am)){let r=e[n+1];if(Array.isArray(r))for(let y=0;y<r.length;y+=2){let A=s[r[y]],P=r[y+1];Br(4,A,P);try{P.call(A)}finally{Br(5,A,P)}}else{Br(4,s,r);try{r.call(s)}finally{Br(5,s,r)}}}}}function mV(i,t,e){return mY(i,t.parent,e)}function mY(i,t,e){let n=t;for(;n!==null&&n.type&168;)t=n,n=t.parent;if(n===null)return e[Eu];if(O_(n)){let{encapsulation:s}=i.data[n.directiveStart+n.componentOffset];if(s===Ad.None||s===Ad.Emulated)return null}return Rd(n,e)}function gV(i,t,e){return _Y(i,t,e)}function gY(i,t,e){return i.type&40?Rd(i,e):null}var _Y=gY,az;function DE(i,t,e,n){let s=mV(i,n,t),r=t[_o],y=n.parent||t[Xs],A=gV(y,n,t);if(s!=null)if(Array.isArray(e))for(let P=0;P<e.length;P++)oz(r,s,e[P],A,!1);else oz(r,s,e,A,!1);az!==void 0&&az(r,n,t,e,s)}function eb(i,t){if(t!==null){let e=t.type;if(e&3)return Rd(t,i);if(e&4)return NA(-1,i[t.index]);if(e&8){let n=t.child;if(n!==null)return eb(i,n);{let s=i[t.index];return Su(s)?NA(-1,s):Td(s)}}else{if(e&128)return eb(i,t.next);if(e&32)return ek(t,i)()||Td(i[t.index]);{let n=_V(i,t);if(n!==null){if(Array.isArray(n))return n[0];let s=rm(i[xl]);return eb(s,n)}else return eb(i,t.next)}}}return null}function _V(i,t){if(t!==null){let n=i[xl][Xs],s=t.projection;return n.projection[s]}return null}function NA(i,t){let e=ns+i+1;if(e<t.length){let n=t[e],s=n[Hn].firstChild;if(s!==null)return eb(n,s)}return t[nm]}function nk(i,t,e,n,s,r,y){for(;e!=null;){if(e.type===128){e=e.next;continue}let A=n[e.index],P=e.type;if(y&&t===0&&(A&&B_(Td(A),n),e.flags|=2),!tk(e))if(P&8)nk(i,t,e.child,n,s,r,!1),y_(t,i,s,A,r);else if(P&32){let B=ek(e,n),U;for(;U=B();)y_(t,i,s,U,r);y_(t,i,s,A,r)}else P&16?yV(i,t,n,e,s,r):y_(t,i,s,A,r);e=y?e.projectionNext:e.next}}function ME(i,t,e,n,s,r){nk(e,n,i.firstChild,t,s,r,!1)}function yY(i,t,e){let n=t[_o],s=mV(i,e,t),r=e.parent||t[Xs],y=gV(r,e,t);yV(n,0,t,e,s,y)}function yV(i,t,e,n,s,r){let y=e[xl],P=y[Xs].projection[n.projection];if(Array.isArray(P))for(let B=0;B<P.length;B++){let U=P[B];y_(t,i,s,U,r)}else{let B=P,U=y[rs];PB(n)&&(B.flags|=128),nk(i,t,B,U,s,r,!0)}}function vY(i,t,e,n,s){let r=e[nm],y=Td(e);r!==y&&y_(t,i,n,r,s);for(let A=ns;A<e.length;A++){let P=e[A];ME(P[Hn],P,i,t,n,r)}}function bY(i,t,e,n,s){if(t)s?i.addClass(e,n):i.removeClass(e,n);else{let r=n.indexOf("-")===-1?void 0:wu.DashCase;s==null?i.removeStyle(e,n,r):(typeof s=="string"&&s.endsWith("!important")&&(s=s.slice(0,-10),r|=wu.Important),i.setStyle(e,n,s,r))}}function KC(i,t,e,n,s=!1){for(;e!==null;){if(e.type===128){e=s?e.projectionNext:e.next;continue}let r=t[e.index];r!==null&&n.push(Td(r)),Su(r)&&xY(r,n);let y=e.type;if(y&8)KC(i,t,e.child,n);else if(y&32){let A=ek(e,t),P;for(;P=A();)n.push(P)}else if(y&16){let A=_V(t,e);if(Array.isArray(A))n.push(...A);else{let P=rm(t[xl]);KC(P[Hn],P,A,n,!0)}}e=s?e.projectionNext:e.next}return n}function xY(i,t){for(let e=ns;e<i.length;e++){let n=i[e],s=n[Hn].firstChild;s!==null&&KC(n[Hn],n,s,t)}i[nm]!==i[Eu]&&t.push(i[nm])}function vV(i){if(i[v_]!==null){for(let t of i[v_])t.impl.addSequence(t);i[v_].length=0}}var bV=[];function wY(i){return i[Ul]??CY(i)}function CY(i){let t=bV.pop()??Object.create(SY);return t.lView=i,t}function EY(i){i.lView[Ul]!==i&&(i.lView=null,bV.push(i))}var SY=Xi(Ct({},a_),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:i=>{F_(i.lView)},consumerOnSignalRead(){this.lView[Ul]=this}});function DY(i){let t=i[Ul]??Object.create(MY);return t.lView=i,t}var MY=Xi(Ct({},a_),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:i=>{let t=rm(i.lView);for(;t&&!xV(t[Hn]);)t=rm(t);t&&iB(t)},consumerOnSignalRead(){this.lView[Ul]=this}});function xV(i){return i.type!==2}function wV(i){if(i[im]===null)return;let t=!0;for(;t;){let e=!1;for(let n of i[im])n.dirty&&(e=!0,n.zone===null||Zone.current===n.zone?n.run():n.zone.run(()=>n.run()));t=e&&!!(i[Pn]&8192)}}var TY=100;function CV(i,t=!0,e=0){let s=i[vu].rendererFactory,r=!1;r||s.begin?.();try{IY(i,e)}catch(y){throw t&&oY(i,y),y}finally{r||s.end?.()}}function IY(i,t){let e=aB();try{HC(!0),zA(i,t);let n=0;for(;mE(i);){if(n===TY)throw new Mi(103,!1);n++,zA(i,1)}}finally{HC(e)}}function AY(i,t,e,n){if(ub(t))return;let s=t[Pn],r=!1,y=!1;FR(t);let A=!0,P=null,B=null;r||(xV(i)?(B=wY(t),P=V0(B)):EI()===null?(A=!1,B=DY(t),P=V0(B)):t[Ul]&&(j0(t[Ul]),t[Ul]=null));try{tB(t),a9(i.bindingStartIndex),e!==null&&pV(i,t,e,2,n);let U=(s&3)===3;if(!r)if(U){let re=i.preOrderCheckHooks;re!==null&&AC(t,re,null)}else{let re=i.preOrderHooks;re!==null&&RC(t,re,0,null),ZI(t,0)}if(y||RY(t),wV(t),EV(t,0),i.contentQueries!==null&&$B(i,t),!r)if(U){let re=i.contentCheckHooks;re!==null&&AC(t,re)}else{let re=i.contentHooks;re!==null&&RC(t,re,1),ZI(t,1)}PY(i,t);let J=i.components;J!==null&&DV(t,J,0);let le=i.viewQuery;if(le!==null&&MA(2,le,n),!r)if(U){let re=i.viewCheckHooks;re!==null&&AC(t,re)}else{let re=i.viewHooks;re!==null&&RC(t,re,2),ZI(t,2)}if(i.firstUpdatePass===!0&&(i.firstUpdatePass=!1),t[YI]){for(let re of t[YI])re();t[YI]=null}r||(vV(t),t[Pn]&=-73)}catch(U){throw r||F_(t),U}finally{B!==null&&(V1(B,P),A&&EY(B)),LR()}}function EV(i,t){for(let e=LB(i);e!==null;e=NB(e))for(let n=ns;n<e.length;n++){let s=e[n];SV(s,t)}}function RY(i){for(let t=LB(i);t!==null;t=NB(t)){if(!(t[Pn]&2))continue;let e=t[D_];for(let n=0;n<e.length;n++){let s=e[n];iB(s)}}}function kY(i,t,e){Br(18);let n=Id(t,i);SV(n,e),Br(19,n[Ea])}function SV(i,t){MR(i)&&zA(i,t)}function zA(i,t){let n=i[Hn],s=i[Pn],r=i[Ul],y=!!(t===0&&s&16);if(y||=!!(s&64&&t===0),y||=!!(s&1024),y||=!!(r?.dirty&&j1(r)),y||=!1,r&&(r.dirty=!1),i[Pn]&=-9217,y)AY(n,i,n.template,i[Ea]);else if(s&8192){wV(i),EV(i,1);let A=n.components;A!==null&&DV(i,A,1),vV(i)}}function DV(i,t,e){for(let n=0;n<t.length;n++)kY(i,t[n],e)}function PY(i,t){let e=i.hostBindingOpCodes;if(e!==null)try{for(let n=0;n<e.length;n++){let s=e[n];if(s<0)om(~s);else{let r=s,y=e[++n],A=e[++n];l9(y,r);let P=t[r];Br(24,P),A(2,P),Br(25,P)}}}finally{om(-1)}}function rk(i,t){let e=aB()?64:1088;for(i[vu].changeDetectionScheduler?.notify(t);i;){i[Pn]|=e;let n=rm(i);if(UC(i)&&!n)return i;i=n}return null}function MV(i,t,e,n){return[i,!0,0,t,null,n,null,e,null,null]}function TV(i,t){let e=ns+t;if(e<i.length)return i[e]}function gb(i,t,e,n=!0){let s=t[Hn];if(OY(s,t,i,e),n){let y=NA(e,i),A=t[_o],P=A.parentNode(i[nm]);P!==null&&uY(s,i[Xs],A,t,P,y)}let r=t[E_];r!==null&&r.firstChild!==null&&(r.firstChild=null)}function IV(i,t){let e=ab(i,t);return e!==void 0&&SE(e[Hn],e),e}function ab(i,t){if(i.length<=ns)return;let e=ns+t,n=i[e];if(n){let s=n[tm];s!==null&&s!==i&&ik(s,n),t>0&&(i[e-1][Nc]=n[Nc]);let r=zC(i,ns+t);dY(n[Hn],n);let y=r[bu];y!==null&&y.detachView(r[Hn]),n[rs]=null,n[Nc]=null,n[Pn]&=-129}return n}function OY(i,t,e,n){let s=ns+n,r=e.length;n>0&&(e[s-1][Nc]=t),n<r-ns?(t[Nc]=e[s],Nz(e,ns+n,t)):(e.push(t),t[Nc]=null),t[rs]=e;let y=t[tm];y!==null&&e!==y&&AV(y,t);let A=t[bu];A!==null&&A.insertView(i),mA(t),t[Pn]|=128}function AV(i,t){let e=i[D_],n=t[rs];if(Kh(n))i[Pn]|=2;else{let s=n[rs][xl];t[xl]!==s&&(i[Pn]|=2)}e===null?i[D_]=[t]:e.push(t)}var sb=class{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){let t=this._lView,e=t[Hn];return KC(e,t,e.firstChild,[])}constructor(t,e,n=!0){this._lView=t,this._cdRefInjectingView=e,this.notifyErrorHandler=n}get context(){return this._lView[Ea]}set context(t){this._lView[Ea]=t}get destroyed(){return ub(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let t=this._lView[rs];if(Su(t)){let e=t[jC],n=e?e.indexOf(this):-1;n>-1&&(ab(t,n),zC(e,n))}this._attachedToViewContainer=!1}SE(this._lView[Hn],this._lView)}onDestroy(t){nB(this._lView,t)}markForCheck(){rk(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[Pn]&=-129}reattach(){mA(this._lView),this._lView[Pn]|=128}detectChanges(){this._lView[Pn]|=1024,CV(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Mi(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let t=UC(this._lView),e=this._lView[tm];e!==null&&!t&&ik(e,this._lView),fV(this._lView[Hn],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Mi(902,!1);this._appRef=t;let e=UC(this._lView),n=this._lView[tm];n!==null&&!e&&AV(n,this._lView),mA(this._lView)}};var co=(()=>{class i{static __NG_ELEMENT_ID__=NY}return i})(),FY=co,LY=class extends FY{_declarationLView;_declarationTContainer;elementRef;constructor(t,e,n){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=n}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,e){return this.createEmbeddedViewImpl(t,e)}createEmbeddedViewImpl(t,e,n){let s=mb(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:e,dehydratedView:n});return new sb(s)}};function NY(){return TE(os(),pn())}function TE(i,t){return i.type&4?new LY(t,i,z_(i,t)):null}function j_(i,t,e,n,s){let r=i.data[t];if(r===null)r=zY(i,t,e,n,s),s9()&&(r.flags|=32);else if(r.type&64){r.type=e,r.value=n,r.attrs=s;let y=n9();r.injectorIndex=y===null?-1:y.injectorIndex}return ip(r,!0),r}function zY(i,t,e,n,s){let r=oB(),y=RR(),A=y?r:r&&r.parent,P=i.data[t]=VY(i,A,e,t,n,s);return BY(i,P,r,y),P}function BY(i,t,e,n){i.firstChild===null&&(i.firstChild=t),e!==null&&(n?e.child==null&&t.parent!==null&&(e.child=t):e.next===null&&(e.next=t,t.prev=e))}function VY(i,t,e,n,s,r){let y=t?t.injectorIndex:-1,A=0;return rB()&&(A|=128),{type:e,index:n,insertBeforeIndex:null,injectorIndex:y,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:A,providerIndexes:0,value:s,attrs:r,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var Yge=new RegExp(`^(\\d+)*(${Z9}|${Y9})*(.*)`);var jY=()=>null;function I_(i,t){return jY(i,t)}var UY=class{},RV=class{},BA=class{resolveComponentFactory(t){throw Error(`No component factory found for ${Ys(t)}.`)}},IE=class{static NULL=new BA},Sa=class{},Do=(()=>{class i{destroyNode=null;static __NG_ELEMENT_ID__=()=>HY()}return i})();function HY(){let i=pn(),t=os(),e=Id(t.index,i);return(Kh(e)?e:i)[_o]}var $Y=(()=>{class i{static \u0275prov=Mt({token:i,providedIn:"root",factory:()=>null})}return i})();var QI={},VA=class{injector;parentInjector;constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,n){n=cE(n);let s=this.injector.get(t,QI,n);return s!==QI||e===QI?s:this.parentInjector.get(t,e,n)}};function jA(i,t,e){let n=e?i.styles:null,s=e?i.classes:null,r=0;if(t!==null)for(let y=0;y<t.length;y++){let A=t[y];if(typeof A=="number")r=A;else if(r==1)s=sA(s,A);else if(r==2){let P=A,B=t[++y];n=sA(n,P+": "+B+";")}}e?i.styles=n:i.stylesWithoutHost=n,e?i.classes=s:i.classesWithoutHost=s}function ai(i,t=rr.Default){let e=pn();if(e===null)return hi(i,t);let n=os();return xB(n,e,Ga(i),t)}function AE(){let i="invalid";throw new Error(i)}function ok(i,t,e,n,s){let r=n===null?null:{"":-1},y=s(i,e);if(y!==null){let A,P=null,B=null,U=qY(y);U===null?A=y:[A,P,B]=U,ZY(i,t,e,A,r,P,B)}r!==null&&n!==null&&GY(e,n,r)}function GY(i,t,e){let n=i.localNames=[];for(let s=0;s<t.length;s+=2){let r=e[t[s+1]];if(r==null)throw new Mi(-301,!1);n.push(t[s],r)}}function qY(i){let t=null,e=!1;for(let y=0;y<i.length;y++){let A=i[y];if(y===0&&Md(A)&&(t=A),A.findHostDirectiveDefs!==null){e=!0;break}}if(!e)return null;let n=null,s=null,r=null;for(let y of i)y.findHostDirectiveDefs!==null&&(n??=[],s??=new Map,r??=new Map,WY(y,n,r,s)),y===t&&(n??=[],n.push(y));return n!==null?(n.push(...t===null?i:i.slice(1)),[n,s,r]):null}function WY(i,t,e,n){let s=t.length;i.findHostDirectiveDefs(i,t,n),e.set(i,[s,t.length-1])}function YY(i,t,e){t.componentOffset=e,(i.components??=[]).push(t.index)}function ZY(i,t,e,n,s,r,y){let A=n.length,P=!1;for(let le=0;le<A;le++){let re=n[le];!P&&Md(re)&&(P=!0,YY(i,e,le)),vA(WC(e,t),i,re.type)}tZ(e,i.data.length,A);for(let le=0;le<A;le++){let re=n[le];re.providersResolver&&re.providersResolver(re)}let B=!1,U=!1,J=uV(i,t,A,null);A>0&&(e.directiveToIndex=new Map);for(let le=0;le<A;le++){let re=n[le];if(e.mergedAttrs=M_(e.mergedAttrs,re.hostAttrs),KY(i,e,t,J,re),eZ(J,re,s),y!==null&&y.has(re)){let[ee,we]=y.get(re);e.directiveToIndex.set(re.type,[J,ee+e.directiveStart,we+e.directiveStart])}else(r===null||!r.has(re))&&e.directiveToIndex.set(re.type,J);re.contentQueries!==null&&(e.flags|=4),(re.hostBindings!==null||re.hostAttrs!==null||re.hostVars!==0)&&(e.flags|=64);let X=re.type.prototype;!B&&(X.ngOnChanges||X.ngOnInit||X.ngDoCheck)&&((i.preOrderHooks??=[]).push(e.index),B=!0),!U&&(X.ngOnChanges||X.ngDoCheck)&&((i.preOrderCheckHooks??=[]).push(e.index),U=!0),J++}XY(i,e,r)}function XY(i,t,e){for(let n=t.directiveStart;n<t.directiveEnd;n++){let s=i.data[n];if(e===null||!e.has(s))sz(0,t,s,n),sz(1,t,s,n),cz(t,n,!1);else{let r=e.get(s);lz(0,t,r,n),lz(1,t,r,n),cz(t,n,!0)}}}function sz(i,t,e,n){let s=i===0?e.inputs:e.outputs;for(let r in s)if(s.hasOwnProperty(r)){let y;i===0?y=t.inputs??={}:y=t.outputs??={},y[r]??=[],y[r].push(n),kV(t,r)}}function lz(i,t,e,n){let s=i===0?e.inputs:e.outputs;for(let r in s)if(s.hasOwnProperty(r)){let y=s[r],A;i===0?A=t.hostDirectiveInputs??={}:A=t.hostDirectiveOutputs??={},A[y]??=[],A[y].push(n,r),kV(t,y)}}function kV(i,t){t==="class"?i.flags|=8:t==="style"&&(i.flags|=16)}function cz(i,t,e){let{attrs:n,inputs:s,hostDirectiveInputs:r}=i;if(n===null||!e&&s===null||e&&r===null||qR(i)){i.initialInputs??=[],i.initialInputs.push(null);return}let y=null,A=0;for(;A<n.length;){let P=n[A];if(P===0){A+=4;continue}else if(P===5){A+=2;continue}else if(typeof P=="number")break;if(!e&&s.hasOwnProperty(P)){let B=s[P];for(let U of B)if(U===t){y??=[],y.push(P,n[A+1]);break}}else if(e&&r.hasOwnProperty(P)){let B=r[P];for(let U=0;U<B.length;U+=2)if(B[U]===t){y??=[],y.push(B[U+1],n[A+1]);break}}A+=2}i.initialInputs??=[],i.initialInputs.push(y)}function KY(i,t,e,n,s){i.data[n]=s;let r=s.factory||(s.factory=em(s.type,!0)),y=new am(r,Md(s),ai);i.blueprint[n]=y,e[n]=y,QY(i,t,n,uV(i,e,s.hostVars,Ks),s)}function QY(i,t,e,n,s){let r=s.hostBindings;if(r){let y=i.hostBindingOpCodes;y===null&&(y=i.hostBindingOpCodes=[]);let A=~t.index;JY(y)!=A&&y.push(A),y.push(e,n,r)}}function JY(i){let t=i.length;for(;t>0;){let e=i[--t];if(typeof e=="number"&&e<0)return e}return 0}function eZ(i,t,e){if(e){if(t.exportAs)for(let n=0;n<t.exportAs.length;n++)e[t.exportAs[n]]=i;Md(t)&&(e[""]=i)}}function tZ(i,t,e){i.flags|=1,i.directiveStart=t,i.directiveEnd=t+e,i.providerIndexes=t}function PV(i,t,e,n,s,r,y,A){let P=t.consts,B=Jh(P,y),U=j_(t,i,2,n,B);return r&&ok(t,e,U,Jh(P,A),s),U.mergedAttrs=M_(U.mergedAttrs,U.attrs),U.attrs!==null&&jA(U,U.attrs,!1),U.mergedAttrs!==null&&jA(U,U.mergedAttrs,!0),t.queries!==null&&t.queries.elementStart(t,U),U}function OV(i,t){NR(i,t),ER(t)&&i.queries.elementEnd(t)}var QC=class extends IE{ngModule;constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){let e=Qh(t);return new lm(e,this.ngModule)}};function iZ(i){return Object.keys(i).map(t=>{let[e,n,s]=i[t],r={propName:e,templateName:t,isSignal:(n&wE.SignalBased)!==0};return s&&(r.transform=s),r})}function nZ(i){return Object.keys(i).map(t=>({propName:i[t],templateName:t}))}function rZ(i,t,e){let n=t instanceof Fo?t:t?.injector;return n&&i.getStandaloneInjector!==null&&(n=i.getStandaloneInjector(n)||n),n?new VA(e,n):e}function oZ(i){let t=i.get(Sa,null);if(t===null)throw new Mi(407,!1);let e=i.get($Y,null),n=i.get(sm,null);return{rendererFactory:t,sanitizer:e,changeDetectionScheduler:n}}function aZ(i,t){let e=(i.selectors[0][0]||"div").toLowerCase();return sV(t,e,e==="svg"?Jz:e==="math"?qW:null)}var lm=class extends RV{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=iZ(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=nZ(this.componentDef.outputs),this.cachedOutputs}constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=N7(t.selectors),this.ngContentSelectors=t.ngContentSelectors??[],this.isBoundToModule=!!e}create(t,e,n,s){Br(22);let r=er(null);try{let y=this.componentDef,A=n?["ng-version","19.2.8"]:z7(this.componentDef.selectors[0]),P=WR(0,null,null,1,0,null,null,null,null,[A],null),B=rZ(y,s||this.ngModule,t),U=oZ(B),J=U.rendererFactory.createRenderer(null,y),le=n?Y7(J,n,y.encapsulation,B):aZ(y,J),re=YR(null,P,null,512|dV(y),null,null,U,J,B,null,HB(le,B,!0));re[na]=le,FR(re);let X=null;try{let ee=PV(na,P,re,"#host",()=>[this.componentDef],!0,0);le&&(cV(J,le,ee),B_(le,re)),CE(P,re,ee),GR(P,ee,re),OV(P,ee),e!==void 0&&sZ(ee,this.ngContentSelectors,e),X=Id(ee.index,re),re[Ea]=X[Ea],JR(P,re,null)}catch(ee){throw X!==null&&EA(X),EA(re),ee}finally{Br(23),LR()}return new UA(this.componentType,re)}finally{er(r)}}},UA=class extends UY{_rootLView;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(t,e){super(),this._rootLView=e,this._tNode=SR(e[Hn],na),this.location=z_(this._tNode,e),this.instance=Id(this._tNode.index,e)[Ea],this.hostView=this.changeDetectorRef=new sb(e,void 0,!1),this.componentType=t}setInput(t,e){let n=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),e))return;let s=this._rootLView,r=QR(n,s[Hn],s,t,e);this.previousInputValues.set(t,e);let y=Id(n.index,s);rk(y,1)}get injector(){return new Jf(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}};function sZ(i,t,e){let n=i.projection=[];for(let s=0;s<t.length;s++){let r=e[s];n.push(r!=null&&r.length?Array.from(r):null)}}var yo=(()=>{class i{static __NG_ELEMENT_ID__=lZ}return i})();function lZ(){let i=os();return LV(i,pn())}var cZ=yo,FV=class extends cZ{_lContainer;_hostTNode;_hostLView;constructor(t,e,n){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=n}get element(){return z_(this._hostTNode,this._hostLView)}get injector(){return new Jf(this._hostTNode,this._hostLView)}get parentInjector(){let t=zR(this._hostTNode,this._hostLView);if(mB(t)){let e=GC(t,this._hostLView),n=$C(t),s=e[Hn].data[n+8];return new Jf(s,e)}else return new Jf(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){let e=dz(this._lContainer);return e!==null&&e[t]||null}get length(){return this._lContainer.length-ns}createEmbeddedView(t,e,n){let s,r;typeof n=="number"?s=n:n!=null&&(s=n.index,r=n.injector);let y=I_(this._lContainer,t.ssrId),A=t.createEmbeddedViewImpl(e||{},r,y);return this.insertImpl(A,s,T_(this._hostTNode,y)),A}createComponent(t,e,n,s,r){let y=t&&!UW(t),A;if(y)A=e;else{let X=e||{};A=X.index,n=X.injector,s=X.projectableNodes,r=X.environmentInjector||X.ngModuleRef}let P=y?t:new lm(Qh(t)),B=n||this.parentInjector;if(!r&&P.ngModule==null){let ee=(y?B:this.parentInjector).get(Fo,null);ee&&(r=ee)}let U=Qh(P.componentType??{}),J=I_(this._lContainer,U?.id??null),le=J?.firstChild??null,re=P.create(B,s,le,r);return this.insertImpl(re.hostView,A,T_(this._hostTNode,J)),re}insert(t,e){return this.insertImpl(t,e,!0)}insertImpl(t,e,n){let s=t._lView;if(YW(s)){let A=this.indexOf(t);if(A!==-1)this.detach(A);else{let P=s[rs],B=new FV(P,P[Xs],P[rs]);B.detach(B.indexOf(t))}}let r=this._adjustIndex(e),y=this._lContainer;return gb(y,s,r,n),t.attachToViewContainerRef(),Nz(JI(y),r,t),t}move(t,e){return this.insert(t,e)}indexOf(t){let e=dz(this._lContainer);return e!==null?e.indexOf(t):-1}remove(t){let e=this._adjustIndex(t,-1),n=ab(this._lContainer,e);n&&(zC(JI(this._lContainer),e),SE(n[Hn],n))}detach(t){let e=this._adjustIndex(t,-1),n=ab(this._lContainer,e);return n&&zC(JI(this._lContainer),e)!=null?new sb(n):null}_adjustIndex(t,e=0){return t??this.length+e}};function dz(i){return i[jC]}function JI(i){return i[jC]||(i[jC]=[])}function LV(i,t){let e,n=t[i.index];return Su(n)?e=n:(e=MV(n,t,null,i),t[i.index]=e,ZR(t,e)),uZ(e,t,i,n),new FV(e,i,t)}function dZ(i,t){let e=i[_o],n=e.createComment(""),s=Rd(t,i),r=e.parentNode(s);return XC(e,r,n,e.nextSibling(s),!1),n}var uZ=fZ,hZ=()=>!1;function pZ(i,t,e){return hZ(i,t,e)}function fZ(i,t,e,n){if(i[nm])return;let s;e.type&8?s=Td(n):s=dZ(t,e),i[nm]=s}var HA=class i{queryList;matches=null;constructor(t){this.queryList=t}clone(){return new i(this.queryList)}setDirty(){this.queryList.setDirty()}},$A=class i{queries;constructor(t=[]){this.queries=t}createEmbeddedView(t){let e=t.queries;if(e!==null){let n=t.contentQueries!==null?t.contentQueries[0]:e.length,s=[];for(let r=0;r<n;r++){let y=e.getByIndex(r),A=this.queries[y.indexInDeclarationView];s.push(A.clone())}return new i(s)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}finishViewCreation(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)sk(t,e).matches!==null&&this.queries[e].setDirty()}},JC=class{flags;read;predicate;constructor(t,e,n=null){this.flags=e,this.read=n,typeof t=="string"?this.predicate=bZ(t):this.predicate=t}},GA=class i{queries;constructor(t=[]){this.queries=t}elementStart(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let n=0;n<this.length;n++){let s=e!==null?e.length:0,r=this.getByIndex(n).embeddedTView(t,s);r&&(r.indexInDeclarationView=n,e!==null?e.push(r):e=[r])}return e!==null?new i(e):null}template(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}},qA=class i{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(t,e=-1){this.metadata=t,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new i(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let e=this._declarationNodeIndex,n=t.parent;for(;n!==null&&n.type&8&&n.index!==e;)n=n.parent;return e===(n!==null?n.index:-1)}return this._appliesToNextNode}matchTNode(t,e){let n=this.metadata.predicate;if(Array.isArray(n))for(let s=0;s<n.length;s++){let r=n[s];this.matchTNodeWithReadOption(t,e,mZ(e,r)),this.matchTNodeWithReadOption(t,e,kC(e,t,r,!1,!1))}else n===co?e.type&4&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,kC(e,t,n,!1,!1))}matchTNodeWithReadOption(t,e,n){if(n!==null){let s=this.metadata.read;if(s!==null)if(s===Ii||s===yo||s===co&&e.type&4)this.addMatch(e.index,-2);else{let r=kC(e,t,s,!1,!1);r!==null&&this.addMatch(e.index,r)}else this.addMatch(e.index,n)}}addMatch(t,e){this.matches===null?this.matches=[t,e]:this.matches.push(t,e)}};function mZ(i,t){let e=i.localNames;if(e!==null){for(let n=0;n<e.length;n+=2)if(e[n]===t)return e[n+1]}return null}function gZ(i,t){return i.type&11?z_(i,t):i.type&4?TE(i,t):null}function _Z(i,t,e,n){return e===-1?gZ(t,i):e===-2?yZ(i,t,n):rb(i,i[Hn],e,t)}function yZ(i,t,e){if(e===Ii)return z_(t,i);if(e===co)return TE(t,i);if(e===yo)return LV(t,i)}function NV(i,t,e,n){let s=t[bu].queries[n];if(s.matches===null){let r=i.data,y=e.matches,A=[];for(let P=0;y!==null&&P<y.length;P+=2){let B=y[P];if(B<0)A.push(null);else{let U=r[B];A.push(_Z(t,U,y[P+1],e.metadata.read))}}s.matches=A}return s.matches}function WA(i,t,e,n){let s=i.queries.getByIndex(e),r=s.matches;if(r!==null){let y=NV(i,t,s,e);for(let A=0;A<r.length;A+=2){let P=r[A];if(P>0)n.push(y[A/2]);else{let B=r[A+1],U=t[-P];for(let J=ns;J<U.length;J++){let le=U[J];le[tm]===le[rs]&&WA(le[Hn],le,B,n)}if(U[D_]!==null){let J=U[D_];for(let le=0;le<J.length;le++){let re=J[le];WA(re[Hn],re,B,n)}}}}}return n}function ak(i,t){return i[bu].queries[t].queryList}function zV(i,t,e){let n=new ep((e&4)===4);return KW(i,t,n,n.destroy),(t[bu]??=new $A).queries.push(new HA(n))-1}function vZ(i,t,e){let n=uo();return n.firstCreatePass&&(VV(n,new JC(i,t,e),-1),(t&2)===2&&(n.staticViewQueries=!0)),zV(n,pn(),t)}function BV(i,t,e,n){let s=uo();if(s.firstCreatePass){let r=os();VV(s,new JC(t,e,n),r.index),xZ(s,i),(e&2)===2&&(s.staticContentQueries=!0)}return zV(s,pn(),e)}function bZ(i){return i.split(",").map(t=>t.trim())}function VV(i,t,e){i.queries===null&&(i.queries=new GA),i.queries.track(new qA(t,e))}function xZ(i,t){let e=i.contentQueries||(i.contentQueries=[]),n=e.length?e[e.length-1]:-1;t!==n&&e.push(i.queries.length-1,t)}function sk(i,t){return i.queries.getByIndex(t)}function jV(i,t){let e=i[Hn],n=sk(e,t);return n.crossesNgTemplate?WA(e,i,t,[]):NV(e,i,n,t)}function UV(i,t,e){let n,s=$1(()=>{n._dirtyCounter();let r=SZ(n,i);if(t&&r===void 0)throw new Mi(-951,!1);return r});return n=s[Gs],n._dirtyCounter=Lo(0),n._flatValue=void 0,s}function wZ(i){return UV(!0,!1,i)}function CZ(i){return UV(!0,!0,i)}function EZ(i,t){let e=i[Gs];e._lView=pn(),e._queryIndex=t,e._queryList=ak(e._lView,t),e._queryList.onDirty(()=>e._dirtyCounter.update(n=>n+1))}function SZ(i,t){let e=i._lView,n=i._queryIndex;if(e===void 0||n===void 0||e[Pn]&4)return t?void 0:Ds;let s=ak(e,n),r=jV(e,n);return s.reset(r,RB),t?s.first:s._changesDetected||i._flatValue===void 0?i._flatValue=s.toArray():i._flatValue}function uz(i,t){return wZ(t)}function DZ(i,t){return CZ(t)}var HV=(uz.required=DZ,uz);var Cu=class{},lk=class{};var YA=class extends Cu{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new QC(this);constructor(t,e,n,s=!0){super(),this.ngModuleType=t,this._parent=e;let r=Vz(t);this._bootstrapComponents=rV(r.bootstrap),this._r3Injector=EB(t,e,[{provide:Cu,useValue:this},{provide:IE,useValue:this.componentFactoryResolver},...n],Ys(t),new Set(["environment"])),s&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}},ZA=class extends lk{moduleType;constructor(t){super(),this.moduleType=t}create(t){return new YA(this.moduleType,t,[])}};var eE=class extends Cu{injector;componentFactoryResolver=new QC(this);instance=null;constructor(t){super();let e=new ib([...t.providers,{provide:Cu,useValue:this},{provide:IE,useValue:this.componentFactoryResolver}],t.parent||hE(),t.debugName,new Set(["environment"]));this.injector=e,t.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}};function _b(i,t,e=null){return new eE({providers:i,parent:t,debugName:e,runEnvironmentInitializers:!0}).injector}var MZ=(()=>{class i{_injector;cachedInjectors=new Map;constructor(e){this._injector=e}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e)){let n=Uz(!1,e.type),s=n.length>0?_b([n],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e,s)}return this.cachedInjectors.get(e)}ngOnDestroy(){try{for(let e of this.cachedInjectors.values())e!==null&&e.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=Mt({token:i,providedIn:"environment",factory:()=>new i(hi(Fo))})}return i})();function Yt(i){return cb(()=>{let t=$V(i),e=Xi(Ct({},t),{decls:i.decls,vars:i.vars,template:i.template,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,onPush:i.changeDetection===OB.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&i.dependencies||null,getStandaloneInjector:t.standalone?s=>s.get(MZ).getOrCreateStandaloneInjector(e):null,getExternalStyles:null,signals:i.signals??!1,data:i.data||{},encapsulation:i.encapsulation||Ad.Emulated,styles:i.styles||Ds,_:null,schemas:i.schemas||null,tView:null,id:""});t.standalone&&rp("NgStandalone"),GV(e);let n=i.dependencies;return e.directiveDefs=hz(n,!1),e.pipeDefs=hz(n,!0),e.id=kZ(e),e})}function TZ(i){return Qh(i)||jz(i)}function IZ(i){return i!==null}function Ni(i){return cb(()=>({type:i.type,bootstrap:i.bootstrap||Ds,declarations:i.declarations||Ds,imports:i.imports||Ds,exports:i.exports||Ds,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null}))}function AZ(i,t){if(i==null)return Dd;let e={};for(let n in i)if(i.hasOwnProperty(n)){let s=i[n],r,y,A,P;Array.isArray(s)?(A=s[0],r=s[1],y=s[2]??r,P=s[3]||null):(r=s,y=s,A=wE.None,P=null),e[r]=[n,A,P],t[r]=y}return e}function RZ(i){if(i==null)return Dd;let t={};for(let e in i)i.hasOwnProperty(e)&&(t[i[e]]=e);return t}function ri(i){return cb(()=>{let t=$V(i);return GV(t),t})}function ck(i){return{type:i.type,name:i.name,factory:null,pure:i.pure!==!1,standalone:i.standalone??!0,onDestroy:i.type.prototype.ngOnDestroy||null}}function $V(i){let t={};return{type:i.type,providersResolver:null,factory:null,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:t,inputConfig:i.inputs||Dd,exportAs:i.exportAs||null,standalone:i.standalone??!0,signals:i.signals===!0,selectors:i.selectors||Ds,viewQuery:i.viewQuery||null,features:i.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:AZ(i.inputs,t),outputs:RZ(i.outputs),debugInfo:null}}function GV(i){i.features?.forEach(t=>t(i))}function hz(i,t){if(!i)return null;let e=t?RW:TZ;return()=>(typeof i=="function"?i():i).map(n=>e(n)).filter(IZ)}function kZ(i){let t=0,e=typeof i.consts=="function"?"":i.consts,n=[i.selectors,i.ngContentSelectors,i.hostVars,i.hostAttrs,e,i.vars,i.decls,i.encapsulation,i.standalone,i.signals,i.exportAs,JSON.stringify(i.inputs),JSON.stringify(i.outputs),Object.getOwnPropertyNames(i.type.prototype),!!i.contentQueries,!!i.viewQuery];for(let r of n.join("|"))t=Math.imul(31,t)+r.charCodeAt(0)<<0;return t+=2147483648,"c"+t}function PZ(i){return Object.getPrototypeOf(i.prototype).constructor}function dn(i){let t=PZ(i.type),e=!0,n=[i];for(;t;){let s;if(Md(i))s=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Mi(903,!1);s=t.\u0275dir}if(s){if(e){n.push(s);let y=i;y.inputs=eA(i.inputs),y.declaredInputs=eA(i.declaredInputs),y.outputs=eA(i.outputs);let A=s.hostBindings;A&&zZ(i,A);let P=s.viewQuery,B=s.contentQueries;if(P&&LZ(i,P),B&&NZ(i,B),OZ(i,s),cW(i.outputs,s.outputs),Md(s)&&s.data.animation){let U=i.data;U.animation=(U.animation||[]).concat(s.data.animation)}}let r=s.features;if(r)for(let y=0;y<r.length;y++){let A=r[y];A&&A.ngInherit&&A(i),A===dn&&(e=!1)}}t=Object.getPrototypeOf(t)}FZ(n)}function OZ(i,t){for(let e in t.inputs){if(!t.inputs.hasOwnProperty(e)||i.inputs.hasOwnProperty(e))continue;let n=t.inputs[e];n!==void 0&&(i.inputs[e]=n,i.declaredInputs[e]=t.declaredInputs[e])}}function FZ(i){let t=0,e=null;for(let n=i.length-1;n>=0;n--){let s=i[n];s.hostVars=t+=s.hostVars,s.hostAttrs=M_(s.hostAttrs,e=M_(e,s.hostAttrs))}}function eA(i){return i===Dd?{}:i===Ds?[]:i}function LZ(i,t){let e=i.viewQuery;e?i.viewQuery=(n,s)=>{t(n,s),e(n,s)}:i.viewQuery=t}function NZ(i,t){let e=i.contentQueries;e?i.contentQueries=(n,s,r)=>{t(n,s,r),e(n,s,r)}:i.contentQueries=t}function zZ(i,t){let e=i.hostBindings;e?i.hostBindings=(n,s)=>{t(n,s),e(n,s)}:i.hostBindings=t}function qV(i){let t=e=>{let n=Array.isArray(i);e.hostDirectives===null?(e.findHostDirectiveDefs=WV,e.hostDirectives=n?i.map(XA):[i]):n?e.hostDirectives.unshift(...i.map(XA)):e.hostDirectives.unshift(i)};return t.ngInherit=!0,t}function WV(i,t,e){if(i.hostDirectives!==null)for(let n of i.hostDirectives)if(typeof n=="function"){let s=n();for(let r of s)pz(XA(r),t,e)}else pz(n,t,e)}function pz(i,t,e){let n=jz(i.directive);BZ(n.declaredInputs,i.inputs),WV(n,t,e),e.set(n,i),t.push(n)}function XA(i){return typeof i=="function"?{directive:Ga(i),inputs:Dd,outputs:Dd}:{directive:Ga(i.directive),inputs:fz(i.inputs),outputs:fz(i.outputs)}}function fz(i){if(i===void 0||i.length===0)return Dd;let t={};for(let e=0;e<i.length;e+=2)t[i[e]]=i[e+1];return t}function BZ(i,t){for(let e in t)if(t.hasOwnProperty(e)){let n=t[e],s=i[e];i[n]=s}}function YV(i){return jZ(i)?Array.isArray(i)||!(i instanceof Map)&&Symbol.iterator in i:!1}function VZ(i,t){if(Array.isArray(i))for(let e=0;e<i.length;e++)t(i[e]);else{let e=i[Symbol.iterator](),n;for(;!(n=e.next()).done;)t(n.value)}}function jZ(i){return i!==null&&(typeof i=="function"||typeof i=="object")}function yb(i,t,e){return i[t]=e}function ZV(i,t){return i[t]}function wl(i,t,e){let n=i[t];return Object.is(n,e)?!1:(i[t]=e,!0)}function tE(i,t,e,n){let s=wl(i,t,e);return wl(i,t+1,n)||s}function XV(i,t,e,n,s,r){let y=tE(i,t,e,n);return tE(i,t+2,s,r)||y}function UZ(i,t,e,n,s,r,y,A,P){let B=t.consts,U=j_(t,i,4,y||null,A||null);AR()&&ok(t,e,U,Jh(B,P),KR),U.mergedAttrs=M_(U.mergedAttrs,U.attrs),NR(t,U);let J=U.tView=WR(2,U,n,s,r,t.directiveRegistry,t.pipeRegistry,null,t.schemas,B,null);return t.queries!==null&&(t.queries.template(t,U),J.queries=t.queries.embeddedTView(U)),U}function iE(i,t,e,n,s,r,y,A,P,B){let U=e+na,J=t.firstCreatePass?UZ(U,t,i,n,s,r,y,A,P):t.data[U];ip(J,!1);let le=HZ(t,i,J,e);_E()&&DE(t,i,le,J),B_(le,i);let re=MV(le,i,le,J);return i[U]=re,ZR(i,re),pZ(re,J,i),fE(J)&&CE(t,i,J),P!=null&&XR(i,J,B),J}function pt(i,t,e,n,s,r,y,A){let P=pn(),B=uo(),U=Jh(B.consts,r);return iE(P,B,i,t,e,n,s,U,y,A),pt}var HZ=$Z;function $Z(i,t,e,n){return yE(!0),t[_o].createComment("")}var dk=(()=>{class i{log(e){console.log(e)}warn(e){console.warn(e)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"platform"})}return i})();var KV=new Dt("");var QV=(()=>{class i{static \u0275prov=Mt({token:i,providedIn:"root",factory:()=>new KA})}return i})(),KA=class{queuedEffectCount=0;queues=new Map;schedule(t){this.enqueue(t)}remove(t){let e=t.zone,n=this.queues.get(e);n.has(t)&&(n.delete(t),this.queuedEffectCount--)}enqueue(t){let e=t.zone;this.queues.has(e)||this.queues.set(e,new Set);let n=this.queues.get(e);n.has(t)||(this.queuedEffectCount++,n.add(t))}flush(){for(;this.queuedEffectCount>0;)for(let[t,e]of this.queues)t===null?this.flushQueue(e):t.run(()=>this.flushQueue(e))}flushQueue(t){for(let e of t)t.delete(e),this.queuedEffectCount--,e.run()}};function ap(i){return!!i&&typeof i.then=="function"}function uk(i){return!!i&&typeof i.subscribe=="function"}var JV=new Dt("");function hk(i){return k_([{provide:JV,multi:!0,useValue:i}])}var e4=(()=>{class i{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((e,n)=>{this.resolve=e,this.reject=n});appInits=Z(JV,{optional:!0})??[];injector=Z(vn);constructor(){}runInitializers(){if(this.initialized)return;let e=[];for(let s of this.appInits){let r=Zs(this.injector,s);if(ap(r))e.push(r);else if(uk(r)){let y=new Promise((A,P)=>{r.subscribe({complete:A,error:P})});e.push(y)}}let n=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{n()}).catch(s=>{this.reject(s)}),e.length===0&&n(),this.initialized=!0}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),RE=new Dt("");function GZ(){TI(()=>{throw new Mi(600,!1)})}function qZ(i){return i.isBoundToModule}var WZ=10;var $l=(()=>{class i{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=Z(z9);afterRenderManager=Z(jB);zonelessEnabled=Z(BR);rootEffectScheduler=Z(QV);dirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new ni;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=Z(Mu).hasPendingTasks.pipe(Ui(e=>!e));constructor(){Z(V_,{optional:!0})}whenStable(){let e;return new Promise(n=>{e=this.isStable.subscribe({next:s=>{s&&n()}})}).finally(()=>{e.unsubscribe()})}_injector=Z(Fo);_rendererFactory=null;get injector(){return this._injector}bootstrap(e,n){return this.bootstrapImpl(e,n)}bootstrapImpl(e,n,s=vn.NULL){Br(10);let r=e instanceof RV;if(!this._injector.get(e4).done){let re="";throw new Mi(405,re)}let A;r?A=e:A=this._injector.get(IE).resolveComponentFactory(e),this.componentTypes.push(A.componentType);let P=qZ(A)?void 0:this._injector.get(Cu),B=n||A.selector,U=A.create(s,[],B,P),J=U.location.nativeElement,le=U.injector.get(KV,null);return le?.registerApplication(J),U.onDestroy(()=>{this.detachView(U.hostView),PC(this.components,U),le?.unregisterApplication(J)}),this._loadComponent(U),Br(11,U),U}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){Br(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(HR.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new Mi(101,!1);let e=er(null);try{this._runningTick=!0,this.synchronize()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,er(e),this.afterTick.next(),Br(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Sa,null,{optional:!0}));let e=0;for(;this.dirtyFlags!==0&&e++<WZ;)Br(14),this.synchronizeOnce(),Br(15)}synchronizeOnce(){if(this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),this.dirtyFlags&7){let e=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:n,notifyErrorHandler:s}of this.allViews)YZ(n,s,e,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:e})=>mE(e))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(e){let n=e;this._views.push(n),n.attachToAppRef(this)}detachView(e){let n=e;PC(this._views,n),n.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(RE,[]).forEach(s=>s(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>PC(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new Mi(406,!1);let e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function PC(i,t){let e=i.indexOf(t);e>-1&&i.splice(e,1)}function YZ(i,t,e,n){if(!e&&!mE(i))return;CV(i,t,e&&!n?0:1)}function ji(i,t,e,n){let s=pn(),r=um();if(wl(s,r,t)){let y=uo(),A=hb();iY(A,s,i,t,e,n)}return ji}function pk(i,t,e,n){return wl(i,um(),e)?t+x_(e)+n:Ks}function ZZ(i,t,e,n,s,r){let y=o9(),A=tE(i,y,e,s);return PR(2),A?t+x_(e)+n+x_(s)+r:Ks}function TC(i,t){return i<<17|t<<2}function cm(i){return i>>17&32767}function XZ(i){return(i&2)==2}function KZ(i,t){return i&131071|t<<17}function QA(i){return i|2}function A_(i){return(i&131068)>>2}function tA(i,t){return i&-131069|t<<2}function QZ(i){return(i&1)===1}function JA(i){return i|1}function JZ(i,t,e,n,s,r){let y=r?t.classBindings:t.styleBindings,A=cm(y),P=A_(y);i[n]=e;let B=!1,U;if(Array.isArray(e)){let J=e;U=J[1],(U===null||db(J,U)>0)&&(B=!0)}else U=e;if(s)if(P!==0){let le=cm(i[A+1]);i[n+1]=TC(le,A),le!==0&&(i[le+1]=tA(i[le+1],n)),i[A+1]=KZ(i[A+1],n)}else i[n+1]=TC(A,0),A!==0&&(i[A+1]=tA(i[A+1],n)),A=n;else i[n+1]=TC(P,0),A===0?A=n:i[P+1]=tA(i[P+1],n),P=n;B&&(i[n+1]=QA(i[n+1])),mz(i,U,n,!0),mz(i,U,n,!1),eX(t,U,i,n,r),y=TC(A,P),r?t.classBindings=y:t.styleBindings=y}function eX(i,t,e,n,s){let r=s?i.residualClasses:i.residualStyles;r!=null&&typeof t=="string"&&db(r,t)>=0&&(e[n+1]=JA(e[n+1]))}function mz(i,t,e,n){let s=i[e+1],r=t===null,y=n?cm(s):A_(s),A=!1;for(;y!==0&&(A===!1||r);){let P=i[y],B=i[y+1];tX(P,t)&&(A=!0,i[y+1]=n?JA(B):QA(B)),y=n?cm(B):A_(B)}A&&(i[e+1]=n?QA(s):JA(s))}function tX(i,t){return i===null||t==null||(Array.isArray(i)?i[1]:i)===t?!0:Array.isArray(i)&&typeof t=="string"?db(i,t)>=0:!1}var Lc={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function iX(i){return i.substring(Lc.key,Lc.keyEnd)}function nX(i){return rX(i),t4(i,i4(i,0,Lc.textEnd))}function t4(i,t){let e=Lc.textEnd;return e===t?-1:(t=Lc.keyEnd=oX(i,Lc.key=t,e),i4(i,t,e))}function rX(i){Lc.key=0,Lc.keyEnd=0,Lc.value=0,Lc.valueEnd=0,Lc.textEnd=i.length}function i4(i,t,e){for(;t<e&&i.charCodeAt(t)<=32;)t++;return t}function oX(i,t,e){for(;t<e&&i.charCodeAt(t)>32;)t++;return t}function Be(i,t,e){let n=pn(),s=um();if(wl(n,s,t)){let r=uo(),y=hb();EE(r,y,n,i,t,n[_o],e,!1)}return Be}function eR(i,t,e,n,s){QR(t,i,e,s?"class":"style",n)}function Gl(i,t,e){return r4(i,t,e,!1),Gl}function Ai(i,t){return r4(i,t,null,!0),Ai}function Ts(i){o4(uX,n4,i,!0)}function n4(i,t){for(let e=nX(t);e>=0;e=t4(t,e))dE(i,iX(t),!0)}function r4(i,t,e,n){let s=pn(),r=uo(),y=PR(2);if(r.firstUpdatePass&&s4(r,i,y,n),t!==Ks&&wl(s,y,t)){let A=r.data[Du()];l4(r,A,s,s[_o],i,s[y+1]=pX(t,e),n,y)}}function o4(i,t,e,n){let s=uo(),r=PR(2);s.firstUpdatePass&&s4(s,null,r,n);let y=pn();if(e!==Ks&&wl(y,r,e)){let A=s.data[Du()];if(c4(A,n)&&!a4(s,r)){let P=n?A.classesWithoutHost:A.stylesWithoutHost;P!==null&&(e=sA(P,e||"")),eR(s,A,y,e,n)}else hX(s,A,y,y[_o],y[r+1],y[r+1]=dX(i,t,e),n,r)}}function a4(i,t){return t>=i.expandoStartIndex}function s4(i,t,e,n){let s=i.data;if(s[e+1]===null){let r=s[Du()],y=a4(i,e);c4(r,n)&&t===null&&!y&&(t=!1),t=aX(s,r,t,n),JZ(s,r,t,e,y,n)}}function aX(i,t,e,n){let s=d9(i),r=n?t.residualClasses:t.residualStyles;if(s===null)(n?t.classBindings:t.styleBindings)===0&&(e=iA(null,i,t,e,n),e=lb(e,t.attrs,n),r=null);else{let y=t.directiveStylingLast;if(y===-1||i[y]!==s)if(e=iA(s,i,t,e,n),r===null){let P=sX(i,t,n);P!==void 0&&Array.isArray(P)&&(P=iA(null,i,t,P[1],n),P=lb(P,t.attrs,n),lX(i,t,n,P))}else r=cX(i,t,n)}return r!==void 0&&(n?t.residualClasses=r:t.residualStyles=r),e}function sX(i,t,e){let n=e?t.classBindings:t.styleBindings;if(A_(n)!==0)return i[cm(n)]}function lX(i,t,e,n){let s=e?t.classBindings:t.styleBindings;i[cm(s)]=n}function cX(i,t,e){let n,s=t.directiveEnd;for(let r=1+t.directiveStylingLast;r<s;r++){let y=i[r].hostAttrs;n=lb(n,y,e)}return lb(n,t.attrs,e)}function iA(i,t,e,n,s){let r=null,y=e.directiveEnd,A=e.directiveStylingLast;for(A===-1?A=e.directiveStart:A++;A<y&&(r=t[A],n=lb(n,r.hostAttrs,s),r!==i);)A++;return i!==null&&(e.directiveStylingLast=A),n}function lb(i,t,e){let n=e?1:2,s=-1;if(t!==null)for(let r=0;r<t.length;r++){let y=t[r];typeof y=="number"?s=y:s===n&&(Array.isArray(i)||(i=i===void 0?[]:["",i]),dE(i,y,e?!0:t[++r]))}return i===void 0?null:i}function dX(i,t,e){if(e==null||e==="")return Ds;let n=[],s=zc(e);if(Array.isArray(s))for(let r=0;r<s.length;r++)i(n,s[r],!0);else if(typeof s=="object")for(let r in s)s.hasOwnProperty(r)&&i(n,r,s[r]);else typeof s=="string"&&t(n,s);return n}function uX(i,t,e){let n=String(t);n!==""&&!n.includes(" ")&&dE(i,n,e)}function hX(i,t,e,n,s,r,y,A){s===Ks&&(s=Ds);let P=0,B=0,U=0<s.length?s[0]:null,J=0<r.length?r[0]:null;for(;U!==null||J!==null;){let le=P<s.length?s[P+1]:void 0,re=B<r.length?r[B+1]:void 0,X=null,ee;U===J?(P+=2,B+=2,le!==re&&(X=J,ee=re)):J===null||U!==null&&U<J?(P+=2,X=U):(B+=2,X=J,ee=re),X!==null&&l4(i,t,e,n,X,ee,y,A),U=P<s.length?s[P]:null,J=B<r.length?r[B]:null}}function l4(i,t,e,n,s,r,y,A){if(!(t.type&3))return;let P=i.data,B=P[A+1],U=QZ(B)?gz(P,t,e,s,A_(B),y):void 0;if(!nE(U)){nE(r)||XZ(B)&&(r=gz(P,null,e,s,A,y));let J=eB(Du(),e);bY(n,y,J,s,r)}}function gz(i,t,e,n,s,r){let y=t===null,A;for(;s>0;){let P=i[s],B=Array.isArray(P),U=B?P[1]:P,J=U===null,le=e[s+1];le===Ks&&(le=J?Ds:void 0);let re=J?qI(le,n):U===n?le:void 0;if(B&&!nE(re)&&(re=qI(P,n)),nE(re)&&(A=re,y))return A;let X=i[s+1];s=y?cm(X):A_(X)}if(t!==null){let P=r?t.residualClasses:t.residualStyles;P!=null&&(A=qI(P,n))}return A}function nE(i){return i!==void 0}function pX(i,t){return i==null||i===""||(typeof t=="string"?i=i+t:typeof i=="object"&&(i=Ys(zc(i)))),i}function c4(i,t){return(i.flags&(t?8:16))!==0}function d4(i,t,e){let n=pn(),s=pk(n,i,t,e);o4(dE,n4,s,!0)}var tR=class{destroy(t){}updateValue(t,e){}swap(t,e){let n=Math.min(t,e),s=Math.max(t,e),r=this.detach(s);if(s-n>1){let y=this.detach(n);this.attach(n,r),this.attach(s,y)}else this.attach(n,r)}move(t,e){this.attach(e,this.detach(t))}};function nA(i,t,e,n,s){return i===e&&Object.is(t,n)?1:Object.is(s(i,t),s(e,n))?-1:0}function fX(i,t,e){let n,s,r=0,y=i.length-1,A=void 0;if(Array.isArray(t)){let P=t.length-1;for(;r<=y&&r<=P;){let B=i.at(r),U=t[r],J=nA(r,B,r,U,e);if(J!==0){J<0&&i.updateValue(r,U),r++;continue}let le=i.at(y),re=t[P],X=nA(y,le,P,re,e);if(X!==0){X<0&&i.updateValue(y,re),y--,P--;continue}let ee=e(r,B),we=e(y,le),Re=e(r,U);if(Object.is(Re,we)){let Ce=e(P,re);Object.is(Ce,ee)?(i.swap(r,y),i.updateValue(y,re),P--,y--):i.move(y,r),i.updateValue(r,U),r++;continue}if(n??=new rE,s??=yz(i,r,y,e),iR(i,n,r,Re))i.updateValue(r,U),r++,y++;else if(s.has(Re))n.set(ee,i.detach(r)),y--;else{let Ce=i.create(r,t[r]);i.attach(r,Ce),r++,y++}}for(;r<=P;)_z(i,n,e,r,t[r]),r++}else if(t!=null){let P=t[Symbol.iterator](),B=P.next();for(;!B.done&&r<=y;){let U=i.at(r),J=B.value,le=nA(r,U,r,J,e);if(le!==0)le<0&&i.updateValue(r,J),r++,B=P.next();else{n??=new rE,s??=yz(i,r,y,e);let re=e(r,J);if(iR(i,n,r,re))i.updateValue(r,J),r++,y++,B=P.next();else if(!s.has(re))i.attach(r,i.create(r,J)),r++,y++,B=P.next();else{let X=e(r,U);n.set(X,i.detach(r)),y--}}}for(;!B.done;)_z(i,n,e,i.length,B.value),B=P.next()}for(;r<=y;)i.destroy(i.detach(y--));n?.forEach(P=>{i.destroy(P)})}function iR(i,t,e,n){return t!==void 0&&t.has(n)?(i.attach(e,t.get(n)),t.delete(n),!0):!1}function _z(i,t,e,n,s){if(iR(i,t,n,e(n,s)))i.updateValue(n,s);else{let r=i.create(n,s);i.attach(n,r)}}function yz(i,t,e,n){let s=new Set;for(let r=t;r<=e;r++)s.add(n(r,i.at(r)));return s}var rE=class{kvMap=new Map;_vMap=void 0;has(t){return this.kvMap.has(t)}delete(t){if(!this.has(t))return!1;let e=this.kvMap.get(t);return this._vMap!==void 0&&this._vMap.has(e)?(this.kvMap.set(t,this._vMap.get(e)),this._vMap.delete(e)):this.kvMap.delete(t),!0}get(t){return this.kvMap.get(t)}set(t,e){if(this.kvMap.has(t)){let n=this.kvMap.get(t);this._vMap===void 0&&(this._vMap=new Map);let s=this._vMap;for(;s.has(n);)n=s.get(n);s.set(n,e)}else this.kvMap.set(t,e)}forEach(t){for(let[e,n]of this.kvMap)if(t(n,e),this._vMap!==void 0){let s=this._vMap;for(;s.has(n);)n=s.get(n),t(n,e)}}};function un(i,t){rp("NgControlFlow");let e=pn(),n=um(),s=e[n]!==Ks?e[n]:-1,r=s!==-1?oE(e,na+s):void 0,y=0;if(wl(e,n,i)){let A=er(null);try{if(r!==void 0&&IV(r,y),i!==-1){let P=na+i,B=oE(e,P),U=aR(e[Hn],P),J=I_(B,U.tView.ssrId),le=mb(e,U,t,{dehydratedView:J});gb(B,le,y,T_(U,J))}}finally{er(A)}}else if(r!==void 0){let A=TV(r,y);A!==void 0&&(A[Ea]=t)}}var nR=class{lContainer;$implicit;$index;constructor(t,e,n){this.lContainer=t,this.$implicit=e,this.$index=n}get $count(){return this.lContainer.length-ns}};function u4(i,t){return t}var rR=class{hasEmptyBlock;trackByFn;liveCollection;constructor(t,e,n){this.hasEmptyBlock=t,this.trackByFn=e,this.liveCollection=n}};function U_(i,t,e,n,s,r,y,A,P,B,U,J,le){rp("NgControlFlow");let re=pn(),X=uo(),ee=P!==void 0,we=pn(),Re=A?y.bind(we[xl][Ea]):y,Ce=new rR(ee,Re);we[na+i]=Ce,iE(re,X,i+1,t,e,n,s,Jh(X.consts,r)),ee&&iE(re,X,i+2,P,B,U,J,Jh(X.consts,le))}var oR=class extends tR{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(t,e,n){super(),this.lContainer=t,this.hostLView=e,this.templateTNode=n}get length(){return this.lContainer.length-ns}at(t){return this.getLView(t)[Ea].$implicit}attach(t,e){let n=e[E_];this.needsIndexUpdate||=t!==this.length,gb(this.lContainer,e,t,T_(this.templateTNode,n))}detach(t){return this.needsIndexUpdate||=t!==this.length-1,mX(this.lContainer,t)}create(t,e){let n=I_(this.lContainer,this.templateTNode.tView.ssrId),s=mb(this.hostLView,this.templateTNode,new nR(this.lContainer,e,t),{dehydratedView:n});return this.operationsCounter?.recordCreate(),s}destroy(t){SE(t[Hn],t),this.operationsCounter?.recordDestroy()}updateValue(t,e){this.getLView(t)[Ea].$implicit=e}reset(){this.needsIndexUpdate=!1,this.operationsCounter?.reset()}updateIndexes(){if(this.needsIndexUpdate)for(let t=0;t<this.length;t++)this.getLView(t)[Ea].$index=t}getLView(t){return gX(this.lContainer,t)}};function H_(i){let t=er(null),e=Du();try{let n=pn(),s=n[Hn],r=n[e],y=e+1,A=oE(n,y);if(r.liveCollection===void 0){let B=aR(s,y);r.liveCollection=new oR(A,n,B)}else r.liveCollection.reset();let P=r.liveCollection;if(fX(P,i,r.trackByFn),P.updateIndexes(),r.hasEmptyBlock){let B=um(),U=P.length===0;if(wl(n,B,U)){let J=e+2,le=oE(n,J);if(U){let re=aR(s,J),X=I_(le,re.tView.ssrId),ee=mb(n,re,void 0,{dehydratedView:X});gb(le,ee,0,T_(re,X))}else IV(le,0)}}}finally{er(t)}}function oE(i,t){return i[t]}function mX(i,t){return ab(i,t)}function gX(i,t){return TV(i,t)}function aR(i,t){return SR(i,t)}function oe(i,t,e,n){let s=pn(),r=uo(),y=na+i,A=s[_o],P=r.firstCreatePass?PV(y,r,s,t,KR,AR(),e,n):r.data[y],B=_X(r,s,P,A,t,i);s[y]=B;let U=fE(P);return ip(P,!0),cV(A,B,P),!tk(P)&&_E()&&DE(r,s,B,P),(QW()===0||U)&&B_(B,s),JW(),U&&(CE(r,s,P),GR(r,P,s)),n!==null&&XR(s,P),oe}function ae(){let i=os();RR()?kR():(i=i.parent,ip(i,!1));let t=i;t9(t)&&i9(),e9();let e=uo();return e.firstCreatePass&&OV(e,t),t.classesWithoutHost!=null&&_9(t)&&eR(e,t,pn(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&y9(t)&&eR(e,t,pn(),t.stylesWithoutHost,!1),ae}function Et(i,t,e,n){return oe(i,t,e,n),ae(),Et}var _X=(i,t,e,n,s,r)=>(yE(!0),sV(n,s,f9()));function yX(i,t,e,n,s){let r=t.consts,y=Jh(r,n),A=j_(t,i,8,"ng-container",y);y!==null&&jA(A,y,!0);let P=Jh(r,s);return AR()&&ok(t,e,A,P,KR),A.mergedAttrs=M_(A.mergedAttrs,A.attrs),t.queries!==null&&t.queries.elementStart(t,A),A}function bn(i,t,e){let n=pn(),s=uo(),r=i+na,y=s.firstCreatePass?yX(r,s,n,t,e):s.data[r];ip(y,!0);let A=vX(s,n,y,i);return n[r]=A,_E()&&DE(s,n,A,y),B_(A,n),fE(y)&&(CE(s,n,y),GR(s,y,n)),e!=null&&XR(n,y),bn}function xn(){let i=os(),t=uo();return RR()?kR():(i=i.parent,ip(i,!1)),t.firstCreatePass&&(NR(t,i),ER(i)&&t.queries.elementEnd(i)),xn}function Ta(i,t,e){return bn(i,t,e),xn(),Ta}var vX=(i,t,e,n)=>(yE(!0),j7(t[_o],""));function bi(){return pn()}function Ia(i,t,e){let n=pn(),s=um();if(wl(n,s,t)){let r=uo(),y=hb();EE(r,y,n,i,t,n[_o],e,!0)}return Ia}var Kf=void 0;function bX(i){let t=Math.floor(Math.abs(i)),e=i.toString().replace(/^[^.]*\.?/,"").length;return t===1&&e===0?1:5}var xX=["en",[["a","p"],["AM","PM"],Kf],[["AM","PM"],Kf,Kf],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Kf,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Kf,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Kf,"{1} 'at' {0}",Kf],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",bX],rA={};function ql(i){let t=wX(i),e=vz(t);if(e)return e;let n=t.split("-")[0];if(e=vz(n),e)return e;if(n==="en")return xX;throw new Mi(701,!1)}function vz(i){return i in rA||(rA[i]=Ed.ng&&Ed.ng.common&&Ed.ng.common.locales&&Ed.ng.common.locales[i]),rA[i]}var Wo=function(i){return i[i.LocaleId=0]="LocaleId",i[i.DayPeriodsFormat=1]="DayPeriodsFormat",i[i.DayPeriodsStandalone=2]="DayPeriodsStandalone",i[i.DaysFormat=3]="DaysFormat",i[i.DaysStandalone=4]="DaysStandalone",i[i.MonthsFormat=5]="MonthsFormat",i[i.MonthsStandalone=6]="MonthsStandalone",i[i.Eras=7]="Eras",i[i.FirstDayOfWeek=8]="FirstDayOfWeek",i[i.WeekendRange=9]="WeekendRange",i[i.DateFormat=10]="DateFormat",i[i.TimeFormat=11]="TimeFormat",i[i.DateTimeFormat=12]="DateTimeFormat",i[i.NumberSymbols=13]="NumberSymbols",i[i.NumberFormats=14]="NumberFormats",i[i.CurrencyCode=15]="CurrencyCode",i[i.CurrencySymbol=16]="CurrencySymbol",i[i.CurrencyName=17]="CurrencyName",i[i.Currencies=18]="Currencies",i[i.Directionality=19]="Directionality",i[i.PluralCase=20]="PluralCase",i[i.ExtraData=21]="ExtraData",i}(Wo||{});function wX(i){return i.toLowerCase().replace(/_/g,"-")}var aE="en-US";var CX=aE;function EX(i){typeof i=="string"&&(CX=i.toLowerCase().replace(/_/g,"-"))}function bz(i,t,e){return function n(s){if(s===Function)return e;let r=O_(i)?Id(i.index,t):t;rk(r,5);let y=t[Ea],A=xz(t,y,e,s),P=n.__ngNextListenerFn__;for(;P;)A=xz(t,y,P,s)&&A,P=P.__ngNextListenerFn__;return A}}function xz(i,t,e,n){let s=er(null);try{return Br(6,t,e),e(n)!==!1}catch(r){return SX(i,r),!1}finally{Br(7,t,e),er(s)}}function SX(i,t){let e=i[S_],n=e?e.get(Ms,null):null;n&&n.handleError(t)}function wz(i,t,e,n,s,r){let y=t[e],A=t[Hn],B=A.data[e].outputs[n],U=y[B],J=A.firstCreatePass?IR(A):null,le=TR(t),re=U.subscribe(r),X=le.length;le.push(r,re),J&&J.push(s,i.index,X,-(X+1))}var DX=(i,t,e)=>{};function _t(i,t,e,n){let s=pn(),r=uo(),y=os();return h4(r,s,s[_o],y,i,t,n),_t}function MX(i,t,e,n){let s=i.cleanup;if(s!=null)for(let r=0;r<s.length-1;r+=2){let y=s[r];if(y===e&&s[r+1]===n){let A=t[VC],P=s[r+2];return A.length>P?A[P]:null}typeof y=="string"&&(r+=2)}return null}function h4(i,t,e,n,s,r,y){let A=fE(n),B=i.firstCreatePass?IR(i):null,U=TR(t),J=!0;if(n.type&3||y){let le=Rd(n,t),re=y?y(le):le,X=U.length,ee=y?Re=>y(Td(Re[n.index])):n.index,we=null;if(!y&&A&&(we=MX(i,t,s,n.index)),we!==null){let Re=we.__ngLastListenerFn__||we;Re.__ngNextListenerFn__=r,we.__ngLastListenerFn__=r,J=!1}else{r=bz(n,t,r),DX(re,s,r);let Re=e.listen(re,s,r);U.push(r,Re),B&&B.push(s,ee,X,X+1)}}else r=bz(n,t,r);if(J){let le=n.outputs?.[s],re=n.hostDirectiveOutputs?.[s];if(re&&re.length)for(let X=0;X<re.length;X+=2){let ee=re[X],we=re[X+1];wz(n,t,ee,we,s,r)}if(le&&le.length)for(let X of le)wz(n,t,X,s,s,r)}}function bt(i=1){return h9(i)}function TX(i,t){let e=null,n=k7(i);for(let s=0;s<t.length;s++){let r=t[s];if(r==="*"){e=s;continue}if(n===null?aV(i,r,!0):F7(n,r))return s}return e}function xr(i){let t=pn()[xl][Xs];if(!t.projection){let e=i?i.length:1,n=t.projection=TW(e,null),s=n.slice(),r=t.child;for(;r!==null;){if(r.type!==128){let y=i?TX(r,i):0;y!==null&&(s[y]?s[y].projectionNext=r:n[y]=r,s[y]=r)}r=r.next}}}function an(i,t=0,e,n,s,r){let y=pn(),A=uo(),P=n?i+1:null;P!==null&&iE(y,A,P,n,s,r,null,e);let B=j_(A,na+i,16,null,e||null);B.projection===null&&(B.projection=t),kR();let J=!y[E_]||rB();y[xl][Xs].projection[B.projection]===null&&P!==null?IX(y,A,P):J&&!tk(B)&&yY(A,y,B)}function IX(i,t,e){let n=na+e,s=t.data[n],r=i[n],y=I_(r,s.tView.ssrId),A=mb(i,s,void 0,{dehydratedView:y});gb(r,A,0,T_(s,y))}function fk(i,t,e){return p4(i,"",t,"",e),fk}function p4(i,t,e,n,s){let r=pn(),y=pk(r,t,e,n);if(y!==Ks){let A=uo(),P=hb();EE(A,P,r,i,y,r[_o],s,!1)}return p4}function Mr(i,t,e,n){BV(i,t,e,n)}function Bn(i,t,e){vZ(i,t,e)}function Bi(i){let t=pn(),e=uo(),n=OR();gE(n+1);let s=sk(e,n);if(i.dirty&&WW(t)===((s.metadata.flags&2)===2)){if(s.matches===null)i.reset([]);else{let r=jV(t,n);i.reset(r,RB),i.notifyOnChanges()}return!0}return!1}function Vi(){return ak(pn(),OR())}function f4(i,t,e,n,s){EZ(t,BV(i,e,n,s))}function m4(i=1){gE(OR()+i)}function g4(i,t,e,n){e>=i.data.length&&(i.data[e]=null,i.blueprint[e]=null),t[e]=n}function No(i){let t=r9();return DR(t,na+i)}function Ee(i,t=""){let e=pn(),n=uo(),s=i+na,r=n.firstCreatePass?j_(n,s,1,t,null):n.data[s],y=AX(n,e,r,t,i);e[s]=y,_E()&&DE(n,e,y,r),ip(r,!1)}var AX=(i,t,e,n,s)=>(yE(!0),B7(t[_o],n));function tn(i){return zi("",i,""),tn}function zi(i,t,e){let n=pn(),s=pk(n,i,t,e);return s!==Ks&&_4(n,Du(),s),zi}function kd(i,t,e,n,s){let r=pn(),y=ZZ(r,i,t,e,n,s);return y!==Ks&&_4(r,Du(),y),kd}function _4(i,t,e){let n=eB(t,i);V7(i[_o],n,e)}function Iu(i,t,e){kB(t)&&(t=t());let n=pn(),s=um();if(wl(n,s,t)){let r=uo(),y=hb();EE(r,y,n,i,t,n[_o],e,!1)}return Iu}function sp(i,t){let e=kB(i);return e&&i.set(t),e}function Au(i,t){let e=pn(),n=uo(),s=os();return h4(n,e,e[_o],s,i,t),Au}var RX={};function mk(i){let t=uo(),e=pn(),n=i+na,s=j_(t,n,128,null,null);return ip(s,!1),g4(t,e,n,RX),mk}function kX(i,t,e){let n=uo();if(n.firstCreatePass){let s=Md(i);sR(e,n.data,n.blueprint,s,!0),sR(t,n.data,n.blueprint,s,!1)}}function sR(i,t,e,n,s){if(i=Ga(i),Array.isArray(i))for(let r=0;r<i.length;r++)sR(i[r],t,e,n,s);else{let r=uo(),y=pn(),A=os(),P=C_(i)?i:Ga(i.provide),B=Gz(i),U=A.providerIndexes&1048575,J=A.directiveStart,le=A.providerIndexes>>20;if(C_(i)||!i.multi){let re=new am(B,s,ai),X=aA(P,t,s?U:U+le,J);X===-1?(vA(WC(A,y),r,P),oA(r,i,t.length),t.push(P),A.directiveStart++,A.directiveEnd++,s&&(A.providerIndexes+=1048576),e.push(re),y.push(re)):(e[X]=re,y[X]=re)}else{let re=aA(P,t,U+le,J),X=aA(P,t,U,U+le),ee=re>=0&&e[re],we=X>=0&&e[X];if(s&&!we||!s&&!ee){vA(WC(A,y),r,P);let Re=FX(s?OX:PX,e.length,s,n,B);!s&&we&&(e[X].providerFactory=Re),oA(r,i,t.length,0),t.push(P),A.directiveStart++,A.directiveEnd++,s&&(A.providerIndexes+=1048576),e.push(Re),y.push(Re)}else{let Re=y4(e[s?X:re],B,!s&&n);oA(r,i,re>-1?re:X,Re)}!s&&n&&we&&e[X].componentProviders++}}}function oA(i,t,e,n){let s=C_(t),r=LW(t);if(s||r){let P=(r?Ga(t.useClass):t).prototype.ngOnDestroy;if(P){let B=i.destroyHooks||(i.destroyHooks=[]);if(!s&&t.multi){let U=B.indexOf(e);U===-1?B.push(e,[n,P]):B[U+1].push(n,P)}else B.push(e,P)}}}function y4(i,t,e){return e&&i.componentProviders++,i.multi.push(t)-1}function aA(i,t,e,n){for(let s=e;s<n;s++)if(t[s]===i)return s;return-1}function PX(i,t,e,n){return lR(this.multi,[])}function OX(i,t,e,n){let s=this.multi,r;if(this.providerFactory){let y=this.providerFactory.componentProviders,A=rb(e,e[Hn],this.providerFactory.index,n);r=A.slice(0,y),lR(s,r);for(let P=y;P<A.length;P++)r.push(A[P])}else r=[],lR(s,r);return r}function lR(i,t){for(let e=0;e<i.length;e++){let n=i[e];t.push(n())}return t}function FX(i,t,e,n,s){let r=new am(i,e,ai);return r.multi=[],r.index=t,r.componentProviders=0,y4(r,s,n&&!e),r}function Vn(i,t=[]){return e=>{e.providersResolver=(n,s)=>kX(n,s?s(i):i,t)}}function $_(i,t,e){let n=L_()+i,s=pn();return s[n]===Ks?yb(s,n,e?t.call(e):t()):ZV(s,n)}function v4(i,t,e,n,s){return b4(pn(),L_(),i,t,e,n,s)}function kE(i,t,e,n,s,r,y){return NX(pn(),L_(),i,t,e,n,s,r,y)}function gk(i,t,e,n,s,r,y,A){let P=L_()+i,B=pn(),U=XV(B,P,e,n,s,r);return wl(B,P+4,y)||U?yb(B,P+5,A?t.call(A,e,n,s,r,y):t(e,n,s,r,y)):ZV(B,P+5)}function _k(i,t){let e=i[t];return e===Ks?void 0:e}function LX(i,t,e,n,s,r){let y=t+e;return wl(i,y,s)?yb(i,y+1,r?n.call(r,s):n(s)):_k(i,y+1)}function b4(i,t,e,n,s,r,y){let A=t+e;return tE(i,A,s,r)?yb(i,A+2,y?n.call(y,s,r):n(s,r)):_k(i,A+2)}function NX(i,t,e,n,s,r,y,A,P){let B=t+e;return XV(i,B,s,r,y,A)?yb(i,B+4,P?n.call(P,s,r,y,A):n(s,r,y,A)):_k(i,B+4)}function Qs(i,t){let e=uo(),n,s=i+na;e.firstCreatePass?(n=zX(t,e.pipeRegistry),e.data[s]=n,n.onDestroy&&(e.destroyHooks??=[]).push(s,n.onDestroy)):n=e.data[s];let r=n.factory||(n.factory=em(n.type,!0)),y,A=Ws(ai);try{let P=qC(!1),B=r();return qC(P),g4(e,pn(),s,B),B}finally{Ws(A)}}function zX(i,t){if(t)for(let e=t.length-1;e>=0;e--){let n=t[e];if(i===n.name)return n}}function vb(i,t,e){let n=i+na,s=pn(),r=DR(s,n);return x4(s,n)?LX(s,L_(),t,r.transform,e,r):r.transform(e)}function Pd(i,t,e,n){let s=i+na,r=pn(),y=DR(r,s);return x4(r,s)?b4(r,L_(),t,y.transform,e,n,y):y.transform(e,n)}function x4(i,t){return i[Hn].data[t].pure}function lp(i,t){return TE(i,t)}var dm=class{full;major;minor;patch;constructor(t){this.full=t;let e=t.split(".");this.major=e[0],this.minor=e[1],this.patch=e.slice(2).join(".")}},yk=new dm("19.2.8"),cR=class{ngModuleFactory;componentFactories;constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}},w4=(()=>{class i{compileModuleSync(e){return new ZA(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){let n=this.compileModuleSync(e),s=Vz(e),r=rV(s.declarations).reduce((y,A)=>{let P=Qh(A);return P&&y.push(new lm(P)),y},[]);return new cR(n,r)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var BX=(()=>{class i{zone=Z(ki);changeDetectionScheduler=Z(sm);applicationRef=Z($l);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function VX({ngZoneFactory:i,ignoreChangesOutsideZone:t,scheduleInRootZone:e}){return i??=()=>new ki(Xi(Ct({},jX()),{scheduleInRootZone:e})),[{provide:ki,useFactory:i},{provide:w_,multi:!0,useFactory:()=>{let n=Z(BX,{optional:!0});return()=>n.initialize()}},{provide:w_,multi:!0,useFactory:()=>{let n=Z(UX);return()=>{n.initialize()}}},t===!0?{provide:DB,useValue:!0}:[],{provide:MB,useValue:e??SB}]}function jX(i){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:i?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:i?.runCoalescing??!1}}var UX=(()=>{class i{subscription=new Tn;initialized=!1;zone=Z(ki);pendingTasks=Z(Mu);initialize(){if(this.initialized)return;this.initialized=!0;let e=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(e=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{ki.assertNotInAngularZone(),queueMicrotask(()=>{e!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(e),e=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{ki.assertInAngularZone(),e??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var HX=(()=>{class i{appRef=Z($l);taskService=Z(Mu);ngZone=Z(ki);zonelessEnabled=Z(BR);tracing=Z(V_,{optional:!0});disableScheduling=Z(DB,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Tn;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(ZC):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(Z(MB,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof CA||!this.zoneIsDefined)}notify(e){if(!this.zonelessEnabled&&e===5)return;let n=!1;switch(e){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,n=!0;break}case 12:{this.appRef.dirtyFlags|=16,n=!0;break}case 13:{this.appRef.dirtyFlags|=2,n=!0;break}case 11:{n=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(n))return;let s=this.useMicrotaskScheduler?W3:TB;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>s(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>s(()=>this.tick()))}shouldScheduleTick(e){return!(this.disableScheduling&&!e||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(ZC+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let e=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(n){throw this.taskService.remove(e),n}finally{this.cleanup()}this.useMicrotaskScheduler=!0,W3(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(e)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let e=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(e)}}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function $X(){return typeof $localize<"u"&&$localize.locale||aE}var G_=new Dt("",{providedIn:"root",factory:()=>Z(G_,rr.Optional|rr.SkipSelf)||$X()});var dR=new Dt(""),GX=new Dt("");function Q0(i){return!i.moduleRef}function qX(i){let t=Q0(i)?i.r3Injector:i.moduleRef.injector,e=t.get(ki);return e.run(()=>{Q0(i)?i.r3Injector.resolveInjectorInitializers():i.moduleRef.resolveInjectorInitializers();let n=t.get(Ms,null),s;if(e.runOutsideAngular(()=>{s=e.onError.subscribe({next:r=>{n.handleError(r)}})}),Q0(i)){let r=()=>t.destroy(),y=i.platformInjector.get(dR);y.add(r),t.onDestroy(()=>{s.unsubscribe(),y.delete(r)})}else{let r=()=>i.moduleRef.destroy(),y=i.platformInjector.get(dR);y.add(r),i.moduleRef.onDestroy(()=>{PC(i.allPlatformModules,i.moduleRef),s.unsubscribe(),y.delete(r)})}return YX(n,e,()=>{let r=t.get(e4);return r.runInitializers(),r.donePromise.then(()=>{let y=t.get(G_,aE);if(EX(y||aE),!t.get(GX,!0))return Q0(i)?t.get($l):(i.allPlatformModules.push(i.moduleRef),i.moduleRef);if(Q0(i)){let P=t.get($l);return i.rootComponent!==void 0&&P.bootstrap(i.rootComponent),P}else return WX(i.moduleRef,i.allPlatformModules),i.moduleRef})})})}function WX(i,t){let e=i.injector.get($l);if(i._bootstrapComponents.length>0)i._bootstrapComponents.forEach(n=>e.bootstrap(n));else if(i.instance.ngDoBootstrap)i.instance.ngDoBootstrap(e);else throw new Mi(-403,!1);t.push(i)}function YX(i,t,e){try{let n=e();return ap(n)?n.catch(s=>{throw t.runOutsideAngular(()=>i.handleError(s)),s}):n}catch(n){throw t.runOutsideAngular(()=>i.handleError(n)),n}}var OC=null;function ZX(i=[],t){return vn.create({name:t,providers:[{provide:uE,useValue:"platform"},{provide:dR,useValue:new Set([()=>OC=null])},...i]})}function XX(i=[]){if(OC)return OC;let t=ZX(i);return OC=t,GZ(),KX(t),t}function KX(i){let t=i.get(UR,null);Zs(i,()=>{t?.forEach(e=>e())})}var $n=(()=>{class i{static __NG_ELEMENT_ID__=QX}return i})();function QX(i){return JX(os(),pn(),(i&16)===16)}function JX(i,t,e){if(O_(i)&&!e){let n=Id(i.index,t);return new sb(n,n)}else if(i.type&175){let n=t[xl];return new sb(n,t)}return null}var uR=class{constructor(){}supports(t){return YV(t)}create(t){return new hR(t)}},eK=(i,t)=>t,hR=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(t){this._trackByFn=t||eK}forEachItem(t){let e;for(e=this._itHead;e!==null;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,s=0,r=null;for(;e||n;){let y=!n||e&&e.currentIndex<Cz(n,s,r)?e:n,A=Cz(y,s,r),P=y.currentIndex;if(y===n)s--,n=n._nextRemoved;else if(e=e._next,y.previousIndex==null)s++;else{r||(r=[]);let B=A-s,U=P-s;if(B!=U){for(let le=0;le<B;le++){let re=le<r.length?r[le]:r[le]=0,X=re+le;U<=X&&X<B&&(r[le]=re+1)}let J=y.previousIndex;r[J]=U-B}}A!==P&&t(y,A,P)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;e!==null;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;e!==null;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;e!==null;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;e!==null;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;e!==null;e=e._nextIdentityChange)t(e)}diff(t){if(t==null&&(t=[]),!YV(t))throw new Mi(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._itHead,n=!1,s,r,y;if(Array.isArray(t)){this.length=t.length;for(let A=0;A<this.length;A++)r=t[A],y=this._trackByFn(A,r),e===null||!Object.is(e.trackById,y)?(e=this._mismatch(e,r,y,A),n=!0):(n&&(e=this._verifyReinsertion(e,r,y,A)),Object.is(e.item,r)||this._addIdentityChange(e,r)),e=e._next}else s=0,VZ(t,A=>{y=this._trackByFn(s,A),e===null||!Object.is(e.trackById,y)?(e=this._mismatch(e,A,y,s),n=!0):(n&&(e=this._verifyReinsertion(e,A,y,s)),Object.is(e.item,A)||this._addIdentityChange(e,A)),e=e._next,s++}),this.length=s;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;t!==null;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;t!==null;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;t!==null;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,s){let r;return t===null?r=this._itTail:(r=t._prev,this._remove(t)),t=this._unlinkedRecords===null?null:this._unlinkedRecords.get(n,null),t!==null?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,r,s)):(t=this._linkedRecords===null?null:this._linkedRecords.get(n,s),t!==null?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,r,s)):t=this._addAfter(new pR(e,n),r,s)),t}_verifyReinsertion(t,e,n,s){let r=this._unlinkedRecords===null?null:this._unlinkedRecords.get(n,null);return r!==null?t=this._reinsertAfter(r,t._prev,s):t.currentIndex!=s&&(t.currentIndex=s,this._addToMoves(t,s)),t}_truncate(t){for(;t!==null;){let e=t._next;this._addToRemovals(this._unlink(t)),t=e}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(t);let s=t._prevRemoved,r=t._nextRemoved;return s===null?this._removalsHead=r:s._nextRemoved=r,r===null?this._removalsTail=s:r._prevRemoved=s,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail===null?this._additionsTail=this._additionsHead=t:this._additionsTail=this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){let s=e===null?this._itHead:e._next;return t._next=s,t._prev=e,s===null?this._itTail=t:s._prev=t,e===null?this._itHead=t:e._next=t,this._linkedRecords===null&&(this._linkedRecords=new sE),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){this._linkedRecords!==null&&this._linkedRecords.remove(t);let e=t._prev,n=t._next;return e===null?this._itHead=n:e._next=n,n===null?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail===null?this._movesTail=this._movesHead=t:this._movesTail=this._movesTail._nextMoved=t),t}_addToRemovals(t){return this._unlinkedRecords===null&&(this._unlinkedRecords=new sE),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=t:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=t,t}},pR=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(t,e){this.item=t,this.trackById=e}},fR=class{_head=null;_tail=null;add(t){this._head===null?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;n!==null;n=n._nextDup)if((e===null||e<=n.currentIndex)&&Object.is(n.trackById,t))return n;return null}remove(t){let e=t._prevDup,n=t._nextDup;return e===null?this._head=n:e._nextDup=n,n===null?this._tail=e:n._prevDup=e,this._head===null}},sE=class{map=new Map;put(t){let e=t.trackById,n=this.map.get(e);n||(n=new fR,this.map.set(e,n)),n.add(t)}get(t,e){let n=t,s=this.map.get(n);return s?s.get(t,e):null}remove(t){let e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function Cz(i,t,e){let n=i.previousIndex;if(n===null)return n;let s=0;return e&&n<e.length&&(s=e[n]),n+t+s}function Ez(){return new Od([new uR])}var Od=(()=>{class i{factories;static \u0275prov=Mt({token:i,providedIn:"root",factory:Ez});constructor(e){this.factories=e}static create(e,n){if(n!=null){let s=n.factories.slice();e=e.concat(s)}return new i(e)}static extend(e){return{provide:i,useFactory:n=>i.create(e,n||Ez()),deps:[[i,new R_,new tp]]}}find(e){let n=this.factories.find(s=>s.supports(e));if(n!=null)return n;throw new Mi(901,!1)}}return i})();function C4(i){Br(8);try{let{rootComponent:t,appProviders:e,platformProviders:n}=i,s=XX(n),r=[VX({}),{provide:sm,useExisting:HX},...e||[]],y=new eE({providers:r,parent:s,debugName:"",runEnvironmentInitializers:!1});return qX({r3Injector:y.injector,platformInjector:s,rootComponent:t})}catch(t){return Promise.reject(t)}finally{Br(9)}}function xi(i){return typeof i=="boolean"?i:i!=null&&i!=="false"}function Aa(i,t=NaN){return!isNaN(parseFloat(i))&&!isNaN(Number(i))?Number(i):t}function Js(i){return RI(i)}function Cl(i,t){return $1(i,t?.equal)}var mR=class{[Gs];constructor(t){this[Gs]=t}destroy(){this[Gs].destroy()}};function bb(i,t){!t?.injector&&CR(bb);let e=t?.injector??Z(vn),n=t?.manualCleanup!==!0?e.get(N_):null,s,r=e.get($R,null,{optional:!0}),y=e.get(sm);return r!==null&&!t?.forceRoot?(s=nK(r.view,y,i),n instanceof YC&&n._lView===r.view&&(n=null)):s=rK(i,e.get(QV),y),s.injector=e,n!==null&&(s.onDestroyFn=n.onDestroy(()=>s.destroy())),new mR(s)}var E4=Xi(Ct({},a_),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,hasRun:!1,cleanupFns:void 0,zone:null,kind:"effect",onDestroyFn:ob,run(){if(this.dirty=!1,this.hasRun&&!j1(this))return;this.hasRun=!0;let i=n=>(this.cleanupFns??=[]).push(n),t=V0(this),e=HC(!1);try{this.maybeCleanup(),this.fn(i)}finally{HC(e),V1(this,t)}},maybeCleanup(){if(this.cleanupFns?.length)try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[]}}}),tK=Xi(Ct({},E4),{consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(12)},destroy(){j0(this),this.onDestroyFn(),this.maybeCleanup(),this.scheduler.remove(this)}}),iK=Xi(Ct({},E4),{consumerMarkedDirty(){this.view[Pn]|=8192,F_(this.view),this.notifier.notify(13)},destroy(){j0(this),this.onDestroyFn(),this.maybeCleanup(),this.view[im]?.delete(this)}});function nK(i,t,e){let n=Object.create(iK);return n.view=i,n.zone=typeof Zone<"u"?Zone.current:null,n.notifier=t,n.fn=e,i[im]??=new Set,i[im].add(n),n.consumerMarkedDirty(n),n}function rK(i,t,e){let n=Object.create(tK);return n.fn=i,n.scheduler=t,n.notifier=e,n.zone=typeof Zone<"u"?Zone.current:null,n.scheduler.schedule(n),n.notifier.notify(12),n}function PE(i,t){let e=Qh(i),n=t.elementInjector||hE();return new lm(e).create(n,t.projectableNodes,t.hostElement,t.environmentInjector)}function S4(i){let t=Qh(i);if(!t)return null;let e=new lm(t);return{get selector(){return e.selector},get type(){return e.componentType},get inputs(){return e.inputs},get outputs(){return e.outputs},get ngContentSelectors(){return e.ngContentSelectors},get isStandalone(){return t.standalone},get isSignal(){return t.signals}}}var Ki=new Dt("");var T4=null;function Wl(){return T4}function vk(i){T4??=i}var xb=class{},wb=(()=>{class i{historyGo(e){throw new Error("")}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:()=>Z(I4),providedIn:"platform"})}return i})(),bk=new Dt(""),I4=(()=>{class i extends wb{_location;_history;_doc=Z(Ki);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Wl().getBaseHref(this._doc)}onPopState(e){let n=Wl().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",e,!1),()=>n.removeEventListener("popstate",e)}onHashChange(e){let n=Wl().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",e,!1),()=>n.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,n,s){this._history.pushState(e,n,s)}replaceState(e,n,s){this._history.replaceState(e,n,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:()=>new i,providedIn:"platform"})}return i})();function OE(i,t){return i?t?i.endsWith("/")?t.startsWith("/")?i+t.slice(1):i+t:t.startsWith("/")?i+t:`${i}/${t}`:i:t}function D4(i){let t=i.search(/#|\?|$/);return i[t-1]==="/"?i.slice(0,t-1)+i.slice(t):i}function Bc(i){return i&&i[0]!=="?"?`?${i}`:i}var Vc=(()=>{class i{historyGo(e){throw new Error("")}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:()=>Z(LE),providedIn:"root"})}return i})(),FE=new Dt(""),LE=(()=>{class i extends Vc{_platformLocation;_baseHref;_removeListenerFns=[];constructor(e,n){super(),this._platformLocation=e,this._baseHref=n??this._platformLocation.getBaseHrefFromDOM()??Z(Ki).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return OE(this._baseHref,e)}path(e=!1){let n=this._platformLocation.pathname+Bc(this._platformLocation.search),s=this._platformLocation.hash;return s&&e?`${n}${s}`:n}pushState(e,n,s,r){let y=this.prepareExternalUrl(s+Bc(r));this._platformLocation.pushState(e,n,y)}replaceState(e,n,s,r){let y=this.prepareExternalUrl(s+Bc(r));this._platformLocation.replaceState(e,n,y)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(n){return new(n||i)(hi(wb),hi(FE,8))};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),Fd=(()=>{class i{_subject=new ni;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(e){this._locationStrategy=e;let n=this._locationStrategy.getBaseHref();this._basePath=sK(D4(M4(n))),this._locationStrategy.onPopState(s=>{this._subject.next({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,n=""){return this.path()==this.normalize(e+Bc(n))}normalize(e){return i.stripTrailingSlash(aK(this._basePath,M4(e)))}prepareExternalUrl(e){return e&&e[0]!=="/"&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,n="",s=null){this._locationStrategy.pushState(s,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Bc(n)),s)}replaceState(e,n="",s=null){this._locationStrategy.replaceState(s,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Bc(n)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription??=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)}),()=>{let n=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(n,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",n){this._urlChangeListeners.forEach(s=>s(e,n))}subscribe(e,n,s){return this._subject.subscribe({next:e,error:n??void 0,complete:s??void 0})}static normalizeQueryParams=Bc;static joinWithSlash=OE;static stripTrailingSlash=D4;static \u0275fac=function(n){return new(n||i)(hi(Vc))};static \u0275prov=Mt({token:i,factory:()=>oK(),providedIn:"root"})}return i})();function oK(){return new Fd(hi(Vc))}function aK(i,t){if(!i||!t.startsWith(i))return t;let e=t.substring(i.length);return e===""||["/",";","?","#"].includes(e[0])?e:t}function M4(i){return i.replace(/\/index.html$/,"")}function sK(i){if(new RegExp("^(https?:)?//").test(i)){let[,e]=i.split(/\/\/[^\/]+/);return e}return i}var Mk=(()=>{class i extends Vc{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(e,n){super(),this._platformLocation=e,n!=null&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let n=this._platformLocation.hash??"#";return n.length>0?n.substring(1):n}prepareExternalUrl(e){let n=OE(this._baseHref,e);return n.length>0?"#"+n:n}pushState(e,n,s,r){let y=this.prepareExternalUrl(s+Bc(r))||this._platformLocation.pathname;this._platformLocation.pushState(e,n,y)}replaceState(e,n,s,r){let y=this.prepareExternalUrl(s+Bc(r))||this._platformLocation.pathname;this._platformLocation.replaceState(e,n,y)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(n){return new(n||i)(hi(wb),hi(FE,8))};static \u0275prov=Mt({token:i,factory:i.\u0275fac})}return i})();var ls=function(i){return i[i.Format=0]="Format",i[i.Standalone=1]="Standalone",i}(ls||{}),jr=function(i){return i[i.Narrow=0]="Narrow",i[i.Abbreviated=1]="Abbreviated",i[i.Wide=2]="Wide",i[i.Short=3]="Short",i}(jr||{}),el=function(i){return i[i.Short=0]="Short",i[i.Medium=1]="Medium",i[i.Long=2]="Long",i[i.Full=3]="Full",i}(el||{}),ku={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function O4(i){return ql(i)[Wo.LocaleId]}function F4(i,t,e){let n=ql(i),s=[n[Wo.DayPeriodsFormat],n[Wo.DayPeriodsStandalone]],r=Yl(s,t);return Yl(r,e)}function L4(i,t,e){let n=ql(i),s=[n[Wo.DaysFormat],n[Wo.DaysStandalone]],r=Yl(s,t);return Yl(r,e)}function N4(i,t,e){let n=ql(i),s=[n[Wo.MonthsFormat],n[Wo.MonthsStandalone]],r=Yl(s,t);return Yl(r,e)}function z4(i,t){let n=ql(i)[Wo.Eras];return Yl(n,t)}function Cb(i,t){let e=ql(i);return Yl(e[Wo.DateFormat],t)}function Eb(i,t){let e=ql(i);return Yl(e[Wo.TimeFormat],t)}function Sb(i,t){let n=ql(i)[Wo.DateTimeFormat];return Yl(n,t)}function Db(i,t){let e=ql(i),n=e[Wo.NumberSymbols][t];if(typeof n>"u"){if(t===ku.CurrencyDecimal)return e[Wo.NumberSymbols][ku.Decimal];if(t===ku.CurrencyGroup)return e[Wo.NumberSymbols][ku.Group]}return n}function B4(i){if(!i[Wo.ExtraData])throw new Error(`Missing extra locale data for the locale "${i[Wo.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function V4(i){let t=ql(i);return B4(t),(t[Wo.ExtraData][2]||[]).map(n=>typeof n=="string"?xk(n):[xk(n[0]),xk(n[1])])}function j4(i,t,e){let n=ql(i);B4(n);let s=[n[Wo.ExtraData][0],n[Wo.ExtraData][1]],r=Yl(s,t)||[];return Yl(r,e)||[]}function Yl(i,t){for(let e=t;e>-1;e--)if(typeof i[e]<"u")return i[e];throw new Error("Locale data API: locale data undefined")}function xk(i){let[t,e]=i.split(":");return{hours:+t,minutes:+e}}var lK=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,NE={},cK=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function U4(i,t,e,n){let s=yK(i);t=Ru(e,t)||t;let y=[],A;for(;t;)if(A=cK.exec(t),A){y=y.concat(A.slice(1));let U=y.pop();if(!U)break;t=U}else{y.push(t);break}let P=s.getTimezoneOffset();n&&(P=$4(n,P),s=_K(s,n));let B="";return y.forEach(U=>{let J=mK(U);B+=J?J(s,e,P):U==="''"?"'":U.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),B}function UE(i,t,e){let n=new Date(0);return n.setFullYear(i,t,e),n.setHours(0,0,0),n}function Ru(i,t){let e=O4(i);if(NE[e]??={},NE[e][t])return NE[e][t];let n="";switch(t){case"shortDate":n=Cb(i,el.Short);break;case"mediumDate":n=Cb(i,el.Medium);break;case"longDate":n=Cb(i,el.Long);break;case"fullDate":n=Cb(i,el.Full);break;case"shortTime":n=Eb(i,el.Short);break;case"mediumTime":n=Eb(i,el.Medium);break;case"longTime":n=Eb(i,el.Long);break;case"fullTime":n=Eb(i,el.Full);break;case"short":let s=Ru(i,"shortTime"),r=Ru(i,"shortDate");n=zE(Sb(i,el.Short),[s,r]);break;case"medium":let y=Ru(i,"mediumTime"),A=Ru(i,"mediumDate");n=zE(Sb(i,el.Medium),[y,A]);break;case"long":let P=Ru(i,"longTime"),B=Ru(i,"longDate");n=zE(Sb(i,el.Long),[P,B]);break;case"full":let U=Ru(i,"fullTime"),J=Ru(i,"fullDate");n=zE(Sb(i,el.Full),[U,J]);break}return n&&(NE[e][t]=n),n}function zE(i,t){return t&&(i=i.replace(/\{([^}]+)}/g,function(e,n){return t!=null&&n in t?t[n]:e})),i}function jc(i,t,e="-",n,s){let r="";(i<0||s&&i<=0)&&(s?i=-i+1:(i=-i,r=e));let y=String(i);for(;y.length<t;)y="0"+y;return n&&(y=y.slice(y.length-t)),r+y}function dK(i,t){return jc(i,3).substring(0,t)}function oa(i,t,e=0,n=!1,s=!1){return function(r,y){let A=uK(i,r);if((e>0||A>-e)&&(A+=e),i===3)A===0&&e===-12&&(A=12);else if(i===6)return dK(A,t);let P=Db(y,ku.MinusSign);return jc(A,t,P,n,s)}}function uK(i,t){switch(i){case 0:return t.getFullYear();case 1:return t.getMonth();case 2:return t.getDate();case 3:return t.getHours();case 4:return t.getMinutes();case 5:return t.getSeconds();case 6:return t.getMilliseconds();case 7:return t.getDay();default:throw new Error(`Unknown DateType value "${i}".`)}}function Jr(i,t,e=ls.Format,n=!1){return function(s,r){return hK(s,r,i,t,e,n)}}function hK(i,t,e,n,s,r){switch(e){case 2:return N4(t,s,n)[i.getMonth()];case 1:return L4(t,s,n)[i.getDay()];case 0:let y=i.getHours(),A=i.getMinutes();if(r){let B=V4(t),U=j4(t,s,n),J=B.findIndex(le=>{if(Array.isArray(le)){let[re,X]=le,ee=y>=re.hours&&A>=re.minutes,we=y<X.hours||y===X.hours&&A<X.minutes;if(re.hours<X.hours){if(ee&&we)return!0}else if(ee||we)return!0}else if(le.hours===y&&le.minutes===A)return!0;return!1});if(J!==-1)return U[J]}return F4(t,s,n)[y<12?0:1];case 3:return z4(t,n)[i.getFullYear()<=0?0:1];default:let P=e;throw new Error(`unexpected translation type ${P}`)}}function BE(i){return function(t,e,n){let s=-1*n,r=Db(e,ku.MinusSign),y=s>0?Math.floor(s/60):Math.ceil(s/60);switch(i){case 0:return(s>=0?"+":"")+jc(y,2,r)+jc(Math.abs(s%60),2,r);case 1:return"GMT"+(s>=0?"+":"")+jc(y,1,r);case 2:return"GMT"+(s>=0?"+":"")+jc(y,2,r)+":"+jc(Math.abs(s%60),2,r);case 3:return n===0?"Z":(s>=0?"+":"")+jc(y,2,r)+":"+jc(Math.abs(s%60),2,r);default:throw new Error(`Unknown zone width "${i}"`)}}}var pK=0,jE=4;function fK(i){let t=UE(i,pK,1).getDay();return UE(i,0,1+(t<=jE?jE:jE+7)-t)}function H4(i){let t=i.getDay(),e=t===0?-3:jE-t;return UE(i.getFullYear(),i.getMonth(),i.getDate()+e)}function wk(i,t=!1){return function(e,n){let s;if(t){let r=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,y=e.getDate();s=1+Math.floor((y+r)/7)}else{let r=H4(e),y=fK(r.getFullYear()),A=r.getTime()-y.getTime();s=1+Math.round(A/6048e5)}return jc(s,i,Db(n,ku.MinusSign))}}function VE(i,t=!1){return function(e,n){let r=H4(e).getFullYear();return jc(r,i,Db(n,ku.MinusSign),t)}}var Ck={};function mK(i){if(Ck[i])return Ck[i];let t;switch(i){case"G":case"GG":case"GGG":t=Jr(3,jr.Abbreviated);break;case"GGGG":t=Jr(3,jr.Wide);break;case"GGGGG":t=Jr(3,jr.Narrow);break;case"y":t=oa(0,1,0,!1,!0);break;case"yy":t=oa(0,2,0,!0,!0);break;case"yyy":t=oa(0,3,0,!1,!0);break;case"yyyy":t=oa(0,4,0,!1,!0);break;case"Y":t=VE(1);break;case"YY":t=VE(2,!0);break;case"YYY":t=VE(3);break;case"YYYY":t=VE(4);break;case"M":case"L":t=oa(1,1,1);break;case"MM":case"LL":t=oa(1,2,1);break;case"MMM":t=Jr(2,jr.Abbreviated);break;case"MMMM":t=Jr(2,jr.Wide);break;case"MMMMM":t=Jr(2,jr.Narrow);break;case"LLL":t=Jr(2,jr.Abbreviated,ls.Standalone);break;case"LLLL":t=Jr(2,jr.Wide,ls.Standalone);break;case"LLLLL":t=Jr(2,jr.Narrow,ls.Standalone);break;case"w":t=wk(1);break;case"ww":t=wk(2);break;case"W":t=wk(1,!0);break;case"d":t=oa(2,1);break;case"dd":t=oa(2,2);break;case"c":case"cc":t=oa(7,1);break;case"ccc":t=Jr(1,jr.Abbreviated,ls.Standalone);break;case"cccc":t=Jr(1,jr.Wide,ls.Standalone);break;case"ccccc":t=Jr(1,jr.Narrow,ls.Standalone);break;case"cccccc":t=Jr(1,jr.Short,ls.Standalone);break;case"E":case"EE":case"EEE":t=Jr(1,jr.Abbreviated);break;case"EEEE":t=Jr(1,jr.Wide);break;case"EEEEE":t=Jr(1,jr.Narrow);break;case"EEEEEE":t=Jr(1,jr.Short);break;case"a":case"aa":case"aaa":t=Jr(0,jr.Abbreviated);break;case"aaaa":t=Jr(0,jr.Wide);break;case"aaaaa":t=Jr(0,jr.Narrow);break;case"b":case"bb":case"bbb":t=Jr(0,jr.Abbreviated,ls.Standalone,!0);break;case"bbbb":t=Jr(0,jr.Wide,ls.Standalone,!0);break;case"bbbbb":t=Jr(0,jr.Narrow,ls.Standalone,!0);break;case"B":case"BB":case"BBB":t=Jr(0,jr.Abbreviated,ls.Format,!0);break;case"BBBB":t=Jr(0,jr.Wide,ls.Format,!0);break;case"BBBBB":t=Jr(0,jr.Narrow,ls.Format,!0);break;case"h":t=oa(3,1,-12);break;case"hh":t=oa(3,2,-12);break;case"H":t=oa(3,1);break;case"HH":t=oa(3,2);break;case"m":t=oa(4,1);break;case"mm":t=oa(4,2);break;case"s":t=oa(5,1);break;case"ss":t=oa(5,2);break;case"S":t=oa(6,1);break;case"SS":t=oa(6,2);break;case"SSS":t=oa(6,3);break;case"Z":case"ZZ":case"ZZZ":t=BE(0);break;case"ZZZZZ":t=BE(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=BE(1);break;case"OOOO":case"ZZZZ":case"zzzz":t=BE(2);break;default:return null}return Ck[i]=t,t}function $4(i,t){i=i.replace(/:/g,"");let e=Date.parse("Jan 01, 1970 00:00:00 "+i)/6e4;return isNaN(e)?t:e}function gK(i,t){return i=new Date(i.getTime()),i.setMinutes(i.getMinutes()+t),i}function _K(i,t,e){let s=i.getTimezoneOffset(),r=$4(t,s);return gK(i,-1*(r-s))}function yK(i){if(A4(i))return i;if(typeof i=="number"&&!isNaN(i))return new Date(i);if(typeof i=="string"){if(i=i.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(i)){let[s,r=1,y=1]=i.split("-").map(A=>+A);return UE(s,r-1,y)}let e=parseFloat(i);if(!isNaN(i-e))return new Date(e);let n;if(n=i.match(lK))return vK(n)}let t=new Date(i);if(!A4(t))throw new Error(`Unable to convert "${i}" into a date`);return t}function vK(i){let t=new Date(0),e=0,n=0,s=i[8]?t.setUTCFullYear:t.setFullYear,r=i[8]?t.setUTCHours:t.setHours;i[9]&&(e=Number(i[9]+i[10]),n=Number(i[9]+i[11])),s.call(t,Number(i[1]),Number(i[2])-1,Number(i[3]));let y=Number(i[4]||0)-e,A=Number(i[5]||0)-n,P=Number(i[6]||0),B=Math.floor(parseFloat("0."+(i[7]||0))*1e3);return r.call(t,y,A,P,B),t}function A4(i){return i instanceof Date&&!isNaN(i.valueOf())}var Ek=/\s+/,R4=[],qa=(()=>{class i{_ngEl;_renderer;initialClasses=R4;rawClass;stateMap=new Map;constructor(e,n){this._ngEl=e,this._renderer=n}set klass(e){this.initialClasses=e!=null?e.trim().split(Ek):R4}set ngClass(e){this.rawClass=typeof e=="string"?e.trim().split(Ek):e}ngDoCheck(){for(let n of this.initialClasses)this._updateState(n,!0);let e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(let n of e)this._updateState(n,!0);else if(e!=null)for(let n of Object.keys(e))this._updateState(n,!!e[n]);this._applyStateDiff()}_updateState(e,n){let s=this.stateMap.get(e);s!==void 0?(s.enabled!==n&&(s.changed=!0,s.enabled=n),s.touched=!0):this.stateMap.set(e,{enabled:n,changed:!0,touched:!0})}_applyStateDiff(){for(let e of this.stateMap){let n=e[0],s=e[1];s.changed?(this._toggleClass(n,s.enabled),s.changed=!1):s.touched||(s.enabled&&this._toggleClass(n,!1),this.stateMap.delete(n)),s.touched=!1}}_toggleClass(e,n){e=e.trim(),e.length>0&&e.split(Ek).forEach(s=>{n?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}static \u0275fac=function(n){return new(n||i)(ai(Ii),ai(Do))};static \u0275dir=ri({type:i,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return i})();var HE=class{$implicit;ngForOf;index;count;constructor(t,e,n,s){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=s}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},cs=(()=>{class i{_viewContainer;_template;_differs;set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(e,n,s){this._viewContainer=e,this._template=n,this._differs=s}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){let e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){let n=this._viewContainer;e.forEachOperation((s,r,y)=>{if(s.previousIndex==null)n.createEmbeddedView(this._template,new HE(s.item,this._ngForOf,-1,-1),y===null?void 0:y);else if(y==null)n.remove(r===null?void 0:r);else if(r!==null){let A=n.get(r);n.move(A,y),k4(A,s)}});for(let s=0,r=n.length;s<r;s++){let A=n.get(s).context;A.index=s,A.count=r,A.ngForOf=this._ngForOf}e.forEachIdentityChange(s=>{let r=n.get(s.currentIndex);k4(r,s)})}static ngTemplateContextGuard(e,n){return!0}static \u0275fac=function(n){return new(n||i)(ai(yo),ai(co),ai(Od))};static \u0275dir=ri({type:i,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return i})();function k4(i,t){i.context.$implicit=t.item}var Zn=(()=>{class i{_viewContainer;_context=new $E;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(e,n){this._viewContainer=e,this._thenTemplateRef=n}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){P4(e,!1),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){P4(e,!1),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(e,n){return!0}static \u0275fac=function(n){return new(n||i)(ai(yo),ai(co))};static \u0275dir=ri({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return i})(),$E=class{$implicit=null;ngIf=null};function P4(i,t){if(i&&!i.createEmbeddedView)throw new Mi(2020,!1)}var Mb=(()=>{class i{_viewContainerRef;_viewRef=null;ngTemplateOutletContext=null;ngTemplateOutlet=null;ngTemplateOutletInjector=null;constructor(e){this._viewContainerRef=e}ngOnChanges(e){if(this._shouldRecreateView(e)){let n=this._viewContainerRef;if(this._viewRef&&n.remove(n.indexOf(this._viewRef)),!this.ngTemplateOutlet){this._viewRef=null;return}let s=this._createContextForwardProxy();this._viewRef=n.createEmbeddedView(this.ngTemplateOutlet,s,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(e){return!!e.ngTemplateOutlet||!!e.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(e,n,s)=>this.ngTemplateOutletContext?Reflect.set(this.ngTemplateOutletContext,n,s):!1,get:(e,n,s)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,n,s)}})}static \u0275fac=function(n){return new(n||i)(ai(yo))};static \u0275dir=ri({type:i,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},features:[fr]})}return i})();function G4(i,t){return new Mi(2100,!1)}var Sk=class{createSubscription(t,e){return Js(()=>t.subscribe({next:e,error:n=>{throw n}}))}dispose(t){Js(()=>t.unsubscribe())}},Dk=class{createSubscription(t,e){return t.then(e,n=>{throw n})}dispose(t){}},bK=new Dk,xK=new Sk,Tb=(()=>{class i{_ref;_latestValue=null;markForCheckOnValueUpdate=!0;_subscription=null;_obj=null;_strategy=null;constructor(e){this._ref=e}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(e){if(!this._obj){if(e)try{this.markForCheckOnValueUpdate=!1,this._subscribe(e)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return e!==this._obj?(this._dispose(),this.transform(e)):this._latestValue}_subscribe(e){this._obj=e,this._strategy=this._selectStrategy(e),this._subscription=this._strategy.createSubscription(e,n=>this._updateLatestValue(e,n))}_selectStrategy(e){if(ap(e))return bK;if(uk(e))return xK;throw G4(i,e)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(e,n){e===this._obj&&(this._latestValue=n,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static \u0275fac=function(n){return new(n||i)(ai($n,16))};static \u0275pipe=ck({name:"async",type:i,pure:!1})}return i})();var wK="mediumDate",q4=new Dt(""),W4=new Dt(""),Uc=(()=>{class i{locale;defaultTimezone;defaultOptions;constructor(e,n,s){this.locale=e,this.defaultTimezone=n,this.defaultOptions=s}transform(e,n,s,r){if(e==null||e===""||e!==e)return null;try{let y=n??this.defaultOptions?.dateFormat??wK,A=s??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return U4(e,y,r||this.locale,A)}catch(y){throw G4(i,y.message)}}static \u0275fac=function(n){return new(n||i)(ai(G_,16),ai(q4,24),ai(W4,24))};static \u0275pipe=ck({name:"date",type:i,pure:!0})}return i})();var sr=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({})}return i})();function Ib(i,t){t=encodeURIComponent(t);for(let e of i.split(";")){let n=e.indexOf("="),[s,r]=n==-1?[e,""]:[e.slice(0,n),e.slice(n+1)];if(s.trim()===t)return decodeURIComponent(r)}return null}var GE="browser",Y4="server";function tl(i){return i===GE}function qE(i){return i===Y4}var gm=class{};var Z4=(()=>{class i{static \u0275prov=Mt({token:i,providedIn:"root",factory:()=>new Tk(Z(Ki),window)})}return i})(),Tk=class{document;window;offset=()=>[0,0];constructor(t,e){this.document=t,this.window=e}setOffset(t){Array.isArray(t)?this.offset=()=>t:this.offset=t}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(t){this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){let e=CK(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){this.window.history.scrollRestoration=t}scrollToElement(t){let e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,s=e.top+this.window.pageYOffset,r=this.offset();this.window.scrollTo(n-r[0],s-r[1])}};function CK(i,t){let e=i.getElementById(t)||i.getElementsByName(t)[0];if(e)return e;if(typeof i.createTreeWalker=="function"&&i.body&&typeof i.body.attachShadow=="function"){let n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT),s=n.currentNode;for(;s;){let r=s.shadowRoot;if(r){let y=r.getElementById(t)||r.querySelector(`[name="${t}"]`);if(y)return y}s=n.nextNode()}}return null}var ZE=new Dt(""),kk=(()=>{class i{_zone;_plugins;_eventNameToPlugin=new Map;constructor(e,n){this._zone=n,e.forEach(s=>{s.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,n,s,r){return this._findPluginFor(n).addEventListener(e,n,s,r)}getZone(){return this._zone}_findPluginFor(e){let n=this._eventNameToPlugin.get(e);if(n)return n;if(n=this._plugins.find(r=>r.supports(e)),!n)throw new Mi(5101,!1);return this._eventNameToPlugin.set(e,n),n}static \u0275fac=function(n){return new(n||i)(hi(ZE),hi(ki))};static \u0275prov=Mt({token:i,factory:i.\u0275fac})}return i})(),Ab=class{_doc;constructor(t){this._doc=t}manager},WE="ng-app-id";function X4(i){for(let t of i)t.remove()}function K4(i,t){let e=t.createElement("style");return e.textContent=i,e}function EK(i,t,e,n){let s=i.head?.querySelectorAll(`style[${WE}="${t}"],link[${WE}="${t}"]`);if(s)for(let r of s)r.removeAttribute(WE),r instanceof HTMLLinkElement?n.set(r.href.slice(r.href.lastIndexOf("/")+1),{usage:0,elements:[r]}):r.textContent&&e.set(r.textContent,{usage:0,elements:[r]})}function Ak(i,t){let e=t.createElement("link");return e.setAttribute("rel","stylesheet"),e.setAttribute("href",i),e}var Pk=(()=>{class i{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(e,n,s,r={}){this.doc=e,this.appId=n,this.nonce=s,this.isServer=qE(r),EK(e,n,this.inline,this.external),this.hosts.add(e.head)}addStyles(e,n){for(let s of e)this.addUsage(s,this.inline,K4);n?.forEach(s=>this.addUsage(s,this.external,Ak))}removeStyles(e,n){for(let s of e)this.removeUsage(s,this.inline);n?.forEach(s=>this.removeUsage(s,this.external))}addUsage(e,n,s){let r=n.get(e);r?r.usage++:n.set(e,{usage:1,elements:[...this.hosts].map(y=>this.addElement(y,s(e,this.doc)))})}removeUsage(e,n){let s=n.get(e);s&&(s.usage--,s.usage<=0&&(X4(s.elements),n.delete(e)))}ngOnDestroy(){for(let[,{elements:e}]of[...this.inline,...this.external])X4(e);this.hosts.clear()}addHost(e){this.hosts.add(e);for(let[n,{elements:s}]of this.inline)s.push(this.addElement(e,K4(n,this.doc)));for(let[n,{elements:s}]of this.external)s.push(this.addElement(e,Ak(n,this.doc)))}removeHost(e){this.hosts.delete(e)}addElement(e,n){return this.nonce&&n.setAttribute("nonce",this.nonce),this.isServer&&n.setAttribute(WE,this.appId),e.appendChild(n)}static \u0275fac=function(n){return new(n||i)(hi(Ki),hi(pm),hi(pb,8),hi(as))};static \u0275prov=Mt({token:i,factory:i.\u0275fac})}return i})(),Ik={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Ok=/%COMP%/g;var J4="%COMP%",SK=`_nghost-${J4}`,DK=`_ngcontent-${J4}`,MK=!0,TK=new Dt("",{providedIn:"root",factory:()=>MK});function IK(i){return DK.replace(Ok,i)}function AK(i){return SK.replace(Ok,i)}function e5(i,t){return t.map(e=>e.replace(Ok,i))}var Fk=(()=>{class i{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(e,n,s,r,y,A,P,B=null,U=null){this.eventManager=e,this.sharedStylesHost=n,this.appId=s,this.removeStylesOnCompDestroy=r,this.doc=y,this.platformId=A,this.ngZone=P,this.nonce=B,this.tracingService=U,this.platformIsServer=qE(A),this.defaultRenderer=new Rb(e,y,P,this.platformIsServer,this.tracingService)}createRenderer(e,n){if(!e||!n)return this.defaultRenderer;this.platformIsServer&&n.encapsulation===Ad.ShadowDom&&(n=Xi(Ct({},n),{encapsulation:Ad.Emulated}));let s=this.getOrCreateRenderer(e,n);return s instanceof YE?s.applyToHost(e):s instanceof kb&&s.applyStyles(),s}getOrCreateRenderer(e,n){let s=this.rendererByCompId,r=s.get(n.id);if(!r){let y=this.doc,A=this.ngZone,P=this.eventManager,B=this.sharedStylesHost,U=this.removeStylesOnCompDestroy,J=this.platformIsServer,le=this.tracingService;switch(n.encapsulation){case Ad.Emulated:r=new YE(P,B,n,this.appId,U,y,A,J,le);break;case Ad.ShadowDom:return new Rk(P,B,e,n,y,A,this.nonce,J,le);default:r=new kb(P,B,n,U,y,A,J,le);break}s.set(n.id,r)}return r}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(e){this.rendererByCompId.delete(e)}static \u0275fac=function(n){return new(n||i)(hi(kk),hi(Pk),hi(pm),hi(TK),hi(Ki),hi(as),hi(ki),hi(pb),hi(V_,8))};static \u0275prov=Mt({token:i,factory:i.\u0275fac})}return i})(),Rb=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(t,e,n,s,r){this.eventManager=t,this.doc=e,this.ngZone=n,this.platformIsServer=s,this.tracingService=r}destroy(){}destroyNode=null;createElement(t,e){return e?this.doc.createElementNS(Ik[e]||e,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,e){(Q4(t)?t.content:t).appendChild(e)}insertBefore(t,e,n){t&&(Q4(t)?t.content:t).insertBefore(e,n)}removeChild(t,e){e.remove()}selectRootElement(t,e){let n=typeof t=="string"?this.doc.querySelector(t):t;if(!n)throw new Mi(-5104,!1);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,s){if(s){e=s+":"+e;let r=Ik[s];r?t.setAttributeNS(r,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){let s=Ik[n];s?t.removeAttributeNS(s,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,s){s&(wu.DashCase|wu.Important)?t.style.setProperty(e,n,s&wu.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&wu.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){t!=null&&(t[e]=n)}setValue(t,e){t.nodeValue=e}listen(t,e,n,s){if(typeof t=="string"&&(t=Wl().getGlobalEventTarget(this.doc,t),!t))throw new Mi(5102,!1);let r=this.decoratePreventDefault(n);return this.tracingService?.wrapEventListener&&(r=this.tracingService.wrapEventListener(t,e,r)),this.eventManager.addEventListener(t,e,r,s)}decoratePreventDefault(t){return e=>{if(e==="__ngUnwrap__")return t;(this.platformIsServer?this.ngZone.runGuarded(()=>t(e)):t(e))===!1&&e.preventDefault()}}};function Q4(i){return i.tagName==="TEMPLATE"&&i.content!==void 0}var Rk=class extends Rb{sharedStylesHost;hostEl;shadowRoot;constructor(t,e,n,s,r,y,A,P,B){super(t,r,y,P,B),this.sharedStylesHost=e,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let U=s.styles;U=e5(s.id,U);for(let le of U){let re=document.createElement("style");A&&re.setAttribute("nonce",A),re.textContent=le,this.shadowRoot.appendChild(re)}let J=s.getExternalStyles?.();if(J)for(let le of J){let re=Ak(le,r);A&&re.setAttribute("nonce",A),this.shadowRoot.appendChild(re)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(null,e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},kb=class extends Rb{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(t,e,n,s,r,y,A,P,B){super(t,r,y,A,P),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=s;let U=n.styles;this.styles=B?e5(B,U):U,this.styleUrls=n.getExternalStyles?.(B)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},YE=class extends kb{contentAttr;hostAttr;constructor(t,e,n,s,r,y,A,P,B){let U=s+"-"+n.id;super(t,e,n,r,y,A,P,B,U),this.contentAttr=IK(U),this.hostAttr=AK(U)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,e){let n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}};var XE=class i extends xb{supportsDOMEvents=!0;static makeCurrent(){vk(new i)}onAndCancel(t,e,n,s){return t.addEventListener(e,n,s),()=>{t.removeEventListener(e,n,s)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.remove()}createElement(t,e){return e=e||this.getDefaultDocument(),e.createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return e==="window"?window:e==="document"?t:e==="body"?t.body:null}getBaseHref(t){let e=RK();return e==null?null:kK(e)}resetBaseElement(){Pb=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return Ib(document.cookie,t)}},Pb=null;function RK(){return Pb=Pb||document.querySelector("base"),Pb?Pb.getAttribute("href"):null}function kK(i){return new URL(i,document.baseURI).pathname}var PK=(()=>{class i{build(){return new XMLHttpRequest}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac})}return i})(),i5=(()=>{class i extends Ab{constructor(e){super(e)}supports(e){return!0}addEventListener(e,n,s,r){return e.addEventListener(n,s,r),()=>this.removeEventListener(e,n,s,r)}removeEventListener(e,n,s,r){return e.removeEventListener(n,s,r)}static \u0275fac=function(n){return new(n||i)(hi(Ki))};static \u0275prov=Mt({token:i,factory:i.\u0275fac})}return i})(),t5=["alt","control","meta","shift"],OK={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},FK={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey},n5=(()=>{class i extends Ab{constructor(e){super(e)}supports(e){return i.parseEventName(e)!=null}addEventListener(e,n,s,r){let y=i.parseEventName(n),A=i.eventCallback(y.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Wl().onAndCancel(e,y.domEventName,A,r))}static parseEventName(e){let n=e.toLowerCase().split("."),s=n.shift();if(n.length===0||!(s==="keydown"||s==="keyup"))return null;let r=i._normalizeKey(n.pop()),y="",A=n.indexOf("code");if(A>-1&&(n.splice(A,1),y="code."),t5.forEach(B=>{let U=n.indexOf(B);U>-1&&(n.splice(U,1),y+=B+".")}),y+=r,n.length!=0||r.length===0)return null;let P={};return P.domEventName=s,P.fullKey=y,P}static matchEventFullKeyCode(e,n){let s=OK[e.key]||e.key,r="";return n.indexOf("code.")>-1&&(s=e.code,r="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),t5.forEach(y=>{if(y!==s){let A=FK[y];A(e)&&(r+=y+".")}}),r+=s,r===n)}static eventCallback(e,n,s){return r=>{i.matchEventFullKeyCode(r,e)&&s.runGuarded(()=>n(r))}}static _normalizeKey(e){return e==="esc"?"escape":e}static \u0275fac=function(n){return new(n||i)(hi(Ki))};static \u0275prov=Mt({token:i,factory:i.\u0275fac})}return i})();function Lk(i,t){return C4(Ct({rootComponent:i},LK(t)))}function LK(i){return{appProviders:[...jK,...i?.providers??[]],platformProviders:VK}}function NK(){XE.makeCurrent()}function zK(){return new Ms}function BK(){return BB(document),document}var VK=[{provide:as,useValue:GE},{provide:UR,useValue:NK,multi:!0},{provide:Ki,useFactory:BK}];var jK=[{provide:uE,useValue:"root"},{provide:Ms,useFactory:zK},{provide:ZE,useClass:i5,multi:!0,deps:[Ki]},{provide:ZE,useClass:n5,multi:!0,deps:[Ki]},Fk,Pk,kk,{provide:Sa,useExisting:Fk},{provide:gm,useClass:PK},[]];var W_=class{},Ob=class{},cp=class i{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(t){t?typeof t=="string"?this.lazyInit=()=>{this.headers=new Map,t.split(`
`).forEach(e=>{let n=e.indexOf(":");if(n>0){let s=e.slice(0,n),r=e.slice(n+1).trim();this.addHeaderEntry(s,r)}})}:typeof Headers<"u"&&t instanceof Headers?(this.headers=new Map,t.forEach((e,n)=>{this.addHeaderEntry(n,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(t).forEach(([e,n])=>{this.setHeaderEntries(e,n)})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();let e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof i?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){let e=new i;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof i?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){let e=t.name.toLowerCase();switch(t.op){case"a":case"s":let n=t.value;if(typeof n=="string"&&(n=[n]),n.length===0)return;this.maybeSetNormalizedName(t.name,e);let s=(t.op==="a"?this.headers.get(e):void 0)||[];s.push(...n),this.headers.set(e,s);break;case"d":let r=t.value;if(!r)this.headers.delete(e),this.normalizedNames.delete(e);else{let y=this.headers.get(e);if(!y)return;y=y.filter(A=>r.indexOf(A)===-1),y.length===0?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,y)}break}}addHeaderEntry(t,e){let n=t.toLowerCase();this.maybeSetNormalizedName(t,n),this.headers.has(n)?this.headers.get(n).push(e):this.headers.set(n,[e])}setHeaderEntries(t,e){let n=(Array.isArray(e)?e:[e]).map(r=>r.toString()),s=t.toLowerCase();this.headers.set(s,n),this.maybeSetNormalizedName(t,s)}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}};var QE=class{encodeKey(t){return r5(t)}encodeValue(t){return r5(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}};function UK(i,t){let e=new Map;return i.length>0&&i.replace(/^\?/,"").split("&").forEach(s=>{let r=s.indexOf("="),[y,A]=r==-1?[t.decodeKey(s),""]:[t.decodeKey(s.slice(0,r)),t.decodeValue(s.slice(r+1))],P=e.get(y)||[];P.push(A),e.set(y,P)}),e}var HK=/%(\d[a-f0-9])/gi,$K={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function r5(i){return encodeURIComponent(i).replace(HK,(t,e)=>$K[e]??t)}function KE(i){return`${i}`}var ka=class i{map;encoder;updates=null;cloneFrom=null;constructor(t={}){if(this.encoder=t.encoder||new QE,t.fromString){if(t.fromObject)throw new Mi(2805,!1);this.map=UK(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{let n=t.fromObject[e],s=Array.isArray(n)?n.map(KE):[KE(n)];this.map.set(e,s)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();let e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){let e=[];return Object.keys(t).forEach(n=>{let s=t[n];Array.isArray(s)?s.forEach(r=>{e.push({param:n,value:r,op:"a"})}):e.push({param:n,value:s,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{let e=this.encoder.encodeKey(t);return this.map.get(t).map(n=>e+"="+this.encoder.encodeValue(n)).join("&")}).filter(t=>t!=="").join("&")}clone(t){let e=new i({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":let e=(t.op==="a"?this.map.get(t.param):void 0)||[];e.push(KE(t.value)),this.map.set(t.param,e);break;case"d":if(t.value!==void 0){let n=this.map.get(t.param)||[],s=n.indexOf(KE(t.value));s!==-1&&n.splice(s,1),n.length>0?this.map.set(t.param,n):this.map.delete(t.param)}else{this.map.delete(t.param);break}}}),this.cloneFrom=this.updates=null)}};var JE=class{map=new Map;set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}};function GK(i){switch(i){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function o5(i){return typeof ArrayBuffer<"u"&&i instanceof ArrayBuffer}function a5(i){return typeof Blob<"u"&&i instanceof Blob}function s5(i){return typeof FormData<"u"&&i instanceof FormData}function qK(i){return typeof URLSearchParams<"u"&&i instanceof URLSearchParams}var l5="Content-Type",c5="Accept",u5="X-Request-URL",h5="text/plain",p5="application/json",WK=`${p5}, ${h5}, */*`,q_=class i{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(t,e,n,s){this.url=e,this.method=t.toUpperCase();let r;if(GK(this.method)||s?(this.body=n!==void 0?n:null,r=s):r=n,r&&(this.reportProgress=!!r.reportProgress,this.withCredentials=!!r.withCredentials,r.responseType&&(this.responseType=r.responseType),r.headers&&(this.headers=r.headers),r.context&&(this.context=r.context),r.params&&(this.params=r.params),this.transferCache=r.transferCache),this.headers??=new cp,this.context??=new JE,!this.params)this.params=new ka,this.urlWithParams=e;else{let y=this.params.toString();if(y.length===0)this.urlWithParams=e;else{let A=e.indexOf("?"),P=A===-1?"?":A<e.length-1?"&":"";this.urlWithParams=e+P+y}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||o5(this.body)||a5(this.body)||s5(this.body)||qK(this.body)?this.body:this.body instanceof ka?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||s5(this.body)?null:a5(this.body)?this.body.type||null:o5(this.body)?null:typeof this.body=="string"?h5:this.body instanceof ka?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?p5:null}clone(t={}){let e=t.method||this.method,n=t.url||this.url,s=t.responseType||this.responseType,r=t.transferCache??this.transferCache,y=t.body!==void 0?t.body:this.body,A=t.withCredentials??this.withCredentials,P=t.reportProgress??this.reportProgress,B=t.headers||this.headers,U=t.params||this.params,J=t.context??this.context;return t.setHeaders!==void 0&&(B=Object.keys(t.setHeaders).reduce((le,re)=>le.set(re,t.setHeaders[re]),B)),t.setParams&&(U=Object.keys(t.setParams).reduce((le,re)=>le.set(re,t.setParams[re]),U)),new i(e,n,y,{params:U,headers:B,context:J,reportProgress:P,responseType:s,withCredentials:A,transferCache:r})}},_m=function(i){return i[i.Sent=0]="Sent",i[i.UploadProgress=1]="UploadProgress",i[i.ResponseHeader=2]="ResponseHeader",i[i.DownloadProgress=3]="DownloadProgress",i[i.Response=4]="Response",i[i.User=5]="User",i}(_m||{}),Y_=class{headers;status;statusText;url;ok;type;constructor(t,e=200,n="OK"){this.headers=t.headers||new cp,this.status=t.status!==void 0?t.status:e,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}},eS=class i extends Y_{constructor(t={}){super(t)}type=_m.ResponseHeader;clone(t={}){return new i({headers:t.headers||this.headers,status:t.status!==void 0?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}},Fb=class i extends Y_{body;constructor(t={}){super(t),this.body=t.body!==void 0?t.body:null}type=_m.Response;clone(t={}){return new i({body:t.body!==void 0?t.body:this.body,headers:t.headers||this.headers,status:t.status!==void 0?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}},Lb=class extends Y_{name="HttpErrorResponse";message;error;ok=!1;constructor(t){super(t,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${t.url||"(unknown url)"}`:this.message=`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}},YK=200,ZK=204;function Nk(i,t){return{body:t,headers:i.headers,context:i.context,observe:i.observe,params:i.params,reportProgress:i.reportProgress,responseType:i.responseType,withCredentials:i.withCredentials,transferCache:i.transferCache}}var zo=(()=>{class i{handler;constructor(e){this.handler=e}request(e,n,s={}){let r;if(e instanceof q_)r=e;else{let P;s.headers instanceof cp?P=s.headers:P=new cp(s.headers);let B;s.params&&(s.params instanceof ka?B=s.params:B=new ka({fromObject:s.params})),r=new q_(e,n,s.body!==void 0?s.body:null,{headers:P,context:s.context,params:B,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let y=wi(r).pipe(Cd(P=>this.handler.handle(P)));if(e instanceof q_||s.observe==="events")return y;let A=y.pipe(dr(P=>P instanceof Fb));switch(s.observe||"body"){case"body":switch(r.responseType){case"arraybuffer":return A.pipe(Ui(P=>{if(P.body!==null&&!(P.body instanceof ArrayBuffer))throw new Mi(2806,!1);return P.body}));case"blob":return A.pipe(Ui(P=>{if(P.body!==null&&!(P.body instanceof Blob))throw new Mi(2807,!1);return P.body}));case"text":return A.pipe(Ui(P=>{if(P.body!==null&&typeof P.body!="string")throw new Mi(2808,!1);return P.body}));case"json":default:return A.pipe(Ui(P=>P.body))}case"response":return A;default:throw new Mi(2809,!1)}}delete(e,n={}){return this.request("DELETE",e,n)}get(e,n={}){return this.request("GET",e,n)}head(e,n={}){return this.request("HEAD",e,n)}jsonp(e,n){return this.request("JSONP",e,{params:new ka().append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,n={}){return this.request("OPTIONS",e,n)}patch(e,n,s={}){return this.request("PATCH",e,Nk(s,n))}post(e,n,s={}){return this.request("POST",e,Nk(s,n))}put(e,n,s={}){return this.request("PUT",e,Nk(s,n))}static \u0275fac=function(n){return new(n||i)(hi(W_))};static \u0275prov=Mt({token:i,factory:i.\u0275fac})}return i})();var XK=new Dt("");function f5(i,t){return t(i)}function KK(i,t){return(e,n)=>t.intercept(e,{handle:s=>i(s,n)})}function QK(i,t,e){return(n,s)=>Zs(e,()=>t(n,r=>i(r,s)))}var iS=new Dt(""),Bk=new Dt(""),m5=new Dt(""),Vk=new Dt("",{providedIn:"root",factory:()=>!0});function JK(){let i=null;return(t,e)=>{i===null&&(i=(Z(iS,{optional:!0})??[]).reduceRight(KK,f5));let n=Z(Mu);if(Z(Vk)){let r=n.add();return i(t,e).pipe(jl(()=>n.remove(r)))}else return i(t,e)}}var tS=(()=>{class i extends W_{backend;injector;chain=null;pendingTasks=Z(Mu);contributeToStability=Z(Vk);constructor(e,n){super(),this.backend=e,this.injector=n}handle(e){if(this.chain===null){let n=Array.from(new Set([...this.injector.get(Bk),...this.injector.get(m5,[])]));this.chain=n.reduceRight((s,r)=>QK(s,r,this.injector),f5)}if(this.contributeToStability){let n=this.pendingTasks.add();return this.chain(e,s=>this.backend.handle(s)).pipe(jl(()=>this.pendingTasks.remove(n)))}else return this.chain(e,n=>this.backend.handle(n))}static \u0275fac=function(n){return new(n||i)(hi(Ob),hi(Fo))};static \u0275prov=Mt({token:i,factory:i.\u0275fac})}return i})();var eQ=/^\)\]\}',?\n/,tQ=RegExp(`^${u5}:`,"m");function iQ(i){return"responseURL"in i&&i.responseURL?i.responseURL:tQ.test(i.getAllResponseHeaders())?i.getResponseHeader(u5):null}var zk=(()=>{class i{xhrFactory;constructor(e){this.xhrFactory=e}handle(e){if(e.method==="JSONP")throw new Mi(-2800,!1);let n=this.xhrFactory;return(n.\u0275loadImpl?zr(n.\u0275loadImpl()):wi(null)).pipe(Oo(()=>new Yn(r=>{let y=n.build();if(y.open(e.method,e.urlWithParams),e.withCredentials&&(y.withCredentials=!0),e.headers.forEach((ee,we)=>y.setRequestHeader(ee,we.join(","))),e.headers.has(c5)||y.setRequestHeader(c5,WK),!e.headers.has(l5)){let ee=e.detectContentTypeHeader();ee!==null&&y.setRequestHeader(l5,ee)}if(e.responseType){let ee=e.responseType.toLowerCase();y.responseType=ee!=="json"?ee:"text"}let A=e.serializeBody(),P=null,B=()=>{if(P!==null)return P;let ee=y.statusText||"OK",we=new cp(y.getAllResponseHeaders()),Re=iQ(y)||e.url;return P=new eS({headers:we,status:y.status,statusText:ee,url:Re}),P},U=()=>{let{headers:ee,status:we,statusText:Re,url:Ce}=B(),Te=null;we!==ZK&&(Te=typeof y.response>"u"?y.responseText:y.response),we===0&&(we=Te?YK:0);let Xe=we>=200&&we<300;if(e.responseType==="json"&&typeof Te=="string"){let et=Te;Te=Te.replace(eQ,"");try{Te=Te!==""?JSON.parse(Te):null}catch(Pt){Te=et,Xe&&(Xe=!1,Te={error:Pt,text:Te})}}Xe?(r.next(new Fb({body:Te,headers:ee,status:we,statusText:Re,url:Ce||void 0})),r.complete()):r.error(new Lb({error:Te,headers:ee,status:we,statusText:Re,url:Ce||void 0}))},J=ee=>{let{url:we}=B(),Re=new Lb({error:ee,status:y.status||0,statusText:y.statusText||"Unknown Error",url:we||void 0});r.error(Re)},le=!1,re=ee=>{le||(r.next(B()),le=!0);let we={type:_m.DownloadProgress,loaded:ee.loaded};ee.lengthComputable&&(we.total=ee.total),e.responseType==="text"&&y.responseText&&(we.partialText=y.responseText),r.next(we)},X=ee=>{let we={type:_m.UploadProgress,loaded:ee.loaded};ee.lengthComputable&&(we.total=ee.total),r.next(we)};return y.addEventListener("load",U),y.addEventListener("error",J),y.addEventListener("timeout",J),y.addEventListener("abort",J),e.reportProgress&&(y.addEventListener("progress",re),A!==null&&y.upload&&y.upload.addEventListener("progress",X)),y.send(A),r.next({type:_m.Sent}),()=>{y.removeEventListener("error",J),y.removeEventListener("abort",J),y.removeEventListener("load",U),y.removeEventListener("timeout",J),e.reportProgress&&(y.removeEventListener("progress",re),A!==null&&y.upload&&y.upload.removeEventListener("progress",X)),y.readyState!==y.DONE&&y.abort()}})))}static \u0275fac=function(n){return new(n||i)(hi(gm))};static \u0275prov=Mt({token:i,factory:i.\u0275fac})}return i})(),g5=new Dt(""),nQ="XSRF-TOKEN",rQ=new Dt("",{providedIn:"root",factory:()=>nQ}),oQ="X-XSRF-TOKEN",aQ=new Dt("",{providedIn:"root",factory:()=>oQ}),Nb=class{},sQ=(()=>{class i{doc;platform;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(e,n,s){this.doc=e,this.platform=n,this.cookieName=s}getToken(){if(this.platform==="server")return null;let e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=Ib(e,this.cookieName),this.lastCookieString=e),this.lastToken}static \u0275fac=function(n){return new(n||i)(hi(Ki),hi(as),hi(rQ))};static \u0275prov=Mt({token:i,factory:i.\u0275fac})}return i})();function lQ(i,t){let e=i.url.toLowerCase();if(!Z(g5)||i.method==="GET"||i.method==="HEAD"||e.startsWith("http://")||e.startsWith("https://"))return t(i);let n=Z(Nb).getToken(),s=Z(aQ);return n!=null&&!i.headers.has(s)&&(i=i.clone({headers:i.headers.set(s,n)})),t(i)}var jk=function(i){return i[i.Interceptors=0]="Interceptors",i[i.LegacyInterceptors=1]="LegacyInterceptors",i[i.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",i[i.NoXsrfProtection=3]="NoXsrfProtection",i[i.JsonpSupport=4]="JsonpSupport",i[i.RequestsMadeViaParent=5]="RequestsMadeViaParent",i[i.Fetch=6]="Fetch",i}(jk||{});function cQ(i,t){return{\u0275kind:i,\u0275providers:t}}function Uk(...i){let t=[zo,zk,tS,{provide:W_,useExisting:tS},{provide:Ob,useFactory:()=>Z(XK,{optional:!0})??Z(zk)},{provide:Bk,useValue:lQ,multi:!0},{provide:g5,useValue:!0},{provide:Nb,useClass:sQ}];for(let e of i)t.push(...e.\u0275providers);return k_(t)}var d5=new Dt("");function Hk(){return cQ(jk.LegacyInterceptors,[{provide:d5,useFactory:JK},{provide:Bk,useExisting:d5,multi:!0}])}var _5=(()=>{class i{_doc;constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}static \u0275fac=function(n){return new(n||i)(hi(Ki))};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var $k=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:function(n){let s=null;return n?s=new(n||i):s=hi(dQ),s},providedIn:"root"})}return i})(),dQ=(()=>{class i extends $k{_doc;constructor(e){super(),this._doc=e}sanitize(e,n){if(n==null)return null;switch(e){case ss.NONE:return n;case ss.HTML:return op(n,"HTML")?zc(n):tV(this._doc,String(n)).toString();case ss.STYLE:return op(n,"Style")?zc(n):n;case ss.SCRIPT:if(op(n,"Script"))return zc(n);throw new Mi(5200,!1);case ss.URL:return op(n,"URL")?zc(n):xE(String(n));case ss.RESOURCE_URL:if(op(n,"ResourceURL"))return zc(n);throw new Mi(5201,!1);default:throw new Mi(5202,!1)}}bypassSecurityTrustHtml(e){return GB(e)}bypassSecurityTrustStyle(e){return qB(e)}bypassSecurityTrustScript(e){return WB(e)}bypassSecurityTrustUrl(e){return YB(e)}bypassSecurityTrustResourceUrl(e){return ZB(e)}static \u0275fac=function(n){return new(n||i)(hi(Ki))};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Wn="primary",Xb=Symbol("RouteTitle"),Zk=class{params;constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){let e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){let e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}};function bm(i){return new Zk(i)}function D5(i,t,e){let n=e.path.split("/");if(n.length>i.length||e.pathMatch==="full"&&(t.hasChildren()||n.length<i.length))return null;let s={};for(let r=0;r<n.length;r++){let y=n[r],A=i[r];if(y[0]===":")s[y.substring(1)]=A;else if(y!==A.path)return null}return{consumed:i.slice(0,n.length),posParams:s}}function uQ(i,t){if(i.length!==t.length)return!1;for(let e=0;e<i.length;++e)if(!Ld(i[e],t[e]))return!1;return!0}function Ld(i,t){let e=i?Xk(i):void 0,n=t?Xk(t):void 0;if(!e||!n||e.length!=n.length)return!1;let s;for(let r=0;r<e.length;r++)if(s=e[r],!M5(i[s],t[s]))return!1;return!0}function Xk(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}function M5(i,t){if(Array.isArray(i)&&Array.isArray(t)){if(i.length!==t.length)return!1;let e=[...i].sort(),n=[...t].sort();return e.every((s,r)=>n[r]===s)}else return i===t}function T5(i){return i.length>0?i[i.length-1]:null}function fp(i){return p_(i)?i:ap(i)?zr(Promise.resolve(i)):wi(i)}var hQ={exact:A5,subset:R5},I5={exact:pQ,subset:fQ,ignored:()=>!0};function v5(i,t,e){return hQ[e.paths](i.root,t.root,e.matrixParams)&&I5[e.queryParams](i.queryParams,t.queryParams)&&!(e.fragment==="exact"&&i.fragment!==t.fragment)}function pQ(i,t){return Ld(i,t)}function A5(i,t,e){if(!ym(i.segments,t.segments)||!oS(i.segments,t.segments,e)||i.numberOfChildren!==t.numberOfChildren)return!1;for(let n in t.children)if(!i.children[n]||!A5(i.children[n],t.children[n],e))return!1;return!0}function fQ(i,t){return Object.keys(t).length<=Object.keys(i).length&&Object.keys(t).every(e=>M5(i[e],t[e]))}function R5(i,t,e){return k5(i,t,t.segments,e)}function k5(i,t,e,n){if(i.segments.length>e.length){let s=i.segments.slice(0,e.length);return!(!ym(s,e)||t.hasChildren()||!oS(s,e,n))}else if(i.segments.length===e.length){if(!ym(i.segments,e)||!oS(i.segments,e,n))return!1;for(let s in t.children)if(!i.children[s]||!R5(i.children[s],t.children[s],n))return!1;return!0}else{let s=e.slice(0,i.segments.length),r=e.slice(i.segments.length);return!ym(i.segments,s)||!oS(i.segments,s,n)||!i.children[Wn]?!1:k5(i.children[Wn],t,r,n)}}function oS(i,t,e){return t.every((n,s)=>I5[e](i[s].parameters,n.parameters))}var zd=class{root;queryParams;fragment;_queryParamMap;constructor(t=new Tr([],{}),e={},n=null){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap??=bm(this.queryParams),this._queryParamMap}toString(){return _Q.serialize(this)}},Tr=class{segments;children;parent=null;constructor(t,e){this.segments=t,this.children=e,Object.values(e).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return aS(this)}},dp=class{path;parameters;_parameterMap;constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap??=bm(this.parameters),this._parameterMap}toString(){return O5(this)}};function mQ(i,t){return ym(i,t)&&i.every((e,n)=>Ld(e.parameters,t[n].parameters))}function ym(i,t){return i.length!==t.length?!1:i.every((e,n)=>e.path===t[n].path)}function gQ(i,t){let e=[];return Object.entries(i.children).forEach(([n,s])=>{n===Wn&&(e=e.concat(t(s,n)))}),Object.entries(i.children).forEach(([n,s])=>{n!==Wn&&(e=e.concat(t(s,n)))}),e}var xm=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:()=>new up,providedIn:"root"})}return i})(),up=class{parse(t){let e=new Qk(t);return new zd(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){let e=`/${zb(t.root,!0)}`,n=bQ(t.queryParams),s=typeof t.fragment=="string"?`#${yQ(t.fragment)}`:"";return`${e}${n}${s}`}},_Q=new up;function aS(i){return i.segments.map(t=>O5(t)).join("/")}function zb(i,t){if(!i.hasChildren())return aS(i);if(t){let e=i.children[Wn]?zb(i.children[Wn],!1):"",n=[];return Object.entries(i.children).forEach(([s,r])=>{s!==Wn&&n.push(`${s}:${zb(r,!1)}`)}),n.length>0?`${e}(${n.join("//")})`:e}else{let e=gQ(i,(n,s)=>s===Wn?[zb(i.children[Wn],!1)]:[`${s}:${zb(n,!1)}`]);return Object.keys(i.children).length===1&&i.children[Wn]!=null?`${aS(i)}/${e[0]}`:`${aS(i)}/(${e.join("//")})`}}function P5(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function nS(i){return P5(i).replace(/%3B/gi,";")}function yQ(i){return encodeURI(i)}function Kk(i){return P5(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function sS(i){return decodeURIComponent(i)}function b5(i){return sS(i.replace(/\+/g,"%20"))}function O5(i){return`${Kk(i.path)}${vQ(i.parameters)}`}function vQ(i){return Object.entries(i).map(([t,e])=>`;${Kk(t)}=${Kk(e)}`).join("")}function bQ(i){let t=Object.entries(i).map(([e,n])=>Array.isArray(n)?n.map(s=>`${nS(e)}=${nS(s)}`).join("&"):`${nS(e)}=${nS(n)}`).filter(e=>e);return t.length?`?${t.join("&")}`:""}var xQ=/^[^\/()?;#]+/;function Gk(i){let t=i.match(xQ);return t?t[0]:""}var wQ=/^[^\/()?;=#]+/;function CQ(i){let t=i.match(wQ);return t?t[0]:""}var EQ=/^[^=?&#]+/;function SQ(i){let t=i.match(EQ);return t?t[0]:""}var DQ=/^[^&#]+/;function MQ(i){let t=i.match(DQ);return t?t[0]:""}var Qk=class{url;remaining;constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Tr([],{}):new Tr([],this.parseChildren())}parseQueryParams(){let t={};if(this.consumeOptional("?"))do this.parseQueryParam(t);while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n[Wn]=new Tr(t,e)),n}parseSegment(){let t=Gk(this.remaining);if(t===""&&this.peekStartsWith(";"))throw new Mi(4009,!1);return this.capture(t),new dp(sS(t),this.parseMatrixParams())}parseMatrixParams(){let t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){let e=CQ(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){let s=Gk(this.remaining);s&&(n=s,this.capture(n))}t[sS(e)]=sS(n)}parseQueryParam(t){let e=SQ(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){let y=MQ(this.remaining);y&&(n=y,this.capture(n))}let s=b5(e),r=b5(n);if(t.hasOwnProperty(s)){let y=t[s];Array.isArray(y)||(y=[y],t[s]=y),y.push(r)}else t[s]=r}parseParens(t){let e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let n=Gk(this.remaining),s=this.remaining[n.length];if(s!=="/"&&s!==")"&&s!==";")throw new Mi(4010,!1);let r;n.indexOf(":")>-1?(r=n.slice(0,n.indexOf(":")),this.capture(r),this.capture(":")):t&&(r=Wn);let y=this.parseChildren();e[r]=Object.keys(y).length===1?y[Wn]:new Tr([],y),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return this.peekStartsWith(t)?(this.remaining=this.remaining.substring(t.length),!0):!1}capture(t){if(!this.consumeOptional(t))throw new Mi(4011,!1)}};function F5(i){return i.segments.length>0?new Tr([],{[Wn]:i}):i}function L5(i){let t={};for(let[n,s]of Object.entries(i.children)){let r=L5(s);if(n===Wn&&r.segments.length===0&&r.hasChildren())for(let[y,A]of Object.entries(r.children))t[y]=A;else(r.segments.length>0||r.hasChildren())&&(t[n]=r)}let e=new Tr(i.segments,t);return TQ(e)}function TQ(i){if(i.numberOfChildren===1&&i.children[Wn]){let t=i.children[Wn];return new Tr(i.segments.concat(t.segments),t.children)}return i}function hp(i){return i instanceof zd}function N5(i,t,e=null,n=null){let s=z5(i);return B5(s,t,e,n)}function z5(i){let t;function e(r){let y={};for(let P of r.children){let B=e(P);y[P.outlet]=B}let A=new Tr(r.url,y);return r===i&&(t=A),A}let n=e(i.root),s=F5(n);return t??s}function B5(i,t,e,n){let s=i;for(;s.parent;)s=s.parent;if(t.length===0)return qk(s,s,s,e,n);let r=IQ(t);if(r.toRoot())return qk(s,s,new Tr([],{}),e,n);let y=AQ(r,s,i),A=y.processChildren?Vb(y.segmentGroup,y.index,r.commands):j5(y.segmentGroup,y.index,r.commands);return qk(s,y.segmentGroup,A,e,n)}function cS(i){return typeof i=="object"&&i!=null&&!i.outlets&&!i.segmentPath}function Ub(i){return typeof i=="object"&&i!=null&&i.outlets}function qk(i,t,e,n,s){let r={};n&&Object.entries(n).forEach(([P,B])=>{r[P]=Array.isArray(B)?B.map(U=>`${U}`):`${B}`});let y;i===t?y=e:y=V5(i,t,e);let A=F5(L5(y));return new zd(A,r,s)}function V5(i,t,e){let n={};return Object.entries(i.children).forEach(([s,r])=>{r===t?n[s]=e:n[s]=V5(r,t,e)}),new Tr(i.segments,n)}var dS=class{isAbsolute;numberOfDoubleDots;commands;constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&cS(n[0]))throw new Mi(4003,!1);let s=n.find(Ub);if(s&&s!==T5(n))throw new Mi(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function IQ(i){if(typeof i[0]=="string"&&i.length===1&&i[0]==="/")return new dS(!0,0,i);let t=0,e=!1,n=i.reduce((s,r,y)=>{if(typeof r=="object"&&r!=null){if(r.outlets){let A={};return Object.entries(r.outlets).forEach(([P,B])=>{A[P]=typeof B=="string"?B.split("/"):B}),[...s,{outlets:A}]}if(r.segmentPath)return[...s,r.segmentPath]}return typeof r!="string"?[...s,r]:y===0?(r.split("/").forEach((A,P)=>{P==0&&A==="."||(P==0&&A===""?e=!0:A===".."?t++:A!=""&&s.push(A))}),s):[...s,r]},[]);return new dS(e,t,n)}var K_=class{segmentGroup;processChildren;index;constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}};function AQ(i,t,e){if(i.isAbsolute)return new K_(t,!0,0);if(!e)return new K_(t,!1,NaN);if(e.parent===null)return new K_(e,!0,0);let n=cS(i.commands[0])?0:1,s=e.segments.length-1+n;return RQ(e,s,i.numberOfDoubleDots)}function RQ(i,t,e){let n=i,s=t,r=e;for(;r>s;){if(r-=s,n=n.parent,!n)throw new Mi(4005,!1);s=n.segments.length}return new K_(n,!1,s-r)}function kQ(i){return Ub(i[0])?i[0].outlets:{[Wn]:i}}function j5(i,t,e){if(i??=new Tr([],{}),i.segments.length===0&&i.hasChildren())return Vb(i,t,e);let n=PQ(i,t,e),s=e.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){let r=new Tr(i.segments.slice(0,n.pathIndex),{});return r.children[Wn]=new Tr(i.segments.slice(n.pathIndex),i.children),Vb(r,0,s)}else return n.match&&s.length===0?new Tr(i.segments,{}):n.match&&!i.hasChildren()?Jk(i,t,e):n.match?Vb(i,0,s):Jk(i,t,e)}function Vb(i,t,e){if(e.length===0)return new Tr(i.segments,{});{let n=kQ(e),s={};if(Object.keys(n).some(r=>r!==Wn)&&i.children[Wn]&&i.numberOfChildren===1&&i.children[Wn].segments.length===0){let r=Vb(i.children[Wn],t,e);return new Tr(i.segments,r.children)}return Object.entries(n).forEach(([r,y])=>{typeof y=="string"&&(y=[y]),y!==null&&(s[r]=j5(i.children[r],t,y))}),Object.entries(i.children).forEach(([r,y])=>{n[r]===void 0&&(s[r]=y)}),new Tr(i.segments,s)}}function PQ(i,t,e){let n=0,s=t,r={match:!1,pathIndex:0,commandIndex:0};for(;s<i.segments.length;){if(n>=e.length)return r;let y=i.segments[s],A=e[n];if(Ub(A))break;let P=`${A}`,B=n<e.length-1?e[n+1]:null;if(s>0&&P===void 0)break;if(P&&B&&typeof B=="object"&&B.outlets===void 0){if(!w5(P,B,y))return r;n+=2}else{if(!w5(P,{},y))return r;n++}s++}return{match:!0,pathIndex:s,commandIndex:n}}function Jk(i,t,e){let n=i.segments.slice(0,t),s=0;for(;s<e.length;){let r=e[s];if(Ub(r)){let P=OQ(r.outlets);return new Tr(n,P)}if(s===0&&cS(e[0])){let P=i.segments[t];n.push(new dp(P.path,x5(e[0]))),s++;continue}let y=Ub(r)?r.outlets[Wn]:`${r}`,A=s<e.length-1?e[s+1]:null;y&&A&&cS(A)?(n.push(new dp(y,x5(A))),s+=2):(n.push(new dp(y,{})),s++)}return new Tr(n,{})}function OQ(i){let t={};return Object.entries(i).forEach(([e,n])=>{typeof n=="string"&&(n=[n]),n!==null&&(t[e]=Jk(new Tr([],{}),0,n))}),t}function x5(i){let t={};return Object.entries(i).forEach(([e,n])=>t[e]=`${n}`),t}function w5(i,t,e){return i==e.path&&Ld(t,e.parameters)}var lS="imperative",Pa=function(i){return i[i.NavigationStart=0]="NavigationStart",i[i.NavigationEnd=1]="NavigationEnd",i[i.NavigationCancel=2]="NavigationCancel",i[i.NavigationError=3]="NavigationError",i[i.RoutesRecognized=4]="RoutesRecognized",i[i.ResolveStart=5]="ResolveStart",i[i.ResolveEnd=6]="ResolveEnd",i[i.GuardsCheckStart=7]="GuardsCheckStart",i[i.GuardsCheckEnd=8]="GuardsCheckEnd",i[i.RouteConfigLoadStart=9]="RouteConfigLoadStart",i[i.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",i[i.ChildActivationStart=11]="ChildActivationStart",i[i.ChildActivationEnd=12]="ChildActivationEnd",i[i.ActivationStart=13]="ActivationStart",i[i.ActivationEnd=14]="ActivationEnd",i[i.Scroll=15]="Scroll",i[i.NavigationSkipped=16]="NavigationSkipped",i}(Pa||{}),Sl=class{id;url;constructor(t,e){this.id=t,this.url=e}},pp=class extends Sl{type=Pa.NavigationStart;navigationTrigger;restoredState;constructor(t,e,n="imperative",s=null){super(t,e),this.navigationTrigger=n,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Zl=class extends Sl{urlAfterRedirects;type=Pa.NavigationEnd;constructor(t,e,n){super(t,e),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},il=function(i){return i[i.Redirect=0]="Redirect",i[i.SupersededByNewNavigation=1]="SupersededByNewNavigation",i[i.NoDataFromResolver=2]="NoDataFromResolver",i[i.GuardRejected=3]="GuardRejected",i}(il||{}),J_=function(i){return i[i.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",i[i.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",i}(J_||{}),Nd=class extends Sl{reason;code;type=Pa.NavigationCancel;constructor(t,e,n,s){super(t,e),this.reason=n,this.code=s}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Bd=class extends Sl{reason;code;type=Pa.NavigationSkipped;constructor(t,e,n,s){super(t,e),this.reason=n,this.code=s}},ey=class extends Sl{error;target;type=Pa.NavigationError;constructor(t,e,n,s){super(t,e),this.error=n,this.target=s}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Hb=class extends Sl{urlAfterRedirects;state;type=Pa.RoutesRecognized;constructor(t,e,n,s){super(t,e),this.urlAfterRedirects=n,this.state=s}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},uS=class extends Sl{urlAfterRedirects;state;type=Pa.GuardsCheckStart;constructor(t,e,n,s){super(t,e),this.urlAfterRedirects=n,this.state=s}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},hS=class extends Sl{urlAfterRedirects;state;shouldActivate;type=Pa.GuardsCheckEnd;constructor(t,e,n,s,r){super(t,e),this.urlAfterRedirects=n,this.state=s,this.shouldActivate=r}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},pS=class extends Sl{urlAfterRedirects;state;type=Pa.ResolveStart;constructor(t,e,n,s){super(t,e),this.urlAfterRedirects=n,this.state=s}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},fS=class extends Sl{urlAfterRedirects;state;type=Pa.ResolveEnd;constructor(t,e,n,s){super(t,e),this.urlAfterRedirects=n,this.state=s}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},mS=class{route;type=Pa.RouteConfigLoadStart;constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},gS=class{route;type=Pa.RouteConfigLoadEnd;constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},_S=class{snapshot;type=Pa.ChildActivationStart;constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},yS=class{snapshot;type=Pa.ChildActivationEnd;constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},vS=class{snapshot;type=Pa.ActivationStart;constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},bS=class{snapshot;type=Pa.ActivationEnd;constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ty=class{routerEvent;position;anchor;type=Pa.Scroll;constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n}toString(){let t=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${t}')`}},$b=class{},iy=class{url;navigationBehaviorOptions;constructor(t,e){this.url=t,this.navigationBehaviorOptions=e}};function FQ(i,t){return i.providers&&!i._injector&&(i._injector=_b(i.providers,t,`Route: ${i.path}`)),i._injector??t}function Hc(i){return i.outlet||Wn}function LQ(i,t){let e=i.filter(n=>Hc(n)===t);return e.push(...i.filter(n=>Hc(n)!==t)),e}function Kb(i){if(!i)return null;if(i.routeConfig?._injector)return i.routeConfig._injector;for(let t=i.parent;t;t=t.parent){let e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}var xS=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return Kb(this.route?.snapshot)??this.rootInjector}constructor(t){this.rootInjector=t,this.children=new wm(this.rootInjector)}},wm=(()=>{class i{rootInjector;contexts=new Map;constructor(e){this.rootInjector=e}onChildOutletCreated(e,n){let s=this.getOrCreateContext(e);s.outlet=n,this.contexts.set(e,s)}onChildOutletDestroyed(e){let n=this.getContext(e);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){let e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let n=this.getContext(e);return n||(n=new xS(this.rootInjector),this.contexts.set(e,n)),n}getContext(e){return this.contexts.get(e)||null}static \u0275fac=function(n){return new(n||i)(hi(Fo))};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),wS=class{_root;constructor(t){this._root=t}get root(){return this._root.value}parent(t){let e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){let e=e2(t,this._root);return e?e.children.map(n=>n.value):[]}firstChild(t){let e=e2(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){let e=t2(t,this._root);return e.length<2?[]:e[e.length-2].children.map(s=>s.value).filter(s=>s!==t)}pathFromRoot(t){return t2(t,this._root).map(e=>e.value)}};function e2(i,t){if(i===t.value)return t;for(let e of t.children){let n=e2(i,e);if(n)return n}return null}function t2(i,t){if(i===t.value)return[t];for(let e of t.children){let n=t2(i,e);if(n.length)return n.unshift(t),n}return[]}var El=class{value;children;constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}};function X_(i){let t={};return i&&i.children.forEach(e=>t[e.value.outlet]=e),t}var Gb=class extends wS{snapshot;constructor(t,e){super(t),this.snapshot=e,c2(this,t)}toString(){return this.snapshot.toString()}};function U5(i){let t=NQ(i),e=new Cr([new dp("",{})]),n=new Cr({}),s=new Cr({}),r=new Cr({}),y=new Cr(""),A=new nl(e,n,r,y,s,Wn,i,t.root);return A.snapshot=t.root,new Gb(new El(A,[]),t)}function NQ(i){let t={},e={},n={},s="",r=new vm([],t,n,s,e,Wn,i,null,{});return new qb("",new El(r,[]))}var nl=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(t,e,n,s,r,y,A,P){this.urlSubject=t,this.paramsSubject=e,this.queryParamsSubject=n,this.fragmentSubject=s,this.dataSubject=r,this.outlet=y,this.component=A,this._futureSnapshot=P,this.title=this.dataSubject?.pipe(Ui(B=>B[Xb]))??wi(void 0),this.url=t,this.params=e,this.queryParams=n,this.fragment=s,this.data=r}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Ui(t=>bm(t))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Ui(t=>bm(t))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function CS(i,t,e="emptyOnly"){let n,{routeConfig:s}=i;return t!==null&&(e==="always"||s?.path===""||!t.component&&!t.routeConfig?.loadComponent)?n={params:Ct(Ct({},t.params),i.params),data:Ct(Ct({},t.data),i.data),resolve:Ct(Ct(Ct(Ct({},i.data),t.data),s?.data),i._resolvedData)}:n={params:Ct({},i.params),data:Ct({},i.data),resolve:Ct(Ct({},i.data),i._resolvedData??{})},s&&$5(s)&&(n.resolve[Xb]=s.title),n}var vm=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Xb]}constructor(t,e,n,s,r,y,A,P,B){this.url=t,this.params=e,this.queryParams=n,this.fragment=s,this.data=r,this.outlet=y,this.component=A,this.routeConfig=P,this._resolve=B}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=bm(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=bm(this.queryParams),this._queryParamMap}toString(){let t=this.url.map(n=>n.toString()).join("/"),e=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${t}', path:'${e}')`}},qb=class extends wS{url;constructor(t,e){super(e),this.url=t,c2(this,e)}toString(){return H5(this._root)}};function c2(i,t){t.value._routerState=i,t.children.forEach(e=>c2(i,e))}function H5(i){let t=i.children.length>0?` { ${i.children.map(H5).join(", ")} } `:"";return`${i.value}${t}`}function Wk(i){if(i.snapshot){let t=i.snapshot,e=i._futureSnapshot;i.snapshot=e,Ld(t.queryParams,e.queryParams)||i.queryParamsSubject.next(e.queryParams),t.fragment!==e.fragment&&i.fragmentSubject.next(e.fragment),Ld(t.params,e.params)||i.paramsSubject.next(e.params),uQ(t.url,e.url)||i.urlSubject.next(e.url),Ld(t.data,e.data)||i.dataSubject.next(e.data)}else i.snapshot=i._futureSnapshot,i.dataSubject.next(i._futureSnapshot.data)}function i2(i,t){let e=Ld(i.params,t.params)&&mQ(i.url,t.url),n=!i.parent!=!t.parent;return e&&!n&&(!i.parent||i2(i.parent,t.parent))}function $5(i){return typeof i.title=="string"||i.title===null}var G5=new Dt(""),Qb=(()=>{class i{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Wn;activateEvents=new ui;deactivateEvents=new ui;attachEvents=new ui;detachEvents=new ui;routerOutletData=AB(void 0);parentContexts=Z(wm);location=Z(yo);changeDetector=Z($n);inputBinder=Z(Jb,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(e){if(e.name){let{firstChange:n,previousValue:s}=e.name;if(n)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Mi(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Mi(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Mi(4012,!1);this.location.detach();let e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,n){this.activated=e,this._activatedRoute=n,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){let e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,n){if(this.isActivated)throw new Mi(4013,!1);this._activatedRoute=e;let s=this.location,y=e.snapshot.component,A=this.parentContexts.getOrCreateContext(this.name).children,P=new n2(e,A,s.injector,this.routerOutletData);this.activated=s.createComponent(y,{index:s.length,injector:P,environmentInjector:n}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[fr]})}return i})(),n2=class{route;childContexts;parent;outletData;constructor(t,e,n,s){this.route=t,this.childContexts=e,this.parent=n,this.outletData=s}get(t,e){return t===nl?this.route:t===wm?this.childContexts:t===G5?this.outletData:this.parent.get(t,e)}},Jb=new Dt(""),d2=(()=>{class i{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(e){this.unsubscribeFromRouteData(e),this.subscribeToRouteData(e)}unsubscribeFromRouteData(e){this.outletDataSubscriptions.get(e)?.unsubscribe(),this.outletDataSubscriptions.delete(e)}subscribeToRouteData(e){let{activatedRoute:n}=e,s=Zf([n.queryParams,n.params,n.data]).pipe(Oo(([r,y,A],P)=>(A=Ct(Ct(Ct({},r),y),A),P===0?wi(A):Promise.resolve(A)))).subscribe(r=>{if(!e.isActivated||!e.activatedComponentRef||e.activatedRoute!==n||n.component===null){this.unsubscribeFromRouteData(e);return}let y=S4(n.component);if(!y){this.unsubscribeFromRouteData(e);return}for(let{templateName:A}of y.inputs)e.activatedComponentRef.setInput(A,r[A])});this.outletDataSubscriptions.set(e,s)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac})}return i})();function zQ(i,t,e){let n=Wb(i,t._root,e?e._root:void 0);return new Gb(n,t)}function Wb(i,t,e){if(e&&i.shouldReuseRoute(t.value,e.value.snapshot)){let n=e.value;n._futureSnapshot=t.value;let s=BQ(i,t,e);return new El(n,s)}else{if(i.shouldAttach(t.value)){let r=i.retrieve(t.value);if(r!==null){let y=r.route;return y.value._futureSnapshot=t.value,y.children=t.children.map(A=>Wb(i,A)),y}}let n=VQ(t.value),s=t.children.map(r=>Wb(i,r));return new El(n,s)}}function BQ(i,t,e){return t.children.map(n=>{for(let s of e.children)if(i.shouldReuseRoute(n.value,s.value.snapshot))return Wb(i,n,s);return Wb(i,n)})}function VQ(i){return new nl(new Cr(i.url),new Cr(i.params),new Cr(i.queryParams),new Cr(i.fragment),new Cr(i.data),i.outlet,i.component,i)}var ny=class{redirectTo;navigationBehaviorOptions;constructor(t,e){this.redirectTo=t,this.navigationBehaviorOptions=e}},q5="ngNavigationCancelingError";function ES(i,t){let{redirectTo:e,navigationBehaviorOptions:n}=hp(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,s=W5(!1,il.Redirect);return s.url=e,s.navigationBehaviorOptions=n,s}function W5(i,t){let e=new Error(`NavigationCancelingError: ${i||""}`);return e[q5]=!0,e.cancellationCode=t,e}function jQ(i){return Y5(i)&&hp(i.url)}function Y5(i){return!!i&&i[q5]}var UQ=(i,t,e,n)=>Ui(s=>(new r2(t,s.targetRouterState,s.currentRouterState,e,n).activate(i),s)),r2=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(t,e,n,s,r){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=s,this.inputBindingEnabled=r}activate(t){let e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),Wk(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){let s=X_(e);t.children.forEach(r=>{let y=r.value.outlet;this.deactivateRoutes(r,s[y],n),delete s[y]}),Object.values(s).forEach(r=>{this.deactivateRouteAndItsChildren(r,n)})}deactivateRoutes(t,e,n){let s=t.value,r=e?e.value:null;if(s===r)if(s.component){let y=n.getContext(s.outlet);y&&this.deactivateChildRoutes(t,e,y.children)}else this.deactivateChildRoutes(t,e,n);else r&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){let n=e.getContext(t.value.outlet),s=n&&t.value.component?n.children:e,r=X_(t);for(let y of Object.values(r))this.deactivateRouteAndItsChildren(y,s);if(n&&n.outlet){let y=n.outlet.detach(),A=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:y,route:t,contexts:A})}}deactivateRouteAndOutlet(t,e){let n=e.getContext(t.value.outlet),s=n&&t.value.component?n.children:e,r=X_(t);for(let y of Object.values(r))this.deactivateRouteAndItsChildren(y,s);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(t,e,n){let s=X_(e);t.children.forEach(r=>{this.activateRoutes(r,s[r.value.outlet],n),this.forwardEvent(new bS(r.value.snapshot))}),t.children.length&&this.forwardEvent(new yS(t.value.snapshot))}activateRoutes(t,e,n){let s=t.value,r=e?e.value:null;if(Wk(s),s===r)if(s.component){let y=n.getOrCreateContext(s.outlet);this.activateChildRoutes(t,e,y.children)}else this.activateChildRoutes(t,e,n);else if(s.component){let y=n.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){let A=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),y.children.onOutletReAttached(A.contexts),y.attachRef=A.componentRef,y.route=A.route.value,y.outlet&&y.outlet.attach(A.componentRef,A.route.value),Wk(A.route.value),this.activateChildRoutes(t,null,y.children)}else y.attachRef=null,y.route=s,y.outlet&&y.outlet.activateWith(s,y.injector),this.activateChildRoutes(t,null,y.children)}else this.activateChildRoutes(t,null,n)}},SS=class{path;route;constructor(t){this.path=t,this.route=this.path[this.path.length-1]}},Q_=class{component;route;constructor(t,e){this.component=t,this.route=e}};function HQ(i,t,e){let n=i._root,s=t?t._root:null;return Bb(n,s,e,[n.value])}function $Q(i){let t=i.routeConfig?i.routeConfig.canActivateChild:null;return!t||t.length===0?null:{node:i,guards:t}}function oy(i,t){let e=Symbol(),n=t.get(i,e);return n===e?typeof i=="function"&&!Az(i)?i:t.get(i):n}function Bb(i,t,e,n,s={canDeactivateChecks:[],canActivateChecks:[]}){let r=X_(t);return i.children.forEach(y=>{GQ(y,r[y.value.outlet],e,n.concat([y.value]),s),delete r[y.value.outlet]}),Object.entries(r).forEach(([y,A])=>jb(A,e.getContext(y),s)),s}function GQ(i,t,e,n,s={canDeactivateChecks:[],canActivateChecks:[]}){let r=i.value,y=t?t.value:null,A=e?e.getContext(i.value.outlet):null;if(y&&r.routeConfig===y.routeConfig){let P=qQ(y,r,r.routeConfig.runGuardsAndResolvers);P?s.canActivateChecks.push(new SS(n)):(r.data=y.data,r._resolvedData=y._resolvedData),r.component?Bb(i,t,A?A.children:null,n,s):Bb(i,t,e,n,s),P&&A&&A.outlet&&A.outlet.isActivated&&s.canDeactivateChecks.push(new Q_(A.outlet.component,y))}else y&&jb(t,A,s),s.canActivateChecks.push(new SS(n)),r.component?Bb(i,null,A?A.children:null,n,s):Bb(i,null,e,n,s);return s}function qQ(i,t,e){if(typeof e=="function")return e(i,t);switch(e){case"pathParamsChange":return!ym(i.url,t.url);case"pathParamsOrQueryParamsChange":return!ym(i.url,t.url)||!Ld(i.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!i2(i,t)||!Ld(i.queryParams,t.queryParams);case"paramsChange":default:return!i2(i,t)}}function jb(i,t,e){let n=X_(i),s=i.value;Object.entries(n).forEach(([r,y])=>{s.component?t?jb(y,t.children.getContext(r),e):jb(y,null,e):jb(y,t,e)}),s.component?t&&t.outlet&&t.outlet.isActivated?e.canDeactivateChecks.push(new Q_(t.outlet.component,s)):e.canDeactivateChecks.push(new Q_(null,s)):e.canDeactivateChecks.push(new Q_(null,s))}function ex(i){return typeof i=="function"}function WQ(i){return typeof i=="boolean"}function YQ(i){return i&&ex(i.canLoad)}function ZQ(i){return i&&ex(i.canActivate)}function XQ(i){return i&&ex(i.canActivateChild)}function KQ(i){return i&&ex(i.canDeactivate)}function QQ(i){return i&&ex(i.canMatch)}function Z5(i){return i instanceof _u||i?.name==="EmptyError"}var rS=Symbol("INITIAL_VALUE");function ry(){return Oo(i=>Zf(i.map(t=>t.pipe(mo(1),go(rS)))).pipe(Ui(t=>{for(let e of t)if(e!==!0){if(e===rS)return rS;if(e===!1||JQ(e))return e}return!0}),dr(t=>t!==rS),mo(1)))}function JQ(i){return hp(i)||i instanceof ny}function eJ(i,t){return qo(e=>{let{targetSnapshot:n,currentSnapshot:s,guards:{canActivateChecks:r,canDeactivateChecks:y}}=e;return y.length===0&&r.length===0?wi(Xi(Ct({},e),{guardsResult:!0})):tJ(y,n,s,i).pipe(qo(A=>A&&WQ(A)?iJ(n,r,i,t):wi(A)),Ui(A=>Xi(Ct({},e),{guardsResult:A})))})}function tJ(i,t,e,n){return zr(i).pipe(qo(s=>sJ(s.component,s.route,e,t,n)),yu(s=>s!==!0,!0))}function iJ(i,t,e,n){return zr(t).pipe(Cd(s=>Yh(rJ(s.route.parent,n),nJ(s.route,n),aJ(i,s.path,e),oJ(i,s.route,e))),yu(s=>s!==!0,!0))}function nJ(i,t){return i!==null&&t&&t(new vS(i)),wi(!0)}function rJ(i,t){return i!==null&&t&&t(new _S(i)),wi(!0)}function oJ(i,t,e){let n=t.routeConfig?t.routeConfig.canActivate:null;if(!n||n.length===0)return wi(!0);let s=n.map(r=>wd(()=>{let y=Kb(t)??e,A=oy(r,y),P=ZQ(A)?A.canActivate(t,i):Zs(y,()=>A(t,i));return fp(P).pipe(yu())}));return wi(s).pipe(ry())}function aJ(i,t,e){let n=t[t.length-1],r=t.slice(0,t.length-1).reverse().map(y=>$Q(y)).filter(y=>y!==null).map(y=>wd(()=>{let A=y.guards.map(P=>{let B=Kb(y.node)??e,U=oy(P,B),J=XQ(U)?U.canActivateChild(n,i):Zs(B,()=>U(n,i));return fp(J).pipe(yu())});return wi(A).pipe(ry())}));return wi(r).pipe(ry())}function sJ(i,t,e,n,s){let r=t&&t.routeConfig?t.routeConfig.canDeactivate:null;if(!r||r.length===0)return wi(!0);let y=r.map(A=>{let P=Kb(t)??s,B=oy(A,P),U=KQ(B)?B.canDeactivate(i,t,e,n):Zs(P,()=>B(i,t,e,n));return fp(U).pipe(yu())});return wi(y).pipe(ry())}function lJ(i,t,e,n){let s=t.canLoad;if(s===void 0||s.length===0)return wi(!0);let r=s.map(y=>{let A=oy(y,i),P=YQ(A)?A.canLoad(t,e):Zs(i,()=>A(t,e));return fp(P)});return wi(r).pipe(ry(),X5(n))}function X5(i){return zI(Gn(t=>{if(typeof t!="boolean")throw ES(i,t)}),Ui(t=>t===!0))}function cJ(i,t,e,n){let s=t.canMatch;if(!s||s.length===0)return wi(!0);let r=s.map(y=>{let A=oy(y,i),P=QQ(A)?A.canMatch(t,e):Zs(i,()=>A(t,e));return fp(P)});return wi(r).pipe(ry(),X5(n))}var Yb=class{segmentGroup;constructor(t){this.segmentGroup=t||null}},Zb=class extends Error{urlTree;constructor(t){super(),this.urlTree=t}};function Z_(i){return lo(new Yb(i))}function dJ(i){return lo(new Mi(4e3,!1))}function uJ(i){return lo(W5(!1,il.GuardRejected))}var o2=class{urlSerializer;urlTree;constructor(t,e){this.urlSerializer=t,this.urlTree=e}lineralizeSegments(t,e){let n=[],s=e.root;for(;;){if(n=n.concat(s.segments),s.numberOfChildren===0)return wi(n);if(s.numberOfChildren>1||!s.children[Wn])return dJ(`${t.redirectTo}`);s=s.children[Wn]}}applyRedirectCommands(t,e,n,s,r){if(typeof e!="string"){let A=e,{queryParams:P,fragment:B,routeConfig:U,url:J,outlet:le,params:re,data:X,title:ee}=s,we=Zs(r,()=>A({params:re,data:X,queryParams:P,fragment:B,routeConfig:U,url:J,outlet:le,title:ee}));if(we instanceof zd)throw new Zb(we);e=we}let y=this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,n);if(e[0]==="/")throw new Zb(y);return y}applyRedirectCreateUrlTree(t,e,n,s){let r=this.createSegmentGroup(t,e.root,n,s);return new zd(r,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){let n={};return Object.entries(t).forEach(([s,r])=>{if(typeof r=="string"&&r[0]===":"){let A=r.substring(1);n[s]=e[A]}else n[s]=r}),n}createSegmentGroup(t,e,n,s){let r=this.createSegments(t,e.segments,n,s),y={};return Object.entries(e.children).forEach(([A,P])=>{y[A]=this.createSegmentGroup(t,P,n,s)}),new Tr(r,y)}createSegments(t,e,n,s){return e.map(r=>r.path[0]===":"?this.findPosParam(t,r,s):this.findOrReturn(r,n))}findPosParam(t,e,n){let s=n[e.path.substring(1)];if(!s)throw new Mi(4001,!1);return s}findOrReturn(t,e){let n=0;for(let s of e){if(s.path===t.path)return e.splice(n),s;n++}return t}},a2={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function hJ(i,t,e,n,s){let r=K5(i,t,e);return r.matched?(n=FQ(t,n),cJ(n,t,e,s).pipe(Ui(y=>y===!0?r:Ct({},a2)))):wi(r)}function K5(i,t,e){if(t.path==="**")return pJ(e);if(t.path==="")return t.pathMatch==="full"&&(i.hasChildren()||e.length>0)?Ct({},a2):{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};let s=(t.matcher||D5)(e,i,t);if(!s)return Ct({},a2);let r={};Object.entries(s.posParams??{}).forEach(([A,P])=>{r[A]=P.path});let y=s.consumed.length>0?Ct(Ct({},r),s.consumed[s.consumed.length-1].parameters):r;return{matched:!0,consumedSegments:s.consumed,remainingSegments:e.slice(s.consumed.length),parameters:y,positionalParamSegments:s.posParams??{}}}function pJ(i){return{matched:!0,parameters:i.length>0?T5(i).parameters:{},consumedSegments:i,remainingSegments:[],positionalParamSegments:{}}}function C5(i,t,e,n){return e.length>0&&gJ(i,e,n)?{segmentGroup:new Tr(t,mJ(n,new Tr(e,i.children))),slicedSegments:[]}:e.length===0&&_J(i,e,n)?{segmentGroup:new Tr(i.segments,fJ(i,e,n,i.children)),slicedSegments:e}:{segmentGroup:new Tr(i.segments,i.children),slicedSegments:e}}function fJ(i,t,e,n){let s={};for(let r of e)if(MS(i,t,r)&&!n[Hc(r)]){let y=new Tr([],{});s[Hc(r)]=y}return Ct(Ct({},n),s)}function mJ(i,t){let e={};e[Wn]=t;for(let n of i)if(n.path===""&&Hc(n)!==Wn){let s=new Tr([],{});e[Hc(n)]=s}return e}function gJ(i,t,e){return e.some(n=>MS(i,t,n)&&Hc(n)!==Wn)}function _J(i,t,e){return e.some(n=>MS(i,t,n))}function MS(i,t,e){return(i.hasChildren()||t.length>0)&&e.pathMatch==="full"?!1:e.path===""}function yJ(i,t,e){return t.length===0&&!i.children[e]}var s2=class{};function vJ(i,t,e,n,s,r,y="emptyOnly"){return new l2(i,t,e,n,s,y,r).recognize()}var bJ=31,l2=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(t,e,n,s,r,y,A){this.injector=t,this.configLoader=e,this.rootComponentType=n,this.config=s,this.urlTree=r,this.paramsInheritanceStrategy=y,this.urlSerializer=A,this.applyRedirects=new o2(this.urlSerializer,this.urlTree)}noMatchError(t){return new Mi(4002,`'${t.segmentGroup}'`)}recognize(){let t=C5(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(t).pipe(Ui(({children:e,rootSnapshot:n})=>{let s=new El(n,e),r=new qb("",s),y=N5(n,[],this.urlTree.queryParams,this.urlTree.fragment);return y.queryParams=this.urlTree.queryParams,r.url=this.urlSerializer.serialize(y),{state:r,tree:y}}))}match(t){let e=new vm([],Object.freeze({}),Object.freeze(Ct({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Wn,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,t,Wn,e).pipe(Ui(n=>({children:n,rootSnapshot:e})),tr(n=>{if(n instanceof Zb)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof Yb?this.noMatchError(n):n}))}processSegmentGroup(t,e,n,s,r){return n.segments.length===0&&n.hasChildren()?this.processChildren(t,e,n,r):this.processSegment(t,e,n,n.segments,s,!0,r).pipe(Ui(y=>y instanceof El?[y]:[]))}processChildren(t,e,n,s){let r=[];for(let y of Object.keys(n.children))y==="primary"?r.unshift(y):r.push(y);return zr(r).pipe(Cd(y=>{let A=n.children[y],P=LQ(e,y);return this.processSegmentGroup(t,P,A,y,s)}),$I((y,A)=>(y.push(...A),y)),Zh(null),HI(),qo(y=>{if(y===null)return Z_(n);let A=Q5(y);return xJ(A),wi(A)}))}processSegment(t,e,n,s,r,y,A){return zr(e).pipe(Cd(P=>this.processSegmentAgainstRoute(P._injector??t,e,P,n,s,r,y,A).pipe(tr(B=>{if(B instanceof Yb)return wi(null);throw B}))),yu(P=>!!P),tr(P=>{if(Z5(P))return yJ(n,s,r)?wi(new s2):Z_(n);throw P}))}processSegmentAgainstRoute(t,e,n,s,r,y,A,P){return Hc(n)!==y&&(y===Wn||!MS(s,r,n))?Z_(s):n.redirectTo===void 0?this.matchSegmentAgainstRoute(t,s,n,r,y,P):this.allowRedirects&&A?this.expandSegmentAgainstRouteUsingRedirect(t,s,e,n,r,y,P):Z_(s)}expandSegmentAgainstRouteUsingRedirect(t,e,n,s,r,y,A){let{matched:P,parameters:B,consumedSegments:U,positionalParamSegments:J,remainingSegments:le}=K5(e,s,r);if(!P)return Z_(e);typeof s.redirectTo=="string"&&s.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>bJ&&(this.allowRedirects=!1));let re=new vm(r,B,Object.freeze(Ct({},this.urlTree.queryParams)),this.urlTree.fragment,E5(s),Hc(s),s.component??s._loadedComponent??null,s,S5(s)),X=CS(re,A,this.paramsInheritanceStrategy);re.params=Object.freeze(X.params),re.data=Object.freeze(X.data);let ee=this.applyRedirects.applyRedirectCommands(U,s.redirectTo,J,re,t);return this.applyRedirects.lineralizeSegments(s,ee).pipe(qo(we=>this.processSegment(t,n,e,we.concat(le),y,!1,A)))}matchSegmentAgainstRoute(t,e,n,s,r,y){let A=hJ(e,n,s,t,this.urlSerializer);return n.path==="**"&&(e.children={}),A.pipe(Oo(P=>P.matched?(t=n._injector??t,this.getChildConfig(t,n,s).pipe(Oo(({routes:B})=>{let U=n._loadedInjector??t,{parameters:J,consumedSegments:le,remainingSegments:re}=P,X=new vm(le,J,Object.freeze(Ct({},this.urlTree.queryParams)),this.urlTree.fragment,E5(n),Hc(n),n.component??n._loadedComponent??null,n,S5(n)),ee=CS(X,y,this.paramsInheritanceStrategy);X.params=Object.freeze(ee.params),X.data=Object.freeze(ee.data);let{segmentGroup:we,slicedSegments:Re}=C5(e,le,re,B);if(Re.length===0&&we.hasChildren())return this.processChildren(U,B,we,X).pipe(Ui(Te=>new El(X,Te)));if(B.length===0&&Re.length===0)return wi(new El(X,[]));let Ce=Hc(n)===r;return this.processSegment(U,B,we,Re,Ce?Wn:r,!0,X).pipe(Ui(Te=>new El(X,Te instanceof El?[Te]:[])))}))):Z_(e)))}getChildConfig(t,e,n){return e.children?wi({routes:e.children,injector:t}):e.loadChildren?e._loadedRoutes!==void 0?wi({routes:e._loadedRoutes,injector:e._loadedInjector}):lJ(t,e,n,this.urlSerializer).pipe(qo(s=>s?this.configLoader.loadChildren(t,e).pipe(Gn(r=>{e._loadedRoutes=r.routes,e._loadedInjector=r.injector})):uJ(e))):wi({routes:[],injector:t})}};function xJ(i){i.sort((t,e)=>t.value.outlet===Wn?-1:e.value.outlet===Wn?1:t.value.outlet.localeCompare(e.value.outlet))}function wJ(i){let t=i.value.routeConfig;return t&&t.path===""}function Q5(i){let t=[],e=new Set;for(let n of i){if(!wJ(n)){t.push(n);continue}let s=t.find(r=>n.value.routeConfig===r.value.routeConfig);s!==void 0?(s.children.push(...n.children),e.add(s)):t.push(n)}for(let n of e){let s=Q5(n.children);t.push(new El(n.value,s))}return t.filter(n=>!e.has(n))}function E5(i){return i.data||{}}function S5(i){return i.resolve||{}}function CJ(i,t,e,n,s,r){return qo(y=>vJ(i,t,e,n,y.extractedUrl,s,r).pipe(Ui(({state:A,tree:P})=>Xi(Ct({},y),{targetSnapshot:A,urlAfterRedirects:P}))))}function EJ(i,t){return qo(e=>{let{targetSnapshot:n,guards:{canActivateChecks:s}}=e;if(!s.length)return wi(e);let r=new Set(s.map(P=>P.route)),y=new Set;for(let P of r)if(!y.has(P))for(let B of J5(P))y.add(B);let A=0;return zr(y).pipe(Cd(P=>r.has(P)?SJ(P,n,i,t):(P.data=CS(P,P.parent,i).resolve,wi(void 0))),Gn(()=>A++),f_(1),qo(P=>A===y.size?wi(e):za))})}function J5(i){let t=i.children.map(e=>J5(e)).flat();return[i,...t]}function SJ(i,t,e,n){let s=i.routeConfig,r=i._resolve;return s?.title!==void 0&&!$5(s)&&(r[Xb]=s.title),DJ(r,i,t,n).pipe(Ui(y=>(i._resolvedData=y,i.data=CS(i,i.parent,e).resolve,null)))}function DJ(i,t,e,n){let s=Xk(i);if(s.length===0)return wi({});let r={};return zr(s).pipe(qo(y=>MJ(i[y],t,e,n).pipe(yu(),Gn(A=>{if(A instanceof ny)throw ES(new up,A);r[y]=A}))),f_(1),Ui(()=>r),tr(y=>Z5(y)?za:lo(y)))}function MJ(i,t,e,n){let s=Kb(t)??n,r=oy(i,s),y=r.resolve?r.resolve(t,e):Zs(s,()=>r(t,e));return fp(y)}function Yk(i){return Oo(t=>{let e=i(t);return e?zr(e).pipe(Ui(()=>t)):wi(t)})}var u2=(()=>{class i{buildTitle(e){let n,s=e.root;for(;s!==void 0;)n=this.getResolvedTitleForRoute(s)??n,s=s.children.find(r=>r.outlet===Wn);return n}getResolvedTitleForRoute(e){return e.data[Xb]}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:()=>Z(ej),providedIn:"root"})}return i})(),ej=(()=>{class i extends u2{title;constructor(e){super(),this.title=e}updateTitle(e){let n=this.buildTitle(e);n!==void 0&&this.title.setTitle(n)}static \u0275fac=function(n){return new(n||i)(hi(_5))};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),Cm=new Dt("",{providedIn:"root",factory:()=>({})}),h2=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(n,s){n&1&&Et(0,"router-outlet")},dependencies:[Qb],encapsulation:2})}return i})();function p2(i){let t=i.children&&i.children.map(p2),e=t?Xi(Ct({},i),{children:t}):Ct({},i);return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==Wn&&(e.component=h2),e}var Em=new Dt(""),TS=(()=>{class i{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=Z(w4);loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return wi(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);let n=fp(e.loadComponent()).pipe(Ui(ij),Gn(r=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=r}),jl(()=>{this.componentLoaders.delete(e)})),s=new qh(n,()=>new ni).pipe(u_());return this.componentLoaders.set(e,s),s}loadChildren(e,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return wi({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);let r=tj(n,this.compiler,e,this.onLoadEndListener).pipe(jl(()=>{this.childrenLoaders.delete(n)})),y=new qh(r,()=>new ni).pipe(u_());return this.childrenLoaders.set(n,y),y}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function tj(i,t,e,n){return fp(i.loadChildren()).pipe(Ui(ij),qo(s=>s instanceof lk||Array.isArray(s)?wi(s):zr(t.compileModuleAsync(s))),Ui(s=>{n&&n(i);let r,y,A=!1;return Array.isArray(s)?(y=s,A=!0):(r=s.create(e).injector,y=r.get(Em,[],{optional:!0,self:!0}).flat()),{routes:y.map(p2),injector:r}}))}function TJ(i){return i&&typeof i=="object"&&"default"in i}function ij(i){return TJ(i)?i.default:i}var IS=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:()=>Z(IJ),providedIn:"root"})}return i})(),IJ=(()=>{class i{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,n){return e}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),f2=new Dt(""),m2=new Dt("");function nj(i,t,e){let n=i.get(m2),s=i.get(Ki);return i.get(ki).runOutsideAngular(()=>{if(!s.startViewTransition||n.skipNextTransition)return n.skipNextTransition=!1,new Promise(B=>setTimeout(B));let r,y=new Promise(B=>{r=B}),A=s.startViewTransition(()=>(r(),AJ(i))),{onViewTransitionCreated:P}=n;return P&&Zs(i,()=>P({transition:A,from:t,to:e})),y})}function AJ(i){return new Promise(t=>{Ma({read:()=>setTimeout(t)},{injector:i})})}var g2=new Dt(""),AS=(()=>{class i{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new ni;transitionAbortSubject=new ni;configLoader=Z(TS);environmentInjector=Z(Fo);destroyRef=Z(N_);urlSerializer=Z(xm);rootContexts=Z(wm);location=Z(Fd);inputBindingEnabled=Z(Jb,{optional:!0})!==null;titleStrategy=Z(u2);options=Z(Cm,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=Z(IS);createViewTransition=Z(f2,{optional:!0});navigationErrorHandler=Z(g2,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>wi(void 0);rootComponentType=null;destroyed=!1;constructor(){let e=s=>this.events.next(new mS(s)),n=s=>this.events.next(new gS(s));this.configLoader.onLoadEndListener=n,this.configLoader.onLoadStartListener=e,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(e){let n=++this.navigationId;this.transitions?.next(Xi(Ct({},e),{extractedUrl:this.urlHandlingStrategy.extract(e.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:n}))}setupNavigations(e){return this.transitions=new Cr(null),this.transitions.pipe(dr(n=>n!==null),Oo(n=>{let s=!1,r=!1;return wi(n).pipe(Oo(y=>{if(this.navigationId>n.id)return this.cancelNavigationTransition(n,"",il.SupersededByNewNavigation),za;this.currentTransition=n,this.currentNavigation={id:y.id,initialUrl:y.rawUrl,extractedUrl:y.extractedUrl,targetBrowserUrl:typeof y.extras.browserUrl=="string"?this.urlSerializer.parse(y.extras.browserUrl):y.extras.browserUrl,trigger:y.source,extras:y.extras,previousNavigation:this.lastSuccessfulNavigation?Xi(Ct({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let A=!e.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),P=y.extras.onSameUrlNavigation??e.onSameUrlNavigation;if(!A&&P!=="reload"){let B="";return this.events.next(new Bd(y.id,this.urlSerializer.serialize(y.rawUrl),B,J_.IgnoredSameUrlNavigation)),y.resolve(!1),za}if(this.urlHandlingStrategy.shouldProcessUrl(y.rawUrl))return wi(y).pipe(Oo(B=>(this.events.next(new pp(B.id,this.urlSerializer.serialize(B.extractedUrl),B.source,B.restoredState)),B.id!==this.navigationId?za:Promise.resolve(B))),CJ(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,this.paramsInheritanceStrategy),Gn(B=>{n.targetSnapshot=B.targetSnapshot,n.urlAfterRedirects=B.urlAfterRedirects,this.currentNavigation=Xi(Ct({},this.currentNavigation),{finalUrl:B.urlAfterRedirects});let U=new Hb(B.id,this.urlSerializer.serialize(B.extractedUrl),this.urlSerializer.serialize(B.urlAfterRedirects),B.targetSnapshot);this.events.next(U)}));if(A&&this.urlHandlingStrategy.shouldProcessUrl(y.currentRawUrl)){let{id:B,extractedUrl:U,source:J,restoredState:le,extras:re}=y,X=new pp(B,this.urlSerializer.serialize(U),J,le);this.events.next(X);let ee=U5(this.rootComponentType).snapshot;return this.currentTransition=n=Xi(Ct({},y),{targetSnapshot:ee,urlAfterRedirects:U,extras:Xi(Ct({},re),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=U,wi(n)}else{let B="";return this.events.next(new Bd(y.id,this.urlSerializer.serialize(y.extractedUrl),B,J_.IgnoredByUrlHandlingStrategy)),y.resolve(!1),za}}),Gn(y=>{let A=new uS(y.id,this.urlSerializer.serialize(y.extractedUrl),this.urlSerializer.serialize(y.urlAfterRedirects),y.targetSnapshot);this.events.next(A)}),Ui(y=>(this.currentTransition=n=Xi(Ct({},y),{guards:HQ(y.targetSnapshot,y.currentSnapshot,this.rootContexts)}),n)),eJ(this.environmentInjector,y=>this.events.next(y)),Gn(y=>{if(n.guardsResult=y.guardsResult,y.guardsResult&&typeof y.guardsResult!="boolean")throw ES(this.urlSerializer,y.guardsResult);let A=new hS(y.id,this.urlSerializer.serialize(y.extractedUrl),this.urlSerializer.serialize(y.urlAfterRedirects),y.targetSnapshot,!!y.guardsResult);this.events.next(A)}),dr(y=>y.guardsResult?!0:(this.cancelNavigationTransition(y,"",il.GuardRejected),!1)),Yk(y=>{if(y.guards.canActivateChecks.length!==0)return wi(y).pipe(Gn(A=>{let P=new pS(A.id,this.urlSerializer.serialize(A.extractedUrl),this.urlSerializer.serialize(A.urlAfterRedirects),A.targetSnapshot);this.events.next(P)}),Oo(A=>{let P=!1;return wi(A).pipe(EJ(this.paramsInheritanceStrategy,this.environmentInjector),Gn({next:()=>P=!0,complete:()=>{P||this.cancelNavigationTransition(A,"",il.NoDataFromResolver)}}))}),Gn(A=>{let P=new fS(A.id,this.urlSerializer.serialize(A.extractedUrl),this.urlSerializer.serialize(A.urlAfterRedirects),A.targetSnapshot);this.events.next(P)}))}),Yk(y=>{let A=P=>{let B=[];P.routeConfig?.loadComponent&&!P.routeConfig._loadedComponent&&B.push(this.configLoader.loadComponent(P.routeConfig).pipe(Gn(U=>{P.component=U}),Ui(()=>{})));for(let U of P.children)B.push(...A(U));return B};return Zf(A(y.targetSnapshot.root)).pipe(Zh(null),mo(1))}),Yk(()=>this.afterPreactivation()),Oo(()=>{let{currentSnapshot:y,targetSnapshot:A}=n,P=this.createViewTransition?.(this.environmentInjector,y.root,A.root);return P?zr(P).pipe(Ui(()=>n)):wi(n)}),Ui(y=>{let A=zQ(e.routeReuseStrategy,y.targetSnapshot,y.currentRouterState);return this.currentTransition=n=Xi(Ct({},y),{targetRouterState:A}),this.currentNavigation.targetRouterState=A,n}),Gn(()=>{this.events.next(new $b)}),UQ(this.rootContexts,e.routeReuseStrategy,y=>this.events.next(y),this.inputBindingEnabled),mo(1),Gn({next:y=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Zl(y.id,this.urlSerializer.serialize(y.extractedUrl),this.urlSerializer.serialize(y.urlAfterRedirects))),this.titleStrategy?.updateTitle(y.targetRouterState.snapshot),y.resolve(!0)},complete:()=>{s=!0}}),Un(this.transitionAbortSubject.pipe(Gn(y=>{throw y}))),jl(()=>{!s&&!r&&this.cancelNavigationTransition(n,"",il.SupersededByNewNavigation),this.currentTransition?.id===n.id&&(this.currentNavigation=null,this.currentTransition=null)}),tr(y=>{if(this.destroyed)return n.resolve(!1),za;if(r=!0,Y5(y))this.events.next(new Nd(n.id,this.urlSerializer.serialize(n.extractedUrl),y.message,y.cancellationCode)),jQ(y)?this.events.next(new iy(y.url,y.navigationBehaviorOptions)):n.resolve(!1);else{let A=new ey(n.id,this.urlSerializer.serialize(n.extractedUrl),y,n.targetSnapshot??void 0);try{let P=Zs(this.environmentInjector,()=>this.navigationErrorHandler?.(A));if(P instanceof ny){let{message:B,cancellationCode:U}=ES(this.urlSerializer,P);this.events.next(new Nd(n.id,this.urlSerializer.serialize(n.extractedUrl),B,U)),this.events.next(new iy(P.redirectTo,P.navigationBehaviorOptions))}else throw this.events.next(A),y}catch(P){this.options.resolveNavigationPromiseOnError?n.resolve(!1):n.reject(P)}}return za}))}))}cancelNavigationTransition(e,n,s){let r=new Nd(e.id,this.urlSerializer.serialize(e.extractedUrl),n,s);this.events.next(r),e.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let e=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),n=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return e.toString()!==n?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function RJ(i){return i!==lS}var rj=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:()=>Z(kJ),providedIn:"root"})}return i})(),DS=class{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}},kJ=(()=>{class i extends DS{static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),oj=(()=>{class i{urlSerializer=Z(xm);options=Z(Cm,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=Z(Fd);urlHandlingStrategy=Z(IS);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new zd;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:e,initialUrl:n,targetBrowserUrl:s}){let r=e!==void 0?this.urlHandlingStrategy.merge(e,n):n,y=s??r;return y instanceof zd?this.urlSerializer.serialize(y):y}commitTransition({targetRouterState:e,finalUrl:n,initialUrl:s}){n&&e?(this.currentUrlTree=n,this.rawUrlTree=this.urlHandlingStrategy.merge(n,s),this.routerState=e):this.rawUrlTree=s}routerState=U5(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:e}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e??this.rawUrlTree)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:()=>Z(PJ),providedIn:"root"})}return i})(),PJ=(()=>{class i extends oj{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(e){return this.location.subscribe(n=>{n.type==="popstate"&&setTimeout(()=>{e(n.url,n.state,"popstate")})})}handleRouterEvent(e,n){e instanceof pp?this.updateStateMemento():e instanceof Bd?this.commitTransition(n):e instanceof Hb?this.urlUpdateStrategy==="eager"&&(n.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(n),n)):e instanceof $b?(this.commitTransition(n),this.urlUpdateStrategy==="deferred"&&!n.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(n),n)):e instanceof Nd&&(e.code===il.GuardRejected||e.code===il.NoDataFromResolver)?this.restoreHistory(n):e instanceof ey?this.restoreHistory(n,!0):e instanceof Zl&&(this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId)}setBrowserUrl(e,{extras:n,id:s}){let{replaceUrl:r,state:y}=n;if(this.location.isCurrentPathEqualTo(e)||r){let A=this.browserPageId,P=Ct(Ct({},y),this.generateNgRouterState(s,A));this.location.replaceState(e,"",P)}else{let A=Ct(Ct({},y),this.generateNgRouterState(s,this.browserPageId+1));this.location.go(e,"",A)}}restoreHistory(e,n=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,r=this.currentPageId-s;r!==0?this.location.historyGo(r):this.getCurrentUrlTree()===e.finalUrl&&r===0&&(this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(n&&this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,n){return this.canceledNavigationResolution==="computed"?{navigationId:e,\u0275routerPageId:n}:{navigationId:e}}static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function RS(i,t){i.events.pipe(dr(e=>e instanceof Zl||e instanceof Nd||e instanceof ey||e instanceof Bd),Ui(e=>e instanceof Zl||e instanceof Bd?0:(e instanceof Nd?e.code===il.Redirect||e.code===il.SupersededByNewNavigation:!1)?2:1),dr(e=>e!==2),mo(1)).subscribe(()=>{t()})}var OJ={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},FJ={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},fn=(()=>{class i{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=Z(dk);stateManager=Z(oj);options=Z(Cm,{optional:!0})||{};pendingTasks=Z(Mu);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=Z(AS);urlSerializer=Z(xm);location=Z(Fd);urlHandlingStrategy=Z(IS);_events=new ni;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=Z(rj);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=Z(Em,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!Z(Jb,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:e=>{this.console.warn(e)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Tn;subscribeToNavigationEvents(){let e=this.navigationTransitions.events.subscribe(n=>{try{let s=this.navigationTransitions.currentTransition,r=this.navigationTransitions.currentNavigation;if(s!==null&&r!==null){if(this.stateManager.handleRouterEvent(n,r),n instanceof Nd&&n.code!==il.Redirect&&n.code!==il.SupersededByNewNavigation)this.navigated=!0;else if(n instanceof Zl)this.navigated=!0;else if(n instanceof iy){let y=n.navigationBehaviorOptions,A=this.urlHandlingStrategy.merge(n.url,s.currentRawUrl),P=Ct({browserUrl:s.extras.browserUrl,info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:s.extras.replaceUrl||this.urlUpdateStrategy==="eager"||RJ(s.source)},y);this.scheduleNavigation(A,lS,null,P,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}NJ(n)&&this._events.next(n)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(e)}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),lS,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((e,n,s)=>{this.navigateToSyncWithBrowser(e,s,n)})}navigateToSyncWithBrowser(e,n,s){let r={replaceUrl:!0},y=s?.navigationId?s:null;if(s){let P=Ct({},s);delete P.navigationId,delete P.\u0275routerPageId,Object.keys(P).length!==0&&(r.state=P)}let A=this.parseUrl(e);this.scheduleNavigation(A,n,y,r)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(p2),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(e,n={}){let{relativeTo:s,queryParams:r,fragment:y,queryParamsHandling:A,preserveFragment:P}=n,B=P?this.currentUrlTree.fragment:y,U=null;switch(A??this.options.defaultQueryParamsHandling){case"merge":U=Ct(Ct({},this.currentUrlTree.queryParams),r);break;case"preserve":U=this.currentUrlTree.queryParams;break;default:U=r||null}U!==null&&(U=this.removeEmptyProps(U));let J;try{let le=s?s.snapshot:this.routerState.snapshot.root;J=z5(le)}catch{(typeof e[0]!="string"||e[0][0]!=="/")&&(e=[]),J=this.currentUrlTree.root}return B5(J,e,U,B??null)}navigateByUrl(e,n={skipLocationChange:!1}){let s=hp(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(r,lS,null,n)}navigate(e,n={skipLocationChange:!1}){return LJ(e),this.navigateByUrl(this.createUrlTree(e,n),n)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){try{return this.urlSerializer.parse(e)}catch{return this.urlSerializer.parse("/")}}isActive(e,n){let s;if(n===!0?s=Ct({},OJ):n===!1?s=Ct({},FJ):s=n,hp(e))return v5(this.currentUrlTree,e,s);let r=this.parseUrl(e);return v5(this.currentUrlTree,r,s)}removeEmptyProps(e){return Object.entries(e).reduce((n,[s,r])=>(r!=null&&(n[s]=r),n),{})}scheduleNavigation(e,n,s,r,y){if(this.disposed)return Promise.resolve(!1);let A,P,B;y?(A=y.resolve,P=y.reject,B=y.promise):B=new Promise((J,le)=>{A=J,P=le});let U=this.pendingTasks.add();return RS(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(U))}),this.navigationTransitions.handleNavigationRequest({source:n,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:r,resolve:A,reject:P,promise:B,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),B.catch(J=>Promise.reject(J))}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function LJ(i){for(let t=0;t<i.length;t++)if(i[t]==null)throw new Mi(4008,!1)}function NJ(i){return!(i instanceof $b)&&!(i instanceof iy)}var ay=(()=>{class i{router;route;tabIndexAttribute;renderer;el;locationStrategy;href=null;target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new ni;constructor(e,n,s,r,y,A){this.router=e,this.route=n,this.tabIndexAttribute=s,this.renderer=r,this.el=y,this.locationStrategy=A;let P=y.nativeElement.tagName?.toLowerCase();this.isAnchorElement=P==="a"||P==="area",this.isAnchorElement?this.subscription=e.events.subscribe(B=>{B instanceof Zl&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(e){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(e){e==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(hp(e)?this.routerLinkInput=e:this.routerLinkInput=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0"))}onClick(e,n,s,r,y){let A=this.urlTree;if(A===null||this.isAnchorElement&&(e!==0||n||s||r||y||typeof this.target=="string"&&this.target!="_self"))return!0;let P={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(A,P),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let e=this.urlTree;this.href=e!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(e)):null;let n=this.href===null?null:iV(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",n)}applyAttributeValue(e,n){let s=this.renderer,r=this.el.nativeElement;n!==null?s.setAttribute(r,e,n):s.removeAttribute(r,e)}get urlTree(){return this.routerLinkInput===null?null:hp(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(n){return new(n||i)(ai(fn),ai(nl),vE("tabindex"),ai(Do),ai(Ii),ai(Vc))};static \u0275dir=ri({type:i,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(n,s){n&1&&_t("click",function(y){return s.onClick(y.button,y.ctrlKey,y.shiftKey,y.altKey,y.metaKey)}),n&2&&ji("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",xi],skipLocationChange:[2,"skipLocationChange","skipLocationChange",xi],replaceUrl:[2,"replaceUrl","replaceUrl",xi],routerLink:"routerLink"},features:[fr]})}return i})();var tx=class{};var aj=(()=>{class i{router;injector;preloadingStrategy;loader;subscription;constructor(e,n,s,r){this.router=e,this.injector=n,this.preloadingStrategy=s,this.loader=r}setUpPreloading(){this.subscription=this.router.events.pipe(dr(e=>e instanceof Zl),Cd(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,n){let s=[];for(let r of n){r.providers&&!r._injector&&(r._injector=_b(r.providers,e,`Route: ${r.path}`));let y=r._injector??e,A=r._loadedInjector??y;(r.loadChildren&&!r._loadedRoutes&&r.canLoad===void 0||r.loadComponent&&!r._loadedComponent)&&s.push(this.preloadConfig(y,r)),(r.children||r._loadedRoutes)&&s.push(this.processRoutes(A,r.children??r._loadedRoutes))}return zr(s).pipe(Wh())}preloadConfig(e,n){return this.preloadingStrategy.preload(n,()=>{let s;n.loadChildren&&n.canLoad===void 0?s=this.loader.loadChildren(e,n):s=wi(null);let r=s.pipe(qo(y=>y===null?wi(void 0):(n._loadedRoutes=y.routes,n._loadedInjector=y.injector,this.processRoutes(y.injector??e,y.routes))));if(n.loadComponent&&!n._loadedComponent){let y=this.loader.loadComponent(n);return zr([r,y]).pipe(Wh())}else return r})}static \u0275fac=function(n){return new(n||i)(hi(fn),hi(Fo),hi(tx),hi(TS))};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),sj=new Dt(""),zJ=(()=>{class i{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource="imperative";restoredId=0;store={};constructor(e,n,s,r,y={}){this.urlSerializer=e,this.transitions=n,this.viewportScroller=s,this.zone=r,this.options=y,y.scrollPositionRestoration||="disabled",y.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof pp?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Zl?(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment)):e instanceof Bd&&e.code===J_.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof ty&&(e.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(e.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,n){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new ty(e,this.lastSource==="popstate"?this.store[this.restoredId]:null,n))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(n){AE()};static \u0275prov=Mt({token:i,factory:i.\u0275fac})}return i})();function y2(i,...t){return k_([{provide:Em,multi:!0,useValue:i},[],{provide:nl,useFactory:lj,deps:[fn]},{provide:RE,multi:!0,useFactory:cj},t.map(e=>e.\u0275providers)])}function lj(i){return i.routerState.root}function ix(i,t){return{\u0275kind:i,\u0275providers:t}}function cj(){let i=Z(vn);return t=>{let e=i.get($l);if(t!==e.components[0])return;let n=i.get(fn),s=i.get(dj);i.get(v2)===1&&n.initialNavigation(),i.get(pj,null,rr.Optional)?.setUpPreloading(),i.get(sj,null,rr.Optional)?.init(),n.resetRootComponentType(e.componentTypes[0]),s.closed||(s.next(),s.complete(),s.unsubscribe())}}var dj=new Dt("",{factory:()=>new ni}),v2=new Dt("",{providedIn:"root",factory:()=>1});function uj(){let i=[{provide:v2,useValue:0},hk(()=>{let t=Z(vn);return t.get(bk,Promise.resolve()).then(()=>new Promise(n=>{let s=t.get(fn),r=t.get(dj);RS(s,()=>{n(!0)}),t.get(AS).afterPreactivation=()=>(n(!0),r.closed?wi(void 0):r),s.initialNavigation()}))})];return ix(2,i)}function hj(){let i=[hk(()=>{Z(fn).setUpLocationChangeListener()}),{provide:v2,useValue:2}];return ix(3,i)}var pj=new Dt("");function fj(i){return ix(0,[{provide:pj,useExisting:aj},{provide:tx,useExisting:i}])}function mj(){return ix(8,[d2,{provide:Jb,useExisting:d2}])}function gj(i){rp("NgRouterViewTransitions");let t=[{provide:f2,useValue:nj},{provide:m2,useValue:Ct({skipNextTransition:!!i?.skipInitialTransition},i)}];return ix(9,t)}var _j=[Fd,{provide:xm,useClass:up},fn,wm,{provide:nl,useFactory:lj,deps:[fn]},TS,[]],Dl=(()=>{class i{constructor(){}static forRoot(e,n){return{ngModule:i,providers:[_j,[],{provide:Em,multi:!0,useValue:e},[],n?.errorHandler?{provide:g2,useValue:n.errorHandler}:[],{provide:Cm,useValue:n||{}},n?.useHash?VJ():jJ(),BJ(),n?.preloadingStrategy?fj(n.preloadingStrategy).\u0275providers:[],n?.initialNavigation?UJ(n):[],n?.bindToComponentInputs?mj().\u0275providers:[],n?.enableViewTransitions?gj().\u0275providers:[],HJ()]}}static forChild(e){return{ngModule:i,providers:[{provide:Em,multi:!0,useValue:e}]}}static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({})}return i})();function BJ(){return{provide:sj,useFactory:()=>{let i=Z(Z4),t=Z(ki),e=Z(Cm),n=Z(AS),s=Z(xm);return e.scrollOffset&&i.setOffset(e.scrollOffset),new zJ(s,n,i,t,e)}}}function VJ(){return{provide:Vc,useClass:Mk}}function jJ(){return{provide:Vc,useClass:LE}}function UJ(i){return[i.initialNavigation==="disabled"?hj().\u0275providers:[],i.initialNavigation==="enabledBlocking"?uj().\u0275providers:[]]}var _2=new Dt("");function HJ(){return[{provide:_2,useFactory:cj},{provide:RE,multi:!0,useExisting:_2}]}var aa={mapboxToken:"pk.eyJ1IjoibWFya2F0IiwiYSI6ImNtN2o2eGcwZDAwcGsycG9pZzZ6cjhncTgifQ.f9qApUfu6cdG-w-gpjPOlQ",cloud_name:"dxospqsu0",api_key:"173283854338116",api_secret:"kTTNZ1yXBfEjGr1jm39FithfSwU",urlBack:"http://localhost:8080/api/v1"};var eo=class i{constructor(t){this.http=t}apiUrl=aa.urlBack;userNotificationService=bR(gp);currentUser=new Cr(null);currentUser$=this.currentUser.asObservable();authStatus=new Cr(!1);adminStatus=new Cr(!1);getAuthStatus(){return this.authStatus.asObservable()}getAdminStatus(){return this.adminStatus.asObservable()}updatePassword(t,e){return this.http.patch(`${this.apiUrl}/users/${t}/password`,e,{withCredentials:!0})}deleteUser(t){return this.http.delete(`${this.apiUrl}/users/${t}`,{withCredentials:!0})}login(t){return this.http.post(`${this.apiUrl}/auth/sessions`,{userName:t.email,password:t.password},{withCredentials:!0}).pipe(Gn(()=>{this.authStatus.next(!0),this.checkIsAdmin().subscribe()}),Ui(()=>!0),tr(e=>(this.authStatus.next(!1),this.adminStatus.next(!1),lo(()=>e))))}getCurrentUser(){return this.http.get(`${this.apiUrl}/users/me`,{withCredentials:!0}).pipe(Gn(t=>{sessionStorage.setItem("lat",t.latitude.toString()),sessionStorage.setItem("lng",t.longitude.toString()),sessionStorage.setItem("radiusKm",t.notificationRadiusKm.toString()),this.authStatus.next(!0),this.currentUser.next(t)}),tr(t=>(this.authStatus.next(!1),lo(()=>t))))}isLoggedIn(){return this.getCurrentUser().pipe(Ui(()=>!0),tr(()=>wi(!1)))}logout(){return this.http.get(`${this.apiUrl}/auth/logout`,{withCredentials:!0}).pipe(Gn(()=>{this.authStatus.next(!1),sessionStorage.removeItem("lat"),sessionStorage.removeItem("lng"),sessionStorage.removeItem("radiusKm")}),tr(t=>lo(()=>t)))}register(t){return this.http.post(`${this.apiUrl}/users`,t).pipe(Gn(()=>console.log("Registro exitoso")),tr(e=>lo(()=>e)))}getMe(){return this.http.get(`${this.apiUrl}/users/me`,{withCredentials:!0})}updateUser(t,e){return this.http.put(`${this.apiUrl}/users/${t}`,e,{withCredentials:!0})}validateAccount(t){return this.http.patch(`${this.apiUrl}/auth/activations?code=${t}`,{},{responseType:"text"}).pipe(Gn(()=>console.log("Validaci\xF3n de cuenta exitosa")),tr(e=>(console.error("Error al validar la cuenta",e),lo(()=>e))))}sendCodeAgain(t){return this.http.post(`${this.apiUrl}/auth/activations/${t}`,{}).pipe(Gn(()=>console.log("C\xF3digo reenviado exitosamente")),tr(e=>(console.error("Error al reenviar el c\xF3digo",e),lo(()=>e))))}resendResetPasswordCode(t){return this.http.post(`${this.apiUrl}/auth/users/password-codes/${t}`,{}).pipe(Gn(()=>console.log("C\xF3digo reenviado exitosamente")),tr(e=>(console.error("Error al reenviar el c\xF3digo",e),lo(()=>e))))}requestPasswordResetCode(t){return this.http.post(`${this.apiUrl}/auth/passwordCodes?email=${encodeURIComponent(t)}`,{}).pipe(Gn(()=>console.log(`\u{1F501} C\xF3digo de recuperaci\xF3n enviado a ${t}`)),tr(e=>(console.error("\u274C Error al solicitar c\xF3digo de recuperaci\xF3n",e),lo(()=>e))))}resetPasswordWithCode(t){return this.http.patch(`${this.apiUrl}/auth/users/password`,t).pipe(Gn(()=>console.log("\u{1F504} Contrase\xF1a restablecida con c\xF3digo")),tr(e=>(console.error("\u274C Error en resetPasswordWithCode",e),lo(()=>e))))}checkIsAdmin(){return this.http.get(`${this.apiUrl}/users/admin`,{withCredentials:!0,observe:"response"}).pipe(Ui(t=>t.status===204),Gn(t=>this.adminStatus.next(t)),tr(()=>(this.adminStatus.next(!1),wi(!1))))}static \u0275fac=function(e){return new(e||i)(hi(zo))};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})};var gp=class i{storageKey="app_notifications";zone=Z(ki);authService=Z(eo);eventSource=null;platformId=Z(as);notificationsSubject=new Cr(this.loadFromStorage());notifications$=this.notificationsSubject.asObservable();constructor(){this.authService.getAuthStatus().subscribe(t=>{t?this.safeStart():(this.disconnect(),this.clearNotifications())})}safeStart(){if(tl(this.platformId))try{this.disconnect(),this.requestNotificationPermission(),this.connectToSse()}catch(t){console.warn("No se pudo iniciar SSE de notificaciones:",t)}}connectToSse(){this.eventSource||!tl(this.platformId)||(this.eventSource=new EventSource(`${aa.urlBack}/notifications/subscribe`,{withCredentials:!0}),this.eventSource.addEventListener("new-notification",t=>{this.zone.run(()=>{let e=this.parseNotification(t.data);e&&(this.addNotification(e),this.showBrowserNotification(e))})}),this.eventSource.onerror=t=>{console.error("Error en conexi\xF3n SSE:",t),this.reconnect()})}reconnect(){this.disconnect(),tl(this.platformId)&&setTimeout(()=>this.safeStart(),5e3)}disconnect(){this.eventSource&&(this.eventSource.close(),this.eventSource=null)}parseNotification(t){try{let e=JSON.parse(t);if(e?.title&&e?.message&&e?.reportId&&e?.type&&e?.createdAt)return{id:e.id||Date.now().toString(),title:e.title,message:e.message,reportId:e.reportId,type:e.type,createdAt:e.createdAt,read:!1}}catch(e){console.error("Error parsing notification:",e)}return null}addNotification(t){let e=[t,...this.notificationsSubject.value];this.notificationsSubject.next(e),this.saveToStorage(e)}loadFromStorage(){try{return tl(this.platformId)?JSON.parse(localStorage.getItem(this.storageKey)||"[]"):(console.warn("localStorage no est\xE1 disponible"),[])}catch(t){return console.error("Error loading notifications from storage:",t),[]}}saveToStorage(t){try{tl(this.platformId)&&localStorage.setItem(this.storageKey,JSON.stringify(t))}catch(e){console.error("Error saving notifications to storage:",e)}}requestNotificationPermission(){tl(this.platformId)&&"Notification"in window&&Notification.permission!=="denied"&&Notification.requestPermission().then(t=>{t==="granted"&&console.log("Notification permission granted")})}showBrowserNotification(t){Notification.permission==="granted"&&new Notification(t.title,{body:t.message,icon:this.getNotificationIcon(t.type),data:{reportId:t.reportId}})}getNotificationIcon(t){return{NEW_REPORT:"map_marker.png",COMMENT:"comment.png",STATUS_CHANGE:"status-change.png"}[t]||"assets/icons/notification.png"}markAsRead(t){let e=this.notificationsSubject.value.map(n=>n.id===t?Xi(Ct({},n),{read:!0}):n);this.notificationsSubject.next(e),this.saveToStorage(e)}clearNotifications(){this.notificationsSubject.next([]),tl(this.platformId)&&localStorage.removeItem(this.storageKey)}ngOnDestroy(){this.disconnect()}static \u0275fac=function(e){return new(e||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})};function GJ(i,t){i&1&&(oe(0,"div",3),Ee(1," No tienes notificaciones "),ae())}function qJ(i,t){if(i&1){let e=bi();oe(0,"div",4),_t("click",function(){let s=qt(e).$implicit,r=bt();return Wt(r.markAsRead(s.id))}),oe(1,"div",5),Et(2,"img",6),ae(),oe(3,"div",7)(4,"strong"),Ee(5),ae(),oe(6,"small"),Ee(7),Qs(8,"date"),ae(),oe(9,"p"),Ee(10),ae()()()}if(i&2){let e=t.$implicit,n=bt();Ai("unread",!e.read),ge(2),Be("src",n.getIcon(e.type),mm),ge(3),tn(e.title),ge(2),tn(Pd(8,6,e.createdAt,"medium")),ge(3),tn(e.message)}}var kS=class i{notificationService=Z(gp);notifications$=this.notificationService.notifications$;markAsRead(t){this.notificationService.markAsRead(t)}getIcon(t){return this.notificationService.getNotificationIcon(t)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Yt({type:i,selectors:[["app-notification-list"]],decls:5,vars:6,consts:[[1,"list"],["class","empty",4,"ngIf"],["class","item",3,"unread","click",4,"ngFor","ngForOf"],[1,"empty"],[1,"item",3,"click"],[1,"icon-container"],[1,"icon",3,"src"],[1,"content"]],template:function(e,n){if(e&1&&(oe(0,"div",0),pt(1,GJ,2,0,"div",1),Qs(2,"async"),pt(3,qJ,11,9,"div",2),Qs(4,"async"),ae()),e&2){let s;ge(),Be("ngIf",((s=vb(2,2,n.notifications$))==null?null:s.length)===0),ge(2),Be("ngForOf",vb(4,4,n.notifications$))}},dependencies:[sr,cs,Zn,Tb,Uc],styles:[".list[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto;padding:8px}.item[_ngcontent-%COMP%]{display:flex;padding:12px;border-bottom:1px solid #eee;cursor:pointer;gap:12px}.item[_ngcontent-%COMP%]:last-child{border:none}.item.unread[_ngcontent-%COMP%]{background-color:#f8f9fe}.empty[_ngcontent-%COMP%]{padding:16px;color:#666;text-align:center}.icon-container[_ngcontent-%COMP%]{width:24px;height:24px}.icon[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain}.content[_ngcontent-%COMP%]{flex:1}small[_ngcontent-%COMP%]{display:block;color:#999;margin:4px 0;font-size:.8em}strong[_ngcontent-%COMP%]{font-size:.9em}p[_ngcontent-%COMP%]{margin:0;font-size:.85em;color:#555}"]})};var sy=class{_attachedHost;attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;t!=null&&(this._attachedHost=null,t.detach())}get isAttached(){return this._attachedHost!=null}setAttachedHost(t){this._attachedHost=t}},Is=class extends sy{component;viewContainerRef;injector;componentFactoryResolver;projectableNodes;constructor(t,e,n,s,r){super(),this.component=t,this.viewContainerRef=e,this.injector=n,this.projectableNodes=r}},Gc=class extends sy{templateRef;viewContainerRef;context;injector;constructor(t,e,n,s){super(),this.templateRef=t,this.viewContainerRef=e,this.context=n,this.injector=s}get origin(){return this.templateRef.elementRef}attach(t,e=this.context){return this.context=e,super.attach(t)}detach(){return this.context=void 0,super.detach()}},PS=class extends sy{element;constructor(t){super(),this.element=t instanceof Ii?t.nativeElement:t}},Ou=class{_attachedPortal;_disposeFn;_isDisposed=!1;hasAttached(){return!!this._attachedPortal}attach(t){if(t instanceof Is)return this._attachedPortal=t,this.attachComponentPortal(t);if(t instanceof Gc)return this._attachedPortal=t,this.attachTemplatePortal(t);if(this.attachDomPortal&&t instanceof PS)return this._attachedPortal=t,this.attachDomPortal(t)}attachDomPortal=null;detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}};var nx=class extends Ou{outletElement;_appRef;_defaultInjector;_document;constructor(t,e,n,s,r){super(),this.outletElement=t,this._appRef=n,this._defaultInjector=s,this._document=r}attachComponentPortal(t){let e;if(t.viewContainerRef){let n=t.injector||t.viewContainerRef.injector,s=n.get(Cu,null,{optional:!0})||void 0;e=t.viewContainerRef.createComponent(t.component,{index:t.viewContainerRef.length,injector:n,ngModuleRef:s,projectableNodes:t.projectableNodes||void 0}),this.setDisposeFn(()=>e.destroy())}else{let n=this._appRef,s=t.injector||this._defaultInjector||vn.NULL,r=s.get(Fo,n.injector);e=PE(t.component,{elementInjector:s,environmentInjector:r,projectableNodes:t.projectableNodes||void 0}),n.attachView(e.hostView),this.setDisposeFn(()=>{n.viewCount>0&&n.detachView(e.hostView),e.destroy()})}return this.outletElement.appendChild(this._getComponentRootNode(e)),this._attachedPortal=t,e}attachTemplatePortal(t){let e=t.viewContainerRef,n=e.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return n.rootNodes.forEach(s=>this.outletElement.appendChild(s)),n.detectChanges(),this.setDisposeFn(()=>{let s=e.indexOf(n);s!==-1&&e.remove(s)}),this._attachedPortal=t,n}attachDomPortal=t=>{let e=t.element;e.parentNode;let n=this._document.createComment("dom-portal");e.parentNode.insertBefore(n,e),this.outletElement.appendChild(e),this._attachedPortal=t,super.setDisposeFn(()=>{n.parentNode&&n.parentNode.replaceChild(e,n)})};dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(t){return t.hostView.rootNodes[0]}};var Xl=(()=>{class i extends Ou{_moduleRef=Z(Cu,{optional:!0});_document=Z(Ki);_viewContainerRef=Z(yo);_isInitialized=!1;_attachedRef;constructor(){super()}get portal(){return this._attachedPortal}set portal(e){this.hasAttached()&&!e&&!this._isInitialized||(this.hasAttached()&&super.detach(),e&&super.attach(e),this._attachedPortal=e||null)}attached=new ui;get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(e){e.setAttachedHost(this);let n=e.viewContainerRef!=null?e.viewContainerRef:this._viewContainerRef,s=n.createComponent(e.component,{index:n.length,injector:e.injector||n.injector,projectableNodes:e.projectableNodes||void 0,ngModuleRef:this._moduleRef||void 0});return n!==this._viewContainerRef&&this._getRootNode().appendChild(s.hostView.rootNodes[0]),super.setDisposeFn(()=>s.destroy()),this._attachedPortal=e,this._attachedRef=s,this.attached.emit(s),s}attachTemplatePortal(e){e.setAttachedHost(this);let n=this._viewContainerRef.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=e,this._attachedRef=n,this.attached.emit(n),n}attachDomPortal=e=>{let n=e.element;n.parentNode;let s=this._document.createComment("dom-portal");e.setAttachedHost(this),n.parentNode.insertBefore(s,n),this._getRootNode().appendChild(n),this._attachedPortal=e,super.setDisposeFn(()=>{s.parentNode&&s.parentNode.replaceChild(n,s)})};_getRootNode(){let e=this._viewContainerRef.element.nativeElement;return e.nodeType===e.ELEMENT_NODE?e:e.parentNode}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[0,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[dn]})}return i})();var qc=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({})}return i})();function rx(i){return i.buttons===0||i.detail===0}function ox(i){let t=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0];return!!t&&t.identifier===-1&&(t.radiusX==null||t.radiusX===1)&&(t.radiusY==null||t.radiusY===1)}var b2;function yj(){if(b2==null){let i=typeof document<"u"?document.head:null;b2=!!(i&&(i.createShadowRoot||i.attachShadow))}return b2}function x2(i){if(yj()){let t=i.getRootNode?i.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}function Fu(){let i=typeof document<"u"&&document?document.activeElement:null;for(;i&&i.shadowRoot;){let t=i.shadowRoot.activeElement;if(t===i)break;i=t}return i}function As(i){return i.composedPath?i.composedPath()[0]:i.target}function Bo(i,t,e,n,s){let r=parseInt(yk.major),y=parseInt(yk.minor);return r>19||r===19&&y>0||r===0&&y===0?i.listen(t,e,n,s):(t.addEventListener(e,n,s),()=>{t.removeEventListener(e,n,s)})}var w2;try{w2=typeof Intl<"u"&&Intl.v8BreakIterator}catch{w2=!1}var or=(()=>{class i{_platformId=Z(as);isBrowser=this._platformId?tl(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||w2)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var ax;function vj(){if(ax==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>ax=!0}))}finally{ax=ax||!1}return ax}function _p(i){return vj()?i:!!i.capture}function Lu(i,t=0){return bj(i)?Number(i):arguments.length===2?t:0}function bj(i){return!isNaN(parseFloat(i))&&!isNaN(Number(i))}function Ml(i){return i instanceof Ii?i.nativeElement:i}var xj=new Dt("cdk-input-modality-detector-options"),wj={ignoreKeys:[18,17,224,91,16]},Cj=650,C2={passive:!0,capture:!0},Ej=(()=>{class i{_platform=Z(or);_listenerCleanups;modalityDetected;modalityChanged;get mostRecentModality(){return this._modality.value}_mostRecentTarget=null;_modality=new Cr(null);_options;_lastTouchMs=0;_onKeydown=e=>{this._options?.ignoreKeys?.some(n=>n===e.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=As(e))};_onMousedown=e=>{Date.now()-this._lastTouchMs<Cj||(this._modality.next(rx(e)?"keyboard":"mouse"),this._mostRecentTarget=As(e))};_onTouchstart=e=>{if(ox(e)){this._modality.next("keyboard");return}this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=As(e)};constructor(){let e=Z(ki),n=Z(Ki),s=Z(xj,{optional:!0});if(this._options=Ct(Ct({},wj),s),this.modalityDetected=this._modality.pipe(K0(1)),this.modalityChanged=this.modalityDetected.pipe(bC()),this._platform.isBrowser){let r=Z(Sa).createRenderer(null,null);this._listenerCleanups=e.runOutsideAngular(()=>[Bo(r,n,"keydown",this._onKeydown,C2),Bo(r,n,"mousedown",this._onMousedown,C2),Bo(r,n,"touchstart",this._onTouchstart,C2)])}}ngOnDestroy(){this._modality.complete(),this._listenerCleanups?.forEach(e=>e())}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),sx=function(i){return i[i.IMMEDIATE=0]="IMMEDIATE",i[i.EVENTUAL=1]="EVENTUAL",i}(sx||{}),Sj=new Dt("cdk-focus-monitor-default-options"),OS=_p({passive:!0,capture:!0}),Kl=(()=>{class i{_ngZone=Z(ki);_platform=Z(or);_inputModalityDetector=Z(Ej);_origin=null;_lastFocusOrigin;_windowFocused=!1;_windowFocusTimeoutId;_originTimeoutId;_originFromTouchInteraction=!1;_elementInfo=new Map;_monitoredElementCount=0;_rootNodeFocusListenerCount=new Map;_detectionMode;_windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)};_document=Z(Ki,{optional:!0});_stopInputModalityDetector=new ni;constructor(){let e=Z(Sj,{optional:!0});this._detectionMode=e?.detectionMode||sx.IMMEDIATE}_rootNodeFocusAndBlurListener=e=>{let n=As(e);for(let s=n;s;s=s.parentElement)e.type==="focus"?this._onFocus(e,s):this._onBlur(e,s)};monitor(e,n=!1){let s=Ml(e);if(!this._platform.isBrowser||s.nodeType!==1)return wi();let r=x2(s)||this._getDocument(),y=this._elementInfo.get(s);if(y)return n&&(y.checkChildren=!0),y.subject;let A={checkChildren:n,subject:new ni,rootNode:r};return this._elementInfo.set(s,A),this._registerGlobalListeners(A),A.subject}stopMonitoring(e){let n=Ml(e),s=this._elementInfo.get(n);s&&(s.subject.complete(),this._setClasses(n),this._elementInfo.delete(n),this._removeGlobalListeners(s))}focusVia(e,n,s){let r=Ml(e),y=this._getDocument().activeElement;r===y?this._getClosestElementsInfo(r).forEach(([A,P])=>this._originChanged(A,n,P)):(this._setOrigin(n),typeof r.focus=="function"&&r.focus(s))}ngOnDestroy(){this._elementInfo.forEach((e,n)=>this.stopMonitoring(n))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:e&&this._isLastInteractionFromInputLabel(e)?"mouse":"program"}_shouldBeAttributedToTouch(e){return this._detectionMode===sx.EVENTUAL||!!e?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(e,n){e.classList.toggle("cdk-focused",!!n),e.classList.toggle("cdk-touch-focused",n==="touch"),e.classList.toggle("cdk-keyboard-focused",n==="keyboard"),e.classList.toggle("cdk-mouse-focused",n==="mouse"),e.classList.toggle("cdk-program-focused",n==="program")}_setOrigin(e,n=!1){this._ngZone.runOutsideAngular(()=>{if(this._origin=e,this._originFromTouchInteraction=e==="touch"&&n,this._detectionMode===sx.IMMEDIATE){clearTimeout(this._originTimeoutId);let s=this._originFromTouchInteraction?Cj:1;this._originTimeoutId=setTimeout(()=>this._origin=null,s)}})}_onFocus(e,n){let s=this._elementInfo.get(n),r=As(e);!s||!s.checkChildren&&n!==r||this._originChanged(n,this._getFocusOrigin(r),s)}_onBlur(e,n){let s=this._elementInfo.get(n);!s||s.checkChildren&&e.relatedTarget instanceof Node&&n.contains(e.relatedTarget)||(this._setClasses(n),this._emitOrigin(s,null))}_emitOrigin(e,n){e.subject.observers.length&&this._ngZone.run(()=>e.subject.next(n))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;let n=e.rootNode,s=this._rootNodeFocusListenerCount.get(n)||0;s||this._ngZone.runOutsideAngular(()=>{n.addEventListener("focus",this._rootNodeFocusAndBlurListener,OS),n.addEventListener("blur",this._rootNodeFocusAndBlurListener,OS)}),this._rootNodeFocusListenerCount.set(n,s+1),++this._monitoredElementCount===1&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Un(this._stopInputModalityDetector)).subscribe(r=>{this._setOrigin(r,!0)}))}_removeGlobalListeners(e){let n=e.rootNode;if(this._rootNodeFocusListenerCount.has(n)){let s=this._rootNodeFocusListenerCount.get(n);s>1?this._rootNodeFocusListenerCount.set(n,s-1):(n.removeEventListener("focus",this._rootNodeFocusAndBlurListener,OS),n.removeEventListener("blur",this._rootNodeFocusAndBlurListener,OS),this._rootNodeFocusListenerCount.delete(n))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,n,s){this._setClasses(e,n),this._emitOrigin(s,n),this._lastFocusOrigin=n}_getClosestElementsInfo(e){let n=[];return this._elementInfo.forEach((s,r)=>{(r===e||s.checkChildren&&r.contains(e))&&n.push([r,s])}),n}_isLastInteractionFromInputLabel(e){let{_mostRecentTarget:n,mostRecentModality:s}=this._inputModalityDetector;if(s!=="mouse"||!n||n===e||e.nodeName!=="INPUT"&&e.nodeName!=="TEXTAREA"||e.disabled)return!1;let r=e.labels;if(r){for(let y=0;y<r.length;y++)if(r[y].contains(n))return!0}return!1}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),E2=(()=>{class i{_elementRef=Z(Ii);_focusMonitor=Z(Kl);_monitorSubscription;_focusOrigin=null;cdkFocusChange=new ui;constructor(){}get focusOrigin(){return this._focusOrigin}ngAfterViewInit(){let e=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(e,e.nodeType===1&&e.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(n=>{this._focusOrigin=n,this.cdkFocusChange.emit(n)})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"},exportAs:["cdkMonitorFocus"]})}return i})();var FS=new WeakMap,to=(()=>{class i{_appRef;_injector=Z(vn);_environmentInjector=Z(Fo);load(e){let n=this._appRef=this._appRef||this._injector.get($l),s=FS.get(n);s||(s={loaders:new Set,refs:[]},FS.set(n,s),n.onDestroy(()=>{FS.get(n)?.refs.forEach(r=>r.destroy()),FS.delete(n)})),s.loaders.has(e)||(s.loaders.add(e),s.refs.push(PE(e,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Ql=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["ng-component"]],exportAs:["cdkVisuallyHidden"],decls:0,vars:0,template:function(n,s){},styles:[`.cdk-visually-hidden{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap;outline:0;-webkit-appearance:none;-moz-appearance:none;left:0}[dir=rtl] .cdk-visually-hidden{left:auto;right:0}
`],encapsulation:2,changeDetection:0})}return i})();function ly(i){return Array.isArray(i)?i:[i]}var Dj=new Set,Sm,Tj=(()=>{class i{_platform=Z(or);_nonce=Z(pb,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):YJ}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&WJ(e,this._nonce),this._matchMedia(e)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function WJ(i,t){if(!Dj.has(i))try{Sm||(Sm=document.createElement("style"),t&&Sm.setAttribute("nonce",t),Sm.setAttribute("type","text/css"),document.head.appendChild(Sm)),Sm.sheet&&(Sm.sheet.insertRule(`@media ${i} {body{ }}`,0),Dj.add(i))}catch(e){console.error(e)}}function YJ(i){return{matches:i==="all"||i==="",media:i,addListener:()=>{},removeListener:()=>{}}}var lx=(()=>{class i{_mediaMatcher=Z(Tj);_zone=Z(ki);_queries=new Map;_destroySubject=new ni;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return Mj(ly(e)).some(s=>this._registerQuery(s).mql.matches)}observe(e){let s=Mj(ly(e)).map(y=>this._registerQuery(y).observable),r=Zf(s);return r=Yh(r.pipe(mo(1)),r.pipe(K0(1),Z0(0))),r.pipe(Ui(y=>{let A={matches:!1,breakpoints:{}};return y.forEach(({matches:P,query:B})=>{A.matches=A.matches||P,A.breakpoints[B]=P}),A}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);let n=this._mediaMatcher.matchMedia(e),r={observable:new Yn(y=>{let A=P=>this._zone.run(()=>y.next(P));return n.addListener(A),()=>{n.removeListener(A)}}).pipe(go(n),Ui(({matches:y})=>({query:e,matches:y})),Un(this._destroySubject)),mql:n};return this._queries.set(e,r),r}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Mj(i){return i.map(t=>t.split(",")).reduce((t,e)=>t.concat(e)).map(t=>t.trim())}var ZJ=(()=>{class i{create(e){return typeof MutationObserver>"u"?null:new MutationObserver(e)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var LS=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({providers:[ZJ]})}return i})();var M2=(()=>{class i{_platform=Z(or);constructor(){}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return KJ(e)&&getComputedStyle(e).visibility==="visible"}isTabbable(e){if(!this._platform.isBrowser)return!1;let n=XJ(oee(e));if(n&&(Ij(n)===-1||!this.isVisible(n)))return!1;let s=e.nodeName.toLowerCase(),r=Ij(e);return e.hasAttribute("contenteditable")?r!==-1:s==="iframe"||s==="object"||this._platform.WEBKIT&&this._platform.IOS&&!nee(e)?!1:s==="audio"?e.hasAttribute("controls")?r!==-1:!1:s==="video"?r===-1?!1:r!==null?!0:this._platform.FIREFOX||e.hasAttribute("controls"):e.tabIndex>=0}isFocusable(e,n){return ree(e)&&!this.isDisabled(e)&&(n?.ignoreVisibility||this.isVisible(e))}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function XJ(i){try{return i.frameElement}catch{return null}}function KJ(i){return!!(i.offsetWidth||i.offsetHeight||typeof i.getClientRects=="function"&&i.getClientRects().length)}function QJ(i){let t=i.nodeName.toLowerCase();return t==="input"||t==="select"||t==="button"||t==="textarea"}function JJ(i){return tee(i)&&i.type=="hidden"}function eee(i){return iee(i)&&i.hasAttribute("href")}function tee(i){return i.nodeName.toLowerCase()=="input"}function iee(i){return i.nodeName.toLowerCase()=="a"}function kj(i){if(!i.hasAttribute("tabindex")||i.tabIndex===void 0)return!1;let t=i.getAttribute("tabindex");return!!(t&&!isNaN(parseInt(t,10)))}function Ij(i){if(!kj(i))return null;let t=parseInt(i.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}function nee(i){let t=i.nodeName.toLowerCase(),e=t==="input"&&i.type;return e==="text"||e==="password"||t==="select"||t==="textarea"}function ree(i){return JJ(i)?!1:QJ(i)||eee(i)||i.hasAttribute("contenteditable")||kj(i)}function oee(i){return i.ownerDocument&&i.ownerDocument.defaultView||window}var D2=class{_element;_checker;_ngZone;_document;_injector;_startAnchor;_endAnchor;_hasAttached=!1;startAnchorListener=()=>this.focusLastTabbableElement();endAnchorListener=()=>this.focusFirstTabbableElement();get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_enabled=!0;constructor(t,e,n,s,r=!1,y){this._element=t,this._checker=e,this._ngZone=n,this._document=s,this._injector=y,r||this.attachAnchors()}destroy(){let t=this._startAnchor,e=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.remove()),e&&(e.removeEventListener("focus",this.endAnchorListener),e.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return this._hasAttached?!0:(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement(t)))})}focusFirstTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement(t)))})}focusLastTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement(t)))})}_getRegionBoundary(t){let e=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);return t=="start"?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(t){let e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(e){if(!this._checker.isFocusable(e)){let n=this._getFirstTabbableElement(e);return n?.focus(t),!!n}return e.focus(t),!0}return this.focusFirstTabbableElement(t)}focusFirstTabbableElement(t){let e=this._getRegionBoundary("start");return e&&e.focus(t),!!e}focusLastTabbableElement(t){let e=this._getRegionBoundary("end");return e&&e.focus(t),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let e=t.children;for(let n=0;n<e.length;n++){let s=e[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[n]):null;if(s)return s}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let e=t.children;for(let n=e.length-1;n>=0;n--){let s=e[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[n]):null;if(s)return s}return null}_createAnchor(){let t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,e){t?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._injector?Ma(t,{injector:this._injector}):setTimeout(t)}},NS=(()=>{class i{_checker=Z(M2);_ngZone=Z(ki);_document=Z(Ki);_injector=Z(vn);constructor(){Z(to).load(Ql)}create(e,n=!1){return new D2(e,this._checker,this._ngZone,this._document,n,this._injector)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),T2=(()=>{class i{_elementRef=Z(Ii);_focusTrapFactory=Z(NS);focusTrap;_previouslyFocusedElement=null;get enabled(){return this.focusTrap?.enabled||!1}set enabled(e){this.focusTrap&&(this.focusTrap.enabled=e)}autoCapture;constructor(){Z(or).isBrowser&&(this.focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement,!0))}ngOnDestroy(){this.focusTrap?.destroy(),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null)}ngAfterContentInit(){this.focusTrap?.attachAnchors(),this.autoCapture&&this._captureFocus()}ngDoCheck(){this.focusTrap&&!this.focusTrap.hasAttached()&&this.focusTrap.attachAnchors()}ngOnChanges(e){let n=e.autoCapture;n&&!n.firstChange&&this.autoCapture&&this.focusTrap?.hasAttached()&&this._captureFocus()}_captureFocus(){this._previouslyFocusedElement=Fu(),this.focusTrap?.focusInitialElementWhenReady()}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","cdkTrapFocus",""]],inputs:{enabled:[2,"cdkTrapFocus","enabled",xi],autoCapture:[2,"cdkTrapFocusAutoCapture","autoCapture",xi]},exportAs:["cdkTrapFocus"],features:[fr]})}return i})(),Pj=new Dt("liveAnnouncerElement",{providedIn:"root",factory:Oj});function Oj(){return null}var Fj=new Dt("LIVE_ANNOUNCER_DEFAULT_OPTIONS"),aee=0,cx=(()=>{class i{_ngZone=Z(ki);_defaultOptions=Z(Fj,{optional:!0});_liveElement;_document=Z(Ki);_previousTimeout;_currentPromise;_currentResolve;constructor(){let e=Z(Pj,{optional:!0});this._liveElement=e||this._createLiveElement()}announce(e,...n){let s=this._defaultOptions,r,y;return n.length===1&&typeof n[0]=="number"?y=n[0]:[r,y]=n,this.clear(),clearTimeout(this._previousTimeout),r||(r=s&&s.politeness?s.politeness:"polite"),y==null&&s&&(y=s.duration),this._liveElement.setAttribute("aria-live",r),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(A=>this._currentResolve=A)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=e,typeof y=="number"&&(this._previousTimeout=setTimeout(()=>this.clear(),y)),this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){let e="cdk-live-announcer-element",n=this._document.getElementsByClassName(e),s=this._document.createElement("div");for(let r=0;r<n.length;r++)n[r].remove();return s.classList.add(e),s.classList.add("cdk-visually-hidden"),s.setAttribute("aria-atomic","true"),s.setAttribute("aria-live","polite"),s.id=`cdk-live-announcer-${aee++}`,this._document.body.appendChild(s),s}_exposeAnnouncerToModals(e){let n=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let s=0;s<n.length;s++){let r=n[s],y=r.getAttribute("aria-owns");y?y.indexOf(e)===-1&&r.setAttribute("aria-owns",y+" "+e):r.setAttribute("aria-owns",e)}}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var yp=function(i){return i[i.NONE=0]="NONE",i[i.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",i[i.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",i}(yp||{}),Aj="cdk-high-contrast-black-on-white",Rj="cdk-high-contrast-white-on-black",S2="cdk-high-contrast-active",zS=(()=>{class i{_platform=Z(or);_hasCheckedHighContrastMode;_document=Z(Ki);_breakpointSubscription;constructor(){this._breakpointSubscription=Z(lx).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return yp.NONE;let e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);let n=this._document.defaultView||window,s=n&&n.getComputedStyle?n.getComputedStyle(e):null,r=(s&&s.backgroundColor||"").replace(/ /g,"");switch(e.remove(),r){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return yp.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return yp.BLACK_ON_WHITE}return yp.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let e=this._document.body.classList;e.remove(S2,Aj,Rj),this._hasCheckedHighContrastMode=!0;let n=this.getHighContrastMode();n===yp.BLACK_ON_WHITE?e.add(S2,Aj):n===yp.WHITE_ON_BLACK&&e.add(S2,Rj)}}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),Dm=(()=>{class i{constructor(){Z(zS)._applyBodyHighContrastModeCssClasses()}static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({imports:[LS]})}return i})();function I2(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function Zo(i){return i==null?"":typeof i=="string"?i:`${i}px`}var see=new Dt("cdk-dir-doc",{providedIn:"root",factory:lee});function lee(){return Z(Ki)}var cee=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function Lj(i){let t=i?.toLowerCase()||"";return t==="auto"&&typeof navigator<"u"&&navigator?.language?cee.test(navigator.language)?"rtl":"ltr":t==="rtl"?"rtl":"ltr"}var vo=(()=>{class i{value="ltr";change=new ui;constructor(){let e=Z(see,{optional:!0});if(e){let n=e.body?e.body.dir:null,s=e.documentElement?e.documentElement.dir:null;this.value=Lj(n||s||"ltr")}}ngOnDestroy(){this.change.complete()}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Wc=function(i){return i[i.NORMAL=0]="NORMAL",i[i.NEGATED=1]="NEGATED",i[i.INVERTED=2]="INVERTED",i}(Wc||{}),BS,Mm;function VS(){if(Mm==null){if(typeof document!="object"||!document||typeof Element!="function"||!Element)return Mm=!1,Mm;if("scrollBehavior"in document.documentElement.style)Mm=!0;else{let i=Element.prototype.scrollTo;i?Mm=!/\{\s*\[native code\]\s*\}/.test(i.toString()):Mm=!1}}return Mm}function cy(){if(typeof document!="object"||!document)return Wc.NORMAL;if(BS==null){let i=document.createElement("div"),t=i.style;i.dir="rtl",t.width="1px",t.overflow="auto",t.visibility="hidden",t.pointerEvents="none",t.position="absolute";let e=document.createElement("div"),n=e.style;n.width="2px",n.height="1px",i.appendChild(e),document.body.appendChild(i),BS=Wc.NORMAL,i.scrollLeft===0&&(i.scrollLeft=1,BS=i.scrollLeft===0?Wc.NEGATED:Wc.INVERTED),i.remove()}return BS}var vp=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({})}return i})();function jS(i){return i&&typeof i.connect=="function"&&!(i instanceof qh)}var bp=function(i){return i[i.REPLACED=0]="REPLACED",i[i.INSERTED=1]="INSERTED",i[i.MOVED=2]="MOVED",i[i.REMOVED=3]="REMOVED",i}(bp||{}),dy=new Dt("_ViewRepeater");var dee=20,uy=(()=>{class i{_ngZone=Z(ki);_platform=Z(or);_renderer=Z(Sa).createRenderer(null,null);_cleanupGlobalListener;constructor(){}_scrolled=new ni;_scrolledCount=0;scrollContainers=new Map;register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){let n=this.scrollContainers.get(e);n&&(n.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=dee){return this._platform.isBrowser?new Yn(n=>{this._cleanupGlobalListener||(this._cleanupGlobalListener=this._ngZone.runOutsideAngular(()=>this._renderer.listen("document","scroll",()=>this._scrolled.next())));let s=e>0?this._scrolled.pipe(vC(e)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{s.unsubscribe(),this._scrolledCount--,this._scrolledCount||(this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0)}}):wi()}ngOnDestroy(){this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0,this.scrollContainers.forEach((e,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(e,n){let s=this.getAncestorScrollContainers(e);return this.scrolled(n).pipe(dr(r=>!r||s.indexOf(r)>-1))}getAncestorScrollContainers(e){let n=[];return this.scrollContainers.forEach((s,r)=>{this._scrollableContainsElement(r,e)&&n.push(r)}),n}_scrollableContainsElement(e,n){let s=Ml(n),r=e.getElementRef().nativeElement;do if(s==r)return!0;while(s=s.parentElement);return!1}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),A2=(()=>{class i{elementRef=Z(Ii);scrollDispatcher=Z(uy);ngZone=Z(ki);dir=Z(vo,{optional:!0});_scrollElement=this.elementRef.nativeElement;_destroyed=new ni;_renderer=Z(Do);_cleanupScroll;_elementScrolled=new ni;constructor(){}ngOnInit(){this._cleanupScroll=this.ngZone.runOutsideAngular(()=>this._renderer.listen(this._scrollElement,"scroll",e=>this._elementScrolled.next(e))),this.scrollDispatcher.register(this)}ngOnDestroy(){this._cleanupScroll?.(),this._elementScrolled.complete(),this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(e){let n=this.elementRef.nativeElement,s=this.dir&&this.dir.value=="rtl";e.left==null&&(e.left=s?e.end:e.start),e.right==null&&(e.right=s?e.start:e.end),e.bottom!=null&&(e.top=n.scrollHeight-n.clientHeight-e.bottom),s&&cy()!=Wc.NORMAL?(e.left!=null&&(e.right=n.scrollWidth-n.clientWidth-e.left),cy()==Wc.INVERTED?e.left=e.right:cy()==Wc.NEGATED&&(e.left=e.right?-e.right:e.right)):e.right!=null&&(e.left=n.scrollWidth-n.clientWidth-e.right),this._applyScrollToOptions(e)}_applyScrollToOptions(e){let n=this.elementRef.nativeElement;VS()?n.scrollTo(e):(e.top!=null&&(n.scrollTop=e.top),e.left!=null&&(n.scrollLeft=e.left))}measureScrollOffset(e){let n="left",s="right",r=this.elementRef.nativeElement;if(e=="top")return r.scrollTop;if(e=="bottom")return r.scrollHeight-r.clientHeight-r.scrollTop;let y=this.dir&&this.dir.value=="rtl";return e=="start"?e=y?s:n:e=="end"&&(e=y?n:s),y&&cy()==Wc.INVERTED?e==n?r.scrollWidth-r.clientWidth-r.scrollLeft:r.scrollLeft:y&&cy()==Wc.NEGATED?e==n?r.scrollLeft+r.scrollWidth-r.clientWidth:-r.scrollLeft:e==n?r.scrollLeft:r.scrollWidth-r.clientWidth-r.scrollLeft}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]})}return i})(),uee=20,xp=(()=>{class i{_platform=Z(or);_listeners;_viewportSize;_change=new ni;_document=Z(Ki,{optional:!0});constructor(){let e=Z(ki),n=Z(Sa).createRenderer(null,null);e.runOutsideAngular(()=>{if(this._platform.isBrowser){let s=r=>this._change.next(r);this._listeners=[n.listen("window","resize",s),n.listen("window","orientationchange",s)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(e=>e()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){let e=this.getViewportScrollPosition(),{width:n,height:s}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+s,right:e.left+n,height:s,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let e=this._document,n=this._getWindow(),s=e.documentElement,r=s.getBoundingClientRect(),y=-r.top||e.body.scrollTop||n.scrollY||s.scrollTop||0,A=-r.left||e.body.scrollLeft||n.scrollX||s.scrollLeft||0;return{top:y,left:A}}change(e=uee){return e>0?this._change.pipe(vC(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Nu=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({})}return i})(),dx=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({imports:[vp,Nu,vp,Nu]})}return i})();var R2={},kr=(()=>{class i{_appId=Z(pm);getId(e){return this._appId!=="ng"&&(e+=this._appId),R2.hasOwnProperty(e)||(R2[e]=0),`${e}${R2[e]++}`}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Mo(i,...t){return t.length?t.some(e=>i[e]):i.altKey||i.shiftKey||i.ctrlKey||i.metaKey}var Nj=VS(),US=class{_viewportRuler;_previousHTMLStyles={top:"",left:""};_previousScrollPosition;_isEnabled=!1;_document;constructor(t,e){this._viewportRuler=t,this._document=e}attach(){}enable(){if(this._canBeEnabled()){let t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=Zo(-this._previousScrollPosition.left),t.style.top=Zo(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){let t=this._document.documentElement,e=this._document.body,n=t.style,s=e.style,r=n.scrollBehavior||"",y=s.scrollBehavior||"";this._isEnabled=!1,n.left=this._previousHTMLStyles.left,n.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),Nj&&(n.scrollBehavior=s.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),Nj&&(n.scrollBehavior=r,s.scrollBehavior=y)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;let e=this._document.documentElement,n=this._viewportRuler.getViewportSize();return e.scrollHeight>n.height||e.scrollWidth>n.width}};var HS=class{_scrollDispatcher;_ngZone;_viewportRuler;_config;_scrollSubscription=null;_overlayRef;_initialScrollPosition;constructor(t,e,n,s){this._scrollDispatcher=t,this._ngZone=e,this._viewportRuler=n,this._config=s}attach(t){this._overlayRef,this._overlayRef=t}enable(){if(this._scrollSubscription)return;let t=this._scrollDispatcher.scrolled(0).pipe(dr(e=>!e||!this._overlayRef.overlayElement.contains(e.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{let e=this._viewportRuler.getViewportScrollPosition().top;Math.abs(e-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}_detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}},ux=class{enable(){}disable(){}attach(){}};function k2(i,t){return t.some(e=>{let n=i.bottom<e.top,s=i.top>e.bottom,r=i.right<e.left,y=i.left>e.right;return n||s||r||y})}function zj(i,t){return t.some(e=>{let n=i.top<e.top,s=i.bottom>e.bottom,r=i.left<e.left,y=i.right>e.right;return n||s||r||y})}var $S=class{_scrollDispatcher;_viewportRuler;_ngZone;_config;_scrollSubscription=null;_overlayRef;constructor(t,e,n,s){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=n,this._config=s}attach(t){this._overlayRef,this._overlayRef=t}enable(){if(!this._scrollSubscription){let t=this._config?this._config.scrollThrottle:0;this._scrollSubscription=this._scrollDispatcher.scrolled(t).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){let e=this._overlayRef.overlayElement.getBoundingClientRect(),{width:n,height:s}=this._viewportRuler.getViewportSize();k2(e,[{width:n,height:s,bottom:s,right:n,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}})}}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},$j=(()=>{class i{_scrollDispatcher=Z(uy);_viewportRuler=Z(xp);_ngZone=Z(ki);_document=Z(Ki);constructor(){}noop=()=>new ux;close=e=>new HS(this._scrollDispatcher,this._ngZone,this._viewportRuler,e);block=()=>new US(this._viewportRuler,this._document);reposition=e=>new $S(this._scrollDispatcher,this._viewportRuler,this._ngZone,e);static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),Yc=class{positionStrategy;scrollStrategy=new ux;panelClass="";hasBackdrop=!1;backdropClass="cdk-overlay-dark-backdrop";width;height;minWidth;minHeight;maxWidth;maxHeight;direction;disposeOnNavigation=!1;constructor(t){if(t){let e=Object.keys(t);for(let n of e)t[n]!==void 0&&(this[n]=t[n])}}};var GS=class{connectionPair;scrollableViewProperties;constructor(t,e){this.connectionPair=t,this.scrollableViewProperties=e}};var Gj=(()=>{class i{_attachedOverlays=[];_document=Z(Ki);_isAttached;constructor(){}ngOnDestroy(){this.detach()}add(e){this.remove(e),this._attachedOverlays.push(e)}remove(e){let n=this._attachedOverlays.indexOf(e);n>-1&&this._attachedOverlays.splice(n,1),this._attachedOverlays.length===0&&this.detach()}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),qj=(()=>{class i extends Gj{_ngZone=Z(ki);_renderer=Z(Sa).createRenderer(null,null);_cleanupKeydown;add(e){super.add(e),this._isAttached||(this._ngZone.runOutsideAngular(()=>{this._cleanupKeydown=this._renderer.listen("body","keydown",this._keydownListener)}),this._isAttached=!0)}detach(){this._isAttached&&(this._cleanupKeydown?.(),this._isAttached=!1)}_keydownListener=e=>{let n=this._attachedOverlays;for(let s=n.length-1;s>-1;s--)if(n[s]._keydownEvents.observers.length>0){this._ngZone.run(()=>n[s]._keydownEvents.next(e));break}};static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),Wj=(()=>{class i extends Gj{_platform=Z(or);_ngZone=Z(ki);_renderer=Z(Sa).createRenderer(null,null);_cursorOriginalValue;_cursorStyleIsSet=!1;_pointerDownEventTarget;_cleanups;add(e){if(super.add(e),!this._isAttached){let n=this._document.body,s={capture:!0};this._cleanups=this._ngZone.runOutsideAngular(()=>[Bo(this._renderer,n,"pointerdown",this._pointerDownListener,s),Bo(this._renderer,n,"click",this._clickListener,s),Bo(this._renderer,n,"auxclick",this._clickListener,s),Bo(this._renderer,n,"contextmenu",this._clickListener,s)]),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=n.style.cursor,n.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){this._isAttached&&(this._cleanups?.forEach(e=>e()),this._cleanups=void 0,this._platform.IOS&&this._cursorStyleIsSet&&(this._document.body.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1)}_pointerDownListener=e=>{this._pointerDownEventTarget=As(e)};_clickListener=e=>{let n=As(e),s=e.type==="click"&&this._pointerDownEventTarget?this._pointerDownEventTarget:n;this._pointerDownEventTarget=null;let r=this._attachedOverlays.slice();for(let y=r.length-1;y>-1;y--){let A=r[y];if(A._outsidePointerEvents.observers.length<1||!A.hasAttached())continue;if(Bj(A.overlayElement,n)||Bj(A.overlayElement,s))break;let P=A._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>P.next(e)):P.next(e)}};static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Bj(i,t){let e=typeof ShadowRoot<"u"&&ShadowRoot,n=t;for(;n;){if(n===i)return!0;n=e&&n instanceof ShadowRoot?n.host:n.parentNode}return!1}var Yj=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["ng-component"]],hostAttrs:["cdk-overlay-style-loader",""],decls:0,vars:0,template:function(n,s){},styles:[`.cdk-overlay-container,.cdk-global-overlay-wrapper{pointer-events:none;top:0;left:0;height:100%;width:100%}.cdk-overlay-container{position:fixed}@layer cdk-overlay{.cdk-overlay-container{z-index:1000}}.cdk-overlay-container:empty{display:none}.cdk-global-overlay-wrapper{display:flex;position:absolute}@layer cdk-overlay{.cdk-global-overlay-wrapper{z-index:1000}}.cdk-overlay-pane{position:absolute;pointer-events:auto;box-sizing:border-box;display:flex;max-width:100%;max-height:100%}@layer cdk-overlay{.cdk-overlay-pane{z-index:1000}}.cdk-overlay-backdrop{position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:auto;-webkit-tap-highlight-color:rgba(0,0,0,0);opacity:0}@layer cdk-overlay{.cdk-overlay-backdrop{z-index:1000;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}}@media(prefers-reduced-motion){.cdk-overlay-backdrop{transition-duration:1ms}}.cdk-overlay-backdrop-showing{opacity:1}@media(forced-colors: active){.cdk-overlay-backdrop-showing{opacity:.6}}@layer cdk-overlay{.cdk-overlay-dark-backdrop{background:rgba(0,0,0,.32)}}.cdk-overlay-transparent-backdrop{transition:visibility 1ms linear,opacity 1ms linear;visibility:hidden;opacity:1}.cdk-overlay-transparent-backdrop.cdk-overlay-backdrop-showing,.cdk-high-contrast-active .cdk-overlay-transparent-backdrop{opacity:0;visibility:visible}.cdk-overlay-backdrop-noop-animation{transition:none}.cdk-overlay-connected-position-bounding-box{position:absolute;display:flex;flex-direction:column;min-width:1px;min-height:1px}@layer cdk-overlay{.cdk-overlay-connected-position-bounding-box{z-index:1000}}.cdk-global-scrollblock{position:fixed;width:100%;overflow-y:scroll}
`],encapsulation:2,changeDetection:0})}return i})(),WS=(()=>{class i{_platform=Z(or);_containerElement;_document=Z(Ki);_styleLoader=Z(to);constructor(){}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._loadStyles(),this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let e="cdk-overlay-container";if(this._platform.isBrowser||I2()){let s=this._document.querySelectorAll(`.${e}[platform="server"], .${e}[platform="test"]`);for(let r=0;r<s.length;r++)s[r].remove()}let n=this._document.createElement("div");n.classList.add(e),I2()?n.setAttribute("platform","test"):this._platform.isBrowser||n.setAttribute("platform","server"),this._document.body.appendChild(n),this._containerElement=n}_loadStyles(){this._styleLoader.load(Yj)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),P2=class{_renderer;_ngZone;element;_cleanupClick;_cleanupTransitionEnd;_fallbackTimeout;constructor(t,e,n,s){this._renderer=e,this._ngZone=n,this.element=t.createElement("div"),this.element.classList.add("cdk-overlay-backdrop"),this._cleanupClick=e.listen(this.element,"click",s)}detach(){this._ngZone.runOutsideAngular(()=>{let t=this.element;clearTimeout(this._fallbackTimeout),this._cleanupTransitionEnd?.(),this._cleanupTransitionEnd=this._renderer.listen(t,"transitionend",this.dispose),this._fallbackTimeout=setTimeout(this.dispose,500),t.style.pointerEvents="none",t.classList.remove("cdk-overlay-backdrop-showing")})}dispose=()=>{clearTimeout(this._fallbackTimeout),this._cleanupClick?.(),this._cleanupTransitionEnd?.(),this._cleanupClick=this._cleanupTransitionEnd=this._fallbackTimeout=void 0,this.element.remove()}},Im=class{_portalOutlet;_host;_pane;_config;_ngZone;_keyboardDispatcher;_document;_location;_outsideClickDispatcher;_animationsDisabled;_injector;_renderer;_backdropClick=new ni;_attachments=new ni;_detachments=new ni;_positionStrategy;_scrollStrategy;_locationChanges=Tn.EMPTY;_backdropRef=null;_previousHostParent;_keydownEvents=new ni;_outsidePointerEvents=new ni;_renders=new ni;_afterRenderRef;_afterNextRenderRef;constructor(t,e,n,s,r,y,A,P,B,U=!1,J,le){this._portalOutlet=t,this._host=e,this._pane=n,this._config=s,this._ngZone=r,this._keyboardDispatcher=y,this._document=A,this._location=P,this._outsideClickDispatcher=B,this._animationsDisabled=U,this._injector=J,this._renderer=le,s.scrollStrategy&&(this._scrollStrategy=s.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=s.positionStrategy,this._afterRenderRef=Js(()=>fm(()=>{this._renders.next()},{injector:this._injector}))}get overlayElement(){return this._pane}get backdropElement(){return this._backdropRef?.element||null}get hostElement(){return this._host}attach(t){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);let e=this._portalOutlet.attach(t);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._afterNextRenderRef?.destroy(),this._afterNextRenderRef=Ma(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),typeof e?.onDestroy=="function"&&e.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();let t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){let t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._backdropRef?.dispose(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._afterNextRenderRef?.destroy(),this._previousHostParent=this._pane=this._host=this._backdropRef=null,t&&this._detachments.next(),this._detachments.complete(),this._afterRenderRef.destroy(),this._renders.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config=Ct(Ct({},this._config),t),this._updateElementSize()}setDirection(t){this._config=Xi(Ct({},this._config),{direction:t}),this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){let t=this._config.direction;return t?typeof t=="string"?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;let t=this._pane.style;t.width=Zo(this._config.width),t.height=Zo(this._config.height),t.minWidth=Zo(this._config.minWidth),t.minHeight=Zo(this._config.minHeight),t.maxWidth=Zo(this._config.maxWidth),t.maxHeight=Zo(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"":"none"}_attachBackdrop(){let t="cdk-overlay-backdrop-showing";this._backdropRef?.dispose(),this._backdropRef=new P2(this._document,this._renderer,this._ngZone,e=>{this._backdropClick.next(e)}),this._animationsDisabled&&this._backdropRef.element.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropRef.element,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropRef.element,this._host),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this._backdropRef?.element.classList.add(t))}):this._backdropRef.element.classList.add(t)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){this._animationsDisabled?(this._backdropRef?.dispose(),this._backdropRef=null):this._backdropRef?.detach()}_toggleClasses(t,e,n){let s=ly(e||[]).filter(r=>!!r);s.length&&(n?t.classList.add(...s):t.classList.remove(...s))}_detachContentWhenEmpty(){this._ngZone.runOutsideAngular(()=>{let t=this._renders.pipe(Un(Ba(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||this._pane.children.length===0)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),t.unsubscribe())})})}_disposeScrollStrategy(){let t=this._scrollStrategy;t?.disable(),t?.detach?.()}},Vj="cdk-overlay-connected-position-bounding-box",pee=/([A-Za-z%]+)$/,hy=class{_viewportRuler;_document;_platform;_overlayContainer;_overlayRef;_isInitialRender;_lastBoundingBoxSize={width:0,height:0};_isPushed=!1;_canPush=!0;_growAfterOpen=!1;_hasFlexibleDimensions=!0;_positionLocked=!1;_originRect;_overlayRect;_viewportRect;_containerRect;_viewportMargin=0;_scrollables=[];_preferredPositions=[];_origin;_pane;_isDisposed;_boundingBox;_lastPosition;_lastScrollVisibility;_positionChanges=new ni;_resizeSubscription=Tn.EMPTY;_offsetX=0;_offsetY=0;_transformOriginSelector;_appliedPanelClasses=[];_previousPushAmount;positionChanges=this._positionChanges;get positions(){return this._preferredPositions}constructor(t,e,n,s,r){this._viewportRuler=e,this._document=n,this._platform=s,this._overlayContainer=r,this.setOrigin(t)}attach(t){this._overlayRef&&this._overlayRef,this._validatePositions(),t.hostElement.classList.add(Vj),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition){this.reapplyLastPosition();return}this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let t=this._originRect,e=this._overlayRect,n=this._viewportRect,s=this._containerRect,r=[],y;for(let A of this._preferredPositions){let P=this._getOriginPoint(t,s,A),B=this._getOverlayPoint(P,e,A),U=this._getOverlayFit(B,e,n,A);if(U.isCompletelyWithinViewport){this._isPushed=!1,this._applyPosition(A,P);return}if(this._canFitWithFlexibleDimensions(U,B,n)){r.push({position:A,origin:P,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(P,A)});continue}(!y||y.overlayFit.visibleArea<U.visibleArea)&&(y={overlayFit:U,overlayPoint:B,originPoint:P,position:A,overlayRect:e})}if(r.length){let A=null,P=-1;for(let B of r){let U=B.boundingBoxRect.width*B.boundingBoxRect.height*(B.position.weight||1);U>P&&(P=U,A=B)}this._isPushed=!1,this._applyPosition(A.position,A.origin);return}if(this._canPush){this._isPushed=!0,this._applyPosition(y.position,y.originPoint);return}this._applyPosition(y.position,y.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Tm(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(Vj),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;let t=this._lastPosition;if(t){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let e=this._getOriginPoint(this._originRect,this._containerRect,t);this._applyPosition(t,e)}else this.apply()}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,t.indexOf(this._lastPosition)===-1&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,e,n){let s;if(n.originX=="center")s=t.left+t.width/2;else{let y=this._isRtl()?t.right:t.left,A=this._isRtl()?t.left:t.right;s=n.originX=="start"?y:A}e.left<0&&(s-=e.left);let r;return n.originY=="center"?r=t.top+t.height/2:r=n.originY=="top"?t.top:t.bottom,e.top<0&&(r-=e.top),{x:s,y:r}}_getOverlayPoint(t,e,n){let s;n.overlayX=="center"?s=-e.width/2:n.overlayX==="start"?s=this._isRtl()?-e.width:0:s=this._isRtl()?0:-e.width;let r;return n.overlayY=="center"?r=-e.height/2:r=n.overlayY=="top"?0:-e.height,{x:t.x+s,y:t.y+r}}_getOverlayFit(t,e,n,s){let r=Uj(e),{x:y,y:A}=t,P=this._getOffset(s,"x"),B=this._getOffset(s,"y");P&&(y+=P),B&&(A+=B);let U=0-y,J=y+r.width-n.width,le=0-A,re=A+r.height-n.height,X=this._subtractOverflows(r.width,U,J),ee=this._subtractOverflows(r.height,le,re),we=X*ee;return{visibleArea:we,isCompletelyWithinViewport:r.width*r.height===we,fitsInViewportVertically:ee===r.height,fitsInViewportHorizontally:X==r.width}}_canFitWithFlexibleDimensions(t,e,n){if(this._hasFlexibleDimensions){let s=n.bottom-e.y,r=n.right-e.x,y=jj(this._overlayRef.getConfig().minHeight),A=jj(this._overlayRef.getConfig().minWidth),P=t.fitsInViewportVertically||y!=null&&y<=s,B=t.fitsInViewportHorizontally||A!=null&&A<=r;return P&&B}return!1}_pushOverlayOnScreen(t,e,n){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};let s=Uj(e),r=this._viewportRect,y=Math.max(t.x+s.width-r.width,0),A=Math.max(t.y+s.height-r.height,0),P=Math.max(r.top-n.top-t.y,0),B=Math.max(r.left-n.left-t.x,0),U=0,J=0;return s.width<=r.width?U=B||-y:U=t.x<this._viewportMargin?r.left-n.left-t.x:0,s.height<=r.height?J=P||-A:J=t.y<this._viewportMargin?r.top-n.top-t.y:0,this._previousPushAmount={x:U,y:J},{x:t.x+U,y:t.y+J}}_applyPosition(t,e){if(this._setTransformOrigin(t),this._setOverlayElementStyles(e,t),this._setBoundingBoxStyles(e,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._positionChanges.observers.length){let n=this._getScrollVisibility();if(t!==this._lastPosition||!this._lastScrollVisibility||!fee(this._lastScrollVisibility,n)){let s=new GS(t,n);this._positionChanges.next(s)}this._lastScrollVisibility=n}this._lastPosition=t,this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;let e=this._boundingBox.querySelectorAll(this._transformOriginSelector),n,s=t.overlayY;t.overlayX==="center"?n="center":this._isRtl()?n=t.overlayX==="start"?"right":"left":n=t.overlayX==="start"?"left":"right";for(let r=0;r<e.length;r++)e[r].style.transformOrigin=`${n} ${s}`}_calculateBoundingBoxRect(t,e){let n=this._viewportRect,s=this._isRtl(),r,y,A;if(e.overlayY==="top")y=t.y,r=n.height-y+this._viewportMargin;else if(e.overlayY==="bottom")A=n.height-t.y+this._viewportMargin*2,r=n.height-A+this._viewportMargin;else{let re=Math.min(n.bottom-t.y+n.top,t.y),X=this._lastBoundingBoxSize.height;r=re*2,y=t.y-re,r>X&&!this._isInitialRender&&!this._growAfterOpen&&(y=t.y-X/2)}let P=e.overlayX==="start"&&!s||e.overlayX==="end"&&s,B=e.overlayX==="end"&&!s||e.overlayX==="start"&&s,U,J,le;if(B)le=n.width-t.x+this._viewportMargin*2,U=t.x-this._viewportMargin;else if(P)J=t.x,U=n.right-t.x;else{let re=Math.min(n.right-t.x+n.left,t.x),X=this._lastBoundingBoxSize.width;U=re*2,J=t.x-re,U>X&&!this._isInitialRender&&!this._growAfterOpen&&(J=t.x-X/2)}return{top:y,left:J,bottom:A,right:le,width:U,height:r}}_setBoundingBoxStyles(t,e){let n=this._calculateBoundingBoxRect(t,e);!this._isInitialRender&&!this._growAfterOpen&&(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));let s={};if(this._hasExactPosition())s.top=s.left="0",s.bottom=s.right=s.maxHeight=s.maxWidth="",s.width=s.height="100%";else{let r=this._overlayRef.getConfig().maxHeight,y=this._overlayRef.getConfig().maxWidth;s.height=Zo(n.height),s.top=Zo(n.top),s.bottom=Zo(n.bottom),s.width=Zo(n.width),s.left=Zo(n.left),s.right=Zo(n.right),e.overlayX==="center"?s.alignItems="center":s.alignItems=e.overlayX==="end"?"flex-end":"flex-start",e.overlayY==="center"?s.justifyContent="center":s.justifyContent=e.overlayY==="bottom"?"flex-end":"flex-start",r&&(s.maxHeight=Zo(r)),y&&(s.maxWidth=Zo(y))}this._lastBoundingBoxSize=n,Tm(this._boundingBox.style,s)}_resetBoundingBoxStyles(){Tm(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Tm(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,e){let n={},s=this._hasExactPosition(),r=this._hasFlexibleDimensions,y=this._overlayRef.getConfig();if(s){let U=this._viewportRuler.getViewportScrollPosition();Tm(n,this._getExactOverlayY(e,t,U)),Tm(n,this._getExactOverlayX(e,t,U))}else n.position="static";let A="",P=this._getOffset(e,"x"),B=this._getOffset(e,"y");P&&(A+=`translateX(${P}px) `),B&&(A+=`translateY(${B}px)`),n.transform=A.trim(),y.maxHeight&&(s?n.maxHeight=Zo(y.maxHeight):r&&(n.maxHeight="")),y.maxWidth&&(s?n.maxWidth=Zo(y.maxWidth):r&&(n.maxWidth="")),Tm(this._pane.style,n)}_getExactOverlayY(t,e,n){let s={top:"",bottom:""},r=this._getOverlayPoint(e,this._overlayRect,t);if(this._isPushed&&(r=this._pushOverlayOnScreen(r,this._overlayRect,n)),t.overlayY==="bottom"){let y=this._document.documentElement.clientHeight;s.bottom=`${y-(r.y+this._overlayRect.height)}px`}else s.top=Zo(r.y);return s}_getExactOverlayX(t,e,n){let s={left:"",right:""},r=this._getOverlayPoint(e,this._overlayRect,t);this._isPushed&&(r=this._pushOverlayOnScreen(r,this._overlayRect,n));let y;if(this._isRtl()?y=t.overlayX==="end"?"left":"right":y=t.overlayX==="end"?"right":"left",y==="right"){let A=this._document.documentElement.clientWidth;s.right=`${A-(r.x+this._overlayRect.width)}px`}else s.left=Zo(r.x);return s}_getScrollVisibility(){let t=this._getOriginRect(),e=this._pane.getBoundingClientRect(),n=this._scrollables.map(s=>s.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:zj(t,n),isOriginOutsideView:k2(t,n),isOverlayClipped:zj(e,n),isOverlayOutsideView:k2(e,n)}}_subtractOverflows(t,...e){return e.reduce((n,s)=>n-Math.max(s,0),t)}_getNarrowedViewportRect(){let t=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+t-this._viewportMargin,bottom:n.top+e-this._viewportMargin,width:t-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return this._overlayRef.getDirection()==="rtl"}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,e){return e==="x"?t.offsetX==null?this._offsetX:t.offsetX:t.offsetY==null?this._offsetY:t.offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&ly(t).forEach(e=>{e!==""&&this._appliedPanelClasses.indexOf(e)===-1&&(this._appliedPanelClasses.push(e),this._pane.classList.add(e))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){let t=this._origin;if(t instanceof Ii)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();let e=t.width||0,n=t.height||0;return{top:t.y,bottom:t.y+n,left:t.x,right:t.x+e,height:n,width:e}}};function Tm(i,t){for(let e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);return i}function jj(i){if(typeof i!="number"&&i!=null){let[t,e]=i.split(pee);return!e||e==="px"?parseFloat(t):null}return i||null}function Uj(i){return{top:Math.floor(i.top),right:Math.floor(i.right),bottom:Math.floor(i.bottom),left:Math.floor(i.left),width:Math.floor(i.width),height:Math.floor(i.height)}}function fee(i,t){return i===t?!0:i.isOriginClipped===t.isOriginClipped&&i.isOriginOutsideView===t.isOriginOutsideView&&i.isOverlayClipped===t.isOverlayClipped&&i.isOverlayOutsideView===t.isOverlayOutsideView}var Hj="cdk-global-overlay-wrapper",qS=class{_overlayRef;_cssPosition="static";_topOffset="";_bottomOffset="";_alignItems="";_xPosition="";_xOffset="";_width="";_height="";_isDisposed=!1;attach(t){let e=t.getConfig();this._overlayRef=t,this._width&&!e.width&&t.updateSize({width:this._width}),this._height&&!e.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(Hj),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._xOffset=t,this._xPosition="left",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._xOffset=t,this._xPosition="right",this}start(t=""){return this._xOffset=t,this._xPosition="start",this}end(t=""){return this._xOffset=t,this._xPosition="end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._xPosition="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;let t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:s,height:r,maxWidth:y,maxHeight:A}=n,P=(s==="100%"||s==="100vw")&&(!y||y==="100%"||y==="100vw"),B=(r==="100%"||r==="100vh")&&(!A||A==="100%"||A==="100vh"),U=this._xPosition,J=this._xOffset,le=this._overlayRef.getConfig().direction==="rtl",re="",X="",ee="";P?ee="flex-start":U==="center"?(ee="center",le?X=J:re=J):le?U==="left"||U==="end"?(ee="flex-end",re=J):(U==="right"||U==="start")&&(ee="flex-start",X=J):U==="left"||U==="start"?(ee="flex-start",re=J):(U==="right"||U==="end")&&(ee="flex-end",X=J),t.position=this._cssPosition,t.marginLeft=P?"0":re,t.marginTop=B?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=P?"0":X,e.justifyContent=ee,e.alignItems=B?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;let t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,n=e.style;e.classList.remove(Hj),n.justifyContent=n.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}},Zj=(()=>{class i{_viewportRuler=Z(xp);_document=Z(Ki);_platform=Z(or);_overlayContainer=Z(WS);constructor(){}global(){return new qS}flexibleConnectedTo(e){return new hy(e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),bo=(()=>{class i{scrollStrategies=Z($j);_overlayContainer=Z(WS);_positionBuilder=Z(Zj);_keyboardDispatcher=Z(qj);_injector=Z(vn);_ngZone=Z(ki);_document=Z(Ki);_directionality=Z(vo);_location=Z(Fd);_outsideClickDispatcher=Z(Wj);_animationsModuleType=Z(Vr,{optional:!0});_idGenerator=Z(kr);_renderer=Z(Sa).createRenderer(null,null);_appRef;_styleLoader=Z(to);constructor(){}create(e){this._styleLoader.load(Yj);let n=this._createHostElement(),s=this._createPaneElement(n),r=this._createPortalOutlet(s),y=new Yc(e);return y.direction=y.direction||this._directionality.value,new Im(r,n,s,y,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,this._animationsModuleType==="NoopAnimations",this._injector.get(Fo),this._renderer)}position(){return this._positionBuilder}_createPaneElement(e){let n=this._document.createElement("div");return n.id=this._idGenerator.getId("cdk-overlay-"),n.classList.add("cdk-overlay-pane"),e.appendChild(n),n}_createHostElement(){let e=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(e),e}_createPortalOutlet(e){return this._appRef||(this._appRef=this._injector.get($l)),new nx(e,null,this._appRef,this._injector,this._document)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),mee=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],Xj=new Dt("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{let i=Z(bo);return()=>i.scrollStrategies.reposition()}}),py=(()=>{class i{elementRef=Z(Ii);constructor(){}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"]})}return i})(),YS=(()=>{class i{_overlay=Z(bo);_dir=Z(vo,{optional:!0});_overlayRef;_templatePortal;_backdropSubscription=Tn.EMPTY;_attachSubscription=Tn.EMPTY;_detachSubscription=Tn.EMPTY;_positionSubscription=Tn.EMPTY;_offsetX;_offsetY;_position;_scrollStrategyFactory=Z(Xj);_disposeOnNavigation=!1;_ngZone=Z(ki);origin;positions;positionStrategy;get offsetX(){return this._offsetX}set offsetX(e){this._offsetX=e,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(e){this._offsetY=e,this._position&&this._updatePositionStrategy(this._position)}width;height;minWidth;minHeight;backdropClass;panelClass;viewportMargin=0;scrollStrategy;open=!1;disableClose=!1;transformOriginSelector;hasBackdrop=!1;lockPosition=!1;flexibleDimensions=!1;growAfterOpen=!1;push=!1;get disposeOnNavigation(){return this._disposeOnNavigation}set disposeOnNavigation(e){this._disposeOnNavigation=e}backdropClick=new ui;positionChange=new ui;attach=new ui;detach=new ui;overlayKeydown=new ui;overlayOutsideClick=new ui;constructor(){let e=Z(co),n=Z(yo);this._templatePortal=new Gc(e,n),this.scrollStrategy=this._scrollStrategyFactory()}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef?.dispose()}ngOnChanges(e){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef?.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),e.origin&&this.open&&this._position.apply()),e.open&&(this.open?this.attachOverlay():this.detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=mee);let e=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=e.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=e.detachments().subscribe(()=>this.detach.emit()),e.keydownEvents().subscribe(n=>{this.overlayKeydown.next(n),n.keyCode===27&&!this.disableClose&&!Mo(n)&&(n.preventDefault(),this.detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(n=>{let s=this._getOriginElement(),r=As(n);(!s||s!==r&&!s.contains(r))&&this.overlayOutsideClick.next(n)})}_buildConfig(){let e=this._position=this.positionStrategy||this._createPositionStrategy(),n=new Yc({direction:this._dir||"ltr",positionStrategy:e,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop,disposeOnNavigation:this.disposeOnNavigation});return(this.width||this.width===0)&&(n.width=this.width),(this.height||this.height===0)&&(n.height=this.height),(this.minWidth||this.minWidth===0)&&(n.minWidth=this.minWidth),(this.minHeight||this.minHeight===0)&&(n.minHeight=this.minHeight),this.backdropClass&&(n.backdropClass=this.backdropClass),this.panelClass&&(n.panelClass=this.panelClass),n}_updatePositionStrategy(e){let n=this.positions.map(s=>({originX:s.originX,originY:s.originY,overlayX:s.overlayX,overlayY:s.overlayY,offsetX:s.offsetX||this.offsetX,offsetY:s.offsetY||this.offsetY,panelClass:s.panelClass||void 0}));return e.setOrigin(this._getOrigin()).withPositions(n).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){let e=this._overlay.position().flexibleConnectedTo(this._getOrigin());return this._updatePositionStrategy(e),e}_getOrigin(){return this.origin instanceof py?this.origin.elementRef:this.origin}_getOriginElement(){return this.origin instanceof py?this.origin.elementRef.nativeElement:this.origin instanceof Ii?this.origin.nativeElement:typeof Element<"u"&&this.origin instanceof Element?this.origin:null}attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(e=>{this.backdropClick.emit(e)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(Xf(()=>this.positionChange.observers.length>0)).subscribe(e=>{this._ngZone.run(()=>this.positionChange.emit(e)),this.positionChange.observers.length===0&&this._positionSubscription.unsubscribe()})),this.open=!0}detachOverlay(){this._overlayRef?.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.open=!1}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:[0,"cdkConnectedOverlayOrigin","origin"],positions:[0,"cdkConnectedOverlayPositions","positions"],positionStrategy:[0,"cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:[0,"cdkConnectedOverlayOffsetX","offsetX"],offsetY:[0,"cdkConnectedOverlayOffsetY","offsetY"],width:[0,"cdkConnectedOverlayWidth","width"],height:[0,"cdkConnectedOverlayHeight","height"],minWidth:[0,"cdkConnectedOverlayMinWidth","minWidth"],minHeight:[0,"cdkConnectedOverlayMinHeight","minHeight"],backdropClass:[0,"cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:[0,"cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:[0,"cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:[0,"cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:[0,"cdkConnectedOverlayOpen","open"],disableClose:[0,"cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:[0,"cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:[2,"cdkConnectedOverlayHasBackdrop","hasBackdrop",xi],lockPosition:[2,"cdkConnectedOverlayLockPosition","lockPosition",xi],flexibleDimensions:[2,"cdkConnectedOverlayFlexibleDimensions","flexibleDimensions",xi],growAfterOpen:[2,"cdkConnectedOverlayGrowAfterOpen","growAfterOpen",xi],push:[2,"cdkConnectedOverlayPush","push",xi],disposeOnNavigation:[2,"cdkConnectedOverlayDisposeOnNavigation","disposeOnNavigation",xi]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],features:[fr]})}return i})();function gee(i){return()=>i.scrollStrategies.reposition()}var _ee={provide:Xj,deps:[bo],useFactory:gee},Jl=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({providers:[bo,_ee],imports:[vp,qc,dx,dx]})}return i})();function yee(i,t){}var wp=class{viewContainerRef;injector;id;role="dialog";panelClass="";hasBackdrop=!0;backdropClass="";disableClose=!1;width="";height="";minWidth;minHeight;maxWidth;maxHeight;positionStrategy;data=null;direction;ariaDescribedBy=null;ariaLabelledBy=null;ariaLabel=null;ariaModal=!1;autoFocus="first-tabbable";restoreFocus=!0;scrollStrategy;closeOnNavigation=!0;closeOnDestroy=!0;closeOnOverlayDetachments=!0;componentFactoryResolver;providers;container;templateContext};var F2=(()=>{class i extends Ou{_elementRef=Z(Ii);_focusTrapFactory=Z(NS);_config;_interactivityChecker=Z(M2);_ngZone=Z(ki);_overlayRef=Z(Im);_focusMonitor=Z(Kl);_renderer=Z(Do);_platform=Z(or);_document=Z(Ki,{optional:!0});_portalOutlet;_focusTrap=null;_elementFocusedBeforeDialogWasOpened=null;_closeInteractionType=null;_ariaLabelledByQueue=[];_changeDetectorRef=Z($n);_injector=Z(vn);_isDestroyed=!1;constructor(){super(),this._config=Z(wp,{optional:!0})||new wp,this._config.ariaLabelledBy&&this._ariaLabelledByQueue.push(this._config.ariaLabelledBy)}_addAriaLabelledBy(e){this._ariaLabelledByQueue.push(e),this._changeDetectorRef.markForCheck()}_removeAriaLabelledBy(e){let n=this._ariaLabelledByQueue.indexOf(e);n>-1&&(this._ariaLabelledByQueue.splice(n,1),this._changeDetectorRef.markForCheck())}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._isDestroyed=!0,this._restoreFocus()}attachComponentPortal(e){this._portalOutlet.hasAttached();let n=this._portalOutlet.attachComponentPortal(e);return this._contentAttached(),n}attachTemplatePortal(e){this._portalOutlet.hasAttached();let n=this._portalOutlet.attachTemplatePortal(e);return this._contentAttached(),n}attachDomPortal=e=>{this._portalOutlet.hasAttached();let n=this._portalOutlet.attachDomPortal(e);return this._contentAttached(),n};_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(e,n){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{let s=()=>{r(),y(),e.removeAttribute("tabindex")},r=this._renderer.listen(e,"blur",s),y=this._renderer.listen(e,"mousedown",s)})),e.focus(n)}_focusByCssSelector(e,n){let s=this._elementRef.nativeElement.querySelector(e);s&&this._forceFocus(s,n)}_trapFocus(e){this._isDestroyed||Ma(()=>{let n=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||n.focus(e);break;case!0:case"first-tabbable":this._focusTrap?.focusInitialElement(e)||this._focusDialogContainer(e);break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]',e);break;default:this._focusByCssSelector(this._config.autoFocus,e);break}},{injector:this._injector})}_restoreFocus(){let e=this._config.restoreFocus,n=null;if(typeof e=="string"?n=this._document.querySelector(e):typeof e=="boolean"?n=e?this._elementFocusedBeforeDialogWasOpened:null:e&&(n=e),this._config.restoreFocus&&n&&typeof n.focus=="function"){let s=Fu(),r=this._elementRef.nativeElement;(!s||s===this._document.body||s===r||r.contains(s))&&(this._focusMonitor?(this._focusMonitor.focusVia(n,this._closeInteractionType),this._closeInteractionType=null):n.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(e){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus(e)}_containsFocus(){let e=this._elementRef.nativeElement,n=Fu();return e===n||e.contains(n)}_initializeFocusTrap(){this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=Fu()))}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["cdk-dialog-container"]],viewQuery:function(n,s){if(n&1&&Bn(Xl,7),n&2){let r;Bi(r=Vi())&&(s._portalOutlet=r.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(n,s){n&2&&ji("id",s._config.id||null)("role",s._config.role)("aria-modal",s._config.ariaModal)("aria-labelledby",s._config.ariaLabel?null:s._ariaLabelledByQueue[0])("aria-label",s._config.ariaLabel)("aria-describedby",s._config.ariaDescribedBy||null)},features:[dn],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(n,s){n&1&&pt(0,yee,0,0,"ng-template",0)},dependencies:[Xl],styles:[`.cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}
`],encapsulation:2})}return i})(),hx=class{overlayRef;config;componentInstance;componentRef;containerInstance;disableClose;closed=new ni;backdropClick;keydownEvents;outsidePointerEvents;id;_detachSubscription;constructor(t,e){this.overlayRef=t,this.config=e,this.disableClose=e.disableClose,this.backdropClick=t.backdropClick(),this.keydownEvents=t.keydownEvents(),this.outsidePointerEvents=t.outsidePointerEvents(),this.id=e.id,this.keydownEvents.subscribe(n=>{n.keyCode===27&&!this.disableClose&&!Mo(n)&&(n.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=t.detachments().subscribe(()=>{e.closeOnOverlayDetachments!==!1&&this.close()})}close(t,e){if(this.containerInstance){let n=this.closed;this.containerInstance._closeInteractionType=e?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),n.next(t),n.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(t="",e=""){return this.overlayRef.updateSize({width:t,height:e}),this}addPanelClass(t){return this.overlayRef.addPanelClass(t),this}removePanelClass(t){return this.overlayRef.removePanelClass(t),this}},vee=new Dt("DialogScrollStrategy",{providedIn:"root",factory:()=>{let i=Z(bo);return()=>i.scrollStrategies.block()}}),bee=new Dt("DialogData"),xee=new Dt("DefaultDialogConfig");var L2=(()=>{class i{_overlay=Z(bo);_injector=Z(vn);_defaultOptions=Z(xee,{optional:!0});_parentDialog=Z(i,{optional:!0,skipSelf:!0});_overlayContainer=Z(WS);_idGenerator=Z(kr);_openDialogsAtThisLevel=[];_afterAllClosedAtThisLevel=new ni;_afterOpenedAtThisLevel=new ni;_ariaHiddenElements=new Map;_scrollStrategy=Z(vee);get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}afterAllClosed=wd(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(go(void 0)));constructor(){}open(e,n){let s=this._defaultOptions||new wp;n=Ct(Ct({},s),n),n.id=n.id||this._idGenerator.getId("cdk-dialog-"),n.id&&this.getDialogById(n.id);let r=this._getOverlayConfig(n),y=this._overlay.create(r),A=new hx(y,n),P=this._attachContainer(y,A,n);return A.containerInstance=P,this._attachDialogContent(e,A,P,n),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(A),A.closed.subscribe(()=>this._removeOpenDialog(A,!0)),this.afterOpened.next(A),A}closeAll(){O2(this.openDialogs,e=>e.close())}getDialogById(e){return this.openDialogs.find(n=>n.id===e)}ngOnDestroy(){O2(this._openDialogsAtThisLevel,e=>{e.config.closeOnDestroy===!1&&this._removeOpenDialog(e,!1)}),O2(this._openDialogsAtThisLevel,e=>e.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(e){let n=new Yc({positionStrategy:e.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:e.scrollStrategy||this._scrollStrategy(),panelClass:e.panelClass,hasBackdrop:e.hasBackdrop,direction:e.direction,minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight,width:e.width,height:e.height,disposeOnNavigation:e.closeOnNavigation});return e.backdropClass&&(n.backdropClass=e.backdropClass),n}_attachContainer(e,n,s){let r=s.injector||s.viewContainerRef?.injector,y=[{provide:wp,useValue:s},{provide:hx,useValue:n},{provide:Im,useValue:e}],A;s.container?typeof s.container=="function"?A=s.container:(A=s.container.type,y.push(...s.container.providers(s))):A=F2;let P=new Is(A,s.viewContainerRef,vn.create({parent:r||this._injector,providers:y}));return e.attach(P).instance}_attachDialogContent(e,n,s,r){if(e instanceof co){let y=this._createInjector(r,n,s,void 0),A={$implicit:r.data,dialogRef:n};r.templateContext&&(A=Ct(Ct({},A),typeof r.templateContext=="function"?r.templateContext():r.templateContext)),s.attachTemplatePortal(new Gc(e,null,A,y))}else{let y=this._createInjector(r,n,s,this._injector),A=s.attachComponentPortal(new Is(e,r.viewContainerRef,y));n.componentRef=A,n.componentInstance=A.instance}}_createInjector(e,n,s,r){let y=e.injector||e.viewContainerRef?.injector,A=[{provide:bee,useValue:e.data},{provide:hx,useValue:n}];return e.providers&&(typeof e.providers=="function"?A.push(...e.providers(n,e,s)):A.push(...e.providers)),e.direction&&(!y||!y.get(vo,null,{optional:!0}))&&A.push({provide:vo,useValue:{value:e.direction,change:wi()}}),vn.create({parent:y||r,providers:A})}_removeOpenDialog(e,n){let s=this.openDialogs.indexOf(e);s>-1&&(this.openDialogs.splice(s,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((r,y)=>{r?y.setAttribute("aria-hidden",r):y.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),n&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){let e=this._overlayContainer.getContainerElement();if(e.parentElement){let n=e.parentElement.children;for(let s=n.length-1;s>-1;s--){let r=n[s];r!==e&&r.nodeName!=="SCRIPT"&&r.nodeName!=="STYLE"&&!r.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(r,r.getAttribute("aria-hidden")),r.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){let e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function O2(i,t){let e=i.length;for(;e--;)t(i[e])}var Kj=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({providers:[L2],imports:[Jl,qc,Dm,qc]})}return i})();function Tl(i){return i!=null&&`${i}`!="false"}function Qj(i,t=/\s+/){let e=[];if(i!=null){let n=Array.isArray(i)?i:`${i}`.split(t);for(let s of n){let r=`${s}`.trim();r&&e.push(r)}}return e}var wee=200,ZS=class{_letterKeyStream=new ni;_items=[];_selectedItemIndex=-1;_pressedLetters=[];_skipPredicateFn;_selectedItem=new ni;selectedItem=this._selectedItem;constructor(t,e){let n=typeof e?.debounceInterval=="number"?e.debounceInterval:wee;e?.skipPredicate&&(this._skipPredicateFn=e.skipPredicate),this.setItems(t),this._setupKeyHandler(n)}destroy(){this._pressedLetters=[],this._letterKeyStream.complete(),this._selectedItem.complete()}setCurrentSelectedItemIndex(t){this._selectedItemIndex=t}setItems(t){this._items=t}handleKey(t){let e=t.keyCode;t.key&&t.key.length===1?this._letterKeyStream.next(t.key.toLocaleUpperCase()):(e>=65&&e<=90||e>=48&&e<=57)&&this._letterKeyStream.next(String.fromCharCode(e))}isTyping(){return this._pressedLetters.length>0}reset(){this._pressedLetters=[]}_setupKeyHandler(t){this._letterKeyStream.pipe(Gn(e=>this._pressedLetters.push(e)),Z0(t),dr(()=>this._pressedLetters.length>0),Ui(()=>this._pressedLetters.join("").toLocaleUpperCase())).subscribe(e=>{for(let n=1;n<this._items.length+1;n++){let s=(this._selectedItemIndex+n)%this._items.length,r=this._items[s];if(!this._skipPredicateFn?.(r)&&r.getLabel?.().toLocaleUpperCase().trim().indexOf(e)===0){this._selectedItem.next(r);break}}this._pressedLetters=[]})}};var fy=class{_items;_activeItemIndex=-1;_activeItem=Lo(null);_wrap=!1;_typeaheadSubscription=Tn.EMPTY;_itemChangesSubscription;_vertical=!0;_horizontal;_allowedModifierKeys=[];_homeAndEnd=!1;_pageUpAndDown={enabled:!1,delta:10};_effectRef;_typeahead;_skipPredicateFn=t=>t.disabled;constructor(t,e){this._items=t,t instanceof ep?this._itemChangesSubscription=t.changes.subscribe(n=>this._itemsChanged(n.toArray())):np(t)&&(this._effectRef=bb(()=>this._itemsChanged(t()),{injector:e}))}tabOut=new ni;change=new ni;skipPredicate(t){return this._skipPredicateFn=t,this}withWrap(t=!0){return this._wrap=t,this}withVerticalOrientation(t=!0){return this._vertical=t,this}withHorizontalOrientation(t){return this._horizontal=t,this}withAllowedModifierKeys(t){return this._allowedModifierKeys=t,this}withTypeAhead(t=200){this._typeaheadSubscription.unsubscribe();let e=this._getItemsArray();return this._typeahead=new ZS(e,{debounceInterval:typeof t=="number"?t:void 0,skipPredicate:n=>this._skipPredicateFn(n)}),this._typeaheadSubscription=this._typeahead.selectedItem.subscribe(n=>{this.setActiveItem(n)}),this}cancelTypeahead(){return this._typeahead?.reset(),this}withHomeAndEnd(t=!0){return this._homeAndEnd=t,this}withPageUpDown(t=!0,e=10){return this._pageUpAndDown={enabled:t,delta:e},this}setActiveItem(t){let e=this._activeItem();this.updateActiveItem(t),this._activeItem()!==e&&this.change.next(this._activeItemIndex)}onKeydown(t){let e=t.keyCode,s=["altKey","ctrlKey","metaKey","shiftKey"].every(r=>!t[r]||this._allowedModifierKeys.indexOf(r)>-1);switch(e){case 9:this.tabOut.next();return;case 40:if(this._vertical&&s){this.setNextItemActive();break}else return;case 38:if(this._vertical&&s){this.setPreviousItemActive();break}else return;case 39:if(this._horizontal&&s){this._horizontal==="rtl"?this.setPreviousItemActive():this.setNextItemActive();break}else return;case 37:if(this._horizontal&&s){this._horizontal==="rtl"?this.setNextItemActive():this.setPreviousItemActive();break}else return;case 36:if(this._homeAndEnd&&s){this.setFirstItemActive();break}else return;case 35:if(this._homeAndEnd&&s){this.setLastItemActive();break}else return;case 33:if(this._pageUpAndDown.enabled&&s){let r=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(r>0?r:0,1);break}else return;case 34:if(this._pageUpAndDown.enabled&&s){let r=this._activeItemIndex+this._pageUpAndDown.delta,y=this._getItemsArray().length;this._setActiveItemByIndex(r<y?r:y-1,-1);break}else return;default:(s||Mo(t,"shiftKey"))&&this._typeahead?.handleKey(t);return}this._typeahead?.reset(),t.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem()}isTyping(){return!!this._typeahead&&this._typeahead.isTyping()}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._getItemsArray().length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(t){let e=this._getItemsArray(),n=typeof t=="number"?t:e.indexOf(t),s=e[n];this._activeItem.set(s??null),this._activeItemIndex=n,this._typeahead?.setCurrentSelectedItemIndex(n)}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._effectRef?.destroy(),this._typeahead?.destroy(),this.tabOut.complete(),this.change.complete()}_setActiveItemByDelta(t){this._wrap?this._setActiveInWrapMode(t):this._setActiveInDefaultMode(t)}_setActiveInWrapMode(t){let e=this._getItemsArray();for(let n=1;n<=e.length;n++){let s=(this._activeItemIndex+t*n+e.length)%e.length,r=e[s];if(!this._skipPredicateFn(r)){this.setActiveItem(s);return}}}_setActiveInDefaultMode(t){this._setActiveItemByIndex(this._activeItemIndex+t,t)}_setActiveItemByIndex(t,e){let n=this._getItemsArray();if(n[t]){for(;this._skipPredicateFn(n[t]);)if(t+=e,!n[t])return;this.setActiveItem(t)}}_getItemsArray(){return np(this._items)?this._items():this._items instanceof ep?this._items.toArray():this._items}_itemsChanged(t){this._typeahead?.setItems(t);let e=this._activeItem();if(e){let n=t.indexOf(e);n>-1&&n!==this._activeItemIndex&&(this._activeItemIndex=n,this._typeahead?.setCurrentSelectedItemIndex(n))}}};var mx=class extends fy{setActiveItem(t){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(t),this.activeItem&&this.activeItem.setActiveStyles()}};var gx=class extends fy{_origin="program";setFocusOrigin(t){return this._origin=t,this}setActiveItem(t){super.setActiveItem(t),this.activeItem&&this.activeItem.focus(this._origin)}};var tU=" ";function B2(i,t,e){let n=JS(i,t);e=e.trim(),!n.some(s=>s.trim()===e)&&(n.push(e),i.setAttribute(t,n.join(tU)))}function eD(i,t,e){let n=JS(i,t);e=e.trim();let s=n.filter(r=>r!==e);s.length?i.setAttribute(t,s.join(tU)):i.removeAttribute(t)}function JS(i,t){return i.getAttribute(t)?.match(/\S+/g)??[]}var iU="cdk-describedby-message",QS="cdk-describedby-host",z2=0,nU=(()=>{class i{_platform=Z(or);_document=Z(Ki);_messageRegistry=new Map;_messagesContainer=null;_id=`${z2++}`;constructor(){Z(to).load(Ql),this._id=Z(pm)+"-"+z2++}describe(e,n,s){if(!this._canBeDescribed(e,n))return;let r=N2(n,s);typeof n!="string"?(eU(n,this._id),this._messageRegistry.set(r,{messageElement:n,referenceCount:0})):this._messageRegistry.has(r)||this._createMessageElement(n,s),this._isElementDescribedByMessage(e,r)||this._addMessageReference(e,r)}removeDescription(e,n,s){if(!n||!this._isElementNode(e))return;let r=N2(n,s);if(this._isElementDescribedByMessage(e,r)&&this._removeMessageReference(e,r),typeof n=="string"){let y=this._messageRegistry.get(r);y&&y.referenceCount===0&&this._deleteMessageElement(r)}this._messagesContainer?.childNodes.length===0&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){let e=this._document.querySelectorAll(`[${QS}="${this._id}"]`);for(let n=0;n<e.length;n++)this._removeCdkDescribedByReferenceIds(e[n]),e[n].removeAttribute(QS);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(e,n){let s=this._document.createElement("div");eU(s,this._id),s.textContent=e,n&&s.setAttribute("role",n),this._createMessagesContainer(),this._messagesContainer.appendChild(s),this._messageRegistry.set(N2(e,n),{messageElement:s,referenceCount:0})}_deleteMessageElement(e){this._messageRegistry.get(e)?.messageElement?.remove(),this._messageRegistry.delete(e)}_createMessagesContainer(){if(this._messagesContainer)return;let e="cdk-describedby-message-container",n=this._document.querySelectorAll(`.${e}[platform="server"]`);for(let r=0;r<n.length;r++)n[r].remove();let s=this._document.createElement("div");s.style.visibility="hidden",s.classList.add(e),s.classList.add("cdk-visually-hidden"),this._platform.isBrowser||s.setAttribute("platform","server"),this._document.body.appendChild(s),this._messagesContainer=s}_removeCdkDescribedByReferenceIds(e){let n=JS(e,"aria-describedby").filter(s=>s.indexOf(iU)!=0);e.setAttribute("aria-describedby",n.join(" "))}_addMessageReference(e,n){let s=this._messageRegistry.get(n);B2(e,"aria-describedby",s.messageElement.id),e.setAttribute(QS,this._id),s.referenceCount++}_removeMessageReference(e,n){let s=this._messageRegistry.get(n);s.referenceCount--,eD(e,"aria-describedby",s.messageElement.id),e.removeAttribute(QS)}_isElementDescribedByMessage(e,n){let s=JS(e,"aria-describedby"),r=this._messageRegistry.get(n),y=r&&r.messageElement.id;return!!y&&s.indexOf(y)!=-1}_canBeDescribed(e,n){if(!this._isElementNode(e))return!1;if(n&&typeof n=="object")return!0;let s=n==null?"":`${n}`.trim(),r=e.getAttribute("aria-label");return s?!r||r.trim()!==s:!1}_isElementNode(e){return e.nodeType===this._document.ELEMENT_NODE}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function N2(i,t){return typeof i=="string"?`${t||""}/${i}`:i}function eU(i,t){i.id||(i.id=`${iU}-${t}-${z2++}`)}var An=(()=>{class i{constructor(){Z(zS)._applyBodyHighContrastModeCssClasses()}static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({imports:[vp,vp]})}return i})();function Eee(i,t){}var yx=class{viewContainerRef;injector;id;role="dialog";panelClass="";hasBackdrop=!0;backdropClass="";disableClose=!1;width="";height="";minWidth;minHeight;maxWidth;maxHeight;position;data=null;direction;ariaDescribedBy=null;ariaLabelledBy=null;ariaLabel=null;ariaModal=!1;autoFocus="first-tabbable";restoreFocus=!0;delayFocusTrap=!0;scrollStrategy;closeOnNavigation=!0;componentFactoryResolver;enterAnimationDuration;exitAnimationDuration},V2="mdc-dialog--open",rU="mdc-dialog--opening",oU="mdc-dialog--closing",See=150,Dee=75,lU=(()=>{class i extends F2{_animationMode=Z(Vr,{optional:!0});_animationStateChanged=new ui;_animationsEnabled=this._animationMode!=="NoopAnimations";_actionSectionCount=0;_hostElement=this._elementRef.nativeElement;_enterAnimationDuration=this._animationsEnabled?sU(this._config.enterAnimationDuration)??See:0;_exitAnimationDuration=this._animationsEnabled?sU(this._config.exitAnimationDuration)??Dee:0;_animationTimer=null;_contentAttached(){super._contentAttached(),this._startOpenAnimation()}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(aU,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(rU,V2)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(V2),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(V2),this._animationsEnabled?(this._hostElement.style.setProperty(aU,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(oU)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_updateActionSectionCount(e){this._actionSectionCount+=e,this._changeDetectorRef.markForCheck()}_finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)};_finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})};_clearAnimationClasses(){this._hostElement.classList.remove(rU,oU)}_waitForAnimationToComplete(e,n){this._animationTimer!==null&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(n,e)}_requestAnimationFrame(e){this._ngZone.runOutsideAngular(()=>{typeof requestAnimationFrame=="function"?requestAnimationFrame(e):e()})}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(e){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:e})}ngOnDestroy(){super.ngOnDestroy(),this._animationTimer!==null&&clearTimeout(this._animationTimer)}attachComponentPortal(e){let n=super.attachComponentPortal(e);return n.location.nativeElement.classList.add("mat-mdc-dialog-component-host"),n}static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275cmp=Yt({type:i,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:10,hostBindings:function(n,s){n&2&&(Ia("id",s._config.id),ji("aria-modal",s._config.ariaModal)("role",s._config.role)("aria-labelledby",s._config.ariaLabel?null:s._ariaLabelledByQueue[0])("aria-label",s._config.ariaLabel)("aria-describedby",s._config.ariaDescribedBy||null),Ai("_mat-animation-noopable",!s._animationsEnabled)("mat-mdc-dialog-container-with-actions",s._actionSectionCount>0))},features:[dn],decls:3,vars:0,consts:[[1,"mat-mdc-dialog-inner-container","mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(n,s){n&1&&(oe(0,"div",0)(1,"div",1),pt(2,Eee,0,0,"ng-template",2),ae()())},dependencies:[Xl],styles:[`.mat-mdc-dialog-container{width:100%;height:100%;display:block;box-sizing:border-box;max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;outline:0}.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-max-width, 560px);min-width:var(--mat-dialog-container-min-width, 280px)}@media(max-width: 599px){.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-small-max-width, calc(100vw - 32px))}}.mat-mdc-dialog-inner-container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;opacity:0;transition:opacity linear var(--mat-dialog-transition-duration, 0ms);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mdc-dialog--closing .mat-mdc-dialog-inner-container{transition:opacity 75ms linear;transform:none}.mdc-dialog--open .mat-mdc-dialog-inner-container{opacity:1}._mat-animation-noopable .mat-mdc-dialog-inner-container{transition:none}.mat-mdc-dialog-surface{display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;width:100%;height:100%;position:relative;overflow-y:auto;outline:0;transform:scale(0.8);transition:transform var(--mat-dialog-transition-duration, 0ms) cubic-bezier(0, 0, 0.2, 1);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;box-shadow:var(--mat-dialog-container-elevation-shadow, none);border-radius:var(--mdc-dialog-container-shape, var(--mat-sys-corner-extra-large, 4px));background-color:var(--mdc-dialog-container-color, var(--mat-sys-surface, white))}[dir=rtl] .mat-mdc-dialog-surface{text-align:right}.mdc-dialog--open .mat-mdc-dialog-surface,.mdc-dialog--closing .mat-mdc-dialog-surface{transform:none}._mat-animation-noopable .mat-mdc-dialog-surface{transition:none}.mat-mdc-dialog-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mat-mdc-dialog-title{display:block;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:var(--mat-dialog-headline-padding, 6px 24px 13px)}.mat-mdc-dialog-title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mat-mdc-dialog-title{text-align:right}.mat-mdc-dialog-container .mat-mdc-dialog-title{color:var(--mdc-dialog-subhead-color, var(--mat-sys-on-surface, rgba(0, 0, 0, 0.87)));font-family:var(--mdc-dialog-subhead-font, var(--mat-sys-headline-small-font, inherit));line-height:var(--mdc-dialog-subhead-line-height, var(--mat-sys-headline-small-line-height, 1.5rem));font-size:var(--mdc-dialog-subhead-size, var(--mat-sys-headline-small-size, 1rem));font-weight:var(--mdc-dialog-subhead-weight, var(--mat-sys-headline-small-weight, 400));letter-spacing:var(--mdc-dialog-subhead-tracking, var(--mat-sys-headline-small-tracking, 0.03125em))}.mat-mdc-dialog-content{display:block;flex-grow:1;box-sizing:border-box;margin:0;overflow:auto;max-height:65vh}.mat-mdc-dialog-content>:first-child{margin-top:0}.mat-mdc-dialog-content>:last-child{margin-bottom:0}.mat-mdc-dialog-container .mat-mdc-dialog-content{color:var(--mdc-dialog-supporting-text-color, var(--mat-sys-on-surface-variant, rgba(0, 0, 0, 0.6)));font-family:var(--mdc-dialog-supporting-text-font, var(--mat-sys-body-medium-font, inherit));line-height:var(--mdc-dialog-supporting-text-line-height, var(--mat-sys-body-medium-line-height, 1.5rem));font-size:var(--mdc-dialog-supporting-text-size, var(--mat-sys-body-medium-size, 1rem));font-weight:var(--mdc-dialog-supporting-text-weight, var(--mat-sys-body-medium-weight, 400));letter-spacing:var(--mdc-dialog-supporting-text-tracking, var(--mat-sys-body-medium-tracking, 0.03125em))}.mat-mdc-dialog-container .mat-mdc-dialog-content{padding:var(--mat-dialog-content-padding, 20px 24px)}.mat-mdc-dialog-container-with-actions .mat-mdc-dialog-content{padding:var(--mat-dialog-with-actions-content-padding, 20px 24px 0)}.mat-mdc-dialog-container .mat-mdc-dialog-title+.mat-mdc-dialog-content{padding-top:0}.mat-mdc-dialog-actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0);padding:var(--mat-dialog-actions-padding, 16px 24px);justify-content:var(--mat-dialog-actions-alignment, flex-end)}@media(forced-colors: active){.mat-mdc-dialog-actions{border-top-color:CanvasText}}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-start,.mat-mdc-dialog-actions[align=start]{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}.mat-mdc-dialog-component-host{display:contents}
`],encapsulation:2})}return i})(),aU="--mat-dialog-transition-duration";function sU(i){return i==null?null:typeof i=="number"?i:i.endsWith("ms")?Lu(i.substring(0,i.length-2)):i.endsWith("s")?Lu(i.substring(0,i.length-1))*1e3:i==="0"?0:null}var _x=function(i){return i[i.OPEN=0]="OPEN",i[i.CLOSING=1]="CLOSING",i[i.CLOSED=2]="CLOSED",i}(_x||{}),km=class{_ref;_containerInstance;componentInstance;componentRef;disableClose;id;_afterOpened=new ni;_beforeClosed=new ni;_result;_closeFallbackTimeout;_state=_x.OPEN;_closeInteractionType;constructor(t,e,n){this._ref=t,this._containerInstance=n,this.disableClose=e.disableClose,this.id=t.id,t.addPanelClass("mat-mdc-dialog-panel"),n._animationStateChanged.pipe(dr(s=>s.state==="opened"),mo(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),n._animationStateChanged.pipe(dr(s=>s.state==="closed"),mo(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),t.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),Ba(this.backdropClick(),this.keydownEvents().pipe(dr(s=>s.keyCode===27&&!this.disableClose&&!Mo(s)))).subscribe(s=>{this.disableClose||(s.preventDefault(),cU(this,s.type==="keydown"?"keyboard":"mouse"))})}close(t){this._result=t,this._containerInstance._animationStateChanged.pipe(dr(e=>e.state==="closing"),mo(1)).subscribe(e=>{this._beforeClosed.next(t),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),e.totalTime+100)}),this._state=_x.CLOSING,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(t){let e=this._ref.config.positionStrategy;return t&&(t.left||t.right)?t.left?e.left(t.left):e.right(t.right):e.centerHorizontally(),t&&(t.top||t.bottom)?t.top?e.top(t.top):e.bottom(t.bottom):e.centerVertically(),this._ref.updatePosition(),this}updateSize(t="",e=""){return this._ref.updateSize(t,e),this}addPanelClass(t){return this._ref.addPanelClass(t),this}removePanelClass(t){return this._ref.removePanelClass(t),this}getState(){return this._state}_finishDialogClose(){this._state=_x.CLOSED,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}};function cU(i,t,e){return i._closeInteractionType=t,i.close(e)}var tD=new Dt("MatMdcDialogData"),dU=new Dt("mat-mdc-dialog-default-options"),uU=new Dt("mat-mdc-dialog-scroll-strategy",{providedIn:"root",factory:()=>{let i=Z(bo);return()=>i.scrollStrategies.block()}});var Il=(()=>{class i{_overlay=Z(bo);_defaultOptions=Z(dU,{optional:!0});_scrollStrategy=Z(uU);_parentDialog=Z(i,{optional:!0,skipSelf:!0});_idGenerator=Z(kr);_dialog=Z(L2);_openDialogsAtThisLevel=[];_afterAllClosedAtThisLevel=new ni;_afterOpenedAtThisLevel=new ni;dialogConfigClass=yx;_dialogRefConstructor;_dialogContainerType;_dialogDataToken;get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){let e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}afterAllClosed=wd(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(go(void 0)));constructor(){this._dialogRefConstructor=km,this._dialogContainerType=lU,this._dialogDataToken=tD}open(e,n){let s;n=Ct(Ct({},this._defaultOptions||new yx),n),n.id=n.id||this._idGenerator.getId("mat-mdc-dialog-"),n.scrollStrategy=n.scrollStrategy||this._scrollStrategy();let r=this._dialog.open(e,Xi(Ct({},n),{positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:n},{provide:wp,useValue:n}]},templateContext:()=>({dialogRef:s}),providers:(y,A,P)=>(s=new this._dialogRefConstructor(y,n,P),s.updatePosition(n?.position),[{provide:this._dialogContainerType,useValue:P},{provide:this._dialogDataToken,useValue:A.data},{provide:this._dialogRefConstructor,useValue:s}])}));return s.componentRef=r.componentRef,s.componentInstance=r.componentInstance,this.openDialogs.push(s),this.afterOpened.next(s),s.afterClosed().subscribe(()=>{let y=this.openDialogs.indexOf(s);y>-1&&(this.openDialogs.splice(y,1),this.openDialogs.length||this._getAfterAllClosed().next())}),s}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(e){return this.openDialogs.find(n=>n.id===e)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(e){let n=e.length;for(;n--;)e[n].close()}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var hU=(()=>{class i{_dialogRef=Z(km,{optional:!0});_elementRef=Z(Ii);_dialog=Z(Il);constructor(){}ngOnInit(){this._dialogRef||(this._dialogRef=Mee(this._elementRef,this._dialog.openDialogs)),this._dialogRef&&Promise.resolve().then(()=>{this._onAdd()})}ngOnDestroy(){this._dialogRef?._containerInstance&&Promise.resolve().then(()=>{this._onRemove()})}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i})}return i})(),j2=(()=>{class i extends hU{id=Z(kr).getId("mat-mdc-dialog-title-");_onAdd(){this._dialogRef._containerInstance?._addAriaLabelledBy?.(this.id)}_onRemove(){this._dialogRef?._containerInstance?._removeAriaLabelledBy?.(this.id)}static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275dir=ri({type:i,selectors:[["","mat-dialog-title",""],["","matDialogTitle",""]],hostAttrs:[1,"mat-mdc-dialog-title","mdc-dialog__title"],hostVars:1,hostBindings:function(n,s){n&2&&Ia("id",s.id)},inputs:{id:"id"},exportAs:["matDialogTitle"],features:[dn]})}return i})(),U2=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-mdc-dialog-content","mdc-dialog__content"],features:[qV([A2])]})}return i})(),H2=(()=>{class i extends hU{align;_onAdd(){this._dialogRef._containerInstance?._updateActionSectionCount?.(1)}_onRemove(){this._dialogRef._containerInstance?._updateActionSectionCount?.(-1)}static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275dir=ri({type:i,selectors:[["","mat-dialog-actions",""],["mat-dialog-actions"],["","matDialogActions",""]],hostAttrs:[1,"mat-mdc-dialog-actions","mdc-dialog__actions"],hostVars:6,hostBindings:function(n,s){n&2&&Ai("mat-mdc-dialog-actions-align-start",s.align==="start")("mat-mdc-dialog-actions-align-center",s.align==="center")("mat-mdc-dialog-actions-align-end",s.align==="end")},inputs:{align:"align"},features:[dn]})}return i})();function Mee(i,t){let e=i.nativeElement.parentElement;for(;e&&!e.classList.contains("mat-mdc-dialog-container");)e=e.parentElement;return e?t.find(n=>n.id===e.id):null}var Pm=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({providers:[Il],imports:[Kj,Jl,qc,An,An]})}return i})();var my,fU=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function $2(){if(my)return my;if(typeof document!="object"||!document)return my=new Set(fU),my;let i=document.createElement("input");return my=new Set(fU.filter(t=>(i.setAttribute("type",t),i.type===t))),my}var ec=function(i){return i[i.FADING_IN=0]="FADING_IN",i[i.VISIBLE=1]="VISIBLE",i[i.FADING_OUT=2]="FADING_OUT",i[i.HIDDEN=3]="HIDDEN",i}(ec||{}),G2=class{_renderer;element;config;_animationForciblyDisabledThroughCss;state=ec.HIDDEN;constructor(t,e,n,s=!1){this._renderer=t,this.element=e,this.config=n,this._animationForciblyDisabledThroughCss=s}fadeOut(){this._renderer.fadeOutRipple(this)}},mU=_p({passive:!0,capture:!0}),q2=class{_events=new Map;addHandler(t,e,n,s){let r=this._events.get(e);if(r){let y=r.get(n);y?y.add(s):r.set(n,new Set([s]))}else this._events.set(e,new Map([[n,new Set([s])]])),t.runOutsideAngular(()=>{document.addEventListener(e,this._delegateEventHandler,mU)})}removeHandler(t,e,n){let s=this._events.get(t);if(!s)return;let r=s.get(e);r&&(r.delete(n),r.size===0&&s.delete(e),s.size===0&&(this._events.delete(t),document.removeEventListener(t,this._delegateEventHandler,mU)))}_delegateEventHandler=t=>{let e=As(t);e&&this._events.get(t.type)?.forEach((n,s)=>{(s===e||s.contains(e))&&n.forEach(r=>r.handleEvent(t))})}},vx={enterDuration:225,exitDuration:150},Tee=800,gU=_p({passive:!0,capture:!0}),_U=["mousedown","touchstart"],yU=["mouseup","mouseleave","touchend","touchcancel"],Iee=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["ng-component"]],hostAttrs:["mat-ripple-style-loader",""],decls:0,vars:0,template:function(n,s){},styles:[`.mat-ripple{overflow:hidden;position:relative}.mat-ripple:not(:empty){transform:translateZ(0)}.mat-ripple.mat-ripple-unbounded{overflow:visible}.mat-ripple-element{position:absolute;border-radius:50%;pointer-events:none;transition:opacity,transform 0ms cubic-bezier(0, 0, 0.2, 1);transform:scale3d(0, 0, 0);background-color:var(--mat-ripple-color, color-mix(in srgb, var(--mat-sys-on-surface) 10%, transparent))}@media(forced-colors: active){.mat-ripple-element{display:none}}.cdk-drag-preview .mat-ripple-element,.cdk-drag-placeholder .mat-ripple-element{display:none}
`],encapsulation:2,changeDetection:0})}return i})(),bx=class i{_target;_ngZone;_platform;_containerElement;_triggerElement;_isPointerDown=!1;_activeRipples=new Map;_mostRecentTransientRipple;_lastTouchStartEvent;_pointerUpEventsRegistered=!1;_containerRect;static _eventManager=new q2;constructor(t,e,n,s,r){this._target=t,this._ngZone=e,this._platform=s,s.isBrowser&&(this._containerElement=Ml(n)),r&&r.get(to).load(Iee)}fadeInRipple(t,e,n={}){let s=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),r=Ct(Ct({},vx),n.animation);n.centered&&(t=s.left+s.width/2,e=s.top+s.height/2);let y=n.radius||Aee(t,e,s),A=t-s.left,P=e-s.top,B=r.enterDuration,U=document.createElement("div");U.classList.add("mat-ripple-element"),U.style.left=`${A-y}px`,U.style.top=`${P-y}px`,U.style.height=`${y*2}px`,U.style.width=`${y*2}px`,n.color!=null&&(U.style.backgroundColor=n.color),U.style.transitionDuration=`${B}ms`,this._containerElement.appendChild(U);let J=window.getComputedStyle(U),le=J.transitionProperty,re=J.transitionDuration,X=le==="none"||re==="0s"||re==="0s, 0s"||s.width===0&&s.height===0,ee=new G2(this,U,n,X);U.style.transform="scale3d(1, 1, 1)",ee.state=ec.FADING_IN,n.persistent||(this._mostRecentTransientRipple=ee);let we=null;return!X&&(B||r.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let Re=()=>{we&&(we.fallbackTimer=null),clearTimeout(Te),this._finishRippleTransition(ee)},Ce=()=>this._destroyRipple(ee),Te=setTimeout(Ce,B+100);U.addEventListener("transitionend",Re),U.addEventListener("transitioncancel",Ce),we={onTransitionEnd:Re,onTransitionCancel:Ce,fallbackTimer:Te}}),this._activeRipples.set(ee,we),(X||!B)&&this._finishRippleTransition(ee),ee}fadeOutRipple(t){if(t.state===ec.FADING_OUT||t.state===ec.HIDDEN)return;let e=t.element,n=Ct(Ct({},vx),t.config.animation);e.style.transitionDuration=`${n.exitDuration}ms`,e.style.opacity="0",t.state=ec.FADING_OUT,(t._animationForciblyDisabledThroughCss||!n.exitDuration)&&this._finishRippleTransition(t)}fadeOutAll(){this._getActiveRipples().forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){let e=Ml(t);!this._platform.isBrowser||!e||e===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=e,_U.forEach(n=>{i._eventManager.addHandler(this._ngZone,n,e,this)}))}handleEvent(t){t.type==="mousedown"?this._onMousedown(t):t.type==="touchstart"?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{yU.forEach(e=>{this._triggerElement.addEventListener(e,this,gU)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(t){t.state===ec.FADING_IN?this._startFadeOutTransition(t):t.state===ec.FADING_OUT&&this._destroyRipple(t)}_startFadeOutTransition(t){let e=t===this._mostRecentTransientRipple,{persistent:n}=t.config;t.state=ec.VISIBLE,!n&&(!e||!this._isPointerDown)&&t.fadeOut()}_destroyRipple(t){let e=this._activeRipples.get(t)??null;this._activeRipples.delete(t),this._activeRipples.size||(this._containerRect=null),t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),t.state=ec.HIDDEN,e!==null&&(t.element.removeEventListener("transitionend",e.onTransitionEnd),t.element.removeEventListener("transitioncancel",e.onTransitionCancel),e.fallbackTimer!==null&&clearTimeout(e.fallbackTimer)),t.element.remove()}_onMousedown(t){let e=rx(t),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+Tee;!this._target.rippleDisabled&&!e&&!n&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!ox(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let e=t.changedTouches;if(e)for(let n=0;n<e.length;n++)this.fadeInRipple(e[n].clientX,e[n].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(t=>{let e=t.state===ec.VISIBLE||t.config.terminateOnPointerUp&&t.state===ec.FADING_IN;!t.config.persistent&&e&&t.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let t=this._triggerElement;t&&(_U.forEach(e=>i._eventManager.removeHandler(e,t,this)),this._pointerUpEventsRegistered&&(yU.forEach(e=>t.removeEventListener(e,this,gU)),this._pointerUpEventsRegistered=!1))}};function Aee(i,t,e){let n=Math.max(Math.abs(i-e.left),Math.abs(i-e.right)),s=Math.max(Math.abs(t-e.top),Math.abs(t-e.bottom));return Math.sqrt(n*n+s*s)}var xx=new Dt("mat-ripple-global-options"),iD=(()=>{class i{_elementRef=Z(Ii);_animationMode=Z(Vr,{optional:!0});color;unbounded;centered;radius=0;animation;get disabled(){return this._disabled}set disabled(e){e&&this.fadeOutAllNonPersistent(),this._disabled=e,this._setupTriggerEventsIfEnabled()}_disabled=!1;get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}_trigger;_rippleRenderer;_globalOptions;_isInitialized=!1;constructor(){let e=Z(ki),n=Z(or),s=Z(xx,{optional:!0}),r=Z(vn);this._globalOptions=s||{},this._rippleRenderer=new bx(this,e,this._elementRef,n,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Ct(Ct(Ct({},this._globalOptions.animation),this._animationMode==="NoopAnimations"?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(e,n=0,s){return typeof e=="number"?this._rippleRenderer.fadeInRipple(e,n,Ct(Ct({},this.rippleConfig),s)):this._rippleRenderer.fadeInRipple(0,0,Ct(Ct({},this.rippleConfig),e))}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(n,s){n&2&&Ai("mat-ripple-unbounded",s.unbounded)},inputs:{color:[0,"matRippleColor","color"],unbounded:[0,"matRippleUnbounded","unbounded"],centered:[0,"matRippleCentered","centered"],radius:[0,"matRippleRadius","radius"],animation:[0,"matRippleAnimation","animation"],disabled:[0,"matRippleDisabled","disabled"],trigger:[0,"matRippleTrigger","trigger"]},exportAs:["matRipple"]})}return i})();var Ree={capture:!0},kee=["focus","mousedown","mouseenter","touchstart"],W2="mat-ripple-loader-uninitialized",Y2="mat-ripple-loader-class-name",vU="mat-ripple-loader-centered",nD="mat-ripple-loader-disabled",rD=(()=>{class i{_document=Z(Ki);_animationMode=Z(Vr,{optional:!0});_globalRippleOptions=Z(xx,{optional:!0});_platform=Z(or);_ngZone=Z(ki);_injector=Z(vn);_eventCleanups;_hosts=new Map;constructor(){let e=Z(Sa).createRenderer(null,null);this._eventCleanups=this._ngZone.runOutsideAngular(()=>kee.map(n=>Bo(e,this._document,n,this._onInteraction,Ree)))}ngOnDestroy(){let e=this._hosts.keys();for(let n of e)this.destroyRipple(n);this._eventCleanups.forEach(n=>n())}configureRipple(e,n){e.setAttribute(W2,this._globalRippleOptions?.namespace??""),(n.className||!e.hasAttribute(Y2))&&e.setAttribute(Y2,n.className||""),n.centered&&e.setAttribute(vU,""),n.disabled&&e.setAttribute(nD,"")}setDisabled(e,n){let s=this._hosts.get(e);s?(s.target.rippleDisabled=n,!n&&!s.hasSetUpEvents&&(s.hasSetUpEvents=!0,s.renderer.setupTriggerEvents(e))):n?e.setAttribute(nD,""):e.removeAttribute(nD)}_onInteraction=e=>{let n=As(e);if(n instanceof HTMLElement){let s=n.closest(`[${W2}="${this._globalRippleOptions?.namespace??""}"]`);s&&this._createRipple(s)}};_createRipple(e){if(!this._document||this._hosts.has(e))return;e.querySelector(".mat-ripple")?.remove();let n=this._document.createElement("span");n.classList.add("mat-ripple",e.getAttribute(Y2)),e.append(n);let s=this._animationMode==="NoopAnimations",r=this._globalRippleOptions,y=s?0:r?.animation?.enterDuration??vx.enterDuration,A=s?0:r?.animation?.exitDuration??vx.exitDuration,P={rippleDisabled:s||r?.disabled||e.hasAttribute(nD),rippleConfig:{centered:e.hasAttribute(vU),terminateOnPointerUp:r?.terminateOnPointerUp,animation:{enterDuration:y,exitDuration:A}}},B=new bx(P,this._ngZone,n,this._platform,this._injector),U=!P.rippleDisabled;U&&B.setupTriggerEvents(e),this._hosts.set(e,{target:P,renderer:B,hasSetUpEvents:U}),e.removeAttribute(W2)}destroyRipple(e){let n=this._hosts.get(e);n&&(n.renderer._removeTriggerEvents(),this._hosts.delete(e))}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Zc=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["structural-styles"]],decls:0,vars:0,template:function(n,s){},styles:[`.mat-focus-indicator{position:relative}.mat-focus-indicator::before{top:0;left:0;right:0;bottom:0;position:absolute;box-sizing:border-box;pointer-events:none;display:var(--mat-focus-indicator-display, none);border-width:var(--mat-focus-indicator-border-width, 3px);border-style:var(--mat-focus-indicator-border-style, solid);border-color:var(--mat-focus-indicator-border-color, transparent);border-radius:var(--mat-focus-indicator-border-radius, 4px)}.mat-focus-indicator:focus::before{content:""}@media(forced-colors: active){html{--mat-focus-indicator-display: block}}
`],encapsulation:2,changeDetection:0})}return i})();var Pee=["mat-icon-button",""],Oee=["*"];var Fee=new Dt("MAT_BUTTON_CONFIG");var Lee=[{attribute:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{attribute:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{attribute:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{attribute:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{attribute:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab-base","mat-mdc-fab"]},{attribute:"mat-mini-fab",mdcClasses:["mdc-fab","mat-mdc-fab-base","mdc-fab--mini","mat-mdc-mini-fab"]},{attribute:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],Z2=(()=>{class i{_elementRef=Z(Ii);_ngZone=Z(ki);_animationMode=Z(Vr,{optional:!0});_focusMonitor=Z(Kl);_rippleLoader=Z(rD);_isFab=!1;color;get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=e,this._updateRippleDisabled()}_disableRipple=!1;get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._updateRippleDisabled()}_disabled=!1;ariaDisabled;disabledInteractive;constructor(){Z(to).load(Zc);let e=Z(Fee,{optional:!0}),n=this._elementRef.nativeElement,s=n.classList;this.disabledInteractive=e?.disabledInteractive??!1,this.color=e?.color??null,this._rippleLoader?.configureRipple(n,{className:"mat-mdc-button-ripple"});for(let{attribute:r,mdcClasses:y}of Lee)n.hasAttribute(r)&&s.add(...y)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(e="program",n){e?this._focusMonitor.focusVia(this._elementRef.nativeElement,e,n):this._elementRef.nativeElement.focus(n)}_getAriaDisabled(){return this.ariaDisabled!=null?this.ariaDisabled:this.disabled&&this.disabledInteractive?!0:null}_getDisabledAttribute(){return this.disabledInteractive||!this.disabled?null:!0}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,inputs:{color:"color",disableRipple:[2,"disableRipple","disableRipple",xi],disabled:[2,"disabled","disabled",xi],ariaDisabled:[2,"aria-disabled","ariaDisabled",xi],disabledInteractive:[2,"disabledInteractive","disabledInteractive",xi]}})}return i})();var ds=(()=>{class i extends Z2{constructor(){super(),this._rippleLoader.configureRipple(this._elementRef.nativeElement,{centered:!0})}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["button","mat-icon-button",""]],hostVars:14,hostBindings:function(n,s){n&2&&(ji("disabled",s._getDisabledAttribute())("aria-disabled",s._getAriaDisabled()),Ts(s.color?"mat-"+s.color:""),Ai("mat-mdc-button-disabled",s.disabled)("mat-mdc-button-disabled-interactive",s.disabledInteractive)("_mat-animation-noopable",s._animationMode==="NoopAnimations")("mat-unthemed",!s.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],features:[dn],attrs:Pee,ngContentSelectors:Oee,decls:4,vars:0,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(n,s){n&1&&(xr(),Et(0,"span",0),an(1),Et(2,"span",1)(3,"span",2))},styles:[`.mat-mdc-icon-button{-webkit-user-select:none;user-select:none;display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;z-index:0;overflow:visible;border-radius:50%;flex-shrink:0;text-align:center;width:var(--mdc-icon-button-state-layer-size, 40px);height:var(--mdc-icon-button-state-layer-size, 40px);padding:calc(calc(var(--mdc-icon-button-state-layer-size, 40px) - var(--mdc-icon-button-icon-size, 24px)) / 2);font-size:var(--mdc-icon-button-icon-size, 24px);color:var(--mdc-icon-button-icon-color, var(--mat-sys-on-surface-variant));-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-icon-button .mdc-button__label,.mat-mdc-icon-button .mat-icon{z-index:1;position:relative}.mat-mdc-icon-button .mat-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus>.mat-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-icon-button-ripple-color, color-mix(in srgb, var(--mat-sys-on-surface-variant) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-icon-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-icon-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-icon-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-icon-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-icon-button-touch-target-display, block)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button[disabled],.mat-mdc-icon-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-icon-button-disabled-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-icon-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-icon-button img,.mat-mdc-icon-button svg{width:var(--mdc-icon-button-icon-size, 24px);height:var(--mdc-icon-button-icon-size, 24px);vertical-align:baseline}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button[hidden]{display:none}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}
`,`@media(forced-colors: active){.mat-mdc-button:not(.mdc-button--outlined),.mat-mdc-unelevated-button:not(.mdc-button--outlined),.mat-mdc-raised-button:not(.mdc-button--outlined),.mat-mdc-outlined-button:not(.mdc-button--outlined),.mat-mdc-icon-button.mat-mdc-icon-button,.mat-mdc-outlined-button .mdc-button__ripple{outline:solid 1px}}
`],encapsulation:2,changeDetection:0})}return i})();var gy=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({imports:[An,An]})}return i})();var Nee=["mat-button",""],zee=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],Bee=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"];var Rs=(()=>{class i extends Z2{static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275cmp=Yt({type:i,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:14,hostBindings:function(n,s){n&2&&(ji("disabled",s._getDisabledAttribute())("aria-disabled",s._getAriaDisabled()),Ts(s.color?"mat-"+s.color:""),Ai("mat-mdc-button-disabled",s.disabled)("mat-mdc-button-disabled-interactive",s.disabledInteractive)("_mat-animation-noopable",s._animationMode==="NoopAnimations")("mat-unthemed",!s.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],features:[dn],attrs:Nee,ngContentSelectors:Bee,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(n,s){n&1&&(xr(zee),Et(0,"span",0),an(1),oe(2,"span",1),an(3,1),ae(),an(4,2),Et(5,"span",2)(6,"span",3)),n&2&&Ai("mdc-button__ripple",!s._isFab)("mdc-fab__ripple",s._isFab)},styles:[`.mat-mdc-button-base{text-decoration:none}.mdc-button{-webkit-user-select:none;user-select:none;position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0);padding:0 8px}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__label{position:relative}.mat-mdc-button{padding:0 var(--mat-text-button-horizontal-padding, 12px);height:var(--mdc-text-button-container-height, 40px);font-family:var(--mdc-text-button-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mdc-text-button-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mdc-text-button-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mdc-text-button-label-text-transform);font-weight:var(--mdc-text-button-label-text-weight, var(--mat-sys-label-large-weight))}.mat-mdc-button,.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mat-sys-corner-full))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, var(--mat-sys-primary))}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-text-button-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-text-button-with-icon-horizontal-padding, 16px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-offset, -4px);margin-left:var(--mat-text-button-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-offset, -4px);margin-left:var(--mat-text-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, -4px)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-text-button-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-state-layer-color, var(--mat-sys-primary))}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-text-button-touch-target-display, block)}.mat-mdc-unelevated-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mdc-filled-button-container-height, 40px);font-family:var(--mdc-filled-button-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mdc-filled-button-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mdc-filled-button-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mdc-filled-button-label-text-transform);font-weight:var(--mdc-filled-button-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-filled-button-horizontal-padding, 24px)}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -8px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -8px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -8px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -8px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-filled-button-ripple-color, color-mix(in srgb, var(--mat-sys-on-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-state-layer-color, var(--mat-sys-on-primary))}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-unelevated-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-unelevated-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-unelevated-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-filled-button-touch-target-display, block)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, var(--mat-sys-on-primary));background-color:var(--mdc-filled-button-container-color, var(--mat-sys-primary))}.mat-mdc-unelevated-button,.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mat-sys-corner-full))}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-filled-button-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mdc-filled-button-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);box-shadow:var(--mdc-protected-button-container-elevation-shadow, var(--mat-sys-level1));height:var(--mdc-protected-button-container-height, 40px);font-family:var(--mdc-protected-button-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mdc-protected-button-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mdc-protected-button-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mdc-protected-button-label-text-transform);font-weight:var(--mdc-protected-button-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-protected-button-horizontal-padding, 24px)}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -8px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -8px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -8px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -8px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-protected-button-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-state-layer-color, var(--mat-sys-primary))}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-raised-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-raised-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-raised-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-protected-button-touch-target-display, block)}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, var(--mat-sys-primary));background-color:var(--mdc-protected-button-container-color, var(--mat-sys-surface))}.mat-mdc-raised-button,.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mat-sys-corner-full))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation-shadow, var(--mat-sys-level2))}.mat-mdc-raised-button:focus{box-shadow:var(--mdc-protected-button-focus-container-elevation-shadow, var(--mat-sys-level1))}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mdc-protected-button-pressed-container-elevation-shadow, var(--mat-sys-level1))}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-protected-button-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mdc-protected-button-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation-shadow, var(--mat-sys-level0))}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mdc-outlined-button-container-height, 40px);font-family:var(--mdc-outlined-button-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mdc-outlined-button-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mdc-outlined-button-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mdc-outlined-button-label-text-transform);font-weight:var(--mdc-outlined-button-label-text-weight, var(--mat-sys-label-large-weight));border-radius:var(--mdc-outlined-button-container-shape, var(--mat-sys-corner-full));border-width:var(--mdc-outlined-button-outline-width, 1px);padding:0 var(--mat-outlined-button-horizontal-padding, 24px)}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -8px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -8px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -8px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -8px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-outlined-button-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-state-layer-color, var(--mat-sys-primary))}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-outlined-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-outlined-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-outlined-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-outlined-button-touch-target-display, block)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, var(--mat-sys-primary));border-color:var(--mdc-outlined-button-outline-color, var(--mat-sys-outline))}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-outlined-button-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));border-color:var(--mdc-outlined-button-disabled-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-button .mat-icon,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-unelevated-button .mat-icon,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-raised-button .mat-icon,.mat-mdc-outlined-button .mdc-button__label,.mat-mdc-outlined-button .mat-icon{z-index:1;position:relative}.mat-mdc-button .mat-focus-indicator,.mat-mdc-unelevated-button .mat-focus-indicator,.mat-mdc-raised-button .mat-focus-indicator,.mat-mdc-outlined-button .mat-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus>.mat-focus-indicator::before,.mat-mdc-unelevated-button:focus>.mat-focus-indicator::before,.mat-mdc-raised-button:focus>.mat-focus-indicator::before,.mat-mdc-outlined-button:focus>.mat-focus-indicator::before{content:""}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px}.mat-mdc-unelevated-button .mat-focus-indicator::before,.mat-mdc-raised-button .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px)*-1)}
`,`@media(forced-colors: active){.mat-mdc-button:not(.mdc-button--outlined),.mat-mdc-unelevated-button:not(.mdc-button--outlined),.mat-mdc-raised-button:not(.mdc-button--outlined),.mat-mdc-outlined-button:not(.mdc-button--outlined),.mat-mdc-icon-button.mat-mdc-icon-button,.mat-mdc-outlined-button .mdc-button__ripple{outline:solid 1px}}
`],encapsulation:2,changeDetection:0})}return i})();var Wa=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({imports:[An,gy,An]})}return i})();var TU=(()=>{class i{_renderer;_elementRef;onChange=e=>{};onTouched=()=>{};constructor(e,n){this._renderer=e,this._elementRef=n}setProperty(e,n){this._renderer.setProperty(this._elementRef.nativeElement,e,n)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static \u0275fac=function(n){return new(n||i)(ai(Do),ai(Ii))};static \u0275dir=ri({type:i})}return i})(),IU=(()=>{class i extends TU{static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275dir=ri({type:i,features:[dn]})}return i})(),Ud=new Dt("");var Vee={provide:Ud,useExisting:ra(()=>io),multi:!0};function jee(){let i=Wl()?Wl().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}var Uee=new Dt(""),io=(()=>{class i extends TU{_compositionMode;_composing=!1;constructor(e,n,s){super(e,n),this._compositionMode=s,this._compositionMode==null&&(this._compositionMode=!jee())}writeValue(e){let n=e??"";this.setProperty("value",n)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static \u0275fac=function(n){return new(n||i)(ai(Do),ai(Ii),ai(Uee,8))};static \u0275dir=ri({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,s){n&1&&_t("input",function(y){return s._handleInput(y.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(y){return s._compositionEnd(y.target.value)})},standalone:!1,features:[Vn([Vee]),dn]})}return i})();function J2(i){return i==null||eP(i)===0}function eP(i){return i==null?null:Array.isArray(i)||typeof i=="string"?i.length:i instanceof Set?i.size:null}var Xc=new Dt(""),gD=new Dt(""),Hee=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,si=class{static min(t){return AU(t)}static max(t){return $ee(t)}static required(t){return RU(t)}static requiredTrue(t){return Gee(t)}static email(t){return qee(t)}static minLength(t){return Wee(t)}static maxLength(t){return kU(t)}static pattern(t){return Yee(t)}static nullValidator(t){return aD()}static compose(t){return zU(t)}static composeAsync(t){return BU(t)}};function AU(i){return t=>{if(t.value==null||i==null)return null;let e=parseFloat(t.value);return!isNaN(e)&&e<i?{min:{min:i,actual:t.value}}:null}}function $ee(i){return t=>{if(t.value==null||i==null)return null;let e=parseFloat(t.value);return!isNaN(e)&&e>i?{max:{max:i,actual:t.value}}:null}}function RU(i){return J2(i.value)?{required:!0}:null}function Gee(i){return i.value===!0?null:{required:!0}}function qee(i){return J2(i.value)||Hee.test(i.value)?null:{email:!0}}function Wee(i){return t=>{let e=t.value?.length??eP(t.value);return e===null||e===0?null:e<i?{minlength:{requiredLength:i,actualLength:e}}:null}}function kU(i){return t=>{let e=t.value?.length??eP(t.value);return e!==null&&e>i?{maxlength:{requiredLength:i,actualLength:e}}:null}}function Yee(i){if(!i)return aD;let t,e;return typeof i=="string"?(e="",i.charAt(0)!=="^"&&(e+="^"),e+=i,i.charAt(i.length-1)!=="$"&&(e+="$"),t=new RegExp(e)):(e=i.toString(),t=i),n=>{if(J2(n.value))return null;let s=n.value;return t.test(s)?null:{pattern:{requiredPattern:e,actualValue:s}}}}function aD(i){return null}function PU(i){return i!=null}function OU(i){return ap(i)?zr(i):i}function FU(i){let t={};return i.forEach(e=>{t=e!=null?Ct(Ct({},t),e):t}),Object.keys(t).length===0?null:t}function LU(i,t){return t.map(e=>e(i))}function Zee(i){return!i.validate}function NU(i){return i.map(t=>Zee(t)?t:e=>t.validate(e))}function zU(i){if(!i)return null;let t=i.filter(PU);return t.length==0?null:function(e){return FU(LU(e,t))}}function tP(i){return i!=null?zU(NU(i)):null}function BU(i){if(!i)return null;let t=i.filter(PU);return t.length==0?null:function(e){let n=LU(e,t).map(OU);return W0(n).pipe(Ui(FU))}}function iP(i){return i!=null?BU(NU(i)):null}function bU(i,t){return i===null?[t]:Array.isArray(i)?[...i,t]:[i,t]}function VU(i){return i._rawValidators}function jU(i){return i._rawAsyncValidators}function X2(i){return i?Array.isArray(i)?i:[i]:[]}function sD(i,t){return Array.isArray(i)?i.includes(t):i===t}function xU(i,t){let e=X2(t);return X2(i).forEach(s=>{sD(e,s)||e.push(s)}),e}function wU(i,t){return X2(t).filter(e=>!sD(i,e))}var lD=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=tP(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=iP(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,e){return this.control?this.control.hasError(t,e):!1}getError(t,e){return this.control?this.control.getError(t,e):null}},jd=class extends lD{name;get formDirective(){return null}get path(){return null}},Al=class extends lD{_parent=null;name=null;valueAccessor=null},cD=class{_cd;constructor(t){this._cd=t}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},Xee={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},CEe=Xi(Ct({},Xee),{"[class.ng-submitted]":"isSubmitted"}),xo=(()=>{class i extends cD{constructor(e){super(e)}static \u0275fac=function(n){return new(n||i)(ai(Al,2))};static \u0275dir=ri({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,s){n&2&&Ai("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},standalone:!1,features:[dn]})}return i})(),sa=(()=>{class i extends cD{constructor(e){super(e)}static \u0275fac=function(n){return new(n||i)(ai(jd,10))};static \u0275dir=ri({type:i,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,s){n&2&&Ai("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},standalone:!1,features:[dn]})}return i})();var wx="VALID",oD="INVALID",yy="PENDING",Cx="DISABLED",Cp=class{},dD=class extends Cp{value;source;constructor(t,e){super(),this.value=t,this.source=e}},Sx=class extends Cp{pristine;source;constructor(t,e){super(),this.pristine=t,this.source=e}},Dx=class extends Cp{touched;source;constructor(t,e){super(),this.touched=t,this.source=e}},vy=class extends Cp{status;source;constructor(t,e){super(),this.status=t,this.source=e}},uD=class extends Cp{source;constructor(t){super(),this.source=t}},hD=class extends Cp{source;constructor(t){super(),this.source=t}};function nP(i){return(_D(i)?i.validators:i)||null}function Kee(i){return Array.isArray(i)?tP(i):i||null}function rP(i,t){return(_D(t)?t.asyncValidators:i)||null}function Qee(i){return Array.isArray(i)?iP(i):i||null}function _D(i){return i!=null&&!Array.isArray(i)&&typeof i=="object"}function UU(i,t,e){let n=i.controls;if(!(t?Object.keys(n):n).length)throw new Mi(1e3,"");if(!n[e])throw new Mi(1001,"")}function HU(i,t,e){i._forEachChild((n,s)=>{if(e[s]===void 0)throw new Mi(1002,"")})}var by=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(t,e){this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get status(){return Js(this.statusReactive)}set status(t){Js(()=>this.statusReactive.set(t))}_status=Cl(()=>this.statusReactive());statusReactive=Lo(void 0);get valid(){return this.status===wx}get invalid(){return this.status===oD}get pending(){return this.status==yy}get disabled(){return this.status===Cx}get enabled(){return this.status!==Cx}errors;get pristine(){return Js(this.pristineReactive)}set pristine(t){Js(()=>this.pristineReactive.set(t))}_pristine=Cl(()=>this.pristineReactive());pristineReactive=Lo(!0);get dirty(){return!this.pristine}get touched(){return Js(this.touchedReactive)}set touched(t){Js(()=>this.touchedReactive.set(t))}_touched=Cl(()=>this.touchedReactive());touchedReactive=Lo(!1);get untouched(){return!this.touched}_events=new ni;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(xU(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(xU(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(wU(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(wU(t,this._rawAsyncValidators))}hasValidator(t){return sD(this._rawValidators,t)}hasAsyncValidator(t){return sD(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){let e=this.touched===!1;this.touched=!0;let n=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsTouched(Xi(Ct({},t),{sourceControl:n})),e&&t.emitEvent!==!1&&this._events.next(new Dx(!0,n))}markAllAsTouched(t={}){this.markAsTouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsTouched(t))}markAsUntouched(t={}){let e=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let n=t.sourceControl??this;this._forEachChild(s=>{s.markAsUntouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:n})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,n),e&&t.emitEvent!==!1&&this._events.next(new Dx(!1,n))}markAsDirty(t={}){let e=this.pristine===!0;this.pristine=!1;let n=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsDirty(Xi(Ct({},t),{sourceControl:n})),e&&t.emitEvent!==!1&&this._events.next(new Sx(!1,n))}markAsPristine(t={}){let e=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let n=t.sourceControl??this;this._forEachChild(s=>{s.markAsPristine({onlySelf:!0,emitEvent:t.emitEvent})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t,n),e&&t.emitEvent!==!1&&this._events.next(new Sx(!0,n))}markAsPending(t={}){this.status=yy;let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new vy(this.status,e)),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.markAsPending(Xi(Ct({},t),{sourceControl:e}))}disable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=Cx,this.errors=null,this._forEachChild(s=>{s.disable(Xi(Ct({},t),{onlySelf:!0}))}),this._updateValue();let n=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new dD(this.value,n)),this._events.next(new vy(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Xi(Ct({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(s=>s(!0))}enable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=wx,this._forEachChild(n=>{n.enable(Xi(Ct({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Xi(Ct({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(t,e){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine({},e),this._parent._updateTouched({},e))}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let n=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===wx||this.status===yy)&&this._runAsyncValidator(n,t.emitEvent)}let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new dD(this.value,e)),this._events.next(new vy(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(Xi(Ct({},t),{sourceControl:e}))}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Cx:wx}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t,e){if(this.asyncValidator){this.status=yy,this._hasOwnPendingAsyncValidator={emitEvent:e!==!1};let n=OU(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(s=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(s,{emitEvent:e,shouldHaveEmitted:t})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let t=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,t}return!1}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(e.emitEvent!==!1,this,e.shouldHaveEmitted)}get(t){let e=t;return e==null||(Array.isArray(e)||(e=e.split(".")),e.length===0)?null:e.reduce((n,s)=>n&&n._find(s),this)}getError(t,e){let n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t,e,n){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),(t||n)&&this._events.next(new vy(this.status,e)),this._parent&&this._parent._updateControlsErrors(t,e,n)}_initObservables(){this.valueChanges=new ui,this.statusChanges=new ui}_calculateStatus(){return this._allControlsDisabled()?Cx:this.errors?oD:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(yy)?yy:this._anyControlsHaveStatus(oD)?oD:wx}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t,e){let n=!this._anyControlsDirty(),s=this.pristine!==n;this.pristine=n,this._parent&&!t.onlySelf&&this._parent._updatePristine(t,e),s&&this._events.next(new Sx(this.pristine,e))}_updateTouched(t={},e){this.touched=this._anyControlsTouched(),this._events.next(new Dx(this.touched,e)),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,e)}_onDisabledChange=[];_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){_D(t)&&t.updateOn!=null&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){let e=this._parent&&this._parent.dirty;return!t&&!!e&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=Kee(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=Qee(this._rawAsyncValidators)}},xy=class extends by{constructor(t,e,n){super(nP(e),rP(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,n={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){HU(this,!0,t),Object.keys(t).forEach(n=>{UU(this,!0,n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t!=null&&(Object.keys(t).forEach(n=>{let s=this.controls[n];s&&s.patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((n,s)=>{n.reset(t?t[s]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,n)=>n._syncPendingControls()?!0:e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{let n=this.controls[e];n&&t(n,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(let[e,n]of Object.entries(this.controls))if(this.contains(e)&&t(n))return!0;return!1}_reduceValue(){let t={};return this._reduceChildren(t,(e,n,s)=>((n.enabled||this.disabled)&&(e[s]=n.value),e))}_reduceChildren(t,e){let n=t;return this._forEachChild((s,r)=>{n=e(n,s,r)}),n}_allControlsDisabled(){for(let t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}};var K2=class extends xy{};var Mx=new Dt("",{providedIn:"root",factory:()=>yD}),yD="always";function $U(i,t){return[...t.path,i]}function pD(i,t,e=yD){oP(i,t),t.valueAccessor.writeValue(i.value),(i.disabled||e==="always")&&t.valueAccessor.setDisabledState?.(i.disabled),ete(i,t),ite(i,t),tte(i,t),Jee(i,t)}function CU(i,t,e=!0){let n=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(n),t.valueAccessor.registerOnTouched(n)),mD(i,t),i&&(t._invokeOnDestroyCallbacks(),i._registerOnCollectionChange(()=>{}))}function fD(i,t){i.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function Jee(i,t){if(t.valueAccessor.setDisabledState){let e=n=>{t.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(e),t._registerOnDestroy(()=>{i._unregisterOnDisabledChange(e)})}}function oP(i,t){let e=VU(i);t.validator!==null?i.setValidators(bU(e,t.validator)):typeof e=="function"&&i.setValidators([e]);let n=jU(i);t.asyncValidator!==null?i.setAsyncValidators(bU(n,t.asyncValidator)):typeof n=="function"&&i.setAsyncValidators([n]);let s=()=>i.updateValueAndValidity();fD(t._rawValidators,s),fD(t._rawAsyncValidators,s)}function mD(i,t){let e=!1;if(i!==null){if(t.validator!==null){let s=VU(i);if(Array.isArray(s)&&s.length>0){let r=s.filter(y=>y!==t.validator);r.length!==s.length&&(e=!0,i.setValidators(r))}}if(t.asyncValidator!==null){let s=jU(i);if(Array.isArray(s)&&s.length>0){let r=s.filter(y=>y!==t.asyncValidator);r.length!==s.length&&(e=!0,i.setAsyncValidators(r))}}}let n=()=>{};return fD(t._rawValidators,n),fD(t._rawAsyncValidators,n),e}function ete(i,t){t.valueAccessor.registerOnChange(e=>{i._pendingValue=e,i._pendingChange=!0,i._pendingDirty=!0,i.updateOn==="change"&&GU(i,t)})}function tte(i,t){t.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,i.updateOn==="blur"&&i._pendingChange&&GU(i,t),i.updateOn!=="submit"&&i.markAsTouched()})}function GU(i,t){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function ite(i,t){let e=(n,s)=>{t.valueAccessor.writeValue(n),s&&t.viewToModelUpdate(n)};i.registerOnChange(e),t._registerOnDestroy(()=>{i._unregisterOnChange(e)})}function qU(i,t){i==null,oP(i,t)}function nte(i,t){return mD(i,t)}function WU(i,t){if(!i.hasOwnProperty("model"))return!1;let e=i.model;return e.isFirstChange()?!0:!Object.is(t,e.currentValue)}function rte(i){return Object.getPrototypeOf(i.constructor)===IU}function YU(i,t){i._syncPendingControls(),t.forEach(e=>{let n=e.control;n.updateOn==="submit"&&n._pendingChange&&(e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function ZU(i,t){if(!t)return null;Array.isArray(t);let e,n,s;return t.forEach(r=>{r.constructor===io?e=r:rte(r)?n=r:s=r}),s||n||e||null}function ote(i,t){let e=i.indexOf(t);e>-1&&i.splice(e,1)}var ate={provide:jd,useExisting:ra(()=>Om)},Ex=Promise.resolve(),Om=(()=>{class i extends jd{callSetDisabledState;get submitted(){return Js(this.submittedReactive)}_submitted=Cl(()=>this.submittedReactive());submittedReactive=Lo(!1);_directives=new Set;form;ngSubmit=new ui;options;constructor(e,n,s){super(),this.callSetDisabledState=s,this.form=new xy({},tP(e),iP(n))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){Ex.then(()=>{let n=this._findContainer(e.path);e.control=n.registerControl(e.name,e.control),pD(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){Ex.then(()=>{let n=this._findContainer(e.path);n&&n.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){Ex.then(()=>{let n=this._findContainer(e.path),s=new xy({});qU(s,e),n.registerControl(e.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){Ex.then(()=>{let n=this._findContainer(e.path);n&&n.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,n){Ex.then(()=>{this.form.get(e.path).setValue(n)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submittedReactive.set(!0),YU(this.form,this._directives),this.ngSubmit.emit(e),this.form._events.next(new uD(this.control)),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submittedReactive.set(!1),this.form._events.next(new hD(this.form))}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}static \u0275fac=function(n){return new(n||i)(ai(Xc,10),ai(gD,10),ai(Mx,8))};static \u0275dir=ri({type:i,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(n,s){n&1&&_t("submit",function(y){return s.onSubmit(y)})("reset",function(){return s.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Vn([ate]),dn]})}return i})();function EU(i,t){let e=i.indexOf(t);e>-1&&i.splice(e,1)}function SU(i){return typeof i=="object"&&i!==null&&Object.keys(i).length===2&&"value"in i&&"disabled"in i}var Wr=class extends by{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(t=null,e,n){super(nP(e),rP(n,e)),this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),_D(e)&&(e.nonNullable||e.initialValueIsDefault)&&(SU(t)?this.defaultValue=t.value:this.defaultValue=t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&e.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,e.emitViewToModelChange!==!1)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){EU(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){EU(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(t){SU(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};var ste=i=>i instanceof Wr;var lte={provide:Al,useExisting:ra(()=>Tx)},DU=Promise.resolve(),Tx=(()=>{class i extends Al{_changeDetectorRef;callSetDisabledState;control=new Wr;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new ui;constructor(e,n,s,r,y,A){super(),this._changeDetectorRef=y,this.callSetDisabledState=A,this._parent=e,this._setValidators(n),this._setAsyncValidators(s),this.valueAccessor=ZU(this,r)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){let n=e.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),WU(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){pD(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(e){DU.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){let n=e.isDisabled.currentValue,s=n!==0&&xi(n);DU.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?$U(e,this._parent):[e]}static \u0275fac=function(n){return new(n||i)(ai(jd,9),ai(Xc,10),ai(gD,10),ai(Ud,10),ai($n,8),ai(Mx,8))};static \u0275dir=ri({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Vn([lte]),dn,fr]})}return i})();var la=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return i})(),cte={provide:Ud,useExisting:ra(()=>Fm),multi:!0},Fm=(()=>{class i extends IU{writeValue(e){let n=e??"";this.setProperty("value",n)}registerOnChange(e){this.onChange=n=>{e(n==""?null:parseFloat(n))}}static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275dir=ri({type:i,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(n,s){n&1&&_t("input",function(y){return s.onChange(y.target.value)})("blur",function(){return s.onTouched()})},standalone:!1,features:[Vn([cte]),dn]})}return i})();var XU=new Dt("");var dte={provide:jd,useExisting:ra(()=>Yr)},Yr=(()=>{class i extends jd{callSetDisabledState;get submitted(){return Js(this._submittedReactive)}set submitted(e){this._submittedReactive.set(e)}_submitted=Cl(()=>this._submittedReactive());_submittedReactive=Lo(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new ui;constructor(e,n,s){super(),this.callSetDisabledState=s,this._setValidators(e),this._setAsyncValidators(n)}ngOnChanges(e){e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(mD(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){let n=this.form.get(e.path);return pD(n,e,this.callSetDisabledState),n.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),n}getControl(e){return this.form.get(e.path)}removeControl(e){CU(e.control||null,e,!1),ote(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,n){this.form.get(e.path).setValue(n)}onSubmit(e){return this._submittedReactive.set(!0),YU(this.form,this.directives),this.ngSubmit.emit(e),this.form._events.next(new uD(this.control)),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this._submittedReactive.set(!1),this.form._events.next(new hD(this.form))}_updateDomValue(){this.directives.forEach(e=>{let n=e.control,s=this.form.get(e.path);n!==s&&(CU(n||null,e),ste(s)&&(pD(s,e,this.callSetDisabledState),e.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){let n=this.form.get(e.path);qU(n,e),n.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){let n=this.form.get(e.path);n&&nte(n,e)&&n.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){oP(this.form,this),this._oldForm&&mD(this._oldForm,this)}static \u0275fac=function(n){return new(n||i)(ai(Xc,10),ai(gD,10),ai(Mx,8))};static \u0275dir=ri({type:i,selectors:[["","formGroup",""]],hostBindings:function(n,s){n&1&&_t("submit",function(y){return s.onSubmit(y)})("reset",function(){return s.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Vn([dte]),dn,fr]})}return i})();var ute={provide:Al,useExisting:ra(()=>Xo)},Xo=(()=>{class i extends Al{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(e){}model;update=new ui;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(e,n,s,r,y){super(),this._ngModelWarningConfig=y,this._parent=e,this._setValidators(n),this._setAsyncValidators(s),this.valueAccessor=ZU(this,r)}ngOnChanges(e){this._added||this._setUpControl(),WU(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return $U(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(n){return new(n||i)(ai(jd,13),ai(Xc,10),ai(gD,10),ai(Ud,10),ai(XU,8))};static \u0275dir=ri({type:i,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Vn([ute]),dn,fr]})}return i})();function hte(i){return typeof i=="number"?i:parseInt(i,10)}function pte(i){return typeof i=="number"?i:parseFloat(i)}var aP=(()=>{class i{_validator=aD;_onChange;_enabled;ngOnChanges(e){if(this.inputName in e){let n=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(n),this._validator=this._enabled?this.createValidator(n):aD,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return e!=null}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,features:[fr]})}return i})();var fte={provide:Xc,useExisting:ra(()=>sP),multi:!0},sP=(()=>{class i extends aP{min;inputName="min";normalizeInput=e=>pte(e);createValidator=e=>AU(e);static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275dir=ri({type:i,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(n,s){n&2&&ji("min",s._enabled?s.min:null)},inputs:{min:"min"},standalone:!1,features:[Vn([fte]),dn]})}return i})(),mte={provide:Xc,useExisting:ra(()=>lP),multi:!0};var lP=(()=>{class i extends aP{required;inputName="required";normalizeInput=xi;createValidator=e=>RU;enabled(e){return e}static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275dir=ri({type:i,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(n,s){n&2&&ji("required",s._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[Vn([mte]),dn]})}return i})();var gte={provide:Xc,useExisting:ra(()=>Ix),multi:!0},Ix=(()=>{class i extends aP{maxlength;inputName="maxlength";normalizeInput=e=>hte(e);createValidator=e=>kU(e);static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275dir=ri({type:i,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(n,s){n&2&&ji("maxlength",s._enabled?s.maxlength:null)},inputs:{maxlength:"maxlength"},standalone:!1,features:[Vn([gte]),dn]})}return i})();var KU=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({})}return i})(),Q2=class extends by{constructor(t,e,n){super(nP(e),rP(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,n={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(t,e={}){let n=this._adjustIndex(t);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,n={}){let s=this._adjustIndex(t);s<0&&(s=0),this.controls[s]&&this.controls[s]._registerOnCollectionChange(()=>{}),this.controls.splice(s,1),e&&(this.controls.splice(s,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){HU(this,!1,t),t.forEach((n,s)=>{UU(this,!1,s),this.at(s).setValue(n,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t!=null&&(t.forEach((n,s)=>{this.at(s)&&this.at(s).patchValue(n,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((n,s)=>{n.reset(t[s],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,n)=>n._syncPendingControls()?!0:e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,n)=>{t(e,n)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(let t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}};function MU(i){return!!i&&(i.asyncValidators!==void 0||i.validators!==void 0||i.updateOn!==void 0)}var ca=(()=>{class i{useNonNullable=!1;get nonNullable(){let e=new i;return e.useNonNullable=!0,e}group(e,n=null){let s=this._reduceControls(e),r={};return MU(n)?r=n:n!==null&&(r.validators=n.validator,r.asyncValidators=n.asyncValidator),new xy(s,r)}record(e,n=null){let s=this._reduceControls(e);return new K2(s,n)}control(e,n,s){let r={};return this.useNonNullable?(MU(n)?r=n:(r.validators=n,r.asyncValidators=s),new Wr(e,Xi(Ct({},r),{nonNullable:!0}))):new Wr(e,n,s)}array(e,n,s){let r=e.map(y=>this._createControl(y));return new Q2(r,n,s)}_reduceControls(e){let n={};return Object.keys(e).forEach(s=>{n[s]=this._createControl(e[s])}),n}_createControl(e){if(e instanceof Wr)return e;if(e instanceof by)return e;if(Array.isArray(e)){let n=e[0],s=e.length>1?e[1]:null,r=e.length>2?e[2]:null;return this.control(n,s,r)}else return this.control(e)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Ep=(()=>{class i{static withConfig(e){return{ngModule:i,providers:[{provide:Mx,useValue:e.callSetDisabledState??yD}]}}static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({imports:[KU]})}return i})(),da=(()=>{class i{static withConfig(e){return{ngModule:i,providers:[{provide:XU,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:Mx,useValue:e.callSetDisabledState??yD}]}}static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({imports:[KU]})}return i})();function _te(i,t){if(i&1){let e=bi();bn(0),oe(1,"textarea",6),Au("ngModelChange",function(s){qt(e);let r=bt();return sp(r.inputValue,s)||(r.inputValue=s),Wt(s)}),ae(),xn()}if(i&2){let e=bt();ge(),fk("placeholder",e.data.inputPlaceholder||""),Iu("ngModel",e.inputValue)}}var ks=class i{constructor(t,e){this.dialogRef=t;this.data=e;e.input&&e.inputPlaceholder&&(this.inputValue="")}inputValue="";onConfirm(){this.dialogRef.close(this.data.input?this.inputValue.trim():!0)}onCancel(){this.dialogRef.close(!1)}static \u0275fac=function(e){return new(e||i)(ai(km),ai(tD))};static \u0275cmp=Yt({type:i,selectors:[["app-confirm-dialog"]],decls:11,vars:7,consts:[["mat-dialog-title",""],[1,"dialog-content"],[4,"ngIf"],["align","end"],["mat-button","",3,"click"],["mat-flat-button","",3,"click","color","disabled"],["rows","4",1,"full-width","textarea",3,"ngModelChange","ngModel","placeholder"]],template:function(e,n){e&1&&(oe(0,"h2",0),Ee(1),ae(),oe(2,"mat-dialog-content",1)(3,"p"),Ee(4),ae(),pt(5,_te,2,2,"ng-container",2),ae(),oe(6,"mat-dialog-actions",3)(7,"button",4),_t("click",function(){return n.onCancel()}),Ee(8),ae(),oe(9,"button",5),_t("click",function(){return n.onConfirm()}),Ee(10),ae()()),e&2&&(ge(),tn(n.data.title||"Confirmar"),ge(3),tn(n.data.message),ge(),Be("ngIf",n.data.input),ge(3),zi(" ",n.data.cancelText||"Cancelar"," "),ge(),Be("color",n.data.input?"warn":"primary")("disabled",n.data.input&&!n.inputValue.trim()),ge(),zi(" ",n.data.confirmText||(n.data.input?"Enviar":"Aceptar")," "))},dependencies:[sr,Zn,Ep,io,xo,Tx,Pm,j2,H2,U2,Wa,Rs],styles:[".dialog-content[_ngcontent-%COMP%]{padding-right:16px}.textarea[_ngcontent-%COMP%]{width:90%;margin-top:1rem;font-size:14px;padding:.5rem}"]})};var QU={XSmall:"(max-width: 599.98px)",Small:"(min-width: 600px) and (max-width: 959.98px)",Medium:"(min-width: 960px) and (max-width: 1279.98px)",Large:"(min-width: 1280px) and (max-width: 1919.98px)",XLarge:"(min-width: 1920px)",Handset:"(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)",Tablet:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait), (min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",Web:"(min-width: 840px) and (orientation: portrait), (min-width: 1280px) and (orientation: landscape)",HandsetPortrait:"(max-width: 599.98px) and (orientation: portrait)",TabletPortrait:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait)",WebPortrait:"(min-width: 840px) and (orientation: portrait)",HandsetLandscape:"(max-width: 959.98px) and (orientation: landscape)",TabletLandscape:"(min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",WebLandscape:"(min-width: 1280px) and (orientation: landscape)"};function yte(i,t){if(i&1){let e=bi();oe(0,"div",1)(1,"button",2),_t("click",function(){qt(e);let s=bt();return Wt(s.action())}),Ee(2),ae()()}if(i&2){let e=bt();ge(2),zi(" ",e.data.action," ")}}var vte=["label"];function bte(i,t){}var xte=Math.pow(2,31)-1,Ax=class{_overlayRef;instance;containerInstance;_afterDismissed=new ni;_afterOpened=new ni;_onAction=new ni;_durationTimeoutId;_dismissedByAction=!1;constructor(t,e){this._overlayRef=e,this.containerInstance=t,t._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(t){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(t,xte))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}},JU=new Dt("MatSnackBarData"),wy=class{politeness="assertive";announcementMessage="";viewContainerRef;duration=0;panelClass;direction;data=null;horizontalPosition="center";verticalPosition="bottom"},wte=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"]})}return i})(),Cte=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"]})}return i})(),Ete=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"]})}return i})(),Ste=(()=>{class i{snackBarRef=Z(Ax);data=Z(JU);constructor(){}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions",""],["mat-button","","matSnackBarAction","",3,"click"]],template:function(n,s){n&1&&(oe(0,"div",0),Ee(1),ae(),pt(2,yte,3,1,"div",1)),n&2&&(ge(),zi(" ",s.data.message,`
`),ge(),un(s.hasAction?2:-1))},dependencies:[Rs,wte,Cte,Ete],styles:[`.mat-mdc-simple-snack-bar{display:flex}
`],encapsulation:2,changeDetection:0})}return i})(),cP="_mat-snack-bar-enter",dP="_mat-snack-bar-exit",Dte=(()=>{class i extends Ou{_ngZone=Z(ki);_elementRef=Z(Ii);_changeDetectorRef=Z($n);_platform=Z(or);_rendersRef;_animationsDisabled=Z(Vr,{optional:!0})==="NoopAnimations";snackBarConfig=Z(wy);_document=Z(Ki);_trackedModals=new Set;_enterFallback;_exitFallback;_renders=new ni;_announceDelay=150;_announceTimeoutId;_destroyed=!1;_portalOutlet;_onAnnounce=new ni;_onExit=new ni;_onEnter=new ni;_animationState="void";_live;_label;_role;_liveElementId=Z(kr).getId("mat-snack-bar-container-live-");constructor(){super();let e=this.snackBarConfig;e.politeness==="assertive"&&!e.announcementMessage?this._live="assertive":e.politeness==="off"?this._live="off":this._live="polite",this._platform.FIREFOX&&(this._live==="polite"&&(this._role="status"),this._live==="assertive"&&(this._role="alert")),this._rendersRef=fm(()=>this._renders.next(),{manualCleanup:!0})}attachComponentPortal(e){this._assertNotAttached();let n=this._portalOutlet.attachComponentPortal(e);return this._afterPortalAttached(),n}attachTemplatePortal(e){this._assertNotAttached();let n=this._portalOutlet.attachTemplatePortal(e);return this._afterPortalAttached(),n}attachDomPortal=e=>{this._assertNotAttached();let n=this._portalOutlet.attachDomPortal(e);return this._afterPortalAttached(),n};onAnimationEnd(e){e===dP?this._completeExit():e===cP&&(clearTimeout(this._enterFallback),this._ngZone.run(()=>{this._onEnter.next(),this._onEnter.complete()}))}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.markForCheck(),this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce(),this._animationsDisabled?this._renders.pipe(mo(1)).subscribe(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(cP)))}):(clearTimeout(this._enterFallback),this._enterFallback=setTimeout(()=>{this._elementRef.nativeElement.classList.add("mat-snack-bar-fallback-visible"),this.onAnimationEnd(cP)},200)))}exit(){return this._destroyed?wi(void 0):(this._ngZone.run(()=>{this._animationState="hidden",this._changeDetectorRef.markForCheck(),this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId),this._animationsDisabled?this._renders.pipe(mo(1)).subscribe(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(dP)))}):(clearTimeout(this._exitFallback),this._exitFallback=setTimeout(()=>this.onAnimationEnd(dP),200))}),this._onExit)}ngOnDestroy(){this._destroyed=!0,this._clearFromModals(),this._completeExit(),this._renders.complete(),this._rendersRef.destroy()}_completeExit(){clearTimeout(this._exitFallback),queueMicrotask(()=>{this._onExit.next(),this._onExit.complete()})}_afterPortalAttached(){let e=this._elementRef.nativeElement,n=this.snackBarConfig.panelClass;n&&(Array.isArray(n)?n.forEach(y=>e.classList.add(y)):e.classList.add(n)),this._exposeToModals();let s=this._label.nativeElement,r="mdc-snackbar__label";s.classList.toggle(r,!s.querySelector(`.${r}`))}_exposeToModals(){let e=this._liveElementId,n=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let s=0;s<n.length;s++){let r=n[s],y=r.getAttribute("aria-owns");this._trackedModals.add(r),y?y.indexOf(e)===-1&&r.setAttribute("aria-owns",y+" "+e):r.setAttribute("aria-owns",e)}}_clearFromModals(){this._trackedModals.forEach(e=>{let n=e.getAttribute("aria-owns");if(n){let s=n.replace(this._liveElementId,"").trim();s.length>0?e.setAttribute("aria-owns",s):e.removeAttribute("aria-owns")}}),this._trackedModals.clear()}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{if(this._destroyed)return;let e=this._elementRef.nativeElement,n=e.querySelector("[aria-hidden]"),s=e.querySelector("[aria-live]");if(n&&s){let r=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&n.contains(document.activeElement)&&(r=document.activeElement),n.removeAttribute("aria-hidden"),s.appendChild(n),r?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-snack-bar-container"]],viewQuery:function(n,s){if(n&1&&(Bn(Xl,7),Bn(vte,7)),n&2){let r;Bi(r=Vi())&&(s._portalOutlet=r.first),Bi(r=Vi())&&(s._label=r.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container"],hostVars:6,hostBindings:function(n,s){n&1&&_t("animationend",function(y){return s.onAnimationEnd(y.animationName)})("animationcancel",function(y){return s.onAnimationEnd(y.animationName)}),n&2&&Ai("mat-snack-bar-container-enter",s._animationState==="visible")("mat-snack-bar-container-exit",s._animationState==="hidden")("mat-snack-bar-container-animations-enabled",!s._animationsDisabled)},features:[dn],decls:6,vars:3,consts:[["label",""],[1,"mdc-snackbar__surface","mat-mdc-snackbar-surface"],[1,"mat-mdc-snack-bar-label"],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(n,s){n&1&&(oe(0,"div",1)(1,"div",2,0)(3,"div",3),pt(4,bte,0,0,"ng-template",4),ae(),Et(5,"div"),ae()()),n&2&&(ge(5),ji("aria-live",s._live)("role",s._role)("id",s._liveElementId))},dependencies:[Xl],styles:[`@keyframes _mat-snack-bar-enter{from{transform:scale(0.8);opacity:0}to{transform:scale(1);opacity:1}}@keyframes _mat-snack-bar-exit{from{opacity:1}to{opacity:0}}.mat-mdc-snack-bar-container{display:flex;align-items:center;justify-content:center;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);margin:8px}.mat-mdc-snack-bar-handset .mat-mdc-snack-bar-container{width:100vw}.mat-snack-bar-container-animations-enabled{opacity:0}.mat-snack-bar-container-animations-enabled.mat-snack-bar-fallback-visible{opacity:1}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-enter{animation:_mat-snack-bar-enter 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-exit{animation:_mat-snack-bar-exit 75ms cubic-bezier(0.4, 0, 1, 1) forwards}.mat-mdc-snackbar-surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12);display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;padding-left:0;padding-right:8px}[dir=rtl] .mat-mdc-snackbar-surface{padding-right:0;padding-left:8px}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{min-width:344px;max-width:672px}.mat-mdc-snack-bar-handset .mat-mdc-snackbar-surface{width:100%;min-width:0}@media(forced-colors: active){.mat-mdc-snackbar-surface{outline:solid 1px}}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{color:var(--mdc-snackbar-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mdc-snackbar-container-shape, var(--mat-sys-corner-extra-small));background-color:var(--mdc-snackbar-container-color, var(--mat-sys-inverse-surface))}.mdc-snackbar__label{width:100%;flex-grow:1;box-sizing:border-box;margin:0;padding:14px 8px 14px 16px}[dir=rtl] .mdc-snackbar__label{padding-left:8px;padding-right:16px}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-family:var(--mdc-snackbar-supporting-text-font, var(--mat-sys-body-medium-font));font-size:var(--mdc-snackbar-supporting-text-size, var(--mat-sys-body-medium-size));font-weight:var(--mdc-snackbar-supporting-text-weight, var(--mat-sys-body-medium-weight));line-height:var(--mdc-snackbar-supporting-text-line-height, var(--mat-sys-body-medium-line-height))}.mat-mdc-snack-bar-actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled).mat-unthemed{color:var(--mat-snack-bar-button-color, var(--mat-sys-inverse-primary))}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){--mat-text-button-state-layer-color:currentColor;--mat-text-button-ripple-color:currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{opacity:.1}
`],encapsulation:2})}return i})();function Mte(){return new wy}var Tte=new Dt("mat-snack-bar-default-options",{providedIn:"root",factory:Mte}),Cy=(()=>{class i{_overlay=Z(bo);_live=Z(cx);_injector=Z(vn);_breakpointObserver=Z(lx);_parentSnackBar=Z(i,{optional:!0,skipSelf:!0});_defaultConfig=Z(Tte);_snackBarRefAtThisLevel=null;simpleSnackBarComponent=Ste;snackBarContainerComponent=Dte;handsetCssClass="mat-mdc-snack-bar-handset";get _openedSnackBarRef(){let e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}constructor(){}openFromComponent(e,n){return this._attach(e,n)}openFromTemplate(e,n){return this._attach(e,n)}open(e,n="",s){let r=Ct(Ct({},this._defaultConfig),s);return r.data={message:e,action:n},r.announcementMessage===e&&(r.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,r)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(e,n){let s=n&&n.viewContainerRef&&n.viewContainerRef.injector,r=vn.create({parent:s||this._injector,providers:[{provide:wy,useValue:n}]}),y=new Is(this.snackBarContainerComponent,n.viewContainerRef,r),A=e.attach(y);return A.instance.snackBarConfig=n,A.instance}_attach(e,n){let s=Ct(Ct(Ct({},new wy),this._defaultConfig),n),r=this._createOverlay(s),y=this._attachSnackBarContainer(r,s),A=new Ax(y,r);if(e instanceof co){let P=new Gc(e,null,{$implicit:s.data,snackBarRef:A});A.instance=y.attachTemplatePortal(P)}else{let P=this._createInjector(s,A),B=new Is(e,void 0,P),U=y.attachComponentPortal(B);A.instance=U.instance}return this._breakpointObserver.observe(QU.HandsetPortrait).pipe(Un(r.detachments())).subscribe(P=>{r.overlayElement.classList.toggle(this.handsetCssClass,P.matches)}),s.announcementMessage&&y._onAnnounce.subscribe(()=>{this._live.announce(s.announcementMessage,s.politeness)}),this._animateSnackBar(A,s),this._openedSnackBarRef=A,this._openedSnackBarRef}_animateSnackBar(e,n){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef==e&&(this._openedSnackBarRef=null),n.announcementMessage&&this._live.clear()}),n.duration&&n.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(n.duration)),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter()}_createOverlay(e){let n=new Yc;n.direction=e.direction;let s=this._overlay.position().global(),r=e.direction==="rtl",y=e.horizontalPosition==="left"||e.horizontalPosition==="start"&&!r||e.horizontalPosition==="end"&&r,A=!y&&e.horizontalPosition!=="center";return y?s.left("0"):A?s.right("0"):s.centerHorizontally(),e.verticalPosition==="top"?s.top("0"):s.bottom("0"),n.positionStrategy=s,this._overlay.create(n)}_createInjector(e,n){let s=e&&e.viewContainerRef&&e.viewContainerRef.injector;return vn.create({parent:s||this._injector,providers:[{provide:Ax,useValue:n},{provide:JU,useValue:e.data}]})}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Pr=class i{constructor(t,e){this.snackBar=t;this.dialog=e}success(t){this.snackBar.open(`\u2714\uFE0F ${t}`,"Cerrar",{duration:4e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-success"]})}error(t){this.snackBar.open(`\u274C ${t}`,"Cerrar",{duration:5e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-error"]})}confirm(t,e={}){return this.dialog.open(ks,{width:"320px",data:Ct({message:t},e)}).afterClosed()}static \u0275fac=function(e){return new(e||i)(hi(Cy),hi(Il))};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})};function Ite(i,t){if(i&1){let e=bi();oe(0,"li")(1,"a",4),_t("click",function(){qt(e);let s=bt();return Wt(s.toggleMenu())}),Ee(2,"Crear cuenta"),ae()()}}function Ate(i,t){if(i&1&&(oe(0,"span",7),Ee(1),ae()),i&2){let e=bt().ngIf;ge(),zi(" ",e.length," ")}}function Rte(i,t){if(i&1&&(bn(0),pt(1,Ate,2,1,"span",6),xn()),i&2){let e=t.ngIf;ge(),Be("ngIf",e.length>0)}}function kte(i,t){if(i&1){let e=bi();oe(0,"li")(1,"a",5),_t("click",function(){qt(e);let s=bt();return Wt(s.toggleNotifications())}),Ee(2," \u{1F514} Notificaciones "),pt(3,Rte,2,1,"ng-container",1),Qs(4,"async"),ae()()}if(i&2){let e=bt();ge(3),Be("ngIf",vb(4,1,e.userNotificationService.notifications$))}}function Pte(i,t){i&1&&(oe(0,"li",8),Et(1,"app-notification-list"),ae())}function Ote(i,t){if(i&1){let e=bi();oe(0,"li")(1,"a",9),_t("click",function(){qt(e);let s=bt();return Wt(s.toggleMenu())}),Ee(2,"Inicio"),ae()()}}function Fte(i,t){if(i&1){let e=bi();oe(0,"li")(1,"a",10),_t("click",function(){qt(e);let s=bt();return Wt(s.toggleMenu())}),Ee(2,"Mi Cuenta"),ae()()}}function Lte(i,t){if(i&1){let e=bi();oe(0,"li")(1,"a",11),_t("click",function(){qt(e);let s=bt();return Wt(s.toggleMenu())}),Ee(2,"Mis Reportes"),ae()()}}function Nte(i,t){if(i&1){let e=bi();oe(0,"li")(1,"a",12),_t("click",function(){qt(e);let s=bt();return Wt(s.toggleMenu())}),Ee(2,"Crear reporte"),ae()()}}function zte(i,t){if(i&1){let e=bi();oe(0,"li")(1,"a",13),_t("click",function(){qt(e);let s=bt();return Wt(s.toggleMenu())}),Ee(2,"Administrar Reportes"),ae()()}}function Bte(i,t){if(i&1){let e=bi();oe(0,"li")(1,"a",14),_t("click",function(){qt(e);let s=bt();return Wt(s.toggleMenu())}),Ee(2,"Historias de Reportes"),ae()()}}function Vte(i,t){if(i&1){let e=bi();oe(0,"li")(1,"a",15),_t("click",function(){qt(e);let s=bt();return Wt(s.toggleMenu())}),Ee(2,"Generar informe"),ae()()}}function jte(i,t){if(i&1){let e=bi();oe(0,"li")(1,"a",16),_t("click",function(){qt(e);let s=bt();return Wt(s.toggleMenu())}),Ee(2,"Administrar Categor\xEDas"),ae()()}}function Ute(i,t){if(i&1){let e=bi();oe(0,"li")(1,"a",5),_t("click",function(){qt(e);let s=bt();return s.logout(),Wt(s.toggleMenu())}),Ee(2,"Cerrar Sesi\xF3n"),ae()()}}var vD=class i{constructor(t,e,n,s){this.authService=t;this.router=e;this.notificationService=n;this.userNotificationService=s}isOpen=!1;isLoggedIn=!1;notificationsOpen=!1;isAdmin=!1;authSubscription=new Tn;ngOnInit(){this.authSubscription.add(this.authService.getAuthStatus().subscribe(t=>{this.isLoggedIn=t})),this.authSubscription.add(this.authService.getAdminStatus().subscribe(t=>{this.isAdmin=t}))}ngOnDestroy(){this.authSubscription&&this.authSubscription.unsubscribe()}toggleMenu(){this.isOpen=!this.isOpen}toggleNotifications(){this.notificationsOpen=!this.notificationsOpen}logout(){this.notificationService.confirm("\xBFEst\xE1s seguro de que quieres cerrar sesi\xF3n?",{title:"Cerrar sesi\xF3n",confirmText:"S\xED, salir",cancelText:"No"}).subscribe(t=>{t&&(this.notificationService.success("Cerrando sesi\xF3n..."),this.authService.logout().subscribe({next:()=>this.router.navigate(["/login"]),error:e=>{console.error(e),this.notificationService.error("No se pudo cerrar sesi\xF3n")}}))})}register(){this.router.navigate(["/report/new"])}navigate(t){this.router.navigate([t]),this.isOpen=!1}static \u0275fac=function(e){return new(e||i)(ai(eo),ai(fn),ai(Pr),ai(gp))};static \u0275cmp=Yt({type:i,selectors:[["app-header"]],decls:16,vars:14,consts:[[1,"sidebar"],[4,"ngIf"],["class","notification-panel",4,"ngIf"],[1,"menu-button",3,"click"],["routerLink","/register",3,"click"],[3,"click"],["class","badge",4,"ngIf"],[1,"badge"],[1,"notification-panel"],["routerLink","/map",3,"click"],["routerLink","/profile",3,"click"],["routerLink","/my-reports",3,"click"],["routerLink","/report/new",3,"click"],["routerLink","/report-list-admin",3,"click"],["routerLink","/report-histories",3,"click"],["routerLink","/report-summary",3,"click"],["routerLink","/category-list",3,"click"]],template:function(e,n){e&1&&(oe(0,"div",0)(1,"ul"),pt(2,Ite,3,0,"li",1)(3,kte,5,3,"li",1)(4,Pte,2,0,"li",2)(5,Ote,3,0,"li",1)(6,Fte,3,0,"li",1)(7,Lte,3,0,"li",1)(8,Nte,3,0,"li",1)(9,zte,3,0,"li",1)(10,Bte,3,0,"li",1)(11,Vte,3,0,"li",1)(12,jte,3,0,"li",1)(13,Ute,3,0,"li",1),ae()(),oe(14,"button",3),_t("click",function(){return n.toggleMenu()}),Ee(15,"\u2630"),ae()),e&2&&(Ai("active",n.isOpen),ge(2),Be("ngIf",!n.isLoggedIn),ge(),Be("ngIf",n.isLoggedIn),ge(),Be("ngIf",n.notificationsOpen),ge(),Be("ngIf",n.isLoggedIn),ge(),Be("ngIf",n.isLoggedIn),ge(),Be("ngIf",n.isLoggedIn),ge(),Be("ngIf",n.isLoggedIn),ge(),Be("ngIf",n.isAdmin),ge(),Be("ngIf",n.isAdmin),ge(),Be("ngIf",n.isAdmin),ge(),Be("ngIf",n.isAdmin),ge(),Be("ngIf",n.isLoggedIn))},dependencies:[Zn,Dl,ay,Tb,kS],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c;--hover-bg: #c0c8d4}.sidebar[_ngcontent-%COMP%]{position:fixed;right:-270px;top:0;width:250px;height:100%;background:#fff;color:var(--primary-dark);transition:right .4s ease;padding-top:80px;box-shadow:-4px 0 8px #0003;border-top-left-radius:10px;border-bottom-left-radius:10px;z-index:999}.sidebar.active[_ngcontent-%COMP%]{right:0}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:15px 20px;text-align:left;transition:background .3s ease;font-weight:500;font-size:16px;background:var(--input-bg)}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background:#aaa;cursor:pointer;border-radius:8px}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--primary-dark);text-decoration:none;display:block}.menu-button[_ngcontent-%COMP%]{position:fixed;top:20px;right:20px;background:var(--primary-bg);border:none;color:var(--primary-dark);padding:10px 15px;font-size:24px;cursor:pointer;border-radius:8px;box-shadow:2px 2px 6px #0003;transition:background .3s,transform .2s;z-index:1000}.menu-button[_ngcontent-%COMP%]:hover{background:var(--primary-accent);transform:scale(1.05)}.menu-button[_ngcontent-%COMP%]:active{background:#7a99c3;transform:scale(.95)}.link-button[_ngcontent-%COMP%]{background:none;border:none;color:var(--primary-dark);font-weight:500;font-size:16px;width:100%;text-align:left;padding:15px 20px;cursor:pointer;display:block}.link-button[_ngcontent-%COMP%]:hover{background:#aaa;border-radius:8px}"]})};var bD=class i{static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Yt({type:i,selectors:[["app-root"]],decls:2,vars:0,template:function(e,n){e&1&&Et(0,"app-header")(1,"router-outlet")},dependencies:[vD,Qb],styles:[".close-btn[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;background:none;border:none;color:#fff;font-size:20px;cursor:pointer}"]})};var CD=o_(Ey());var Kc={production:!1,mapboxToken:"pk.eyJ1IjoibWFya2F0IiwiYSI6ImNtN2o2eGcwZDAwcGsycG9pZzZ6cjhncTgifQ.f9qApUfu6cdG-w-gpjPOlQ",cloud_name:"dxospqsu0",api_key:"173283854338116",api_secret:"kTTNZ1yXBfEjGr1jm39FithfSwU",urlBack:"http://localhost:8080/api/v1"};var xD;function Hte(){if(xD===void 0&&(xD=null,typeof window<"u")){let i=window;i.trustedTypes!==void 0&&(xD=i.trustedTypes.createPolicy("angular#components",{createHTML:t=>t}))}return xD}function kx(i){return Hte()?.createHTML(i)||i}function i6(i){return Error(`Unable to find icon with the name "${i}"`)}function $te(){return Error("Could not find HttpClient for use with Angular Material icons. Please add provideHttpClient() to your providers.")}function n6(i){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${i}".`)}function r6(i){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${i}".`)}var Vu=class{url;svgText;options;svgElement;constructor(t,e,n){this.url=t,this.svgText=e,this.options=n}},a6=(()=>{class i{_httpClient;_sanitizer;_errorHandler;_document;_svgIconConfigs=new Map;_iconSetConfigs=new Map;_cachedIconsByUrl=new Map;_inProgressUrlFetches=new Map;_fontCssClassesByAlias=new Map;_resolvers=[];_defaultFontSetClass=["material-icons","mat-ligature-font"];constructor(e,n,s,r){this._httpClient=e,this._sanitizer=n,this._errorHandler=r,this._document=s}addSvgIcon(e,n,s){return this.addSvgIconInNamespace("",e,n,s)}addSvgIconLiteral(e,n,s){return this.addSvgIconLiteralInNamespace("",e,n,s)}addSvgIconInNamespace(e,n,s,r){return this._addSvgIconConfig(e,n,new Vu(s,null,r))}addSvgIconResolver(e){return this._resolvers.push(e),this}addSvgIconLiteralInNamespace(e,n,s,r){let y=this._sanitizer.sanitize(ss.HTML,s);if(!y)throw r6(s);let A=kx(y);return this._addSvgIconConfig(e,n,new Vu("",A,r))}addSvgIconSet(e,n){return this.addSvgIconSetInNamespace("",e,n)}addSvgIconSetLiteral(e,n){return this.addSvgIconSetLiteralInNamespace("",e,n)}addSvgIconSetInNamespace(e,n,s){return this._addSvgIconSetConfig(e,new Vu(n,null,s))}addSvgIconSetLiteralInNamespace(e,n,s){let r=this._sanitizer.sanitize(ss.HTML,n);if(!r)throw r6(n);let y=kx(r);return this._addSvgIconSetConfig(e,new Vu("",y,s))}registerFontClassAlias(e,n=e){return this._fontCssClassesByAlias.set(e,n),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(...e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){let n=this._sanitizer.sanitize(ss.RESOURCE_URL,e);if(!n)throw n6(e);let s=this._cachedIconsByUrl.get(n);return s?wi(wD(s)):this._loadSvgIconFromConfig(new Vu(e,null)).pipe(Gn(r=>this._cachedIconsByUrl.set(n,r)),Ui(r=>wD(r)))}getNamedSvgIcon(e,n=""){let s=o6(n,e),r=this._svgIconConfigs.get(s);if(r)return this._getSvgFromConfig(r);if(r=this._getIconConfigFromResolvers(n,e),r)return this._svgIconConfigs.set(s,r),this._getSvgFromConfig(r);let y=this._iconSetConfigs.get(n);return y?this._getSvgFromIconSetConfigs(e,y):lo(i6(s))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgText?wi(wD(this._svgElementFromConfig(e))):this._loadSvgIconFromConfig(e).pipe(Ui(n=>wD(n)))}_getSvgFromIconSetConfigs(e,n){let s=this._extractIconWithNameFromAnySet(e,n);if(s)return wi(s);let r=n.filter(y=>!y.svgText).map(y=>this._loadSvgIconSetFromConfig(y).pipe(tr(A=>{let B=`Loading icon set URL: ${this._sanitizer.sanitize(ss.RESOURCE_URL,y.url)} failed: ${A.message}`;return this._errorHandler.handleError(new Error(B)),wi(null)})));return W0(r).pipe(Ui(()=>{let y=this._extractIconWithNameFromAnySet(e,n);if(!y)throw i6(e);return y}))}_extractIconWithNameFromAnySet(e,n){for(let s=n.length-1;s>=0;s--){let r=n[s];if(r.svgText&&r.svgText.toString().indexOf(e)>-1){let y=this._svgElementFromConfig(r),A=this._extractSvgIconFromSet(y,e,r.options);if(A)return A}}return null}_loadSvgIconFromConfig(e){return this._fetchIcon(e).pipe(Gn(n=>e.svgText=n),Ui(()=>this._svgElementFromConfig(e)))}_loadSvgIconSetFromConfig(e){return e.svgText?wi(null):this._fetchIcon(e).pipe(Gn(n=>e.svgText=n))}_extractSvgIconFromSet(e,n,s){let r=e.querySelector(`[id="${n}"]`);if(!r)return null;let y=r.cloneNode(!0);if(y.removeAttribute("id"),y.nodeName.toLowerCase()==="svg")return this._setSvgAttributes(y,s);if(y.nodeName.toLowerCase()==="symbol")return this._setSvgAttributes(this._toSvgElement(y),s);let A=this._svgElementFromString(kx("<svg></svg>"));return A.appendChild(y),this._setSvgAttributes(A,s)}_svgElementFromString(e){let n=this._document.createElement("DIV");n.innerHTML=e;let s=n.querySelector("svg");if(!s)throw Error("<svg> tag not found");return s}_toSvgElement(e){let n=this._svgElementFromString(kx("<svg></svg>")),s=e.attributes;for(let r=0;r<s.length;r++){let{name:y,value:A}=s[r];y!=="id"&&n.setAttribute(y,A)}for(let r=0;r<e.childNodes.length;r++)e.childNodes[r].nodeType===this._document.ELEMENT_NODE&&n.appendChild(e.childNodes[r].cloneNode(!0));return n}_setSvgAttributes(e,n){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),n&&n.viewBox&&e.setAttribute("viewBox",n.viewBox),e}_fetchIcon(e){let{url:n,options:s}=e,r=s?.withCredentials??!1;if(!this._httpClient)throw $te();if(n==null)throw Error(`Cannot fetch icon from URL "${n}".`);let y=this._sanitizer.sanitize(ss.RESOURCE_URL,n);if(!y)throw n6(n);let A=this._inProgressUrlFetches.get(y);if(A)return A;let P=this._httpClient.get(y,{responseType:"text",withCredentials:r}).pipe(Ui(B=>kx(B)),jl(()=>this._inProgressUrlFetches.delete(y)),X0());return this._inProgressUrlFetches.set(y,P),P}_addSvgIconConfig(e,n,s){return this._svgIconConfigs.set(o6(e,n),s),this}_addSvgIconSetConfig(e,n){let s=this._iconSetConfigs.get(e);return s?s.push(n):this._iconSetConfigs.set(e,[n]),this}_svgElementFromConfig(e){if(!e.svgElement){let n=this._svgElementFromString(e.svgText);this._setSvgAttributes(n,e.options),e.svgElement=n}return e.svgElement}_getIconConfigFromResolvers(e,n){for(let s=0;s<this._resolvers.length;s++){let r=this._resolvers[s](n,e);if(r)return Gte(r)?new Vu(r.url,null,r.options):new Vu(r,null)}}static \u0275fac=function(n){return new(n||i)(hi(zo,8),hi($k),hi(Ki,8),hi(Ms))};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function wD(i){return i.cloneNode(!0)}function o6(i,t){return i+":"+t}function Gte(i){return!!(i.url&&i.options)}var qte=["*"],Wte=new Dt("MAT_ICON_DEFAULT_OPTIONS"),Yte=new Dt("mat-icon-location",{providedIn:"root",factory:Zte});function Zte(){let i=Z(Ki),t=i?i.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}var s6=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],Xte=s6.map(i=>`[${i}]`).join(", "),Kte=/^url\(['"]?#(.*?)['"]?\)$/,no=(()=>{class i{_elementRef=Z(Ii);_iconRegistry=Z(a6);_location=Z(Yte);_errorHandler=Z(Ms);_defaultColor;get color(){return this._color||this._defaultColor}set color(e){this._color=e}_color;inline=!1;get svgIcon(){return this._svgIcon}set svgIcon(e){e!==this._svgIcon&&(e?this._updateSvgIcon(e):this._svgIcon&&this._clearSvgElement(),this._svgIcon=e)}_svgIcon;get fontSet(){return this._fontSet}set fontSet(e){let n=this._cleanupFontValue(e);n!==this._fontSet&&(this._fontSet=n,this._updateFontIconClasses())}_fontSet;get fontIcon(){return this._fontIcon}set fontIcon(e){let n=this._cleanupFontValue(e);n!==this._fontIcon&&(this._fontIcon=n,this._updateFontIconClasses())}_fontIcon;_previousFontSetClass=[];_previousFontIconClass;_svgName;_svgNamespace;_previousPath;_elementsWithExternalReferences;_currentIconFetch=Tn.EMPTY;constructor(){let e=Z(new Hl("aria-hidden"),{optional:!0}),n=Z(Wte,{optional:!0});n&&(n.color&&(this.color=this._defaultColor=n.color),n.fontSet&&(this.fontSet=n.fontSet)),e||this._elementRef.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(e){if(!e)return["",""];let n=e.split(":");switch(n.length){case 1:return["",n[0]];case 2:return n;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){let e=this._elementsWithExternalReferences;if(e&&e.size){let n=this._location.getPathname();n!==this._previousPath&&(this._previousPath=n,this._prependPathToReferences(n))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();let n=this._location.getPathname();this._previousPath=n,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(n),this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){let e=this._elementRef.nativeElement,n=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();n--;){let s=e.childNodes[n];(s.nodeType!==1||s.nodeName.toLowerCase()==="svg")&&s.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;let e=this._elementRef.nativeElement,n=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(s=>s.length>0);this._previousFontSetClass.forEach(s=>e.classList.remove(s)),n.forEach(s=>e.classList.add(s)),this._previousFontSetClass=n,this.fontIcon!==this._previousFontIconClass&&!n.includes("mat-ligature-font")&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return typeof e=="string"?e.trim().split(" ")[0]:e}_prependPathToReferences(e){let n=this._elementsWithExternalReferences;n&&n.forEach((s,r)=>{s.forEach(y=>{r.setAttribute(y.name,`url('${e}#${y.value}')`)})})}_cacheChildrenWithExternalReferences(e){let n=e.querySelectorAll(Xte),s=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let r=0;r<n.length;r++)s6.forEach(y=>{let A=n[r],P=A.getAttribute(y),B=P?P.match(Kte):null;if(B){let U=s.get(A);U||(U=[],s.set(A,U)),U.push({name:y,value:B[1]})}})}_updateSvgIcon(e){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),e){let[n,s]=this._splitIconName(e);n&&(this._svgNamespace=n),s&&(this._svgName=s),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(s,n).pipe(mo(1)).subscribe(r=>this._setSvgElement(r),r=>{let y=`Error retrieving icon ${n}:${s}! ${r.message}`;this._errorHandler.handleError(new Error(y))})}}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(n,s){n&2&&(ji("data-mat-icon-type",s._usingFontIcon()?"font":"svg")("data-mat-icon-name",s._svgName||s.fontIcon)("data-mat-icon-namespace",s._svgNamespace||s.fontSet)("fontIcon",s._usingFontIcon()?s.fontIcon:null),Ts(s.color?"mat-"+s.color:""),Ai("mat-icon-inline",s.inline)("mat-icon-no-color",s.color!=="primary"&&s.color!=="accent"&&s.color!=="warn"))},inputs:{color:"color",inline:[2,"inline","inline",xi],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],ngContentSelectors:qte,decls:1,vars:0,template:function(n,s){n&1&&(xr(),an(0))},styles:[`mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color, inherit)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}
`],encapsulation:2,changeDetection:0})}return i})(),ua=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({imports:[An,An]})}return i})();function Qte(i,t){i&1&&(oe(0,"h2"),Ee(1,"CREA UNA CUENTA"),ae())}function Jte(i,t){i&1&&(oe(0,"div",20),Ee(1," \u26A0 El nombre completo es obligatorio. "),ae())}function eie(i,t){i&1&&(oe(0,"div",20),Ee(1," \u26A0 El nombre debe tener al menos 8 caracteres. "),ae())}function tie(i,t){i&1&&(oe(0,"div",20),Ee(1," \u26A0 El nombre no puede exceder 50 caracteres. "),ae())}function iie(i,t){i&1&&(oe(0,"div",20),Ee(1," \u26A0 El correo electr\xF3nico es obligatorio. "),ae())}function nie(i,t){i&1&&(oe(0,"div",20),Ee(1," \u26A0 El formato de correo no es v\xE1lido. "),ae())}function rie(i,t){i&1&&(oe(0,"div",20),Ee(1," \u26A0 El correo debe tener al menos 8 caracteres. "),ae())}function oie(i,t){i&1&&(oe(0,"div",20),Ee(1," \u26A0 El correo no puede exceder 50 caracteres. "),ae())}function aie(i,t){i&1&&(oe(0,"div",20),Ee(1," \u26A0 La contrase\xF1a es obligatoria. "),ae())}function sie(i,t){i&1&&(oe(0,"div",20),Ee(1," \u26A0 Debe incluir al menos un d\xEDgito, una may\xFAscula y una min\xFAscula. "),ae())}function lie(i,t){i&1&&(oe(0,"div",20),Ee(1," \u26A0 La contrase\xF1a debe tener al menos 8 caracteres. "),ae())}function cie(i,t){i&1&&(oe(0,"div",20),Ee(1," \u26A0 La contrase\xF1a no puede exceder 50 caracteres. "),ae())}function die(i,t){i&1&&(oe(0,"div",20),Ee(1," \u26A0 La fecha de nacimiento es obligatoria. "),ae())}function uie(i,t){i&1&&(oe(0,"div",20),Ee(1," \u26A0 La fecha de nacimiento no puede ser posterior a hoy. "),ae())}function hie(i,t){i&1&&(oe(0,"div",20),Ee(1," \u26A0 La ciudad de residencia es obligatoria. "),ae())}function pie(i,t){i&1&&(oe(0,"div",20),Ee(1," \u26A0 El radio de notificaciones es obligatorio. "),ae())}function fie(i,t){i&1&&(oe(0,"div",20),Ee(1," \u26A0 El radio de notificaciones debe ser mayor que 0. "),ae())}function mie(i,t){if(i&1){let e=bi();oe(0,"div")(1,"div",5),Et(2,"i",6)(3,"input",7),ae(),pt(4,Jte,2,0,"div",8)(5,eie,2,0,"div",8)(6,tie,2,0,"div",8),oe(7,"div",5),Et(8,"i",9)(9,"input",10),ae(),pt(10,iie,2,0,"div",8)(11,nie,2,0,"div",8)(12,rie,2,0,"div",8)(13,oie,2,0,"div",8),oe(14,"div",5),Et(15,"i",11)(16,"input",12),ae(),pt(17,aie,2,0,"div",8)(18,sie,2,0,"div",8)(19,lie,2,0,"div",8)(20,cie,2,0,"div",8),oe(21,"div",5),Et(22,"i",13)(23,"input",14),ae(),pt(24,die,2,0,"div",8)(25,uie,2,0,"div",8),oe(26,"div",5),Et(27,"i",15)(28,"input",16),ae(),pt(29,hie,2,0,"div",8),oe(30,"div",5),Et(31,"i",17)(32,"input",18),ae(),pt(33,pie,2,0,"div",8)(34,fie,2,0,"div",8),oe(35,"button",19),_t("click",function(){qt(e);let s=bt();return Wt(s.continueToMap())}),Ee(36," Continuar "),ae()()}if(i&2){let e=bt();ge(4),Be("ngIf",e.hasError("fullName","required")),ge(),Be("ngIf",e.hasError("fullName","minlength")),ge(),Be("ngIf",e.hasError("fullName","maxlength")),ge(4),Be("ngIf",e.hasError("email","required")),ge(),Be("ngIf",e.hasError("email","email")),ge(),Be("ngIf",e.hasError("email","minlength")),ge(),Be("ngIf",e.hasError("email","maxlength")),ge(4),Be("ngIf",e.hasError("password","required")),ge(),Be("ngIf",e.hasError("password","pattern")),ge(),Be("ngIf",e.hasError("password","minlength")),ge(),Be("ngIf",e.hasError("password","maxlength")),ge(4),Be("ngIf",e.hasError("dateBirth","required")),ge(),Be("ngIf",e.hasError("dateBirth","futureDate")),ge(4),Be("ngIf",e.hasError("cityOfResidence","required")),ge(4),Be("ngIf",e.hasError("notificationRadiusKm","required")),ge(),Be("ngIf",e.hasError("notificationRadiusKm","min")),ge(),Be("disabled",e.registerForm.invalid)}}function gie(i,t){i&1&&(oe(0,"div",21),Ee(1," Cargando mapa... "),ae())}function _ie(i,t){i&1&&Et(0,"i",25)}function yie(i,t){if(i&1){let e=bi();oe(0,"div"),Et(1,"div",22),oe(2,"p"),Ee(3,"Haz clic en el mapa para seleccionar tu ubicaci\xF3n."),ae(),oe(4,"button",23),pt(5,_ie,1,0,"i",24),Ee(6),ae(),oe(7,"button",19),_t("click",function(){qt(e);let s=bt();return Wt(s.backToForm())}),Ee(8," \u2190 Volver "),ae()()}if(i&2){let e=bt();ge(4),Be("disabled",e.registerForm.invalid||e.isSubmitting),ge(),Be("ngIf",e.isSubmitting),ge(),zi(" ",e.isSubmitting?"Registrando...":"Registrar"," "),ge(),Be("disabled",e.isSubmitting)}}var ED=class i{constructor(t,e,n,s){this.fb=t;this.authService=e;this.notificationService=n;this.router=s;this.registerForm=this.fb.group({fullName:["",[si.required,si.minLength(8),si.maxLength(50)]],email:["",[si.required,si.email,si.minLength(8),si.maxLength(50)]],password:["",[si.required,si.pattern("^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).*$"),si.minLength(8),si.maxLength(50)]],dateBirth:["",[si.required,this.pastDateValidator()]],cityOfResidence:["",si.required],notificationRadiusKm:[null,si.required],latitude:[null],longitude:[null]})}registerForm;showMap=!1;isLoadingMap=!1;map;marker;isSubmitting=!1;hasError(t,e){let n=this.registerForm.get(t);return!!(n&&n.touched&&n.hasError(e))}ngOnInit(){}ngAfterViewInit(){}continueToMap(){if(this.registerForm.valid){this.isLoadingMap=!0,this.showMap=!0;let t=this.registerForm.get("cityOfResidence").value;this.getCityCoordinates(t).then(e=>{this.initializeMap(e)}).catch(e=>{this.notificationService.error("No pudimos encontrar tu ciudad. Por favor revisa el nombre."),this.showMap=!1}).finally(()=>{this.isLoadingMap=!1})}}initializeMap(t={lng:-75.681,lat:4.533}){this.map=new CD.default.Map({container:"map_user",style:"mapbox://styles/mapbox/streets-v11",center:[t.lng,t.lat],zoom:12,attributionControl:!1,accessToken:Kc.mapboxToken}),this.map.on("load",()=>{this.map.resize(),this.isLoadingMap=!1}),this.map.addControl(new CD.default.NavigationControl,"bottom-right"),this.map.on("click",({lngLat:e})=>{this.registerForm.patchValue({latitude:e.lat,longitude:e.lng}),this.marker?this.marker.setLngLat(e):this.marker=new CD.default.Marker({draggable:!0,anchor:"center"}).setLngLat(e).addTo(this.map)})}getCityCoordinates(t){let n=`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(t+", Colombia")}.json?access_token=${Kc.mapboxToken}&limit=1`;return fetch(n).then(s=>s.json()).then(s=>{if(!s.features||s.features.length===0)throw new Error("No se encontr\xF3 la ciudad");let[r,y]=s.features[0].center;return{lng:r,lat:y}})}onRegister(){if(this.registerForm.invalid){this.registerForm.markAllAsTouched();return}if(this.isSubmitting)return;this.isSubmitting=!0;let t=this.registerForm.value;if(t.latitude==null||t.longitude==null){this.notificationService.error("Por favor selecciona una ubicaci\xF3n."),this.isSubmitting=!1;return}this.authService.register(t).subscribe({next:e=>{sessionStorage.setItem("Email",e.email),sessionStorage.setItem("UserId",e.id),this.notificationService.success("\xA1Registro exitoso!"),this.router.navigate(["/validate-account"])},error:e=>{let n=e.status,s="Ocurri\xF3 un error. Intenta de nuevo.";n===400?s=e.error?.message||"Datos inv\xE1lidos.":n===409?s="El correo ya est\xE1 registrado.":n===500&&(s="Error interno del servidor."),this.notificationService.error(s),this.showMap=!1,this.isSubmitting=!1}})}backToForm(){this.showMap=!1}get fullNameInvalid(){let t=this.registerForm.get("fullName");return!!(t&&t.touched&&t.invalid)}get emailInvalid(){let t=this.registerForm.get("email");return!!(t&&t.touched&&t.invalid)}get passwordInvalid(){let t=this.registerForm.get("password");return!!(t&&t.touched&&t.invalid)}get dateBirthInvalid(){let t=this.registerForm.get("dateBirth");return!!(t&&t.touched&&t.invalid)}get cityOfResidenceInvalid(){let t=this.registerForm.get("cityOfResidence");return!!(t&&t.touched&&t.invalid)}get notificationRadiusInvalid(){let t=this.registerForm.get("notificationRadiusKm");return!!(t&&t.touched&&(t.invalid||t.value<=0))}pastDateValidator(){return t=>{let e=t.value;if(!e)return null;let n=new Date(e),s=new Date;return s.setHours(0,0,0,0),n>s?{futureDate:!0}:null}}goBack(){history.back()}static \u0275fac=function(e){return new(e||i)(ai(ca),ai(eo),ai(Pr),ai(fn))};static \u0275cmp=Yt({type:i,selectors:[["app-register"]],decls:9,vars:5,consts:[["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],[1,"register-container"],[4,"ngIf"],[3,"ngSubmit","formGroup"],["class","loading-spinner",4,"ngIf"],[1,"field-group"],[1,"icon","fa","fa-user"],["type","text","placeholder","Nombre completo","formControlName","fullName"],["class","error-message",4,"ngIf"],[1,"icon","fa","fa-envelope"],["type","email","placeholder","Correo electr\xF3nico","formControlName","email"],[1,"icon","fa","fa-lock"],["type","password","placeholder","Contrase\xF1a","formControlName","password"],[1,"icon","fa","fa-calendar"],["type","date","formControlName","dateBirth"],[1,"icon","fa","fa-city"],["type","text","placeholder","Ciudad de residencia","formControlName","cityOfResidence"],[1,"icon","fa","fa-bullhorn"],["type","number","placeholder","Radio de notificaciones (Km)","formControlName","notificationRadiusKm"],["type","button",1,"submit-button",3,"click","disabled"],[1,"error-message"],[1,"loading-spinner"],["id","map_user"],["type","submit",1,"submit-button",3,"disabled"],["class","fas fa-spinner fa-spin me-2",4,"ngIf"],[1,"fas","fa-spinner","fa-spin","me-2"]],template:function(e,n){e&1&&(oe(0,"button",0),_t("click",function(){return n.goBack()}),oe(1,"mat-icon"),Ee(2,"arrow_back"),ae()(),oe(3,"div",1),pt(4,Qte,2,0,"h2",2),oe(5,"form",3),_t("ngSubmit",function(){return n.onRegister()}),pt(6,mie,37,17,"div",2)(7,gie,2,0,"div",4)(8,yie,9,4,"div",2),ae()()),e&2&&(ge(4),Be("ngIf",!n.showMap),ge(),Be("formGroup",n.registerForm),ge(),Be("ngIf",!n.showMap),ge(),Be("ngIf",n.isLoadingMap),ge(),Be("ngIf",n.showMap))},dependencies:[sr,Zn,da,la,io,Fm,xo,sa,Yr,Xo,Dl,ua,no],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c}.register-container[_ngcontent-%COMP%]{width:360px;background:var(--input-bg);margin:60px auto;padding:30px;border-radius:12px;text-align:center;box-shadow:0 4px 15px #0000001a;position:relative}.register-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;margin:0 0 25px;color:var(--primary-dark)}.field-group[_ngcontent-%COMP%]{position:relative;margin-bottom:15px}.field-group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:12px;transform:translateY(-50%);color:var(--primary-accent);font-size:18px}.field-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px 12px 12px 40px;border:2px solid #ccc;border-radius:6px;font-size:14px;background:var(--input-bg);transition:border-color .2s ease;box-sizing:border-box}.field-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-accent)}.error-message[_ngcontent-%COMP%]{text-align:left;color:var(--error-color);font-size:13px;margin:-10px 0 10px;padding-left:40px}.submit-button[_ngcontent-%COMP%]{width:100%;padding:12px;margin-top:3px;background:var(--primary-accent);color:#000;border:none;border-radius:6px;cursor:pointer;font-size:16px;font-weight:600;transition:background .3s ease,transform .2s ease;box-shadow:0 2px 8px #00000026}.submit-button[_ngcontent-%COMP%]:disabled{background:#aaa;color:#ccc;cursor:not-allowed}.submit-button[_ngcontent-%COMP%]:not(:disabled):hover{background:var(--primary-dark);transform:translateY(-2px)}.loading-spinner[_ngcontent-%COMP%]{font-size:16px;color:var(--primary-dark);margin:20px 0}#map_user[_ngcontent-%COMP%]{width:100%;height:400px;border:1px solid #ccc;border-radius:4px}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;background-color:#fff;border-radius:50%;box-shadow:0 2px 6px #0003}"]})};function vie(i,t){i&1&&(oe(0,"div",14),Ee(1," \u26A0 Email inv\xE1lido o vac\xEDo "),ae())}function bie(i,t){i&1&&(oe(0,"div",14),Ee(1," \u26A0 La contrase\xF1a es obligatoria. "),ae())}function xie(i,t){i&1&&Et(0,"i",15)}function wie(i,t){if(i&1){let e=bi();oe(0,"div",16)(1,"button",17),_t("click",function(){qt(e);let s=bt();return Wt(s.sendCodePassword())}),Ee(2," \xBFOlvidaste tu contrase\xF1a? "),ae()()}if(i&2){let e=bt();ge(),Be("disabled",e.isSubmitting||e.isSendPassword)}}var SD=class i{constructor(t,e,n,s){this.fb=t;this.authService=e;this.router=n;this.notificationService=s;this.registerForm=this.fb.group({email:["",[si.required,si.email]],password:["",[si.required]]})}registerForm;loginErrorMessage="";showReetPassword=!1;isSubmitting=!1;isSendPassword=!1;onLogin(){if(this.registerForm.invalid){this.registerForm.markAllAsTouched();return}if(this.isSubmitting)return;this.isSubmitting=!0;let{email:t,password:e}=this.registerForm.value;this.authService.login({email:t,password:e}).subscribe({next:()=>{this.notificationService.success("\xA1Bienvenido!"),this.router.navigate(["/map"])},error:n=>{let s=this.getErrorMessage(n.status,n.error?.message);this.notificationService.error(s),s.includes("La cuenta no est\xE1 activada")&&(this.notificationService.error("La cuenta no est\xE1 activada, reenviando c\xF3digo de activaci\xF3n..."),this.resendCode()),this.isSubmitting=!1}})}getErrorMessage(t,e){switch(t){case 400:return this.showReetPassword=!0,e||"Campos inv\xE1lidos.";case 403:return"La cuenta no est\xE1 activada";case 404:return"Usuario no encontrado.";case 500:return"Error interno del servidor.";default:return"Ocurri\xF3 un error. Intenta de nuevo."}}sendCodePassword(){if(this.isSendPassword)return;let t=this.registerForm.value.email;if(!t||this.registerForm.get("email")?.invalid){this.notificationService.error("Por favor ingresa un correo v\xE1lido.");return}this.isSendPassword=!0,this.authService.requestPasswordResetCode(t).subscribe({next:()=>{sessionStorage.setItem("email",t),this.notificationService.success("\u{1F4E9} C\xF3digo enviado al correo."),this.router.navigate(["/reset-password"])},error:e=>{switch(e.status){case 404:this.notificationService.error("\u274C Usuario no encontrado.");break;case 500:this.notificationService.error("\u26A0\uFE0F Error del servidor. Int\xE9ntalo m\xE1s tarde.");break;default:this.notificationService.error("Ocurri\xF3 un error. Int\xE9ntalo de nuevo.")}this.isSendPassword=!1}})}resendCode(){let t=this.registerForm.value.email;if(!t){this.notificationService.error("No se encontr\xF3 el email del usuario.");return}this.authService.sendCodeAgain(t).subscribe({next:()=>{this.router.navigate(["/validate-account"]),this.notificationService.success("\xA1C\xF3digo reenviado exitosamente!")},error:e=>{let n=e.status,s="Ocurri\xF3 un error al reenviar el c\xF3digo.";n===404?s="Usuario no encontrado.":n===500&&(s="Error interno del servidor."),this.notificationService.error(s)}})}get emailInvalid(){let t=this.registerForm.get("email");return!!(t&&t.touched&&t.invalid)}get passwordInvalid(){let t=this.registerForm.get("password");return!!(t&&t.touched&&t.invalid)}static \u0275fac=function(e){return new(e||i)(ai(ca),ai(eo),ai(fn),ai(Pr))};static \u0275cmp=Yt({type:i,selectors:[["app-login"]],decls:21,vars:7,consts:[[1,"login-container"],["alt","MapHopper","src","logo.png",1,"logo"],["novalidate","",3,"formGroup"],[1,"field-group"],[1,"fa","fa-envelope","icon"],["type","email","id","email","placeholder","Correo","formControlName","email","name","email"],["class","error-message",4,"ngIf"],[1,"fa","fa-lock","icon"],["type","password","id","password","placeholder","Contrase\xF1a","formControlName","password","name","password"],["type","button",1,"submit-button",3,"click","disabled"],["class","fas fa-spinner fa-spin me-2",4,"ngIf"],[1,"register-link"],["routerLink","/register"],["class","resend-container",4,"ngIf"],[1,"error-message"],[1,"fas","fa-spinner","fa-spin","me-2"],[1,"resend-container"],["type","button",1,"resend-button",3,"click","disabled"]],template:function(e,n){e&1&&(oe(0,"div",0),Et(1,"img",1),oe(2,"h2"),Ee(3,"INICIAR SESI\xD3N"),ae(),oe(4,"form",2)(5,"div",3),Et(6,"i",4)(7,"input",5),ae(),pt(8,vie,2,0,"div",6),oe(9,"div",3),Et(10,"i",7)(11,"input",8),ae(),pt(12,bie,2,0,"div",6),oe(13,"button",9),_t("click",function(){return n.onLogin()}),pt(14,xie,1,0,"i",10),Ee(15),ae(),oe(16,"p",11),Ee(17," \xBFNo tienes una cuenta? "),oe(18,"a",12),Ee(19,"Reg\xEDstrate aqu\xED"),ae()()(),pt(20,wie,3,1,"div",13),ae()),e&2&&(ge(4),Be("formGroup",n.registerForm),ge(4),Be("ngIf",n.emailInvalid),ge(4),Be("ngIf",n.passwordInvalid),ge(),Be("disabled",n.registerForm.invalid||n.isSubmitting),ge(),Be("ngIf",n.isSubmitting),ge(),zi(" ",n.isSubmitting?"Ingresando...":"Ingresar"," "),ge(5),Be("ngIf",n.showReetPassword))},dependencies:[da,la,io,xo,sa,Yr,Xo,Zn,Dl,ay],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c}body[_ngcontent-%COMP%]{background-color:var(--primary-bg);font-family:Segoe UI,sans-serif;color:var(--primary-dark)}.login-container[_ngcontent-%COMP%]{width:360px;background:var(--input-bg);margin:60px auto;padding:30px;border-radius:12px;text-align:center;box-shadow:0 4px 15px #0000001a;position:relative}.logo[_ngcontent-%COMP%]{width:80px;margin:0 auto 20px;display:block}h2[_ngcontent-%COMP%]{font-size:24px;margin:0 0 25px;color:var(--primary-dark)}.field-group[_ngcontent-%COMP%]{position:relative;margin-bottom:15px}.field-group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:12px;transform:translateY(-50%);color:var(--primary-accent);font-size:18px}.field-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px 12px 12px 40px;border:2px solid #ccc;border-radius:6px;font-size:14px;background:var(--input-bg);transition:border-color .2s ease;box-sizing:border-box}.field-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-accent)}.error-message[_ngcontent-%COMP%]{text-align:left;color:var(--error-color);font-size:13px;margin:-10px 0 10px;padding-left:40px}.submit-button[_ngcontent-%COMP%]{width:100%;padding:12px;background:var(--primary-accent);color:#000;border:none;border-radius:6px;cursor:pointer;font-size:16px;font-weight:600;transition:background .3s ease,transform .2s ease;box-shadow:0 2px 8px #00000026}.submit-button[_ngcontent-%COMP%]:disabled{background:#aaa;cursor:not-allowed;color:#ccc}.submit-button[_ngcontent-%COMP%]:not(:disabled):hover{background:var(--primary-dark);transform:translateY(-2px);color:#000}.register-link[_ngcontent-%COMP%]{margin-top:18px;font-size:14px}.register-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--primary-accent);text-decoration:none;font-weight:600}.register-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.resend-container[_ngcontent-%COMP%]{margin-top:20px}.resend-button[_ngcontent-%COMP%]{padding:10px 16px;background:var(--primary-bg);color:var(--primary-dark);border:2px solid var(--primary-accent);border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;transition:background .3s ease,transform .2s ease;display:inline-flex;align-items:center;gap:8px}.resend-button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.resend-button[_ngcontent-%COMP%]:not(:disabled):hover{background:var(--primary-accent);color:var(--input-bg);transform:translateY(-1px)}"]})};var Sp=o_(Ey());var Rl=63710088e-1,c6={centimeters:Rl*100,centimetres:Rl*100,degrees:360/(2*Math.PI),feet:Rl*3.28084,inches:Rl*39.37,kilometers:Rl/1e3,kilometres:Rl/1e3,meters:Rl,metres:Rl,miles:Rl/1609.344,millimeters:Rl*1e3,millimetres:Rl*1e3,nauticalmiles:Rl/1852,radians:1,yards:Rl*1.0936};function d6(i,t,e={}){let n={type:"Feature"};return(e.id===0||e.id)&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.properties=t||{},n.geometry=i,n}function u6(i,t,e={}){if(!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!l6(i[0])||!l6(i[1]))throw new Error("coordinates must contain numbers");return d6({type:"Point",coordinates:i},t,e)}function h6(i,t,e={}){for(let s of i){if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(s[s.length-1].length!==s[0].length)throw new Error("First and last Position are not equivalent.");for(let r=0;r<s[s.length-1].length;r++)if(s[s.length-1][r]!==s[0][r])throw new Error("First and last Position are not equivalent.")}return d6({type:"Polygon",coordinates:i},t,e)}function p6(i,t="kilometers"){let e=c6[t];if(!e)throw new Error(t+" units is invalid");return i*e}function f6(i,t="kilometers"){let e=c6[t];if(!e)throw new Error(t+" units is invalid");return i/e}function pP(i){return i%(2*Math.PI)*180/Math.PI}function ju(i){return i%360*Math.PI/180}function l6(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function Px(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return[...i.geometry.coordinates];if(i.type==="Point")return[...i.coordinates]}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return[...i];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function m6(i,t,e,n={}){let s=Px(i),r=ju(s[0]),y=ju(s[1]),A=ju(e),P=f6(t,n.units),B=Math.asin(Math.sin(y)*Math.cos(P)+Math.cos(y)*Math.sin(P)*Math.cos(A)),U=r+Math.atan2(Math.sin(A)*Math.sin(P)*Math.cos(y),Math.cos(P)-Math.sin(y)*Math.sin(B)),J=pP(U),le=pP(B);return u6([J,le],n.properties)}function fP(i,t,e={}){var n=Px(i),s=Px(t),r=ju(s[1]-n[1]),y=ju(s[0]-n[0]),A=ju(n[1]),P=ju(s[1]),B=Math.pow(Math.sin(r/2),2)+Math.pow(Math.sin(y/2),2)*Math.cos(A)*Math.cos(P);return p6(2*Math.atan2(Math.sqrt(B),Math.sqrt(1-B)),e.units)}function Ox(i,t,e={}){let n=e.steps||64,s=e.properties?e.properties:!Array.isArray(i)&&i.type==="Feature"&&i.properties?i.properties:{},r=[];for(let y=0;y<n;y++)r.push(m6(i,t,y*-360/n,e).geometry.coordinates);return r.push(r[0]),h6([r],s)}var ic=class i{constructor(t){this.http=t}apiUrl=`${aa.urlBack}/categories`;cetegorySubject=new Cr([]);categories$=this.cetegorySubject.asObservable();getAllActiveCategories(){return this.http.get(this.apiUrl,{withCredentials:!0}).pipe(Gn(t=>{this.cetegorySubject.next(t)}))}getAllCategories(){return this.http.get(`${this.apiUrl}/all`,{withCredentials:!0}).pipe(Gn(t=>{this.cetegorySubject.next(t)}))}addCategory(t){return this.http.post(this.apiUrl,t,{withCredentials:!0})}toggleCategoryActivation(t){let e=`${this.apiUrl}/${t}/toggle-activated`;return this.http.patch(e,{},{withCredentials:!0})}getCategoryById(t){return this.http.get(`${this.apiUrl}/${t}`,{withCredentials:!0})}updateCategory(t,e){return this.http.put(`${this.apiUrl}/${t}`,e,{withCredentials:!0})}static \u0275fac=function(e){return new(e||i)(hi(zo))};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})};var DD=class i{constructor(t){this.http=t}uploadPreset="default";uploadImage(t){let e=`https://api.cloudinary.com/v1_1/${aa.cloud_name}/image/upload`,n=new FormData;return n.append("file",t),n.append("upload_preset",this.uploadPreset),n.append("api_key",aa.api_key),this.http.post(e,n)}static \u0275fac=function(e){return new(e||i)(hi(zo))};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})};var MD=class i{constructor(t,e){this.http=t;this.cloudinaryService=e}apiUrl=`${aa.urlBack}/images`;registerImage(t,e){this.cloudinaryService.uploadImage(t).subscribe({next:n=>{if(console.log("Imagen subida:",n),e.id){let s={imageUrl:n.url,reportId:e.id};this.http.post(`${this.apiUrl}`,s,{withCredentials:!0}).subscribe({next:r=>{console.log("Imagen registrada en el reporte:",r)},error:r=>{console.error("Error registrando la imagen en el reporte:",r)}})}},error:n=>{console.error("Error subiendo la imagen  cloudinary:",n)}})}deleteImage(t){this.http.delete(`${this.apiUrl}/${t}`).subscribe({next:e=>{console.log("Imagen eliminada:",e)},error:e=>{console.error("Error eliminando la imagen:",e)}})}static \u0275fac=function(e){return new(e||i)(hi(zo),hi(DD))};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})};var rl=class i{constructor(t,e){this.http=t;this.imageService=e}apiUrl=`${aa.urlBack}/reports`;selectedReportSource=new Cr(null);selectedReport$=this.selectedReportSource.asObservable();reportsSubject=new Cr([]);reports$=this.reportsSubject.asObservable();toggleVote(t){return this.http.patch(`${this.apiUrl}/${t}/votes`,{},{withCredentials:!0})}selectReport(t){this.selectedReportSource.next(t)}createReport(t,e){return this.http.post(this.apiUrl,t,{withCredentials:!0}).pipe(Gn(n=>{console.log("Reporte creado:",n),this.imageService.registerImage(e,n)}))}getReports(){let t=new ka;return t=t.set("latitud",sessionStorage.getItem("lat")||""),t=t.set("longitud",sessionStorage.getItem("lng")||""),t=t.set("radio",sessionStorage.getItem("radiusKm")||""),this.http.get(`${this.apiUrl}`,{params:t,withCredentials:!0}).pipe(Gn(e=>{this.reportsSubject.next(e.content)}))}refreshReports(){this.getReports().subscribe()}getReportById(t){return this.http.get(`${this.apiUrl}/${t}`,{withCredentials:!0}).pipe(tr(this.handleError))}getAllImagesReportById(t){return this.http.get(`${this.apiUrl}/${t}/images`,{withCredentials:!0}).pipe(tr(this.handleError))}getAllCommentsReportById(t){return this.http.get(`${this.apiUrl}/${t}/comments`,{withCredentials:!0}).pipe(tr(this.handleError))}updateReport(t,e,n){return console.log(e),n&&this.getAllImagesReportById(t).subscribe(s=>{s.forEach(r=>{this.imageService.deleteImage(r.id)}),this.imageService.registerImage(n,{id:t})}),this.http.put(`${this.apiUrl}/${t}`,e,{withCredentials:!0}).pipe(tr(this.handleError))}deleteReport(t){return this.http.delete(`${this.apiUrl}/${t}`,{withCredentials:!0}).pipe(tr(this.handleError))}resolveReport(t){return this.http.patch(`${this.apiUrl}/${t}/resolve`,{withCredentials:!0}).pipe(tr(this.handleError))}updateReportStatus(t,e,n){let s={status:e,rejectionMessage:n??null};return this.http.patch(`${this.apiUrl}/${t}/status`,s,{withCredentials:!0})}getMyReportsPaginated(t=1,e=10,n){let s=new ka().set("page",t).set("size",e);return this.http.get(`${this.apiUrl}/my`,{params:s,withCredentials:!0}).pipe(Ui(r=>{let y=r.content.map(A=>Xi(Ct({},A),{createdAt:new Date(A.createdAt),updatedAt:A.updatedAt?new Date(A.updatedAt):void 0,resolvedAt:A.resolvedAt?new Date(A.resolvedAt):void 0}));return Xi(Ct({},r),{content:y})}),Gn(r=>{console.log(`Reportes cargados: p\xE1gina ${r.page} de ${r.totalPages}, elementos totales: ${r.totalElements}`)}),tr(r=>(console.error("Error al obtener reportes paginados",r),lo(()=>r))))}getAllReportsPaginated(t=1,e=10,n){let s=new ka().set("page",t).set("size",e);return n&&(s=s.set("status",n)),this.http.get(`${this.apiUrl}/admin`,{params:s,withCredentials:!0}).pipe(Ui(r=>{let y=r.content.map(A=>Xi(Ct({},A),{createdAt:new Date(A.createdAt),updatedAt:A.updatedAt?new Date(A.updatedAt):void 0,resolvedAt:A.resolvedAt?new Date(A.resolvedAt):void 0}));return Xi(Ct({},r),{content:y})}),Gn(r=>{console.log(`Reportes cargados: p\xE1gina ${r.page} de ${r.totalPages}, elementos totales: ${r.totalElements}`)}),tr(r=>(console.error("Error al obtener reportes paginados",r),lo(()=>r))))}handleError(t){return console.error("Ocurri\xF3 un error en ReportService:",t),lo(()=>new Error("Error en la operaci\xF3n del reporte. Intenta de nuevo."))}static \u0275fac=function(e){return new(e||i)(hi(zo),hi(MD))};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})};var Sie=(i,t)=>({"star-gray":i,"star-yellow":t});function Die(i,t){if(i&1&&(oe(0,"option",10),Ee(1),ae()),i&2){let e=t.$implicit;Be("value",e.name),ge(),tn(e.name)}}function Mie(i,t){if(i&1){let e=bi();oe(0,"li")(1,"div",11),_t("click",function(){let s=qt(e).$implicit,r=bt();return Wt(r.flyToReport(s))}),oe(2,"strong"),Ee(3),ae(),Ee(4),oe(5,"p",12)(6,"mat-icon",13),Ee(7,"star "),ae(),Ee(8),ae(),oe(9,"p"),Ee(10),ae()()()}if(i&2){let e=t.$implicit,n=bt();ge(3),tn(e.title),ge(),zi(" (",n.getCategoryNames(e),") "),ge(2),Be("ngClass",v4(6,Sie,e.importantVotes===0,e.importantVotes>0)),ge(2),kd(" ",e.importantVotes||0," voto",e.importantVotes===1?"":"s"," importantes "),ge(2),zi("descripci\xF3n: ",e.description,"")}}function Tie(i,t){i&1&&(oe(0,"li"),Ee(1," No hay reportes para mostrar con el filtro actual. "),ae())}var ID=class i{constructor(t,e,n){this.categoryService=t;this.reportService=e;this.router=n}actionFilterReport=new ui;categories=[];allReports=[];filteredReports=[];selectedCategory="";ngOnInit(){this.reportService.reports$.subscribe(t=>{this.allReports=t,this.filteredReports=this.sortByVotesDesc(this.allReports)}),this.loadCategories(),this.categoryService.categories$.subscribe(t=>{this.categories=t})}loadCategories(){this.categoryService.getAllActiveCategories().subscribe()}sortByVotesDesc(t){return[...t].sort((e,n)=>(n.importantVotes||0)-(e.importantVotes||0))}filterReports(t){this.selectedCategory=t;let e=t?this.allReports.filter(n=>n.categoryList?.some(s=>s.name===t)):[...this.allReports];this.filteredReports=this.sortByVotesDesc(e),this.actionFilterReport.emit(this.filteredReports)}flyToReport(t){this.reportService.selectReport(t)}editReport(t){t&&this.router.navigate(["/report/edit",t])}searchAddress(t){console.log("Buscar direcci\xF3n:",t)}getCategoryNames(t){return!t.categoryList||t.categoryList.length===0?"Sin categor\xEDa":t.categoryList.map(e=>e.name).join(", ")}static \u0275fac=function(e){return new(e||i)(ai(ic),ai(rl),ai(fn))};static \u0275cmp=Yt({type:i,selectors:[["report-categories-filter"]],outputs:{actionFilterReport:"actionFilterReport"},decls:14,vars:3,consts:[["categorySelect",""],[1,"report-panel"],[1,"filter-section"],["for","category-filter"],["id","category-filter",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"report-list"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],[2,"cursor","pointer",3,"click"],[1,"important-votes"],[1,"star-icon",3,"ngClass"]],template:function(e,n){if(e&1){let s=bi();oe(0,"div",1)(1,"h3"),Ee(2,"Reportes"),ae(),oe(3,"div",2)(4,"label",3),Ee(5,"Filtrar por categor\xEDa:"),ae(),oe(6,"select",4,0),_t("change",function(){qt(s);let y=No(7);return Wt(n.filterReports(y.value))}),oe(8,"option",5),Ee(9,"Todos"),ae(),pt(10,Die,2,2,"option",6),ae()(),oe(11,"ul",7),pt(12,Mie,11,9,"li",8)(13,Tie,2,0,"li",9),ae()()}e&2&&(ge(10),Be("ngForOf",n.categories),ge(2),Be("ngForOf",n.filteredReports),ge(),Be("ngIf",n.filteredReports.length===0))},dependencies:[sr,qa,cs,Zn,no],styles:[".report-panel[_ngcontent-%COMP%]{width:300px;min-width:300px;max-width:300px;height:100vh;background-color:#f8f9fa;padding:15px;border-right:1px solid #dee2e6;display:flex;flex-direction:column;overflow:hidden;box-sizing:border-box}.filter-section[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:8px;border:1px solid #ced4da;border-radius:4px;box-sizing:border-box}.report-panel[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{max-width:100%;word-wrap:break-word;overflow-wrap:break-word}.report-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;overflow-y:auto;flex:1;min-height:0}.report-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:10px;border-bottom:1px solid #eee;cursor:pointer;transition:background-color .2s ease}.report-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:#e9ecef}.report-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;font-size:1em;margin-bottom:3px}.report-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85em;color:#6c757d;margin:0;word-wrap:break-word;overflow-wrap:break-word}.report-list[_ngcontent-%COMP%]   .star-icon.star-gray[_ngcontent-%COMP%]{color:gray!important}.report-list[_ngcontent-%COMP%]   .star-icon.star-yellow[_ngcontent-%COMP%]{color:gold!important}"]})};var AD=class i{constructor(t){this.http=t}apiUrl=`${aa.urlBack}/comments`;registerComments(t){return this.http.post(`${this.apiUrl}`,t,{withCredentials:!0})}static \u0275fac=function(e){return new(e||i)(hi(zo))};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})};function Aie(i,t){if(i&1&&(oe(0,"swiper-slide"),Et(1,"img",23),ae()),i&2){let e=t.$implicit,n=bt(3);ge(),Be("src",e.imageUrl,mm)("alt",n.report.title)}}function Rie(i,t){if(i&1&&(oe(0,"div",20)(1,"swiper-container",21),pt(2,Aie,2,2,"swiper-slide",22),ae()()),i&2){let e=bt(2);ge(2),Be("ngForOf",e.report.images)}}function kie(i,t){i&1&&(oe(0,"div",24),Ee(1,"No hay im\xE1genes disponibles"),ae())}function Pie(i,t){if(i&1&&(oe(0,"div",25)(1,"div",26)(2,"mat-icon"),Ee(3,"person"),ae(),oe(4,"strong"),Ee(5),ae()(),oe(6,"p"),Ee(7),ae()()),i&2){let e=t.$implicit;ge(5),tn(e.userName),ge(2),tn(e.comment)}}function Oie(i,t){if(i&1){let e=bi();oe(0,"div",2)(1,"div",3)(2,"button",4),_t("click",function(){qt(e);let s=bt();return Wt(s.close.emit())}),oe(3,"mat-icon"),Ee(4,"close"),ae()(),oe(5,"div",5)(6,"h2",6),Ee(7),ae(),pt(8,Rie,3,1,"div",7)(9,kie,2,0,"ng-template",null,0,lp),ae(),oe(11,"div",8)(12,"p",9)(13,"strong"),Ee(14,"Categor\xEDas:"),ae(),Ee(15),ae(),oe(16,"p",10),Ee(17),ae(),oe(18,"div",11)(19,"button",12),_t("click",function(){qt(e);let s=bt();return Wt(s.toggleVote(s.report))}),oe(20,"mat-icon",13),Ee(21,"star"),ae(),Ee(22," Es importante "),ae(),oe(23,"div",14),Ee(24),ae()(),oe(25,"div",15)(26,"h3"),Ee(27,"Comentarios"),ae(),pt(28,Pie,8,2,"div",16),oe(29,"div",17)(30,"textarea",18),Au("ngModelChange",function(s){qt(e);let r=bt();return sp(r.newComment,s)||(r.newComment=s),Wt(s)}),ae(),oe(31,"button",19),_t("click",function(){qt(e);let s=bt();return Wt(s.addComment())}),Ee(32,"Comentar"),ae()()()()()()}if(i&2){let e=No(10),n=bt();ge(7),tn(n.report.title),ge(),Be("ngIf",n.report.images==null?null:n.report.images.length)("ngIfElse",e),ge(7),zi(" ",n.getCategoryNames(),""),ge(2),tn(n.report.description),ge(3),Be("ngClass",n.hasVoted?"star-yellow":"star-gray"),ge(4),zi(" ",n.report.importantVotes," Votos "),ge(4),Be("ngForOf",n.report.comments),ge(2),Iu("ngModel",n.newComment)}}var RD=class i{constructor(t,e){this.reportService=t;this.commentService=e}report=null;close=new ui;newComment="";hasVoted=!1;ngOnInit(){this.report?.id&&this.loadComments(this.report.id)}loadComments(t){this.reportService.getAllCommentsReportById(t).subscribe({next:e=>{e.size>0&&this.report&&(this.report.comments=e.content)}})}addComment(){if(this.report?.id&&this.newComment.trim()){let t={reportId:this.report.id,comment:this.newComment.trim()};this.commentService.registerComments(t).subscribe({next:e=>{this.report?.comments?.push(e),this.newComment=""},error:e=>console.error(e)})}}toggleVote(t){if(!t.id){console.error("El reporte no tiene ID definido, no se puede alternar el voto.");return}this.reportService.toggleVote(t.id).subscribe({next:e=>{let n=e?1:-1;t.importantVotes=(t.importantVotes||0)+n,this.hasVoted=e},error:e=>{console.error("Error al alternar voto:",e)}})}getCategoryNames(){return this.report?.categoryList?.map(t=>t.name).join(", ")||"Sin categor\xEDa"}static \u0275fac=function(e){return new(e||i)(ai(rl),ai(AD))};static \u0275cmp=Yt({type:i,selectors:[["report-details-overlay"]],inputs:{report:"report"},outputs:{close:"close"},decls:1,vars:1,consts:[["noImages",""],["class","report-overlay",4,"ngIf"],[1,"report-overlay"],[1,"report-details"],[1,"close-btn",3,"click"],[1,"fixed-section"],[1,"title"],["class","image-carousel",4,"ngIf","ngIfElse"],[1,"scroll-section"],[1,"category"],[1,"description"],[1,"actions"],[1,"toggle-vote-btn",3,"click"],[3,"ngClass"],[1,"votes"],[1,"comments-section"],["class","comment",4,"ngFor","ngForOf"],[1,"add-comment"],["placeholder","Agregar un comentario",3,"ngModelChange","ngModel"],[1,"btn-primary",3,"click"],[1,"image-carousel"],["navigation","true","pagination","true","loop","true"],[4,"ngFor","ngForOf"],[3,"src","alt"],[1,"no-images"],[1,"comment"],[1,"comment-header"]],template:function(e,n){e&1&&pt(0,Oie,33,9,"div",1),e&2&&Be("ngIf",n.report)},dependencies:[sr,qa,cs,Zn,Ep,io,xo,Tx,ua,no],styles:[".report-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0009;display:flex;justify-content:center;align-items:center;z-index:1000;padding:1rem;overflow-y:auto}.report-details[_ngcontent-%COMP%]{background:#fff;border-radius:12px;width:90%;max-width:800px;height:90vh;display:flex;flex-direction:column;box-shadow:0 8px 24px #0003;position:relative;overflow:hidden;box-sizing:border-box;padding:1rem}.close-btn[_ngcontent-%COMP%]{position:absolute;top:.75rem;right:.75rem;background:none;border:none;font-size:1.25rem;cursor:pointer;color:#555;transition:color .2s}.close-btn[_ngcontent-%COMP%]:hover{color:#000}.fixed-section[_ngcontent-%COMP%]{flex:0 0 auto}.title[_ngcontent-%COMP%]{margin:0 0 .75rem;font-size:1.75rem;text-align:center;color:#333}.image-carousel[_ngcontent-%COMP%]{width:100%;height:180px;border-radius:8px;overflow:hidden;margin-bottom:1rem}.image-carousel[_ngcontent-%COMP%]   swiper-container[_ngcontent-%COMP%]{width:100%;height:100%}.image-carousel[_ngcontent-%COMP%]   swiper-slide[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.image-carousel[_ngcontent-%COMP%]   swiper-slide[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.scroll-section[_ngcontent-%COMP%]{flex:1 1 auto;overflow-y:auto;padding-right:.5rem;display:flex;flex-direction:column;gap:1rem}.no-images[_ngcontent-%COMP%]{font-style:italic;color:#888;text-align:center}.category[_ngcontent-%COMP%], .description[_ngcontent-%COMP%]{font-size:1rem;color:#555}.category[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#333}.actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.toggle-vote-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.3rem;background:linear-gradient(135deg,#f9a825,#ffd54f);border:none;padding:.5rem 1rem;border-radius:24px;font-weight:700;color:#333;cursor:pointer;box-shadow:0 2px 6px #00000026;transition:transform .1s,box-shadow .1s}.toggle-vote-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0003}.toggle-vote-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.2rem}.votes[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.3rem;color:#666}.votes[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1976d2}.comments-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;color:#333}.comment[_ngcontent-%COMP%]{padding:.75rem 0;border-bottom:1px solid #eee}.comment-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:.9rem;color:#444}.comment-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1rem;color:#888}.comment[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0 0;font-size:.95rem;color:#555}.add-comment[_ngcontent-%COMP%]{margin-top:auto}.add-comment[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:97%;min-height:80px;padding:.75rem;border:1px solid #ccc;border-radius:6px;resize:vertical;font-size:1rem;margin-bottom:.5rem}.add-comment[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background-color:#1976d2;color:#fff;border:none;padding:.5rem 1rem;border-radius:6px;cursor:pointer;transition:background-color .2s}.add-comment[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover{background-color:#155fa0}.star-yellow[_ngcontent-%COMP%]{color:gold}.star-gray[_ngcontent-%COMP%]{color:gray}"]})};function Fie(i,t){if(i&1){let e=bi();oe(0,"report-details-overlay",9),_t("close",function(){qt(e);let s=bt();return Wt(s.selectedReport=null)}),ae()}if(i&2){let e=bt();Be("report",e.selectedReport)}}var kD=class i{constructor(t,e){this.reportService=t;this.authService=e}mapa;markers=[];platformId=Z(as);allReports=[];selectedReport=null;reportClicked=new ui;ngOnInit(){this.reportService.reports$.subscribe(t=>{this.allReports=t,this.loadImage()}),this.authService.getCurrentUser().subscribe({next:t=>{this.loadReports(),tl(this.platformId)&&this.initializeMap([t.longitude,t.latitude])},error:()=>{let t=[-75.681,4.533];this.loadReports(),tl(this.platformId)&&this.initializeMap(t)}}),this.reportService.selectedReport$.subscribe(t=>{this.selectedReport=t,t&&this.flyToReport(t)})}ngOnDestroy(){this.mapa?.remove()}loadReports(){this.reportService.getReports().subscribe({error:t=>console.error("Error reportes",t)})}initializeMap(t){this.mapa||(this.mapa=new Sp.default.Map({accessToken:Kc.mapboxToken,container:"map",style:"mapbox://styles/mapbox/streets-v11",center:t,zoom:12}),this.addUserMarker(t),this.mapa.addControl(new Sp.default.NavigationControl,"bottom-right"),this.mapa.addControl(new Sp.default.ScaleControl({maxWidth:100,unit:"metric"})),this.mapa.on("load",()=>{this.mapa.resize(),this.updateMarkers(this.allReports),this.drawUserRadius(t)}),this.mapa.on("error",e=>console.error("Mapbox error",e)))}drawUserRadius(t){let e=parseFloat(sessionStorage.getItem("radiusKm")||"1"),n=Ox(t,e,{steps:64,units:"kilometers"});this.mapa.getSource("user-radius")?this.mapa.getSource("user-radius").setData(n):(this.mapa.addSource("user-radius",{type:"geojson",data:n}),this.mapa.addLayer({id:"user-radius-fill",type:"fill",source:"user-radius",paint:{"fill-color":"#007BFF","fill-opacity":.15}}),this.mapa.addLayer({id:"user-radius-outline",type:"line",source:"user-radius",paint:{"line-color":"#007BFF","line-width":2}}))}addUserMarker(t){let e=document.createElement("div");e.className="user-marker",e.style.backgroundImage="url(user.ico)",e.style.width="40px",e.style.height="40px",e.style.backgroundSize="contain",new Sp.default.Marker(e).setLngLat(t).setPopup(new Sp.default.Popup().setText("Tu ubicaci\xF3n")).addTo(this.mapa)}clearMarkers(){this.markers.forEach(t=>t.remove()),this.markers=[]}updateMarkers(t){if(this.mapa){if(this.clearMarkers(),!this.mapa||!this.mapa.isStyleLoaded()){console.warn("Map is not ready yet. Skipping marker update.");return}t.forEach(e=>{let n=new Sp.default.Popup({closeButton:!1,closeOnMove:!0,anchor:"bottom",offset:[0,-20]}).setHTML(`
                <div class="report-popup">
                  <div class="popup-content">
                    <div class="popup-image">
                      <img src="${e.images&&e.images.length>0?e.images[0].imageUrl:"placeholder.png"}" alt="${e.title}" />
                    </div>
                    <div class="popup-info">
                      <h6 class="popup-title">${e.title}</h6>
                      <p class="popup-votes">${e.importantVotes} votos</p>
                    </div>
                  </div>
                </div>
              `),s=new Sp.default.Marker().setLngLat([e.longitude,e.latitude]).setDraggable(!1).setPopup(n).addTo(this.mapa);s.getElement().addEventListener("mouseenter",()=>{n.addTo(this.mapa)}),s.getElement().addEventListener("mouseleave",()=>{n.remove()}),s.getElement().addEventListener("click",()=>{this.selectedReport=e}),this.markers.push(s)})}}flyToReport(t){t&&this.mapa.flyTo({center:[t.longitude,t.latitude],zoom:15,essential:!0})}searchAddress(t){console.log("Buscar direcci\xF3n:",t)}loadImage(){for(let t of this.allReports)t.id&&this.reportService.getAllImagesReportById(t.id).subscribe({next:e=>{e.length>0&&t&&(t.images=e)}})}static \u0275fac=function(e){return new(e||i)(ai(rl),ai(eo))};static \u0275cmp=Yt({type:i,selectors:[["app-map-view"]],outputs:{reportClicked:"reportClicked"},decls:10,vars:1,consts:[["searchInput",""],[1,"map-view-container"],[3,"actionFilterReport"],[3,"report","close",4,"ngIf"],[1,"map-panel"],[1,"search-bar"],["type","text","placeholder","Buscar direcci\xF3n..."],[3,"click"],["id","map",1,"map"],[3,"close","report"]],template:function(e,n){if(e&1){let s=bi();oe(0,"div",1)(1,"report-categories-filter",2),_t("actionFilterReport",function(y){return qt(s),Wt(n.updateMarkers(y))}),ae(),pt(2,Fie,1,1,"report-details-overlay",3),oe(3,"div",4)(4,"div",5),Et(5,"input",6,0),oe(7,"button",7),_t("click",function(){qt(s);let y=No(6);return Wt(n.searchAddress(y.value))}),Ee(8,"\u{1F50D}"),ae()(),Et(9,"div",8),ae()()}e&2&&(ge(2),Be("ngIf",n.selectedReport))},dependencies:[sr,Zn,ID,RD],styles:[".map-view-container[_ngcontent-%COMP%]{display:flex;width:100%;height:100vh;overflow:hidden}.map-panel[_ngcontent-%COMP%]{flex-grow:1;position:relative;display:flex;flex-direction:column}.map[_ngcontent-%COMP%]{width:100%;flex-grow:1;height:100%}.search-bar[_ngcontent-%COMP%]{position:absolute;top:10px;left:10px;transform:none;z-index:10;display:flex;background:#fff;padding:5px;border-radius:5px;box-shadow:0 2px 4px #0003}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;padding:5px}.search-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;background:none;cursor:pointer;padding:5px}.star-icon[_ngcontent-%COMP%]{vertical-align:middle;font-size:20px;margin-right:4px}.star-gray[_ngcontent-%COMP%]{color:gray}.star-yellow[_ngcontent-%COMP%]{color:gold}.important-votes[_ngcontent-%COMP%]{display:flex;align-items:center;margin:4px 0}"]})};var $d=class i{constructor(t,e){this.authService=t;this.router=e}canActivate(){return console.log("call canActivate"),this.authService.isLoggedIn().pipe(Ui(t=>t?!0:this.router.createUrlTree(["/login"])),tr(()=>wi(this.router.createUrlTree(["/login"]))))}static \u0275fac=function(e){return new(e||i)(hi(eo),hi(fn))};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})};var Lie=["digitInput"];function Nie(i,t){i&1&&Et(0,"i",20)}function zie(i,t){i&1&&Et(0,"i",21)}function Bie(i,t){if(i&1&&(oe(0,"span"),Ee(1),ae()),i&2){let e=bt();ge(),zi("Reenviar en ",e.formattedTime,"")}}function Vie(i,t){i&1&&(oe(0,"span"),Ee(1,"Reenviar C\xF3digo"),ae())}var Fx=class i{fb=Z(ca);router=Z(fn);notificationService=Z(Pr);authService=Z(eo);isSubmitting=!1;isResend=!1;digitInputs;verificationForm=this.fb.group({digit0:new Wr(null,[si.required,si.pattern(/^\d$/)]),digit1:new Wr(null,[si.required,si.pattern(/^\d$/)]),digit2:new Wr(null,[si.required,si.pattern(/^\d$/)]),digit3:new Wr(null,[si.required,si.pattern(/^\d$/)]),digit4:new Wr(null,[si.required,si.pattern(/^\d$/)]),digit5:new Wr(null,[si.required,si.pattern(/^\d$/)])});resendDisabled=!1;secondsLeft=0;countdownSub;ngOnInit(){}ngOnDestroy(){this.countdownSub?.unsubscribe()}submitCode(){if(this.verificationForm.invalid){this.notificationService.error("Por favor completa todos los campos del c\xF3digo."),this.verificationForm.markAllAsTouched();return}if(this.isSubmitting)return;this.isSubmitting=!0;let t=Object.values(this.verificationForm.value).join("");this.authService.validateAccount(t).subscribe({next:()=>{this.notificationService.success("\u2705 Cuenta validada exitosamente"),sessionStorage.removeItem("Email"),this.router.navigate(["/login"])},error:e=>{console.error("Error completo al validar cuenta:",e);let n=e.status,s="Ocurri\xF3 un error al validar la cuenta.";if(n===400){let r;try{r=typeof e.error=="string"?JSON.parse(e.error):e.error}catch{r={message:e.error}}let y=r.message?.toLowerCase()??"";y.includes("c\xF3digo inv\xE1lido")?s="El c\xF3digo es inv\xE1lido.":y.includes("expirado")?s="El c\xF3digo ha expirado.":s=y||"Solicitud incorrecta."}else n===500&&(s="Error interno del servidor.");this.notificationService.error(s),this.isSubmitting=!1}})}resendCode(){if(this.resendDisabled||this.isSubmitting||this.isResend)return;this.isResend=!0;let t=sessionStorage.getItem("email");if(!t){this.notificationService.error("No se encontr\xF3 el email del usuario.");return}this.authService.sendCodeAgain(t).subscribe({next:()=>{this.startCountdown(),this.notificationService.success("\xA1C\xF3digo reenviado exitosamente!"),this.isResend=!1},error:e=>{let n=e.status,s="Ocurri\xF3 un error al reenviar el c\xF3digo.";n===404?s="Usuario no encontrado.":n===500&&(s="Error interno del servidor."),this.notificationService.error(s),this.isResend=!1}})}startCountdown(){this.countdownSub?.unsubscribe(),this.resendDisabled=!0,this.secondsLeft=120,this.countdownSub=Y0(1e3).pipe(Xf(()=>this.secondsLeft>0)).subscribe(()=>{this.secondsLeft--,this.secondsLeft===0&&(this.resendDisabled=!1)})}get formattedTime(){let t=Math.floor(this.secondsLeft/60).toString().padStart(2,"0"),e=(this.secondsLeft%60).toString().padStart(2,"0");return`${t}:${e}`}onCodeInput(t,e){let s=t.target.value.replace(/\D/g,"").slice(0,1),r=`digit${e}`;this.verificationForm.controls[r].setValue(s,{emitEvent:!1}),s&&e<this.digitInputs.length-1&&this.digitInputs.toArray()[e+1].nativeElement.focus()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Yt({type:i,selectors:[["app-verification"]],viewQuery:function(e,n){if(e&1&&Bn(Lie,5),e&2){let s;Bi(s=Vi())&&(n.digitInputs=s)}},decls:30,vars:8,consts:[["digitInput",""],[1,"verification-container"],[1,"logo"],[1,"fas","fa-shield-alt"],[1,"subtitle"],[3,"ngSubmit","formGroup"],[1,"code-inputs"],["type","text","maxlength","1","formControlName","digit0","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit1","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit2","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit3","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit4","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit5","placeholder","-",1,"digit-input",3,"input"],["type","submit",1,"submit-button",3,"disabled"],["class","fas fa-check-circle",4,"ngIf"],["class","fas fa-spinner fa-spin me-2",4,"ngIf"],[1,"resend-container"],["type","button",1,"resend-button",3,"click","disabled"],[1,"fas","fa-clock"],[4,"ngIf"],[1,"fas","fa-check-circle"],[1,"fas","fa-spinner","fa-spin","me-2"]],template:function(e,n){if(e&1){let s=bi();oe(0,"div",1)(1,"div",2),Et(2,"i",3),ae(),oe(3,"h2"),Ee(4,"Verificaci\xF3n de Cuenta"),ae(),oe(5,"p",4),Ee(6,"Ingresa el c\xF3digo de 6 d\xEDgitos enviado a tu correo"),ae(),oe(7,"form",5),_t("ngSubmit",function(){return qt(s),Wt(n.submitCode())}),oe(8,"div",6)(9,"input",7,0),_t("input",function(y){return qt(s),Wt(n.onCodeInput(y,0))}),ae(),oe(11,"input",8,0),_t("input",function(y){return qt(s),Wt(n.onCodeInput(y,1))}),ae(),oe(13,"input",9,0),_t("input",function(y){return qt(s),Wt(n.onCodeInput(y,2))}),ae(),oe(15,"input",10,0),_t("input",function(y){return qt(s),Wt(n.onCodeInput(y,3))}),ae(),oe(17,"input",11,0),_t("input",function(y){return qt(s),Wt(n.onCodeInput(y,4))}),ae(),oe(19,"input",12,0),_t("input",function(y){return qt(s),Wt(n.onCodeInput(y,5))}),ae()(),oe(21,"button",13),pt(22,Nie,1,0,"i",14)(23,zie,1,0,"i",15),Ee(24),ae()(),oe(25,"div",16)(26,"button",17),_t("click",function(){return qt(s),Wt(n.resendCode())}),Et(27,"i",18),pt(28,Bie,2,1,"span",19)(29,Vie,2,0,"span",19),ae()()()}e&2&&(ge(7),Be("formGroup",n.verificationForm),ge(14),Be("disabled",n.verificationForm.invalid||n.isSubmitting),ge(),Be("ngIf",!n.isSubmitting),ge(),Be("ngIf",n.isSubmitting),ge(),zi(" ",n.isSubmitting?"Validando...":"Validar C\xF3digo"," "),ge(2),Be("disabled",n.resendDisabled||n.isSubmitting||n.isResend),ge(2),Be("ngIf",n.resendDisabled),ge(),Be("ngIf",!n.resendDisabled))},dependencies:[sr,Zn,da,la,io,xo,sa,Ix,Yr,Xo],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c}.verification-container[_ngcontent-%COMP%]{width:380px;background:var(--input-bg);margin:80px auto;padding:30px 25px;border-radius:12px;text-align:center;box-shadow:0 4px 15px #0000001a}.logo[_ngcontent-%COMP%]{font-size:3rem;color:var(--primary-accent);margin-bottom:15px}h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:8px;color:var(--primary-dark)}.subtitle[_ngcontent-%COMP%]{font-size:14px;margin-bottom:25px;color:var(--primary-accent)}.code-inputs[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:20px}.digit-input[_ngcontent-%COMP%]{width:48px;height:60px;font-size:2rem;text-align:center;border:2px dashed var(--primary-dark);border-radius:6px;background:var(--input-bg);background-image:linear-gradient(to bottom right,var(--primary-accent) 2px,transparent 2px);background-size:100% 100%;transition:background .2s ease,border-color .2s ease;box-sizing:border-box}.digit-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-accent)}.digit-input.ng-valid[_ngcontent-%COMP%]{background-image:none}.submit-button[_ngcontent-%COMP%]{width:100%;padding:12px;background:var(--primary-accent);color:var(--primary-dark);border:none;border-radius:6px;cursor:pointer;font-size:16px;font-weight:600;transition:background .3s ease,transform .2s ease;box-shadow:0 2px 8px #00000026}.submit-button[_ngcontent-%COMP%]:disabled{background:#aaa;cursor:not-allowed;color:#ccc}.submit-button[_ngcontent-%COMP%]:not(:disabled):hover{background:var(--primary-dark);transform:translateY(-2px);color:var(--input-bg)}.resend-container[_ngcontent-%COMP%]{margin-top:20px}.resend-button[_ngcontent-%COMP%]{padding:10px 16px;background:var(--primary-bg);color:var(--primary-dark);border:2px solid var(--primary-accent);border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;transition:background .3s ease,transform .2s ease;display:inline-flex;align-items:center;gap:8px}.resend-button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.resend-button[_ngcontent-%COMP%]:not(:disabled):hover{background:var(--primary-accent);color:var(--input-bg);transform:translateY(-1px)}"]})};var Gd=o_(Ey());function jie(i,t){i&1&&(oe(0,"span"),Ee(1,"El t\xEDtulo es obligatorio."),ae())}function Uie(i,t){i&1&&(oe(0,"span"),Ee(1,"M\xEDnimo 5 caracteres."),ae())}function Hie(i,t){i&1&&(oe(0,"span"),Ee(1,"M\xE1ximo 100 caracteres."),ae())}function $ie(i,t){if(i&1&&(oe(0,"div",22),pt(1,jie,2,0,"span",14)(2,Uie,2,0,"span",14)(3,Hie,2,0,"span",14),ae()),i&2){let e=bt();ge(),Be("ngIf",e.title==null||e.title.errors==null?null:e.title.errors.required),ge(),Be("ngIf",e.title==null||e.title.errors==null?null:e.title.errors.minlength),ge(),Be("ngIf",e.title==null||e.title.errors==null?null:e.title.errors.maxlength)}}function Gie(i,t){i&1&&(oe(0,"span"),Ee(1,"La descripci\xF3n es obligatoria."),ae())}function qie(i,t){i&1&&(oe(0,"span"),Ee(1,"M\xEDnimo 10 caracteres."),ae())}function Wie(i,t){if(i&1&&(oe(0,"div",22),pt(1,Gie,2,0,"span",14)(2,qie,2,0,"span",14),ae()),i&2){let e=bt();ge(),Be("ngIf",e.description==null||e.description.errors==null?null:e.description.errors.required),ge(),Be("ngIf",e.description==null||e.description.errors==null?null:e.description.errors.minlength)}}function Yie(i,t){if(i&1){let e=bi();oe(0,"button",23),_t("click",function(){let s=qt(e).$implicit,r=bt();return Wt(r.toggleCategory(s.id))}),Ee(1),ae()}if(i&2){let e=t.$implicit,n=bt();Ai("selected",n.isSelected(e.id)),ge(),zi(" ",e.name," ")}}function Zie(i,t){i&1&&(oe(0,"span"),Ee(1," Debes seleccionar al menos una categor\xEDa. "),ae())}function Xie(i,t){if(i&1&&(oe(0,"div",22),pt(1,Zie,2,0,"span",14),ae()),i&2){let e=bt();ge(),Be("ngIf",(e.categoryIds==null||e.categoryIds.errors==null?null:e.categoryIds.errors.required)||(e.categoryIds==null||e.categoryIds.errors==null?null:e.categoryIds.errors.minlength))}}function Kie(i,t){if(i&1&&(oe(0,"li"),Ee(1),ae()),i&2){let e=t.$implicit,n=bt(2);ge(),zi(" ",n.getCategoryName(e)," ")}}function Qie(i,t){if(i&1&&(oe(0,"div")(1,"p"),Ee(2,"Categor\xEDas seleccionadas:"),ae(),oe(3,"ul"),pt(4,Kie,2,1,"li",24),ae()()),i&2){let e=bt();ge(4),Be("ngForOf",e.categoryIds==null?null:e.categoryIds.value)}}function Jie(i,t){i&1&&(oe(0,"div",22),Ee(1," Debes seleccionar una ubicaci\xF3n en el mapa. "),ae())}function ene(i,t){if(i&1){let e=bi();oe(0,"div",25)(1,"div",26),Et(2,"img",27),oe(3,"button",28),_t("click",function(){qt(e);let s=bt();return Wt(s.removePreview(0))}),Ee(4," \u2716 "),ae()()()}if(i&2){let e=bt();ge(2),Be("src",e.imagePreview,mm)}}function tne(i,t){i&1&&(oe(0,"div",22),Ee(1," Debes subir al menos una imagen. "),ae())}function ine(i,t){if(i&1&&(oe(0,"span"),Ee(1),ae()),i&2){let e=bt();ge(),zi(" ",e.isEditMode?"Actualizar Reporte":"Crear Reporte"," ")}}function nne(i,t){if(i&1&&(oe(0,"span"),Ee(1),ae()),i&2){let e=bt();ge(),zi(" ",e.isEditMode?"Actualizando...":"Creando..."," ")}}var Lx=class i{constructor(t,e,n,s,r,y,A){this.fb=t;this.reportService=e;this.categoryService=n;this.snackBar=s;this.router=r;this.route=y;this.cdRef=A;this.reportForm=this.fb.group({title:["",[si.required,si.minLength(5),si.maxLength(100)]],description:["",[si.required,si.minLength(10)]],categoryIds:[[],[si.required,si.minLength(1)]],latitude:[null,si.required],longitude:[null,si.required],selectedFile:[null,si.required]})}reportForm;categories=[];file=null;imagePreview=null;map;marker;isLoading=!1;isEditMode=!1;reportId=null;routeSub=null;initialReportData=null;platformId=Z(as);notificationService=Z(Pr);ngOnInit(){this.loadCategories(),this.routeSub=this.route.paramMap.subscribe(t=>{this.reportId=t.get("id"),this.reportId?(this.isEditMode=!0,this.loadReportForEdit(this.reportId)):(this.isEditMode=!1,console.log("No hay ID de reporte, modo creaci\xF3n."),setTimeout(()=>this.initializeMap(),100))})}ngAfterViewInit(){}ngOnDestroy(){this.routeSub?.unsubscribe(),this.map?.remove()}loadCategories(){this.categoryService.getAllActiveCategories().subscribe({next:t=>this.categories=t,error:t=>this.notificationService.error("Error al cargar las categor\xEDas")})}loadReportForEdit(t){this.isLoading=!0,this.reportService.getReportById(t).subscribe({next:e=>{this.initialReportData=e,this.reportForm.patchValue({title:e.title,description:e.description,categoryIds:e.categoryList.map(n=>n.id),latitude:e.latitude,longitude:e.longitude}),this.reportForm.get("selectedFile")?.clearValidators(),this.reportForm.get("selectedFile")?.updateValueAndValidity(),this.loadImages(e.id),this.isLoading=!1,this.initializeMapWithReportCoords(e.longitude,e.latitude)},error:e=>{this.isLoading=!1,this.notificationService.error("Error al cargar el reporte para editar."),this.router.navigate(["/map"])}})}initializeMapWithReportCoords(t,e){this.map&&this.map.remove(),this.map=new Gd.default.Map({accessToken:Kc.mapboxToken,container:"map_user",style:"mapbox://styles/mapbox/streets-v11",center:[t,e],zoom:15,attributionControl:!1}),this.addMapControls(),this.addMarkerWithDragging(t,e)}addMapControls(){this.map.addControl(new Gd.default.NavigationControl,"bottom-right"),this.map.addControl(new Gd.default.FullscreenControl,"top-right")}addMarkerWithDragging(t,e){this.marker&&this.marker.remove(),this.marker=new Gd.default.Marker({draggable:!0}).setLngLat([t,e]).addTo(this.map),this.marker.on("dragend",()=>{let n=this.marker.getLngLat();this.reportForm.patchValue({latitude:n.lat,longitude:n.lng})}),this.map.flyTo({center:[t,e],essential:!0})}initializeMap(t){let e=sessionStorage.getItem("lat"),n=sessionStorage.getItem("lng"),s,r;e&&n?(s={lng:parseFloat(n),lat:parseFloat(e)},r=13):t?(s={lng:t[0],lat:t[1]},r=13):(s={lng:-75.681,lat:4.533},r=13);try{this.map=new Gd.default.Map({accessToken:Kc.mapboxToken,container:"map_user",style:"mapbox://styles/mapbox/streets-v11",center:s,zoom:r,attributionControl:!1}),this.map.addControl(new Gd.default.NavigationControl,"bottom-right"),this.map.on("load",()=>{if(this.map.resize(),console.log("Mapa cargado (report form)."),this.reportForm.get("latitude")?.value&&this.reportForm.get("longitude")?.value){let y=new Gd.LngLat(this.reportForm.get("longitude")?.value,this.reportForm.get("latitude")?.value);this.updateMarkerAndForm(y)}}),this.map.on("click",({lngLat:y})=>{this.isEditMode||this.updateMarkerAndForm(y)}),this.map.on("error",y=>{console.error("Error en Mapbox (report form):",y),this.notificationService.error("Error al cargar el mapa.")})}catch(y){console.error("Error inicializando Mapbox (report form):",y)}}updateMarkerAndForm(t){this.reportForm.patchValue({latitude:t.lat,longitude:t.lng}),this.marker?this.marker.setLngLat(t):(this.marker=new Gd.default.Marker({draggable:!this.isEditMode}).setLngLat(t).addTo(this.map),this.isEditMode||this.marker.on("dragend",()=>{let e=this.marker.getLngLat();this.reportForm.patchValue({latitude:e.lat,longitude:e.lng})}))}onFileSelected(t){let e=t.currentTarget,n=e.files;if(this.imagePreview=null,n&&n.length>0){let s=n[0];this.file=n[0],s.type.startsWith("image/")||this.notificationService.error(`El archivo '${s.name}' no es una imagen v\xE1lida.`);let r=new FileReader;r.onload=y=>{this.imagePreview=y.target.result,this.cdRef.detectChanges()},r.readAsDataURL(s)}e.value=""}removePreview(t){this.imagePreview=null}onSubmit(){if(this.reportForm.invalid){this.reportForm.markAllAsTouched(),this.snackBar.open("Por favor, completa todos los campos requeridos.","Cerrar",{duration:3e3});return}if(!this.isEditMode&&!this.file){this.snackBar.open("Debes subir al menos una imagen para el reporte.","Cerrar",{duration:3e3});return}this.isLoading=!0;let t=this.reportForm.value,e={title:t.title,description:t.description,latitude:t.latitude,longitude:t.longitude,categoryList:this.categories.filter(n=>t.categoryIds.includes(n.id))};this.isEditMode&&this.reportId?(console.log(this.file),this.reportService.updateReport(this.reportId,e,this.file).subscribe({next:()=>{this.isLoading=!1,this.notificationService.success("Reporte actualizado con \xE9xito."),this.router.navigate(["/map"])},error:n=>{this.isLoading=!1,this.notificationService.error("Error al actualizar el reporte.")}})):this.file&&this.reportService.createReport(e,this.file).subscribe({next:n=>{this.isLoading=!1,this.notificationService.success("Reporte creado con \xE9xito. Pendiente de verificaci\xF3n."),this.router.navigate(["/map"])},error:n=>{this.isLoading=!1,this.notificationService.error(n.message||"Error al crear el reporte.")}})}getCategoryName(t){return this.categories.find(e=>e.id===t)?.name||"Desconocido"}toggleCategory(t){let e=this.reportForm.get("categoryIds"),n=e?.value||[],s=n.indexOf(t);s>-1?n.splice(s,1):n.push(t),e?.setValue([...n])}isSelected(t){return this.reportForm.get("categoryIds")?.value?.includes(t)}get title(){return this.reportForm.get("title")}get description(){return this.reportForm.get("description")}get categoryIds(){return this.reportForm.get("categoryIds")}get latitude(){return this.reportForm.get("latitude")}get longitude(){return this.reportForm.get("longitude")}get selectedFile(){return this.reportForm.get("selectedFile")}loadImages(t){t&&this.reportService.getAllImagesReportById(t).subscribe({next:e=>{this.imagePreview=e[0].imageUrl,console.log("Imagenes cargadas",this.imagePreview)},error:e=>{this.snackBar.open("Error al cargar las im\xE1genes del reporte.","Cerrar",{duration:3e3})}})}goBack(){this.router.navigate(["/map"])}static \u0275fac=function(e){return new(e||i)(ai(ca),ai(rl),ai(ic),ai(Cy),ai(fn),ai(nl),ai($n))};static \u0275cmp=Yt({type:i,selectors:[["app-report"]],decls:43,vars:13,consts:[["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],[1,"report-container"],["novalidate","",3,"ngSubmit","formGroup"],[1,"field-group"],["for","title"],[1,"fa","fa-heading","icon"],["type","text","id","title","formControlName","title","placeholder","Ej: Perro perdido cerca del parque"],["class","error-message",4,"ngIf"],["for","description"],[1,"fa","fa-align-left","icon"],["id","description","formControlName","description","rows","4","placeholder","Describe detalladamente lo que sucede..."],[1,"fa","fa-tags","icon"],[1,"category-chip-container"],["type","button",3,"selected","click",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"fa","fa-map-marker-alt","icon"],["id","map_user",2,"width","100%","height","300px","border","1px solid #ccc","border-radius","6px"],["for","selectedFile"],[1,"fa","fa-image","icon"],["type","file","id","selectedFile","formControlName","selectedFile","accept","image/*",3,"change"],["class","image-previews",4,"ngIf"],["type","submit",1,"submit-button",3,"disabled"],[1,"error-message"],["type","button",3,"click"],[4,"ngFor","ngForOf"],[1,"image-previews"],[1,"preview-item"],["alt","Previsualizaci\xF3n",3,"src"],["type","button","title","Quitar imagen",1,"remove-preview-btn",3,"click"]],template:function(e,n){e&1&&(oe(0,"button",0),_t("click",function(){return n.goBack()}),oe(1,"mat-icon"),Ee(2,"arrow_back"),ae()(),oe(3,"div",1)(4,"h2"),Ee(5),ae(),oe(6,"form",2),_t("ngSubmit",function(){return n.onSubmit()}),oe(7,"div",3)(8,"label",4),Et(9,"i",5),Ee(10," T\xEDtulo "),ae(),Et(11,"input",6),pt(12,$ie,4,3,"div",7),ae(),oe(13,"div",3)(14,"label",8),Et(15,"i",9),Ee(16," Descripci\xF3n "),ae(),Et(17,"textarea",10),pt(18,Wie,3,2,"div",7),ae(),oe(19,"div",3)(20,"label"),Et(21,"i",11),Ee(22," Categor\xEDas "),ae(),oe(23,"div",12),pt(24,Yie,2,3,"button",13),ae(),pt(25,Xie,2,1,"div",7)(26,Qie,5,1,"div",14),ae(),oe(27,"div",3)(28,"label"),Et(29,"i",15),Ee(30," Ubicaci\xF3n "),ae(),Et(31,"div",16),pt(32,Jie,2,0,"div",7),ae(),oe(33,"div",3)(34,"label",17),Et(35,"i",18),Ee(36," Im\xE1genes (al menos 1) "),ae(),oe(37,"input",19),_t("change",function(r){return n.onFileSelected(r)}),ae(),pt(38,ene,5,1,"div",20)(39,tne,2,0,"div",7),ae(),oe(40,"button",21),pt(41,ine,2,1,"span",14)(42,nne,2,1,"span",14),ae()()()),e&2&&(ge(5),tn(n.isEditMode?"Editar Reporte":"Crear Nuevo Reporte"),ge(),Be("formGroup",n.reportForm),ge(6),Be("ngIf",(n.title==null?null:n.title.invalid)&&((n.title==null?null:n.title.dirty)||(n.title==null?null:n.title.touched))),ge(6),Be("ngIf",(n.description==null?null:n.description.invalid)&&((n.description==null?null:n.description.dirty)||(n.description==null?null:n.description.touched))),ge(6),Be("ngForOf",n.categories),ge(),Be("ngIf",(n.categoryIds==null?null:n.categoryIds.invalid)&&((n.categoryIds==null?null:n.categoryIds.touched)||(n.categoryIds==null?null:n.categoryIds.dirty))),ge(),Be("ngIf",n.categoryIds==null||n.categoryIds.value==null?null:n.categoryIds.value.length),ge(6),Be("ngIf",((n.latitude==null?null:n.latitude.invalid)||(n.longitude==null?null:n.longitude.invalid))&&((n.latitude==null?null:n.latitude.touched)||(n.longitude==null?null:n.longitude.touched))),ge(6),Be("ngIf",n.imagePreview),ge(),Be("ngIf",!n.isEditMode&&!n.selectedFile&&n.reportForm.touched),ge(),Be("disabled",n.reportForm.invalid||n.isLoading||!n.isEditMode&&!n.selectedFile),ge(),Be("ngIf",!n.isLoading),ge(),Be("ngIf",n.isLoading))},dependencies:[sr,cs,Zn,da,la,io,xo,sa,Yr,Xo,Dl,ua,no],styles:["body[_ngcontent-%COMP%]{font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;background-color:#f4f6f8;margin:0;padding:0}.report-container[_ngcontent-%COMP%]{max-width:700px;margin:50px auto;padding:30px 40px;border:1px solid #ccc;border-radius:8px;background-color:#fff;box-shadow:0 4px 12px #0000000d}.report-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;font-size:28px;color:#333;margin-bottom:40px}.field-group[_ngcontent-%COMP%]{margin-bottom:40px}.field-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:12px;font-weight:700;color:#555}.field-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .field-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .field-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{display:block;width:100%;padding:14px 16px;border:1px solid #ccc;border-radius:4px;box-sizing:border-box;font-size:15px;background-color:#fff;transition:border-color .2s ease}.field-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .field-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, .field-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:#79b4d8;outline:none}.field-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:vertical;min-height:120px}.field-group[_ngcontent-%COMP%]   select[multiple][_ngcontent-%COMP%]{min-height:120px}.error-message[_ngcontent-%COMP%]{color:#e74c3c;font-size:.9em;margin-top:8px}.category-chip-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:10px}.category-chip-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#ecf0f1;border:1px solid #bdc3c7;color:#2c3e50;padding:8px 14px;border-radius:20px;cursor:pointer;transition:background .2s ease,border-color .2s ease}.category-chip-container[_ngcontent-%COMP%]   button.selected[_ngcontent-%COMP%]{background-color:#79b4d8;color:#fff;border-color:#1e3a5f}.image-previews[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:12px;margin-top:12px}.preview-item[_ngcontent-%COMP%]{position:relative;border-radius:4px;overflow:visible;box-shadow:0 2px 6px #0000001a}.remove-preview-btn[_ngcontent-%COMP%]{position:absolute;top:-8px;right:-8px;background:#e74c3c;color:#fff;border:none;border-radius:50%;width:24px;height:24px;font-size:14px;line-height:24px;text-align:center;cursor:pointer;z-index:1}.remove-preview-btn[_ngcontent-%COMP%]:hover{background:#c0392b}.preview-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100px;max-height:100px;object-fit:cover}#map_user[_ngcontent-%COMP%], #map_report[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:4px;height:300px;margin-top:12px}.submit-button[_ngcontent-%COMP%]{display:block;width:100%;padding:14px;background-color:#f9f9f9;color:#333;border:1px solid #ccc;border-radius:4px;font-size:16px;cursor:pointer;transition:background-color .2s ease;margin-top:30px}.submit-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#e0e0e0}.submit-button[_ngcontent-%COMP%]:disabled{background-color:#ddd;cursor:not-allowed}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;width:40px;height:40px;padding:0;background-color:#fff;border:1px solid #ccc;border-radius:8px;box-shadow:0 4px 12px #0000000d;display:flex;align-items:center;justify-content:center;transition:background-color .2s ease,transform .1s ease}.back-button[_ngcontent-%COMP%]:hover{background-color:#f9f9f9;transform:translate(-2px)}.back-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;color:#0009}"]})};var rne=["digitInput"];function one(i,t){i&1&&(oe(0,"div",23),Ee(1," La contrase\xF1a debe tener al menos una may\xFAscula, una min\xFAscula y un d\xEDgito. "),ae())}function ane(i,t){i&1&&Et(0,"i",24)}function sne(i,t){i&1&&Et(0,"i",25)}function lne(i,t){if(i&1&&(oe(0,"span"),Ee(1),ae()),i&2){let e=bt();ge(),zi("Reenviar en ",e.formattedTime,"")}}function cne(i,t){i&1&&(oe(0,"span"),Ee(1,"Reenviar C\xF3digo"),ae())}var PD=class i{fb=Z(ca);router=Z(fn);notificationService=Z(Pr);authService=Z(eo);digitInputs;verificationForm=this.fb.group({digit0:new Wr(null,[si.required,si.pattern(/^\d$/)]),digit1:new Wr(null,[si.required,si.pattern(/^\d$/)]),digit2:new Wr(null,[si.required,si.pattern(/^\d$/)]),digit3:new Wr(null,[si.required,si.pattern(/^\d$/)]),digit4:new Wr(null,[si.required,si.pattern(/^\d$/)]),digit5:new Wr(null,[si.required,si.pattern(/^\d$/)]),password:new Wr(null,[si.required,si.pattern(/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/)])});isSubmitting=!1;isResend=!1;resendDisabled=!1;secondsLeft=0;countdownSub;ngOnInit(){}ngOnDestroy(){this.countdownSub?.unsubscribe()}submitCode(){if(this.verificationForm.invalid){this.notificationService.error("Por favor completa todos los campos del c\xF3digo y la contrase\xF1a."),this.verificationForm.markAllAsTouched();return}if(this.isSubmitting)return;this.isSubmitting=!0;let t=[this.verificationForm.value.digit0,this.verificationForm.value.digit1,this.verificationForm.value.digit2,this.verificationForm.value.digit3,this.verificationForm.value.digit4,this.verificationForm.value.digit5].join(""),e=this.verificationForm.value.password;this.authService.resetPasswordWithCode({code:t,newPassword:e}).subscribe({next:()=>{this.notificationService.success("\u2705 Contrase\xF1a restablecida exitosamente"),this.router.navigate(["/login"])},error:n=>{console.error("Error completo al restablecer contrase\xF1a:",n);let s=n.status,r="Ocurri\xF3 un error al restablecer la contrase\xF1a.";if(s===400){let y;try{y=typeof n.error=="string"?JSON.parse(n.error):n.error}catch{y={message:n.error}}let A=y.message?.toLowerCase()??"";A.includes("no es v\xE1lido para recuperar contrase\xF1a")?r="El c\xF3digo no es v\xE1lido para recuperar contrase\xF1a.":A.includes("c\xF3digo inv\xE1lido")?r="El c\xF3digo es inv\xE1lido.":A.includes("ha expirado")?r="El c\xF3digo ha expirado.":r=y.message||"Solicitud incorrecta."}else s===404?r="Usuario no encontrado.":s===500&&(r="Error interno del servidor.");this.notificationService.error(r),this.isSubmitting=!1}})}resendCode(){if(this.resendDisabled||this.isSubmitting||this.isResend)return;this.isResend=!0;let t=sessionStorage.getItem("email");if(!t){this.notificationService.error("No se encontr\xF3 el email del usuario.");return}this.authService.resendResetPasswordCode(t).subscribe({next:()=>{this.startCountdown(),this.notificationService.success("\xA1C\xF3digo reenviado exitosamente!"),this.isResend=!1},error:e=>{let n=e.status,s="Ocurri\xF3 un error al reenviar el c\xF3digo.";n===404?s="Usuario no encontrado.":n===500&&(s="Error interno del servidor."),this.notificationService.error(s),this.isResend=!1}})}startCountdown(){this.countdownSub?.unsubscribe(),this.resendDisabled=!0,this.secondsLeft=120,this.countdownSub=Y0(1e3).pipe(Xf(()=>this.secondsLeft>0)).subscribe(()=>{this.secondsLeft--,this.secondsLeft===0&&(this.resendDisabled=!1)})}get formattedTime(){let t=Math.floor(this.secondsLeft/60).toString().padStart(2,"0"),e=(this.secondsLeft%60).toString().padStart(2,"0");return`${t}:${e}`}onCodeInput(t,e){let s=t.target.value.replace(/\D/g,"").slice(0,1),r=`digit${e}`;this.verificationForm.controls[r].setValue(s,{emitEvent:!1}),s&&e<this.digitInputs.length-1&&this.digitInputs.toArray()[e+1].nativeElement.focus()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Yt({type:i,selectors:[["app-verification"]],viewQuery:function(e,n){if(e&1&&Bn(rne,5),e&2){let s;Bi(s=Vi())&&(n.digitInputs=s)}},decls:33,vars:9,consts:[["digitInput",""],[1,"verification-container"],[1,"logo"],[1,"fas","fa-shield-alt"],[1,"subtitle"],[3,"ngSubmit","formGroup"],[1,"code-inputs"],["type","text","maxlength","1","formControlName","digit0","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit1","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit2","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit3","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit4","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit5","placeholder","-",1,"digit-input",3,"input"],[1,"password-group"],["type","password","formControlName","password","placeholder","Nueva contrase\xF1a",1,"password-input"],["class","error-message",4,"ngIf"],["type","submit",1,"submit-button",3,"disabled"],["class","fas fa-check-circle",4,"ngIf"],["class","fas fa-spinner fa-spin me-2",4,"ngIf"],[1,"resend-container"],["type","button",1,"resend-button",3,"click","disabled"],[1,"fas","fa-clock"],[4,"ngIf"],[1,"error-message"],[1,"fas","fa-check-circle"],[1,"fas","fa-spinner","fa-spin","me-2"]],template:function(e,n){if(e&1){let s=bi();oe(0,"div",1)(1,"div",2),Et(2,"i",3),ae(),oe(3,"h2"),Ee(4,"Confirmaci\xF3n de restablecer contrase\xF1a"),ae(),oe(5,"p",4),Ee(6,"Ingresa el c\xF3digo de 6 d\xEDgitos y tu nueva contrase\xF1a"),ae(),oe(7,"form",5),_t("ngSubmit",function(){return qt(s),Wt(n.submitCode())}),oe(8,"div",6)(9,"input",7,0),_t("input",function(y){return qt(s),Wt(n.onCodeInput(y,0))}),ae(),oe(11,"input",8,0),_t("input",function(y){return qt(s),Wt(n.onCodeInput(y,1))}),ae(),oe(13,"input",9,0),_t("input",function(y){return qt(s),Wt(n.onCodeInput(y,2))}),ae(),oe(15,"input",10,0),_t("input",function(y){return qt(s),Wt(n.onCodeInput(y,3))}),ae(),oe(17,"input",11,0),_t("input",function(y){return qt(s),Wt(n.onCodeInput(y,4))}),ae(),oe(19,"input",12,0),_t("input",function(y){return qt(s),Wt(n.onCodeInput(y,5))}),ae()(),oe(21,"div",13),Et(22,"input",14),pt(23,one,2,0,"div",15),ae(),oe(24,"button",16),pt(25,ane,1,0,"i",17)(26,sne,1,0,"i",18),Ee(27),ae()(),oe(28,"div",19)(29,"button",20),_t("click",function(){return qt(s),Wt(n.resendCode())}),Et(30,"i",21),pt(31,lne,2,1,"span",22)(32,cne,2,0,"span",22),ae()()()}if(e&2){let s;ge(7),Be("formGroup",n.verificationForm),ge(16),Be("ngIf",((s=n.verificationForm.get("password"))==null?null:s.invalid)&&((s=n.verificationForm.get("password"))==null?null:s.touched)),ge(),Be("disabled",n.verificationForm.invalid||n.isSubmitting),ge(),Be("ngIf",!n.isSubmitting),ge(),Be("ngIf",n.isSubmitting),ge(),zi(" ",n.isSubmitting?"Restableciendo...":"Confirmar y Cambiar"," "),ge(2),Be("disabled",n.resendDisabled||n.isSubmitting||n.isResend),ge(2),Be("ngIf",n.resendDisabled),ge(),Be("ngIf",!n.resendDisabled)}},dependencies:[sr,Zn,da,la,io,xo,sa,Ix,Yr,Xo],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c}.verification-container[_ngcontent-%COMP%]{width:380px;background:var(--input-bg);margin:80px auto;padding:30px 25px;border-radius:12px;text-align:center;box-shadow:0 4px 15px #0000001a}.logo[_ngcontent-%COMP%]{font-size:3rem;color:var(--primary-accent);margin-bottom:15px}h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:8px;color:var(--primary-dark)}.subtitle[_ngcontent-%COMP%]{font-size:14px;margin-bottom:25px;color:var(--primary-accent)}.code-inputs[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:10px}.digit-input[_ngcontent-%COMP%]{width:40px;height:50px;font-size:1.5rem;text-align:center;border:2px dashed var(--primary-dark);border-radius:6px;background:var(--input-bg);background-image:linear-gradient(to bottom right,var(--primary-accent) 2px,transparent 2px);background-size:100% 100%;transition:background .2s ease,border-color .2s ease;box-sizing:border-box}.digit-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-accent)}.digit-input.ng-valid[_ngcontent-%COMP%]{background-image:none}.submit-button[_ngcontent-%COMP%]{width:100%;padding:12px;margin-top:8px;background:var(--primary-accent);color:var(--primary-dark);border:none;border-radius:6px;cursor:pointer;font-size:16px;font-weight:600;transition:background .3s ease,transform .2s ease;box-shadow:0 2px 8px #00000026}.submit-button[_ngcontent-%COMP%]:disabled{background:#aaa;cursor:not-allowed;color:#ccc}.submit-button[_ngcontent-%COMP%]:not(:disabled):hover{background:var(--primary-dark);transform:translateY(-2px);color:var(--input-bg)}.resend-container[_ngcontent-%COMP%]{margin-top:20px}.resend-button[_ngcontent-%COMP%]{padding:10px 16px;background:var(--primary-bg);color:var(--primary-dark);border:2px solid var(--primary-accent);border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;transition:background .3s ease,transform .2s ease;display:inline-flex;align-items:center;gap:8px}.resend-button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.resend-button[_ngcontent-%COMP%]:not(:disabled):hover{background:var(--primary-accent);color:var(--input-bg);transform:translateY(-1px)}.password-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.password-input[_ngcontent-%COMP%]{padding:10px;font-size:16px;margin-bottom:10px;border:2px solid #ccc;border-radius:6px;background:var(--input-bg);transition:border-color .2s ease}.password-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-accent)}.error-message[_ngcontent-%COMP%]{color:var(--error-color);font-size:13px;text-align:left;margin-top:-10px}"]})};var OD=class i{constructor(t){this.router=t}goHome(){this.router.navigate(["/map"])}static \u0275fac=function(e){return new(e||i)(ai(fn))};static \u0275cmp=Yt({type:i,selectors:[["app-not-found"]],decls:10,vars:0,consts:[[1,"not-found-container"],[1,"icon-wrapper"],[1,"fas","fa-exclamation-triangle"],[1,"submit-button",3,"click"],[1,"fas","fa-home"]],template:function(e,n){e&1&&(oe(0,"div",0)(1,"div",1),Et(2,"i",2),ae(),oe(3,"h1"),Ee(4,"P\xE1gina no encontrada"),ae(),oe(5,"p"),Ee(6,"Lo sentimos, la ruta que est\xE1s buscando no existe."),ae(),oe(7,"button",3),_t("click",function(){return n.goHome()}),Et(8,"i",4),Ee(9," Ir al inicio "),ae()())},dependencies:[Dl],styles:["[_nghost-%COMP%]{display:block}.not-found-container[_ngcontent-%COMP%]{max-width:400px;margin:100px auto;padding:40px;text-align:center;background-color:var(--input-bg);border-radius:12px;box-shadow:0 4px 20px #0000001a}.icon-wrapper[_ngcontent-%COMP%]{font-size:60px;color:var(--primary-accent);margin-bottom:20px}.not-found-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:26px;color:var(--primary-dark);margin-bottom:10px}.not-found-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#555;margin-bottom:30px;font-size:16px}.submit-button[_ngcontent-%COMP%]{width:100%;padding:12px;background:var(--primary-accent);color:#000;border:none;border-radius:6px;cursor:pointer;font-size:16px;font-weight:600;transition:background .3s ease,transform .2s ease;box-shadow:0 2px 8px #00000026}.submit-button[_ngcontent-%COMP%]:hover{background:var(--primary-dark);transform:translateY(-2px)}.submit-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:8px}"]})};var Lm=class{applyChanges(t,e,n,s,r){t.forEachOperation((y,A,P)=>{let B,U;if(y.previousIndex==null){let J=n(y,A,P);B=e.createEmbeddedView(J.templateRef,J.context,J.index),U=bp.INSERTED}else P==null?(e.remove(A),U=bp.REMOVED):(B=e.get(A),e.move(B,P),U=bp.MOVED);r&&r({context:B?.context,operation:U,record:y})})}detach(){}};var dne=[[["caption"]],[["colgroup"],["col"]],"*"],une=["caption","colgroup, col","*"];function hne(i,t){i&1&&an(0,2)}function pne(i,t){i&1&&(oe(0,"thead",0),Ta(1,1),ae(),oe(2,"tbody",0),Ta(3,2)(4,3),ae(),oe(5,"tfoot",0),Ta(6,4),ae())}function fne(i,t){i&1&&Ta(0,1)(1,2)(2,3)(3,4)}var Qc=new Dt("CDK_TABLE");var VD=(()=>{class i{template=Z(co);constructor(){}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","cdkCellDef",""]]})}return i})(),jD=(()=>{class i{template=Z(co);constructor(){}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","cdkHeaderCellDef",""]]})}return i})(),x6=(()=>{class i{template=Z(co);constructor(){}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","cdkFooterCellDef",""]]})}return i})(),Sy=(()=>{class i{_table=Z(Qc,{optional:!0});_hasStickyChanged=!1;get name(){return this._name}set name(e){this._setNameInput(e)}_name;get sticky(){return this._sticky}set sticky(e){e!==this._sticky&&(this._sticky=e,this._hasStickyChanged=!0)}_sticky=!1;get stickyEnd(){return this._stickyEnd}set stickyEnd(e){e!==this._stickyEnd&&(this._stickyEnd=e,this._hasStickyChanged=!0)}_stickyEnd=!1;cell;headerCell;footerCell;cssClassFriendlyName;_columnCssClassName;constructor(){}hasStickyChanged(){let e=this._hasStickyChanged;return this.resetStickyChanged(),e}resetStickyChanged(){this._hasStickyChanged=!1}_updateColumnCssClassName(){this._columnCssClassName=[`cdk-column-${this.cssClassFriendlyName}`]}_setNameInput(e){e&&(this._name=e,this.cssClassFriendlyName=e.replace(/[^a-z0-9_-]/gi,"-"),this._updateColumnCssClassName())}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","cdkColumnDef",""]],contentQueries:function(n,s,r){if(n&1&&(Mr(r,VD,5),Mr(r,jD,5),Mr(r,x6,5)),n&2){let y;Bi(y=Vi())&&(s.cell=y.first),Bi(y=Vi())&&(s.headerCell=y.first),Bi(y=Vi())&&(s.footerCell=y.first)}},inputs:{name:[0,"cdkColumnDef","name"],sticky:[2,"sticky","sticky",xi],stickyEnd:[2,"stickyEnd","stickyEnd",xi]},features:[Vn([{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:i}])]})}return i})(),LD=class{constructor(t,e){e.nativeElement.classList.add(...t._columnCssClassName)}},w6=(()=>{class i extends LD{constructor(){super(Z(Sy),Z(Ii))}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["cdk-header-cell"],["th","cdk-header-cell",""]],hostAttrs:["role","columnheader",1,"cdk-header-cell"],features:[dn]})}return i})();var C6=(()=>{class i extends LD{constructor(){let e=Z(Sy),n=Z(Ii);super(e,n);let s=e._table?._getCellRole();s&&n.nativeElement.setAttribute("role",s)}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["cdk-cell"],["td","cdk-cell",""]],hostAttrs:[1,"cdk-cell"],features:[dn]})}return i})(),ND=class{tasks=[];endTasks=[]},zD=new Dt("_COALESCED_STYLE_SCHEDULER"),gP=(()=>{class i{_currentSchedule=null;_ngZone=Z(ki);constructor(){}schedule(e){this._createScheduleIfNeeded(),this._currentSchedule.tasks.push(e)}scheduleEnd(e){this._createScheduleIfNeeded(),this._currentSchedule.endTasks.push(e)}_createScheduleIfNeeded(){this._currentSchedule||(this._currentSchedule=new ND,this._ngZone.runOutsideAngular(()=>queueMicrotask(()=>{for(;this._currentSchedule.tasks.length||this._currentSchedule.endTasks.length;){let e=this._currentSchedule;this._currentSchedule=new ND;for(let n of e.tasks)n();for(let n of e.endTasks)n()}this._currentSchedule=null})))}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac})}return i})();var _P=(()=>{class i{template=Z(co);_differs=Z(Od);columns;_columnsDiffer;constructor(){}ngOnChanges(e){if(!this._columnsDiffer){let n=e.columns&&e.columns.currentValue||[];this._columnsDiffer=this._differs.find(n).create(),this._columnsDiffer.diff(n)}}getColumnsDiff(){return this._columnsDiffer.diff(this.columns)}extractCellTemplate(e){return this instanceof Nx?e.headerCell.template:this instanceof yP?e.footerCell.template:e.cell.template}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,features:[fr]})}return i})(),Nx=(()=>{class i extends _P{_table=Z(Qc,{optional:!0});_hasStickyChanged=!1;get sticky(){return this._sticky}set sticky(e){e!==this._sticky&&(this._sticky=e,this._hasStickyChanged=!0)}_sticky=!1;constructor(){super(Z(co),Z(Od))}ngOnChanges(e){super.ngOnChanges(e)}hasStickyChanged(){let e=this._hasStickyChanged;return this.resetStickyChanged(),e}resetStickyChanged(){this._hasStickyChanged=!1}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","cdkHeaderRowDef",""]],inputs:{columns:[0,"cdkHeaderRowDef","columns"],sticky:[2,"cdkHeaderRowDefSticky","sticky",xi]},features:[dn,fr]})}return i})(),yP=(()=>{class i extends _P{_table=Z(Qc,{optional:!0});_hasStickyChanged=!1;get sticky(){return this._sticky}set sticky(e){e!==this._sticky&&(this._sticky=e,this._hasStickyChanged=!0)}_sticky=!1;constructor(){super(Z(co),Z(Od))}ngOnChanges(e){super.ngOnChanges(e)}hasStickyChanged(){let e=this._hasStickyChanged;return this.resetStickyChanged(),e}resetStickyChanged(){this._hasStickyChanged=!1}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","cdkFooterRowDef",""]],inputs:{columns:[0,"cdkFooterRowDef","columns"],sticky:[2,"cdkFooterRowDefSticky","sticky",xi]},features:[dn,fr]})}return i})(),UD=(()=>{class i extends _P{_table=Z(Qc,{optional:!0});when;constructor(){super(Z(co),Z(Od))}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","cdkRowDef",""]],inputs:{columns:[0,"cdkRowDefColumns","columns"],when:[0,"cdkRowDefWhen","when"]},features:[dn]})}return i})(),Nm=(()=>{class i{_viewContainer=Z(yo);cells;context;static mostRecentCellOutlet=null;constructor(){i.mostRecentCellOutlet=this}ngOnDestroy(){i.mostRecentCellOutlet===this&&(i.mostRecentCellOutlet=null)}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","cdkCellOutlet",""]]})}return i})(),vP=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["cdk-header-row"],["tr","cdk-header-row",""]],hostAttrs:["role","row",1,"cdk-header-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(n,s){n&1&&Ta(0,0)},dependencies:[Nm],encapsulation:2})}return i})();var bP=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["cdk-row"],["tr","cdk-row",""]],hostAttrs:["role","row",1,"cdk-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(n,s){n&1&&Ta(0,0)},dependencies:[Nm],encapsulation:2})}return i})(),E6=(()=>{class i{templateRef=Z(co);_contentClassName="cdk-no-data-row";constructor(){}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["ng-template","cdkNoDataRow",""]]})}return i})(),y6=["top","bottom","left","right"],mP=class{_isNativeHtmlTable;_stickCellCss;direction;_coalescedStyleScheduler;_isBrowser;_needsPositionStickyOnElement;_positionListener;_tableInjector;_elemSizeCache=new WeakMap;_resizeObserver=globalThis?.ResizeObserver?new globalThis.ResizeObserver(t=>this._updateCachedSizes(t)):null;_updatedStickyColumnsParamsToReplay=[];_stickyColumnsReplayTimeout=null;_cachedCellWidths=[];_borderCellCss;_destroyed=!1;constructor(t,e,n,s,r=!0,y=!0,A,P){this._isNativeHtmlTable=t,this._stickCellCss=e,this.direction=n,this._coalescedStyleScheduler=s,this._isBrowser=r,this._needsPositionStickyOnElement=y,this._positionListener=A,this._tableInjector=P,this._borderCellCss={top:`${e}-border-elem-top`,bottom:`${e}-border-elem-bottom`,left:`${e}-border-elem-left`,right:`${e}-border-elem-right`}}clearStickyPositioning(t,e){(e.includes("left")||e.includes("right"))&&this._removeFromStickyColumnReplayQueue(t);let n=[];for(let s of t)s.nodeType===s.ELEMENT_NODE&&n.push(s,...Array.from(s.children));this._afterNextRender({write:()=>{for(let s of n)this._removeStickyStyle(s,e)}})}updateStickyColumns(t,e,n,s=!0,r=!0){if(!t.length||!this._isBrowser||!(e.some(we=>we)||n.some(we=>we))){this._positionListener?.stickyColumnsUpdated({sizes:[]}),this._positionListener?.stickyEndColumnsUpdated({sizes:[]});return}let y=t[0],A=y.children.length,P=this.direction==="rtl",B=P?"right":"left",U=P?"left":"right",J=e.lastIndexOf(!0),le=n.indexOf(!0),re,X,ee;r&&this._updateStickyColumnReplayQueue({rows:[...t],stickyStartStates:[...e],stickyEndStates:[...n]}),this._afterNextRender({earlyRead:()=>{re=this._getCellWidths(y,s),X=this._getStickyStartColumnPositions(re,e),ee=this._getStickyEndColumnPositions(re,n)},write:()=>{for(let we of t)for(let Re=0;Re<A;Re++){let Ce=we.children[Re];e[Re]&&this._addStickyStyle(Ce,B,X[Re],Re===J),n[Re]&&this._addStickyStyle(Ce,U,ee[Re],Re===le)}this._positionListener&&re.some(we=>!!we)&&(this._positionListener.stickyColumnsUpdated({sizes:J===-1?[]:re.slice(0,J+1).map((we,Re)=>e[Re]?we:null)}),this._positionListener.stickyEndColumnsUpdated({sizes:le===-1?[]:re.slice(le).map((we,Re)=>n[Re+le]?we:null).reverse()}))}})}stickRows(t,e,n){if(!this._isBrowser)return;let s=n==="bottom"?t.slice().reverse():t,r=n==="bottom"?e.slice().reverse():e,y=[],A=[],P=[];this._afterNextRender({earlyRead:()=>{for(let B=0,U=0;B<s.length;B++){if(!r[B])continue;y[B]=U;let J=s[B];P[B]=this._isNativeHtmlTable?Array.from(J.children):[J];let le=this._retrieveElementSize(J).height;U+=le,A[B]=le}},write:()=>{let B=r.lastIndexOf(!0);for(let U=0;U<s.length;U++){if(!r[U])continue;let J=y[U],le=U===B;for(let re of P[U])this._addStickyStyle(re,n,J,le)}n==="top"?this._positionListener?.stickyHeaderRowsUpdated({sizes:A,offsets:y,elements:P}):this._positionListener?.stickyFooterRowsUpdated({sizes:A,offsets:y,elements:P})}})}updateStickyFooterContainer(t,e){this._isNativeHtmlTable&&this._afterNextRender({write:()=>{let n=t.querySelector("tfoot");n&&(e.some(s=>!s)?this._removeStickyStyle(n,["bottom"]):this._addStickyStyle(n,"bottom",0,!1))}})}destroy(){this._stickyColumnsReplayTimeout&&clearTimeout(this._stickyColumnsReplayTimeout),this._resizeObserver?.disconnect(),this._destroyed=!0}_removeStickyStyle(t,e){if(!t.classList.contains(this._stickCellCss))return;for(let s of e)t.style[s]="",t.classList.remove(this._borderCellCss[s]);y6.some(s=>e.indexOf(s)===-1&&t.style[s])?t.style.zIndex=this._getCalculatedZIndex(t):(t.style.zIndex="",this._needsPositionStickyOnElement&&(t.style.position=""),t.classList.remove(this._stickCellCss))}_addStickyStyle(t,e,n,s){t.classList.add(this._stickCellCss),s&&t.classList.add(this._borderCellCss[e]),t.style[e]=`${n}px`,t.style.zIndex=this._getCalculatedZIndex(t),this._needsPositionStickyOnElement&&(t.style.cssText+="position: -webkit-sticky; position: sticky; ")}_getCalculatedZIndex(t){let e={top:100,bottom:10,left:1,right:1},n=0;for(let s of y6)t.style[s]&&(n+=e[s]);return n?`${n}`:""}_getCellWidths(t,e=!0){if(!e&&this._cachedCellWidths.length)return this._cachedCellWidths;let n=[],s=t.children;for(let r=0;r<s.length;r++){let y=s[r];n.push(this._retrieveElementSize(y).width)}return this._cachedCellWidths=n,n}_getStickyStartColumnPositions(t,e){let n=[],s=0;for(let r=0;r<t.length;r++)e[r]&&(n[r]=s,s+=t[r]);return n}_getStickyEndColumnPositions(t,e){let n=[],s=0;for(let r=t.length;r>0;r--)e[r]&&(n[r]=s,s+=t[r]);return n}_retrieveElementSize(t){let e=this._elemSizeCache.get(t);if(e)return e;let n=t.getBoundingClientRect(),s={width:n.width,height:n.height};return this._resizeObserver&&(this._elemSizeCache.set(t,s),this._resizeObserver.observe(t,{box:"border-box"})),s}_updateStickyColumnReplayQueue(t){this._removeFromStickyColumnReplayQueue(t.rows),this._stickyColumnsReplayTimeout||this._updatedStickyColumnsParamsToReplay.push(t)}_removeFromStickyColumnReplayQueue(t){let e=new Set(t);for(let n of this._updatedStickyColumnsParamsToReplay)n.rows=n.rows.filter(s=>!e.has(s));this._updatedStickyColumnsParamsToReplay=this._updatedStickyColumnsParamsToReplay.filter(n=>!!n.rows.length)}_updateCachedSizes(t){let e=!1;for(let n of t){let s=n.borderBoxSize?.length?{width:n.borderBoxSize[0].inlineSize,height:n.borderBoxSize[0].blockSize}:{width:n.contentRect.width,height:n.contentRect.height};s.width!==this._elemSizeCache.get(n.target)?.width&&mne(n.target)&&(e=!0),this._elemSizeCache.set(n.target,s)}e&&this._updatedStickyColumnsParamsToReplay.length&&(this._stickyColumnsReplayTimeout&&clearTimeout(this._stickyColumnsReplayTimeout),this._stickyColumnsReplayTimeout=setTimeout(()=>{if(!this._destroyed){for(let n of this._updatedStickyColumnsParamsToReplay)this.updateStickyColumns(n.rows,n.stickyStartStates,n.stickyEndStates,!0,!1);this._updatedStickyColumnsParamsToReplay=[],this._stickyColumnsReplayTimeout=null}},0))}_afterNextRender(t){this._tableInjector?Ma(t,{injector:this._tableInjector}):this._coalescedStyleScheduler.schedule(()=>{t.earlyRead?.(),t.write()})}};function mne(i){return["cdk-cell","cdk-header-cell","cdk-footer-cell"].some(t=>i.classList.contains(t))}var BD=new Dt("CDK_SPL");var xP=(()=>{class i{viewContainer=Z(yo);elementRef=Z(Ii);constructor(){let e=Z(Qc);e._rowOutlet=this,e._outletAssigned()}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","rowOutlet",""]]})}return i})(),wP=(()=>{class i{viewContainer=Z(yo);elementRef=Z(Ii);constructor(){let e=Z(Qc);e._headerRowOutlet=this,e._outletAssigned()}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","headerRowOutlet",""]]})}return i})(),CP=(()=>{class i{viewContainer=Z(yo);elementRef=Z(Ii);constructor(){let e=Z(Qc);e._footerRowOutlet=this,e._outletAssigned()}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","footerRowOutlet",""]]})}return i})(),EP=(()=>{class i{viewContainer=Z(yo);elementRef=Z(Ii);constructor(){let e=Z(Qc);e._noDataRowOutlet=this,e._outletAssigned()}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","noDataRowOutlet",""]]})}return i})();var SP=(()=>{class i{_differs=Z(Od);_changeDetectorRef=Z($n);_elementRef=Z(Ii);_dir=Z(vo,{optional:!0});_platform=Z(or);_viewRepeater=Z(dy);_coalescedStyleScheduler=Z(zD);_viewportRuler=Z(xp);_stickyPositioningListener=Z(BD,{optional:!0,skipSelf:!0});_document=Z(Ki);_data;_onDestroy=new ni;_renderRows;_renderChangeSubscription;_columnDefsByName=new Map;_rowDefs;_headerRowDefs;_footerRowDefs;_dataDiffer;_defaultRowDef;_customColumnDefs=new Set;_customRowDefs=new Set;_customHeaderRowDefs=new Set;_customFooterRowDefs=new Set;_customNoDataRow;_headerRowDefChanged=!0;_footerRowDefChanged=!0;_stickyColumnStylesNeedReset=!0;_forceRecalculateCellWidths=!0;_cachedRenderRowsMap=new Map;_isNativeHtmlTable;_stickyStyler;stickyCssClass="cdk-table-sticky";needsPositionStickyOnElement=!0;_isServer;_isShowingNoDataRow=!1;_hasAllOutlets=!1;_hasInitialized=!1;_getCellRole(){if(this._cellRoleInternal===void 0){let e=this._elementRef.nativeElement.getAttribute("role");return e==="grid"||e==="treegrid"?"gridcell":"cell"}return this._cellRoleInternal}_cellRoleInternal=void 0;get trackBy(){return this._trackByFn}set trackBy(e){this._trackByFn=e}_trackByFn;get dataSource(){return this._dataSource}set dataSource(e){this._dataSource!==e&&this._switchDataSource(e)}_dataSource;get multiTemplateDataRows(){return this._multiTemplateDataRows}set multiTemplateDataRows(e){this._multiTemplateDataRows=e,this._rowOutlet&&this._rowOutlet.viewContainer.length&&(this._forceRenderDataRows(),this.updateStickyColumnStyles())}_multiTemplateDataRows=!1;get fixedLayout(){return this._fixedLayout}set fixedLayout(e){this._fixedLayout=e,this._forceRecalculateCellWidths=!0,this._stickyColumnStylesNeedReset=!0}_fixedLayout=!1;contentChanged=new ui;viewChange=new Cr({start:0,end:Number.MAX_VALUE});_rowOutlet;_headerRowOutlet;_footerRowOutlet;_noDataRowOutlet;_contentColumnDefs;_contentRowDefs;_contentHeaderRowDefs;_contentFooterRowDefs;_noDataRow;_injector=Z(vn);constructor(){Z(new Hl("role"),{optional:!0})||this._elementRef.nativeElement.setAttribute("role","table"),this._isServer=!this._platform.isBrowser,this._isNativeHtmlTable=this._elementRef.nativeElement.nodeName==="TABLE",this._dataDiffer=this._differs.find([]).create((n,s)=>this.trackBy?this.trackBy(s.dataIndex,s.data):s)}ngOnInit(){this._setupStickyStyler(),this._viewportRuler.change().pipe(Un(this._onDestroy)).subscribe(()=>{this._forceRecalculateCellWidths=!0})}ngAfterContentInit(){this._hasInitialized=!0}ngAfterContentChecked(){this._canRender()&&this._render()}ngOnDestroy(){this._stickyStyler?.destroy(),[this._rowOutlet?.viewContainer,this._headerRowOutlet?.viewContainer,this._footerRowOutlet?.viewContainer,this._cachedRenderRowsMap,this._customColumnDefs,this._customRowDefs,this._customHeaderRowDefs,this._customFooterRowDefs,this._columnDefsByName].forEach(e=>{e?.clear()}),this._headerRowDefs=[],this._footerRowDefs=[],this._defaultRowDef=null,this._onDestroy.next(),this._onDestroy.complete(),jS(this.dataSource)&&this.dataSource.disconnect(this)}renderRows(){this._renderRows=this._getAllRenderRows();let e=this._dataDiffer.diff(this._renderRows);if(!e){this._updateNoDataRow(),this.contentChanged.next();return}let n=this._rowOutlet.viewContainer;this._viewRepeater.applyChanges(e,n,(s,r,y)=>this._getEmbeddedViewArgs(s.item,y),s=>s.item.data,s=>{s.operation===bp.INSERTED&&s.context&&this._renderCellTemplateForItem(s.record.item.rowDef,s.context)}),this._updateRowIndexContext(),e.forEachIdentityChange(s=>{let r=n.get(s.currentIndex);r.context.$implicit=s.item.data}),this._updateNoDataRow(),this.contentChanged.next(),this.updateStickyColumnStyles()}addColumnDef(e){this._customColumnDefs.add(e)}removeColumnDef(e){this._customColumnDefs.delete(e)}addRowDef(e){this._customRowDefs.add(e)}removeRowDef(e){this._customRowDefs.delete(e)}addHeaderRowDef(e){this._customHeaderRowDefs.add(e),this._headerRowDefChanged=!0}removeHeaderRowDef(e){this._customHeaderRowDefs.delete(e),this._headerRowDefChanged=!0}addFooterRowDef(e){this._customFooterRowDefs.add(e),this._footerRowDefChanged=!0}removeFooterRowDef(e){this._customFooterRowDefs.delete(e),this._footerRowDefChanged=!0}setNoDataRow(e){this._customNoDataRow=e}updateStickyHeaderRowStyles(){let e=this._getRenderedRows(this._headerRowOutlet);if(this._isNativeHtmlTable){let s=v6(this._headerRowOutlet,"thead");s&&(s.style.display=e.length?"":"none")}let n=this._headerRowDefs.map(s=>s.sticky);this._stickyStyler.clearStickyPositioning(e,["top"]),this._stickyStyler.stickRows(e,n,"top"),this._headerRowDefs.forEach(s=>s.resetStickyChanged())}updateStickyFooterRowStyles(){let e=this._getRenderedRows(this._footerRowOutlet);if(this._isNativeHtmlTable){let s=v6(this._footerRowOutlet,"tfoot");s&&(s.style.display=e.length?"":"none")}let n=this._footerRowDefs.map(s=>s.sticky);this._stickyStyler.clearStickyPositioning(e,["bottom"]),this._stickyStyler.stickRows(e,n,"bottom"),this._stickyStyler.updateStickyFooterContainer(this._elementRef.nativeElement,n),this._footerRowDefs.forEach(s=>s.resetStickyChanged())}updateStickyColumnStyles(){let e=this._getRenderedRows(this._headerRowOutlet),n=this._getRenderedRows(this._rowOutlet),s=this._getRenderedRows(this._footerRowOutlet);(this._isNativeHtmlTable&&!this._fixedLayout||this._stickyColumnStylesNeedReset)&&(this._stickyStyler.clearStickyPositioning([...e,...n,...s],["left","right"]),this._stickyColumnStylesNeedReset=!1),e.forEach((r,y)=>{this._addStickyColumnStyles([r],this._headerRowDefs[y])}),this._rowDefs.forEach(r=>{let y=[];for(let A=0;A<n.length;A++)this._renderRows[A].rowDef===r&&y.push(n[A]);this._addStickyColumnStyles(y,r)}),s.forEach((r,y)=>{this._addStickyColumnStyles([r],this._footerRowDefs[y])}),Array.from(this._columnDefsByName.values()).forEach(r=>r.resetStickyChanged())}_outletAssigned(){!this._hasAllOutlets&&this._rowOutlet&&this._headerRowOutlet&&this._footerRowOutlet&&this._noDataRowOutlet&&(this._hasAllOutlets=!0,this._canRender()&&this._render())}_canRender(){return this._hasAllOutlets&&this._hasInitialized}_render(){this._cacheRowDefs(),this._cacheColumnDefs(),!this._headerRowDefs.length&&!this._footerRowDefs.length&&this._rowDefs.length;let n=this._renderUpdatedColumns()||this._headerRowDefChanged||this._footerRowDefChanged;this._stickyColumnStylesNeedReset=this._stickyColumnStylesNeedReset||n,this._forceRecalculateCellWidths=n,this._headerRowDefChanged&&(this._forceRenderHeaderRows(),this._headerRowDefChanged=!1),this._footerRowDefChanged&&(this._forceRenderFooterRows(),this._footerRowDefChanged=!1),this.dataSource&&this._rowDefs.length>0&&!this._renderChangeSubscription?this._observeRenderChanges():this._stickyColumnStylesNeedReset&&this.updateStickyColumnStyles(),this._checkStickyStates()}_getAllRenderRows(){let e=[],n=this._cachedRenderRowsMap;if(this._cachedRenderRowsMap=new Map,!this._data)return e;for(let s=0;s<this._data.length;s++){let r=this._data[s],y=this._getRenderRowsForData(r,s,n.get(r));this._cachedRenderRowsMap.has(r)||this._cachedRenderRowsMap.set(r,new WeakMap);for(let A=0;A<y.length;A++){let P=y[A],B=this._cachedRenderRowsMap.get(P.data);B.has(P.rowDef)?B.get(P.rowDef).push(P):B.set(P.rowDef,[P]),e.push(P)}}return e}_getRenderRowsForData(e,n,s){return this._getRowDefs(e,n).map(y=>{let A=s&&s.has(y)?s.get(y):[];if(A.length){let P=A.shift();return P.dataIndex=n,P}else return{data:e,rowDef:y,dataIndex:n}})}_cacheColumnDefs(){this._columnDefsByName.clear(),FD(this._getOwnDefs(this._contentColumnDefs),this._customColumnDefs).forEach(n=>{this._columnDefsByName.has(n.name),this._columnDefsByName.set(n.name,n)})}_cacheRowDefs(){this._headerRowDefs=FD(this._getOwnDefs(this._contentHeaderRowDefs),this._customHeaderRowDefs),this._footerRowDefs=FD(this._getOwnDefs(this._contentFooterRowDefs),this._customFooterRowDefs),this._rowDefs=FD(this._getOwnDefs(this._contentRowDefs),this._customRowDefs);let e=this._rowDefs.filter(n=>!n.when);!this.multiTemplateDataRows&&e.length>1,this._defaultRowDef=e[0]}_renderUpdatedColumns(){let e=(y,A)=>{let P=!!A.getColumnsDiff();return y||P},n=this._rowDefs.reduce(e,!1);n&&this._forceRenderDataRows();let s=this._headerRowDefs.reduce(e,!1);s&&this._forceRenderHeaderRows();let r=this._footerRowDefs.reduce(e,!1);return r&&this._forceRenderFooterRows(),n||s||r}_switchDataSource(e){this._data=[],jS(this.dataSource)&&this.dataSource.disconnect(this),this._renderChangeSubscription&&(this._renderChangeSubscription.unsubscribe(),this._renderChangeSubscription=null),e||(this._dataDiffer&&this._dataDiffer.diff([]),this._rowOutlet&&this._rowOutlet.viewContainer.clear()),this._dataSource=e}_observeRenderChanges(){if(!this.dataSource)return;let e;jS(this.dataSource)?e=this.dataSource.connect(this):p_(this.dataSource)?e=this.dataSource:Array.isArray(this.dataSource)&&(e=wi(this.dataSource)),this._renderChangeSubscription=e.pipe(Un(this._onDestroy)).subscribe(n=>{this._data=n||[],this.renderRows()})}_forceRenderHeaderRows(){this._headerRowOutlet.viewContainer.length>0&&this._headerRowOutlet.viewContainer.clear(),this._headerRowDefs.forEach((e,n)=>this._renderRow(this._headerRowOutlet,e,n)),this.updateStickyHeaderRowStyles()}_forceRenderFooterRows(){this._footerRowOutlet.viewContainer.length>0&&this._footerRowOutlet.viewContainer.clear(),this._footerRowDefs.forEach((e,n)=>this._renderRow(this._footerRowOutlet,e,n)),this.updateStickyFooterRowStyles()}_addStickyColumnStyles(e,n){let s=Array.from(n?.columns||[]).map(A=>{let P=this._columnDefsByName.get(A);return P}),r=s.map(A=>A.sticky),y=s.map(A=>A.stickyEnd);this._stickyStyler.updateStickyColumns(e,r,y,!this._fixedLayout||this._forceRecalculateCellWidths)}_getRenderedRows(e){let n=[];for(let s=0;s<e.viewContainer.length;s++){let r=e.viewContainer.get(s);n.push(r.rootNodes[0])}return n}_getRowDefs(e,n){if(this._rowDefs.length==1)return[this._rowDefs[0]];let s=[];if(this.multiTemplateDataRows)s=this._rowDefs.filter(r=>!r.when||r.when(n,e));else{let r=this._rowDefs.find(y=>y.when&&y.when(n,e))||this._defaultRowDef;r&&s.push(r)}return s.length,s}_getEmbeddedViewArgs(e,n){let s=e.rowDef,r={$implicit:e.data};return{templateRef:s.template,context:r,index:n}}_renderRow(e,n,s,r={}){let y=e.viewContainer.createEmbeddedView(n.template,r,s);return this._renderCellTemplateForItem(n,r),y}_renderCellTemplateForItem(e,n){for(let s of this._getCellTemplates(e))Nm.mostRecentCellOutlet&&Nm.mostRecentCellOutlet._viewContainer.createEmbeddedView(s,n);this._changeDetectorRef.markForCheck()}_updateRowIndexContext(){let e=this._rowOutlet.viewContainer;for(let n=0,s=e.length;n<s;n++){let y=e.get(n).context;y.count=s,y.first=n===0,y.last=n===s-1,y.even=n%2===0,y.odd=!y.even,this.multiTemplateDataRows?(y.dataIndex=this._renderRows[n].dataIndex,y.renderIndex=n):y.index=this._renderRows[n].dataIndex}}_getCellTemplates(e){return!e||!e.columns?[]:Array.from(e.columns,n=>{let s=this._columnDefsByName.get(n);return e.extractCellTemplate(s)})}_forceRenderDataRows(){this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear(),this.renderRows()}_checkStickyStates(){let e=(n,s)=>n||s.hasStickyChanged();this._headerRowDefs.reduce(e,!1)&&this.updateStickyHeaderRowStyles(),this._footerRowDefs.reduce(e,!1)&&this.updateStickyFooterRowStyles(),Array.from(this._columnDefsByName.values()).reduce(e,!1)&&(this._stickyColumnStylesNeedReset=!0,this.updateStickyColumnStyles())}_setupStickyStyler(){let e=this._dir?this._dir.value:"ltr";this._stickyStyler=new mP(this._isNativeHtmlTable,this.stickyCssClass,e,this._coalescedStyleScheduler,this._platform.isBrowser,this.needsPositionStickyOnElement,this._stickyPositioningListener,this._injector),(this._dir?this._dir.change:wi()).pipe(Un(this._onDestroy)).subscribe(n=>{this._stickyStyler.direction=n,this.updateStickyColumnStyles()})}_getOwnDefs(e){return e.filter(n=>!n._table||n._table===this)}_updateNoDataRow(){let e=this._customNoDataRow||this._noDataRow;if(!e)return;let n=this._rowOutlet.viewContainer.length===0;if(n===this._isShowingNoDataRow)return;let s=this._noDataRowOutlet.viewContainer;if(n){let r=s.createEmbeddedView(e.templateRef),y=r.rootNodes[0];r.rootNodes.length===1&&y?.nodeType===this._document.ELEMENT_NODE&&(y.setAttribute("role","row"),y.classList.add(e._contentClassName))}else s.clear();this._isShowingNoDataRow=n,this._changeDetectorRef.markForCheck()}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["cdk-table"],["table","cdk-table",""]],contentQueries:function(n,s,r){if(n&1&&(Mr(r,E6,5),Mr(r,Sy,5),Mr(r,UD,5),Mr(r,Nx,5),Mr(r,yP,5)),n&2){let y;Bi(y=Vi())&&(s._noDataRow=y.first),Bi(y=Vi())&&(s._contentColumnDefs=y),Bi(y=Vi())&&(s._contentRowDefs=y),Bi(y=Vi())&&(s._contentHeaderRowDefs=y),Bi(y=Vi())&&(s._contentFooterRowDefs=y)}},hostAttrs:[1,"cdk-table"],hostVars:2,hostBindings:function(n,s){n&2&&Ai("cdk-table-fixed-layout",s.fixedLayout)},inputs:{trackBy:"trackBy",dataSource:"dataSource",multiTemplateDataRows:[2,"multiTemplateDataRows","multiTemplateDataRows",xi],fixedLayout:[2,"fixedLayout","fixedLayout",xi]},outputs:{contentChanged:"contentChanged"},exportAs:["cdkTable"],features:[Vn([{provide:Qc,useExisting:i},{provide:dy,useClass:Lm},{provide:zD,useClass:gP},{provide:BD,useValue:null}])],ngContentSelectors:une,decls:5,vars:2,consts:[["role","rowgroup"],["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(n,s){n&1&&(xr(dne),an(0),an(1,1),pt(2,hne,1,0)(3,pne,7,0)(4,fne,4,0)),n&2&&(ge(2),un(s._isServer?2:-1),ge(),un(s._isNativeHtmlTable?3:4))},dependencies:[wP,xP,EP,CP],styles:[`.cdk-table-fixed-layout{table-layout:fixed}
`],encapsulation:2})}return i})();function FD(i,t){return i.concat(Array.from(t))}function v6(i,t){let e=t.toUpperCase(),n=i.viewContainer.element.nativeElement;for(;n;){let s=n.nodeType===1?n.nodeName:null;if(s===e)return n;if(s==="TABLE")break;n=n.parentNode}return null}var S6=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({imports:[dx]})}return i})();var zx=class{_multiple;_emitChanges;compareWith;_selection=new Set;_deselectedToEmit=[];_selectedToEmit=[];_selected;get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}changed=new ni;constructor(t=!1,e,n=!0,s){this._multiple=t,this._emitChanges=n,this.compareWith=s,e&&e.length&&(t?e.forEach(r=>this._markSelected(r)):this._markSelected(e[0]),this._selectedToEmit.length=0)}select(...t){this._verifyValueAssignment(t),t.forEach(n=>this._markSelected(n));let e=this._hasQueuedChanges();return this._emitChangeEvent(),e}deselect(...t){this._verifyValueAssignment(t),t.forEach(n=>this._unmarkSelected(n));let e=this._hasQueuedChanges();return this._emitChangeEvent(),e}setSelection(...t){this._verifyValueAssignment(t);let e=this.selected,n=new Set(t.map(r=>this._getConcreteValue(r)));t.forEach(r=>this._markSelected(r)),e.filter(r=>!n.has(this._getConcreteValue(r,n))).forEach(r=>this._unmarkSelected(r));let s=this._hasQueuedChanges();return this._emitChangeEvent(),s}toggle(t){return this.isSelected(t)?this.deselect(t):this.select(t)}clear(t=!0){this._unmarkAll();let e=this._hasQueuedChanges();return t&&this._emitChangeEvent(),e}isSelected(t){return this._selection.has(this._getConcreteValue(t))}isEmpty(){return this._selection.size===0}hasValue(){return!this.isEmpty()}sort(t){this._multiple&&this.selected&&this._selected.sort(t)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(t){t=this._getConcreteValue(t),this.isSelected(t)||(this._multiple||this._unmarkAll(),this.isSelected(t)||this._selection.add(t),this._emitChanges&&this._selectedToEmit.push(t))}_unmarkSelected(t){t=this._getConcreteValue(t),this.isSelected(t)&&(this._selection.delete(t),this._emitChanges&&this._deselectedToEmit.push(t))}_unmarkAll(){this.isEmpty()||this._selection.forEach(t=>this._unmarkSelected(t))}_verifyValueAssignment(t){t.length>1&&this._multiple}_hasQueuedChanges(){return!!(this._deselectedToEmit.length||this._selectedToEmit.length)}_getConcreteValue(t,e){if(this.compareWith){e=e??this._selection;for(let n of e)if(this.compareWith(t,n))return n;return t}else return t}};var gne=[[["caption"]],[["colgroup"],["col"]],"*"],_ne=["caption","colgroup, col","*"];function yne(i,t){i&1&&an(0,2)}function vne(i,t){i&1&&(oe(0,"thead",0),Ta(1,1),ae(),oe(2,"tbody",2),Ta(3,3)(4,4),ae(),oe(5,"tfoot",0),Ta(6,5),ae())}function bne(i,t){i&1&&Ta(0,1)(1,3)(2,4)(3,5)}var Dp=(()=>{class i extends SP{stickyCssClass="mat-mdc-table-sticky";needsPositionStickyOnElement=!1;static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275cmp=Yt({type:i,selectors:[["mat-table"],["table","mat-table",""]],hostAttrs:[1,"mat-mdc-table","mdc-data-table__table"],hostVars:2,hostBindings:function(n,s){n&2&&Ai("mdc-table-fixed-layout",s.fixedLayout)},exportAs:["matTable"],features:[Vn([{provide:SP,useExisting:i},{provide:Qc,useExisting:i},{provide:zD,useClass:gP},{provide:dy,useClass:Lm},{provide:BD,useValue:null}]),dn],ngContentSelectors:_ne,decls:5,vars:2,consts:[["role","rowgroup"],["headerRowOutlet",""],["role","rowgroup",1,"mdc-data-table__content"],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(n,s){n&1&&(xr(gne),an(0),an(1,1),pt(2,yne,1,0)(3,vne,7,0)(4,bne,4,0)),n&2&&(ge(2),un(s._isServer?2:-1),ge(),un(s._isNativeHtmlTable?3:4))},dependencies:[wP,xP,EP,CP],styles:[`.mat-mdc-table-sticky{position:sticky !important}mat-table{display:block}mat-header-row{min-height:56px}mat-row,mat-footer-row{min-height:48px}mat-row,mat-header-row,mat-footer-row{display:flex;border-width:0;border-bottom-width:1px;border-style:solid;align-items:center;box-sizing:border-box}mat-cell:first-of-type,mat-header-cell:first-of-type,mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] mat-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:first-of-type:not(:only-of-type){padding-left:0;padding-right:24px}mat-cell:last-of-type,mat-header-cell:last-of-type,mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] mat-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:last-of-type:not(:only-of-type){padding-right:0;padding-left:24px}mat-cell,mat-header-cell,mat-footer-cell{flex:1;display:flex;align-items:center;overflow:hidden;word-wrap:break-word;min-height:inherit}.mat-mdc-table{min-width:100%;border:0;border-spacing:0;table-layout:auto;white-space:normal;background-color:var(--mat-table-background-color, var(--mat-sys-surface))}.mdc-data-table__cell{box-sizing:border-box;overflow:hidden;text-align:left;text-overflow:ellipsis}[dir=rtl] .mdc-data-table__cell{text-align:right}.mdc-data-table__cell,.mdc-data-table__header-cell{padding:0 16px}.mat-mdc-header-row{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-header-container-height, 56px);color:var(--mat-table-header-headline-color, var(--mat-sys-on-surface, rgba(0, 0, 0, 0.87)));font-family:var(--mat-table-header-headline-font, var(--mat-sys-title-small-font, Roboto, sans-serif));line-height:var(--mat-table-header-headline-line-height, var(--mat-sys-title-small-line-height));font-size:var(--mat-table-header-headline-size, var(--mat-sys-title-small-size, 14px));font-weight:var(--mat-table-header-headline-weight, var(--mat-sys-title-small-weight, 500))}.mat-mdc-row{height:var(--mat-table-row-item-container-height, 52px);color:var(--mat-table-row-item-label-text-color, var(--mat-sys-on-surface, rgba(0, 0, 0, 0.87)))}.mat-mdc-row,.mdc-data-table__content{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-table-row-item-label-text-font, var(--mat-sys-body-medium-font, Roboto, sans-serif));line-height:var(--mat-table-row-item-label-text-line-height, var(--mat-sys-body-medium-line-height));font-size:var(--mat-table-row-item-label-text-size, var(--mat-sys-body-medium-size, 14px));font-weight:var(--mat-table-row-item-label-text-weight, var(--mat-sys-body-medium-weight))}.mat-mdc-footer-row{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-footer-container-height, 52px);color:var(--mat-table-row-item-label-text-color, var(--mat-sys-on-surface, rgba(0, 0, 0, 0.87)));font-family:var(--mat-table-footer-supporting-text-font, var(--mat-sys-body-medium-font, Roboto, sans-serif));line-height:var(--mat-table-footer-supporting-text-line-height, var(--mat-sys-body-medium-line-height));font-size:var(--mat-table-footer-supporting-text-size, var(--mat-sys-body-medium-size, 14px));font-weight:var(--mat-table-footer-supporting-text-weight, var(--mat-sys-body-medium-weight));letter-spacing:var(--mat-table-footer-supporting-text-tracking, var(--mat-sys-body-medium-tracking))}.mat-mdc-header-cell{border-bottom-color:var(--mat-table-row-item-outline-color, var(--mat-sys-outline, rgba(0, 0, 0, 0.12)));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-header-headline-tracking, var(--mat-sys-title-small-tracking));font-weight:inherit;line-height:inherit;box-sizing:border-box;text-overflow:ellipsis;overflow:hidden;outline:none;text-align:left}[dir=rtl] .mat-mdc-header-cell{text-align:right}.mdc-data-table__row:last-child>.mat-mdc-header-cell{border-bottom:none}.mat-mdc-cell{border-bottom-color:var(--mat-table-row-item-outline-color, var(--mat-sys-outline, rgba(0, 0, 0, 0.12)));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-row-item-label-text-tracking, var(--mat-sys-body-medium-tracking));line-height:inherit}.mdc-data-table__row:last-child>.mat-mdc-cell{border-bottom:none}.mat-mdc-footer-cell{letter-spacing:var(--mat-table-row-item-label-text-tracking, var(--mat-sys-body-medium-tracking))}mat-row.mat-mdc-row,mat-header-row.mat-mdc-header-row,mat-footer-row.mat-mdc-footer-row{border-bottom:none}.mat-mdc-table tbody,.mat-mdc-table tfoot,.mat-mdc-table thead,.mat-mdc-cell,.mat-mdc-footer-cell,.mat-mdc-header-row,.mat-mdc-row,.mat-mdc-footer-row,.mat-mdc-table .mat-mdc-header-cell{background:inherit}.mat-mdc-table mat-header-row.mat-mdc-header-row,.mat-mdc-table mat-row.mat-mdc-row,.mat-mdc-table mat-footer-row.mat-mdc-footer-cell{height:unset}mat-header-cell.mat-mdc-header-cell,mat-cell.mat-mdc-cell,mat-footer-cell.mat-mdc-footer-cell{align-self:stretch}
`],encapsulation:2})}return i})(),Mp=(()=>{class i extends VD{static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275dir=ri({type:i,selectors:[["","matCellDef",""]],features:[Vn([{provide:VD,useExisting:i}]),dn]})}return i})(),Tp=(()=>{class i extends jD{static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275dir=ri({type:i,selectors:[["","matHeaderCellDef",""]],features:[Vn([{provide:jD,useExisting:i}]),dn]})}return i})();var Ip=(()=>{class i extends Sy{get name(){return this._name}set name(e){this._setNameInput(e)}_updateColumnCssClassName(){super._updateColumnCssClassName(),this._columnCssClassName.push(`mat-column-${this.cssClassFriendlyName}`)}static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275dir=ri({type:i,selectors:[["","matColumnDef",""]],inputs:{name:[0,"matColumnDef","name"]},features:[Vn([{provide:Sy,useExisting:i},{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:i}]),dn]})}return i})(),Ap=(()=>{class i extends w6{static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275dir=ri({type:i,selectors:[["mat-header-cell"],["th","mat-header-cell",""]],hostAttrs:["role","columnheader",1,"mat-mdc-header-cell","mdc-data-table__header-cell"],features:[dn]})}return i})();var Rp=(()=>{class i extends C6{static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275dir=ri({type:i,selectors:[["mat-cell"],["td","mat-cell",""]],hostAttrs:[1,"mat-mdc-cell","mdc-data-table__cell"],features:[dn]})}return i})();var kp=(()=>{class i extends Nx{static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275dir=ri({type:i,selectors:[["","matHeaderRowDef",""]],inputs:{columns:[0,"matHeaderRowDef","columns"],sticky:[2,"matHeaderRowDefSticky","sticky",xi]},features:[Vn([{provide:Nx,useExisting:i}]),dn]})}return i})();var Pp=(()=>{class i extends UD{static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275dir=ri({type:i,selectors:[["","matRowDef",""]],inputs:{columns:[0,"matRowDefColumns","columns"],when:[0,"matRowDefWhen","when"]},features:[Vn([{provide:UD,useExisting:i}]),dn]})}return i})(),Op=(()=>{class i extends vP{static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275cmp=Yt({type:i,selectors:[["mat-header-row"],["tr","mat-header-row",""]],hostAttrs:["role","row",1,"mat-mdc-header-row","mdc-data-table__header-row"],exportAs:["matHeaderRow"],features:[Vn([{provide:vP,useExisting:i}]),dn],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(n,s){n&1&&Ta(0,0)},dependencies:[Nm],encapsulation:2})}return i})();var Fp=(()=>{class i extends bP{static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275cmp=Yt({type:i,selectors:[["mat-row"],["tr","mat-row",""]],hostAttrs:["role","row",1,"mat-mdc-row","mdc-data-table__row"],exportAs:["matRow"],features:[Vn([{provide:bP,useExisting:i}]),dn],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(n,s){n&1&&Ta(0,0)},dependencies:[Nm],encapsulation:2})}return i})();var Lp=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({imports:[An,S6,An]})}return i})();var DP=class{_box;_destroyed=new ni;_resizeSubject=new ni;_resizeObserver;_elementObservables=new Map;constructor(t){this._box=t,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(e=>this._resizeSubject.next(e)))}observe(t){return this._elementObservables.has(t)||this._elementObservables.set(t,new Yn(e=>{let n=this._resizeSubject.subscribe(e);return this._resizeObserver?.observe(t,{box:this._box}),()=>{this._resizeObserver?.unobserve(t),n.unsubscribe(),this._elementObservables.delete(t)}}).pipe(dr(e=>e.some(n=>n.target===t)),CC({bufferSize:1,refCount:!0}),Un(this._destroyed))),this._elementObservables.get(t)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}},D6=(()=>{class i{_cleanupErrorListener;_observers=new Map;_ngZone=Z(ki);constructor(){typeof ResizeObserver<"u"}ngOnDestroy(){for(let[,e]of this._observers)e.destroy();this._observers.clear(),this._cleanupErrorListener?.()}observe(e,n){let s=n?.box||"content-box";return this._observers.has(s)||this._observers.set(s,new DP(s)),this._observers.get(s).observe(e)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var xne=["notch"],wne=["matFormFieldNotchedOutline",""],Cne=["*"],Ene=["textField"],Sne=["iconPrefixContainer"],Dne=["textPrefixContainer"],Mne=["iconSuffixContainer"],Tne=["textSuffixContainer"],Ine=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],Ane=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];function Rne(i,t){i&1&&Et(0,"span",20)}function kne(i,t){if(i&1&&(oe(0,"label",19),an(1,1),pt(2,Rne,1,0,"span",20),ae()),i&2){let e=bt(2);Be("floating",e._shouldLabelFloat())("monitorResize",e._hasOutline())("id",e._labelId),ji("for",e._control.disableAutomaticLabeling?null:e._control.id),ge(2),un(!e.hideRequiredMarker&&e._control.required?2:-1)}}function Pne(i,t){if(i&1&&pt(0,kne,3,5,"label",19),i&2){let e=bt();un(e._hasFloatingLabel()?0:-1)}}function One(i,t){i&1&&Et(0,"div",7)}function Fne(i,t){}function Lne(i,t){if(i&1&&pt(0,Fne,0,0,"ng-template",13),i&2){bt(2);let e=No(1);Be("ngTemplateOutlet",e)}}function Nne(i,t){if(i&1&&(oe(0,"div",9),pt(1,Lne,1,1,null,13),ae()),i&2){let e=bt();Be("matFormFieldNotchedOutlineOpen",e._shouldLabelFloat()),ge(),un(e._forceDisplayInfixLabel()?-1:1)}}function zne(i,t){i&1&&(oe(0,"div",10,2),an(2,2),ae())}function Bne(i,t){i&1&&(oe(0,"div",11,3),an(2,3),ae())}function Vne(i,t){}function jne(i,t){if(i&1&&pt(0,Vne,0,0,"ng-template",13),i&2){bt();let e=No(1);Be("ngTemplateOutlet",e)}}function Une(i,t){i&1&&(oe(0,"div",14,4),an(2,4),ae())}function Hne(i,t){i&1&&(oe(0,"div",15,5),an(2,5),ae())}function $ne(i,t){i&1&&Et(0,"div",16)}function Gne(i,t){i&1&&an(0,6)}function qne(i,t){if(i&1&&(oe(0,"mat-hint",21),Ee(1),ae()),i&2){let e=bt(2);Be("id",e._hintLabelId),ge(),tn(e.hintLabel)}}function Wne(i,t){if(i&1&&(pt(0,qne,2,2,"mat-hint",21),an(1,7),Et(2,"div",22),an(3,8)),i&2){let e=bt();un(e.hintLabel?0:-1)}}var Jc=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["mat-label"]]})}return i})(),TP=new Dt("MatError"),IP=(()=>{class i{id=Z(kr).getId("mat-mdc-error-");constructor(){}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["mat-error"],["","matError",""]],hostAttrs:[1,"mat-mdc-form-field-error","mat-mdc-form-field-bottom-align"],hostVars:1,hostBindings:function(n,s){n&2&&Ia("id",s.id)},inputs:{id:"id"},features:[Vn([{provide:TP,useExisting:i}])]})}return i})(),MP=(()=>{class i{align="start";id=Z(kr).getId("mat-mdc-hint-");static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(n,s){n&2&&(Ia("id",s.id),ji("align",null),Ai("mat-mdc-form-field-hint-end",s.align==="end"))},inputs:{align:"align",id:"id"}})}return i})(),P6=new Dt("MatPrefix");var AP=new Dt("MatSuffix"),RP=(()=>{class i{set _isTextSelector(e){this._isText=!0}_isText=!1;static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","matSuffix",""],["","matIconSuffix",""],["","matTextSuffix",""]],inputs:{_isTextSelector:[0,"matTextSuffix","_isTextSelector"]},features:[Vn([{provide:AP,useExisting:i}])]})}return i})(),O6=new Dt("FloatingLabelParent"),M6=(()=>{class i{_elementRef=Z(Ii);get floating(){return this._floating}set floating(e){this._floating=e,this.monitorResize&&this._handleResize()}_floating=!1;get monitorResize(){return this._monitorResize}set monitorResize(e){this._monitorResize=e,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}_monitorResize=!1;_resizeObserver=Z(D6);_ngZone=Z(ki);_parent=Z(O6);_resizeSubscription=new Tn;constructor(){}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return Yne(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(n,s){n&2&&Ai("mdc-floating-label--float-above",s.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"}})}return i})();function Yne(i){let t=i;if(t.offsetParent!==null)return t.scrollWidth;let e=t.cloneNode(!0);e.style.setProperty("position","absolute"),e.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(e);let n=e.scrollWidth;return e.remove(),n}var T6="mdc-line-ripple--active",$D="mdc-line-ripple--deactivating",I6=(()=>{class i{_elementRef=Z(Ii);_cleanupTransitionEnd;constructor(){let e=Z(ki),n=Z(Do);e.runOutsideAngular(()=>{this._cleanupTransitionEnd=n.listen(this._elementRef.nativeElement,"transitionend",this._handleTransitionEnd)})}activate(){let e=this._elementRef.nativeElement.classList;e.remove($D),e.add(T6)}deactivate(){this._elementRef.nativeElement.classList.add($D)}_handleTransitionEnd=e=>{let n=this._elementRef.nativeElement.classList,s=n.contains($D);e.propertyName==="opacity"&&s&&n.remove(T6,$D)};ngOnDestroy(){this._cleanupTransitionEnd()}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"]})}return i})(),A6=(()=>{class i{_elementRef=Z(Ii);_ngZone=Z(ki);open=!1;_notch;constructor(){}ngAfterViewInit(){let e=this._elementRef.nativeElement.querySelector(".mdc-floating-label");e?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),typeof requestAnimationFrame=="function"&&(e.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>e.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(e){!this.open||!e?this._notch.nativeElement.style.width="":this._notch.nativeElement.style.width=`calc(${e}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(n,s){if(n&1&&Bn(xne,5),n&2){let r;Bi(r=Vi())&&(s._notch=r.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(n,s){n&2&&Ai("mdc-notched-outline--notched",s.open)},inputs:{open:[0,"matFormFieldNotchedOutlineOpen","open"]},attrs:wne,ngContentSelectors:Cne,decls:5,vars:0,consts:[["notch",""],[1,"mat-mdc-notch-piece","mdc-notched-outline__leading"],[1,"mat-mdc-notch-piece","mdc-notched-outline__notch"],[1,"mat-mdc-notch-piece","mdc-notched-outline__trailing"]],template:function(n,s){n&1&&(xr(),Et(0,"div",1),oe(1,"div",2,0),an(3),ae(),Et(4,"div",3))},encapsulation:2,changeDetection:0})}return i})(),zm=(()=>{class i{value;stateChanges;id;placeholder;ngControl;focused;empty;shouldLabelFloat;required;disabled;errorState;controlType;autofilled;userAriaDescribedBy;disableAutomaticLabeling;static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i})}return i})();var Np=new Dt("MatFormField"),F6=new Dt("MAT_FORM_FIELD_DEFAULT_OPTIONS"),R6="fill",Zne="auto",k6="fixed",Xne="translateY(-50%)",kl=(()=>{class i{_elementRef=Z(Ii);_changeDetectorRef=Z($n);_dir=Z(vo);_platform=Z(or);_idGenerator=Z(kr);_ngZone=Z(ki);_injector=Z(vn);_defaults=Z(F6,{optional:!0});_textField;_iconPrefixContainer;_textPrefixContainer;_iconSuffixContainer;_textSuffixContainer;_floatingLabel;_notchedOutline;_lineRipple;_formFieldControl;_prefixChildren;_suffixChildren;_errorChildren;_hintChildren;_labelChild=HV(Jc);get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(e){this._hideRequiredMarker=Tl(e)}_hideRequiredMarker=!1;color="primary";get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||Zne}set floatLabel(e){e!==this._floatLabel&&(this._floatLabel=e,this._changeDetectorRef.markForCheck())}_floatLabel;get appearance(){return this._appearance}set appearance(e){let n=this._appearance,s=e||this._defaults?.appearance||R6;this._appearance=s,this._appearance==="outline"&&this._appearance!==n&&(this._needsOutlineLabelOffsetUpdate=!0)}_appearance=R6;get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||k6}set subscriptSizing(e){this._subscriptSizing=e||this._defaults?.subscriptSizing||k6}_subscriptSizing=null;get hintLabel(){return this._hintLabel}set hintLabel(e){this._hintLabel=e,this._processHints()}_hintLabel="";_hasIconPrefix=!1;_hasTextPrefix=!1;_hasIconSuffix=!1;_hasTextSuffix=!1;_labelId=this._idGenerator.getId("mat-mdc-form-field-label-");_hintLabelId=this._idGenerator.getId("mat-mdc-hint-");get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(e){this._explicitFormFieldControl=e}_destroyed=new ni;_isFocused=null;_explicitFormFieldControl;_needsOutlineLabelOffsetUpdate=!1;_previousControl=null;_previousControlValidatorFn=null;_stateChanges;_valueChanges;_describedByChanges;_animationsDisabled;constructor(){let e=this._defaults;e&&(e.appearance&&(this.appearance=e.appearance),this._hideRequiredMarker=!!e?.hideRequiredMarker,e.color&&(this.color=e.color)),this._animationsDisabled=Z(Vr,{optional:!0})==="NoopAnimations"}ngAfterViewInit(){this._updateFocusState(),this._animationsDisabled||this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{this._elementRef.nativeElement.classList.add("mat-form-field-animations-enabled")},300)}),this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl(),this._control!==this._previousControl&&(this._initializeControl(this._previousControl),this._control.ngControl&&this._control.ngControl.control&&(this._previousControlValidatorFn=this._control.ngControl.control.validator),this._previousControl=this._control),this._control.ngControl&&this._control.ngControl.control&&this._control.ngControl.control.validator!==this._previousControlValidatorFn&&this._changeDetectorRef.markForCheck()}ngOnDestroy(){this._stateChanges?.unsubscribe(),this._valueChanges?.unsubscribe(),this._describedByChanges?.unsubscribe(),this._destroyed.next(),this._destroyed.complete()}getLabelId=Cl(()=>this._hasFloatingLabel()?this._labelId:null);getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(e){let n=this._control,s="mat-mdc-form-field-type-";e&&this._elementRef.nativeElement.classList.remove(s+e.controlType),n.controlType&&this._elementRef.nativeElement.classList.add(s+n.controlType),this._stateChanges?.unsubscribe(),this._stateChanges=n.stateChanges.subscribe(()=>{this._updateFocusState(),this._changeDetectorRef.markForCheck()}),this._describedByChanges?.unsubscribe(),this._describedByChanges=n.stateChanges.pipe(go([void 0,void 0]),Ui(()=>[n.errorState,n.userAriaDescribedBy]),wC(),dr(([[r,y],[A,P]])=>r!==A||y!==P)).subscribe(()=>this._syncDescribedByIds()),this._valueChanges?.unsubscribe(),n.ngControl&&n.ngControl.valueChanges&&(this._valueChanges=n.ngControl.valueChanges.pipe(Un(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()))}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(e=>!e._isText),this._hasTextPrefix=!!this._prefixChildren.find(e=>e._isText),this._hasIconSuffix=!!this._suffixChildren.find(e=>!e._isText),this._hasTextSuffix=!!this._suffixChildren.find(e=>e._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),Ba(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){this._control}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||this._isFocused===null)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdate=!0),fm(()=>{this._needsOutlineLabelOffsetUpdate&&(this._needsOutlineLabelOffsetUpdate=!1,this._updateOutlineLabelOffset())},{injector:this._injector}),this._dir.change.pipe(Un(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdate=!0)}_shouldAlwaysFloat(){return this.floatLabel==="always"}_hasOutline(){return this.appearance==="outline"}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel=Cl(()=>!!this._labelChild());_shouldLabelFloat(){return this._hasFloatingLabel()?this._control.shouldLabelFloat||this._shouldAlwaysFloat():!1}_shouldForward(e){let n=this._control?this._control.ngControl:null;return n&&n[e]}_getSubscriptMessageType(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||!this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(0):this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){this._hintChildren}_syncDescribedByIds(){if(this._control){let e=[];if(this._control.userAriaDescribedBy&&typeof this._control.userAriaDescribedBy=="string"&&e.push(...this._control.userAriaDescribedBy.split(" ")),this._getSubscriptMessageType()==="hint"){let n=this._hintChildren?this._hintChildren.find(r=>r.align==="start"):null,s=this._hintChildren?this._hintChildren.find(r=>r.align==="end"):null;n?e.push(n.id):this._hintLabel&&e.push(this._hintLabelId),s&&e.push(s.id)}else this._errorChildren&&e.push(...this._errorChildren.map(n=>n.id));this._control.setDescribedByIds(e)}}_updateOutlineLabelOffset(){if(!this._hasOutline()||!this._floatingLabel)return;let e=this._floatingLabel.element;if(!(this._iconPrefixContainer||this._textPrefixContainer)){e.style.transform="";return}if(!this._isAttachedToDom()){this._needsOutlineLabelOffsetUpdate=!0;return}let n=this._iconPrefixContainer?.nativeElement,s=this._textPrefixContainer?.nativeElement,r=this._iconSuffixContainer?.nativeElement,y=this._textSuffixContainer?.nativeElement,A=n?.getBoundingClientRect().width??0,P=s?.getBoundingClientRect().width??0,B=r?.getBoundingClientRect().width??0,U=y?.getBoundingClientRect().width??0,J=this._dir.value==="rtl"?"-1":"1",le=`${A+P}px`,X=`calc(${J} * (${le} + var(--mat-mdc-form-field-label-offset-x, 0px)))`;e.style.transform=`var(
        --mat-mdc-form-field-label-transform,
        ${Xne} translateX(${X})
    )`;let ee=A+P+B+U;this._elementRef.nativeElement.style.setProperty("--mat-form-field-notch-max-width",`calc(100% - ${ee}px)`)}_isAttachedToDom(){let e=this._elementRef.nativeElement;if(e.getRootNode){let n=e.getRootNode();return n&&n!==e}return document.documentElement.contains(e)}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-form-field"]],contentQueries:function(n,s,r){if(n&1&&(f4(r,s._labelChild,Jc,5),Mr(r,zm,5),Mr(r,P6,5),Mr(r,AP,5),Mr(r,TP,5),Mr(r,MP,5)),n&2){m4();let y;Bi(y=Vi())&&(s._formFieldControl=y.first),Bi(y=Vi())&&(s._prefixChildren=y),Bi(y=Vi())&&(s._suffixChildren=y),Bi(y=Vi())&&(s._errorChildren=y),Bi(y=Vi())&&(s._hintChildren=y)}},viewQuery:function(n,s){if(n&1&&(Bn(Ene,5),Bn(Sne,5),Bn(Dne,5),Bn(Mne,5),Bn(Tne,5),Bn(M6,5),Bn(A6,5),Bn(I6,5)),n&2){let r;Bi(r=Vi())&&(s._textField=r.first),Bi(r=Vi())&&(s._iconPrefixContainer=r.first),Bi(r=Vi())&&(s._textPrefixContainer=r.first),Bi(r=Vi())&&(s._iconSuffixContainer=r.first),Bi(r=Vi())&&(s._textSuffixContainer=r.first),Bi(r=Vi())&&(s._floatingLabel=r.first),Bi(r=Vi())&&(s._notchedOutline=r.first),Bi(r=Vi())&&(s._lineRipple=r.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:40,hostBindings:function(n,s){n&2&&Ai("mat-mdc-form-field-label-always-float",s._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",s._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",s._hasIconSuffix)("mat-form-field-invalid",s._control.errorState)("mat-form-field-disabled",s._control.disabled)("mat-form-field-autofilled",s._control.autofilled)("mat-form-field-appearance-fill",s.appearance=="fill")("mat-form-field-appearance-outline",s.appearance=="outline")("mat-form-field-hide-placeholder",s._hasFloatingLabel()&&!s._shouldLabelFloat())("mat-focused",s._control.focused)("mat-primary",s.color!=="accent"&&s.color!=="warn")("mat-accent",s.color==="accent")("mat-warn",s.color==="warn")("ng-untouched",s._shouldForward("untouched"))("ng-touched",s._shouldForward("touched"))("ng-pristine",s._shouldForward("pristine"))("ng-dirty",s._shouldForward("dirty"))("ng-valid",s._shouldForward("valid"))("ng-invalid",s._shouldForward("invalid"))("ng-pending",s._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[Vn([{provide:Np,useExisting:i},{provide:O6,useExisting:i}])],ngContentSelectors:Ane,decls:20,vars:25,consts:[["labelTemplate",""],["textField",""],["iconPrefixContainer",""],["textPrefixContainer",""],["textSuffixContainer",""],["iconSuffixContainer",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],[1,"mat-mdc-form-field-focus-overlay"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[1,"mat-mdc-form-field-icon-prefix"],[1,"mat-mdc-form-field-text-prefix"],[1,"mat-mdc-form-field-infix"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align"],["aria-atomic","true","aria-live","polite"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[3,"id"],[1,"mat-mdc-form-field-hint-spacer"]],template:function(n,s){if(n&1){let r=bi();xr(Ine),pt(0,Pne,1,1,"ng-template",null,0,lp),oe(2,"div",6,1),_t("click",function(A){return qt(r),Wt(s._control.onContainerClick(A))}),pt(4,One,1,0,"div",7),oe(5,"div",8),pt(6,Nne,2,2,"div",9)(7,zne,3,0,"div",10)(8,Bne,3,0,"div",11),oe(9,"div",12),pt(10,jne,1,1,null,13),an(11),ae(),pt(12,Une,3,0,"div",14)(13,Hne,3,0,"div",15),ae(),pt(14,$ne,1,0,"div",16),ae(),oe(15,"div",17),mk(16),oe(17,"div",18),pt(18,Gne,1,0)(19,Wne,4,1),ae()()}if(n&2){let r;ge(2),Ai("mdc-text-field--filled",!s._hasOutline())("mdc-text-field--outlined",s._hasOutline())("mdc-text-field--no-label",!s._hasFloatingLabel())("mdc-text-field--disabled",s._control.disabled)("mdc-text-field--invalid",s._control.errorState),ge(2),un(!s._hasOutline()&&!s._control.disabled?4:-1),ge(2),un(s._hasOutline()?6:-1),ge(),un(s._hasIconPrefix?7:-1),ge(),un(s._hasTextPrefix?8:-1),ge(2),un(!s._hasOutline()||s._forceDisplayInfixLabel()?10:-1),ge(2),un(s._hasTextSuffix?12:-1),ge(),un(s._hasIconSuffix?13:-1),ge(),un(s._hasOutline()?-1:14),ge(),Ai("mat-mdc-form-field-subscript-dynamic-size",s.subscriptSizing==="dynamic");let y=s._getSubscriptMessageType();ge(2),Ai("mat-mdc-form-field-error-wrapper",y==="error")("mat-mdc-form-field-hint-wrapper",y==="hint"),ge(),un((r=y)==="error"?18:r==="hint"?19:-1)}},dependencies:[M6,A6,Mb,I6,MP],styles:[`.mdc-text-field{display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color;border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field__input{width:100%;min-width:0;border:none;border-radius:0;background:none;padding:0;-moz-appearance:none;-webkit-appearance:none;height:28px}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}.mdc-text-field__input::placeholder{opacity:0}.mdc-text-field__input::-moz-placeholder{opacity:0}.mdc-text-field__input::-webkit-input-placeholder{opacity:0}.mdc-text-field__input:-ms-input-placeholder{opacity:0}.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input::-moz-placeholder,.mdc-text-field--focused .mdc-text-field__input::-moz-placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input::-webkit-input-placeholder,.mdc-text-field--focused .mdc-text-field__input::-webkit-input-placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive::placeholder{opacity:0}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive::-moz-placeholder{opacity:0}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive::-webkit-input-placeholder{opacity:0}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive:-ms-input-placeholder{opacity:0}.mdc-text-field--outlined .mdc-text-field__input,.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-filled-text-field-input-text-color, var(--mat-sys-on-surface));caret-color:var(--mdc-filled-text-field-caret-color, var(--mat-sys-primary))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::-moz-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::-webkit-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-error-caret-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-filled-text-field-disabled-input-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-outlined-text-field-input-text-color, var(--mat-sys-on-surface));caret-color:var(--mdc-outlined-text-field-caret-color, var(--mat-sys-primary))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::-moz-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::-webkit-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-error-caret-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}@media(forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}}.mdc-text-field--filled{height:56px;border-bottom-right-radius:0;border-bottom-left-radius:0;border-top-left-radius:var(--mdc-filled-text-field-container-shape, var(--mat-sys-corner-extra-small));border-top-right-radius:var(--mdc-filled-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mdc-filled-text-field-container-color, var(--mat-sys-surface-variant))}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mdc-filled-text-field-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 4%, transparent))}.mdc-text-field--outlined{height:56px;overflow:visible;padding-right:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)));padding-left:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)) + 4px)}[dir=rtl] .mdc-text-field--outlined{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)) + 4px);padding-left:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)))}.mdc-floating-label{position:absolute;left:0;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label{right:0;left:auto;transform-origin:right top;text-align:right}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:auto}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label{left:auto;right:4px}.mdc-text-field--filled .mdc-floating-label{left:16px;right:auto}[dir=rtl] .mdc-text-field--filled .mdc-floating-label{left:auto;right:16px}.mdc-text-field--disabled .mdc-floating-label{cursor:default}@media(forced-colors: active){.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label{color:var(--mdc-filled-text-field-label-text-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label{color:var(--mdc-filled-text-field-focus-label-text-color, var(--mat-sys-primary))}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label{color:var(--mdc-filled-text-field-hover-label-text-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label{color:var(--mdc-filled-text-field-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-floating-label{color:var(--mdc-filled-text-field-error-label-text-color, var(--mat-sys-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mdc-floating-label{color:var(--mdc-filled-text-field-error-focus-label-text-color, var(--mat-sys-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--disabled):hover .mdc-floating-label{color:var(--mdc-filled-text-field-error-hover-label-text-color, var(--mat-sys-on-error-container))}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mdc-filled-text-field-label-text-font, var(--mat-sys-body-large-font));font-size:var(--mdc-filled-text-field-label-text-size, var(--mat-sys-body-large-size));font-weight:var(--mdc-filled-text-field-label-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mdc-filled-text-field-label-text-tracking, var(--mat-sys-body-large-tracking))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label{color:var(--mdc-outlined-text-field-label-text-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label{color:var(--mdc-outlined-text-field-focus-label-text-color, var(--mat-sys-primary))}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label{color:var(--mdc-outlined-text-field-hover-label-text-color, var(--mat-sys-on-surface))}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label{color:var(--mdc-outlined-text-field-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-floating-label{color:var(--mdc-outlined-text-field-error-label-text-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mdc-floating-label{color:var(--mdc-outlined-text-field-error-focus-label-text-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--disabled):hover .mdc-floating-label{color:var(--mdc-outlined-text-field-error-hover-label-text-color, var(--mat-sys-on-error-container))}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mdc-outlined-text-field-label-text-font, var(--mat-sys-body-large-font));font-size:var(--mdc-outlined-text-field-label-text-size, var(--mat-sys-body-large-size));font-weight:var(--mdc-outlined-text-field-label-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mdc-outlined-text-field-label-text-tracking, var(--mat-sys-body-large-tracking))}.mdc-floating-label--float-above{cursor:auto;transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1);font-size:.75rem}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline{text-align:right}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mat-mdc-notch-piece{box-sizing:border-box;height:100%;pointer-events:none;border-top:1px solid;border-bottom:1px solid}.mdc-text-field--focused .mat-mdc-notch-piece{border-width:2px}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-outline-color, var(--mat-sys-outline));border-width:var(--mdc-outlined-text-field-outline-width, 1px)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-hover-outline-color, var(--mat-sys-on-surface))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-focus-outline-color, var(--mat-sys-primary))}.mdc-text-field--outlined.mdc-text-field--disabled .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-disabled-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-error-outline-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--focused):hover .mdc-notched-outline .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-error-hover-outline-color, var(--mat-sys-on-error-container))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-error-focus-outline-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mat-mdc-notch-piece{border-width:var(--mdc-outlined-text-field-focus-outline-width, 2px)}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;border-top-right-radius:0;border-bottom-right-radius:0;border-top-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)))}[dir=rtl] .mdc-notched-outline__leading{border-left:none;border-right:1px solid;border-bottom-left-radius:0;border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-notched-outline__trailing{flex-grow:1;border-left:none;border-right:1px solid;border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}[dir=rtl] .mdc-notched-outline__trailing{border-left:1px solid;border-right:none;border-top-right-radius:0;border-bottom-right-radius:0;border-top-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:min(var(--mat-form-field-notch-max-width, 100%),100% - max(12px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)))*2)}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none;--mat-form-field-notch-max-width: 100%}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1;border-bottom-width:var(--mdc-filled-text-field-active-indicator-height, 1px)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-active-indicator-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-hover-active-indicator-color, var(--mat-sys-on-surface))}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-disabled-active-indicator-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-active-indicator-color, var(--mat-sys-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-hover-active-indicator-color, var(--mat-sys-on-error-container))}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mdc-filled-text-field-focus-active-indicator-height, 2px)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-focus-active-indicator-color, var(--mat-sys-primary))}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-error-focus-active-indicator-color, var(--mat-sys-error))}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-text-field--disabled{pointer-events:none}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all;will-change:auto}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto;will-change:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:1px solid rgba(0,0,0,0)}[dir=rtl] .mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:none;border-right:1px solid rgba(0,0,0,0)}.mat-mdc-form-field-infix{min-height:var(--mat-form-field-container-height, 56px);padding-top:var(--mat-form-field-filled-with-label-container-padding-top, 24px);padding-bottom:var(--mat-form-field-filled-with-label-container-padding-bottom, 8px)}.mdc-text-field--outlined .mat-mdc-form-field-infix,.mdc-text-field--no-label .mat-mdc-form-field-infix{padding-top:var(--mat-form-field-container-vertical-padding, 16px);padding-bottom:var(--mat-form-field-container-vertical-padding, 16px)}.mat-mdc-text-field-wrapper .mat-mdc-form-field-flex .mat-mdc-floating-label{top:calc(var(--mat-form-field-container-height, 56px)/2)}.mdc-text-field--filled .mat-mdc-floating-label{display:var(--mat-form-field-filled-label-display, block)}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{--mat-mdc-form-field-label-transform: translateY(calc(calc(6.75px + var(--mat-form-field-container-height, 56px) / 2) * -1)) scale(var(--mat-mdc-form-field-floating-label-scale, 0.75));transform:var(--mat-mdc-form-field-label-transform)}@keyframes _mat-form-field-subscript-animation{from{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px;opacity:1;transform:translateY(0);animation:_mat-form-field-subscript-animation 0ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block;color:var(--mat-form-field-error-text-color, var(--mat-sys-error))}.mat-mdc-form-field-subscript-wrapper,.mat-mdc-form-field-bottom-align::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-subscript-text-font, var(--mat-sys-body-small-font));line-height:var(--mat-form-field-subscript-text-line-height, var(--mat-sys-body-small-line-height));font-size:var(--mat-form-field-subscript-text-size, var(--mat-sys-body-small-size));letter-spacing:var(--mat-form-field-subscript-text-tracking, var(--mat-sys-body-small-tracking));font-weight:var(--mat-form-field-subscript-text-weight, var(--mat-sys-body-small-weight))}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none;background-color:var(--mat-form-field-state-layer-color, var(--mat-sys-on-surface))}.mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-form-field.mat-focused .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-focus-state-layer-opacity, 0)}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option{color:var(--mat-form-field-select-option-text-color, var(--mat-sys-neutral10))}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option:disabled{color:var(--mat-form-field-select-disabled-option-text-color, color-mix(in srgb, var(--mat-sys-neutral10) 38%, transparent))}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none;color:var(--mat-form-field-enabled-select-arrow-color, var(--mat-sys-on-surface-variant))}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select.mat-focused .mat-mdc-form-field-infix::after{color:var(--mat-form-field-focus-select-arrow-color, var(--mat-sys-primary))}.mat-mdc-form-field-type-mat-native-select.mat-form-field-disabled .mat-mdc-form-field-infix::after{color:var(--mat-form-field-disabled-select-arrow-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}@media(forced-colors: active){.mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}}@media(forced-colors: active){.mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}}@media(forced-colors: active){.mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}}@media(forced-colors: active){.mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font, var(--mat-sys-body-large-font));line-height:var(--mat-form-field-container-text-line-height, var(--mat-sys-body-large-line-height));font-size:var(--mat-form-field-container-text-size, var(--mat-sys-body-large-size));letter-spacing:var(--mat-form-field-container-text-tracking, var(--mat-sys-body-large-tracking));font-weight:var(--mat-form-field-container-text-weight, var(--mat-sys-body-large-weight))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size)*var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%;z-index:0}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:0 12px;box-sizing:content-box}.mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-leading-icon-color, var(--mat-sys-on-surface-variant))}.mat-form-field-disabled .mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-disabled-leading-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-trailing-icon-color, var(--mat-sys-on-surface-variant))}.mat-form-field-disabled .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-disabled-trailing-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-invalid .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-trailing-icon-color, var(--mat-sys-error))}.mat-form-field-invalid:not(.mat-focused):not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-hover-trailing-icon-color, var(--mat-sys-on-error-container))}.mat-form-field-invalid.mat-focused .mat-mdc-text-field-wrapper .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-focus-trailing-icon-color, var(--mat-sys-error))}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field-infix:has(textarea[cols]){width:auto}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-text-field__input{transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-text-field__input::placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-text-field__input::-moz-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-text-field__input::-webkit-input-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--focused .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--no-label .mdc-text-field__input::-moz-placeholder,.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--focused .mdc-text-field__input::-moz-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--no-label .mdc-text-field__input::-webkit-input-placeholder,.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--focused .mdc-text-field__input::-webkit-input-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field.mat-form-field-animations-enabled .mat-mdc-form-field-error-wrapper{animation-duration:300ms}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}
`],encapsulation:2,changeDetection:0})}return i})();var L6=(()=>{class i{_animationMode=Z(Vr,{optional:!0});state="unchecked";disabled=!1;appearance="full";constructor(){}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:12,hostBindings:function(n,s){n&2&&Ai("mat-pseudo-checkbox-indeterminate",s.state==="indeterminate")("mat-pseudo-checkbox-checked",s.state==="checked")("mat-pseudo-checkbox-disabled",s.disabled)("mat-pseudo-checkbox-minimal",s.appearance==="minimal")("mat-pseudo-checkbox-full",s.appearance==="full")("_mat-animation-noopable",s._animationMode==="NoopAnimations")},inputs:{state:"state",disabled:"disabled",appearance:"appearance"},decls:0,vars:0,template:function(n,s){},styles:[`.mat-pseudo-checkbox{border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{left:1px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{left:1px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-minimal-pseudo-checkbox-selected-checkmark-color, var(--mat-sys-primary))}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-pseudo-checkbox-full{border-color:var(--mat-full-pseudo-checkbox-unselected-icon-color, var(--mat-sys-on-surface-variant));border-width:2px;border-style:solid}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-disabled{border-color:var(--mat-full-pseudo-checkbox-disabled-unselected-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate{background-color:var(--mat-full-pseudo-checkbox-selected-icon-color, var(--mat-sys-primary));border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-full-pseudo-checkbox-selected-checkmark-color, var(--mat-sys-on-primary))}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled{background-color:var(--mat-full-pseudo-checkbox-disabled-selected-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-full-pseudo-checkbox-disabled-selected-checkmark-color, var(--mat-sys-surface))}.mat-pseudo-checkbox{width:18px;height:18px}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after{width:14px;height:6px;transform-origin:center;top:-4.2426406871px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{top:8px;width:16px}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after{width:10px;height:4px;transform-origin:center;top:-2.8284271247px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{top:6px;width:12px}
`],encapsulation:2,changeDetection:0})}return i})();var Kne=["text"],Qne=[[["mat-icon"]],"*"],Jne=["mat-icon","*"];function ere(i,t){if(i&1&&Et(0,"mat-pseudo-checkbox",1),i&2){let e=bt();Be("disabled",e.disabled)("state",e.selected?"checked":"unchecked")}}function tre(i,t){if(i&1&&Et(0,"mat-pseudo-checkbox",3),i&2){let e=bt();Be("disabled",e.disabled)}}function ire(i,t){if(i&1&&(oe(0,"span",4),Ee(1),ae()),i&2){let e=bt();ge(),zi("(",e.group.label,")")}}var PP=new Dt("MAT_OPTION_PARENT_COMPONENT"),OP=new Dt("MatOptgroup");var kP=class{source;isUserInput;constructor(t,e=!1){this.source=t,this.isUserInput=e}},ed=(()=>{class i{_element=Z(Ii);_changeDetectorRef=Z($n);_parent=Z(PP,{optional:!0});group=Z(OP,{optional:!0});_signalDisableRipple=!1;_selected=!1;_active=!1;_disabled=!1;_mostRecentViewValue="";get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}value;id=Z(kr).getId("mat-option-");get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(e){this._disabled=e}get disableRipple(){return this._signalDisableRipple?this._parent.disableRipple():!!this._parent?.disableRipple}get hideSingleSelectionIndicator(){return!!(this._parent&&this._parent.hideSingleSelectionIndicator)}onSelectionChange=new ui;_text;_stateChanges=new ni;constructor(){let e=Z(to);e.load(Zc),e.load(Ql),this._signalDisableRipple=!!this._parent&&np(this._parent.disableRipple)}get active(){return this._active}get viewValue(){return(this._text?.nativeElement.textContent||"").trim()}select(e=!0){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),e&&this._emitSelectionChangeEvent())}deselect(e=!0){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),e&&this._emitSelectionChangeEvent())}focus(e,n){let s=this._getHostElement();typeof s.focus=="function"&&s.focus(n)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(e){(e.keyCode===13||e.keyCode===32)&&!Mo(e)&&(this._selectViaInteraction(),e.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=this.multiple?!this._selected:!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){let e=this.viewValue;e!==this._mostRecentViewValue&&(this._mostRecentViewValue&&this._stateChanges.next(),this._mostRecentViewValue=e)}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(e=!1){this.onSelectionChange.emit(new kP(this,e))}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-option"]],viewQuery:function(n,s){if(n&1&&Bn(Kne,7),n&2){let r;Bi(r=Vi())&&(s._text=r.first)}},hostAttrs:["role","option",1,"mat-mdc-option","mdc-list-item"],hostVars:11,hostBindings:function(n,s){n&1&&_t("click",function(){return s._selectViaInteraction()})("keydown",function(y){return s._handleKeydown(y)}),n&2&&(Ia("id",s.id),ji("aria-selected",s.selected)("aria-disabled",s.disabled.toString()),Ai("mdc-list-item--selected",s.selected)("mat-mdc-option-multiple",s.multiple)("mat-mdc-option-active",s.active)("mdc-list-item--disabled",s.disabled))},inputs:{value:"value",id:"id",disabled:[2,"disabled","disabled",xi]},outputs:{onSelectionChange:"onSelectionChange"},exportAs:["matOption"],ngContentSelectors:Jne,decls:8,vars:5,consts:[["text",""],["aria-hidden","true",1,"mat-mdc-option-pseudo-checkbox",3,"disabled","state"],[1,"mdc-list-item__primary-text"],["state","checked","aria-hidden","true","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"cdk-visually-hidden"],["aria-hidden","true","mat-ripple","",1,"mat-mdc-option-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled"]],template:function(n,s){n&1&&(xr(Qne),pt(0,ere,1,2,"mat-pseudo-checkbox",1),an(1),oe(2,"span",2,0),an(4,1),ae(),pt(5,tre,1,1,"mat-pseudo-checkbox",3)(6,ire,2,1,"span",4),Et(7,"div",5)),n&2&&(un(s.multiple?0:-1),ge(5),un(!s.multiple&&s.selected&&!s.hideSingleSelectionIndicator?5:-1),ge(),un(s.group&&s.group._inert?6:-1),ge(),Be("matRippleTrigger",s._getHostElement())("matRippleDisabled",s.disabled||s.disableRipple))},dependencies:[L6,iD],styles:[`.mat-mdc-option{-webkit-user-select:none;user-select:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;min-height:48px;padding:0 16px;cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);color:var(--mat-option-label-text-color, var(--mat-sys-on-surface));font-family:var(--mat-option-label-text-font, var(--mat-sys-label-large-font));line-height:var(--mat-option-label-text-line-height, var(--mat-sys-label-large-line-height));font-size:var(--mat-option-label-text-size, var(--mat-sys-body-large-size));letter-spacing:var(--mat-option-label-text-tracking, var(--mat-sys-label-large-tracking));font-weight:var(--mat-option-label-text-weight, var(--mat-sys-body-large-weight))}.mat-mdc-option:hover:not(.mdc-list-item--disabled){background-color:var(--mat-option-hover-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-hover-state-layer-opacity) * 100%), transparent))}.mat-mdc-option:focus.mdc-list-item,.mat-mdc-option.mat-mdc-option-active.mdc-list-item{background-color:var(--mat-option-focus-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-focus-state-layer-opacity) * 100%), transparent));outline:0}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled):not(.mat-mdc-option-multiple){background-color:var(--mat-option-selected-state-layer-color, var(--mat-sys-secondary-container))}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled):not(.mat-mdc-option-multiple) .mdc-list-item__primary-text{color:var(--mat-option-selected-state-label-text-color, var(--mat-sys-on-secondary-container))}.mat-mdc-option .mat-pseudo-checkbox{--mat-minimal-pseudo-checkbox-selected-checkmark-color: var(--mat-option-selected-state-label-text-color, var(--mat-sys-on-secondary-container))}.mat-mdc-option.mdc-list-item{align-items:center;background:rgba(0,0,0,0)}.mat-mdc-option.mdc-list-item--disabled{cursor:default;pointer-events:none}.mat-mdc-option.mdc-list-item--disabled .mat-mdc-option-pseudo-checkbox,.mat-mdc-option.mdc-list-item--disabled .mdc-list-item__primary-text,.mat-mdc-option.mdc-list-item--disabled>mat-icon{opacity:.38}.mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:32px}[dir=rtl] .mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:16px;padding-right:32px}.mat-mdc-option .mat-icon,.mat-mdc-option .mat-pseudo-checkbox-full{margin-right:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-icon,[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-full{margin-right:0;margin-left:16px}.mat-mdc-option .mat-pseudo-checkbox-minimal{margin-left:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-minimal{margin-right:16px;margin-left:0}.mat-mdc-option .mat-mdc-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-option .mdc-list-item__primary-text{white-space:normal;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;font-family:inherit;text-decoration:inherit;text-transform:inherit;margin-right:auto}[dir=rtl] .mat-mdc-option .mdc-list-item__primary-text{margin-right:0;margin-left:auto}@media(forced-colors: active){.mat-mdc-option.mdc-list-item--selected:not(:has(.mat-mdc-option-pseudo-checkbox))::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .mat-mdc-option.mdc-list-item--selected:not(:has(.mat-mdc-option-pseudo-checkbox))::after{right:auto;left:16px}}.mat-mdc-option-multiple{--mdc-list-list-item-selected-container-color:var(--mdc-list-list-item-container-color, transparent)}.mat-mdc-option-active .mat-focus-indicator::before{content:""}
`],encapsulation:2,changeDetection:0})}return i})();function N6(i,t,e){if(e.length){let n=t.toArray(),s=e.toArray(),r=0;for(let y=0;y<i+1;y++)n[y].group&&n[y].group===s[r]&&r++;return r}return 0}function z6(i,t,e,n){return i<e?i:i+t>e+n?Math.max(0,i-n+t):e}var Dy=(()=>{class i{isErrorState(e,n){return!!(e&&e.invalid&&(e.touched||n&&n.submitted))}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var My=class{_defaultMatcher;ngControl;_parentFormGroup;_parentForm;_stateChanges;errorState=!1;matcher;constructor(t,e,n,s,r){this._defaultMatcher=t,this.ngControl=e,this._parentFormGroup=n,this._parentForm=s,this._stateChanges=r}updateErrorState(){let t=this.errorState,e=this._parentFormGroup||this._parentForm,n=this.matcher||this._defaultMatcher,s=this.ngControl?this.ngControl.control:null,r=n?.isErrorState(s,e)??!1;r!==t&&(this.errorState=r,this._stateChanges.next())}};var us=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({imports:[An,LS,An]})}return i})();var B6=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({imports:[An]})}return i})();var FP=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({imports:[gy,An,B6]})}return i})();var nre=["trigger"],rre=["panel"],ore=[[["mat-select-trigger"]],"*"],are=["mat-select-trigger","*"];function sre(i,t){if(i&1&&(oe(0,"span",4),Ee(1),ae()),i&2){let e=bt();ge(),tn(e.placeholder)}}function lre(i,t){i&1&&an(0)}function cre(i,t){if(i&1&&(oe(0,"span",11),Ee(1),ae()),i&2){let e=bt(2);ge(),tn(e.triggerValue)}}function dre(i,t){if(i&1&&(oe(0,"span",5),pt(1,lre,1,0)(2,cre,2,1,"span",11),ae()),i&2){let e=bt();ge(),un(e.customTrigger?1:2)}}function ure(i,t){if(i&1){let e=bi();oe(0,"div",12,1),_t("keydown",function(s){qt(e);let r=bt();return Wt(r._handleKeydown(s))}),an(2,1),ae()}if(i&2){let e=bt();d4("mat-mdc-select-panel mdc-menu-surface mdc-menu-surface--open ",e._getPanelTheme(),""),Ai("mat-select-panel-animations-enabled",!e._animationsDisabled),Be("ngClass",e.panelClass),ji("id",e.id+"-panel")("aria-multiselectable",e.multiple)("aria-label",e.ariaLabel||null)("aria-labelledby",e._getPanelAriaLabelledby())}}var LP=new Dt("mat-select-scroll-strategy",{providedIn:"root",factory:()=>{let i=Z(bo);return()=>i.scrollStrategies.reposition()}});function V6(i){return()=>i.scrollStrategies.reposition()}var j6=new Dt("MAT_SELECT_CONFIG"),U6={provide:LP,deps:[bo],useFactory:V6},H6=new Dt("MatSelectTrigger"),GD=class{source;value;constructor(t,e){this.source=t,this.value=e}},Uu=(()=>{class i{_viewportRuler=Z(xp);_changeDetectorRef=Z($n);_elementRef=Z(Ii);_dir=Z(vo,{optional:!0});_idGenerator=Z(kr);_renderer=Z(Do);_parentFormField=Z(Np,{optional:!0});ngControl=Z(Al,{self:!0,optional:!0});_liveAnnouncer=Z(cx);_defaultOptions=Z(j6,{optional:!0});_animationsDisabled=Z(Vr,{optional:!0})==="NoopAnimations";_initialized=new ni;_cleanupDetach;options;optionGroups;customTrigger;_positions=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"}];_scrollOptionIntoView(e){let n=this.options.toArray()[e];if(n){let s=this.panel.nativeElement,r=N6(e,this.options,this.optionGroups),y=n._getHostElement();e===0&&r===1?s.scrollTop=0:s.scrollTop=z6(y.offsetTop,y.offsetHeight,s.scrollTop,s.offsetHeight)}}_positioningSettled(){this._scrollOptionIntoView(this._keyManager.activeItemIndex||0)}_getChangeEvent(e){return new GD(this,e)}_scrollStrategyFactory=Z(LP);_panelOpen=!1;_compareWith=(e,n)=>e===n;_uid=this._idGenerator.getId("mat-select-");_triggerAriaLabelledBy=null;_previousControl;_destroy=new ni;_errorStateTracker;stateChanges=new ni;disableAutomaticLabeling=!0;userAriaDescribedBy;_selectionModel;_keyManager;_preferredOverlayOrigin;_overlayWidth;_onChange=()=>{};_onTouched=()=>{};_valueId=this._idGenerator.getId("mat-select-value-");_scrollStrategy;_overlayPanelClass=this._defaultOptions?.overlayPanelClass||"";get focused(){return this._focused||this._panelOpen}_focused=!1;controlType="mat-select";trigger;panel;_overlayDir;panelClass;disabled=!1;disableRipple=!1;tabIndex=0;get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(e){this._hideSingleSelectionIndicator=e,this._syncParentProperties()}_hideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1;get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.stateChanges.next()}_placeholder;get required(){return this._required??this.ngControl?.control?.hasValidator(si.required)??!1}set required(e){this._required=e,this.stateChanges.next()}_required;get multiple(){return this._multiple}set multiple(e){this._selectionModel,this._multiple=e}_multiple=!1;disableOptionCentering=this._defaultOptions?.disableOptionCentering??!1;get compareWith(){return this._compareWith}set compareWith(e){this._compareWith=e,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(e){this._assignValue(e)&&this._onChange(e)}_value;ariaLabel="";ariaLabelledby;get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(e){this._errorStateTracker.matcher=e}typeaheadDebounceInterval;sortComparator;get id(){return this._id}set id(e){this._id=e||this._uid,this.stateChanges.next()}_id;get errorState(){return this._errorStateTracker.errorState}set errorState(e){this._errorStateTracker.errorState=e}panelWidth=this._defaultOptions&&typeof this._defaultOptions.panelWidth<"u"?this._defaultOptions.panelWidth:"auto";canSelectNullableOptions=this._defaultOptions?.canSelectNullableOptions??!1;optionSelectionChanges=wd(()=>{let e=this.options;return e?e.changes.pipe(go(e),Oo(()=>Ba(...e.map(n=>n.onSelectionChange)))):this._initialized.pipe(Oo(()=>this.optionSelectionChanges))});openedChange=new ui;_openedStream=this.openedChange.pipe(dr(e=>e),Ui(()=>{}));_closedStream=this.openedChange.pipe(dr(e=>!e),Ui(()=>{}));selectionChange=new ui;valueChange=new ui;constructor(){let e=Z(Dy),n=Z(Om,{optional:!0}),s=Z(Yr,{optional:!0}),r=Z(new Hl("tabindex"),{optional:!0});this.ngControl&&(this.ngControl.valueAccessor=this),this._defaultOptions?.typeaheadDebounceInterval!=null&&(this.typeaheadDebounceInterval=this._defaultOptions.typeaheadDebounceInterval),this._errorStateTracker=new My(e,this.ngControl,s,n,this.stateChanges),this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=r==null?0:parseInt(r)||0,this.id=this.id}ngOnInit(){this._selectionModel=new zx(this.multiple),this.stateChanges.next(),this._viewportRuler.change().pipe(Un(this._destroy)).subscribe(()=>{this.panelOpen&&(this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._changeDetectorRef.detectChanges())})}ngAfterContentInit(){this._initialized.next(),this._initialized.complete(),this._initKeyManager(),this._selectionModel.changed.pipe(Un(this._destroy)).subscribe(e=>{e.added.forEach(n=>n.select()),e.removed.forEach(n=>n.deselect())}),this.options.changes.pipe(go(null),Un(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){let e=this._getTriggerAriaLabelledby(),n=this.ngControl;if(e!==this._triggerAriaLabelledBy){let s=this._elementRef.nativeElement;this._triggerAriaLabelledBy=e,e?s.setAttribute("aria-labelledby",e):s.removeAttribute("aria-labelledby")}n&&(this._previousControl!==n.control&&(this._previousControl!==void 0&&n.disabled!==null&&n.disabled!==this.disabled&&(this.disabled=n.disabled),this._previousControl=n.control),this.updateErrorState())}ngOnChanges(e){(e.disabled||e.userAriaDescribedBy)&&this.stateChanges.next(),e.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this.typeaheadDebounceInterval)}ngOnDestroy(){this._cleanupDetach?.(),this._keyManager?.destroy(),this._destroy.next(),this._destroy.complete(),this.stateChanges.complete(),this._clearFromModal()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._parentFormField&&(this._preferredOverlayOrigin=this._parentFormField.getConnectedOverlayOrigin()),this._cleanupDetach?.(),this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._applyModalPanelOwnership(),this._panelOpen=!0,this._overlayDir.positionChange.pipe(mo(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()}),this._overlayDir.attachOverlay(),this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck(),this.stateChanges.next(),Promise.resolve().then(()=>this.openedChange.emit(!0)))}_trackedModal=null;_applyModalPanelOwnership(){let e=this._elementRef.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!e)return;let n=`${this.id}-panel`;this._trackedModal&&eD(this._trackedModal,"aria-owns",n),B2(e,"aria-owns",n),this._trackedModal=e}_clearFromModal(){if(!this._trackedModal)return;let e=`${this.id}-panel`;eD(this._trackedModal,"aria-owns",e),this._trackedModal=null}close(){this._panelOpen&&(this._panelOpen=!1,this._exitAndDetach(),this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched(),this.stateChanges.next(),Promise.resolve().then(()=>this.openedChange.emit(!1)))}_exitAndDetach(){if(this._animationsDisabled||!this.panel){this._detachOverlay();return}this._cleanupDetach?.(),this._cleanupDetach=()=>{n(),clearTimeout(s),this._cleanupDetach=void 0};let e=this.panel.nativeElement,n=this._renderer.listen(e,"animationend",r=>{r.animationName==="_mat-select-exit"&&(this._cleanupDetach?.(),this._detachOverlay())}),s=setTimeout(()=>{this._cleanupDetach?.(),this._detachOverlay()},200);e.classList.add("mat-select-panel-exit")}_detachOverlay(){this._overlayDir.detachOverlay(),this._changeDetectorRef.markForCheck()}writeValue(e){this._assignValue(e)}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel?.selected||[]:this._selectionModel?.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){let e=this._selectionModel.selected.map(n=>n.viewValue);return this._isRtl()&&e.reverse(),e.join(", ")}return this._selectionModel.selected[0].viewValue}updateErrorState(){this._errorStateTracker.updateErrorState()}_isRtl(){return this._dir?this._dir.value==="rtl":!1}_handleKeydown(e){this.disabled||(this.panelOpen?this._handleOpenKeydown(e):this._handleClosedKeydown(e))}_handleClosedKeydown(e){let n=e.keyCode,s=n===40||n===38||n===37||n===39,r=n===13||n===32,y=this._keyManager;if(!y.isTyping()&&r&&!Mo(e)||(this.multiple||e.altKey)&&s)e.preventDefault(),this.open();else if(!this.multiple){let A=this.selected;y.onKeydown(e);let P=this.selected;P&&A!==P&&this._liveAnnouncer.announce(P.viewValue,1e4)}}_handleOpenKeydown(e){let n=this._keyManager,s=e.keyCode,r=s===40||s===38,y=n.isTyping();if(r&&e.altKey)e.preventDefault(),this.close();else if(!y&&(s===13||s===32)&&n.activeItem&&!Mo(e))e.preventDefault(),n.activeItem._selectViaInteraction();else if(!y&&this._multiple&&s===65&&e.ctrlKey){e.preventDefault();let A=this.options.some(P=>!P.disabled&&!P.selected);this.options.forEach(P=>{P.disabled||(A?P.select():P.deselect())})}else{let A=n.activeItemIndex;n.onKeydown(e),this._multiple&&r&&e.shiftKey&&n.activeItem&&n.activeItemIndex!==A&&n.activeItem._selectViaInteraction()}}_handleOverlayKeydown(e){e.keyCode===27&&!Mo(e)&&(e.preventDefault(),this.close())}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this._keyManager?.cancelTypeahead(),!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(e){if(this.options.forEach(n=>n.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&e)Array.isArray(e),e.forEach(n=>this._selectOptionByValue(n)),this._sortValues();else{let n=this._selectOptionByValue(e);n?this._keyManager.updateActiveItem(n):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(e){let n=this.options.find(s=>{if(this._selectionModel.isSelected(s))return!1;try{return(s.value!=null||this.canSelectNullableOptions)&&this._compareWith(s.value,e)}catch{return!1}});return n&&this._selectionModel.select(n),n}_assignValue(e){return e!==this._value||this._multiple&&Array.isArray(e)?(this.options&&this._setSelectionByValue(e),this._value=e,!0):!1}_skipPredicate=e=>this.panelOpen?!1:e.disabled;_getOverlayWidth(e){return this.panelWidth==="auto"?(e instanceof py?e.elementRef:e||this._elementRef).nativeElement.getBoundingClientRect().width:this.panelWidth===null?"":this.panelWidth}_syncParentProperties(){if(this.options)for(let e of this.options)e._changeDetectorRef.markForCheck()}_initKeyManager(){this._keyManager=new mx(this.options).withTypeAhead(this.typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withPageUpDown().withAllowedModifierKeys(["shiftKey"]).skipPredicate(this._skipPredicate),this._keyManager.tabOut.subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){let e=Ba(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(Un(e)).subscribe(n=>{this._onSelect(n.source,n.isUserInput),n.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),Ba(...this.options.map(n=>n._stateChanges)).pipe(Un(e)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this.stateChanges.next()})}_onSelect(e,n){let s=this._selectionModel.isSelected(e);!this.canSelectNullableOptions&&e.value==null&&!this._multiple?(e.deselect(),this._selectionModel.clear(),this.value!=null&&this._propagateChanges(e.value)):(s!==e.selected&&(e.selected?this._selectionModel.select(e):this._selectionModel.deselect(e)),n&&this._keyManager.setActiveItem(e),this.multiple&&(this._sortValues(),n&&this.focus())),s!==this._selectionModel.isSelected(e)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){let e=this.options.toArray();this._selectionModel.sort((n,s)=>this.sortComparator?this.sortComparator(n,s,e):e.indexOf(n)-e.indexOf(s)),this.stateChanges.next()}}_propagateChanges(e){let n;this.multiple?n=this.selected.map(s=>s.value):n=this.selected?this.selected.value:e,this._value=n,this.valueChange.emit(n),this._onChange(n),this.selectionChange.emit(this._getChangeEvent(n)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){if(this._keyManager)if(this.empty){let e=-1;for(let n=0;n<this.options.length;n++)if(!this.options.get(n).disabled){e=n;break}this._keyManager.setActiveItem(e)}else this._keyManager.setActiveItem(this._selectionModel.selected[0])}_canOpen(){return!this._panelOpen&&!this.disabled&&this.options?.length>0&&!!this._overlayDir}focus(e){this._elementRef.nativeElement.focus(e)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;let e=this._parentFormField?.getLabelId()||null,n=e?e+" ":"";return this.ariaLabelledby?n+this.ariaLabelledby:e}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;let e=this._parentFormField?.getLabelId()||"";return this.ariaLabelledby&&(e+=" "+this.ariaLabelledby),e||(e=this._valueId),e}setDescribedByIds(e){e.length?this._elementRef.nativeElement.setAttribute("aria-describedby",e.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this.panelOpen||!this.empty||this.focused&&!!this.placeholder}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-select"]],contentQueries:function(n,s,r){if(n&1&&(Mr(r,H6,5),Mr(r,ed,5),Mr(r,OP,5)),n&2){let y;Bi(y=Vi())&&(s.customTrigger=y.first),Bi(y=Vi())&&(s.options=y),Bi(y=Vi())&&(s.optionGroups=y)}},viewQuery:function(n,s){if(n&1&&(Bn(nre,5),Bn(rre,5),Bn(YS,5)),n&2){let r;Bi(r=Vi())&&(s.trigger=r.first),Bi(r=Vi())&&(s.panel=r.first),Bi(r=Vi())&&(s._overlayDir=r.first)}},hostAttrs:["role","combobox","aria-haspopup","listbox",1,"mat-mdc-select"],hostVars:19,hostBindings:function(n,s){n&1&&_t("keydown",function(y){return s._handleKeydown(y)})("focus",function(){return s._onFocus()})("blur",function(){return s._onBlur()}),n&2&&(ji("id",s.id)("tabindex",s.disabled?-1:s.tabIndex)("aria-controls",s.panelOpen?s.id+"-panel":null)("aria-expanded",s.panelOpen)("aria-label",s.ariaLabel||null)("aria-required",s.required.toString())("aria-disabled",s.disabled.toString())("aria-invalid",s.errorState)("aria-activedescendant",s._getAriaActiveDescendant()),Ai("mat-mdc-select-disabled",s.disabled)("mat-mdc-select-invalid",s.errorState)("mat-mdc-select-required",s.required)("mat-mdc-select-empty",s.empty)("mat-mdc-select-multiple",s.multiple))},inputs:{userAriaDescribedBy:[0,"aria-describedby","userAriaDescribedBy"],panelClass:"panelClass",disabled:[2,"disabled","disabled",xi],disableRipple:[2,"disableRipple","disableRipple",xi],tabIndex:[2,"tabIndex","tabIndex",e=>e==null?0:Aa(e)],hideSingleSelectionIndicator:[2,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",xi],placeholder:"placeholder",required:[2,"required","required",xi],multiple:[2,"multiple","multiple",xi],disableOptionCentering:[2,"disableOptionCentering","disableOptionCentering",xi],compareWith:"compareWith",value:"value",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:[2,"typeaheadDebounceInterval","typeaheadDebounceInterval",Aa],sortComparator:"sortComparator",id:"id",panelWidth:"panelWidth",canSelectNullableOptions:[2,"canSelectNullableOptions","canSelectNullableOptions",xi]},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},exportAs:["matSelect"],features:[Vn([{provide:zm,useExisting:i},{provide:PP,useExisting:i}]),fr],ngContentSelectors:are,decls:11,vars:9,consts:[["fallbackOverlayOrigin","cdkOverlayOrigin","trigger",""],["panel",""],["cdk-overlay-origin","",1,"mat-mdc-select-trigger",3,"click"],[1,"mat-mdc-select-value"],[1,"mat-mdc-select-placeholder","mat-mdc-select-min-line"],[1,"mat-mdc-select-value-text"],[1,"mat-mdc-select-arrow-wrapper"],[1,"mat-mdc-select-arrow"],["viewBox","0 0 24 24","width","24px","height","24px","focusable","false","aria-hidden","true"],["d","M7 10l5 5 5-5z"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"detach","backdropClick","overlayKeydown","cdkConnectedOverlayDisableClose","cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayPositions","cdkConnectedOverlayWidth","cdkConnectedOverlayFlexibleDimensions"],[1,"mat-mdc-select-min-line"],["role","listbox","tabindex","-1",3,"keydown","ngClass"]],template:function(n,s){if(n&1){let r=bi();xr(ore),oe(0,"div",2,0),_t("click",function(){return qt(r),Wt(s.open())}),oe(3,"div",3),pt(4,sre,2,1,"span",4)(5,dre,3,1,"span",5),ae(),oe(6,"div",6)(7,"div",7),Da(),oe(8,"svg",8),Et(9,"path",9),ae()()()(),pt(10,ure,3,10,"ng-template",10),_t("detach",function(){return qt(r),Wt(s.close())})("backdropClick",function(){return qt(r),Wt(s.close())})("overlayKeydown",function(A){return qt(r),Wt(s._handleOverlayKeydown(A))})}if(n&2){let r=No(1);ge(3),ji("id",s._valueId),ge(),un(s.empty?4:5),ge(6),Be("cdkConnectedOverlayDisableClose",!0)("cdkConnectedOverlayPanelClass",s._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",s._scrollStrategy)("cdkConnectedOverlayOrigin",s._preferredOverlayOrigin||r)("cdkConnectedOverlayPositions",s._positions)("cdkConnectedOverlayWidth",s._overlayWidth)("cdkConnectedOverlayFlexibleDimensions",!0)}},dependencies:[py,YS,qa],styles:[`@keyframes _mat-select-enter{from{opacity:0;transform:scaleY(0.8)}to{opacity:1;transform:none}}@keyframes _mat-select-exit{from{opacity:1}to{opacity:0}}.mat-mdc-select{display:inline-block;width:100%;outline:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-select-enabled-trigger-text-color, var(--mat-sys-on-surface));font-family:var(--mat-select-trigger-text-font, var(--mat-sys-body-large-font));line-height:var(--mat-select-trigger-text-line-height, var(--mat-sys-body-large-line-height));font-size:var(--mat-select-trigger-text-size, var(--mat-sys-body-large-size));font-weight:var(--mat-select-trigger-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mat-select-trigger-text-tracking, var(--mat-sys-body-large-tracking))}div.mat-mdc-select-panel{box-shadow:var(--mat-select-container-elevation-shadow, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-select-disabled{color:var(--mat-select-disabled-trigger-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-select-disabled .mat-mdc-select-placeholder{color:var(--mat-select-disabled-trigger-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-mdc-select-disabled .mat-mdc-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-mdc-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-mdc-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-mdc-select-arrow-wrapper{height:24px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mdc-text-field--no-label .mat-mdc-select-arrow-wrapper{transform:none}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-invalid .mat-mdc-select-arrow,.mat-form-field-invalid:not(.mat-form-field-disabled) .mat-mdc-form-field-infix::after{color:var(--mat-select-invalid-arrow-color, var(--mat-sys-error))}.mat-mdc-select-arrow{width:10px;height:5px;position:relative;color:var(--mat-select-enabled-arrow-color, var(--mat-sys-on-surface-variant))}.mat-mdc-form-field.mat-focused .mat-mdc-select-arrow{color:var(--mat-select-focused-arrow-color, var(--mat-sys-primary))}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-disabled .mat-mdc-select-arrow{color:var(--mat-select-disabled-arrow-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-select-arrow svg{fill:currentColor;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}@media(forced-colors: active){.mat-mdc-select-arrow svg{fill:CanvasText}.mat-mdc-select-disabled .mat-mdc-select-arrow svg{fill:GrayText}}div.mat-mdc-select-panel{width:100%;max-height:275px;outline:0;overflow:auto;padding:8px 0;border-radius:4px;box-sizing:border-box;position:static;background-color:var(--mat-select-panel-background-color, var(--mat-sys-surface-container))}@media(forced-colors: active){div.mat-mdc-select-panel{outline:solid 1px}}.cdk-overlay-pane:not(.mat-mdc-select-panel-above) div.mat-mdc-select-panel{border-top-left-radius:0;border-top-right-radius:0;transform-origin:top center}.mat-mdc-select-panel-above div.mat-mdc-select-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:bottom center}div.mat-mdc-select-panel .mat-mdc-option{--mdc-list-list-item-container-color: var(--mat-select-panel-background-color)}.mat-select-panel-animations-enabled{animation:_mat-select-enter 120ms cubic-bezier(0, 0, 0.2, 1)}.mat-select-panel-animations-enabled.mat-select-panel-exit{animation:_mat-select-exit 100ms linear}.mat-mdc-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1);color:var(--mat-select-placeholder-text-color, var(--mat-sys-on-surface-variant))}.mat-mdc-form-field:not(.mat-form-field-animations-enabled) .mat-mdc-select-placeholder,._mat-animation-noopable .mat-mdc-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-mdc-select-placeholder{color:rgba(0,0,0,0);-webkit-text-fill-color:rgba(0,0,0,0);transition:none;display:block}.mat-mdc-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper{cursor:pointer}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mat-mdc-floating-label{max-width:calc(100% - 18px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 24px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-text-field--label-floating .mdc-notched-outline__notch{max-width:calc(100% - 24px)}.mat-mdc-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;visibility:hidden}.mat-form-field-appearance-fill .mat-mdc-select-arrow-wrapper{transform:var(--mat-select-arrow-transform, translateY(-8px))}
`],encapsulation:2,changeDetection:0})}return i})();var td=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({providers:[U6],imports:[Jl,FP,An,Nu,us,FP,An]})}return i})();var hre=["tooltip"],q6=20;var W6=new Dt("mat-tooltip-scroll-strategy",{providedIn:"root",factory:()=>{let i=Z(bo);return()=>i.scrollStrategies.reposition({scrollThrottle:q6})}});function pre(i){return()=>i.scrollStrategies.reposition({scrollThrottle:q6})}var fre={provide:W6,deps:[bo],useFactory:pre};function mre(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}var gre=new Dt("mat-tooltip-default-options",{providedIn:"root",factory:mre});var $6="tooltip-panel",G6=_p({passive:!0}),_re=8,yre=8,vre=24,bre=200,Y6=(()=>{class i{_elementRef=Z(Ii);_ngZone=Z(ki);_platform=Z(or);_ariaDescriber=Z(nU);_focusMonitor=Z(Kl);_dir=Z(vo);_injector=Z(vn);_viewContainerRef=Z(yo);_defaultOptions=Z(gre,{optional:!0});_overlayRef;_tooltipInstance;_portal;_position="below";_positionAtOrigin=!1;_disabled=!1;_tooltipClass;_viewInitialized=!1;_pointerExitEventsInitialized=!1;_tooltipComponent=xre;_viewportMargin=8;_currentPosition;_cssClassPrefix="mat-mdc";_ariaDescriptionPending;_dirSubscribed=!1;get position(){return this._position}set position(e){e!==this._position&&(this._position=e,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(e){this._positionAtOrigin=Tl(e),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(e){let n=Tl(e);this._disabled!==n&&(this._disabled=n,n?this.hide(0):this._setupPointerEnterEventsIfNeeded(),this._syncAriaDescription(this.message))}get showDelay(){return this._showDelay}set showDelay(e){this._showDelay=Lu(e)}_showDelay;get hideDelay(){return this._hideDelay}set hideDelay(e){this._hideDelay=Lu(e),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}_hideDelay;touchGestures="auto";get message(){return this._message}set message(e){let n=this._message;this._message=e!=null?String(e).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage()),this._syncAriaDescription(n)}_message="";get tooltipClass(){return this._tooltipClass}set tooltipClass(e){this._tooltipClass=e,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}_passiveListeners=[];_touchstartTimeout=null;_destroyed=new ni;_isDestroyed=!1;constructor(){let e=this._defaultOptions;e&&(this._showDelay=e.showDelay,this._hideDelay=e.hideDelay,e.position&&(this.position=e.position),e.positionAtOrigin&&(this.positionAtOrigin=e.positionAtOrigin),e.touchGestures&&(this.touchGestures=e.touchGestures),e.tooltipClass&&(this.tooltipClass=e.tooltipClass)),this._viewportMargin=_re}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(Un(this._destroyed)).subscribe(e=>{e?e==="keyboard"&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){let e=this._elementRef.nativeElement;this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([n,s])=>{e.removeEventListener(n,s,G6)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._isDestroyed=!0,this._ariaDescriber.removeDescription(e,this.message,"tooltip"),this._focusMonitor.stopMonitoring(e)}show(e=this.showDelay,n){if(this.disabled||!this.message||this._isTooltipVisible()){this._tooltipInstance?._cancelPendingAnimations();return}let s=this._createOverlay(n);this._detach(),this._portal=this._portal||new Is(this._tooltipComponent,this._viewContainerRef);let r=this._tooltipInstance=s.attach(this._portal).instance;r._triggerElement=this._elementRef.nativeElement,r._mouseLeaveHideDelay=this._hideDelay,r.afterHidden().pipe(Un(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),r.show(e)}hide(e=this.hideDelay){let n=this._tooltipInstance;n&&(n.isVisible()?n.hide(e):(n._cancelPendingAnimations(),this._detach()))}toggle(e){this._isTooltipVisible()?this.hide():this.show(void 0,e)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(e){if(this._overlayRef){let y=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!e)&&y._origin instanceof Ii)return this._overlayRef;this._detach()}let n=this._injector.get(uy).getAncestorScrollContainers(this._elementRef),s=this._injector.get(bo),r=s.position().flexibleConnectedTo(this.positionAtOrigin?e||this._elementRef:this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(n);return r.positionChanges.pipe(Un(this._destroyed)).subscribe(y=>{this._updateCurrentPositionClass(y.connectionPair),this._tooltipInstance&&y.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=s.create({direction:this._dir,positionStrategy:r,panelClass:`${this._cssClassPrefix}-${$6}`,scrollStrategy:this._injector.get(W6)()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(Un(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(Un(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(Un(this._destroyed)).subscribe(y=>{this._isTooltipVisible()&&y.keyCode===27&&!Mo(y)&&(y.preventDefault(),y.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._dirSubscribed||(this._dirSubscribed=!0,this._dir.change.pipe(Un(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)})),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(e){let n=e.getConfig().positionStrategy,s=this._getOrigin(),r=this._getOverlayPosition();n.withPositions([this._addOffset(Ct(Ct({},s.main),r.main)),this._addOffset(Ct(Ct({},s.fallback),r.fallback))])}_addOffset(e){let n=yre,s=!this._dir||this._dir.value=="ltr";return e.originY==="top"?e.offsetY=-8:e.originY==="bottom"?e.offsetY=n:e.originX==="start"?e.offsetX=s?-8:n:e.originX==="end"&&(e.offsetX=s?n:-8),e}_getOrigin(){let e=!this._dir||this._dir.value=="ltr",n=this.position,s;n=="above"||n=="below"?s={originX:"center",originY:n=="above"?"top":"bottom"}:n=="before"||n=="left"&&e||n=="right"&&!e?s={originX:"start",originY:"center"}:(n=="after"||n=="right"&&e||n=="left"&&!e)&&(s={originX:"end",originY:"center"});let{x:r,y}=this._invertPosition(s.originX,s.originY);return{main:s,fallback:{originX:r,originY:y}}}_getOverlayPosition(){let e=!this._dir||this._dir.value=="ltr",n=this.position,s;n=="above"?s={overlayX:"center",overlayY:"bottom"}:n=="below"?s={overlayX:"center",overlayY:"top"}:n=="before"||n=="left"&&e||n=="right"&&!e?s={overlayX:"end",overlayY:"center"}:(n=="after"||n=="right"&&e||n=="left"&&!e)&&(s={overlayX:"start",overlayY:"center"});let{x:r,y}=this._invertPosition(s.overlayX,s.overlayY);return{main:s,fallback:{overlayX:r,overlayY:y}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),Ma(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()},{injector:this._injector}))}_setTooltipClass(e){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=e,this._tooltipInstance._markForCheck())}_invertPosition(e,n){return this.position==="above"||this.position==="below"?n==="top"?n="bottom":n==="bottom"&&(n="top"):e==="end"?e="start":e==="start"&&(e="end"),{x:e,y:n}}_updateCurrentPositionClass(e){let{overlayY:n,originX:s,originY:r}=e,y;if(n==="center"?this._dir&&this._dir.value==="rtl"?y=s==="end"?"left":"right":y=s==="start"?"left":"right":y=n==="bottom"&&r==="top"?"above":"below",y!==this._currentPosition){let A=this._overlayRef;if(A){let P=`${this._cssClassPrefix}-${$6}-`;A.removePanelClass(P+this._currentPosition),A.addPanelClass(P+y)}this._currentPosition=y}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",e=>{this._setupPointerExitEventsIfNeeded();let n;e.x!==void 0&&e.y!==void 0&&(n=e),this.show(void 0,n)}]):this.touchGestures!=="off"&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",e=>{let n=e.targetTouches?.[0],s=n?{x:n.clientX,y:n.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),this._touchstartTimeout&&clearTimeout(this._touchstartTimeout);let r=500;this._touchstartTimeout=setTimeout(()=>{this._touchstartTimeout=null,this.show(void 0,s)},this._defaultOptions?.touchLongPressShowDelay??r)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;let e=[];if(this._platformSupportsMouseEvents())e.push(["mouseleave",n=>{let s=n.relatedTarget;(!s||!this._overlayRef?.overlayElement.contains(s))&&this.hide()}],["wheel",n=>this._wheelListener(n)]);else if(this.touchGestures!=="off"){this._disableNativeGesturesIfNecessary();let n=()=>{this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions?.touchendHideDelay)};e.push(["touchend",n],["touchcancel",n])}this._addListeners(e),this._passiveListeners.push(...e)}_addListeners(e){e.forEach(([n,s])=>{this._elementRef.nativeElement.addEventListener(n,s,G6)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(e){if(this._isTooltipVisible()){let n=this._injector.get(Ki).elementFromPoint(e.clientX,e.clientY),s=this._elementRef.nativeElement;n!==s&&!s.contains(n)&&this.hide()}}_disableNativeGesturesIfNecessary(){let e=this.touchGestures;if(e!=="off"){let n=this._elementRef.nativeElement,s=n.style;(e==="on"||n.nodeName!=="INPUT"&&n.nodeName!=="TEXTAREA")&&(s.userSelect=s.msUserSelect=s.webkitUserSelect=s.MozUserSelect="none"),(e==="on"||!n.draggable)&&(s.webkitUserDrag="none"),s.touchAction="none",s.webkitTapHighlightColor="transparent"}}_syncAriaDescription(e){this._ariaDescriptionPending||(this._ariaDescriptionPending=!0,this._ariaDescriber.removeDescription(this._elementRef.nativeElement,e,"tooltip"),this._isDestroyed||Ma({write:()=>{this._ariaDescriptionPending=!1,this.message&&!this.disabled&&this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")}},{injector:this._injector}))}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],hostVars:2,hostBindings:function(n,s){n&2&&Ai("mat-mdc-tooltip-disabled",s.disabled)},inputs:{position:[0,"matTooltipPosition","position"],positionAtOrigin:[0,"matTooltipPositionAtOrigin","positionAtOrigin"],disabled:[0,"matTooltipDisabled","disabled"],showDelay:[0,"matTooltipShowDelay","showDelay"],hideDelay:[0,"matTooltipHideDelay","hideDelay"],touchGestures:[0,"matTooltipTouchGestures","touchGestures"],message:[0,"matTooltip","message"],tooltipClass:[0,"matTooltipClass","tooltipClass"]},exportAs:["matTooltip"]})}return i})(),xre=(()=>{class i{_changeDetectorRef=Z($n);_elementRef=Z(Ii);_isMultiline=!1;message;tooltipClass;_showTimeoutId;_hideTimeoutId;_triggerElement;_mouseLeaveHideDelay;_animationsDisabled;_tooltip;_closeOnInteraction=!1;_isVisible=!1;_onHide=new ni;_showAnimation="mat-mdc-tooltip-show";_hideAnimation="mat-mdc-tooltip-hide";constructor(){let e=Z(Vr,{optional:!0});this._animationsDisabled=e==="NoopAnimations"}show(e){this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},e)}hide(e){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},e)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:e}){(!e||!this._triggerElement.contains(e))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){let e=this._elementRef.nativeElement.getBoundingClientRect();return e.height>vre&&e.width>=bre}_handleAnimationEnd({animationName:e}){(e===this._showAnimation||e===this._hideAnimation)&&this._finalizeAnimation(e===this._showAnimation)}_cancelPendingAnimations(){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(e){e?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(e){let n=this._tooltip.nativeElement,s=this._showAnimation,r=this._hideAnimation;if(n.classList.remove(e?r:s),n.classList.add(e?s:r),this._isVisible!==e&&(this._isVisible=e,this._changeDetectorRef.markForCheck()),e&&!this._animationsDisabled&&typeof getComputedStyle=="function"){let y=getComputedStyle(n);(y.getPropertyValue("animation-duration")==="0s"||y.getPropertyValue("animation-name")==="none")&&(this._animationsDisabled=!0)}e&&this._onShow(),this._animationsDisabled&&(n.classList.add("_mat-animation-noopable"),this._finalizeAnimation(e))}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-tooltip-component"]],viewQuery:function(n,s){if(n&1&&Bn(hre,7),n&2){let r;Bi(r=Vi())&&(s._tooltip=r.first)}},hostAttrs:["aria-hidden","true"],hostBindings:function(n,s){n&1&&_t("mouseleave",function(y){return s._handleMouseLeave(y)})},decls:4,vars:4,consts:[["tooltip",""],[1,"mdc-tooltip","mat-mdc-tooltip",3,"animationend","ngClass"],[1,"mat-mdc-tooltip-surface","mdc-tooltip__surface"]],template:function(n,s){if(n&1){let r=bi();oe(0,"div",1,0),_t("animationend",function(A){return qt(r),Wt(s._handleAnimationEnd(A))}),oe(2,"div",2),Ee(3),ae()()}n&2&&(Ai("mdc-tooltip--multiline",s._isMultiline),Be("ngClass",s.tooltipClass),ge(3),tn(s.message))},dependencies:[qa],styles:[`.mat-mdc-tooltip{position:relative;transform:scale(0);display:inline-flex}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-surface{word-break:normal;overflow-wrap:anywhere;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center;will-change:transform,opacity;background-color:var(--mdc-plain-tooltip-container-color, var(--mat-sys-inverse-surface));color:var(--mdc-plain-tooltip-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mdc-plain-tooltip-container-shape, var(--mat-sys-corner-extra-small));font-family:var(--mdc-plain-tooltip-supporting-text-font, var(--mat-sys-body-small-font));font-size:var(--mdc-plain-tooltip-supporting-text-size, var(--mat-sys-body-small-size));font-weight:var(--mdc-plain-tooltip-supporting-text-weight, var(--mat-sys-body-small-weight));line-height:var(--mdc-plain-tooltip-supporting-text-line-height, var(--mat-sys-body-small-line-height));letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking, var(--mat-sys-body-small-tracking))}.mat-mdc-tooltip-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:right}.mat-mdc-tooltip-panel{line-height:normal}.mat-mdc-tooltip-panel.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}
`],encapsulation:2,changeDetection:0})}return i})(),Z6=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({providers:[fre],imports:[Dm,Jl,An,An,Nu]})}return i})();function wre(i,t){if(i&1&&(oe(0,"mat-option",17),Ee(1),ae()),i&2){let e=t.$implicit;Be("value",e),ge(),zi(" ",e," ")}}function Cre(i,t){if(i&1){let e=bi();oe(0,"mat-form-field",14)(1,"mat-select",16,0),_t("selectionChange",function(s){qt(e);let r=bt(2);return Wt(r._changePageSize(s.value))}),U_(3,wre,2,2,"mat-option",17,u4),ae(),oe(5,"div",18),_t("click",function(){qt(e);let s=No(2);return Wt(s.open())}),ae()()}if(i&2){let e=bt(2);Be("appearance",e._formFieldAppearance)("color",e.color),ge(),Be("value",e.pageSize)("disabled",e.disabled)("aria-labelledby",e._pageSizeLabelId)("panelClass",e.selectConfig.panelClass||"")("disableOptionCentering",e.selectConfig.disableOptionCentering),ge(2),H_(e._displayedPageSizeOptions)}}function Ere(i,t){if(i&1&&(oe(0,"div",15),Ee(1),ae()),i&2){let e=bt(2);ge(),tn(e.pageSize)}}function Sre(i,t){if(i&1&&(oe(0,"div",3)(1,"div",13),Ee(2),ae(),pt(3,Cre,6,7,"mat-form-field",14)(4,Ere,2,1,"div",15),ae()),i&2){let e=bt();ge(),ji("id",e._pageSizeLabelId),ge(),zi(" ",e._intl.itemsPerPageLabel," "),ge(),un(e._displayedPageSizeOptions.length>1?3:-1),ge(),un(e._displayedPageSizeOptions.length<=1?4:-1)}}function Dre(i,t){if(i&1){let e=bi();oe(0,"button",19),_t("click",function(){qt(e);let s=bt();return Wt(s._buttonClicked(0,s._previousButtonsDisabled()))}),Da(),oe(1,"svg",8),Et(2,"path",20),ae()()}if(i&2){let e=bt();Be("matTooltip",e._intl.firstPageLabel)("matTooltipDisabled",e._previousButtonsDisabled())("disabled",e._previousButtonsDisabled())("tabindex",e._previousButtonsDisabled()?-1:null),ji("aria-label",e._intl.firstPageLabel)}}function Mre(i,t){if(i&1){let e=bi();oe(0,"button",21),_t("click",function(){qt(e);let s=bt();return Wt(s._buttonClicked(s.getNumberOfPages()-1,s._nextButtonsDisabled()))}),Da(),oe(1,"svg",8),Et(2,"path",22),ae()()}if(i&2){let e=bt();Be("matTooltip",e._intl.lastPageLabel)("matTooltipDisabled",e._nextButtonsDisabled())("disabled",e._nextButtonsDisabled())("tabindex",e._nextButtonsDisabled()?-1:null),ji("aria-label",e._intl.lastPageLabel)}}var qD=(()=>{class i{changes=new ni;itemsPerPageLabel="Items per page:";nextPageLabel="Next page";previousPageLabel="Previous page";firstPageLabel="First page";lastPageLabel="Last page";getRangeLabel=(e,n,s)=>{if(s==0||n==0)return`0 of ${s}`;s=Math.max(s,0);let r=e*n,y=r<s?Math.min(r+n,s):r+n;return`${r+1} \u2013 ${y} of ${s}`};static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Tre(i){return i||new qD}var Ire={provide:qD,deps:[[new tp,new R_,qD]],useFactory:Tre},Are=50;var Rre=new Dt("MAT_PAGINATOR_DEFAULT_OPTIONS"),Bm=(()=>{class i{_intl=Z(qD);_changeDetectorRef=Z($n);_formFieldAppearance;_pageSizeLabelId=Z(kr).getId("mat-paginator-page-size-label-");_intlChanges;_isInitialized=!1;_initializedStream=new qf(1);color;get pageIndex(){return this._pageIndex}set pageIndex(e){this._pageIndex=Math.max(e||0,0),this._changeDetectorRef.markForCheck()}_pageIndex=0;get length(){return this._length}set length(e){this._length=e||0,this._changeDetectorRef.markForCheck()}_length=0;get pageSize(){return this._pageSize}set pageSize(e){this._pageSize=Math.max(e||0,0),this._updateDisplayedPageSizeOptions()}_pageSize;get pageSizeOptions(){return this._pageSizeOptions}set pageSizeOptions(e){this._pageSizeOptions=(e||[]).map(n=>Aa(n,0)),this._updateDisplayedPageSizeOptions()}_pageSizeOptions=[];hidePageSize=!1;showFirstLastButtons=!1;selectConfig={};disabled=!1;page=new ui;_displayedPageSizeOptions;initialized=this._initializedStream;constructor(){let e=this._intl,n=Z(Rre,{optional:!0});if(this._intlChanges=e.changes.subscribe(()=>this._changeDetectorRef.markForCheck()),n){let{pageSize:s,pageSizeOptions:r,hidePageSize:y,showFirstLastButtons:A}=n;s!=null&&(this._pageSize=s),r!=null&&(this._pageSizeOptions=r),y!=null&&(this.hidePageSize=y),A!=null&&(this.showFirstLastButtons=A)}this._formFieldAppearance=n?.formFieldAppearance||"outline"}ngOnInit(){this._isInitialized=!0,this._updateDisplayedPageSizeOptions(),this._initializedStream.next()}ngOnDestroy(){this._initializedStream.complete(),this._intlChanges.unsubscribe()}nextPage(){this.hasNextPage()&&this._navigate(this.pageIndex+1)}previousPage(){this.hasPreviousPage()&&this._navigate(this.pageIndex-1)}firstPage(){this.hasPreviousPage()&&this._navigate(0)}lastPage(){this.hasNextPage()&&this._navigate(this.getNumberOfPages()-1)}hasPreviousPage(){return this.pageIndex>=1&&this.pageSize!=0}hasNextPage(){let e=this.getNumberOfPages()-1;return this.pageIndex<e&&this.pageSize!=0}getNumberOfPages(){return this.pageSize?Math.ceil(this.length/this.pageSize):0}_changePageSize(e){let n=this.pageIndex*this.pageSize,s=this.pageIndex;this.pageIndex=Math.floor(n/e)||0,this.pageSize=e,this._emitPageEvent(s)}_nextButtonsDisabled(){return this.disabled||!this.hasNextPage()}_previousButtonsDisabled(){return this.disabled||!this.hasPreviousPage()}_updateDisplayedPageSizeOptions(){this._isInitialized&&(this.pageSize||(this._pageSize=this.pageSizeOptions.length!=0?this.pageSizeOptions[0]:Are),this._displayedPageSizeOptions=this.pageSizeOptions.slice(),this._displayedPageSizeOptions.indexOf(this.pageSize)===-1&&this._displayedPageSizeOptions.push(this.pageSize),this._displayedPageSizeOptions.sort((e,n)=>e-n),this._changeDetectorRef.markForCheck())}_emitPageEvent(e){this.page.emit({previousPageIndex:e,pageIndex:this.pageIndex,pageSize:this.pageSize,length:this.length})}_navigate(e){let n=this.pageIndex;e!==n&&(this.pageIndex=e,this._emitPageEvent(n))}_buttonClicked(e,n){n||this._navigate(e)}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-paginator"]],hostAttrs:["role","group",1,"mat-mdc-paginator"],inputs:{color:"color",pageIndex:[2,"pageIndex","pageIndex",Aa],length:[2,"length","length",Aa],pageSize:[2,"pageSize","pageSize",Aa],pageSizeOptions:"pageSizeOptions",hidePageSize:[2,"hidePageSize","hidePageSize",xi],showFirstLastButtons:[2,"showFirstLastButtons","showFirstLastButtons",xi],selectConfig:"selectConfig",disabled:[2,"disabled","disabled",xi]},outputs:{page:"page"},exportAs:["matPaginator"],decls:14,vars:14,consts:[["selectRef",""],[1,"mat-mdc-paginator-outer-container"],[1,"mat-mdc-paginator-container"],[1,"mat-mdc-paginator-page-size"],[1,"mat-mdc-paginator-range-actions"],["aria-live","polite",1,"mat-mdc-paginator-range-label"],["mat-icon-button","","type","button","matTooltipPosition","above","disabledInteractive","",1,"mat-mdc-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","disabled","tabindex"],["mat-icon-button","","type","button","matTooltipPosition","above","disabledInteractive","",1,"mat-mdc-paginator-navigation-previous",3,"click","matTooltip","matTooltipDisabled","disabled","tabindex"],["viewBox","0 0 24 24","focusable","false","aria-hidden","true",1,"mat-mdc-paginator-icon"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button","matTooltipPosition","above","disabledInteractive","",1,"mat-mdc-paginator-navigation-next",3,"click","matTooltip","matTooltipDisabled","disabled","tabindex"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["mat-icon-button","","type","button","matTooltipPosition","above","disabledInteractive","",1,"mat-mdc-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","disabled","tabindex"],[1,"mat-mdc-paginator-page-size-label"],[1,"mat-mdc-paginator-page-size-select",3,"appearance","color"],[1,"mat-mdc-paginator-page-size-value"],["hideSingleSelectionIndicator","",3,"selectionChange","value","disabled","aria-labelledby","panelClass","disableOptionCentering"],[3,"value"],[1,"mat-mdc-paginator-touch-target",3,"click"],["mat-icon-button","","type","button","matTooltipPosition","above","disabledInteractive","",1,"mat-mdc-paginator-navigation-first",3,"click","matTooltip","matTooltipDisabled","disabled","tabindex"],["d","M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"],["mat-icon-button","","type","button","matTooltipPosition","above","disabledInteractive","",1,"mat-mdc-paginator-navigation-last",3,"click","matTooltip","matTooltipDisabled","disabled","tabindex"],["d","M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"]],template:function(n,s){n&1&&(oe(0,"div",1)(1,"div",2),pt(2,Sre,5,4,"div",3),oe(3,"div",4)(4,"div",5),Ee(5),ae(),pt(6,Dre,3,5,"button",6),oe(7,"button",7),_t("click",function(){return s._buttonClicked(s.pageIndex-1,s._previousButtonsDisabled())}),Da(),oe(8,"svg",8),Et(9,"path",9),ae()(),hm(),oe(10,"button",10),_t("click",function(){return s._buttonClicked(s.pageIndex+1,s._nextButtonsDisabled())}),Da(),oe(11,"svg",8),Et(12,"path",11),ae()(),pt(13,Mre,3,5,"button",12),ae()()()),n&2&&(ge(2),un(s.hidePageSize?-1:2),ge(3),zi(" ",s._intl.getRangeLabel(s.pageIndex,s.pageSize,s.length)," "),ge(),un(s.showFirstLastButtons?6:-1),ge(),Be("matTooltip",s._intl.previousPageLabel)("matTooltipDisabled",s._previousButtonsDisabled())("disabled",s._previousButtonsDisabled())("tabindex",s._previousButtonsDisabled()?-1:null),ji("aria-label",s._intl.previousPageLabel),ge(3),Be("matTooltip",s._intl.nextPageLabel)("matTooltipDisabled",s._nextButtonsDisabled())("disabled",s._nextButtonsDisabled())("tabindex",s._nextButtonsDisabled()?-1:null),ji("aria-label",s._intl.nextPageLabel),ge(3),un(s.showFirstLastButtons?13:-1))},dependencies:[kl,Uu,ed,ds,Y6],styles:[`.mat-mdc-paginator{display:block;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-paginator-container-text-color, var(--mat-sys-on-surface));background-color:var(--mat-paginator-container-background-color, var(--mat-sys-surface));font-family:var(--mat-paginator-container-text-font, var(--mat-sys-body-small-font));line-height:var(--mat-paginator-container-text-line-height, var(--mat-sys-body-small-line-height));font-size:var(--mat-paginator-container-text-size, var(--mat-sys-body-small-size));font-weight:var(--mat-paginator-container-text-weight, var(--mat-sys-body-small-weight));letter-spacing:var(--mat-paginator-container-text-tracking, var(--mat-sys-body-small-tracking));--mat-form-field-container-height:var(--mat-paginator-form-field-container-height, 40px);--mat-form-field-container-vertical-padding:var(--mat-paginator-form-field-container-vertical-padding, 8px)}.mat-mdc-paginator .mat-mdc-select-value{font-size:var(--mat-paginator-select-trigger-text-size, var(--mat-sys-body-small-size))}.mat-mdc-paginator .mat-mdc-form-field-subscript-wrapper{display:none}.mat-mdc-paginator .mat-mdc-select{line-height:1.5}.mat-mdc-paginator-outer-container{display:flex}.mat-mdc-paginator-container{display:flex;align-items:center;justify-content:flex-end;padding:0 8px;flex-wrap:wrap;width:100%;min-height:var(--mat-paginator-container-size, 56px)}.mat-mdc-paginator-page-size{display:flex;align-items:baseline;margin-right:8px}[dir=rtl] .mat-mdc-paginator-page-size{margin-right:0;margin-left:8px}.mat-mdc-paginator-page-size-label{margin:0 4px}.mat-mdc-paginator-page-size-select{margin:0 4px;width:84px}.mat-mdc-paginator-range-label{margin:0 32px 0 24px}.mat-mdc-paginator-range-actions{display:flex;align-items:center}.mat-mdc-paginator-icon{display:inline-block;width:28px;fill:var(--mat-paginator-enabled-icon-color, var(--mat-sys-on-surface-variant))}.mat-mdc-icon-button[aria-disabled] .mat-mdc-paginator-icon{fill:var(--mat-paginator-disabled-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}[dir=rtl] .mat-mdc-paginator-icon{transform:rotate(180deg)}@media(forced-colors: active){.mat-mdc-icon-button[aria-disabled] .mat-mdc-paginator-icon,.mat-mdc-paginator-icon{fill:currentColor}.mat-mdc-paginator-range-actions .mat-mdc-icon-button{outline:solid 1px}.mat-mdc-paginator-range-actions .mat-mdc-icon-button[aria-disabled]{color:GrayText}}.mat-mdc-paginator-touch-target{display:var(--mat-paginator-touch-target-display, block);position:absolute;top:50%;left:50%;width:84px;height:48px;background-color:rgba(0,0,0,0);transform:translate(-50%, -50%);cursor:pointer}
`],encapsulation:2,changeDetection:0})}return i})(),Ty=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({providers:[Ire],imports:[Wa,td,Z6,Bm]})}return i})();var kre=["*"];var Pre=[[["","mat-card-avatar",""],["","matCardAvatar",""]],[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],"*"],Ore=["[mat-card-avatar], [matCardAvatar]",`mat-card-title, mat-card-subtitle,
      [mat-card-title], [mat-card-subtitle],
      [matCardTitle], [matCardSubtitle]`,"*"],Fre=new Dt("MAT_CARD_CONFIG"),rc=(()=>{class i{appearance;constructor(){let e=Z(Fre,{optional:!0});this.appearance=e?.appearance||"raised"}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(n,s){n&2&&Ai("mat-mdc-card-outlined",s.appearance==="outlined")("mdc-card--outlined",s.appearance==="outlined")},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:kre,decls:1,vars:0,template:function(n,s){n&1&&(xr(),an(0))},styles:[`.mat-mdc-card{display:flex;flex-direction:column;box-sizing:border-box;position:relative;border-style:solid;border-width:0;background-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium));box-shadow:var(--mdc-elevated-card-container-elevation, var(--mat-sys-level1))}.mat-mdc-card::after{position:absolute;top:0;left:0;width:100%;height:100%;border:solid 1px rgba(0,0,0,0);content:"";display:block;pointer-events:none;box-sizing:border-box;border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium))}.mat-mdc-card-outlined{background-color:var(--mdc-outlined-card-container-color, var(--mat-sys-surface));border-radius:var(--mdc-outlined-card-container-shape, var(--mat-sys-corner-medium));border-width:var(--mdc-outlined-card-outline-width, 1px);border-color:var(--mdc-outlined-card-outline-color, var(--mat-sys-outline-variant));box-shadow:var(--mdc-outlined-card-container-elevation, var(--mat-sys-level0))}.mat-mdc-card-outlined::after{border:none}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mat-mdc-card-actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font, var(--mat-sys-title-large-font));line-height:var(--mat-card-title-text-line-height, var(--mat-sys-title-large-line-height));font-size:var(--mat-card-title-text-size, var(--mat-sys-title-large-size));letter-spacing:var(--mat-card-title-text-tracking, var(--mat-sys-title-large-tracking));font-weight:var(--mat-card-title-text-weight, var(--mat-sys-title-large-weight))}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color, var(--mat-sys-on-surface));font-family:var(--mat-card-subtitle-text-font, var(--mat-sys-title-medium-font));line-height:var(--mat-card-subtitle-text-line-height, var(--mat-sys-title-medium-line-height));font-size:var(--mat-card-subtitle-text-size, var(--mat-sys-title-medium-size));letter-spacing:var(--mat-card-subtitle-text-tracking, var(--mat-sys-title-medium-tracking));font-weight:var(--mat-card-subtitle-text-weight, var(--mat-sys-title-medium-weight))}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}
`],encapsulation:2,changeDetection:0})}return i})(),zp=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["mat-card-title"],["","mat-card-title",""],["","matCardTitle",""]],hostAttrs:[1,"mat-mdc-card-title"]})}return i})();var Bp=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["mat-card-content"]],hostAttrs:[1,"mat-mdc-card-content"]})}return i})(),WD=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["mat-card-subtitle"],["","mat-card-subtitle",""],["","matCardSubtitle",""]],hostAttrs:[1,"mat-mdc-card-subtitle"]})}return i})(),YD=(()=>{class i{align="start";static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["mat-card-actions"]],hostAttrs:[1,"mat-mdc-card-actions","mdc-card__actions"],hostVars:2,hostBindings:function(n,s){n&2&&Ai("mat-mdc-card-actions-align-end",s.align==="end")},inputs:{align:"align"},exportAs:["matCardActions"]})}return i})(),Vp=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-card-header"]],hostAttrs:[1,"mat-mdc-card-header"],ngContentSelectors:Ore,decls:4,vars:0,consts:[[1,"mat-mdc-card-header-text"]],template:function(n,s){n&1&&(xr(Pre),an(0),oe(1,"div",0),an(2,1),ae(),an(3,2))},encapsulation:2,changeDetection:0})}return i})();var oc=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({imports:[An,An]})}return i})();var ZD=(()=>{class i{get vertical(){return this._vertical}set vertical(e){this._vertical=Tl(e)}_vertical=!1;get inset(){return this._inset}set inset(e){this._inset=Tl(e)}_inset=!1;static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(n,s){n&2&&(ji("aria-orientation",s.vertical?"vertical":"horizontal"),Ai("mat-divider-vertical",s.vertical)("mat-divider-horizontal",!s.vertical)("mat-divider-inset",s.inset))},inputs:{vertical:"vertical",inset:"inset"},decls:0,vars:0,template:function(n,s){},styles:[`.mat-divider{display:block;margin:0;border-top-style:solid;border-top-color:var(--mat-divider-color, var(--mat-sys-outline));border-top-width:var(--mat-divider-width, 1px)}.mat-divider.mat-divider-vertical{border-top:0;border-right-style:solid;border-right-color:var(--mat-divider-color, var(--mat-sys-outline));border-right-width:var(--mat-divider-width, 1px)}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}
`],encapsulation:2,changeDetection:0})}return i})(),Ay=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({imports:[An,An]})}return i})();var eH=["*",[["mat-chip-avatar"],["","matChipAvatar",""]],[["mat-chip-trailing-icon"],["","matChipRemove",""],["","matChipTrailingIcon",""]]],tH=["*","mat-chip-avatar, [matChipAvatar]","mat-chip-trailing-icon,[matChipRemove],[matChipTrailingIcon]"];function Nre(i,t){i&1&&(oe(0,"span",3),an(1,1),ae())}function zre(i,t){i&1&&(oe(0,"span",6),an(1,2),ae())}function Bre(i,t){i&1&&(oe(0,"span",3),an(1,1),oe(2,"span",8),Da(),oe(3,"svg",9),Et(4,"path",10),ae()()())}function Vre(i,t){i&1&&(oe(0,"span",6),an(1,2),ae())}var jre=`.mdc-evolution-chip,.mdc-evolution-chip__cell,.mdc-evolution-chip__action{display:inline-flex;align-items:center}.mdc-evolution-chip{position:relative;max-width:100%}.mdc-evolution-chip__cell,.mdc-evolution-chip__action{height:100%}.mdc-evolution-chip__cell--primary{flex-basis:100%;overflow-x:hidden}.mdc-evolution-chip__cell--trailing{flex:1 0 auto}.mdc-evolution-chip__action{align-items:center;background:none;border:none;box-sizing:content-box;cursor:pointer;display:inline-flex;justify-content:center;outline:none;padding:0;text-decoration:none;color:inherit}.mdc-evolution-chip__action--presentational{cursor:auto}.mdc-evolution-chip--disabled,.mdc-evolution-chip__action:disabled{pointer-events:none}@media(forced-colors: active){.mdc-evolution-chip--disabled,.mdc-evolution-chip__action:disabled{forced-color-adjust:none}}.mdc-evolution-chip__action--primary{font:inherit;letter-spacing:inherit;white-space:inherit;overflow-x:hidden}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary::before{border-width:var(--mdc-chip-outline-width, 1px);border-radius:var(--mdc-chip-container-shape-radius, 8px);box-sizing:border-box;content:"";height:100%;left:0;position:absolute;pointer-events:none;top:0;width:100%;z-index:1;border-style:solid}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__action--primary::before{border-color:var(--mdc-chip-outline-color, var(--mat-sys-outline))}.mdc-evolution-chip__action--primary:not(.mdc-evolution-chip__action--presentational):not(.mdc-ripple-upgraded):focus::before{border-color:var(--mdc-chip-focus-outline-color, var(--mat-sys-on-surface-variant))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__action--primary::before{border-color:var(--mdc-chip-disabled-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-standard-chip.mdc-evolution-chip--selected .mdc-evolution-chip__action--primary::before{border-width:var(--mdc-chip-flat-selected-outline-width, 0)}.mat-mdc-basic-chip .mdc-evolution-chip__action--primary{font:inherit}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}.mdc-evolution-chip__action--trailing{position:relative;overflow:visible}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__action--trailing{color:var(--mdc-chip-with-trailing-icon-trailing-icon-color, var(--mat-sys-on-surface-variant))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__action--trailing{color:var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-color, var(--mat-sys-on-surface))}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}.mdc-evolution-chip__text-label{-webkit-user-select:none;user-select:none;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.mat-mdc-standard-chip .mdc-evolution-chip__text-label{font-family:var(--mdc-chip-label-text-font, var(--mat-sys-label-large-font));line-height:var(--mdc-chip-label-text-line-height, var(--mat-sys-label-large-line-height));font-size:var(--mdc-chip-label-text-size, var(--mat-sys-label-large-size));font-weight:var(--mdc-chip-label-text-weight, var(--mat-sys-label-large-weight));letter-spacing:var(--mdc-chip-label-text-tracking, var(--mat-sys-label-large-tracking))}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__text-label{color:var(--mdc-chip-label-text-color, var(--mat-sys-on-surface-variant))}.mat-mdc-standard-chip.mdc-evolution-chip--selected:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__text-label{color:var(--mdc-chip-selected-label-text-color, var(--mat-sys-on-secondary-container))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label,.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-evolution-chip__graphic{align-items:center;display:inline-flex;justify-content:center;overflow:hidden;pointer-events:none;position:relative;flex:1 0 auto}.mat-mdc-standard-chip .mdc-evolution-chip__graphic{width:var(--mdc-chip-with-avatar-avatar-size, 24px);height:var(--mdc-chip-with-avatar-avatar-size, 24px);font-size:var(--mdc-chip-with-avatar-avatar-size, 24px)}.mdc-evolution-chip--selecting .mdc-evolution-chip__graphic{transition:width 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--selected):not(.mdc-evolution-chip--with-primary-icon) .mdc-evolution-chip__graphic{width:0}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:8px;padding-right:4px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:8px;padding-right:4px}.mdc-evolution-chip__checkmark{position:absolute;opacity:0;top:50%;left:50%;height:20px;width:20px}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color, var(--mat-sys-on-secondary-container))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-disabled-icon-color, var(--mat-sys-on-surface))}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark{transition:transform 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark{transform:translate(-50%, -50%);opacity:1}.mdc-evolution-chip__checkmark-svg{display:block}.mdc-evolution-chip__checkmark-path{stroke-width:2px;stroke-dasharray:29.7833385;stroke-dashoffset:29.7833385;stroke:currentColor}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 45ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}@media(forced-colors: active){.mdc-evolution-chip__checkmark-path{stroke:CanvasText !important}}.mat-mdc-standard-chip .mdc-evolution-chip__icon--trailing{height:18px;width:18px;font-size:18px}.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing.mat-mdc-chip-remove{opacity:calc(var(--mat-chip-trailing-action-opacity, 1)*var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-opacity, 0.38))}.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing.mat-mdc-chip-remove:focus{opacity:calc(var(--mat-chip-trailing-action-focus-opacity, 1)*var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-opacity, 0.38))}.mat-mdc-standard-chip{border-radius:var(--mdc-chip-container-shape-radius, 8px);height:var(--mdc-chip-container-height, 32px)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled){background-color:var(--mdc-chip-elevated-container-color, transparent)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color)}.mat-mdc-standard-chip.mdc-evolution-chip--selected:not(.mdc-evolution-chip--disabled){background-color:var(--mdc-chip-elevated-selected-container-color, var(--mat-sys-secondary-container))}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-flat-disabled-selected-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}@media(forced-colors: active){.mat-mdc-standard-chip{outline:solid 1px}}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{border-radius:var(--mdc-chip-with-avatar-avatar-shape-radius, 24px);width:var(--mdc-chip-with-icon-icon-size, 18px);height:var(--mdc-chip-with-icon-icon-size, 18px);font-size:var(--mdc-chip-with-icon-icon-size, 18px)}.mdc-evolution-chip--selected .mdc-evolution-chip__icon--primary{opacity:0}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-icon-color, var(--mat-sys-on-surface-variant))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-disabled-icon-color, var(--mat-sys-on-surface))}.mat-mdc-chip-highlighted{--mdc-chip-with-icon-icon-color:var(--mdc-chip-with-icon-selected-icon-color, var(--mat-sys-on-secondary-container));--mdc-chip-elevated-container-color:var(--mdc-chip-elevated-selected-container-color, var(--mat-sys-secondary-container));--mdc-chip-label-text-color:var(--mdc-chip-selected-label-text-color, var(--mat-sys-on-secondary-container));--mdc-chip-outline-width:var(--mdc-chip-flat-selected-outline-width, 0)}.mat-mdc-chip-focus-overlay{background:var(--mdc-chip-focus-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-chip-selected .mat-mdc-chip-focus-overlay,.mat-mdc-chip-highlighted .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-selected-focus-state-layer-color, var(--mat-sys-on-secondary-container))}.mat-mdc-chip:hover .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-hover-state-layer-color, var(--mat-sys-on-surface-variant));opacity:var(--mdc-chip-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-chip-focus-overlay .mat-mdc-chip-selected:hover,.mat-mdc-chip-highlighted:hover .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-selected-hover-state-layer-color, var(--mat-sys-on-secondary-container));opacity:var(--mdc-chip-selected-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-chip.cdk-focused .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-focus-state-layer-color, var(--mat-sys-on-surface-variant));opacity:var(--mdc-chip-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-chip-selected.cdk-focused .mat-mdc-chip-focus-overlay,.mat-mdc-chip-highlighted.cdk-focused .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-selected-focus-state-layer-color, var(--mat-sys-on-secondary-container));opacity:var(--mdc-chip-selected-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mdc-evolution-chip--disabled:not(.mdc-evolution-chip--selected) .mat-mdc-chip-avatar{opacity:var(--mdc-chip-with-avatar-disabled-avatar-opacity, 0.38)}.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing{opacity:var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-opacity, 0.38)}.mdc-evolution-chip--disabled.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark{opacity:var(--mdc-chip-with-icon-disabled-icon-opacity, 0.38)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{opacity:var(--mat-chip-disabled-container-opacity, 1)}.mat-mdc-standard-chip.mdc-evolution-chip--selected .mdc-evolution-chip__icon--trailing,.mat-mdc-standard-chip.mat-mdc-chip-highlighted .mdc-evolution-chip__icon--trailing{color:var(--mat-chip-selected-trailing-icon-color, var(--mat-sys-on-secondary-container))}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing,.mat-mdc-standard-chip.mat-mdc-chip-highlighted.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing{color:var(--mat-chip-selected-disabled-trailing-icon-color, var(--mat-sys-on-surface))}.mat-mdc-chip-remove{opacity:var(--mat-chip-trailing-action-opacity, 1)}.mat-mdc-chip-remove:focus{opacity:var(--mat-chip-trailing-action-focus-opacity, 1)}.mat-mdc-chip-remove::after{background-color:var(--mat-chip-trailing-action-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-chip-remove:hover::after{opacity:var(--mat-chip-trailing-action-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-chip-remove:focus::after{opacity:var(--mat-chip-trailing-action-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-chip-selected .mat-mdc-chip-remove::after,.mat-mdc-chip-highlighted .mat-mdc-chip-remove::after{background-color:var(--mat-chip-selected-trailing-action-state-layer-color, var(--mat-sys-on-secondary-container))}.mat-mdc-standard-chip{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mat-mdc-chip-action-label{overflow:visible}.mat-mdc-standard-chip .mat-mdc-chip-graphic,.mat-mdc-standard-chip .mat-mdc-chip-trailing-icon{box-sizing:content-box}.mat-mdc-standard-chip._mat-animation-noopable,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__graphic,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark-path{transition-duration:1ms;animation-duration:1ms}.mat-mdc-chip-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;opacity:0;border-radius:inherit;transition:opacity 150ms linear}._mat-animation-noopable .mat-mdc-chip-focus-overlay{transition:none}.mat-mdc-basic-chip .mat-mdc-chip-focus-overlay{display:none}.mat-mdc-chip .mat-ripple.mat-mdc-chip-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-chip-avatar{text-align:center;line-height:1;color:var(--mdc-chip-with-icon-icon-color, currentColor)}.mat-mdc-chip{position:relative;z-index:0}.mat-mdc-chip-action-label{text-align:left;z-index:1}[dir=rtl] .mat-mdc-chip-action-label{text-align:right}.mat-mdc-chip.mdc-evolution-chip--with-trailing-action .mat-mdc-chip-action-label{position:relative}.mat-mdc-chip-action-label .mat-mdc-chip-primary-focus-indicator{position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none}.mat-mdc-chip-action-label .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-chip-remove::before{margin:calc(var(--mat-focus-indicator-border-width, 3px)*-1);left:8px;right:8px}.mat-mdc-chip-remove::after{content:"";display:block;opacity:0;position:absolute;top:-3px;bottom:-3px;left:5px;right:5px;border-radius:50%;box-sizing:border-box;padding:12px;margin:-12px;background-clip:content-box}.mat-mdc-chip-remove .mat-icon{width:18px;height:18px;font-size:18px;box-sizing:content-box}.mat-chip-edit-input{cursor:text;display:inline-block;color:inherit;outline:0}@media(forced-colors: active){.mat-mdc-chip-selected:not(.mat-mdc-chip-multiple){outline-width:3px}}.mat-mdc-chip-action:focus .mat-focus-indicator::before{content:""}
`;var iH=["*"],Ure=`.mat-mdc-chip-set{display:flex}.mat-mdc-chip-set:focus{outline:none}.mat-mdc-chip-set .mdc-evolution-chip-set__chips{min-width:100%;margin-left:-8px;margin-right:0}.mat-mdc-chip-set .mdc-evolution-chip{margin:4px 0 4px 8px}[dir=rtl] .mat-mdc-chip-set .mdc-evolution-chip-set__chips{margin-left:0;margin-right:-8px}[dir=rtl] .mat-mdc-chip-set .mdc-evolution-chip{margin-left:0;margin-right:8px}.mdc-evolution-chip-set__chips{display:flex;flex-flow:wrap;min-width:0}.mat-mdc-chip-set-stacked{flex-direction:column;align-items:flex-start}.mat-mdc-chip-set-stacked .mat-mdc-chip{width:100%}.mat-mdc-chip-set-stacked .mdc-evolution-chip__graphic{flex-grow:0}.mat-mdc-chip-set-stacked .mdc-evolution-chip__action--primary{flex-basis:100%;justify-content:start}input.mat-mdc-chip-input{flex:1 0 150px;margin-left:8px}[dir=rtl] input.mat-mdc-chip-input{margin-left:0;margin-right:8px}
`,VP=new Dt("mat-chips-default-options",{providedIn:"root",factory:()=>({separatorKeyCodes:[13]})}),K6=new Dt("MatChipAvatar"),Q6=new Dt("MatChipTrailingIcon"),J6=new Dt("MatChipRemove"),jP=new Dt("MatChip"),zP=(()=>{class i{_elementRef=Z(Ii);_parentChip=Z(jP);isInteractive=!0;_isPrimary=!0;get disabled(){return this._disabled||this._parentChip?.disabled||!1}set disabled(e){this._disabled=e}_disabled=!1;tabIndex=-1;_allowFocusWhenDisabled=!1;_getDisabledAttribute(){return this.disabled&&!this._allowFocusWhenDisabled?"":null}_getTabindex(){return this.disabled&&!this._allowFocusWhenDisabled||!this.isInteractive?null:this.tabIndex.toString()}constructor(){Z(to).load(Zc),this._elementRef.nativeElement.nodeName==="BUTTON"&&this._elementRef.nativeElement.setAttribute("type","button")}focus(){this._elementRef.nativeElement.focus()}_handleClick(e){!this.disabled&&this.isInteractive&&this._isPrimary&&(e.preventDefault(),this._parentChip._handlePrimaryActionInteraction())}_handleKeydown(e){(e.keyCode===13||e.keyCode===32)&&!this.disabled&&this.isInteractive&&this._isPrimary&&!this._parentChip._isEditing&&(e.preventDefault(),this._parentChip._handlePrimaryActionInteraction())}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","matChipAction",""]],hostAttrs:[1,"mdc-evolution-chip__action","mat-mdc-chip-action"],hostVars:9,hostBindings:function(n,s){n&1&&_t("click",function(y){return s._handleClick(y)})("keydown",function(y){return s._handleKeydown(y)}),n&2&&(ji("tabindex",s._getTabindex())("disabled",s._getDisabledAttribute())("aria-disabled",s.disabled),Ai("mdc-evolution-chip__action--primary",s._isPrimary)("mdc-evolution-chip__action--presentational",!s.isInteractive)("mdc-evolution-chip__action--trailing",!s._isPrimary))},inputs:{isInteractive:"isInteractive",disabled:[2,"disabled","disabled",xi],tabIndex:[2,"tabIndex","tabIndex",e=>e==null?-1:Aa(e)],_allowFocusWhenDisabled:"_allowFocusWhenDisabled"}})}return i})();var Vm=(()=>{class i{_changeDetectorRef=Z($n);_elementRef=Z(Ii);_ngZone=Z(ki);_focusMonitor=Z(Kl);_globalRippleOptions=Z(xx,{optional:!0});_document=Z(Ki);_onFocus=new ni;_onBlur=new ni;_isBasicChip;role=null;_hasFocusInternal=!1;_pendingFocus;_actionChanges;_animationsDisabled;_allLeadingIcons;_allTrailingIcons;_allRemoveIcons;_hasFocus(){return this._hasFocusInternal}id=Z(kr).getId("mat-mdc-chip-");ariaLabel=null;ariaDescription=null;_ariaDescriptionId=`${this.id}-aria-description`;_chipListDisabled=!1;_textElement;get value(){return this._value!==void 0?this._value:this._textElement.textContent.trim()}set value(e){this._value=e}_value;color;removable=!0;highlighted=!1;disableRipple=!1;get disabled(){return this._disabled||this._chipListDisabled}set disabled(e){this._disabled=e}_disabled=!1;removed=new ui;destroyed=new ui;basicChipAttrName="mat-basic-chip";leadingIcon;trailingIcon;removeIcon;primaryAction;_rippleLoader=Z(rD);_injector=Z(vn);constructor(){let e=Z(to);e.load(Zc),e.load(Ql);let n=Z(Vr,{optional:!0});this._animationsDisabled=n==="NoopAnimations",this._monitorFocus(),this._rippleLoader?.configureRipple(this._elementRef.nativeElement,{className:"mat-mdc-chip-ripple",disabled:this._isRippleDisabled()})}ngOnInit(){let e=this._elementRef.nativeElement;this._isBasicChip=e.hasAttribute(this.basicChipAttrName)||e.tagName.toLowerCase()===this.basicChipAttrName}ngAfterViewInit(){this._textElement=this._elementRef.nativeElement.querySelector(".mat-mdc-chip-action-label"),this._pendingFocus&&(this._pendingFocus=!1,this.focus())}ngAfterContentInit(){this._actionChanges=Ba(this._allLeadingIcons.changes,this._allTrailingIcons.changes,this._allRemoveIcons.changes).subscribe(()=>this._changeDetectorRef.markForCheck())}ngDoCheck(){this._rippleLoader.setDisabled(this._elementRef.nativeElement,this._isRippleDisabled())}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement),this._actionChanges?.unsubscribe(),this.destroyed.emit({chip:this}),this.destroyed.complete()}remove(){this.removable&&this.removed.emit({chip:this})}_isRippleDisabled(){return this.disabled||this.disableRipple||this._animationsDisabled||this._isBasicChip||!!this._globalRippleOptions?.disabled}_hasTrailingIcon(){return!!(this.trailingIcon||this.removeIcon)}_handleKeydown(e){(e.keyCode===8&&!e.repeat||e.keyCode===46)&&(e.preventDefault(),this.remove())}focus(){this.disabled||(this.primaryAction?this.primaryAction.focus():this._pendingFocus=!0)}_getSourceAction(e){return this._getActions().find(n=>{let s=n._elementRef.nativeElement;return s===e||s.contains(e)})}_getActions(){let e=[];return this.primaryAction&&e.push(this.primaryAction),this.removeIcon&&e.push(this.removeIcon),this.trailingIcon&&e.push(this.trailingIcon),e}_handlePrimaryActionInteraction(){}_monitorFocus(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{let n=e!==null;n!==this._hasFocusInternal&&(this._hasFocusInternal=n,n?this._onFocus.next({chip:this}):(this._changeDetectorRef.markForCheck(),setTimeout(()=>this._ngZone.run(()=>this._onBlur.next({chip:this})))))})}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-basic-chip"],["","mat-basic-chip",""],["mat-chip"],["","mat-chip",""]],contentQueries:function(n,s,r){if(n&1&&(Mr(r,K6,5),Mr(r,Q6,5),Mr(r,J6,5),Mr(r,K6,5),Mr(r,Q6,5),Mr(r,J6,5)),n&2){let y;Bi(y=Vi())&&(s.leadingIcon=y.first),Bi(y=Vi())&&(s.trailingIcon=y.first),Bi(y=Vi())&&(s.removeIcon=y.first),Bi(y=Vi())&&(s._allLeadingIcons=y),Bi(y=Vi())&&(s._allTrailingIcons=y),Bi(y=Vi())&&(s._allRemoveIcons=y)}},viewQuery:function(n,s){if(n&1&&Bn(zP,5),n&2){let r;Bi(r=Vi())&&(s.primaryAction=r.first)}},hostAttrs:[1,"mat-mdc-chip"],hostVars:31,hostBindings:function(n,s){n&1&&_t("keydown",function(y){return s._handleKeydown(y)}),n&2&&(Ia("id",s.id),ji("role",s.role)("aria-label",s.ariaLabel),Ts("mat-"+(s.color||"primary")),Ai("mdc-evolution-chip",!s._isBasicChip)("mdc-evolution-chip--disabled",s.disabled)("mdc-evolution-chip--with-trailing-action",s._hasTrailingIcon())("mdc-evolution-chip--with-primary-graphic",s.leadingIcon)("mdc-evolution-chip--with-primary-icon",s.leadingIcon)("mdc-evolution-chip--with-avatar",s.leadingIcon)("mat-mdc-chip-with-avatar",s.leadingIcon)("mat-mdc-chip-highlighted",s.highlighted)("mat-mdc-chip-disabled",s.disabled)("mat-mdc-basic-chip",s._isBasicChip)("mat-mdc-standard-chip",!s._isBasicChip)("mat-mdc-chip-with-trailing-icon",s._hasTrailingIcon())("_mat-animation-noopable",s._animationsDisabled))},inputs:{role:"role",id:"id",ariaLabel:[0,"aria-label","ariaLabel"],ariaDescription:[0,"aria-description","ariaDescription"],value:"value",color:"color",removable:[2,"removable","removable",xi],highlighted:[2,"highlighted","highlighted",xi],disableRipple:[2,"disableRipple","disableRipple",xi],disabled:[2,"disabled","disabled",xi]},outputs:{removed:"removed",destroyed:"destroyed"},exportAs:["matChip"],features:[Vn([{provide:jP,useExisting:i}])],ngContentSelectors:tH,decls:8,vars:3,consts:[[1,"mat-mdc-chip-focus-overlay"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--primary"],["matChipAction","",3,"isInteractive"],[1,"mdc-evolution-chip__graphic","mat-mdc-chip-graphic"],[1,"mdc-evolution-chip__text-label","mat-mdc-chip-action-label"],[1,"mat-mdc-chip-primary-focus-indicator","mat-focus-indicator"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--trailing"]],template:function(n,s){n&1&&(xr(eH),Et(0,"span",0),oe(1,"span",1)(2,"span",2),pt(3,Nre,2,0,"span",3),oe(4,"span",4),an(5),Et(6,"span",5),ae()()(),pt(7,zre,2,0,"span",6)),n&2&&(ge(2),Be("isInteractive",!1),ge(),un(s.leadingIcon?3:-1),ge(4),un(s._hasTrailingIcon()?7:-1))},dependencies:[zP],styles:[`.mdc-evolution-chip,.mdc-evolution-chip__cell,.mdc-evolution-chip__action{display:inline-flex;align-items:center}.mdc-evolution-chip{position:relative;max-width:100%}.mdc-evolution-chip__cell,.mdc-evolution-chip__action{height:100%}.mdc-evolution-chip__cell--primary{flex-basis:100%;overflow-x:hidden}.mdc-evolution-chip__cell--trailing{flex:1 0 auto}.mdc-evolution-chip__action{align-items:center;background:none;border:none;box-sizing:content-box;cursor:pointer;display:inline-flex;justify-content:center;outline:none;padding:0;text-decoration:none;color:inherit}.mdc-evolution-chip__action--presentational{cursor:auto}.mdc-evolution-chip--disabled,.mdc-evolution-chip__action:disabled{pointer-events:none}@media(forced-colors: active){.mdc-evolution-chip--disabled,.mdc-evolution-chip__action:disabled{forced-color-adjust:none}}.mdc-evolution-chip__action--primary{font:inherit;letter-spacing:inherit;white-space:inherit;overflow-x:hidden}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary::before{border-width:var(--mdc-chip-outline-width, 1px);border-radius:var(--mdc-chip-container-shape-radius, 8px);box-sizing:border-box;content:"";height:100%;left:0;position:absolute;pointer-events:none;top:0;width:100%;z-index:1;border-style:solid}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__action--primary::before{border-color:var(--mdc-chip-outline-color, var(--mat-sys-outline))}.mdc-evolution-chip__action--primary:not(.mdc-evolution-chip__action--presentational):not(.mdc-ripple-upgraded):focus::before{border-color:var(--mdc-chip-focus-outline-color, var(--mat-sys-on-surface-variant))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__action--primary::before{border-color:var(--mdc-chip-disabled-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-standard-chip.mdc-evolution-chip--selected .mdc-evolution-chip__action--primary::before{border-width:var(--mdc-chip-flat-selected-outline-width, 0)}.mat-mdc-basic-chip .mdc-evolution-chip__action--primary{font:inherit}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}.mdc-evolution-chip__action--trailing{position:relative;overflow:visible}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__action--trailing{color:var(--mdc-chip-with-trailing-icon-trailing-icon-color, var(--mat-sys-on-surface-variant))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__action--trailing{color:var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-color, var(--mat-sys-on-surface))}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}.mdc-evolution-chip__text-label{-webkit-user-select:none;user-select:none;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.mat-mdc-standard-chip .mdc-evolution-chip__text-label{font-family:var(--mdc-chip-label-text-font, var(--mat-sys-label-large-font));line-height:var(--mdc-chip-label-text-line-height, var(--mat-sys-label-large-line-height));font-size:var(--mdc-chip-label-text-size, var(--mat-sys-label-large-size));font-weight:var(--mdc-chip-label-text-weight, var(--mat-sys-label-large-weight));letter-spacing:var(--mdc-chip-label-text-tracking, var(--mat-sys-label-large-tracking))}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__text-label{color:var(--mdc-chip-label-text-color, var(--mat-sys-on-surface-variant))}.mat-mdc-standard-chip.mdc-evolution-chip--selected:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__text-label{color:var(--mdc-chip-selected-label-text-color, var(--mat-sys-on-secondary-container))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label,.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-evolution-chip__graphic{align-items:center;display:inline-flex;justify-content:center;overflow:hidden;pointer-events:none;position:relative;flex:1 0 auto}.mat-mdc-standard-chip .mdc-evolution-chip__graphic{width:var(--mdc-chip-with-avatar-avatar-size, 24px);height:var(--mdc-chip-with-avatar-avatar-size, 24px);font-size:var(--mdc-chip-with-avatar-avatar-size, 24px)}.mdc-evolution-chip--selecting .mdc-evolution-chip__graphic{transition:width 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--selected):not(.mdc-evolution-chip--with-primary-icon) .mdc-evolution-chip__graphic{width:0}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:8px;padding-right:4px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:8px;padding-right:4px}.mdc-evolution-chip__checkmark{position:absolute;opacity:0;top:50%;left:50%;height:20px;width:20px}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color, var(--mat-sys-on-secondary-container))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-disabled-icon-color, var(--mat-sys-on-surface))}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark{transition:transform 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark{transform:translate(-50%, -50%);opacity:1}.mdc-evolution-chip__checkmark-svg{display:block}.mdc-evolution-chip__checkmark-path{stroke-width:2px;stroke-dasharray:29.7833385;stroke-dashoffset:29.7833385;stroke:currentColor}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 45ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}@media(forced-colors: active){.mdc-evolution-chip__checkmark-path{stroke:CanvasText !important}}.mat-mdc-standard-chip .mdc-evolution-chip__icon--trailing{height:18px;width:18px;font-size:18px}.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing.mat-mdc-chip-remove{opacity:calc(var(--mat-chip-trailing-action-opacity, 1)*var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-opacity, 0.38))}.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing.mat-mdc-chip-remove:focus{opacity:calc(var(--mat-chip-trailing-action-focus-opacity, 1)*var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-opacity, 0.38))}.mat-mdc-standard-chip{border-radius:var(--mdc-chip-container-shape-radius, 8px);height:var(--mdc-chip-container-height, 32px)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled){background-color:var(--mdc-chip-elevated-container-color, transparent)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color)}.mat-mdc-standard-chip.mdc-evolution-chip--selected:not(.mdc-evolution-chip--disabled){background-color:var(--mdc-chip-elevated-selected-container-color, var(--mat-sys-secondary-container))}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-flat-disabled-selected-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}@media(forced-colors: active){.mat-mdc-standard-chip{outline:solid 1px}}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{border-radius:var(--mdc-chip-with-avatar-avatar-shape-radius, 24px);width:var(--mdc-chip-with-icon-icon-size, 18px);height:var(--mdc-chip-with-icon-icon-size, 18px);font-size:var(--mdc-chip-with-icon-icon-size, 18px)}.mdc-evolution-chip--selected .mdc-evolution-chip__icon--primary{opacity:0}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-icon-color, var(--mat-sys-on-surface-variant))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-disabled-icon-color, var(--mat-sys-on-surface))}.mat-mdc-chip-highlighted{--mdc-chip-with-icon-icon-color:var(--mdc-chip-with-icon-selected-icon-color, var(--mat-sys-on-secondary-container));--mdc-chip-elevated-container-color:var(--mdc-chip-elevated-selected-container-color, var(--mat-sys-secondary-container));--mdc-chip-label-text-color:var(--mdc-chip-selected-label-text-color, var(--mat-sys-on-secondary-container));--mdc-chip-outline-width:var(--mdc-chip-flat-selected-outline-width, 0)}.mat-mdc-chip-focus-overlay{background:var(--mdc-chip-focus-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-chip-selected .mat-mdc-chip-focus-overlay,.mat-mdc-chip-highlighted .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-selected-focus-state-layer-color, var(--mat-sys-on-secondary-container))}.mat-mdc-chip:hover .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-hover-state-layer-color, var(--mat-sys-on-surface-variant));opacity:var(--mdc-chip-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-chip-focus-overlay .mat-mdc-chip-selected:hover,.mat-mdc-chip-highlighted:hover .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-selected-hover-state-layer-color, var(--mat-sys-on-secondary-container));opacity:var(--mdc-chip-selected-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-chip.cdk-focused .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-focus-state-layer-color, var(--mat-sys-on-surface-variant));opacity:var(--mdc-chip-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-chip-selected.cdk-focused .mat-mdc-chip-focus-overlay,.mat-mdc-chip-highlighted.cdk-focused .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-selected-focus-state-layer-color, var(--mat-sys-on-secondary-container));opacity:var(--mdc-chip-selected-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mdc-evolution-chip--disabled:not(.mdc-evolution-chip--selected) .mat-mdc-chip-avatar{opacity:var(--mdc-chip-with-avatar-disabled-avatar-opacity, 0.38)}.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing{opacity:var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-opacity, 0.38)}.mdc-evolution-chip--disabled.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark{opacity:var(--mdc-chip-with-icon-disabled-icon-opacity, 0.38)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{opacity:var(--mat-chip-disabled-container-opacity, 1)}.mat-mdc-standard-chip.mdc-evolution-chip--selected .mdc-evolution-chip__icon--trailing,.mat-mdc-standard-chip.mat-mdc-chip-highlighted .mdc-evolution-chip__icon--trailing{color:var(--mat-chip-selected-trailing-icon-color, var(--mat-sys-on-secondary-container))}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing,.mat-mdc-standard-chip.mat-mdc-chip-highlighted.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing{color:var(--mat-chip-selected-disabled-trailing-icon-color, var(--mat-sys-on-surface))}.mat-mdc-chip-remove{opacity:var(--mat-chip-trailing-action-opacity, 1)}.mat-mdc-chip-remove:focus{opacity:var(--mat-chip-trailing-action-focus-opacity, 1)}.mat-mdc-chip-remove::after{background-color:var(--mat-chip-trailing-action-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-chip-remove:hover::after{opacity:var(--mat-chip-trailing-action-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-chip-remove:focus::after{opacity:var(--mat-chip-trailing-action-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-chip-selected .mat-mdc-chip-remove::after,.mat-mdc-chip-highlighted .mat-mdc-chip-remove::after{background-color:var(--mat-chip-selected-trailing-action-state-layer-color, var(--mat-sys-on-secondary-container))}.mat-mdc-standard-chip{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mat-mdc-chip-action-label{overflow:visible}.mat-mdc-standard-chip .mat-mdc-chip-graphic,.mat-mdc-standard-chip .mat-mdc-chip-trailing-icon{box-sizing:content-box}.mat-mdc-standard-chip._mat-animation-noopable,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__graphic,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark-path{transition-duration:1ms;animation-duration:1ms}.mat-mdc-chip-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;opacity:0;border-radius:inherit;transition:opacity 150ms linear}._mat-animation-noopable .mat-mdc-chip-focus-overlay{transition:none}.mat-mdc-basic-chip .mat-mdc-chip-focus-overlay{display:none}.mat-mdc-chip .mat-ripple.mat-mdc-chip-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-chip-avatar{text-align:center;line-height:1;color:var(--mdc-chip-with-icon-icon-color, currentColor)}.mat-mdc-chip{position:relative;z-index:0}.mat-mdc-chip-action-label{text-align:left;z-index:1}[dir=rtl] .mat-mdc-chip-action-label{text-align:right}.mat-mdc-chip.mdc-evolution-chip--with-trailing-action .mat-mdc-chip-action-label{position:relative}.mat-mdc-chip-action-label .mat-mdc-chip-primary-focus-indicator{position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none}.mat-mdc-chip-action-label .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-chip-remove::before{margin:calc(var(--mat-focus-indicator-border-width, 3px)*-1);left:8px;right:8px}.mat-mdc-chip-remove::after{content:"";display:block;opacity:0;position:absolute;top:-3px;bottom:-3px;left:5px;right:5px;border-radius:50%;box-sizing:border-box;padding:12px;margin:-12px;background-clip:content-box}.mat-mdc-chip-remove .mat-icon{width:18px;height:18px;font-size:18px;box-sizing:content-box}.mat-chip-edit-input{cursor:text;display:inline-block;color:inherit;outline:0}@media(forced-colors: active){.mat-mdc-chip-selected:not(.mat-mdc-chip-multiple){outline-width:3px}}.mat-mdc-chip-action:focus .mat-focus-indicator::before{content:""}
`],encapsulation:2,changeDetection:0})}return i})();var UP=(()=>{class i extends Vm{_defaultOptions=Z(VP,{optional:!0});chipListSelectable=!0;_chipListMultiple=!1;_chipListHideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1;get selectable(){return this._selectable&&this.chipListSelectable}set selectable(e){this._selectable=e,this._changeDetectorRef.markForCheck()}_selectable=!0;get selected(){return this._selected}set selected(e){this._setSelectedState(e,!1,!0)}_selected=!1;get ariaSelected(){return this.selectable?this.selected.toString():null}basicChipAttrName="mat-basic-chip-option";selectionChange=new ui;ngOnInit(){super.ngOnInit(),this.role="presentation"}select(){this._setSelectedState(!0,!1,!0)}deselect(){this._setSelectedState(!1,!1,!0)}selectViaInteraction(){this._setSelectedState(!0,!0,!0)}toggleSelected(e=!1){return this._setSelectedState(!this.selected,e,!0),this.selected}_handlePrimaryActionInteraction(){this.disabled||(this.focus(),this.selectable&&this.toggleSelected(!0))}_hasLeadingGraphic(){return this.leadingIcon?!0:!this._chipListHideSingleSelectionIndicator||this._chipListMultiple}_setSelectedState(e,n,s){e!==this.selected&&(this._selected=e,s&&this.selectionChange.emit({source:this,isUserInput:n,selected:this.selected}),this._changeDetectorRef.markForCheck())}static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275cmp=Yt({type:i,selectors:[["mat-basic-chip-option"],["","mat-basic-chip-option",""],["mat-chip-option"],["","mat-chip-option",""]],hostAttrs:[1,"mat-mdc-chip","mat-mdc-chip-option"],hostVars:37,hostBindings:function(n,s){n&2&&(Ia("id",s.id),ji("tabindex",null)("aria-label",null)("aria-description",null)("role",s.role),Ai("mdc-evolution-chip",!s._isBasicChip)("mdc-evolution-chip--filter",!s._isBasicChip)("mdc-evolution-chip--selectable",!s._isBasicChip)("mat-mdc-chip-selected",s.selected)("mat-mdc-chip-multiple",s._chipListMultiple)("mat-mdc-chip-disabled",s.disabled)("mat-mdc-chip-with-avatar",s.leadingIcon)("mdc-evolution-chip--disabled",s.disabled)("mdc-evolution-chip--selected",s.selected)("mdc-evolution-chip--selecting",!s._animationsDisabled)("mdc-evolution-chip--with-trailing-action",s._hasTrailingIcon())("mdc-evolution-chip--with-primary-icon",s.leadingIcon)("mdc-evolution-chip--with-primary-graphic",s._hasLeadingGraphic())("mdc-evolution-chip--with-avatar",s.leadingIcon)("mat-mdc-chip-highlighted",s.highlighted)("mat-mdc-chip-with-trailing-icon",s._hasTrailingIcon()))},inputs:{selectable:[2,"selectable","selectable",xi],selected:[2,"selected","selected",xi]},outputs:{selectionChange:"selectionChange"},features:[Vn([{provide:Vm,useExisting:i},{provide:jP,useExisting:i}]),dn],ngContentSelectors:tH,decls:10,vars:8,consts:[[1,"mat-mdc-chip-focus-overlay"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--primary"],["matChipAction","","role","option",3,"_allowFocusWhenDisabled"],[1,"mdc-evolution-chip__graphic","mat-mdc-chip-graphic"],[1,"mdc-evolution-chip__text-label","mat-mdc-chip-action-label"],[1,"mat-mdc-chip-primary-focus-indicator","mat-focus-indicator"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--trailing"],[1,"cdk-visually-hidden",3,"id"],[1,"mdc-evolution-chip__checkmark"],["viewBox","-2 -3 30 30","focusable","false","aria-hidden","true",1,"mdc-evolution-chip__checkmark-svg"],["fill","none","stroke","currentColor","d","M1.73,12.91 8.1,19.28 22.79,4.59",1,"mdc-evolution-chip__checkmark-path"]],template:function(n,s){n&1&&(xr(eH),Et(0,"span",0),oe(1,"span",1)(2,"button",2),pt(3,Bre,5,0,"span",3),oe(4,"span",4),an(5),Et(6,"span",5),ae()()(),pt(7,Vre,2,0,"span",6),oe(8,"span",7),Ee(9),ae()),n&2&&(ge(2),Be("_allowFocusWhenDisabled",!0),ji("aria-selected",s.ariaSelected)("aria-label",s.ariaLabel)("aria-describedby",s._ariaDescriptionId),ge(),un(s._hasLeadingGraphic()?3:-1),ge(4),un(s._hasTrailingIcon()?7:-1),ge(),Be("id",s._ariaDescriptionId),ge(),tn(s.ariaDescription))},dependencies:[zP],styles:[jre],encapsulation:2,changeDetection:0})}return i})();var Bx=(()=>{class i{_elementRef=Z(Ii);_changeDetectorRef=Z($n);_dir=Z(vo,{optional:!0});_lastDestroyedFocusedChipIndex=null;_keyManager;_destroyed=new ni;_defaultRole="presentation";get chipFocusChanges(){return this._getChipStream(e=>e._onFocus)}get chipDestroyedChanges(){return this._getChipStream(e=>e.destroyed)}get chipRemovedChanges(){return this._getChipStream(e=>e.removed)}get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._syncChipsState()}_disabled=!1;get empty(){return!this._chips||this._chips.length===0}get role(){return this._explicitRole?this._explicitRole:this.empty?null:this._defaultRole}tabIndex=0;set role(e){this._explicitRole=e}_explicitRole=null;get focused(){return this._hasFocusedChip()}_chips;_chipActions=new ep;constructor(){}ngAfterViewInit(){this._setUpFocusManagement(),this._trackChipSetChanges(),this._trackDestroyedFocusedChip()}ngOnDestroy(){this._keyManager?.destroy(),this._chipActions.destroy(),this._destroyed.next(),this._destroyed.complete()}_hasFocusedChip(){return this._chips&&this._chips.some(e=>e._hasFocus())}_syncChipsState(){this._chips?.forEach(e=>{e._chipListDisabled=this._disabled,e._changeDetectorRef.markForCheck()})}focus(){}_handleKeydown(e){this._originatesFromChip(e)&&this._keyManager.onKeydown(e)}_isValidIndex(e){return e>=0&&e<this._chips.length}_allowFocusEscape(){let e=this._elementRef.nativeElement.tabIndex;e!==-1&&(this._elementRef.nativeElement.tabIndex=-1,setTimeout(()=>this._elementRef.nativeElement.tabIndex=e))}_getChipStream(e){return this._chips.changes.pipe(go(null),Oo(()=>Ba(...this._chips.map(e))))}_originatesFromChip(e){let n=e.target;for(;n&&n!==this._elementRef.nativeElement;){if(n.classList.contains("mat-mdc-chip"))return!0;n=n.parentElement}return!1}_setUpFocusManagement(){this._chips.changes.pipe(go(this._chips)).subscribe(e=>{let n=[];e.forEach(s=>s._getActions().forEach(r=>n.push(r))),this._chipActions.reset(n),this._chipActions.notifyOnChanges()}),this._keyManager=new gx(this._chipActions).withVerticalOrientation().withHorizontalOrientation(this._dir?this._dir.value:"ltr").withHomeAndEnd().skipPredicate(e=>this._skipPredicate(e)),this.chipFocusChanges.pipe(Un(this._destroyed)).subscribe(({chip:e})=>{let n=e._getSourceAction(document.activeElement);n&&this._keyManager.updateActiveItem(n)}),this._dir?.change.pipe(Un(this._destroyed)).subscribe(e=>this._keyManager.withHorizontalOrientation(e))}_skipPredicate(e){return!e.isInteractive||e.disabled}_trackChipSetChanges(){this._chips.changes.pipe(go(null),Un(this._destroyed)).subscribe(()=>{this.disabled&&Promise.resolve().then(()=>this._syncChipsState()),this._redirectDestroyedChipFocus()})}_trackDestroyedFocusedChip(){this.chipDestroyedChanges.pipe(Un(this._destroyed)).subscribe(e=>{let s=this._chips.toArray().indexOf(e.chip);this._isValidIndex(s)&&e.chip._hasFocus()&&(this._lastDestroyedFocusedChipIndex=s)})}_redirectDestroyedChipFocus(){if(this._lastDestroyedFocusedChipIndex!=null){if(this._chips.length){let e=Math.min(this._lastDestroyedFocusedChipIndex,this._chips.length-1),n=this._chips.toArray()[e];n.disabled?this._chips.length===1?this.focus():this._keyManager.setPreviousItemActive():n.focus()}else this.focus();this._lastDestroyedFocusedChipIndex=null}}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-chip-set"]],contentQueries:function(n,s,r){if(n&1&&Mr(r,Vm,5),n&2){let y;Bi(y=Vi())&&(s._chips=y)}},hostAttrs:[1,"mat-mdc-chip-set","mdc-evolution-chip-set"],hostVars:1,hostBindings:function(n,s){n&1&&_t("keydown",function(y){return s._handleKeydown(y)}),n&2&&ji("role",s.role)},inputs:{disabled:[2,"disabled","disabled",xi],role:"role",tabIndex:[2,"tabIndex","tabIndex",e=>e==null?0:Aa(e)]},ngContentSelectors:iH,decls:2,vars:0,consts:[["role","presentation",1,"mdc-evolution-chip-set__chips"]],template:function(n,s){n&1&&(xr(),oe(0,"div",0),an(1),ae())},styles:[`.mat-mdc-chip-set{display:flex}.mat-mdc-chip-set:focus{outline:none}.mat-mdc-chip-set .mdc-evolution-chip-set__chips{min-width:100%;margin-left:-8px;margin-right:0}.mat-mdc-chip-set .mdc-evolution-chip{margin:4px 0 4px 8px}[dir=rtl] .mat-mdc-chip-set .mdc-evolution-chip-set__chips{margin-left:0;margin-right:-8px}[dir=rtl] .mat-mdc-chip-set .mdc-evolution-chip{margin-left:0;margin-right:8px}.mdc-evolution-chip-set__chips{display:flex;flex-flow:wrap;min-width:0}.mat-mdc-chip-set-stacked{flex-direction:column;align-items:flex-start}.mat-mdc-chip-set-stacked .mat-mdc-chip{width:100%}.mat-mdc-chip-set-stacked .mdc-evolution-chip__graphic{flex-grow:0}.mat-mdc-chip-set-stacked .mdc-evolution-chip__action--primary{flex-basis:100%;justify-content:start}input.mat-mdc-chip-input{flex:1 0 150px;margin-left:8px}[dir=rtl] input.mat-mdc-chip-input{margin-left:0;margin-right:8px}
`],encapsulation:2,changeDetection:0})}return i})(),BP=class{source;value;constructor(t,e){this.source=t,this.value=e}},Hre={provide:Ud,useExisting:ra(()=>HP),multi:!0},HP=(()=>{class i extends Bx{_onTouched=()=>{};_onChange=()=>{};_defaultRole="listbox";_defaultOptions=Z(VP,{optional:!0});get multiple(){return this._multiple}set multiple(e){this._multiple=e,this._syncListboxProperties()}_multiple=!1;get selected(){let e=this._chips.toArray().filter(n=>n.selected);return this.multiple?e:e[0]}ariaOrientation="horizontal";get selectable(){return this._selectable}set selectable(e){this._selectable=e,this._syncListboxProperties()}_selectable=!0;compareWith=(e,n)=>e===n;required=!1;get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(e){this._hideSingleSelectionIndicator=e,this._syncListboxProperties()}_hideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1;get chipSelectionChanges(){return this._getChipStream(e=>e.selectionChange)}get chipBlurChanges(){return this._getChipStream(e=>e._onBlur)}get value(){return this._value}set value(e){this._chips&&this._chips.length&&this._setSelectionByValue(e,!1),this._value=e}_value;change=new ui;_chips=void 0;ngAfterContentInit(){this._chips.changes.pipe(go(null),Un(this._destroyed)).subscribe(()=>{this.value!==void 0&&Promise.resolve().then(()=>{this._setSelectionByValue(this.value,!1)}),this._syncListboxProperties()}),this.chipBlurChanges.pipe(Un(this._destroyed)).subscribe(()=>this._blur()),this.chipSelectionChanges.pipe(Un(this._destroyed)).subscribe(e=>{this.multiple||this._chips.forEach(n=>{n!==e.source&&n._setSelectedState(!1,!1,!1)}),e.isUserInput&&this._propagateChanges()})}focus(){if(this.disabled)return;let e=this._getFirstSelectedChip();e&&!e.disabled?e.focus():this._chips.length>0?this._keyManager.setFirstItemActive():this._elementRef.nativeElement.focus()}writeValue(e){e!=null?this.value=e:this.value=void 0}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_setSelectionByValue(e,n=!0){this._clearSelection(),Array.isArray(e)?e.forEach(s=>this._selectValue(s,n)):this._selectValue(e,n)}_blur(){this.disabled||setTimeout(()=>{this.focused||this._markAsTouched()})}_keydown(e){e.keyCode===9&&super._allowFocusEscape()}_markAsTouched(){this._onTouched(),this._changeDetectorRef.markForCheck()}_propagateChanges(){let e=null;Array.isArray(this.selected)?e=this.selected.map(n=>n.value):e=this.selected?this.selected.value:void 0,this._value=e,this.change.emit(new BP(this,e)),this._onChange(e),this._changeDetectorRef.markForCheck()}_clearSelection(e){this._chips.forEach(n=>{n!==e&&n.deselect()})}_selectValue(e,n){let s=this._chips.find(r=>r.value!=null&&this.compareWith(r.value,e));return s&&(n?s.selectViaInteraction():s.select()),s}_syncListboxProperties(){this._chips&&Promise.resolve().then(()=>{this._chips.forEach(e=>{e._chipListMultiple=this.multiple,e.chipListSelectable=this._selectable,e._chipListHideSingleSelectionIndicator=this.hideSingleSelectionIndicator,e._changeDetectorRef.markForCheck()})})}_getFirstSelectedChip(){return Array.isArray(this.selected)?this.selected.length?this.selected[0]:void 0:this.selected}_skipPredicate(e){return!e.isInteractive}static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275cmp=Yt({type:i,selectors:[["mat-chip-listbox"]],contentQueries:function(n,s,r){if(n&1&&Mr(r,UP,5),n&2){let y;Bi(y=Vi())&&(s._chips=y)}},hostAttrs:[1,"mdc-evolution-chip-set","mat-mdc-chip-listbox"],hostVars:10,hostBindings:function(n,s){n&1&&_t("focus",function(){return s.focus()})("blur",function(){return s._blur()})("keydown",function(y){return s._keydown(y)}),n&2&&(Ia("tabIndex",s.disabled||s.empty?-1:s.tabIndex),ji("role",s.role)("aria-required",s.role?s.required:null)("aria-disabled",s.disabled.toString())("aria-multiselectable",s.multiple)("aria-orientation",s.ariaOrientation),Ai("mat-mdc-chip-list-disabled",s.disabled)("mat-mdc-chip-list-required",s.required))},inputs:{multiple:[2,"multiple","multiple",xi],ariaOrientation:[0,"aria-orientation","ariaOrientation"],selectable:[2,"selectable","selectable",xi],compareWith:"compareWith",required:[2,"required","required",xi],hideSingleSelectionIndicator:[2,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",xi],value:"value"},outputs:{change:"change"},features:[Vn([Hre]),dn],ngContentSelectors:iH,decls:2,vars:0,consts:[["role","presentation",1,"mdc-evolution-chip-set__chips"]],template:function(n,s){n&1&&(xr(),oe(0,"div",0),an(1),ae())},styles:[Ure],encapsulation:2,changeDetection:0})}return i})();var Ry=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({providers:[Dy,{provide:VP,useValue:{separatorKeyCodes:[13]}}],imports:[An,gy,An]})}return i})();var $re=["determinateSpinner"];function Gre(i,t){if(i&1&&(Da(),oe(0,"svg",11),Et(1,"circle",12),ae()),i&2){let e=bt();ji("viewBox",e._viewBox()),ge(),Gl("stroke-dasharray",e._strokeCircumference(),"px")("stroke-dashoffset",e._strokeCircumference()/2,"px")("stroke-width",e._circleStrokeWidth(),"%"),ji("r",e._circleRadius())}}var qre=new Dt("mat-progress-spinner-default-options",{providedIn:"root",factory:Wre});function Wre(){return{diameter:nH}}var nH=100,Yre=10,ac=(()=>{class i{_elementRef=Z(Ii);_noopAnimations;get color(){return this._color||this._defaultColor}set color(e){this._color=e}_color;_defaultColor="primary";_determinateCircle;constructor(){let e=Z(Vr,{optional:!0}),n=Z(qre);this._noopAnimations=e==="NoopAnimations"&&!!n&&!n._forceAnimations,this.mode=this._elementRef.nativeElement.nodeName.toLowerCase()==="mat-spinner"?"indeterminate":"determinate",n&&(n.color&&(this.color=this._defaultColor=n.color),n.diameter&&(this.diameter=n.diameter),n.strokeWidth&&(this.strokeWidth=n.strokeWidth))}mode;get value(){return this.mode==="determinate"?this._value:0}set value(e){this._value=Math.max(0,Math.min(100,e||0))}_value=0;get diameter(){return this._diameter}set diameter(e){this._diameter=e||0}_diameter=nH;get strokeWidth(){return this._strokeWidth??this.diameter/10}set strokeWidth(e){this._strokeWidth=e||0}_strokeWidth;_circleRadius(){return(this.diameter-Yre)/2}_viewBox(){let e=this._circleRadius()*2+this.strokeWidth;return`0 0 ${e} ${e}`}_strokeCircumference(){return 2*Math.PI*this._circleRadius()}_strokeDashOffset(){return this.mode==="determinate"?this._strokeCircumference()*(100-this._value)/100:null}_circleStrokeWidth(){return this.strokeWidth/this.diameter*100}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-progress-spinner"],["mat-spinner"]],viewQuery:function(n,s){if(n&1&&Bn($re,5),n&2){let r;Bi(r=Vi())&&(s._determinateCircle=r.first)}},hostAttrs:["role","progressbar","tabindex","-1",1,"mat-mdc-progress-spinner","mdc-circular-progress"],hostVars:18,hostBindings:function(n,s){n&2&&(ji("aria-valuemin",0)("aria-valuemax",100)("aria-valuenow",s.mode==="determinate"?s.value:null)("mode",s.mode),Ts("mat-"+s.color),Gl("width",s.diameter,"px")("height",s.diameter,"px")("--mdc-circular-progress-size",s.diameter+"px")("--mdc-circular-progress-active-indicator-width",s.diameter+"px"),Ai("_mat-animation-noopable",s._noopAnimations)("mdc-circular-progress--indeterminate",s.mode==="indeterminate"))},inputs:{color:"color",mode:"mode",value:[2,"value","value",Aa],diameter:[2,"diameter","diameter",Aa],strokeWidth:[2,"strokeWidth","strokeWidth",Aa]},exportAs:["matProgressSpinner"],decls:14,vars:11,consts:[["circle",""],["determinateSpinner",""],["aria-hidden","true",1,"mdc-circular-progress__determinate-container"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__determinate-circle-graphic"],["cx","50%","cy","50%",1,"mdc-circular-progress__determinate-circle"],["aria-hidden","true",1,"mdc-circular-progress__indeterminate-container"],[1,"mdc-circular-progress__spinner-layer"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-left"],[3,"ngTemplateOutlet"],[1,"mdc-circular-progress__gap-patch"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-right"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__indeterminate-circle-graphic"],["cx","50%","cy","50%"]],template:function(n,s){if(n&1&&(pt(0,Gre,2,8,"ng-template",null,0,lp),oe(2,"div",2,1),Da(),oe(4,"svg",3),Et(5,"circle",4),ae()(),hm(),oe(6,"div",5)(7,"div",6)(8,"div",7),Ta(9,8),ae(),oe(10,"div",9),Ta(11,8),ae(),oe(12,"div",10),Ta(13,8),ae()()()),n&2){let r=No(1);ge(4),ji("viewBox",s._viewBox()),ge(),Gl("stroke-dasharray",s._strokeCircumference(),"px")("stroke-dashoffset",s._strokeDashOffset(),"px")("stroke-width",s._circleStrokeWidth(),"%"),ji("r",s._circleRadius()),ge(4),Be("ngTemplateOutlet",r),ge(2),Be("ngTemplateOutlet",r),ge(2),Be("ngTemplateOutlet",r)}},dependencies:[Mb],styles:[`.mat-mdc-progress-spinner{display:block;overflow:hidden;line-height:0;position:relative;direction:ltr;transition:opacity 250ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-progress-spinner circle{stroke-width:var(--mdc-circular-progress-active-indicator-width, 4px)}.mat-mdc-progress-spinner._mat-animation-noopable,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__determinate-circle{transition:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__spinner-layer,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container{animation:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container circle{stroke-dasharray:0 !important}@media(forced-colors: active){.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle{stroke:currentColor;stroke:CanvasText}}.mdc-circular-progress__determinate-container,.mdc-circular-progress__indeterminate-circle-graphic,.mdc-circular-progress__indeterminate-container,.mdc-circular-progress__spinner-layer{position:absolute;width:100%;height:100%}.mdc-circular-progress__determinate-container{transform:rotate(-90deg)}.mdc-circular-progress--indeterminate .mdc-circular-progress__determinate-container{opacity:0}.mdc-circular-progress__indeterminate-container{font-size:0;letter-spacing:0;white-space:nowrap;opacity:0}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{opacity:1;animation:mdc-circular-progress-container-rotate 1568.2352941176ms linear infinite}.mdc-circular-progress__determinate-circle-graphic,.mdc-circular-progress__indeterminate-circle-graphic{fill:rgba(0,0,0,0)}.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:var(--mdc-circular-progress-active-indicator-color, var(--mat-sys-primary))}@media(forced-colors: active){.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mdc-circular-progress__determinate-circle{transition:stroke-dashoffset 500ms cubic-bezier(0, 0, 0.2, 1)}.mdc-circular-progress__gap-patch{position:absolute;top:0;left:47.5%;box-sizing:border-box;width:5%;height:100%;overflow:hidden}.mdc-circular-progress__gap-patch .mdc-circular-progress__indeterminate-circle-graphic{left:-900%;width:2000%;transform:rotate(180deg)}.mdc-circular-progress__circle-clipper .mdc-circular-progress__indeterminate-circle-graphic{width:200%}.mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{left:-100%}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-left .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress__circle-clipper{display:inline-flex;position:relative;width:50%;height:100%;overflow:hidden}.mdc-circular-progress--indeterminate .mdc-circular-progress__spinner-layer{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}@keyframes mdc-circular-progress-container-rotate{to{transform:rotate(360deg)}}@keyframes mdc-circular-progress-spinner-layer-rotate{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes mdc-circular-progress-left-spin{from{transform:rotate(265deg)}50%{transform:rotate(130deg)}to{transform:rotate(265deg)}}@keyframes mdc-circular-progress-right-spin{from{transform:rotate(-265deg)}50%{transform:rotate(-130deg)}to{transform:rotate(-265deg)}}
`],encapsulation:2,changeDetection:0})}return i})();var qd=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({imports:[An]})}return i})();var Zre=()=>[5,10,25],Xre=(i,t,e,n)=>({"status-pending":i,"status-rejected":t,"status-verified":e,"status-resolved":n});function Kre(i,t){if(i&1&&(oe(0,"mat-option",8),Ee(1),ae()),i&2){let e=t.$implicit;Be("value",e),ge(),zi(" ",e," ")}}function Qre(i,t){i&1&&(oe(0,"div",9),Et(1,"mat-spinner",10),ae())}function Jre(i,t){i&1&&(oe(0,"th",25),Ee(1,"T\xEDtulo"),ae())}function eoe(i,t){if(i&1&&(oe(0,"td",26),Ee(1),ae()),i&2){let e=t.$implicit;ge(),tn(e.title)}}function toe(i,t){i&1&&(oe(0,"th",25),Ee(1,"Descripci\xF3n"),ae())}function ioe(i,t){if(i&1&&(oe(0,"td",26),Ee(1),ae()),i&2){let e=t.$implicit;ge(),tn(e.description)}}function noe(i,t){i&1&&(oe(0,"th",25),Ee(1,"Categor\xEDas"),ae())}function roe(i,t){if(i&1&&(oe(0,"mat-chip"),Ee(1),ae()),i&2){let e=t.$implicit;ge(),tn(e.name)}}function ooe(i,t){if(i&1&&(oe(0,"td",26)(1,"mat-chip-set"),pt(2,roe,2,1,"mat-chip",27),ae()()),i&2){let e=t.$implicit;ge(2),Be("ngForOf",e.categoryList)}}function aoe(i,t){i&1&&(oe(0,"th",25),Ee(1,"Ubicaci\xF3n"),ae())}function soe(i,t){if(i&1&&(oe(0,"td",26),Ee(1),ae()),i&2){let e=t.$implicit;ge(),kd(" ",e.latitude,", ",e.longitude," ")}}function loe(i,t){i&1&&(oe(0,"th",25),Ee(1,"Estado"),ae())}function coe(i,t){if(i&1&&(oe(0,"td",26)(1,"span",28),Ee(2),ae()()),i&2){let e=t.$implicit;ge(),Be("ngClass",kE(2,Xre,e.reportStatus==="PENDING",e.reportStatus==="REJECTED",e.reportStatus==="VERIFIED",e.reportStatus==="RESOLVED")),ge(),zi(" ",e.reportStatus," ")}}function doe(i,t){i&1&&(oe(0,"th",25),Ee(1,"Fecha Creaci\xF3n"),ae())}function uoe(i,t){if(i&1&&(oe(0,"td",26),Ee(1),Qs(2,"date"),ae()),i&2){let e=t.$implicit;ge(),zi(" ",Pd(2,1,e.createdAt,"short")," ")}}function hoe(i,t){i&1&&(oe(0,"th",25),Ee(1,"Votos"),ae())}function poe(i,t){if(i&1&&(oe(0,"td",26),Ee(1),ae()),i&2){let e=t.$implicit;ge(),tn(e.importantVotes)}}function foe(i,t){i&1&&(oe(0,"th",25),Ee(1,"Acciones"),ae())}function moe(i,t){if(i&1){let e=bi();bn(0),oe(1,"button",29),_t("click",function(){qt(e);let s=bt().$implicit,r=bt(2);return Wt(r.verifyReport(s.id))}),oe(2,"mat-icon"),Ee(3,"check"),ae(),Ee(4," Verificar "),ae(),oe(5,"button",30),_t("click",function(){qt(e);let s=bt().$implicit,r=bt(2);return Wt(r.rejectReport(s.id))}),oe(6,"mat-icon"),Ee(7,"close"),ae(),Ee(8," Rechazar "),ae(),xn()}}function goe(i,t){if(i&1){let e=bi();bn(0),oe(1,"button",29),_t("click",function(){qt(e);let s=bt().$implicit,r=bt(2);return Wt(r.verifyReport(s.id))}),oe(2,"mat-icon"),Ee(3,"check"),ae(),Ee(4," Verificar "),ae(),xn()}}function _oe(i,t){if(i&1){let e=bi();bn(0),oe(1,"button",31),_t("click",function(){qt(e);let s=bt().$implicit,r=bt(2);return Wt(r.resolveReport(s.id))}),oe(2,"mat-icon"),Ee(3,"done_all"),ae(),Ee(4," Resolver "),ae(),xn()}}function yoe(i,t){if(i&1&&(oe(0,"td",26),pt(1,moe,9,0,"ng-container",7)(2,goe,5,0,"ng-container",7)(3,_oe,5,0,"ng-container",7),ae()),i&2){let e=t.$implicit;ge(),Be("ngIf",e.reportStatus==="PENDING"),ge(),Be("ngIf",e.reportStatus==="REJECTED"),ge(),Be("ngIf",e.reportStatus==="VERIFIED")}}function voe(i,t){i&1&&Et(0,"tr",32)}function boe(i,t){i&1&&Et(0,"tr",33)}function xoe(i,t){if(i&1){let e=bi();oe(0,"div")(1,"table",11),bn(2,12),pt(3,Jre,2,0,"th",13)(4,eoe,2,1,"td",14),xn(),bn(5,15),pt(6,toe,2,0,"th",13)(7,ioe,2,1,"td",14),xn(),bn(8,16),pt(9,noe,2,0,"th",13)(10,ooe,3,1,"td",14),xn(),bn(11,17),pt(12,aoe,2,0,"th",13)(13,soe,2,2,"td",14),xn(),bn(14,18),pt(15,loe,2,0,"th",13)(16,coe,3,7,"td",14),xn(),bn(17,19),pt(18,doe,2,0,"th",13)(19,uoe,3,4,"td",14),xn(),bn(20,20),pt(21,hoe,2,0,"th",13)(22,poe,2,1,"td",14),xn(),bn(23,21),pt(24,foe,2,0,"th",13)(25,yoe,4,3,"td",14),xn(),pt(26,voe,1,0,"tr",22)(27,boe,1,0,"tr",23),ae(),oe(28,"mat-paginator",24),_t("page",function(s){qt(e);let r=bt();return Wt(r.onPageChange(s))}),ae()()}if(i&2){let e=bt();ge(),Be("dataSource",e.filteredContent()),ge(25),Be("matHeaderRowDef",e.displayedColumns),ge(),Be("matRowDefColumns",e.displayedColumns),ge(),Be("length",e.paginatedData().totalElements)("pageSize",e.paginatedData().size)("pageIndex",e.paginatedData().page-1)("pageSizeOptions",$_(7,Zre))}}var XD=class i{reportService=Z(rl);notificationService=Z(Pr);dialog=Z(Il);loading=Lo(!1);paginatedData=Lo({content:[],page:0,size:10,totalElements:0,totalPages:0});router=Z(fn);statuses=["PENDING","VERIFIED","REJECTED","RESOLVED"];selectedStatus=Lo("");filteredContent=Cl(()=>{let t=this.paginatedData().content,e=this.selectedStatus();return e?t.filter(n=>n.reportStatus===e):t});displayedColumns=["title","description","categories","location","reportStatus","dateCreation","importantVotes","actions"];ngOnInit(){this.loadReports(1,10)}loadReports(t,e,n=""){this.loading.set(!0),this.reportService.getAllReportsPaginated(t,e,n).subscribe({next:s=>this.paginatedData.set(s),error:s=>{},complete:()=>this.loading.set(!1)})}verifyReport(t){if(!t)return;let e={title:"Verificar reporte",message:"\xBFSeguro que deseas verificar este reporte?",confirmText:"Verificar",cancelText:"Cancelar"};this.dialog.open(ks,{data:e}).afterClosed().subscribe(n=>{n===!0&&this.reportService.updateReportStatus(t,"VERIFIED").subscribe({next:()=>{this.notificationService.success("\u2705 Reporte verificado correctamente."),this.loadReports(1,10)},error:s=>{console.error("\u274C Error al verificar reporte:",s),this.notificationService.error("Ocurri\xF3 un error al verificar el reporte.")}})})}rejectReport(t){if(!t)return;let e={title:"Rechazar reporte",message:"Por favor, indica el motivo del rechazo:",confirmText:"Rechazar",cancelText:"Cancelar",input:!0,inputPlaceholder:"Motivo de rechazo\u2026"};this.dialog.open(ks,{data:e}).afterClosed().subscribe(n=>{typeof n=="string"&&this.reportService.updateReportStatus(t,"REJECTED",n).subscribe({next:()=>{this.notificationService.success("\u2705 Reporte rechazado correctamente."),this.loadReports(1,10)},error:s=>{console.error("\u274C Error al rechazar reporte:",s),this.notificationService.error("Ocurri\xF3 un error al rechazar el reporte.")}})})}resolveReport(t){if(!t)return;let e={title:"Resolver reporte",message:"\xBFDeseas marcar este reporte como resuelto?",confirmText:"Resolver",cancelText:"Cancelar"};this.dialog.open(ks,{data:e}).afterClosed().subscribe(n=>{n===!0&&this.reportService.updateReportStatus(t,"RESOLVED").subscribe({next:()=>{this.notificationService.success("\u2705 Reporte marcado como resuelto."),this.loadReports(1,10)},error:s=>{console.error("\u274C Error al resolver reporte:",s),this.notificationService.error("Ocurri\xF3 un error al resolver el reporte.")}})})}onPageChange(t){let e=t.pageIndex+1,n=t.pageSize;this.loadReports(e,n,this.selectedStatus())}onStatusChange(t){this.selectedStatus.set(t),this.loadReports(1,this.paginatedData().size,t)}goBack(){this.router.navigate(["/map"])}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Yt({type:i,selectors:[["app-report-list"]],decls:16,vars:4,consts:[["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],[1,"contenedor"],["appearance","outline",1,"status-filter"],[3,"selectionChange","value"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","loading-container",4,"ngIf"],[4,"ngIf"],[3,"value"],[1,"loading-container"],["diameter","50"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","title"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","categories"],["matColumnDef","location"],["matColumnDef","reportStatus"],["matColumnDef","dateCreation"],["matColumnDef","importantVotes"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Seleccionar p\xE1gina",3,"page","length","pageSize","pageIndex","pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],[4,"ngFor","ngForOf"],[3,"ngClass"],["mat-raised-button","","color","primary",1,"action-button",3,"click"],["mat-raised-button","","color","warn",1,"action-button",3,"click"],["mat-raised-button","","color","accent",1,"action-button",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,n){e&1&&(oe(0,"button",0),_t("click",function(){return n.goBack()}),oe(1,"mat-icon"),Ee(2,"arrow_back"),ae()(),oe(3,"mat-card",1)(4,"h1"),Ee(5,"Listado de reportes"),ae(),Et(6,"mat-divider"),oe(7,"mat-form-field",2)(8,"mat-label"),Ee(9,"Filtrar por estado"),ae(),oe(10,"mat-select",3),_t("selectionChange",function(r){return n.onStatusChange(r.value)}),oe(11,"mat-option",4),Ee(12,"Todos"),ae(),pt(13,Kre,2,2,"mat-option",5),ae()(),pt(14,Qre,2,0,"div",6)(15,xoe,29,8,"div",7),ae()),e&2&&(ge(10),Be("value",n.selectedStatus()),ge(3),Be("ngForOf",n.statuses),ge(),Be("ngIf",n.loading()),ge(),Be("ngIf",!n.loading()))},dependencies:[sr,qa,cs,Zn,Uc,us,kl,Jc,td,Uu,ed,qd,ac,Lp,Dp,Tp,kp,Ip,Mp,Pp,Ap,Rp,Op,Fp,Ty,Bm,oc,rc,Ay,ZD,Ry,Vm,Bx,ua,no],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c;--resolve-color: #26a69a;--table-header-bg: #d0eaf5;--table-row-hover: #f2faff}mat-card[_ngcontent-%COMP%]{margin:2rem auto;padding:1.5rem;background:var(--input-bg);box-shadow:0 4px 20px #0000001a;border-radius:12px}mat-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:.5rem;color:var(--primary-dark);font-weight:600;font-size:24px}.status-filter[_ngcontent-%COMP%]{width:250px;margin:1.5rem 0}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:50px 0}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background-color:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px #0000000d}th.mat-header-cell[_ngcontent-%COMP%]{background-color:var(--table-header-bg);color:var(--primary-dark);font-weight:600;padding:12px;border-bottom:1px solid #ccc}td.mat-cell[_ngcontent-%COMP%]{padding:12px 16px;color:#333;border-bottom:1px solid #eee}tr.mat-row[_ngcontent-%COMP%]:hover{background-color:var(--table-row-hover);transition:background-color .2s ease-in-out}mat-chip[_ngcontent-%COMP%]{background-color:var(--primary-accent);color:#fff;font-weight:500;margin-right:5px}.status-pending[_ngcontent-%COMP%], .status-rejected[_ngcontent-%COMP%], .status-verified[_ngcontent-%COMP%], .status-resolved[_ngcontent-%COMP%]{display:inline-block;padding:6px 10px;border-radius:4px;font-weight:600;font-size:13px}.status-pending[_ngcontent-%COMP%]{background-color:#fff59d;color:#444}.status-rejected[_ngcontent-%COMP%]{background-color:#ef9a9a;color:#fff}.status-verified[_ngcontent-%COMP%]{background-color:#a5d6a7;color:#fff}.status-resolved[_ngcontent-%COMP%]{background-color:#81d4fa;color:#fff}td.mat-cell[_ngcontent-%COMP%] > ng-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:8px 0}.action-button[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;gap:6px;height:36px;width:120px;padding:0 12px;font-size:13px;font-weight:500;line-height:1;border-radius:6px;box-shadow:0 2px 4px #0000001a;text-transform:none;box-sizing:border-box;transition:background-color .2s ease,box-shadow .2s ease}.action-button[color=primary][_ngcontent-%COMP%]{background-color:var(--primary-accent);color:#000}.action-button[color=primary][_ngcontent-%COMP%]:hover{background-color:#1e8e81;box-shadow:0 3px 6px #00000026;color:#fff}.action-button[color=warn][_ngcontent-%COMP%]{background-color:var(--error-color);color:#000}.action-button[color=warn][_ngcontent-%COMP%]:hover{background-color:#ac1e08;color:#fff}.action-button[color=accent][_ngcontent-%COMP%]{background-color:var(--resolve-color);color:#000}.action-button[color=accent][_ngcontent-%COMP%]:hover{background-color:#5fa2c9;color:#fff}.action-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;line-height:1}mat-paginator[_ngcontent-%COMP%]{margin-top:1.5rem;background:transparent}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;width:40px;height:40px;padding:0;background-color:#fff;border:1px solid #ccc;border-radius:8px;box-shadow:0 4px 12px #0000000d;display:flex;align-items:center;justify-content:center;transition:background-color .2s ease,transform .1s ease}.back-button[_ngcontent-%COMP%]:hover{background-color:#f9f9f9;transform:translate(-2px)}.back-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;color:#0009}"]})};var woe=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["ng-component"]],hostAttrs:["cdk-text-field-style-loader",""],decls:0,vars:0,template:function(n,s){},styles:[`textarea.cdk-textarea-autosize{resize:none}textarea.cdk-textarea-autosize-measuring{padding:2px 0 !important;box-sizing:content-box !important;height:auto !important;overflow:hidden !important}textarea.cdk-textarea-autosize-measuring-firefox{padding:2px 0 !important;box-sizing:content-box !important;height:0 !important}@keyframes cdk-text-field-autofill-start{/*!*/}@keyframes cdk-text-field-autofill-end{/*!*/}.cdk-text-field-autofill-monitored:-webkit-autofill{animation:cdk-text-field-autofill-start 0s 1ms}.cdk-text-field-autofill-monitored:not(:-webkit-autofill){animation:cdk-text-field-autofill-end 0s 1ms}
`],encapsulation:2,changeDetection:0})}return i})(),Coe={passive:!0},rH=(()=>{class i{_platform=Z(or);_ngZone=Z(ki);_renderer=Z(Sa).createRenderer(null,null);_styleLoader=Z(to);_monitoredElements=new Map;constructor(){}monitor(e){if(!this._platform.isBrowser)return za;this._styleLoader.load(woe);let n=Ml(e),s=this._monitoredElements.get(n);if(s)return s.subject;let r=new ni,y="cdk-text-field-autofilled",A=B=>{B.animationName==="cdk-text-field-autofill-start"&&!n.classList.contains(y)?(n.classList.add(y),this._ngZone.run(()=>r.next({target:B.target,isAutofilled:!0}))):B.animationName==="cdk-text-field-autofill-end"&&n.classList.contains(y)&&(n.classList.remove(y),this._ngZone.run(()=>r.next({target:B.target,isAutofilled:!1})))},P=this._ngZone.runOutsideAngular(()=>(n.classList.add("cdk-text-field-autofill-monitored"),Bo(this._renderer,n,"animationstart",A,Coe)));return this._monitoredElements.set(n,{subject:r,unlisten:P}),r}stopMonitoring(e){let n=Ml(e),s=this._monitoredElements.get(n);s&&(s.unlisten(),s.subject.complete(),n.classList.remove("cdk-text-field-autofill-monitored"),n.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(n))}ngOnDestroy(){this._monitoredElements.forEach((e,n)=>this.stopMonitoring(n))}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var oH=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({})}return i})();var KD=new Dt("MAT_INPUT_VALUE_ACCESSOR");var Eoe=["button","checkbox","file","hidden","image","radio","range","reset","submit"],Soe=new Dt("MAT_INPUT_CONFIG"),ky=(()=>{class i{_elementRef=Z(Ii);_platform=Z(or);ngControl=Z(Al,{optional:!0,self:!0});_autofillMonitor=Z(rH);_ngZone=Z(ki);_formField=Z(Np,{optional:!0});_renderer=Z(Do);_uid=Z(kr).getId("mat-input-");_previousNativeValue;_inputValueAccessor;_signalBasedValueAccessor;_previousPlaceholder;_errorStateTracker;_config=Z(Soe,{optional:!0});_cleanupIosKeyup;_cleanupWebkitWheel;_formFieldDescribedBy;_isServer;_isNativeSelect;_isTextarea;_isInFormField;focused=!1;stateChanges=new ni;controlType="mat-input";autofilled=!1;get disabled(){return this._disabled}set disabled(e){this._disabled=Tl(e),this.focused&&(this.focused=!1,this.stateChanges.next())}_disabled=!1;get id(){return this._id}set id(e){this._id=e||this._uid}_id;placeholder;name;get required(){return this._required??this.ngControl?.control?.hasValidator(si.required)??!1}set required(e){this._required=Tl(e)}_required;get type(){return this._type}set type(e){let n=this._type;this._type=e||"text",this._validateType(),!this._isTextarea&&$2().has(this._type)&&(this._elementRef.nativeElement.type=this._type),this._type!==n&&this._ensureWheelDefaultBehavior()}_type="text";get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(e){this._errorStateTracker.matcher=e}userAriaDescribedBy;get value(){return this._signalBasedValueAccessor?this._signalBasedValueAccessor.value():this._inputValueAccessor.value}set value(e){e!==this.value&&(this._signalBasedValueAccessor?this._signalBasedValueAccessor.value.set(e):this._inputValueAccessor.value=e,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(e){this._readonly=Tl(e)}_readonly=!1;disabledInteractive;get errorState(){return this._errorStateTracker.errorState}set errorState(e){this._errorStateTracker.errorState=e}_neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(e=>$2().has(e));constructor(){let e=Z(Om,{optional:!0}),n=Z(Yr,{optional:!0}),s=Z(Dy),r=Z(KD,{optional:!0,self:!0}),y=this._elementRef.nativeElement,A=y.nodeName.toLowerCase();r?np(r.value)?this._signalBasedValueAccessor=r:this._inputValueAccessor=r:this._inputValueAccessor=y,this._previousNativeValue=this.value,this.id=this.id,this._platform.IOS&&this._ngZone.runOutsideAngular(()=>{this._cleanupIosKeyup=this._renderer.listen(y,"keyup",this._iOSKeyupListener)}),this._errorStateTracker=new My(s,this.ngControl,n,e,this.stateChanges),this._isServer=!this._platform.isBrowser,this._isNativeSelect=A==="select",this._isTextarea=A==="textarea",this._isInFormField=!!this._formField,this.disabledInteractive=this._config?.disabledInteractive||!1,this._isNativeSelect&&(this.controlType=y.multiple?"mat-native-select-multiple":"mat-native-select"),this._signalBasedValueAccessor&&bb(()=>{this._signalBasedValueAccessor.value(),this.stateChanges.next()})}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(e=>{this.autofilled=e.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._cleanupIosKeyup?.(),this._cleanupWebkitWheel?.()}ngDoCheck(){this.ngControl&&(this.updateErrorState(),this.ngControl.disabled!==null&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(e){this._elementRef.nativeElement.focus(e)}updateErrorState(){this._errorStateTracker.updateErrorState()}_focusChanged(e){if(e!==this.focused){if(!this._isNativeSelect&&e&&this.disabled&&this.disabledInteractive){let n=this._elementRef.nativeElement;n.type==="number"?(n.type="text",n.setSelectionRange(0,0),n.type="number"):n.setSelectionRange(0,0)}this.focused=e,this.stateChanges.next()}}_onInput(){}_dirtyCheckNativeValue(){let e=this._elementRef.nativeElement.value;this._previousNativeValue!==e&&(this._previousNativeValue=e,this.stateChanges.next())}_dirtyCheckPlaceholder(){let e=this._getPlaceholder();if(e!==this._previousPlaceholder){let n=this._elementRef.nativeElement;this._previousPlaceholder=e,e?n.setAttribute("placeholder",e):n.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){Eoe.indexOf(this._type)>-1}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let e=this._elementRef.nativeElement.validity;return e&&e.badInput}get empty(){return!this._isNeverEmpty()&&!this._elementRef.nativeElement.value&&!this._isBadInput()&&!this.autofilled}get shouldLabelFloat(){if(this._isNativeSelect){let e=this._elementRef.nativeElement,n=e.options[0];return this.focused||e.multiple||!this.empty||!!(e.selectedIndex>-1&&n&&n.label)}else return this.focused&&!this.disabled||!this.empty}setDescribedByIds(e){let n=this._elementRef.nativeElement,s=n.getAttribute("aria-describedby"),r;if(s){let y=this._formFieldDescribedBy||e;r=e.concat(s.split(" ").filter(A=>A&&!y.includes(A)))}else r=e;this._formFieldDescribedBy=e,r.length?n.setAttribute("aria-describedby",r.join(" ")):n.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){let e=this._elementRef.nativeElement;return this._isNativeSelect&&(e.multiple||e.size>1)}_iOSKeyupListener=e=>{let n=e.target;!n.value&&n.selectionStart===0&&n.selectionEnd===0&&(n.setSelectionRange(1,1),n.setSelectionRange(0,0))};_webkitBlinkWheelListener=()=>{};_ensureWheelDefaultBehavior(){this._cleanupWebkitWheel?.(),this._type==="number"&&(this._platform.BLINK||this._platform.WEBKIT)&&(this._cleanupWebkitWheel=this._renderer.listen(this._elementRef.nativeElement,"wheel",this._webkitBlinkWheelListener))}_getReadonlyAttribute(){return this._isNativeSelect?null:this.readonly||this.disabled&&this.disabledInteractive?"true":null}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:21,hostBindings:function(n,s){n&1&&_t("focus",function(){return s._focusChanged(!0)})("blur",function(){return s._focusChanged(!1)})("input",function(){return s._onInput()}),n&2&&(Ia("id",s.id)("disabled",s.disabled&&!s.disabledInteractive)("required",s.required),ji("name",s.name||null)("readonly",s._getReadonlyAttribute())("aria-disabled",s.disabled&&s.disabledInteractive?"true":null)("aria-invalid",s.empty&&s.required?null:s.errorState)("aria-required",s.required)("id",s.id),Ai("mat-input-server",s._isServer)("mat-mdc-form-field-textarea-control",s._isInFormField&&s._isTextarea)("mat-mdc-form-field-input-control",s._isInFormField)("mat-mdc-input-disabled-interactive",s.disabledInteractive)("mdc-text-field__input",s._isInFormField)("mat-mdc-native-select-inline",s._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:[0,"aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly",disabledInteractive:[2,"disabledInteractive","disabledInteractive",xi]},exportAs:["matInput"],features:[Vn([{provide:zm,useExisting:i}]),fr]})}return i})(),Py=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({imports:[An,us,us,oH,An]})}return i})();var WP=new Dt("MAT_DATE_LOCALE",{providedIn:"root",factory:Doe});function Doe(){return Z(G_)}var Oy="Method not implemented",hs=class{locale;_localeChanges=new ni;localeChanges=this._localeChanges;setTime(t,e,n,s){throw new Error(Oy)}getHours(t){throw new Error(Oy)}getMinutes(t){throw new Error(Oy)}getSeconds(t){throw new Error(Oy)}parseTime(t,e){throw new Error(Oy)}addSeconds(t,e){throw new Error(Oy)}getValidDateOrNull(t){return this.isDateInstance(t)&&this.isValid(t)?t:null}deserialize(t){return t==null||this.isDateInstance(t)&&this.isValid(t)?t:this.invalid()}setLocale(t){this.locale=t,this._localeChanges.next()}compareDate(t,e){return this.getYear(t)-this.getYear(e)||this.getMonth(t)-this.getMonth(e)||this.getDate(t)-this.getDate(e)}compareTime(t,e){return this.getHours(t)-this.getHours(e)||this.getMinutes(t)-this.getMinutes(e)||this.getSeconds(t)-this.getSeconds(e)}sameDate(t,e){if(t&&e){let n=this.isValid(t),s=this.isValid(e);return n&&s?!this.compareDate(t,e):n==s}return t==e}sameTime(t,e){if(t&&e){let n=this.isValid(t),s=this.isValid(e);return n&&s?!this.compareTime(t,e):n==s}return t==e}clampDate(t,e,n){return e&&this.compareDate(t,e)<0?e:n&&this.compareDate(t,n)>0?n:t}},jp=new Dt("mat-date-formats");var Moe=["mat-calendar-body",""];function Toe(i,t){return this._trackRow(t)}var pH=(i,t)=>t.id;function Ioe(i,t){if(i&1&&(oe(0,"tr",0)(1,"td",3),Ee(2),ae()()),i&2){let e=bt();ge(),Gl("padding-top",e._cellPadding)("padding-bottom",e._cellPadding),ji("colspan",e.numCols),ge(),zi(" ",e.label," ")}}function Aoe(i,t){if(i&1&&(oe(0,"td",3),Ee(1),ae()),i&2){let e=bt(2);Gl("padding-top",e._cellPadding)("padding-bottom",e._cellPadding),ji("colspan",e._firstRowOffset),ge(),zi(" ",e._firstRowOffset>=e.labelMinRequiredCells?e.label:""," ")}}function Roe(i,t){if(i&1){let e=bi();oe(0,"td",6)(1,"button",7),_t("click",function(s){let r=qt(e).$implicit,y=bt(2);return Wt(y._cellClicked(r,s))})("focus",function(s){let r=qt(e).$implicit,y=bt(2);return Wt(y._emitActiveDateChange(r,s))}),oe(2,"span",8),Ee(3),ae(),Et(4,"span",9),ae()()}if(i&2){let e=t.$implicit,n=t.$index,s=bt().$index,r=bt();Gl("width",r._cellWidth)("padding-top",r._cellPadding)("padding-bottom",r._cellPadding),ji("data-mat-row",s)("data-mat-col",n),ge(),Ai("mat-calendar-body-disabled",!e.enabled)("mat-calendar-body-active",r._isActiveCell(s,n))("mat-calendar-body-range-start",r._isRangeStart(e.compareValue))("mat-calendar-body-range-end",r._isRangeEnd(e.compareValue))("mat-calendar-body-in-range",r._isInRange(e.compareValue))("mat-calendar-body-comparison-bridge-start",r._isComparisonBridgeStart(e.compareValue,s,n))("mat-calendar-body-comparison-bridge-end",r._isComparisonBridgeEnd(e.compareValue,s,n))("mat-calendar-body-comparison-start",r._isComparisonStart(e.compareValue))("mat-calendar-body-comparison-end",r._isComparisonEnd(e.compareValue))("mat-calendar-body-in-comparison-range",r._isInComparisonRange(e.compareValue))("mat-calendar-body-preview-start",r._isPreviewStart(e.compareValue))("mat-calendar-body-preview-end",r._isPreviewEnd(e.compareValue))("mat-calendar-body-in-preview",r._isInPreview(e.compareValue)),Be("ngClass",e.cssClasses)("tabindex",r._isActiveCell(s,n)?0:-1),ji("aria-label",e.ariaLabel)("aria-disabled",!e.enabled||null)("aria-pressed",r._isSelected(e.compareValue))("aria-current",r.todayValue===e.compareValue?"date":null)("aria-describedby",r._getDescribedby(e.compareValue)),ge(),Ai("mat-calendar-body-selected",r._isSelected(e.compareValue))("mat-calendar-body-comparison-identical",r._isComparisonIdentical(e.compareValue))("mat-calendar-body-today",r.todayValue===e.compareValue),ge(),zi(" ",e.displayValue," ")}}function koe(i,t){if(i&1&&(oe(0,"tr",1),pt(1,Aoe,2,6,"td",4),U_(2,Roe,5,48,"td",5,pH),ae()),i&2){let e=t.$implicit,n=t.$index,s=bt();ge(),un(n===0&&s._firstRowOffset?1:-1),ge(),H_(e)}}function Poe(i,t){if(i&1&&(oe(0,"th",2)(1,"span",6),Ee(2),ae(),oe(3,"span",3),Ee(4),ae()()),i&2){let e=t.$implicit;ge(2),tn(e.long),ge(2),tn(e.narrow)}}var Ooe=["*"];function Foe(i,t){}function Loe(i,t){if(i&1){let e=bi();oe(0,"mat-month-view",4),Au("activeDateChange",function(s){qt(e);let r=bt();return sp(r.activeDate,s)||(r.activeDate=s),Wt(s)}),_t("_userSelection",function(s){qt(e);let r=bt();return Wt(r._dateSelected(s))})("dragStarted",function(s){qt(e);let r=bt();return Wt(r._dragStarted(s))})("dragEnded",function(s){qt(e);let r=bt();return Wt(r._dragEnded(s))}),ae()}if(i&2){let e=bt();Iu("activeDate",e.activeDate),Be("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)("comparisonStart",e.comparisonStart)("comparisonEnd",e.comparisonEnd)("startDateAccessibleName",e.startDateAccessibleName)("endDateAccessibleName",e.endDateAccessibleName)("activeDrag",e._activeDrag)}}function Noe(i,t){if(i&1){let e=bi();oe(0,"mat-year-view",5),Au("activeDateChange",function(s){qt(e);let r=bt();return sp(r.activeDate,s)||(r.activeDate=s),Wt(s)}),_t("monthSelected",function(s){qt(e);let r=bt();return Wt(r._monthSelectedInYearView(s))})("selectedChange",function(s){qt(e);let r=bt();return Wt(r._goToDateInView(s,"month"))}),ae()}if(i&2){let e=bt();Iu("activeDate",e.activeDate),Be("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)}}function zoe(i,t){if(i&1){let e=bi();oe(0,"mat-multi-year-view",6),Au("activeDateChange",function(s){qt(e);let r=bt();return sp(r.activeDate,s)||(r.activeDate=s),Wt(s)}),_t("yearSelected",function(s){qt(e);let r=bt();return Wt(r._yearSelectedInMultiYearView(s))})("selectedChange",function(s){qt(e);let r=bt();return Wt(r._goToDateInView(s,"year"))}),ae()}if(i&2){let e=bt();Iu("activeDate",e.activeDate),Be("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)}}function Boe(i,t){}var Voe=["button"],joe=[[["","matDatepickerToggleIcon",""]]],Uoe=["[matDatepickerToggleIcon]"];function Hoe(i,t){i&1&&(Da(),oe(0,"svg",2),Et(1,"path",3),ae())}var Ny=(()=>{class i{changes=new ni;calendarLabel="Calendar";openCalendarLabel="Open calendar";closeCalendarLabel="Close calendar";prevMonthLabel="Previous month";nextMonthLabel="Next month";prevYearLabel="Previous year";nextYearLabel="Next year";prevMultiYearLabel="Previous 24 years";nextMultiYearLabel="Next 24 years";switchToMonthViewLabel="Choose date";switchToMultiYearViewLabel="Choose month and year";startDateLabel="Start date";endDateLabel="End date";comparisonDateLabel="Comparison range";formatYearRange(e,n){return`${e} \u2013 ${n}`}formatYearRangeLabel(e,n){return`${e} to ${n}`}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),$oe=0,Hx=class{value;displayValue;ariaLabel;enabled;cssClasses;compareValue;rawValue;id=$oe++;constructor(t,e,n,s,r={},y=t,A){this.value=t,this.displayValue=e,this.ariaLabel=n,this.enabled=s,this.cssClasses=r,this.compareValue=y,this.rawValue=A}},Goe={passive:!1,capture:!0},QD={passive:!0,capture:!0},aH={passive:!0},Ly=(()=>{class i{_elementRef=Z(Ii);_ngZone=Z(ki);_platform=Z(or);_intl=Z(Ny);_eventCleanups;_skipNextFocus;_focusActiveCellAfterViewChecked=!1;label;rows;todayValue;startValue;endValue;labelMinRequiredCells;numCols=7;activeCell=0;ngAfterViewChecked(){this._focusActiveCellAfterViewChecked&&(this._focusActiveCell(),this._focusActiveCellAfterViewChecked=!1)}isRange=!1;cellAspectRatio=1;comparisonStart;comparisonEnd;previewStart=null;previewEnd=null;startDateAccessibleName;endDateAccessibleName;selectedValueChange=new ui;previewChange=new ui;activeDateChange=new ui;dragStarted=new ui;dragEnded=new ui;_firstRowOffset;_cellPadding;_cellWidth;_startDateLabelId;_endDateLabelId;_comparisonStartDateLabelId;_comparisonEndDateLabelId;_didDragSinceMouseDown=!1;_injector=Z(vn);comparisonDateAccessibleName=this._intl.comparisonDateLabel;_trackRow=e=>e;constructor(){let e=Z(Do),n=Z(kr);this._startDateLabelId=n.getId("mat-calendar-body-start-"),this._endDateLabelId=n.getId("mat-calendar-body-end-"),this._comparisonStartDateLabelId=n.getId("mat-calendar-body-comparison-start-"),this._comparisonEndDateLabelId=n.getId("mat-calendar-body-comparison-end-"),Z(to).load(Zc),this._ngZone.runOutsideAngular(()=>{let s=this._elementRef.nativeElement,r=[Bo(e,s,"touchmove",this._touchmoveHandler,Goe),Bo(e,s,"mouseenter",this._enterHandler,QD),Bo(e,s,"focus",this._enterHandler,QD),Bo(e,s,"mouseleave",this._leaveHandler,QD),Bo(e,s,"blur",this._leaveHandler,QD),Bo(e,s,"mousedown",this._mousedownHandler,aH),Bo(e,s,"touchstart",this._mousedownHandler,aH)];this._platform.isBrowser&&r.push(e.listen("window","mouseup",this._mouseupHandler),e.listen("window","touchend",this._touchendHandler)),this._eventCleanups=r})}_cellClicked(e,n){this._didDragSinceMouseDown||e.enabled&&this.selectedValueChange.emit({value:e.value,event:n})}_emitActiveDateChange(e,n){e.enabled&&this.activeDateChange.emit({value:e.value,event:n})}_isSelected(e){return this.startValue===e||this.endValue===e}ngOnChanges(e){let n=e.numCols,{rows:s,numCols:r}=this;(e.rows||n)&&(this._firstRowOffset=s&&s.length&&s[0].length?r-s[0].length:0),(e.cellAspectRatio||n||!this._cellPadding)&&(this._cellPadding=`${50*this.cellAspectRatio/r}%`),(n||!this._cellWidth)&&(this._cellWidth=`${100/r}%`)}ngOnDestroy(){this._eventCleanups.forEach(e=>e())}_isActiveCell(e,n){let s=e*this.numCols+n;return e&&(s-=this._firstRowOffset),s==this.activeCell}_focusActiveCell(e=!0){Ma(()=>{setTimeout(()=>{let n=this._elementRef.nativeElement.querySelector(".mat-calendar-body-active");n&&(e||(this._skipNextFocus=!0),n.focus())})},{injector:this._injector})}_scheduleFocusActiveCellAfterViewChecked(){this._focusActiveCellAfterViewChecked=!0}_isRangeStart(e){return XP(e,this.startValue,this.endValue)}_isRangeEnd(e){return KP(e,this.startValue,this.endValue)}_isInRange(e){return QP(e,this.startValue,this.endValue,this.isRange)}_isComparisonStart(e){return XP(e,this.comparisonStart,this.comparisonEnd)}_isComparisonBridgeStart(e,n,s){if(!this._isComparisonStart(e)||this._isRangeStart(e)||!this._isInRange(e))return!1;let r=this.rows[n][s-1];if(!r){let y=this.rows[n-1];r=y&&y[y.length-1]}return r&&!this._isRangeEnd(r.compareValue)}_isComparisonBridgeEnd(e,n,s){if(!this._isComparisonEnd(e)||this._isRangeEnd(e)||!this._isInRange(e))return!1;let r=this.rows[n][s+1];if(!r){let y=this.rows[n+1];r=y&&y[0]}return r&&!this._isRangeStart(r.compareValue)}_isComparisonEnd(e){return KP(e,this.comparisonStart,this.comparisonEnd)}_isInComparisonRange(e){return QP(e,this.comparisonStart,this.comparisonEnd,this.isRange)}_isComparisonIdentical(e){return this.comparisonStart===this.comparisonEnd&&e===this.comparisonStart}_isPreviewStart(e){return XP(e,this.previewStart,this.previewEnd)}_isPreviewEnd(e){return KP(e,this.previewStart,this.previewEnd)}_isInPreview(e){return QP(e,this.previewStart,this.previewEnd,this.isRange)}_getDescribedby(e){if(!this.isRange)return null;if(this.startValue===e&&this.endValue===e)return`${this._startDateLabelId} ${this._endDateLabelId}`;if(this.startValue===e)return this._startDateLabelId;if(this.endValue===e)return this._endDateLabelId;if(this.comparisonStart!==null&&this.comparisonEnd!==null){if(e===this.comparisonStart&&e===this.comparisonEnd)return`${this._comparisonStartDateLabelId} ${this._comparisonEndDateLabelId}`;if(e===this.comparisonStart)return this._comparisonStartDateLabelId;if(e===this.comparisonEnd)return this._comparisonEndDateLabelId}return null}_enterHandler=e=>{if(this._skipNextFocus&&e.type==="focus"){this._skipNextFocus=!1;return}if(e.target&&this.isRange){let n=this._getCellFromElement(e.target);n&&this._ngZone.run(()=>this.previewChange.emit({value:n.enabled?n:null,event:e}))}};_touchmoveHandler=e=>{if(!this.isRange)return;let n=sH(e),s=n?this._getCellFromElement(n):null;n!==e.target&&(this._didDragSinceMouseDown=!0),ZP(e.target)&&e.preventDefault(),this._ngZone.run(()=>this.previewChange.emit({value:s?.enabled?s:null,event:e}))};_leaveHandler=e=>{this.previewEnd!==null&&this.isRange&&(e.type!=="blur"&&(this._didDragSinceMouseDown=!0),e.target&&this._getCellFromElement(e.target)&&!(e.relatedTarget&&this._getCellFromElement(e.relatedTarget))&&this._ngZone.run(()=>this.previewChange.emit({value:null,event:e})))};_mousedownHandler=e=>{if(!this.isRange)return;this._didDragSinceMouseDown=!1;let n=e.target&&this._getCellFromElement(e.target);!n||!this._isInRange(n.compareValue)||this._ngZone.run(()=>{this.dragStarted.emit({value:n.rawValue,event:e})})};_mouseupHandler=e=>{if(!this.isRange)return;let n=ZP(e.target);if(!n){this._ngZone.run(()=>{this.dragEnded.emit({value:null,event:e})});return}n.closest(".mat-calendar-body")===this._elementRef.nativeElement&&this._ngZone.run(()=>{let s=this._getCellFromElement(n);this.dragEnded.emit({value:s?.rawValue??null,event:e})})};_touchendHandler=e=>{let n=sH(e);n&&this._mouseupHandler({target:n})};_getCellFromElement(e){let n=ZP(e);if(n){let s=n.getAttribute("data-mat-row"),r=n.getAttribute("data-mat-col");if(s&&r)return this.rows[parseInt(s)][parseInt(r)]}return null}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["","mat-calendar-body",""]],hostAttrs:[1,"mat-calendar-body"],inputs:{label:"label",rows:"rows",todayValue:"todayValue",startValue:"startValue",endValue:"endValue",labelMinRequiredCells:"labelMinRequiredCells",numCols:"numCols",activeCell:"activeCell",isRange:"isRange",cellAspectRatio:"cellAspectRatio",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",previewStart:"previewStart",previewEnd:"previewEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedValueChange:"selectedValueChange",previewChange:"previewChange",activeDateChange:"activeDateChange",dragStarted:"dragStarted",dragEnded:"dragEnded"},exportAs:["matCalendarBody"],features:[fr],attrs:Moe,decls:11,vars:11,consts:[["aria-hidden","true"],["role","row"],[1,"mat-calendar-body-hidden-label",3,"id"],[1,"mat-calendar-body-label"],[1,"mat-calendar-body-label",3,"paddingTop","paddingBottom"],["role","gridcell",1,"mat-calendar-body-cell-container",3,"width","paddingTop","paddingBottom"],["role","gridcell",1,"mat-calendar-body-cell-container"],["type","button",1,"mat-calendar-body-cell",3,"click","focus","ngClass","tabindex"],[1,"mat-calendar-body-cell-content","mat-focus-indicator"],["aria-hidden","true",1,"mat-calendar-body-cell-preview"]],template:function(n,s){n&1&&(pt(0,Ioe,3,6,"tr",0),U_(1,koe,4,1,"tr",1,Toe,!0),oe(3,"span",2),Ee(4),ae(),oe(5,"span",2),Ee(6),ae(),oe(7,"span",2),Ee(8),ae(),oe(9,"span",2),Ee(10),ae()),n&2&&(un(s._firstRowOffset<s.labelMinRequiredCells?0:-1),ge(),H_(s.rows),ge(2),Be("id",s._startDateLabelId),ge(),zi(" ",s.startDateAccessibleName,`
`),ge(),Be("id",s._endDateLabelId),ge(),zi(" ",s.endDateAccessibleName,`
`),ge(),Be("id",s._comparisonStartDateLabelId),ge(),kd(" ",s.comparisonDateAccessibleName," ",s.startDateAccessibleName,`
`),ge(),Be("id",s._comparisonEndDateLabelId),ge(),kd(" ",s.comparisonDateAccessibleName," ",s.endDateAccessibleName,`
`))},dependencies:[qa],styles:[`.mat-calendar-body{min-width:224px}.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-outline-color, var(--mat-sys-primary))}.mat-calendar-body-label{height:0;line-height:0;text-align:start;padding-left:4.7142857143%;padding-right:4.7142857143%;font-size:var(--mat-datepicker-calendar-body-label-text-size, var(--mat-sys-title-small-size));font-weight:var(--mat-datepicker-calendar-body-label-text-weight, var(--mat-sys-title-small-weight));color:var(--mat-datepicker-calendar-body-label-text-color, var(--mat-sys-on-surface))}.mat-calendar-body-hidden-label{display:none}.mat-calendar-body-cell-container{position:relative;height:0;line-height:0}.mat-calendar-body-cell{position:absolute;top:0;left:0;width:100%;height:100%;background:none;text-align:center;outline:none;font-family:inherit;margin:0;font-family:var(--mat-datepicker-calendar-text-font, var(--mat-sys-body-medium-font));font-size:var(--mat-datepicker-calendar-text-size, var(--mat-sys-body-medium-size));-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-calendar-body-cell::-moz-focus-inner{border:0}.mat-calendar-body-cell::before,.mat-calendar-body-cell::after,.mat-calendar-body-cell-preview{content:"";position:absolute;top:5%;left:0;z-index:0;box-sizing:border-box;display:block;height:90%;width:100%}.mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-start::after,.mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,.mat-calendar-body-comparison-start::after,.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:5%;width:95%;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,[dir=rtl] .mat-calendar-body-comparison-start::after,[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:0;border-radius:0;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,.mat-calendar-body-comparison-end::after,.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}[dir=rtl] .mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,[dir=rtl] .mat-calendar-body-comparison-end::after,[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{left:5%;border-radius:0;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-comparison-bridge-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-bridge-end.mat-calendar-body-range-start::after{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end.mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-end.mat-calendar-body-range-start::after{width:90%}.mat-calendar-body-in-preview{color:var(--mat-datepicker-calendar-date-preview-state-outline-color, var(--mat-sys-primary))}.mat-calendar-body-in-preview .mat-calendar-body-cell-preview{border-top:dashed 1px;border-bottom:dashed 1px}.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:dashed 1px}[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:0;border-right:dashed 1px}.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:dashed 1px}[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:0;border-left:dashed 1px}.mat-calendar-body-disabled{cursor:default}.mat-calendar-body-disabled>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){color:var(--mat-datepicker-calendar-date-disabled-state-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-calendar-body-disabled>.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-disabled-state-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}@media(forced-colors: active){.mat-calendar-body-disabled{opacity:.5}}.mat-calendar-body-cell-content{top:5%;left:5%;z-index:1;display:flex;align-items:center;justify-content:center;box-sizing:border-box;width:90%;height:90%;line-height:1;border-width:1px;border-style:solid;border-radius:999px;color:var(--mat-datepicker-calendar-date-text-color, var(--mat-sys-on-surface));border-color:var(--mat-datepicker-calendar-date-outline-color, transparent)}.mat-calendar-body-cell-content.mat-focus-indicator{position:absolute}@media(forced-colors: active){.mat-calendar-body-cell-content{border:none}}.cdk-keyboard-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical),.cdk-program-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-focus-state-background-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-focus-state-layer-opacity) * 100%), transparent))}@media(hover: hover){.mat-calendar-body-cell:not(.mat-calendar-body-disabled):hover>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-hover-state-background-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-hover-state-layer-opacity) * 100%), transparent))}}.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-state-background-color, var(--mat-sys-primary));color:var(--mat-datepicker-calendar-date-selected-state-text-color, var(--mat-sys-on-primary))}.mat-calendar-body-disabled>.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-disabled-state-background-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-calendar-body-selected.mat-calendar-body-today{box-shadow:inset 0 0 0 1px var(--mat-datepicker-calendar-date-today-selected-state-outline-color, var(--mat-sys-primary))}.mat-calendar-body-in-range::before{background:var(--mat-datepicker-calendar-date-in-range-state-background-color, var(--mat-sys-primary-container))}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color, var(--mat-sys-tertiary-container))}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color, var(--mat-sys-tertiary-container))}.mat-calendar-body-comparison-bridge-start::before,[dir=rtl] .mat-calendar-body-comparison-bridge-end::before{background:linear-gradient(to right, var(--mat-datepicker-calendar-date-in-range-state-background-color, var(--mat-sys-primary-container)) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color, var(--mat-sys-tertiary-container)) 50%)}.mat-calendar-body-comparison-bridge-end::before,[dir=rtl] .mat-calendar-body-comparison-bridge-start::before{background:linear-gradient(to left, var(--mat-datepicker-calendar-date-in-range-state-background-color, var(--mat-sys-primary-container)) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color, var(--mat-sys-tertiary-container)) 50%)}.mat-calendar-body-in-range>.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range.mat-calendar-body-in-range::after{background:var(--mat-datepicker-calendar-date-in-overlap-range-state-background-color, var(--mat-sys-secondary-container))}.mat-calendar-body-comparison-identical.mat-calendar-body-selected,.mat-calendar-body-in-comparison-range>.mat-calendar-body-selected{background:var(--mat-datepicker-calendar-date-in-overlap-range-selected-state-background-color, var(--mat-sys-secondary))}@media(forced-colors: active){.mat-datepicker-popup:not(:empty),.mat-calendar-body-cell:not(.mat-calendar-body-in-range) .mat-calendar-body-selected{outline:solid 1px}.mat-calendar-body-today{outline:dotted 1px}.mat-calendar-body-cell::before,.mat-calendar-body-cell::after,.mat-calendar-body-selected{background:none}.mat-calendar-body-in-range::before,.mat-calendar-body-comparison-bridge-start::before,.mat-calendar-body-comparison-bridge-end::before{border-top:solid 1px;border-bottom:solid 1px}.mat-calendar-body-range-start::before{border-left:solid 1px}[dir=rtl] .mat-calendar-body-range-start::before{border-left:0;border-right:solid 1px}.mat-calendar-body-range-end::before{border-right:solid 1px}[dir=rtl] .mat-calendar-body-range-end::before{border-right:0;border-left:solid 1px}.mat-calendar-body-in-comparison-range::before{border-top:dashed 1px;border-bottom:dashed 1px}.mat-calendar-body-comparison-start::before{border-left:dashed 1px}[dir=rtl] .mat-calendar-body-comparison-start::before{border-left:0;border-right:dashed 1px}.mat-calendar-body-comparison-end::before{border-right:dashed 1px}[dir=rtl] .mat-calendar-body-comparison-end::before{border-right:0;border-left:dashed 1px}}
`],encapsulation:2,changeDetection:0})}return i})();function YP(i){return i?.nodeName==="TD"}function ZP(i){let t;return YP(i)?t=i:YP(i.parentNode)?t=i.parentNode:YP(i.parentNode?.parentNode)&&(t=i.parentNode.parentNode),t?.getAttribute("data-mat-row")!=null?t:null}function XP(i,t,e){return e!==null&&t!==e&&i<e&&i===t}function KP(i,t,e){return t!==null&&t!==e&&i>=t&&i===e}function QP(i,t,e,n){return n&&t!==null&&e!==null&&t!==e&&i>=t&&i<=e}function sH(i){let t=i.changedTouches[0];return document.elementFromPoint(t.clientX,t.clientY)}var sc=class{start;end;_disableStructuralEquivalency;constructor(t,e){this.start=t,this.end=e}},$x=(()=>{class i{selection;_adapter;_selectionChanged=new ni;selectionChanged=this._selectionChanged;constructor(e,n){this.selection=e,this._adapter=n,this.selection=e}updateSelection(e,n){let s=this.selection;this.selection=e,this._selectionChanged.next({selection:e,source:n,oldValue:s})}ngOnDestroy(){this._selectionChanged.complete()}_isValidDateInstance(e){return this._adapter.isDateInstance(e)&&this._adapter.isValid(e)}static \u0275fac=function(n){AE()};static \u0275prov=Mt({token:i,factory:i.\u0275fac})}return i})(),qoe=(()=>{class i extends $x{constructor(e){super(null,e)}add(e){super.updateSelection(e,this)}isValid(){return this.selection!=null&&this._isValidDateInstance(this.selection)}isComplete(){return this.selection!=null}clone(){let e=new i(this._adapter);return e.updateSelection(this.selection,this),e}static \u0275fac=function(n){return new(n||i)(hi(hs))};static \u0275prov=Mt({token:i,factory:i.\u0275fac})}return i})();function Woe(i,t){return i||new qoe(t)}var fH={provide:$x,deps:[[new tp,new R_,$x],hs],useFactory:Woe};var mH=new Dt("MAT_DATE_RANGE_SELECTION_STRATEGY");var JP=7,Yoe=0,lH=(()=>{class i{_changeDetectorRef=Z($n);_dateFormats=Z(jp,{optional:!0});_dateAdapter=Z(hs,{optional:!0});_dir=Z(vo,{optional:!0});_rangeStrategy=Z(mH,{optional:!0});_rerenderSubscription=Tn.EMPTY;_selectionKeyPressed;get activeDate(){return this._activeDate}set activeDate(e){let n=this._activeDate,s=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(s,this.minDate,this.maxDate),this._hasSameMonthAndYear(n,this._activeDate)||this._init()}_activeDate;get selected(){return this._selected}set selected(e){e instanceof sc?this._selected=e:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setRanges(this._selected)}_selected;get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_minDate;get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_maxDate;dateFilter;dateClass;comparisonStart;comparisonEnd;startDateAccessibleName;endDateAccessibleName;activeDrag=null;selectedChange=new ui;_userSelection=new ui;dragStarted=new ui;dragEnded=new ui;activeDateChange=new ui;_matCalendarBody;_monthLabel;_weeks;_firstWeekOffset;_rangeStart;_rangeEnd;_comparisonRangeStart;_comparisonRangeEnd;_previewStart;_previewEnd;_isRange;_todayDate;_weekdays;constructor(){Z(to).load(Ql),this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(go(null)).subscribe(()=>this._init())}ngOnChanges(e){let n=e.comparisonStart||e.comparisonEnd;n&&!n.firstChange&&this._setRanges(this.selected),e.activeDrag&&!this.activeDrag&&this._clearPreview()}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_dateSelected(e){let n=e.value,s=this._getDateFromDayOfMonth(n),r,y;this._selected instanceof sc?(r=this._getDateInCurrentMonth(this._selected.start),y=this._getDateInCurrentMonth(this._selected.end)):r=y=this._getDateInCurrentMonth(this._selected),(r!==n||y!==n)&&this.selectedChange.emit(s),this._userSelection.emit({value:s,event:e.event}),this._clearPreview(),this._changeDetectorRef.markForCheck()}_updateActiveDate(e){let n=e.value,s=this._activeDate;this.activeDate=this._getDateFromDayOfMonth(n),this._dateAdapter.compareDate(s,this.activeDate)&&this.activeDateChange.emit(this._activeDate)}_handleCalendarBodyKeydown(e){let n=this._activeDate,s=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,s?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,s?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,-7);break;case 40:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,7);break;case 36:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,1-this._dateAdapter.getDate(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,this._dateAdapter.getNumDaysInMonth(this._activeDate)-this._dateAdapter.getDate(this._activeDate));break;case 33:this.activeDate=e.altKey?this._dateAdapter.addCalendarYears(this._activeDate,-1):this._dateAdapter.addCalendarMonths(this._activeDate,-1);break;case 34:this.activeDate=e.altKey?this._dateAdapter.addCalendarYears(this._activeDate,1):this._dateAdapter.addCalendarMonths(this._activeDate,1);break;case 13:case 32:this._selectionKeyPressed=!0,this._canSelect(this._activeDate)&&e.preventDefault();return;case 27:this._previewEnd!=null&&!Mo(e)&&(this._clearPreview(),this.activeDrag?this.dragEnded.emit({value:null,event:e}):(this.selectedChange.emit(null),this._userSelection.emit({value:null,event:e})),e.preventDefault(),e.stopPropagation());return;default:return}this._dateAdapter.compareDate(n,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),e.preventDefault()}_handleCalendarBodyKeyup(e){(e.keyCode===32||e.keyCode===13)&&(this._selectionKeyPressed&&this._canSelect(this._activeDate)&&this._dateSelected({value:this._dateAdapter.getDate(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_init(){this._setRanges(this.selected),this._todayDate=this._getCellCompareValue(this._dateAdapter.today()),this._monthLabel=this._dateFormats.display.monthLabel?this._dateAdapter.format(this.activeDate,this._dateFormats.display.monthLabel):this._dateAdapter.getMonthNames("short")[this._dateAdapter.getMonth(this.activeDate)].toLocaleUpperCase();let e=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),1);this._firstWeekOffset=(JP+this._dateAdapter.getDayOfWeek(e)-this._dateAdapter.getFirstDayOfWeek())%JP,this._initWeekdays(),this._createWeekCells(),this._changeDetectorRef.markForCheck()}_focusActiveCell(e){this._matCalendarBody._focusActiveCell(e)}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_previewChanged({event:e,value:n}){if(this._rangeStrategy){let s=n?n.rawValue:null,r=this._rangeStrategy.createPreview(s,this.selected,e);if(this._previewStart=this._getCellCompareValue(r.start),this._previewEnd=this._getCellCompareValue(r.end),this.activeDrag&&s){let y=this._rangeStrategy.createDrag?.(this.activeDrag.value,this.selected,s,e);y&&(this._previewStart=this._getCellCompareValue(y.start),this._previewEnd=this._getCellCompareValue(y.end))}this._changeDetectorRef.detectChanges()}}_dragEnded(e){if(this.activeDrag)if(e.value){let n=this._rangeStrategy?.createDrag?.(this.activeDrag.value,this.selected,e.value,e.event);this.dragEnded.emit({value:n??null,event:e.event})}else this.dragEnded.emit({value:null,event:e.event})}_getDateFromDayOfMonth(e){return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),e)}_initWeekdays(){let e=this._dateAdapter.getFirstDayOfWeek(),n=this._dateAdapter.getDayOfWeekNames("narrow"),r=this._dateAdapter.getDayOfWeekNames("long").map((y,A)=>({long:y,narrow:n[A],id:Yoe++}));this._weekdays=r.slice(e).concat(r.slice(0,e))}_createWeekCells(){let e=this._dateAdapter.getNumDaysInMonth(this.activeDate),n=this._dateAdapter.getDateNames();this._weeks=[[]];for(let s=0,r=this._firstWeekOffset;s<e;s++,r++){r==JP&&(this._weeks.push([]),r=0);let y=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),s+1),A=this._shouldEnableDate(y),P=this._dateAdapter.format(y,this._dateFormats.display.dateA11yLabel),B=this.dateClass?this.dateClass(y,"month"):void 0;this._weeks[this._weeks.length-1].push(new Hx(s+1,n[s],P,A,B,this._getCellCompareValue(y),y))}}_shouldEnableDate(e){return!!e&&(!this.minDate||this._dateAdapter.compareDate(e,this.minDate)>=0)&&(!this.maxDate||this._dateAdapter.compareDate(e,this.maxDate)<=0)&&(!this.dateFilter||this.dateFilter(e))}_getDateInCurrentMonth(e){return e&&this._hasSameMonthAndYear(e,this.activeDate)?this._dateAdapter.getDate(e):null}_hasSameMonthAndYear(e,n){return!!(e&&n&&this._dateAdapter.getMonth(e)==this._dateAdapter.getMonth(n)&&this._dateAdapter.getYear(e)==this._dateAdapter.getYear(n))}_getCellCompareValue(e){if(e){let n=this._dateAdapter.getYear(e),s=this._dateAdapter.getMonth(e),r=this._dateAdapter.getDate(e);return new Date(n,s,r).getTime()}return null}_isRtl(){return this._dir&&this._dir.value==="rtl"}_setRanges(e){e instanceof sc?(this._rangeStart=this._getCellCompareValue(e.start),this._rangeEnd=this._getCellCompareValue(e.end),this._isRange=!0):(this._rangeStart=this._rangeEnd=this._getCellCompareValue(e),this._isRange=!1),this._comparisonRangeStart=this._getCellCompareValue(this.comparisonStart),this._comparisonRangeEnd=this._getCellCompareValue(this.comparisonEnd)}_canSelect(e){return!this.dateFilter||this.dateFilter(e)}_clearPreview(){this._previewStart=this._previewEnd=null}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-month-view"]],viewQuery:function(n,s){if(n&1&&Bn(Ly,5),n&2){let r;Bi(r=Vi())&&(s._matCalendarBody=r.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName",activeDrag:"activeDrag"},outputs:{selectedChange:"selectedChange",_userSelection:"_userSelection",dragStarted:"dragStarted",dragEnded:"dragEnded",activeDateChange:"activeDateChange"},exportAs:["matMonthView"],features:[fr],decls:8,vars:14,consts:[["role","grid",1,"mat-calendar-table"],[1,"mat-calendar-table-header"],["scope","col"],["aria-hidden","true"],["colspan","7",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"selectedValueChange","activeDateChange","previewChange","dragStarted","dragEnded","keyup","keydown","label","rows","todayValue","startValue","endValue","comparisonStart","comparisonEnd","previewStart","previewEnd","isRange","labelMinRequiredCells","activeCell","startDateAccessibleName","endDateAccessibleName"],[1,"cdk-visually-hidden"]],template:function(n,s){n&1&&(oe(0,"table",0)(1,"thead",1)(2,"tr"),U_(3,Poe,5,2,"th",2,pH),ae(),oe(5,"tr",3),Et(6,"th",4),ae()(),oe(7,"tbody",5),_t("selectedValueChange",function(y){return s._dateSelected(y)})("activeDateChange",function(y){return s._updateActiveDate(y)})("previewChange",function(y){return s._previewChanged(y)})("dragStarted",function(y){return s.dragStarted.emit(y)})("dragEnded",function(y){return s._dragEnded(y)})("keyup",function(y){return s._handleCalendarBodyKeyup(y)})("keydown",function(y){return s._handleCalendarBodyKeydown(y)}),ae()()),n&2&&(ge(3),H_(s._weekdays),ge(4),Be("label",s._monthLabel)("rows",s._weeks)("todayValue",s._todayDate)("startValue",s._rangeStart)("endValue",s._rangeEnd)("comparisonStart",s._comparisonRangeStart)("comparisonEnd",s._comparisonRangeEnd)("previewStart",s._previewStart)("previewEnd",s._previewEnd)("isRange",s._isRange)("labelMinRequiredCells",3)("activeCell",s._dateAdapter.getDate(s.activeDate)-1)("startDateAccessibleName",s.startDateAccessibleName)("endDateAccessibleName",s.endDateAccessibleName))},dependencies:[Ly],encapsulation:2,changeDetection:0})}return i})(),Wd=24,cH=4,dH=(()=>{class i{_changeDetectorRef=Z($n);_dateAdapter=Z(hs,{optional:!0});_dir=Z(vo,{optional:!0});_rerenderSubscription=Tn.EMPTY;_selectionKeyPressed;get activeDate(){return this._activeDate}set activeDate(e){let n=this._activeDate,s=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(s,this.minDate,this.maxDate),gH(this._dateAdapter,n,this._activeDate,this.minDate,this.maxDate)||this._init()}_activeDate;get selected(){return this._selected}set selected(e){e instanceof sc?this._selected=e:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setSelectedYear(e)}_selected;get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_minDate;get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_maxDate;dateFilter;dateClass;selectedChange=new ui;yearSelected=new ui;activeDateChange=new ui;_matCalendarBody;_years;_todayYear;_selectedYear;constructor(){this._dateAdapter,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(go(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_init(){this._todayYear=this._dateAdapter.getYear(this._dateAdapter.today());let n=this._dateAdapter.getYear(this._activeDate)-Ux(this._dateAdapter,this.activeDate,this.minDate,this.maxDate);this._years=[];for(let s=0,r=[];s<Wd;s++)r.push(n+s),r.length==cH&&(this._years.push(r.map(y=>this._createCellForYear(y))),r=[]);this._changeDetectorRef.markForCheck()}_yearSelected(e){let n=e.value,s=this._dateAdapter.createDate(n,0,1),r=this._getDateFromYear(n);this.yearSelected.emit(s),this.selectedChange.emit(r)}_updateActiveDate(e){let n=e.value,s=this._activeDate;this.activeDate=this._getDateFromYear(n),this._dateAdapter.compareDate(s,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(e){let n=this._activeDate,s=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,s?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,s?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,cH);break;case 36:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-Ux(this._dateAdapter,this.activeDate,this.minDate,this.maxDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,Wd-Ux(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)-1);break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?-24*10:-24);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?Wd*10:Wd);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(n,this.activeDate)&&this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked(),e.preventDefault()}_handleCalendarBodyKeyup(e){(e.keyCode===32||e.keyCode===13)&&(this._selectionKeyPressed&&this._yearSelected({value:this._dateAdapter.getYear(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_getActiveCell(){return Ux(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getDateFromYear(e){let n=this._dateAdapter.getMonth(this.activeDate),s=this._dateAdapter.getNumDaysInMonth(this._dateAdapter.createDate(e,n,1));return this._dateAdapter.createDate(e,n,Math.min(this._dateAdapter.getDate(this.activeDate),s))}_createCellForYear(e){let n=this._dateAdapter.createDate(e,0,1),s=this._dateAdapter.getYearName(n),r=this.dateClass?this.dateClass(n,"multi-year"):void 0;return new Hx(e,s,s,this._shouldEnableYear(e),r)}_shouldEnableYear(e){if(e==null||this.maxDate&&e>this._dateAdapter.getYear(this.maxDate)||this.minDate&&e<this._dateAdapter.getYear(this.minDate))return!1;if(!this.dateFilter)return!0;let n=this._dateAdapter.createDate(e,0,1);for(let s=n;this._dateAdapter.getYear(s)==e;s=this._dateAdapter.addCalendarDays(s,1))if(this.dateFilter(s))return!0;return!1}_isRtl(){return this._dir&&this._dir.value==="rtl"}_setSelectedYear(e){if(this._selectedYear=null,e instanceof sc){let n=e.start||e.end;n&&(this._selectedYear=this._dateAdapter.getYear(n))}else e&&(this._selectedYear=this._dateAdapter.getYear(e))}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-multi-year-view"]],viewQuery:function(n,s){if(n&1&&Bn(Ly,5),n&2){let r;Bi(r=Vi())&&(s._matCalendarBody=r.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",activeDateChange:"activeDateChange"},exportAs:["matMultiYearView"],decls:5,vars:7,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"selectedValueChange","activeDateChange","keyup","keydown","rows","todayValue","startValue","endValue","numCols","cellAspectRatio","activeCell"]],template:function(n,s){n&1&&(oe(0,"table",0)(1,"thead",1)(2,"tr"),Et(3,"th",2),ae()(),oe(4,"tbody",3),_t("selectedValueChange",function(y){return s._yearSelected(y)})("activeDateChange",function(y){return s._updateActiveDate(y)})("keyup",function(y){return s._handleCalendarBodyKeyup(y)})("keydown",function(y){return s._handleCalendarBodyKeydown(y)}),ae()()),n&2&&(ge(4),Be("rows",s._years)("todayValue",s._todayYear)("startValue",s._selectedYear)("endValue",s._selectedYear)("numCols",4)("cellAspectRatio",4/7)("activeCell",s._getActiveCell()))},dependencies:[Ly],encapsulation:2,changeDetection:0})}return i})();function gH(i,t,e,n,s){let r=i.getYear(t),y=i.getYear(e),A=_H(i,n,s);return Math.floor((r-A)/Wd)===Math.floor((y-A)/Wd)}function Ux(i,t,e,n){let s=i.getYear(t);return Zoe(s-_H(i,e,n),Wd)}function _H(i,t,e){let n=0;return e?n=i.getYear(e)-Wd+1:t&&(n=i.getYear(t)),n}function Zoe(i,t){return(i%t+t)%t}var uH=(()=>{class i{_changeDetectorRef=Z($n);_dateFormats=Z(jp,{optional:!0});_dateAdapter=Z(hs,{optional:!0});_dir=Z(vo,{optional:!0});_rerenderSubscription=Tn.EMPTY;_selectionKeyPressed;get activeDate(){return this._activeDate}set activeDate(e){let n=this._activeDate,s=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(s,this.minDate,this.maxDate),this._dateAdapter.getYear(n)!==this._dateAdapter.getYear(this._activeDate)&&this._init()}_activeDate;get selected(){return this._selected}set selected(e){e instanceof sc?this._selected=e:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setSelectedMonth(e)}_selected;get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_minDate;get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_maxDate;dateFilter;dateClass;selectedChange=new ui;monthSelected=new ui;activeDateChange=new ui;_matCalendarBody;_months;_yearLabel;_todayMonth;_selectedMonth;constructor(){this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(go(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_monthSelected(e){let n=e.value,s=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),n,1);this.monthSelected.emit(s);let r=this._getDateFromMonth(n);this.selectedChange.emit(r)}_updateActiveDate(e){let n=e.value,s=this._activeDate;this.activeDate=this._getDateFromMonth(n),this._dateAdapter.compareDate(s,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(e){let n=this._activeDate,s=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,s?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,s?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-this._dateAdapter.getMonth(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,11-this._dateAdapter.getMonth(this._activeDate));break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?-10:-1);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?10:1);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(n,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),e.preventDefault()}_handleCalendarBodyKeyup(e){(e.keyCode===32||e.keyCode===13)&&(this._selectionKeyPressed&&this._monthSelected({value:this._dateAdapter.getMonth(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_init(){this._setSelectedMonth(this.selected),this._todayMonth=this._getMonthInCurrentYear(this._dateAdapter.today()),this._yearLabel=this._dateAdapter.getYearName(this.activeDate);let e=this._dateAdapter.getMonthNames("short");this._months=[[0,1,2,3],[4,5,6,7],[8,9,10,11]].map(n=>n.map(s=>this._createCellForMonth(s,e[s]))),this._changeDetectorRef.markForCheck()}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getMonthInCurrentYear(e){return e&&this._dateAdapter.getYear(e)==this._dateAdapter.getYear(this.activeDate)?this._dateAdapter.getMonth(e):null}_getDateFromMonth(e){let n=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,1),s=this._dateAdapter.getNumDaysInMonth(n);return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,Math.min(this._dateAdapter.getDate(this.activeDate),s))}_createCellForMonth(e,n){let s=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,1),r=this._dateAdapter.format(s,this._dateFormats.display.monthYearA11yLabel),y=this.dateClass?this.dateClass(s,"year"):void 0;return new Hx(e,n.toLocaleUpperCase(),r,this._shouldEnableMonth(e),y)}_shouldEnableMonth(e){let n=this._dateAdapter.getYear(this.activeDate);if(e==null||this._isYearAndMonthAfterMaxDate(n,e)||this._isYearAndMonthBeforeMinDate(n,e))return!1;if(!this.dateFilter)return!0;let s=this._dateAdapter.createDate(n,e,1);for(let r=s;this._dateAdapter.getMonth(r)==e;r=this._dateAdapter.addCalendarDays(r,1))if(this.dateFilter(r))return!0;return!1}_isYearAndMonthAfterMaxDate(e,n){if(this.maxDate){let s=this._dateAdapter.getYear(this.maxDate),r=this._dateAdapter.getMonth(this.maxDate);return e>s||e===s&&n>r}return!1}_isYearAndMonthBeforeMinDate(e,n){if(this.minDate){let s=this._dateAdapter.getYear(this.minDate),r=this._dateAdapter.getMonth(this.minDate);return e<s||e===s&&n<r}return!1}_isRtl(){return this._dir&&this._dir.value==="rtl"}_setSelectedMonth(e){e instanceof sc?this._selectedMonth=this._getMonthInCurrentYear(e.start)||this._getMonthInCurrentYear(e.end):this._selectedMonth=this._getMonthInCurrentYear(e)}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-year-view"]],viewQuery:function(n,s){if(n&1&&Bn(Ly,5),n&2){let r;Bi(r=Vi())&&(s._matCalendarBody=r.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",monthSelected:"monthSelected",activeDateChange:"activeDateChange"},exportAs:["matYearView"],decls:5,vars:9,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"selectedValueChange","activeDateChange","keyup","keydown","label","rows","todayValue","startValue","endValue","labelMinRequiredCells","numCols","cellAspectRatio","activeCell"]],template:function(n,s){n&1&&(oe(0,"table",0)(1,"thead",1)(2,"tr"),Et(3,"th",2),ae()(),oe(4,"tbody",3),_t("selectedValueChange",function(y){return s._monthSelected(y)})("activeDateChange",function(y){return s._updateActiveDate(y)})("keyup",function(y){return s._handleCalendarBodyKeyup(y)})("keydown",function(y){return s._handleCalendarBodyKeydown(y)}),ae()()),n&2&&(ge(4),Be("label",s._yearLabel)("rows",s._months)("todayValue",s._todayMonth)("startValue",s._selectedMonth)("endValue",s._selectedMonth)("labelMinRequiredCells",2)("numCols",4)("cellAspectRatio",4/7)("activeCell",s._dateAdapter.getMonth(s.activeDate)))},dependencies:[Ly],encapsulation:2,changeDetection:0})}return i})(),yH=(()=>{class i{_intl=Z(Ny);calendar=Z(eO);_dateAdapter=Z(hs,{optional:!0});_dateFormats=Z(jp,{optional:!0});constructor(){Z(to).load(Ql);let e=Z($n);this.calendar.stateChanges.subscribe(()=>e.markForCheck())}get periodButtonText(){return this.calendar.currentView=="month"?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():this.calendar.currentView=="year"?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRange(...this._formatMinAndMaxYearLabels())}get periodButtonDescription(){return this.calendar.currentView=="month"?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():this.calendar.currentView=="year"?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRangeLabel(...this._formatMinAndMaxYearLabels())}get periodButtonLabel(){return this.calendar.currentView=="month"?this._intl.switchToMultiYearViewLabel:this._intl.switchToMonthViewLabel}get prevButtonLabel(){return{month:this._intl.prevMonthLabel,year:this._intl.prevYearLabel,"multi-year":this._intl.prevMultiYearLabel}[this.calendar.currentView]}get nextButtonLabel(){return{month:this._intl.nextMonthLabel,year:this._intl.nextYearLabel,"multi-year":this._intl.nextMultiYearLabel}[this.calendar.currentView]}currentPeriodClicked(){this.calendar.currentView=this.calendar.currentView=="month"?"multi-year":"month"}previousClicked(){this.calendar.activeDate=this.calendar.currentView=="month"?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,-1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,this.calendar.currentView=="year"?-1:-24)}nextClicked(){this.calendar.activeDate=this.calendar.currentView=="month"?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,this.calendar.currentView=="year"?1:Wd)}previousEnabled(){return this.calendar.minDate?!this.calendar.minDate||!this._isSameView(this.calendar.activeDate,this.calendar.minDate):!0}nextEnabled(){return!this.calendar.maxDate||!this._isSameView(this.calendar.activeDate,this.calendar.maxDate)}_isSameView(e,n){return this.calendar.currentView=="month"?this._dateAdapter.getYear(e)==this._dateAdapter.getYear(n)&&this._dateAdapter.getMonth(e)==this._dateAdapter.getMonth(n):this.calendar.currentView=="year"?this._dateAdapter.getYear(e)==this._dateAdapter.getYear(n):gH(this._dateAdapter,e,n,this.calendar.minDate,this.calendar.maxDate)}_formatMinAndMaxYearLabels(){let n=this._dateAdapter.getYear(this.calendar.activeDate)-Ux(this._dateAdapter,this.calendar.activeDate,this.calendar.minDate,this.calendar.maxDate),s=n+Wd-1,r=this._dateAdapter.getYearName(this._dateAdapter.createDate(n,0,1)),y=this._dateAdapter.getYearName(this._dateAdapter.createDate(s,0,1));return[r,y]}_periodButtonLabelId=Z(kr).getId("mat-calendar-period-label-");static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-calendar-header"]],exportAs:["matCalendarHeader"],ngContentSelectors:Ooe,decls:17,vars:11,consts:[[1,"mat-calendar-header"],[1,"mat-calendar-controls"],["aria-live","polite",1,"cdk-visually-hidden",3,"id"],["mat-button","","type","button",1,"mat-calendar-period-button",3,"click"],["aria-hidden","true"],["viewBox","0 0 10 5","focusable","false","aria-hidden","true",1,"mat-calendar-arrow"],["points","0,0 5,5 10,0"],[1,"mat-calendar-spacer"],["mat-icon-button","","type","button",1,"mat-calendar-previous-button",3,"click","disabled"],["viewBox","0 0 24 24","focusable","false","aria-hidden","true"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button",1,"mat-calendar-next-button",3,"click","disabled"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"]],template:function(n,s){n&1&&(xr(),oe(0,"div",0)(1,"div",1)(2,"span",2),Ee(3),ae(),oe(4,"button",3),_t("click",function(){return s.currentPeriodClicked()}),oe(5,"span",4),Ee(6),ae(),Da(),oe(7,"svg",5),Et(8,"polygon",6),ae()(),hm(),Et(9,"div",7),an(10),oe(11,"button",8),_t("click",function(){return s.previousClicked()}),Da(),oe(12,"svg",9),Et(13,"path",10),ae()(),hm(),oe(14,"button",11),_t("click",function(){return s.nextClicked()}),Da(),oe(15,"svg",9),Et(16,"path",12),ae()()()()),n&2&&(ge(2),Be("id",s._periodButtonLabelId),ge(),tn(s.periodButtonDescription),ge(),ji("aria-label",s.periodButtonLabel)("aria-describedby",s._periodButtonLabelId),ge(2),tn(s.periodButtonText),ge(),Ai("mat-calendar-invert",s.calendar.currentView!=="month"),ge(4),Be("disabled",!s.previousEnabled()),ji("aria-label",s.prevButtonLabel),ge(3),Be("disabled",!s.nextEnabled()),ji("aria-label",s.nextButtonLabel))},dependencies:[Rs,ds],encapsulation:2,changeDetection:0})}return i})(),eO=(()=>{class i{_dateAdapter=Z(hs,{optional:!0});_dateFormats=Z(jp,{optional:!0});_changeDetectorRef=Z($n);headerComponent;_calendarHeaderPortal;_intlChanges;_moveFocusOnNextTick=!1;get startAt(){return this._startAt}set startAt(e){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_startAt;startView="month";get selected(){return this._selected}set selected(e){e instanceof sc?this._selected=e:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_selected;get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_minDate;get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_maxDate;dateFilter;dateClass;comparisonStart;comparisonEnd;startDateAccessibleName;endDateAccessibleName;selectedChange=new ui;yearSelected=new ui;monthSelected=new ui;viewChanged=new ui(!0);_userSelection=new ui;_userDragDrop=new ui;monthView;yearView;multiYearView;get activeDate(){return this._clampedActiveDate}set activeDate(e){this._clampedActiveDate=this._dateAdapter.clampDate(e,this.minDate,this.maxDate),this.stateChanges.next(),this._changeDetectorRef.markForCheck()}_clampedActiveDate;get currentView(){return this._currentView}set currentView(e){let n=this._currentView!==e?e:null;this._currentView=e,this._moveFocusOnNextTick=!0,this._changeDetectorRef.markForCheck(),n&&this.viewChanged.emit(n)}_currentView;_activeDrag=null;stateChanges=new ni;constructor(){this._intlChanges=Z(Ny).changes.subscribe(()=>{this._changeDetectorRef.markForCheck(),this.stateChanges.next()})}ngAfterContentInit(){this._calendarHeaderPortal=new Is(this.headerComponent||yH),this.activeDate=this.startAt||this._dateAdapter.today(),this._currentView=this.startView}ngAfterViewChecked(){this._moveFocusOnNextTick&&(this._moveFocusOnNextTick=!1,this.focusActiveCell())}ngOnDestroy(){this._intlChanges.unsubscribe(),this.stateChanges.complete()}ngOnChanges(e){let n=e.minDate&&!this._dateAdapter.sameDate(e.minDate.previousValue,e.minDate.currentValue)?e.minDate:void 0,s=e.maxDate&&!this._dateAdapter.sameDate(e.maxDate.previousValue,e.maxDate.currentValue)?e.maxDate:void 0,r=n||s||e.dateFilter;if(r&&!r.firstChange){let y=this._getCurrentViewComponent();y&&(this._moveFocusOnNextTick=!0,this._changeDetectorRef.detectChanges(),y._init())}this.stateChanges.next()}focusActiveCell(){this._getCurrentViewComponent()._focusActiveCell(!1)}updateTodaysDate(){this._getCurrentViewComponent()._init()}_dateSelected(e){let n=e.value;(this.selected instanceof sc||n&&!this._dateAdapter.sameDate(n,this.selected))&&this.selectedChange.emit(n),this._userSelection.emit(e)}_yearSelectedInMultiYearView(e){this.yearSelected.emit(e)}_monthSelectedInYearView(e){this.monthSelected.emit(e)}_goToDateInView(e,n){this.activeDate=e,this.currentView=n}_dragStarted(e){this._activeDrag=e}_dragEnded(e){this._activeDrag&&(e.value&&this._userDragDrop.emit(e),this._activeDrag=null)}_getCurrentViewComponent(){return this.monthView||this.yearView||this.multiYearView}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-calendar"]],viewQuery:function(n,s){if(n&1&&(Bn(lH,5),Bn(uH,5),Bn(dH,5)),n&2){let r;Bi(r=Vi())&&(s.monthView=r.first),Bi(r=Vi())&&(s.yearView=r.first),Bi(r=Vi())&&(s.multiYearView=r.first)}},hostAttrs:[1,"mat-calendar"],inputs:{headerComponent:"headerComponent",startAt:"startAt",startView:"startView",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",_userSelection:"_userSelection",_userDragDrop:"_userDragDrop"},exportAs:["matCalendar"],features:[Vn([fH]),fr],decls:5,vars:2,consts:[[3,"cdkPortalOutlet"],["cdkMonitorSubtreeFocus","","tabindex","-1",1,"mat-calendar-content"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass"],[3,"activeDateChange","_userSelection","dragStarted","dragEnded","activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag"],[3,"activeDateChange","monthSelected","selectedChange","activeDate","selected","dateFilter","maxDate","minDate","dateClass"],[3,"activeDateChange","yearSelected","selectedChange","activeDate","selected","dateFilter","maxDate","minDate","dateClass"]],template:function(n,s){if(n&1&&(pt(0,Foe,0,0,"ng-template",0),oe(1,"div",1),pt(2,Loe,1,11,"mat-month-view",2)(3,Noe,1,6,"mat-year-view",3)(4,zoe,1,6,"mat-multi-year-view",3),ae()),n&2){let r;Be("cdkPortalOutlet",s._calendarHeaderPortal),ge(2),un((r=s.currentView)==="month"?2:r==="year"?3:r==="multi-year"?4:-1)}},dependencies:[Xl,E2,lH,uH,dH],styles:[`.mat-calendar{display:block;line-height:normal;font-family:var(--mat-datepicker-calendar-text-font, var(--mat-sys-body-medium-font));font-size:var(--mat-datepicker-calendar-text-size, var(--mat-sys-body-medium-size))}.mat-calendar-header{padding:8px 8px 0 8px}.mat-calendar-content{padding:0 8px 8px 8px;outline:none}.mat-calendar-controls{display:flex;align-items:center;margin:5% calc(4.7142857143% - 16px)}.mat-calendar-spacer{flex:1 1 auto}.mat-calendar-period-button{min-width:0;margin:0 8px;font-size:var(--mat-datepicker-calendar-period-button-text-size, var(--mat-sys-title-small-size));font-weight:var(--mat-datepicker-calendar-period-button-text-weight, var(--mat-sys-title-small-weight));--mdc-text-button-label-text-color:var(--mat-datepicker-calendar-period-button-text-color, var(--mat-sys-on-surface-variant))}.mat-calendar-arrow{display:inline-block;width:10px;height:5px;margin:0 0 0 5px;vertical-align:middle;fill:var(--mat-datepicker-calendar-period-button-icon-color, var(--mat-sys-on-surface-variant))}.mat-calendar-arrow.mat-calendar-invert{transform:rotate(180deg)}[dir=rtl] .mat-calendar-arrow{margin:0 5px 0 0}@media(forced-colors: active){.mat-calendar-arrow{fill:CanvasText}}.mat-datepicker-content .mat-calendar-previous-button:not(.mat-mdc-button-disabled),.mat-datepicker-content .mat-calendar-next-button:not(.mat-mdc-button-disabled){color:var(--mat-datepicker-calendar-navigation-button-icon-color, var(--mat-sys-on-surface-variant))}[dir=rtl] .mat-calendar-previous-button,[dir=rtl] .mat-calendar-next-button{transform:rotate(180deg)}.mat-calendar-table{border-spacing:0;border-collapse:collapse;width:100%}.mat-calendar-table-header th{text-align:center;padding:0 0 8px 0;color:var(--mat-datepicker-calendar-header-text-color, var(--mat-sys-on-surface-variant));font-size:var(--mat-datepicker-calendar-header-text-size, var(--mat-sys-title-small-size));font-weight:var(--mat-datepicker-calendar-header-text-weight, var(--mat-sys-title-small-weight))}.mat-calendar-table-header-divider{position:relative;height:1px}.mat-calendar-table-header-divider::after{content:"";position:absolute;top:0;left:-8px;right:-8px;height:1px;background:var(--mat-datepicker-calendar-header-divider-color, transparent)}.mat-calendar-body-cell-content::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px)*-1)}.mat-calendar-body-cell:focus .mat-focus-indicator::before{content:""}
`],encapsulation:2,changeDetection:0})}return i})(),vH=new Dt("mat-datepicker-scroll-strategy",{providedIn:"root",factory:()=>{let i=Z(bo);return()=>i.scrollStrategies.reposition()}});function Xoe(i){return()=>i.scrollStrategies.reposition()}var Koe={provide:vH,deps:[bo],useFactory:Xoe},bH=(()=>{class i{_elementRef=Z(Ii);_animationsDisabled=Z(Vr,{optional:!0})==="NoopAnimations";_changeDetectorRef=Z($n);_globalModel=Z($x);_dateAdapter=Z(hs);_ngZone=Z(ki);_rangeSelectionStrategy=Z(mH,{optional:!0});_stateChanges;_model;_eventCleanups;_animationFallback;_calendar;color;datepicker;comparisonStart;comparisonEnd;startDateAccessibleName;endDateAccessibleName;_isAbove;_animationDone=new ni;_isAnimating=!1;_closeButtonText;_closeButtonFocused;_actionsPortal=null;_dialogLabelId;constructor(){if(Z(to).load(Ql),this._closeButtonText=Z(Ny).closeCalendarLabel,!this._animationsDisabled){let e=this._elementRef.nativeElement,n=Z(Do);this._eventCleanups=this._ngZone.runOutsideAngular(()=>[n.listen(e,"animationstart",this._handleAnimationEvent),n.listen(e,"animationend",this._handleAnimationEvent),n.listen(e,"animationcancel",this._handleAnimationEvent)])}}ngAfterViewInit(){this._stateChanges=this.datepicker.stateChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()}),this._calendar.focusActiveCell()}ngOnDestroy(){clearTimeout(this._animationFallback),this._eventCleanups?.forEach(e=>e()),this._stateChanges?.unsubscribe(),this._animationDone.complete()}_handleUserSelection(e){let n=this._model.selection,s=e.value,r=n instanceof sc;if(r&&this._rangeSelectionStrategy){let y=this._rangeSelectionStrategy.selectionFinished(s,n,e.event);this._model.updateSelection(y,this)}else s&&(r||!this._dateAdapter.sameDate(s,n))&&this._model.add(s);(!this._model||this._model.isComplete())&&!this._actionsPortal&&this.datepicker.close()}_handleUserDragDrop(e){this._model.updateSelection(e.value,this)}_startExitAnimation(){this._elementRef.nativeElement.classList.add("mat-datepicker-content-exit"),this._animationsDisabled?this._animationDone.next():(clearTimeout(this._animationFallback),this._animationFallback=setTimeout(()=>{this._isAnimating||this._animationDone.next()},200))}_handleAnimationEvent=e=>{let n=this._elementRef.nativeElement;e.target!==n||!e.animationName.startsWith("_mat-datepicker-content")||(clearTimeout(this._animationFallback),this._isAnimating=e.type==="animationstart",n.classList.toggle("mat-datepicker-content-animating",this._isAnimating),this._isAnimating||this._animationDone.next())};_getSelected(){return this._model.selection}_applyPendingSelection(){this._model!==this._globalModel&&this._globalModel.updateSelection(this._model.selection,this)}_assignActions(e,n){this._model=e?this._globalModel.clone():this._globalModel,this._actionsPortal=e,n&&this._changeDetectorRef.detectChanges()}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-datepicker-content"]],viewQuery:function(n,s){if(n&1&&Bn(eO,5),n&2){let r;Bi(r=Vi())&&(s._calendar=r.first)}},hostAttrs:[1,"mat-datepicker-content"],hostVars:6,hostBindings:function(n,s){n&2&&(Ts(s.color?"mat-"+s.color:""),Ai("mat-datepicker-content-touch",s.datepicker.touchUi)("mat-datepicker-content-animations-enabled",!s._animationsDisabled))},inputs:{color:"color"},exportAs:["matDatepickerContent"],decls:5,vars:26,consts:[["cdkTrapFocus","","role","dialog",1,"mat-datepicker-content-container"],[3,"yearSelected","monthSelected","viewChanged","_userSelection","_userDragDrop","id","startAt","startView","minDate","maxDate","dateFilter","headerComponent","selected","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName"],[3,"cdkPortalOutlet"],["type","button","mat-raised-button","",1,"mat-datepicker-close-button",3,"focus","blur","click","color"]],template:function(n,s){if(n&1&&(oe(0,"div",0)(1,"mat-calendar",1),_t("yearSelected",function(y){return s.datepicker._selectYear(y)})("monthSelected",function(y){return s.datepicker._selectMonth(y)})("viewChanged",function(y){return s.datepicker._viewChanged(y)})("_userSelection",function(y){return s._handleUserSelection(y)})("_userDragDrop",function(y){return s._handleUserDragDrop(y)}),ae(),pt(2,Boe,0,0,"ng-template",2),oe(3,"button",3),_t("focus",function(){return s._closeButtonFocused=!0})("blur",function(){return s._closeButtonFocused=!1})("click",function(){return s.datepicker.close()}),Ee(4),ae()()),n&2){let r;Ai("mat-datepicker-content-container-with-custom-header",s.datepicker.calendarHeaderComponent)("mat-datepicker-content-container-with-actions",s._actionsPortal),ji("aria-modal",!0)("aria-labelledby",(r=s._dialogLabelId)!==null&&r!==void 0?r:void 0),ge(),Ts(s.datepicker.panelClass),Be("id",s.datepicker.id)("startAt",s.datepicker.startAt)("startView",s.datepicker.startView)("minDate",s.datepicker._getMinDate())("maxDate",s.datepicker._getMaxDate())("dateFilter",s.datepicker._getDateFilter())("headerComponent",s.datepicker.calendarHeaderComponent)("selected",s._getSelected())("dateClass",s.datepicker.dateClass)("comparisonStart",s.comparisonStart)("comparisonEnd",s.comparisonEnd)("startDateAccessibleName",s.startDateAccessibleName)("endDateAccessibleName",s.endDateAccessibleName),ge(),Be("cdkPortalOutlet",s._actionsPortal),ge(),Ai("cdk-visually-hidden",!s._closeButtonFocused),Be("color",s.color||"primary"),ge(),tn(s._closeButtonText)}},dependencies:[T2,eO,Xl,Rs],styles:[`@keyframes _mat-datepicker-content-dropdown-enter{from{opacity:0;transform:scaleY(0.8)}to{opacity:1;transform:none}}@keyframes _mat-datepicker-content-dialog-enter{from{opacity:0;transform:scale(0.8)}to{opacity:1;transform:none}}@keyframes _mat-datepicker-content-exit{from{opacity:1}to{opacity:0}}.mat-datepicker-content{display:block;border-radius:4px;background-color:var(--mat-datepicker-calendar-container-background-color, var(--mat-sys-surface-container-high));color:var(--mat-datepicker-calendar-container-text-color, var(--mat-sys-on-surface));box-shadow:var(--mat-datepicker-calendar-container-elevation-shadow, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12));border-radius:var(--mat-datepicker-calendar-container-shape, var(--mat-sys-corner-large))}.mat-datepicker-content.mat-datepicker-content-animations-enabled{animation:_mat-datepicker-content-dropdown-enter 120ms cubic-bezier(0, 0, 0.2, 1)}.mat-datepicker-content .mat-calendar{width:296px;height:354px}.mat-datepicker-content .mat-datepicker-content-container-with-custom-header .mat-calendar{height:auto}.mat-datepicker-content .mat-datepicker-close-button{position:absolute;top:100%;left:0;margin-top:8px}.mat-datepicker-content-animating .mat-datepicker-content .mat-datepicker-close-button{display:none}.mat-datepicker-content-container{display:flex;flex-direction:column;justify-content:space-between}.mat-datepicker-content-touch{display:block;max-height:80vh;box-shadow:var(--mat-datepicker-calendar-container-touch-elevation-shadow, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12));border-radius:var(--mat-datepicker-calendar-container-touch-shape, var(--mat-sys-corner-extra-large));position:relative;overflow:visible}.mat-datepicker-content-touch.mat-datepicker-content-animations-enabled{animation:_mat-datepicker-content-dialog-enter 150ms cubic-bezier(0, 0, 0.2, 1)}.mat-datepicker-content-touch .mat-datepicker-content-container{min-height:312px;max-height:788px;min-width:250px;max-width:750px}.mat-datepicker-content-touch .mat-calendar{width:100%;height:auto}.mat-datepicker-content-exit.mat-datepicker-content-animations-enabled{animation:_mat-datepicker-content-exit 100ms linear}@media all and (orientation: landscape){.mat-datepicker-content-touch .mat-datepicker-content-container{width:64vh;height:80vh}}@media all and (orientation: portrait){.mat-datepicker-content-touch .mat-datepicker-content-container{width:80vw;height:100vw}.mat-datepicker-content-touch .mat-datepicker-content-container-with-actions{height:115vw}}
`],encapsulation:2,changeDetection:0})}return i})(),hH=(()=>{class i{_overlay=Z(bo);_viewContainerRef=Z(yo);_dateAdapter=Z(hs,{optional:!0});_dir=Z(vo,{optional:!0});_model=Z($x);_scrollStrategy=Z(vH);_inputStateChanges=Tn.EMPTY;_document=Z(Ki);calendarHeaderComponent;get startAt(){return this._startAt||(this.datepickerInput?this.datepickerInput.getStartValue():null)}set startAt(e){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_startAt;startView="month";get color(){return this._color||(this.datepickerInput?this.datepickerInput.getThemePalette():void 0)}set color(e){this._color=e}_color;touchUi=!1;get disabled(){return this._disabled===void 0&&this.datepickerInput?this.datepickerInput.disabled:!!this._disabled}set disabled(e){e!==this._disabled&&(this._disabled=e,this.stateChanges.next(void 0))}_disabled;xPosition="start";yPosition="below";restoreFocus=!0;yearSelected=new ui;monthSelected=new ui;viewChanged=new ui(!0);dateClass;openedStream=new ui;closedStream=new ui;get panelClass(){return this._panelClass}set panelClass(e){this._panelClass=Qj(e)}_panelClass;get opened(){return this._opened}set opened(e){e?this.open():this.close()}_opened=!1;id=Z(kr).getId("mat-datepicker-");_getMinDate(){return this.datepickerInput&&this.datepickerInput.min}_getMaxDate(){return this.datepickerInput&&this.datepickerInput.max}_getDateFilter(){return this.datepickerInput&&this.datepickerInput.dateFilter}_overlayRef;_componentRef;_focusedElementBeforeOpen=null;_backdropHarnessClass=`${this.id}-backdrop`;_actionsPortal;datepickerInput;stateChanges=new ni;_injector=Z(vn);_changeDetectorRef=Z($n);constructor(){this._dateAdapter,this._model.selectionChanged.subscribe(()=>{this._changeDetectorRef.markForCheck()})}ngOnChanges(e){let n=e.xPosition||e.yPosition;if(n&&!n.firstChange&&this._overlayRef){let s=this._overlayRef.getConfig().positionStrategy;s instanceof hy&&(this._setConnectedPositions(s),this.opened&&this._overlayRef.updatePosition())}this.stateChanges.next(void 0)}ngOnDestroy(){this._destroyOverlay(),this.close(),this._inputStateChanges.unsubscribe(),this.stateChanges.complete()}select(e){this._model.add(e)}_selectYear(e){this.yearSelected.emit(e)}_selectMonth(e){this.monthSelected.emit(e)}_viewChanged(e){this.viewChanged.emit(e)}registerInput(e){return this.datepickerInput,this._inputStateChanges.unsubscribe(),this.datepickerInput=e,this._inputStateChanges=e.stateChanges.subscribe(()=>this.stateChanges.next(void 0)),this._model}registerActions(e){this._actionsPortal,this._actionsPortal=e,this._componentRef?.instance._assignActions(e,!0)}removeActions(e){e===this._actionsPortal&&(this._actionsPortal=null,this._componentRef?.instance._assignActions(null,!0))}open(){this._opened||this.disabled||this._componentRef?.instance._isAnimating||(this.datepickerInput,this._focusedElementBeforeOpen=Fu(),this._openOverlay(),this._opened=!0,this.openedStream.emit())}close(){if(!this._opened||this._componentRef?.instance._isAnimating)return;let e=this.restoreFocus&&this._focusedElementBeforeOpen&&typeof this._focusedElementBeforeOpen.focus=="function",n=()=>{this._opened&&(this._opened=!1,this.closedStream.emit())};if(this._componentRef){let{instance:s,location:r}=this._componentRef;s._animationDone.pipe(mo(1)).subscribe(()=>{let y=this._document.activeElement;e&&(!y||y===this._document.activeElement||r.nativeElement.contains(y))&&this._focusedElementBeforeOpen.focus(),this._focusedElementBeforeOpen=null,this._destroyOverlay()}),s._startExitAnimation()}e?setTimeout(n):n()}_applyPendingSelection(){this._componentRef?.instance?._applyPendingSelection()}_forwardContentValues(e){e.datepicker=this,e.color=this.color,e._dialogLabelId=this.datepickerInput.getOverlayLabelId(),e._assignActions(this._actionsPortal,!1)}_openOverlay(){this._destroyOverlay();let e=this.touchUi,n=new Is(bH,this._viewContainerRef),s=this._overlayRef=this._overlay.create(new Yc({positionStrategy:e?this._getDialogStrategy():this._getDropdownStrategy(),hasBackdrop:!0,backdropClass:[e?"cdk-overlay-dark-backdrop":"mat-overlay-transparent-backdrop",this._backdropHarnessClass],direction:this._dir||"ltr",scrollStrategy:e?this._overlay.scrollStrategies.block():this._scrollStrategy(),panelClass:`mat-datepicker-${e?"dialog":"popup"}`}));this._getCloseStream(s).subscribe(r=>{r&&r.preventDefault(),this.close()}),s.keydownEvents().subscribe(r=>{let y=r.keyCode;(y===38||y===40||y===37||y===39||y===33||y===34)&&r.preventDefault()}),this._componentRef=s.attach(n),this._forwardContentValues(this._componentRef.instance),e||Ma(()=>{s.updatePosition()},{injector:this._injector})}_destroyOverlay(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=this._componentRef=null)}_getDialogStrategy(){return this._overlay.position().global().centerHorizontally().centerVertically()}_getDropdownStrategy(){let e=this._overlay.position().flexibleConnectedTo(this.datepickerInput.getConnectedOverlayOrigin()).withTransformOriginOn(".mat-datepicker-content").withFlexibleDimensions(!1).withViewportMargin(8).withLockedPosition();return this._setConnectedPositions(e)}_setConnectedPositions(e){let n=this.xPosition==="end"?"end":"start",s=n==="start"?"end":"start",r=this.yPosition==="above"?"bottom":"top",y=r==="top"?"bottom":"top";return e.withPositions([{originX:n,originY:y,overlayX:n,overlayY:r},{originX:n,originY:r,overlayX:n,overlayY:y},{originX:s,originY:y,overlayX:s,overlayY:r},{originX:s,originY:r,overlayX:s,overlayY:y}])}_getCloseStream(e){let n=["ctrlKey","shiftKey","metaKey"];return Ba(e.backdropClick(),e.detachments(),e.keydownEvents().pipe(dr(s=>s.keyCode===27&&!Mo(s)||this.datepickerInput&&Mo(s,"altKey")&&s.keyCode===38&&n.every(r=>!Mo(s,r)))))}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,inputs:{calendarHeaderComponent:"calendarHeaderComponent",startAt:"startAt",startView:"startView",color:"color",touchUi:[2,"touchUi","touchUi",xi],disabled:[2,"disabled","disabled",xi],xPosition:"xPosition",yPosition:"yPosition",restoreFocus:[2,"restoreFocus","restoreFocus",xi],dateClass:"dateClass",panelClass:"panelClass",opened:[2,"opened","opened",xi]},outputs:{yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",openedStream:"opened",closedStream:"closed"},features:[fr]})}return i})(),xH=(()=>{class i extends hH{static \u0275fac=(()=>{let e;return function(s){return(e||(e=ur(i)))(s||i)}})();static \u0275cmp=Yt({type:i,selectors:[["mat-datepicker"]],exportAs:["matDatepicker"],features:[Vn([fH,{provide:hH,useExisting:i}]),dn],decls:0,vars:0,template:function(n,s){},encapsulation:2,changeDetection:0})}return i})(),Fy=class{target;targetElement;value;constructor(t,e){this.target=t,this.targetElement=e,this.value=this.target.value}},Qoe=(()=>{class i{_elementRef=Z(Ii);_dateAdapter=Z(hs,{optional:!0});_dateFormats=Z(jp,{optional:!0});_isInitialized;get value(){return this._model?this._getValueFromModel(this._model.selection):this._pendingValue}set value(e){this._assignValueProgrammatically(e)}_model;get disabled(){return!!this._disabled||this._parentDisabled()}set disabled(e){let n=e,s=this._elementRef.nativeElement;this._disabled!==n&&(this._disabled=n,this.stateChanges.next(void 0)),n&&this._isInitialized&&s.blur&&s.blur()}_disabled;dateChange=new ui;dateInput=new ui;stateChanges=new ni;_onTouched=()=>{};_validatorOnChange=()=>{};_cvaOnChange=()=>{};_valueChangesSubscription=Tn.EMPTY;_localeSubscription=Tn.EMPTY;_pendingValue;_parseValidator=()=>this._lastValueValid?null:{matDatepickerParse:{text:this._elementRef.nativeElement.value}};_filterValidator=e=>{let n=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e.value));return!n||this._matchesFilter(n)?null:{matDatepickerFilter:!0}};_minValidator=e=>{let n=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e.value)),s=this._getMinDate();return!s||!n||this._dateAdapter.compareDate(s,n)<=0?null:{matDatepickerMin:{min:s,actual:n}}};_maxValidator=e=>{let n=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e.value)),s=this._getMaxDate();return!s||!n||this._dateAdapter.compareDate(s,n)>=0?null:{matDatepickerMax:{max:s,actual:n}}};_getValidators(){return[this._parseValidator,this._minValidator,this._maxValidator,this._filterValidator]}_registerModel(e){this._model=e,this._valueChangesSubscription.unsubscribe(),this._pendingValue&&this._assignValue(this._pendingValue),this._valueChangesSubscription=this._model.selectionChanged.subscribe(n=>{if(this._shouldHandleChangeEvent(n)){let s=this._getValueFromModel(n.selection);this._lastValueValid=this._isValidValue(s),this._cvaOnChange(s),this._onTouched(),this._formatValue(s),this.dateInput.emit(new Fy(this,this._elementRef.nativeElement)),this.dateChange.emit(new Fy(this,this._elementRef.nativeElement))}})}_lastValueValid=!1;constructor(){this._localeSubscription=this._dateAdapter.localeChanges.subscribe(()=>{this._assignValueProgrammatically(this.value)})}ngAfterViewInit(){this._isInitialized=!0}ngOnChanges(e){Joe(e,this._dateAdapter)&&this.stateChanges.next(void 0)}ngOnDestroy(){this._valueChangesSubscription.unsubscribe(),this._localeSubscription.unsubscribe(),this.stateChanges.complete()}registerOnValidatorChange(e){this._validatorOnChange=e}validate(e){return this._validator?this._validator(e):null}writeValue(e){this._assignValueProgrammatically(e)}registerOnChange(e){this._cvaOnChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_onKeydown(e){let n=["ctrlKey","shiftKey","metaKey"];Mo(e,"altKey")&&e.keyCode===40&&n.every(r=>!Mo(e,r))&&!this._elementRef.nativeElement.readOnly&&(this._openPopup(),e.preventDefault())}_onInput(e){let n=this._lastValueValid,s=this._dateAdapter.parse(e,this._dateFormats.parse.dateInput);this._lastValueValid=this._isValidValue(s),s=this._dateAdapter.getValidDateOrNull(s);let r=!this._dateAdapter.sameDate(s,this.value);!s||r?this._cvaOnChange(s):(e&&!this.value&&this._cvaOnChange(s),n!==this._lastValueValid&&this._validatorOnChange()),r&&(this._assignValue(s),this.dateInput.emit(new Fy(this,this._elementRef.nativeElement)))}_onChange(){this.dateChange.emit(new Fy(this,this._elementRef.nativeElement))}_onBlur(){this.value&&this._formatValue(this.value),this._onTouched()}_formatValue(e){this._elementRef.nativeElement.value=e!=null?this._dateAdapter.format(e,this._dateFormats.display.dateInput):""}_assignValue(e){this._model?(this._assignValueToModel(e),this._pendingValue=null):this._pendingValue=e}_isValidValue(e){return!e||this._dateAdapter.isValid(e)}_parentDisabled(){return!1}_assignValueProgrammatically(e){e=this._dateAdapter.deserialize(e),this._lastValueValid=this._isValidValue(e),e=this._dateAdapter.getValidDateOrNull(e),this._assignValue(e),this._formatValue(e)}_matchesFilter(e){let n=this._getDateFilter();return!n||n(e)}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,inputs:{value:"value",disabled:[2,"disabled","disabled",xi]},outputs:{dateChange:"dateChange",dateInput:"dateInput"},features:[fr]})}return i})();function Joe(i,t){let e=Object.keys(i);for(let n of e){let{previousValue:s,currentValue:r}=i[n];if(t.isDateInstance(s)&&t.isDateInstance(r)){if(!t.sameDate(s,r))return!0}else return!0}return!1}var eae={provide:Ud,useExisting:ra(()=>JD),multi:!0},tae={provide:Xc,useExisting:ra(()=>JD),multi:!0},JD=(()=>{class i extends Qoe{_formField=Z(Np,{optional:!0});_closedSubscription=Tn.EMPTY;_openedSubscription=Tn.EMPTY;set matDatepicker(e){e&&(this._datepicker=e,this._ariaOwns.set(e.opened?e.id:null),this._closedSubscription=e.closedStream.subscribe(()=>{this._onTouched(),this._ariaOwns.set(null)}),this._openedSubscription=e.openedStream.subscribe(()=>{this._ariaOwns.set(e.id)}),this._registerModel(e.registerInput(this)))}_datepicker;_ariaOwns=Lo(null);get min(){return this._min}set min(e){let n=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e));this._dateAdapter.sameDate(n,this._min)||(this._min=n,this._validatorOnChange())}_min;get max(){return this._max}set max(e){let n=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e));this._dateAdapter.sameDate(n,this._max)||(this._max=n,this._validatorOnChange())}_max;get dateFilter(){return this._dateFilter}set dateFilter(e){let n=this._matchesFilter(this.value);this._dateFilter=e,this._matchesFilter(this.value)!==n&&this._validatorOnChange()}_dateFilter;_validator;constructor(){super(),this._validator=si.compose(super._getValidators())}getConnectedOverlayOrigin(){return this._formField?this._formField.getConnectedOverlayOrigin():this._elementRef}getOverlayLabelId(){return this._formField?this._formField.getLabelId():this._elementRef.nativeElement.getAttribute("aria-labelledby")}getThemePalette(){return this._formField?this._formField.color:void 0}getStartValue(){return this.value}ngOnDestroy(){super.ngOnDestroy(),this._closedSubscription.unsubscribe(),this._openedSubscription.unsubscribe()}_openPopup(){this._datepicker&&this._datepicker.open()}_getValueFromModel(e){return e}_assignValueToModel(e){this._model&&this._model.updateSelection(e,this)}_getMinDate(){return this._min}_getMaxDate(){return this._max}_getDateFilter(){return this._dateFilter}_shouldHandleChangeEvent(e){return e.source!==this}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["input","matDatepicker",""]],hostAttrs:[1,"mat-datepicker-input"],hostVars:6,hostBindings:function(n,s){n&1&&_t("input",function(y){return s._onInput(y.target.value)})("change",function(){return s._onChange()})("blur",function(){return s._onBlur()})("keydown",function(y){return s._onKeydown(y)}),n&2&&(Ia("disabled",s.disabled),ji("aria-haspopup",s._datepicker?"dialog":null)("aria-owns",s._ariaOwns())("min",s.min?s._dateAdapter.toIso8601(s.min):null)("max",s.max?s._dateAdapter.toIso8601(s.max):null)("data-mat-calendar",s._datepicker?s._datepicker.id:null))},inputs:{matDatepicker:"matDatepicker",min:"min",max:"max",dateFilter:[0,"matDatepickerFilter","dateFilter"]},exportAs:["matDatepickerInput"],features:[Vn([eae,tae,{provide:KD,useExisting:i}]),dn]})}return i})(),iae=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275dir=ri({type:i,selectors:[["","matDatepickerToggleIcon",""]]})}return i})(),tO=(()=>{class i{_intl=Z(Ny);_changeDetectorRef=Z($n);_stateChanges=Tn.EMPTY;datepicker;tabIndex;ariaLabel;get disabled(){return this._disabled===void 0&&this.datepicker?this.datepicker.disabled:!!this._disabled}set disabled(e){this._disabled=e}_disabled;disableRipple;_customIcon;_button;constructor(){let e=Z(new Hl("tabindex"),{optional:!0}),n=Number(e);this.tabIndex=n||n===0?n:null}ngOnChanges(e){e.datepicker&&this._watchStateChanges()}ngOnDestroy(){this._stateChanges.unsubscribe()}ngAfterContentInit(){this._watchStateChanges()}_open(e){this.datepicker&&!this.disabled&&(this.datepicker.open(),e.stopPropagation())}_watchStateChanges(){let e=this.datepicker?this.datepicker.stateChanges:wi(),n=this.datepicker&&this.datepicker.datepickerInput?this.datepicker.datepickerInput.stateChanges:wi(),s=this.datepicker?Ba(this.datepicker.openedStream,this.datepicker.closedStream):wi();this._stateChanges.unsubscribe(),this._stateChanges=Ba(this._intl.changes,e,n,s).subscribe(()=>this._changeDetectorRef.markForCheck())}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-datepicker-toggle"]],contentQueries:function(n,s,r){if(n&1&&Mr(r,iae,5),n&2){let y;Bi(y=Vi())&&(s._customIcon=y.first)}},viewQuery:function(n,s){if(n&1&&Bn(Voe,5),n&2){let r;Bi(r=Vi())&&(s._button=r.first)}},hostAttrs:[1,"mat-datepicker-toggle"],hostVars:8,hostBindings:function(n,s){n&1&&_t("click",function(y){return s._open(y)}),n&2&&(ji("tabindex",null)("data-mat-calendar",s.datepicker?s.datepicker.id:null),Ai("mat-datepicker-toggle-active",s.datepicker&&s.datepicker.opened)("mat-accent",s.datepicker&&s.datepicker.color==="accent")("mat-warn",s.datepicker&&s.datepicker.color==="warn"))},inputs:{datepicker:[0,"for","datepicker"],tabIndex:"tabIndex",ariaLabel:[0,"aria-label","ariaLabel"],disabled:[2,"disabled","disabled",xi],disableRipple:"disableRipple"},exportAs:["matDatepickerToggle"],features:[fr],ngContentSelectors:Uoe,decls:4,vars:7,consts:[["button",""],["mat-icon-button","","type","button",3,"disabled","disableRipple"],["viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false","aria-hidden","true",1,"mat-datepicker-toggle-default-icon"],["d","M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"]],template:function(n,s){n&1&&(xr(joe),oe(0,"button",1,0),pt(2,Hoe,2,0,":svg:svg",2),an(3),ae()),n&2&&(Be("disabled",s.disabled)("disableRipple",s.disableRipple),ji("aria-haspopup",s.datepicker?"dialog":null)("aria-label",s.ariaLabel||s._intl.openCalendarLabel)("tabindex",s.disabled?-1:s.tabIndex)("aria-expanded",s.datepicker?s.datepicker.opened:null),ge(2),un(s._customIcon?-1:2))},dependencies:[ds],styles:[`.mat-datepicker-toggle{pointer-events:auto;color:var(--mat-datepicker-toggle-icon-color, var(--mat-sys-on-surface-variant))}.mat-datepicker-toggle-active{color:var(--mat-datepicker-toggle-active-state-icon-color, var(--mat-sys-on-surface-variant))}@media(forced-colors: active){.mat-datepicker-toggle-default-icon{color:CanvasText}}
`],encapsulation:2,changeDetection:0})}return i})();var eM=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({providers:[Ny,Koe],imports:[Wa,Jl,Dm,qc,An,bH,tO,yH,Nu]})}return i})();var tM=class i{constructor(t){this.http=t}apiUrl=`${aa.urlBack}/report-status-histories`;getAllHistories(t=1,e=20){let n=new ka().set("page",t).set("size",e);return this.http.get(this.apiUrl,{params:n,withCredentials:!0})}getByReportId(t,e=1,n=20){let s=new ka().set("page",e).set("size",n);return this.http.get(`${this.apiUrl}/by-report`,{params:s.set("reportId",t),withCredentials:!0})}getByUserId(t,e=1,n=20){let s=new ka().set("page",e).set("size",n);return this.http.get(`${this.apiUrl}/by-user`,{params:s.set("userId",t),withCredentials:!0})}getByPreviousStatus(t,e=1,n=20){let s=new ka().set("page",e).set("size",n);return this.http.get(`${this.apiUrl}/by-previous-status`,{params:s.set("previousStatus",t),withCredentials:!0})}getByNewStatus(t,e=1,n=20){let s=new ka().set("page",e).set("size",n);return this.http.get(`${this.apiUrl}/by-new-satatus`,{params:s.set("newStatus",t),withCredentials:!0})}getByStatus(t,e,n=1,s=20){return t&&!e?this.getByPreviousStatus(t,n,s):!t&&e?this.getByNewStatus(e,n,s):this.getAllHistories(n,s)}static \u0275fac=function(e){return new(e||i)(hi(zo))};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})};var rae=()=>[10,20,50,100],wH=(i,t,e,n,s)=>({"status-pending":i,"status-rejected":t,"status-verified":e,"status-resolved":n,"status-na":s});function oae(i,t){i&1&&(bn(0),oe(1,"mat-form-field",3)(2,"mat-label"),Ee(3,"ID de Reporte"),ae(),Et(4,"input",16),ae(),xn())}function aae(i,t){i&1&&(bn(0),oe(1,"mat-form-field",3)(2,"mat-label"),Ee(3,"ID de Usuario"),ae(),Et(4,"input",17),ae(),xn())}function sae(i,t){i&1&&(bn(0),oe(1,"mat-form-field",3)(2,"mat-label"),Ee(3,"Estado Anterior"),ae(),oe(4,"mat-select",18)(5,"mat-option",19),Ee(6,"PENDING"),ae(),oe(7,"mat-option",20),Ee(8,"DELETED"),ae(),oe(9,"mat-option",21),Ee(10,"VERIFIED"),ae(),oe(11,"mat-option",22),Ee(12,"RESOLVED"),ae(),oe(13,"mat-option",23),Ee(14,"REJECTED"),ae()()(),xn())}function lae(i,t){i&1&&(bn(0),oe(1,"mat-form-field",3)(2,"mat-label"),Ee(3,"Estado Nuevo"),ae(),oe(4,"mat-select",24)(5,"mat-option",19),Ee(6,"PENDING"),ae(),oe(7,"mat-option",20),Ee(8,"DELETED"),ae(),oe(9,"mat-option",21),Ee(10,"VERIFIED"),ae(),oe(11,"mat-option",22),Ee(12,"RESOLVED"),ae(),oe(13,"mat-option",23),Ee(14,"REJECTED"),ae()()(),xn())}function cae(i,t){i&1&&(oe(0,"div",14),Et(1,"mat-spinner",25),oe(2,"span"),Ee(3,"Cargando historial..."),ae()())}function dae(i,t){i&1&&(oe(0,"th",38),Ee(1,"ID"),ae())}function uae(i,t){if(i&1&&(oe(0,"td",39),Ee(1),ae()),i&2){let e=t.$implicit;ge(),tn(e.id)}}function hae(i,t){i&1&&(oe(0,"th",38),Ee(1,"Reporte ID"),ae())}function pae(i,t){if(i&1&&(oe(0,"td",39),Ee(1),ae()),i&2){let e=t.$implicit;ge(),tn(e.reportId)}}function fae(i,t){i&1&&(oe(0,"th",38),Ee(1,"Usuario ID"),ae())}function mae(i,t){if(i&1&&(oe(0,"td",39),Ee(1),ae()),i&2){let e=t.$implicit;ge(),tn(e.userId)}}function gae(i,t){i&1&&(oe(0,"th",38),Ee(1,"Estado Anterior"),ae())}function _ae(i,t){if(i&1&&(oe(0,"td",39)(1,"span",40),Ee(2),ae()()),i&2){let e=t.$implicit;ge(),Be("ngClass",gk(2,wH,e.previousStatus==="PENDING",e.previousStatus==="REJECTED",e.previousStatus==="VERIFIED",e.previousStatus==="RESOLVED",!e.previousStatus)),ge(),zi(" ",e.previousStatus||"N/A"," ")}}function yae(i,t){i&1&&(oe(0,"th",38),Ee(1,"Estado Nuevo"),ae())}function vae(i,t){if(i&1&&(oe(0,"td",39)(1,"span",40),Ee(2),ae()()),i&2){let e=t.$implicit;ge(),Be("ngClass",gk(2,wH,e.newStatus==="PENDING",e.newStatus==="REJECTED",e.newStatus==="VERIFIED",e.newStatus==="RESOLVED",!e.newStatus)),ge(),zi(" ",e.newStatus||"N/A"," ")}}function bae(i,t){i&1&&(oe(0,"th",38),Ee(1,"Fecha Cambio"),ae())}function xae(i,t){if(i&1&&(oe(0,"td",39),Ee(1),Qs(2,"date"),ae()),i&2){let e=t.$implicit;ge(),tn(Pd(2,1,e.changedAt,"medium"))}}function wae(i,t){i&1&&Et(0,"tr",41)}function Cae(i,t){i&1&&Et(0,"tr",42)}function Eae(i,t){if(i&1){let e=bi();oe(0,"div",15)(1,"table",26),bn(2,27),pt(3,dae,2,0,"th",28)(4,uae,2,1,"td",29),xn(),bn(5,30),pt(6,hae,2,0,"th",28)(7,pae,2,1,"td",29),xn(),bn(8,31),pt(9,fae,2,0,"th",28)(10,mae,2,1,"td",29),xn(),bn(11,32),pt(12,gae,2,0,"th",28)(13,_ae,3,8,"td",29),xn(),bn(14,33),pt(15,yae,2,0,"th",28)(16,vae,3,8,"td",29),xn(),bn(17,34),pt(18,bae,2,0,"th",28)(19,xae,3,4,"td",29),xn(),pt(20,wae,1,0,"tr",35)(21,Cae,1,0,"tr",36),ae(),oe(22,"mat-paginator",37),_t("page",function(s){qt(e);let r=bt();return Wt(r.onPageChange(s))}),ae()()}if(i&2){let e=bt();ge(),Be("dataSource",e.paginatedData().content),ge(19),Be("matHeaderRowDef",e.displayedColumns),ge(),Be("matRowDefColumns",e.displayedColumns),ge(),Be("length",e.paginatedData().totalElements)("pageSize",e.paginatedData().size)("pageSizeOptions",$_(7,rae))("pageIndex",e.paginatedData().page-1)}}var iM=class i{historyService=Z(tM);notificationService=Z(Pr);fb=Z(ca);router=Z(fn);loading=Lo(!1);paginatedData=Lo({content:[],page:0,size:20,totalElements:0,totalPages:0});statusOptions=[{value:"",display:"Todos"},{value:"PENDING",display:"Pendiente"},{value:"DELETED",display:"Eliminado"},{value:"VERIFIED",display:"Verificado"},{value:"RESOLVED",display:"Resuelto"},{value:"REJECTED",display:"Rechazado"}];filterForm=this.fb.group({filterType:["all"],reportId:[""],userId:[""],previousStatus:[""],newStatus:[""],startDate:[""],endDate:[""]});displayedColumns=["id","reportId","userId","previousStatus","newStatus","changedAt"];ngOnInit(){this.loadAllHistories(1,20)}loadAllHistories(t,e){this.loading.set(!0),this.historyService.getAllHistories(t,e).subscribe({next:n=>this.handleSuccessResponse(n),error:n=>this.handleError(n)})}loadByReportId(t,e,n){this.loading.set(!0),this.historyService.getByReportId(t,e,n).subscribe({next:s=>this.handleSuccessResponse(s),error:s=>this.handleError(s)})}loadByUserId(t,e,n){this.loading.set(!0),this.historyService.getByUserId(t,e,n).subscribe({next:s=>this.handleSuccessResponse(s),error:s=>this.handleError(s)})}loadByPreviousStatus(t,e,n){this.loading.set(!0),this.historyService.getByPreviousStatus(t,e,n).subscribe({next:s=>this.handleSuccessResponse(s),error:s=>this.handleError(s)})}loadByNewStatus(t,e,n){this.loading.set(!0),this.historyService.getByNewStatus(t,e,n).subscribe({next:s=>this.handleSuccessResponse(s),error:s=>this.handleError(s)})}loadByBothStatuses(t,e,n,s){this.loading.set(!0),this.historyService.getByStatus(t,e,n,s).subscribe({next:r=>this.handleSuccessResponse(r),error:r=>this.handleError(r)})}handleSuccessResponse(t){this.paginatedData.set(Xi(Ct({},t),{content:t.content.map(e=>Xi(Ct({},e),{changedAt:new Date(e.changedAt)}))})),this.loading.set(!1)}handleError(t){console.error("Error cargando historiales",t),this.notificationService.error("No se pudo cargar el historial."),this.loading.set(!1)}onPageChange(t){let y=this.filterForm.value,{filterType:e}=y,n=r_(y,["filterType"]),s=t.pageIndex+1,r=t.pageSize;switch(e){case"by-report":this.loadByReportId(n.reportId,s,r);break;case"by-user":this.loadByUserId(n.userId,s,r);break;case"by-previous-status":this.loadByPreviousStatus(n.previousStatus,s,r);break;case"by-new-status":this.loadByNewStatus(n.newStatus,s,r);break;case"by-status":this.loadByBothStatuses(n.previousStatus,n.newStatus,s,r);break;default:this.loadAllHistories(s,r)}}applyFilters(){let t=this.filterForm.value,e=1,n=this.paginatedData().size;switch(t.filterType){case"by-report":if(!t.reportId){this.notificationService.error("Debe ingresar un ID de reporte");return}this.loadByReportId(t.reportId,e,n);break;case"by-user":if(!t.userId){this.notificationService.error("Debe ingresar un ID de usuario");return}this.loadByUserId(t.userId,e,n);break;case"by-previous-status":this.loadByPreviousStatus(t.previousStatus||"",e,n);break;case"by-new-status":this.loadByNewStatus(t.newStatus||"",e,n);break;case"by-status":this.loadByBothStatuses(t.previousStatus||"",t.newStatus||"",e,n);break;default:this.loadAllHistories(e,n)}}clearFilters(){this.filterForm.reset({filterType:"all"}),this.loadAllHistories(1,this.paginatedData().size)}goBack(){this.router.navigate(["/map"])}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Yt({type:i,selectors:[["app-history-list"]],decls:40,vars:9,consts:[["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],[1,"filter-form",3,"ngSubmit","formGroup"],[1,"filter-row"],["appearance","outline"],["formControlName","filterType"],["value","all"],["value","by-report"],["value","by-user"],["value","by-previous-status"],["value","by-new-status"],[4,"ngIf"],[1,"filter-actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-button","","type","button",3,"click","disabled"],[1,"loading-section"],[1,"table-container"],["matInput","","formControlName","reportId","required",""],["matInput","","formControlName","userId","required",""],["formControlName","previousStatus"],["value","PENDING"],["value","DELETED"],["value","VERIFIED"],["value","RESOLVED"],["value","REJECTED"],["formControlName","newStatus"],["diameter","40"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","reportId"],["matColumnDef","userId"],["matColumnDef","previousStatus"],["matColumnDef","newStatus"],["matColumnDef","changedAt"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Seleccionar p\xE1gina",3,"page","length","pageSize","pageSizeOptions","pageIndex"],["mat-header-cell",""],["mat-cell",""],[3,"ngClass"],["mat-header-row",""],["mat-row",""]],template:function(e,n){if(e&1&&(oe(0,"button",0),_t("click",function(){return n.goBack()}),oe(1,"mat-icon"),Ee(2,"arrow_back"),ae()(),oe(3,"mat-card")(4,"mat-card-header")(5,"mat-card-title"),Ee(6,"Historial de Cambios de Estado"),ae()(),Et(7,"br"),oe(8,"mat-card-content")(9,"form",1),_t("ngSubmit",function(){return n.applyFilters()}),oe(10,"div",2)(11,"mat-form-field",3)(12,"mat-label"),Ee(13,"Tipo de Filtro"),ae(),oe(14,"mat-select",4)(15,"mat-option",5),Ee(16,"Todos los historiales"),ae(),oe(17,"mat-option",6),Ee(18,"Por Reporte"),ae(),oe(19,"mat-option",7),Ee(20,"Por Usuario"),ae(),oe(21,"mat-option",8),Ee(22,"Por Estado Anterior"),ae(),oe(23,"mat-option",9),Ee(24,"Por Nuevo Estado"),ae()()(),pt(25,oae,5,0,"ng-container",10)(26,aae,5,0,"ng-container",10)(27,sae,15,0,"ng-container",10)(28,lae,15,0,"ng-container",10),ae(),oe(29,"div",11)(30,"button",12)(31,"mat-icon"),Ee(32,"search"),ae(),Ee(33," Filtrar "),ae(),oe(34,"button",13),_t("click",function(){return n.clearFilters()}),oe(35,"mat-icon"),Ee(36,"clear"),ae(),Ee(37," Limpiar "),ae()()(),pt(38,cae,4,0,"div",14)(39,Eae,23,8,"div",15),ae()()),e&2){let s,r,y,A;ge(9),Be("formGroup",n.filterForm),ge(16),Be("ngIf",((s=n.filterForm.get("filterType"))==null?null:s.value)==="by-report"),ge(),Be("ngIf",((r=n.filterForm.get("filterType"))==null?null:r.value)==="by-user"),ge(),Be("ngIf",((y=n.filterForm.get("filterType"))==null?null:y.value)==="by-previous-status"),ge(),Be("ngIf",((A=n.filterForm.get("filterType"))==null?null:A.value)==="by-new-status"),ge(2),Be("disabled",n.loading()||n.filterForm.invalid),ge(4),Be("disabled",n.loading()),ge(4),un(n.loading()?38:-1),ge(),un(n.loading()?-1:39)}},dependencies:[sr,qa,Zn,Uc,oc,rc,Bp,Vp,zp,Ay,qd,ac,Lp,Dp,Tp,kp,Ip,Mp,Pp,Ap,Rp,Op,Fp,Ty,Bm,us,kl,Jc,Py,ky,Wa,Rs,ds,ua,no,td,Uu,ed,eM,Ep,la,io,xo,sa,lP,da,Yr,Xo,Dl],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c;--resolve-color: #26a69a;--table-header-bg: #d0eaf5;--table-row-hover: #f2faff}mat-card[_ngcontent-%COMP%]{margin:1.5rem auto;padding:1rem;background:var(--input-bg);border-radius:8px;box-shadow:0 4px 12px #0000000d}mat-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:.5rem;color:var(--primary-dark);font-size:20px}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:40px 0}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th.mat-header-cell[_ngcontent-%COMP%]{background:var(--table-header-bg);font-weight:600;padding:8px}td.mat-cell[_ngcontent-%COMP%]{padding:8px;border-bottom:1px solid #eee}tr.mat-row[_ngcontent-%COMP%]:hover{background:var(--table-row-hover);transition:background .2s}.status-pending[_ngcontent-%COMP%], .status-rejected[_ngcontent-%COMP%], .status-verified[_ngcontent-%COMP%], .status-resolved[_ngcontent-%COMP%]{display:inline-block;padding:4px 8px;border-radius:4px;font-weight:600;font-size:12px;text-transform:uppercase}.status-pending[_ngcontent-%COMP%]{background:#fff59d;color:#444}.status-rejected[_ngcontent-%COMP%]{background:#ef9a9a;color:#fff}.status-verified[_ngcontent-%COMP%]{background:#a5d6a7;color:#fff}.status-resolved[_ngcontent-%COMP%]{background:#81d4fa;color:#fff}mat-paginator[_ngcontent-%COMP%]{margin-top:1rem}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;background-color:#fff;border-radius:50%;box-shadow:0 2px 6px #0003}"]})};var Sae=["mat-internal-form-field",""],Dae=["*"],CH=(()=>{class i{labelPosition;static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["div","mat-internal-form-field",""]],hostAttrs:[1,"mdc-form-field","mat-internal-form-field"],hostVars:2,hostBindings:function(n,s){n&2&&Ai("mdc-form-field--align-end",s.labelPosition==="before")},inputs:{labelPosition:"labelPosition"},attrs:Sae,ngContentSelectors:Dae,decls:1,vars:0,template:function(n,s){n&1&&(xr(),an(0))},styles:[`.mat-internal-form-field{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:inline-flex;align-items:center;vertical-align:middle}.mat-internal-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mat-internal-form-field>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end .mdc-form-field--align-end label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0}
`],encapsulation:2,changeDetection:0})}return i})();var Mae=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/,Tae=/^(\d?\d)[:.](\d?\d)(?:[:.](\d?\d))?\s*(AM|PM)?$/i;function iO(i,t){let e=Array(i);for(let n=0;n<i;n++)e[n]=t(n);return e}var Iae=(()=>{class i extends hs{useUtcForDisplay=!1;_matDateLocale=Z(WP,{optional:!0});constructor(){super();let e=Z(WP,{optional:!0});e!==void 0&&(this._matDateLocale=e),super.setLocale(this._matDateLocale)}getYear(e){return e.getFullYear()}getMonth(e){return e.getMonth()}getDate(e){return e.getDate()}getDayOfWeek(e){return e.getDay()}getMonthNames(e){let n=new Intl.DateTimeFormat(this.locale,{month:e,timeZone:"utc"});return iO(12,s=>this._format(n,new Date(2017,s,1)))}getDateNames(){let e=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return iO(31,n=>this._format(e,new Date(2017,0,n+1)))}getDayOfWeekNames(e){let n=new Intl.DateTimeFormat(this.locale,{weekday:e,timeZone:"utc"});return iO(7,s=>this._format(n,new Date(2017,0,s+1)))}getYearName(e){let n=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._format(n,e)}getFirstDayOfWeek(){if(typeof Intl<"u"&&Intl.Locale){let e=new Intl.Locale(this.locale),n=(e.getWeekInfo?.()||e.weekInfo)?.firstDay??0;return n===7?0:n}return 0}getNumDaysInMonth(e){return this.getDate(this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+1,0))}clone(e){return new Date(e.getTime())}createDate(e,n,s){let r=this._createDateWithOverflow(e,n,s);return r.getMonth()!=n,r}today(){return new Date}parse(e,n){return typeof e=="number"?new Date(e):e?new Date(Date.parse(e)):null}format(e,n){if(!this.isValid(e))throw Error("NativeDateAdapter: Cannot format invalid date.");let s=new Intl.DateTimeFormat(this.locale,Xi(Ct({},n),{timeZone:"utc"}));return this._format(s,e)}addCalendarYears(e,n){return this.addCalendarMonths(e,n*12)}addCalendarMonths(e,n){let s=this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+n,this.getDate(e));return this.getMonth(s)!=((this.getMonth(e)+n)%12+12)%12&&(s=this._createDateWithOverflow(this.getYear(s),this.getMonth(s),0)),s}addCalendarDays(e,n){return this._createDateWithOverflow(this.getYear(e),this.getMonth(e),this.getDate(e)+n)}toIso8601(e){return[e.getUTCFullYear(),this._2digit(e.getUTCMonth()+1),this._2digit(e.getUTCDate())].join("-")}deserialize(e){if(typeof e=="string"){if(!e)return null;if(Mae.test(e)){let n=new Date(e);if(this.isValid(n))return n}}return super.deserialize(e)}isDateInstance(e){return e instanceof Date}isValid(e){return!isNaN(e.getTime())}invalid(){return new Date(NaN)}setTime(e,n,s,r){let y=this.clone(e);return y.setHours(n,s,r,0),y}getHours(e){return e.getHours()}getMinutes(e){return e.getMinutes()}getSeconds(e){return e.getSeconds()}parseTime(e,n){if(typeof e!="string")return e instanceof Date?new Date(e.getTime()):null;let s=e.trim();if(s.length===0)return null;let r=this._parseTimeString(s);if(r===null){let y=s.replace(/[^0-9:(AM|PM)]/gi,"").trim();y.length>0&&(r=this._parseTimeString(y))}return r||this.invalid()}addSeconds(e,n){return new Date(e.getTime()+n*1e3)}_createDateWithOverflow(e,n,s){let r=new Date;return r.setFullYear(e,n,s),r.setHours(0,0,0,0),r}_2digit(e){return("00"+e).slice(-2)}_format(e,n){let s=new Date;return s.setUTCFullYear(n.getFullYear(),n.getMonth(),n.getDate()),s.setUTCHours(n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()),e.format(s)}_parseTimeString(e){let n=e.toUpperCase().match(Tae);if(n){let s=parseInt(n[1]),r=parseInt(n[2]),y=n[3]==null?void 0:parseInt(n[3]),A=n[4];if(s===12?s=A==="AM"?0:s:A==="PM"&&(s+=12),nO(s,0,23)&&nO(r,0,59)&&(y==null||nO(y,0,59)))return this.setTime(this.today(),s,r,y||0)}return null}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Mt({token:i,factory:i.\u0275fac})}return i})();function nO(i,t,e){return!isNaN(i)&&i>=t&&i<=e}var Aae={parse:{dateInput:null,timeInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},timeInput:{hour:"numeric",minute:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"},timeOptionLabel:{hour:"numeric",minute:"numeric"}}};var EH=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({providers:[Rae()]})}return i})();function Rae(i=Aae){return[{provide:hs,useClass:Iae},{provide:jp,useValue:i}]}var DH=o_(SH());var nM=o_(Ey());function kae(i,t){if(i&1&&(oe(0,"mat-error"),Ee(1),ae()),i&2){let e=bt();ge(),zi(" ",e.filterForm.getError("dateOrder")," ")}}function Pae(i,t){i&1&&Et(0,"mat-spinner",12)}function Oae(i,t){if(i&1){let e=bi();oe(0,"mat-chip-option",25),_t("click",function(){let s=qt(e).$implicit,r=bt(2);return Wt(r.toggleCategory(s.id))}),Ee(1),ae()}if(i&2){let e=t.$implicit,n=bt(2);Be("selected",n.isSelected(e.id)),ge(),zi(" ",e.name," ")}}function Fae(i,t){i&1&&(oe(0,"mat-error"),Ee(1," Debes seleccionar al menos una categor\xEDa "),ae())}function Lae(i,t){if(i&1&&(oe(0,"div",22)(1,"mat-chip-listbox",23),pt(2,Oae,2,2,"mat-chip-option",24),ae()(),pt(3,Fae,2,0,"mat-error")),i&2){let e,n=bt();ge(),Be("multiple",!0),ge(),Be("ngForOf",n.categories),ge(),un((e=n.filterForm.get("categoryIds"))!=null&&e.invalid&&((e=n.filterForm.get("categoryIds"))!=null&&e.touched)?3:-1)}}function Nae(i,t){i&1&&(oe(0,"mat-error"),Ee(1," La latitud debe estar entre -90 y 90 "),ae())}function zae(i,t){i&1&&(oe(0,"mat-error"),Ee(1," La longitud debe estar entre -180 y 180 "),ae())}function Bae(i,t){i&1&&(oe(0,"mat-error"),Ee(1," El radio debe ser un n\xFAmero positivo "),ae())}function Vae(i,t){i&1&&Et(0,"mat-spinner",26)}var rM=class i{fb=Z(ca);http=Z(zo);categoryService=Z(ic);snackBar=Z(Cy);loading=!1;categories=[];loadingCategories=!1;map;radiusMarker=null;isMapInitialized=!1;router=Z(fn);filterForm=this.fb.group({startDate:new Wr(null),endDate:new Wr(null),categoryIds:new Wr([],{validators:[si.minLength(1)]}),centerLat:new Wr(null,{validators:[si.min(-90),si.max(90)]}),centerLng:new Wr(null,{validators:[si.min(-180),si.max(180)]}),radiusKm:new Wr(null,{validators:[si.min(0)]})});ngOnInit(){this.loadCategories()}ngAfterViewInit(){this.initializeMap()}ngOnDestroy(){this.map&&this.map.remove()}initializeMap(){let t=sessionStorage.getItem("lat"),e=sessionStorage.getItem("lng"),n,s;t&&e?(n={lng:parseFloat(e),lat:parseFloat(t)},s=13):(n={lng:-75.681,lat:4.533},s=13),this.map=new nM.default.Map({accessToken:aa.mapboxToken,container:"map-container",style:"mapbox://styles/mapbox/streets-v11",center:n,zoom:13}),this.map.addControl(new nM.default.NavigationControl,"top-right"),this.map.on("load",()=>{this.isMapInitialized=!0,this.setupRadiusSelection()}),this.filterForm.value.centerLat&&this.filterForm.value.centerLng&&this.updateMapWithCurrentValues()}setupRadiusSelection(){let t=!1,e=this.filterForm.value.radiusKm||5;this.map.on("click",n=>{let{lng:s,lat:r}=n.lngLat;this.filterForm.patchValue({centerLng:s,centerLat:r,radiusKm:e}),this.drawRadiusCircle([s,r],e)}),this.map.on("mousedown",()=>{t=!0}),this.map.on("mouseup",()=>{t=!1}),this.map.on("mousemove",n=>{if(!t||!this.radiusMarker)return;let s=this.radiusMarker.getLngLat(),r=fP([s.lng,s.lat],[n.lngLat.lng,n.lngLat.lat],{units:"kilometers"});e=Math.max(.1,r),this.filterForm.patchValue({radiusKm:e}),this.drawRadiusCircle([s.lng,s.lat],e)})}drawRadiusCircle(t,e){this.map.getLayer("radius-fill")&&this.map.removeLayer("radius-fill"),this.map.getLayer("radius-outline")&&this.map.removeLayer("radius-outline"),this.map.getSource("radius")&&this.map.removeSource("radius"),this.radiusMarker&&this.radiusMarker.remove();let n=Ox(t,e,{steps:64,units:"kilometers"});this.map.addSource("radius",{type:"geojson",data:n}),this.map.addLayer({id:"radius-fill",type:"fill",source:"radius",paint:{"fill-color":"#4285F4","fill-opacity":.2}}),this.map.addLayer({id:"radius-outline",type:"line",source:"radius",paint:{"line-color":"#4285F4","line-width":2}}),this.radiusMarker=new nM.default.Marker({draggable:!0,color:"#4285F4"}).setLngLat(t).addTo(this.map),this.radiusMarker.on("drag",()=>{let s=this.radiusMarker.getLngLat();this.filterForm.patchValue({centerLng:s.lng,centerLat:s.lat}),this.drawRadiusCircle([s.lng,s.lat],e)})}updateMapWithCurrentValues(){if(!this.isMapInitialized)return;let{centerLat:t,centerLng:e,radiusKm:n}=this.filterForm.value;if(t&&e){let s=[e,t];this.map.flyTo({center:s,zoom:12}),n&&this.drawRadiusCircle(s,n)}}loadCategories(){this.loadingCategories=!0,this.categoryService.getAllActiveCategories().subscribe({next:t=>{this.categories=t,this.loadingCategories=!1},error:t=>{console.error("Error cargando categor\xEDas",t),this.snackBar.open("Error al cargar categor\xEDas","Cerrar",{duration:3e3}),this.loadingCategories=!1}})}toggleCategory(t){let e=this.filterForm.get("categoryIds"),n=e?.value||[],s=n.indexOf(t);s>-1?n.splice(s,1):n.push(t),e?.setValue([...n])}isSelected(t){return(this.filterForm.get("categoryIds")?.value||[]).includes(t)}generateReport(){if(this.filterForm.invalid)return;this.loading=!0;let t=this.filterForm.value,e={startDate:t.startDate?new Date(t.startDate).toISOString():null,endDate:t.endDate?new Date(t.endDate).toISOString():null,categoryIds:t.categoryIds||[],center:t.centerLat&&t.centerLng?{type:"Point",coordinates:[t.centerLng,t.centerLat]}:null,radiusKm:t.radiusKm||null},n=Object.fromEntries(Object.entries(e).filter(([s,r])=>r!==null));this.http.post(`${aa.urlBack}/admin/reportSummaries/pdf`,n,{params:{page:1,size:20},responseType:"arraybuffer",withCredentials:!0}).subscribe({next:s=>{let r=new Blob([s],{type:"application/pdf"});(0,DH.saveAs)(r,`reporte_${new Date().toISOString().split("T")[0]}.pdf`),this.loading=!1},error:s=>{console.error("Error generando PDF",s),this.snackBar.open("Error generando PDF","Cerrar",{duration:3e3}),this.loading=!1}})}goBack(){this.router.navigate(["/map"])}clearFilters(){this.filterForm.reset({startDate:null,endDate:null,categoryIds:[],centerLat:null,centerLng:null,radiusKm:null}),this.isMapInitialized&&(["radius-fill","radius-outline"].forEach(t=>{this.map.getLayer(t)&&this.map.removeLayer(t)}),this.map.getSource("radius")&&this.map.removeSource("radius"),this.radiusMarker&&(this.radiusMarker.remove(),this.radiusMarker=null))}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Yt({type:i,selectors:[["app-report-pdf-generator"]],decls:67,vars:13,consts:[["startPicker",""],["endPicker",""],["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],[1,"contenedor"],[3,"ngSubmit","formGroup"],[1,"filter-section"],[1,"date-filters"],["appearance","fill"],["matInput","","formControlName","startDate","placeholder","YYYY-MM-DD",3,"matDatepicker"],["matSuffix","",3,"for"],["matInput","","formControlName","endDate","placeholder","YYYY-MM-DD",3,"matDatepicker"],[4,"ngIf"],["diameter","30"],["id","map-container",1,"map-container"],[1,"location-inputs"],["matInput","","formControlName","centerLat","type","number","step","0.000001"],["matInput","","formControlName","centerLng","type","number","step","0.000001"],["matInput","","formControlName","radiusKm","type","number","step","0.1","min","0"],[1,"actions"],["mat-raised-button","","color","primary","type","button",3,"click","disabled"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["diameter","20",4,"ngIf"],[1,"category-chip-container"],[3,"multiple"],[3,"selected","click",4,"ngFor","ngForOf"],[3,"click","selected"],["diameter","20"]],template:function(e,n){if(e&1){let s=bi();oe(0,"button",2),_t("click",function(){return qt(s),Wt(n.goBack())}),oe(1,"mat-icon"),Ee(2,"arrow_back"),ae()(),oe(3,"mat-card",3)(4,"mat-card-header")(5,"mat-card-title"),Ee(6,"Generar Informe PDF"),ae(),oe(7,"mat-card-subtitle"),Ee(8,"Filtros opcionales para el reporte"),ae()(),oe(9,"mat-card-content")(10,"form",4),_t("ngSubmit",function(){return qt(s),Wt(n.generateReport())}),oe(11,"div",5)(12,"h3"),Ee(13,"Filtros por Fecha"),ae(),oe(14,"div",6)(15,"mat-form-field",7)(16,"mat-label"),Ee(17,"Fecha inicio"),ae(),Et(18,"input",8)(19,"mat-datepicker-toggle",9)(20,"mat-datepicker",null,0),ae(),oe(22,"mat-form-field",7)(23,"mat-label"),Ee(24,"Fecha fin"),ae(),Et(25,"input",10)(26,"mat-datepicker-toggle",9)(27,"mat-datepicker",null,1),ae()(),pt(29,kae,2,1,"mat-error",11),ae(),oe(30,"div",5)(31,"h3"),Ee(32,"Filtros por Categor\xEDa"),ae(),pt(33,Pae,1,0,"mat-spinner",12)(34,Lae,4,3),ae(),oe(35,"div",5)(36,"h3"),Ee(37,"Filtros por Ubicaci\xF3n"),ae(),oe(38,"p"),Ee(39,"Selecciona un \xE1rea en el mapa haciendo clic para establecer el centro y arrastrando para ajustar el radio."),ae(),Et(40,"div",13),oe(41,"div",14)(42,"mat-form-field",7)(43,"mat-label"),Ee(44,"Latitud"),ae(),Et(45,"input",15),pt(46,Nae,2,0,"mat-error",11),ae(),oe(47,"mat-form-field",7)(48,"mat-label"),Ee(49,"Longitud"),ae(),Et(50,"input",16),pt(51,zae,2,0,"mat-error",11),ae(),oe(52,"mat-form-field",7)(53,"mat-label"),Ee(54,"Radio (km)"),ae(),Et(55,"input",17),pt(56,Bae,2,0,"mat-error",11),ae()()(),oe(57,"div",18)(58,"button",19),_t("click",function(){return qt(s),Wt(n.clearFilters())}),oe(59,"mat-icon"),Ee(60,"clear"),ae(),Ee(61," Limpiar filtros "),ae(),oe(62,"button",20)(63,"mat-icon"),Ee(64,"picture_as_pdf"),ae(),Ee(65," Generar PDF "),pt(66,Vae,1,0,"mat-spinner",21),ae()()()()()}if(e&2){let s,r,y,A=No(21),P=No(28);ge(10),Be("formGroup",n.filterForm),ge(8),Be("matDatepicker",A),ge(),Be("for",A),ge(6),Be("matDatepicker",P),ge(),Be("for",P),ge(3),Be("ngIf",n.filterForm.hasError("dateOrder")),ge(4),un(n.loadingCategories?33:34),ge(13),Be("ngIf",(s=n.filterForm.get("centerLat"))==null?null:s.invalid),ge(5),Be("ngIf",(r=n.filterForm.get("centerLng"))==null?null:r.invalid),ge(5),Be("ngIf",(y=n.filterForm.get("radiusKm"))==null?null:y.invalid),ge(2),Be("disabled",n.loading),ge(4),Be("disabled",n.loading||n.filterForm.invalid),ge(4),Be("ngIf",n.loading)}},dependencies:[sr,cs,Zn,Ep,la,io,Fm,xo,sa,sP,da,Yr,Xo,oc,rc,Bp,Vp,WD,zp,us,kl,Jc,IP,RP,Py,ky,eM,xH,JD,tO,EH,td,Wa,Rs,ds,ua,no,qd,ac,Ry,HP,UP],styles:[".contenedor[_ngcontent-%COMP%]{max-width:800px;margin:50px auto;padding:30px 40px;border:1px solid #ccc;border-radius:8px;background-color:#fff;box-shadow:0 4px 12px #0000000d}.category-chip-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:8px}mat-chip-option[_ngcontent-%COMP%]{cursor:pointer}.actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:16px}mat-spinner[_ngcontent-%COMP%]{margin-left:8px}.date-filters[_ngcontent-%COMP%]{display:flex;gap:16px;flex-wrap:wrap}.map-container[_ngcontent-%COMP%]{width:100%;height:300px;margin-bottom:16px}.date-filters[_ngcontent-%COMP%]{display:flex;gap:16px;flex-wrap:wrap;margin-bottom:8px}.filter-section[_ngcontent-%COMP%]{margin-bottom:24px}.coords-display[_ngcontent-%COMP%]{font-size:.85em;color:#0009;margin-bottom:8px}.actions[_ngcontent-%COMP%]{margin-top:16px}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;background-color:#fff;border-radius:50%;box-shadow:0 2px 6px #0003}"]})};function jae(i,t){i&1&&(oe(0,"div",11),Ee(1," El nombre es obligatorio "),ae())}function Uae(i,t){i&1&&(oe(0,"div",11),Ee(1," M\xE1ximo 100 caracteres "),ae())}function Hae(i,t){i&1&&(oe(0,"div",11),Ee(1," M\xE1ximo 255 caracteres "),ae())}var Gx=class i{fb=Z(ca);categoryService=Z(ic);notification=Z(Pr);route=Z(nl);router=Z(fn);form=this.fb.group({name:["",[si.required,si.maxLength(100)]],description:["",[si.maxLength(255)]]});loading=!1;isEditMode=!1;categoryId=null;ngOnInit(){this.categoryId=this.route.snapshot.paramMap.get("id"),this.isEditMode=!!this.categoryId,this.isEditMode&&this.categoryId&&(this.loading=!0,this.categoryService.getCategoryById(this.categoryId).subscribe({next:t=>{this.form.patchValue({name:t.name,description:t.description})},error:t=>{this.notification.error("No se pudo cargar la categor\xEDa")},complete:()=>this.loading=!1}))}onSubmit(){if(this.form.invalid){this.form.markAllAsTouched();return}let t={name:this.form.value.name,description:this.form.value.description||""};this.loading=!0,(this.isEditMode?this.categoryService.updateCategory(this.categoryId,t):this.categoryService.addCategory(t)).subscribe({next:()=>{let n=this.isEditMode?"Categor\xEDa actualizada correctamente":"Categor\xEDa creada correctamente";this.notification.success(n),this.router.navigate(["/category-list"])},error:n=>{let s=this.isEditMode?"Error al actualizar categor\xEDa":"Error al crear categor\xEDa";this.notification.error(s)},complete:()=>this.loading=!1})}goBack(){this.router.navigate(["/category-list"])}get name(){return this.form.get("name")}get description(){return this.form.get("description")}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Yt({type:i,selectors:[["app-category-form"]],decls:22,vars:7,consts:[["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],[1,"report-container"],[3,"ngSubmit","formGroup"],[1,"field-group"],["for","name"],["appearance","outline",1,"full-width"],["matInput","","id","name","formControlName","name","placeholder","Nombre de la categor\xEDa"],["class","error-message",4,"ngIf"],["for","description"],["matInput","","id","description","formControlName","description","placeholder","Descripci\xF3n de la categor\xEDa","rows","4"],["type","submit",1,"submit-button",3,"disabled"],[1,"error-message"]],template:function(e,n){e&1&&(oe(0,"button",0),_t("click",function(){return n.goBack()}),oe(1,"mat-icon"),Ee(2,"arrow_back"),ae()(),oe(3,"div",1)(4,"h2"),Ee(5),ae(),oe(6,"form",2),_t("ngSubmit",function(){return n.onSubmit()}),oe(7,"div",3)(8,"label",4),Ee(9,"Nombre"),ae(),oe(10,"mat-form-field",5),Et(11,"input",6),ae(),pt(12,jae,2,0,"div",7)(13,Uae,2,0,"div",7),ae(),oe(14,"div",3)(15,"label",8),Ee(16,"Descripci\xF3n (opcional)"),ae(),oe(17,"mat-form-field",5),Et(18,"textarea",9),ae(),pt(19,Hae,2,0,"div",7),ae(),oe(20,"button",10),Ee(21),ae()()()),e&2&&(ge(5),zi(" ",n.isEditMode?"Editar Categor\xEDa":"Crear Nueva Categor\xEDa"," "),ge(),Be("formGroup",n.form),ge(6),Be("ngIf",(n.name==null?null:n.name.touched)&&(n.name==null?null:n.name.hasError("required"))),ge(),Be("ngIf",(n.name==null?null:n.name.touched)&&(n.name==null?null:n.name.hasError("maxLength"))),ge(6),Be("ngIf",(n.description==null?null:n.description.touched)&&(n.description==null?null:n.description.hasError("maxLength"))),ge(),Be("disabled",n.loading||n.form.invalid),ge(),zi(" ",n.loading?n.isEditMode?"Actualizando...":"Creando...":n.isEditMode?"Actualizar Categor\xEDa":"Crear Categor\xEDa"," "))},dependencies:[sr,Zn,da,la,io,xo,sa,Yr,Xo,us,kl,Py,ky,Wa,ds,ua,no],styles:[".back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;background-color:#fff;border:none;border-radius:50%;box-shadow:0 2px 8px #00000026;width:40px;height:40px;display:flex;align-items:center;justify-content:center;transition:background-color .2s ease,transform .2s ease}.back-button[_ngcontent-%COMP%]:hover{background-color:#f0f0f0;transform:translate(-2px)}.report-container[_ngcontent-%COMP%]{max-width:700px;margin:80px auto 40px;padding:30px 40px;border:1px solid #ddd;border-radius:10px;background-color:#fff;box-shadow:0 6px 16px #0000000d}.report-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;font-size:30px;color:#2c3e50;margin-bottom:30px}.field-group[_ngcontent-%COMP%]{margin-bottom:30px}.field-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:600;color:#34495e}.full-width[_ngcontent-%COMP%]{width:100%}.error-message[_ngcontent-%COMP%]{color:#e74c3c;font-size:.85em;margin-top:6px}.submit-button[_ngcontent-%COMP%]{display:block;width:100%;padding:14px;background-color:#f9f9f9;color:#2c3e50;border:1px solid #ccc;border-radius:4px;font-size:16px;font-weight:600;cursor:pointer;transition:background-color .2s ease,box-shadow .2s ease;margin-top:20px}.submit-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#eaeaea;box-shadow:0 2px 8px #0000001a}.submit-button[_ngcontent-%COMP%]:disabled{background-color:#f0f0f0;color:#999;cursor:not-allowed}"]})};var $ae=["switch"],Gae=["*"];function qae(i,t){i&1&&(oe(0,"span",10),Da(),oe(1,"svg",12),Et(2,"path",13),ae(),oe(3,"svg",14),Et(4,"path",15),ae()())}var Wae=new Dt("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1,hideIcon:!1,disabledInteractive:!1})}),Yae={provide:Ud,useExisting:ra(()=>aM),multi:!0},oM=class{source;checked;constructor(t,e){this.source=t,this.checked=e}},aM=(()=>{class i{_elementRef=Z(Ii);_focusMonitor=Z(Kl);_changeDetectorRef=Z($n);defaults=Z(Wae);_onChange=e=>{};_onTouched=()=>{};_validatorOnChange=()=>{};_uniqueId;_checked=!1;_createChangeEvent(e){return new oM(this,e)}_labelId;get buttonId(){return`${this.id||this._uniqueId}-button`}_switchElement;focus(){this._switchElement.nativeElement.focus()}_noopAnimations;_focused;name=null;id;labelPosition="after";ariaLabel=null;ariaLabelledby=null;ariaDescribedby;required;color;disabled=!1;disableRipple=!1;tabIndex=0;get checked(){return this._checked}set checked(e){this._checked=e,this._changeDetectorRef.markForCheck()}hideIcon;disabledInteractive;change=new ui;toggleChange=new ui;get inputId(){return`${this.id||this._uniqueId}-input`}constructor(){Z(to).load(Zc);let e=Z(new Hl("tabindex"),{optional:!0}),n=this.defaults,s=Z(Vr,{optional:!0});this.tabIndex=e==null?0:parseInt(e)||0,this.color=n.color||"accent",this._noopAnimations=s==="NoopAnimations",this.id=this._uniqueId=Z(kr).getId("mat-mdc-slide-toggle-"),this.hideIcon=n.hideIcon??!1,this.disabledInteractive=n.disabledInteractive??!1,this._labelId=this._uniqueId+"-label"}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{e==="keyboard"||e==="program"?(this._focused=!0,this._changeDetectorRef.markForCheck()):e||Promise.resolve().then(()=>{this._focused=!1,this._onTouched(),this._changeDetectorRef.markForCheck()})})}ngOnChanges(e){e.required&&this._validatorOnChange()}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}writeValue(e){this.checked=!!e}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}validate(e){return this.required&&e.value!==!0?{required:!0}:null}registerOnValidatorChange(e){this._validatorOnChange=e}setDisabledState(e){this.disabled=e,this._changeDetectorRef.markForCheck()}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(this._createChangeEvent(this.checked))}_handleClick(){this.disabled||(this.toggleChange.emit(),this.defaults.disableToggleValue||(this.checked=!this.checked,this._onChange(this.checked),this.change.emit(new oM(this,this.checked))))}_getAriaLabelledBy(){return this.ariaLabelledby?this.ariaLabelledby:this.ariaLabel?null:this._labelId}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Yt({type:i,selectors:[["mat-slide-toggle"]],viewQuery:function(n,s){if(n&1&&Bn($ae,5),n&2){let r;Bi(r=Vi())&&(s._switchElement=r.first)}},hostAttrs:[1,"mat-mdc-slide-toggle"],hostVars:13,hostBindings:function(n,s){n&2&&(Ia("id",s.id),ji("tabindex",null)("aria-label",null)("name",null)("aria-labelledby",null),Ts(s.color?"mat-"+s.color:""),Ai("mat-mdc-slide-toggle-focused",s._focused)("mat-mdc-slide-toggle-checked",s.checked)("_mat-animation-noopable",s._noopAnimations))},inputs:{name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],required:[2,"required","required",xi],color:"color",disabled:[2,"disabled","disabled",xi],disableRipple:[2,"disableRipple","disableRipple",xi],tabIndex:[2,"tabIndex","tabIndex",e=>e==null?0:Aa(e)],checked:[2,"checked","checked",xi],hideIcon:[2,"hideIcon","hideIcon",xi],disabledInteractive:[2,"disabledInteractive","disabledInteractive",xi]},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],features:[Vn([Yae,{provide:Xc,useExisting:i,multi:!0}]),fr],ngContentSelectors:Gae,decls:13,vars:27,consts:[["switch",""],["mat-internal-form-field","",3,"labelPosition"],["role","switch","type","button",1,"mdc-switch",3,"click","tabIndex","disabled"],[1,"mdc-switch__track"],[1,"mdc-switch__handle-track"],[1,"mdc-switch__handle"],[1,"mdc-switch__shadow"],[1,"mdc-elevation-overlay"],[1,"mdc-switch__ripple"],["mat-ripple","",1,"mat-mdc-slide-toggle-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-switch__icons"],[1,"mdc-label",3,"click","for"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--on"],["d","M19.69,5.23L8.96,15.96l-4.23-4.23L2.96,13.5l6,6L21.46,7L19.69,5.23z"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--off"],["d","M20 13H4v-2h16v2z"]],template:function(n,s){if(n&1){let r=bi();xr(),oe(0,"div",1)(1,"button",2,0),_t("click",function(){return qt(r),Wt(s._handleClick())}),Et(3,"span",3),oe(4,"span",4)(5,"span",5)(6,"span",6),Et(7,"span",7),ae(),oe(8,"span",8),Et(9,"span",9),ae(),pt(10,qae,5,0,"span",10),ae()()(),oe(11,"label",11),_t("click",function(A){return qt(r),Wt(A.stopPropagation())}),an(12),ae()()}if(n&2){let r=No(2);Be("labelPosition",s.labelPosition),ge(),Ai("mdc-switch--selected",s.checked)("mdc-switch--unselected",!s.checked)("mdc-switch--checked",s.checked)("mdc-switch--disabled",s.disabled)("mat-mdc-slide-toggle-disabled-interactive",s.disabledInteractive),Be("tabIndex",s.disabled&&!s.disabledInteractive?-1:s.tabIndex)("disabled",s.disabled&&!s.disabledInteractive),ji("id",s.buttonId)("name",s.name)("aria-label",s.ariaLabel)("aria-labelledby",s._getAriaLabelledBy())("aria-describedby",s.ariaDescribedby)("aria-required",s.required||null)("aria-checked",s.checked)("aria-disabled",s.disabled&&s.disabledInteractive?"true":null),ge(8),Be("matRippleTrigger",r)("matRippleDisabled",s.disableRipple||s.disabled)("matRippleCentered",!0),ge(),un(s.hideIcon?-1:10),ge(),Be("for",s.buttonId),ji("id",s._labelId)}},dependencies:[iD,CH],styles:[`.mdc-switch{align-items:center;background:none;border:none;cursor:pointer;display:inline-flex;flex-shrink:0;margin:0;outline:none;overflow:visible;padding:0;position:relative;width:var(--mdc-switch-track-width, 52px)}.mdc-switch.mdc-switch--disabled{cursor:default;pointer-events:none}.mdc-switch.mat-mdc-slide-toggle-disabled-interactive{pointer-events:auto}.mdc-switch__track{overflow:hidden;position:relative;width:100%;height:var(--mdc-switch-track-height, 32px);border-radius:var(--mdc-switch-track-shape, var(--mat-sys-corner-full))}.mdc-switch--disabled.mdc-switch .mdc-switch__track{opacity:var(--mdc-switch-disabled-track-opacity, 0.12)}.mdc-switch__track::before,.mdc-switch__track::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";height:100%;left:0;position:absolute;width:100%;border-width:var(--mat-switch-track-outline-width, 2px);border-color:var(--mat-switch-track-outline-color, var(--mat-sys-outline))}.mdc-switch--selected .mdc-switch__track::before,.mdc-switch--selected .mdc-switch__track::after{border-width:var(--mat-switch-selected-track-outline-width, 2px);border-color:var(--mat-switch-selected-track-outline-color, transparent)}.mdc-switch--disabled .mdc-switch__track::before,.mdc-switch--disabled .mdc-switch__track::after{border-width:var(--mat-switch-disabled-unselected-track-outline-width, 2px);border-color:var(--mat-switch-disabled-unselected-track-outline-color, var(--mat-sys-on-surface))}@media(forced-colors: active){.mdc-switch__track{border-color:currentColor}}.mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:translateX(0);background:var(--mdc-switch-unselected-track-color, var(--mat-sys-surface-variant))}.mdc-switch--selected .mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.6, 1);transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch--selected .mdc-switch__track::before{transform:translateX(-100%)}.mdc-switch--selected .mdc-switch__track::before{opacity:var(--mat-switch-hidden-track-opacity, 0);transition:var(--mat-switch-hidden-track-transition, opacity 75ms)}.mdc-switch--unselected .mdc-switch__track::before{opacity:var(--mat-switch-visible-track-opacity, 1);transition:var(--mat-switch-visible-track-transition, opacity 75ms)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-hover-track-color, var(--mat-sys-surface-variant))}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-focus-track-color, var(--mat-sys-surface-variant))}.mdc-switch:enabled:active .mdc-switch__track::before{background:var(--mdc-switch-unselected-pressed-track-color, var(--mat-sys-surface-variant))}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:hover:not(:focus):not(:active) .mdc-switch__track::before,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:focus:not(:active) .mdc-switch__track::before,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:active .mdc-switch__track::before,.mdc-switch.mdc-switch--disabled .mdc-switch__track::before{background:var(--mdc-switch-disabled-unselected-track-color, var(--mat-sys-surface-variant))}.mdc-switch__track::after{transform:translateX(-100%);background:var(--mdc-switch-selected-track-color, var(--mat-sys-primary))}[dir=rtl] .mdc-switch__track::after{transform:translateX(100%)}.mdc-switch--selected .mdc-switch__track::after{transform:translateX(0)}.mdc-switch--selected .mdc-switch__track::after{opacity:var(--mat-switch-visible-track-opacity, 1);transition:var(--mat-switch-visible-track-transition, opacity 75ms)}.mdc-switch--unselected .mdc-switch__track::after{opacity:var(--mat-switch-hidden-track-opacity, 0);transition:var(--mat-switch-hidden-track-transition, opacity 75ms)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-hover-track-color, var(--mat-sys-primary))}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-focus-track-color, var(--mat-sys-primary))}.mdc-switch:enabled:active .mdc-switch__track::after{background:var(--mdc-switch-selected-pressed-track-color, var(--mat-sys-primary))}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:hover:not(:focus):not(:active) .mdc-switch__track::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:focus:not(:active) .mdc-switch__track::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:active .mdc-switch__track::after,.mdc-switch.mdc-switch--disabled .mdc-switch__track::after{background:var(--mdc-switch-disabled-selected-track-color, var(--mat-sys-on-surface))}.mdc-switch__handle-track{height:100%;pointer-events:none;position:absolute;top:0;transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);left:0;right:auto;transform:translateX(0);width:calc(100% - var(--mdc-switch-handle-width))}[dir=rtl] .mdc-switch__handle-track{left:auto;right:0}.mdc-switch--selected .mdc-switch__handle-track{transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch__handle-track{transform:translateX(-100%)}.mdc-switch__handle{display:flex;pointer-events:auto;position:absolute;top:50%;transform:translateY(-50%);left:0;right:auto;transition:width 75ms cubic-bezier(0.4, 0, 0.2, 1),height 75ms cubic-bezier(0.4, 0, 0.2, 1),margin 75ms cubic-bezier(0.4, 0, 0.2, 1);width:var(--mdc-switch-handle-width);height:var(--mdc-switch-handle-height);border-radius:var(--mdc-switch-handle-shape, var(--mat-sys-corner-full))}[dir=rtl] .mdc-switch__handle{left:auto;right:0}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle{width:var(--mat-switch-unselected-handle-size, 16px);height:var(--mat-switch-unselected-handle-size, 16px);margin:var(--mat-switch-unselected-handle-horizontal-margin, 0 8px)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-unselected-with-icon-handle-horizontal-margin, 0 4px)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle{width:var(--mat-switch-selected-handle-size, 24px);height:var(--mat-switch-selected-handle-size, 24px);margin:var(--mat-switch-selected-handle-horizontal-margin, 0 24px)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-selected-with-icon-handle-horizontal-margin, 0 24px)}.mat-mdc-slide-toggle .mdc-switch__handle:has(.mdc-switch__icons){width:var(--mat-switch-with-icon-handle-size, 24px);height:var(--mat-switch-with-icon-handle-size, 24px)}.mat-mdc-slide-toggle .mdc-switch:active:not(.mdc-switch--disabled) .mdc-switch__handle{width:var(--mat-switch-pressed-handle-size, 28px);height:var(--mat-switch-pressed-handle-size, 28px)}.mat-mdc-slide-toggle .mdc-switch--selected:active:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-selected-pressed-handle-horizontal-margin, 0 22px)}.mat-mdc-slide-toggle .mdc-switch--unselected:active:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-unselected-pressed-handle-horizontal-margin, 0 2px)}.mdc-switch--disabled.mdc-switch--selected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-selected-handle-opacity, 1)}.mdc-switch--disabled.mdc-switch--unselected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-unselected-handle-opacity, 0.38)}.mdc-switch__handle::before,.mdc-switch__handle::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";width:100%;height:100%;left:0;position:absolute;top:0;transition:background-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1),border-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);z-index:-1}@media(forced-colors: active){.mdc-switch__handle::before,.mdc-switch__handle::after{border-color:currentColor}}.mdc-switch--selected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-selected-handle-color, var(--mat-sys-on-primary))}.mdc-switch--selected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-hover-handle-color, var(--mat-sys-primary-container))}.mdc-switch--selected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-focus-handle-color, var(--mat-sys-primary-container))}.mdc-switch--selected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-selected-pressed-handle-color, var(--mat-sys-primary-container))}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled.mdc-switch--selected:hover:not(:focus):not(:active) .mdc-switch__handle::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled.mdc-switch--selected:focus:not(:active) .mdc-switch__handle::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled.mdc-switch--selected:active .mdc-switch__handle::after,.mdc-switch--selected.mdc-switch--disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-selected-handle-color, var(--mat-sys-surface))}.mdc-switch--unselected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-unselected-handle-color, var(--mat-sys-outline))}.mdc-switch--unselected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-hover-handle-color, var(--mat-sys-on-surface-variant))}.mdc-switch--unselected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-focus-handle-color, var(--mat-sys-on-surface-variant))}.mdc-switch--unselected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-unselected-pressed-handle-color, var(--mat-sys-on-surface-variant))}.mdc-switch--unselected.mdc-switch--disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-unselected-handle-color, var(--mat-sys-on-surface))}.mdc-switch__handle::before{background:var(--mdc-switch-handle-surface-color)}.mdc-switch__shadow{border-radius:inherit;bottom:0;left:0;position:absolute;right:0;top:0}.mdc-switch:enabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-handle-elevation-shadow)}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:hover:not(:focus):not(:active) .mdc-switch__shadow,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:focus:not(:active) .mdc-switch__shadow,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:active .mdc-switch__shadow,.mdc-switch.mdc-switch--disabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-disabled-handle-elevation-shadow)}.mdc-switch__ripple{left:50%;position:absolute;top:50%;transform:translate(-50%, -50%);z-index:-1;width:var(--mdc-switch-state-layer-size, 40px);height:var(--mdc-switch-state-layer-size, 40px)}.mdc-switch__ripple::after{content:"";opacity:0}.mdc-switch--disabled .mdc-switch__ripple::after{display:none}.mat-mdc-slide-toggle-disabled-interactive .mdc-switch__ripple::after{display:block}.mdc-switch:hover .mdc-switch__ripple::after{opacity:.04;transition:75ms opacity cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mdc-switch .mdc-switch__ripple::after{opacity:.12}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:enabled:focus .mdc-switch__ripple::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:enabled:active .mdc-switch__ripple::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:enabled:hover:not(:focus) .mdc-switch__ripple::after,.mdc-switch--unselected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background:var(--mdc-switch-unselected-hover-state-layer-color, var(--mat-sys-on-surface))}.mdc-switch--unselected:enabled:focus .mdc-switch__ripple::after{background:var(--mdc-switch-unselected-focus-state-layer-color, var(--mat-sys-on-surface))}.mdc-switch--unselected:enabled:active .mdc-switch__ripple::after{background:var(--mdc-switch-unselected-pressed-state-layer-color, var(--mat-sys-on-surface));opacity:var(--mdc-switch-unselected-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity));transition:opacity 75ms linear}.mdc-switch--selected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background:var(--mdc-switch-selected-hover-state-layer-color, var(--mat-sys-primary))}.mdc-switch--selected:enabled:focus .mdc-switch__ripple::after{background:var(--mdc-switch-selected-focus-state-layer-color, var(--mat-sys-primary))}.mdc-switch--selected:enabled:active .mdc-switch__ripple::after{background:var(--mdc-switch-selected-pressed-state-layer-color, var(--mat-sys-primary));opacity:var(--mdc-switch-selected-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity));transition:opacity 75ms linear}.mdc-switch__icons{position:relative;height:100%;width:100%;z-index:1;transform:translateZ(0)}.mdc-switch--disabled.mdc-switch--unselected .mdc-switch__icons{opacity:var(--mdc-switch-disabled-unselected-icon-opacity, 0.38)}.mdc-switch--disabled.mdc-switch--selected .mdc-switch__icons{opacity:var(--mdc-switch-disabled-selected-icon-opacity, 0.38)}.mdc-switch__icon{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0;opacity:0;transition:opacity 30ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-switch--unselected .mdc-switch__icon{width:var(--mdc-switch-unselected-icon-size, 16px);height:var(--mdc-switch-unselected-icon-size, 16px);fill:var(--mdc-switch-unselected-icon-color, var(--mat-sys-surface-variant))}.mdc-switch--unselected.mdc-switch--disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-unselected-icon-color, var(--mat-sys-surface-variant))}.mdc-switch--selected .mdc-switch__icon{width:var(--mdc-switch-selected-icon-size, 16px);height:var(--mdc-switch-selected-icon-size, 16px);fill:var(--mdc-switch-selected-icon-color, var(--mat-sys-on-primary-container))}.mdc-switch--selected.mdc-switch--disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-selected-icon-color, var(--mat-sys-on-surface))}.mdc-switch--selected .mdc-switch__icon--on,.mdc-switch--unselected .mdc-switch__icon--off{opacity:1;transition:opacity 45ms 30ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle{-webkit-user-select:none;user-select:none;display:inline-block;-webkit-tap-highlight-color:rgba(0,0,0,0);outline:0}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple,.mat-mdc-slide-toggle .mdc-switch__ripple::after{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple:not(:empty),.mat-mdc-slide-toggle .mdc-switch__ripple::after:not(:empty){transform:translateZ(0)}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mat-focus-indicator::before{content:""}.mat-mdc-slide-toggle .mat-internal-form-field{color:var(--mat-switch-label-text-color, var(--mat-sys-on-surface));font-family:var(--mat-switch-label-text-font, var(--mat-sys-body-medium-font));line-height:var(--mat-switch-label-text-line-height, var(--mat-sys-body-medium-line-height));font-size:var(--mat-switch-label-text-size, var(--mat-sys-body-medium-size));letter-spacing:var(--mat-switch-label-text-tracking, var(--mat-sys-body-medium-tracking));font-weight:var(--mat-switch-label-text-weight, var(--mat-sys-body-medium-weight))}.mat-mdc-slide-toggle .mat-ripple-element{opacity:.12}.mat-mdc-slide-toggle .mat-focus-indicator::before{border-radius:50%}.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle-track,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__icon,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::after,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::after{transition:none}.mat-mdc-slide-toggle .mdc-switch:enabled+.mdc-label{cursor:pointer}.mat-mdc-slide-toggle .mdc-switch--disabled+label{color:var(--mdc-switch-disabled-label-text-color)}
`],encapsulation:2,changeDetection:0})}return i})();var MH=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ni({type:i});static \u0275inj=Li({imports:[aM,An,An]})}return i})();function Xae(i,t){i&1&&(oe(0,"div",4),Et(1,"mat-spinner",5),oe(2,"p"),Ee(3,"Cargando categor\xEDas\u2026"),ae()())}function Kae(i,t){i&1&&(oe(0,"th",17),Ee(1,"ID"),ae())}function Qae(i,t){if(i&1&&(oe(0,"td",18),Ee(1),ae()),i&2){let e=t.$implicit;ge(),tn(e.id)}}function Jae(i,t){i&1&&(oe(0,"th",17),Ee(1,"Nombre"),ae())}function ese(i,t){if(i&1&&(oe(0,"td",18),Ee(1),ae()),i&2){let e=t.$implicit;ge(),tn(e.name)}}function tse(i,t){i&1&&(oe(0,"th",17),Ee(1,"Descripci\xF3n"),ae())}function ise(i,t){if(i&1&&(oe(0,"td",18),Ee(1),ae()),i&2){let e=t.$implicit;ge(),tn(e.description)}}function nse(i,t){i&1&&(oe(0,"th",17),Ee(1,"Creado En"),ae())}function rse(i,t){if(i&1&&(oe(0,"td",18),Ee(1),Qs(2,"date"),ae()),i&2){let e=t.$implicit;ge(),zi(" ",Pd(2,1,e.createdAt,"yyyy-MM-dd hh:mm a")," ")}}function ose(i,t){i&1&&(oe(0,"th",17),Ee(1,"Estado"),ae())}function ase(i,t){if(i&1){let e=bi();oe(0,"td",18)(1,"mat-slide-toggle",19),_t("change",function(){let s=qt(e).$implicit,r=bt(2);return Wt(r.onToggleActivation(s))}),Ee(2),ae()()}if(i&2){let e=t.$implicit;ge(),Be("checked",e.activated)("disabled",!e.id),ge(),zi(" ",e.activated?"Activada":"Desactivada"," ")}}function sse(i,t){i&1&&(oe(0,"th",17),Ee(1,"Acciones"),ae())}function lse(i,t){if(i&1){let e=bi();oe(0,"td",18)(1,"button",20),_t("click",function(){let s=qt(e).$implicit,r=bt(2);return Wt(r.onEdit(s))}),oe(2,"mat-icon"),Ee(3,"edit"),ae()()()}}function cse(i,t){i&1&&Et(0,"tr",21)}function dse(i,t){i&1&&Et(0,"tr",22)}function use(i,t){if(i&1&&(oe(0,"table",6),bn(1,7),pt(2,Kae,2,0,"th",8)(3,Qae,2,1,"td",9),xn(),bn(4,10),pt(5,Jae,2,0,"th",8)(6,ese,2,1,"td",9),xn(),bn(7,11),pt(8,tse,2,0,"th",8)(9,ise,2,1,"td",9),xn(),bn(10,12),pt(11,nse,2,0,"th",8)(12,rse,3,4,"td",9),xn(),bn(13,13),pt(14,ose,2,0,"th",8)(15,ase,3,3,"td",9),xn(),bn(16,14),pt(17,sse,2,0,"th",8)(18,lse,4,0,"td",9),xn(),pt(19,cse,1,0,"tr",15)(20,dse,1,0,"tr",16),ae()),i&2){let e=bt();Be("dataSource",e.categories),ge(19),Be("matHeaderRowDef",e.displayedColumns),ge(),Be("matRowDefColumns",e.displayedColumns)}}var sM=class i{categoryService=Z(ic);notification=Z(Pr);router=Z(fn);dialog=Z(Il);loading=!1;categories=[];displayedColumns=["id","name","description","createdAt","activated","actions"];ngOnInit(){this.fetchCategories()}fetchCategories(){this.loading=!0,this.categoryService.getAllCategories().subscribe({next:t=>this.categories=t,error:t=>{console.error("Error cargando categor\xEDas",t),this.notification.error("No fue posible cargar las categor\xEDas")},complete:()=>this.loading=!1})}onAdd(){this.router.navigate(["/categories/create"])}onEdit(t){t.id&&this.router.navigate(["/categories/edit",t.id])}onToggleActivation(t){if(!t.id)return;let e=t.activated?"Desactivar":"Activar",n=t.activated?"desactivada":"activada",s={title:`${e} Categor\xEDa`,message:`\xBFSeguro que deseas ${e.toLowerCase()} la categor\xEDa \u201C${t.name}\u201D?`,confirmText:e,cancelText:"Cancelar"};this.dialog.open(ks,{data:s}).afterClosed().subscribe(r=>{r===!0&&this.categoryService.toggleCategoryActivation(t.id).subscribe({next:y=>{this.notification.success(`Categor\xEDa \u201C${t.name}\u201D ${n}`),this.fetchCategories(),t.activated=y.activated},error:y=>{console.error("Error cambiando estado de categor\xEDa",y),this.notification.error(`No se pudo ${e.toLowerCase()} la categor\xEDa`)}})})}goBack(){this.router.navigate(["/map"])}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Yt({type:i,selectors:[["app-category-list"]],decls:16,vars:2,consts:[["tableBlock",""],["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],["mat-flat-button","","color","primary",3,"click"],["class","loading-section",4,"ngIf","ngIfElse"],[1,"loading-section"],["diameter","40"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","description"],["matColumnDef","createdAt"],["matColumnDef","activated"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["color","primary",3,"change","checked","disabled"],["mat-icon-button","","color","accent",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,n){if(e&1){let s=bi();oe(0,"button",1),_t("click",function(){return qt(s),Wt(n.goBack())}),oe(1,"mat-icon"),Ee(2,"arrow_back"),ae()(),oe(3,"mat-card")(4,"mat-card-header")(5,"mat-card-title"),Ee(6,"Listado de Categor\xEDas"),ae(),oe(7,"mat-card-actions")(8,"button",2),_t("click",function(){return qt(s),Wt(n.onAdd())}),oe(9,"mat-icon"),Ee(10,"add"),ae(),Ee(11," A\xF1adir Categor\xEDa "),ae()()(),oe(12,"mat-card-content"),pt(13,Xae,4,0,"div",3)(14,use,21,3,"ng-template",null,0,lp),ae()()}if(e&2){let s=No(15);ge(13),Be("ngIf",n.loading)("ngIfElse",s)}},dependencies:[sr,Zn,Uc,oc,rc,YD,Bp,Vp,zp,Lp,Dp,Tp,kp,Ip,Mp,Pp,Ap,Rp,Op,Fp,qd,ac,Wa,Rs,ds,ua,no,Pm,MH,aM],styles:[".loading-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;justify-content:center;padding:40px 0}table[_ngcontent-%COMP%]{width:100%;margin-top:16px}th.mat-header-cell[_ngcontent-%COMP%]{font-weight:700}td.mat-cell[_ngcontent-%COMP%]{word-wrap:break-word}mat-card-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}mat-card-actions[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;margin-top:12px}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;background-color:#fff;border-radius:50%;box-shadow:0 2px 6px #0003}.bg-green[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724;font-weight:700;padding:4px 8px;border-radius:4px}.bg-red[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24;font-weight:700;padding:4px 8px;border-radius:4px}"]})};var Hu=class i{constructor(t,e){this.authService=t;this.router=e}canActivate(){return this.authService.checkIsAdmin().pipe(Ui(t=>t?!0:this.router.createUrlTree(["/map"])),tr(()=>wi(this.router.createUrlTree(["/map"]))))}static \u0275fac=function(e){return new(e||i)(hi(eo),hi(fn))};static \u0275prov=Mt({token:i,factory:i.\u0275fac,providedIn:"root"})};var lM=o_(Ey());function hse(i,t){i&1&&(oe(0,"div",16),Ee(1," \u26A0 El nombre completo es obligatorio. "),ae())}function pse(i,t){i&1&&(oe(0,"div",16),Ee(1," \u26A0 El nombre debe tener al menos 8 caracteres. "),ae())}function fse(i,t){i&1&&(oe(0,"div",16),Ee(1," \u26A0 El nombre no puede exceder 50 caracteres. "),ae())}function mse(i,t){i&1&&(oe(0,"div",16),Ee(1," \u26A0 El correo electr\xF3nico es obligatorio. "),ae())}function gse(i,t){i&1&&(oe(0,"div",16),Ee(1," \u26A0 El formato de correo no es v\xE1lido. "),ae())}function _se(i,t){i&1&&(oe(0,"div",16),Ee(1," \u26A0 El correo debe tener al menos 8 caracteres. "),ae())}function yse(i,t){i&1&&(oe(0,"div",16),Ee(1," \u26A0 El correo no puede exceder 50 caracteres. "),ae())}function vse(i,t){i&1&&(oe(0,"div",16),Ee(1," \u26A0 La ciudad de residencia es obligatoria. "),ae())}function bse(i,t){i&1&&(oe(0,"div",16),Ee(1," \u26A0 El radio de notificaciones es obligatorio. "),ae())}function xse(i,t){i&1&&(oe(0,"div",16),Ee(1," \u26A0 El radio de notificaciones debe ser mayor que 0. "),ae())}function wse(i,t){if(i&1){let e=bi();oe(0,"div")(1,"div",5),Et(2,"i",6)(3,"input",7),ae(),pt(4,hse,2,0,"div",8)(5,pse,2,0,"div",8)(6,fse,2,0,"div",8),oe(7,"div",5),Et(8,"i",9)(9,"input",10),ae(),pt(10,mse,2,0,"div",8)(11,gse,2,0,"div",8)(12,_se,2,0,"div",8)(13,yse,2,0,"div",8),oe(14,"div",5),Et(15,"i",11)(16,"input",12),ae(),pt(17,vse,2,0,"div",8),oe(18,"div",5),Et(19,"i",13)(20,"input",14),ae(),pt(21,bse,2,0,"div",8)(22,xse,2,0,"div",8),oe(23,"button",15),_t("click",function(){qt(e);let s=bt();return Wt(s.continueToMap())}),Ee(24," Actualizar Ubicaci\xF3n "),ae()()}if(i&2){let e=bt();ge(4),Be("ngIf",e.hasError("fullName","required")),ge(),Be("ngIf",e.hasError("fullName","minlength")),ge(),Be("ngIf",e.hasError("fullName","maxlength")),ge(4),Be("ngIf",e.hasError("email","required")),ge(),Be("ngIf",e.hasError("email","email")),ge(),Be("ngIf",e.hasError("email","minlength")),ge(),Be("ngIf",e.hasError("email","maxlength")),ge(4),Be("ngIf",e.hasError("cityOfResidence","required")),ge(4),Be("ngIf",e.hasError("notificationRadiusKm","required")),ge(),Be("ngIf",e.hasError("notificationRadiusKm","min")),ge(),Be("disabled",e.profileForm.invalid)}}function Cse(i,t){i&1&&(oe(0,"div",17),Ee(1," Cargando mapa... "),ae())}function Ese(i,t){i&1&&Et(0,"i",23)}function Sse(i,t){if(i&1){let e=bi();oe(0,"div"),Et(1,"div",18),oe(2,"p",19),Ee(3,"Haz clic en el mapa para actualizar tu ubicaci\xF3n"),ae(),oe(4,"div",20)(5,"button",21),pt(6,Ese,1,0,"i",22),Ee(7),ae(),oe(8,"button",15),_t("click",function(){qt(e);let s=bt();return Wt(s.showMap=!1)}),Ee(9," Cancelar "),ae()()()}if(i&2){let e=bt();ge(5),Be("disabled",e.profileForm.invalid||e.isSubmitting),ge(),Be("ngIf",e.isSubmitting),ge(),zi(" ",e.isSubmitting?"Guardando...":"Guardar Cambios"," "),ge(),Be("disabled",e.isSubmitting)}}var cM=class i{constructor(t,e,n,s,r){this.fb=t;this.authService=e;this.notificationService=n;this.router=s;this.cdr=r;this.profileForm=this.fb.group({email:["",[si.required,si.email,si.minLength(8),si.maxLength(50)]],fullName:["",[si.required,si.minLength(8),si.maxLength(50)]],cityOfResidence:["",si.required],notificationRadiusKm:[null,[si.required,si.min(1)]],latitude:[null,si.required],longitude:[null,si.required]})}profileForm;showMap=!1;isLoadingMap=!1;map;marker;isSubmitting=!1;currentUser;ngOnInit(){this.loadUserData()}ngAfterViewInit(){this.currentUser?.latitude&&this.currentUser?.longitude&&setTimeout(()=>{this.showMap=!0,this.initializeMap({lng:this.currentUser.longitude,lat:this.currentUser.latitude}),this.cdr.detectChanges()},0)}loadUserData(){this.authService.getMe().subscribe({next:t=>{this.currentUser=t,this.populateForm(t)},error:()=>{this.notificationService.error("Error al cargar los datos del usuario"),this.router.navigate(["/"])}})}populateForm(t){this.profileForm.patchValue({email:t.email,fullName:t.fullName,dateBirth:t.dateBirth,cityOfResidence:t.cityOfResidence,notificationRadiusKm:t.notificationRadiusKm,latitude:t.latitude,longitude:t.longitude})}hasError(t,e){let n=this.profileForm.get(t);return!!(n&&n.touched&&n.hasError(e))}continueToMap(){if(!this.profileForm.valid){this.profileForm.markAllAsTouched();return}let e=this.profileForm.get("cityOfResidence").value;if(e===this.currentUser.cityOfResidence){this.showMap=!0,this.isLoadingMap=!1,this.cdr.detectChanges(),setTimeout(()=>{let n=this.profileForm.get("latitude").value,s=this.profileForm.get("longitude").value;this.initializeMap({lng:s,lat:n})},0);return}this.isLoadingMap=!0,this.showMap=!0,this.cdr.detectChanges(),console.log("Buscando coordenadas para:",e),this.getCityCoordinates(e).then(n=>{setTimeout(()=>this.initializeMap({lng:n.lng,lat:n.lat}),0)}).catch(n=>{console.error("Error al obtener coordenadas:",n);let s=n?.message==="Ciudad no encontrada"?"No pudimos encontrar tu ciudad. Revisa el nombre.":"Ocurri\xF3 un error al cargar el mapa. Intenta nuevamente.";this.notificationService.error(s),this.showMap=!1}).finally(()=>this.isLoadingMap=!1)}initializeMap(t){console.log("Inicializando mapa con coords:",t),this.map&&(this.map.remove(),console.log("Mapa anterior eliminado")),this.map=new lM.default.Map({container:"map_user",style:"mapbox://styles/mapbox/streets-v11",center:[t.lng,t.lat],zoom:12,accessToken:Kc.mapboxToken}),this.map.on("load",()=>{this.map.resize(),this.isLoadingMap=!1}),this.map.addControl(new lM.default.NavigationControl,"bottom-right"),this.map.on("click",({lngLat:e})=>this.onMapClick(e)),this.addMarker(t)}onMapClick(t){this.updateLocation(t),this.marker?this.marker.setLngLat(t):this.addMarker({lng:t.lng,lat:t.lat})}addMarker(t){this.marker&&this.marker.remove(),this.marker=new lM.default.Marker({draggable:!0,anchor:"center"}).setLngLat([t.lng,t.lat]).addTo(this.map).on("dragend",()=>{let e=this.marker.getLngLat();this.updateLocation(e)})}updateLocation(t){this.profileForm.patchValue({latitude:t.lat,longitude:t.lng})}getCityCoordinates(t){let n=`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(t+", Colombia")}.json?access_token=${Kc.mapboxToken}&limit=1`;return fetch(n).then(s=>s.json()).then(s=>{if(!s.features||s.features.length===0)throw new Error("No se encontr\xF3 la ciudad");let[r,y]=s.features[0].center;return{lng:r,lat:y}})}onSubmit(){if(this.profileForm.invalid){this.profileForm.markAllAsTouched();return}this.isSubmitting=!0;let t=this.profileForm.value;this.authService.updateUser(this.currentUser.id,t).subscribe({next:e=>{this.notificationService.success("Datos actualizados correctamente"),this.currentUser=e,this.isSubmitting=!1,this.goBack()},error:e=>{let n=e.error?.message||"Error al actualizar los datos";this.notificationService.error(n),this.populateForm(this.currentUser),this.isSubmitting=!1}})}goBack(){this.router.navigate(["/profile"])}static \u0275fac=function(e){return new(e||i)(ai(ca),ai(eo),ai(Pr),ai(fn),ai($n))};static \u0275cmp=Yt({type:i,selectors:[["app-profile"]],decls:10,vars:4,consts:[["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],[1,"profile-container"],[3,"ngSubmit","formGroup"],[4,"ngIf"],["class","loading-spinner",4,"ngIf"],[1,"field-group"],[1,"icon","fa","fa-user"],["type","text","placeholder","Nombre completo","formControlName","fullName"],["class","error-message",4,"ngIf"],[1,"icon","fa","fa-envelope"],["type","email","placeholder","Correo electr\xF3nico","formControlName","email"],[1,"icon","fa","fa-city"],["type","text","placeholder","Ciudad de residencia","formControlName","cityOfResidence"],[1,"icon","fa","fa-bullhorn"],["type","number","placeholder","Radio de notificaciones (Km)","formControlName","notificationRadiusKm"],["type","button",1,"submit-button",3,"click","disabled"],[1,"error-message"],[1,"loading-spinner"],["id","map_user"],[1,"map-instructions"],[1,"form-actions"],["type","submit",1,"submit-button",3,"disabled"],["class","fas fa-spinner fa-spin me-2",4,"ngIf"],[1,"fas","fa-spinner","fa-spin","me-2"]],template:function(e,n){e&1&&(oe(0,"button",0),_t("click",function(){return n.goBack()}),oe(1,"mat-icon"),Ee(2,"arrow_back"),ae()(),oe(3,"div",1)(4,"h2"),Ee(5,"Actualizar campos"),ae(),oe(6,"form",2),_t("ngSubmit",function(){return n.onSubmit()}),pt(7,wse,25,11,"div",3)(8,Cse,2,0,"div",4)(9,Sse,10,4,"div",3),ae()()),e&2&&(ge(6),Be("formGroup",n.profileForm),ge(),Be("ngIf",!n.showMap),ge(),Be("ngIf",n.isLoadingMap),ge(),Be("ngIf",n.showMap&&!n.isLoadingMap))},dependencies:[sr,Zn,da,la,io,Fm,xo,sa,Yr,Xo,no],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c;--cancel-color: #95a5a6}.profile-container[_ngcontent-%COMP%]{width:360px;background:var(--input-bg);margin:60px auto;padding:30px;border-radius:12px;text-align:center;box-shadow:0 4px 15px #0000001a;position:relative}.profile-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;margin:0 0 25px;color:var(--primary-dark)}.field-group[_ngcontent-%COMP%]{position:relative;margin-bottom:15px}.field-group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:12px;transform:translateY(-50%);color:var(--primary-accent);font-size:18px}.field-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px 12px 12px 40px;border:2px solid #ccc;border-radius:6px;font-size:14px;background:var(--input-bg);transition:border-color .2s ease;box-sizing:border-box}.field-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-accent)}.error-message[_ngcontent-%COMP%]{text-align:left;color:var(--error-color);font-size:13px;margin:-10px 0 10px;padding-left:40px}.submit-button[_ngcontent-%COMP%]{width:100%;padding:12px;margin-top:3px;background:var(--primary-accent);color:#000;border:none;border-radius:6px;cursor:pointer;font-size:16px;font-weight:600;transition:background .3s ease,transform .2s ease;box-shadow:0 2px 8px #00000026}.cancel-button[_ngcontent-%COMP%]{width:100%;padding:12px;margin-top:10px;background:var(--cancel-color);color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:16px;font-weight:600;transition:background .3s ease}.submit-button[_ngcontent-%COMP%]:disabled, .cancel-button[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.submit-button[_ngcontent-%COMP%]:not(:disabled):hover{background:var(--primary-dark);transform:translateY(-2px)}.cancel-button[_ngcontent-%COMP%]:not(:disabled):hover{background:#7f8c8d}#map_user[_ngcontent-%COMP%]{width:100%;height:400px;border:1px solid #ccc;border-radius:4px;margin-bottom:15px}.map-instructions[_ngcontent-%COMP%]{color:var(--primary-dark);font-size:14px;margin-bottom:20px}.loading-spinner[_ngcontent-%COMP%]{font-size:16px;color:var(--primary-dark);margin:20px 0}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;background-color:#fff;border-radius:50%;box-shadow:0 2px 6px #0003}.form-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}"]})};function Dse(i,t){i&1&&(oe(0,"div",13),Ee(1," \u26A0 La contrase\xF1a actual es obligatoria. "),ae())}function Mse(i,t){i&1&&(oe(0,"div",13),Ee(1," \u26A0 La nueva contrase\xF1a es obligatoria. "),ae())}function Tse(i,t){i&1&&(oe(0,"div",13),Ee(1," \u26A0 Debe tener entre 8 y 50 caracteres. "),ae())}function Ise(i,t){i&1&&(oe(0,"div",13),Ee(1," \u26A0 Debe contener al menos un d\xEDgito, una may\xFAscula y una min\xFAscula. "),ae())}function Ase(i,t){i&1&&Et(0,"i",14)}var dM=class i{constructor(t,e,n,s){this.fb=t;this.authService=e;this.notificationService=n;this.router=s}passwordForm;isSubmitting=!1;userId;ngOnInit(){this.initForm(),this.authService.getMe().subscribe({next:t=>this.userId=t.id,error:()=>{this.notificationService.error("Error al obtener informaci\xF3n del usuario"),this.router.navigate(["/"])}})}initForm(){this.passwordForm=this.fb.group({currentPassword:["",[si.required]],newPassword:["",[si.required,si.minLength(8),si.maxLength(50),si.pattern(/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/)]]})}hasError(t,e){let n=this.passwordForm.get(t);return!!(n&&n.touched&&n.hasError(e))}onSubmit(){if(this.passwordForm.invalid){this.passwordForm.markAllAsTouched();return}this.isSubmitting=!0;let t=this.passwordForm.value;this.authService.updatePassword(this.userId,t).subscribe({next:()=>{this.notificationService.success("Contrase\xF1a actualizada correctamente"),this.router.navigate(["/profile"])},error:e=>{let n=e.error?.message||"Error al actualizar la contrase\xF1a";this.notificationService.error(n),this.isSubmitting=!1}})}goBack(){this.router.navigate(["/profile"])}static \u0275fac=function(e){return new(e||i)(ai(ca),ai(eo),ai(Pr),ai(fn))};static \u0275cmp=Yt({type:i,selectors:[["app-password-update"]],decls:23,vars:9,consts:[["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],[1,"password-update-container"],["novalidate","",3,"ngSubmit","formGroup"],[1,"field-group"],[1,"icon","fa","fa-lock"],["type","password","placeholder","Contrase\xF1a actual","formControlName","currentPassword"],["class","error-message",4,"ngIf"],[1,"icon","fa","fa-key"],["type","password","placeholder","Nueva contrase\xF1a","formControlName","newPassword"],[1,"button-group"],["type","submit",3,"disabled"],["class","fas fa-spinner fa-spin",4,"ngIf"],["type","button",3,"click","disabled"],[1,"error-message"],[1,"fas","fa-spinner","fa-spin"]],template:function(e,n){e&1&&(oe(0,"button",0),_t("click",function(){return n.goBack()}),oe(1,"mat-icon"),Ee(2,"arrow_back"),ae()(),oe(3,"div",1)(4,"h2"),Ee(5,"Actualizar contrase\xF1a"),ae(),oe(6,"form",2),_t("ngSubmit",function(){return n.onSubmit()}),oe(7,"div",3),Et(8,"i",4)(9,"input",5),ae(),pt(10,Dse,2,0,"div",6),oe(11,"div",3),Et(12,"i",7)(13,"input",8),ae(),pt(14,Mse,2,0,"div",6)(15,Tse,2,0,"div",6)(16,Ise,2,0,"div",6),oe(17,"div",9)(18,"button",10),pt(19,Ase,1,0,"i",11),Ee(20),ae(),oe(21,"button",12),_t("click",function(){return n.goBack()}),Ee(22," Cancelar "),ae()()()()),e&2&&(ge(6),Be("formGroup",n.passwordForm),ge(4),Be("ngIf",n.hasError("currentPassword","required")),ge(4),Be("ngIf",n.hasError("newPassword","required")),ge(),Be("ngIf",n.hasError("newPassword","minlength")||n.hasError("newPassword","maxlength")),ge(),Be("ngIf",n.hasError("newPassword","pattern")),ge(2),Be("disabled",n.isSubmitting),ge(),Be("ngIf",n.isSubmitting),ge(),zi(" ",n.isSubmitting?"Actualizando...":"Actualizar contrase\xF1a"," "),ge(),Be("disabled",n.isSubmitting))},dependencies:[sr,Zn,da,la,io,xo,sa,Yr,Xo,no],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c}.password-update-container[_ngcontent-%COMP%]{width:360px;background:var(--input-bg);margin:60px auto;padding:30px;border-radius:12px;text-align:center;box-shadow:0 4px 15px #0000001a;position:relative}.password-update-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:25px;color:var(--primary-dark)}.field-group[_ngcontent-%COMP%]{position:relative;margin-bottom:15px}.field-group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:12px;transform:translateY(-50%);color:var(--primary-accent);font-size:18px}.field-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px 12px 12px 40px;border:2px solid #ccc;border-radius:6px;font-size:14px;background:var(--input-bg);transition:border-color .2s ease;box-sizing:border-box}.field-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-accent)}.error-message[_ngcontent-%COMP%]{text-align:left;color:var(--error-color);font-size:13px;margin:-10px 0 10px;padding-left:40px}.button-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:10px}.button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:12px;background:var(--primary-accent);color:#000;border:none;border-radius:6px;cursor:pointer;font-size:16px;font-weight:600;transition:background .3s ease,transform .2s ease;box-shadow:0 2px 8px #00000026}.button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background:#aaa;color:#ccc;cursor:not-allowed}.button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:not(:disabled):hover{background:var(--primary-dark);transform:translateY(-2px)}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;background-color:#fff;border-radius:50%;box-shadow:0 2px 6px #0003}.fa-spinner[_ngcontent-%COMP%]{margin-right:8px}"]})};function Rse(i,t){if(i&1){let e=bi();oe(0,"mat-card",3)(1,"mat-card-header",4)(2,"mat-card-title"),Ee(3),ae(),oe(4,"mat-card-subtitle"),Ee(5),ae()(),oe(6,"mat-card-content",5)(7,"div",6)(8,"strong"),Ee(9,"Ciudad:"),ae(),oe(10,"span"),Ee(11),ae()(),oe(12,"div",6)(13,"strong"),Ee(14,"Radio de notificaciones:"),ae(),oe(15,"span"),Ee(16),ae()()(),oe(17,"mat-card-actions",7)(18,"button",8),_t("click",function(){qt(e);let s=bt();return Wt(s.onEditData())}),oe(19,"mat-icon"),Ee(20,"edit"),ae(),Ee(21," Editar datos "),ae(),oe(22,"button",9),_t("click",function(){qt(e);let s=bt();return Wt(s.onUpdatePassword())}),oe(23,"mat-icon"),Ee(24,"lock"),ae(),Ee(25," Actualizar contrase\xF1a "),ae(),oe(26,"button",10),_t("click",function(){qt(e);let s=bt();return Wt(s.onDeleteAccount())}),oe(27,"mat-icon",11),Ee(28,"delete_forever"),ae(),Ee(29," Eliminar cuenta "),ae()()()}if(i&2){let e=bt();ge(3),tn(e.user.fullName),ge(2),tn(e.user.email),ge(6),tn(e.user.cityOfResidence),ge(5),zi("",e.user.notificationRadiusKm," km")}}function kse(i,t){i&1&&(oe(0,"div",12),Et(1,"mat-progress-spinner",13),ae())}var uM=class i{authService=Z(eo);notification=Z(Pr);router=Z(fn);dialog=Z(Il);user;loading=!0;ngOnInit(){this.authService.getMe().subscribe({next:t=>{this.user=t},error:t=>{console.error("Error al cargar perfil",t),this.notification.error("No fue posible cargar tu perfil"),this.router.navigate(["/"])},complete:()=>this.loading=!1})}onEditData(){this.router.navigate(["/user/edit"])}onUpdatePassword(){this.router.navigate(["/user/edit/password"])}onDeleteAccount(){if(!this.user?.id)return;let t={title:"Eliminar cuenta",message:"\xBFEst\xE1s seguro de que deseas eliminar tu cuenta? Esta acci\xF3n no se puede deshacer.",confirmText:"Eliminar",cancelText:"Cancelar"};this.dialog.open(ks,{data:t}).afterClosed().subscribe(e=>{e&&this.authService.deleteUser(this.user.id).subscribe({next:()=>{this.notification.success("Cuenta eliminada correctamente"),this.router.navigate(["/login"])},error:n=>{console.error("Error al eliminar cuenta",n),this.notification.error("No se pudo eliminar tu cuenta")}})})}goBack(){this.router.navigate(["/map"])}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Yt({type:i,selectors:[["app-profile"]],decls:5,vars:2,consts:[["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],["class","profile-card",4,"ngIf"],["class","loading-spinner",4,"ngIf"],[1,"profile-card"],[1,"profile-header"],[1,"content"],[1,"info-group"],[1,"actions"],["mat-stroked-button","",3,"click"],["mat-stroked-button","","color","primary",3,"click"],["mat-flat-button","","color","primary",1,"delete-button",3,"click"],[1,"delete-icon"],[1,"loading-spinner"],["mode","indeterminate"]],template:function(e,n){e&1&&(oe(0,"button",0),_t("click",function(){return n.goBack()}),oe(1,"mat-icon"),Ee(2,"arrow_back"),ae()(),pt(3,Rse,30,4,"mat-card",1)(4,kse,2,0,"div",2)),e&2&&(ge(3),Be("ngIf",!n.loading&&n.user),ge(),Be("ngIf",n.loading))},dependencies:[sr,Zn,oc,rc,YD,Bp,Vp,WD,zp,Wa,Rs,ds,ua,no,Pm,ac],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;background-color:var(--input-bg);color:var(--primary-dark);border-radius:50%;box-shadow:0 2px 6px #0000001a;z-index:1000;transition:all .2s ease}.back-button[_ngcontent-%COMP%]:hover{background-color:var(--primary-bg);transform:scale(1.05)}.profile-card[_ngcontent-%COMP%]{max-width:500px;width:90%;margin:80px auto 40px;padding:24px;background:var(--input-bg);border-radius:12px;box-shadow:0 4px 15px #0000001a}.profile-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:20px;text-align:center;width:100%}.avatar-center[_ngcontent-%COMP%]{width:80px;height:80px;margin:0 auto 16px;border-radius:50%;background-color:var(--primary-bg);color:var(--primary-dark);display:flex;align-items:center;justify-content:center}.avatar-center[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:36px}mat-card-title[_ngcontent-%COMP%]{font-size:1.5rem;color:var(--primary-dark);margin:0 auto 4px;text-align:center;width:100%}mat-card-subtitle[_ngcontent-%COMP%]{color:var(--primary-accent);font-size:1rem;text-align:center;width:100%;margin:0 auto}.content[_ngcontent-%COMP%]{padding:16px 0;margin:16px 0;border-top:1px solid rgba(0,0,0,.1);border-bottom:1px solid rgba(0,0,0,.1)}.info-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:12px;padding:0 8px}.info-group[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--primary-dark)}.actions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;gap:12px;margin-top:24px}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:160px;padding:8px 16px;display:flex;align-items:center;justify-content:center;gap:8px;border-radius:6px;transition:all .2s ease}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px}button[color=warn][_ngcontent-%COMP%]{background-color:var(--error-color);color:#fff}button[color=warn][_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff}.loading-spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:80px}@media (max-width: 600px){.profile-card[_ngcontent-%COMP%]{margin-top:60px;padding:16px}.actions[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}"]})};var Pse=()=>[5,10,25],Ose=(i,t,e,n)=>({"status-pending":i,"status-rejected":t,"status-verified":e,"status-resolved":n});function Fse(i,t){if(i&1&&(oe(0,"mat-option",8),Ee(1),ae()),i&2){let e=t.$implicit;Be("value",e),ge(),zi(" ",e," ")}}function Lse(i,t){i&1&&(oe(0,"div",9),Et(1,"mat-spinner",10),ae())}function Nse(i,t){i&1&&(oe(0,"th",25),Ee(1,"T\xEDtulo"),ae())}function zse(i,t){if(i&1&&(oe(0,"td",26),Ee(1),ae()),i&2){let e=t.$implicit;ge(),tn(e.title)}}function Bse(i,t){i&1&&(oe(0,"th",25),Ee(1,"Descripci\xF3n"),ae())}function Vse(i,t){if(i&1&&(oe(0,"td",26),Ee(1),ae()),i&2){let e=t.$implicit;ge(),tn(e.description)}}function jse(i,t){i&1&&(oe(0,"th",25),Ee(1,"Categor\xEDas"),ae())}function Use(i,t){if(i&1&&(oe(0,"mat-chip"),Ee(1),ae()),i&2){let e=t.$implicit;ge(),tn(e.name)}}function Hse(i,t){if(i&1&&(oe(0,"td",26)(1,"mat-chip-set"),pt(2,Use,2,1,"mat-chip",27),ae()()),i&2){let e=t.$implicit;ge(2),Be("ngForOf",e.categoryList)}}function $se(i,t){i&1&&(oe(0,"th",25),Ee(1,"Ubicaci\xF3n"),ae())}function Gse(i,t){if(i&1&&(oe(0,"td",26),Ee(1),ae()),i&2){let e=t.$implicit;ge(),kd(" ",e.latitude,", ",e.longitude," ")}}function qse(i,t){i&1&&(oe(0,"th",25),Ee(1,"Estado"),ae())}function Wse(i,t){if(i&1&&(oe(0,"td",26)(1,"span",28),Ee(2),ae()()),i&2){let e=t.$implicit;ge(),Be("ngClass",kE(2,Ose,e.reportStatus==="PENDING",e.reportStatus==="REJECTED",e.reportStatus==="VERIFIED",e.reportStatus==="RESOLVED")),ge(),zi(" ",e.reportStatus," ")}}function Yse(i,t){i&1&&(oe(0,"th",25),Ee(1,"Fecha Creaci\xF3n"),ae())}function Zse(i,t){if(i&1&&(oe(0,"td",26),Ee(1),Qs(2,"date"),ae()),i&2){let e=t.$implicit;ge(),zi(" ",Pd(2,1,e.createdAt,"short")," ")}}function Xse(i,t){i&1&&(oe(0,"th",25),Ee(1,"Votos"),ae())}function Kse(i,t){if(i&1&&(oe(0,"td",26),Ee(1),ae()),i&2){let e=t.$implicit;ge(),tn(e.importantVotes)}}function Qse(i,t){i&1&&(oe(0,"th",25),Ee(1,"Acciones"),ae())}function Jse(i,t){if(i&1){let e=bi();bn(0),oe(1,"button",31),_t("click",function(){qt(e);let s=bt().$implicit,r=bt(2);return Wt(r.resolveReport(s.id))}),oe(2,"mat-icon"),Ee(3,"done_all"),ae(),Ee(4," Resolver "),ae(),xn()}}function ele(i,t){if(i&1){let e=bi();oe(0,"td",26),bn(1),oe(2,"button",29),_t("click",function(){let s=qt(e).$implicit,r=bt(2);return Wt(r.editReport(s.id))}),oe(3,"mat-icon"),Ee(4,"edit"),ae(),Ee(5," Editar "),ae(),oe(6,"button",30),_t("click",function(){let s=qt(e).$implicit,r=bt(2);return Wt(r.deleteReport(s.id))}),oe(7,"mat-icon"),Ee(8,"close"),ae(),Ee(9," Eliminar "),ae(),xn(),pt(10,Jse,5,0,"ng-container",7),ae()}if(i&2){let e=t.$implicit;ge(10),Be("ngIf",e.reportStatus==="VERIFIED")}}function tle(i,t){i&1&&Et(0,"tr",32)}function ile(i,t){i&1&&Et(0,"tr",33)}function nle(i,t){if(i&1){let e=bi();oe(0,"div")(1,"table",11),bn(2,12),pt(3,Nse,2,0,"th",13)(4,zse,2,1,"td",14),xn(),bn(5,15),pt(6,Bse,2,0,"th",13)(7,Vse,2,1,"td",14),xn(),bn(8,16),pt(9,jse,2,0,"th",13)(10,Hse,3,1,"td",14),xn(),bn(11,17),pt(12,$se,2,0,"th",13)(13,Gse,2,2,"td",14),xn(),bn(14,18),pt(15,qse,2,0,"th",13)(16,Wse,3,7,"td",14),xn(),bn(17,19),pt(18,Yse,2,0,"th",13)(19,Zse,3,4,"td",14),xn(),bn(20,20),pt(21,Xse,2,0,"th",13)(22,Kse,2,1,"td",14),xn(),bn(23,21),pt(24,Qse,2,0,"th",13)(25,ele,11,1,"td",14),xn(),pt(26,tle,1,0,"tr",22)(27,ile,1,0,"tr",23),ae(),oe(28,"mat-paginator",24),_t("page",function(s){qt(e);let r=bt();return Wt(r.onPageChange(s))}),ae()()}if(i&2){let e=bt();ge(),Be("dataSource",e.filteredContent()),ge(25),Be("matHeaderRowDef",e.displayedColumns),ge(),Be("matRowDefColumns",e.displayedColumns),ge(),Be("length",e.paginatedData().totalElements)("pageSize",e.paginatedData().size)("pageIndex",e.paginatedData().page-1)("pageSizeOptions",$_(7,Pse))}}var hM=class i{reportService=Z(rl);notificationService=Z(Pr);dialog=Z(Il);loading=Lo(!1);paginatedData=Lo({content:[],page:0,size:10,totalElements:0,totalPages:0});router=Z(fn);statuses=["PENDING","VERIFIED","REJECTED","RESOLVED"];selectedStatus=Lo("");filteredContent=Cl(()=>{let t=this.paginatedData().content,e=this.selectedStatus();return e?t.filter(n=>n.reportStatus===e):t});displayedColumns=["title","description","categories","location","reportStatus","dateCreation","importantVotes","actions"];ngOnInit(){this.loadReports(1,10)}loadReports(t,e,n=""){this.loading.set(!0),this.reportService.getMyReportsPaginated(t,e,n).subscribe({next:s=>this.paginatedData.set(s),error:s=>{},complete:()=>this.loading.set(!1)})}deleteReport(t){if(!t)return;let e={title:"Eliminar Reporte",message:"\xBFSeguro que quieres eliminar este reporte?",confirmText:"Eliminar",cancelText:"Cancelar"};this.dialog.open(ks,{data:e}).afterClosed().subscribe(n=>{n===!0&&this.reportService.deleteReport(t).subscribe({next:()=>{this.notificationService.success("\u2705 Reporte eliminado correctamente."),this.loadReports(1,10)},error:s=>{console.error("\u274C Error al rechazar reporte:",s),this.notificationService.error("Ocurri\xF3 un error al rechazar el reporte.")}})})}editReport(t){t&&this.router.navigate([`report/edit/${t}`])}resolveReport(t){if(!t)return;let e={title:"Resolver reporte",message:"\xBFDeseas marcar este reporte como resuelto?",confirmText:"Resolver",cancelText:"Cancelar"};this.dialog.open(ks,{data:e}).afterClosed().subscribe(n=>{n===!0&&this.reportService.updateReportStatus(t,"RESOLVED").subscribe({next:()=>{this.notificationService.success("\u2705 Reporte marcado como resuelto."),this.loadReports(1,10)},error:s=>{console.error("\u274C Error al resolver reporte:",s),this.notificationService.error("Ocurri\xF3 un error al resolver el reporte.")}})})}onPageChange(t){let e=t.pageIndex+1,n=t.pageSize;this.loadReports(e,n,this.selectedStatus())}onStatusChange(t){this.selectedStatus.set(t),this.loadReports(1,this.paginatedData().size,t)}goBack(){this.router.navigate(["/map"])}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Yt({type:i,selectors:[["app-report-list"]],decls:16,vars:4,consts:[["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],[1,"contenedor"],["appearance","outline",1,"status-filter"],[3,"selectionChange","value"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","loading-container",4,"ngIf"],[4,"ngIf"],[3,"value"],[1,"loading-container"],["diameter","50"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","title"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","categories"],["matColumnDef","location"],["matColumnDef","reportStatus"],["matColumnDef","dateCreation"],["matColumnDef","importantVotes"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Seleccionar p\xE1gina",3,"page","length","pageSize","pageIndex","pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],[4,"ngFor","ngForOf"],[3,"ngClass"],["mat-raised-button","","color","primary",1,"action-button",3,"click"],["mat-raised-button","","color","warn",1,"action-button",3,"click"],["mat-raised-button","","color","accent",1,"action-button",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,n){e&1&&(oe(0,"button",0),_t("click",function(){return n.goBack()}),oe(1,"mat-icon"),Ee(2,"arrow_back"),ae()(),oe(3,"mat-card",1)(4,"h1"),Ee(5,"Mis Reportes"),ae(),Et(6,"mat-divider"),oe(7,"mat-form-field",2)(8,"mat-label"),Ee(9,"Filtrar por estado"),ae(),oe(10,"mat-select",3),_t("selectionChange",function(r){return n.onStatusChange(r.value)}),oe(11,"mat-option",4),Ee(12,"Todos"),ae(),pt(13,Fse,2,2,"mat-option",5),ae()(),pt(14,Lse,2,0,"div",6)(15,nle,29,8,"div",7),ae()),e&2&&(ge(10),Be("value",n.selectedStatus()),ge(3),Be("ngForOf",n.statuses),ge(),Be("ngIf",n.loading()),ge(),Be("ngIf",!n.loading()))},dependencies:[sr,qa,cs,Zn,Uc,us,kl,Jc,td,Uu,ed,qd,ac,Lp,Dp,Tp,kp,Ip,Mp,Pp,Ap,Rp,Op,Fp,Ty,Bm,oc,rc,Ay,ZD,Ry,Vm,Bx,ua,no],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c;--resolve-color: #26a69a;--table-header-bg: #d0eaf5;--table-row-hover: #f2faff}mat-card[_ngcontent-%COMP%]{margin:2rem auto;padding:1.5rem;background:var(--input-bg);box-shadow:0 4px 20px #0000001a;border-radius:12px}mat-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:.5rem;color:var(--primary-dark);font-weight:600;font-size:24px}.status-filter[_ngcontent-%COMP%]{width:250px;margin:1.5rem 0}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:50px 0}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background-color:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px #0000000d}th.mat-header-cell[_ngcontent-%COMP%]{background-color:var(--table-header-bg);color:var(--primary-dark);font-weight:600;padding:12px;border-bottom:1px solid #ccc}td.mat-cell[_ngcontent-%COMP%]{padding:12px 16px;color:#333;border-bottom:1px solid #eee}tr.mat-row[_ngcontent-%COMP%]:hover{background-color:var(--table-row-hover);transition:background-color .2s ease-in-out}mat-chip[_ngcontent-%COMP%]{background-color:var(--primary-accent);color:#fff;font-weight:500;margin-right:5px}.status-pending[_ngcontent-%COMP%], .status-rejected[_ngcontent-%COMP%], .status-verified[_ngcontent-%COMP%], .status-resolved[_ngcontent-%COMP%]{display:inline-block;padding:6px 10px;border-radius:4px;font-weight:600;font-size:13px}.status-pending[_ngcontent-%COMP%]{background-color:#fff59d;color:#444}.status-rejected[_ngcontent-%COMP%]{background-color:#ef9a9a;color:#fff}.status-verified[_ngcontent-%COMP%]{background-color:#a5d6a7;color:#fff}.status-resolved[_ngcontent-%COMP%]{background-color:#81d4fa;color:#fff}td.mat-cell[_ngcontent-%COMP%] > ng-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:8px 0}.action-button[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;gap:6px;height:36px;width:120px;padding:0 12px;font-size:13px;font-weight:500;line-height:1;border-radius:6px;box-shadow:0 2px 4px #0000001a;text-transform:none;box-sizing:border-box;transition:background-color .2s ease,box-shadow .2s ease}.action-button[color=primary][_ngcontent-%COMP%]{background-color:var(--primary-accent);color:#000}.action-button[color=primary][_ngcontent-%COMP%]:hover{background-color:#1e8e81;box-shadow:0 3px 6px #00000026;color:#fff}.action-button[color=warn][_ngcontent-%COMP%]{background-color:var(--error-color);color:#000}.action-button[color=warn][_ngcontent-%COMP%]:hover{background-color:#ac1e08;color:#fff}.action-button[color=accent][_ngcontent-%COMP%]{background-color:var(--resolve-color);color:#000}.action-button[color=accent][_ngcontent-%COMP%]:hover{background-color:#5fa2c9;color:#fff}.action-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;line-height:1}mat-paginator[_ngcontent-%COMP%]{margin-top:1.5rem;background:transparent}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;width:40px;height:40px;padding:0;background-color:#fff;border:1px solid #ccc;border-radius:8px;box-shadow:0 4px 12px #0000000d;display:flex;align-items:center;justify-content:center;transition:background-color .2s ease,transform .1s ease}.back-button[_ngcontent-%COMP%]:hover{background-color:#f9f9f9;transform:translate(-2px)}.back-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;color:#0009}"]})};var TH=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:SD},{path:"register",component:ED},{path:"validate-account",component:Fx},{path:"map",component:kD,canActivate:[$d]},{path:"report/new",component:Lx,canActivate:[$d]},{path:"report/edit/:id",component:Lx,canActivate:[$d]},{path:"user/edit",component:cM,canActivate:[$d]},{path:"user/edit/password",component:dM,canActivate:[$d]},{path:"profile",component:uM,canActivate:[$d]},{path:"my-reports",component:hM,canActivate:[$d]},{path:"validate-account",component:Fx},{path:"reset-password",component:PD},{path:"report-list-admin",component:XD,canActivate:[Hu]},{path:"report-histories",component:iM,canActivate:[Hu]},{path:"report-summary",component:rM,canActivate:[Hu]},{path:"category-list",component:sM,canActivate:[Hu]},{path:"categories/create",component:Gx,canActivate:[Hu]},{path:"categories/edit/:id",component:Gx,canActivate:[Hu]},{path:"**",component:OD}];var pM=class i{constructor(t,e){this.http=t;this.router=e}refreshing=!1;intercept(t,e){return e.handle(t).pipe(tr(n=>n.status!==401||this.refreshing||t.url.endsWith("/accessTokens")?lo(()=>n):(this.refreshing=!0,this.http.post("http://localhost:8080/api/v1/auth/accessTokens",{},{withCredentials:!0}).pipe(Oo(()=>e.handle(t)),tr(s=>(this.router.navigate(["/login"]),lo(()=>s))),jl(()=>{this.refreshing=!1})))))}static \u0275fac=function(e){return new(e||i)(hi(zo),hi(fn))};static \u0275prov=Mt({token:i,factory:i.\u0275fac})};function IH(i){return i!==null&&typeof i=="object"&&"constructor"in i&&i.constructor===Object}function aO(i,t){i===void 0&&(i={}),t===void 0&&(t={});let e=["__proto__","constructor","prototype"];Object.keys(t).filter(n=>e.indexOf(n)<0).forEach(n=>{typeof i[n]>"u"?i[n]=t[n]:IH(t[n])&&IH(i[n])&&Object.keys(t[n]).length>0&&aO(i[n],t[n])})}var AH={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}},createElementNS(){return{}},importNode(){return null},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function Zr(){let i=typeof document<"u"?document:{};return aO(i,AH),i}var rle={document:AH,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle(){return{getPropertyValue(){return""}}},Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia(){return{}},requestAnimationFrame(i){return typeof setTimeout>"u"?(i(),null):setTimeout(i,0)},cancelAnimationFrame(i){typeof setTimeout>"u"||clearTimeout(i)}};function Ir(){let i=typeof window<"u"?window:{};return aO(i,rle),i}function $u(i){return i===void 0&&(i=""),i.trim().split(" ").filter(t=>!!t.trim())}function RH(i){let t=i;Object.keys(t).forEach(e=>{try{t[e]=null}catch{}try{delete t[e]}catch{}})}function id(i,t){return t===void 0&&(t=0),setTimeout(i,t)}function Ps(){return Date.now()}function ole(i){let t=Ir(),e;return t.getComputedStyle&&(e=t.getComputedStyle(i,null)),!e&&i.currentStyle&&(e=i.currentStyle),e||(e=i.style),e}function qx(i,t){t===void 0&&(t="x");let e=Ir(),n,s,r,y=ole(i);return e.WebKitCSSMatrix?(s=y.transform||y.webkitTransform,s.split(",").length>6&&(s=s.split(", ").map(A=>A.replace(",",".")).join(", ")),r=new e.WebKitCSSMatrix(s==="none"?"":s)):(r=y.MozTransform||y.OTransform||y.MsTransform||y.msTransform||y.transform||y.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),n=r.toString().split(",")),t==="x"&&(e.WebKitCSSMatrix?s=r.m41:n.length===16?s=parseFloat(n[12]):s=parseFloat(n[4])),t==="y"&&(e.WebKitCSSMatrix?s=r.m42:n.length===16?s=parseFloat(n[13]):s=parseFloat(n[5])),s||0}function zy(i){return typeof i=="object"&&i!==null&&i.constructor&&Object.prototype.toString.call(i).slice(8,-1)==="Object"}function ale(i){return typeof window<"u"&&typeof window.HTMLElement<"u"?i instanceof HTMLElement:i&&(i.nodeType===1||i.nodeType===11)}function al(){let i=Object(arguments.length<=0?void 0:arguments[0]),t=["__proto__","constructor","prototype"];for(let e=1;e<arguments.length;e+=1){let n=e<0||arguments.length<=e?void 0:arguments[e];if(n!=null&&!ale(n)){let s=Object.keys(Object(n)).filter(r=>t.indexOf(r)<0);for(let r=0,y=s.length;r<y;r+=1){let A=s[r],P=Object.getOwnPropertyDescriptor(n,A);P!==void 0&&P.enumerable&&(zy(i[A])&&zy(n[A])?n[A].__swiper__?i[A]=n[A]:al(i[A],n[A]):!zy(i[A])&&zy(n[A])?(i[A]={},n[A].__swiper__?i[A]=n[A]:al(i[A],n[A])):i[A]=n[A])}}}return i}function jm(i,t,e){i.style.setProperty(t,e)}function sO(i){let{swiper:t,targetPosition:e,side:n}=i,s=Ir(),r=-t.translate,y=null,A,P=t.params.speed;t.wrapperEl.style.scrollSnapType="none",s.cancelAnimationFrame(t.cssModeFrameID);let B=e>r?"next":"prev",U=(le,re)=>B==="next"&&le>=re||B==="prev"&&le<=re,J=()=>{A=new Date().getTime(),y===null&&(y=A);let le=Math.max(Math.min((A-y)/P,1),0),re=.5-Math.cos(le*Math.PI)/2,X=r+re*(e-r);if(U(X,e)&&(X=e),t.wrapperEl.scrollTo({[n]:X}),U(X,e)){t.wrapperEl.style.overflow="hidden",t.wrapperEl.style.scrollSnapType="",setTimeout(()=>{t.wrapperEl.style.overflow="",t.wrapperEl.scrollTo({[n]:X})}),s.cancelAnimationFrame(t.cssModeFrameID);return}t.cssModeFrameID=s.requestAnimationFrame(J)};J()}function sl(i){return i.querySelector(".swiper-slide-transform")||i.shadowRoot&&i.shadowRoot.querySelector(".swiper-slide-transform")||i}function wo(i,t){t===void 0&&(t="");let e=Ir(),n=[...i.children];return e.HTMLSlotElement&&i instanceof HTMLSlotElement&&n.push(...i.assignedElements()),t?n.filter(s=>s.matches(t)):n}function sle(i,t){let e=[t];for(;e.length>0;){let n=e.shift();if(i===n)return!0;e.push(...n.children,...n.shadowRoot?n.shadowRoot.children:[],...n.assignedElements?n.assignedElements():[])}}function kH(i,t){let e=Ir(),n=t.contains(i);return!n&&e.HTMLSlotElement&&t instanceof HTMLSlotElement&&(n=[...t.assignedElements()].includes(i),n||(n=sle(i,t))),n}function Wx(i){try{console.warn(i);return}catch{}}function ha(i,t){t===void 0&&(t=[]);let e=document.createElement(i);return e.classList.add(...Array.isArray(t)?t:$u(t)),e}function Um(i){let t=Ir(),e=Zr(),n=i.getBoundingClientRect(),s=e.body,r=i.clientTop||s.clientTop||0,y=i.clientLeft||s.clientLeft||0,A=i===t?t.scrollY:i.scrollTop,P=i===t?t.scrollX:i.scrollLeft;return{top:n.top+A-r,left:n.left+P-y}}function PH(i,t){let e=[];for(;i.previousElementSibling;){let n=i.previousElementSibling;t?n.matches(t)&&e.push(n):e.push(n),i=n}return e}function OH(i,t){let e=[];for(;i.nextElementSibling;){let n=i.nextElementSibling;t?n.matches(t)&&e.push(n):e.push(n),i=n}return e}function Gu(i,t){return Ir().getComputedStyle(i,null).getPropertyValue(t)}function Up(i){let t=i,e;if(t){for(e=0;(t=t.previousSibling)!==null;)t.nodeType===1&&(e+=1);return e}}function nd(i,t){let e=[],n=i.parentElement;for(;n;)t?n.matches(t)&&e.push(n):e.push(n),n=n.parentElement;return e}function Hp(i,t){function e(n){n.target===i&&(t.call(i,n),i.removeEventListener("transitionend",e))}t&&i.addEventListener("transitionend",e)}function Yx(i,t,e){let n=Ir();return e?i[t==="width"?"offsetWidth":"offsetHeight"]+parseFloat(n.getComputedStyle(i,null).getPropertyValue(t==="width"?"margin-right":"margin-top"))+parseFloat(n.getComputedStyle(i,null).getPropertyValue(t==="width"?"margin-left":"margin-bottom")):i.offsetWidth}function Xn(i){return(Array.isArray(i)?i:[i]).filter(t=>!!t)}function $p(i){return t=>Math.abs(t)>0&&i.browser&&i.browser.need3dFix&&Math.abs(t)%90===0?t+.001:t}var lO;function lle(){let i=Ir(),t=Zr();return{smoothScroll:t.documentElement&&t.documentElement.style&&"scrollBehavior"in t.documentElement.style,touch:!!("ontouchstart"in i||i.DocumentTouch&&t instanceof i.DocumentTouch)}}function BH(){return lO||(lO=lle()),lO}var cO;function cle(i){let{userAgent:t}=i===void 0?{}:i,e=BH(),n=Ir(),s=n.navigator.platform,r=t||n.navigator.userAgent,y={ios:!1,android:!1},A=n.screen.width,P=n.screen.height,B=r.match(/(Android);?[\s\/]+([\d.]+)?/),U=r.match(/(iPad).*OS\s([\d_]+)/),J=r.match(/(iPod)(.*OS\s([\d_]+))?/),le=!U&&r.match(/(iPhone\sOS|iOS)\s([\d_]+)/),re=s==="Win32",X=s==="MacIntel",ee=["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"];return!U&&X&&e.touch&&ee.indexOf(`${A}x${P}`)>=0&&(U=r.match(/(Version)\/([\d.]+)/),U||(U=[0,1,"13_0_0"]),X=!1),B&&!re&&(y.os="android",y.android=!0),(U||le||J)&&(y.os="ios",y.ios=!0),y}function VH(i){return i===void 0&&(i={}),cO||(cO=cle(i)),cO}var dO;function dle(){let i=Ir(),t=VH(),e=!1;function n(){let A=i.navigator.userAgent.toLowerCase();return A.indexOf("safari")>=0&&A.indexOf("chrome")<0&&A.indexOf("android")<0}if(n()){let A=String(i.navigator.userAgent);if(A.includes("Version/")){let[P,B]=A.split("Version/")[1].split(" ")[0].split(".").map(U=>Number(U));e=P<16||P===16&&B<2}}let s=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(i.navigator.userAgent),r=n(),y=r||s&&t.ios;return{isSafari:e||r,needPerspectiveFix:e,need3dFix:y,isWebView:s}}function jH(){return dO||(dO=dle()),dO}function ule(i){let{swiper:t,on:e,emit:n}=i,s=Ir(),r=null,y=null,A=()=>{!t||t.destroyed||!t.initialized||(n("beforeResize"),n("resize"))},P=()=>{!t||t.destroyed||!t.initialized||(r=new ResizeObserver(J=>{y=s.requestAnimationFrame(()=>{let{width:le,height:re}=t,X=le,ee=re;J.forEach(we=>{let{contentBoxSize:Re,contentRect:Ce,target:Te}=we;Te&&Te!==t.el||(X=Ce?Ce.width:(Re[0]||Re).inlineSize,ee=Ce?Ce.height:(Re[0]||Re).blockSize)}),(X!==le||ee!==re)&&A()})}),r.observe(t.el))},B=()=>{y&&s.cancelAnimationFrame(y),r&&r.unobserve&&t.el&&(r.unobserve(t.el),r=null)},U=()=>{!t||t.destroyed||!t.initialized||n("orientationchange")};e("init",()=>{if(t.params.resizeObserver&&typeof s.ResizeObserver<"u"){P();return}s.addEventListener("resize",A),s.addEventListener("orientationchange",U)}),e("destroy",()=>{B(),s.removeEventListener("resize",A),s.removeEventListener("orientationchange",U)})}function hle(i){let{swiper:t,extendParams:e,on:n,emit:s}=i,r=[],y=Ir(),A=function(U,J){J===void 0&&(J={});let le=y.MutationObserver||y.WebkitMutationObserver,re=new le(X=>{if(t.__preventObserver__)return;if(X.length===1){s("observerUpdate",X[0]);return}let ee=function(){s("observerUpdate",X[0])};y.requestAnimationFrame?y.requestAnimationFrame(ee):y.setTimeout(ee,0)});re.observe(U,{attributes:typeof J.attributes>"u"?!0:J.attributes,childList:t.isElement||(typeof J.childList>"u"?!0:J).childList,characterData:typeof J.characterData>"u"?!0:J.characterData}),r.push(re)},P=()=>{if(t.params.observer){if(t.params.observeParents){let U=nd(t.hostEl);for(let J=0;J<U.length;J+=1)A(U[J])}A(t.hostEl,{childList:t.params.observeSlideChildren}),A(t.wrapperEl,{attributes:!1})}},B=()=>{r.forEach(U=>{U.disconnect()}),r.splice(0,r.length)};e({observer:!1,observeParents:!1,observeSlideChildren:!1}),n("init",P),n("destroy",B)}var ple={on(i,t,e){let n=this;if(!n.eventsListeners||n.destroyed||typeof t!="function")return n;let s=e?"unshift":"push";return i.split(" ").forEach(r=>{n.eventsListeners[r]||(n.eventsListeners[r]=[]),n.eventsListeners[r][s](t)}),n},once(i,t,e){let n=this;if(!n.eventsListeners||n.destroyed||typeof t!="function")return n;function s(){n.off(i,s),s.__emitterProxy&&delete s.__emitterProxy;for(var r=arguments.length,y=new Array(r),A=0;A<r;A++)y[A]=arguments[A];t.apply(n,y)}return s.__emitterProxy=t,n.on(i,s,e)},onAny(i,t){let e=this;if(!e.eventsListeners||e.destroyed||typeof i!="function")return e;let n=t?"unshift":"push";return e.eventsAnyListeners.indexOf(i)<0&&e.eventsAnyListeners[n](i),e},offAny(i){let t=this;if(!t.eventsListeners||t.destroyed||!t.eventsAnyListeners)return t;let e=t.eventsAnyListeners.indexOf(i);return e>=0&&t.eventsAnyListeners.splice(e,1),t},off(i,t){let e=this;return!e.eventsListeners||e.destroyed||!e.eventsListeners||i.split(" ").forEach(n=>{typeof t>"u"?e.eventsListeners[n]=[]:e.eventsListeners[n]&&e.eventsListeners[n].forEach((s,r)=>{(s===t||s.__emitterProxy&&s.__emitterProxy===t)&&e.eventsListeners[n].splice(r,1)})}),e},emit(){let i=this;if(!i.eventsListeners||i.destroyed||!i.eventsListeners)return i;let t,e,n;for(var s=arguments.length,r=new Array(s),y=0;y<s;y++)r[y]=arguments[y];return typeof r[0]=="string"||Array.isArray(r[0])?(t=r[0],e=r.slice(1,r.length),n=i):(t=r[0].events,e=r[0].data,n=r[0].context||i),e.unshift(n),(Array.isArray(t)?t:t.split(" ")).forEach(P=>{i.eventsAnyListeners&&i.eventsAnyListeners.length&&i.eventsAnyListeners.forEach(B=>{B.apply(n,[P,...e])}),i.eventsListeners&&i.eventsListeners[P]&&i.eventsListeners[P].forEach(B=>{B.apply(n,e)})}),i}};function fle(){let i=this,t,e,n=i.el;typeof i.params.width<"u"&&i.params.width!==null?t=i.params.width:t=n.clientWidth,typeof i.params.height<"u"&&i.params.height!==null?e=i.params.height:e=n.clientHeight,!(t===0&&i.isHorizontal()||e===0&&i.isVertical())&&(t=t-parseInt(Gu(n,"padding-left")||0,10)-parseInt(Gu(n,"padding-right")||0,10),e=e-parseInt(Gu(n,"padding-top")||0,10)-parseInt(Gu(n,"padding-bottom")||0,10),Number.isNaN(t)&&(t=0),Number.isNaN(e)&&(e=0),Object.assign(i,{width:t,height:e,size:i.isHorizontal()?t:e}))}function mle(){let i=this;function t(xt,Bt){return parseFloat(xt.getPropertyValue(i.getDirectionLabel(Bt))||0)}let e=i.params,{wrapperEl:n,slidesEl:s,size:r,rtlTranslate:y,wrongRTL:A}=i,P=i.virtual&&e.virtual.enabled,B=P?i.virtual.slides.length:i.slides.length,U=wo(s,`.${i.params.slideClass}, swiper-slide`),J=P?i.virtual.slides.length:U.length,le=[],re=[],X=[],ee=e.slidesOffsetBefore;typeof ee=="function"&&(ee=e.slidesOffsetBefore.call(i));let we=e.slidesOffsetAfter;typeof we=="function"&&(we=e.slidesOffsetAfter.call(i));let Re=i.snapGrid.length,Ce=i.slidesGrid.length,Te=e.spaceBetween,Xe=-ee,et=0,Pt=0;if(typeof r>"u")return;typeof Te=="string"&&Te.indexOf("%")>=0?Te=parseFloat(Te.replace("%",""))/100*r:typeof Te=="string"&&(Te=parseFloat(Te)),i.virtualSize=-Te,U.forEach(xt=>{y?xt.style.marginLeft="":xt.style.marginRight="",xt.style.marginBottom="",xt.style.marginTop=""}),e.centeredSlides&&e.cssMode&&(jm(n,"--swiper-centered-offset-before",""),jm(n,"--swiper-centered-offset-after",""));let Lt=e.grid&&e.grid.rows>1&&i.grid;Lt?i.grid.initSlides(U):i.grid&&i.grid.unsetSlides();let lt,Ye=e.slidesPerView==="auto"&&e.breakpoints&&Object.keys(e.breakpoints).filter(xt=>typeof e.breakpoints[xt].slidesPerView<"u").length>0;for(let xt=0;xt<J;xt+=1){lt=0;let Bt;if(U[xt]&&(Bt=U[xt]),Lt&&i.grid.updateSlide(xt,Bt,U),!(U[xt]&&Gu(Bt,"display")==="none")){if(e.slidesPerView==="auto"){Ye&&(U[xt].style[i.getDirectionLabel("width")]="");let Ft=getComputedStyle(Bt),dt=Bt.style.transform,Ot=Bt.style.webkitTransform;if(dt&&(Bt.style.transform="none"),Ot&&(Bt.style.webkitTransform="none"),e.roundLengths)lt=i.isHorizontal()?Yx(Bt,"width",!0):Yx(Bt,"height",!0);else{let Kt=t(Ft,"width"),oi=t(Ft,"padding-left"),tt=t(Ft,"padding-right"),vt=t(Ft,"margin-left"),pi=t(Ft,"margin-right"),mn=Ft.getPropertyValue("box-sizing");if(mn&&mn==="border-box")lt=Kt+vt+pi;else{let{clientWidth:_i,offsetWidth:ro}=Bt;lt=Kt+oi+tt+vt+pi+(ro-_i)}}dt&&(Bt.style.transform=dt),Ot&&(Bt.style.webkitTransform=Ot),e.roundLengths&&(lt=Math.floor(lt))}else lt=(r-(e.slidesPerView-1)*Te)/e.slidesPerView,e.roundLengths&&(lt=Math.floor(lt)),U[xt]&&(U[xt].style[i.getDirectionLabel("width")]=`${lt}px`);U[xt]&&(U[xt].swiperSlideSize=lt),X.push(lt),e.centeredSlides?(Xe=Xe+lt/2+et/2+Te,et===0&&xt!==0&&(Xe=Xe-r/2-Te),xt===0&&(Xe=Xe-r/2-Te),Math.abs(Xe)<1/1e3&&(Xe=0),e.roundLengths&&(Xe=Math.floor(Xe)),Pt%e.slidesPerGroup===0&&le.push(Xe),re.push(Xe)):(e.roundLengths&&(Xe=Math.floor(Xe)),(Pt-Math.min(i.params.slidesPerGroupSkip,Pt))%i.params.slidesPerGroup===0&&le.push(Xe),re.push(Xe),Xe=Xe+lt+Te),i.virtualSize+=lt+Te,et=lt,Pt+=1}}if(i.virtualSize=Math.max(i.virtualSize,r)+we,y&&A&&(e.effect==="slide"||e.effect==="coverflow")&&(n.style.width=`${i.virtualSize+Te}px`),e.setWrapperSize&&(n.style[i.getDirectionLabel("width")]=`${i.virtualSize+Te}px`),Lt&&i.grid.updateWrapperSize(lt,le),!e.centeredSlides){let xt=[];for(let Bt=0;Bt<le.length;Bt+=1){let Ft=le[Bt];e.roundLengths&&(Ft=Math.floor(Ft)),le[Bt]<=i.virtualSize-r&&xt.push(Ft)}le=xt,Math.floor(i.virtualSize-r)-Math.floor(le[le.length-1])>1&&le.push(i.virtualSize-r)}if(P&&e.loop){let xt=X[0]+Te;if(e.slidesPerGroup>1){let Bt=Math.ceil((i.virtual.slidesBefore+i.virtual.slidesAfter)/e.slidesPerGroup),Ft=xt*e.slidesPerGroup;for(let dt=0;dt<Bt;dt+=1)le.push(le[le.length-1]+Ft)}for(let Bt=0;Bt<i.virtual.slidesBefore+i.virtual.slidesAfter;Bt+=1)e.slidesPerGroup===1&&le.push(le[le.length-1]+xt),re.push(re[re.length-1]+xt),i.virtualSize+=xt}if(le.length===0&&(le=[0]),Te!==0){let xt=i.isHorizontal()&&y?"marginLeft":i.getDirectionLabel("marginRight");U.filter((Bt,Ft)=>!e.cssMode||e.loop?!0:Ft!==U.length-1).forEach(Bt=>{Bt.style[xt]=`${Te}px`})}if(e.centeredSlides&&e.centeredSlidesBounds){let xt=0;X.forEach(Ft=>{xt+=Ft+(Te||0)}),xt-=Te;let Bt=xt>r?xt-r:0;le=le.map(Ft=>Ft<=0?-ee:Ft>Bt?Bt+we:Ft)}if(e.centerInsufficientSlides){let xt=0;X.forEach(Ft=>{xt+=Ft+(Te||0)}),xt-=Te;let Bt=(e.slidesOffsetBefore||0)+(e.slidesOffsetAfter||0);if(xt+Bt<r){let Ft=(r-xt-Bt)/2;le.forEach((dt,Ot)=>{le[Ot]=dt-Ft}),re.forEach((dt,Ot)=>{re[Ot]=dt+Ft})}}if(Object.assign(i,{slides:U,snapGrid:le,slidesGrid:re,slidesSizesGrid:X}),e.centeredSlides&&e.cssMode&&!e.centeredSlidesBounds){jm(n,"--swiper-centered-offset-before",`${-le[0]}px`),jm(n,"--swiper-centered-offset-after",`${i.size/2-X[X.length-1]/2}px`);let xt=-i.snapGrid[0],Bt=-i.slidesGrid[0];i.snapGrid=i.snapGrid.map(Ft=>Ft+xt),i.slidesGrid=i.slidesGrid.map(Ft=>Ft+Bt)}if(J!==B&&i.emit("slidesLengthChange"),le.length!==Re&&(i.params.watchOverflow&&i.checkOverflow(),i.emit("snapGridLengthChange")),re.length!==Ce&&i.emit("slidesGridLengthChange"),e.watchSlidesProgress&&i.updateSlidesOffset(),i.emit("slidesUpdated"),!P&&!e.cssMode&&(e.effect==="slide"||e.effect==="fade")){let xt=`${e.containerModifierClass}backface-hidden`,Bt=i.el.classList.contains(xt);J<=e.maxBackfaceHiddenSlides?Bt||i.el.classList.add(xt):Bt&&i.el.classList.remove(xt)}}function gle(i){let t=this,e=[],n=t.virtual&&t.params.virtual.enabled,s=0,r;typeof i=="number"?t.setTransition(i):i===!0&&t.setTransition(t.params.speed);let y=A=>n?t.slides[t.getSlideIndexByData(A)]:t.slides[A];if(t.params.slidesPerView!=="auto"&&t.params.slidesPerView>1)if(t.params.centeredSlides)(t.visibleSlides||[]).forEach(A=>{e.push(A)});else for(r=0;r<Math.ceil(t.params.slidesPerView);r+=1){let A=t.activeIndex+r;if(A>t.slides.length&&!n)break;e.push(y(A))}else e.push(y(t.activeIndex));for(r=0;r<e.length;r+=1)if(typeof e[r]<"u"){let A=e[r].offsetHeight;s=A>s?A:s}(s||s===0)&&(t.wrapperEl.style.height=`${s}px`)}function _le(){let i=this,t=i.slides,e=i.isElement?i.isHorizontal()?i.wrapperEl.offsetLeft:i.wrapperEl.offsetTop:0;for(let n=0;n<t.length;n+=1)t[n].swiperSlideOffset=(i.isHorizontal()?t[n].offsetLeft:t[n].offsetTop)-e-i.cssOverflowAdjustment()}var FH=(i,t,e)=>{t&&!i.classList.contains(e)?i.classList.add(e):!t&&i.classList.contains(e)&&i.classList.remove(e)};function yle(i){i===void 0&&(i=this&&this.translate||0);let t=this,e=t.params,{slides:n,rtlTranslate:s,snapGrid:r}=t;if(n.length===0)return;typeof n[0].swiperSlideOffset>"u"&&t.updateSlidesOffset();let y=-i;s&&(y=i),t.visibleSlidesIndexes=[],t.visibleSlides=[];let A=e.spaceBetween;typeof A=="string"&&A.indexOf("%")>=0?A=parseFloat(A.replace("%",""))/100*t.size:typeof A=="string"&&(A=parseFloat(A));for(let P=0;P<n.length;P+=1){let B=n[P],U=B.swiperSlideOffset;e.cssMode&&e.centeredSlides&&(U-=n[0].swiperSlideOffset);let J=(y+(e.centeredSlides?t.minTranslate():0)-U)/(B.swiperSlideSize+A),le=(y-r[0]+(e.centeredSlides?t.minTranslate():0)-U)/(B.swiperSlideSize+A),re=-(y-U),X=re+t.slidesSizesGrid[P],ee=re>=0&&re<=t.size-t.slidesSizesGrid[P],we=re>=0&&re<t.size-1||X>1&&X<=t.size||re<=0&&X>=t.size;we&&(t.visibleSlides.push(B),t.visibleSlidesIndexes.push(P)),FH(B,we,e.slideVisibleClass),FH(B,ee,e.slideFullyVisibleClass),B.progress=s?-J:J,B.originalProgress=s?-le:le}}function vle(i){let t=this;if(typeof i>"u"){let U=t.rtlTranslate?-1:1;i=t&&t.translate&&t.translate*U||0}let e=t.params,n=t.maxTranslate()-t.minTranslate(),{progress:s,isBeginning:r,isEnd:y,progressLoop:A}=t,P=r,B=y;if(n===0)s=0,r=!0,y=!0;else{s=(i-t.minTranslate())/n;let U=Math.abs(i-t.minTranslate())<1,J=Math.abs(i-t.maxTranslate())<1;r=U||s<=0,y=J||s>=1,U&&(s=0),J&&(s=1)}if(e.loop){let U=t.getSlideIndexByData(0),J=t.getSlideIndexByData(t.slides.length-1),le=t.slidesGrid[U],re=t.slidesGrid[J],X=t.slidesGrid[t.slidesGrid.length-1],ee=Math.abs(i);ee>=le?A=(ee-le)/X:A=(ee+X-re)/X,A>1&&(A-=1)}Object.assign(t,{progress:s,progressLoop:A,isBeginning:r,isEnd:y}),(e.watchSlidesProgress||e.centeredSlides&&e.autoHeight)&&t.updateSlidesProgress(i),r&&!P&&t.emit("reachBeginning toEdge"),y&&!B&&t.emit("reachEnd toEdge"),(P&&!r||B&&!y)&&t.emit("fromEdge"),t.emit("progress",s)}var uO=(i,t,e)=>{t&&!i.classList.contains(e)?i.classList.add(e):!t&&i.classList.contains(e)&&i.classList.remove(e)};function ble(){let i=this,{slides:t,params:e,slidesEl:n,activeIndex:s}=i,r=i.virtual&&e.virtual.enabled,y=i.grid&&e.grid&&e.grid.rows>1,A=J=>wo(n,`.${e.slideClass}${J}, swiper-slide${J}`)[0],P,B,U;if(r)if(e.loop){let J=s-i.virtual.slidesBefore;J<0&&(J=i.virtual.slides.length+J),J>=i.virtual.slides.length&&(J-=i.virtual.slides.length),P=A(`[data-swiper-slide-index="${J}"]`)}else P=A(`[data-swiper-slide-index="${s}"]`);else y?(P=t.find(J=>J.column===s),U=t.find(J=>J.column===s+1),B=t.find(J=>J.column===s-1)):P=t[s];P&&(y||(U=OH(P,`.${e.slideClass}, swiper-slide`)[0],e.loop&&!U&&(U=t[0]),B=PH(P,`.${e.slideClass}, swiper-slide`)[0],e.loop&&!B===0&&(B=t[t.length-1]))),t.forEach(J=>{uO(J,J===P,e.slideActiveClass),uO(J,J===U,e.slideNextClass),uO(J,J===B,e.slidePrevClass)}),i.emitSlidesClasses()}var fM=(i,t)=>{if(!i||i.destroyed||!i.params)return;let e=()=>i.isElement?"swiper-slide":`.${i.params.slideClass}`,n=t.closest(e());if(n){let s=n.querySelector(`.${i.params.lazyPreloaderClass}`);!s&&i.isElement&&(n.shadowRoot?s=n.shadowRoot.querySelector(`.${i.params.lazyPreloaderClass}`):requestAnimationFrame(()=>{n.shadowRoot&&(s=n.shadowRoot.querySelector(`.${i.params.lazyPreloaderClass}`),s&&s.remove())})),s&&s.remove()}},hO=(i,t)=>{if(!i.slides[t])return;let e=i.slides[t].querySelector('[loading="lazy"]');e&&e.removeAttribute("loading")},mO=i=>{if(!i||i.destroyed||!i.params)return;let t=i.params.lazyPreloadPrevNext,e=i.slides.length;if(!e||!t||t<0)return;t=Math.min(t,e);let n=i.params.slidesPerView==="auto"?i.slidesPerViewDynamic():Math.ceil(i.params.slidesPerView),s=i.activeIndex;if(i.params.grid&&i.params.grid.rows>1){let y=s,A=[y-t];A.push(...Array.from({length:t}).map((P,B)=>y+n+B)),i.slides.forEach((P,B)=>{A.includes(P.column)&&hO(i,B)});return}let r=s+n-1;if(i.params.rewind||i.params.loop)for(let y=s-t;y<=r+t;y+=1){let A=(y%e+e)%e;(A<s||A>r)&&hO(i,A)}else for(let y=Math.max(s-t,0);y<=Math.min(r+t,e-1);y+=1)y!==s&&(y>r||y<s)&&hO(i,y)};function xle(i){let{slidesGrid:t,params:e}=i,n=i.rtlTranslate?i.translate:-i.translate,s;for(let r=0;r<t.length;r+=1)typeof t[r+1]<"u"?n>=t[r]&&n<t[r+1]-(t[r+1]-t[r])/2?s=r:n>=t[r]&&n<t[r+1]&&(s=r+1):n>=t[r]&&(s=r);return e.normalizeSlideIndex&&(s<0||typeof s>"u")&&(s=0),s}function wle(i){let t=this,e=t.rtlTranslate?t.translate:-t.translate,{snapGrid:n,params:s,activeIndex:r,realIndex:y,snapIndex:A}=t,P=i,B,U=re=>{let X=re-t.virtual.slidesBefore;return X<0&&(X=t.virtual.slides.length+X),X>=t.virtual.slides.length&&(X-=t.virtual.slides.length),X};if(typeof P>"u"&&(P=xle(t)),n.indexOf(e)>=0)B=n.indexOf(e);else{let re=Math.min(s.slidesPerGroupSkip,P);B=re+Math.floor((P-re)/s.slidesPerGroup)}if(B>=n.length&&(B=n.length-1),P===r&&!t.params.loop){B!==A&&(t.snapIndex=B,t.emit("snapIndexChange"));return}if(P===r&&t.params.loop&&t.virtual&&t.params.virtual.enabled){t.realIndex=U(P);return}let J=t.grid&&s.grid&&s.grid.rows>1,le;if(t.virtual&&s.virtual.enabled&&s.loop)le=U(P);else if(J){let re=t.slides.find(ee=>ee.column===P),X=parseInt(re.getAttribute("data-swiper-slide-index"),10);Number.isNaN(X)&&(X=Math.max(t.slides.indexOf(re),0)),le=Math.floor(X/s.grid.rows)}else if(t.slides[P]){let re=t.slides[P].getAttribute("data-swiper-slide-index");re?le=parseInt(re,10):le=P}else le=P;Object.assign(t,{previousSnapIndex:A,snapIndex:B,previousRealIndex:y,realIndex:le,previousIndex:r,activeIndex:P}),t.initialized&&mO(t),t.emit("activeIndexChange"),t.emit("snapIndexChange"),(t.initialized||t.params.runCallbacksOnInit)&&(y!==le&&t.emit("realIndexChange"),t.emit("slideChange"))}function Cle(i,t){let e=this,n=e.params,s=i.closest(`.${n.slideClass}, swiper-slide`);!s&&e.isElement&&t&&t.length>1&&t.includes(i)&&[...t.slice(t.indexOf(i)+1,t.length)].forEach(A=>{!s&&A.matches&&A.matches(`.${n.slideClass}, swiper-slide`)&&(s=A)});let r=!1,y;if(s){for(let A=0;A<e.slides.length;A+=1)if(e.slides[A]===s){r=!0,y=A;break}}if(s&&r)e.clickedSlide=s,e.virtual&&e.params.virtual.enabled?e.clickedIndex=parseInt(s.getAttribute("data-swiper-slide-index"),10):e.clickedIndex=y;else{e.clickedSlide=void 0,e.clickedIndex=void 0;return}n.slideToClickedSlide&&e.clickedIndex!==void 0&&e.clickedIndex!==e.activeIndex&&e.slideToClickedSlide()}var Ele={updateSize:fle,updateSlides:mle,updateAutoHeight:gle,updateSlidesOffset:_le,updateSlidesProgress:yle,updateProgress:vle,updateSlidesClasses:ble,updateActiveIndex:wle,updateClickedSlide:Cle};function Sle(i){i===void 0&&(i=this.isHorizontal()?"x":"y");let t=this,{params:e,rtlTranslate:n,translate:s,wrapperEl:r}=t;if(e.virtualTranslate)return n?-s:s;if(e.cssMode)return s;let y=qx(r,i);return y+=t.cssOverflowAdjustment(),n&&(y=-y),y||0}function Dle(i,t){let e=this,{rtlTranslate:n,params:s,wrapperEl:r,progress:y}=e,A=0,P=0,B=0;e.isHorizontal()?A=n?-i:i:P=i,s.roundLengths&&(A=Math.floor(A),P=Math.floor(P)),e.previousTranslate=e.translate,e.translate=e.isHorizontal()?A:P,s.cssMode?r[e.isHorizontal()?"scrollLeft":"scrollTop"]=e.isHorizontal()?-A:-P:s.virtualTranslate||(e.isHorizontal()?A-=e.cssOverflowAdjustment():P-=e.cssOverflowAdjustment(),r.style.transform=`translate3d(${A}px, ${P}px, ${B}px)`);let U,J=e.maxTranslate()-e.minTranslate();J===0?U=0:U=(i-e.minTranslate())/J,U!==y&&e.updateProgress(i),e.emit("setTranslate",e.translate,t)}function Mle(){return-this.snapGrid[0]}function Tle(){return-this.snapGrid[this.snapGrid.length-1]}function Ile(i,t,e,n,s){i===void 0&&(i=0),t===void 0&&(t=this.params.speed),e===void 0&&(e=!0),n===void 0&&(n=!0);let r=this,{params:y,wrapperEl:A}=r;if(r.animating&&y.preventInteractionOnTransition)return!1;let P=r.minTranslate(),B=r.maxTranslate(),U;if(n&&i>P?U=P:n&&i<B?U=B:U=i,r.updateProgress(U),y.cssMode){let J=r.isHorizontal();if(t===0)A[J?"scrollLeft":"scrollTop"]=-U;else{if(!r.support.smoothScroll)return sO({swiper:r,targetPosition:-U,side:J?"left":"top"}),!0;A.scrollTo({[J?"left":"top"]:-U,behavior:"smooth"})}return!0}return t===0?(r.setTransition(0),r.setTranslate(U),e&&(r.emit("beforeTransitionStart",t,s),r.emit("transitionEnd"))):(r.setTransition(t),r.setTranslate(U),e&&(r.emit("beforeTransitionStart",t,s),r.emit("transitionStart")),r.animating||(r.animating=!0,r.onTranslateToWrapperTransitionEnd||(r.onTranslateToWrapperTransitionEnd=function(le){!r||r.destroyed||le.target===this&&(r.wrapperEl.removeEventListener("transitionend",r.onTranslateToWrapperTransitionEnd),r.onTranslateToWrapperTransitionEnd=null,delete r.onTranslateToWrapperTransitionEnd,r.animating=!1,e&&r.emit("transitionEnd"))}),r.wrapperEl.addEventListener("transitionend",r.onTranslateToWrapperTransitionEnd))),!0}var Ale={getTranslate:Sle,setTranslate:Dle,minTranslate:Mle,maxTranslate:Tle,translateTo:Ile};function Rle(i,t){let e=this;e.params.cssMode||(e.wrapperEl.style.transitionDuration=`${i}ms`,e.wrapperEl.style.transitionDelay=i===0?"0ms":""),e.emit("setTransition",i,t)}function UH(i){let{swiper:t,runCallbacks:e,direction:n,step:s}=i,{activeIndex:r,previousIndex:y}=t,A=n;if(A||(r>y?A="next":r<y?A="prev":A="reset"),t.emit(`transition${s}`),e&&r!==y){if(A==="reset"){t.emit(`slideResetTransition${s}`);return}t.emit(`slideChangeTransition${s}`),A==="next"?t.emit(`slideNextTransition${s}`):t.emit(`slidePrevTransition${s}`)}}function kle(i,t){i===void 0&&(i=!0);let e=this,{params:n}=e;n.cssMode||(n.autoHeight&&e.updateAutoHeight(),UH({swiper:e,runCallbacks:i,direction:t,step:"Start"}))}function Ple(i,t){i===void 0&&(i=!0);let e=this,{params:n}=e;e.animating=!1,!n.cssMode&&(e.setTransition(0),UH({swiper:e,runCallbacks:i,direction:t,step:"End"}))}var Ole={setTransition:Rle,transitionStart:kle,transitionEnd:Ple};function Fle(i,t,e,n,s){i===void 0&&(i=0),e===void 0&&(e=!0),typeof i=="string"&&(i=parseInt(i,10));let r=this,y=i;y<0&&(y=0);let{params:A,snapGrid:P,slidesGrid:B,previousIndex:U,activeIndex:J,rtlTranslate:le,wrapperEl:re,enabled:X}=r;if(!X&&!n&&!s||r.destroyed||r.animating&&A.preventInteractionOnTransition)return!1;typeof t>"u"&&(t=r.params.speed);let ee=Math.min(r.params.slidesPerGroupSkip,y),we=ee+Math.floor((y-ee)/r.params.slidesPerGroup);we>=P.length&&(we=P.length-1);let Re=-P[we];if(A.normalizeSlideIndex)for(let Lt=0;Lt<B.length;Lt+=1){let lt=-Math.floor(Re*100),Ye=Math.floor(B[Lt]*100),xt=Math.floor(B[Lt+1]*100);typeof B[Lt+1]<"u"?lt>=Ye&&lt<xt-(xt-Ye)/2?y=Lt:lt>=Ye&&lt<xt&&(y=Lt+1):lt>=Ye&&(y=Lt)}if(r.initialized&&y!==J&&(!r.allowSlideNext&&(le?Re>r.translate&&Re>r.minTranslate():Re<r.translate&&Re<r.minTranslate())||!r.allowSlidePrev&&Re>r.translate&&Re>r.maxTranslate()&&(J||0)!==y))return!1;y!==(U||0)&&e&&r.emit("beforeSlideChangeStart"),r.updateProgress(Re);let Ce;y>J?Ce="next":y<J?Ce="prev":Ce="reset";let Te=r.virtual&&r.params.virtual.enabled;if(!(Te&&s)&&(le&&-Re===r.translate||!le&&Re===r.translate))return r.updateActiveIndex(y),A.autoHeight&&r.updateAutoHeight(),r.updateSlidesClasses(),A.effect!=="slide"&&r.setTranslate(Re),Ce!=="reset"&&(r.transitionStart(e,Ce),r.transitionEnd(e,Ce)),!1;if(A.cssMode){let Lt=r.isHorizontal(),lt=le?Re:-Re;if(t===0)Te&&(r.wrapperEl.style.scrollSnapType="none",r._immediateVirtual=!0),Te&&!r._cssModeVirtualInitialSet&&r.params.initialSlide>0?(r._cssModeVirtualInitialSet=!0,requestAnimationFrame(()=>{re[Lt?"scrollLeft":"scrollTop"]=lt})):re[Lt?"scrollLeft":"scrollTop"]=lt,Te&&requestAnimationFrame(()=>{r.wrapperEl.style.scrollSnapType="",r._immediateVirtual=!1});else{if(!r.support.smoothScroll)return sO({swiper:r,targetPosition:lt,side:Lt?"left":"top"}),!0;re.scrollTo({[Lt?"left":"top"]:lt,behavior:"smooth"})}return!0}let Pt=jH().isSafari;return Te&&!s&&Pt&&r.isElement&&r.virtual.update(!1,!1,y),r.setTransition(t),r.setTranslate(Re),r.updateActiveIndex(y),r.updateSlidesClasses(),r.emit("beforeTransitionStart",t,n),r.transitionStart(e,Ce),t===0?r.transitionEnd(e,Ce):r.animating||(r.animating=!0,r.onSlideToWrapperTransitionEnd||(r.onSlideToWrapperTransitionEnd=function(lt){!r||r.destroyed||lt.target===this&&(r.wrapperEl.removeEventListener("transitionend",r.onSlideToWrapperTransitionEnd),r.onSlideToWrapperTransitionEnd=null,delete r.onSlideToWrapperTransitionEnd,r.transitionEnd(e,Ce))}),r.wrapperEl.addEventListener("transitionend",r.onSlideToWrapperTransitionEnd)),!0}function Lle(i,t,e,n){i===void 0&&(i=0),e===void 0&&(e=!0),typeof i=="string"&&(i=parseInt(i,10));let s=this;if(s.destroyed)return;typeof t>"u"&&(t=s.params.speed);let r=s.grid&&s.params.grid&&s.params.grid.rows>1,y=i;if(s.params.loop)if(s.virtual&&s.params.virtual.enabled)y=y+s.virtual.slidesBefore;else{let A;if(r){let le=y*s.params.grid.rows;A=s.slides.find(re=>re.getAttribute("data-swiper-slide-index")*1===le).column}else A=s.getSlideIndexByData(y);let P=r?Math.ceil(s.slides.length/s.params.grid.rows):s.slides.length,{centeredSlides:B}=s.params,U=s.params.slidesPerView;U==="auto"?U=s.slidesPerViewDynamic():(U=Math.ceil(parseFloat(s.params.slidesPerView,10)),B&&U%2===0&&(U=U+1));let J=P-A<U;if(B&&(J=J||A<Math.ceil(U/2)),n&&B&&s.params.slidesPerView!=="auto"&&!r&&(J=!1),J){let le=B?A<s.activeIndex?"prev":"next":A-s.activeIndex-1<s.params.slidesPerView?"next":"prev";s.loopFix({direction:le,slideTo:!0,activeSlideIndex:le==="next"?A+1:A-P+1,slideRealIndex:le==="next"?s.realIndex:void 0})}if(r){let le=y*s.params.grid.rows;y=s.slides.find(re=>re.getAttribute("data-swiper-slide-index")*1===le).column}else y=s.getSlideIndexByData(y)}return requestAnimationFrame(()=>{s.slideTo(y,t,e,n)}),s}function Nle(i,t,e){t===void 0&&(t=!0);let n=this,{enabled:s,params:r,animating:y}=n;if(!s||n.destroyed)return n;typeof i>"u"&&(i=n.params.speed);let A=r.slidesPerGroup;r.slidesPerView==="auto"&&r.slidesPerGroup===1&&r.slidesPerGroupAuto&&(A=Math.max(n.slidesPerViewDynamic("current",!0),1));let P=n.activeIndex<r.slidesPerGroupSkip?1:A,B=n.virtual&&r.virtual.enabled;if(r.loop){if(y&&!B&&r.loopPreventsSliding)return!1;if(n.loopFix({direction:"next"}),n._clientLeft=n.wrapperEl.clientLeft,n.activeIndex===n.slides.length-1&&r.cssMode)return requestAnimationFrame(()=>{n.slideTo(n.activeIndex+P,i,t,e)}),!0}return r.rewind&&n.isEnd?n.slideTo(0,i,t,e):n.slideTo(n.activeIndex+P,i,t,e)}function zle(i,t,e){t===void 0&&(t=!0);let n=this,{params:s,snapGrid:r,slidesGrid:y,rtlTranslate:A,enabled:P,animating:B}=n;if(!P||n.destroyed)return n;typeof i>"u"&&(i=n.params.speed);let U=n.virtual&&s.virtual.enabled;if(s.loop){if(B&&!U&&s.loopPreventsSliding)return!1;n.loopFix({direction:"prev"}),n._clientLeft=n.wrapperEl.clientLeft}let J=A?n.translate:-n.translate;function le(Ce){return Ce<0?-Math.floor(Math.abs(Ce)):Math.floor(Ce)}let re=le(J),X=r.map(Ce=>le(Ce)),ee=s.freeMode&&s.freeMode.enabled,we=r[X.indexOf(re)-1];if(typeof we>"u"&&(s.cssMode||ee)){let Ce;r.forEach((Te,Xe)=>{re>=Te&&(Ce=Xe)}),typeof Ce<"u"&&(we=ee?r[Ce]:r[Ce>0?Ce-1:Ce])}let Re=0;if(typeof we<"u"&&(Re=y.indexOf(we),Re<0&&(Re=n.activeIndex-1),s.slidesPerView==="auto"&&s.slidesPerGroup===1&&s.slidesPerGroupAuto&&(Re=Re-n.slidesPerViewDynamic("previous",!0)+1,Re=Math.max(Re,0))),s.rewind&&n.isBeginning){let Ce=n.params.virtual&&n.params.virtual.enabled&&n.virtual?n.virtual.slides.length-1:n.slides.length-1;return n.slideTo(Ce,i,t,e)}else if(s.loop&&n.activeIndex===0&&s.cssMode)return requestAnimationFrame(()=>{n.slideTo(Re,i,t,e)}),!0;return n.slideTo(Re,i,t,e)}function Ble(i,t,e){t===void 0&&(t=!0);let n=this;if(!n.destroyed)return typeof i>"u"&&(i=n.params.speed),n.slideTo(n.activeIndex,i,t,e)}function Vle(i,t,e,n){t===void 0&&(t=!0),n===void 0&&(n=.5);let s=this;if(s.destroyed)return;typeof i>"u"&&(i=s.params.speed);let r=s.activeIndex,y=Math.min(s.params.slidesPerGroupSkip,r),A=y+Math.floor((r-y)/s.params.slidesPerGroup),P=s.rtlTranslate?s.translate:-s.translate;if(P>=s.snapGrid[A]){let B=s.snapGrid[A],U=s.snapGrid[A+1];P-B>(U-B)*n&&(r+=s.params.slidesPerGroup)}else{let B=s.snapGrid[A-1],U=s.snapGrid[A];P-B<=(U-B)*n&&(r-=s.params.slidesPerGroup)}return r=Math.max(r,0),r=Math.min(r,s.slidesGrid.length-1),s.slideTo(r,i,t,e)}function jle(){let i=this;if(i.destroyed)return;let{params:t,slidesEl:e}=i,n=t.slidesPerView==="auto"?i.slidesPerViewDynamic():t.slidesPerView,s=i.clickedIndex,r,y=i.isElement?"swiper-slide":`.${t.slideClass}`;if(t.loop){if(i.animating)return;r=parseInt(i.clickedSlide.getAttribute("data-swiper-slide-index"),10),t.centeredSlides?s<i.loopedSlides-n/2||s>i.slides.length-i.loopedSlides+n/2?(i.loopFix(),s=i.getSlideIndex(wo(e,`${y}[data-swiper-slide-index="${r}"]`)[0]),id(()=>{i.slideTo(s)})):i.slideTo(s):s>i.slides.length-n?(i.loopFix(),s=i.getSlideIndex(wo(e,`${y}[data-swiper-slide-index="${r}"]`)[0]),id(()=>{i.slideTo(s)})):i.slideTo(s)}else i.slideTo(s)}var Ule={slideTo:Fle,slideToLoop:Lle,slideNext:Nle,slidePrev:zle,slideReset:Ble,slideToClosest:Vle,slideToClickedSlide:jle};function Hle(i,t){let e=this,{params:n,slidesEl:s}=e;if(!n.loop||e.virtual&&e.params.virtual.enabled)return;let r=()=>{wo(s,`.${n.slideClass}, swiper-slide`).forEach((le,re)=>{le.setAttribute("data-swiper-slide-index",re)})},y=e.grid&&n.grid&&n.grid.rows>1,A=n.slidesPerGroup*(y?n.grid.rows:1),P=e.slides.length%A!==0,B=y&&e.slides.length%n.grid.rows!==0,U=J=>{for(let le=0;le<J;le+=1){let re=e.isElement?ha("swiper-slide",[n.slideBlankClass]):ha("div",[n.slideClass,n.slideBlankClass]);e.slidesEl.append(re)}};if(P){if(n.loopAddBlankSlides){let J=A-e.slides.length%A;U(J),e.recalcSlides(),e.updateSlides()}else Wx("Swiper Loop Warning: The number of slides is not even to slidesPerGroup, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");r()}else if(B){if(n.loopAddBlankSlides){let J=n.grid.rows-e.slides.length%n.grid.rows;U(J),e.recalcSlides(),e.updateSlides()}else Wx("Swiper Loop Warning: The number of slides is not even to grid.rows, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");r()}else r();e.loopFix({slideRealIndex:i,direction:n.centeredSlides?void 0:"next",initial:t})}function $le(i){let{slideRealIndex:t,slideTo:e=!0,direction:n,setTranslate:s,activeSlideIndex:r,initial:y,byController:A,byMousewheel:P}=i===void 0?{}:i,B=this;if(!B.params.loop)return;B.emit("beforeLoopFix");let{slides:U,allowSlidePrev:J,allowSlideNext:le,slidesEl:re,params:X}=B,{centeredSlides:ee,initialSlide:we}=X;if(B.allowSlidePrev=!0,B.allowSlideNext=!0,B.virtual&&X.virtual.enabled){e&&(!X.centeredSlides&&B.snapIndex===0?B.slideTo(B.virtual.slides.length,0,!1,!0):X.centeredSlides&&B.snapIndex<X.slidesPerView?B.slideTo(B.virtual.slides.length+B.snapIndex,0,!1,!0):B.snapIndex===B.snapGrid.length-1&&B.slideTo(B.virtual.slidesBefore,0,!1,!0)),B.allowSlidePrev=J,B.allowSlideNext=le,B.emit("loopFix");return}let Re=X.slidesPerView;Re==="auto"?Re=B.slidesPerViewDynamic():(Re=Math.ceil(parseFloat(X.slidesPerView,10)),ee&&Re%2===0&&(Re=Re+1));let Ce=X.slidesPerGroupAuto?Re:X.slidesPerGroup,Te=Ce;Te%Ce!==0&&(Te+=Ce-Te%Ce),Te+=X.loopAdditionalSlides,B.loopedSlides=Te;let Xe=B.grid&&X.grid&&X.grid.rows>1;U.length<Re+Te||B.params.effect==="cards"&&U.length<Re+Te*2?Wx("Swiper Loop Warning: The number of slides is not enough for loop mode, it will be disabled or not function properly. You need to add more slides (or make duplicates) or lower the values of slidesPerView and slidesPerGroup parameters"):Xe&&X.grid.fill==="row"&&Wx("Swiper Loop Warning: Loop mode is not compatible with grid.fill = `row`");let et=[],Pt=[],Lt=Xe?Math.ceil(U.length/X.grid.rows):U.length,lt=y&&Lt-we<Re&&!ee,Ye=lt?we:B.activeIndex;typeof r>"u"?r=B.getSlideIndex(U.find(oi=>oi.classList.contains(X.slideActiveClass))):Ye=r;let xt=n==="next"||!n,Bt=n==="prev"||!n,Ft=0,dt=0,Kt=(Xe?U[r].column:r)+(ee&&typeof s>"u"?-Re/2+.5:0);if(Kt<Te){Ft=Math.max(Te-Kt,Ce);for(let oi=0;oi<Te-Kt;oi+=1){let tt=oi-Math.floor(oi/Lt)*Lt;if(Xe){let vt=Lt-tt-1;for(let pi=U.length-1;pi>=0;pi-=1)U[pi].column===vt&&et.push(pi)}else et.push(Lt-tt-1)}}else if(Kt+Re>Lt-Te){dt=Math.max(Kt-(Lt-Te*2),Ce),lt&&(dt=Math.max(dt,Re-Lt+we+1));for(let oi=0;oi<dt;oi+=1){let tt=oi-Math.floor(oi/Lt)*Lt;Xe?U.forEach((vt,pi)=>{vt.column===tt&&Pt.push(pi)}):Pt.push(tt)}}if(B.__preventObserver__=!0,requestAnimationFrame(()=>{B.__preventObserver__=!1}),B.params.effect==="cards"&&U.length<Re+Te*2&&(Pt.includes(r)&&Pt.splice(Pt.indexOf(r),1),et.includes(r)&&et.splice(et.indexOf(r),1)),Bt&&et.forEach(oi=>{U[oi].swiperLoopMoveDOM=!0,re.prepend(U[oi]),U[oi].swiperLoopMoveDOM=!1}),xt&&Pt.forEach(oi=>{U[oi].swiperLoopMoveDOM=!0,re.append(U[oi]),U[oi].swiperLoopMoveDOM=!1}),B.recalcSlides(),X.slidesPerView==="auto"?B.updateSlides():Xe&&(et.length>0&&Bt||Pt.length>0&&xt)&&B.slides.forEach((oi,tt)=>{B.grid.updateSlide(tt,oi,B.slides)}),X.watchSlidesProgress&&B.updateSlidesOffset(),e){if(et.length>0&&Bt){if(typeof t>"u"){let oi=B.slidesGrid[Ye],vt=B.slidesGrid[Ye+Ft]-oi;P?B.setTranslate(B.translate-vt):(B.slideTo(Ye+Math.ceil(Ft),0,!1,!0),s&&(B.touchEventsData.startTranslate=B.touchEventsData.startTranslate-vt,B.touchEventsData.currentTranslate=B.touchEventsData.currentTranslate-vt))}else if(s){let oi=Xe?et.length/X.grid.rows:et.length;B.slideTo(B.activeIndex+oi,0,!1,!0),B.touchEventsData.currentTranslate=B.translate}}else if(Pt.length>0&&xt)if(typeof t>"u"){let oi=B.slidesGrid[Ye],vt=B.slidesGrid[Ye-dt]-oi;P?B.setTranslate(B.translate-vt):(B.slideTo(Ye-dt,0,!1,!0),s&&(B.touchEventsData.startTranslate=B.touchEventsData.startTranslate-vt,B.touchEventsData.currentTranslate=B.touchEventsData.currentTranslate-vt))}else{let oi=Xe?Pt.length/X.grid.rows:Pt.length;B.slideTo(B.activeIndex-oi,0,!1,!0)}}if(B.allowSlidePrev=J,B.allowSlideNext=le,B.controller&&B.controller.control&&!A){let oi={slideRealIndex:t,direction:n,setTranslate:s,activeSlideIndex:r,byController:!0};Array.isArray(B.controller.control)?B.controller.control.forEach(tt=>{!tt.destroyed&&tt.params.loop&&tt.loopFix(Xi(Ct({},oi),{slideTo:tt.params.slidesPerView===X.slidesPerView?e:!1}))}):B.controller.control instanceof B.constructor&&B.controller.control.params.loop&&B.controller.control.loopFix(Xi(Ct({},oi),{slideTo:B.controller.control.params.slidesPerView===X.slidesPerView?e:!1}))}B.emit("loopFix")}function Gle(){let i=this,{params:t,slidesEl:e}=i;if(!t.loop||!e||i.virtual&&i.params.virtual.enabled)return;i.recalcSlides();let n=[];i.slides.forEach(s=>{let r=typeof s.swiperSlideIndex>"u"?s.getAttribute("data-swiper-slide-index")*1:s.swiperSlideIndex;n[r]=s}),i.slides.forEach(s=>{s.removeAttribute("data-swiper-slide-index")}),n.forEach(s=>{e.append(s)}),i.recalcSlides(),i.slideTo(i.realIndex,0)}var qle={loopCreate:Hle,loopFix:$le,loopDestroy:Gle};function Wle(i){let t=this;if(!t.params.simulateTouch||t.params.watchOverflow&&t.isLocked||t.params.cssMode)return;let e=t.params.touchEventsTarget==="container"?t.el:t.wrapperEl;t.isElement&&(t.__preventObserver__=!0),e.style.cursor="move",e.style.cursor=i?"grabbing":"grab",t.isElement&&requestAnimationFrame(()=>{t.__preventObserver__=!1})}function Yle(){let i=this;i.params.watchOverflow&&i.isLocked||i.params.cssMode||(i.isElement&&(i.__preventObserver__=!0),i[i.params.touchEventsTarget==="container"?"el":"wrapperEl"].style.cursor="",i.isElement&&requestAnimationFrame(()=>{i.__preventObserver__=!1}))}var Zle={setGrabCursor:Wle,unsetGrabCursor:Yle};function Xle(i,t){t===void 0&&(t=this);function e(n){if(!n||n===Zr()||n===Ir())return null;n.assignedSlot&&(n=n.assignedSlot);let s=n.closest(i);return!s&&!n.getRootNode?null:s||e(n.getRootNode().host)}return e(t)}function LH(i,t,e){let n=Ir(),{params:s}=i,r=s.edgeSwipeDetection,y=s.edgeSwipeThreshold;return r&&(e<=y||e>=n.innerWidth-y)?r==="prevent"?(t.preventDefault(),!0):!1:!0}function Kle(i){let t=this,e=Zr(),n=i;n.originalEvent&&(n=n.originalEvent);let s=t.touchEventsData;if(n.type==="pointerdown"){if(s.pointerId!==null&&s.pointerId!==n.pointerId)return;s.pointerId=n.pointerId}else n.type==="touchstart"&&n.targetTouches.length===1&&(s.touchId=n.targetTouches[0].identifier);if(n.type==="touchstart"){LH(t,n,n.targetTouches[0].pageX);return}let{params:r,touches:y,enabled:A}=t;if(!A||!r.simulateTouch&&n.pointerType==="mouse"||t.animating&&r.preventInteractionOnTransition)return;!t.animating&&r.cssMode&&r.loop&&t.loopFix();let P=n.target;if(r.touchEventsTarget==="wrapper"&&!kH(P,t.wrapperEl)||"which"in n&&n.which===3||"button"in n&&n.button>0||s.isTouched&&s.isMoved)return;let B=!!r.noSwipingClass&&r.noSwipingClass!=="",U=n.composedPath?n.composedPath():n.path;B&&n.target&&n.target.shadowRoot&&U&&(P=U[0]);let J=r.noSwipingSelector?r.noSwipingSelector:`.${r.noSwipingClass}`,le=!!(n.target&&n.target.shadowRoot);if(r.noSwiping&&(le?Xle(J,P):P.closest(J))){t.allowClick=!0;return}if(r.swipeHandler&&!P.closest(r.swipeHandler))return;y.currentX=n.pageX,y.currentY=n.pageY;let re=y.currentX,X=y.currentY;if(!LH(t,n,re))return;Object.assign(s,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),y.startX=re,y.startY=X,s.touchStartTime=Ps(),t.allowClick=!0,t.updateSize(),t.swipeDirection=void 0,r.threshold>0&&(s.allowThresholdMove=!1);let ee=!0;P.matches(s.focusableElements)&&(ee=!1,P.nodeName==="SELECT"&&(s.isTouched=!1)),e.activeElement&&e.activeElement.matches(s.focusableElements)&&e.activeElement!==P&&(n.pointerType==="mouse"||n.pointerType!=="mouse"&&!P.matches(s.focusableElements))&&e.activeElement.blur();let we=ee&&t.allowTouchMove&&r.touchStartPreventDefault;(r.touchStartForcePreventDefault||we)&&!P.isContentEditable&&n.preventDefault(),r.freeMode&&r.freeMode.enabled&&t.freeMode&&t.animating&&!r.cssMode&&t.freeMode.onTouchStart(),t.emit("touchStart",n)}function Qle(i){let t=Zr(),e=this,n=e.touchEventsData,{params:s,touches:r,rtlTranslate:y,enabled:A}=e;if(!A||!s.simulateTouch&&i.pointerType==="mouse")return;let P=i;if(P.originalEvent&&(P=P.originalEvent),P.type==="pointermove"&&(n.touchId!==null||P.pointerId!==n.pointerId))return;let B;if(P.type==="touchmove"){if(B=[...P.changedTouches].find(Pt=>Pt.identifier===n.touchId),!B||B.identifier!==n.touchId)return}else B=P;if(!n.isTouched){n.startMoving&&n.isScrolling&&e.emit("touchMoveOpposite",P);return}let U=B.pageX,J=B.pageY;if(P.preventedByNestedSwiper){r.startX=U,r.startY=J;return}if(!e.allowTouchMove){P.target.matches(n.focusableElements)||(e.allowClick=!1),n.isTouched&&(Object.assign(r,{startX:U,startY:J,currentX:U,currentY:J}),n.touchStartTime=Ps());return}if(s.touchReleaseOnEdges&&!s.loop)if(e.isVertical()){if(J<r.startY&&e.translate<=e.maxTranslate()||J>r.startY&&e.translate>=e.minTranslate()){n.isTouched=!1,n.isMoved=!1;return}}else{if(y&&(U>r.startX&&-e.translate<=e.maxTranslate()||U<r.startX&&-e.translate>=e.minTranslate()))return;if(!y&&(U<r.startX&&e.translate<=e.maxTranslate()||U>r.startX&&e.translate>=e.minTranslate()))return}if(t.activeElement&&t.activeElement.matches(n.focusableElements)&&t.activeElement!==P.target&&P.pointerType!=="mouse"&&t.activeElement.blur(),t.activeElement&&P.target===t.activeElement&&P.target.matches(n.focusableElements)){n.isMoved=!0,e.allowClick=!1;return}n.allowTouchCallbacks&&e.emit("touchMove",P),r.previousX=r.currentX,r.previousY=r.currentY,r.currentX=U,r.currentY=J;let le=r.currentX-r.startX,re=r.currentY-r.startY;if(e.params.threshold&&Math.sqrt(le**2+re**2)<e.params.threshold)return;if(typeof n.isScrolling>"u"){let Pt;e.isHorizontal()&&r.currentY===r.startY||e.isVertical()&&r.currentX===r.startX?n.isScrolling=!1:le*le+re*re>=25&&(Pt=Math.atan2(Math.abs(re),Math.abs(le))*180/Math.PI,n.isScrolling=e.isHorizontal()?Pt>s.touchAngle:90-Pt>s.touchAngle)}if(n.isScrolling&&e.emit("touchMoveOpposite",P),typeof n.startMoving>"u"&&(r.currentX!==r.startX||r.currentY!==r.startY)&&(n.startMoving=!0),n.isScrolling||P.type==="touchmove"&&n.preventTouchMoveFromPointerMove){n.isTouched=!1;return}if(!n.startMoving)return;e.allowClick=!1,!s.cssMode&&P.cancelable&&P.preventDefault(),s.touchMoveStopPropagation&&!s.nested&&P.stopPropagation();let X=e.isHorizontal()?le:re,ee=e.isHorizontal()?r.currentX-r.previousX:r.currentY-r.previousY;s.oneWayMovement&&(X=Math.abs(X)*(y?1:-1),ee=Math.abs(ee)*(y?1:-1)),r.diff=X,X*=s.touchRatio,y&&(X=-X,ee=-ee);let we=e.touchesDirection;e.swipeDirection=X>0?"prev":"next",e.touchesDirection=ee>0?"prev":"next";let Re=e.params.loop&&!s.cssMode,Ce=e.touchesDirection==="next"&&e.allowSlideNext||e.touchesDirection==="prev"&&e.allowSlidePrev;if(!n.isMoved){if(Re&&Ce&&e.loopFix({direction:e.swipeDirection}),n.startTranslate=e.getTranslate(),e.setTransition(0),e.animating){let Pt=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0,detail:{bySwiperTouchMove:!0}});e.wrapperEl.dispatchEvent(Pt)}n.allowMomentumBounce=!1,s.grabCursor&&(e.allowSlideNext===!0||e.allowSlidePrev===!0)&&e.setGrabCursor(!0),e.emit("sliderFirstMove",P)}let Te;if(new Date().getTime(),s._loopSwapReset!==!1&&n.isMoved&&n.allowThresholdMove&&we!==e.touchesDirection&&Re&&Ce&&Math.abs(X)>=1){Object.assign(r,{startX:U,startY:J,currentX:U,currentY:J,startTranslate:n.currentTranslate}),n.loopSwapReset=!0,n.startTranslate=n.currentTranslate;return}e.emit("sliderMove",P),n.isMoved=!0,n.currentTranslate=X+n.startTranslate;let Xe=!0,et=s.resistanceRatio;if(s.touchReleaseOnEdges&&(et=0),X>0?(Re&&Ce&&!Te&&n.allowThresholdMove&&n.currentTranslate>(s.centeredSlides?e.minTranslate()-e.slidesSizesGrid[e.activeIndex+1]-(s.slidesPerView!=="auto"&&e.slides.length-s.slidesPerView>=2?e.slidesSizesGrid[e.activeIndex+1]+e.params.spaceBetween:0)-e.params.spaceBetween:e.minTranslate())&&e.loopFix({direction:"prev",setTranslate:!0,activeSlideIndex:0}),n.currentTranslate>e.minTranslate()&&(Xe=!1,s.resistance&&(n.currentTranslate=e.minTranslate()-1+(-e.minTranslate()+n.startTranslate+X)**et))):X<0&&(Re&&Ce&&!Te&&n.allowThresholdMove&&n.currentTranslate<(s.centeredSlides?e.maxTranslate()+e.slidesSizesGrid[e.slidesSizesGrid.length-1]+e.params.spaceBetween+(s.slidesPerView!=="auto"&&e.slides.length-s.slidesPerView>=2?e.slidesSizesGrid[e.slidesSizesGrid.length-1]+e.params.spaceBetween:0):e.maxTranslate())&&e.loopFix({direction:"next",setTranslate:!0,activeSlideIndex:e.slides.length-(s.slidesPerView==="auto"?e.slidesPerViewDynamic():Math.ceil(parseFloat(s.slidesPerView,10)))}),n.currentTranslate<e.maxTranslate()&&(Xe=!1,s.resistance&&(n.currentTranslate=e.maxTranslate()+1-(e.maxTranslate()-n.startTranslate-X)**et))),Xe&&(P.preventedByNestedSwiper=!0),!e.allowSlideNext&&e.swipeDirection==="next"&&n.currentTranslate<n.startTranslate&&(n.currentTranslate=n.startTranslate),!e.allowSlidePrev&&e.swipeDirection==="prev"&&n.currentTranslate>n.startTranslate&&(n.currentTranslate=n.startTranslate),!e.allowSlidePrev&&!e.allowSlideNext&&(n.currentTranslate=n.startTranslate),s.threshold>0)if(Math.abs(X)>s.threshold||n.allowThresholdMove){if(!n.allowThresholdMove){n.allowThresholdMove=!0,r.startX=r.currentX,r.startY=r.currentY,n.currentTranslate=n.startTranslate,r.diff=e.isHorizontal()?r.currentX-r.startX:r.currentY-r.startY;return}}else{n.currentTranslate=n.startTranslate;return}!s.followFinger||s.cssMode||((s.freeMode&&s.freeMode.enabled&&e.freeMode||s.watchSlidesProgress)&&(e.updateActiveIndex(),e.updateSlidesClasses()),s.freeMode&&s.freeMode.enabled&&e.freeMode&&e.freeMode.onTouchMove(),e.updateProgress(n.currentTranslate),e.setTranslate(n.currentTranslate))}function Jle(i){let t=this,e=t.touchEventsData,n=i;n.originalEvent&&(n=n.originalEvent);let s;if(n.type==="touchend"||n.type==="touchcancel"){if(s=[...n.changedTouches].find(et=>et.identifier===e.touchId),!s||s.identifier!==e.touchId)return}else{if(e.touchId!==null||n.pointerId!==e.pointerId)return;s=n}if(["pointercancel","pointerout","pointerleave","contextmenu"].includes(n.type)&&!(["pointercancel","contextmenu"].includes(n.type)&&(t.browser.isSafari||t.browser.isWebView)))return;e.pointerId=null,e.touchId=null;let{params:y,touches:A,rtlTranslate:P,slidesGrid:B,enabled:U}=t;if(!U||!y.simulateTouch&&n.pointerType==="mouse")return;if(e.allowTouchCallbacks&&t.emit("touchEnd",n),e.allowTouchCallbacks=!1,!e.isTouched){e.isMoved&&y.grabCursor&&t.setGrabCursor(!1),e.isMoved=!1,e.startMoving=!1;return}y.grabCursor&&e.isMoved&&e.isTouched&&(t.allowSlideNext===!0||t.allowSlidePrev===!0)&&t.setGrabCursor(!1);let J=Ps(),le=J-e.touchStartTime;if(t.allowClick){let et=n.path||n.composedPath&&n.composedPath();t.updateClickedSlide(et&&et[0]||n.target,et),t.emit("tap click",n),le<300&&J-e.lastClickTime<300&&t.emit("doubleTap doubleClick",n)}if(e.lastClickTime=Ps(),id(()=>{t.destroyed||(t.allowClick=!0)}),!e.isTouched||!e.isMoved||!t.swipeDirection||A.diff===0&&!e.loopSwapReset||e.currentTranslate===e.startTranslate&&!e.loopSwapReset){e.isTouched=!1,e.isMoved=!1,e.startMoving=!1;return}e.isTouched=!1,e.isMoved=!1,e.startMoving=!1;let re;if(y.followFinger?re=P?t.translate:-t.translate:re=-e.currentTranslate,y.cssMode)return;if(y.freeMode&&y.freeMode.enabled){t.freeMode.onTouchEnd({currentPos:re});return}let X=re>=-t.maxTranslate()&&!t.params.loop,ee=0,we=t.slidesSizesGrid[0];for(let et=0;et<B.length;et+=et<y.slidesPerGroupSkip?1:y.slidesPerGroup){let Pt=et<y.slidesPerGroupSkip-1?1:y.slidesPerGroup;typeof B[et+Pt]<"u"?(X||re>=B[et]&&re<B[et+Pt])&&(ee=et,we=B[et+Pt]-B[et]):(X||re>=B[et])&&(ee=et,we=B[B.length-1]-B[B.length-2])}let Re=null,Ce=null;y.rewind&&(t.isBeginning?Ce=y.virtual&&y.virtual.enabled&&t.virtual?t.virtual.slides.length-1:t.slides.length-1:t.isEnd&&(Re=0));let Te=(re-B[ee])/we,Xe=ee<y.slidesPerGroupSkip-1?1:y.slidesPerGroup;if(le>y.longSwipesMs){if(!y.longSwipes){t.slideTo(t.activeIndex);return}t.swipeDirection==="next"&&(Te>=y.longSwipesRatio?t.slideTo(y.rewind&&t.isEnd?Re:ee+Xe):t.slideTo(ee)),t.swipeDirection==="prev"&&(Te>1-y.longSwipesRatio?t.slideTo(ee+Xe):Ce!==null&&Te<0&&Math.abs(Te)>y.longSwipesRatio?t.slideTo(Ce):t.slideTo(ee))}else{if(!y.shortSwipes){t.slideTo(t.activeIndex);return}t.navigation&&(n.target===t.navigation.nextEl||n.target===t.navigation.prevEl)?n.target===t.navigation.nextEl?t.slideTo(ee+Xe):t.slideTo(ee):(t.swipeDirection==="next"&&t.slideTo(Re!==null?Re:ee+Xe),t.swipeDirection==="prev"&&t.slideTo(Ce!==null?Ce:ee))}}function NH(){let i=this,{params:t,el:e}=i;if(e&&e.offsetWidth===0)return;t.breakpoints&&i.setBreakpoint();let{allowSlideNext:n,allowSlidePrev:s,snapGrid:r}=i,y=i.virtual&&i.params.virtual.enabled;i.allowSlideNext=!0,i.allowSlidePrev=!0,i.updateSize(),i.updateSlides(),i.updateSlidesClasses();let A=y&&t.loop;(t.slidesPerView==="auto"||t.slidesPerView>1)&&i.isEnd&&!i.isBeginning&&!i.params.centeredSlides&&!A?i.slideTo(i.slides.length-1,0,!1,!0):i.params.loop&&!y?i.slideToLoop(i.realIndex,0,!1,!0):i.slideTo(i.activeIndex,0,!1,!0),i.autoplay&&i.autoplay.running&&i.autoplay.paused&&(clearTimeout(i.autoplay.resizeTimeout),i.autoplay.resizeTimeout=setTimeout(()=>{i.autoplay&&i.autoplay.running&&i.autoplay.paused&&i.autoplay.resume()},500)),i.allowSlidePrev=s,i.allowSlideNext=n,i.params.watchOverflow&&r!==i.snapGrid&&i.checkOverflow()}function ece(i){let t=this;t.enabled&&(t.allowClick||(t.params.preventClicks&&i.preventDefault(),t.params.preventClicksPropagation&&t.animating&&(i.stopPropagation(),i.stopImmediatePropagation())))}function tce(){let i=this,{wrapperEl:t,rtlTranslate:e,enabled:n}=i;if(!n)return;i.previousTranslate=i.translate,i.isHorizontal()?i.translate=-t.scrollLeft:i.translate=-t.scrollTop,i.translate===0&&(i.translate=0),i.updateActiveIndex(),i.updateSlidesClasses();let s,r=i.maxTranslate()-i.minTranslate();r===0?s=0:s=(i.translate-i.minTranslate())/r,s!==i.progress&&i.updateProgress(e?-i.translate:i.translate),i.emit("setTranslate",i.translate,!1)}function ice(i){let t=this;fM(t,i.target),!(t.params.cssMode||t.params.slidesPerView!=="auto"&&!t.params.autoHeight)&&t.update()}function nce(){let i=this;i.documentTouchHandlerProceeded||(i.documentTouchHandlerProceeded=!0,i.params.touchReleaseOnEdges&&(i.el.style.touchAction="auto"))}var HH=(i,t)=>{let e=Zr(),{params:n,el:s,wrapperEl:r,device:y}=i,A=!!n.nested,P=t==="on"?"addEventListener":"removeEventListener",B=t;!s||typeof s=="string"||(e[P]("touchstart",i.onDocumentTouchStart,{passive:!1,capture:A}),s[P]("touchstart",i.onTouchStart,{passive:!1}),s[P]("pointerdown",i.onTouchStart,{passive:!1}),e[P]("touchmove",i.onTouchMove,{passive:!1,capture:A}),e[P]("pointermove",i.onTouchMove,{passive:!1,capture:A}),e[P]("touchend",i.onTouchEnd,{passive:!0}),e[P]("pointerup",i.onTouchEnd,{passive:!0}),e[P]("pointercancel",i.onTouchEnd,{passive:!0}),e[P]("touchcancel",i.onTouchEnd,{passive:!0}),e[P]("pointerout",i.onTouchEnd,{passive:!0}),e[P]("pointerleave",i.onTouchEnd,{passive:!0}),e[P]("contextmenu",i.onTouchEnd,{passive:!0}),(n.preventClicks||n.preventClicksPropagation)&&s[P]("click",i.onClick,!0),n.cssMode&&r[P]("scroll",i.onScroll),n.updateOnWindowResize?i[B](y.ios||y.android?"resize orientationchange observerUpdate":"resize observerUpdate",NH,!0):i[B]("observerUpdate",NH,!0),s[P]("load",i.onLoad,{capture:!0}))};function rce(){let i=this,{params:t}=i;i.onTouchStart=Kle.bind(i),i.onTouchMove=Qle.bind(i),i.onTouchEnd=Jle.bind(i),i.onDocumentTouchStart=nce.bind(i),t.cssMode&&(i.onScroll=tce.bind(i)),i.onClick=ece.bind(i),i.onLoad=ice.bind(i),HH(i,"on")}function oce(){HH(this,"off")}var ace={attachEvents:rce,detachEvents:oce},zH=(i,t)=>i.grid&&t.grid&&t.grid.rows>1;function sce(){let i=this,{realIndex:t,initialized:e,params:n,el:s}=i,r=n.breakpoints;if(!r||r&&Object.keys(r).length===0)return;let y=Zr(),A=n.breakpointsBase==="window"||!n.breakpointsBase?n.breakpointsBase:"container",P=["window","container"].includes(n.breakpointsBase)||!n.breakpointsBase?i.el:y.querySelector(n.breakpointsBase),B=i.getBreakpoint(r,A,P);if(!B||i.currentBreakpoint===B)return;let J=(B in r?r[B]:void 0)||i.originalParams,le=zH(i,n),re=zH(i,J),X=i.params.grabCursor,ee=J.grabCursor,we=n.enabled;le&&!re?(s.classList.remove(`${n.containerModifierClass}grid`,`${n.containerModifierClass}grid-column`),i.emitContainerClasses()):!le&&re&&(s.classList.add(`${n.containerModifierClass}grid`),(J.grid.fill&&J.grid.fill==="column"||!J.grid.fill&&n.grid.fill==="column")&&s.classList.add(`${n.containerModifierClass}grid-column`),i.emitContainerClasses()),X&&!ee?i.unsetGrabCursor():!X&&ee&&i.setGrabCursor(),["navigation","pagination","scrollbar"].forEach(Pt=>{if(typeof J[Pt]>"u")return;let Lt=n[Pt]&&n[Pt].enabled,lt=J[Pt]&&J[Pt].enabled;Lt&&!lt&&i[Pt].disable(),!Lt&&lt&&i[Pt].enable()});let Re=J.direction&&J.direction!==n.direction,Ce=n.loop&&(J.slidesPerView!==n.slidesPerView||Re),Te=n.loop;Re&&e&&i.changeDirection(),al(i.params,J);let Xe=i.params.enabled,et=i.params.loop;Object.assign(i,{allowTouchMove:i.params.allowTouchMove,allowSlideNext:i.params.allowSlideNext,allowSlidePrev:i.params.allowSlidePrev}),we&&!Xe?i.disable():!we&&Xe&&i.enable(),i.currentBreakpoint=B,i.emit("_beforeBreakpoint",J),e&&(Ce?(i.loopDestroy(),i.loopCreate(t),i.updateSlides()):!Te&&et?(i.loopCreate(t),i.updateSlides()):Te&&!et&&i.loopDestroy()),i.emit("breakpoint",J)}function lce(i,t,e){if(t===void 0&&(t="window"),!i||t==="container"&&!e)return;let n=!1,s=Ir(),r=t==="window"?s.innerHeight:e.clientHeight,y=Object.keys(i).map(A=>{if(typeof A=="string"&&A.indexOf("@")===0){let P=parseFloat(A.substr(1));return{value:r*P,point:A}}return{value:A,point:A}});y.sort((A,P)=>parseInt(A.value,10)-parseInt(P.value,10));for(let A=0;A<y.length;A+=1){let{point:P,value:B}=y[A];t==="window"?s.matchMedia(`(min-width: ${B}px)`).matches&&(n=P):B<=e.clientWidth&&(n=P)}return n||"max"}var cce={setBreakpoint:sce,getBreakpoint:lce};function dce(i,t){let e=[];return i.forEach(n=>{typeof n=="object"?Object.keys(n).forEach(s=>{n[s]&&e.push(t+s)}):typeof n=="string"&&e.push(t+n)}),e}function uce(){let i=this,{classNames:t,params:e,rtl:n,el:s,device:r}=i,y=dce(["initialized",e.direction,{"free-mode":i.params.freeMode&&e.freeMode.enabled},{autoheight:e.autoHeight},{rtl:n},{grid:e.grid&&e.grid.rows>1},{"grid-column":e.grid&&e.grid.rows>1&&e.grid.fill==="column"},{android:r.android},{ios:r.ios},{"css-mode":e.cssMode},{centered:e.cssMode&&e.centeredSlides},{"watch-progress":e.watchSlidesProgress}],e.containerModifierClass);t.push(...y),s.classList.add(...t),i.emitContainerClasses()}function hce(){let i=this,{el:t,classNames:e}=i;!t||typeof t=="string"||(t.classList.remove(...e),i.emitContainerClasses())}var pce={addClasses:uce,removeClasses:hce};function fce(){let i=this,{isLocked:t,params:e}=i,{slidesOffsetBefore:n}=e;if(n){let s=i.slides.length-1,r=i.slidesGrid[s]+i.slidesSizesGrid[s]+n*2;i.isLocked=i.size>r}else i.isLocked=i.snapGrid.length===1;e.allowSlideNext===!0&&(i.allowSlideNext=!i.isLocked),e.allowSlidePrev===!0&&(i.allowSlidePrev=!i.isLocked),t&&t!==i.isLocked&&(i.isEnd=!1),t!==i.isLocked&&i.emit(i.isLocked?"lock":"unlock")}var mce={checkOverflow:fce},mM={init:!0,direction:"horizontal",oneWayMovement:!1,swiperElementNodeName:"SWIPER-CONTAINER",touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,eventsPrefix:"swiper",enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:5,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loop:!1,loopAddBlankSlides:!0,loopAdditionalSlides:0,loopPreventsSliding:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-blank",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideFullyVisibleClass:"swiper-slide-fully-visible",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",lazyPreloaderClass:"swiper-lazy-preloader",lazyPreloadPrevNext:0,runCallbacksOnInit:!0,_emitClasses:!1};function gce(i,t){return function(n){n===void 0&&(n={});let s=Object.keys(n)[0],r=n[s];if(typeof r!="object"||r===null){al(t,n);return}if(i[s]===!0&&(i[s]={enabled:!0}),s==="navigation"&&i[s]&&i[s].enabled&&!i[s].prevEl&&!i[s].nextEl&&(i[s].auto=!0),["pagination","scrollbar"].indexOf(s)>=0&&i[s]&&i[s].enabled&&!i[s].el&&(i[s].auto=!0),!(s in i&&"enabled"in r)){al(t,n);return}typeof i[s]=="object"&&!("enabled"in i[s])&&(i[s].enabled=!0),i[s]||(i[s]={enabled:!1}),al(t,n)}}var pO={eventsEmitter:ple,update:Ele,translate:Ale,transition:Ole,slide:Ule,loop:qle,grabCursor:Zle,events:ace,breakpoints:cce,checkOverflow:mce,classes:pce},fO={},Gp=class i{constructor(){let t,e;for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];s.length===1&&s[0].constructor&&Object.prototype.toString.call(s[0]).slice(8,-1)==="Object"?e=s[0]:[t,e]=s,e||(e={}),e=al({},e),t&&!e.el&&(e.el=t);let y=Zr();if(e.el&&typeof e.el=="string"&&y.querySelectorAll(e.el).length>1){let U=[];return y.querySelectorAll(e.el).forEach(J=>{let le=al({},e,{el:J});U.push(new i(le))}),U}let A=this;A.__swiper__=!0,A.support=BH(),A.device=VH({userAgent:e.userAgent}),A.browser=jH(),A.eventsListeners={},A.eventsAnyListeners=[],A.modules=[...A.__modules__],e.modules&&Array.isArray(e.modules)&&A.modules.push(...e.modules);let P={};A.modules.forEach(U=>{U({params:e,swiper:A,extendParams:gce(e,P),on:A.on.bind(A),once:A.once.bind(A),off:A.off.bind(A),emit:A.emit.bind(A)})});let B=al({},mM,P);return A.params=al({},B,fO,e),A.originalParams=al({},A.params),A.passedParams=al({},e),A.params&&A.params.on&&Object.keys(A.params.on).forEach(U=>{A.on(U,A.params.on[U])}),A.params&&A.params.onAny&&A.onAny(A.params.onAny),Object.assign(A,{enabled:A.params.enabled,el:t,classNames:[],slides:[],slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal(){return A.params.direction==="horizontal"},isVertical(){return A.params.direction==="vertical"},activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,cssOverflowAdjustment(){return Math.trunc(this.translate/2**23)*2**23},allowSlideNext:A.params.allowSlideNext,allowSlidePrev:A.params.allowSlidePrev,touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:A.params.focusableElements,lastClickTime:0,clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,startMoving:void 0,pointerId:null,touchId:null},allowClick:!0,allowTouchMove:A.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),A.emit("_swiper"),A.params.init&&A.init(),A}getDirectionLabel(t){return this.isHorizontal()?t:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[t]}getSlideIndex(t){let{slidesEl:e,params:n}=this,s=wo(e,`.${n.slideClass}, swiper-slide`),r=Up(s[0]);return Up(t)-r}getSlideIndexByData(t){return this.getSlideIndex(this.slides.find(e=>e.getAttribute("data-swiper-slide-index")*1===t))}recalcSlides(){let t=this,{slidesEl:e,params:n}=t;t.slides=wo(e,`.${n.slideClass}, swiper-slide`)}enable(){let t=this;t.enabled||(t.enabled=!0,t.params.grabCursor&&t.setGrabCursor(),t.emit("enable"))}disable(){let t=this;t.enabled&&(t.enabled=!1,t.params.grabCursor&&t.unsetGrabCursor(),t.emit("disable"))}setProgress(t,e){let n=this;t=Math.min(Math.max(t,0),1);let s=n.minTranslate(),y=(n.maxTranslate()-s)*t+s;n.translateTo(y,typeof e>"u"?0:e),n.updateActiveIndex(),n.updateSlidesClasses()}emitContainerClasses(){let t=this;if(!t.params._emitClasses||!t.el)return;let e=t.el.className.split(" ").filter(n=>n.indexOf("swiper")===0||n.indexOf(t.params.containerModifierClass)===0);t.emit("_containerClasses",e.join(" "))}getSlideClasses(t){let e=this;return e.destroyed?"":t.className.split(" ").filter(n=>n.indexOf("swiper-slide")===0||n.indexOf(e.params.slideClass)===0).join(" ")}emitSlidesClasses(){let t=this;if(!t.params._emitClasses||!t.el)return;let e=[];t.slides.forEach(n=>{let s=t.getSlideClasses(n);e.push({slideEl:n,classNames:s}),t.emit("_slideClass",n,s)}),t.emit("_slideClasses",e)}slidesPerViewDynamic(t,e){t===void 0&&(t="current"),e===void 0&&(e=!1);let n=this,{params:s,slides:r,slidesGrid:y,slidesSizesGrid:A,size:P,activeIndex:B}=n,U=1;if(typeof s.slidesPerView=="number")return s.slidesPerView;if(s.centeredSlides){let J=r[B]?Math.ceil(r[B].swiperSlideSize):0,le;for(let re=B+1;re<r.length;re+=1)r[re]&&!le&&(J+=Math.ceil(r[re].swiperSlideSize),U+=1,J>P&&(le=!0));for(let re=B-1;re>=0;re-=1)r[re]&&!le&&(J+=r[re].swiperSlideSize,U+=1,J>P&&(le=!0))}else if(t==="current")for(let J=B+1;J<r.length;J+=1)(e?y[J]+A[J]-y[B]<P:y[J]-y[B]<P)&&(U+=1);else for(let J=B-1;J>=0;J-=1)y[B]-y[J]<P&&(U+=1);return U}update(){let t=this;if(!t||t.destroyed)return;let{snapGrid:e,params:n}=t;n.breakpoints&&t.setBreakpoint(),[...t.el.querySelectorAll('[loading="lazy"]')].forEach(y=>{y.complete&&fM(t,y)}),t.updateSize(),t.updateSlides(),t.updateProgress(),t.updateSlidesClasses();function s(){let y=t.rtlTranslate?t.translate*-1:t.translate,A=Math.min(Math.max(y,t.maxTranslate()),t.minTranslate());t.setTranslate(A),t.updateActiveIndex(),t.updateSlidesClasses()}let r;if(n.freeMode&&n.freeMode.enabled&&!n.cssMode)s(),n.autoHeight&&t.updateAutoHeight();else{if((n.slidesPerView==="auto"||n.slidesPerView>1)&&t.isEnd&&!n.centeredSlides){let y=t.virtual&&n.virtual.enabled?t.virtual.slides:t.slides;r=t.slideTo(y.length-1,0,!1,!0)}else r=t.slideTo(t.activeIndex,0,!1,!0);r||s()}n.watchOverflow&&e!==t.snapGrid&&t.checkOverflow(),t.emit("update")}changeDirection(t,e){e===void 0&&(e=!0);let n=this,s=n.params.direction;return t||(t=s==="horizontal"?"vertical":"horizontal"),t===s||t!=="horizontal"&&t!=="vertical"||(n.el.classList.remove(`${n.params.containerModifierClass}${s}`),n.el.classList.add(`${n.params.containerModifierClass}${t}`),n.emitContainerClasses(),n.params.direction=t,n.slides.forEach(r=>{t==="vertical"?r.style.width="":r.style.height=""}),n.emit("changeDirection"),e&&n.update()),n}changeLanguageDirection(t){let e=this;e.rtl&&t==="rtl"||!e.rtl&&t==="ltr"||(e.rtl=t==="rtl",e.rtlTranslate=e.params.direction==="horizontal"&&e.rtl,e.rtl?(e.el.classList.add(`${e.params.containerModifierClass}rtl`),e.el.dir="rtl"):(e.el.classList.remove(`${e.params.containerModifierClass}rtl`),e.el.dir="ltr"),e.update())}mount(t){let e=this;if(e.mounted)return!0;let n=t||e.params.el;if(typeof n=="string"&&(n=document.querySelector(n)),!n)return!1;n.swiper=e,n.parentNode&&n.parentNode.host&&n.parentNode.host.nodeName===e.params.swiperElementNodeName.toUpperCase()&&(e.isElement=!0);let s=()=>`.${(e.params.wrapperClass||"").trim().split(" ").join(".")}`,y=n&&n.shadowRoot&&n.shadowRoot.querySelector?n.shadowRoot.querySelector(s()):wo(n,s())[0];return!y&&e.params.createElements&&(y=ha("div",e.params.wrapperClass),n.append(y),wo(n,`.${e.params.slideClass}`).forEach(A=>{y.append(A)})),Object.assign(e,{el:n,wrapperEl:y,slidesEl:e.isElement&&!n.parentNode.host.slideSlots?n.parentNode.host:y,hostEl:e.isElement?n.parentNode.host:n,mounted:!0,rtl:n.dir.toLowerCase()==="rtl"||Gu(n,"direction")==="rtl",rtlTranslate:e.params.direction==="horizontal"&&(n.dir.toLowerCase()==="rtl"||Gu(n,"direction")==="rtl"),wrongRTL:Gu(y,"display")==="-webkit-box"}),!0}init(t){let e=this;if(e.initialized||e.mount(t)===!1)return e;e.emit("beforeInit"),e.params.breakpoints&&e.setBreakpoint(),e.addClasses(),e.updateSize(),e.updateSlides(),e.params.watchOverflow&&e.checkOverflow(),e.params.grabCursor&&e.enabled&&e.setGrabCursor(),e.params.loop&&e.virtual&&e.params.virtual.enabled?e.slideTo(e.params.initialSlide+e.virtual.slidesBefore,0,e.params.runCallbacksOnInit,!1,!0):e.slideTo(e.params.initialSlide,0,e.params.runCallbacksOnInit,!1,!0),e.params.loop&&e.loopCreate(void 0,!0),e.attachEvents();let s=[...e.el.querySelectorAll('[loading="lazy"]')];return e.isElement&&s.push(...e.hostEl.querySelectorAll('[loading="lazy"]')),s.forEach(r=>{r.complete?fM(e,r):r.addEventListener("load",y=>{fM(e,y.target)})}),mO(e),e.initialized=!0,mO(e),e.emit("init"),e.emit("afterInit"),e}destroy(t,e){t===void 0&&(t=!0),e===void 0&&(e=!0);let n=this,{params:s,el:r,wrapperEl:y,slides:A}=n;return typeof n.params>"u"||n.destroyed||(n.emit("beforeDestroy"),n.initialized=!1,n.detachEvents(),s.loop&&n.loopDestroy(),e&&(n.removeClasses(),r&&typeof r!="string"&&r.removeAttribute("style"),y&&y.removeAttribute("style"),A&&A.length&&A.forEach(P=>{P.classList.remove(s.slideVisibleClass,s.slideFullyVisibleClass,s.slideActiveClass,s.slideNextClass,s.slidePrevClass),P.removeAttribute("style"),P.removeAttribute("data-swiper-slide-index")})),n.emit("destroy"),Object.keys(n.eventsListeners).forEach(P=>{n.off(P)}),t!==!1&&(n.el&&typeof n.el!="string"&&(n.el.swiper=null),RH(n)),n.destroyed=!0),null}static extendDefaults(t){al(fO,t)}static get extendedDefaults(){return fO}static get defaults(){return mM}static installModule(t){i.prototype.__modules__||(i.prototype.__modules__=[]);let e=i.prototype.__modules__;typeof t=="function"&&e.indexOf(t)<0&&e.push(t)}static use(t){return Array.isArray(t)?(t.forEach(e=>i.installModule(e)),i):(i.installModule(t),i)}};Object.keys(pO).forEach(i=>{Object.keys(pO[i]).forEach(t=>{Gp.prototype[t]=pO[i][t]})});Gp.use([ule,hle]);function $H(i){let{swiper:t,extendParams:e,on:n,emit:s}=i;e({virtual:{enabled:!1,slides:[],cache:!0,renderSlide:null,renderExternal:null,renderExternalUpdate:!0,addSlidesBefore:0,addSlidesAfter:0}});let r,y=Zr();t.virtual={cache:{},from:void 0,to:void 0,slides:[],offset:0,slidesGrid:[]};let A=y.createElement("div");function P(X,ee){let we=t.params.virtual;if(we.cache&&t.virtual.cache[ee])return t.virtual.cache[ee];let Re;return we.renderSlide?(Re=we.renderSlide.call(t,X,ee),typeof Re=="string"&&(A.innerHTML=Re,Re=A.children[0])):t.isElement?Re=ha("swiper-slide"):Re=ha("div",t.params.slideClass),Re.setAttribute("data-swiper-slide-index",ee),we.renderSlide||(Re.innerHTML=X),we.cache&&(t.virtual.cache[ee]=Re),Re}function B(X,ee,we){let{slidesPerView:Re,slidesPerGroup:Ce,centeredSlides:Te,loop:Xe,initialSlide:et}=t.params;if(ee&&!Xe&&et>0)return;let{addSlidesBefore:Pt,addSlidesAfter:Lt}=t.params.virtual,{from:lt,to:Ye,slides:xt,slidesGrid:Bt,offset:Ft}=t.virtual;t.params.cssMode||t.updateActiveIndex();let dt=typeof we>"u"?t.activeIndex||0:we,Ot;t.rtlTranslate?Ot="right":Ot=t.isHorizontal()?"left":"top";let Kt,oi;Te?(Kt=Math.floor(Re/2)+Ce+Lt,oi=Math.floor(Re/2)+Ce+Pt):(Kt=Re+(Ce-1)+Lt,oi=(Xe?Re:Ce)+Pt);let tt=dt-oi,vt=dt+Kt;Xe||(tt=Math.max(tt,0),vt=Math.min(vt,xt.length-1));let pi=(t.slidesGrid[tt]||0)-(t.slidesGrid[0]||0);Xe&&dt>=oi?(tt-=oi,Te||(pi+=t.slidesGrid[0])):Xe&&dt<oi&&(tt=-oi,Te&&(pi+=t.slidesGrid[0])),Object.assign(t.virtual,{from:tt,to:vt,offset:pi,slidesGrid:t.slidesGrid,slidesBefore:oi,slidesAfter:Kt});function mn(){t.updateSlides(),t.updateProgress(),t.updateSlidesClasses(),s("virtualUpdate")}if(lt===tt&&Ye===vt&&!X){t.slidesGrid!==Bt&&pi!==Ft&&t.slides.forEach(Xt=>{Xt.style[Ot]=`${pi-Math.abs(t.cssOverflowAdjustment())}px`}),t.updateProgress(),s("virtualUpdate");return}if(t.params.virtual.renderExternal){t.params.virtual.renderExternal.call(t,{offset:pi,from:tt,to:vt,slides:function(){let li=[];for(let ce=tt;ce<=vt;ce+=1)li.push(xt[ce]);return li}()}),t.params.virtual.renderExternalUpdate?mn():s("virtualUpdate");return}let _i=[],ro=[],pa=Xt=>{let li=Xt;return Xt<0?li=xt.length+Xt:li>=xt.length&&(li=li-xt.length),li};if(X)t.slides.filter(Xt=>Xt.matches(`.${t.params.slideClass}, swiper-slide`)).forEach(Xt=>{Xt.remove()});else for(let Xt=lt;Xt<=Ye;Xt+=1)if(Xt<tt||Xt>vt){let li=pa(Xt);t.slides.filter(ce=>ce.matches(`.${t.params.slideClass}[data-swiper-slide-index="${li}"], swiper-slide[data-swiper-slide-index="${li}"]`)).forEach(ce=>{ce.remove()})}let Ko=Xe?-xt.length:0,Qt=Xe?xt.length*2:xt.length;for(let Xt=Ko;Xt<Qt;Xt+=1)if(Xt>=tt&&Xt<=vt){let li=pa(Xt);typeof Ye>"u"||X?ro.push(li):(Xt>Ye&&ro.push(li),Xt<lt&&_i.push(li))}if(ro.forEach(Xt=>{t.slidesEl.append(P(xt[Xt],Xt))}),Xe)for(let Xt=_i.length-1;Xt>=0;Xt-=1){let li=_i[Xt];t.slidesEl.prepend(P(xt[li],li))}else _i.sort((Xt,li)=>li-Xt),_i.forEach(Xt=>{t.slidesEl.prepend(P(xt[Xt],Xt))});wo(t.slidesEl,".swiper-slide, swiper-slide").forEach(Xt=>{Xt.style[Ot]=`${pi-Math.abs(t.cssOverflowAdjustment())}px`}),mn()}function U(X){if(typeof X=="object"&&"length"in X)for(let ee=0;ee<X.length;ee+=1)X[ee]&&t.virtual.slides.push(X[ee]);else t.virtual.slides.push(X);B(!0)}function J(X){let ee=t.activeIndex,we=ee+1,Re=1;if(Array.isArray(X)){for(let Ce=0;Ce<X.length;Ce+=1)X[Ce]&&t.virtual.slides.unshift(X[Ce]);we=ee+X.length,Re=X.length}else t.virtual.slides.unshift(X);if(t.params.virtual.cache){let Ce=t.virtual.cache,Te={};Object.keys(Ce).forEach(Xe=>{let et=Ce[Xe],Pt=et.getAttribute("data-swiper-slide-index");Pt&&et.setAttribute("data-swiper-slide-index",parseInt(Pt,10)+Re),Te[parseInt(Xe,10)+Re]=et}),t.virtual.cache=Te}B(!0),t.slideTo(we,0)}function le(X){if(typeof X>"u"||X===null)return;let ee=t.activeIndex;if(Array.isArray(X))for(let we=X.length-1;we>=0;we-=1)t.params.virtual.cache&&(delete t.virtual.cache[X[we]],Object.keys(t.virtual.cache).forEach(Re=>{Re>X&&(t.virtual.cache[Re-1]=t.virtual.cache[Re],t.virtual.cache[Re-1].setAttribute("data-swiper-slide-index",Re-1),delete t.virtual.cache[Re])})),t.virtual.slides.splice(X[we],1),X[we]<ee&&(ee-=1),ee=Math.max(ee,0);else t.params.virtual.cache&&(delete t.virtual.cache[X],Object.keys(t.virtual.cache).forEach(we=>{we>X&&(t.virtual.cache[we-1]=t.virtual.cache[we],t.virtual.cache[we-1].setAttribute("data-swiper-slide-index",we-1),delete t.virtual.cache[we])})),t.virtual.slides.splice(X,1),X<ee&&(ee-=1),ee=Math.max(ee,0);B(!0),t.slideTo(ee,0)}function re(){t.virtual.slides=[],t.params.virtual.cache&&(t.virtual.cache={}),B(!0),t.slideTo(0,0)}n("beforeInit",()=>{if(!t.params.virtual.enabled)return;let X;if(typeof t.passedParams.virtual.slides>"u"){let ee=[...t.slidesEl.children].filter(we=>we.matches(`.${t.params.slideClass}, swiper-slide`));ee&&ee.length&&(t.virtual.slides=[...ee],X=!0,ee.forEach((we,Re)=>{we.setAttribute("data-swiper-slide-index",Re),t.virtual.cache[Re]=we,we.remove()}))}X||(t.virtual.slides=t.params.virtual.slides),t.classNames.push(`${t.params.containerModifierClass}virtual`),t.params.watchSlidesProgress=!0,t.originalParams.watchSlidesProgress=!0,B(!1,!0)}),n("setTranslate",()=>{t.params.virtual.enabled&&(t.params.cssMode&&!t._immediateVirtual?(clearTimeout(r),r=setTimeout(()=>{B()},100)):B())}),n("init update resize",()=>{t.params.virtual.enabled&&t.params.cssMode&&jm(t.wrapperEl,"--swiper-virtual-size",`${t.virtualSize}px`)}),Object.assign(t.virtual,{appendSlide:U,prependSlide:J,removeSlide:le,removeAllSlides:re,update:B})}function GH(i){let{swiper:t,extendParams:e,on:n,emit:s}=i,r=Zr(),y=Ir();t.keyboard={enabled:!1},e({keyboard:{enabled:!1,onlyInViewport:!0,pageUpDown:!0}});function A(U){if(!t.enabled)return;let{rtlTranslate:J}=t,le=U;le.originalEvent&&(le=le.originalEvent);let re=le.keyCode||le.charCode,X=t.params.keyboard.pageUpDown,ee=X&&re===33,we=X&&re===34,Re=re===37,Ce=re===39,Te=re===38,Xe=re===40;if(!t.allowSlideNext&&(t.isHorizontal()&&Ce||t.isVertical()&&Xe||we)||!t.allowSlidePrev&&(t.isHorizontal()&&Re||t.isVertical()&&Te||ee))return!1;if(!(le.shiftKey||le.altKey||le.ctrlKey||le.metaKey)&&!(r.activeElement&&r.activeElement.nodeName&&(r.activeElement.nodeName.toLowerCase()==="input"||r.activeElement.nodeName.toLowerCase()==="textarea"))){if(t.params.keyboard.onlyInViewport&&(ee||we||Re||Ce||Te||Xe)){let et=!1;if(nd(t.el,`.${t.params.slideClass}, swiper-slide`).length>0&&nd(t.el,`.${t.params.slideActiveClass}`).length===0)return;let Pt=t.el,Lt=Pt.clientWidth,lt=Pt.clientHeight,Ye=y.innerWidth,xt=y.innerHeight,Bt=Um(Pt);J&&(Bt.left-=Pt.scrollLeft);let Ft=[[Bt.left,Bt.top],[Bt.left+Lt,Bt.top],[Bt.left,Bt.top+lt],[Bt.left+Lt,Bt.top+lt]];for(let dt=0;dt<Ft.length;dt+=1){let Ot=Ft[dt];if(Ot[0]>=0&&Ot[0]<=Ye&&Ot[1]>=0&&Ot[1]<=xt){if(Ot[0]===0&&Ot[1]===0)continue;et=!0}}if(!et)return}t.isHorizontal()?((ee||we||Re||Ce)&&(le.preventDefault?le.preventDefault():le.returnValue=!1),((we||Ce)&&!J||(ee||Re)&&J)&&t.slideNext(),((ee||Re)&&!J||(we||Ce)&&J)&&t.slidePrev()):((ee||we||Te||Xe)&&(le.preventDefault?le.preventDefault():le.returnValue=!1),(we||Xe)&&t.slideNext(),(ee||Te)&&t.slidePrev()),s("keyPress",re)}}function P(){t.keyboard.enabled||(r.addEventListener("keydown",A),t.keyboard.enabled=!0)}function B(){t.keyboard.enabled&&(r.removeEventListener("keydown",A),t.keyboard.enabled=!1)}n("init",()=>{t.params.keyboard.enabled&&P()}),n("destroy",()=>{t.keyboard.enabled&&B()}),Object.assign(t.keyboard,{enable:P,disable:B})}function qH(i){let{swiper:t,extendParams:e,on:n,emit:s}=i,r=Ir();e({mousewheel:{enabled:!1,releaseOnEdges:!1,invert:!1,forceToAxis:!1,sensitivity:1,eventsTarget:"container",thresholdDelta:null,thresholdTime:null,noMousewheelClass:"swiper-no-mousewheel"}}),t.mousewheel={enabled:!1};let y,A=Ps(),P,B=[];function U(Te){let Lt=0,lt=0,Ye=0,xt=0;return"detail"in Te&&(lt=Te.detail),"wheelDelta"in Te&&(lt=-Te.wheelDelta/120),"wheelDeltaY"in Te&&(lt=-Te.wheelDeltaY/120),"wheelDeltaX"in Te&&(Lt=-Te.wheelDeltaX/120),"axis"in Te&&Te.axis===Te.HORIZONTAL_AXIS&&(Lt=lt,lt=0),Ye=Lt*10,xt=lt*10,"deltaY"in Te&&(xt=Te.deltaY),"deltaX"in Te&&(Ye=Te.deltaX),Te.shiftKey&&!Ye&&(Ye=xt,xt=0),(Ye||xt)&&Te.deltaMode&&(Te.deltaMode===1?(Ye*=40,xt*=40):(Ye*=800,xt*=800)),Ye&&!Lt&&(Lt=Ye<1?-1:1),xt&&!lt&&(lt=xt<1?-1:1),{spinX:Lt,spinY:lt,pixelX:Ye,pixelY:xt}}function J(){t.enabled&&(t.mouseEntered=!0)}function le(){t.enabled&&(t.mouseEntered=!1)}function re(Te){return t.params.mousewheel.thresholdDelta&&Te.delta<t.params.mousewheel.thresholdDelta||t.params.mousewheel.thresholdTime&&Ps()-A<t.params.mousewheel.thresholdTime?!1:Te.delta>=6&&Ps()-A<60?!0:(Te.direction<0?(!t.isEnd||t.params.loop)&&!t.animating&&(t.slideNext(),s("scroll",Te.raw)):(!t.isBeginning||t.params.loop)&&!t.animating&&(t.slidePrev(),s("scroll",Te.raw)),A=new r.Date().getTime(),!1)}function X(Te){let Xe=t.params.mousewheel;if(Te.direction<0){if(t.isEnd&&!t.params.loop&&Xe.releaseOnEdges)return!0}else if(t.isBeginning&&!t.params.loop&&Xe.releaseOnEdges)return!0;return!1}function ee(Te){let Xe=Te,et=!0;if(!t.enabled||Te.target.closest(`.${t.params.mousewheel.noMousewheelClass}`))return;let Pt=t.params.mousewheel;t.params.cssMode&&Xe.preventDefault();let Lt=t.el;t.params.mousewheel.eventsTarget!=="container"&&(Lt=document.querySelector(t.params.mousewheel.eventsTarget));let lt=Lt&&Lt.contains(Xe.target);if(!t.mouseEntered&&!lt&&!Pt.releaseOnEdges)return!0;Xe.originalEvent&&(Xe=Xe.originalEvent);let Ye=0,xt=t.rtlTranslate?-1:1,Bt=U(Xe);if(Pt.forceToAxis)if(t.isHorizontal())if(Math.abs(Bt.pixelX)>Math.abs(Bt.pixelY))Ye=-Bt.pixelX*xt;else return!0;else if(Math.abs(Bt.pixelY)>Math.abs(Bt.pixelX))Ye=-Bt.pixelY;else return!0;else Ye=Math.abs(Bt.pixelX)>Math.abs(Bt.pixelY)?-Bt.pixelX*xt:-Bt.pixelY;if(Ye===0)return!0;Pt.invert&&(Ye=-Ye);let Ft=t.getTranslate()+Ye*Pt.sensitivity;if(Ft>=t.minTranslate()&&(Ft=t.minTranslate()),Ft<=t.maxTranslate()&&(Ft=t.maxTranslate()),et=t.params.loop?!0:!(Ft===t.minTranslate()||Ft===t.maxTranslate()),et&&t.params.nested&&Xe.stopPropagation(),!t.params.freeMode||!t.params.freeMode.enabled){let dt={time:Ps(),delta:Math.abs(Ye),direction:Math.sign(Ye),raw:Te};B.length>=2&&B.shift();let Ot=B.length?B[B.length-1]:void 0;if(B.push(dt),Ot?(dt.direction!==Ot.direction||dt.delta>Ot.delta||dt.time>Ot.time+150)&&re(dt):re(dt),X(dt))return!0}else{let dt={time:Ps(),delta:Math.abs(Ye),direction:Math.sign(Ye)},Ot=P&&dt.time<P.time+500&&dt.delta<=P.delta&&dt.direction===P.direction;if(!Ot){P=void 0;let Kt=t.getTranslate()+Ye*Pt.sensitivity,oi=t.isBeginning,tt=t.isEnd;if(Kt>=t.minTranslate()&&(Kt=t.minTranslate()),Kt<=t.maxTranslate()&&(Kt=t.maxTranslate()),t.setTransition(0),t.setTranslate(Kt),t.updateProgress(),t.updateActiveIndex(),t.updateSlidesClasses(),(!oi&&t.isBeginning||!tt&&t.isEnd)&&t.updateSlidesClasses(),t.params.loop&&t.loopFix({direction:dt.direction<0?"next":"prev",byMousewheel:!0}),t.params.freeMode.sticky){clearTimeout(y),y=void 0,B.length>=15&&B.shift();let vt=B.length?B[B.length-1]:void 0,pi=B[0];if(B.push(dt),vt&&(dt.delta>vt.delta||dt.direction!==vt.direction))B.splice(0);else if(B.length>=15&&dt.time-pi.time<500&&pi.delta-dt.delta>=1&&dt.delta<=6){let mn=Ye>0?.8:.2;P=dt,B.splice(0),y=id(()=>{t.destroyed||!t.params||t.slideToClosest(t.params.speed,!0,void 0,mn)},0)}y||(y=id(()=>{if(t.destroyed||!t.params)return;let mn=.5;P=dt,B.splice(0),t.slideToClosest(t.params.speed,!0,void 0,mn)},500))}if(Ot||s("scroll",Xe),t.params.autoplay&&t.params.autoplay.disableOnInteraction&&t.autoplay.stop(),Pt.releaseOnEdges&&(Kt===t.minTranslate()||Kt===t.maxTranslate()))return!0}}return Xe.preventDefault?Xe.preventDefault():Xe.returnValue=!1,!1}function we(Te){let Xe=t.el;t.params.mousewheel.eventsTarget!=="container"&&(Xe=document.querySelector(t.params.mousewheel.eventsTarget)),Xe[Te]("mouseenter",J),Xe[Te]("mouseleave",le),Xe[Te]("wheel",ee)}function Re(){return t.params.cssMode?(t.wrapperEl.removeEventListener("wheel",ee),!0):t.mousewheel.enabled?!1:(we("addEventListener"),t.mousewheel.enabled=!0,!0)}function Ce(){return t.params.cssMode?(t.wrapperEl.addEventListener(event,ee),!0):t.mousewheel.enabled?(we("removeEventListener"),t.mousewheel.enabled=!1,!0):!1}n("init",()=>{!t.params.mousewheel.enabled&&t.params.cssMode&&Ce(),t.params.mousewheel.enabled&&Re()}),n("destroy",()=>{t.params.cssMode&&Re(),t.mousewheel.enabled&&Ce()}),Object.assign(t.mousewheel,{enable:Re,disable:Ce})}function By(i,t,e,n){return i.params.createElements&&Object.keys(n).forEach(s=>{if(!e[s]&&e.auto===!0){let r=wo(i.el,`.${n[s]}`)[0];r||(r=ha("div",n[s]),r.className=n[s],i.el.append(r)),e[s]=r,t[s]=r}}),e}function WH(i){let{swiper:t,extendParams:e,on:n,emit:s}=i;e({navigation:{nextEl:null,prevEl:null,hideOnClick:!1,disabledClass:"swiper-button-disabled",hiddenClass:"swiper-button-hidden",lockClass:"swiper-button-lock",navigationDisabledClass:"swiper-navigation-disabled"}}),t.navigation={nextEl:null,prevEl:null};function r(X){let ee;return X&&typeof X=="string"&&t.isElement&&(ee=t.el.querySelector(X)||t.hostEl.querySelector(X),ee)?ee:(X&&(typeof X=="string"&&(ee=[...document.querySelectorAll(X)]),t.params.uniqueNavElements&&typeof X=="string"&&ee&&ee.length>1&&t.el.querySelectorAll(X).length===1?ee=t.el.querySelector(X):ee&&ee.length===1&&(ee=ee[0])),X&&!ee?X:ee)}function y(X,ee){let we=t.params.navigation;X=Xn(X),X.forEach(Re=>{Re&&(Re.classList[ee?"add":"remove"](...we.disabledClass.split(" ")),Re.tagName==="BUTTON"&&(Re.disabled=ee),t.params.watchOverflow&&t.enabled&&Re.classList[t.isLocked?"add":"remove"](we.lockClass))})}function A(){let{nextEl:X,prevEl:ee}=t.navigation;if(t.params.loop){y(ee,!1),y(X,!1);return}y(ee,t.isBeginning&&!t.params.rewind),y(X,t.isEnd&&!t.params.rewind)}function P(X){X.preventDefault(),!(t.isBeginning&&!t.params.loop&&!t.params.rewind)&&(t.slidePrev(),s("navigationPrev"))}function B(X){X.preventDefault(),!(t.isEnd&&!t.params.loop&&!t.params.rewind)&&(t.slideNext(),s("navigationNext"))}function U(){let X=t.params.navigation;if(t.params.navigation=By(t,t.originalParams.navigation,t.params.navigation,{nextEl:"swiper-button-next",prevEl:"swiper-button-prev"}),!(X.nextEl||X.prevEl))return;let ee=r(X.nextEl),we=r(X.prevEl);Object.assign(t.navigation,{nextEl:ee,prevEl:we}),ee=Xn(ee),we=Xn(we);let Re=(Ce,Te)=>{Ce&&Ce.addEventListener("click",Te==="next"?B:P),!t.enabled&&Ce&&Ce.classList.add(...X.lockClass.split(" "))};ee.forEach(Ce=>Re(Ce,"next")),we.forEach(Ce=>Re(Ce,"prev"))}function J(){let{nextEl:X,prevEl:ee}=t.navigation;X=Xn(X),ee=Xn(ee);let we=(Re,Ce)=>{Re.removeEventListener("click",Ce==="next"?B:P),Re.classList.remove(...t.params.navigation.disabledClass.split(" "))};X.forEach(Re=>we(Re,"next")),ee.forEach(Re=>we(Re,"prev"))}n("init",()=>{t.params.navigation.enabled===!1?re():(U(),A())}),n("toEdge fromEdge lock unlock",()=>{A()}),n("destroy",()=>{J()}),n("enable disable",()=>{let{nextEl:X,prevEl:ee}=t.navigation;if(X=Xn(X),ee=Xn(ee),t.enabled){A();return}[...X,...ee].filter(we=>!!we).forEach(we=>we.classList.add(t.params.navigation.lockClass))}),n("click",(X,ee)=>{let{nextEl:we,prevEl:Re}=t.navigation;we=Xn(we),Re=Xn(Re);let Ce=ee.target,Te=Re.includes(Ce)||we.includes(Ce);if(t.isElement&&!Te){let Xe=ee.path||ee.composedPath&&ee.composedPath();Xe&&(Te=Xe.find(et=>we.includes(et)||Re.includes(et)))}if(t.params.navigation.hideOnClick&&!Te){if(t.pagination&&t.params.pagination&&t.params.pagination.clickable&&(t.pagination.el===Ce||t.pagination.el.contains(Ce)))return;let Xe;we.length?Xe=we[0].classList.contains(t.params.navigation.hiddenClass):Re.length&&(Xe=Re[0].classList.contains(t.params.navigation.hiddenClass)),s(Xe===!0?"navigationShow":"navigationHide"),[...we,...Re].filter(et=>!!et).forEach(et=>et.classList.toggle(t.params.navigation.hiddenClass))}});let le=()=>{t.el.classList.remove(...t.params.navigation.navigationDisabledClass.split(" ")),U(),A()},re=()=>{t.el.classList.add(...t.params.navigation.navigationDisabledClass.split(" ")),J()};Object.assign(t.navigation,{enable:le,disable:re,update:A,init:U,destroy:J})}function lc(i){return i===void 0&&(i=""),`.${i.trim().replace(/([\.:!+\/])/g,"\\$1").replace(/ /g,".")}`}function YH(i){let{swiper:t,extendParams:e,on:n,emit:s}=i,r="swiper-pagination";e({pagination:{el:null,bulletElement:"span",clickable:!1,hideOnClick:!1,renderBullet:null,renderProgressbar:null,renderFraction:null,renderCustom:null,progressbarOpposite:!1,type:"bullets",dynamicBullets:!1,dynamicMainBullets:1,formatFractionCurrent:Ce=>Ce,formatFractionTotal:Ce=>Ce,bulletClass:`${r}-bullet`,bulletActiveClass:`${r}-bullet-active`,modifierClass:`${r}-`,currentClass:`${r}-current`,totalClass:`${r}-total`,hiddenClass:`${r}-hidden`,progressbarFillClass:`${r}-progressbar-fill`,progressbarOppositeClass:`${r}-progressbar-opposite`,clickableClass:`${r}-clickable`,lockClass:`${r}-lock`,horizontalClass:`${r}-horizontal`,verticalClass:`${r}-vertical`,paginationDisabledClass:`${r}-disabled`}}),t.pagination={el:null,bullets:[]};let y,A=0;function P(){return!t.params.pagination.el||!t.pagination.el||Array.isArray(t.pagination.el)&&t.pagination.el.length===0}function B(Ce,Te){let{bulletActiveClass:Xe}=t.params.pagination;Ce&&(Ce=Ce[`${Te==="prev"?"previous":"next"}ElementSibling`],Ce&&(Ce.classList.add(`${Xe}-${Te}`),Ce=Ce[`${Te==="prev"?"previous":"next"}ElementSibling`],Ce&&Ce.classList.add(`${Xe}-${Te}-${Te}`)))}function U(Ce,Te,Xe){if(Ce=Ce%Xe,Te=Te%Xe,Te===Ce+1)return"next";if(Te===Ce-1)return"previous"}function J(Ce){let Te=Ce.target.closest(lc(t.params.pagination.bulletClass));if(!Te)return;Ce.preventDefault();let Xe=Up(Te)*t.params.slidesPerGroup;if(t.params.loop){if(t.realIndex===Xe)return;let et=U(t.realIndex,Xe,t.slides.length);et==="next"?t.slideNext():et==="previous"?t.slidePrev():t.slideToLoop(Xe)}else t.slideTo(Xe)}function le(){let Ce=t.rtl,Te=t.params.pagination;if(P())return;let Xe=t.pagination.el;Xe=Xn(Xe);let et,Pt,Lt=t.virtual&&t.params.virtual.enabled?t.virtual.slides.length:t.slides.length,lt=t.params.loop?Math.ceil(Lt/t.params.slidesPerGroup):t.snapGrid.length;if(t.params.loop?(Pt=t.previousRealIndex||0,et=t.params.slidesPerGroup>1?Math.floor(t.realIndex/t.params.slidesPerGroup):t.realIndex):typeof t.snapIndex<"u"?(et=t.snapIndex,Pt=t.previousSnapIndex):(Pt=t.previousIndex||0,et=t.activeIndex||0),Te.type==="bullets"&&t.pagination.bullets&&t.pagination.bullets.length>0){let Ye=t.pagination.bullets,xt,Bt,Ft;if(Te.dynamicBullets&&(y=Yx(Ye[0],t.isHorizontal()?"width":"height",!0),Xe.forEach(dt=>{dt.style[t.isHorizontal()?"width":"height"]=`${y*(Te.dynamicMainBullets+4)}px`}),Te.dynamicMainBullets>1&&Pt!==void 0&&(A+=et-(Pt||0),A>Te.dynamicMainBullets-1?A=Te.dynamicMainBullets-1:A<0&&(A=0)),xt=Math.max(et-A,0),Bt=xt+(Math.min(Ye.length,Te.dynamicMainBullets)-1),Ft=(Bt+xt)/2),Ye.forEach(dt=>{let Ot=[...["","-next","-next-next","-prev","-prev-prev","-main"].map(Kt=>`${Te.bulletActiveClass}${Kt}`)].map(Kt=>typeof Kt=="string"&&Kt.includes(" ")?Kt.split(" "):Kt).flat();dt.classList.remove(...Ot)}),Xe.length>1)Ye.forEach(dt=>{let Ot=Up(dt);Ot===et?dt.classList.add(...Te.bulletActiveClass.split(" ")):t.isElement&&dt.setAttribute("part","bullet"),Te.dynamicBullets&&(Ot>=xt&&Ot<=Bt&&dt.classList.add(...`${Te.bulletActiveClass}-main`.split(" ")),Ot===xt&&B(dt,"prev"),Ot===Bt&&B(dt,"next"))});else{let dt=Ye[et];if(dt&&dt.classList.add(...Te.bulletActiveClass.split(" ")),t.isElement&&Ye.forEach((Ot,Kt)=>{Ot.setAttribute("part",Kt===et?"bullet-active":"bullet")}),Te.dynamicBullets){let Ot=Ye[xt],Kt=Ye[Bt];for(let oi=xt;oi<=Bt;oi+=1)Ye[oi]&&Ye[oi].classList.add(...`${Te.bulletActiveClass}-main`.split(" "));B(Ot,"prev"),B(Kt,"next")}}if(Te.dynamicBullets){let dt=Math.min(Ye.length,Te.dynamicMainBullets+4),Ot=(y*dt-y)/2-Ft*y,Kt=Ce?"right":"left";Ye.forEach(oi=>{oi.style[t.isHorizontal()?Kt:"top"]=`${Ot}px`})}}Xe.forEach((Ye,xt)=>{if(Te.type==="fraction"&&(Ye.querySelectorAll(lc(Te.currentClass)).forEach(Bt=>{Bt.textContent=Te.formatFractionCurrent(et+1)}),Ye.querySelectorAll(lc(Te.totalClass)).forEach(Bt=>{Bt.textContent=Te.formatFractionTotal(lt)})),Te.type==="progressbar"){let Bt;Te.progressbarOpposite?Bt=t.isHorizontal()?"vertical":"horizontal":Bt=t.isHorizontal()?"horizontal":"vertical";let Ft=(et+1)/lt,dt=1,Ot=1;Bt==="horizontal"?dt=Ft:Ot=Ft,Ye.querySelectorAll(lc(Te.progressbarFillClass)).forEach(Kt=>{Kt.style.transform=`translate3d(0,0,0) scaleX(${dt}) scaleY(${Ot})`,Kt.style.transitionDuration=`${t.params.speed}ms`})}Te.type==="custom"&&Te.renderCustom?(Ye.innerHTML=Te.renderCustom(t,et+1,lt),xt===0&&s("paginationRender",Ye)):(xt===0&&s("paginationRender",Ye),s("paginationUpdate",Ye)),t.params.watchOverflow&&t.enabled&&Ye.classList[t.isLocked?"add":"remove"](Te.lockClass)})}function re(){let Ce=t.params.pagination;if(P())return;let Te=t.virtual&&t.params.virtual.enabled?t.virtual.slides.length:t.grid&&t.params.grid.rows>1?t.slides.length/Math.ceil(t.params.grid.rows):t.slides.length,Xe=t.pagination.el;Xe=Xn(Xe);let et="";if(Ce.type==="bullets"){let Pt=t.params.loop?Math.ceil(Te/t.params.slidesPerGroup):t.snapGrid.length;t.params.freeMode&&t.params.freeMode.enabled&&Pt>Te&&(Pt=Te);for(let Lt=0;Lt<Pt;Lt+=1)Ce.renderBullet?et+=Ce.renderBullet.call(t,Lt,Ce.bulletClass):et+=`<${Ce.bulletElement} ${t.isElement?'part="bullet"':""} class="${Ce.bulletClass}"></${Ce.bulletElement}>`}Ce.type==="fraction"&&(Ce.renderFraction?et=Ce.renderFraction.call(t,Ce.currentClass,Ce.totalClass):et=`<span class="${Ce.currentClass}"></span> / <span class="${Ce.totalClass}"></span>`),Ce.type==="progressbar"&&(Ce.renderProgressbar?et=Ce.renderProgressbar.call(t,Ce.progressbarFillClass):et=`<span class="${Ce.progressbarFillClass}"></span>`),t.pagination.bullets=[],Xe.forEach(Pt=>{Ce.type!=="custom"&&(Pt.innerHTML=et||""),Ce.type==="bullets"&&t.pagination.bullets.push(...Pt.querySelectorAll(lc(Ce.bulletClass)))}),Ce.type!=="custom"&&s("paginationRender",Xe[0])}function X(){t.params.pagination=By(t,t.originalParams.pagination,t.params.pagination,{el:"swiper-pagination"});let Ce=t.params.pagination;if(!Ce.el)return;let Te;typeof Ce.el=="string"&&t.isElement&&(Te=t.el.querySelector(Ce.el)),!Te&&typeof Ce.el=="string"&&(Te=[...document.querySelectorAll(Ce.el)]),Te||(Te=Ce.el),!(!Te||Te.length===0)&&(t.params.uniqueNavElements&&typeof Ce.el=="string"&&Array.isArray(Te)&&Te.length>1&&(Te=[...t.el.querySelectorAll(Ce.el)],Te.length>1&&(Te=Te.find(Xe=>nd(Xe,".swiper")[0]===t.el))),Array.isArray(Te)&&Te.length===1&&(Te=Te[0]),Object.assign(t.pagination,{el:Te}),Te=Xn(Te),Te.forEach(Xe=>{Ce.type==="bullets"&&Ce.clickable&&Xe.classList.add(...(Ce.clickableClass||"").split(" ")),Xe.classList.add(Ce.modifierClass+Ce.type),Xe.classList.add(t.isHorizontal()?Ce.horizontalClass:Ce.verticalClass),Ce.type==="bullets"&&Ce.dynamicBullets&&(Xe.classList.add(`${Ce.modifierClass}${Ce.type}-dynamic`),A=0,Ce.dynamicMainBullets<1&&(Ce.dynamicMainBullets=1)),Ce.type==="progressbar"&&Ce.progressbarOpposite&&Xe.classList.add(Ce.progressbarOppositeClass),Ce.clickable&&Xe.addEventListener("click",J),t.enabled||Xe.classList.add(Ce.lockClass)}))}function ee(){let Ce=t.params.pagination;if(P())return;let Te=t.pagination.el;Te&&(Te=Xn(Te),Te.forEach(Xe=>{Xe.classList.remove(Ce.hiddenClass),Xe.classList.remove(Ce.modifierClass+Ce.type),Xe.classList.remove(t.isHorizontal()?Ce.horizontalClass:Ce.verticalClass),Ce.clickable&&(Xe.classList.remove(...(Ce.clickableClass||"").split(" ")),Xe.removeEventListener("click",J))})),t.pagination.bullets&&t.pagination.bullets.forEach(Xe=>Xe.classList.remove(...Ce.bulletActiveClass.split(" ")))}n("changeDirection",()=>{if(!t.pagination||!t.pagination.el)return;let Ce=t.params.pagination,{el:Te}=t.pagination;Te=Xn(Te),Te.forEach(Xe=>{Xe.classList.remove(Ce.horizontalClass,Ce.verticalClass),Xe.classList.add(t.isHorizontal()?Ce.horizontalClass:Ce.verticalClass)})}),n("init",()=>{t.params.pagination.enabled===!1?Re():(X(),re(),le())}),n("activeIndexChange",()=>{typeof t.snapIndex>"u"&&le()}),n("snapIndexChange",()=>{le()}),n("snapGridLengthChange",()=>{re(),le()}),n("destroy",()=>{ee()}),n("enable disable",()=>{let{el:Ce}=t.pagination;Ce&&(Ce=Xn(Ce),Ce.forEach(Te=>Te.classList[t.enabled?"remove":"add"](t.params.pagination.lockClass)))}),n("lock unlock",()=>{le()}),n("click",(Ce,Te)=>{let Xe=Te.target,et=Xn(t.pagination.el);if(t.params.pagination.el&&t.params.pagination.hideOnClick&&et&&et.length>0&&!Xe.classList.contains(t.params.pagination.bulletClass)){if(t.navigation&&(t.navigation.nextEl&&Xe===t.navigation.nextEl||t.navigation.prevEl&&Xe===t.navigation.prevEl))return;let Pt=et[0].classList.contains(t.params.pagination.hiddenClass);s(Pt===!0?"paginationShow":"paginationHide"),et.forEach(Lt=>Lt.classList.toggle(t.params.pagination.hiddenClass))}});let we=()=>{t.el.classList.remove(t.params.pagination.paginationDisabledClass);let{el:Ce}=t.pagination;Ce&&(Ce=Xn(Ce),Ce.forEach(Te=>Te.classList.remove(t.params.pagination.paginationDisabledClass))),X(),re(),le()},Re=()=>{t.el.classList.add(t.params.pagination.paginationDisabledClass);let{el:Ce}=t.pagination;Ce&&(Ce=Xn(Ce),Ce.forEach(Te=>Te.classList.add(t.params.pagination.paginationDisabledClass))),ee()};Object.assign(t.pagination,{enable:we,disable:Re,render:re,update:le,init:X,destroy:ee})}function ZH(i){let{swiper:t,extendParams:e,on:n,emit:s}=i,r=Zr(),y=!1,A=null,P=null,B,U,J,le;e({scrollbar:{el:null,dragSize:"auto",hide:!1,draggable:!1,snapOnRelease:!0,lockClass:"swiper-scrollbar-lock",dragClass:"swiper-scrollbar-drag",scrollbarDisabledClass:"swiper-scrollbar-disabled",horizontalClass:"swiper-scrollbar-horizontal",verticalClass:"swiper-scrollbar-vertical"}}),t.scrollbar={el:null,dragEl:null};function re(){if(!t.params.scrollbar.el||!t.scrollbar.el)return;let{scrollbar:Ft,rtlTranslate:dt}=t,{dragEl:Ot,el:Kt}=Ft,oi=t.params.scrollbar,tt=t.params.loop?t.progressLoop:t.progress,vt=U,pi=(J-U)*tt;dt?(pi=-pi,pi>0?(vt=U-pi,pi=0):-pi+U>J&&(vt=J+pi)):pi<0?(vt=U+pi,pi=0):pi+U>J&&(vt=J-pi),t.isHorizontal()?(Ot.style.transform=`translate3d(${pi}px, 0, 0)`,Ot.style.width=`${vt}px`):(Ot.style.transform=`translate3d(0px, ${pi}px, 0)`,Ot.style.height=`${vt}px`),oi.hide&&(clearTimeout(A),Kt.style.opacity=1,A=setTimeout(()=>{Kt.style.opacity=0,Kt.style.transitionDuration="400ms"},1e3))}function X(Ft){!t.params.scrollbar.el||!t.scrollbar.el||(t.scrollbar.dragEl.style.transitionDuration=`${Ft}ms`)}function ee(){if(!t.params.scrollbar.el||!t.scrollbar.el)return;let{scrollbar:Ft}=t,{dragEl:dt,el:Ot}=Ft;dt.style.width="",dt.style.height="",J=t.isHorizontal()?Ot.offsetWidth:Ot.offsetHeight,le=t.size/(t.virtualSize+t.params.slidesOffsetBefore-(t.params.centeredSlides?t.snapGrid[0]:0)),t.params.scrollbar.dragSize==="auto"?U=J*le:U=parseInt(t.params.scrollbar.dragSize,10),t.isHorizontal()?dt.style.width=`${U}px`:dt.style.height=`${U}px`,le>=1?Ot.style.display="none":Ot.style.display="",t.params.scrollbar.hide&&(Ot.style.opacity=0),t.params.watchOverflow&&t.enabled&&Ft.el.classList[t.isLocked?"add":"remove"](t.params.scrollbar.lockClass)}function we(Ft){return t.isHorizontal()?Ft.clientX:Ft.clientY}function Re(Ft){let{scrollbar:dt,rtlTranslate:Ot}=t,{el:Kt}=dt,oi;oi=(we(Ft)-Um(Kt)[t.isHorizontal()?"left":"top"]-(B!==null?B:U/2))/(J-U),oi=Math.max(Math.min(oi,1),0),Ot&&(oi=1-oi);let tt=t.minTranslate()+(t.maxTranslate()-t.minTranslate())*oi;t.updateProgress(tt),t.setTranslate(tt),t.updateActiveIndex(),t.updateSlidesClasses()}function Ce(Ft){let dt=t.params.scrollbar,{scrollbar:Ot,wrapperEl:Kt}=t,{el:oi,dragEl:tt}=Ot;y=!0,B=Ft.target===tt?we(Ft)-Ft.target.getBoundingClientRect()[t.isHorizontal()?"left":"top"]:null,Ft.preventDefault(),Ft.stopPropagation(),Kt.style.transitionDuration="100ms",tt.style.transitionDuration="100ms",Re(Ft),clearTimeout(P),oi.style.transitionDuration="0ms",dt.hide&&(oi.style.opacity=1),t.params.cssMode&&(t.wrapperEl.style["scroll-snap-type"]="none"),s("scrollbarDragStart",Ft)}function Te(Ft){let{scrollbar:dt,wrapperEl:Ot}=t,{el:Kt,dragEl:oi}=dt;y&&(Ft.preventDefault&&Ft.cancelable?Ft.preventDefault():Ft.returnValue=!1,Re(Ft),Ot.style.transitionDuration="0ms",Kt.style.transitionDuration="0ms",oi.style.transitionDuration="0ms",s("scrollbarDragMove",Ft))}function Xe(Ft){let dt=t.params.scrollbar,{scrollbar:Ot,wrapperEl:Kt}=t,{el:oi}=Ot;y&&(y=!1,t.params.cssMode&&(t.wrapperEl.style["scroll-snap-type"]="",Kt.style.transitionDuration=""),dt.hide&&(clearTimeout(P),P=id(()=>{oi.style.opacity=0,oi.style.transitionDuration="400ms"},1e3)),s("scrollbarDragEnd",Ft),dt.snapOnRelease&&t.slideToClosest())}function et(Ft){let{scrollbar:dt,params:Ot}=t,Kt=dt.el;if(!Kt)return;let oi=Kt,tt=Ot.passiveListeners?{passive:!1,capture:!1}:!1,vt=Ot.passiveListeners?{passive:!0,capture:!1}:!1;if(!oi)return;let pi=Ft==="on"?"addEventListener":"removeEventListener";oi[pi]("pointerdown",Ce,tt),r[pi]("pointermove",Te,tt),r[pi]("pointerup",Xe,vt)}function Pt(){!t.params.scrollbar.el||!t.scrollbar.el||et("on")}function Lt(){!t.params.scrollbar.el||!t.scrollbar.el||et("off")}function lt(){let{scrollbar:Ft,el:dt}=t;t.params.scrollbar=By(t,t.originalParams.scrollbar,t.params.scrollbar,{el:"swiper-scrollbar"});let Ot=t.params.scrollbar;if(!Ot.el)return;let Kt;if(typeof Ot.el=="string"&&t.isElement&&(Kt=t.el.querySelector(Ot.el)),!Kt&&typeof Ot.el=="string"){if(Kt=r.querySelectorAll(Ot.el),!Kt.length)return}else Kt||(Kt=Ot.el);t.params.uniqueNavElements&&typeof Ot.el=="string"&&Kt.length>1&&dt.querySelectorAll(Ot.el).length===1&&(Kt=dt.querySelector(Ot.el)),Kt.length>0&&(Kt=Kt[0]),Kt.classList.add(t.isHorizontal()?Ot.horizontalClass:Ot.verticalClass);let oi;Kt&&(oi=Kt.querySelector(lc(t.params.scrollbar.dragClass)),oi||(oi=ha("div",t.params.scrollbar.dragClass),Kt.append(oi))),Object.assign(Ft,{el:Kt,dragEl:oi}),Ot.draggable&&Pt(),Kt&&Kt.classList[t.enabled?"remove":"add"](...$u(t.params.scrollbar.lockClass))}function Ye(){let Ft=t.params.scrollbar,dt=t.scrollbar.el;dt&&dt.classList.remove(...$u(t.isHorizontal()?Ft.horizontalClass:Ft.verticalClass)),Lt()}n("changeDirection",()=>{if(!t.scrollbar||!t.scrollbar.el)return;let Ft=t.params.scrollbar,{el:dt}=t.scrollbar;dt=Xn(dt),dt.forEach(Ot=>{Ot.classList.remove(Ft.horizontalClass,Ft.verticalClass),Ot.classList.add(t.isHorizontal()?Ft.horizontalClass:Ft.verticalClass)})}),n("init",()=>{t.params.scrollbar.enabled===!1?Bt():(lt(),ee(),re())}),n("update resize observerUpdate lock unlock changeDirection",()=>{ee()}),n("setTranslate",()=>{re()}),n("setTransition",(Ft,dt)=>{X(dt)}),n("enable disable",()=>{let{el:Ft}=t.scrollbar;Ft&&Ft.classList[t.enabled?"remove":"add"](...$u(t.params.scrollbar.lockClass))}),n("destroy",()=>{Ye()});let xt=()=>{t.el.classList.remove(...$u(t.params.scrollbar.scrollbarDisabledClass)),t.scrollbar.el&&t.scrollbar.el.classList.remove(...$u(t.params.scrollbar.scrollbarDisabledClass)),lt(),ee(),re()},Bt=()=>{t.el.classList.add(...$u(t.params.scrollbar.scrollbarDisabledClass)),t.scrollbar.el&&t.scrollbar.el.classList.add(...$u(t.params.scrollbar.scrollbarDisabledClass)),Ye()};Object.assign(t.scrollbar,{enable:xt,disable:Bt,updateSize:ee,setTranslate:re,init:lt,destroy:Ye})}function XH(i){let{swiper:t,extendParams:e,on:n}=i;e({parallax:{enabled:!1}});let s="[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y], [data-swiper-parallax-opacity], [data-swiper-parallax-scale]",r=(P,B)=>{let{rtl:U}=t,J=U?-1:1,le=P.getAttribute("data-swiper-parallax")||"0",re=P.getAttribute("data-swiper-parallax-x"),X=P.getAttribute("data-swiper-parallax-y"),ee=P.getAttribute("data-swiper-parallax-scale"),we=P.getAttribute("data-swiper-parallax-opacity"),Re=P.getAttribute("data-swiper-parallax-rotate");if(re||X?(re=re||"0",X=X||"0"):t.isHorizontal()?(re=le,X="0"):(X=le,re="0"),re.indexOf("%")>=0?re=`${parseInt(re,10)*B*J}%`:re=`${re*B*J}px`,X.indexOf("%")>=0?X=`${parseInt(X,10)*B}%`:X=`${X*B}px`,typeof we<"u"&&we!==null){let Te=we-(we-1)*(1-Math.abs(B));P.style.opacity=Te}let Ce=`translate3d(${re}, ${X}, 0px)`;if(typeof ee<"u"&&ee!==null){let Te=ee-(ee-1)*(1-Math.abs(B));Ce+=` scale(${Te})`}if(Re&&typeof Re<"u"&&Re!==null){let Te=Re*B*-1;Ce+=` rotate(${Te}deg)`}P.style.transform=Ce},y=()=>{let{el:P,slides:B,progress:U,snapGrid:J,isElement:le}=t,re=wo(P,s);t.isElement&&re.push(...wo(t.hostEl,s)),re.forEach(X=>{r(X,U)}),B.forEach((X,ee)=>{let we=X.progress;t.params.slidesPerGroup>1&&t.params.slidesPerView!=="auto"&&(we+=Math.ceil(ee/2)-U*(J.length-1)),we=Math.min(Math.max(we,-1),1),X.querySelectorAll(`${s}, [data-swiper-parallax-rotate]`).forEach(Re=>{r(Re,we)})})},A=function(P){P===void 0&&(P=t.params.speed);let{el:B,hostEl:U}=t,J=[...B.querySelectorAll(s)];t.isElement&&J.push(...U.querySelectorAll(s)),J.forEach(le=>{let re=parseInt(le.getAttribute("data-swiper-parallax-duration"),10)||P;P===0&&(re=0),le.style.transitionDuration=`${re}ms`})};n("beforeInit",()=>{t.params.parallax.enabled&&(t.params.watchSlidesProgress=!0,t.originalParams.watchSlidesProgress=!0)}),n("init",()=>{t.params.parallax.enabled&&y()}),n("setTranslate",()=>{t.params.parallax.enabled&&y()}),n("setTransition",(P,B)=>{t.params.parallax.enabled&&A(B)})}function KH(i){let{swiper:t,extendParams:e,on:n,emit:s}=i,r=Ir();e({zoom:{enabled:!1,limitToOriginalSize:!1,maxRatio:3,minRatio:1,panOnMouseMove:!1,toggle:!0,containerClass:"swiper-zoom-container",zoomedSlideClass:"swiper-slide-zoomed"}}),t.zoom={enabled:!1};let y=1,A=!1,P=!1,B={x:0,y:0},U=-3,J,le,re=[],X={originX:0,originY:0,slideEl:void 0,slideWidth:void 0,slideHeight:void 0,imageEl:void 0,imageWrapEl:void 0,maxRatio:3},ee={isTouched:void 0,isMoved:void 0,currentX:void 0,currentY:void 0,minX:void 0,minY:void 0,maxX:void 0,maxY:void 0,width:void 0,height:void 0,startX:void 0,startY:void 0,touchesStart:{},touchesCurrent:{}},we={x:void 0,y:void 0,prevPositionX:void 0,prevPositionY:void 0,prevTime:void 0},Re=1;Object.defineProperty(t.zoom,"scale",{get(){return Re},set(Qt){if(Re!==Qt){let Xt=X.imageEl,li=X.slideEl;s("zoomChange",Qt,Xt,li)}Re=Qt}});function Ce(){if(re.length<2)return 1;let Qt=re[0].pageX,Xt=re[0].pageY,li=re[1].pageX,ce=re[1].pageY;return Math.sqrt((li-Qt)**2+(ce-Xt)**2)}function Te(){let Qt=t.params.zoom,Xt=X.imageWrapEl.getAttribute("data-swiper-zoom")||Qt.maxRatio;if(Qt.limitToOriginalSize&&X.imageEl&&X.imageEl.naturalWidth){let li=X.imageEl.naturalWidth/X.imageEl.offsetWidth;return Math.min(li,Xt)}return Xt}function Xe(){if(re.length<2)return{x:null,y:null};let Qt=X.imageEl.getBoundingClientRect();return[(re[0].pageX+(re[1].pageX-re[0].pageX)/2-Qt.x-r.scrollX)/y,(re[0].pageY+(re[1].pageY-re[0].pageY)/2-Qt.y-r.scrollY)/y]}function et(){return t.isElement?"swiper-slide":`.${t.params.slideClass}`}function Pt(Qt){let Xt=et();return!!(Qt.target.matches(Xt)||t.slides.filter(li=>li.contains(Qt.target)).length>0)}function Lt(Qt){let Xt=`.${t.params.zoom.containerClass}`;return!!(Qt.target.matches(Xt)||[...t.hostEl.querySelectorAll(Xt)].filter(li=>li.contains(Qt.target)).length>0)}function lt(Qt){if(Qt.pointerType==="mouse"&&re.splice(0,re.length),!Pt(Qt))return;let Xt=t.params.zoom;if(J=!1,le=!1,re.push(Qt),!(re.length<2)){if(J=!0,X.scaleStart=Ce(),!X.slideEl){X.slideEl=Qt.target.closest(`.${t.params.slideClass}, swiper-slide`),X.slideEl||(X.slideEl=t.slides[t.activeIndex]);let li=X.slideEl.querySelector(`.${Xt.containerClass}`);if(li&&(li=li.querySelectorAll("picture, img, svg, canvas, .swiper-zoom-target")[0]),X.imageEl=li,li?X.imageWrapEl=nd(X.imageEl,`.${Xt.containerClass}`)[0]:X.imageWrapEl=void 0,!X.imageWrapEl){X.imageEl=void 0;return}X.maxRatio=Te()}if(X.imageEl){let[li,ce]=Xe();X.originX=li,X.originY=ce,X.imageEl.style.transitionDuration="0ms"}A=!0}}function Ye(Qt){if(!Pt(Qt))return;let Xt=t.params.zoom,li=t.zoom,ce=re.findIndex(Xr=>Xr.pointerId===Qt.pointerId);ce>=0&&(re[ce]=Qt),!(re.length<2)&&(le=!0,X.scaleMove=Ce(),X.imageEl&&(li.scale=X.scaleMove/X.scaleStart*y,li.scale>X.maxRatio&&(li.scale=X.maxRatio-1+(li.scale-X.maxRatio+1)**.5),li.scale<Xt.minRatio&&(li.scale=Xt.minRatio+1-(Xt.minRatio-li.scale+1)**.5),X.imageEl.style.transform=`translate3d(0,0,0) scale(${li.scale})`))}function xt(Qt){if(!Pt(Qt)||Qt.pointerType==="mouse"&&Qt.type==="pointerout")return;let Xt=t.params.zoom,li=t.zoom,ce=re.findIndex(Xr=>Xr.pointerId===Qt.pointerId);ce>=0&&re.splice(ce,1),!(!J||!le)&&(J=!1,le=!1,X.imageEl&&(li.scale=Math.max(Math.min(li.scale,X.maxRatio),Xt.minRatio),X.imageEl.style.transitionDuration=`${t.params.speed}ms`,X.imageEl.style.transform=`translate3d(0,0,0) scale(${li.scale})`,y=li.scale,A=!1,li.scale>1&&X.slideEl?X.slideEl.classList.add(`${Xt.zoomedSlideClass}`):li.scale<=1&&X.slideEl&&X.slideEl.classList.remove(`${Xt.zoomedSlideClass}`),li.scale===1&&(X.originX=0,X.originY=0,X.slideEl=void 0)))}let Bt;function Ft(){t.touchEventsData.preventTouchMoveFromPointerMove=!1}function dt(){clearTimeout(Bt),t.touchEventsData.preventTouchMoveFromPointerMove=!0,Bt=setTimeout(()=>{t.destroyed||Ft()})}function Ot(Qt){let Xt=t.device;if(!X.imageEl||ee.isTouched)return;Xt.android&&Qt.cancelable&&Qt.preventDefault(),ee.isTouched=!0;let li=re.length>0?re[0]:Qt;ee.touchesStart.x=li.pageX,ee.touchesStart.y=li.pageY}function Kt(Qt){let li=Qt.pointerType==="mouse"&&t.params.zoom.panOnMouseMove;if(!Pt(Qt)||!Lt(Qt))return;let ce=t.zoom;if(!X.imageEl)return;if(!ee.isTouched||!X.slideEl){li&&vt(Qt);return}if(li){vt(Qt);return}ee.isMoved||(ee.width=X.imageEl.offsetWidth||X.imageEl.clientWidth,ee.height=X.imageEl.offsetHeight||X.imageEl.clientHeight,ee.startX=qx(X.imageWrapEl,"x")||0,ee.startY=qx(X.imageWrapEl,"y")||0,X.slideWidth=X.slideEl.offsetWidth,X.slideHeight=X.slideEl.offsetHeight,X.imageWrapEl.style.transitionDuration="0ms");let Xr=ee.width*ce.scale,fa=ee.height*ce.scale;if(ee.minX=Math.min(X.slideWidth/2-Xr/2,0),ee.maxX=-ee.minX,ee.minY=Math.min(X.slideHeight/2-fa/2,0),ee.maxY=-ee.minY,ee.touchesCurrent.x=re.length>0?re[0].pageX:Qt.pageX,ee.touchesCurrent.y=re.length>0?re[0].pageY:Qt.pageY,Math.max(Math.abs(ee.touchesCurrent.x-ee.touchesStart.x),Math.abs(ee.touchesCurrent.y-ee.touchesStart.y))>5&&(t.allowClick=!1),!ee.isMoved&&!A){if(t.isHorizontal()&&(Math.floor(ee.minX)===Math.floor(ee.startX)&&ee.touchesCurrent.x<ee.touchesStart.x||Math.floor(ee.maxX)===Math.floor(ee.startX)&&ee.touchesCurrent.x>ee.touchesStart.x)){ee.isTouched=!1,Ft();return}if(!t.isHorizontal()&&(Math.floor(ee.minY)===Math.floor(ee.startY)&&ee.touchesCurrent.y<ee.touchesStart.y||Math.floor(ee.maxY)===Math.floor(ee.startY)&&ee.touchesCurrent.y>ee.touchesStart.y)){ee.isTouched=!1,Ft();return}}Qt.cancelable&&Qt.preventDefault(),Qt.stopPropagation(),dt(),ee.isMoved=!0;let At=(ce.scale-y)/(X.maxRatio-t.params.zoom.minRatio),{originX:To,originY:mr}=X;ee.currentX=ee.touchesCurrent.x-ee.touchesStart.x+ee.startX+At*(ee.width-To*2),ee.currentY=ee.touchesCurrent.y-ee.touchesStart.y+ee.startY+At*(ee.height-mr*2),ee.currentX<ee.minX&&(ee.currentX=ee.minX+1-(ee.minX-ee.currentX+1)**.8),ee.currentX>ee.maxX&&(ee.currentX=ee.maxX-1+(ee.currentX-ee.maxX+1)**.8),ee.currentY<ee.minY&&(ee.currentY=ee.minY+1-(ee.minY-ee.currentY+1)**.8),ee.currentY>ee.maxY&&(ee.currentY=ee.maxY-1+(ee.currentY-ee.maxY+1)**.8),we.prevPositionX||(we.prevPositionX=ee.touchesCurrent.x),we.prevPositionY||(we.prevPositionY=ee.touchesCurrent.y),we.prevTime||(we.prevTime=Date.now()),we.x=(ee.touchesCurrent.x-we.prevPositionX)/(Date.now()-we.prevTime)/2,we.y=(ee.touchesCurrent.y-we.prevPositionY)/(Date.now()-we.prevTime)/2,Math.abs(ee.touchesCurrent.x-we.prevPositionX)<2&&(we.x=0),Math.abs(ee.touchesCurrent.y-we.prevPositionY)<2&&(we.y=0),we.prevPositionX=ee.touchesCurrent.x,we.prevPositionY=ee.touchesCurrent.y,we.prevTime=Date.now(),X.imageWrapEl.style.transform=`translate3d(${ee.currentX}px, ${ee.currentY}px,0)`}function oi(){let Qt=t.zoom;if(re.length=0,!X.imageEl)return;if(!ee.isTouched||!ee.isMoved){ee.isTouched=!1,ee.isMoved=!1;return}ee.isTouched=!1,ee.isMoved=!1;let Xt=300,li=300,ce=we.x*Xt,Xr=ee.currentX+ce,fa=we.y*li,ma=ee.currentY+fa;we.x!==0&&(Xt=Math.abs((Xr-ee.currentX)/we.x)),we.y!==0&&(li=Math.abs((ma-ee.currentY)/we.y));let At=Math.max(Xt,li);ee.currentX=Xr,ee.currentY=ma;let To=ee.width*Qt.scale,mr=ee.height*Qt.scale;ee.minX=Math.min(X.slideWidth/2-To/2,0),ee.maxX=-ee.minX,ee.minY=Math.min(X.slideHeight/2-mr/2,0),ee.maxY=-ee.minY,ee.currentX=Math.max(Math.min(ee.currentX,ee.maxX),ee.minX),ee.currentY=Math.max(Math.min(ee.currentY,ee.maxY),ee.minY),X.imageWrapEl.style.transitionDuration=`${At}ms`,X.imageWrapEl.style.transform=`translate3d(${ee.currentX}px, ${ee.currentY}px,0)`}function tt(){let Qt=t.zoom;X.slideEl&&t.activeIndex!==t.slides.indexOf(X.slideEl)&&(X.imageEl&&(X.imageEl.style.transform="translate3d(0,0,0) scale(1)"),X.imageWrapEl&&(X.imageWrapEl.style.transform="translate3d(0,0,0)"),X.slideEl.classList.remove(`${t.params.zoom.zoomedSlideClass}`),Qt.scale=1,y=1,X.slideEl=void 0,X.imageEl=void 0,X.imageWrapEl=void 0,X.originX=0,X.originY=0)}function vt(Qt){if(y<=1||!X.imageWrapEl||!Pt(Qt)||!Lt(Qt))return;let Xt=r.getComputedStyle(X.imageWrapEl).transform,li=new r.DOMMatrix(Xt);if(!P){P=!0,B.x=Qt.clientX,B.y=Qt.clientY,ee.startX=li.e,ee.startY=li.f,ee.width=X.imageEl.offsetWidth||X.imageEl.clientWidth,ee.height=X.imageEl.offsetHeight||X.imageEl.clientHeight,X.slideWidth=X.slideEl.offsetWidth,X.slideHeight=X.slideEl.offsetHeight;return}let ce=(Qt.clientX-B.x)*U,Xr=(Qt.clientY-B.y)*U,fa=ee.width*y,ma=ee.height*y,At=X.slideWidth,To=X.slideHeight,mr=Math.min(At/2-fa/2,0),ho=-mr,Qi=Math.min(To/2-ma/2,0),Ur=-Qi,ga=Math.max(Math.min(ee.startX+ce,ho),mr),Ya=Math.max(Math.min(ee.startY+Xr,Ur),Qi);X.imageWrapEl.style.transitionDuration="0ms",X.imageWrapEl.style.transform=`translate3d(${ga}px, ${Ya}px, 0)`,B.x=Qt.clientX,B.y=Qt.clientY,ee.startX=ga,ee.startY=Ya,ee.currentX=ga,ee.currentY=Ya}function pi(Qt){let Xt=t.zoom,li=t.params.zoom;if(!X.slideEl){Qt&&Qt.target&&(X.slideEl=Qt.target.closest(`.${t.params.slideClass}, swiper-slide`)),X.slideEl||(t.params.virtual&&t.params.virtual.enabled&&t.virtual?X.slideEl=wo(t.slidesEl,`.${t.params.slideActiveClass}`)[0]:X.slideEl=t.slides[t.activeIndex]);let dl=X.slideEl.querySelector(`.${li.containerClass}`);dl&&(dl=dl.querySelectorAll("picture, img, svg, canvas, .swiper-zoom-target")[0]),X.imageEl=dl,dl?X.imageWrapEl=nd(X.imageEl,`.${li.containerClass}`)[0]:X.imageWrapEl=void 0}if(!X.imageEl||!X.imageWrapEl)return;t.params.cssMode&&(t.wrapperEl.style.overflow="hidden",t.wrapperEl.style.touchAction="none"),X.slideEl.classList.add(`${li.zoomedSlideClass}`);let ce,Xr,fa,ma,At,To,mr,ho,Qi,Ur,ga,Ya,Za,ll,qi,Vo,Os,cl;typeof ee.touchesStart.x>"u"&&Qt?(ce=Qt.pageX,Xr=Qt.pageY):(ce=ee.touchesStart.x,Xr=ee.touchesStart.y);let Io=y,Oa=typeof Qt=="number"?Qt:null;y===1&&Oa&&(ce=void 0,Xr=void 0,ee.touchesStart.x=void 0,ee.touchesStart.y=void 0);let ps=Te();Xt.scale=Oa||ps,y=Oa||ps,Qt&&!(y===1&&Oa)?(Os=X.slideEl.offsetWidth,cl=X.slideEl.offsetHeight,fa=Um(X.slideEl).left+r.scrollX,ma=Um(X.slideEl).top+r.scrollY,At=fa+Os/2-ce,To=ma+cl/2-Xr,Qi=X.imageEl.offsetWidth||X.imageEl.clientWidth,Ur=X.imageEl.offsetHeight||X.imageEl.clientHeight,ga=Qi*Xt.scale,Ya=Ur*Xt.scale,Za=Math.min(Os/2-ga/2,0),ll=Math.min(cl/2-Ya/2,0),qi=-Za,Vo=-ll,Io>0&&Oa&&typeof ee.currentX=="number"&&typeof ee.currentY=="number"?(mr=ee.currentX*Xt.scale/Io,ho=ee.currentY*Xt.scale/Io):(mr=At*Xt.scale,ho=To*Xt.scale),mr<Za&&(mr=Za),mr>qi&&(mr=qi),ho<ll&&(ho=ll),ho>Vo&&(ho=Vo)):(mr=0,ho=0),Oa&&Xt.scale===1&&(X.originX=0,X.originY=0),ee.currentX=mr,ee.currentY=ho,X.imageWrapEl.style.transitionDuration="300ms",X.imageWrapEl.style.transform=`translate3d(${mr}px, ${ho}px,0)`,X.imageEl.style.transitionDuration="300ms",X.imageEl.style.transform=`translate3d(0,0,0) scale(${Xt.scale})`}function mn(){let Qt=t.zoom,Xt=t.params.zoom;if(!X.slideEl){t.params.virtual&&t.params.virtual.enabled&&t.virtual?X.slideEl=wo(t.slidesEl,`.${t.params.slideActiveClass}`)[0]:X.slideEl=t.slides[t.activeIndex];let li=X.slideEl.querySelector(`.${Xt.containerClass}`);li&&(li=li.querySelectorAll("picture, img, svg, canvas, .swiper-zoom-target")[0]),X.imageEl=li,li?X.imageWrapEl=nd(X.imageEl,`.${Xt.containerClass}`)[0]:X.imageWrapEl=void 0}!X.imageEl||!X.imageWrapEl||(t.params.cssMode&&(t.wrapperEl.style.overflow="",t.wrapperEl.style.touchAction=""),Qt.scale=1,y=1,ee.currentX=void 0,ee.currentY=void 0,ee.touchesStart.x=void 0,ee.touchesStart.y=void 0,X.imageWrapEl.style.transitionDuration="300ms",X.imageWrapEl.style.transform="translate3d(0,0,0)",X.imageEl.style.transitionDuration="300ms",X.imageEl.style.transform="translate3d(0,0,0) scale(1)",X.slideEl.classList.remove(`${Xt.zoomedSlideClass}`),X.slideEl=void 0,X.originX=0,X.originY=0,t.params.zoom.panOnMouseMove&&(B={x:0,y:0},P&&(P=!1,ee.startX=0,ee.startY=0)))}function _i(Qt){let Xt=t.zoom;Xt.scale&&Xt.scale!==1?mn():pi(Qt)}function ro(){let Qt=t.params.passiveListeners?{passive:!0,capture:!1}:!1,Xt=t.params.passiveListeners?{passive:!1,capture:!0}:!0;return{passiveListener:Qt,activeListenerWithCapture:Xt}}function pa(){let Qt=t.zoom;if(Qt.enabled)return;Qt.enabled=!0;let{passiveListener:Xt,activeListenerWithCapture:li}=ro();t.wrapperEl.addEventListener("pointerdown",lt,Xt),t.wrapperEl.addEventListener("pointermove",Ye,li),["pointerup","pointercancel","pointerout"].forEach(ce=>{t.wrapperEl.addEventListener(ce,xt,Xt)}),t.wrapperEl.addEventListener("pointermove",Kt,li)}function Ko(){let Qt=t.zoom;if(!Qt.enabled)return;Qt.enabled=!1;let{passiveListener:Xt,activeListenerWithCapture:li}=ro();t.wrapperEl.removeEventListener("pointerdown",lt,Xt),t.wrapperEl.removeEventListener("pointermove",Ye,li),["pointerup","pointercancel","pointerout"].forEach(ce=>{t.wrapperEl.removeEventListener(ce,xt,Xt)}),t.wrapperEl.removeEventListener("pointermove",Kt,li)}n("init",()=>{t.params.zoom.enabled&&pa()}),n("destroy",()=>{Ko()}),n("touchStart",(Qt,Xt)=>{t.zoom.enabled&&Ot(Xt)}),n("touchEnd",(Qt,Xt)=>{t.zoom.enabled&&oi()}),n("doubleTap",(Qt,Xt)=>{!t.animating&&t.params.zoom.enabled&&t.zoom.enabled&&t.params.zoom.toggle&&_i(Xt)}),n("transitionEnd",()=>{t.zoom.enabled&&t.params.zoom.enabled&&tt()}),n("slideChange",()=>{t.zoom.enabled&&t.params.zoom.enabled&&t.params.cssMode&&tt()}),Object.assign(t.zoom,{enable:pa,disable:Ko,in:pi,out:mn,toggle:_i})}function QH(i){let{swiper:t,extendParams:e,on:n}=i;e({controller:{control:void 0,inverse:!1,by:"slide"}}),t.controller={control:void 0};function s(B,U){let J=function(){let ee,we,Re;return(Ce,Te)=>{for(we=-1,ee=Ce.length;ee-we>1;)Re=ee+we>>1,Ce[Re]<=Te?we=Re:ee=Re;return ee}}();this.x=B,this.y=U,this.lastIndex=B.length-1;let le,re;return this.interpolate=function(ee){return ee?(re=J(this.x,ee),le=re-1,(ee-this.x[le])*(this.y[re]-this.y[le])/(this.x[re]-this.x[le])+this.y[le]):0},this}function r(B){t.controller.spline=t.params.loop?new s(t.slidesGrid,B.slidesGrid):new s(t.snapGrid,B.snapGrid)}function y(B,U){let J=t.controller.control,le,re,X=t.constructor;function ee(we){if(we.destroyed)return;let Re=t.rtlTranslate?-t.translate:t.translate;t.params.controller.by==="slide"&&(r(we),re=-t.controller.spline.interpolate(-Re)),(!re||t.params.controller.by==="container")&&(le=(we.maxTranslate()-we.minTranslate())/(t.maxTranslate()-t.minTranslate()),(Number.isNaN(le)||!Number.isFinite(le))&&(le=1),re=(Re-t.minTranslate())*le+we.minTranslate()),t.params.controller.inverse&&(re=we.maxTranslate()-re),we.updateProgress(re),we.setTranslate(re,t),we.updateActiveIndex(),we.updateSlidesClasses()}if(Array.isArray(J))for(let we=0;we<J.length;we+=1)J[we]!==U&&J[we]instanceof X&&ee(J[we]);else J instanceof X&&U!==J&&ee(J)}function A(B,U){let J=t.constructor,le=t.controller.control,re;function X(ee){ee.destroyed||(ee.setTransition(B,t),B!==0&&(ee.transitionStart(),ee.params.autoHeight&&id(()=>{ee.updateAutoHeight()}),Hp(ee.wrapperEl,()=>{le&&ee.transitionEnd()})))}if(Array.isArray(le))for(re=0;re<le.length;re+=1)le[re]!==U&&le[re]instanceof J&&X(le[re]);else le instanceof J&&U!==le&&X(le)}function P(){t.controller.control&&t.controller.spline&&(t.controller.spline=void 0,delete t.controller.spline)}n("beforeInit",()=>{if(typeof window<"u"&&(typeof t.params.controller.control=="string"||t.params.controller.control instanceof HTMLElement)){(typeof t.params.controller.control=="string"?[...document.querySelectorAll(t.params.controller.control)]:[t.params.controller.control]).forEach(U=>{if(t.controller.control||(t.controller.control=[]),U&&U.swiper)t.controller.control.push(U.swiper);else if(U){let J=`${t.params.eventsPrefix}init`,le=re=>{t.controller.control.push(re.detail[0]),t.update(),U.removeEventListener(J,le)};U.addEventListener(J,le)}});return}t.controller.control=t.params.controller.control}),n("update",()=>{P()}),n("resize",()=>{P()}),n("observerUpdate",()=>{P()}),n("setTranslate",(B,U,J)=>{!t.controller.control||t.controller.control.destroyed||t.controller.setTranslate(U,J)}),n("setTransition",(B,U,J)=>{!t.controller.control||t.controller.control.destroyed||t.controller.setTransition(U,J)}),Object.assign(t.controller,{setTranslate:y,setTransition:A})}function JH(i){let{swiper:t,extendParams:e,on:n}=i;e({a11y:{enabled:!0,notificationClass:"swiper-notification",prevSlideMessage:"Previous slide",nextSlideMessage:"Next slide",firstSlideMessage:"This is the first slide",lastSlideMessage:"This is the last slide",paginationBulletMessage:"Go to slide {{index}}",slideLabelMessage:"{{index}} / {{slidesLength}}",containerMessage:null,containerRoleDescriptionMessage:null,containerRole:null,itemRoleDescriptionMessage:null,slideRole:"group",id:null,scrollOnFocus:!0}}),t.a11y={clicked:!1};let s=null,r,y,A=new Date().getTime();function P(tt){let vt=s;vt.length!==0&&(vt.innerHTML="",vt.innerHTML=tt)}function B(tt){tt===void 0&&(tt=16);let vt=()=>Math.round(16*Math.random()).toString(16);return"x".repeat(tt).replace(/x/g,vt)}function U(tt){tt=Xn(tt),tt.forEach(vt=>{vt.setAttribute("tabIndex","0")})}function J(tt){tt=Xn(tt),tt.forEach(vt=>{vt.setAttribute("tabIndex","-1")})}function le(tt,vt){tt=Xn(tt),tt.forEach(pi=>{pi.setAttribute("role",vt)})}function re(tt,vt){tt=Xn(tt),tt.forEach(pi=>{pi.setAttribute("aria-roledescription",vt)})}function X(tt,vt){tt=Xn(tt),tt.forEach(pi=>{pi.setAttribute("aria-controls",vt)})}function ee(tt,vt){tt=Xn(tt),tt.forEach(pi=>{pi.setAttribute("aria-label",vt)})}function we(tt,vt){tt=Xn(tt),tt.forEach(pi=>{pi.setAttribute("id",vt)})}function Re(tt,vt){tt=Xn(tt),tt.forEach(pi=>{pi.setAttribute("aria-live",vt)})}function Ce(tt){tt=Xn(tt),tt.forEach(vt=>{vt.setAttribute("aria-disabled",!0)})}function Te(tt){tt=Xn(tt),tt.forEach(vt=>{vt.setAttribute("aria-disabled",!1)})}function Xe(tt){if(tt.keyCode!==13&&tt.keyCode!==32)return;let vt=t.params.a11y,pi=tt.target;if(!(t.pagination&&t.pagination.el&&(pi===t.pagination.el||t.pagination.el.contains(tt.target))&&!tt.target.matches(lc(t.params.pagination.bulletClass)))){if(t.navigation&&t.navigation.prevEl&&t.navigation.nextEl){let mn=Xn(t.navigation.prevEl);Xn(t.navigation.nextEl).includes(pi)&&(t.isEnd&&!t.params.loop||t.slideNext(),t.isEnd?P(vt.lastSlideMessage):P(vt.nextSlideMessage)),mn.includes(pi)&&(t.isBeginning&&!t.params.loop||t.slidePrev(),t.isBeginning?P(vt.firstSlideMessage):P(vt.prevSlideMessage))}t.pagination&&pi.matches(lc(t.params.pagination.bulletClass))&&pi.click()}}function et(){if(t.params.loop||t.params.rewind||!t.navigation)return;let{nextEl:tt,prevEl:vt}=t.navigation;vt&&(t.isBeginning?(Ce(vt),J(vt)):(Te(vt),U(vt))),tt&&(t.isEnd?(Ce(tt),J(tt)):(Te(tt),U(tt)))}function Pt(){return t.pagination&&t.pagination.bullets&&t.pagination.bullets.length}function Lt(){return Pt()&&t.params.pagination.clickable}function lt(){let tt=t.params.a11y;Pt()&&t.pagination.bullets.forEach(vt=>{t.params.pagination.clickable&&(U(vt),t.params.pagination.renderBullet||(le(vt,"button"),ee(vt,tt.paginationBulletMessage.replace(/\{\{index\}\}/,Up(vt)+1)))),vt.matches(lc(t.params.pagination.bulletActiveClass))?vt.setAttribute("aria-current","true"):vt.removeAttribute("aria-current")})}let Ye=(tt,vt,pi)=>{U(tt),tt.tagName!=="BUTTON"&&(le(tt,"button"),tt.addEventListener("keydown",Xe)),ee(tt,pi),X(tt,vt)},xt=tt=>{y&&y!==tt.target&&!y.contains(tt.target)&&(r=!0),t.a11y.clicked=!0},Bt=()=>{r=!1,requestAnimationFrame(()=>{requestAnimationFrame(()=>{t.destroyed||(t.a11y.clicked=!1)})})},Ft=tt=>{A=new Date().getTime()},dt=tt=>{if(t.a11y.clicked||!t.params.a11y.scrollOnFocus||new Date().getTime()-A<100)return;let vt=tt.target.closest(`.${t.params.slideClass}, swiper-slide`);if(!vt||!t.slides.includes(vt))return;y=vt;let pi=t.slides.indexOf(vt)===t.activeIndex,mn=t.params.watchSlidesProgress&&t.visibleSlides&&t.visibleSlides.includes(vt);pi||mn||tt.sourceCapabilities&&tt.sourceCapabilities.firesTouchEvents||(t.isHorizontal()?t.el.scrollLeft=0:t.el.scrollTop=0,requestAnimationFrame(()=>{r||(t.params.loop?t.slideToLoop(parseInt(vt.getAttribute("data-swiper-slide-index")),0):t.slideTo(t.slides.indexOf(vt),0),r=!1)}))},Ot=()=>{let tt=t.params.a11y;tt.itemRoleDescriptionMessage&&re(t.slides,tt.itemRoleDescriptionMessage),tt.slideRole&&le(t.slides,tt.slideRole);let vt=t.slides.length;tt.slideLabelMessage&&t.slides.forEach((pi,mn)=>{let _i=t.params.loop?parseInt(pi.getAttribute("data-swiper-slide-index"),10):mn,ro=tt.slideLabelMessage.replace(/\{\{index\}\}/,_i+1).replace(/\{\{slidesLength\}\}/,vt);ee(pi,ro)})},Kt=()=>{let tt=t.params.a11y;t.el.append(s);let vt=t.el;tt.containerRoleDescriptionMessage&&re(vt,tt.containerRoleDescriptionMessage),tt.containerMessage&&ee(vt,tt.containerMessage),tt.containerRole&&le(vt,tt.containerRole);let pi=t.wrapperEl,mn=tt.id||pi.getAttribute("id")||`swiper-wrapper-${B(16)}`,_i=t.params.autoplay&&t.params.autoplay.enabled?"off":"polite";we(pi,mn),Re(pi,_i),Ot();let{nextEl:ro,prevEl:pa}=t.navigation?t.navigation:{};ro=Xn(ro),pa=Xn(pa),ro&&ro.forEach(Qt=>Ye(Qt,mn,tt.nextSlideMessage)),pa&&pa.forEach(Qt=>Ye(Qt,mn,tt.prevSlideMessage)),Lt()&&Xn(t.pagination.el).forEach(Xt=>{Xt.addEventListener("keydown",Xe)}),Zr().addEventListener("visibilitychange",Ft),t.el.addEventListener("focus",dt,!0),t.el.addEventListener("focus",dt,!0),t.el.addEventListener("pointerdown",xt,!0),t.el.addEventListener("pointerup",Bt,!0)};function oi(){s&&s.remove();let{nextEl:tt,prevEl:vt}=t.navigation?t.navigation:{};tt=Xn(tt),vt=Xn(vt),tt&&tt.forEach(mn=>mn.removeEventListener("keydown",Xe)),vt&&vt.forEach(mn=>mn.removeEventListener("keydown",Xe)),Lt()&&Xn(t.pagination.el).forEach(_i=>{_i.removeEventListener("keydown",Xe)}),Zr().removeEventListener("visibilitychange",Ft),t.el&&typeof t.el!="string"&&(t.el.removeEventListener("focus",dt,!0),t.el.removeEventListener("pointerdown",xt,!0),t.el.removeEventListener("pointerup",Bt,!0))}n("beforeInit",()=>{s=ha("span",t.params.a11y.notificationClass),s.setAttribute("aria-live","assertive"),s.setAttribute("aria-atomic","true")}),n("afterInit",()=>{t.params.a11y.enabled&&Kt()}),n("slidesLengthChange snapGridLengthChange slidesGridLengthChange",()=>{t.params.a11y.enabled&&Ot()}),n("fromEdge toEdge afterInit lock unlock",()=>{t.params.a11y.enabled&&et()}),n("paginationUpdate",()=>{t.params.a11y.enabled&&lt()}),n("destroy",()=>{t.params.a11y.enabled&&oi()})}function e8(i){let{swiper:t,extendParams:e,on:n}=i;e({history:{enabled:!1,root:"",replaceState:!1,key:"slides",keepQuery:!1}});let s=!1,r={},y=re=>re.toString().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+/,"").replace(/-+$/,""),A=re=>{let X=Ir(),ee;re?ee=new URL(re):ee=X.location;let we=ee.pathname.slice(1).split("/").filter(Xe=>Xe!==""),Re=we.length,Ce=we[Re-2],Te=we[Re-1];return{key:Ce,value:Te}},P=(re,X)=>{let ee=Ir();if(!s||!t.params.history.enabled)return;let we;t.params.url?we=new URL(t.params.url):we=ee.location;let Re=t.virtual&&t.params.virtual.enabled?t.slidesEl.querySelector(`[data-swiper-slide-index="${X}"]`):t.slides[X],Ce=y(Re.getAttribute("data-history"));if(t.params.history.root.length>0){let Xe=t.params.history.root;Xe[Xe.length-1]==="/"&&(Xe=Xe.slice(0,Xe.length-1)),Ce=`${Xe}/${re?`${re}/`:""}${Ce}`}else we.pathname.includes(re)||(Ce=`${re?`${re}/`:""}${Ce}`);t.params.history.keepQuery&&(Ce+=we.search);let Te=ee.history.state;Te&&Te.value===Ce||(t.params.history.replaceState?ee.history.replaceState({value:Ce},null,Ce):ee.history.pushState({value:Ce},null,Ce))},B=(re,X,ee)=>{if(X)for(let we=0,Re=t.slides.length;we<Re;we+=1){let Ce=t.slides[we];if(y(Ce.getAttribute("data-history"))===X){let Xe=t.getSlideIndex(Ce);t.slideTo(Xe,re,ee)}}else t.slideTo(0,re,ee)},U=()=>{r=A(t.params.url),B(t.params.speed,r.value,!1)},J=()=>{let re=Ir();if(t.params.history){if(!re.history||!re.history.pushState){t.params.history.enabled=!1,t.params.hashNavigation.enabled=!0;return}if(s=!0,r=A(t.params.url),!r.key&&!r.value){t.params.history.replaceState||re.addEventListener("popstate",U);return}B(0,r.value,t.params.runCallbacksOnInit),t.params.history.replaceState||re.addEventListener("popstate",U)}},le=()=>{let re=Ir();t.params.history.replaceState||re.removeEventListener("popstate",U)};n("init",()=>{t.params.history.enabled&&J()}),n("destroy",()=>{t.params.history.enabled&&le()}),n("transitionEnd _freeModeNoMomentumRelease",()=>{s&&P(t.params.history.key,t.activeIndex)}),n("slideChange",()=>{s&&t.params.cssMode&&P(t.params.history.key,t.activeIndex)})}function t8(i){let{swiper:t,extendParams:e,emit:n,on:s}=i,r=!1,y=Zr(),A=Ir();e({hashNavigation:{enabled:!1,replaceState:!1,watchState:!1,getSlideIndex(le,re){if(t.virtual&&t.params.virtual.enabled){let X=t.slides.find(we=>we.getAttribute("data-hash")===re);return X?parseInt(X.getAttribute("data-swiper-slide-index"),10):0}return t.getSlideIndex(wo(t.slidesEl,`.${t.params.slideClass}[data-hash="${re}"], swiper-slide[data-hash="${re}"]`)[0])}}});let P=()=>{n("hashChange");let le=y.location.hash.replace("#",""),re=t.virtual&&t.params.virtual.enabled?t.slidesEl.querySelector(`[data-swiper-slide-index="${t.activeIndex}"]`):t.slides[t.activeIndex],X=re?re.getAttribute("data-hash"):"";if(le!==X){let ee=t.params.hashNavigation.getSlideIndex(t,le);if(typeof ee>"u"||Number.isNaN(ee))return;t.slideTo(ee)}},B=()=>{if(!r||!t.params.hashNavigation.enabled)return;let le=t.virtual&&t.params.virtual.enabled?t.slidesEl.querySelector(`[data-swiper-slide-index="${t.activeIndex}"]`):t.slides[t.activeIndex],re=le?le.getAttribute("data-hash")||le.getAttribute("data-history"):"";t.params.hashNavigation.replaceState&&A.history&&A.history.replaceState?(A.history.replaceState(null,null,`#${re}`||""),n("hashSet")):(y.location.hash=re||"",n("hashSet"))},U=()=>{if(!t.params.hashNavigation.enabled||t.params.history&&t.params.history.enabled)return;r=!0;let le=y.location.hash.replace("#","");if(le){let X=t.params.hashNavigation.getSlideIndex(t,le);t.slideTo(X||0,0,t.params.runCallbacksOnInit,!0)}t.params.hashNavigation.watchState&&A.addEventListener("hashchange",P)},J=()=>{t.params.hashNavigation.watchState&&A.removeEventListener("hashchange",P)};s("init",()=>{t.params.hashNavigation.enabled&&U()}),s("destroy",()=>{t.params.hashNavigation.enabled&&J()}),s("transitionEnd _freeModeNoMomentumRelease",()=>{r&&B()}),s("slideChange",()=>{r&&t.params.cssMode&&B()})}function i8(i){let{swiper:t,extendParams:e,on:n,emit:s,params:r}=i;t.autoplay={running:!1,paused:!1,timeLeft:0},e({autoplay:{enabled:!1,delay:3e3,waitForTransition:!0,disableOnInteraction:!1,stopOnLastSlide:!1,reverseDirection:!1,pauseOnMouseEnter:!1}});let y,A,P=r&&r.autoplay?r.autoplay.delay:3e3,B=r&&r.autoplay?r.autoplay.delay:3e3,U,J=new Date().getTime(),le,re,X,ee,we,Re,Ce;function Te(vt){!t||t.destroyed||!t.wrapperEl||vt.target===t.wrapperEl&&(t.wrapperEl.removeEventListener("transitionend",Te),!(Ce||vt.detail&&vt.detail.bySwiperTouchMove)&&xt())}let Xe=()=>{if(t.destroyed||!t.autoplay.running)return;t.autoplay.paused?le=!0:le&&(B=U,le=!1);let vt=t.autoplay.paused?U:J+B-new Date().getTime();t.autoplay.timeLeft=vt,s("autoplayTimeLeft",vt,vt/P),A=requestAnimationFrame(()=>{Xe()})},et=()=>{let vt;return t.virtual&&t.params.virtual.enabled?vt=t.slides.find(mn=>mn.classList.contains("swiper-slide-active")):vt=t.slides[t.activeIndex],vt?parseInt(vt.getAttribute("data-swiper-autoplay"),10):void 0},Pt=vt=>{if(t.destroyed||!t.autoplay.running)return;cancelAnimationFrame(A),Xe();let pi=typeof vt>"u"?t.params.autoplay.delay:vt;P=t.params.autoplay.delay,B=t.params.autoplay.delay;let mn=et();!Number.isNaN(mn)&&mn>0&&typeof vt>"u"&&(pi=mn,P=mn,B=mn),U=pi;let _i=t.params.speed,ro=()=>{!t||t.destroyed||(t.params.autoplay.reverseDirection?!t.isBeginning||t.params.loop||t.params.rewind?(t.slidePrev(_i,!0,!0),s("autoplay")):t.params.autoplay.stopOnLastSlide||(t.slideTo(t.slides.length-1,_i,!0,!0),s("autoplay")):!t.isEnd||t.params.loop||t.params.rewind?(t.slideNext(_i,!0,!0),s("autoplay")):t.params.autoplay.stopOnLastSlide||(t.slideTo(0,_i,!0,!0),s("autoplay")),t.params.cssMode&&(J=new Date().getTime(),requestAnimationFrame(()=>{Pt()})))};return pi>0?(clearTimeout(y),y=setTimeout(()=>{ro()},pi)):requestAnimationFrame(()=>{ro()}),pi},Lt=()=>{J=new Date().getTime(),t.autoplay.running=!0,Pt(),s("autoplayStart")},lt=()=>{t.autoplay.running=!1,clearTimeout(y),cancelAnimationFrame(A),s("autoplayStop")},Ye=(vt,pi)=>{if(t.destroyed||!t.autoplay.running)return;clearTimeout(y),vt||(Re=!0);let mn=()=>{s("autoplayPause"),t.params.autoplay.waitForTransition?t.wrapperEl.addEventListener("transitionend",Te):xt()};if(t.autoplay.paused=!0,pi){we&&(U=t.params.autoplay.delay),we=!1,mn();return}U=(U||t.params.autoplay.delay)-(new Date().getTime()-J),!(t.isEnd&&U<0&&!t.params.loop)&&(U<0&&(U=0),mn())},xt=()=>{t.isEnd&&U<0&&!t.params.loop||t.destroyed||!t.autoplay.running||(J=new Date().getTime(),Re?(Re=!1,Pt(U)):Pt(),t.autoplay.paused=!1,s("autoplayResume"))},Bt=()=>{if(t.destroyed||!t.autoplay.running)return;let vt=Zr();vt.visibilityState==="hidden"&&(Re=!0,Ye(!0)),vt.visibilityState==="visible"&&xt()},Ft=vt=>{vt.pointerType==="mouse"&&(Re=!0,Ce=!0,!(t.animating||t.autoplay.paused)&&Ye(!0))},dt=vt=>{vt.pointerType==="mouse"&&(Ce=!1,t.autoplay.paused&&xt())},Ot=()=>{t.params.autoplay.pauseOnMouseEnter&&(t.el.addEventListener("pointerenter",Ft),t.el.addEventListener("pointerleave",dt))},Kt=()=>{t.el&&typeof t.el!="string"&&(t.el.removeEventListener("pointerenter",Ft),t.el.removeEventListener("pointerleave",dt))},oi=()=>{Zr().addEventListener("visibilitychange",Bt)},tt=()=>{Zr().removeEventListener("visibilitychange",Bt)};n("init",()=>{t.params.autoplay.enabled&&(Ot(),oi(),Lt())}),n("destroy",()=>{Kt(),tt(),t.autoplay.running&&lt()}),n("_freeModeStaticRelease",()=>{(X||Re)&&xt()}),n("_freeModeNoMomentumRelease",()=>{t.params.autoplay.disableOnInteraction?lt():Ye(!0,!0)}),n("beforeTransitionStart",(vt,pi,mn)=>{t.destroyed||!t.autoplay.running||(mn||!t.params.autoplay.disableOnInteraction?Ye(!0,!0):lt())}),n("sliderFirstMove",()=>{if(!(t.destroyed||!t.autoplay.running)){if(t.params.autoplay.disableOnInteraction){lt();return}re=!0,X=!1,Re=!1,ee=setTimeout(()=>{Re=!0,X=!0,Ye(!0)},200)}}),n("touchEnd",()=>{if(!(t.destroyed||!t.autoplay.running||!re)){if(clearTimeout(ee),clearTimeout(y),t.params.autoplay.disableOnInteraction){X=!1,re=!1;return}X&&t.params.cssMode&&xt(),X=!1,re=!1}}),n("slideChange",()=>{t.destroyed||!t.autoplay.running||(we=!0)}),Object.assign(t.autoplay,{start:Lt,stop:lt,pause:Ye,resume:xt})}function n8(i){let{swiper:t,extendParams:e,on:n}=i;e({thumbs:{swiper:null,multipleActiveThumbs:!0,autoScrollOffset:0,slideThumbActiveClass:"swiper-slide-thumb-active",thumbsContainerClass:"swiper-thumbs"}});let s=!1,r=!1;t.thumbs={swiper:null};function y(){let B=t.thumbs.swiper;if(!B||B.destroyed)return;let U=B.clickedIndex,J=B.clickedSlide;if(J&&J.classList.contains(t.params.thumbs.slideThumbActiveClass)||typeof U>"u"||U===null)return;let le;B.params.loop?le=parseInt(B.clickedSlide.getAttribute("data-swiper-slide-index"),10):le=U,t.params.loop?t.slideToLoop(le):t.slideTo(le)}function A(){let{thumbs:B}=t.params;if(s)return!1;s=!0;let U=t.constructor;if(B.swiper instanceof U){if(B.swiper.destroyed)return s=!1,!1;t.thumbs.swiper=B.swiper,Object.assign(t.thumbs.swiper.originalParams,{watchSlidesProgress:!0,slideToClickedSlide:!1}),Object.assign(t.thumbs.swiper.params,{watchSlidesProgress:!0,slideToClickedSlide:!1}),t.thumbs.swiper.update()}else if(zy(B.swiper)){let J=Object.assign({},B.swiper);Object.assign(J,{watchSlidesProgress:!0,slideToClickedSlide:!1}),t.thumbs.swiper=new U(J),r=!0}return t.thumbs.swiper.el.classList.add(t.params.thumbs.thumbsContainerClass),t.thumbs.swiper.on("tap",y),!0}function P(B){let U=t.thumbs.swiper;if(!U||U.destroyed)return;let J=U.params.slidesPerView==="auto"?U.slidesPerViewDynamic():U.params.slidesPerView,le=1,re=t.params.thumbs.slideThumbActiveClass;if(t.params.slidesPerView>1&&!t.params.centeredSlides&&(le=t.params.slidesPerView),t.params.thumbs.multipleActiveThumbs||(le=1),le=Math.floor(le),U.slides.forEach(we=>we.classList.remove(re)),U.params.loop||U.params.virtual&&U.params.virtual.enabled)for(let we=0;we<le;we+=1)wo(U.slidesEl,`[data-swiper-slide-index="${t.realIndex+we}"]`).forEach(Re=>{Re.classList.add(re)});else for(let we=0;we<le;we+=1)U.slides[t.realIndex+we]&&U.slides[t.realIndex+we].classList.add(re);let X=t.params.thumbs.autoScrollOffset,ee=X&&!U.params.loop;if(t.realIndex!==U.realIndex||ee){let we=U.activeIndex,Re,Ce;if(U.params.loop){let Te=U.slides.find(Xe=>Xe.getAttribute("data-swiper-slide-index")===`${t.realIndex}`);Re=U.slides.indexOf(Te),Ce=t.activeIndex>t.previousIndex?"next":"prev"}else Re=t.realIndex,Ce=Re>t.previousIndex?"next":"prev";ee&&(Re+=Ce==="next"?X:-1*X),U.visibleSlidesIndexes&&U.visibleSlidesIndexes.indexOf(Re)<0&&(U.params.centeredSlides?Re>we?Re=Re-Math.floor(J/2)+1:Re=Re+Math.floor(J/2)-1:Re>we&&U.params.slidesPerGroup,U.slideTo(Re,B?0:void 0))}}n("beforeInit",()=>{let{thumbs:B}=t.params;if(!(!B||!B.swiper))if(typeof B.swiper=="string"||B.swiper instanceof HTMLElement){let U=Zr(),J=()=>{let re=typeof B.swiper=="string"?U.querySelector(B.swiper):B.swiper;if(re&&re.swiper)B.swiper=re.swiper,A(),P(!0);else if(re){let X=`${t.params.eventsPrefix}init`,ee=we=>{B.swiper=we.detail[0],re.removeEventListener(X,ee),A(),P(!0),B.swiper.update(),t.update()};re.addEventListener(X,ee)}return re},le=()=>{if(t.destroyed)return;J()||requestAnimationFrame(le)};requestAnimationFrame(le)}else A(),P(!0)}),n("slideChange update resize observerUpdate",()=>{P()}),n("setTransition",(B,U)=>{let J=t.thumbs.swiper;!J||J.destroyed||J.setTransition(U)}),n("beforeDestroy",()=>{let B=t.thumbs.swiper;!B||B.destroyed||r&&B.destroy()}),Object.assign(t.thumbs,{init:A,update:P})}function r8(i){let{swiper:t,extendParams:e,emit:n,once:s}=i;e({freeMode:{enabled:!1,momentum:!0,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,momentumVelocityRatio:1,sticky:!1,minimumVelocity:.02}});function r(){if(t.params.cssMode)return;let P=t.getTranslate();t.setTranslate(P),t.setTransition(0),t.touchEventsData.velocities.length=0,t.freeMode.onTouchEnd({currentPos:t.rtl?t.translate:-t.translate})}function y(){if(t.params.cssMode)return;let{touchEventsData:P,touches:B}=t;P.velocities.length===0&&P.velocities.push({position:B[t.isHorizontal()?"startX":"startY"],time:P.touchStartTime}),P.velocities.push({position:B[t.isHorizontal()?"currentX":"currentY"],time:Ps()})}function A(P){let{currentPos:B}=P;if(t.params.cssMode)return;let{params:U,wrapperEl:J,rtlTranslate:le,snapGrid:re,touchEventsData:X}=t,we=Ps()-X.touchStartTime;if(B<-t.minTranslate()){t.slideTo(t.activeIndex);return}if(B>-t.maxTranslate()){t.slides.length<re.length?t.slideTo(re.length-1):t.slideTo(t.slides.length-1);return}if(U.freeMode.momentum){if(X.velocities.length>1){let lt=X.velocities.pop(),Ye=X.velocities.pop(),xt=lt.position-Ye.position,Bt=lt.time-Ye.time;t.velocity=xt/Bt,t.velocity/=2,Math.abs(t.velocity)<U.freeMode.minimumVelocity&&(t.velocity=0),(Bt>150||Ps()-lt.time>300)&&(t.velocity=0)}else t.velocity=0;t.velocity*=U.freeMode.momentumVelocityRatio,X.velocities.length=0;let Re=1e3*U.freeMode.momentumRatio,Ce=t.velocity*Re,Te=t.translate+Ce;le&&(Te=-Te);let Xe=!1,et,Pt=Math.abs(t.velocity)*20*U.freeMode.momentumBounceRatio,Lt;if(Te<t.maxTranslate())U.freeMode.momentumBounce?(Te+t.maxTranslate()<-Pt&&(Te=t.maxTranslate()-Pt),et=t.maxTranslate(),Xe=!0,X.allowMomentumBounce=!0):Te=t.maxTranslate(),U.loop&&U.centeredSlides&&(Lt=!0);else if(Te>t.minTranslate())U.freeMode.momentumBounce?(Te-t.minTranslate()>Pt&&(Te=t.minTranslate()+Pt),et=t.minTranslate(),Xe=!0,X.allowMomentumBounce=!0):Te=t.minTranslate(),U.loop&&U.centeredSlides&&(Lt=!0);else if(U.freeMode.sticky){let lt;for(let Ye=0;Ye<re.length;Ye+=1)if(re[Ye]>-Te){lt=Ye;break}Math.abs(re[lt]-Te)<Math.abs(re[lt-1]-Te)||t.swipeDirection==="next"?Te=re[lt]:Te=re[lt-1],Te=-Te}if(Lt&&s("transitionEnd",()=>{t.loopFix()}),t.velocity!==0){if(le?Re=Math.abs((-Te-t.translate)/t.velocity):Re=Math.abs((Te-t.translate)/t.velocity),U.freeMode.sticky){let lt=Math.abs((le?-Te:Te)-t.translate),Ye=t.slidesSizesGrid[t.activeIndex];lt<Ye?Re=U.speed:lt<2*Ye?Re=U.speed*1.5:Re=U.speed*2.5}}else if(U.freeMode.sticky){t.slideToClosest();return}U.freeMode.momentumBounce&&Xe?(t.updateProgress(et),t.setTransition(Re),t.setTranslate(Te),t.transitionStart(!0,t.swipeDirection),t.animating=!0,Hp(J,()=>{!t||t.destroyed||!X.allowMomentumBounce||(n("momentumBounce"),t.setTransition(U.speed),setTimeout(()=>{t.setTranslate(et),Hp(J,()=>{!t||t.destroyed||t.transitionEnd()})},0))})):t.velocity?(n("_freeModeNoMomentumRelease"),t.updateProgress(Te),t.setTransition(Re),t.setTranslate(Te),t.transitionStart(!0,t.swipeDirection),t.animating||(t.animating=!0,Hp(J,()=>{!t||t.destroyed||t.transitionEnd()}))):t.updateProgress(Te),t.updateActiveIndex(),t.updateSlidesClasses()}else if(U.freeMode.sticky){t.slideToClosest();return}else U.freeMode&&n("_freeModeNoMomentumRelease");(!U.freeMode.momentum||we>=U.longSwipesMs)&&(n("_freeModeStaticRelease"),t.updateProgress(),t.updateActiveIndex(),t.updateSlidesClasses())}Object.assign(t,{freeMode:{onTouchStart:r,onTouchMove:y,onTouchEnd:A}})}function o8(i){let{swiper:t,extendParams:e,on:n}=i;e({grid:{rows:1,fill:"column"}});let s,r,y,A,P=()=>{let ee=t.params.spaceBetween;return typeof ee=="string"&&ee.indexOf("%")>=0?ee=parseFloat(ee.replace("%",""))/100*t.size:typeof ee=="string"&&(ee=parseFloat(ee)),ee},B=ee=>{let{slidesPerView:we}=t.params,{rows:Re,fill:Ce}=t.params.grid,Te=t.virtual&&t.params.virtual.enabled?t.virtual.slides.length:ee.length;y=Math.floor(Te/Re),Math.floor(Te/Re)===Te/Re?s=Te:s=Math.ceil(Te/Re)*Re,we!=="auto"&&Ce==="row"&&(s=Math.max(s,we*Re)),r=s/Re},U=()=>{t.slides&&t.slides.forEach(ee=>{ee.swiperSlideGridSet&&(ee.style.height="",ee.style[t.getDirectionLabel("margin-top")]="")})},J=(ee,we,Re)=>{let{slidesPerGroup:Ce}=t.params,Te=P(),{rows:Xe,fill:et}=t.params.grid,Pt=t.virtual&&t.params.virtual.enabled?t.virtual.slides.length:Re.length,Lt,lt,Ye;if(et==="row"&&Ce>1){let xt=Math.floor(ee/(Ce*Xe)),Bt=ee-Xe*Ce*xt,Ft=xt===0?Ce:Math.min(Math.ceil((Pt-xt*Xe*Ce)/Xe),Ce);Ye=Math.floor(Bt/Ft),lt=Bt-Ye*Ft+xt*Ce,Lt=lt+Ye*s/Xe,we.style.order=Lt}else et==="column"?(lt=Math.floor(ee/Xe),Ye=ee-lt*Xe,(lt>y||lt===y&&Ye===Xe-1)&&(Ye+=1,Ye>=Xe&&(Ye=0,lt+=1))):(Ye=Math.floor(ee/r),lt=ee-Ye*r);we.row=Ye,we.column=lt,we.style.height=`calc((100% - ${(Xe-1)*Te}px) / ${Xe})`,we.style[t.getDirectionLabel("margin-top")]=Ye!==0?Te&&`${Te}px`:"",we.swiperSlideGridSet=!0},le=(ee,we)=>{let{centeredSlides:Re,roundLengths:Ce}=t.params,Te=P(),{rows:Xe}=t.params.grid;if(t.virtualSize=(ee+Te)*s,t.virtualSize=Math.ceil(t.virtualSize/Xe)-Te,t.params.cssMode||(t.wrapperEl.style[t.getDirectionLabel("width")]=`${t.virtualSize+Te}px`),Re){let et=[];for(let Pt=0;Pt<we.length;Pt+=1){let Lt=we[Pt];Ce&&(Lt=Math.floor(Lt)),we[Pt]<t.virtualSize+we[0]&&et.push(Lt)}we.splice(0,we.length),we.push(...et)}},re=()=>{A=t.params.grid&&t.params.grid.rows>1},X=()=>{let{params:ee,el:we}=t,Re=ee.grid&&ee.grid.rows>1;A&&!Re?(we.classList.remove(`${ee.containerModifierClass}grid`,`${ee.containerModifierClass}grid-column`),y=1,t.emitContainerClasses()):!A&&Re&&(we.classList.add(`${ee.containerModifierClass}grid`),ee.grid.fill==="column"&&we.classList.add(`${ee.containerModifierClass}grid-column`),t.emitContainerClasses()),A=Re};n("init",re),n("update",X),t.grid={initSlides:B,unsetSlides:U,updateSlide:J,updateWrapperSize:le}}function _ce(i){let t=this,{params:e,slidesEl:n}=t;e.loop&&t.loopDestroy();let s=r=>{if(typeof r=="string"){let y=document.createElement("div");y.innerHTML=r,n.append(y.children[0]),y.innerHTML=""}else n.append(r)};if(typeof i=="object"&&"length"in i)for(let r=0;r<i.length;r+=1)i[r]&&s(i[r]);else s(i);t.recalcSlides(),e.loop&&t.loopCreate(),(!e.observer||t.isElement)&&t.update()}function yce(i){let t=this,{params:e,activeIndex:n,slidesEl:s}=t;e.loop&&t.loopDestroy();let r=n+1,y=A=>{if(typeof A=="string"){let P=document.createElement("div");P.innerHTML=A,s.prepend(P.children[0]),P.innerHTML=""}else s.prepend(A)};if(typeof i=="object"&&"length"in i){for(let A=0;A<i.length;A+=1)i[A]&&y(i[A]);r=n+i.length}else y(i);t.recalcSlides(),e.loop&&t.loopCreate(),(!e.observer||t.isElement)&&t.update(),t.slideTo(r,0,!1)}function vce(i,t){let e=this,{params:n,activeIndex:s,slidesEl:r}=e,y=s;n.loop&&(y-=e.loopedSlides,e.loopDestroy(),e.recalcSlides());let A=e.slides.length;if(i<=0){e.prependSlide(t);return}if(i>=A){e.appendSlide(t);return}let P=y>i?y+1:y,B=[];for(let U=A-1;U>=i;U-=1){let J=e.slides[U];J.remove(),B.unshift(J)}if(typeof t=="object"&&"length"in t){for(let U=0;U<t.length;U+=1)t[U]&&r.append(t[U]);P=y>i?y+t.length:y}else r.append(t);for(let U=0;U<B.length;U+=1)r.append(B[U]);e.recalcSlides(),n.loop&&e.loopCreate(),(!n.observer||e.isElement)&&e.update(),n.loop?e.slideTo(P+e.loopedSlides,0,!1):e.slideTo(P,0,!1)}function bce(i){let t=this,{params:e,activeIndex:n}=t,s=n;e.loop&&(s-=t.loopedSlides,t.loopDestroy());let r=s,y;if(typeof i=="object"&&"length"in i){for(let A=0;A<i.length;A+=1)y=i[A],t.slides[y]&&t.slides[y].remove(),y<r&&(r-=1);r=Math.max(r,0)}else y=i,t.slides[y]&&t.slides[y].remove(),y<r&&(r-=1),r=Math.max(r,0);t.recalcSlides(),e.loop&&t.loopCreate(),(!e.observer||t.isElement)&&t.update(),e.loop?t.slideTo(r+t.loopedSlides,0,!1):t.slideTo(r,0,!1)}function xce(){let i=this,t=[];for(let e=0;e<i.slides.length;e+=1)t.push(e);i.removeSlide(t)}function a8(i){let{swiper:t}=i;Object.assign(t,{appendSlide:_ce.bind(t),prependSlide:yce.bind(t),addSlide:vce.bind(t),removeSlide:bce.bind(t),removeAllSlides:xce.bind(t)})}function cc(i){let{effect:t,swiper:e,on:n,setTranslate:s,setTransition:r,overwriteParams:y,perspective:A,recreateShadows:P,getEffectParams:B}=i;n("beforeInit",()=>{if(e.params.effect!==t)return;e.classNames.push(`${e.params.containerModifierClass}${t}`),A&&A()&&e.classNames.push(`${e.params.containerModifierClass}3d`);let J=y?y():{};Object.assign(e.params,J),Object.assign(e.originalParams,J)}),n("setTranslate",()=>{e.params.effect===t&&s()}),n("setTransition",(J,le)=>{e.params.effect===t&&r(le)}),n("transitionEnd",()=>{if(e.params.effect===t&&P){if(!B||!B().slideShadows)return;e.slides.forEach(J=>{J.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(le=>le.remove())}),P()}});let U;n("virtualUpdate",()=>{e.params.effect===t&&(e.slides.length||(U=!0),requestAnimationFrame(()=>{U&&e.slides&&e.slides.length&&(s(),U=!1)}))})}function Yd(i,t){let e=sl(t);return e!==t&&(e.style.backfaceVisibility="hidden",e.style["-webkit-backface-visibility"]="hidden"),e}function qp(i){let{swiper:t,duration:e,transformElements:n,allSlides:s}=i,{activeIndex:r}=t,y=A=>A.parentElement?A.parentElement:t.slides.find(B=>B.shadowRoot&&B.shadowRoot===A.parentNode);if(t.params.virtualTranslate&&e!==0){let A=!1,P;s?P=n:P=n.filter(B=>{let U=B.classList.contains("swiper-slide-transform")?y(B):B;return t.getSlideIndex(U)===r}),P.forEach(B=>{Hp(B,()=>{if(A||!t||t.destroyed)return;A=!0,t.animating=!1;let U=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0});t.wrapperEl.dispatchEvent(U)})})}}function s8(i){let{swiper:t,extendParams:e,on:n}=i;e({fadeEffect:{crossFade:!1}}),cc({effect:"fade",swiper:t,on:n,setTranslate:()=>{let{slides:y}=t,A=t.params.fadeEffect;for(let P=0;P<y.length;P+=1){let B=t.slides[P],J=-B.swiperSlideOffset;t.params.virtualTranslate||(J-=t.translate);let le=0;t.isHorizontal()||(le=J,J=0);let re=t.params.fadeEffect.crossFade?Math.max(1-Math.abs(B.progress),0):1+Math.min(Math.max(B.progress,-1),0),X=Yd(A,B);X.style.opacity=re,X.style.transform=`translate3d(${J}px, ${le}px, 0px)`}},setTransition:y=>{let A=t.slides.map(P=>sl(P));A.forEach(P=>{P.style.transitionDuration=`${y}ms`}),qp({swiper:t,duration:y,transformElements:A,allSlides:!0})},overwriteParams:()=>({slidesPerView:1,slidesPerGroup:1,watchSlidesProgress:!0,spaceBetween:0,virtualTranslate:!t.params.cssMode})})}function l8(i){let{swiper:t,extendParams:e,on:n}=i;e({cubeEffect:{slideShadows:!0,shadow:!0,shadowOffset:20,shadowScale:.94}});let s=(P,B,U)=>{let J=U?P.querySelector(".swiper-slide-shadow-left"):P.querySelector(".swiper-slide-shadow-top"),le=U?P.querySelector(".swiper-slide-shadow-right"):P.querySelector(".swiper-slide-shadow-bottom");J||(J=ha("div",`swiper-slide-shadow-cube swiper-slide-shadow-${U?"left":"top"}`.split(" ")),P.append(J)),le||(le=ha("div",`swiper-slide-shadow-cube swiper-slide-shadow-${U?"right":"bottom"}`.split(" ")),P.append(le)),J&&(J.style.opacity=Math.max(-B,0)),le&&(le.style.opacity=Math.max(B,0))};cc({effect:"cube",swiper:t,on:n,setTranslate:()=>{let{el:P,wrapperEl:B,slides:U,width:J,height:le,rtlTranslate:re,size:X,browser:ee}=t,we=$p(t),Re=t.params.cubeEffect,Ce=t.isHorizontal(),Te=t.virtual&&t.params.virtual.enabled,Xe=0,et;Re.shadow&&(Ce?(et=t.wrapperEl.querySelector(".swiper-cube-shadow"),et||(et=ha("div","swiper-cube-shadow"),t.wrapperEl.append(et)),et.style.height=`${J}px`):(et=P.querySelector(".swiper-cube-shadow"),et||(et=ha("div","swiper-cube-shadow"),P.append(et))));for(let Lt=0;Lt<U.length;Lt+=1){let lt=U[Lt],Ye=Lt;Te&&(Ye=parseInt(lt.getAttribute("data-swiper-slide-index"),10));let xt=Ye*90,Bt=Math.floor(xt/360);re&&(xt=-xt,Bt=Math.floor(-xt/360));let Ft=Math.max(Math.min(lt.progress,1),-1),dt=0,Ot=0,Kt=0;Ye%4===0?(dt=-Bt*4*X,Kt=0):(Ye-1)%4===0?(dt=0,Kt=-Bt*4*X):(Ye-2)%4===0?(dt=X+Bt*4*X,Kt=X):(Ye-3)%4===0&&(dt=-X,Kt=3*X+X*4*Bt),re&&(dt=-dt),Ce||(Ot=dt,dt=0);let oi=`rotateX(${we(Ce?0:-xt)}deg) rotateY(${we(Ce?xt:0)}deg) translate3d(${dt}px, ${Ot}px, ${Kt}px)`;Ft<=1&&Ft>-1&&(Xe=Ye*90+Ft*90,re&&(Xe=-Ye*90-Ft*90)),lt.style.transform=oi,Re.slideShadows&&s(lt,Ft,Ce)}if(B.style.transformOrigin=`50% 50% -${X/2}px`,B.style["-webkit-transform-origin"]=`50% 50% -${X/2}px`,Re.shadow)if(Ce)et.style.transform=`translate3d(0px, ${J/2+Re.shadowOffset}px, ${-J/2}px) rotateX(89.99deg) rotateZ(0deg) scale(${Re.shadowScale})`;else{let Lt=Math.abs(Xe)-Math.floor(Math.abs(Xe)/90)*90,lt=1.5-(Math.sin(Lt*2*Math.PI/360)/2+Math.cos(Lt*2*Math.PI/360)/2),Ye=Re.shadowScale,xt=Re.shadowScale/lt,Bt=Re.shadowOffset;et.style.transform=`scale3d(${Ye}, 1, ${xt}) translate3d(0px, ${le/2+Bt}px, ${-le/2/xt}px) rotateX(-89.99deg)`}let Pt=(ee.isSafari||ee.isWebView)&&ee.needPerspectiveFix?-X/2:0;B.style.transform=`translate3d(0px,0,${Pt}px) rotateX(${we(t.isHorizontal()?0:Xe)}deg) rotateY(${we(t.isHorizontal()?-Xe:0)}deg)`,B.style.setProperty("--swiper-cube-translate-z",`${Pt}px`)},setTransition:P=>{let{el:B,slides:U}=t;if(U.forEach(J=>{J.style.transitionDuration=`${P}ms`,J.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(le=>{le.style.transitionDuration=`${P}ms`})}),t.params.cubeEffect.shadow&&!t.isHorizontal()){let J=B.querySelector(".swiper-cube-shadow");J&&(J.style.transitionDuration=`${P}ms`)}},recreateShadows:()=>{let P=t.isHorizontal();t.slides.forEach(B=>{let U=Math.max(Math.min(B.progress,1),-1);s(B,U,P)})},getEffectParams:()=>t.params.cubeEffect,perspective:()=>!0,overwriteParams:()=>({slidesPerView:1,slidesPerGroup:1,watchSlidesProgress:!0,resistanceRatio:0,spaceBetween:0,centeredSlides:!1,virtualTranslate:!0})})}function Zd(i,t,e){let n=`swiper-slide-shadow${e?`-${e}`:""}${i?` swiper-slide-shadow-${i}`:""}`,s=sl(t),r=s.querySelector(`.${n.split(" ").join(".")}`);return r||(r=ha("div",n.split(" ")),s.append(r)),r}function c8(i){let{swiper:t,extendParams:e,on:n}=i;e({flipEffect:{slideShadows:!0,limitRotation:!0}});let s=(P,B)=>{let U=t.isHorizontal()?P.querySelector(".swiper-slide-shadow-left"):P.querySelector(".swiper-slide-shadow-top"),J=t.isHorizontal()?P.querySelector(".swiper-slide-shadow-right"):P.querySelector(".swiper-slide-shadow-bottom");U||(U=Zd("flip",P,t.isHorizontal()?"left":"top")),J||(J=Zd("flip",P,t.isHorizontal()?"right":"bottom")),U&&(U.style.opacity=Math.max(-B,0)),J&&(J.style.opacity=Math.max(B,0))};cc({effect:"flip",swiper:t,on:n,setTranslate:()=>{let{slides:P,rtlTranslate:B}=t,U=t.params.flipEffect,J=$p(t);for(let le=0;le<P.length;le+=1){let re=P[le],X=re.progress;t.params.flipEffect.limitRotation&&(X=Math.max(Math.min(re.progress,1),-1));let ee=re.swiperSlideOffset,Re=-180*X,Ce=0,Te=t.params.cssMode?-ee-t.translate:-ee,Xe=0;t.isHorizontal()?B&&(Re=-Re):(Xe=Te,Te=0,Ce=-Re,Re=0),re.style.zIndex=-Math.abs(Math.round(X))+P.length,U.slideShadows&&s(re,X);let et=`translate3d(${Te}px, ${Xe}px, 0px) rotateX(${J(Ce)}deg) rotateY(${J(Re)}deg)`,Pt=Yd(U,re);Pt.style.transform=et}},setTransition:P=>{let B=t.slides.map(U=>sl(U));B.forEach(U=>{U.style.transitionDuration=`${P}ms`,U.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(J=>{J.style.transitionDuration=`${P}ms`})}),qp({swiper:t,duration:P,transformElements:B})},recreateShadows:()=>{t.params.flipEffect,t.slides.forEach(P=>{let B=P.progress;t.params.flipEffect.limitRotation&&(B=Math.max(Math.min(P.progress,1),-1)),s(P,B)})},getEffectParams:()=>t.params.flipEffect,perspective:()=>!0,overwriteParams:()=>({slidesPerView:1,slidesPerGroup:1,watchSlidesProgress:!0,spaceBetween:0,virtualTranslate:!t.params.cssMode})})}function d8(i){let{swiper:t,extendParams:e,on:n}=i;e({coverflowEffect:{rotate:50,stretch:0,depth:100,scale:1,modifier:1,slideShadows:!0}}),cc({effect:"coverflow",swiper:t,on:n,setTranslate:()=>{let{width:y,height:A,slides:P,slidesSizesGrid:B}=t,U=t.params.coverflowEffect,J=t.isHorizontal(),le=t.translate,re=J?-le+y/2:-le+A/2,X=J?U.rotate:-U.rotate,ee=U.depth,we=$p(t);for(let Re=0,Ce=P.length;Re<Ce;Re+=1){let Te=P[Re],Xe=B[Re],et=Te.swiperSlideOffset,Pt=(re-et-Xe/2)/Xe,Lt=typeof U.modifier=="function"?U.modifier(Pt):Pt*U.modifier,lt=J?X*Lt:0,Ye=J?0:X*Lt,xt=-ee*Math.abs(Lt),Bt=U.stretch;typeof Bt=="string"&&Bt.indexOf("%")!==-1&&(Bt=parseFloat(U.stretch)/100*Xe);let Ft=J?0:Bt*Lt,dt=J?Bt*Lt:0,Ot=1-(1-U.scale)*Math.abs(Lt);Math.abs(dt)<.001&&(dt=0),Math.abs(Ft)<.001&&(Ft=0),Math.abs(xt)<.001&&(xt=0),Math.abs(lt)<.001&&(lt=0),Math.abs(Ye)<.001&&(Ye=0),Math.abs(Ot)<.001&&(Ot=0);let Kt=`translate3d(${dt}px,${Ft}px,${xt}px)  rotateX(${we(Ye)}deg) rotateY(${we(lt)}deg) scale(${Ot})`,oi=Yd(U,Te);if(oi.style.transform=Kt,Te.style.zIndex=-Math.abs(Math.round(Lt))+1,U.slideShadows){let tt=J?Te.querySelector(".swiper-slide-shadow-left"):Te.querySelector(".swiper-slide-shadow-top"),vt=J?Te.querySelector(".swiper-slide-shadow-right"):Te.querySelector(".swiper-slide-shadow-bottom");tt||(tt=Zd("coverflow",Te,J?"left":"top")),vt||(vt=Zd("coverflow",Te,J?"right":"bottom")),tt&&(tt.style.opacity=Lt>0?Lt:0),vt&&(vt.style.opacity=-Lt>0?-Lt:0)}}},setTransition:y=>{t.slides.map(P=>sl(P)).forEach(P=>{P.style.transitionDuration=`${y}ms`,P.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(B=>{B.style.transitionDuration=`${y}ms`})})},perspective:()=>!0,overwriteParams:()=>({watchSlidesProgress:!0})})}function u8(i){let{swiper:t,extendParams:e,on:n}=i;e({creativeEffect:{limitProgress:1,shadowPerProgress:!1,progressMultiplier:1,perspective:!0,prev:{translate:[0,0,0],rotate:[0,0,0],opacity:1,scale:1},next:{translate:[0,0,0],rotate:[0,0,0],opacity:1,scale:1}}});let s=A=>typeof A=="string"?A:`${A}px`;cc({effect:"creative",swiper:t,on:n,setTranslate:()=>{let{slides:A,wrapperEl:P,slidesSizesGrid:B}=t,U=t.params.creativeEffect,{progressMultiplier:J}=U,le=t.params.centeredSlides,re=$p(t);if(le){let X=B[0]/2-t.params.slidesOffsetBefore||0;P.style.transform=`translateX(calc(50% - ${X}px))`}for(let X=0;X<A.length;X+=1){let ee=A[X],we=ee.progress,Re=Math.min(Math.max(ee.progress,-U.limitProgress),U.limitProgress),Ce=Re;le||(Ce=Math.min(Math.max(ee.originalProgress,-U.limitProgress),U.limitProgress));let Te=ee.swiperSlideOffset,Xe=[t.params.cssMode?-Te-t.translate:-Te,0,0],et=[0,0,0],Pt=!1;t.isHorizontal()||(Xe[1]=Xe[0],Xe[0]=0);let Lt={translate:[0,0,0],rotate:[0,0,0],scale:1,opacity:1};Re<0?(Lt=U.next,Pt=!0):Re>0&&(Lt=U.prev,Pt=!0),Xe.forEach((Ot,Kt)=>{Xe[Kt]=`calc(${Ot}px + (${s(Lt.translate[Kt])} * ${Math.abs(Re*J)}))`}),et.forEach((Ot,Kt)=>{let oi=Lt.rotate[Kt]*Math.abs(Re*J);et[Kt]=oi}),ee.style.zIndex=-Math.abs(Math.round(we))+A.length;let lt=Xe.join(", "),Ye=`rotateX(${re(et[0])}deg) rotateY(${re(et[1])}deg) rotateZ(${re(et[2])}deg)`,xt=Ce<0?`scale(${1+(1-Lt.scale)*Ce*J})`:`scale(${1-(1-Lt.scale)*Ce*J})`,Bt=Ce<0?1+(1-Lt.opacity)*Ce*J:1-(1-Lt.opacity)*Ce*J,Ft=`translate3d(${lt}) ${Ye} ${xt}`;if(Pt&&Lt.shadow||!Pt){let Ot=ee.querySelector(".swiper-slide-shadow");if(!Ot&&Lt.shadow&&(Ot=Zd("creative",ee)),Ot){let Kt=U.shadowPerProgress?Re*(1/U.limitProgress):Re;Ot.style.opacity=Math.min(Math.max(Math.abs(Kt),0),1)}}let dt=Yd(U,ee);dt.style.transform=Ft,dt.style.opacity=Bt,Lt.origin&&(dt.style.transformOrigin=Lt.origin)}},setTransition:A=>{let P=t.slides.map(B=>sl(B));P.forEach(B=>{B.style.transitionDuration=`${A}ms`,B.querySelectorAll(".swiper-slide-shadow").forEach(U=>{U.style.transitionDuration=`${A}ms`})}),qp({swiper:t,duration:A,transformElements:P,allSlides:!0})},perspective:()=>t.params.creativeEffect.perspective,overwriteParams:()=>({watchSlidesProgress:!0,virtualTranslate:!t.params.cssMode})})}function h8(i){let{swiper:t,extendParams:e,on:n}=i;e({cardsEffect:{slideShadows:!0,rotate:!0,perSlideRotate:2,perSlideOffset:8}}),cc({effect:"cards",swiper:t,on:n,setTranslate:()=>{let{slides:y,activeIndex:A,rtlTranslate:P}=t,B=t.params.cardsEffect,{startTranslate:U,isTouched:J}=t.touchEventsData,le=P?-t.translate:t.translate;for(let re=0;re<y.length;re+=1){let X=y[re],ee=X.progress,we=Math.min(Math.max(ee,-4),4),Re=X.swiperSlideOffset;t.params.centeredSlides&&!t.params.cssMode&&(t.wrapperEl.style.transform=`translateX(${t.minTranslate()}px)`),t.params.centeredSlides&&t.params.cssMode&&(Re-=y[0].swiperSlideOffset);let Ce=t.params.cssMode?-Re-t.translate:-Re,Te=0,Xe=-100*Math.abs(we),et=1,Pt=-B.perSlideRotate*we,Lt=B.perSlideOffset-Math.abs(we)*.75,lt=t.virtual&&t.params.virtual.enabled?t.virtual.from+re:re,Ye=(lt===A||lt===A-1)&&we>0&&we<1&&(J||t.params.cssMode)&&le<U,xt=(lt===A||lt===A+1)&&we<0&&we>-1&&(J||t.params.cssMode)&&le>U;if(Ye||xt){let Ot=(1-Math.abs((Math.abs(we)-.5)/.5))**.5;Pt+=-28*we*Ot,et+=-.5*Ot,Lt+=96*Ot,Te=`${-25*Ot*Math.abs(we)}%`}if(we<0?Ce=`calc(${Ce}px ${P?"-":"+"} (${Lt*Math.abs(we)}%))`:we>0?Ce=`calc(${Ce}px ${P?"-":"+"} (-${Lt*Math.abs(we)}%))`:Ce=`${Ce}px`,!t.isHorizontal()){let Ot=Te;Te=Ce,Ce=Ot}let Bt=we<0?`${1+(1-et)*we}`:`${1-(1-et)*we}`,Ft=`
        translate3d(${Ce}, ${Te}, ${Xe}px)
        rotateZ(${B.rotate?P?-Pt:Pt:0}deg)
        scale(${Bt})
      `;if(B.slideShadows){let Ot=X.querySelector(".swiper-slide-shadow");Ot||(Ot=Zd("cards",X)),Ot&&(Ot.style.opacity=Math.min(Math.max((Math.abs(we)-.5)/.5,0),1))}X.style.zIndex=-Math.abs(Math.round(ee))+y.length;let dt=Yd(B,X);dt.style.transform=Ft}},setTransition:y=>{let A=t.slides.map(P=>sl(P));A.forEach(P=>{P.style.transitionDuration=`${y}ms`,P.querySelectorAll(".swiper-slide-shadow").forEach(B=>{B.style.transitionDuration=`${y}ms`})}),qp({swiper:t,duration:y,transformElements:A})},perspective:()=>!0,overwriteParams:()=>({_loopSwapReset:!1,watchSlidesProgress:!0,loopAdditionalSlides:t.params.cardsEffect.rotate?3:2,centeredSlides:!0,virtualTranslate:!t.params.cssMode})})}var wce=[$H,GH,qH,WH,YH,ZH,XH,KH,QH,JH,e8,t8,i8,n8,r8,o8,a8,s8,l8,c8,d8,u8,h8];Gp.use(wce);var Vy=["eventsPrefix","injectStyles","injectStylesUrls","modules","init","_direction","oneWayMovement","swiperElementNodeName","touchEventsTarget","initialSlide","_speed","cssMode","updateOnWindowResize","resizeObserver","nested","focusableElements","_enabled","_width","_height","preventInteractionOnTransition","userAgent","url","_edgeSwipeDetection","_edgeSwipeThreshold","_freeMode","_autoHeight","setWrapperSize","virtualTranslate","_effect","breakpoints","breakpointsBase","_spaceBetween","_slidesPerView","maxBackfaceHiddenSlides","_grid","_slidesPerGroup","_slidesPerGroupSkip","_slidesPerGroupAuto","_centeredSlides","_centeredSlidesBounds","_slidesOffsetBefore","_slidesOffsetAfter","normalizeSlideIndex","_centerInsufficientSlides","_watchOverflow","roundLengths","touchRatio","touchAngle","simulateTouch","_shortSwipes","_longSwipes","longSwipesRatio","longSwipesMs","_followFinger","allowTouchMove","_threshold","touchMoveStopPropagation","touchStartPreventDefault","touchStartForcePreventDefault","touchReleaseOnEdges","uniqueNavElements","_resistance","_resistanceRatio","_watchSlidesProgress","_grabCursor","preventClicks","preventClicksPropagation","_slideToClickedSlide","_loop","loopAdditionalSlides","loopAddBlankSlides","loopPreventsSliding","_rewind","_allowSlidePrev","_allowSlideNext","_swipeHandler","_noSwiping","noSwipingClass","noSwipingSelector","passiveListeners","containerModifierClass","slideClass","slideActiveClass","slideVisibleClass","slideFullyVisibleClass","slideNextClass","slidePrevClass","slideBlankClass","wrapperClass","lazyPreloaderClass","lazyPreloadPrevNext","runCallbacksOnInit","observer","observeParents","observeSlideChildren","a11y","_autoplay","_controller","coverflowEffect","cubeEffect","fadeEffect","flipEffect","creativeEffect","cardsEffect","hashNavigation","history","keyboard","mousewheel","_navigation","_pagination","parallax","_scrollbar","_thumbs","virtual","zoom","control"];function Hm(i){return typeof i=="object"&&i!==null&&i.constructor&&Object.prototype.toString.call(i).slice(8,-1)==="Object"&&!i.__swiper__}function gM(i,t){let e=["__proto__","constructor","prototype"];Object.keys(t).filter(n=>e.indexOf(n)<0).forEach(n=>{typeof i[n]>"u"?i[n]=t[n]:Hm(t[n])&&Hm(i[n])&&Object.keys(t[n]).length>0?t[n].__swiper__?i[n]=t[n]:gM(i[n],t[n]):i[n]=t[n]})}function p8(i){return i===void 0&&(i={}),i.navigation&&typeof i.navigation.nextEl>"u"&&typeof i.navigation.prevEl>"u"}function f8(i){return i===void 0&&(i={}),i.pagination&&typeof i.pagination.el>"u"}function m8(i){return i===void 0&&(i={}),i.scrollbar&&typeof i.scrollbar.el>"u"}function jy(i){return i===void 0&&(i=""),i.replace(/-[a-z]/g,t=>t.toUpperCase().replace("-",""))}function g8(i){let{swiper:t,slides:e,passedParams:n,changedParams:s,nextEl:r,prevEl:y,scrollbarEl:A,paginationEl:P}=i,B=s.filter(Ye=>Ye!=="children"&&Ye!=="direction"&&Ye!=="wrapperClass"),{params:U,pagination:J,navigation:le,scrollbar:re,virtual:X,thumbs:ee}=t,we,Re,Ce,Te,Xe,et,Pt,Lt;s.includes("thumbs")&&n.thumbs&&n.thumbs.swiper&&!n.thumbs.swiper.destroyed&&U.thumbs&&(!U.thumbs.swiper||U.thumbs.swiper.destroyed)&&(we=!0),s.includes("controller")&&n.controller&&n.controller.control&&U.controller&&!U.controller.control&&(Re=!0),s.includes("pagination")&&n.pagination&&(n.pagination.el||P)&&(U.pagination||U.pagination===!1)&&J&&!J.el&&(Ce=!0),s.includes("scrollbar")&&n.scrollbar&&(n.scrollbar.el||A)&&(U.scrollbar||U.scrollbar===!1)&&re&&!re.el&&(Te=!0),s.includes("navigation")&&n.navigation&&(n.navigation.prevEl||y)&&(n.navigation.nextEl||r)&&(U.navigation||U.navigation===!1)&&le&&!le.prevEl&&!le.nextEl&&(Xe=!0);let lt=Ye=>{t[Ye]&&(t[Ye].destroy(),Ye==="navigation"?(t.isElement&&(t[Ye].prevEl.remove(),t[Ye].nextEl.remove()),U[Ye].prevEl=void 0,U[Ye].nextEl=void 0,t[Ye].prevEl=void 0,t[Ye].nextEl=void 0):(t.isElement&&t[Ye].el.remove(),U[Ye].el=void 0,t[Ye].el=void 0))};s.includes("loop")&&t.isElement&&(U.loop&&!n.loop?et=!0:!U.loop&&n.loop?Pt=!0:Lt=!0),B.forEach(Ye=>{if(Hm(U[Ye])&&Hm(n[Ye]))Object.assign(U[Ye],n[Ye]),(Ye==="navigation"||Ye==="pagination"||Ye==="scrollbar")&&"enabled"in n[Ye]&&!n[Ye].enabled&&lt(Ye);else{let xt=n[Ye];(xt===!0||xt===!1)&&(Ye==="navigation"||Ye==="pagination"||Ye==="scrollbar")?xt===!1&&lt(Ye):U[Ye]=n[Ye]}}),B.includes("controller")&&!Re&&t.controller&&t.controller.control&&U.controller&&U.controller.control&&(t.controller.control=U.controller.control),s.includes("children")&&e&&X&&U.virtual.enabled?(X.slides=e,X.update(!0)):s.includes("virtual")&&X&&U.virtual.enabled&&(e&&(X.slides=e),X.update(!0)),s.includes("children")&&e&&U.loop&&(Lt=!0),we&&ee.init()&&ee.update(!0),Re&&(t.controller.control=U.controller.control),Ce&&(t.isElement&&(!P||typeof P=="string")&&(P=document.createElement("div"),P.classList.add("swiper-pagination"),P.part.add("pagination"),t.el.appendChild(P)),P&&(U.pagination.el=P),J.init(),J.render(),J.update()),Te&&(t.isElement&&(!A||typeof A=="string")&&(A=document.createElement("div"),A.classList.add("swiper-scrollbar"),A.part.add("scrollbar"),t.el.appendChild(A)),A&&(U.scrollbar.el=A),re.init(),re.updateSize(),re.setTranslate()),Xe&&(t.isElement&&((!r||typeof r=="string")&&(r=document.createElement("div"),r.classList.add("swiper-button-next"),r.innerHTML=t.hostEl.constructor.nextButtonSvg,r.part.add("button-next"),t.el.appendChild(r)),(!y||typeof y=="string")&&(y=document.createElement("div"),y.classList.add("swiper-button-prev"),y.innerHTML=t.hostEl.constructor.prevButtonSvg,y.part.add("button-prev"),t.el.appendChild(y))),r&&(U.navigation.nextEl=r),y&&(U.navigation.prevEl=y),le.init(),le.update()),s.includes("allowSlideNext")&&(t.allowSlideNext=n.allowSlideNext),s.includes("allowSlidePrev")&&(t.allowSlidePrev=n.allowSlidePrev),s.includes("direction")&&t.changeDirection(n.direction,!1),(et||Lt)&&t.loopDestroy(),(Pt||Lt)&&t.loopCreate(),t.update()}var _8=i=>{if(parseFloat(i)===Number(i))return Number(i);if(i==="true"||i==="")return!0;if(i==="false")return!1;if(i==="null")return null;if(i!=="undefined"){if(typeof i=="string"&&i.includes("{")&&i.includes("}")&&i.includes('"')){let t;try{t=JSON.parse(i)}catch{t=i}return t}return i}},y8=["a11y","autoplay","controller","cards-effect","coverflow-effect","creative-effect","cube-effect","fade-effect","flip-effect","free-mode","grid","hash-navigation","history","keyboard","mousewheel","navigation","pagination","parallax","scrollbar","thumbs","virtual","zoom"];function gO(i,t,e){let n={},s={};gM(n,mM);let r=[...Vy,"on"],y=r.map(P=>P.replace(/_/,""));r.forEach(P=>{P=P.replace("_",""),typeof i[P]<"u"&&(s[P]=i[P])});let A=[...i.attributes];return typeof t=="string"&&typeof e<"u"&&A.push({name:t,value:Hm(e)?Ct({},e):e}),A.forEach(P=>{let B=y8.find(U=>P.name.startsWith(`${U}-`));if(B){let U=jy(B),J=jy(P.name.split(`${B}-`)[1]);typeof s[U]>"u"&&(s[U]={}),s[U]===!0&&(s[U]={enabled:!0}),s[U][J]=_8(P.value)}else{let U=jy(P.name);if(!y.includes(U))return;let J=_8(P.value);s[U]&&y8.includes(P.name)&&!Hm(J)?(s[U].constructor!==Object&&(s[U]={}),s[U].enabled=!!J):s[U]=J}}),gM(n,s),n.navigation?n.navigation=Ct({prevEl:".swiper-button-prev",nextEl:".swiper-button-next"},n.navigation!==!0?n.navigation:{}):n.navigation===!1&&delete n.navigation,n.scrollbar?n.scrollbar=Ct({el:".swiper-scrollbar"},n.scrollbar!==!0?n.scrollbar:{}):n.scrollbar===!1&&delete n.scrollbar,n.pagination?n.pagination=Ct({el:".swiper-pagination"},n.pagination!==!0?n.pagination:{}):n.pagination===!1&&delete n.pagination,{params:n,passedParams:s}}var Cce=":host{--swiper-theme-color:#007aff}:host{position:relative;display:block;margin-left:auto;margin-right:auto;z-index:1}.swiper{width:100%;height:100%;margin-left:auto;margin-right:auto;position:relative;overflow:hidden;list-style:none;padding:0;z-index:1;display:block}.swiper-vertical>.swiper-wrapper{flex-direction:column}.swiper-wrapper{position:relative;width:100%;height:100%;z-index:1;display:flex;transition-property:transform;transition-timing-function:var(--swiper-wrapper-transition-timing-function,initial);box-sizing:content-box}.swiper-android ::slotted(swiper-slide),.swiper-ios ::slotted(swiper-slide),.swiper-wrapper{transform:translate3d(0px,0,0)}.swiper-horizontal{touch-action:pan-y}.swiper-vertical{touch-action:pan-x}::slotted(swiper-slide){flex-shrink:0;width:100%;height:100%;position:relative;transition-property:transform;display:block}::slotted(.swiper-slide-invisible-blank){visibility:hidden}.swiper-autoheight,.swiper-autoheight ::slotted(swiper-slide){height:auto}.swiper-autoheight .swiper-wrapper{align-items:flex-start;transition-property:transform,height}.swiper-backface-hidden ::slotted(swiper-slide){transform:translateZ(0);-webkit-backface-visibility:hidden;backface-visibility:hidden}.swiper-3d.swiper-css-mode .swiper-wrapper{perspective:1200px}.swiper-3d .swiper-wrapper{transform-style:preserve-3d}.swiper-3d{perspective:1200px}.swiper-3d .swiper-cube-shadow,.swiper-3d ::slotted(swiper-slide){transform-style:preserve-3d}.swiper-css-mode>.swiper-wrapper{overflow:auto;scrollbar-width:none;-ms-overflow-style:none}.swiper-css-mode>.swiper-wrapper::-webkit-scrollbar{display:none}.swiper-css-mode ::slotted(swiper-slide){scroll-snap-align:start start}.swiper-css-mode.swiper-horizontal>.swiper-wrapper{scroll-snap-type:x mandatory}.swiper-css-mode.swiper-vertical>.swiper-wrapper{scroll-snap-type:y mandatory}.swiper-css-mode.swiper-free-mode>.swiper-wrapper{scroll-snap-type:none}.swiper-css-mode.swiper-free-mode ::slotted(swiper-slide){scroll-snap-align:none}.swiper-css-mode.swiper-centered>.swiper-wrapper::before{content:'';flex-shrink:0;order:9999}.swiper-css-mode.swiper-centered ::slotted(swiper-slide){scroll-snap-align:center center;scroll-snap-stop:always}.swiper-css-mode.swiper-centered.swiper-horizontal ::slotted(swiper-slide):first-child{margin-inline-start:var(--swiper-centered-offset-before)}.swiper-css-mode.swiper-centered.swiper-horizontal>.swiper-wrapper::before{height:100%;min-height:1px;width:var(--swiper-centered-offset-after)}.swiper-css-mode.swiper-centered.swiper-vertical ::slotted(swiper-slide):first-child{margin-block-start:var(--swiper-centered-offset-before)}.swiper-css-mode.swiper-centered.swiper-vertical>.swiper-wrapper::before{width:100%;min-width:1px;height:var(--swiper-centered-offset-after)}.swiper-virtual ::slotted(swiper-slide){-webkit-backface-visibility:hidden;transform:translateZ(0)}.swiper-virtual.swiper-css-mode .swiper-wrapper::after{content:'';position:absolute;left:0;top:0;pointer-events:none}.swiper-virtual.swiper-css-mode.swiper-horizontal .swiper-wrapper::after{height:1px;width:var(--swiper-virtual-size)}.swiper-virtual.swiper-css-mode.swiper-vertical .swiper-wrapper::after{width:1px;height:var(--swiper-virtual-size)}:host{--swiper-navigation-size:44px}.swiper-button-next,.swiper-button-prev{position:absolute;top:var(--swiper-navigation-top-offset,50%);width:calc(var(--swiper-navigation-size)/ 44 * 27);height:var(--swiper-navigation-size);margin-top:calc(0px - (var(--swiper-navigation-size)/ 2));z-index:10;cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--swiper-navigation-color,var(--swiper-theme-color))}.swiper-button-next.swiper-button-disabled,.swiper-button-prev.swiper-button-disabled{opacity:.35;cursor:auto;pointer-events:none}.swiper-button-next.swiper-button-hidden,.swiper-button-prev.swiper-button-hidden{opacity:0;cursor:auto;pointer-events:none}.swiper-navigation-disabled .swiper-button-next,.swiper-navigation-disabled .swiper-button-prev{display:none!important}.swiper-button-next svg,.swiper-button-prev svg{width:100%;height:100%;object-fit:contain;transform-origin:center}.swiper-rtl .swiper-button-next svg,.swiper-rtl .swiper-button-prev svg{transform:rotate(180deg)}.swiper-button-prev,.swiper-rtl .swiper-button-next{left:var(--swiper-navigation-sides-offset,10px);right:auto}.swiper-button-next,.swiper-rtl .swiper-button-prev{right:var(--swiper-navigation-sides-offset,10px);left:auto}.swiper-button-lock{display:none}.swiper-pagination{position:absolute;text-align:center;transition:.3s opacity;transform:translate3d(0,0,0);z-index:10}.swiper-pagination.swiper-pagination-hidden{opacity:0}.swiper-pagination-disabled>.swiper-pagination,.swiper-pagination.swiper-pagination-disabled{display:none!important}.swiper-horizontal>.swiper-pagination-bullets,.swiper-pagination-bullets.swiper-pagination-horizontal,.swiper-pagination-custom,.swiper-pagination-fraction{bottom:var(--swiper-pagination-bottom,8px);top:var(--swiper-pagination-top,auto);left:0;width:100%}.swiper-pagination-bullets-dynamic{overflow:hidden;font-size:0}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{transform:scale(.33);position:relative}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active{transform:scale(1)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-main{transform:scale(1)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-prev{transform:scale(.66)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-prev-prev{transform:scale(.33)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-next{transform:scale(.66)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-next-next{transform:scale(.33)}.swiper-pagination-bullet{width:var(--swiper-pagination-bullet-width,var(--swiper-pagination-bullet-size,8px));height:var(--swiper-pagination-bullet-height,var(--swiper-pagination-bullet-size,8px));display:inline-block;border-radius:var(--swiper-pagination-bullet-border-radius,50%);background:var(--swiper-pagination-bullet-inactive-color,#000);opacity:var(--swiper-pagination-bullet-inactive-opacity, .2)}button.swiper-pagination-bullet{border:none;margin:0;padding:0;box-shadow:none;-webkit-appearance:none;appearance:none}.swiper-pagination-clickable .swiper-pagination-bullet{cursor:pointer}.swiper-pagination-bullet:only-child{display:none!important}.swiper-pagination-bullet-active{opacity:var(--swiper-pagination-bullet-opacity, 1);background:var(--swiper-pagination-color,var(--swiper-theme-color))}.swiper-pagination-vertical.swiper-pagination-bullets,.swiper-vertical>.swiper-pagination-bullets{right:var(--swiper-pagination-right,8px);left:var(--swiper-pagination-left,auto);top:50%;transform:translate3d(0px,-50%,0)}.swiper-pagination-vertical.swiper-pagination-bullets .swiper-pagination-bullet,.swiper-vertical>.swiper-pagination-bullets .swiper-pagination-bullet{margin:var(--swiper-pagination-bullet-vertical-gap,6px) 0;display:block}.swiper-pagination-vertical.swiper-pagination-bullets.swiper-pagination-bullets-dynamic,.swiper-vertical>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic{top:50%;transform:translateY(-50%);width:8px}.swiper-pagination-vertical.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet,.swiper-vertical>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{display:inline-block;transition:.2s transform,.2s top}.swiper-horizontal>.swiper-pagination-bullets .swiper-pagination-bullet,.swiper-pagination-horizontal.swiper-pagination-bullets .swiper-pagination-bullet{margin:0 var(--swiper-pagination-bullet-horizontal-gap,4px)}.swiper-horizontal>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic,.swiper-pagination-horizontal.swiper-pagination-bullets.swiper-pagination-bullets-dynamic{left:50%;transform:translateX(-50%);white-space:nowrap}.swiper-horizontal>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet,.swiper-pagination-horizontal.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{transition:.2s transform,.2s left}.swiper-horizontal.swiper-rtl>.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{transition:.2s transform,.2s right}.swiper-pagination-fraction{color:var(--swiper-pagination-fraction-color,inherit)}.swiper-pagination-progressbar{background:var(--swiper-pagination-progressbar-bg-color,rgba(0,0,0,.25));position:absolute}.swiper-pagination-progressbar .swiper-pagination-progressbar-fill{background:var(--swiper-pagination-color,var(--swiper-theme-color));position:absolute;left:0;top:0;width:100%;height:100%;transform:scale(0);transform-origin:left top}.swiper-rtl .swiper-pagination-progressbar .swiper-pagination-progressbar-fill{transform-origin:right top}.swiper-horizontal>.swiper-pagination-progressbar,.swiper-pagination-progressbar.swiper-pagination-horizontal,.swiper-pagination-progressbar.swiper-pagination-vertical.swiper-pagination-progressbar-opposite,.swiper-vertical>.swiper-pagination-progressbar.swiper-pagination-progressbar-opposite{width:100%;height:var(--swiper-pagination-progressbar-size,4px);left:0;top:0}.swiper-horizontal>.swiper-pagination-progressbar.swiper-pagination-progressbar-opposite,.swiper-pagination-progressbar.swiper-pagination-horizontal.swiper-pagination-progressbar-opposite,.swiper-pagination-progressbar.swiper-pagination-vertical,.swiper-vertical>.swiper-pagination-progressbar{width:var(--swiper-pagination-progressbar-size,4px);height:100%;left:0;top:0}.swiper-pagination-lock{display:none}.swiper-scrollbar{border-radius:var(--swiper-scrollbar-border-radius,10px);position:relative;touch-action:none;background:var(--swiper-scrollbar-bg-color,rgba(0,0,0,.1))}.swiper-scrollbar-disabled>.swiper-scrollbar,.swiper-scrollbar.swiper-scrollbar-disabled{display:none!important}.swiper-horizontal>.swiper-scrollbar,.swiper-scrollbar.swiper-scrollbar-horizontal{position:absolute;left:var(--swiper-scrollbar-sides-offset,1%);bottom:var(--swiper-scrollbar-bottom,4px);top:var(--swiper-scrollbar-top,auto);z-index:50;height:var(--swiper-scrollbar-size,4px);width:calc(100% - 2 * var(--swiper-scrollbar-sides-offset,1%))}.swiper-scrollbar.swiper-scrollbar-vertical,.swiper-vertical>.swiper-scrollbar{position:absolute;left:var(--swiper-scrollbar-left,auto);right:var(--swiper-scrollbar-right,4px);top:var(--swiper-scrollbar-sides-offset,1%);z-index:50;width:var(--swiper-scrollbar-size,4px);height:calc(100% - 2 * var(--swiper-scrollbar-sides-offset,1%))}.swiper-scrollbar-drag{height:100%;width:100%;position:relative;background:var(--swiper-scrollbar-drag-bg-color,rgba(0,0,0,.5));border-radius:var(--swiper-scrollbar-border-radius,10px);left:0;top:0}.swiper-scrollbar-cursor-drag{cursor:move}.swiper-scrollbar-lock{display:none}::slotted(.swiper-slide-zoomed){cursor:move;touch-action:none}.swiper .swiper-notification{position:absolute;left:0;top:0;pointer-events:none;opacity:0;z-index:-1000}.swiper-free-mode>.swiper-wrapper{transition-timing-function:ease-out;margin:0 auto}.swiper-grid>.swiper-wrapper{flex-wrap:wrap}.swiper-grid-column>.swiper-wrapper{flex-wrap:wrap;flex-direction:column}.swiper-fade.swiper-free-mode ::slotted(swiper-slide){transition-timing-function:ease-out}.swiper-fade ::slotted(swiper-slide){pointer-events:none;transition-property:opacity}.swiper-fade ::slotted(swiper-slide) ::slotted(swiper-slide){pointer-events:none}.swiper-fade ::slotted(.swiper-slide-active){pointer-events:auto}.swiper-fade ::slotted(.swiper-slide-active) ::slotted(.swiper-slide-active){pointer-events:auto}.swiper.swiper-cube{overflow:visible}.swiper-cube ::slotted(swiper-slide){pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;z-index:1;visibility:hidden;transform-origin:0 0;width:100%;height:100%}.swiper-cube ::slotted(swiper-slide) ::slotted(swiper-slide){pointer-events:none}.swiper-cube.swiper-rtl ::slotted(swiper-slide){transform-origin:100% 0}.swiper-cube ::slotted(.swiper-slide-active),.swiper-cube ::slotted(.swiper-slide-active) ::slotted(.swiper-slide-active){pointer-events:auto}.swiper-cube ::slotted(.swiper-slide-active),.swiper-cube ::slotted(.swiper-slide-next),.swiper-cube ::slotted(.swiper-slide-prev){pointer-events:auto;visibility:visible}.swiper-cube .swiper-cube-shadow{position:absolute;left:0;bottom:0px;width:100%;height:100%;opacity:.6;z-index:0}.swiper-cube .swiper-cube-shadow:before{content:'';background:#000;position:absolute;left:0;top:0;bottom:0;right:0;filter:blur(50px)}.swiper-cube ::slotted(.swiper-slide-next)+::slotted(swiper-slide){pointer-events:auto;visibility:visible}.swiper.swiper-flip{overflow:visible}.swiper-flip ::slotted(swiper-slide){pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;z-index:1}.swiper-flip ::slotted(swiper-slide) ::slotted(swiper-slide){pointer-events:none}.swiper-flip ::slotted(.swiper-slide-active),.swiper-flip ::slotted(.swiper-slide-active) ::slotted(.swiper-slide-active){pointer-events:auto}.swiper-creative ::slotted(swiper-slide){-webkit-backface-visibility:hidden;backface-visibility:hidden;overflow:hidden;transition-property:transform,opacity,height}.swiper.swiper-cards{overflow:visible}.swiper-cards ::slotted(swiper-slide){transform-origin:center bottom;-webkit-backface-visibility:hidden;backface-visibility:hidden;overflow:hidden}",Ece="::slotted(.swiper-slide-shadow),::slotted(.swiper-slide-shadow-bottom),::slotted(.swiper-slide-shadow-left),::slotted(.swiper-slide-shadow-right),::slotted(.swiper-slide-shadow-top){position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:10}::slotted(.swiper-slide-shadow){background:rgba(0,0,0,.15)}::slotted(.swiper-slide-shadow-left){background-image:linear-gradient(to left,rgba(0,0,0,.5),rgba(0,0,0,0))}::slotted(.swiper-slide-shadow-right){background-image:linear-gradient(to right,rgba(0,0,0,.5),rgba(0,0,0,0))}::slotted(.swiper-slide-shadow-top){background-image:linear-gradient(to top,rgba(0,0,0,.5),rgba(0,0,0,0))}::slotted(.swiper-slide-shadow-bottom){background-image:linear-gradient(to bottom,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-lazy-preloader{animation:swiper-preloader-spin 1s infinite linear;width:42px;height:42px;position:absolute;left:50%;top:50%;margin-left:-21px;margin-top:-21px;z-index:10;transform-origin:50%;box-sizing:border-box;border:4px solid var(--swiper-preloader-color,var(--swiper-theme-color));border-radius:50%;border-top-color:transparent}@keyframes swiper-preloader-spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}::slotted(.swiper-slide-shadow-cube.swiper-slide-shadow-bottom),::slotted(.swiper-slide-shadow-cube.swiper-slide-shadow-left),::slotted(.swiper-slide-shadow-cube.swiper-slide-shadow-right),::slotted(.swiper-slide-shadow-cube.swiper-slide-shadow-top){z-index:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}::slotted(.swiper-slide-shadow-flip.swiper-slide-shadow-bottom),::slotted(.swiper-slide-shadow-flip.swiper-slide-shadow-left),::slotted(.swiper-slide-shadow-flip.swiper-slide-shadow-right),::slotted(.swiper-slide-shadow-flip.swiper-slide-shadow-top){z-index:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}::slotted(.swiper-zoom-container){width:100%;height:100%;display:flex;justify-content:center;align-items:center;text-align:center}::slotted(.swiper-zoom-container)>canvas,::slotted(.swiper-zoom-container)>img,::slotted(.swiper-zoom-container)>svg{max-width:100%;max-height:100%;object-fit:contain}",_O=class{},b8=typeof window>"u"||typeof HTMLElement>"u"?_O:HTMLElement,v8=`<svg width="11" height="20" viewBox="0 0 11 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0.38296 20.0762C0.111788 19.805 0.111788 19.3654 0.38296 19.0942L9.19758 10.2796L0.38296 1.46497C0.111788 1.19379 0.111788 0.754138 0.38296 0.482966C0.654131 0.211794 1.09379 0.211794 1.36496 0.482966L10.4341 9.55214C10.8359 9.9539 10.8359 10.6053 10.4341 11.007L1.36496 20.0762C1.09379 20.3474 0.654131 20.3474 0.38296 20.0762Z" fill="currentColor"/></svg>
    `,x8=(i,t)=>{if(typeof CSSStyleSheet<"u"&&i.adoptedStyleSheets){let e=new CSSStyleSheet;e.replaceSync(t),i.adoptedStyleSheets=[e]}else{let e=document.createElement("style");e.rel="stylesheet",e.textContent=t,i.appendChild(e)}},_M=class extends b8{constructor(){super(),this.attachShadow({mode:"open"})}static get nextButtonSvg(){return v8}static get prevButtonSvg(){return v8.replace("/></svg>",' transform-origin="center" transform="rotate(180)"/></svg>')}cssStyles(){return[Cce,...this.injectStyles&&Array.isArray(this.injectStyles)?this.injectStyles:[]].join(`
`)}cssLinks(){return this.injectStylesUrls||[]}calcSlideSlots(){let t=this.slideSlots||0,e=[...this.querySelectorAll("[slot^=slide-]")].map(n=>parseInt(n.getAttribute("slot").split("slide-")[1],10));if(this.slideSlots=e.length?Math.max(...e)+1:0,!!this.rendered){if(this.slideSlots>t)for(let n=t;n<this.slideSlots;n+=1){let s=document.createElement("swiper-slide");s.setAttribute("part",`slide slide-${n+1}`);let r=document.createElement("slot");r.setAttribute("name",`slide-${n+1}`),s.appendChild(r),this.shadowRoot.querySelector(".swiper-wrapper").appendChild(s)}else if(this.slideSlots<t){let n=this.swiper.slides;for(let s=n.length-1;s>=0;s-=1)s>this.slideSlots&&n[s].remove()}}}render(){if(this.rendered)return;this.calcSlideSlots();let t=this.cssStyles();this.slideSlots>0&&(t=t.replace(/::slotted\(([a-z-0-9.]*)\)/g,"$1")),t.length&&x8(this.shadowRoot,t),this.cssLinks().forEach(n=>{if(this.shadowRoot.querySelector(`link[href="${n}"]`))return;let r=document.createElement("link");r.rel="stylesheet",r.href=n,this.shadowRoot.appendChild(r)});let e=document.createElement("div");e.classList.add("swiper"),e.part="container",e.innerHTML=`
      <slot name="container-start"></slot>
      <div class="swiper-wrapper" part="wrapper">
        <slot></slot>
        ${Array.from({length:this.slideSlots}).map((n,s)=>`
        <swiper-slide part="slide slide-${s}">
          <slot name="slide-${s}"></slot>
        </swiper-slide>
        `).join("")}
      </div>
      <slot name="container-end"></slot>
      ${p8(this.passedParams)?`
        <div part="button-prev" class="swiper-button-prev">${this.constructor.prevButtonSvg}</div>
        <div part="button-next" class="swiper-button-next">${this.constructor.nextButtonSvg}</div>
      `:""}
      ${f8(this.passedParams)?`
        <div part="pagination" class="swiper-pagination"></div>
      `:""}
      ${m8(this.passedParams)?`
        <div part="scrollbar" class="swiper-scrollbar"></div>
      `:""}
    `,this.shadowRoot.appendChild(e),this.rendered=!0}initialize(){var t=this;if(this.swiper&&this.swiper.initialized)return;let{params:e,passedParams:n}=gO(this);this.swiperParams=e,this.passedParams=n,delete this.swiperParams.init,this.render(),this.swiper=new Gp(this.shadowRoot.querySelector(".swiper"),Xi(Ct(Ct({},e.virtual?{}:{observer:!0}),e),{touchEventsTarget:"container",onAny:function(s){s==="observerUpdate"&&t.calcSlideSlots();let r=e.eventsPrefix?`${e.eventsPrefix}${s.toLowerCase()}`:s.toLowerCase();for(var y=arguments.length,A=new Array(y>1?y-1:0),P=1;P<y;P++)A[P-1]=arguments[P];let B=new CustomEvent(r,{detail:A,bubbles:s!=="hashChange",cancelable:!0});t.dispatchEvent(B)}}))}connectedCallback(){this.swiper&&this.swiper.initialized&&this.nested&&this.closest("swiper-slide")&&this.closest("swiper-slide").swiperLoopMoveDOM||this.init===!1||this.getAttribute("init")==="false"||this.initialize()}disconnectedCallback(){this.nested&&this.closest("swiper-slide")&&this.closest("swiper-slide").swiperLoopMoveDOM||this.swiper&&this.swiper.destroy&&this.swiper.destroy()}updateSwiperOnPropChange(t,e){let{params:n,passedParams:s}=gO(this,t,e);this.passedParams=s,this.swiperParams=n,!(this.swiper&&this.swiper.params[t]===e)&&g8(Ct(Ct(Ct({swiper:this.swiper,passedParams:this.passedParams,changedParams:[jy(t)]},t==="navigation"&&s[t]?{prevEl:".swiper-button-prev",nextEl:".swiper-button-next"}:{}),t==="pagination"&&s[t]?{paginationEl:".swiper-pagination"}:{}),t==="scrollbar"&&s[t]?{scrollbarEl:".swiper-scrollbar"}:{}))}attributeChangedCallback(t,e,n){this.swiper&&this.swiper.initialized&&(e==="true"&&n===null&&(n=!1),this.updateSwiperOnPropChange(t,n))}static get observedAttributes(){return Vy.filter(e=>e.includes("_")).map(e=>e.replace(/[A-Z]/g,n=>`-${n}`).replace("_","").toLowerCase())}};Vy.forEach(i=>{i!=="init"&&(i=i.replace("_",""),Object.defineProperty(_M.prototype,i,{configurable:!0,get(){return(this.passedParams||{})[i]},set(t){this.passedParams||(this.passedParams={}),this.passedParams[i]=t,this.swiper&&this.swiper.initialized&&this.updateSwiperOnPropChange(i,t)}}))});var yO=class extends b8{constructor(){super(),this.attachShadow({mode:"open"})}render(){let t=this.lazy||this.getAttribute("lazy")===""||this.getAttribute("lazy")==="true";if(x8(this.shadowRoot,Ece),this.shadowRoot.appendChild(document.createElement("slot")),t){let e=document.createElement("div");e.classList.add("swiper-lazy-preloader"),e.part.add("preloader"),this.shadowRoot.appendChild(e)}}initialize(){this.render()}connectedCallback(){this.swiperLoopMoveDOM||this.initialize()}},w8=()=>{typeof window>"u"||(window.customElements.get("swiper-container")||window.customElements.define("swiper-container",_M),window.customElements.get("swiper-slide")||window.customElements.define("swiper-slide",yO))};typeof window<"u"&&(window.SwiperElementRegisterParams=i=>{Vy.push(...i)});w8();Lk(bD,{providers:[Uk(Hk()),{provide:iS,useClass:pM,multi:!0},y2(TH)]}).catch(i=>console.error(i));
