import './polyfills.server.mjs';
import{a as It,b as ji,d as Ys,e as lz,f as K_,g as cz,h as Go,i as oR,j as OC,k as Mg,l as uz}from"./chunk-S6KH3LOX.mjs";var vv=lz((a4,s4)=>{"use strict";(function(t,i){typeof a4=="object"&&typeof s4<"u"?s4.exports=i():typeof define=="function"&&define.amd?define(i):(t=typeof globalThis<"u"?globalThis:t||self,t.mapboxgl=i())})(a4,function(){"use strict";var t,i,e;function n(r,g){if(!t)t=g;else if(!i)i=g;else{var w="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+t+")(sharedChunk); ("+i+")(sharedChunk); self.onerror = null;",T={};t(T),e=g(T),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(e.workerUrl=window.URL.createObjectURL(new Blob([w],{type:"text/javascript"})))}}n(["exports"],function(r){function g(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var w,T={},k={};function N(){if(w)return k;w=1,Object.defineProperty(k,"__esModule",{value:!0}),k.setMatrixArrayType=function(p){k.ARRAY_TYPE=a=p},k.toRadian=function(p){return p*d},k.equals=function(p,h){return Math.abs(p-h)<=u*Math.max(1,Math.abs(p),Math.abs(h))},k.RANDOM=k.ARRAY_TYPE=k.EPSILON=void 0;var u=1e-6;k.EPSILON=u;var a=typeof Float32Array<"u"?Float32Array:Array;k.ARRAY_TYPE=a;var l=Math.random;k.RANDOM=l;var d=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var p=0,h=arguments.length;h--;)p+=arguments[h]*arguments[h];return Math.sqrt(p)}),k}var V,q={};function Z(){if(V)return q;function u(h){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},u(h)}V=1,Object.defineProperty(q,"__esModule",{value:!0}),q.create=function(){var h=new a.ARRAY_TYPE(4);return a.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0),h[0]=1,h[3]=1,h},q.clone=function(h){var _=new a.ARRAY_TYPE(4);return _[0]=h[0],_[1]=h[1],_[2]=h[2],_[3]=h[3],_},q.copy=function(h,_){return h[0]=_[0],h[1]=_[1],h[2]=_[2],h[3]=_[3],h},q.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h},q.fromValues=function(h,_,x,C){var M=new a.ARRAY_TYPE(4);return M[0]=h,M[1]=_,M[2]=x,M[3]=C,M},q.set=function(h,_,x,C,M){return h[0]=_,h[1]=x,h[2]=C,h[3]=M,h},q.transpose=function(h,_){if(h===_){var x=_[1];h[1]=_[2],h[2]=x}else h[0]=_[0],h[1]=_[2],h[2]=_[1],h[3]=_[3];return h},q.invert=function(h,_){var x=_[0],C=_[1],M=_[2],v=_[3],S=x*v-M*C;return S?(h[0]=v*(S=1/S),h[1]=-C*S,h[2]=-M*S,h[3]=x*S,h):null},q.adjoint=function(h,_){var x=_[0];return h[0]=_[3],h[1]=-_[1],h[2]=-_[2],h[3]=x,h},q.determinant=function(h){return h[0]*h[3]-h[2]*h[1]},q.multiply=d,q.rotate=function(h,_,x){var C=_[0],M=_[1],v=_[2],S=_[3],A=Math.sin(x),D=Math.cos(x);return h[0]=C*D+v*A,h[1]=M*D+S*A,h[2]=C*-A+v*D,h[3]=M*-A+S*D,h},q.scale=function(h,_,x){var C=_[1],M=_[2],v=_[3],S=x[0],A=x[1];return h[0]=_[0]*S,h[1]=C*S,h[2]=M*A,h[3]=v*A,h},q.fromRotation=function(h,_){var x=Math.sin(_),C=Math.cos(_);return h[0]=C,h[1]=x,h[2]=-x,h[3]=C,h},q.fromScaling=function(h,_){return h[0]=_[0],h[1]=0,h[2]=0,h[3]=_[1],h},q.str=function(h){return"mat2("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+")"},q.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3])},q.LDU=function(h,_,x,C){return h[2]=C[2]/C[0],x[0]=C[0],x[1]=C[1],x[3]=C[3]-h[2]*x[1],[h,_,x]},q.add=function(h,_,x){return h[0]=_[0]+x[0],h[1]=_[1]+x[1],h[2]=_[2]+x[2],h[3]=_[3]+x[3],h},q.subtract=p,q.exactEquals=function(h,_){return h[0]===_[0]&&h[1]===_[1]&&h[2]===_[2]&&h[3]===_[3]},q.equals=function(h,_){var x=h[0],C=h[1],M=h[2],v=h[3],S=_[0],A=_[1],D=_[2],I=_[3];return Math.abs(x-S)<=a.EPSILON*Math.max(1,Math.abs(x),Math.abs(S))&&Math.abs(C-A)<=a.EPSILON*Math.max(1,Math.abs(C),Math.abs(A))&&Math.abs(M-D)<=a.EPSILON*Math.max(1,Math.abs(M),Math.abs(D))&&Math.abs(v-I)<=a.EPSILON*Math.max(1,Math.abs(v),Math.abs(I))},q.multiplyScalar=function(h,_,x){return h[0]=_[0]*x,h[1]=_[1]*x,h[2]=_[2]*x,h[3]=_[3]*x,h},q.multiplyScalarAndAdd=function(h,_,x,C){return h[0]=_[0]+x[0]*C,h[1]=_[1]+x[1]*C,h[2]=_[2]+x[2]*C,h[3]=_[3]+x[3]*C,h},q.sub=q.mul=void 0;var a=function(h,_){if(h&&h.__esModule)return h;if(h===null||u(h)!=="object"&&typeof h!="function")return{default:h};var x=l(void 0);if(x&&x.has(h))return x.get(h);var C={},M=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in h)if(v!=="default"&&Object.prototype.hasOwnProperty.call(h,v)){var S=M?Object.getOwnPropertyDescriptor(h,v):null;S&&(S.get||S.set)?Object.defineProperty(C,v,S):C[v]=h[v]}return C.default=h,x&&x.set(h,C),C}(N());function l(h){if(typeof WeakMap!="function")return null;var _=new WeakMap,x=new WeakMap;return(l=function(C){return C?x:_})(h)}function d(h,_,x){var C=_[0],M=_[1],v=_[2],S=_[3],A=x[0],D=x[1],I=x[2],O=x[3];return h[0]=C*A+v*D,h[1]=M*A+S*D,h[2]=C*I+v*O,h[3]=M*I+S*O,h}function p(h,_,x){return h[0]=_[0]-x[0],h[1]=_[1]-x[1],h[2]=_[2]-x[2],h[3]=_[3]-x[3],h}return q.mul=d,q.sub=p,q}var X,te={};function De(){if(X)return te;function u(h){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},u(h)}X=1,Object.defineProperty(te,"__esModule",{value:!0}),te.create=function(){var h=new a.ARRAY_TYPE(6);return a.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[4]=0,h[5]=0),h[0]=1,h[3]=1,h},te.clone=function(h){var _=new a.ARRAY_TYPE(6);return _[0]=h[0],_[1]=h[1],_[2]=h[2],_[3]=h[3],_[4]=h[4],_[5]=h[5],_},te.copy=function(h,_){return h[0]=_[0],h[1]=_[1],h[2]=_[2],h[3]=_[3],h[4]=_[4],h[5]=_[5],h},te.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=0,h[5]=0,h},te.fromValues=function(h,_,x,C,M,v){var S=new a.ARRAY_TYPE(6);return S[0]=h,S[1]=_,S[2]=x,S[3]=C,S[4]=M,S[5]=v,S},te.set=function(h,_,x,C,M,v,S){return h[0]=_,h[1]=x,h[2]=C,h[3]=M,h[4]=v,h[5]=S,h},te.invert=function(h,_){var x=_[0],C=_[1],M=_[2],v=_[3],S=_[4],A=_[5],D=x*v-C*M;return D?(h[0]=v*(D=1/D),h[1]=-C*D,h[2]=-M*D,h[3]=x*D,h[4]=(M*A-v*S)*D,h[5]=(C*S-x*A)*D,h):null},te.determinant=function(h){return h[0]*h[3]-h[1]*h[2]},te.multiply=d,te.rotate=function(h,_,x){var C=_[0],M=_[1],v=_[2],S=_[3],A=_[4],D=_[5],I=Math.sin(x),O=Math.cos(x);return h[0]=C*O+v*I,h[1]=M*O+S*I,h[2]=C*-I+v*O,h[3]=M*-I+S*O,h[4]=A,h[5]=D,h},te.scale=function(h,_,x){var C=_[1],M=_[2],v=_[3],S=_[4],A=_[5],D=x[0],I=x[1];return h[0]=_[0]*D,h[1]=C*D,h[2]=M*I,h[3]=v*I,h[4]=S,h[5]=A,h},te.translate=function(h,_,x){var C=_[0],M=_[1],v=_[2],S=_[3],A=_[4],D=_[5],I=x[0],O=x[1];return h[0]=C,h[1]=M,h[2]=v,h[3]=S,h[4]=C*I+v*O+A,h[5]=M*I+S*O+D,h},te.fromRotation=function(h,_){var x=Math.sin(_),C=Math.cos(_);return h[0]=C,h[1]=x,h[2]=-x,h[3]=C,h[4]=0,h[5]=0,h},te.fromScaling=function(h,_){return h[0]=_[0],h[1]=0,h[2]=0,h[3]=_[1],h[4]=0,h[5]=0,h},te.fromTranslation=function(h,_){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=_[0],h[5]=_[1],h},te.str=function(h){return"mat2d("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+")"},te.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],1)},te.add=function(h,_,x){return h[0]=_[0]+x[0],h[1]=_[1]+x[1],h[2]=_[2]+x[2],h[3]=_[3]+x[3],h[4]=_[4]+x[4],h[5]=_[5]+x[5],h},te.subtract=p,te.multiplyScalar=function(h,_,x){return h[0]=_[0]*x,h[1]=_[1]*x,h[2]=_[2]*x,h[3]=_[3]*x,h[4]=_[4]*x,h[5]=_[5]*x,h},te.multiplyScalarAndAdd=function(h,_,x,C){return h[0]=_[0]+x[0]*C,h[1]=_[1]+x[1]*C,h[2]=_[2]+x[2]*C,h[3]=_[3]+x[3]*C,h[4]=_[4]+x[4]*C,h[5]=_[5]+x[5]*C,h},te.exactEquals=function(h,_){return h[0]===_[0]&&h[1]===_[1]&&h[2]===_[2]&&h[3]===_[3]&&h[4]===_[4]&&h[5]===_[5]},te.equals=function(h,_){var x=h[0],C=h[1],M=h[2],v=h[3],S=h[4],A=h[5],D=_[0],I=_[1],O=_[2],z=_[3],B=_[4],G=_[5];return Math.abs(x-D)<=a.EPSILON*Math.max(1,Math.abs(x),Math.abs(D))&&Math.abs(C-I)<=a.EPSILON*Math.max(1,Math.abs(C),Math.abs(I))&&Math.abs(M-O)<=a.EPSILON*Math.max(1,Math.abs(M),Math.abs(O))&&Math.abs(v-z)<=a.EPSILON*Math.max(1,Math.abs(v),Math.abs(z))&&Math.abs(S-B)<=a.EPSILON*Math.max(1,Math.abs(S),Math.abs(B))&&Math.abs(A-G)<=a.EPSILON*Math.max(1,Math.abs(A),Math.abs(G))},te.sub=te.mul=void 0;var a=function(h,_){if(h&&h.__esModule)return h;if(h===null||u(h)!=="object"&&typeof h!="function")return{default:h};var x=l(void 0);if(x&&x.has(h))return x.get(h);var C={},M=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in h)if(v!=="default"&&Object.prototype.hasOwnProperty.call(h,v)){var S=M?Object.getOwnPropertyDescriptor(h,v):null;S&&(S.get||S.set)?Object.defineProperty(C,v,S):C[v]=h[v]}return C.default=h,x&&x.set(h,C),C}(N());function l(h){if(typeof WeakMap!="function")return null;var _=new WeakMap,x=new WeakMap;return(l=function(C){return C?x:_})(h)}function d(h,_,x){var C=_[0],M=_[1],v=_[2],S=_[3],A=_[4],D=_[5],I=x[0],O=x[1],z=x[2],B=x[3],G=x[4],$=x[5];return h[0]=C*I+v*O,h[1]=M*I+S*O,h[2]=C*z+v*B,h[3]=M*z+S*B,h[4]=C*G+v*$+A,h[5]=M*G+S*$+D,h}function p(h,_,x){return h[0]=_[0]-x[0],h[1]=_[1]-x[1],h[2]=_[2]-x[2],h[3]=_[3]-x[3],h[4]=_[4]-x[4],h[5]=_[5]-x[5],h}return te.mul=d,te.sub=p,te}var _e,he={};function Ce(){if(_e)return he;function u(h){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},u(h)}_e=1,Object.defineProperty(he,"__esModule",{value:!0}),he.create=function(){var h=new a.ARRAY_TYPE(9);return a.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h},he.fromMat4=function(h,_){return h[0]=_[0],h[1]=_[1],h[2]=_[2],h[3]=_[4],h[4]=_[5],h[5]=_[6],h[6]=_[8],h[7]=_[9],h[8]=_[10],h},he.clone=function(h){var _=new a.ARRAY_TYPE(9);return _[0]=h[0],_[1]=h[1],_[2]=h[2],_[3]=h[3],_[4]=h[4],_[5]=h[5],_[6]=h[6],_[7]=h[7],_[8]=h[8],_},he.copy=function(h,_){return h[0]=_[0],h[1]=_[1],h[2]=_[2],h[3]=_[3],h[4]=_[4],h[5]=_[5],h[6]=_[6],h[7]=_[7],h[8]=_[8],h},he.fromValues=function(h,_,x,C,M,v,S,A,D){var I=new a.ARRAY_TYPE(9);return I[0]=h,I[1]=_,I[2]=x,I[3]=C,I[4]=M,I[5]=v,I[6]=S,I[7]=A,I[8]=D,I},he.set=function(h,_,x,C,M,v,S,A,D,I){return h[0]=_,h[1]=x,h[2]=C,h[3]=M,h[4]=v,h[5]=S,h[6]=A,h[7]=D,h[8]=I,h},he.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},he.transpose=function(h,_){if(h===_){var x=_[1],C=_[2],M=_[5];h[1]=_[3],h[2]=_[6],h[3]=x,h[5]=_[7],h[6]=C,h[7]=M}else h[0]=_[0],h[1]=_[3],h[2]=_[6],h[3]=_[1],h[4]=_[4],h[5]=_[7],h[6]=_[2],h[7]=_[5],h[8]=_[8];return h},he.invert=function(h,_){var x=_[0],C=_[1],M=_[2],v=_[3],S=_[4],A=_[5],D=_[6],I=_[7],O=_[8],z=O*S-A*I,B=-O*v+A*D,G=I*v-S*D,$=x*z+C*B+M*G;return $?(h[0]=z*($=1/$),h[1]=(-O*C+M*I)*$,h[2]=(A*C-M*S)*$,h[3]=B*$,h[4]=(O*x-M*D)*$,h[5]=(-A*x+M*v)*$,h[6]=G*$,h[7]=(-I*x+C*D)*$,h[8]=(S*x-C*v)*$,h):null},he.adjoint=function(h,_){var x=_[0],C=_[1],M=_[2],v=_[3],S=_[4],A=_[5],D=_[6],I=_[7],O=_[8];return h[0]=S*O-A*I,h[1]=M*I-C*O,h[2]=C*A-M*S,h[3]=A*D-v*O,h[4]=x*O-M*D,h[5]=M*v-x*A,h[6]=v*I-S*D,h[7]=C*D-x*I,h[8]=x*S-C*v,h},he.determinant=function(h){var _=h[3],x=h[4],C=h[5],M=h[6],v=h[7],S=h[8];return h[0]*(S*x-C*v)+h[1]*(-S*_+C*M)+h[2]*(v*_-x*M)},he.multiply=d,he.translate=function(h,_,x){var C=_[0],M=_[1],v=_[2],S=_[3],A=_[4],D=_[5],I=_[6],O=_[7],z=_[8],B=x[0],G=x[1];return h[0]=C,h[1]=M,h[2]=v,h[3]=S,h[4]=A,h[5]=D,h[6]=B*C+G*S+I,h[7]=B*M+G*A+O,h[8]=B*v+G*D+z,h},he.rotate=function(h,_,x){var C=_[0],M=_[1],v=_[2],S=_[3],A=_[4],D=_[5],I=_[6],O=_[7],z=_[8],B=Math.sin(x),G=Math.cos(x);return h[0]=G*C+B*S,h[1]=G*M+B*A,h[2]=G*v+B*D,h[3]=G*S-B*C,h[4]=G*A-B*M,h[5]=G*D-B*v,h[6]=I,h[7]=O,h[8]=z,h},he.scale=function(h,_,x){var C=x[0],M=x[1];return h[0]=C*_[0],h[1]=C*_[1],h[2]=C*_[2],h[3]=M*_[3],h[4]=M*_[4],h[5]=M*_[5],h[6]=_[6],h[7]=_[7],h[8]=_[8],h},he.fromTranslation=function(h,_){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=_[0],h[7]=_[1],h[8]=1,h},he.fromRotation=function(h,_){var x=Math.sin(_),C=Math.cos(_);return h[0]=C,h[1]=x,h[2]=0,h[3]=-x,h[4]=C,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},he.fromScaling=function(h,_){return h[0]=_[0],h[1]=0,h[2]=0,h[3]=0,h[4]=_[1],h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},he.fromMat2d=function(h,_){return h[0]=_[0],h[1]=_[1],h[2]=0,h[3]=_[2],h[4]=_[3],h[5]=0,h[6]=_[4],h[7]=_[5],h[8]=1,h},he.fromQuat=function(h,_){var x=_[0],C=_[1],M=_[2],v=_[3],S=x+x,A=C+C,D=M+M,I=x*S,O=C*S,z=C*A,B=M*S,G=M*A,$=M*D,H=v*S,K=v*A,ee=v*D;return h[0]=1-z-$,h[3]=O-ee,h[6]=B+K,h[1]=O+ee,h[4]=1-I-$,h[7]=G-H,h[2]=B-K,h[5]=G+H,h[8]=1-I-z,h},he.normalFromMat4=function(h,_){var x=_[0],C=_[1],M=_[2],v=_[3],S=_[4],A=_[5],D=_[6],I=_[7],O=_[8],z=_[9],B=_[10],G=_[11],$=_[12],H=_[13],K=_[14],ee=_[15],ne=x*A-C*S,ve=x*D-M*S,pe=x*I-v*S,fe=C*D-M*A,Fe=C*I-v*A,be=M*I-v*D,Be=O*H-z*$,$e=O*K-B*$,Ue=O*ee-G*$,Ye=z*K-B*H,Ze=z*ee-G*H,rt=B*ee-G*K,Je=ne*rt-ve*Ze+pe*Ye+fe*Ue-Fe*$e+be*Be;return Je?(h[0]=(A*rt-D*Ze+I*Ye)*(Je=1/Je),h[1]=(D*Ue-S*rt-I*$e)*Je,h[2]=(S*Ze-A*Ue+I*Be)*Je,h[3]=(M*Ze-C*rt-v*Ye)*Je,h[4]=(x*rt-M*Ue+v*$e)*Je,h[5]=(C*Ue-x*Ze-v*Be)*Je,h[6]=(H*be-K*Fe+ee*fe)*Je,h[7]=(K*pe-$*be-ee*ve)*Je,h[8]=($*Fe-H*pe+ee*ne)*Je,h):null},he.projection=function(h,_,x){return h[0]=2/_,h[1]=0,h[2]=0,h[3]=0,h[4]=-2/x,h[5]=0,h[6]=-1,h[7]=1,h[8]=1,h},he.str=function(h){return"mat3("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+", "+h[6]+", "+h[7]+", "+h[8]+")"},he.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],h[8])},he.add=function(h,_,x){return h[0]=_[0]+x[0],h[1]=_[1]+x[1],h[2]=_[2]+x[2],h[3]=_[3]+x[3],h[4]=_[4]+x[4],h[5]=_[5]+x[5],h[6]=_[6]+x[6],h[7]=_[7]+x[7],h[8]=_[8]+x[8],h},he.subtract=p,he.multiplyScalar=function(h,_,x){return h[0]=_[0]*x,h[1]=_[1]*x,h[2]=_[2]*x,h[3]=_[3]*x,h[4]=_[4]*x,h[5]=_[5]*x,h[6]=_[6]*x,h[7]=_[7]*x,h[8]=_[8]*x,h},he.multiplyScalarAndAdd=function(h,_,x,C){return h[0]=_[0]+x[0]*C,h[1]=_[1]+x[1]*C,h[2]=_[2]+x[2]*C,h[3]=_[3]+x[3]*C,h[4]=_[4]+x[4]*C,h[5]=_[5]+x[5]*C,h[6]=_[6]+x[6]*C,h[7]=_[7]+x[7]*C,h[8]=_[8]+x[8]*C,h},he.exactEquals=function(h,_){return h[0]===_[0]&&h[1]===_[1]&&h[2]===_[2]&&h[3]===_[3]&&h[4]===_[4]&&h[5]===_[5]&&h[6]===_[6]&&h[7]===_[7]&&h[8]===_[8]},he.equals=function(h,_){var x=h[0],C=h[1],M=h[2],v=h[3],S=h[4],A=h[5],D=h[6],I=h[7],O=h[8],z=_[0],B=_[1],G=_[2],$=_[3],H=_[4],K=_[5],ee=_[6],ne=_[7],ve=_[8];return Math.abs(x-z)<=a.EPSILON*Math.max(1,Math.abs(x),Math.abs(z))&&Math.abs(C-B)<=a.EPSILON*Math.max(1,Math.abs(C),Math.abs(B))&&Math.abs(M-G)<=a.EPSILON*Math.max(1,Math.abs(M),Math.abs(G))&&Math.abs(v-$)<=a.EPSILON*Math.max(1,Math.abs(v),Math.abs($))&&Math.abs(S-H)<=a.EPSILON*Math.max(1,Math.abs(S),Math.abs(H))&&Math.abs(A-K)<=a.EPSILON*Math.max(1,Math.abs(A),Math.abs(K))&&Math.abs(D-ee)<=a.EPSILON*Math.max(1,Math.abs(D),Math.abs(ee))&&Math.abs(I-ne)<=a.EPSILON*Math.max(1,Math.abs(I),Math.abs(ne))&&Math.abs(O-ve)<=a.EPSILON*Math.max(1,Math.abs(O),Math.abs(ve))},he.sub=he.mul=void 0;var a=function(h,_){if(h&&h.__esModule)return h;if(h===null||u(h)!=="object"&&typeof h!="function")return{default:h};var x=l(void 0);if(x&&x.has(h))return x.get(h);var C={},M=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in h)if(v!=="default"&&Object.prototype.hasOwnProperty.call(h,v)){var S=M?Object.getOwnPropertyDescriptor(h,v):null;S&&(S.get||S.set)?Object.defineProperty(C,v,S):C[v]=h[v]}return C.default=h,x&&x.set(h,C),C}(N());function l(h){if(typeof WeakMap!="function")return null;var _=new WeakMap,x=new WeakMap;return(l=function(C){return C?x:_})(h)}function d(h,_,x){var C=_[0],M=_[1],v=_[2],S=_[3],A=_[4],D=_[5],I=_[6],O=_[7],z=_[8],B=x[0],G=x[1],$=x[2],H=x[3],K=x[4],ee=x[5],ne=x[6],ve=x[7],pe=x[8];return h[0]=B*C+G*S+$*I,h[1]=B*M+G*A+$*O,h[2]=B*v+G*D+$*z,h[3]=H*C+K*S+ee*I,h[4]=H*M+K*A+ee*O,h[5]=H*v+K*D+ee*z,h[6]=ne*C+ve*S+pe*I,h[7]=ne*M+ve*A+pe*O,h[8]=ne*v+ve*D+pe*z,h}function p(h,_,x){return h[0]=_[0]-x[0],h[1]=_[1]-x[1],h[2]=_[2]-x[2],h[3]=_[3]-x[3],h[4]=_[4]-x[4],h[5]=_[5]-x[5],h[6]=_[6]-x[6],h[7]=_[7]-x[7],h[8]=_[8]-x[8],h}return he.mul=d,he.sub=p,he}var Pe,ye={};function vt(){if(Pe)return ye;function u(v){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S},u(v)}Pe=1,Object.defineProperty(ye,"__esModule",{value:!0}),ye.create=function(){var v=new a.ARRAY_TYPE(16);return a.ARRAY_TYPE!=Float32Array&&(v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[11]=0,v[12]=0,v[13]=0,v[14]=0),v[0]=1,v[5]=1,v[10]=1,v[15]=1,v},ye.clone=function(v){var S=new a.ARRAY_TYPE(16);return S[0]=v[0],S[1]=v[1],S[2]=v[2],S[3]=v[3],S[4]=v[4],S[5]=v[5],S[6]=v[6],S[7]=v[7],S[8]=v[8],S[9]=v[9],S[10]=v[10],S[11]=v[11],S[12]=v[12],S[13]=v[13],S[14]=v[14],S[15]=v[15],S},ye.copy=function(v,S){return v[0]=S[0],v[1]=S[1],v[2]=S[2],v[3]=S[3],v[4]=S[4],v[5]=S[5],v[6]=S[6],v[7]=S[7],v[8]=S[8],v[9]=S[9],v[10]=S[10],v[11]=S[11],v[12]=S[12],v[13]=S[13],v[14]=S[14],v[15]=S[15],v},ye.fromValues=function(v,S,A,D,I,O,z,B,G,$,H,K,ee,ne,ve,pe){var fe=new a.ARRAY_TYPE(16);return fe[0]=v,fe[1]=S,fe[2]=A,fe[3]=D,fe[4]=I,fe[5]=O,fe[6]=z,fe[7]=B,fe[8]=G,fe[9]=$,fe[10]=H,fe[11]=K,fe[12]=ee,fe[13]=ne,fe[14]=ve,fe[15]=pe,fe},ye.set=function(v,S,A,D,I,O,z,B,G,$,H,K,ee,ne,ve,pe,fe){return v[0]=S,v[1]=A,v[2]=D,v[3]=I,v[4]=O,v[5]=z,v[6]=B,v[7]=G,v[8]=$,v[9]=H,v[10]=K,v[11]=ee,v[12]=ne,v[13]=ve,v[14]=pe,v[15]=fe,v},ye.identity=d,ye.transpose=function(v,S){if(v===S){var A=S[1],D=S[2],I=S[3],O=S[6],z=S[7],B=S[11];v[1]=S[4],v[2]=S[8],v[3]=S[12],v[4]=A,v[6]=S[9],v[7]=S[13],v[8]=D,v[9]=O,v[11]=S[14],v[12]=I,v[13]=z,v[14]=B}else v[0]=S[0],v[1]=S[4],v[2]=S[8],v[3]=S[12],v[4]=S[1],v[5]=S[5],v[6]=S[9],v[7]=S[13],v[8]=S[2],v[9]=S[6],v[10]=S[10],v[11]=S[14],v[12]=S[3],v[13]=S[7],v[14]=S[11],v[15]=S[15];return v},ye.invert=function(v,S){var A=S[0],D=S[1],I=S[2],O=S[3],z=S[4],B=S[5],G=S[6],$=S[7],H=S[8],K=S[9],ee=S[10],ne=S[11],ve=S[12],pe=S[13],fe=S[14],Fe=S[15],be=A*B-D*z,Be=A*G-I*z,$e=A*$-O*z,Ue=D*G-I*B,Ye=D*$-O*B,Ze=I*$-O*G,rt=H*pe-K*ve,Je=H*fe-ee*ve,ot=H*Fe-ne*ve,kt=K*fe-ee*pe,Mt=K*Fe-ne*pe,ni=ee*Fe-ne*fe,Vt=be*ni-Be*Mt+$e*kt+Ue*ot-Ye*Je+Ze*rt;return Vt?(v[0]=(B*ni-G*Mt+$*kt)*(Vt=1/Vt),v[1]=(I*Mt-D*ni-O*kt)*Vt,v[2]=(pe*Ze-fe*Ye+Fe*Ue)*Vt,v[3]=(ee*Ye-K*Ze-ne*Ue)*Vt,v[4]=(G*ot-z*ni-$*Je)*Vt,v[5]=(A*ni-I*ot+O*Je)*Vt,v[6]=(fe*$e-ve*Ze-Fe*Be)*Vt,v[7]=(H*Ze-ee*$e+ne*Be)*Vt,v[8]=(z*Mt-B*ot+$*rt)*Vt,v[9]=(D*ot-A*Mt-O*rt)*Vt,v[10]=(ve*Ye-pe*$e+Fe*be)*Vt,v[11]=(K*$e-H*Ye-ne*be)*Vt,v[12]=(B*Je-z*kt-G*rt)*Vt,v[13]=(A*kt-D*Je+I*rt)*Vt,v[14]=(pe*Be-ve*Ue-fe*be)*Vt,v[15]=(H*Ue-K*Be+ee*be)*Vt,v):null},ye.adjoint=function(v,S){var A=S[0],D=S[1],I=S[2],O=S[3],z=S[4],B=S[5],G=S[6],$=S[7],H=S[8],K=S[9],ee=S[10],ne=S[11],ve=S[12],pe=S[13],fe=S[14],Fe=S[15];return v[0]=B*(ee*Fe-ne*fe)-K*(G*Fe-$*fe)+pe*(G*ne-$*ee),v[1]=-(D*(ee*Fe-ne*fe)-K*(I*Fe-O*fe)+pe*(I*ne-O*ee)),v[2]=D*(G*Fe-$*fe)-B*(I*Fe-O*fe)+pe*(I*$-O*G),v[3]=-(D*(G*ne-$*ee)-B*(I*ne-O*ee)+K*(I*$-O*G)),v[4]=-(z*(ee*Fe-ne*fe)-H*(G*Fe-$*fe)+ve*(G*ne-$*ee)),v[5]=A*(ee*Fe-ne*fe)-H*(I*Fe-O*fe)+ve*(I*ne-O*ee),v[6]=-(A*(G*Fe-$*fe)-z*(I*Fe-O*fe)+ve*(I*$-O*G)),v[7]=A*(G*ne-$*ee)-z*(I*ne-O*ee)+H*(I*$-O*G),v[8]=z*(K*Fe-ne*pe)-H*(B*Fe-$*pe)+ve*(B*ne-$*K),v[9]=-(A*(K*Fe-ne*pe)-H*(D*Fe-O*pe)+ve*(D*ne-O*K)),v[10]=A*(B*Fe-$*pe)-z*(D*Fe-O*pe)+ve*(D*$-O*B),v[11]=-(A*(B*ne-$*K)-z*(D*ne-O*K)+H*(D*$-O*B)),v[12]=-(z*(K*fe-ee*pe)-H*(B*fe-G*pe)+ve*(B*ee-G*K)),v[13]=A*(K*fe-ee*pe)-H*(D*fe-I*pe)+ve*(D*ee-I*K),v[14]=-(A*(B*fe-G*pe)-z*(D*fe-I*pe)+ve*(D*G-I*B)),v[15]=A*(B*ee-G*K)-z*(D*ee-I*K)+H*(D*G-I*B),v},ye.determinant=function(v){var S=v[0],A=v[1],D=v[2],I=v[3],O=v[4],z=v[5],B=v[6],G=v[7],$=v[8],H=v[9],K=v[10],ee=v[11],ne=v[12],ve=v[13],pe=v[14],fe=v[15];return(S*z-A*O)*(K*fe-ee*pe)-(S*B-D*O)*(H*fe-ee*ve)+(S*G-I*O)*(H*pe-K*ve)+(A*B-D*z)*($*fe-ee*ne)-(A*G-I*z)*($*pe-K*ne)+(D*G-I*B)*($*ve-H*ne)},ye.multiply=p,ye.translate=function(v,S,A){var D,I,O,z,B,G,$,H,K,ee,ne,ve,pe=A[0],fe=A[1],Fe=A[2];return S===v?(v[12]=S[0]*pe+S[4]*fe+S[8]*Fe+S[12],v[13]=S[1]*pe+S[5]*fe+S[9]*Fe+S[13],v[14]=S[2]*pe+S[6]*fe+S[10]*Fe+S[14],v[15]=S[3]*pe+S[7]*fe+S[11]*Fe+S[15]):(I=S[1],O=S[2],z=S[3],B=S[4],G=S[5],$=S[6],H=S[7],K=S[8],ee=S[9],ne=S[10],ve=S[11],v[0]=D=S[0],v[1]=I,v[2]=O,v[3]=z,v[4]=B,v[5]=G,v[6]=$,v[7]=H,v[8]=K,v[9]=ee,v[10]=ne,v[11]=ve,v[12]=D*pe+B*fe+K*Fe+S[12],v[13]=I*pe+G*fe+ee*Fe+S[13],v[14]=O*pe+$*fe+ne*Fe+S[14],v[15]=z*pe+H*fe+ve*Fe+S[15]),v},ye.scale=function(v,S,A){var D=A[0],I=A[1],O=A[2];return v[0]=S[0]*D,v[1]=S[1]*D,v[2]=S[2]*D,v[3]=S[3]*D,v[4]=S[4]*I,v[5]=S[5]*I,v[6]=S[6]*I,v[7]=S[7]*I,v[8]=S[8]*O,v[9]=S[9]*O,v[10]=S[10]*O,v[11]=S[11]*O,v[12]=S[12],v[13]=S[13],v[14]=S[14],v[15]=S[15],v},ye.rotate=function(v,S,A,D){var I,O,z,B,G,$,H,K,ee,ne,ve,pe,fe,Fe,be,Be,$e,Ue,Ye,Ze,rt,Je,ot,kt,Mt=D[0],ni=D[1],Vt=D[2],qt=Math.hypot(Mt,ni,Vt);return qt<a.EPSILON?null:(Mt*=qt=1/qt,ni*=qt,Vt*=qt,I=Math.sin(A),O=Math.cos(A),G=S[1],$=S[2],H=S[3],ee=S[5],ne=S[6],ve=S[7],fe=S[9],Fe=S[10],be=S[11],Be=Mt*Mt*(z=1-O)+O,Ye=Mt*ni*z-Vt*I,Ze=ni*ni*z+O,rt=Vt*ni*z+Mt*I,Je=Mt*Vt*z+ni*I,ot=ni*Vt*z-Mt*I,kt=Vt*Vt*z+O,v[0]=(B=S[0])*Be+(K=S[4])*($e=ni*Mt*z+Vt*I)+(pe=S[8])*(Ue=Vt*Mt*z-ni*I),v[1]=G*Be+ee*$e+fe*Ue,v[2]=$*Be+ne*$e+Fe*Ue,v[3]=H*Be+ve*$e+be*Ue,v[4]=B*Ye+K*Ze+pe*rt,v[5]=G*Ye+ee*Ze+fe*rt,v[6]=$*Ye+ne*Ze+Fe*rt,v[7]=H*Ye+ve*Ze+be*rt,v[8]=B*Je+K*ot+pe*kt,v[9]=G*Je+ee*ot+fe*kt,v[10]=$*Je+ne*ot+Fe*kt,v[11]=H*Je+ve*ot+be*kt,S!==v&&(v[12]=S[12],v[13]=S[13],v[14]=S[14],v[15]=S[15]),v)},ye.rotateX=function(v,S,A){var D=Math.sin(A),I=Math.cos(A),O=S[4],z=S[5],B=S[6],G=S[7],$=S[8],H=S[9],K=S[10],ee=S[11];return S!==v&&(v[0]=S[0],v[1]=S[1],v[2]=S[2],v[3]=S[3],v[12]=S[12],v[13]=S[13],v[14]=S[14],v[15]=S[15]),v[4]=O*I+$*D,v[5]=z*I+H*D,v[6]=B*I+K*D,v[7]=G*I+ee*D,v[8]=$*I-O*D,v[9]=H*I-z*D,v[10]=K*I-B*D,v[11]=ee*I-G*D,v},ye.rotateY=function(v,S,A){var D=Math.sin(A),I=Math.cos(A),O=S[0],z=S[1],B=S[2],G=S[3],$=S[8],H=S[9],K=S[10],ee=S[11];return S!==v&&(v[4]=S[4],v[5]=S[5],v[6]=S[6],v[7]=S[7],v[12]=S[12],v[13]=S[13],v[14]=S[14],v[15]=S[15]),v[0]=O*I-$*D,v[1]=z*I-H*D,v[2]=B*I-K*D,v[3]=G*I-ee*D,v[8]=O*D+$*I,v[9]=z*D+H*I,v[10]=B*D+K*I,v[11]=G*D+ee*I,v},ye.rotateZ=function(v,S,A){var D=Math.sin(A),I=Math.cos(A),O=S[0],z=S[1],B=S[2],G=S[3],$=S[4],H=S[5],K=S[6],ee=S[7];return S!==v&&(v[8]=S[8],v[9]=S[9],v[10]=S[10],v[11]=S[11],v[12]=S[12],v[13]=S[13],v[14]=S[14],v[15]=S[15]),v[0]=O*I+$*D,v[1]=z*I+H*D,v[2]=B*I+K*D,v[3]=G*I+ee*D,v[4]=$*I-O*D,v[5]=H*I-z*D,v[6]=K*I-B*D,v[7]=ee*I-G*D,v},ye.fromTranslation=function(v,S){return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=S[0],v[13]=S[1],v[14]=S[2],v[15]=1,v},ye.fromScaling=function(v,S){return v[0]=S[0],v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=S[1],v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=S[2],v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},ye.fromRotation=function(v,S,A){var D,I,O,z=A[0],B=A[1],G=A[2],$=Math.hypot(z,B,G);return $<a.EPSILON?null:(z*=$=1/$,B*=$,G*=$,D=Math.sin(S),I=Math.cos(S),v[0]=z*z*(O=1-I)+I,v[1]=B*z*O+G*D,v[2]=G*z*O-B*D,v[3]=0,v[4]=z*B*O-G*D,v[5]=B*B*O+I,v[6]=G*B*O+z*D,v[7]=0,v[8]=z*G*O+B*D,v[9]=B*G*O-z*D,v[10]=G*G*O+I,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v)},ye.fromXRotation=function(v,S){var A=Math.sin(S),D=Math.cos(S);return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=D,v[6]=A,v[7]=0,v[8]=0,v[9]=-A,v[10]=D,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},ye.fromYRotation=function(v,S){var A=Math.sin(S),D=Math.cos(S);return v[0]=D,v[1]=0,v[2]=-A,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=A,v[9]=0,v[10]=D,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},ye.fromZRotation=function(v,S){var A=Math.sin(S),D=Math.cos(S);return v[0]=D,v[1]=A,v[2]=0,v[3]=0,v[4]=-A,v[5]=D,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},ye.fromRotationTranslation=h,ye.fromQuat2=function(v,S){var A=new a.ARRAY_TYPE(3),D=-S[0],I=-S[1],O=-S[2],z=S[3],B=S[4],G=S[5],$=S[6],H=S[7],K=D*D+I*I+O*O+z*z;return K>0?(A[0]=2*(B*z+H*D+G*O-$*I)/K,A[1]=2*(G*z+H*I+$*D-B*O)/K,A[2]=2*($*z+H*O+B*I-G*D)/K):(A[0]=2*(B*z+H*D+G*O-$*I),A[1]=2*(G*z+H*I+$*D-B*O),A[2]=2*($*z+H*O+B*I-G*D)),h(v,S,A),v},ye.getTranslation=function(v,S){return v[0]=S[12],v[1]=S[13],v[2]=S[14],v},ye.getScaling=_,ye.getRotation=function(v,S){var A=new a.ARRAY_TYPE(3);_(A,S);var D=1/A[0],I=1/A[1],O=1/A[2],z=S[0]*D,B=S[1]*I,G=S[2]*O,$=S[4]*D,H=S[5]*I,K=S[6]*O,ee=S[8]*D,ne=S[9]*I,ve=S[10]*O,pe=z+H+ve,fe=0;return pe>0?(fe=2*Math.sqrt(pe+1),v[3]=.25*fe,v[0]=(K-ne)/fe,v[1]=(ee-G)/fe,v[2]=(B-$)/fe):z>H&&z>ve?(fe=2*Math.sqrt(1+z-H-ve),v[3]=(K-ne)/fe,v[0]=.25*fe,v[1]=(B+$)/fe,v[2]=(ee+G)/fe):H>ve?(fe=2*Math.sqrt(1+H-z-ve),v[3]=(ee-G)/fe,v[0]=(B+$)/fe,v[1]=.25*fe,v[2]=(K+ne)/fe):(fe=2*Math.sqrt(1+ve-z-H),v[3]=(B-$)/fe,v[0]=(ee+G)/fe,v[1]=(K+ne)/fe,v[2]=.25*fe),v},ye.fromRotationTranslationScale=function(v,S,A,D){var I=S[0],O=S[1],z=S[2],B=S[3],G=I+I,$=O+O,H=z+z,K=I*G,ee=I*$,ne=I*H,ve=O*$,pe=O*H,fe=z*H,Fe=B*G,be=B*$,Be=B*H,$e=D[0],Ue=D[1],Ye=D[2];return v[0]=(1-(ve+fe))*$e,v[1]=(ee+Be)*$e,v[2]=(ne-be)*$e,v[3]=0,v[4]=(ee-Be)*Ue,v[5]=(1-(K+fe))*Ue,v[6]=(pe+Fe)*Ue,v[7]=0,v[8]=(ne+be)*Ye,v[9]=(pe-Fe)*Ye,v[10]=(1-(K+ve))*Ye,v[11]=0,v[12]=A[0],v[13]=A[1],v[14]=A[2],v[15]=1,v},ye.fromRotationTranslationScaleOrigin=function(v,S,A,D,I){var O=S[0],z=S[1],B=S[2],G=S[3],$=O+O,H=z+z,K=B+B,ee=O*$,ne=O*H,ve=O*K,pe=z*H,fe=z*K,Fe=B*K,be=G*$,Be=G*H,$e=G*K,Ue=D[0],Ye=D[1],Ze=D[2],rt=I[0],Je=I[1],ot=I[2],kt=(1-(pe+Fe))*Ue,Mt=(ne+$e)*Ue,ni=(ve-Be)*Ue,Vt=(ne-$e)*Ye,qt=(1-(ee+Fe))*Ye,Lt=(fe+be)*Ye,Ri=(ve+Be)*Ze,Jt=(fe-be)*Ze,mi=(1-(ee+pe))*Ze;return v[0]=kt,v[1]=Mt,v[2]=ni,v[3]=0,v[4]=Vt,v[5]=qt,v[6]=Lt,v[7]=0,v[8]=Ri,v[9]=Jt,v[10]=mi,v[11]=0,v[12]=A[0]+rt-(kt*rt+Vt*Je+Ri*ot),v[13]=A[1]+Je-(Mt*rt+qt*Je+Jt*ot),v[14]=A[2]+ot-(ni*rt+Lt*Je+mi*ot),v[15]=1,v},ye.fromQuat=function(v,S){var A=S[0],D=S[1],I=S[2],O=S[3],z=A+A,B=D+D,G=I+I,$=A*z,H=D*z,K=D*B,ee=I*z,ne=I*B,ve=I*G,pe=O*z,fe=O*B,Fe=O*G;return v[0]=1-K-ve,v[1]=H+Fe,v[2]=ee-fe,v[3]=0,v[4]=H-Fe,v[5]=1-$-ve,v[6]=ne+pe,v[7]=0,v[8]=ee+fe,v[9]=ne-pe,v[10]=1-$-K,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},ye.frustum=function(v,S,A,D,I,O,z){var B=1/(A-S),G=1/(I-D),$=1/(O-z);return v[0]=2*O*B,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=2*O*G,v[6]=0,v[7]=0,v[8]=(A+S)*B,v[9]=(I+D)*G,v[10]=(z+O)*$,v[11]=-1,v[12]=0,v[13]=0,v[14]=z*O*2*$,v[15]=0,v},ye.perspectiveNO=x,ye.perspectiveZO=function(v,S,A,D,I){var O,z=1/Math.tan(S/2);return v[0]=z/A,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=z,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[11]=-1,v[12]=0,v[13]=0,v[15]=0,I!=null&&I!==1/0?(v[10]=I*(O=1/(D-I)),v[14]=I*D*O):(v[10]=-1,v[14]=-D),v},ye.perspectiveFromFieldOfView=function(v,S,A,D){var I=Math.tan(S.upDegrees*Math.PI/180),O=Math.tan(S.downDegrees*Math.PI/180),z=Math.tan(S.leftDegrees*Math.PI/180),B=Math.tan(S.rightDegrees*Math.PI/180),G=2/(z+B),$=2/(I+O);return v[0]=G,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=$,v[6]=0,v[7]=0,v[8]=-(z-B)*G*.5,v[9]=(I-O)*$*.5,v[10]=D/(A-D),v[11]=-1,v[12]=0,v[13]=0,v[14]=D*A/(A-D),v[15]=0,v},ye.orthoNO=C,ye.orthoZO=function(v,S,A,D,I,O,z){var B=1/(S-A),G=1/(D-I),$=1/(O-z);return v[0]=-2*B,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=-2*G,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=$,v[11]=0,v[12]=(S+A)*B,v[13]=(I+D)*G,v[14]=O*$,v[15]=1,v},ye.lookAt=function(v,S,A,D){var I,O,z,B,G,$,H,K,ee,ne,ve=S[0],pe=S[1],fe=S[2],Fe=D[0],be=D[1],Be=D[2],$e=A[0],Ue=A[1],Ye=A[2];return Math.abs(ve-$e)<a.EPSILON&&Math.abs(pe-Ue)<a.EPSILON&&Math.abs(fe-Ye)<a.EPSILON?d(v):(H=ve-$e,K=pe-Ue,ee=fe-Ye,I=be*(ee*=ne=1/Math.hypot(H,K,ee))-Be*(K*=ne),O=Be*(H*=ne)-Fe*ee,z=Fe*K-be*H,(ne=Math.hypot(I,O,z))?(I*=ne=1/ne,O*=ne,z*=ne):(I=0,O=0,z=0),B=K*z-ee*O,G=ee*I-H*z,$=H*O-K*I,(ne=Math.hypot(B,G,$))?(B*=ne=1/ne,G*=ne,$*=ne):(B=0,G=0,$=0),v[0]=I,v[1]=B,v[2]=H,v[3]=0,v[4]=O,v[5]=G,v[6]=K,v[7]=0,v[8]=z,v[9]=$,v[10]=ee,v[11]=0,v[12]=-(I*ve+O*pe+z*fe),v[13]=-(B*ve+G*pe+$*fe),v[14]=-(H*ve+K*pe+ee*fe),v[15]=1,v)},ye.targetTo=function(v,S,A,D){var I=S[0],O=S[1],z=S[2],B=D[0],G=D[1],$=D[2],H=I-A[0],K=O-A[1],ee=z-A[2],ne=H*H+K*K+ee*ee;ne>0&&(H*=ne=1/Math.sqrt(ne),K*=ne,ee*=ne);var ve=G*ee-$*K,pe=$*H-B*ee,fe=B*K-G*H;return(ne=ve*ve+pe*pe+fe*fe)>0&&(ve*=ne=1/Math.sqrt(ne),pe*=ne,fe*=ne),v[0]=ve,v[1]=pe,v[2]=fe,v[3]=0,v[4]=K*fe-ee*pe,v[5]=ee*ve-H*fe,v[6]=H*pe-K*ve,v[7]=0,v[8]=H,v[9]=K,v[10]=ee,v[11]=0,v[12]=I,v[13]=O,v[14]=z,v[15]=1,v},ye.str=function(v){return"mat4("+v[0]+", "+v[1]+", "+v[2]+", "+v[3]+", "+v[4]+", "+v[5]+", "+v[6]+", "+v[7]+", "+v[8]+", "+v[9]+", "+v[10]+", "+v[11]+", "+v[12]+", "+v[13]+", "+v[14]+", "+v[15]+")"},ye.frob=function(v){return Math.hypot(v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],v[8],v[9],v[10],v[11],v[12],v[13],v[14],v[15])},ye.add=function(v,S,A){return v[0]=S[0]+A[0],v[1]=S[1]+A[1],v[2]=S[2]+A[2],v[3]=S[3]+A[3],v[4]=S[4]+A[4],v[5]=S[5]+A[5],v[6]=S[6]+A[6],v[7]=S[7]+A[7],v[8]=S[8]+A[8],v[9]=S[9]+A[9],v[10]=S[10]+A[10],v[11]=S[11]+A[11],v[12]=S[12]+A[12],v[13]=S[13]+A[13],v[14]=S[14]+A[14],v[15]=S[15]+A[15],v},ye.subtract=M,ye.multiplyScalar=function(v,S,A){return v[0]=S[0]*A,v[1]=S[1]*A,v[2]=S[2]*A,v[3]=S[3]*A,v[4]=S[4]*A,v[5]=S[5]*A,v[6]=S[6]*A,v[7]=S[7]*A,v[8]=S[8]*A,v[9]=S[9]*A,v[10]=S[10]*A,v[11]=S[11]*A,v[12]=S[12]*A,v[13]=S[13]*A,v[14]=S[14]*A,v[15]=S[15]*A,v},ye.multiplyScalarAndAdd=function(v,S,A,D){return v[0]=S[0]+A[0]*D,v[1]=S[1]+A[1]*D,v[2]=S[2]+A[2]*D,v[3]=S[3]+A[3]*D,v[4]=S[4]+A[4]*D,v[5]=S[5]+A[5]*D,v[6]=S[6]+A[6]*D,v[7]=S[7]+A[7]*D,v[8]=S[8]+A[8]*D,v[9]=S[9]+A[9]*D,v[10]=S[10]+A[10]*D,v[11]=S[11]+A[11]*D,v[12]=S[12]+A[12]*D,v[13]=S[13]+A[13]*D,v[14]=S[14]+A[14]*D,v[15]=S[15]+A[15]*D,v},ye.exactEquals=function(v,S){return v[0]===S[0]&&v[1]===S[1]&&v[2]===S[2]&&v[3]===S[3]&&v[4]===S[4]&&v[5]===S[5]&&v[6]===S[6]&&v[7]===S[7]&&v[8]===S[8]&&v[9]===S[9]&&v[10]===S[10]&&v[11]===S[11]&&v[12]===S[12]&&v[13]===S[13]&&v[14]===S[14]&&v[15]===S[15]},ye.equals=function(v,S){var A=v[0],D=v[1],I=v[2],O=v[3],z=v[4],B=v[5],G=v[6],$=v[7],H=v[8],K=v[9],ee=v[10],ne=v[11],ve=v[12],pe=v[13],fe=v[14],Fe=v[15],be=S[0],Be=S[1],$e=S[2],Ue=S[3],Ye=S[4],Ze=S[5],rt=S[6],Je=S[7],ot=S[8],kt=S[9],Mt=S[10],ni=S[11],Vt=S[12],qt=S[13],Lt=S[14],Ri=S[15];return Math.abs(A-be)<=a.EPSILON*Math.max(1,Math.abs(A),Math.abs(be))&&Math.abs(D-Be)<=a.EPSILON*Math.max(1,Math.abs(D),Math.abs(Be))&&Math.abs(I-$e)<=a.EPSILON*Math.max(1,Math.abs(I),Math.abs($e))&&Math.abs(O-Ue)<=a.EPSILON*Math.max(1,Math.abs(O),Math.abs(Ue))&&Math.abs(z-Ye)<=a.EPSILON*Math.max(1,Math.abs(z),Math.abs(Ye))&&Math.abs(B-Ze)<=a.EPSILON*Math.max(1,Math.abs(B),Math.abs(Ze))&&Math.abs(G-rt)<=a.EPSILON*Math.max(1,Math.abs(G),Math.abs(rt))&&Math.abs($-Je)<=a.EPSILON*Math.max(1,Math.abs($),Math.abs(Je))&&Math.abs(H-ot)<=a.EPSILON*Math.max(1,Math.abs(H),Math.abs(ot))&&Math.abs(K-kt)<=a.EPSILON*Math.max(1,Math.abs(K),Math.abs(kt))&&Math.abs(ee-Mt)<=a.EPSILON*Math.max(1,Math.abs(ee),Math.abs(Mt))&&Math.abs(ne-ni)<=a.EPSILON*Math.max(1,Math.abs(ne),Math.abs(ni))&&Math.abs(ve-Vt)<=a.EPSILON*Math.max(1,Math.abs(ve),Math.abs(Vt))&&Math.abs(pe-qt)<=a.EPSILON*Math.max(1,Math.abs(pe),Math.abs(qt))&&Math.abs(fe-Lt)<=a.EPSILON*Math.max(1,Math.abs(fe),Math.abs(Lt))&&Math.abs(Fe-Ri)<=a.EPSILON*Math.max(1,Math.abs(Fe),Math.abs(Ri))},ye.sub=ye.mul=ye.ortho=ye.perspective=void 0;var a=function(v,S){if(v&&v.__esModule)return v;if(v===null||u(v)!=="object"&&typeof v!="function")return{default:v};var A=l(void 0);if(A&&A.has(v))return A.get(v);var D={},I=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in v)if(O!=="default"&&Object.prototype.hasOwnProperty.call(v,O)){var z=I?Object.getOwnPropertyDescriptor(v,O):null;z&&(z.get||z.set)?Object.defineProperty(D,O,z):D[O]=v[O]}return D.default=v,A&&A.set(v,D),D}(N());function l(v){if(typeof WeakMap!="function")return null;var S=new WeakMap,A=new WeakMap;return(l=function(D){return D?A:S})(v)}function d(v){return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}function p(v,S,A){var D=S[0],I=S[1],O=S[2],z=S[3],B=S[4],G=S[5],$=S[6],H=S[7],K=S[8],ee=S[9],ne=S[10],ve=S[11],pe=S[12],fe=S[13],Fe=S[14],be=S[15],Be=A[0],$e=A[1],Ue=A[2],Ye=A[3];return v[0]=Be*D+$e*B+Ue*K+Ye*pe,v[1]=Be*I+$e*G+Ue*ee+Ye*fe,v[2]=Be*O+$e*$+Ue*ne+Ye*Fe,v[3]=Be*z+$e*H+Ue*ve+Ye*be,v[4]=(Be=A[4])*D+($e=A[5])*B+(Ue=A[6])*K+(Ye=A[7])*pe,v[5]=Be*I+$e*G+Ue*ee+Ye*fe,v[6]=Be*O+$e*$+Ue*ne+Ye*Fe,v[7]=Be*z+$e*H+Ue*ve+Ye*be,v[8]=(Be=A[8])*D+($e=A[9])*B+(Ue=A[10])*K+(Ye=A[11])*pe,v[9]=Be*I+$e*G+Ue*ee+Ye*fe,v[10]=Be*O+$e*$+Ue*ne+Ye*Fe,v[11]=Be*z+$e*H+Ue*ve+Ye*be,v[12]=(Be=A[12])*D+($e=A[13])*B+(Ue=A[14])*K+(Ye=A[15])*pe,v[13]=Be*I+$e*G+Ue*ee+Ye*fe,v[14]=Be*O+$e*$+Ue*ne+Ye*Fe,v[15]=Be*z+$e*H+Ue*ve+Ye*be,v}function h(v,S,A){var D=S[0],I=S[1],O=S[2],z=S[3],B=D+D,G=I+I,$=O+O,H=D*B,K=D*G,ee=D*$,ne=I*G,ve=I*$,pe=O*$,fe=z*B,Fe=z*G,be=z*$;return v[0]=1-(ne+pe),v[1]=K+be,v[2]=ee-Fe,v[3]=0,v[4]=K-be,v[5]=1-(H+pe),v[6]=ve+fe,v[7]=0,v[8]=ee+Fe,v[9]=ve-fe,v[10]=1-(H+ne),v[11]=0,v[12]=A[0],v[13]=A[1],v[14]=A[2],v[15]=1,v}function _(v,S){var A=S[4],D=S[5],I=S[6],O=S[8],z=S[9],B=S[10];return v[0]=Math.hypot(S[0],S[1],S[2]),v[1]=Math.hypot(A,D,I),v[2]=Math.hypot(O,z,B),v}function x(v,S,A,D,I){var O,z=1/Math.tan(S/2);return v[0]=z/A,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=z,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[11]=-1,v[12]=0,v[13]=0,v[15]=0,I!=null&&I!==1/0?(v[10]=(I+D)*(O=1/(D-I)),v[14]=2*I*D*O):(v[10]=-1,v[14]=-2*D),v}function C(v,S,A,D,I,O,z){var B=1/(S-A),G=1/(D-I),$=1/(O-z);return v[0]=-2*B,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=-2*G,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=2*$,v[11]=0,v[12]=(S+A)*B,v[13]=(I+D)*G,v[14]=(z+O)*$,v[15]=1,v}function M(v,S,A){return v[0]=S[0]-A[0],v[1]=S[1]-A[1],v[2]=S[2]-A[2],v[3]=S[3]-A[3],v[4]=S[4]-A[4],v[5]=S[5]-A[5],v[6]=S[6]-A[6],v[7]=S[7]-A[7],v[8]=S[8]-A[8],v[9]=S[9]-A[9],v[10]=S[10]-A[10],v[11]=S[11]-A[11],v[12]=S[12]-A[12],v[13]=S[13]-A[13],v[14]=S[14]-A[14],v[15]=S[15]-A[15],v}return ye.perspective=x,ye.ortho=C,ye.mul=p,ye.sub=M,ye}var Rt,ut={},ct={};function We(){if(Rt)return ct;function u(I){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(O){return typeof O}:function(O){return O&&typeof Symbol=="function"&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},u(I)}Rt=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.create=d,ct.clone=function(I){var O=new a.ARRAY_TYPE(3);return O[0]=I[0],O[1]=I[1],O[2]=I[2],O},ct.length=p,ct.fromValues=function(I,O,z){var B=new a.ARRAY_TYPE(3);return B[0]=I,B[1]=O,B[2]=z,B},ct.copy=function(I,O){return I[0]=O[0],I[1]=O[1],I[2]=O[2],I},ct.set=function(I,O,z,B){return I[0]=O,I[1]=z,I[2]=B,I},ct.add=function(I,O,z){return I[0]=O[0]+z[0],I[1]=O[1]+z[1],I[2]=O[2]+z[2],I},ct.subtract=h,ct.multiply=_,ct.divide=x,ct.ceil=function(I,O){return I[0]=Math.ceil(O[0]),I[1]=Math.ceil(O[1]),I[2]=Math.ceil(O[2]),I},ct.floor=function(I,O){return I[0]=Math.floor(O[0]),I[1]=Math.floor(O[1]),I[2]=Math.floor(O[2]),I},ct.min=function(I,O,z){return I[0]=Math.min(O[0],z[0]),I[1]=Math.min(O[1],z[1]),I[2]=Math.min(O[2],z[2]),I},ct.max=function(I,O,z){return I[0]=Math.max(O[0],z[0]),I[1]=Math.max(O[1],z[1]),I[2]=Math.max(O[2],z[2]),I},ct.round=function(I,O){return I[0]=Math.round(O[0]),I[1]=Math.round(O[1]),I[2]=Math.round(O[2]),I},ct.scale=function(I,O,z){return I[0]=O[0]*z,I[1]=O[1]*z,I[2]=O[2]*z,I},ct.scaleAndAdd=function(I,O,z,B){return I[0]=O[0]+z[0]*B,I[1]=O[1]+z[1]*B,I[2]=O[2]+z[2]*B,I},ct.distance=C,ct.squaredDistance=M,ct.squaredLength=v,ct.negate=function(I,O){return I[0]=-O[0],I[1]=-O[1],I[2]=-O[2],I},ct.inverse=function(I,O){return I[0]=1/O[0],I[1]=1/O[1],I[2]=1/O[2],I},ct.normalize=function(I,O){var z=O[0],B=O[1],G=O[2],$=z*z+B*B+G*G;return $>0&&($=1/Math.sqrt($)),I[0]=O[0]*$,I[1]=O[1]*$,I[2]=O[2]*$,I},ct.dot=S,ct.cross=function(I,O,z){var B=O[0],G=O[1],$=O[2],H=z[0],K=z[1],ee=z[2];return I[0]=G*ee-$*K,I[1]=$*H-B*ee,I[2]=B*K-G*H,I},ct.lerp=function(I,O,z,B){var G=O[0],$=O[1],H=O[2];return I[0]=G+B*(z[0]-G),I[1]=$+B*(z[1]-$),I[2]=H+B*(z[2]-H),I},ct.hermite=function(I,O,z,B,G,$){var H=$*$,K=H*(2*$-3)+1,ee=H*($-2)+$,ne=H*($-1),ve=H*(3-2*$);return I[0]=O[0]*K+z[0]*ee+B[0]*ne+G[0]*ve,I[1]=O[1]*K+z[1]*ee+B[1]*ne+G[1]*ve,I[2]=O[2]*K+z[2]*ee+B[2]*ne+G[2]*ve,I},ct.bezier=function(I,O,z,B,G,$){var H=1-$,K=H*H,ee=$*$,ne=K*H,ve=3*$*K,pe=3*ee*H,fe=ee*$;return I[0]=O[0]*ne+z[0]*ve+B[0]*pe+G[0]*fe,I[1]=O[1]*ne+z[1]*ve+B[1]*pe+G[1]*fe,I[2]=O[2]*ne+z[2]*ve+B[2]*pe+G[2]*fe,I},ct.random=function(I,O){O=O||1;var z=2*a.RANDOM()*Math.PI,B=2*a.RANDOM()-1,G=Math.sqrt(1-B*B)*O;return I[0]=Math.cos(z)*G,I[1]=Math.sin(z)*G,I[2]=B*O,I},ct.transformMat4=function(I,O,z){var B=O[0],G=O[1],$=O[2],H=z[3]*B+z[7]*G+z[11]*$+z[15];return I[0]=(z[0]*B+z[4]*G+z[8]*$+z[12])/(H=H||1),I[1]=(z[1]*B+z[5]*G+z[9]*$+z[13])/H,I[2]=(z[2]*B+z[6]*G+z[10]*$+z[14])/H,I},ct.transformMat3=function(I,O,z){var B=O[0],G=O[1],$=O[2];return I[0]=B*z[0]+G*z[3]+$*z[6],I[1]=B*z[1]+G*z[4]+$*z[7],I[2]=B*z[2]+G*z[5]+$*z[8],I},ct.transformQuat=function(I,O,z){var B=z[0],G=z[1],$=z[2],H=O[0],K=O[1],ee=O[2],ne=G*ee-$*K,ve=$*H-B*ee,pe=B*K-G*H,fe=G*pe-$*ve,Fe=$*ne-B*pe,be=B*ve-G*ne,Be=2*z[3];return ve*=Be,pe*=Be,Fe*=2,be*=2,I[0]=H+(ne*=Be)+(fe*=2),I[1]=K+ve+Fe,I[2]=ee+pe+be,I},ct.rotateX=function(I,O,z,B){var G=[],$=[];return G[0]=O[0]-z[0],G[1]=O[1]-z[1],G[2]=O[2]-z[2],$[0]=G[0],$[1]=G[1]*Math.cos(B)-G[2]*Math.sin(B),$[2]=G[1]*Math.sin(B)+G[2]*Math.cos(B),I[0]=$[0]+z[0],I[1]=$[1]+z[1],I[2]=$[2]+z[2],I},ct.rotateY=function(I,O,z,B){var G=[],$=[];return G[0]=O[0]-z[0],G[1]=O[1]-z[1],G[2]=O[2]-z[2],$[0]=G[2]*Math.sin(B)+G[0]*Math.cos(B),$[1]=G[1],$[2]=G[2]*Math.cos(B)-G[0]*Math.sin(B),I[0]=$[0]+z[0],I[1]=$[1]+z[1],I[2]=$[2]+z[2],I},ct.rotateZ=function(I,O,z,B){var G=[],$=[];return G[0]=O[0]-z[0],G[1]=O[1]-z[1],G[2]=O[2]-z[2],$[0]=G[0]*Math.cos(B)-G[1]*Math.sin(B),$[1]=G[0]*Math.sin(B)+G[1]*Math.cos(B),$[2]=G[2],I[0]=$[0]+z[0],I[1]=$[1]+z[1],I[2]=$[2]+z[2],I},ct.angle=function(I,O){var z=I[0],B=I[1],G=I[2],$=O[0],H=O[1],K=O[2],ee=Math.sqrt(z*z+B*B+G*G)*Math.sqrt($*$+H*H+K*K),ne=ee&&S(I,O)/ee;return Math.acos(Math.min(Math.max(ne,-1),1))},ct.zero=function(I){return I[0]=0,I[1]=0,I[2]=0,I},ct.str=function(I){return"vec3("+I[0]+", "+I[1]+", "+I[2]+")"},ct.exactEquals=function(I,O){return I[0]===O[0]&&I[1]===O[1]&&I[2]===O[2]},ct.equals=function(I,O){var z=I[0],B=I[1],G=I[2],$=O[0],H=O[1],K=O[2];return Math.abs(z-$)<=a.EPSILON*Math.max(1,Math.abs(z),Math.abs($))&&Math.abs(B-H)<=a.EPSILON*Math.max(1,Math.abs(B),Math.abs(H))&&Math.abs(G-K)<=a.EPSILON*Math.max(1,Math.abs(G),Math.abs(K))},ct.forEach=ct.sqrLen=ct.len=ct.sqrDist=ct.dist=ct.div=ct.mul=ct.sub=void 0;var a=function(I,O){if(I&&I.__esModule)return I;if(I===null||u(I)!=="object"&&typeof I!="function")return{default:I};var z=l(void 0);if(z&&z.has(I))return z.get(I);var B={},G=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in I)if($!=="default"&&Object.prototype.hasOwnProperty.call(I,$)){var H=G?Object.getOwnPropertyDescriptor(I,$):null;H&&(H.get||H.set)?Object.defineProperty(B,$,H):B[$]=I[$]}return B.default=I,z&&z.set(I,B),B}(N());function l(I){if(typeof WeakMap!="function")return null;var O=new WeakMap,z=new WeakMap;return(l=function(B){return B?z:O})(I)}function d(){var I=new a.ARRAY_TYPE(3);return a.ARRAY_TYPE!=Float32Array&&(I[0]=0,I[1]=0,I[2]=0),I}function p(I){return Math.hypot(I[0],I[1],I[2])}function h(I,O,z){return I[0]=O[0]-z[0],I[1]=O[1]-z[1],I[2]=O[2]-z[2],I}function _(I,O,z){return I[0]=O[0]*z[0],I[1]=O[1]*z[1],I[2]=O[2]*z[2],I}function x(I,O,z){return I[0]=O[0]/z[0],I[1]=O[1]/z[1],I[2]=O[2]/z[2],I}function C(I,O){return Math.hypot(O[0]-I[0],O[1]-I[1],O[2]-I[2])}function M(I,O){var z=O[0]-I[0],B=O[1]-I[1],G=O[2]-I[2];return z*z+B*B+G*G}function v(I){var O=I[0],z=I[1],B=I[2];return O*O+z*z+B*B}function S(I,O){return I[0]*O[0]+I[1]*O[1]+I[2]*O[2]}ct.sub=h,ct.mul=_,ct.div=x,ct.dist=C,ct.sqrDist=M,ct.len=p,ct.sqrLen=v;var A,D=(A=d(),function(I,O,z,B,G,$){var H,K;for(O||(O=3),z||(z=0),K=B?Math.min(B*O+z,I.length):I.length,H=z;H<K;H+=O)A[0]=I[H],A[1]=I[H+1],A[2]=I[H+2],G(A,A,$),I[H]=A[0],I[H+1]=A[1],I[H+2]=A[2];return I});return ct.forEach=D,ct}var Pt,ui,we={};function xe(){if(Pt)return we;function u(D){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},u(D)}Pt=1,Object.defineProperty(we,"__esModule",{value:!0}),we.create=d,we.clone=function(D){var I=new a.ARRAY_TYPE(4);return I[0]=D[0],I[1]=D[1],I[2]=D[2],I[3]=D[3],I},we.fromValues=function(D,I,O,z){var B=new a.ARRAY_TYPE(4);return B[0]=D,B[1]=I,B[2]=O,B[3]=z,B},we.copy=function(D,I){return D[0]=I[0],D[1]=I[1],D[2]=I[2],D[3]=I[3],D},we.set=function(D,I,O,z,B){return D[0]=I,D[1]=O,D[2]=z,D[3]=B,D},we.add=function(D,I,O){return D[0]=I[0]+O[0],D[1]=I[1]+O[1],D[2]=I[2]+O[2],D[3]=I[3]+O[3],D},we.subtract=p,we.multiply=h,we.divide=_,we.ceil=function(D,I){return D[0]=Math.ceil(I[0]),D[1]=Math.ceil(I[1]),D[2]=Math.ceil(I[2]),D[3]=Math.ceil(I[3]),D},we.floor=function(D,I){return D[0]=Math.floor(I[0]),D[1]=Math.floor(I[1]),D[2]=Math.floor(I[2]),D[3]=Math.floor(I[3]),D},we.min=function(D,I,O){return D[0]=Math.min(I[0],O[0]),D[1]=Math.min(I[1],O[1]),D[2]=Math.min(I[2],O[2]),D[3]=Math.min(I[3],O[3]),D},we.max=function(D,I,O){return D[0]=Math.max(I[0],O[0]),D[1]=Math.max(I[1],O[1]),D[2]=Math.max(I[2],O[2]),D[3]=Math.max(I[3],O[3]),D},we.round=function(D,I){return D[0]=Math.round(I[0]),D[1]=Math.round(I[1]),D[2]=Math.round(I[2]),D[3]=Math.round(I[3]),D},we.scale=function(D,I,O){return D[0]=I[0]*O,D[1]=I[1]*O,D[2]=I[2]*O,D[3]=I[3]*O,D},we.scaleAndAdd=function(D,I,O,z){return D[0]=I[0]+O[0]*z,D[1]=I[1]+O[1]*z,D[2]=I[2]+O[2]*z,D[3]=I[3]+O[3]*z,D},we.distance=x,we.squaredDistance=C,we.length=M,we.squaredLength=v,we.negate=function(D,I){return D[0]=-I[0],D[1]=-I[1],D[2]=-I[2],D[3]=-I[3],D},we.inverse=function(D,I){return D[0]=1/I[0],D[1]=1/I[1],D[2]=1/I[2],D[3]=1/I[3],D},we.normalize=function(D,I){var O=I[0],z=I[1],B=I[2],G=I[3],$=O*O+z*z+B*B+G*G;return $>0&&($=1/Math.sqrt($)),D[0]=O*$,D[1]=z*$,D[2]=B*$,D[3]=G*$,D},we.dot=function(D,I){return D[0]*I[0]+D[1]*I[1]+D[2]*I[2]+D[3]*I[3]},we.cross=function(D,I,O,z){var B=O[0]*z[1]-O[1]*z[0],G=O[0]*z[2]-O[2]*z[0],$=O[0]*z[3]-O[3]*z[0],H=O[1]*z[2]-O[2]*z[1],K=O[1]*z[3]-O[3]*z[1],ee=O[2]*z[3]-O[3]*z[2],ne=I[0],ve=I[1],pe=I[2],fe=I[3];return D[0]=ve*ee-pe*K+fe*H,D[1]=-ne*ee+pe*$-fe*G,D[2]=ne*K-ve*$+fe*B,D[3]=-ne*H+ve*G-pe*B,D},we.lerp=function(D,I,O,z){var B=I[0],G=I[1],$=I[2],H=I[3];return D[0]=B+z*(O[0]-B),D[1]=G+z*(O[1]-G),D[2]=$+z*(O[2]-$),D[3]=H+z*(O[3]-H),D},we.random=function(D,I){var O,z,B,G,$,H;I=I||1;do $=(O=2*a.RANDOM()-1)*O+(z=2*a.RANDOM()-1)*z;while($>=1);do H=(B=2*a.RANDOM()-1)*B+(G=2*a.RANDOM()-1)*G;while(H>=1);var K=Math.sqrt((1-$)/H);return D[0]=I*O,D[1]=I*z,D[2]=I*B*K,D[3]=I*G*K,D},we.transformMat4=function(D,I,O){var z=I[0],B=I[1],G=I[2],$=I[3];return D[0]=O[0]*z+O[4]*B+O[8]*G+O[12]*$,D[1]=O[1]*z+O[5]*B+O[9]*G+O[13]*$,D[2]=O[2]*z+O[6]*B+O[10]*G+O[14]*$,D[3]=O[3]*z+O[7]*B+O[11]*G+O[15]*$,D},we.transformQuat=function(D,I,O){var z=I[0],B=I[1],G=I[2],$=O[0],H=O[1],K=O[2],ee=O[3],ne=ee*z+H*G-K*B,ve=ee*B+K*z-$*G,pe=ee*G+$*B-H*z,fe=-$*z-H*B-K*G;return D[0]=ne*ee+fe*-$+ve*-K-pe*-H,D[1]=ve*ee+fe*-H+pe*-$-ne*-K,D[2]=pe*ee+fe*-K+ne*-H-ve*-$,D[3]=I[3],D},we.zero=function(D){return D[0]=0,D[1]=0,D[2]=0,D[3]=0,D},we.str=function(D){return"vec4("+D[0]+", "+D[1]+", "+D[2]+", "+D[3]+")"},we.exactEquals=function(D,I){return D[0]===I[0]&&D[1]===I[1]&&D[2]===I[2]&&D[3]===I[3]},we.equals=function(D,I){var O=D[0],z=D[1],B=D[2],G=D[3],$=I[0],H=I[1],K=I[2],ee=I[3];return Math.abs(O-$)<=a.EPSILON*Math.max(1,Math.abs(O),Math.abs($))&&Math.abs(z-H)<=a.EPSILON*Math.max(1,Math.abs(z),Math.abs(H))&&Math.abs(B-K)<=a.EPSILON*Math.max(1,Math.abs(B),Math.abs(K))&&Math.abs(G-ee)<=a.EPSILON*Math.max(1,Math.abs(G),Math.abs(ee))},we.forEach=we.sqrLen=we.len=we.sqrDist=we.dist=we.div=we.mul=we.sub=void 0;var a=function(D,I){if(D&&D.__esModule)return D;if(D===null||u(D)!=="object"&&typeof D!="function")return{default:D};var O=l(void 0);if(O&&O.has(D))return O.get(D);var z={},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var G in D)if(G!=="default"&&Object.prototype.hasOwnProperty.call(D,G)){var $=B?Object.getOwnPropertyDescriptor(D,G):null;$&&($.get||$.set)?Object.defineProperty(z,G,$):z[G]=D[G]}return z.default=D,O&&O.set(D,z),z}(N());function l(D){if(typeof WeakMap!="function")return null;var I=new WeakMap,O=new WeakMap;return(l=function(z){return z?O:I})(D)}function d(){var D=new a.ARRAY_TYPE(4);return a.ARRAY_TYPE!=Float32Array&&(D[0]=0,D[1]=0,D[2]=0,D[3]=0),D}function p(D,I,O){return D[0]=I[0]-O[0],D[1]=I[1]-O[1],D[2]=I[2]-O[2],D[3]=I[3]-O[3],D}function h(D,I,O){return D[0]=I[0]*O[0],D[1]=I[1]*O[1],D[2]=I[2]*O[2],D[3]=I[3]*O[3],D}function _(D,I,O){return D[0]=I[0]/O[0],D[1]=I[1]/O[1],D[2]=I[2]/O[2],D[3]=I[3]/O[3],D}function x(D,I){return Math.hypot(I[0]-D[0],I[1]-D[1],I[2]-D[2],I[3]-D[3])}function C(D,I){var O=I[0]-D[0],z=I[1]-D[1],B=I[2]-D[2],G=I[3]-D[3];return O*O+z*z+B*B+G*G}function M(D){return Math.hypot(D[0],D[1],D[2],D[3])}function v(D){var I=D[0],O=D[1],z=D[2],B=D[3];return I*I+O*O+z*z+B*B}we.sub=p,we.mul=h,we.div=_,we.dist=x,we.sqrDist=C,we.len=M,we.sqrLen=v;var S,A=(S=d(),function(D,I,O,z,B,G){var $,H;for(I||(I=4),O||(O=0),H=z?Math.min(z*I+O,D.length):D.length,$=O;$<H;$+=I)S[0]=D[$],S[1]=D[$+1],S[2]=D[$+2],S[3]=D[$+3],B(S,S,G),D[$]=S[0],D[$+1]=S[1],D[$+2]=S[2],D[$+3]=S[3];return D});return we.forEach=A,we}function le(){if(ui)return ut;function u(be){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Be){return typeof Be}:function(Be){return Be&&typeof Symbol=="function"&&Be.constructor===Symbol&&Be!==Symbol.prototype?"symbol":typeof Be},u(be)}ui=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.create=x,ut.identity=function(be){return be[0]=0,be[1]=0,be[2]=0,be[3]=1,be},ut.setAxisAngle=C,ut.getAxisAngle=function(be,Be){var $e=2*Math.acos(Be[3]),Ue=Math.sin($e/2);return Ue>a.EPSILON?(be[0]=Be[0]/Ue,be[1]=Be[1]/Ue,be[2]=Be[2]/Ue):(be[0]=1,be[1]=0,be[2]=0),$e},ut.getAngle=function(be,Be){var $e=O(be,Be);return Math.acos(2*$e*$e-1)},ut.multiply=M,ut.rotateX=function(be,Be,$e){$e*=.5;var Ue=Be[0],Ye=Be[1],Ze=Be[2],rt=Be[3],Je=Math.sin($e),ot=Math.cos($e);return be[0]=Ue*ot+rt*Je,be[1]=Ye*ot+Ze*Je,be[2]=Ze*ot-Ye*Je,be[3]=rt*ot-Ue*Je,be},ut.rotateY=function(be,Be,$e){$e*=.5;var Ue=Be[0],Ye=Be[1],Ze=Be[2],rt=Be[3],Je=Math.sin($e),ot=Math.cos($e);return be[0]=Ue*ot-Ze*Je,be[1]=Ye*ot+rt*Je,be[2]=Ze*ot+Ue*Je,be[3]=rt*ot-Ye*Je,be},ut.rotateZ=function(be,Be,$e){$e*=.5;var Ue=Be[0],Ye=Be[1],Ze=Be[2],rt=Be[3],Je=Math.sin($e),ot=Math.cos($e);return be[0]=Ue*ot+Ye*Je,be[1]=Ye*ot-Ue*Je,be[2]=Ze*ot+rt*Je,be[3]=rt*ot-Ze*Je,be},ut.calculateW=function(be,Be){var $e=Be[0],Ue=Be[1],Ye=Be[2];return be[0]=$e,be[1]=Ue,be[2]=Ye,be[3]=Math.sqrt(Math.abs(1-$e*$e-Ue*Ue-Ye*Ye)),be},ut.exp=v,ut.ln=S,ut.pow=function(be,Be,$e){return S(be,Be),I(be,be,$e),v(be,be),be},ut.slerp=A,ut.random=function(be){var Be=a.RANDOM(),$e=a.RANDOM(),Ue=a.RANDOM(),Ye=Math.sqrt(1-Be),Ze=Math.sqrt(Be);return be[0]=Ye*Math.sin(2*Math.PI*$e),be[1]=Ye*Math.cos(2*Math.PI*$e),be[2]=Ze*Math.sin(2*Math.PI*Ue),be[3]=Ze*Math.cos(2*Math.PI*Ue),be},ut.invert=function(be,Be){var $e=Be[0],Ue=Be[1],Ye=Be[2],Ze=Be[3],rt=$e*$e+Ue*Ue+Ye*Ye+Ze*Ze,Je=rt?1/rt:0;return be[0]=-$e*Je,be[1]=-Ue*Je,be[2]=-Ye*Je,be[3]=Ze*Je,be},ut.conjugate=function(be,Be){return be[0]=-Be[0],be[1]=-Be[1],be[2]=-Be[2],be[3]=Be[3],be},ut.fromMat3=D,ut.fromEuler=function(be,Be,$e,Ue){var Ye=.5*Math.PI/180;Be*=Ye,$e*=Ye,Ue*=Ye;var Ze=Math.sin(Be),rt=Math.cos(Be),Je=Math.sin($e),ot=Math.cos($e),kt=Math.sin(Ue),Mt=Math.cos(Ue);return be[0]=Ze*ot*Mt-rt*Je*kt,be[1]=rt*Je*Mt+Ze*ot*kt,be[2]=rt*ot*kt-Ze*Je*Mt,be[3]=rt*ot*Mt+Ze*Je*kt,be},ut.str=function(be){return"quat("+be[0]+", "+be[1]+", "+be[2]+", "+be[3]+")"},ut.setAxes=ut.sqlerp=ut.rotationTo=ut.equals=ut.exactEquals=ut.normalize=ut.sqrLen=ut.squaredLength=ut.len=ut.length=ut.lerp=ut.dot=ut.scale=ut.mul=ut.add=ut.set=ut.copy=ut.fromValues=ut.clone=void 0;var a=_(N()),l=_(Ce()),d=_(We()),p=_(xe());function h(be){if(typeof WeakMap!="function")return null;var Be=new WeakMap,$e=new WeakMap;return(h=function(Ue){return Ue?$e:Be})(be)}function _(be,Be){if(be&&be.__esModule)return be;if(be===null||u(be)!=="object"&&typeof be!="function")return{default:be};var $e=h(Be);if($e&&$e.has(be))return $e.get(be);var Ue={},Ye=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ze in be)if(Ze!=="default"&&Object.prototype.hasOwnProperty.call(be,Ze)){var rt=Ye?Object.getOwnPropertyDescriptor(be,Ze):null;rt&&(rt.get||rt.set)?Object.defineProperty(Ue,Ze,rt):Ue[Ze]=be[Ze]}return Ue.default=be,$e&&$e.set(be,Ue),Ue}function x(){var be=new a.ARRAY_TYPE(4);return a.ARRAY_TYPE!=Float32Array&&(be[0]=0,be[1]=0,be[2]=0),be[3]=1,be}function C(be,Be,$e){$e*=.5;var Ue=Math.sin($e);return be[0]=Ue*Be[0],be[1]=Ue*Be[1],be[2]=Ue*Be[2],be[3]=Math.cos($e),be}function M(be,Be,$e){var Ue=Be[0],Ye=Be[1],Ze=Be[2],rt=Be[3],Je=$e[0],ot=$e[1],kt=$e[2],Mt=$e[3];return be[0]=Ue*Mt+rt*Je+Ye*kt-Ze*ot,be[1]=Ye*Mt+rt*ot+Ze*Je-Ue*kt,be[2]=Ze*Mt+rt*kt+Ue*ot-Ye*Je,be[3]=rt*Mt-Ue*Je-Ye*ot-Ze*kt,be}function v(be,Be){var $e=Be[0],Ue=Be[1],Ye=Be[2],Ze=Be[3],rt=Math.sqrt($e*$e+Ue*Ue+Ye*Ye),Je=Math.exp(Ze),ot=rt>0?Je*Math.sin(rt)/rt:0;return be[0]=$e*ot,be[1]=Ue*ot,be[2]=Ye*ot,be[3]=Je*Math.cos(rt),be}function S(be,Be){var $e=Be[0],Ue=Be[1],Ye=Be[2],Ze=Be[3],rt=Math.sqrt($e*$e+Ue*Ue+Ye*Ye),Je=rt>0?Math.atan2(rt,Ze)/rt:0;return be[0]=$e*Je,be[1]=Ue*Je,be[2]=Ye*Je,be[3]=.5*Math.log($e*$e+Ue*Ue+Ye*Ye+Ze*Ze),be}function A(be,Be,$e,Ue){var Ye,Ze,rt,Je,ot,kt=Be[0],Mt=Be[1],ni=Be[2],Vt=Be[3],qt=$e[0],Lt=$e[1],Ri=$e[2],Jt=$e[3];return(Ze=kt*qt+Mt*Lt+ni*Ri+Vt*Jt)<0&&(Ze=-Ze,qt=-qt,Lt=-Lt,Ri=-Ri,Jt=-Jt),1-Ze>a.EPSILON?(Ye=Math.acos(Ze),rt=Math.sin(Ye),Je=Math.sin((1-Ue)*Ye)/rt,ot=Math.sin(Ue*Ye)/rt):(Je=1-Ue,ot=Ue),be[0]=Je*kt+ot*qt,be[1]=Je*Mt+ot*Lt,be[2]=Je*ni+ot*Ri,be[3]=Je*Vt+ot*Jt,be}function D(be,Be){var $e,Ue=Be[0]+Be[4]+Be[8];if(Ue>0)$e=Math.sqrt(Ue+1),be[3]=.5*$e,be[0]=(Be[5]-Be[7])*($e=.5/$e),be[1]=(Be[6]-Be[2])*$e,be[2]=(Be[1]-Be[3])*$e;else{var Ye=0;Be[4]>Be[0]&&(Ye=1),Be[8]>Be[3*Ye+Ye]&&(Ye=2);var Ze=(Ye+1)%3,rt=(Ye+2)%3;$e=Math.sqrt(Be[3*Ye+Ye]-Be[3*Ze+Ze]-Be[3*rt+rt]+1),be[Ye]=.5*$e,be[3]=(Be[3*Ze+rt]-Be[3*rt+Ze])*($e=.5/$e),be[Ze]=(Be[3*Ze+Ye]+Be[3*Ye+Ze])*$e,be[rt]=(Be[3*rt+Ye]+Be[3*Ye+rt])*$e}return be}ut.clone=p.clone,ut.fromValues=p.fromValues,ut.copy=p.copy,ut.set=p.set,ut.add=p.add,ut.mul=M;var I=p.scale;ut.scale=I;var O=p.dot;ut.dot=O,ut.lerp=p.lerp;var z=p.length;ut.length=z,ut.len=z;var B=p.squaredLength;ut.squaredLength=B,ut.sqrLen=B;var G=p.normalize;ut.normalize=G,ut.exactEquals=p.exactEquals,ut.equals=p.equals;var $,H,K,ee=($=d.create(),H=d.fromValues(1,0,0),K=d.fromValues(0,1,0),function(be,Be,$e){var Ue=d.dot(Be,$e);return Ue<-.999999?(d.cross($,H,Be),d.len($)<1e-6&&d.cross($,K,Be),d.normalize($,$),C(be,$,Math.PI),be):Ue>.999999?(be[0]=0,be[1]=0,be[2]=0,be[3]=1,be):(d.cross($,Be,$e),be[0]=$[0],be[1]=$[1],be[2]=$[2],be[3]=1+Ue,G(be,be))});ut.rotationTo=ee;var ne,ve,pe=(ne=x(),ve=x(),function(be,Be,$e,Ue,Ye,Ze){return A(ne,Be,Ye,Ze),A(ve,$e,Ue,Ze),A(be,ne,ve,2*Ze*(1-Ze)),be});ut.sqlerp=pe;var fe,Fe=(fe=l.create(),function(be,Be,$e,Ue){return fe[0]=$e[0],fe[3]=$e[1],fe[6]=$e[2],fe[1]=Ue[0],fe[4]=Ue[1],fe[7]=Ue[2],fe[2]=-Be[0],fe[5]=-Be[1],fe[8]=-Be[2],G(be,D(be,fe))});return ut.setAxes=Fe,ut}var ke,He={};function yt(){if(ke)return He;function u(A){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},u(A)}ke=1,Object.defineProperty(He,"__esModule",{value:!0}),He.create=function(){var A=new a.ARRAY_TYPE(8);return a.ARRAY_TYPE!=Float32Array&&(A[0]=0,A[1]=0,A[2]=0,A[4]=0,A[5]=0,A[6]=0,A[7]=0),A[3]=1,A},He.clone=function(A){var D=new a.ARRAY_TYPE(8);return D[0]=A[0],D[1]=A[1],D[2]=A[2],D[3]=A[3],D[4]=A[4],D[5]=A[5],D[6]=A[6],D[7]=A[7],D},He.fromValues=function(A,D,I,O,z,B,G,$){var H=new a.ARRAY_TYPE(8);return H[0]=A,H[1]=D,H[2]=I,H[3]=O,H[4]=z,H[5]=B,H[6]=G,H[7]=$,H},He.fromRotationTranslationValues=function(A,D,I,O,z,B,G){var $=new a.ARRAY_TYPE(8);$[0]=A,$[1]=D,$[2]=I,$[3]=O;var H=.5*z,K=.5*B,ee=.5*G;return $[4]=H*O+K*I-ee*D,$[5]=K*O+ee*A-H*I,$[6]=ee*O+H*D-K*A,$[7]=-H*A-K*D-ee*I,$},He.fromRotationTranslation=_,He.fromTranslation=function(A,D){return A[0]=0,A[1]=0,A[2]=0,A[3]=1,A[4]=.5*D[0],A[5]=.5*D[1],A[6]=.5*D[2],A[7]=0,A},He.fromRotation=function(A,D){return A[0]=D[0],A[1]=D[1],A[2]=D[2],A[3]=D[3],A[4]=0,A[5]=0,A[6]=0,A[7]=0,A},He.fromMat4=function(A,D){var I=l.create();d.getRotation(I,D);var O=new a.ARRAY_TYPE(3);return d.getTranslation(O,D),_(A,I,O),A},He.copy=x,He.identity=function(A){return A[0]=0,A[1]=0,A[2]=0,A[3]=1,A[4]=0,A[5]=0,A[6]=0,A[7]=0,A},He.set=function(A,D,I,O,z,B,G,$,H){return A[0]=D,A[1]=I,A[2]=O,A[3]=z,A[4]=B,A[5]=G,A[6]=$,A[7]=H,A},He.getDual=function(A,D){return A[0]=D[4],A[1]=D[5],A[2]=D[6],A[3]=D[7],A},He.setDual=function(A,D){return A[4]=D[0],A[5]=D[1],A[6]=D[2],A[7]=D[3],A},He.getTranslation=function(A,D){var I=D[4],O=D[5],z=D[6],B=D[7],G=-D[0],$=-D[1],H=-D[2],K=D[3];return A[0]=2*(I*K+B*G+O*H-z*$),A[1]=2*(O*K+B*$+z*G-I*H),A[2]=2*(z*K+B*H+I*$-O*G),A},He.translate=function(A,D,I){var O=D[0],z=D[1],B=D[2],G=D[3],$=.5*I[0],H=.5*I[1],K=.5*I[2],ee=D[4],ne=D[5],ve=D[6],pe=D[7];return A[0]=O,A[1]=z,A[2]=B,A[3]=G,A[4]=G*$+z*K-B*H+ee,A[5]=G*H+B*$-O*K+ne,A[6]=G*K+O*H-z*$+ve,A[7]=-O*$-z*H-B*K+pe,A},He.rotateX=function(A,D,I){var O=-D[0],z=-D[1],B=-D[2],G=D[3],$=D[4],H=D[5],K=D[6],ee=D[7],ne=$*G+ee*O+H*B-K*z,ve=H*G+ee*z+K*O-$*B,pe=K*G+ee*B+$*z-H*O,fe=ee*G-$*O-H*z-K*B;return l.rotateX(A,D,I),A[4]=ne*(G=A[3])+fe*(O=A[0])+ve*(B=A[2])-pe*(z=A[1]),A[5]=ve*G+fe*z+pe*O-ne*B,A[6]=pe*G+fe*B+ne*z-ve*O,A[7]=fe*G-ne*O-ve*z-pe*B,A},He.rotateY=function(A,D,I){var O=-D[0],z=-D[1],B=-D[2],G=D[3],$=D[4],H=D[5],K=D[6],ee=D[7],ne=$*G+ee*O+H*B-K*z,ve=H*G+ee*z+K*O-$*B,pe=K*G+ee*B+$*z-H*O,fe=ee*G-$*O-H*z-K*B;return l.rotateY(A,D,I),A[4]=ne*(G=A[3])+fe*(O=A[0])+ve*(B=A[2])-pe*(z=A[1]),A[5]=ve*G+fe*z+pe*O-ne*B,A[6]=pe*G+fe*B+ne*z-ve*O,A[7]=fe*G-ne*O-ve*z-pe*B,A},He.rotateZ=function(A,D,I){var O=-D[0],z=-D[1],B=-D[2],G=D[3],$=D[4],H=D[5],K=D[6],ee=D[7],ne=$*G+ee*O+H*B-K*z,ve=H*G+ee*z+K*O-$*B,pe=K*G+ee*B+$*z-H*O,fe=ee*G-$*O-H*z-K*B;return l.rotateZ(A,D,I),A[4]=ne*(G=A[3])+fe*(O=A[0])+ve*(B=A[2])-pe*(z=A[1]),A[5]=ve*G+fe*z+pe*O-ne*B,A[6]=pe*G+fe*B+ne*z-ve*O,A[7]=fe*G-ne*O-ve*z-pe*B,A},He.rotateByQuatAppend=function(A,D,I){var O=I[0],z=I[1],B=I[2],G=I[3],$=D[0],H=D[1],K=D[2],ee=D[3];return A[0]=$*G+ee*O+H*B-K*z,A[1]=H*G+ee*z+K*O-$*B,A[2]=K*G+ee*B+$*z-H*O,A[3]=ee*G-$*O-H*z-K*B,A[4]=($=D[4])*G+(ee=D[7])*O+(H=D[5])*B-(K=D[6])*z,A[5]=H*G+ee*z+K*O-$*B,A[6]=K*G+ee*B+$*z-H*O,A[7]=ee*G-$*O-H*z-K*B,A},He.rotateByQuatPrepend=function(A,D,I){var O=D[0],z=D[1],B=D[2],G=D[3],$=I[0],H=I[1],K=I[2],ee=I[3];return A[0]=O*ee+G*$+z*K-B*H,A[1]=z*ee+G*H+B*$-O*K,A[2]=B*ee+G*K+O*H-z*$,A[3]=G*ee-O*$-z*H-B*K,A[4]=O*(ee=I[7])+G*($=I[4])+z*(K=I[6])-B*(H=I[5]),A[5]=z*ee+G*H+B*$-O*K,A[6]=B*ee+G*K+O*H-z*$,A[7]=G*ee-O*$-z*H-B*K,A},He.rotateAroundAxis=function(A,D,I,O){if(Math.abs(O)<a.EPSILON)return x(A,D);var z=Math.hypot(I[0],I[1],I[2]);O*=.5;var B=Math.sin(O),G=B*I[0]/z,$=B*I[1]/z,H=B*I[2]/z,K=Math.cos(O),ee=D[0],ne=D[1],ve=D[2],pe=D[3];A[0]=ee*K+pe*G+ne*H-ve*$,A[1]=ne*K+pe*$+ve*G-ee*H,A[2]=ve*K+pe*H+ee*$-ne*G,A[3]=pe*K-ee*G-ne*$-ve*H;var fe=D[4],Fe=D[5],be=D[6],Be=D[7];return A[4]=fe*K+Be*G+Fe*H-be*$,A[5]=Fe*K+Be*$+be*G-fe*H,A[6]=be*K+Be*H+fe*$-Fe*G,A[7]=Be*K-fe*G-Fe*$-be*H,A},He.add=function(A,D,I){return A[0]=D[0]+I[0],A[1]=D[1]+I[1],A[2]=D[2]+I[2],A[3]=D[3]+I[3],A[4]=D[4]+I[4],A[5]=D[5]+I[5],A[6]=D[6]+I[6],A[7]=D[7]+I[7],A},He.multiply=C,He.scale=function(A,D,I){return A[0]=D[0]*I,A[1]=D[1]*I,A[2]=D[2]*I,A[3]=D[3]*I,A[4]=D[4]*I,A[5]=D[5]*I,A[6]=D[6]*I,A[7]=D[7]*I,A},He.lerp=function(A,D,I,O){var z=1-O;return M(D,I)<0&&(O=-O),A[0]=D[0]*z+I[0]*O,A[1]=D[1]*z+I[1]*O,A[2]=D[2]*z+I[2]*O,A[3]=D[3]*z+I[3]*O,A[4]=D[4]*z+I[4]*O,A[5]=D[5]*z+I[5]*O,A[6]=D[6]*z+I[6]*O,A[7]=D[7]*z+I[7]*O,A},He.invert=function(A,D){var I=S(D);return A[0]=-D[0]/I,A[1]=-D[1]/I,A[2]=-D[2]/I,A[3]=D[3]/I,A[4]=-D[4]/I,A[5]=-D[5]/I,A[6]=-D[6]/I,A[7]=D[7]/I,A},He.conjugate=function(A,D){return A[0]=-D[0],A[1]=-D[1],A[2]=-D[2],A[3]=D[3],A[4]=-D[4],A[5]=-D[5],A[6]=-D[6],A[7]=D[7],A},He.normalize=function(A,D){var I=S(D);if(I>0){I=Math.sqrt(I);var O=D[0]/I,z=D[1]/I,B=D[2]/I,G=D[3]/I,$=D[4],H=D[5],K=D[6],ee=D[7],ne=O*$+z*H+B*K+G*ee;A[0]=O,A[1]=z,A[2]=B,A[3]=G,A[4]=($-O*ne)/I,A[5]=(H-z*ne)/I,A[6]=(K-B*ne)/I,A[7]=(ee-G*ne)/I}return A},He.str=function(A){return"quat2("+A[0]+", "+A[1]+", "+A[2]+", "+A[3]+", "+A[4]+", "+A[5]+", "+A[6]+", "+A[7]+")"},He.exactEquals=function(A,D){return A[0]===D[0]&&A[1]===D[1]&&A[2]===D[2]&&A[3]===D[3]&&A[4]===D[4]&&A[5]===D[5]&&A[6]===D[6]&&A[7]===D[7]},He.equals=function(A,D){var I=A[0],O=A[1],z=A[2],B=A[3],G=A[4],$=A[5],H=A[6],K=A[7],ee=D[0],ne=D[1],ve=D[2],pe=D[3],fe=D[4],Fe=D[5],be=D[6],Be=D[7];return Math.abs(I-ee)<=a.EPSILON*Math.max(1,Math.abs(I),Math.abs(ee))&&Math.abs(O-ne)<=a.EPSILON*Math.max(1,Math.abs(O),Math.abs(ne))&&Math.abs(z-ve)<=a.EPSILON*Math.max(1,Math.abs(z),Math.abs(ve))&&Math.abs(B-pe)<=a.EPSILON*Math.max(1,Math.abs(B),Math.abs(pe))&&Math.abs(G-fe)<=a.EPSILON*Math.max(1,Math.abs(G),Math.abs(fe))&&Math.abs($-Fe)<=a.EPSILON*Math.max(1,Math.abs($),Math.abs(Fe))&&Math.abs(H-be)<=a.EPSILON*Math.max(1,Math.abs(H),Math.abs(be))&&Math.abs(K-Be)<=a.EPSILON*Math.max(1,Math.abs(K),Math.abs(Be))},He.sqrLen=He.squaredLength=He.len=He.length=He.dot=He.mul=He.setReal=He.getReal=void 0;var a=h(N()),l=h(le()),d=h(vt());function p(A){if(typeof WeakMap!="function")return null;var D=new WeakMap,I=new WeakMap;return(p=function(O){return O?I:D})(A)}function h(A,D){if(A&&A.__esModule)return A;if(A===null||u(A)!=="object"&&typeof A!="function")return{default:A};var I=p(D);if(I&&I.has(A))return I.get(A);var O={},z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var B in A)if(B!=="default"&&Object.prototype.hasOwnProperty.call(A,B)){var G=z?Object.getOwnPropertyDescriptor(A,B):null;G&&(G.get||G.set)?Object.defineProperty(O,B,G):O[B]=A[B]}return O.default=A,I&&I.set(A,O),O}function _(A,D,I){var O=.5*I[0],z=.5*I[1],B=.5*I[2],G=D[0],$=D[1],H=D[2],K=D[3];return A[0]=G,A[1]=$,A[2]=H,A[3]=K,A[4]=O*K+z*H-B*$,A[5]=z*K+B*G-O*H,A[6]=B*K+O*$-z*G,A[7]=-O*G-z*$-B*H,A}function x(A,D){return A[0]=D[0],A[1]=D[1],A[2]=D[2],A[3]=D[3],A[4]=D[4],A[5]=D[5],A[6]=D[6],A[7]=D[7],A}function C(A,D,I){var O=D[0],z=D[1],B=D[2],G=D[3],$=I[4],H=I[5],K=I[6],ee=I[7],ne=D[4],ve=D[5],pe=D[6],fe=D[7],Fe=I[0],be=I[1],Be=I[2],$e=I[3];return A[0]=O*$e+G*Fe+z*Be-B*be,A[1]=z*$e+G*be+B*Fe-O*Be,A[2]=B*$e+G*Be+O*be-z*Fe,A[3]=G*$e-O*Fe-z*be-B*Be,A[4]=O*ee+G*$+z*K-B*H+ne*$e+fe*Fe+ve*Be-pe*be,A[5]=z*ee+G*H+B*$-O*K+ve*$e+fe*be+pe*Fe-ne*Be,A[6]=B*ee+G*K+O*H-z*$+pe*$e+fe*Be+ne*be-ve*Fe,A[7]=G*ee-O*$-z*H-B*K+fe*$e-ne*Fe-ve*be-pe*Be,A}He.getReal=l.copy,He.setReal=l.copy,He.mul=C;var M=l.dot;He.dot=M;var v=l.length;He.length=v,He.len=v;var S=l.squaredLength;return He.squaredLength=S,He.sqrLen=S,He}var li,Ai,hi={};function it(){if(li)return hi;function u(D){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},u(D)}li=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.create=d,hi.clone=function(D){var I=new a.ARRAY_TYPE(2);return I[0]=D[0],I[1]=D[1],I},hi.fromValues=function(D,I){var O=new a.ARRAY_TYPE(2);return O[0]=D,O[1]=I,O},hi.copy=function(D,I){return D[0]=I[0],D[1]=I[1],D},hi.set=function(D,I,O){return D[0]=I,D[1]=O,D},hi.add=function(D,I,O){return D[0]=I[0]+O[0],D[1]=I[1]+O[1],D},hi.subtract=p,hi.multiply=h,hi.divide=_,hi.ceil=function(D,I){return D[0]=Math.ceil(I[0]),D[1]=Math.ceil(I[1]),D},hi.floor=function(D,I){return D[0]=Math.floor(I[0]),D[1]=Math.floor(I[1]),D},hi.min=function(D,I,O){return D[0]=Math.min(I[0],O[0]),D[1]=Math.min(I[1],O[1]),D},hi.max=function(D,I,O){return D[0]=Math.max(I[0],O[0]),D[1]=Math.max(I[1],O[1]),D},hi.round=function(D,I){return D[0]=Math.round(I[0]),D[1]=Math.round(I[1]),D},hi.scale=function(D,I,O){return D[0]=I[0]*O,D[1]=I[1]*O,D},hi.scaleAndAdd=function(D,I,O,z){return D[0]=I[0]+O[0]*z,D[1]=I[1]+O[1]*z,D},hi.distance=x,hi.squaredDistance=C,hi.length=M,hi.squaredLength=v,hi.negate=function(D,I){return D[0]=-I[0],D[1]=-I[1],D},hi.inverse=function(D,I){return D[0]=1/I[0],D[1]=1/I[1],D},hi.normalize=function(D,I){var O=I[0],z=I[1],B=O*O+z*z;return B>0&&(B=1/Math.sqrt(B)),D[0]=I[0]*B,D[1]=I[1]*B,D},hi.dot=function(D,I){return D[0]*I[0]+D[1]*I[1]},hi.cross=function(D,I,O){var z=I[0]*O[1]-I[1]*O[0];return D[0]=D[1]=0,D[2]=z,D},hi.lerp=function(D,I,O,z){var B=I[0],G=I[1];return D[0]=B+z*(O[0]-B),D[1]=G+z*(O[1]-G),D},hi.random=function(D,I){I=I||1;var O=2*a.RANDOM()*Math.PI;return D[0]=Math.cos(O)*I,D[1]=Math.sin(O)*I,D},hi.transformMat2=function(D,I,O){var z=I[0],B=I[1];return D[0]=O[0]*z+O[2]*B,D[1]=O[1]*z+O[3]*B,D},hi.transformMat2d=function(D,I,O){var z=I[0],B=I[1];return D[0]=O[0]*z+O[2]*B+O[4],D[1]=O[1]*z+O[3]*B+O[5],D},hi.transformMat3=function(D,I,O){var z=I[0],B=I[1];return D[0]=O[0]*z+O[3]*B+O[6],D[1]=O[1]*z+O[4]*B+O[7],D},hi.transformMat4=function(D,I,O){var z=I[0],B=I[1];return D[0]=O[0]*z+O[4]*B+O[12],D[1]=O[1]*z+O[5]*B+O[13],D},hi.rotate=function(D,I,O,z){var B=I[0]-O[0],G=I[1]-O[1],$=Math.sin(z),H=Math.cos(z);return D[0]=B*H-G*$+O[0],D[1]=B*$+G*H+O[1],D},hi.angle=function(D,I){var O=D[0],z=D[1],B=I[0],G=I[1],$=Math.sqrt(O*O+z*z)*Math.sqrt(B*B+G*G);return Math.acos(Math.min(Math.max($&&(O*B+z*G)/$,-1),1))},hi.zero=function(D){return D[0]=0,D[1]=0,D},hi.str=function(D){return"vec2("+D[0]+", "+D[1]+")"},hi.exactEquals=function(D,I){return D[0]===I[0]&&D[1]===I[1]},hi.equals=function(D,I){var O=D[0],z=D[1],B=I[0],G=I[1];return Math.abs(O-B)<=a.EPSILON*Math.max(1,Math.abs(O),Math.abs(B))&&Math.abs(z-G)<=a.EPSILON*Math.max(1,Math.abs(z),Math.abs(G))},hi.forEach=hi.sqrLen=hi.sqrDist=hi.dist=hi.div=hi.mul=hi.sub=hi.len=void 0;var a=function(D,I){if(D&&D.__esModule)return D;if(D===null||u(D)!=="object"&&typeof D!="function")return{default:D};var O=l(void 0);if(O&&O.has(D))return O.get(D);var z={},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var G in D)if(G!=="default"&&Object.prototype.hasOwnProperty.call(D,G)){var $=B?Object.getOwnPropertyDescriptor(D,G):null;$&&($.get||$.set)?Object.defineProperty(z,G,$):z[G]=D[G]}return z.default=D,O&&O.set(D,z),z}(N());function l(D){if(typeof WeakMap!="function")return null;var I=new WeakMap,O=new WeakMap;return(l=function(z){return z?O:I})(D)}function d(){var D=new a.ARRAY_TYPE(2);return a.ARRAY_TYPE!=Float32Array&&(D[0]=0,D[1]=0),D}function p(D,I,O){return D[0]=I[0]-O[0],D[1]=I[1]-O[1],D}function h(D,I,O){return D[0]=I[0]*O[0],D[1]=I[1]*O[1],D}function _(D,I,O){return D[0]=I[0]/O[0],D[1]=I[1]/O[1],D}function x(D,I){return Math.hypot(I[0]-D[0],I[1]-D[1])}function C(D,I){var O=I[0]-D[0],z=I[1]-D[1];return O*O+z*z}function M(D){return Math.hypot(D[0],D[1])}function v(D){var I=D[0],O=D[1];return I*I+O*O}hi.len=M,hi.sub=p,hi.mul=h,hi.div=_,hi.dist=x,hi.sqrDist=C,hi.sqrLen=v;var S,A=(S=d(),function(D,I,O,z,B,G){var $,H;for(I||(I=2),O||(O=0),H=z?Math.min(z*I+O,D.length):D.length,$=O;$<H;$+=I)S[0]=D[$],S[1]=D[$+1],B(S,S,G),D[$]=S[0],D[$+1]=S[1];return D});return hi.forEach=A,hi}function pt(){if(Ai)return T;function u(D){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},u(D)}Ai=1,Object.defineProperty(T,"__esModule",{value:!0}),T.vec4=T.vec3=T.vec2=T.quat2=T.quat=T.mat4=T.mat3=T.mat2d=T.mat2=T.glMatrix=void 0;var a=A(N());T.glMatrix=a;var l=A(Z());T.mat2=l;var d=A(De());T.mat2d=d;var p=A(Ce());T.mat3=p;var h=A(vt());T.mat4=h;var _=A(le());T.quat=_;var x=A(yt());T.quat2=x;var C=A(it());T.vec2=C;var M=A(We());T.vec3=M;var v=A(xe());function S(D){if(typeof WeakMap!="function")return null;var I=new WeakMap,O=new WeakMap;return(S=function(z){return z?O:I})(D)}function A(D,I){if(D&&D.__esModule)return D;if(D===null||u(D)!=="object"&&typeof D!="function")return{default:D};var O=S(I);if(O&&O.has(D))return O.get(D);var z={},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var G in D)if(G!=="default"&&Object.prototype.hasOwnProperty.call(D,G)){var $=B?Object.getOwnPropertyDescriptor(D,G):null;$&&($.get||$.set)?Object.defineProperty(z,G,$):z[G]=D[G]}return z.default=D,O&&O.set(D,z),z}return T.vec4=v,T}var di,Cn,Oo,io,ge=pt(),Po=function(){if(Cn)return di;function u(a,l,d,p){this.cx=3*a,this.bx=3*(d-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(p-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=l,this.p2x=d,this.p2y=p}return Cn=1,di=u,u.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,l){if(l===void 0&&(l=1e-6),a<0)return 0;if(a>1)return 1;for(var d=a,p=0;p<8;p++){var h=this.sampleCurveX(d)-a;if(Math.abs(h)<l)return d;var _=this.sampleCurveDerivativeX(d);if(Math.abs(_)<1e-6)break;d-=h/_}var x=0,C=1;for(d=a,p=0;p<20&&(h=this.sampleCurveX(d),!(Math.abs(h-a)<l));p++)a>h?x=d:C=d,d=.5*(C-x)+x;return d},solve:function(a,l){return this.sampleCurveY(this.solveCurveX(a,l))}},di}(),os=g(Po);function ca(){if(io)return Oo;function u(a,l){this.x=a,this.y=l}return io=1,Oo=u,u.prototype={clone:function(){return new u(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,l){return this.clone()._rotateAround(a,l)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var l=a.x-this.x,d=a.y-this.y;return l*l+d*d},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,l){return Math.atan2(this.x*l-this.y*a,this.x*a+this.y*l)},_matMult:function(a){var l=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=l,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var l=Math.cos(a),d=Math.sin(a),p=d*this.x+l*this.y;return this.x=l*this.x-d*this.y,this.y=p,this},_rotateAround:function(a,l){var d=Math.cos(a),p=Math.sin(a),h=l.y+p*(this.x-l.x)+d*(this.y-l.y);return this.x=l.x+d*(this.x-l.x)-p*(this.y-l.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},u.convert=function(a){return a instanceof u?a:Array.isArray(a)?new u(a[0],a[1]):a},Oo}var Wt=g(ca());function Cs(u,a){if(Array.isArray(u)){if(!Array.isArray(a)||u.length!==a.length)return!1;for(let l=0;l<u.length;l++)if(!Cs(u[l],a[l]))return!1;return!0}if(typeof u=="object"&&u!==null&&a!==null){if(typeof a!="object"||Object.keys(u).length!==Object.keys(a).length)return!1;for(let l in u)if(!Cs(u[l],a[l]))return!1;return!0}return u===a}let Ha=Math.PI/180,Yl=180/Math.PI;function Mn(u){return u*Ha}function Ho(u){return u*Yl}let zs=[[0,0],[1,0],[1,1],[0,1]];function kc(u){if(u<=0)return 0;if(u>=1)return 1;let a=u*u,l=a*u;return 4*(u<.5?l:3*(u-a)+l-.75)}function Oc(u,a,l,d){let p=new os(u,a,l,d);return function(h){return p.solve(h)}}let il=Oc(.25,.1,.25,1);function pn(u,a,l){return Math.min(l,Math.max(a,u))}function Gr(u,a,l){return(l=pn((l-u)/(a-u),0,1))*l*(3-2*l)}function hu(u,a,l){let d=l-a,p=((u-a)%d+d)%d+a;return p===a?l:p}function Cr(u,a,l){if(!u.length)return l(null,[]);let d=u.length,p=new Array(u.length),h=null;u.forEach((_,x)=>{a(_,(C,M)=>{C&&(h=C),p[x]=M,--d==0&&l(h,p)})})}function Da(u,...a){for(let l of a)for(let d in l)u[d]=l[d];return u}let Kl=1;function Xl(){return Kl++}function Jd(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))}function eh(u,a){u.forEach(l=>{a[l]&&(a[l]=a[l].bind(a))})}function Pc(u,a,l){let d={};for(let p in u)d[p]=a.call(this,u[p],p,u);return d}function pu(u,a,l){let d={};for(let p in u)a.call(this,u[p],p,u)&&(d[p]=u[p]);return d}function Zn(u){return Array.isArray(u)?u.map(Zn):typeof u=="object"&&u?Pc(u,Zn):u}let ci={};function Gt(u){ci[u]||(typeof console<"u"&&console.warn(u),ci[u]=!0)}function wi(u,a,l){return(l.y-u.y)*(a.x-u.x)>(a.y-u.y)*(l.x-u.x)}function nn(u){let a=0;for(let l,d,p=0,h=u.length,_=h-1;p<h;_=p++)l=u[p],d=u[_],a+=(d.x-l.x)*(l.y+d.y);return a}function Wr([u,a,l]){let d=Mn(a+90),p=Mn(l);return{x:u*Math.cos(d)*Math.sin(p),y:u*Math.sin(d)*Math.sin(p),z:u*Math.cos(p),azimuthal:a,polar:l}}function Pi(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Bs(u){let a={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,d,p,h)=>{let _=p||h;return a[d]=!_||_.toLowerCase(),""}),a["max-age"]){let l=parseInt(a["max-age"],10);isNaN(l)?delete a["max-age"]:a["max-age"]=l}return a}let nl=null;function rl(u,a){return[u[4*a],u[4*a+1],u[4*a+2],u[4*a+3]]}function ol(u,a,l,d){for(;a<l;){let p=a+l>>1;u[p]<d?a=p+1:l=p}return a}function Ma(u,a,l,d){for(;a<l;){let p=a+l>>1;u[p]<=d?a=p+1:l=p}return a}function fu(u){return u>0?1/(1.001-u):1+u}function mt(u){return u>0?1-1/(1.001-u):-u}let Y={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Y.API_URL)return null;try{let u=new URL(Y.API_URL);return u.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":u.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function ue(u){return Y.API_URL_REGEX.test(u)}function Te(u){return Y.API_SPRITE_REGEX.test(u)}let Ne,ze,je,st,Ge,at;function gt(){return Ne==null&&(Ne=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Ne}let ft={now:()=>st!==void 0?st:performance.now(),setNow(u){st=u},restoreNow(){st=void 0},frame(u){let a=requestAnimationFrame(u);return{cancel:()=>cancelAnimationFrame(a)}},getImageData(u,a=0){let{width:l,height:d}=u;Ge||(Ge=document.createElement("canvas"));let p=Ge.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return(l>Ge.width||d>Ge.height)&&(Ge.width=l,Ge.height=d),p.clearRect(-a,-a,l+2*a,d+2*a),p.drawImage(u,0,0,l,d),p.getImageData(-a,-a,l+2*a,d+2*a)},resolveURL:u=>(ze||(ze=document.createElement("a")),ze.href=u,ze.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(je==null&&(je=window.matchMedia("(prefers-reduced-motion: reduce)")),je.matches)},hasCanvasFingerprintNoise(){if(at!==void 0)return at;if(!gt())return at=!1,!1;let u=new OffscreenCanvas(85,1),a=u.getContext("2d",{willReadFrequently:!0}),l=0;for(let p=0;p<u.width;++p)a.fillStyle=`rgba(${l++},${l++},${l++}, 255)`,a.fillRect(p,0,1,1);let d=a.getImageData(0,0,u.width,u.height);l=0;for(let p=0;p<d.data.length;++p)if(p%4!=3&&l++!==d.data[p])return at=!0,!0;return at=!1,!1}};function Bt(u,a){let l=u.indexOf("?");if(l<0)return`${u}?${new URLSearchParams(a).toString()}`;let d=new URLSearchParams(u.slice(l));for(let p in a)d.set(p,a[p]);return`${u.slice(0,l)}?${d.toString()}`}function Yt(u,a={persistentParams:[]}){let l=u.indexOf("?");if(l<0)return u;let d=new URLSearchParams,p=new URLSearchParams(u.slice(l));for(let _ of a.persistentParams){let x=p.get(_);x&&d.set(_,x)}let h=d.toString();return`${u.slice(0,l)}${h.length>0?`?${h}`:""}`}let ei="mapbox-tiles",Dt=500,Zi=50,Yi=["language","worldview","jobid"],Ke,Gi;function Sr(){try{return caches}catch{}}function gn(){let u=Sr();u&&Ke==null&&(Ke=u.open(ei))}let Rn=1/0,Un={supported:!1,testSupport:function(u){!Co&&Jr&&(ua?So(u):dn=u)}},dn,Jr,Co=!1,ua=!1,Ei=typeof self<"u"?self:{};function So(u){let a=u.createTexture();u.bindTexture(u.TEXTURE_2D,a);try{if(u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,Jr),u.isContextLost())return;Un.supported=!0}catch{}u.deleteTexture(a),Co=!0}Ei.document&&(Jr=Ei.document.createElement("img"),Jr.onload=function(){dn&&So(dn),dn=null,ua=!0},Jr.onerror=function(){Co=!0,dn=null},Jr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");let lo={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(lo);class No extends Error{constructor(a,l,d){l===401&&ue(d)&&(a+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(a),this.status=l,this.url=d}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}let xr=Pi()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Vs=function(u,a){if(!(/^file:/.test(l=u.url)||/^file:/.test(xr())&&!/^\w+:/.test(l))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(d,p){let h=new AbortController,_=new Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,referrer:xr(),referrerPolicy:d.referrerPolicy,signal:h.signal}),x=!1,C=!1,M=(v=_.url).indexOf("sku=")>0&&ue(v);var v;d.type==="json"&&_.headers.set("Accept","application/json");let S=(D,I,O)=>{if(C)return;if(D&&D.message!=="SecurityError"&&Gt(D.toString()),I&&O)return A(I);let z=Date.now();fetch(_).then(B=>{if(B.ok){let G=M?B.clone():null;return A(B,G,z)}return p(new No(B.statusText,B.status,d.url))}).catch(B=>{B.name!=="AbortError"&&p(new Error(`${B.message} ${d.url}`))})},A=(D,I,O)=>{(d.type==="arrayBuffer"?D.arrayBuffer():d.type==="json"?D.json():D.text()).then(z=>{C||(I&&O&&function(B,G,$){if(gn(),Ke==null)return;let H=Bs(G.headers.get("Cache-Control")||"");if(H["no-store"])return;let K={status:G.status,statusText:G.statusText,headers:new Headers};G.headers.forEach((ve,pe)=>K.headers.set(pe,ve)),H["max-age"]&&K.headers.set("Expires",new Date($+1e3*H["max-age"]).toUTCString());let ee=K.headers.get("Expires");if(!ee||new Date(ee).getTime()-$<42e4)return;let ne=Yt(B.url,{persistentParams:Yi});if(G.status===206){let ve=B.headers.get("Range");if(!ve)return;K.status=200,ne=Bt(ne,{range:ve})}(function(ve,pe){if(Gi===void 0)try{new Response(new ReadableStream),Gi=!0}catch{Gi=!1}Gi?pe(ve.body):ve.blob().then(pe)})(G,ve=>{let pe=new Response((fe=G.status)!==200&&fe!==404&&[101,103,204,205,304].includes(fe)?null:ve,K);var fe;gn(),Ke?.then(Fe=>Fe.put(ne,pe)).catch(Fe=>Gt(Fe.message))})}(_,I,O),x=!0,p(null,z,D.headers.get("Cache-Control"),D.headers.get("Expires")))}).catch(z=>{C||p(new Error(z.message))})};return M?function(D,I){if(gn(),Ke==null)return I(null);Ke.then(O=>{let z=Yt(D.url,{persistentParams:Yi}),B=D.headers.get("Range");B&&(z=Bt(z,{range:B})),O.match(z).then(G=>{let $=function(H){if(!H)return!1;let K=new Date(H.headers.get("Expires")||0),ee=Bs(H.headers.get("Cache-Control")||"");return K>Date.now()&&!ee["no-cache"]}(G);O.delete(z),$&&O.put(z,G.clone()),I(null,G,$)}).catch(I)}).catch(I)}(_,S):S(null,null),{cancel:()=>{C=!0,x||h.abort()}}}(u,a);if(Pi()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",u,a,void 0,!0)}var l;return function(d,p){let h=new XMLHttpRequest;h.open(d.method||"GET",d.url,!0),d.type==="arrayBuffer"&&(h.responseType="arraybuffer");for(let _ in d.headers)h.setRequestHeader(_,d.headers[_]);return d.type==="json"&&(h.responseType="text",h.setRequestHeader("Accept","application/json")),h.withCredentials=d.credentials==="include",h.onerror=()=>{p(new Error(h.statusText))},h.onload=()=>{if((h.status>=200&&h.status<300||h.status===0)&&h.response!==null){let _=h.response;if(d.type==="json")try{_=JSON.parse(h.response)}catch(x){return p(x)}p(null,_,h.getResponseHeader("Cache-Control"),h.getResponseHeader("Expires"))}else p(new No(h.statusText,h.status,d.url))},h.send(d.body),{cancel:()=>h.abort()}}(u,a)},js=function(u,a){return Vs(Da(u,{type:"arrayBuffer"}),a)};function Qp(u){let a=document.createElement("a");return a.href=u,a.protocol===location.protocol&&a.host===location.host}let Sl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",Xh,th;Xh=[],th=0;let Ju=function(u,a){if(Un.supported&&(u.headers||(u.headers={}),u.headers.accept="image/webp,*/*"),th>=Y.MAX_PARALLEL_IMAGE_REQUESTS){let h={requestParameters:u,callback:a,cancelled:!1,cancel(){this.cancelled=!0}};return Xh.push(h),h}th++;let l=!1,d=()=>{if(!l)for(l=!0,th--;Xh.length&&th<Y.MAX_PARALLEL_IMAGE_REQUESTS;){let h=Xh.shift(),{requestParameters:_,callback:x,cancelled:C}=h;C||(h.cancel=Ju(_,x).cancel)}},p=js(u,(h,_,x,C)=>{d(),h?a(h):_&&(self.createImageBitmap?function(M,v){let S=new Blob([new Uint8Array(M)],{type:"image/png"});createImageBitmap(S).then(A=>{v(null,A)}).catch(A=>{v(new Error(`Could not load image because of ${A.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(_,(M,v)=>a(M,v,x,C)):function(M,v){let S=new Image;S.onload=()=>{v(null,S),URL.revokeObjectURL(S.src),S.onload=null,requestAnimationFrame(()=>{S.src=Sl})},S.onerror=()=>v(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let A=new Blob([new Uint8Array(M)],{type:"image/png"});S.src=M.byteLength?URL.createObjectURL(A):Sl}(_,(M,v)=>a(M,v,x,C)))});return{cancel:()=>{p.cancel(),d()}}};var Ql,Jp,Qh,ed={exports:{}},_a={exports:{}},Ss={exports:{}},as=function(){if(Qh)return ed.exports;Qh=1;var u=(Ql||(Ql=1,_a.exports=function(l,d){var p,h,_,x,C,M,v,S;for(h=l.length-(p=3&l.length),_=d,C=3432918353,M=461845907,S=0;S<h;)v=255&l.charCodeAt(S)|(255&l.charCodeAt(++S))<<8|(255&l.charCodeAt(++S))<<16|(255&l.charCodeAt(++S))<<24,++S,_=27492+(65535&(x=5*(65535&(_=(_^=v=(65535&(v=(v=(65535&v)*C+(((v>>>16)*C&65535)<<16)&4294967295)<<15|v>>>17))*M+(((v>>>16)*M&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(v=0,p){case 3:v^=(255&l.charCodeAt(S+2))<<16;case 2:v^=(255&l.charCodeAt(S+1))<<8;case 1:_^=v=(65535&(v=(v=(65535&(v^=255&l.charCodeAt(S)))*C+(((v>>>16)*C&65535)<<16)&4294967295)<<15|v>>>17))*M+(((v>>>16)*M&65535)<<16)&4294967295}return _^=l.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}),_a.exports),a=(Jp||(Jp=1,Ss.exports=function(l,d){for(var p,h=l.length,_=d^h,x=0;h>=4;)p=1540483477*(65535&(p=255&l.charCodeAt(x)|(255&l.charCodeAt(++x))<<8|(255&l.charCodeAt(++x))<<16|(255&l.charCodeAt(++x))<<24))+((1540483477*(p>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),h-=4,++x;switch(h){case 3:_^=(255&l.charCodeAt(x+2))<<16;case 2:_^=(255&l.charCodeAt(x+1))<<8;case 1:_=1540483477*(65535&(_^=255&l.charCodeAt(x)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}),Ss.exports);return ed.exports=u,ed.exports.murmur3=u,ed.exports.murmur2=a,ed.exports}(),rr=g(as);class Ts{constructor(a,...l){Da(this,l[0]||{}),this.type=a}}class Ia extends Ts{constructor(a,l={}){super("error",Da({error:a},l))}}function mu(u,a,l){l[u]&&l[u].indexOf(a)!==-1||(l[u]=l[u]||[],l[u].push(a))}function gu(u,a,l){if(l&&l[u]){let d=l[u].indexOf(a);d!==-1&&l[u].splice(d,1)}}class ss{on(a,l){return this._listeners=this._listeners||{},mu(a,l,this._listeners),this}off(a,l){return gu(a,l,this._listeners),gu(a,l,this._oneTimeListeners),this}once(a,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},mu(a,l,this._oneTimeListeners),this):new Promise(d=>{this.once(a,d)})}fire(a,l){let d=typeof a=="string"?new Ts(a,l):a,p=d.type;if(this.listens(p)){d.target=this;let h=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(let C of h)C.call(this,d);let _=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(let C of _)gu(p,C,this._oneTimeListeners),C.call(this,d);let x=this._eventedParent;x&&(Da(d,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(d))}else d instanceof Ia&&console.error(d.error);return this}listens(a){return!!(this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a))}setEventedParent(a,l){return this._eventedParent=a,this._eventedParentData=l,this}}class ls{constructor(a){typeof a=="string"?this.name=a:(this.name=a.name,this.iconsetId=a.iconsetId)}static from(a){return new ls(a)}static toString(a){return a.iconsetId?`${a.name}${a.iconsetId}`:a.name}static parse(a){let[l,d]=a.split("");return new ls({name:l,iconsetId:d})}static isEqual(a,l){return a.name===l.name&&a.iconsetId===l.iconsetId}toString(){return ls.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var Jl,Hm={},al=function(){if(Jl)return Hm;Jl=1;var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function a(h){return(h=Math.round(h))<0?0:h>255?255:h}function l(h){return a(h[h.length-1]==="%"?parseFloat(h)/100*255:parseInt(h))}function d(h){return(_=h[h.length-1]==="%"?parseFloat(h)/100:parseFloat(h))<0?0:_>1?1:_;var _}function p(h,_,x){return x<0?x+=1:x>1&&(x-=1),6*x<1?h+(_-h)*x*6:2*x<1?_:3*x<2?h+(_-h)*(2/3-x)*6:h}try{Hm.parseCSSColor=function(h){var _,x=h.replace(/ /g,"").toLowerCase();if(x in u)return u[x].slice();if(x[0]==="#")return x.length===4?(_=parseInt(x.substr(1),16))>=0&&_<=4095?[(3840&_)>>4|(3840&_)>>8,240&_|(240&_)>>4,15&_|(15&_)<<4,1]:null:x.length===7&&(_=parseInt(x.substr(1),16))>=0&&_<=16777215?[(16711680&_)>>16,(65280&_)>>8,255&_,1]:null;var C=x.indexOf("("),M=x.indexOf(")");if(C!==-1&&M+1===x.length){var v=x.substr(0,C),S=x.substr(C+1,M-(C+1)).split(","),A=1;switch(v){case"rgba":if(S.length!==4)return null;A=d(S.pop());case"rgb":return S.length!==3?null:[l(S[0]),l(S[1]),l(S[2]),A];case"hsla":if(S.length!==4)return null;A=d(S.pop());case"hsl":if(S.length!==3)return null;var D=(parseFloat(S[0])%360+360)%360/360,I=d(S[1]),O=d(S[2]),z=O<=.5?O*(I+1):O+I-O*I,B=2*O-z;return[a(255*p(B,z,D+1/3)),a(255*p(B,z,D)),a(255*p(B,z,D-1/3)),A];default:return null}}return null}}catch{}return Hm}();class Ui{constructor(a,l,d,p=1){this.r=a,this.g=l,this.b=d,this.a=p}static parse(a){if(!a)return;if(a instanceof Ui)return a;if(typeof a!="string")return;let l=al.parseCSSColor(a);return l?new Ui(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3]):void 0}toStringPremultipliedAlpha(){let[a,l,d,p]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(a)},${Math.round(l)},${Math.round(d)},${p})`}toString(){let[a,l,d,p]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*a)},${Math.round(255*l)},${Math.round(255*d)},${p})`}toRenderColor(a){let{r:l,g:d,b:p,a:h}=this;return new or(a,l,d,p,h)}clone(){return new Ui(this.r,this.g,this.b,this.a)}}class or{constructor(a,l,d,p,h){if(a){let _=a.image.height,x=_*_;l=h===0?0:l/h*(_-1),d=h===0?0:d/h*(_-1),p=h===0?0:p/h*(_-1);let C=Math.floor(l),M=Math.floor(d),v=Math.floor(p),S=Math.ceil(l),A=Math.ceil(d),D=Math.ceil(p),I=l-C,O=d-M,z=p-v,B=a.image.data,G=4*(C+M*x+v*_),$=4*(C+M*x+D*_),H=4*(C+A*x+v*_),K=4*(C+A*x+D*_),ee=4*(S+M*x+v*_),ne=4*(S+M*x+D*_),ve=4*(S+A*x+v*_),pe=4*(S+A*x+D*_);if(G<0||pe>=B.length)throw new Error("out of range");this.r=pi(pi(pi(B[G],B[$],z),pi(B[H],B[K],z),O),pi(pi(B[ee],B[ne],z),pi(B[ve],B[pe],z),O),I)/255*h,this.g=pi(pi(pi(B[G+1],B[$+1],z),pi(B[H+1],B[K+1],z),O),pi(pi(B[ee+1],B[ne+1],z),pi(B[ve+1],B[pe+1],z),O),I)/255*h,this.b=pi(pi(pi(B[G+2],B[$+2],z),pi(B[H+2],B[K+2],z),O),pi(pi(B[ee+2],B[ne+2],z),pi(B[ve+2],B[pe+2],z),O),I)/255*h,this.a=h}else this.r=l,this.g=d,this.b=p,this.a=h}toArray(){let{r:a,g:l,b:d,a:p}=this;return p===0?[0,0,0,0]:[255*a/p,255*l/p,255*d/p,p]}toHslaArray(){if(this.a===0)return[0,0,0,0];let{r:a,g:l,b:d,a:p}=this,h=Math.min(Math.max(a/p,0),1),_=Math.min(Math.max(l/p,0),1),x=Math.min(Math.max(d/p,0),1),C=Math.min(h,_,x),M=Math.max(h,_,x),v=(C+M)/2;if(C===M)return[0,0,100*v,p];let S=M-C,A=v>.5?S/(2-M-C):S/(M+C),D=0;return M===h?D=(_-x)/S+(_<x?6:0):M===_?D=(x-h)/S+2:M===x&&(D=(h-_)/S+4),D*=60,[Math.min(Math.max(D,0),360),Math.min(Math.max(100*A,0),100),Math.min(Math.max(100*v,0),100),p]}toArray01(){let{r:a,g:l,b:d,a:p}=this;return p===0?[0,0,0,0]:[a/p,l/p,d/p,p]}toArray01Scaled(a){let{r:l,g:d,b:p,a:h}=this;return h===0?[0,0,0]:[l/h*a,d/h*a,p/h*a]}toArray01PremultipliedAlpha(){let{r:a,g:l,b:d,a:p}=this;return[a,l,d,p]}toArray01Linear(){let{r:a,g:l,b:d,a:p}=this;return p===0?[0,0,0,0]:[Math.pow(a/p,2.2),Math.pow(l/p,2.2),Math.pow(d/p,2.2),p]}}function pi(u,a,l){return u*(1-l)+a*l}function Tl(u,a,l){return u.map((d,p)=>pi(d,a[p],l))}function Dl(u){return u*u*u*u*u}Ui.black=new Ui(0,0,0,1),Ui.white=new Ui(1,1,1,1),Ui.transparent=new Ui(0,0,0,0),Ui.red=new Ui(1,0,0,1),Ui.blue=new Ui(0,0,1,1);var Nc=Object.freeze({__proto__:null,array:Tl,color:function(u,a,l){return new Ui(pi(u.r,a.r,l),pi(u.g,a.g,l),pi(u.b,a.b,l),pi(u.a,a.a,l))},easeIn:Dl,number:pi});function Sn(u,...a){for(let l of a)for(let d in l)u[d]=l[d];return u}class yn extends Error{constructor(a,l){super(l),this.message=l,this.key=a}}class td{constructor(a,l=[]){this.parent=a,this.bindings={};for(let[d,p]of l)this.bindings[d]=p}concat(a){return new td(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}let _u={kind:"null"},fi={kind:"number"},jn={kind:"string"},kn={kind:"boolean"},Xo={kind:"color"},ih={kind:"object"},Vn={kind:"value"},To={kind:"collator"},yu={kind:"formatted"},Lc={kind:"resolvedImage"};function ya(u,a){return{kind:"array",itemType:u,N:a}}function jr(u){if(u.kind==="array"){let a=jr(u.itemType);return typeof u.N=="number"?`array<${a}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${a}>`}return u.kind}let rn=[_u,fi,jn,kn,Xo,yu,ih,ya(Vn),Lc];function cr(u,a){if(a.kind==="error")return null;if(u.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!cr(u.itemType,a.itemType))&&(typeof u.N!="number"||u.N===a.N))return null}else{if(u.kind===a.kind)return null;if(u.kind==="value"){for(let l of rn)if(!cr(l,a))return null}}return`Expected ${jr(u)} but found ${jr(a)} instead.`}function ec(u,a){return a.some(l=>l.kind===u.kind)}function tc(u,a){return a.some(l=>l==="null"?u===null:l==="array"?Array.isArray(u):l==="object"?u&&!Array.isArray(u)&&typeof u=="object":l===typeof u)}class Ml{constructor(a,l,d){this.sensitivity=a?l?"variant":"case":l?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,l){return this.collator.compare(a,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class id{constructor(a,l,d,p,h){this.text=a.normalize?a.normalize():a,this.image=l,this.scale=d,this.fontStack=p,this.textColor=h}}class Aa{constructor(a){this.sections=a}static fromString(a){return new Aa([new id(a,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(a=>a.text.length!==0||!!a.image&&a.image.hasPrimary())}static factory(a){return a instanceof Aa?a:Aa.fromString(a)}toString(){return this.sections.length===0?"":this.sections.map(a=>a.text).join("")}serialize(){let a=["format"];for(let l of this.sections){if(l.image){let p=l.image.getPrimary().id.toString();a.push(["image",p]);continue}a.push(l.text);let d={};l.fontStack&&(d["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(d["font-scale"]=l.scale),l.textColor&&(d["text-color"]=["rgba"].concat(l.textColor.toRenderColor(null).toArray())),a.push(d)}return a}}class ic{constructor(a,l={}){if(this.id=ls.from(a),this.options=Object.assign({},l),l.transform){let{a:d,b:p,c:h,d:_,e:x,f:C}=l.transform;this.options.transform=new DOMMatrix([d,p,h,_,x,C])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){let{a,b:l,c:d,d:p,e:h,f:_}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a,b:l,c:d,d:p,e:h,f:_}})}static parse(a){let l,d,p,h;try{({name:l,iconsetId:d,params:p,transform:h}=JSON.parse(a)||{})}catch{return null}if(!l)return null;let{a:_,b:x,c:C,d:M,e:v,f:S}=h||{};return new ic({name:l,iconsetId:d},{params:p,transform:new DOMMatrix([_,x,C,M,v,S])})}scaleSelf(a){return this.options.transform.scaleSelf(a),this}}class va{constructor(a,l,d,p,h=!1){this.primaryId=ls.from(a),this.primaryOptions=l,d&&(this.secondaryId=ls.from(d)),this.secondaryOptions=p,this.available=h}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new ic(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new ic(this.secondaryId,this.secondaryOptions):null}static from(a){return typeof a=="string"?va.build({name:a}):a}static build(a,l,d,p){return!a||typeof a=="object"&&!("name"in a)?null:new va(a,d,l,p)}}function Jh(u,a,l,d){return typeof u=="number"&&u>=0&&u<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof l=="number"&&l>=0&&l<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:`Invalid rgba value [${[u,a,l,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof d=="number"?[u,a,l,d]:[u,a,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Il(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof Ui||u instanceof Ml||u instanceof Aa||u instanceof va)return!0;if(Array.isArray(u)){for(let a of u)if(!Il(a))return!1;return!0}if(typeof u=="object"){for(let a in u)if(!Il(u[a]))return!1;return!0}return!1}function Do(u){if(u===null)return _u;if(typeof u=="string")return jn;if(typeof u=="boolean")return kn;if(typeof u=="number")return fi;if(u instanceof Ui)return Xo;if(u instanceof Ml)return To;if(u instanceof Aa)return yu;if(u instanceof va)return Lc;if(Array.isArray(u)){let a=u.length,l;for(let d of u){let p=Do(d);if(l){if(l===p)continue;l=Vn;break}l=p}return ya(l||Vn,a)}return ih}function Qo(u){let a=typeof u;return u===null?"":a==="string"||a==="number"||a==="boolean"?String(u):u instanceof Ui?u.toStringPremultipliedAlpha():u instanceof Aa||u instanceof va?u.toString():JSON.stringify(u)}class Fc{constructor(a,l){this.type=a,this.value=l}static parse(a,l){if(a.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!Il(a[1]))return l.error("invalid value");let d=a[1],p=Do(d),h=l.expectedType;return p.kind!=="array"||p.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(p=h),new Fc(p,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Ui?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Aa?this.value.serialize():this.value}}class mo{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}}let qm={string:jn,number:fi,boolean:kn,object:ih};class Us{constructor(a,l){this.type=a,this.args=l}static parse(a,l){if(a.length<2)return l.error("Expected at least one argument.");let d,p=1,h=a[0];if(h==="array"){let x,C;if(a.length>2){let M=a[1];if(typeof M!="string"||!(M in qm)||M==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);x=qm[M],p++}else x=Vn;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return l.error('The length argument to "array" must be a positive integer literal',2);C=a[2],p++}d=ya(x,C)}else d=qm[h];let _=[];for(;p<a.length;p++){let x=l.parse(a[p],p,Vn);if(!x)return null;_.push(x)}return new Us(d,_)}evaluate(a){for(let l=0;l<this.args.length;l++){let d=this.args[l].evaluate(a);if(!cr(this.type,Do(d)))return d;if(l===this.args.length-1)throw new mo(`The expression ${JSON.stringify(this.args[l].serialize())} evaluated to ${jr(Do(d))} but was expected to be of type ${jr(this.type)}.`)}return null}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){let a=this.type,l=[a.kind];if(a.kind==="array"){let d=a.itemType;if(d.kind==="string"||d.kind==="number"||d.kind==="boolean"){l.push(d.kind);let p=a.N;(typeof p=="number"||this.args.length>1)&&l.push(p)}}return l.concat(this.args.map(d=>d.serialize()))}}class nh{constructor(a){this.type=yu,this.sections=a}static parse(a,l){if(a.length<2)return l.error("Expected at least one argument.");let d=a[1];if(!Array.isArray(d)&&typeof d=="object")return l.error("First argument must be an image or text section.");let p=[],h=!1;for(let _=1;_<=a.length-1;++_){let x=a[_];if(h&&typeof x=="object"&&!Array.isArray(x)){h=!1;let C=null;if(x["font-scale"]&&(C=l.parseObjectValue(x["font-scale"],_,"font-scale",fi),!C))return null;let M=null;if(x["text-font"]&&(M=l.parseObjectValue(x["text-font"],_,"text-font",ya(jn)),!M))return null;let v=null;if(x["text-color"]&&(v=l.parseObjectValue(x["text-color"],_,"text-color",Xo),!v))return null;let S=p[p.length-1];S.scale=C,S.font=M,S.textColor=v}else{let C=l.parse(a[_],_,Vn);if(!C)return null;let M=C.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,p.push({content:C,scale:null,font:null,textColor:null})}}return new nh(p)}evaluate(a){return new Aa(this.sections.map(l=>{let d=l.content.evaluate(a);return Do(d)===Lc?new id("",d,null,null,null):new id(Qo(d),null,l.scale?l.scale.evaluate(a):null,l.font?l.font.evaluate(a).join(","):null,l.textColor?l.textColor.evaluate(a):null)}))}eachChild(a){for(let l of this.sections)a(l.content),l.scale&&a(l.scale),l.font&&a(l.font),l.textColor&&a(l.textColor)}outputDefined(){return!1}serialize(){let a=["format"];for(let l of this.sections){a.push(l.content.serialize());let d={};l.scale&&(d["font-scale"]=l.scale.serialize()),l.font&&(d["text-font"]=l.font.serialize()),l.textColor&&(d["text-color"]=l.textColor.serialize()),a.push(d)}return a}}class vu{constructor(a,l,d,p){this._imageWarnHistory={},this.type=Lc,this.namePrimary=a,this.nameSecondary=l,d&&(this.paramsPrimary=d.params,this.iconsetIdPrimary=d.iconset?d.iconset.id:void 0),p&&(this.paramsSecondary=p.params,this.iconsetIdSecondary=p.iconset?p.iconset.id:void 0)}static parse(a,l){if(a.length<2)return l.error("Expected two or more arguments.");let d=1,p=[];function h(){if(d<a.length){let x=l.parse(a[d],d++,jn);return x?(p.push({image:x,options:{}}),!0):(l.error(p.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function _(){if(d<a.length){let C=a[d];if((x=C)===null||typeof x!="object"||Array.isArray(x))return!0;let M=C.params,v=C.iconset,S=l.concat(d);if(!M&&!v)return d++,!0;if(M){if(typeof M!="object"||M.constructor!==Object)return S.error('Image options "params" should be an object'),!1;let A={},D=S.concat(void 0,"params");for(let I in M){if(!I)return D.error("Image parameter name should be non-empty"),!1;let O=D.concat(void 0,I).parse(M[I],void 0,Xo,void 0,{typeAnnotation:"coerce"});if(!O)return!1;A[I]=O}p[p.length-1].options.params=A}if(v){if(typeof v!="object"||v.constructor!==Object)return S.error('Image options "iconset" should be an object'),!1;if(!v.id)return S.error('Image options "iconset" should have an "id" property'),!1;p[p.length-1].options.iconset=v}return d++,!0}var x;return!0}for(let x=0;x<2;x++)if(!h()||!_())return;return new vu(p[0].image,p[1]?p[1].image:void 0,p[0].options,p[1]?p[1].options:void 0)}evaluateParams(a,l){let d={};if(l){for(let p in l)if(l[p])try{d[p]=l[p].evaluate(a)}catch{continue}if(Object.keys(d).length!==0)return{params:d}}}evaluate(a){let l={name:this.namePrimary.evaluate(a),iconsetId:this.iconsetIdPrimary},d=this.nameSecondary?{name:this.nameSecondary.evaluate(a),iconsetId:this.iconsetIdSecondary}:void 0,p=va.build(l,d,this.paramsPrimary?this.evaluateParams(a,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(a,this.paramsSecondary):void 0);if(p&&a.availableImages){let h=p.getPrimary().id;if(p.available=a.availableImages.some(_=>ls.isEqual(_,h)),p.available){let _=p.getSecondary()?p.getSecondary().id:null;_&&(p.available=a.availableImages.some(x=>ls.isEqual(x,_)))}}return p}eachChild(a){if(a(this.namePrimary),this.paramsPrimary)for(let l in this.paramsPrimary)this.paramsPrimary[l]&&a(this.paramsPrimary[l]);if(this.nameSecondary&&(a(this.nameSecondary),this.paramsSecondary))for(let l in this.paramsSecondary)this.paramsSecondary[l]&&a(this.paramsSecondary[l])}outputDefined(){return!1}serializeOptions(a,l){let d={};if(l&&(d.iconset={id:l}),a){d.params={};for(let p in a)a[p]&&(d.params[p]=a[p].serialize())}return Object.keys(d).length>0?d:void 0}serialize(){let a=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){let l=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);l&&a.push(l)}if(this.nameSecondary&&(a.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){let l=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);l&&a.push(l)}return a}}function zc(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}let nc={"to-boolean":kn,"to-color":Xo,"to-number":fi,"to-string":jn};class Bc{constructor(a,l){this.type=a,this.args=l}static parse(a,l){if(a.length<2)return l.error("Expected at least one argument.");let d=a[0],p=[],h=_u;if(d==="to-array"){if(!Array.isArray(a[1]))return null;let _=a[1].length;if(l.expectedType){if(l.expectedType.kind!=="array")return l.error(`Expected ${l.expectedType.kind} but found array.`);h=ya(l.expectedType.itemType,_)}else{if(!(_>0&&Il(a[1][0])))return null;h=ya(Do(a[1][0]),_)}for(let x=0;x<_;x++){let C=a[1][x],M;if(zc(C)==="array")M=l.parse(C,void 0,h.itemType);else{let v=zc(C);if(v!==h.itemType.kind)return l.error(`Expected ${h.itemType.kind} but found ${v}.`);M=l.registry.literal.parse(["literal",C===void 0?null:C],l)}if(!M)return null;p.push(M)}}else{if((d==="to-boolean"||d==="to-string")&&a.length!==2)return l.error("Expected one argument.");h=nc[d];for(let _=1;_<a.length;_++){let x=l.parse(a[_],_,Vn);if(!x)return null;p.push(x)}}return new Bc(h,p)}evaluate(a){if(this.type.kind==="boolean")return!!this.args[0].evaluate(a);if(this.type.kind==="color"){let l,d;for(let p of this.args){if(l=p.evaluate(a),d=null,l instanceof Ui)return l;if(typeof l=="string"){let h=a.parseColor(l);if(h)return h}else if(Array.isArray(l)&&(d=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:Jh(l[0],l[1],l[2],l[3]),!d))return new Ui(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new mo(d||`Could not parse color from value '${typeof l=="string"?l:String(JSON.stringify(l))}'`)}if(this.type.kind==="number"){let l=null;for(let d of this.args){if(l=d.evaluate(a),l===null)return 0;let p=Number(l);if(!isNaN(p))return p}throw new mo(`Could not convert ${JSON.stringify(l)} to number.`)}return this.type.kind==="formatted"?Aa.fromString(Qo(this.args[0].evaluate(a))):this.type.kind==="resolvedImage"?va.build(Qo(this.args[0].evaluate(a))):this.type.kind==="array"?this.args.map(l=>l.evaluate(a)):Qo(this.args[0].evaluate(a))}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){if(this.type.kind==="formatted")return new nh([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new vu(this.args[0]).serialize();let a=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(l=>{a.push(l.serialize())}),a}}let W0=["Unknown","Point","LineString","Polygon"];class rh{constructor(a,l){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=a,this.options=l}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?W0[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(a){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){let a=this.featureDistanceData.center,l=this.featureDistanceData.scale,{x:d,y:p}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(d*l-a[0])+this.featureDistanceData.bearing[1]*(p*l-a[1])}return 0}parseColor(a){let l=this._parseColorCache[a];return l||(l=this._parseColorCache[a]=Ui.parse(a)),l}getConfig(a){return this.options?this.options.get(a):null}}class qa{constructor(a,l,d,p,h){this.name=a,this.type=l,this._evaluate=d,this.args=p,this._overloadIndex=h}evaluate(a){if(!this._evaluate){let l=qa.definitions[this.name];this._evaluate=Array.isArray(l)?l[2]:l.overloads[this._overloadIndex][1]}return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(a=>a.serialize()))}static parse(a,l){let d=a[0],p=qa.definitions[d];if(!p)return l.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);let h=Array.isArray(p)?p[0]:p.type,_=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,x=[],C=null,M=-1;for(let[v,S]of _){if(Array.isArray(v)&&v.length!==a.length-1)continue;x.push(v),M++,C=new ap(l.registry,l.path,null,l.scope,void 0,l._scope,l.options);let A=[],D=!1;for(let I=1;I<a.length;I++){let O=a[I],z=Array.isArray(v)?v[I-1]:v.type,B=C.parse(O,1+A.length,z);if(!B){D=!0;break}A.push(B)}if(!D)if(Array.isArray(v)&&v.length!==A.length)C.error(`Expected ${v.length} arguments, but found ${A.length} instead.`);else{for(let I=0;I<A.length;I++){let O=Array.isArray(v)?v[I]:v.type,z=A[I];C.concat(I+1).checkSubtype(O,z.type)}if(C.errors.length===0)return new qa(d,h,S,A,M)}}if(x.length===1)l.errors.push(...C.errors);else{let v=(x.length?x:_.map(([A])=>A)).map(Bv).join(" | "),S=[];for(let A=1;A<a.length;A++){let D=l.parse(a[A],1+S.length);if(!D)return null;S.push(jr(D.type))}l.error(`Expected arguments of type ${v}, but found (${S.join(", ")}) instead.`)}return null}static register(a,l){qa.definitions=l;for(let d in l)a[d]=qa}}function Bv(u){return Array.isArray(u)?`(${u.map(jr).join(", ")})`:`(${jr(u.type)}...)`}class nd{constructor(a,l,d){this.type=To,this.locale=d,this.caseSensitive=a,this.diacriticSensitive=l}static parse(a,l){if(a.length!==2)return l.error("Expected one argument.");let d=a[1];if(typeof d!="object"||Array.isArray(d))return l.error("Collator options argument must be an object.");let p=d["case-sensitive"]===void 0?l.parse(!1,1,kn):l.parseObjectValue(d["case-sensitive"],1,"case-sensitive",kn);if(!p)return null;let h=d["diacritic-sensitive"]===void 0?l.parse(!1,1,kn):l.parseObjectValue(d["diacritic-sensitive"],1,"diacritic-sensitive",kn);if(!h)return null;let _=null;return d.locale&&(_=l.parseObjectValue(d.locale,1,"locale",jn),!_)?null:new nd(p,h,_)}evaluate(a){return new Ml(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}serialize(){let a={};return a["case-sensitive"]=this.caseSensitive.serialize(),a["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(a.locale=this.locale.serialize()),["collator",a]}}function Vc(u,a,l=0,d=u.length-1,p=Vv){for(;d>l;){if(d-l>600){let C=d-l+1,M=a-l+1,v=Math.log(C),S=.5*Math.exp(2*v/3),A=.5*Math.sqrt(v*S*(C-S)/C)*(M-C/2<0?-1:1);Vc(u,a,Math.max(l,Math.floor(a-M*S/C+A)),Math.min(d,Math.floor(a+(C-M)*S/C+A)),p)}let h=u[a],_=l,x=d;for(ep(u,l,a),p(u[d],h)>0&&ep(u,l,d);_<x;){for(ep(u,_,x),_++,x--;p(u[_],h)<0;)_++;for(;p(u[x],h)>0;)x--}p(u[l],h)===0?ep(u,l,x):(x++,ep(u,x,d)),x<=a&&(l=x+1),a<=x&&(d=x-1)}}function ep(u,a,l){let d=u[a];u[a]=u[l],u[l]=d}function Vv(u,a){return u<a?-1:u>a?1:0}function $m(u){let a=0;for(let l,d,p=0,h=u.length,_=h-1;p<h;_=p++)l=u[p],d=u[_],a+=(d.x-l.x)*(l.y+d.y);return a}function tp(u,a){u[0]=Math.min(u[0],a[0]),u[1]=Math.min(u[1],a[1]),u[2]=Math.max(u[2],a[0]),u[3]=Math.max(u[3],a[1])}function Ds(u,a){return!(u[0]<=a[0]||u[2]>=a[2]||u[1]<=a[1]||u[3]>=a[3])}function Gm(u,a,l){let d=u[0]-a[0],p=u[1]-a[1],h=u[0]-l[0],_=u[1]-l[1];return d*_-h*p==0&&d*h<=0&&p*_<=0}function rd(u,a,l=!1){let d=!1;for(let x=0,C=a.length;x<C;x++){let M=a[x];for(let v=0,S=M.length,A=S-1;v<S;A=v++){let D=M[A],I=M[v];if(Gm(u,D,I))return l;(h=D)[1]>(p=u)[1]!=(_=I)[1]>p[1]&&p[0]<(_[0]-h[0])*(p[1]-h[1])/(_[1]-h[1])+h[0]&&(d=!d)}}var p,h,_;return d}function bu(u,a,l,d){let p=d[0]-l[0],h=d[1]-l[1],_=(u[0]-l[0])*h-p*(u[1]-l[1]),x=(a[0]-l[0])*h-p*(a[1]-l[1]);return _>0&&x<0||_<0&&x>0}function od(u,a,l,d){return(p=[d[0]-l[0],d[1]-l[1]])[0]*(h=[a[0]-u[0],a[1]-u[1]])[1]-p[1]*h[0]!=0&&!(!bu(u,a,l,d)||!bu(l,d,u,a));var p,h}let Al=8192;function oh(u,a){let l=(180+u[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,p=Math.pow(2,a.z);return[Math.round(l*p*Al),Math.round(d*p*Al)]}function Wm(u,a){for(let l=0;l<a.length;l++)if(rd(u,a[l]))return!0;return!1}function xu(u,a,l){for(let d of l)for(let p=0,h=d.length,_=h-1;p<h;_=p++)if(od(u,a,d[_],d[p]))return!0;return!1}function ip(u,a){for(let l=0;l<u.length;++l)if(!rd(u[l],a))return!1;for(let l=0;l<u.length-1;++l)if(xu(u[l],u[l+1],a))return!1;return!0}function Z0(u,a){for(let l=0;l<a.length;l++)if(ip(u,a[l]))return!0;return!1}function wu(u,a,l){let d=[];for(let p=0;p<u.length;p++){let h=[];for(let _=0;_<u[p].length;_++){let x=oh(u[p][_],l);tp(a,x),h.push(x)}d.push(h)}return d}function _n(u,a,l){let d=[];for(let p=0;p<u.length;p++){let h=wu(u[p],a,l);d.push(h)}return d}function xi(u,a,l,d){if(u[0]<l[0]||u[0]>l[2]){let p=.5*d,h=u[0]-l[0]>p?-d:l[0]-u[0]>p?d:0;h===0&&(h=u[0]-l[2]>p?-d:l[2]-u[0]>p?d:0),u[0]+=h}tp(a,u)}function ef(u,a,l,d){let p=Math.pow(2,d.z)*Al,h=[d.x*Al,d.y*Al],_=[];if(!u)return _;for(let x of u)for(let C of x){let M=[C.x+h[0],C.y+h[1]];xi(M,a,l,p),_.push(M)}return _}function en(u,a,l,d){let p=Math.pow(2,d.z)*Al,h=[d.x*Al,d.y*Al],_=[];if(!u)return _;for(let C of u){let M=[];for(let v of C){let S=[v.x+h[0],v.y+h[1]];tp(a,S),M.push(S)}_.push(M)}if(a[2]-a[0]<=p/2){(x=a)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(let C of _)for(let M of C)xi(M,a,l,p)}var x;return _}class jc{constructor(a,l){this.type=kn,this.geojson=a,this.geometries=l}static parse(a,l){if(a.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(Il(a[1])){let d=a[1];if(d.type==="FeatureCollection")for(let p=0;p<d.features.length;++p){let h=d.features[p].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new jc(d,d.features[p].geometry)}else if(d.type==="Feature"){let p=d.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new jc(d,d.geometry)}else if(d.type==="Polygon"||d.type==="MultiPolygon")return new jc(d,d)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(l,d){let p=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],_=l.canonicalID();if(!_)return!1;if(d.type==="Polygon"){let x=wu(d.coordinates,h,_),C=ef(l.geometry(),p,h,_);if(!Ds(p,h))return!1;for(let M of C)if(!rd(M,x))return!1}if(d.type==="MultiPolygon"){let x=_n(d.coordinates,h,_),C=ef(l.geometry(),p,h,_);if(!Ds(p,h))return!1;for(let M of C)if(!Wm(M,x))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(l,d){let p=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],_=l.canonicalID();if(!_)return!1;if(d.type==="Polygon"){let x=wu(d.coordinates,h,_),C=en(l.geometry(),p,h,_);if(!Ds(p,h))return!1;for(let M of C)if(!ip(M,x))return!1}if(d.type==="MultiPolygon"){let x=_n(d.coordinates,h,_),C=en(l.geometry(),p,h,_);if(!Ds(p,h))return!1;for(let M of C)if(!Z0(M,x))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}let ah={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Vi=1/298.257223563,sh=Vi*(2-Vi),ad=Math.PI/180;class lh{static fromTile(a,l,d){let p=Math.PI*(1-2*(a+.5)/Math.pow(2,l)),h=Math.atan(.5*(Math.exp(p)-Math.exp(-p)))/ad;return new lh(h,d)}static get units(){return ah}constructor(a,l){if(a===void 0)throw new Error("No latitude given.");if(l&&!ah[l])throw new Error(`Unknown unit ${l}. Use one of: ${Object.keys(ah).join(", ")}`);let d=6378.137*ad*(l?ah[l]:1),p=Math.cos(a*ad),h=1/(1-sh*(1-p*p)),_=Math.sqrt(h);this.kx=d*_*p,this.ky=d*_*h*(1-sh)}distance(a,l){let d=eo(a[0]-l[0])*this.kx,p=(a[1]-l[1])*this.ky;return Math.sqrt(d*d+p*p)}bearing(a,l){let d=eo(l[0]-a[0])*this.kx;return Math.atan2(d,(l[1]-a[1])*this.ky)/ad}destination(a,l,d){let p=d*ad;return this.offset(a,Math.sin(p)*l,Math.cos(p)*l)}offset(a,l,d){return[a[0]+l/this.kx,a[1]+d/this.ky]}lineDistance(a){let l=0;for(let d=0;d<a.length-1;d++)l+=this.distance(a[d],a[d+1]);return l}area(a){let l=0;for(let d=0;d<a.length;d++){let p=a[d];for(let h=0,_=p.length,x=_-1;h<_;x=h++)l+=eo(p[h][0]-p[x][0])*(p[h][1]+p[x][1])*(d?-1:1)}return Math.abs(l)/2*this.kx*this.ky}along(a,l){let d=0;if(l<=0)return a[0];for(let p=0;p<a.length-1;p++){let h=a[p],_=a[p+1],x=this.distance(h,_);if(d+=x,d>l)return Eu(h,_,(l-(d-x))/x)}return a[a.length-1]}pointToSegmentDistance(a,l,d){let[p,h]=l,_=eo(d[0]-p)*this.kx,x=(d[1]-h)*this.ky;if(_!==0||x!==0){let C=(eo(a[0]-p)*this.kx*_+(a[1]-h)*this.ky*x)/(_*_+x*x);C>1?(p=d[0],h=d[1]):C>0&&(p+=_/this.kx*C,h+=x/this.ky*C)}return _=eo(a[0]-p)*this.kx,x=(a[1]-h)*this.ky,Math.sqrt(_*_+x*x)}pointOnLine(a,l){let d=1/0,p=a[0][0],h=a[0][1],_=0,x=0;for(let C=0;C<a.length-1;C++){let M=a[C][0],v=a[C][1],S=eo(a[C+1][0]-M)*this.kx,A=(a[C+1][1]-v)*this.ky,D=0;S===0&&A===0||(D=(eo(l[0]-M)*this.kx*S+(l[1]-v)*this.ky*A)/(S*S+A*A),D>1?(M=a[C+1][0],v=a[C+1][1]):D>0&&(M+=S/this.kx*D,v+=A/this.ky*D)),S=eo(l[0]-M)*this.kx,A=(l[1]-v)*this.ky;let I=S*S+A*A;I<d&&(d=I,p=M,h=v,_=C,x=D)}return{point:[p,h],index:_,t:Math.max(0,Math.min(1,x))}}lineSlice(a,l,d){let p=this.pointOnLine(d,a),h=this.pointOnLine(d,l);if(p.index>h.index||p.index===h.index&&p.t>h.t){let M=p;p=h,h=M}let _=[p.point],x=p.index+1,C=h.index;!tf(d[x],_[0])&&x<=C&&_.push(d[x]);for(let M=x+1;M<=C;M++)_.push(d[M]);return tf(d[C],h.point)||_.push(h.point),_}lineSliceAlong(a,l,d){let p=0,h=[];for(let _=0;_<d.length-1;_++){let x=d[_],C=d[_+1],M=this.distance(x,C);if(p+=M,p>a&&h.length===0&&h.push(Eu(x,C,(a-(p-M))/M)),p>=l)return h.push(Eu(x,C,(l-(p-M))/M)),h;p>a&&h.push(C)}return h}bufferPoint(a,l){let d=l/this.ky,p=l/this.kx;return[a[0]-p,a[1]-d,a[0]+p,a[1]+d]}bufferBBox(a,l){let d=l/this.ky,p=l/this.kx;return[a[0]-p,a[1]-d,a[2]+p,a[3]+d]}insideBBox(a,l){return eo(a[0]-l[0])>=0&&eo(a[0]-l[2])<=0&&a[1]>=l[1]&&a[1]<=l[3]}}function tf(u,a){return u[0]===a[0]&&u[1]===a[1]}function Eu(u,a,l){let d=eo(a[0]-u[0]);return[u[0]+d*l,u[1]+(a[1]-u[1])*l]}function eo(u){for(;u<-180;)u+=360;for(;u>180;)u-=360;return u}class np{constructor(a=[],l=(d,p)=>d<p?-1:d>p?1:0){if(this.data=a,this.length=this.data.length,this.compare=l,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;let a=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),a}peek(){return this.data[0]}_up(a){let{data:l,compare:d}=this,p=l[a];for(;a>0;){let h=a-1>>1,_=l[h];if(d(p,_)>=0)break;l[a]=_,a=h}l[a]=p}_down(a){let{data:l,compare:d}=this,p=this.length>>1,h=l[a];for(;a<p;){let _=1+(a<<1),x=_+1;if(x<this.length&&d(l[x],l[_])<0&&(_=x),d(l[_],h)>=0)break;l[a]=l[_],a=_}l[a]=h}}var $t=8192;function rp(u,a){return a.dist-u.dist}let rc=100,da=50;function Y0(u){let a=[1/0,1/0,-1/0,-1/0];if(a.length!==u.length)return!1;for(let l=0;l<a.length;l++)if(a[l]!==u[l])return!1;return!0}function nf(u){return u[1]-u[0]+1}function Uc(u,a){let l=u[1]>=u[0]&&u[1]<a;return l||console.warn("Distance Expression: Index is out of range"),l}function Hc(u,a){if(u[0]>u[1])return[null,null];let l=nf(u);if(a){if(l===2)return[u,null];let d=Math.floor(l/2);return[[u[0],u[0]+d],[u[0]+d,u[1]]]}{if(l===1)return[u,null];let d=Math.floor(l/2)-1;return[[u[0],u[0]+d],[u[0]+d+1,u[1]]]}}function Rl(u,a){let l=[1/0,1/0,-1/0,-1/0];if(!Uc(a,u.length))return l;for(let d=a[0];d<=a[1];++d)tp(l,u[d]);return l}function sd(u){let a=[1/0,1/0,-1/0,-1/0];for(let l=0;l<u.length;++l)for(let d=0;d<u[l].length;++d)tp(a,u[l][d]);return a}function Hs(u,a,l){if(Y0(u)||Y0(a))return NaN;let d=0,p=0;return u[2]<a[0]&&(d=a[0]-u[2]),u[0]>a[2]&&(d=u[0]-a[2]),u[1]>a[3]&&(p=u[1]-a[3]),u[3]<a[1]&&(p=a[1]-u[3]),l.distance([0,0],[d,p])}function Zm(u){return 360*u-180}function jv(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function Ym(u,a){let l=Math.pow(2,a.z),d=(u.y/$t+a.y)/l;return[Zm((u.x/$t+a.x)/l),jv(d)]}function ch(u,a){let l=[];for(let d=0;d<u.length;++d)l.push(Ym(u[d],a));return l}function Km(u,a,l){let d=l.pointOnLine(a,u).point;return l.distance(u,d)}function K0(u,a,l,d,p){let h=l.slice(d[0],d[1]+1),_=1/0;for(let x=a[0];x<=a[1];++x)if((_=Math.min(_,Km(u[x],h,p)))===0)return 0;return _}function rf(u,a,l,d,p){let h=Math.min(p.pointToSegmentDistance(u,l,d),p.pointToSegmentDistance(a,l,d)),_=Math.min(p.pointToSegmentDistance(l,u,a),p.pointToSegmentDistance(d,u,a));return Math.min(h,_)}function Uv(u,a,l,d,p){if(!Uc(a,u.length)||!Uc(d,l.length))return NaN;let h=1/0;for(let _=a[0];_<a[1];++_)for(let x=d[0];x<d[1];++x){if(od(u[_],u[_+1],l[x],l[x+1]))return 0;h=Math.min(h,rf(u[_],u[_+1],l[x],l[x+1],p))}return h}function ld(u,a,l,d,p){if(!Uc(a,u.length)||!Uc(d,l.length))return NaN;let h=1/0;for(let _=a[0];_<=a[1];++_)for(let x=d[0];x<=d[1];++x)if((h=Math.min(h,p.distance(u[_],l[x])))===0)return h;return h}function Hv(u,a,l){if(rd(u,a,!0))return 0;let d=1/0;for(let p of a){let h=p.length;if(h<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(p[0]!==p[h-1]&&(d=Math.min(d,l.pointToSegmentDistance(u,p[h-1],p[0])))===0||(d=Math.min(d,Km(u,p,l)))===0)return d}return d}function of(u,a,l,d){if(!Uc(a,u.length))return NaN;for(let h=a[0];h<=a[1];++h)if(rd(u[h],l,!0))return 0;let p=1/0;for(let h=a[0];h<a[1];++h)for(let _ of l)for(let x=0,C=_.length,M=C-1;x<C;M=x++){if(od(u[h],u[h+1],_[M],_[x]))return 0;p=Math.min(p,rf(u[h],u[h+1],_[M],_[x],d))}return p}function oc(u,a){for(let l of u)for(let d=0;d<=l.length-1;++d)if(rd(l[d],a,!0))return!0;return!1}function X0(u,a,l,d=1/0){let p=sd(u),h=sd(a);if(d!==1/0&&Hs(p,h,l)>=d)return d;if(Ds(p,h)){if(oc(u,a))return 0}else if(oc(a,u))return 0;let _=d;for(let x of u)for(let C=0,M=x.length,v=M-1;C<M;v=C++)for(let S of a)for(let A=0,D=S.length,I=D-1;A<D;I=A++){if(od(x[v],x[C],S[I],S[A]))return 0;_=Math.min(_,rf(x[v],x[C],S[I],S[A],l))}return _}function uh(u,a,l,d,p,h,_){if(h===null||_===null)return;let x=Hs(Rl(d,h),Rl(p,_),l);x<a&&u.push({dist:x,range1:h,range2:_})}function Ms(u,a,l,d,p=1/0){let h=Math.min(d.distance(u[0],l[0][0]),p);if(h===0)return h;let _=new np([{dist:0,range1:[0,u.length-1],range2:[0,0]}],rp),x=a?da:rc,C=sd(l);for(;_.length;){let M=_.pop();if(M.dist>=h)continue;let v=M.range1;if(nf(v)<=x){if(!Uc(v,u.length))return NaN;if(a){let S=of(u,v,l,d);if((h=Math.min(h,S))===0)return h}else for(let S=v[0];S<=v[1];++S){let A=Hv(u[S],l,d);if((h=Math.min(h,A))===0)return h}}else{let S=Hc(v,a);if(S[0]!==null){let A=Hs(Rl(u,S[0]),C,d);A<h&&_.push({dist:A,range1:S[0],range2:[0,0]})}if(S[1]!==null){let A=Hs(Rl(u,S[1]),C,d);A<h&&_.push({dist:A,range1:S[1],range2:[0,0]})}}}return h}function yo(u,a,l,d,p,h=1/0){let _=Math.min(h,p.distance(u[0],l[0]));if(_===0)return _;let x=new np([{dist:0,range1:[0,u.length-1],range2:[0,l.length-1]}],rp),C=a?da:rc,M=d?da:rc;for(;x.length;){let v=x.pop();if(v.dist>=_)continue;let S=v.range1,A=v.range2;if(nf(S)<=C&&nf(A)<=M){if(!Uc(S,u.length)||!Uc(A,l.length))return NaN;if(a&&d?_=Math.min(_,Uv(u,S,l,A,p)):a||d?a&&!d?_=Math.min(_,K0(l,A,u,S,p)):!a&&d&&(_=Math.min(_,K0(u,S,l,A,p))):_=Math.min(_,ld(u,S,l,A,p)),_===0)return _}else{let D=Hc(S,a),I=Hc(A,d);uh(x,_,p,u,l,D[0],I[0]),uh(x,_,p,u,l,D[0],I[1]),uh(x,_,p,u,l,D[1],I[0]),uh(x,_,p,u,l,D[1],I[1])}}return _}function op(u,a,l,d,p=1/0){let h=p,_=Rl(u,[0,u.length-1]);for(let x of l)if(!(h!==1/0&&Hs(_,Rl(x,[0,x.length-1]),d)>=h)&&(h=Math.min(h,yo(u,a,x,!0,d,h)),h===0))return h;return h}function cd(u,a,l,d,p=1/0){let h=p,_=Rl(u,[0,u.length-1]);for(let x of l){if(h!==1/0&&Hs(_,sd(x),d)>=h)continue;let C=Ms(u,a,x,d,h);if(isNaN(C))return C;if((h=Math.min(h,C))===0)return h}return h}function xn(u){return u==="Point"||u==="MultiPoint"||u==="LineString"||u==="MultiLineString"||u==="Polygon"||u==="MultiPolygon"}class kl{constructor(a,l){this.type=fi,this.geojson=a,this.geometries=l}static parse(a,l){if(a.length!==2)return l.error(`'distance' expression requires either one argument, but found ' ${a.length-1} instead.`);if(Il(a[1])){let d=a[1];if(d.type==="FeatureCollection"){for(let p=0;p<d.features.length;++p)if(xn(d.features[p].geometry.type))return new kl(d,d.features[p].geometry)}else if(d.type==="Feature"){if(xn(d.geometry.type))return new kl(d,d.geometry)}else if(xn(d.type))return new kl(d,d)}return l.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(a){let l=a.geometry(),d=a.canonicalID();if(l!=null&&d!=null){if(a.geometryType()==="Point")return function(p,h,_){let x=[];for(let M of p)for(let v of M)x.push(Ym(v,h));let C=new lh(x[0][1],"meters");return _.type==="Point"||_.type==="MultiPoint"||_.type==="LineString"?yo(x,!1,_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",C):_.type==="MultiLineString"?op(x,!1,_.coordinates,C):_.type==="Polygon"||_.type==="MultiPolygon"?cd(x,!1,_.type==="Polygon"?[_.coordinates]:_.coordinates,C):null}(l,d,this.geometries);if(a.geometryType()==="LineString")return function(p,h,_){let x=[];for(let M of p){let v=[];for(let S of M)v.push(Ym(S,h));x.push(v)}let C=new lh(x[0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return op(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",x,C);if(_.type==="MultiLineString"){let M=1/0;for(let v=0;v<_.coordinates.length;v++){let S=op(_.coordinates[v],!0,x,C,M);if(isNaN(S))return S;if((M=Math.min(M,S))===0)return M}return M}if(_.type==="Polygon"||_.type==="MultiPolygon"){let M=1/0;for(let v=0;v<x.length;v++){let S=cd(x[v],!0,_.type==="Polygon"?[_.coordinates]:_.coordinates,C,M);if(isNaN(S))return S;if((M=Math.min(M,S))===0)return M}return M}return null}(l,d,this.geometries);if(a.geometryType()==="Polygon")return function(p,h,_){let x=[];for(let M of function(v,S){let A=v.length;if(A<=1)return[v];let D=[],I,O;for(let z=0;z<A;z++){let B=$m(v[z]);B!==0&&(v[z].area=Math.abs(B),O===void 0&&(O=B<0),O===B<0?(I&&D.push(I),I=[v[z]]):I.push(v[z]))}return I&&D.push(I),D}(p)){let v=[];for(let S=0;S<M.length;++S)v.push(ch(M[S],h));x.push(v)}let C=new lh(x[0][0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return cd(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",x,C);if(_.type==="MultiLineString"){let M=1/0;for(let v=0;v<_.coordinates.length;v++){let S=cd(_.coordinates[v],!0,x,C,M);if(isNaN(S))return S;if((M=Math.min(M,S))===0)return M}return M}return _.type==="Polygon"||_.type==="MultiPolygon"?function(M,v,S){let A=1/0;for(let D of M)for(let I of v){let O=X0(D,I,S,A);if(isNaN(O))return O;if((A=Math.min(A,O))===0)return A}return A}(_.type==="Polygon"?[_.coordinates]:_.coordinates,x,C):null}(l,d,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function cs(u,a){switch(u){case"string":return Qo(a);case"number":return+a;case"boolean":return!!a;case"color":return Ui.parse(a);case"formatted":return Aa.fromString(Qo(a));case"resolvedImage":return va.build(Qo(a))}return a}function Xm(u,a,l,d){return d!==void 0&&(u=d*Math.round(u/d)),a!==void 0&&u<a&&(u=a),l!==void 0&&u>l&&(u=l),u}class qc{constructor(a,l,d){this.type=a,this.key=l,this.scope=d}static parse(a,l){let d=l.expectedType;if(d==null&&(d=Vn),a.length<2||a.length>3)return l.error("Invalid number of arguments for 'config' expression.");let p=l.parse(a[1],1);if(!(p instanceof Fc))return l.error("Key name of 'config' expression must be a string literal.");if(a.length>=3){let h=l.parse(a[2],2);return h instanceof Fc?new qc(d,Qo(p.value),Qo(h.value)):l.error("Scope of 'config' expression must be a string literal.")}return new qc(d,Qo(p.value))}evaluate(a){let l=[this.key,this.scope,a.scope].filter(Boolean).join(""),d=a.getConfig(l);if(!d)return null;let{type:p,value:h,values:_,minValue:x,maxValue:C,stepValue:M}=d,v=d.default.evaluate(a),S=v;if(h){let A=a.scope;a.scope=(A||"").split("").slice(1).join(""),S=h.evaluate(a),a.scope=A}return p&&(S=cs(p,S)),S===void 0||x===void 0&&C===void 0&&M===void 0||(typeof S=="number"?S=Xm(S,x,C,M):Array.isArray(S)&&(S=S.map(A=>typeof A=="number"?Xm(A,x,C,M):A))),h!==void 0&&S!==void 0&&_&&!_.includes(S)&&(S=v,p&&(S=cs(p,S))),(p&&p!==this.type||S!==void 0&&Do(S)!==this.type)&&(S=cs(this.type.kind,S)),S}eachChild(){}outputDefined(){return!1}serialize(){let a=["config",this.key];return this.scope&&a.concat(this.key),a}}function $c(u){if(u instanceof qa&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof jc||u instanceof kl)return!1;let a=!0;return u.eachChild(l=>{a&&!$c(l)&&(a=!1)}),a}function Ol(u){if(u instanceof qa&&u.name==="feature-state")return!1;let a=!0;return u.eachChild(l=>{a&&!Ol(l)&&(a=!1)}),a}function Gc(u){if(u instanceof qc)return new Set([u.key]);let a=new Set;return u.eachChild(l=>{a=new Set([...a,...Gc(l)])}),a}function Is(u,a){if(u instanceof qa&&a.indexOf(u.name)>=0)return!1;let l=!0;return u.eachChild(d=>{l&&!Is(d,a)&&(l=!1)}),l}class us{constructor(a,l){this.type=l.type,this.name=a,this.boundExpression=l}static parse(a,l){if(a.length!==2||typeof a[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");let d=a[1];return l.scope.has(d)?new us(d,l.scope.get(d)):l.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Wc{constructor(a,l=[],d,p=new td,h=[],_,x){this.registry=a,this.path=l,this.key=l.map(C=>typeof C=="string"?`['${C}']`:`[${C}]`).join(""),this.scope=p,this.errors=h,this.expectedType=d,this._scope=_,this.options=x}parse(a,l,d,p,h={}){return l||d?this.concat(l,null,d,p)._parse(a,h):this._parse(a,h)}parseObjectValue(a,l,d,p,h,_={}){return this.concat(l,d,p,h)._parse(a,_)}_parse(a,l){function d(p,h,_){return _==="assert"?new Us(h,[p]):_==="coerce"?new Bc(h,[p]):p}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let p=typeof a[0]=="string"?this.registry[a[0]]:void 0;if(p){let h=p.parse(a,this);if(!h)return null;if(this.expectedType){let _=this.expectedType,x=h.type;if(_.kind!=="string"&&_.kind!=="number"&&_.kind!=="boolean"&&_.kind!=="object"&&_.kind!=="array"||x.kind!=="value")if(_.kind!=="color"&&_.kind!=="formatted"&&_.kind!=="resolvedImage"||x.kind!=="value"&&x.kind!=="string"){if(this.checkSubtype(_,x))return null}else h=d(h,_,l.typeAnnotation||"coerce");else h=d(h,_,l.typeAnnotation||"assert")}if(!(h instanceof Fc)&&h.type.kind!=="resolvedImage"&&sp(h)){let _=new rh(this._scope,this.options);try{h=new Fc(h.type,h.evaluate(_))}catch(x){return this.error(x.message),null}}return h}return Bc.parse(["to-array",a],this)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,l,d,p){let h=typeof a=="number"?this.path.concat(a):this.path;h=typeof l=="string"?h.concat(l):h;let _=p?this.scope.concat(p):this.scope;return new Wc(this.registry,h,d||null,_,this.errors,this._scope,this.options)}error(a,...l){let d=`${this.key}${l.map(p=>`[${p}]`).join("")}`;this.errors.push(new yn(d,a))}checkSubtype(a,l){let d=cr(a,l);return d&&this.error(d),d}}var ap=Wc;function sp(u){if(u instanceof us)return sp(u.boundExpression);if(u instanceof qa&&u.name==="error"||u instanceof nd||u instanceof jc||u instanceof kl||u instanceof qc)return!1;let a=u instanceof Bc||u instanceof Us,l=!0;return u.eachChild(d=>{l=a?l&&sp(d):l&&d instanceof Fc}),!!l&&$c(u)&&Is(u,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function ud(u,a){let l=u.length-1,d,p,h=0,_=l,x=0;for(;h<=_;)if(x=Math.floor((h+_)/2),d=u[x],p=u[x+1],d<=a){if(x===l||a<p)return x;h=x+1}else{if(!(d>a))throw new mo("Input is not a number.");_=x-1}return 0}class ac{constructor(a,l,d){this.type=a,this.input=l,this.labels=[],this.outputs=[];for(let[p,h]of d)this.labels.push(p),this.outputs.push(h)}static parse(a,l){if(a.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return l.error("Expected an even number of arguments.");let d=l.parse(a[1],1,fi);if(!d)return null;let p=[],h=null;l.expectedType&&l.expectedType.kind!=="value"&&(h=l.expectedType);for(let _=1;_<a.length;_+=2){let x=_===1?-1/0:a[_],C=a[_+1],M=_,v=_+1;if(typeof x!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(p.length&&p[p.length-1][0]>=x)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);let S=l.parse(C,v,h);if(!S)return null;h=h||S.type,p.push([x,S])}return new ac(h,d,p)}evaluate(a){let l=this.labels,d=this.outputs;if(l.length===1)return d[0].evaluate(a);let p=this.input.evaluate(a);if(p<=l[0])return d[0].evaluate(a);let h=l.length;return p>=l[h-1]?d[h-1].evaluate(a):d[ud(l,p)].evaluate(a)}eachChild(a){a(this.input);for(let l of this.outputs)a(l)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){let a=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&a.push(this.labels[l]),a.push(this.outputs[l].serialize());return a}}let In=.95047,Q0=1.08883,Qm=4/29,ce=6/29,de=3*ce*ce,et=ce*ce*ce,wt=Math.PI/180,Zt=180/Math.PI;function Li(u){return u>et?Math.pow(u,1/3):u/de+Qm}function Tn(u){return u>ce?u*u*u:de*(u-Qm)}function mr(u){return 255*(u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055)}function go(u){return(u/=255)<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function ba(u){let a=go(u.r),l=go(u.g),d=go(u.b),p=Li((.4124564*a+.3575761*l+.1804375*d)/In),h=Li((.2126729*a+.7151522*l+.072175*d)/1);return{l:116*h-16,a:500*(p-h),b:200*(h-Li((.0193339*a+.119192*l+.9503041*d)/Q0)),alpha:u.a}}function qs(u){let a=(u.l+16)/116,l=isNaN(u.a)?a:a+u.a/500,d=isNaN(u.b)?a:a-u.b/200;return a=1*Tn(a),l=In*Tn(l),d=Q0*Tn(d),new Ui(mr(3.2404542*l-1.5371385*a-.4985314*d),mr(-.969266*l+1.8760108*a+.041556*d),mr(.0556434*l-.2040259*a+1.0572252*d),u.alpha)}function Pl(u,a,l){let d=a-u;return u+l*(d>180||d<-180?d-360*Math.round(d/360):d)}let Nl={forward:ba,reverse:qs,interpolate:function(u,a,l){return{l:pi(u.l,a.l,l),a:pi(u.a,a.a,l),b:pi(u.b,a.b,l),alpha:pi(u.alpha,a.alpha,l)}}},sl={forward:function(u){let{l:a,a:l,b:d}=ba(u),p=Math.atan2(d,l)*Zt;return{h:p<0?p+360:p,c:Math.sqrt(l*l+d*d),l:a,alpha:u.a}},reverse:function(u){let a=u.h*wt,l=u.c;return qs({l:u.l,a:Math.cos(a)*l,b:Math.sin(a)*l,alpha:u.alpha})},interpolate:function(u,a,l){return{h:Pl(u.h,a.h,l),c:pi(u.c,a.c,l),l:pi(u.l,a.l,l),alpha:pi(u.alpha,a.alpha,l)}}};var dh=Object.freeze({__proto__:null,hcl:sl,lab:Nl});class $s{constructor(a,l,d,p,h){this.type=a,this.operator=l,this.interpolation=d,this.input=p,this.labels=[],this.outputs=[];for(let[_,x]of h)this.labels.push(_),this.outputs.push(x)}static interpolationFactor(a,l,d,p){let h=0;if(a.name==="exponential")h=qv(l,a.base,d,p);else if(a.name==="linear")h=qv(l,1,d,p);else if(a.name==="cubic-bezier"){let _=a.controlPoints;h=new os(_[0],_[1],_[2],_[3]).solve(qv(l,1,d,p))}return h}static parse(a,l){let[d,p,h,..._]=a;if(!Array.isArray(p)||p.length===0)return l.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){let M=p[1];if(typeof M!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:M}}else{if(p[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(p[0])}`,1,0);{let M=p.slice(1);if(M.length!==4||M.some(v=>typeof v!="number"||v<0||v>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:M}}}if(a.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length-1>3&&(a.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(h=l.parse(h,2,fi),!h)return null;let x=[],C=null;d==="interpolate-hcl"||d==="interpolate-lab"?C=Xo:l.expectedType&&l.expectedType.kind!=="value"&&(C=l.expectedType);for(let M=0;M<_.length;M+=2){let v=_[M],S=_[M+1],A=M+3,D=M+4;if(typeof v!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(x.length&&x[x.length-1][0]>=v)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',A);let I=l.parse(S,D,C);if(!I)return null;C=C||I.type,x.push([v,I])}return C.kind==="number"||C.kind==="color"||C.kind==="array"&&C.itemType.kind==="number"&&typeof C.N=="number"?new $s(C,d,p,h,x):l.error(`Type ${jr(C)} is not interpolatable.`)}evaluate(a){let l=this.labels,d=this.outputs;if(l.length===1)return d[0].evaluate(a);let p=this.input.evaluate(a);if(p<=l[0])return d[0].evaluate(a);let h=l.length;if(p>=l[h-1])return d[h-1].evaluate(a);let _=ud(l,p),x=$s.interpolationFactor(this.interpolation,p,l[_],l[_+1]),C=d[_].evaluate(a),M=d[_+1].evaluate(a);return this.operator==="interpolate"?Nc[this.type.kind.toLowerCase()](C,M,x):this.operator==="interpolate-hcl"?sl.reverse(sl.interpolate(sl.forward(C),sl.forward(M),x)):Nl.reverse(Nl.interpolate(Nl.forward(C),Nl.forward(M),x))}eachChild(a){a(this.input);for(let l of this.outputs)a(l)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){let a;a=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];let l=[this.operator,a,this.input.serialize()];for(let d=0;d<this.labels.length;d++)l.push(this.labels[d],this.outputs[d].serialize());return l}}function qv(u,a,l,d){let p=d-l,h=u-l;return p===0?0:a===1?h/p:(Math.pow(a,h)-1)/(Math.pow(a,p)-1)}class J0{constructor(a,l){this.type=a,this.args=l}static parse(a,l){if(a.length<2)return l.error("Expectected at least one argument.");let d=null,p=l.expectedType;p&&p.kind!=="value"&&(d=p);let h=[];for(let x of a.slice(1)){let C=l.parse(x,1+h.length,d,void 0,{typeAnnotation:"omit"});if(!C)return null;d=d||C.type,h.push(C)}let _=p&&h.some(x=>cr(p,x.type));return new J0(_?Vn:d,h)}evaluate(a){let l,d=null,p=0;for(let h of this.args){if(p++,d=h.evaluate(a),d&&d instanceof va&&!d.available&&(l||(l=d),d=null,p===this.args.length))return l;if(d!==null)break}return d}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){let a=["coalesce"];return this.eachChild(l=>{a.push(l.serialize())}),a}}class e_{constructor(a,l){this.type=l.type,this.bindings=[].concat(a),this.result=l}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(let l of this.bindings)a(l[1]);a(this.result)}static parse(a,l){if(a.length<4)return l.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);let d=[];for(let h=1;h<a.length-1;h+=2){let _=a[h];if(typeof _!="string")return l.error(`Expected string, but found ${typeof _} instead.`,h);if(/[^a-zA-Z0-9_]/.test(_))return l.error("Variable names must contain only alphanumeric characters or '_'.",h);let x=l.parse(a[h+1],h+1);if(!x)return null;d.push([_,x])}let p=l.parse(a[a.length-1],a.length-1,l.expectedType,d);return p?new e_(d,p):null}outputDefined(){return this.result.outputDefined()}serialize(){let a=["let"];for(let[l,d]of this.bindings)a.push(l,d.serialize());return a.push(this.result.serialize()),a}}class $v{constructor(a,l,d){this.type=a,this.index=l,this.input=d}static parse(a,l){if(a.length!==3)return l.error(`Expected 2 arguments, but found ${a.length-1} instead.`);let d=l.parse(a[1],1,fi),p=l.parse(a[2],2,ya(l.expectedType||Vn));return d&&p?new $v(p.type.itemType,d,p):null}evaluate(a){let l=this.index.evaluate(a),d=this.input.evaluate(a);if(l<0)throw new mo(`Array index out of bounds: ${l} < 0.`);if(l>=d.length)throw new mo(`Array index out of bounds: ${l} > ${d.length-1}.`);if(l!==Math.floor(l))throw new mo(`Array index must be an integer, but found ${l} instead. Use at-interpolated to retrieve interpolated result with a fractional index.`);return d[l]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Gv{constructor(a,l,d){this.type=a,this.index=l,this.input=d}static parse(a,l){if(a.length!==3)return l.error(`Expected 2 arguments, but found ${a.length-1} instead.`);let d=l.parse(a[1],1,fi),p=l.parse(a[2],2,ya(l.expectedType||Vn));return d&&p?new Gv(p.type.itemType,d,p):null}evaluate(a){let l=this.index.evaluate(a),d=this.input.evaluate(a);if(l<0)throw new mo(`Array index out of bounds: ${l} < 0.`);if(l>d.length-1)throw new mo(`Array index out of bounds: ${l} > ${d.length-1}.`);if(l===Math.floor(l))return d[l];let p=Math.floor(l),h=Math.ceil(l),_=d[p],x=d[h];if(typeof _!="number"||typeof x!="number")throw new mo(`Cannot interpolate between non-number values at index ${l}.`);let C=l-p;return _*(1-C)+x*C}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class Wv{constructor(a,l){this.type=kn,this.needle=a,this.haystack=l}static parse(a,l){if(a.length!==3)return l.error(`Expected 2 arguments, but found ${a.length-1} instead.`);let d=l.parse(a[1],1,Vn),p=l.parse(a[2],2,Vn);return d&&p?ec(d.type,[kn,jn,fi,_u,Vn])?new Wv(d,p):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${jr(d.type)} instead`):null}evaluate(a){let l=this.needle.evaluate(a),d=this.haystack.evaluate(a);if(d==null)return!1;if(!tc(l,["boolean","string","number","null"]))throw new mo(`Expected first argument to be of type boolean, string, number or null, but found ${jr(Do(l))} instead.`);if(!tc(d,["string","array"]))throw new mo(`Expected second argument to be of type array or string, but found ${jr(Do(d))} instead.`);return d.indexOf(l)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class t_{constructor(a,l,d){this.type=fi,this.needle=a,this.haystack=l,this.fromIndex=d}static parse(a,l){if(a.length<=2||a.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);let d=l.parse(a[1],1,Vn),p=l.parse(a[2],2,Vn);if(!d||!p)return null;if(!ec(d.type,[kn,jn,fi,_u,Vn]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${jr(d.type)} instead`);if(a.length===4){let h=l.parse(a[3],3,fi);return h?new t_(d,p,h):null}return new t_(d,p)}evaluate(a){let l=this.needle.evaluate(a),d=this.haystack.evaluate(a);if(!tc(l,["boolean","string","number","null"]))throw new mo(`Expected first argument to be of type boolean, string, number or null, but found ${jr(Do(l))} instead.`);if(!tc(d,["string","array"]))throw new mo(`Expected second argument to be of type array or string, but found ${jr(Do(d))} instead.`);if(this.fromIndex){let p=this.fromIndex.evaluate(a);return d.indexOf(l,p)}return d.indexOf(l)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){let a=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),a]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Zv{constructor(a,l,d,p,h,_){this.inputType=a,this.type=l,this.input=d,this.cases=p,this.outputs=h,this.otherwise=_}static parse(a,l){if(a.length<5)return l.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return l.error("Expected an even number of arguments.");let d,p;l.expectedType&&l.expectedType.kind!=="value"&&(p=l.expectedType);let h={},_=[];for(let M=2;M<a.length-1;M+=2){let v=a[M],S=a[M+1];Array.isArray(v)||(v=[v]);let A=l.concat(M);if(v.length===0)return A.error("Expected at least one branch label.");for(let I of v){if(typeof I!="number"&&typeof I!="string")return A.error("Branch labels must be numbers or strings.");if(typeof I=="number"&&Math.abs(I)>Number.MAX_SAFE_INTEGER)return A.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof I=="number"&&Math.floor(I)!==I)return A.error("Numeric branch labels must be integer values.");if(d){if(A.checkSubtype(d,Do(I)))return null}else d=Do(I);if(h[String(I)]!==void 0)return A.error("Branch labels must be unique.");h[String(I)]=_.length}let D=l.parse(S,M,p);if(!D)return null;p=p||D.type,_.push(D)}let x=l.parse(a[1],1,Vn);if(!x)return null;let C=l.parse(a[a.length-1],a.length-1,p);return C?x.type.kind!=="value"&&l.concat(1).checkSubtype(d,x.type)?null:new Zv(d,p,x,h,_,C):null}evaluate(a){let l=this.input.evaluate(a);return(Do(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){let a=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),d=[],p={};for(let _ of l){let x=p[this.cases[_]];x===void 0?(p[this.cases[_]]=d.length,d.push([this.cases[_],[_]])):d[x][1].push(_)}let h=_=>this.inputType.kind==="number"?Number(_):_;for(let[_,x]of d)a.push(x.length===1?h(x[0]):x.map(h)),a.push(this.outputs[_].serialize());return a.push(this.otherwise.serialize()),a}}class Yv{constructor(a,l,d){this.type=a,this.branches=l,this.otherwise=d}static parse(a,l){if(a.length<4)return l.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return l.error("Expected an odd number of arguments.");let d;l.expectedType&&l.expectedType.kind!=="value"&&(d=l.expectedType);let p=[];for(let _=1;_<a.length-1;_+=2){let x=l.parse(a[_],_,kn);if(!x)return null;let C=l.parse(a[_+1],_+1,d);if(!C)return null;p.push([x,C]),d=d||C.type}let h=l.parse(a[a.length-1],a.length-1,d);return h?new Yv(d,p,h):null}evaluate(a){for(let[l,d]of this.branches)if(l.evaluate(a))return d.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(let[l,d]of this.branches)a(l),a(d);a(this.otherwise)}outputDefined(){return this.branches.every(([a,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){let a=["case"];return this.eachChild(l=>{a.push(l.serialize())}),a}}class i_{constructor(a,l,d,p){this.type=a,this.input=l,this.beginIndex=d,this.endIndex=p}static parse(a,l){if(a.length<=2||a.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);let d=l.parse(a[1],1,Vn),p=l.parse(a[2],2,fi);if(!d||!p)return null;if(!ec(d.type,[ya(Vn),jn,Vn]))return l.error(`Expected first argument to be of type array or string, but found ${jr(d.type)} instead`);if(a.length===4){let h=l.parse(a[3],3,fi);return h?new i_(d.type,d,p,h):null}return new i_(d.type,d,p)}evaluate(a){let l=this.input.evaluate(a),d=this.beginIndex.evaluate(a);if(!tc(l,["string","array"]))throw new mo(`Expected first argument to be of type array or string, but found ${jr(Do(l))} instead.`);if(this.endIndex){let p=this.endIndex.evaluate(a);return l.slice(d,p)}return l.slice(d)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){let a=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),a]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function lE(u,a){return u==="=="||u==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function cE(u,a,l,d){return d.compare(a,l)===0}function af(u,a,l){let d=u!=="=="&&u!=="!=";return class yZ{constructor(h,_,x){this.type=kn,this.lhs=h,this.rhs=_,this.collator=x,this.hasUntypedArgument=h.type.kind==="value"||_.type.kind==="value"}static parse(h,_){if(h.length!==3&&h.length!==4)return _.error("Expected two or three arguments.");let x=h[0],C=_.parse(h[1],1,Vn);if(!C)return null;if(!lE(x,C.type))return _.concat(1).error(`"${x}" comparisons are not supported for type '${jr(C.type)}'.`);let M=_.parse(h[2],2,Vn);if(!M)return null;if(!lE(x,M.type))return _.concat(2).error(`"${x}" comparisons are not supported for type '${jr(M.type)}'.`);if(C.type.kind!==M.type.kind&&C.type.kind!=="value"&&M.type.kind!=="value")return _.error(`Cannot compare types '${jr(C.type)}' and '${jr(M.type)}'.`);d&&(C.type.kind==="value"&&M.type.kind!=="value"?C=new Us(M.type,[C]):C.type.kind!=="value"&&M.type.kind==="value"&&(M=new Us(C.type,[M])));let v=null;if(h.length===4){if(C.type.kind!=="string"&&M.type.kind!=="string"&&C.type.kind!=="value"&&M.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(v=_.parse(h[3],3,To),!v)return null}return new yZ(C,M,v)}evaluate(h){let _=this.lhs.evaluate(h),x=this.rhs.evaluate(h);if(d&&this.hasUntypedArgument){let C=Do(_),M=Do(x);if(C.kind!==M.kind||C.kind!=="string"&&C.kind!=="number")throw new mo(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${C.kind}, ${M.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){let C=Do(_),M=Do(x);if(C.kind!=="string"||M.kind!=="string")return a(h,_,x)}return this.collator?l(h,_,x,this.collator.evaluate(h)):a(h,_,x)}eachChild(h){h(this.lhs),h(this.rhs),this.collator&&h(this.collator)}outputDefined(){return!0}serialize(){let h=[u];return this.eachChild(_=>{h.push(_.serialize())}),h}}}let EI=af("==",function(u,a,l){return a===l},cE),CI=af("!=",function(u,a,l){return a!==l},function(u,a,l,d){return!cE(0,a,l,d)}),SI=af("<",function(u,a,l){return a<l},function(u,a,l,d){return d.compare(a,l)<0}),TI=af(">",function(u,a,l){return a>l},function(u,a,l,d){return d.compare(a,l)>0}),DI=af("<=",function(u,a,l){return a<=l},function(u,a,l,d){return d.compare(a,l)<=0}),MI=af(">=",function(u,a,l){return a>=l},function(u,a,l,d){return d.compare(a,l)>=0});class Jm{constructor(a,l,d,p,h,_){this.type=jn,this.number=a,this.locale=l,this.currency=d,this.unit=p,this.minFractionDigits=h,this.maxFractionDigits=_}static parse(a,l){if(a.length!==3)return l.error("Expected two arguments.");let d=l.parse(a[1],1,fi);if(!d)return null;let p=a[2];if(typeof p!="object"||Array.isArray(p))return l.error("NumberFormat options argument must be an object.");let h=null;if(p.locale&&(h=l.parseObjectValue(p.locale,2,"locale",jn),!h))return null;let _=null;if(p.currency&&(_=l.parseObjectValue(p.currency,2,"currency",jn),!_))return null;let x=null;if(p.unit&&(x=l.parseObjectValue(p.unit,2,"unit",jn),!x))return null;let C=null;if(p["min-fraction-digits"]&&(C=l.parseObjectValue(p["min-fraction-digits"],2,"min-fraction-digits",fi),!C))return null;let M=null;return p["max-fraction-digits"]&&(M=l.parseObjectValue(p["max-fraction-digits"],2,"max-fraction-digits",fi),!M)?null:new Jm(d,h,_,x,C,M)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(a):void 0,unit:this.unit?this.unit.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.unit&&a(this.unit),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}serialize(){let a={};return this.locale&&(a.locale=this.locale.serialize()),this.currency&&(a.currency=this.currency.serialize()),this.unit&&(a.unit=this.unit.serialize()),this.minFractionDigits&&(a["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(a["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),a]}}class Kv{constructor(a){this.type=fi,this.input=a}static parse(a,l){if(a.length!==2)return l.error(`Expected 1 argument, but found ${a.length-1} instead.`);let d=l.parse(a[1],1);return d?d.type.kind!=="array"&&d.type.kind!=="string"&&d.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${jr(d.type)} instead.`):new Kv(d):null}evaluate(a){let l=this.input.evaluate(a);if(typeof l=="string"||Array.isArray(l))return l.length;throw new mo(`Expected value to be of type string or array, but found ${jr(Do(l))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){let a=["length"];return this.eachChild(l=>{a.push(l.serialize())}),a}}function Xv(u){return function(){u=1831565813+(u|=0)|0;let a=Math.imul(u^u>>>15,1|u);return a=a+Math.imul(a^a>>>7,61|a)^a,((a^a>>>14)>>>0)/4294967296}}let sf={"==":EI,"!=":CI,">":TI,"<":SI,">=":MI,"<=":DI,array:Us,at:$v,"at-interpolated":Gv,boolean:Us,case:Yv,coalesce:J0,collator:nd,format:nh,image:vu,in:Wv,"index-of":t_,interpolate:$s,"interpolate-hcl":$s,"interpolate-lab":$s,length:Kv,let:e_,literal:Fc,match:Zv,number:Us,"number-format":Jm,object:Us,slice:i_,step:ac,string:Us,"to-boolean":Bc,"to-color":Bc,"to-number":Bc,"to-string":Bc,var:us,within:jc,distance:kl,config:qc};function uE(u,[a,l,d,p]){a=a.evaluate(u),l=l.evaluate(u),d=d.evaluate(u);let h=p?p.evaluate(u):1,_=Jh(a,l,d,h);if(_)throw new mo(_);return new Ui(a/255*h,l/255*h,d/255*h,h)}function dE(u,[a,l,d,p]){a=a.evaluate(u),l=l.evaluate(u),d=d.evaluate(u);let h=p?p.evaluate(u):1,_=function(M,v,S,A){return typeof M=="number"&&M>=0&&M<=360?typeof v=="number"&&v>=0&&v<=100&&typeof S=="number"&&S>=0&&S<=100?A===void 0||typeof A=="number"&&A>=0&&A<=1?null:`Invalid hsla value [${[M,v,S,A].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof A=="number"?[M,v,S,A]:[M,v,S]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof A=="number"?[M,v,S,A]:[M,v,S]).join(", ")}]: 'h' must be between 0 and 360.`}(a,l,d,h);if(_)throw new mo(_);let x=`hsla(${a}, ${l}%, ${d}%, ${h})`,C=Ui.parse(x);if(!C)throw new mo(`Failed to parse HSLA color: ${x}`);return C}function Qv(u,a){return u in a}function n_(u,a){let l=a[u];return l===void 0?null:l}function sc(u){return{type:u}}function Jv(u){return{result:"success",value:u}}function dd(u){return{result:"error",value:u}}function eb(u,a){return!!u&&!!u.parameters&&u.parameters.indexOf(a)>-1}function lf(u){return u["property-type"]==="data-driven"}function r_(u){return eb(u.expression,"measure-light")}function hE(u){return eb(u.expression,"zoom")}function tb(u){return!!u.expression&&u.expression.interpolated}function o_(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function pE(u){return u}function fE(u,a){let l=a.type==="color",d=u.stops&&typeof u.stops[0][0]=="object",p=d||!(d||u.property!==void 0),h=u.type||(tb(a)?"exponential":"interval");if(l&&((u=Sn({},u)).stops&&(u.stops=u.stops.map(M=>[M[0],Ui.parse(M[1])])),u.default=Ui.parse(u.default?u.default:a.default)),u.colorSpace&&u.colorSpace!=="rgb"&&!dh[u.colorSpace])throw new Error(`Unknown color space: ${u.colorSpace}`);let _,x,C;if(h==="exponential")_=ib;else if(h==="interval")_=mE;else if(h==="categorical"){_=II,x=Object.create(null);for(let M of u.stops)x[M[0]]=M[1];C=typeof u.stops[0][0]}else{if(h!=="identity")throw new Error(`Unknown function type "${h}"`);_=a_}if(d){let M={},v=[];for(let D=0;D<u.stops.length;D++){let I=u.stops[D],O=I[0].zoom;M[O]===void 0&&(M[O]={zoom:O,type:u.type,property:u.property,default:u.default,stops:[]},v.push(O)),M[O].stops.push([I[0].value,I[1]])}let S=[];for(let D of v)S.push([M[D].zoom,fE(M[D],a)]);let A={name:"linear"};return{kind:"composite",interpolationType:A,interpolationFactor:$s.interpolationFactor.bind(void 0,A),zoomStops:S.map(D=>D[0]),evaluate:({zoom:D},I)=>ib({stops:S,base:u.base},a,D).evaluate(D,I)}}if(p){let M=h==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:$s.interpolationFactor.bind(void 0,M),zoomStops:u.stops.map(v=>v[0]),evaluate:({zoom:v})=>_(u,a,v,x,C)}}return{kind:"source",evaluate(M,v){let S=v&&v.properties?v.properties[u.property]:void 0;return S===void 0?eg(u.default,a.default):_(u,a,S,x,C)}}}function eg(u,a,l){return u!==void 0?u:a!==void 0?a:l!==void 0?l:void 0}function II(u,a,l,d,p){return eg(typeof l===p?d[l]:void 0,u.default,a.default)}function mE(u,a,l){if(zc(l)!=="number")return eg(u.default,a.default);let d=u.stops.length;if(d===1||l<=u.stops[0][0])return u.stops[0][1];if(l>=u.stops[d-1][0])return u.stops[d-1][1];let p=ud(u.stops.map(h=>h[0]),l);return u.stops[p][1]}function ib(u,a,l){let d=u.base!==void 0?u.base:1;if(zc(l)!=="number")return eg(u.default,a.default);let p=u.stops.length;if(p===1||l<=u.stops[0][0])return u.stops[0][1];if(l>=u.stops[p-1][0])return u.stops[p-1][1];let h=ud(u.stops.map(v=>v[0]),l),_=function(v,S,A,D){let I=D-A,O=v-A;return I===0?0:S===1?O/I:(Math.pow(S,O)-1)/(Math.pow(S,I)-1)}(l,d,u.stops[h][0],u.stops[h+1][0]),x=u.stops[h][1],C=u.stops[h+1][1],M=Nc[a.type]||pE;if(u.colorSpace&&u.colorSpace!=="rgb"){let v=dh[u.colorSpace];M=(S,A)=>v.reverse(v.interpolate(v.forward(S),v.forward(A),_))}return typeof x.evaluate=="function"?{evaluate(...v){let S=x.evaluate.apply(void 0,v),A=C.evaluate.apply(void 0,v);if(S!==void 0&&A!==void 0)return M(S,A,_)}}:M(x,C,_)}function a_(u,a,l){return a.type==="color"?l=Ui.parse(l):a.type==="formatted"?l=Aa.fromString(l.toString()):a.type==="resolvedImage"?l=va.build(l.toString()):zc(l)===a.type||a.type==="enum"&&a.values[l]||(l=void 0),eg(l,u.default,a.default)}qa.register(sf,{error:[{kind:"error"},[jn],(u,[a])=>{throw new mo(a.evaluate(u))}],typeof:[jn,[Vn],(u,[a])=>jr(Do(a.evaluate(u)))],"to-rgba":[ya(fi,4),[Xo],(u,[a])=>a.evaluate(u).toRenderColor(null).toArray()],"to-hsla":[ya(fi,4),[Xo],(u,[a])=>a.evaluate(u).toRenderColor(null).toHslaArray()],rgb:[Xo,[fi,fi,fi],uE],rgba:[Xo,[fi,fi,fi,fi],uE],hsl:[Xo,[fi,fi,fi],dE],hsla:[Xo,[fi,fi,fi,fi],dE],has:{type:kn,overloads:[[[jn],(u,[a])=>Qv(a.evaluate(u),u.properties())],[[jn,ih],(u,[a,l])=>Qv(a.evaluate(u),l.evaluate(u))]]},get:{type:Vn,overloads:[[[jn],(u,[a])=>n_(a.evaluate(u),u.properties())],[[jn,ih],(u,[a,l])=>n_(a.evaluate(u),l.evaluate(u))]]},"feature-state":[Vn,[jn],(u,[a])=>n_(a.evaluate(u),u.featureState||{})],properties:[ih,[],u=>u.properties()],"geometry-type":[jn,[],u=>u.geometryType()],id:[Vn,[],u=>u.id()],zoom:[fi,[],u=>u.globals.zoom],pitch:[fi,[],u=>u.globals.pitch||0],"distance-from-center":[fi,[],u=>u.distanceFromCenter()],"measure-light":[fi,[jn],(u,[a])=>u.measureLight(a.evaluate(u))],"heatmap-density":[fi,[],u=>u.globals.heatmapDensity||0],"line-progress":[fi,[],u=>u.globals.lineProgress||0],"raster-value":[fi,[],u=>u.globals.rasterValue||0],"raster-particle-speed":[fi,[],u=>u.globals.rasterParticleSpeed||0],"sky-radial-progress":[fi,[],u=>u.globals.skyRadialProgress||0],accumulated:[Vn,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[fi,sc(fi),(u,a)=>{let l=0;for(let d of a)l+=d.evaluate(u);return l}],"*":[fi,sc(fi),(u,a)=>{let l=1;for(let d of a)l*=d.evaluate(u);return l}],"-":{type:fi,overloads:[[[fi,fi],(u,[a,l])=>a.evaluate(u)-l.evaluate(u)],[[fi],(u,[a])=>-a.evaluate(u)]]},"/":[fi,[fi,fi],(u,[a,l])=>a.evaluate(u)/l.evaluate(u)],"%":[fi,[fi,fi],(u,[a,l])=>a.evaluate(u)%l.evaluate(u)],ln2:[fi,[],()=>Math.LN2],pi:[fi,[],()=>Math.PI],e:[fi,[],()=>Math.E],"^":[fi,[fi,fi],(u,[a,l])=>Math.pow(a.evaluate(u),l.evaluate(u))],sqrt:[fi,[fi],(u,[a])=>Math.sqrt(a.evaluate(u))],log10:[fi,[fi],(u,[a])=>Math.log(a.evaluate(u))/Math.LN10],ln:[fi,[fi],(u,[a])=>Math.log(a.evaluate(u))],log2:[fi,[fi],(u,[a])=>Math.log(a.evaluate(u))/Math.LN2],sin:[fi,[fi],(u,[a])=>Math.sin(a.evaluate(u))],cos:[fi,[fi],(u,[a])=>Math.cos(a.evaluate(u))],tan:[fi,[fi],(u,[a])=>Math.tan(a.evaluate(u))],asin:[fi,[fi],(u,[a])=>Math.asin(a.evaluate(u))],acos:[fi,[fi],(u,[a])=>Math.acos(a.evaluate(u))],atan:[fi,[fi],(u,[a])=>Math.atan(a.evaluate(u))],min:[fi,sc(fi),(u,a)=>Math.min(...a.map(l=>l.evaluate(u)))],max:[fi,sc(fi),(u,a)=>Math.max(...a.map(l=>l.evaluate(u)))],abs:[fi,[fi],(u,[a])=>Math.abs(a.evaluate(u))],round:[fi,[fi],(u,[a])=>{let l=a.evaluate(u);return l<0?-Math.round(-l):Math.round(l)}],floor:[fi,[fi],(u,[a])=>Math.floor(a.evaluate(u))],ceil:[fi,[fi],(u,[a])=>Math.ceil(a.evaluate(u))],"filter-==":[kn,[jn,Vn],(u,[a,l])=>u.properties()[a.value]===l.value],"filter-id-==":[kn,[Vn],(u,[a])=>u.id()===a.value],"filter-type-==":[kn,[jn],(u,[a])=>u.geometryType()===a.value],"filter-<":[kn,[jn,Vn],(u,[a,l])=>{let d=u.properties()[a.value],p=l.value;return typeof d==typeof p&&d<p}],"filter-id-<":[kn,[Vn],(u,[a])=>{let l=u.id(),d=a.value;return typeof l==typeof d&&l<d}],"filter->":[kn,[jn,Vn],(u,[a,l])=>{let d=u.properties()[a.value],p=l.value;return typeof d==typeof p&&d>p}],"filter-id->":[kn,[Vn],(u,[a])=>{let l=u.id(),d=a.value;return typeof l==typeof d&&l>d}],"filter-<=":[kn,[jn,Vn],(u,[a,l])=>{let d=u.properties()[a.value],p=l.value;return typeof d==typeof p&&d<=p}],"filter-id-<=":[kn,[Vn],(u,[a])=>{let l=u.id(),d=a.value;return typeof l==typeof d&&l<=d}],"filter->=":[kn,[jn,Vn],(u,[a,l])=>{let d=u.properties()[a.value],p=l.value;return typeof d==typeof p&&d>=p}],"filter-id->=":[kn,[Vn],(u,[a])=>{let l=u.id(),d=a.value;return typeof l==typeof d&&l>=d}],"filter-has":[kn,[Vn],(u,[a])=>a.value in u.properties()],"filter-has-id":[kn,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[kn,[ya(jn)],(u,[a])=>a.value.indexOf(u.geometryType())>=0],"filter-id-in":[kn,[ya(Vn)],(u,[a])=>a.value.indexOf(u.id())>=0],"filter-in-small":[kn,[jn,ya(Vn)],(u,[a,l])=>l.value.indexOf(u.properties()[a.value])>=0],"filter-in-large":[kn,[jn,ya(Vn)],(u,[a,l])=>function(d,p,h,_){for(;h<=_;){let x=h+_>>1;if(p[x]===d)return!0;p[x]>d?_=x-1:h=x+1}return!1}(u.properties()[a.value],l.value,0,l.value.length-1)],all:{type:kn,overloads:[[[kn,kn],(u,[a,l])=>a.evaluate(u)&&l.evaluate(u)],[sc(kn),(u,a)=>{for(let l of a)if(!l.evaluate(u))return!1;return!0}]]},any:{type:kn,overloads:[[[kn,kn],(u,[a,l])=>a.evaluate(u)||l.evaluate(u)],[sc(kn),(u,a)=>{for(let l of a)if(l.evaluate(u))return!0;return!1}]]},"!":[kn,[kn],(u,[a])=>!a.evaluate(u)],"is-supported-script":[kn,[jn],(u,[a])=>{let l=u.globals&&u.globals.isSupportedScript;return!l||l(a.evaluate(u))}],upcase:[jn,[jn],(u,[a])=>a.evaluate(u).toUpperCase()],downcase:[jn,[jn],(u,[a])=>a.evaluate(u).toLowerCase()],concat:[jn,sc(Vn),(u,a)=>a.map(l=>Qo(l.evaluate(u))).join("")],"resolved-locale":[jn,[To],(u,[a])=>a.evaluate(u).resolvedLocale()],random:[fi,[fi,fi,Vn],(u,a)=>{let[l,d,p]=a.map(_=>_.evaluate(u));if(l>d||l===d)return l;let h;if(typeof p=="string")h=function(_){let x=0;if(_.length===0)return x;for(let C=0;C<_.length;C++)x=(x<<5)-x+_.charCodeAt(C),x|=0;return x}(p);else{if(typeof p!="number")throw new mo(`Invalid seed input: ${p}`);h=p}return l+Xv(h)()*(d-l)}]});class nb{constructor(a,l,d,p){this.expression=a,this._warningHistory={},this._evaluator=new rh(d,p),this._defaultValue=l?function(h){return h.type==="color"&&(o_(h.default)||Array.isArray(h.default))?new Ui(0,0,0,0):h.type==="color"?Ui.parse(h.default)||null:h.default===void 0?null:h.default}(l):null,this._enumValues=l&&l.type==="enum"?l.values:null,this.configDependencies=Gc(a)}evaluateWithoutErrorHandling(a,l,d,p,h,_,x,C){return this._evaluator.globals=a,this._evaluator.feature=l,this._evaluator.featureState=d,this._evaluator.canonical=p||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=_,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=C||null,this.expression.evaluate(this._evaluator)}evaluate(a,l,d,p,h,_,x,C){this._evaluator.globals=a,this._evaluator.feature=l||null,this._evaluator.featureState=d||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=_||null,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=C||null;try{let M=this.expression.evaluate(this._evaluator);if(M==null||typeof M=="number"&&M!=M)return this._defaultValue;if(this._enumValues&&!(M in this._enumValues))throw new mo(`Expected value to be one of ${Object.keys(this._enumValues).map(v=>JSON.stringify(v)).join(", ")}, but found ${JSON.stringify(M)} instead.`);return M}catch(M){return this._warningHistory[M.message]||(this._warningHistory[M.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${M.message}`)),this._defaultValue}}}function s_(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in sf}function cf(u,a,l,d){let p=new ap(sf,[],a?function(_){let x={color:Xo,string:jn,number:fi,enum:jn,boolean:kn,formatted:yu,resolvedImage:Lc};return _.type==="array"?ya(x[_.value]||Vn,_.length):x[_.type]}(a):void 0,void 0,void 0,l,d),h=p.parse(u,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?Jv(new nb(h,a,l,d)):dd(p.errors)}class rb{constructor(a,l,d,p){this.kind=a,this._styleExpression=l,this.isLightConstant=d,this.isLineProgressConstant=p,this.isStateDependent=a!=="constant"&&!Ol(l.expression),this.configDependencies=Gc(l.expression)}evaluateWithoutErrorHandling(a,l,d,p,h,_){return this._styleExpression.evaluateWithoutErrorHandling(a,l,d,p,h,_)}evaluate(a,l,d,p,h,_){return this._styleExpression.evaluate(a,l,d,p,h,_)}}class uf{constructor(a,l,d,p,h,_){this.kind=a,this.zoomStops=d,this._styleExpression=l,this.isStateDependent=a!=="camera"&&!Ol(l.expression),this.isLightConstant=h,this.isLineProgressConstant=_,this.configDependencies=Gc(l.expression),this.interpolationType=p}evaluateWithoutErrorHandling(a,l,d,p,h,_){return this._styleExpression.evaluateWithoutErrorHandling(a,l,d,p,h,_)}evaluate(a,l,d,p,h,_){return this._styleExpression.evaluate(a,l,d,p,h,_)}interpolationFactor(a,l,d){return this.interpolationType?$s.interpolationFactor(this.interpolationType,a,l,d):0}}function ob(u,a,l,d){if((u=cf(u,a,l,d)).result==="error")return u;let p=u.value.expression,h=$c(p);if(!h&&!lf(a))return dd([new yn("","data expressions not supported")]);let _=Is(p,["zoom","pitch","distance-from-center"]);if(!_&&!hE(a))return dd([new yn("","zoom expressions not supported")]);let x=Is(p,["measure-light"]);if(!x&&!r_(a))return dd([new yn("","measure-light expression not supported")]);let C=Is(p,["line-progress"]);if(!C&&!function(S){return eb(S.expression,"line-progress")}(a))return dd([new yn("","line-progress expression not supported")]);let M=a.expression&&a.expression.relaxZoomRestriction,v=c_(p);return v||_||M?v instanceof yn?dd([v]):v instanceof $s&&!tb(a)?dd([new yn("",'"interpolate" expressions cannot be used with this property')]):Jv(v?new uf(h&&C?"camera":"composite",u.value,v.labels,v instanceof $s?v.interpolation:void 0,x,C):new rb(h&&C?"constant":"source",u.value,x,C)):dd([new yn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class l_{constructor(a,l){this._parameters=a,this._specification=l,Sn(this,fE(this._parameters,this._specification))}static deserialize(a){return new l_(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function c_(u){let a=null;if(u instanceof e_)a=c_(u.result);else if(u instanceof J0){for(let l of u.args)if(a=c_(l),a)break}else(u instanceof ac||u instanceof $s)&&u.input instanceof qa&&u.input.name==="zoom"&&(a=u);return a instanceof yn||u.eachChild(l=>{let d=c_(l);d instanceof yn?a=d:a&&d&&a!==d&&(a=new yn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}var tg,gE,_E=function(){if(gE)return tg;gE=1,tg=a;var u=3;function a(l,d,p){var h=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;var _=new Int32Array(this.arrayBuffer);l=_[0],this.d=(d=_[1])+2*(p=_[2]);for(var x=0;x<this.d*this.d;x++){var C=_[u+x],M=_[u+x+1];h.push(C===M?null:_.subarray(C,M))}var v=_[u+h.length+1];this.keys=_.subarray(_[u+h.length],v),this.bboxes=_.subarray(v),this.insert=this._insertReadonly}else{this.d=d+2*p;for(var S=0;S<this.d*this.d;S++)h.push([]);this.keys=[],this.bboxes=[]}this.n=d,this.extent=l,this.padding=p,this.scale=d/l,this.uid=0;var A=p/d*l;this.min=-A,this.max=l+A}return a.prototype.insert=function(l,d,p,h,_){this._forEachCell(d,p,h,_,this._insertCell,this.uid++),this.keys.push(l),this.bboxes.push(d),this.bboxes.push(p),this.bboxes.push(h),this.bboxes.push(_)},a.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},a.prototype._insertCell=function(l,d,p,h,_,x){this.cells[_].push(x)},a.prototype.query=function(l,d,p,h,_){var x=this.min,C=this.max;if(l<=x&&d<=x&&C<=p&&C<=h&&!_)return Array.prototype.slice.call(this.keys);var M=[];return this._forEachCell(l,d,p,h,this._queryCell,M,{},_),M},a.prototype._queryCell=function(l,d,p,h,_,x,C,M){var v=this.cells[_];if(v!==null)for(var S=this.keys,A=this.bboxes,D=0;D<v.length;D++){var I=v[D];if(C[I]===void 0){var O=4*I;(M?M(A[O+0],A[O+1],A[O+2],A[O+3]):l<=A[O+2]&&d<=A[O+3]&&p>=A[O+0]&&h>=A[O+1])?(C[I]=!0,x.push(S[I])):C[I]=!1}}},a.prototype._forEachCell=function(l,d,p,h,_,x,C,M){for(var v=this._convertToCellCoord(l),S=this._convertToCellCoord(d),A=this._convertToCellCoord(p),D=this._convertToCellCoord(h),I=v;I<=A;I++)for(var O=S;O<=D;O++){var z=this.d*O+I;if((!M||M(this._convertFromCellCoord(I),this._convertFromCellCoord(O),this._convertFromCellCoord(I+1),this._convertFromCellCoord(O+1)))&&_.call(this,l,d,p,h,z,x,C,M))return}},a.prototype._convertFromCellCoord=function(l){return(l-this.padding)/this.scale},a.prototype._convertToCellCoord=function(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))},a.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,d=u+this.cells.length+1+1,p=0,h=0;h<this.cells.length;h++)p+=this.cells[h].length;var _=new Int32Array(d+p+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;for(var x=d,C=0;C<l.length;C++){var M=l[C];_[u+C]=x,_.set(M,x),x+=M.length}return _[u+l.length]=x,_.set(this.keys,x),_[u+l.length+1]=x+=this.keys.length,_.set(this.bboxes,x),x+=this.bboxes.length,_.buffer},tg}(),df=g(_E);let u_={};function ii(u,a,l={}){Object.defineProperty(u,"_classRegistryKey",{value:a,writable:!1}),u_[a]={klass:u,omit:l.omit||[]}}ii(Object,"Object"),df.serialize=function(u,a){let l=u.toArrayBuffer();return a&&a.add(l),{buffer:l}},df.deserialize=function(u){return new df(u.buffer)},Object.defineProperty(df,"name",{value:"Grid"}),ii(df,"Grid"),typeof DOMMatrix<"u"&&ii(DOMMatrix,"DOMMatrix"),ii(Ui,"Color"),ii(Error,"Error"),ii(Aa,"Formatted"),ii(id,"FormattedSection"),ii(No,"AJAXError"),ii(va,"ResolvedImage"),ii(l_,"StylePropertyFunction"),ii(nb,"StyleExpression",{omit:["_evaluator"]}),ii(ls,"ImageId"),ii(ic,"ImageVariant"),ii(uf,"ZoomDependentExpression"),ii(rb,"ZoomConstantExpression"),ii(qa,"CompoundExpression",{omit:["_evaluate"]});for(let u in sf)u_[sf[u]._classRegistryKey]||ii(sf[u],`Expression${u}`);function ab(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function sb(u){return self.ImageBitmap&&u instanceof ImageBitmap}function hh(u,a){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp)return u;if(ab(u)||sb(u))return a&&a.add(u),u;if(ArrayBuffer.isView(u))return a&&a.add(u.buffer),u;if(u instanceof ImageData)return a&&a.add(u.data.buffer),u;if(Array.isArray(u)){let l=[];for(let d of u)l.push(hh(d,a));return l}if(u instanceof Map){let l={$name:"Map",entries:[]};for(let[d,p]of u.entries())l.entries.push(hh(d),hh(p));return l}if(u instanceof Set){let l={$name:"Set"},d=0;for(let p of u.values())l[++d]=hh(p);return l}if(u instanceof DOMMatrix){let l={$name:"DOMMatrix"},d=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(let p of d)l[p]=u[p];return l}if(typeof u=="bigint")return{$name:"BigInt",value:u.toString()};if(typeof u=="object"){let l=u.constructor,d=l._classRegistryKey;if(!d)throw new Error(`Can't serialize object of unregistered class "${l.name}".`);let p=l.serialize?l.serialize(u,a):{};if(!l.serialize){for(let h in u)u.hasOwnProperty(h)&&(u_[d].omit.indexOf(h)>=0||(p[h]=hh(u[h],a)));u instanceof Error&&(p.message=u.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return d!=="Object"&&(p.$name=d),p}throw new Error("can't serialize object of type "+typeof u)}function Ll(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||ab(u)||sb(u)||ArrayBuffer.isView(u)||u instanceof ImageData)return u;if(Array.isArray(u))return u.map(Ll);if(typeof u=="object"){let a=u.$name||"Object";if(a==="Map"){let p=u.entries||[],h=new Map;for(let _=0;_<p.length;_+=2)h.set(Ll(p[_]),Ll(p[_+1]));return h}if(a==="Set"){let p=new Set;for(let h of Object.keys(u))h!=="$name"&&p.add(Ll(u[h]));return p}if(a==="DOMMatrix"){let p;return p=u.is2D?[u.a,u.b,u.c,u.d,u.e,u.f]:[u.m11,u.m12,u.m13,u.m14,u.m21,u.m22,u.m23,u.m24,u.m31,u.m32,u.m33,u.m34,u.m41,u.m42,u.m43,u.m44],new DOMMatrix(p)}if(a==="BigInt")return BigInt(u.value);let{klass:l}=u_[a];if(!l)throw new Error(`Can't deserialize unregistered class "${a}".`);if(l.deserialize)return l.deserialize(u);let d=Object.create(l.prototype);for(let p of Object.keys(u))p!=="$name"&&(d[p]=Ll(u[p]));return d}throw new Error("can't deserialize object of type "+typeof u)}let Ii={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519,Osage:u=>u>=66736&&u<=66815,"CJK Unified Ideographs Extension B":u=>u>=131072&&u<=173791};function lb(u){for(let a of u)if(d_(a.charCodeAt(0)))return!0;return!1}function AI(u){for(let a of u)if(!yE(a.charCodeAt(0)))return!1;return!0}function yE(u){return!(Ii.Arabic(u)||Ii["Arabic Supplement"](u)||Ii["Arabic Extended-A"](u)||Ii["Arabic Presentation Forms-A"](u)||Ii["Arabic Presentation Forms-B"](u))}function d_(u){return!(u!==746&&u!==747&&(u<4352||!(Ii["Bopomofo Extended"](u)||Ii.Bopomofo(u)||Ii["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||Ii["CJK Compatibility Ideographs"](u)||Ii["CJK Compatibility"](u)||Ii["CJK Radicals Supplement"](u)||Ii["CJK Strokes"](u)||!(!Ii["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||Ii["CJK Unified Ideographs Extension A"](u)||Ii["CJK Unified Ideographs"](u)||Ii["Enclosed CJK Letters and Months"](u)||Ii["Hangul Compatibility Jamo"](u)||Ii["Hangul Jamo Extended-A"](u)||Ii["Hangul Jamo Extended-B"](u)||Ii["Hangul Jamo"](u)||Ii["Hangul Syllables"](u)||Ii.Hiragana(u)||Ii["Ideographic Description Characters"](u)||Ii.Kanbun(u)||Ii["Kangxi Radicals"](u)||Ii["Katakana Phonetic Extensions"](u)||Ii.Katakana(u)&&u!==12540||!(!Ii["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!Ii["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||Ii["Unified Canadian Aboriginal Syllabics"](u)||Ii["Unified Canadian Aboriginal Syllabics Extended"](u)||Ii["Vertical Forms"](u)||Ii["Yijing Hexagram Symbols"](u)||Ii["Yi Syllables"](u)||Ii["Yi Radicals"](u))))}function cb(u){return!(d_(u)||function(a){return!!(Ii["Latin-1 Supplement"](a)&&(a===167||a===169||a===174||a===177||a===188||a===189||a===190||a===215||a===247)||Ii["General Punctuation"](a)&&(a===8214||a===8224||a===8225||a===8240||a===8241||a===8251||a===8252||a===8258||a===8263||a===8264||a===8265||a===8273)||Ii["Letterlike Symbols"](a)||Ii["Number Forms"](a)||Ii["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||a===9003||a>=9085&&a<=9114||a>=9150&&a<=9165||a===9167||a>=9169&&a<=9179||a>=9186&&a<=9215)||Ii["Control Pictures"](a)&&a!==9251||Ii["Optical Character Recognition"](a)||Ii["Enclosed Alphanumerics"](a)||Ii["Geometric Shapes"](a)||Ii["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||Ii["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||Ii["CJK Symbols and Punctuation"](a)||Ii.Katakana(a)||Ii["Private Use Area"](a)||Ii["CJK Compatibility Forms"](a)||Ii["Small Form Variants"](a)||Ii["Halfwidth and Fullwidth Forms"](a)||a===8734||a===8756||a===8757||a>=9984&&a<=10087||a>=10102&&a<=10131||a===65532||a===65533)}(u))}function vE(u){return Ii.Arabic(u)||Ii["Arabic Supplement"](u)||Ii["Arabic Extended-A"](u)||Ii["Arabic Presentation Forms-A"](u)||Ii["Arabic Presentation Forms-B"](u)}function h_(u){return u>=1424&&u<=2303||Ii["Arabic Presentation Forms-A"](u)||Ii["Arabic Presentation Forms-B"](u)}function ub(u,a){return!(!a&&h_(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||Ii.Khmer(u))}function bE(u){for(let a of u)if(h_(a.charCodeAt(0)))return!0;return!1}let db="deferred",p_="loading",hb="loaded",pb=null,Gs="unavailable",ph=null,ig=function(u){u&&typeof u=="string"&&u.indexOf("NetworkError")>-1&&(Gs="error"),pb&&pb(u)};function f_(){hf.fire(new Ts("pluginStateChange",{pluginStatus:Gs,pluginURL:ph}))}let hf=new ss,m_=function(){return Gs},xE=function(){if(Gs!==db||!ph)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Gs=p_,f_(),ph&&js({url:ph},u=>{u?ig(u):(Gs=hb,f_())})},lc={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Gs===hb||lc.applyArabicShaping!=null,isLoading:()=>Gs===p_,setState(u){Gs=u.pluginStatus,ph=u.pluginURL},isParsed:()=>lc.applyArabicShaping!=null&&lc.processBidirectionalText!=null&&lc.processStyledBidirectionalText!=null,getPluginURL:()=>ph};class Ar{constructor(a,l){this.zoom=a,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.transition=l.transition,this.pitch=l.pitch,this.brightness=l.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(a){return function(l,d){for(let p of l)if(!ub(p.charCodeAt(0),d))return!1;return!0}(a,lc.isLoaded())}}class pf{constructor(a,l,d,p){this.property=a,this.value=l,this.expression=function(h,_,x,C){if(o_(h))return new l_(h,_);if(s_(h)||Array.isArray(h)&&h.length>0){let M=ob(h,_,x,C);if(M.result==="error")throw new Error(M.value.map(v=>`${v.key}: ${v.message}`).join(", "));return M.value}{let M=h;return typeof h=="string"&&_.type==="color"&&(M=Ui.parse(h)),{kind:"constant",configDependencies:new Set,evaluate:()=>M}}}(l===void 0?a.specification.default:l,a.specification,d,p)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(a,l,d){return this.property.possiblyEvaluate(this,a,l,d)}}class fb{constructor(a,l,d){this.property=a,this.value=new pf(a,void 0,l,d)}transitioned(a,l){return new g_(this.property,this.value,l,Da({},a.transition,this.transition),a.now)}untransitioned(){return new g_(this.property,this.value,null,{},0)}}class mb{constructor(a,l,d){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues),this._scope=l,this._options=d,this.configDependencies=new Set}getValue(a){return Zn(this._values[a].value.value)}setValue(a,l){this._values.hasOwnProperty(a)||(this._values[a]=new fb(this._values[a].property,this._scope,this._options)),this._values[a].value=new pf(this._values[a].property,l===null?void 0:Zn(l),this._scope,this._options),this._values[a].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[a].value.expression.configDependencies]))}setTransitionOrValue(a,l){l&&(this._options=l);let d=this._properties.properties;if(a)for(let p in a){let h=a[p];if(p.endsWith("-transition")){let _=p.slice(0,-11);d[_]&&this.setTransition(_,h)}else d.hasOwnProperty(p)&&this.setValue(p,h)}}getTransition(a){return Zn(this._values[a].transition)}setTransition(a,l){this._values.hasOwnProperty(a)||(this._values[a]=new fb(this._values[a].property)),this._values[a].transition=Zn(l)||void 0}serialize(){let a={};for(let l of Object.keys(this._values)){let d=this.getValue(l);d!==void 0&&(a[l]=d);let p=this.getTransition(l);p!==void 0&&(a[`${l}-transition`]=p)}return a}transitioned(a,l){let d=new ng(this._properties);for(let p of Object.keys(this._values))d._values[p]=this._values[p].transitioned(a,l._values[p]);return d}untransitioned(){let a=new ng(this._properties);for(let l of Object.keys(this._values))a._values[l]=this._values[l].untransitioned();return a}}class g_{constructor(a,l,d,p,h){let _=p.delay||0,x=p.duration||0;h=h||0,this.property=a,this.value=l,this.begin=h+_,this.end=this.begin+x,a.specification.transition&&(p.delay||p.duration)&&(this.prior=d)}possiblyEvaluate(a,l,d){let p=a.now||0,h=this.value.possiblyEvaluate(a,l,d),_=this.prior;if(_){if(p>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(p<this.begin)return _.possiblyEvaluate(a,l,d);{let x=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(a,l,d),h,kc(x))}}return h}}class ng{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,l,d){let p=new gf(this._properties);for(let h of Object.keys(this._values))p._values[h]=this._values[h].possiblyEvaluate(a,l,d);return p}hasTransition(){for(let a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class ff{constructor(a,l,d){this._properties=a,this._values=Object.create(a.defaultPropertyValues),this._scope=l,this._options=d,this.configDependencies=new Set}getValue(a){return Zn(this._values[a].value)}setValue(a,l){this._values[a]=new pf(this._values[a].property,l===null?void 0:Zn(l),this._scope,this._options),this._values[a].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[a].expression.configDependencies]))}serialize(){let a={};for(let l of Object.keys(this._values)){let d=this.getValue(l);d!==void 0&&(a[l]=d)}return a}possiblyEvaluate(a,l,d){let p=new gf(this._properties);for(let h of Object.keys(this._values))p._values[h]=this._values[h].possiblyEvaluate(a,l,d);return p}}class mf{constructor(a,l,d){this.property=a,this.value=l,this.parameters=d}isConstant(){return this.value.kind==="constant"}constantOr(a){return this.value.kind==="constant"?this.value.value:a}evaluate(a,l,d,p){return this.property.evaluate(this.value,this.parameters,a,l,d,p)}}class gf{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class Ht{constructor(a){this.specification=a}possiblyEvaluate(a,l){return a.expression.evaluate(l)}interpolate(a,l,d){let p=Nc[this.specification.type];return p?p(a,l,d):a}}class ti{constructor(a,l){this.specification=a,this.overrides=l}possiblyEvaluate(a,l,d,p){return new mf(this,a.expression.kind==="constant"||a.expression.kind==="camera"?{kind:"constant",value:a.expression.evaluate(l,null,{},d,p)}:a.expression,l)}interpolate(a,l,d){if(a.value.kind!=="constant"||l.value.kind!=="constant")return a;if(a.value.value===void 0||l.value.value===void 0)return new mf(this,{kind:"constant",value:void 0},a.parameters);let p=Nc[this.specification.type];return p?new mf(this,{kind:"constant",value:p(a.value.value,l.value.value,d)},a.parameters):a}evaluate(a,l,d,p,h,_){return a.kind==="constant"?a.value:a.evaluate(l,d,p,h,_)}}class _f{constructor(a){this.specification=a}possiblyEvaluate(a,l,d,p){return!!a.expression.evaluate(l,null,{},d,p)}interpolate(){return!1}}class no{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];let l=new Ar(0,{});for(let d in a){let p=a[d];p.specification.overridable&&this.overridableProperties.push(d);let h=this.defaultPropertyValues[d]=new pf(p,void 0),_=this.defaultTransitionablePropertyValues[d]=new fb(p);this.defaultTransitioningPropertyValues[d]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=h.possiblyEvaluate(l)}}}ii(ti,"DataDrivenProperty"),ii(Ht,"DataConstantProperty"),ii(_f,"ColorRampProperty");var lt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow","experimental":true},"rain":{"type":"rain","experimental":true},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor","experimental":true},"imports":{"type":"array","value":"import"},"iconsets":{"experimental":true,"type":"iconsets"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"experimental":true,"type":"*"},"selectors":{"experimental":true,"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"experimental":true,"type":"string","required":true},"properties":{"experimental":true,"type":"selectorProperty","required":false},"featureNamespace":{"experimental":true,"type":"string","required":false},"_uniqueFeatureID":{"experimental":true,"type":"boolean","private":true,"required":false}},"selectorProperty":{"experimental":true,"*":{"experimental":true,"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-quality":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]},"experimental":true},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"required":true,"type":"enum","values":{"sprite":1}},"url":{"required":true,"type":"string"}},"iconset_source":{"type":{"required":true,"type":"enum","values":{"source":1}},"source":{"required":true,"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant"},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","experimental":true,"private":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","experimental":true,"private":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.4,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","property-type":"data-constant","default":0.71,"minimum":0,"maximum":5,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.57,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","property-type":"data-constant","default":0.7,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}},"buildingFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","experimental":true,"private":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","transition":true,"experimental":true,"private":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"experimental":true,"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"*"}}}');function wE(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function __(u){if(Array.isArray(u))return u.map(__);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){let a={};for(let l in u)a[l]=__(u[l]);return a}return wE(u)}function gb(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(let a of u.slice(1))if(!gb(a)&&typeof a!="boolean")return!1;return!0;default:return!0}}function _b(u,a="",l=null,d="fill"){if(u==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};gb(u)||(u=y_(u));let p=u,h=!0;try{h=function(v){if(!yf(v))return v;let S=__(v);return CE(S),S=EE(S),S}(p)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(p,null,2)}
        `)}let _=null,x=null;if(d!=="background"&&d!=="sky"&&d!=="slot"){x=lt[`filter_${d}`];let v=cf(h,x,a,l);if(v.result==="error")throw new Error(v.value.map(S=>`${S.key}: ${S.message}`).join(", "));_=(S,A,D)=>v.value.evaluate(S,A,{},D)}let C=null,M=null;if(h!==p){let v=cf(p,x,a,l);if(v.result==="error")throw new Error(v.value.map(S=>`${S.key}: ${S.message}`).join(", "));C=(S,A,D,I,O)=>v.value.evaluate(S,A,{},D,void 0,void 0,I,O),M=!$c(v.value.expression)}return{filter:_,dynamicFilter:C||void 0,needGeometry:SE(h),needFeature:!!M}}function EE(u){if(!Array.isArray(u))return u;let a=function(l){if(RI.has(l[0])){for(let d=1;d<l.length;d++)if(yf(l[d]))return!0}return l}(u);return a===!0?a:a.map(l=>EE(l))}function CE(u){let a=!1,l=[];if(u[0]==="case"){for(let d=1;d<u.length-1;d+=2)a=a||yf(u[d]),l.push(u[d+1]);l.push(u[u.length-1])}else if(u[0]==="match"){a=a||yf(u[1]);for(let d=2;d<u.length-1;d+=2)l.push(u[d+1]);l.push(u[u.length-1])}else if(u[0]==="step"){a=a||yf(u[1]);for(let d=1;d<u.length-1;d+=2)l.push(u[d+1])}a&&(u.length=0,u.push("any",...l));for(let d=1;d<u.length;d++)CE(u[d])}function yf(u){if(!Array.isArray(u))return!1;if((a=u[0])==="pitch"||a==="distance-from-center")return!0;var a;for(let l=1;l<u.length;l++)if(yf(u[l]))return!0;return!1}let RI=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function kI(u,a){return u<a?-1:u>a?1:0}function SE(u){if(!Array.isArray(u))return!1;if(u[0]==="within"||u[0]==="distance")return!0;for(let a=1;a<u.length;a++)if(SE(u[a]))return!0;return!1}function y_(u){if(!u)return!0;let a=u[0];return u.length<=1?a!=="any":a==="=="?fh(u[1],u[2],"=="):a==="!="?lp(fh(u[1],u[2],"==")):a==="<"||a===">"||a==="<="||a===">="?fh(u[1],u[2],a):a==="any"?(l=u.slice(1),["any"].concat(l.map(y_))):a==="all"?["all"].concat(u.slice(1).map(y_)):a==="none"?["all"].concat(u.slice(1).map(y_).map(lp)):a==="in"?yb(u[1],u.slice(2)):a==="!in"?lp(yb(u[1],u.slice(2))):a==="has"?vb(u[1]):a!=="!has"||lp(vb(u[1]));var l}function fh(u,a,l){switch(u){case"$type":return[`filter-type-${l}`,a];case"$id":return[`filter-id-${l}`,a];default:return[`filter-${l}`,u,a]}}function yb(u,a){if(a.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(l=>typeof l!=typeof a[0])?["filter-in-large",u,["literal",a.sort(kI)]]:["filter-in-small",u,["literal",a]]}}function vb(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function lp(u){return["!",u]}let v_="";function vf(u,a){return a?`${u}${v_}${a}`:u}let hd="-transition",TE=new Set(["fill","line","background","hillshade","raster"]);class xa extends ss{constructor(a,l,d,p,h){if(super(),this.id=a.id,this.fqid=vf(this.id,d),this.type=a.type,this.scope=d,this.lut=p,this.options=h,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,a.type!=="custom"){if(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,a.type&&a.type!=="background"&&a.type!=="sky"&&a.type!=="slot"){this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter;let _=cf(this.filter,lt[`filter_${a.type}`]);_.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,..._.value.configDependencies]))}if(a.slot&&(this.slot=a.slot),l.layout&&(this._unevaluatedLayout=new ff(l.layout,this.scope,h),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),l.paint){this._transitionablePaint=new mb(l.paint,this.scope,h);for(let _ in a.paint)this.setPaintProperty(_,a.paint[_]);for(let _ in a.layout)this.setLayoutProperty(_,a.layout[_]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new gf(l.paint)}}}onAdd(a){}onRemove(a){}isDraped(a){return!this.is3D(!0)&&TE.has(this.type)}getLayoutProperty(a){return a==="visibility"?this.visibility:this._unevaluatedLayout.getValue(a)}setLayoutProperty(a,l){if(this.type==="custom"&&a==="visibility")return void(this.visibility=l);let d=this._unevaluatedLayout;d._properties.properties[a]&&(d.setValue(a,l),this.configDependencies=new Set([...this.configDependencies,...d.configDependencies]),a==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(a){return a.endsWith(hd)?this._transitionablePaint.getTransition(a.slice(0,-11)):this._transitionablePaint.getValue(a)}setPaintProperty(a,l){let d=this._transitionablePaint,p=d._properties.properties;if(a.endsWith(hd)){let S=a.slice(0,-11);return p[S]&&d.setTransition(S,l||void 0),!1}if(!p[a])return!1;let h=d._values[a],_=h.value.isDataDriven(),x=h.value;d.setValue(a,l),this.configDependencies=new Set([...this.configDependencies,...d.configDependencies]),this._handleSpecialPaintPropertyUpdate(a);let C=d._values[a].value,M=C.isDataDriven(),v=a.endsWith("pattern")||a==="line-dasharray";return M||_||v||this._handleOverridablePaintPropertyUpdate(a,x,C)}_handleSpecialPaintPropertyUpdate(a){}getProgramIds(){return null}getDefaultProgramParams(a,l,d){return null}_handleOverridablePaintPropertyUpdate(a,l,d){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||this.visibility==="none"}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,l){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,l)}serialize(){return pu({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(a,l)=>!(a===void 0||l==="layout"&&!Object.keys(a).length||l==="paint"&&!Object.keys(a).length))}is3D(a){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(let a in this.paint._values){let l=this.paint.get(a);if(l instanceof mf&&lf(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}compileFilter(a){this._filterCompiled||(this._featureFilter=_b(this.filter,this.scope,a),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(a){this._stats&&(a.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(a){}queryIntersectsFeature(a,l,d,p,h,_,x,C,M){}}let OI={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class rg{constructor(a,l){this._structArray=a,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Fr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,l){return a._trim(),l&&(a.isTransferred=!0,l.add(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){let l=Object.create(this.prototype);return l.arrayBuffer=a.arrayBuffer,l.length=a.length,l.capacity=a.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...a){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...a){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Jn(u,a=1){let l=0,d=0;return{members:u.map(p=>{let h=OI[p.type].BYTES_PER_ELEMENT,_=l=DE(l,Math.max(a,h)),x=p.components||1;return d=Math.max(d,h),l+=h*x,{name:p.name,type:p.type,components:x,offset:_}}),size:DE(l,Math.max(d,a)),alignment:a}}function DE(u,a){return Math.ceil(u/a)*a}class pd extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l){let d=this.length;return this.resize(d+1),this.emplace(d,a,l)}emplace(a,l,d){let p=2*a;return this.int16[p+0]=l,this.int16[p+1]=d,a}}pd.prototype.bytesPerElement=4,ii(pd,"StructArrayLayout2i4");class bf extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,d){let p=this.length;return this.resize(p+1),this.emplace(p,a,l,d)}emplace(a,l,d,p){let h=3*a;return this.int16[h+0]=l,this.int16[h+1]=d,this.int16[h+2]=p,a}}bf.prototype.bytesPerElement=6,ii(bf,"StructArrayLayout3i6");class fd extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,d,p){let h=this.length;return this.resize(h+1),this.emplace(h,a,l,d,p)}emplace(a,l,d,p,h){let _=4*a;return this.int16[_+0]=l,this.int16[_+1]=d,this.int16[_+2]=p,this.int16[_+3]=h,a}}fd.prototype.bytesPerElement=8,ii(fd,"StructArrayLayout4i8");class cp extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){let l=this.length;return this.resize(l+1),this.emplace(l,a)}emplace(a,l){return this.float32[1*a+0]=l,a}}cp.prototype.bytesPerElement=4,ii(cp,"StructArrayLayout1f4");class og extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,d){let p=this.length;return this.resize(p+1),this.emplace(p,a,l,d)}emplace(a,l,d,p){let h=4*a,_=2*a;return this.int16[h+0]=l,this.int16[h+1]=d,this.float32[_+1]=p,a}}og.prototype.bytesPerElement=8,ii(og,"StructArrayLayout2i1f8");class bb extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,d){let p=this.length;return this.resize(p+1),this.emplace(p,a,l,d)}emplace(a,l,d,p){let h=4*a;return this.int16[h+0]=l,this.int16[h+1]=d,this.int16[h+2]=p,a}}bb.prototype.bytesPerElement=8,ii(bb,"StructArrayLayout3i8");class cc extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,d,p,h){let _=this.length;return this.resize(_+1),this.emplace(_,a,l,d,p,h)}emplace(a,l,d,p,h,_){let x=5*a;return this.int16[x+0]=l,this.int16[x+1]=d,this.int16[x+2]=p,this.int16[x+3]=h,this.int16[x+4]=_,a}}cc.prototype.bytesPerElement=10,ii(cc,"StructArrayLayout5i10");class xb extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,d,p,h,_,x){let C=this.length;return this.resize(C+1),this.emplace(C,a,l,d,p,h,_,x)}emplace(a,l,d,p,h,_,x,C){let M=6*a,v=12*a,S=3*a;return this.int16[M+0]=l,this.int16[M+1]=d,this.uint8[v+4]=p,this.uint8[v+5]=h,this.uint8[v+6]=_,this.uint8[v+7]=x,this.float32[S+2]=C,a}}xb.prototype.bytesPerElement=12,ii(xb,"StructArrayLayout2i4ub1f12");class Zc extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,d){let p=this.length;return this.resize(p+1),this.emplace(p,a,l,d)}emplace(a,l,d,p){let h=3*a;return this.float32[h+0]=l,this.float32[h+1]=d,this.float32[h+2]=p,a}}Zc.prototype.bytesPerElement=12,ii(Zc,"StructArrayLayout3f12");class mh extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,d,p,h){let _=this.length;return this.resize(_+1),this.emplace(_,a,l,d,p,h)}emplace(a,l,d,p,h,_){let x=6*a,C=3*a;return this.uint16[x+0]=l,this.uint16[x+1]=d,this.uint16[x+2]=p,this.uint16[x+3]=h,this.float32[C+2]=_,a}}mh.prototype.bytesPerElement=12,ii(mh,"StructArrayLayout4ui1f12");class b_ extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,l,d,p){let h=this.length;return this.resize(h+1),this.emplace(h,a,l,d,p)}emplace(a,l,d,p,h){let _=4*a;return this.uint16[_+0]=l,this.uint16[_+1]=d,this.uint16[_+2]=p,this.uint16[_+3]=h,a}}b_.prototype.bytesPerElement=8,ii(b_,"StructArrayLayout4ui8");class x_ extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,d,p,h,_){let x=this.length;return this.resize(x+1),this.emplace(x,a,l,d,p,h,_)}emplace(a,l,d,p,h,_,x){let C=6*a;return this.int16[C+0]=l,this.int16[C+1]=d,this.int16[C+2]=p,this.int16[C+3]=h,this.int16[C+4]=_,this.int16[C+5]=x,a}}x_.prototype.bytesPerElement=12,ii(x_,"StructArrayLayout6i12");class wb extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,l,d,p,h,_,x,C,M,v,S,A){let D=this.length;return this.resize(D+1),this.emplace(D,a,l,d,p,h,_,x,C,M,v,S,A)}emplace(a,l,d,p,h,_,x,C,M,v,S,A,D){let I=12*a;return this.int16[I+0]=l,this.int16[I+1]=d,this.int16[I+2]=p,this.int16[I+3]=h,this.uint16[I+4]=_,this.uint16[I+5]=x,this.uint16[I+6]=C,this.uint16[I+7]=M,this.int16[I+8]=v,this.int16[I+9]=S,this.int16[I+10]=A,this.int16[I+11]=D,a}}wb.prototype.bytesPerElement=24,ii(wb,"StructArrayLayout4i4ui4i24");class Eb extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,d,p,h,_){let x=this.length;return this.resize(x+1),this.emplace(x,a,l,d,p,h,_)}emplace(a,l,d,p,h,_,x){let C=10*a,M=5*a;return this.int16[C+0]=l,this.int16[C+1]=d,this.int16[C+2]=p,this.float32[M+2]=h,this.float32[M+3]=_,this.float32[M+4]=x,a}}Eb.prototype.bytesPerElement=20,ii(Eb,"StructArrayLayout3i3f20");class up extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,d,p){let h=this.length;return this.resize(h+1),this.emplace(h,a,l,d,p)}emplace(a,l,d,p,h){let _=4*a;return this.float32[_+0]=l,this.float32[_+1]=d,this.float32[_+2]=p,this.float32[_+3]=h,a}}up.prototype.bytesPerElement=16,ii(up,"StructArrayLayout4f16");class Cb extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){let l=this.length;return this.resize(l+1),this.emplace(l,a)}emplace(a,l){return this.uint32[1*a+0]=l,a}}Cb.prototype.bytesPerElement=4,ii(Cb,"StructArrayLayout1ul4");class gh extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,l){let d=this.length;return this.resize(d+1),this.emplace(d,a,l)}emplace(a,l,d){let p=2*a;return this.uint16[p+0]=l,this.uint16[p+1]=d,a}}gh.prototype.bytesPerElement=4,ii(gh,"StructArrayLayout2ui4");class Sb extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,l,d,p,h,_,x,C,M,v,S,A,D){let I=this.length;return this.resize(I+1),this.emplace(I,a,l,d,p,h,_,x,C,M,v,S,A,D)}emplace(a,l,d,p,h,_,x,C,M,v,S,A,D,I){let O=20*a,z=10*a;return this.int16[O+0]=l,this.int16[O+1]=d,this.int16[O+2]=p,this.int16[O+3]=h,this.int16[O+4]=_,this.float32[z+3]=x,this.float32[z+4]=C,this.float32[z+5]=M,this.float32[z+6]=v,this.int16[O+14]=S,this.uint32[z+8]=A,this.uint16[O+18]=D,this.uint16[O+19]=I,a}}Sb.prototype.bytesPerElement=40,ii(Sb,"StructArrayLayout5i4f1i1ul2ui40");class ag extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,d,p,h,_,x){let C=this.length;return this.resize(C+1),this.emplace(C,a,l,d,p,h,_,x)}emplace(a,l,d,p,h,_,x,C){let M=8*a;return this.int16[M+0]=l,this.int16[M+1]=d,this.int16[M+2]=p,this.int16[M+4]=h,this.int16[M+5]=_,this.int16[M+6]=x,this.int16[M+7]=C,a}}ag.prototype.bytesPerElement=16,ii(ag,"StructArrayLayout3i2i2i16");class Tb extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,d,p,h){let _=this.length;return this.resize(_+1),this.emplace(_,a,l,d,p,h)}emplace(a,l,d,p,h,_){let x=4*a,C=8*a;return this.float32[x+0]=l,this.float32[x+1]=d,this.float32[x+2]=p,this.int16[C+6]=h,this.int16[C+7]=_,a}}Tb.prototype.bytesPerElement=16,ii(Tb,"StructArrayLayout2f1f2i16");class Db extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,d,p,h,_){let x=this.length;return this.resize(x+1),this.emplace(x,a,l,d,p,h,_)}emplace(a,l,d,p,h,_,x){let C=20*a,M=5*a;return this.uint8[C+0]=l,this.uint8[C+1]=d,this.float32[M+1]=p,this.float32[M+2]=h,this.float32[M+3]=_,this.float32[M+4]=x,a}}Db.prototype.bytesPerElement=20,ii(Db,"StructArrayLayout2ub4f20");class Ra extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,l,d){let p=this.length;return this.resize(p+1),this.emplace(p,a,l,d)}emplace(a,l,d,p){let h=3*a;return this.uint16[h+0]=l,this.uint16[h+1]=d,this.uint16[h+2]=p,a}}Ra.prototype.bytesPerElement=6,ii(Ra,"StructArrayLayout3ui6");class w_ extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a,l,d,p,h,_,x,C,M,v,S,A,D,I,O,z,B,G,$,H,K){let ee=this.length;return this.resize(ee+1),this.emplace(ee,a,l,d,p,h,_,x,C,M,v,S,A,D,I,O,z,B,G,$,H,K)}emplace(a,l,d,p,h,_,x,C,M,v,S,A,D,I,O,z,B,G,$,H,K,ee){let ne=30*a,ve=15*a,pe=60*a;return this.int16[ne+0]=l,this.int16[ne+1]=d,this.int16[ne+2]=p,this.float32[ve+2]=h,this.float32[ve+3]=_,this.uint16[ne+8]=x,this.uint16[ne+9]=C,this.uint32[ve+5]=M,this.uint32[ve+6]=v,this.uint32[ve+7]=S,this.uint16[ne+16]=A,this.uint16[ne+17]=D,this.uint16[ne+18]=I,this.float32[ve+10]=O,this.float32[ve+11]=z,this.uint8[pe+48]=B,this.uint8[pe+49]=G,this.uint8[pe+50]=$,this.uint32[ve+13]=H,this.int16[ne+28]=K,this.uint8[pe+58]=ee,a}}w_.prototype.bytesPerElement=60,ii(w_,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class E_ extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a,l,d,p,h,_,x,C,M,v,S,A,D,I,O,z,B,G,$,H,K,ee,ne,ve,pe,fe,Fe,be,Be,$e,Ue,Ye,Ze){let rt=this.length;return this.resize(rt+1),this.emplace(rt,a,l,d,p,h,_,x,C,M,v,S,A,D,I,O,z,B,G,$,H,K,ee,ne,ve,pe,fe,Fe,be,Be,$e,Ue,Ye,Ze)}emplace(a,l,d,p,h,_,x,C,M,v,S,A,D,I,O,z,B,G,$,H,K,ee,ne,ve,pe,fe,Fe,be,Be,$e,Ue,Ye,Ze,rt){let Je=20*a,ot=40*a,kt=80*a;return this.float32[Je+0]=l,this.float32[Je+1]=d,this.int16[ot+4]=p,this.int16[ot+5]=h,this.int16[ot+6]=_,this.int16[ot+7]=x,this.int16[ot+8]=C,this.int16[ot+9]=M,this.int16[ot+10]=v,this.int16[ot+11]=S,this.int16[ot+12]=A,this.uint16[ot+13]=D,this.uint16[ot+14]=I,this.uint16[ot+15]=O,this.uint16[ot+16]=z,this.uint16[ot+17]=B,this.uint16[ot+18]=G,this.uint16[ot+19]=$,this.uint16[ot+20]=H,this.uint16[ot+21]=K,this.uint16[ot+22]=ee,this.uint16[ot+23]=ne,this.uint16[ot+24]=ve,this.uint16[ot+25]=pe,this.uint16[ot+26]=fe,this.uint16[ot+27]=Fe,this.uint32[Je+14]=be,this.float32[Je+15]=Be,this.float32[Je+16]=$e,this.float32[Je+17]=Ue,this.float32[Je+18]=Ye,this.uint8[kt+76]=Ze,this.uint16[ot+39]=rt,a}}E_.prototype.bytesPerElement=80,ii(E_,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class ll extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,d,p,h){let _=this.length;return this.resize(_+1),this.emplace(_,a,l,d,p,h)}emplace(a,l,d,p,h,_){let x=5*a;return this.float32[x+0]=l,this.float32[x+1]=d,this.float32[x+2]=p,this.float32[x+3]=h,this.float32[x+4]=_,a}}ll.prototype.bytesPerElement=20,ii(ll,"StructArrayLayout5f20");class C_ extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,d,p,h,_,x){let C=this.length;return this.resize(C+1),this.emplace(C,a,l,d,p,h,_,x)}emplace(a,l,d,p,h,_,x,C){let M=7*a;return this.float32[M+0]=l,this.float32[M+1]=d,this.float32[M+2]=p,this.float32[M+3]=h,this.float32[M+4]=_,this.float32[M+5]=x,this.float32[M+6]=C,a}}C_.prototype.bytesPerElement=28,ii(C_,"StructArrayLayout7f28");class Mb extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,d,p,h,_,x,C,M,v,S){let A=this.length;return this.resize(A+1),this.emplace(A,a,l,d,p,h,_,x,C,M,v,S)}emplace(a,l,d,p,h,_,x,C,M,v,S,A){let D=11*a;return this.float32[D+0]=l,this.float32[D+1]=d,this.float32[D+2]=p,this.float32[D+3]=h,this.float32[D+4]=_,this.float32[D+5]=x,this.float32[D+6]=C,this.float32[D+7]=M,this.float32[D+8]=v,this.float32[D+9]=S,this.float32[D+10]=A,a}}Mb.prototype.bytesPerElement=44,ii(Mb,"StructArrayLayout11f44");class Ib extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,d,p,h,_,x,C,M){let v=this.length;return this.resize(v+1),this.emplace(v,a,l,d,p,h,_,x,C,M)}emplace(a,l,d,p,h,_,x,C,M,v){let S=9*a;return this.float32[S+0]=l,this.float32[S+1]=d,this.float32[S+2]=p,this.float32[S+3]=h,this.float32[S+4]=_,this.float32[S+5]=x,this.float32[S+6]=C,this.float32[S+7]=M,this.float32[S+8]=v,a}}Ib.prototype.bytesPerElement=36,ii(Ib,"StructArrayLayout9f36");class xf extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l){let d=this.length;return this.resize(d+1),this.emplace(d,a,l)}emplace(a,l,d){let p=2*a;return this.float32[p+0]=l,this.float32[p+1]=d,a}}xf.prototype.bytesPerElement=8,ii(xf,"StructArrayLayout2f8");class sg extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,l,d,p){let h=this.length;return this.resize(h+1),this.emplace(h,a,l,d,p)}emplace(a,l,d,p,h){let _=6*a;return this.uint32[3*a+0]=l,this.uint16[_+2]=d,this.uint16[_+3]=p,this.uint16[_+4]=h,a}}sg.prototype.bytesPerElement=12,ii(sg,"StructArrayLayout1ul3ui12");class S_ extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){let l=this.length;return this.resize(l+1),this.emplace(l,a)}emplace(a,l){return this.uint16[1*a+0]=l,a}}S_.prototype.bytesPerElement=2,ii(S_,"StructArrayLayout1ui2");class T_ extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,d,p,h,_,x,C,M,v,S,A,D,I,O,z){let B=this.length;return this.resize(B+1),this.emplace(B,a,l,d,p,h,_,x,C,M,v,S,A,D,I,O,z)}emplace(a,l,d,p,h,_,x,C,M,v,S,A,D,I,O,z,B){let G=16*a;return this.float32[G+0]=l,this.float32[G+1]=d,this.float32[G+2]=p,this.float32[G+3]=h,this.float32[G+4]=_,this.float32[G+5]=x,this.float32[G+6]=C,this.float32[G+7]=M,this.float32[G+8]=v,this.float32[G+9]=S,this.float32[G+10]=A,this.float32[G+11]=D,this.float32[G+12]=I,this.float32[G+13]=O,this.float32[G+14]=z,this.float32[G+15]=B,a}}T_.prototype.bytesPerElement=64,ii(T_,"StructArrayLayout16f64");class D_ extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,d,p,h,_,x){let C=this.length;return this.resize(C+1),this.emplace(C,a,l,d,p,h,_,x)}emplace(a,l,d,p,h,_,x,C){let M=10*a,v=5*a;return this.uint16[M+0]=l,this.uint16[M+1]=d,this.uint16[M+2]=p,this.uint16[M+3]=h,this.float32[v+2]=_,this.float32[v+3]=x,this.float32[v+4]=C,a}}D_.prototype.bytesPerElement=20,ii(D_,"StructArrayLayout4ui3f20");class M_ extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a){let l=this.length;return this.resize(l+1),this.emplace(l,a)}emplace(a,l){return this.int16[1*a+0]=l,a}}M_.prototype.bytesPerElement=2,ii(M_,"StructArrayLayout1i2");class Ab extends Fr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(a){let l=this.length;return this.resize(l+1),this.emplace(l,a)}emplace(a,l){return this.uint8[1*a+0]=l,a}}Ab.prototype.bytesPerElement=1,ii(Ab,"StructArrayLayout1ub1");class Rb extends rg{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Rb.prototype.size=40;class lg extends Sb{get(a){return new Rb(this,a)}}ii(lg,"CollisionBoxArray");class ME extends rg{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(a){this._structArray.uint8[this._pos1+49]=a}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(a){this._structArray.uint8[this._pos1+50]=a}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(a){this._structArray.uint32[this._pos4+13]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(a){this._structArray.uint8[this._pos1+58]=a}}ME.prototype.size=60;class IE extends w_{get(a){return new ME(this,a)}}ii(IE,"PlacedSymbolArray");class AE extends rg{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(a){this._structArray.uint32[this._pos4+14]=a}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(a){this._structArray.float32[this._pos4+18]=a}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}AE.prototype.size=80;class RE extends E_{get(a){return new AE(this,a)}}ii(RE,"SymbolInstanceArray");class kE extends cp{getoffsetX(a){return this.float32[1*a+0]}}ii(kE,"GlyphOffsetArray");class cg extends pd{getx(a){return this.int16[2*a+0]}gety(a){return this.int16[2*a+1]}}ii(cg,"SymbolLineVertexArray");class ug extends rg{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}ug.prototype.size=12;class cl extends sg{get(a){return new ug(this,a)}}ii(cl,"FeatureIndexArray");class dg extends gh{geta_centroid_pos0(a){return this.uint16[2*a+0]}geta_centroid_pos1(a){return this.uint16[2*a+1]}}ii(dg,"FillExtrusionCentroidArray");class OE extends rg{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}OE.prototype.size=6;class PE extends bf{get(a){return new OE(this,a)}}ii(PE,"FillExtrusionWallArray");let PI=Jn([{name:"a_pos",components:2,type:"Int16"}],4),NI=Jn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Zr{constructor(a=[]){this.segments=a}_prepareSegment(a,l,d,p){let h=this.segments[this.segments.length-1];return a>Zr.MAX_VERTEX_ARRAY_LENGTH&&Gt(`Max vertices per segment is ${Zr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}`),(!h||h.vertexLength+a>Zr.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==p)&&(h={vertexOffset:l,primitiveOffset:d,vertexLength:0,primitiveLength:0},p!==void 0&&(h.sortKey=p),this.segments.push(h)),h}prepareSegment(a,l,d,p){return this._prepareSegment(a,l.length,d.length,p)}get(){return this.segments}destroy(){for(let a of this.segments)for(let l in a.vaos)a.vaos[l].destroy()}static simpleSegment(a,l,d,p){return new Zr([{vertexOffset:a,primitiveOffset:l,vertexLength:d,primitiveLength:p,vaos:{},sortKey:0}])}}function NE(u,a){return 256*(u=pn(Math.floor(u),0,255))+pn(Math.floor(a),0,255)}Zr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ii(Zr,"SegmentVector");let kb=Jn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),LI=Jn([{name:"a_dash",components:4,type:"Uint16"}]);class hg{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(a,l,d,p){this.ids.push(Ob(a)),this.positions.push(l,d,p)}eachPosition(a,l){let d=Ob(a),p=0,h=this.ids.length-1;for(;p<h;){let _=p+h>>1;this.ids[_]>=d?h=_:p=_+1}for(;this.ids[p]===d;)l(this.positions[3*p],this.positions[3*p+1],this.positions[3*p+2]),p++}static serialize(a,l){let d=new Float64Array(a.ids),p=new Uint32Array(a.positions);return pg(d,p,0,d.length-1),l&&(l.add(d.buffer),l.add(p.buffer)),{ids:d,positions:p}}static deserialize(a){let l=new hg,d;l.ids=a.ids,l.positions=a.positions;for(let p of l.ids)p!==d&&l.uniqueIds.push(p),d=p;return l.indexed=!0,l}}function Ob(u){let a=+u;return!isNaN(a)&&Number.MIN_SAFE_INTEGER<=a&&a<=Number.MAX_SAFE_INTEGER?a:rr(String(u))}function pg(u,a,l,d){for(;l<d;){let p=u[l+d>>1],h=l-1,_=d+1;for(;;){do h++;while(u[h]<p);do _--;while(u[_]>p);if(h>=_)break;I_(u,h,_),I_(a,3*h,3*_),I_(a,3*h+1,3*_+1),I_(a,3*h+2,3*_+2)}_-l<d-_?(pg(u,a,l,_),l=_+1):(pg(u,a,_+1,d),d=_)}}function I_(u,a,l){let d=u[a];u[a]=u[l],u[l]=d}ii(hg,"FeaturePositionMap");class Cu{constructor(a){this.gl=a.gl,this.initialized=!1}fetchUniformLocation(a,l){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(a,l),this.initialized=!0),!!this.location}set(a,l,d){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class fg extends Cu{constructor(a){super(a),this.current=0}set(a,l,d){this.fetchUniformLocation(a,l)&&this.current!==d&&(this.current=d,this.gl.uniform1i(this.location,d))}}class Mo extends Cu{constructor(a){super(a),this.current=0}set(a,l,d){this.fetchUniformLocation(a,l)&&this.current!==d&&(this.current=d,this.gl.uniform1f(this.location,d))}}class uc extends Cu{constructor(a){super(a),this.current=[0,0]}set(a,l,d){this.fetchUniformLocation(a,l)&&(d[0]===this.current[0]&&d[1]===this.current[1]||(this.current=d,this.gl.uniform2f(this.location,d[0],d[1])))}}class wf extends Cu{constructor(a){super(a),this.current=[0,0,0]}set(a,l,d){this.fetchUniformLocation(a,l)&&(d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]||(this.current=d,this.gl.uniform3f(this.location,d[0],d[1],d[2])))}}class mg extends Cu{constructor(a){super(a),this.current=[0,0,0,0]}set(a,l,d){this.fetchUniformLocation(a,l)&&(d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]&&d[3]===this.current[3]||(this.current=d,this.gl.uniform4f(this.location,d[0],d[1],d[2],d[3])))}}class LE extends Cu{constructor(a){super(a),this.current=Ui.transparent.toRenderColor(null)}set(a,l,d){this.fetchUniformLocation(a,l)&&(d.r===this.current.r&&d.g===this.current.g&&d.b===this.current.b&&d.a===this.current.a||(this.current=d,this.gl.uniform4f(this.location,d.r,d.g,d.b,d.a)))}}let FE=new Float32Array(16);class gg extends Cu{constructor(a){super(a),this.current=FE}set(a,l,d){if(this.fetchUniformLocation(a,l)){if(d[12]!==this.current[12]||d[0]!==this.current[0])return this.current=d,void this.gl.uniformMatrix4fv(this.location,!1,d);for(let p=1;p<16;p++)if(d[p]!==this.current[p]){this.current=d,this.gl.uniformMatrix4fv(this.location,!1,d);break}}}}let Pb=new Float32Array(9),FI=new Float32Array(4);class Nb extends Cu{constructor(a){super(a),this.current=FI}set(a,l,d){if(this.fetchUniformLocation(a,l)){for(let p=0;p<4;p++)if(d[p]!==this.current[p]){this.current=d,this.gl.uniformMatrix2fv(this.location,!1,d);break}}}}function Lb(u){return[NE(255*u.r,255*u.g),NE(255*u.b,255*u.a)]}class _g{constructor(a,l,d,p){this.value=a,this.uniformNames=l.map(h=>`u_${h}`),this.type=d,this.context=p}setUniform(a,l,d,p,h){let _=p.constantOr(this.value);l.set(a,h,_ instanceof Ui?_.toRenderColor(this.lutExpression&&this.lutExpression.value==="none"?null:this.context.lut):_)}getBinding(a,l){return this.type==="color"?new LE(a):new Mo(a)}}class dp{constructor(a,l){this.uniformNames=l.map(d=>`u_${d}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(a){this.pixelRatio=a.pixelRatio||1,this.pattern=a.tl.concat(a.br)}setUniform(a,l,d,p,h){let _=h==="u_pattern"||h==="u_dash"?this.pattern:h==="u_pixel_ratio"?this.pixelRatio:null;_&&l.set(a,h,_)}getBinding(a,l){return l==="u_pattern"||l==="u_dash"?new mg(a):new Mo(a)}}class md{constructor(a,l,d,p){this.expression=a,this.type=d,this.maxValue=0,this.paintVertexAttributes=l.map(h=>({name:`a_${h}`,type:"Float32",components:d==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(a,l,d,p,h,_,x){let C=this.paintVertexArray.length,M=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new Ar(0,{brightness:_}),l,{},h,p,x):this.expression.kind==="constant"&&this.expression.value,v=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Ar(0,{brightness:_}),l,{},h,p,x):this.lutExpression.value)==="none";this.paintVertexArray.resize(a),this._setPaintValue(C,a,M,v?null:this.context.lut)}updatePaintArray(a,l,d,p,h,_,x){let C=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:x},d,p,void 0,h):this.expression.kind==="constant"&&this.expression.value,M=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Ar(0,{brightness:x}),d,p,void 0,h):this.lutExpression.value)==="none";this._setPaintValue(a,l,C,M?null:this.context.lut)}_setPaintValue(a,l,d,p){if(this.type==="color"){let h=Lb(d.toRenderColor(p));for(let _=a;_<l;_++)this.paintVertexArray.emplace(_,h[0],h[1])}else{for(let h=a;h<l;h++)this.paintVertexArray.emplace(h,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Yc{constructor(a,l,d,p,h,_){this.expression=a,this.uniformNames=l.map(x=>`u_${x}_t`),this.type=d,this.useIntegerZoom=p,this.context=h,this.maxValue=0,this.paintVertexAttributes=l.map(x=>({name:`a_${x}`,type:"Float32",components:d==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(a,l,d,p,h,_,x){let C=this.expression.evaluate(new Ar(this.context.zoom,{brightness:_}),l,{},h,p,x),M=this.expression.evaluate(new Ar(this.context.zoom+1,{brightness:_}),l,{},h,p,x),v=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Ar(0,{brightness:_}),l,{},h,p,x):this.lutExpression.value)==="none",S=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(S,a,C,M,v?null:this.context.lut)}updatePaintArray(a,l,d,p,h,_,x){let C=this.expression.evaluate({zoom:this.context.zoom,brightness:x},d,p,void 0,h),M=this.expression.evaluate({zoom:this.context.zoom+1,brightness:x},d,p,void 0,h),v=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Ar(0,{brightness:x}),d,p,void 0,h):this.lutExpression.value)==="none";this._setPaintValue(a,l,C,M,v?null:this.context.lut)}_setPaintValue(a,l,d,p,h){if(this.type==="color"){let _=Lb(d.toRenderColor(h)),x=Lb(d.toRenderColor(h));for(let C=a;C<l;C++)this.paintVertexArray.emplace(C,_[0],_[1],x[0],x[1])}else{for(let _=a;_<l;_++)this.paintVertexArray.emplace(_,d,p);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(p))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,l,d,p,h){let _=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,x=pn(this.expression.interpolationFactor(_,this.context.zoom,this.context.zoom+1),0,1);l.set(a,h,x)}getBinding(a,l){return new Mo(a)}}class _h{constructor(a,l,d,p,h){this.expression=a,this.layerId=h,this.paintVertexAttributes=(d==="array"?LI:kb).members;for(let _=0;_<l.length;++_);this.paintVertexArray=new p}populatePaintArray(a,l,d,p){let h=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValues(h,a,l.patterns&&l.patterns[this.layerId],d)}updatePaintArray(a,l,d,p,h,_,x){this._setPaintValues(a,l,d.patterns&&d.patterns[this.layerId],_)}_setPaintValues(a,l,d,p){if(!p||!d)return;let h=p[d];if(!h)return;let{tl:_,br:x,pixelRatio:C}=h;for(let M=a;M<l;M++)this.paintVertexArray.emplace(M,_[0],_[1],x[0],x[1],C)}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class hp{constructor(a,l,d=()=>!0){this.binders={},this._buffers=[],this.context=l;let p=[];for(let h in a.paint._values){let _=a.paint.get(h);if(h.endsWith("-use-theme")||!d(h)||!(_ instanceof mf&&lf(_.property.specification)))continue;let x=BI(h,a.type),C=_.value,M=_.property.specification.type,v=!!_.property.useIntegerZoom,S=h==="line-dasharray"||h.endsWith("pattern"),A=a.paint.get(`${h}-use-theme`),D=h==="line-dasharray"&&a.layout.get("line-cap").value.kind!=="constant"||A&&A.value.kind!=="constant";if(C.kind!=="constant"||D)if(C.kind==="source"||D||S){let I=zE(h,M,"source");this.binders[h]=S?new _h(C,x,M,I,a.id):new md(C,x,M,I),p.push(`/a_${h}`)}else{let I=zE(h,M,"composite");this.binders[h]=new Yc(C,x,M,v,l,I),p.push(`/z_${h}`)}else this.binders[h]=S?new dp(C.value,x):new _g(C.value,x,M,l),p.push(`/u_${h}`);A&&(this.binders[h].lutExpression=A.value)}this.cacheKey=p.sort().join("")}getMaxValue(a){let l=this.binders[a];return l instanceof md||l instanceof Yc?l.maxValue:0}populatePaintArrays(a,l,d,p,h,_,x){for(let C in this.binders){let M=this.binders[C];M.context=this.context,(M instanceof md||M instanceof Yc||M instanceof _h)&&M.populatePaintArray(a,l,d,p,h,_,x)}}setConstantPatternPositions(a){for(let l in this.binders){let d=this.binders[l];d instanceof dp&&d.setConstantPatternPositions(a)}}updatePaintArrays(a,l,d,p,h,_,x,C,M){let v=!1,S=Object.keys(a),A=S.length!==0&&!C,D=A?S:l.uniqueIds;this.context.lut=h.lut;for(let I in this.binders){let O=this.binders[I];if(O.context=this.context,(O instanceof md||O instanceof Yc||O instanceof _h)&&O.expression&&O.expression.kind&&O.expression.kind!=="constant"&&(O.expression.isStateDependent===!0||O.expression.isLightConstant===!1)){let z=h.paint.get(I);O.expression=z.value;for(let B of D){let G=a[B.toString()];l.eachPosition(B,($,H,K)=>{let ee=p.feature($);O.updatePaintArray(H,K,ee,G,_,x,M)})}if(!A)for(let B of d.uniqueIds){let G=a[B.toString()];d.eachPosition(B,($,H,K)=>{let ee=p.feature($);O.updatePaintArray(H,K,ee,G,_,x,M)})}v=!0}}return v}defines(){let a=[];for(let l in this.binders){let d=this.binders[l];(d instanceof _g||d instanceof dp)&&a.push(...d.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return a}getBinderAttributes(){let a=[];for(let l in this.binders){let d=this.binders[l];if(d instanceof md||d instanceof Yc||d instanceof _h)for(let p=0;p<d.paintVertexAttributes.length;p++)a.push(d.paintVertexAttributes[p].name)}return a}getBinderUniforms(){let a=[];for(let l in this.binders){let d=this.binders[l];if(d instanceof _g||d instanceof dp||d instanceof Yc)for(let p of d.uniformNames)a.push(p)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a){let l=[];for(let d in this.binders){let p=this.binders[d];if(p instanceof _g||p instanceof dp||p instanceof Yc)for(let h of p.uniformNames)l.push({name:h,property:d,binding:p.getBinding(a,h)})}return l}setUniforms(a,l,d,p,h){for(let{name:_,property:x,binding:C}of d)this.binders[x].setUniform(a,C,h,p.get(x),_)}updatePaintBuffers(){this._buffers=[];for(let a in this.binders){let l=this.binders[a];(l instanceof md||l instanceof Yc||l instanceof _h)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(a){for(let l in this.binders){let d=this.binders[l];(d instanceof md||d instanceof Yc||d instanceof _h)&&d.upload(a)}this.updatePaintBuffers()}destroy(){for(let a in this.binders){let l=this.binders[a];(l instanceof md||l instanceof Yc||l instanceof _h)&&l.destroy()}}}class yh{constructor(a,l,d=()=>!0){this.programConfigurations={};for(let p of a)this.programConfigurations[p.id]=new hp(p,l,d);this.needsUpload=!1,this._featureMap=new hg,this._featureMapWithoutIds=new hg,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(a,l,d,p,h,_,x,C){for(let M in this.programConfigurations)this.programConfigurations[M].populatePaintArrays(a,l,p,h,_,x,C);l.id!==void 0?this._featureMap.add(l.id,d,this._bufferOffset,a):(this._featureMapWithoutIds.add(this._idlessCounter,d,this._bufferOffset,a),this._idlessCounter+=1),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,l,d,p,h,_,x){for(let C of d)this.needsUpload=this.programConfigurations[C.id].updatePaintArrays(a,this._featureMap,this._featureMapWithoutIds,l,C,p,h,_,x||0)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(let l in this.programConfigurations)this.programConfigurations[l].upload(a);this.needsUpload=!1}}destroy(){for(let a in this.programConfigurations)this.programConfigurations[a].destroy()}}let zI={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function BI(u,a){return zI[u]||[u.replace(`${a}-`,"").replace(/-/g,"_")]}let VI={"line-pattern":{source:mh,composite:mh},"fill-pattern":{source:mh,composite:mh},"fill-extrusion-pattern":{source:mh,composite:mh},"line-dasharray":{source:b_,composite:b_}},A_={color:{source:xf,composite:up},number:{source:cp,composite:xf}};function zE(u,a,l){let d=VI[u];return d&&d[l]||A_[a][l]}ii(_g,"ConstantBinder"),ii(dp,"PatternConstantBinder"),ii(md,"SourceExpressionBinder"),ii(_h,"PatternCompositeBinder"),ii(Yc,"CompositeExpressionBinder"),ii(hp,"ProgramConfiguration",{omit:["_buffers"]}),ii(yh,"ProgramConfigurationSet");let As=$t/Math.PI/2,Ef=5,BE=6,VE=16383,Cf=64,R_=[Cf,32,16],Fl=-As,zl=As;function Sf(u,a,l,d=As){return l=Mn(l),[u*Math.sin(l)*d,-a*d,u*Math.cos(l)*d]}function pp(u,a,l){return Sf(Math.cos(Mn(u)),Math.sin(Mn(u)),a,l)}let fp=63710088e-1,Fb=2*Math.PI*fp;class er{constructor(a,l){if(isNaN(a)||isNaN(l))throw new Error(`Invalid LngLat object: (${a}, ${l})`);if(this.lng=+a,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new er(hu(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){let l=Math.PI/180,d=this.lat*l,p=a.lat*l,h=Math.sin(d)*Math.sin(p)+Math.cos(d)*Math.cos(p)*Math.cos((a.lng-this.lng)*l);return fp*Math.acos(Math.min(h,1))}toBounds(a=0){let l=360*a/40075017,d=l/Math.cos(Math.PI/180*this.lat);return new vh({lng:this.lng-d,lat:this.lat-l},{lng:this.lng+d,lat:this.lat+l})}toEcef(a){return pp(this.lat,this.lng,As+a*As/fp)}static convert(a){if(a instanceof er)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new er(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new er(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class vh{constructor(a,l){if(a)if(l)this.setSouthWest(a).setNorthEast(l);else if(a.length===4){let d=a;this.setSouthWest([d[0],d[1]]).setNorthEast([d[2],d[3]])}else{let d=a;this.setSouthWest(d[0]).setNorthEast(d[1])}}setNorthEast(a){return this._ne=a instanceof er?new er(a.lng,a.lat):er.convert(a),this}setSouthWest(a){return this._sw=a instanceof er?new er(a.lng,a.lat):er.convert(a),this}extend(a){let l=this._sw,d=this._ne,p,h;if(a instanceof er)p=a,h=a;else{if(!(a instanceof vh))return Array.isArray(a)?a.length===4||a.every(Array.isArray)?this.extend(vh.convert(a)):this.extend(er.convert(a)):typeof a=="object"&&a!==null&&a.hasOwnProperty("lat")&&(a.hasOwnProperty("lon")||a.hasOwnProperty("lng"))?this.extend(er.convert(a)):this;if(p=a._sw,h=a._ne,!p||!h)return this}return l||d?(l.lng=Math.min(p.lng,l.lng),l.lat=Math.min(p.lat,l.lat),d.lng=Math.max(h.lng,d.lng),d.lat=Math.max(h.lat,d.lat)):(this._sw=new er(p.lng,p.lat),this._ne=new er(h.lng,h.lat)),this}getCenter(){return new er((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new er(this.getWest(),this.getNorth())}getSouthEast(){return new er(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(a){let{lng:l,lat:d}=er.convert(a),p=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&p}static convert(a){if(a)return a instanceof vh?a:new vh(a)}}let jI=0,UI=25.5;function k_(u){return Fb*Math.cos(u*Math.PI/180)}function Su(u){return(180+u)/360}function ul(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function $a(u,a){return u/k_(a)}function dl(u){return 360*u-180}function ka(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function zb(u,a){return u*k_(ka(a))}let vo=85.051129;function jE(u){return Math.cos(Mn(pn(u,-vo,vo)))}function bh(u,a){let l=pn(a,jI,UI),d=Math.pow(2,l);return jE(u)*Fb/(512*d)}function HI(u){return 1/Math.cos(u*Math.PI/180)}function m(u,a=0){let l=Math.exp(Math.PI*(1-(u.y+a/$t)/(1<<u.z)*2));return 80150034*l/(l*l+1)/$t/(1<<u.z)}class s{constructor(a,l,d=0){this.x=+a,this.y=+l,this.z=+d}static fromLngLat(a,l=0){let d=er.convert(a);return new s(Su(d.lng),ul(d.lat),$a(l,d.lat))}toLngLat(){return new er(dl(this.x),ka(this.y))}toAltitude(){return zb(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Fb*HI(ka(this.y))}}function c(u,a,l,d,p,h,_,x,C){let M=(a+d)/2,v=(l+p)/2,S=new Wt(M,v);x(S),function(A,D,I,O,z,B){let G=I-z,$=O-B;return Math.abs((O-D)*G-(I-A)*$)/Math.hypot(G,$)}(S.x,S.y,h.x,h.y,_.x,_.y)>=C?(c(u,a,l,M,v,h,S,x,C),c(u,M,v,d,p,S,_,x,C)):u.push(_)}function f(u,a,l){let d=u[0],p=d.x,h=d.y;a(d);let _=[d];for(let x=1;x<u.length;x++){let C=u[x],{x:M,y:v}=C;a(C),c(_,p,h,M,v,d,C,a,l),p=M,h=v,d=C}return _}function y(u,a,l,d){if(d(a,l)){let p=a.add(l)._mult(.5);y(u,a,p,d),y(u,p,l,d)}else u.push(l)}function b(u,a){let l=u[0],d=[l];for(let p=1;p<u.length;p++){let h=u[p];y(d,l,h,a),l=h}return d}let E=Math.pow(2,14)-1,R=-E-1;function P(u,a){let l=Math.round(u.x*a),d=Math.round(u.y*a);return u.x=pn(l,R,E),u.y=pn(d,R,E),(l<u.x||l>u.x+1||d<u.y||d>u.y+1)&&Gt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),u}function L(u,a,l){let d=u.loadGeometry(),p=u.extent,h=$t/p;if(a&&l&&l.projection.isReprojectedInTileSpace){let _=1<<a.z,{scale:x,x:C,y:M,projection:v}=l,S=A=>{let D=dl((a.x+A.x/p)/_),I=ka((a.y+A.y/p)/_),O=v.project(D,I);A.x=(O.x*x-C)*p,A.y=(O.y*x-M)*p};for(let A=0;A<d.length;A++)if(u.type!==1)d[A]=f(d[A],S,1);else{let D=[];for(let I of d[A])I.x<0||I.x>=p||I.y<0||I.y>=p||(S(I),D.push(I));d[A]=D}}for(let _ of d)for(let x of _)P(x,h);return d}function F(u,a){return{type:u.type,id:u.id,properties:u.properties,geometry:a?L(u):[]}}function j(u,a,l,d,p){u.emplaceBack(2*a+(d+1)/2,2*l+(p+1)/2)}function U(u,a,l){u.emplaceBack(a.x,a.y,a.z,l[0]*16384,l[1]*16384,l[2]*16384)}class W{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=a.index,this.hasPattern=!1,this.projection=a.projection,this.layoutVertexArray=new pd,this.indexArray=new Ra,this.segments=new Zr,this.programConfigurations=new yh(a.layers,{zoom:a.zoom,lut:a.lut}),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}updateFootprints(a,l){}populate(a,l,d,p){let h=this.layers[0],_=[],x=null;h.type==="circle"&&(x=h.layout.get("circle-sort-key"));for(let{feature:M,id:v,index:S,sourceLayerIndex:A}of a){let D=this.layers[0]._featureFilter.needGeometry,I=F(M,D);if(!this.layers[0]._featureFilter.filter(new Ar(this.zoom),I,d))continue;let O=x?x.evaluate(I,{},d):void 0,z={id:v,properties:M.properties,type:M.type,sourceLayerIndex:A,index:S,geometry:D?I.geometry:L(M,d,p),patterns:{},sortKey:O};_.push(z)}x&&_.sort((M,v)=>M.sortKey-v.sortKey);let C=null;p.projection.name==="globe"&&(this.globeExtVertexArray=new x_,C=p.projection);for(let M of _){let{geometry:v,index:S,sourceLayerIndex:A}=M,D=a[S].feature;this.addFeature(M,v,S,l.availableImages,d,C,l.brightness),l.featureIndex.insert(D,v,S,A,this.index)}}update(a,l,d,p,h,_,x){this.programConfigurations.updatePaintArrays(a,l,h,d,p,_,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,PI.members),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=a.createVertexBuffer(this.globeExtVertexArray,NI.members))),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(a,l,d,p,h,_,x){for(let C of l)for(let M of C){let v=M.x,S=M.y;if(v<0||v>=$t||S<0||S>=$t)continue;if(_){let I=_.projectTilePoint(v,S,h),O=_.upVector(h,v,S),z=this.globeExtVertexArray;U(z,I,O),U(z,I,O),U(z,I,O),U(z,I,O)}let A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),D=A.vertexLength;j(this.layoutVertexArray,v,S,-1,-1),j(this.layoutVertexArray,v,S,1,-1),j(this.layoutVertexArray,v,S,1,1),j(this.layoutVertexArray,v,S,-1,1),this.indexArray.emplaceBack(D,D+1,D+2),this.indexArray.emplaceBack(D,D+2,D+3),A.vertexLength+=4,A.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,d,{},p,h,x)}}function ie(u,a){for(let l=0;l<u.length;l++)if(Ae(a,u[l]))return!0;for(let l=0;l<a.length;l++)if(Ae(u,a[l]))return!0;return!!me(u,a)}function Q(u,a,l){return!!Ae(u,a)||!!Ee(a,u,l)}function re(u,a){if(u.length===1)return Ie(a,u[0]);for(let l=0;l<a.length;l++){let d=a[l];for(let p=0;p<d.length;p++)if(Ae(u,d[p]))return!0}for(let l=0;l<u.length;l++)if(Ie(a,u[l]))return!0;for(let l=0;l<a.length;l++)if(me(u,a[l]))return!0;return!1}function oe(u,a,l){if(u.length>1){if(me(u,a))return!0;for(let d=0;d<a.length;d++)if(Ee(a[d],u,l))return!0}for(let d=0;d<u.length;d++)if(Ee(u[d],a,l))return!0;return!1}function me(u,a){if(u.length===0||a.length===0)return!1;for(let l=0;l<u.length-1;l++){let d=u[l],p=u[l+1];for(let h=0;h<a.length-1;h++)if(Me(d,p,a[h],a[h+1]))return!0}return!1}function Me(u,a,l,d){return wi(u,l,d)!==wi(a,l,d)&&wi(u,a,l)!==wi(u,a,d)}function Ee(u,a,l){let d=l*l;if(a.length===1)return u.distSqr(a[0])<d;for(let p=1;p<a.length;p++)if(Le(u,a[p-1],a[p])<d)return!0;return!1}function Le(u,a,l){let d=a.distSqr(l);if(d===0)return u.distSqr(a);let p=((u.x-a.x)*(l.x-a.x)+(u.y-a.y)*(l.y-a.y))/d;return u.distSqr(p<0?a:p>1?l:l.sub(a)._mult(p)._add(a))}function Ie(u,a){let l,d,p,h=!1;for(let _=0;_<u.length;_++){l=u[_];for(let x=0,C=l.length-1;x<l.length;C=x++)d=l[x],p=l[C],d.y>a.y!=p.y>a.y&&a.x<(p.x-d.x)*(a.y-d.y)/(p.y-d.y)+d.x&&(h=!h)}return h}function Ae(u,a){let l=!1;for(let d=0,p=u.length-1;d<u.length;p=d++){let h=u[d],_=u[p];h.y>a.y!=_.y>a.y&&a.x<(_.x-h.x)*(a.y-h.y)/(_.y-h.y)+h.x&&(l=!l)}return l}function Re(u,a,l,d,p){for(let _ of u)if(a<=_.x&&l<=_.y&&d>=_.x&&p>=_.y)return!0;let h=[new Wt(a,l),new Wt(a,p),new Wt(d,p),new Wt(d,l)];if(u.length>2){for(let _ of h)if(Ae(u,_))return!0}for(let _=0;_<u.length-1;_++)if(Ve(u[_],u[_+1],h))return!0;return!1}function Ve(u,a,l){let d=l[0],p=l[2];if(u.x<d.x&&a.x<d.x||u.x>p.x&&a.x>p.x||u.y<d.y&&a.y<d.y||u.y>p.y&&a.y>p.y)return!1;let h=wi(u,a,l[0]);return h!==wi(u,a,l[1])||h!==wi(u,a,l[2])||h!==wi(u,a,l[3])}function qe(u,a,l,d,p,h){let _=a.y-u.y,x=u.x-a.x;if(h=h||0){let C=_*_+x*x;if(C===0)return!0;let M=Math.sqrt(C);_/=M,x/=M}return!((l.x-u.x)*_+(l.y-u.y)*x-h<0||(d.x-u.x)*_+(d.y-u.y)*x-h<0||(p.x-u.x)*_+(p.y-u.y)*x-h<0)}function dt(u,a,l,d,p,h,_){return!(qe(u,a,d,p,h,_)||qe(a,l,d,p,h,_)||qe(l,u,d,p,h,_)||qe(d,p,u,a,l,_)||qe(p,h,u,a,l,_)||qe(h,d,u,a,l,_))}function nt(u,a,l){let d=a.paint.get(u).value;return d.kind==="constant"?d.value:l.programConfigurations.get(a.id).getMaxValue(u)}function Et(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function Ct(u,a,l,d,p){if(!a[0]&&!a[1])return u;let h=Wt.convert(a)._mult(p);l==="viewport"&&h._rotate(-d);let _=[];for(let x=0;x<u.length;x++)_.push(u[x].sub(h));return _}function Ut(u,a,l,d){let p=Wt.convert(u)._mult(d);return a==="viewport"&&p._rotate(-l),p}let tt,xt;ii(W,"CircleBucket",{omit:["layers"]});var Qe,bt={exports:{}},_t=(Qe||(Qe=1,function(u,a){(function(l){function d(h,_,x){var C=p(256*h,256*(_=Math.pow(2,x)-_-1),x),M=p(256*(h+1),256*(_+1),x);return C[0]+","+C[1]+","+M[0]+","+M[1]}function p(h,_,x){var C=2*Math.PI*6378137/256/Math.pow(2,x);return[h*C-2*Math.PI*6378137/2,_*C-2*Math.PI*6378137/2]}l.getURL=function(h,_,x,C,M,v){return v=v||{},h+"?"+["bbox="+d(x,C,M),"format="+(v.format||"image/png"),"service="+(v.service||"WMS"),"version="+(v.version||"1.1.1"),"request="+(v.request||"GetMap"),"srs="+(v.srs||"EPSG:3857"),"width="+(v.width||256),"height="+(v.height||256),"layers="+_].join("&")},l.getTileBBox=d,l.getMercCoords=p,Object.defineProperty(l,"__esModule",{value:!0})})(a)}(0,bt.exports)),bt.exports);class St{constructor(a,l,d){this.z=a,this.x=l,this.y=d,this.key=Kt(0,a,a,l,d)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,l){let d=_t.getTileBBox(this.x,this.y,this.z),p=function(h,_,x){let C,M="";for(let v=h;v>0;v--)C=1<<v-1,M+=(_&C?1:0)+(x&C?2:0);return M}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",d)}toString(){return`${this.z}/${this.x}/${this.y}`}}class ht{constructor(a,l){this.wrap=a,this.canonical=l,this.key=Kt(a,l.z,l.z,l.x,l.y)}}class At{constructor(a,l,d,p,h){this.overscaledZ=a,this.wrap=l,this.canonical=new St(d,+p,+h),this.key=l===0&&a===d?this.canonical.key:Kt(l,a,d,p,h)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){let l=this.canonical.z-a;return a>this.canonical.z?new At(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new At(a,this.wrap,a,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(a,l=!0){if(this.overscaledZ===a&&l)return this.key;if(a>this.canonical.z)return Kt(this.wrap*+l,a,this.canonical.z,this.canonical.x,this.canonical.y);{let d=this.canonical.z-a;return Kt(this.wrap*+l,a,a,this.canonical.x>>d,this.canonical.y>>d)}}isChildOf(a){if(a.wrap!==this.wrap)return!1;let l=this.canonical.z-a.canonical.z;return a.overscaledZ===0||a.overscaledZ<this.overscaledZ&&a.canonical.z<this.canonical.z&&a.canonical.x===this.canonical.x>>l&&a.canonical.y===this.canonical.y>>l}children(a){if(this.overscaledZ>=a)return[new At(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let l=this.canonical.z+1,d=2*this.canonical.x,p=2*this.canonical.y;return[new At(l,this.wrap,l,d,p),new At(l,this.wrap,l,d+1,p),new At(l,this.wrap,l,d,p+1),new At(l,this.wrap,l,d+1,p+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new At(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new At(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ht(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Kt(u,a,l,d,p){let h=1<<Math.min(l,22),_=h*(p%h)+d%h;return u&&l<22&&(_+=h*h*((u<0?-2*u-1:2*u)%(1<<2*(22-l)))),16*(32*_+l)+(a-l)}let Xt=[u=>{let a=u.canonical.x-1,l=u.wrap;return a<0&&(a=(1<<u.canonical.z)-1,l--),new At(u.overscaledZ,l,u.canonical.z,a,u.canonical.y)},u=>{let a=u.canonical.x+1,l=u.wrap;return a===1<<u.canonical.z&&(a=0,l++),new At(u.overscaledZ,l,u.canonical.z,a,u.canonical.y)},u=>new At(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,(u.canonical.y===0?1<<u.canonical.z:u.canonical.y)-1),u=>new At(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,u.canonical.y===(1<<u.canonical.z)-1?0:u.canonical.y+1)];ii(St,"CanonicalTileID"),ii(At,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});let Qt=Jn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:_i}=Qt,tn=Jn([{name:"a_pos_3",components:3,type:"Int16"}]);var ki=Jn([{name:"a_pos",type:"Int16",components:2}]);class Ki{constructor(a,l){this.pos=a,this.dir=l}intersectsPlane(a,l,d){let p=ge.vec2.dot(l,this.dir);if(Math.abs(p)<1e-6)return!1;let h=((a[0]-this.pos[0])*l[0]+(a[1]-this.pos[1])*l[1])/p;return d[0]=this.pos[0]+this.dir[0]*h,d[1]=this.pos[1]+this.dir[1]*h,!0}}class Fi{constructor(a,l){this.pos=a,this.dir=l}intersectsPlane(a,l,d){let p=ge.vec3.dot(l,this.dir);if(Math.abs(p)<1e-6)return!1;let h=((a[0]-this.pos[0])*l[0]+(a[1]-this.pos[1])*l[1]+(a[2]-this.pos[2])*l[2])/p;return d[0]=this.pos[0]+this.dir[0]*h,d[1]=this.pos[1]+this.dir[1]*h,d[2]=this.pos[2]+this.dir[2]*h,!0}closestPointOnSphere(a,l,d){if(ge.vec3.equals(this.pos,a)||l===0)return d[0]=d[1]=d[2]=0,!1;let[p,h,_]=this.dir,x=this.pos[0]-a[0],C=this.pos[1]-a[1],M=this.pos[2]-a[2],v=p*p+h*h+_*_,S=2*(x*p+C*h+M*_),A=S*S-4*v*(x*x+C*C+M*M-l*l);if(A<0){let D=Math.max(-S/2,0),I=x+p*D,O=C+h*D,z=M+_*D,B=Math.hypot(I,O,z);return d[0]=I*l/B,d[1]=O*l/B,d[2]=z*l/B,!1}{let D=(-S-Math.sqrt(A))/(2*v);if(D<0){let I=Math.hypot(x,C,M);return d[0]=x*l/I,d[1]=C*l/I,d[2]=M*l/I,!1}return d[0]=x+p*D,d[1]=C+h*D,d[2]=M+_*D,!0}}}class An{constructor(a,l,d,p,h){this.TL=a,this.TR=l,this.BR=d,this.BL=p,this.horizon=h}static fromInvProjectionMatrix(a,l,d){let p=[-1,1,1],h=[1,1,1],_=[1,-1,1],x=[-1,-1,1],C=ge.vec3.transformMat4(p,p,a),M=ge.vec3.transformMat4(h,h,a),v=ge.vec3.transformMat4(_,_,a),S=ge.vec3.transformMat4(x,x,a);return new An(C,M,v,S,l/d)}}function tr(u,a,l){let d=1/0,p=-1/0,h=[];for(let _ of u){ge.vec3.sub(h,_,a);let x=ge.vec3.dot(h,l);d=Math.min(d,x),p=Math.max(p,x)}return[d,p]}function Lr(u,a){let l=!0;for(let d=0;d<u.planes.length;d++){let p=u.planes[d],h=0;for(let _=0;_<a.length;_++)h+=ge.vec3.dot(p,a[_])+p[3]>=0;if(h===0)return 0;h!==a.length&&(l=!1)}return l?2:1}function vn(u,a){for(let l of u.projections){let d=tr(a,u.points[0],l.axis);if(l.projection[1]<d[0]||l.projection[0]>d[1])return 0}return 1}function Yr(u,a){let l=0,d=[0,0,0,0];for(let p=0;p<u.length;p++)d[0]=u[p][0],d[1]=u[p][1],d[2]=u[p][2],d[3]=1,ge.vec4.dot(d,a)>=0&&l++;return l}class on{constructor(a,l){this.points=a||new Array(8).fill([0,0,0]),this.planes=l||new Array(6).fill([0,0,0,0]),this.bounds=yi.fromPoints(this.points),this.projections=[],this.frustumEdges=[ge.vec3.sub([],this.points[2],this.points[3]),ge.vec3.sub([],this.points[0],this.points[3]),ge.vec3.sub([],this.points[4],this.points[0]),ge.vec3.sub([],this.points[5],this.points[1]),ge.vec3.sub([],this.points[6],this.points[2]),ge.vec3.sub([],this.points[7],this.points[3])];for(let d of this.frustumEdges){let p=[0,-d[2],d[1]],h=[d[2],0,-d[0]];this.projections.push({axis:p,projection:tr(this.points,this.points[0],p)}),this.projections.push({axis:h,projection:tr(this.points,this.points[0],h)})}}static fromInvProjectionMatrix(a,l,d,p){let h=Math.pow(2,d),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(M=>{let v=ge.vec4.transformMat4([],M,a),S=1/v[3]/l*h;return ge.vec4.mul(v,v,[S,S,p?1/v[3]:S,S])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(M=>{let v=ge.vec3.sub([],_[M[0]],_[M[1]]),S=ge.vec3.sub([],_[M[2]],_[M[1]]),A=ge.vec3.normalize([],ge.vec3.cross([],v,S)),D=-ge.vec3.dot(A,_[M[1]]);return A.concat(D)}),C=[];for(let M=0;M<_.length;M++)C.push([_[M][0],_[M][1],_[M][2]]);return new on(C,x)}intersectsPrecise(a,l,d){for(let p=0;p<l.length;p++)if(!Yr(a,l[p]))return 0;for(let p=0;p<this.planes.length;p++)if(!Yr(a,this.planes[p]))return 0;for(let p of d)for(let h of this.frustumEdges){let _=ge.vec3.cross([],p,h),x=ge.vec3.length(_);if(x===0)continue;ge.vec3.scale(_,_,1/x);let C=tr(this.points,this.points[0],_),M=tr(a,this.points[0],_);if(C[0]>M[1]||M[0]>C[1])return 0}return 1}containsPoint(a){for(let l of this.planes){let d=l[3];if(ge.vec3.dot([l[0],l[1],l[2]],a)+d<0)return!1}return!0}}class yi{static fromPoints(a){let l=[1/0,1/0,1/0],d=[-1/0,-1/0,-1/0];for(let p of a)ge.vec3.min(l,l,p),ge.vec3.max(d,d,p);return new yi(l,d)}static fromTileIdAndHeight(a,l,d){let p=1<<a.canonical.z,h=a.canonical.x,_=a.canonical.y;return new yi([h/p,_/p,l],[(h+1)/p,(_+1)/p,d])}static applyTransform(a,l){let d=a.getCorners();for(let p=0;p<d.length;++p)ge.vec3.transformMat4(d[p],d[p],l);return yi.fromPoints(d)}static applyTransformFast(a,l){let d=[l[12],l[13],l[14]],p=[...d];for(let h=0;h<3;h++)for(let _=0;_<3;_++){let x=l[4*_+h],C=x*a.min[_],M=x*a.max[_];d[h]+=Math.min(C,M),p[h]+=Math.max(C,M)}return new yi(d,p)}static projectAabbCorners(a,l){let d=a.getCorners();for(let p=0;p<d.length;++p)ge.vec3.transformMat4(d[p],d[p],l);return d}constructor(a,l){this.min=a,this.max=l,this.center=ge.vec3.scale([],ge.vec3.add([],this.min,this.max),.5)}quadrant(a){let l=[a%2==0,a<2],d=ge.vec3.clone(this.min),p=ge.vec3.clone(this.max);for(let h=0;h<l.length;h++)d[h]=l[h]?this.min[h]:this.center[h],p[h]=l[h]?this.center[h]:this.max[h];return p[2]=this.max[2],new yi(d,p)}distanceX(a){return Math.max(Math.min(this.max[0],a[0]),this.min[0])-a[0]}distanceY(a){return Math.max(Math.min(this.max[1],a[1]),this.min[1])-a[1]}distanceZ(a){return Math.max(Math.min(this.max[2],a[2]),this.min[2])-a[2]}getCorners(){let a=this.min,l=this.max;return[[a[0],a[1],a[2]],[l[0],a[1],a[2]],[l[0],l[1],a[2]],[a[0],l[1],a[2]],[a[0],a[1],l[2]],[l[0],a[1],l[2]],[l[0],l[1],l[2]],[a[0],l[1],l[2]]]}intersects(a){return this.intersectsAabb(a.bounds)?Lr(a,this.getCorners()):0}intersectsFlat(a){return this.intersectsAabb(a.bounds)?Lr(a,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(a,l){return l||this.intersects(a)?vn(a,this.getCorners()):0}intersectsPreciseFlat(a,l){return l||this.intersectsFlat(a)?vn(a,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(a){for(let l=0;l<3;++l)if(this.min[l]>a.max[l]||a.min[l]>this.max[l])return!1;return!0}intersectsAabbXY(a){return!(this.min[0]>a.max[0]||a.min[0]>this.max[0]||this.min[1]>a.max[1]||a.min[1]>this.max[1])}encapsulate(a){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],a.min[l]),this.max[l]=Math.max(this.max[l],a.max[l])}encapsulatePoint(a){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],a[l]),this.max[l]=Math.max(this.max[l],a[l])}closestPoint(a){return[Math.max(Math.min(this.max[0],a[0]),this.min[0]),Math.max(Math.min(this.max[1],a[1]),this.min[1]),Math.max(Math.min(this.max[2],a[2]),this.min[2])]}}function Pn(u){return u*As/fp}ii(yi,"Aabb");let dr=[new yi([Fl,Fl,Fl],[zl,zl,zl]),new yi([Fl,Fl,Fl],[0,0,zl]),new yi([0,Fl,Fl],[zl,0,zl]),new yi([Fl,0,Fl],[0,zl,zl]),new yi([0,0,Fl],[zl,zl,zl])];function Yn(u,a,l,d=!0){let p=ge.vec3.scale([],u._camera.position,u.worldSize),h=[a,l,1,1];ge.vec4.transformMat4(h,h,u.pixelMatrixInverse),ge.vec4.scale(h,h,1/h[3]);let _=ge.vec3.sub([],h,p),x=ge.vec3.normalize([],_),C=u.globeMatrix,M=[C[12],C[13],C[14]],v=ge.vec3.sub([],M,p),S=ge.vec3.length(v),A=ge.vec3.normalize([],v),D=u.worldSize/(2*Math.PI),I=ge.vec3.dot(A,x),O=Math.asin(D/S);if(O<Math.acos(I)){if(!d)return null;let Fe=[],be=[];ge.vec3.scale(Fe,x,S/I),ge.vec3.normalize(be,ge.vec3.sub(be,Fe,v)),ge.vec3.normalize(x,ge.vec3.add(x,v,ge.vec3.scale(x,be,Math.tan(O)*S)))}let z=[];new Fi(p,x).closestPointOnSphere(M,D,z);let B=ge.vec3.normalize([],rl(C,0)),G=ge.vec3.normalize([],rl(C,1)),$=ge.vec3.normalize([],rl(C,2)),H=ge.vec3.dot(B,z),K=ge.vec3.dot(G,z),ee=ge.vec3.dot($,z),ne=Ho(Math.asin(-K/D)),ve=Ho(Math.atan2(H,ee));ve=u.center.lng+function(Fe,be){let Be=(be-Fe+180)%360-180;return Be<-180?Be+360:Be}(u.center.lng,ve);let pe=Su(ve),fe=pn(ul(ne),0,1);return new s(pe,fe)}class co{constructor(a,l,d){this.a=ge.vec3.sub([],a,d),this.b=ge.vec3.sub([],l,d),this.center=d;let p=ge.vec3.normalize([],this.a),h=ge.vec3.normalize([],this.b);this.angle=Math.acos(ge.vec3.dot(p,h))}}function Lo(u,a){if(u.angle===0)return null;let l;return l=u.a[a]===0?1/u.angle*.5*Math.PI:1/u.angle*Math.atan(u.b[a]/u.a[a]/Math.sin(u.angle)-1/Math.tan(u.angle)),l<0||l>1?null:function(d,p,h,_){let x=Math.sin(h);return d*(Math.sin((1-_)*h)/x)+p*(Math.sin(_*h)/x)}(u.a[a],u.b[a],u.angle,pn(l,0,1))+u.center[a]}function Jo(u){if(u.z<=1)return dr[u.z+2*u.y+u.x];let a=Kr(Hn(u));return yi.fromPoints(a)}function ha(u,a,l){return ge.vec3.scale(u,u,1-l),ge.vec3.scaleAndAdd(u,u,a,l)}function Bl(u,a,l){for(let d of u)ge.vec3.transformMat4(d,d,a),ge.vec3.scale(d,d,l)}function ds(u,a,l,d){let p=a/u.worldSize,h=u.globeMatrix;if(l.z<=1){let pe=Jo(l).getCorners();return Bl(pe,h,p),yi.fromPoints(pe)}let _=Hn(l,d),x=Kr(_,As+Pn(u._tileCoverLift));Bl(x,h,p);let C=Number.MAX_VALUE,M=[-C,-C,-C],v=[C,C,C];if(_.contains(u.center)){for(let Fe of x)ge.vec3.min(v,v,Fe),ge.vec3.max(M,M,Fe);M[2]=0;let pe=u.point,fe=[pe.x*p,pe.y*p,0];return ge.vec3.min(v,v,fe),ge.vec3.max(M,M,fe),new yi(v,M)}if(u._tileCoverLift>0){for(let pe of x)ge.vec3.min(v,v,pe),ge.vec3.max(M,M,pe);return new yi(v,M)}let S=[h[12]*p,h[13]*p,h[14]*p],A=_.getCenter(),D=pn(u.center.lat,-vo,vo),I=pn(A.lat,-vo,vo),O=Su(u.center.lng),z=ul(D),B=O-Su(A.lng),G=z-ul(I);B>.5?B-=1:B<-.5&&(B+=1);let $=0;if(Math.abs(B)>Math.abs(G))$=B>=0?1:3;else{$=G>=0?0:2;let pe=[h[4]*p,h[5]*p,h[6]*p],fe=-Math.sin(Mn(G>=0?_.getSouth():_.getNorth()))*As;ge.vec3.scaleAndAdd(S,S,pe,fe)}let H=x[$],K=x[($+1)%4],ee=new co(H,K,S),ne=[Lo(ee,0)||H[0],Lo(ee,1)||H[1],Lo(ee,2)||H[2]],ve=Ws(u.zoom);if(ve>0){let pe=function({x:Fe,y:be,z:Be},$e,Ue,Ye,Ze){let rt=1/(1<<Be),Je=Fe*rt,ot=Je+rt,kt=be*rt,Mt=kt+rt,ni=0,Vt=(Je+ot)/2-Ye;return Vt>.5?ni=-1:Vt<-.5&&(ni=1),Je=((Je+ni)*$e-(Ye*=$e))*Ue+Ye,ot=((ot+ni)*$e-Ye)*Ue+Ye,kt=(kt*$e-(Ze*=$e))*Ue+Ze,Mt=(Mt*$e-Ze)*Ue+Ze,[[Je,Mt,0],[ot,Mt,0],[ot,kt,0],[Je,kt,0]]}(l,a,u._pixelsPerMercatorPixel,O,z);for(let Fe=0;Fe<x.length;Fe++)ha(x[Fe],pe[Fe],ve);let fe=ge.vec3.add([],pe[$],pe[($+1)%4]);ge.vec3.scale(fe,fe,.5),ha(ne,fe,ve)}for(let pe of x)ge.vec3.min(v,v,pe),ge.vec3.max(M,M,pe);return v[2]=Math.min(H[2],K[2]),ge.vec3.min(v,v,ne),ge.vec3.max(M,M,ne),new yi(v,M)}function Hn({x:u,y:a,z:l},d=!1){let p=1/(1<<l),h=new er(dl(u*p),a===(1<<l)-1&&d?-90:ka((a+1)*p)),_=new er(dl((u+1)*p),a===0&&d?90:ka(a*p));return new vh(h,_)}function Kr(u,a=As){let l=Mn(u.getNorth()),d=Mn(u.getSouth()),p=Math.cos(l),h=Math.cos(d),_=Math.sin(l),x=Math.sin(d),C=u.getWest(),M=u.getEast();return[Sf(h,x,C,a),Sf(h,x,M,a),Sf(p,_,M,a),Sf(p,_,C,a)]}function ir(u,a,l,d){let p=1<<l.z,h=(u/$t+l.x)/p;return pp(ka((a/$t+l.y)/p),dl(h),d)}function Tr({min:u,max:a}){return VE/Math.max(a[0]-u[0],a[1]-u[1],a[2]-u[2])}let Oa=new Float64Array(16);function Ur(u){let a=Tr(u),l=ge.mat4.fromScaling(Oa,[a,a,a]);return ge.mat4.translate(l,l,ge.vec3.negate([],u.min))}function ea(u){let a=ge.mat4.fromTranslation(Oa,u.min),l=1/Tr(u);return ge.mat4.scale(a,a,[l,l,l])}function Tu(u){let a=$t/(2*Math.PI);return u/(2*Math.PI)/a}function hl(u,a){return $t/(512*Math.pow(2,u))*Tr(Jo(a))}function dc(u,a,l,d,p){let h=Tu(l),_=[u,a,-l/(2*Math.PI)],x=ge.mat4.identity(new Float64Array(16));return ge.mat4.translate(x,x,_),ge.mat4.scale(x,x,[h,h,h]),ge.mat4.rotateX(x,x,Mn(-p)),ge.mat4.rotateY(x,x,Mn(-d)),x}function Ws(u){return Gr(Ef,BE,u)}function hc(u,a){let l=pp(a.lat,a.lng),d=function(h){let _=pp(h._center.lat,h._center.lng),x=ge.vec3.fromValues(0,1,0),C=ge.vec3.cross([],x,_),M=ge.mat4.fromRotation([],-h.angle,_);C=ge.vec3.transformMat4(C,C,M),ge.mat4.fromRotation(M,-h._pitch,C);let v=ge.vec3.normalize([],_);return ge.vec3.scale(v,v,Pn(h.cameraToCenterDistance/h.pixelsPerMeter)),ge.vec3.transformMat4(v,v,M),ge.vec3.add([],_,v)}(u),p=ge.vec3.subtract([],d,l);return ge.vec3.angle(p,l)}function pl(u,a){return hc(u,a)>Math.PI/2*1.01}let gd=Mn(85),Du=Math.cos(gd),_d=Math.sin(gd),Bb=ge.mat4.create(),Tf=u=>{let a=[];return u.paint.get("circle-pitch-alignment")==="map"&&a.push("PITCH_WITH_MAP"),u.paint.get("circle-pitch-scale")==="map"&&a.push("SCALE_WITH_MAP"),a};function O_(u,a,l,d,p,h,_,x,C){if(h&&u.queryGeometry.isAboveHorizon)return!1;h&&(C*=u.pixelToTileUnitsFactor);let M=u.tileID.canonical,v=l.projection.upVectorScale(M,l.center.lat,l.worldSize).metersToTile;for(let S of a)for(let A of S){let D=A.add(x),I=p&&l.elevation?l.elevation.exaggeration()*p.getElevationAt(D.x,D.y,!0):0,O=l.projection.projectTilePoint(D.x,D.y,M);if(I>0){let $=l.projection.upVector(M,D.x,D.y);O.x+=$[0]*v*I,O.y+=$[1]*v*I,O.z+=$[2]*v*I}let z=h?D:Vb(O.x,O.y,O.z,d),B=h?u.tilespaceRays.map($=>ZK($,I)):u.queryGeometry.screenGeometry,G=ge.vec4.transformMat4([],[O.x,O.y,O.z,1],d);if(!_&&h?C*=G[3]/l.cameraToCenterDistance:_&&!h&&(C*=l.cameraToCenterDistance/G[3]),h){let $=ka((A.y/$t+M.y)/(1<<M.z));C/=l.projection.pixelsPerMeter($,1)/$a(1,$)}if(Q(B,z,C))return!0}return!1}function Vb(u,a,l,d){let p=ge.vec4.transformMat4([],[u,a,l,1],d);return new Wt(p[0]/p[3],p[1]/p[3])}let MF=ge.vec3.fromValues(0,0,0),WK=ge.vec3.fromValues(0,0,1);function ZK(u,a){let l=ge.vec3.create();return MF[2]=a,u.intersectsPlane(MF,WK,l),new Wt(l[0],l[1])}class IF extends W{}let AF,RF,kF,OF;function PF(u,{width:a,height:l},d,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==a*l*d)throw new RangeError("mismatched image size")}else p=new Uint8Array(a*l*d);return u.width=a,u.height=l,u.data=p,u}function NF(u,a,l){let{width:d,height:p}=a;d===u.width&&p===u.height||(qI(u,a,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,d),height:Math.min(u.height,p)},l,null),u.width=d,u.height=p,u.data=a.data)}function qI(u,a,l,d,p,h,_,x){if(p.width===0||p.height===0)return a;if(p.width>u.width||p.height>u.height||l.x>u.width-p.width||l.y>u.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>a.width||p.height>a.height||d.x>a.width-p.width||d.y>a.height-p.height)throw new RangeError("out of range destination coordinates for image copy");let C=u.data,M=a.data,v=h===4&&x;for(let S=0;S<p.height;S++){let A=((l.y+S)*u.width+l.x)*h,D=((d.y+S)*a.width+d.x)*h;if(v)for(let I=0;I<p.width;I++){let O=A+I*h+3,z=D+I*h;M[z+0]=255,M[z+1]=255,M[z+2]=255,M[z+3]=C[O]}else if(_)for(let I=0;I<p.width;I++){let O=A+I*h,z=D+I*h,B=C[O+3],G=new Ui(C[O+0]/255*B,C[O+1]/255*B,C[O+2]/255*B,B).toRenderColor(_).toArray();M[z+0]=G[0],M[z+1]=G[1],M[z+2]=G[2],M[z+3]=G[3]}else for(let I=0;I<p.width*h;I++)M[D+I]=C[A+I]}return a}ii(IF,"HeatmapBucket",{omit:["layers"]});class Df{constructor(a,l){PF(this,a,1,l)}resize(a){NF(this,new Df(a),1)}clone(){return new Df({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,l,d,p,h){qI(a,l,d,p,h,1,null)}}class Ga{constructor(a,l){PF(this,a,4,l)}resize(a){NF(this,new Ga(a),4)}replace(a,l){l?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new Ga({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,l,d,p,h,_,x){qI(a,l,d,p,h,4,_,x)}}class LF{constructor(a,l){this.width=a.width,this.height=a.height,this.data=l instanceof Uint8Array?new Float32Array(l.buffer):l}}function jb(u){let a={},l=u.resolution||256,d=u.clips?u.clips.length:1,p=u.image||new Ga({width:l,height:d}),h=(_,x,C)=>{a[u.evaluationKey]=C;let M=u.expression.evaluate(a);M&&(p.data[_+x+0]=Math.floor(255*M.r/M.a),p.data[_+x+1]=Math.floor(255*M.g/M.a),p.data[_+x+2]=Math.floor(255*M.b/M.a),p.data[_+x+3]=Math.floor(255*M.a))};if(u.clips)for(let _=0,x=0;_<d;++_,x+=4*l)for(let C=0,M=0;C<l;C++,M+=4){let v=C/(l-1),{start:S,end:A}=u.clips[_];h(x,M,S*(1-v)+A*v)}else for(let _=0,x=0;_<l;_++,x+=4)h(0,x,_/(l-1));return p}ii(Df,"AlphaImage"),ii(Ga,"RGBAImage");let YK=Jn([{name:"a_pos",components:2,type:"Int16"}],4),KK=Jn([{name:"a_road_z_offset",components:1,type:"Float32"}],4),XK=Jn([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),QK=Jn([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function Ub(u,a,l=2){let d=a&&a.length,p=d?a[0]*l:u.length,h=FF(u,0,p,l,!0),_=[];if(!h||h.next===h.prev)return _;let x,C,M;if(d&&(h=function(v,S,A,D){let I=[];for(let O=0,z=S.length;O<z;O++){let B=FF(v,S[O]*D,O<z-1?S[O+1]*D:v.length,D,!1);B===B.next&&(B.steiner=!0),I.push(aX(B))}I.sort(nX);for(let O=0;O<I.length;O++)A=rX(I[O],A);return A}(u,a,h,l)),u.length>80*l){x=1/0,C=1/0;let v=-1/0,S=-1/0;for(let A=l;A<p;A+=l){let D=u[A],I=u[A+1];D<x&&(x=D),I<C&&(C=I),D>v&&(v=D),I>S&&(S=I)}M=Math.max(v-x,S-C),M=M!==0?32767/M:0}return Hb(h,_,l,x,C,M,0),_}function FF(u,a,l,d,p){let h;if(p===function(_,x,C,M){let v=0;for(let S=x,A=C-M;S<C;S+=M)v+=(_[A]-_[S])*(_[S+1]+_[A+1]),A=S;return v}(u,a,l,d)>0)for(let _=a;_<l;_+=d)h=VF(_/d|0,u[_],u[_+1],h);else for(let _=l-d;_>=a;_-=d)h=VF(_/d|0,u[_],u[_+1],h);return h&&UE(h,h.next)&&($b(h),h=h.next),h}function yg(u,a){if(!u)return u;a||(a=u);let l,d=u;do if(l=!1,d.steiner||!UE(d,d.next)&&pa(d.prev,d,d.next)!==0)d=d.next;else{if($b(d),d=a=d.prev,d===d.next)break;l=!0}while(l||d!==a);return a}function Hb(u,a,l,d,p,h,_){if(!u)return;!_&&h&&function(C,M,v,S){let A=C;do A.z===0&&(A.z=$I(A.x,A.y,M,v,S)),A.prevZ=A.prev,A.nextZ=A.next,A=A.next;while(A!==C);A.prevZ.nextZ=null,A.prevZ=null,function(D){let I,O=1;do{let z,B=D;D=null;let G=null;for(I=0;B;){I++;let $=B,H=0;for(let ee=0;ee<O&&(H++,$=$.nextZ,$);ee++);let K=O;for(;H>0||K>0&&$;)H!==0&&(K===0||!$||B.z<=$.z)?(z=B,B=B.nextZ,H--):(z=$,$=$.nextZ,K--),G?G.nextZ=z:D=z,z.prevZ=G,G=z;B=$}G.nextZ=null,O*=2}while(I>1)}(A)}(u,d,p,h);let x=u;for(;u.prev!==u.next;){let C=u.prev,M=u.next;if(h?eX(u,d,p,h):JK(u))a.push(C.i,u.i,M.i),$b(u),u=M.next,x=M.next;else if((u=M)===x){_?_===1?Hb(u=tX(yg(u),a),a,l,d,p,h,2):_===2&&iX(u,a,l,d,p,h):Hb(yg(u),a,l,d,p,h,1);break}}}function JK(u){let a=u.prev,l=u,d=u.next;if(pa(a,l,d)>=0)return!1;let p=a.x,h=l.x,_=d.x,x=a.y,C=l.y,M=d.y,v=p<h?p<_?p:_:h<_?h:_,S=x<C?x<M?x:M:C<M?C:M,A=p>h?p>_?p:_:h>_?h:_,D=x>C?x>M?x:M:C>M?C:M,I=d.next;for(;I!==a;){if(I.x>=v&&I.x<=A&&I.y>=S&&I.y<=D&&P_(p,x,h,C,_,M,I.x,I.y)&&pa(I.prev,I,I.next)>=0)return!1;I=I.next}return!0}function eX(u,a,l,d){let p=u.prev,h=u,_=u.next;if(pa(p,h,_)>=0)return!1;let x=p.x,C=h.x,M=_.x,v=p.y,S=h.y,A=_.y,D=x<C?x<M?x:M:C<M?C:M,I=v<S?v<A?v:A:S<A?S:A,O=x>C?x>M?x:M:C>M?C:M,z=v>S?v>A?v:A:S>A?S:A,B=$I(D,I,a,l,d),G=$I(O,z,a,l,d),$=u.prevZ,H=u.nextZ;for(;$&&$.z>=B&&H&&H.z<=G;){if($.x>=D&&$.x<=O&&$.y>=I&&$.y<=z&&$!==p&&$!==_&&P_(x,v,C,S,M,A,$.x,$.y)&&pa($.prev,$,$.next)>=0||($=$.prevZ,H.x>=D&&H.x<=O&&H.y>=I&&H.y<=z&&H!==p&&H!==_&&P_(x,v,C,S,M,A,H.x,H.y)&&pa(H.prev,H,H.next)>=0))return!1;H=H.nextZ}for(;$&&$.z>=B;){if($.x>=D&&$.x<=O&&$.y>=I&&$.y<=z&&$!==p&&$!==_&&P_(x,v,C,S,M,A,$.x,$.y)&&pa($.prev,$,$.next)>=0)return!1;$=$.prevZ}for(;H&&H.z<=G;){if(H.x>=D&&H.x<=O&&H.y>=I&&H.y<=z&&H!==p&&H!==_&&P_(x,v,C,S,M,A,H.x,H.y)&&pa(H.prev,H,H.next)>=0)return!1;H=H.nextZ}return!0}function tX(u,a){let l=u;do{let d=l.prev,p=l.next.next;!UE(d,p)&&zF(d,l,l.next,p)&&qb(d,p)&&qb(p,d)&&(a.push(d.i,l.i,p.i),$b(l),$b(l.next),l=u=p),l=l.next}while(l!==u);return yg(l)}function iX(u,a,l,d,p,h){let _=u;do{let x=_.next.next;for(;x!==_.prev;){if(_.i!==x.i&&sX(_,x)){let C=BF(_,x);return _=yg(_,_.next),C=yg(C,C.next),Hb(_,a,l,d,p,h,0),void Hb(C,a,l,d,p,h,0)}x=x.next}_=_.next}while(_!==u)}function nX(u,a){return u.x-a.x}function rX(u,a){let l=function(p,h){let _=h,x=p.x,C=p.y,M,v=-1/0;do{if(C<=_.y&&C>=_.next.y&&_.next.y!==_.y){let O=_.x+(C-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(O<=x&&O>v&&(v=O,M=_.x<_.next.x?_:_.next,O===x))return M}_=_.next}while(_!==h);if(!M)return null;let S=M,A=M.x,D=M.y,I=1/0;_=M;do{if(x>=_.x&&_.x>=A&&x!==_.x&&P_(C<D?x:v,C,A,D,C<D?v:x,C,_.x,_.y)){let O=Math.abs(C-_.y)/(x-_.x);qb(_,p)&&(O<I||O===I&&(_.x>M.x||_.x===M.x&&oX(M,_)))&&(M=_,I=O)}_=_.next}while(_!==S);return M}(u,a);if(!l)return a;let d=BF(l,u);return yg(d,d.next),yg(l,l.next)}function oX(u,a){return pa(u.prev,u,a.prev)<0&&pa(a.next,u,u.next)<0}function $I(u,a,l,d,p){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-l)*p|0)|u<<8))|u<<4))|u<<2))|u<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-d)*p|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function aX(u){let a=u,l=u;do(a.x<l.x||a.x===l.x&&a.y<l.y)&&(l=a),a=a.next;while(a!==u);return l}function P_(u,a,l,d,p,h,_,x){return(p-_)*(a-x)>=(u-_)*(h-x)&&(u-_)*(d-x)>=(l-_)*(a-x)&&(l-_)*(h-x)>=(p-_)*(d-x)}function sX(u,a){return u.next.i!==a.i&&u.prev.i!==a.i&&!function(l,d){let p=l;do{if(p.i!==l.i&&p.next.i!==l.i&&p.i!==d.i&&p.next.i!==d.i&&zF(p,p.next,l,d))return!0;p=p.next}while(p!==l);return!1}(u,a)&&(qb(u,a)&&qb(a,u)&&function(l,d){let p=l,h=!1,_=(l.x+d.x)/2,x=(l.y+d.y)/2;do p.y>x!=p.next.y>x&&p.next.y!==p.y&&_<(p.next.x-p.x)*(x-p.y)/(p.next.y-p.y)+p.x&&(h=!h),p=p.next;while(p!==l);return h}(u,a)&&(pa(u.prev,u,a.prev)||pa(u,a.prev,a))||UE(u,a)&&pa(u.prev,u,u.next)>0&&pa(a.prev,a,a.next)>0)}function pa(u,a,l){return(a.y-u.y)*(l.x-a.x)-(a.x-u.x)*(l.y-a.y)}function UE(u,a){return u.x===a.x&&u.y===a.y}function zF(u,a,l,d){let p=qE(pa(u,a,l)),h=qE(pa(u,a,d)),_=qE(pa(l,d,u)),x=qE(pa(l,d,a));return p!==h&&_!==x||!(p!==0||!HE(u,l,a))||!(h!==0||!HE(u,d,a))||!(_!==0||!HE(l,u,d))||!(x!==0||!HE(l,a,d))}function HE(u,a,l){return a.x<=Math.max(u.x,l.x)&&a.x>=Math.min(u.x,l.x)&&a.y<=Math.max(u.y,l.y)&&a.y>=Math.min(u.y,l.y)}function qE(u){return u>0?1:u<0?-1:0}function qb(u,a){return pa(u.prev,u,u.next)<0?pa(u,a,u.next)>=0&&pa(u,u.prev,a)>=0:pa(u,a,u.prev)<0||pa(u,u.next,a)<0}function BF(u,a){let l=GI(u.i,u.x,u.y),d=GI(a.i,a.x,a.y),p=u.next,h=a.prev;return u.next=a,a.prev=u,l.next=p,p.prev=l,d.next=l,l.prev=d,h.next=d,d.prev=h,d}function VF(u,a,l,d){let p=GI(u,a,l);return d?(p.next=d.next,p.prev=d,d.next.prev=p,d.next=p):(p.prev=p,p.next=p),p}function $b(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function GI(u,a,l){return{i:u,x:a,y:l,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function $E(u,a){let l=u.length;if(l<=1)return[u];let d=[],p,h;for(let _=0;_<l;_++){let x=nn(u[_]);x!==0&&(u[_].area=Math.abs(x),h===void 0&&(h=x<0),h===x<0?(p&&d.push(p),p=[u[_]]):p.push(u[_]))}if(p&&d.push(p),a>1)for(let _=0;_<d.length;_++)d[_].length<=a||(Vc(d[_],a,1,d[_].length-1,lX),d[_]=d[_].slice(0,a));return d}function lX(u,a){return a.area-u.area}function jF(u,a,l=1){if(!u)return null;let d=typeof u=="string"?va.from(u).getPrimary():u.getPrimary(),p=d.id.toString();return a.has(p)||a.set(p,[]),d.scaleSelf(l),a.get(p).push(d),d.toString()}function WI(u,a,l,d){let p=d.patternDependencies,h=!1;for(let _ of a){let x=_.paint.get(`${u}-pattern`);x.isConstant()||(h=!0),jF(x.constantOr(null),p,l)&&(h=!0)}return h}function ZI(u,a,l,d,p,h){let _=h.patternDependencies;for(let x of a){let C=x.paint.get(`${u}-pattern`).value;if(C.kind!=="constant"){let M=C.evaluate({zoom:d},l,{},h.availableImages);M=M&&M.name?M.name:M;let v=jF(M,_,p);v&&(l.patterns[x.id]=v)}}return l}var YI,UF,KI,HF,XI,qF,$F,GE={};function GF(){if(UF)return YI;UF=1;var u=ca();function a(p,h,_,x,C){this.properties={},this.extent=_,this.type=0,this._pbf=p,this._geometry=-1,this._keys=x,this._values=C,p.readFields(l,this,h)}function l(p,h,_){p==1?h.id=_.readVarint():p==2?function(x,C){for(var M=x.readVarint()+x.pos;x.pos<M;){var v=C._keys[x.readVarint()],S=C._values[x.readVarint()];C.properties[v]=S}}(_,h):p==3?h.type=_.readVarint():p==4&&(h._geometry=_.pos)}function d(p){for(var h,_,x=0,C=0,M=p.length,v=M-1;C<M;v=C++)x+=((_=p[v]).x-(h=p[C]).x)*(h.y+_.y);return x}return YI=a,a.types=["Unknown","Point","LineString","Polygon"],a.prototype.loadGeometry=function(){var p=this._pbf;p.pos=this._geometry;for(var h,_=p.readVarint()+p.pos,x=1,C=0,M=0,v=0,S=[];p.pos<_;){if(C<=0){var A=p.readVarint();x=7&A,C=A>>3}if(C--,x===1||x===2)M+=p.readSVarint(),v+=p.readSVarint(),x===1&&(h&&S.push(h),h=[]),h.push(new u(M,v));else{if(x!==7)throw new Error("unknown command "+x);h&&h.push(h[0].clone())}}return h&&S.push(h),S},a.prototype.bbox=function(){var p=this._pbf;p.pos=this._geometry;for(var h=p.readVarint()+p.pos,_=1,x=0,C=0,M=0,v=1/0,S=-1/0,A=1/0,D=-1/0;p.pos<h;){if(x<=0){var I=p.readVarint();_=7&I,x=I>>3}if(x--,_===1||_===2)(C+=p.readSVarint())<v&&(v=C),C>S&&(S=C),(M+=p.readSVarint())<A&&(A=M),M>D&&(D=M);else if(_!==7)throw new Error("unknown command "+_)}return[v,A,S,D]},a.prototype.toGeoJSON=function(p,h,_){var x,C,M=this.extent*Math.pow(2,_),v=this.extent*p,S=this.extent*h,A=this.loadGeometry(),D=a.types[this.type];function I(B){for(var G=0;G<B.length;G++){var $=B[G];B[G]=[360*($.x+v)/M-180,360/Math.PI*Math.atan(Math.exp((180-360*($.y+S)/M)*Math.PI/180))-90]}}switch(this.type){case 1:var O=[];for(x=0;x<A.length;x++)O[x]=A[x][0];I(A=O);break;case 2:for(x=0;x<A.length;x++)I(A[x]);break;case 3:for(A=function(B){var G=B.length;if(G<=1)return[B];for(var $,H,K=[],ee=0;ee<G;ee++){var ne=d(B[ee]);ne!==0&&(H===void 0&&(H=ne<0),H===ne<0?($&&K.push($),$=[B[ee]]):$.push(B[ee]))}return $&&K.push($),K}(A),x=0;x<A.length;x++)for(C=0;C<A[x].length;C++)I(A[x][C])}A.length===1?A=A[0]:D="Multi"+D;var z={type:"Feature",geometry:{type:D,coordinates:A},properties:this.properties};return"id"in this&&(z.id=this.id),z},YI}function WF(){if(HF)return KI;HF=1;var u=GF();function a(d,p){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=d,this._keys=[],this._values=[],this._features=[],d.readFields(l,this,p),this.length=this._features.length}function l(d,p,h){d===15?p.version=h.readVarint():d===1?p.name=h.readString():d===5?p.extent=h.readVarint():d===2?p._features.push(h.pos):d===3?p._keys.push(h.readString()):d===4&&p._values.push(function(_){for(var x=null,C=_.readVarint()+_.pos;_.pos<C;){var M=_.readVarint()>>3;x=M===1?_.readString():M===2?_.readFloat():M===3?_.readDouble():M===4?_.readVarint64():M===5?_.readVarint():M===6?_.readSVarint():M===7?_.readBoolean():null}return x}(h))}return KI=a,a.prototype.feature=function(d){if(d<0||d>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[d];var p=this._pbf.readVarint()+this._pbf.pos;return new u(this._pbf,p,this.extent,this._keys,this._values)},KI}function ZF(){return $F||($F=1,GE.VectorTile=function(){if(qF)return XI;qF=1;var u=WF();function a(l,d,p){if(l===3){var h=new u(p,p.readVarint()+p.pos);h.length&&(d[h.name]=h)}}return XI=function(l,d){this.layers=l.readFields(a,{},d)},XI}(),GE.VectorTileFeature=GF(),GE.VectorTileLayer=WF()),GE}var Mf=ZF();let vg="3d_elevation_id",YF="level";class cX{constructor(){this._valid=!1}reset(a){return this.feature=a,this._valid=!0,this._geometry=a.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(a,l){return this._valid&&a(l(this._geometry)),this}require(a,l,d){return this.get(a,!0,l,d)}optional(a,l,d){return this.get(a,!1,l,d)}success(){return this._valid}get(a,l,d,p){let h=this.feature.properties.hasOwnProperty(a)?+this.feature.properties[a]:void 0;return this._valid&&h!==void 0?d(p?p(h):h):l&&(this._valid=!1),this}}class KF{constructor(a,l){this.featureFunc=a,this.vertexFunc=l}parseFeature(a,l,d){return this.featureFunc(a,l,d)}parseVertex(a,l,d){return this.vertexFunc(a,l,d)}}let uX=new KF((u,a,l)=>u.reset(a).require(vg,d=>{l.id=d}).optional("fixed_height_relative",d=>{l.constantHeight=d},mp.decodeRelativeHeight).geometry(d=>{l.bounds=d},mp.computeBounds).success(),(u,a,l)=>u.reset(a).require(vg,d=>{l.id=d}).require("elevation_idx",d=>{l.idx=d}).require("extent",d=>{l.extent=d}).require("height_relative",d=>{l.height=d},mp.decodeRelativeHeight).geometry(d=>{l.position=d},mp.getPoint).success()),dX=new KF((u,a,l)=>u.reset(a).require(vg,d=>{l.id=d}).optional("fixed_height",d=>{l.constantHeight=d},mp.decodeMetricHeight).geometry(d=>{l.bounds=d},mp.computeBounds).success(),(u,a,l)=>u.reset(a).require(vg,d=>{l.id=d}).require("elevation_idx",d=>{l.idx=d}).require("extent",d=>{l.extent=d}).require("height",d=>{l.height=d},mp.decodeMetricHeight).geometry(d=>{l.position=d},mp.getPoint).success());class mp{static computeBounds(a){let l=new Wt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),d=new Wt(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(let p of a[0])l.x>p.x&&(l.x=p.x),l.y>p.y&&(l.y=p.y),d.x<p.x&&(d.x=p.x),d.y<p.y&&(d.y=p.y);return{min:l,max:d}}static getPoint(a){return ge.vec2.fromValues(a[0][0].x,a[0][0].y)}static decodeRelativeHeight(a){return 1e-4*a*5}static decodeMetricHeight(a){return 1e-4*a}static parse(a){let l=[],d=[],p=a.length,h=new cX;for(let x=0;x<p;x++){let C=a.feature(x),M=C.properties.hasOwnProperty("version")?String(C.properties.version):void 0,v=(_=M)?_==="1.0.1"?dX:void 0:uX;if(v===void 0){Gt(`Unknown elevation feature version number ${M||"(unknown)"}`);continue}let S=C.properties.hasOwnProperty("type")?C.properties.type:void 0;if(S){if(Mf.VectorTileFeature.types[C.type]==="Point"&&S==="curve_point"){let A={};v.parseVertex(h,C,A)&&l.push(A)}else if(Mf.VectorTileFeature.types[C.type]==="Polygon"&&S==="curve_meta"){let A={};v.parseFeature(h,C,A)&&d.push(A)}}}var _;return{vertices:l,features:d}}}class QI{constructor(a,l,d,p,h,_){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=a,this.heightRange={min:d,max:d},this.safeArea=l,this.constantHeight=d,this.constantHeight==null&&(this.constantHeight!=null||p.length!==0)){this.vertices=p,this.edges=h,this.edges=this.edges.filter(x=>x.a<this.vertices.length&&x.b<this.vertices.length&&!ge.vec2.exactEquals(this.vertices[x.a].position,this.vertices[x.b].position)),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(let x of this.vertices)this.vertexProps.push({dir:ge.vec2.fromValues(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,x.height),this.heightRange.max=Math.max(this.heightRange.max,x.height);for(let x of this.edges){let C=this.vertices[x.a].position,M=this.vertices[x.b].position,v=ge.vec2.subtract(ge.vec2.create(),M,C),S=ge.vec2.length(v),A=ge.vec2.scale(ge.vec2.create(),v,1/S);this.edgeProps.push({vec:v,dir:A,len:S});let D=this.vertexProps[x.a].dir,I=this.vertexProps[x.b].dir;ge.vec2.add(D,D,A),ge.vec2.add(I,I,A)}for(let x of this.vertexProps)x.dir[0]===0&&x.dir[1]===0||ge.vec2.normalize(x.dir,x.dir);this.tessellate(_)}}pointElevation(a){if(this.constantHeight!=null)return this.constantHeight;let l=this.getClosestEdge(a);if(l==null)return 0;let[d,p]=l;return((h,_,x)=>(1-x)*h+x*_)(this.vertices[this.edges[d].a].height,this.vertices[this.edges[d].b].height,p)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(a){if(this.edges.length===0)return;let l=0,d=Number.POSITIVE_INFINITY,p=0,h=ge.vec2.fromValues(a.x,a.y);for(let _=0;_<this.edges.length;_++){let x=this.edges[_],C=this.edgeProps[_].dir,M=new Ki(h,this.edgeProps[_].dir),v=this.vertices[x.a].position,S=this.vertices[x.b].position,A=ge.vec2.create(),D=ge.vec2.create(),I=M.intersectsPlane(v,this.vertexProps[x.a].dir,A),O=M.intersectsPlane(S,this.vertexProps[x.b].dir,D);if(!I||!O)continue;let z=ge.vec2.subtract(ge.vec2.create(),D,A),B=ge.vec2.subtract(ge.vec2.create(),h,A),G=ge.vec2.dot(z,z),$=G>0?ge.vec2.dot(B,z)/G:0,H=pn($,0,1),K=Math.abs(($-H)*this.edgeProps[_].len),ee=ge.vec2.subtract(ge.vec2.create(),h,v),ne=K+Math.abs(ge.vec2.dot(ee,ge.vec2.fromValues(C[1],-C[0])));ne<d&&(l=_,d=ne,p=H)}return[l,p]}tessellate(a){for(let l=this.edges.length-1;l>=0;--l){let d=this.edges[l].a,p=this.edges[l].b,{position:h,height:_,extent:x}=this.vertices[d],{position:C,height:M,extent:v}=this.vertices[p],S=this.vertexProps[d].dir,A=this.vertexProps[p].dir,D=ge.vec3.fromValues(h[0]/a,h[1]/a,_),I=ge.vec3.fromValues(C[0]/a,C[1]/a,M),O=ge.vec3.fromValues(S[1],-S[0],0);ge.vec3.scale(O,O,x);let z=ge.vec3.fromValues(A[1],-A[0],0);if(ge.vec3.scale(z,z,v),this.distSqLines(ge.vec3.fromValues(D[0]+.5*O[0],D[1]+.5*O[1],D[2]+.5*O[2]),ge.vec3.fromValues(I[0]-.5*z[0],I[1]-.5*z[1],I[2]-.5*z[2]),ge.vec3.fromValues(D[0]-.5*O[0],D[1]-.5*O[1],D[2]-.5*O[2]),ge.vec3.fromValues(I[0]+.5*z[0],I[1]+.5*z[1],I[2]+.5*z[2]))<=.05*.05)continue;let B=this.vertices.length,G=ge.vec2.add(ge.vec2.create(),h,C);this.vertices.push({position:ge.vec2.scale(G,G,.5),height:.5*(_+M),extent:.5*(x+v)});let $=ge.vec2.add(ge.vec2.create(),S,A);this.vertexProps.push({dir:ge.vec2.normalize($,$)}),this.edges.splice(l,1),this.edgeProps.splice(l,1),this.edges.push({a:d,b:B}),this.edges.push({a:B,b:p});let H=ge.vec2.subtract(ge.vec2.create(),this.vertices[B].position,h),K=ge.vec2.length(H),ee={vec:H,dir:ge.vec2.scale(ge.vec2.create(),H,1/K),len:K};this.edgeProps.push(ee),this.edgeProps.push(ee)}}distSqLines(a,l,d,p){let h=ge.vec3.subtract(ge.vec3.create(),l,a),_=ge.vec3.subtract(ge.vec3.create(),p,d),x=ge.vec3.subtract(ge.vec3.create(),a,d),C=ge.vec3.dot(h,h),M=ge.vec3.dot(h,_),v=ge.vec3.dot(h,x),S=ge.vec3.dot(_,_),A=ge.vec3.dot(_,x),D=C*S-M*M;if(D===0){let G=ge.vec3.dot(x,_)/ge.vec3.dot(_,_),$=ge.vec3.lerp(ge.vec3.create(),d,p,G);return ge.vec3.squaredDistance($,a)}let I=(M*A-v*S)/D,O=(C*A-M*v)/D,z=ge.vec3.lerp(ge.vec3.create(),a,l,I),B=ge.vec3.lerp(ge.vec3.create(),d,p,O);return ge.vec3.squaredDistance(z,B)}}class hX{constructor(a,l){this.zScale=1,this.xOffset=0,this.yOffset=0,a.equals(l)||(this.zScale=Math.pow(2,l.z-a.z),this.xOffset=(a.x*this.zScale-l.x)*$t,this.yOffset=(a.y*this.zScale-l.y)*$t)}constantElevation(a,l){if(a.constantHeight!=null)return this.computeBiasedHeight(a.constantHeight,l)}pointElevation(a,l,d){let p=this.constantElevation(l,d);return p??(a.x=a.x*this.zScale+this.xOffset,a.y=a.y*this.zScale+this.yOffset,this.computeBiasedHeight(l.pointElevation(a),d))}computeBiasedHeight(a,l){return l<=0?a:a+l*Gr(0,l,a>=0?a:Math.abs(.5*a))}}ii(QI,"ElevationFeature");class XF{constructor(){this.polygons=new Map}add(a,...l){this.polygons.has(a)?this.polygons.get(a).push(...l):this.polygons.set(a,l)}merge(a){for(let[l,d]of a.polygons)this.add(l,...d)}}class bg{constructor(){this.portals=[]}static evaluate(a){if(a.length===0)return new bg;let l=[];for(let M of a)l.push(...M.portals);if(l.length===0)return new bg;let d=(M,v)=>M<=0&&v<=0||M>=$t&&v>=$t;for(let M of l){let v=M.va,S=M.vb;(d(v.x,S.x)||d(v.y,S.y))&&(M.type="border")}let p=l.filter(M=>M.type!=="unevaluated"),h=l.filter(M=>M.type==="unevaluated");if(h.length===0)return new bg;h.sort((M,v)=>M.hash===v.hash?M.isTunnel===v.isTunnel?0:M.isTunnel?-1:1:M.hash<v.hash?1:-1),l=p.concat(h);let _=p.length,x=_,C=_;do if(x++,x===l.length||l[_].hash!==l[x].hash){if(x-_==2){C<_&&(l[C]=l[_],l[_]=null);let M=l[C],v=l[x-1];M.type=M.isTunnel!==v.isTunnel?"tunnel":"polygon",M.connection={a:M.connection.a,b:v.connection.a},C++}_=x}while(_!==l.length);return l.splice(C),l.sort((M,v)=>M.hash<v.hash?1:-1),{portals:l}}}ii(bg,"ElevationPortalGraph"),ii(XF,"ElevationPolygons");class pX{constructor(a,l,d){this.outPositions=a,this.outNormals=l,this.outIndices=d,this.vertexLookup=new Map,this.buffer=new ArrayBuffer(4),this.view=new DataView(this.buffer)}addVertex(a,l,d){let p=a[2];d!=null&&(p*=d);let h=this.getVec3Bits(a)<<96n|this.getVec3Bits(l),_=this.vertexLookup.get(h);if(_!=null)return _;let x=this.outPositions.length;this.vertexLookup.set(h,x);let C=Math.trunc(16384*l[0]),M=Math.trunc(16384*l[1]),v=Math.trunc(16384*l[2]);return this.outPositions.emplaceBack(a[0],a[1],p),this.outNormals.emplaceBack(C,M,v),x}addVertices(a,l,...d){let p=[];for(let h of d){let _=this.addVertex(h,a,l);p.push(_)}return p}addTriangles(a,l,d){if(l&&d){let p=d.length===1,h=ge.vec3.fromValues(0,0,0);for(let _=0;_<a.length;_+=3){let x=l[a[_+0]],C=l[a[_+1]],M=l[a[_+2]],v=p?d[0]:d[a[_+1]],S=p?d[0]:d[a[_+2]],A=this.addVertex(ge.vec3.fromValues(x.x,x.y,p?d[0]:d[a[_+0]]),h),D=this.addVertex(ge.vec3.fromValues(C.x,C.y,v),h),I=this.addVertex(ge.vec3.fromValues(M.x,M.y,S),h);this.outIndices.emplaceBack(A,D,I)}}else for(let p=0;p<a.length;p+=3)this.outIndices.emplaceBack(a[p+0],a[p+1],a[p+2])}addQuad(a,l){let d=this.addVertices(l,void 0,...a.map(C=>ge.vec3.fromValues(C.coord.x,C.coord.y,C.height))),[p,h,_,x]=d;this.addTriangles([p,h,_,_,x,p])}getBits(a){return this.view.setFloat32(0,a),BigInt(this.view.getUint32(0))}getVec3Bits(a){return this.getBits(a[0])<<64n|this.getBits(a[1])<<32n|this.getBits(a[2])}}class yd{constructor(a){this.unevaluatedPortals=new bg,this.portalPolygons=new XF,this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new og,this.vertexNormals=new bb,this.indexArray=new Ra,this.tileToMeters=m(a)}addVertices(a,l){let d=this.unevalVertices.length;for(let p=0;p<a.length;p++)this.unevalVertices.push(a[p]),this.unevalHeights.push(l[p]);return d}addTriangles(a,l,d){let p=d?this.unevalTunnelTriangles:this.unevalTriangles;for(let h of a)p.push(h+l)}addRenderableRing(a,l,d,p,h){let _=[new Wt(h.min.x,h.min.y),new Wt(h.max.x,h.min.y),new Wt(h.max.x,h.max.y),new Wt(h.min.x,h.max.y)];for(let x=0;x<d-1;x++){let C=l+x,M=C+1,v=this.unevalVertices[C],S=this.unevalVertices[M];if(!(v.x>=h.min.x&&v.x<=h.max.x&&v.y>=h.min.y&&v.y<=h.max.y||S.x>=h.min.x&&S.x<=h.max.x&&S.y>=h.min.y&&S.y<=h.max.y||Ve(v,S,_))||this.isOnBorder(v.x,S.x)||this.isOnBorder(v.y,S.y))continue;let A=yd.computeEdgeHash(this.unevalVertices[C],this.unevalVertices[M]),D,I=this.vertexHashLookup.get(yd.computePosHash(v));I!=null?D=I.next:(I=this.vertexHashLookup.get(yd.computePosHash(S)),D=I!=null?I.prev:A),this.unevalEdges.push({polygonIdx:a,a:C,b:M,hash:A,portalHash:D,isTunnel:p,type:"unevaluated"})}}addPortalCandidates(a,l,d,p,h){if(l.length===0)return;this.portalPolygons.add(a,{geometry:l,zLevel:h});let _=l[0];this.vertexHashLookup.clear();let x=yd.computeEdgeHash(_[_.length-2],_[_.length-1]);for(let C=0;C<_.length-1;C++){let M=_[C+0],v=_[C+1],S=ge.vec2.fromValues(v.x-M.x,v.y-M.y),A=ge.vec2.length(S);if(A===0)continue;let D="unevaluated",I=p.pointElevation(M),O=p.pointElevation(v);Math.abs(I)<.01&&Math.abs(O)<.01?D="entrance":(this.isOnBorder(M.x,v.x)||this.isOnBorder(M.y,v.y))&&(D="border");let z=yd.computeEdgeHash(M,v);this.unevaluatedPortals.portals.push({connection:{a,b:void 0},va:M,vb:v,vab:S,length:A,hash:z,isTunnel:d,type:D});let B=yd.computePosHash(M);this.vertexHashLookup.set(B,{prev:x,next:z}),x=z}}construct(a){if(this.unevalVertices.length===0)return;let l=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),d=S=>{S.primitiveLength=this.indexArray.length-S.primitiveOffset},p=new pX(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(a.portals,this.unevalEdges);let h=l(),_=l(),x=l(),C=(S,A)=>{S.sort((I,O)=>I.type===A&&O.type!==A?-1:I.type!==A&&O.type===A?1:0);let D=S.findIndex(I=>I.type!==A);return D>=0?D:S.length},M=0;this.unevalEdges.length>0&&(M=C(this.unevalEdges,"none"),this.constructBridgeStructures(p,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:M},this.tileToMeters));let v=l();if(this.unevalEdges.length>0){let S=this.unevalEdges.splice(M),A=C(S,"tunnel")+M;this.unevalEdges.push(...S),this.constructTunnelStructures(p,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:M},{min:M,max:A})}d(x),p.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),d(v),p.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),d(_),p.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),d(h),this.maskSegments=Zr.simpleSegment(0,v.primitiveOffset,0,v.primitiveLength),this.depthSegments=Zr.simpleSegment(0,_.primitiveOffset,0,_.primitiveLength),this.renderableSegments=Zr.simpleSegment(0,x.primitiveOffset,0,x.primitiveLength),this.shadowCasterSegments=Zr.simpleSegment(0,h.primitiveOffset,0,h.primitiveLength)}upload(a){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=a.createVertexBuffer(this.vertexPositions,XK.members),this.vertexBufferNormal=a.createVertexBuffer(this.vertexNormals,QK.members),this.indexBuffer=a.createIndexBuffer(this.indexArray))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableSegments.destroy(),this.shadowCasterSegments.destroy())}computeVertexConnections(a,l,d,p){let h=new Map;for(let _=d;_<p;_++){let x=l[_],C=x.a,M=x.b;h.has(C)||h.set(C,{}),h.has(M)||h.set(M,{});let v=h.get(C),S=h.get(M);a[M]>0&&(v.to=M),a[C]>0&&(S.from=C)}return h}constructBridgeStructures(a,l,d,p,h,_){let x=this.computeVertexConnections(d,p,h.min,h.max),C=1/_,M=.5*C,v=A=>ge.vec3.fromValues(l[A].x,l[A].y,d[A]*C),S=A=>{let D=x.get(A),I=D.from,O=D.to;if(!I||!O)return;let z=v(I),B=v(A),G=v(O),$=ge.vec3.fromValues(0,0,0);if(!ge.vec3.exactEquals(z,B)){let K=ge.vec3.sub(ge.vec3.create(),B,z);ge.vec3.add($,$,ge.vec3.normalize(K,K))}if(!ge.vec3.exactEquals(G,B)){let K=ge.vec3.sub(ge.vec3.create(),G,B);ge.vec3.add($,$,ge.vec3.normalize(K,K))}let H=ge.vec3.len($);return H>0?ge.vec3.scale($,$,1/H):void 0};for(let A=h.min;A<h.max;A++){let D=p[A],I=this.prepareEdgePoints(l,d,D,(Lt,Ri)=>Lt>=Ri);if(I==null)continue;let O=I[0],z=I[1],B=ge.vec3.fromValues(O.coord.x,O.coord.y,C*O.height),G=ge.vec3.fromValues(z.coord.x,z.coord.y,C*z.height);if(ge.vec3.exactEquals(B,G))continue;let $=ge.vec3.sub(ge.vec3.create(),G,B);ge.vec3.normalize($,$);let H=Lt=>ge.vec3.normalize(Lt,Lt),K=S(D.a)||$,ee=S(D.b)||$,ne=H(ge.vec3.fromValues(K[1],-K[0],0)),ve=H(ge.vec3.fromValues(ee[1],-ee[0],0)),pe=H(ge.vec3.cross(ge.vec3.create(),ne,K)),fe=H(ge.vec3.cross(ge.vec3.create(),ve,ee)),Fe=ge.vec3.create(),be=[ge.vec3.add(ge.vec3.create(),B,ge.vec3.scale(Fe,ge.vec3.sub(Fe,ne,pe),M)),ge.vec3.add(ge.vec3.create(),B,ge.vec3.scale(Fe,ge.vec3.add(Fe,ne,pe),M)),ge.vec3.add(ge.vec3.create(),B,ge.vec3.scale(Fe,pe,M)),B],Be=[ge.vec3.add(ge.vec3.create(),G,ge.vec3.scale(Fe,ge.vec3.sub(Fe,ve,fe),M)),ge.vec3.add(ge.vec3.create(),G,ge.vec3.scale(Fe,ge.vec3.add(Fe,ve,fe),M)),ge.vec3.add(ge.vec3.create(),G,ge.vec3.scale(Fe,fe,M)),G],[$e,Ue]=a.addVertices(ne,_,be[0],be[1]),[Ye,Ze]=a.addVertices(ve,_,Be[0],Be[1]);a.addTriangles([$e,Ue,Ye,Ue,Ze,Ye]);let[rt,Je]=a.addVertices(pe,_,be[1],be[2]),[ot,kt]=a.addVertices(fe,_,Be[1],Be[2]);a.addTriangles([rt,Je,ot,Je,kt,ot]);let[Mt,ni]=a.addVertices(ge.vec3.negate(ne,ne),_,be[2],be[3]),[Vt,qt]=a.addVertices(ge.vec3.negate(ve,ve),_,Be[2],Be[3]);a.addTriangles([Mt,ni,Vt,ni,qt,Vt])}}constructTunnelStructures(a,l,d,p,h,_){let x=C=>ge.vec3.normalize(C,C);for(let C=h.min;C<h.max;C++){let M=this.prepareEdgePoints(l,d,p[C],(D,I)=>D<=I);if(M==null)continue;let[v,S]=M,A=x(ge.vec3.fromValues(S.coord.y-v.coord.y,-(S.coord.x-v.coord.x),0));a.addQuad([v,S,{coord:S.coord,height:p[C].isTunnel?-.1:0},{coord:v.coord,height:p[C].isTunnel?-.1:0}],A)}for(let C=_.min;C<_.max;C++){let M=p[C],v=l[M.a],S=l[M.b],A=x(ge.vec3.fromValues(S.y-v.y,-(S.x-v.x),0));a.addQuad([{coord:S,height:0},{coord:v,height:0},{coord:v,height:d[M.a]+4},{coord:S,height:d[M.b]+4}],A),a.addQuad([{coord:v,height:0},{coord:S,height:0},{coord:S,height:d[M.b]+4},{coord:v,height:d[M.a]+4}],A)}}prepareEdgePoints(a,l,d,p){let h=a[d.a],_=a[d.b],x=l[d.a],C=l[d.b];if(!(x!==0&&p(x,0)||C!==0&&p(C,0)))return;let M=h.clone(),v=_.clone();if(p(x,0)){if(!p(C,0)){let S=C/(C-x);v.x=pi(v.x,M.x,S),v.y=pi(v.y,M.y,S),C=pi(C,x,S)}}else{let S=x/(x-C);M.x=pi(M.x,v.x,S),M.y=pi(M.y,v.y,S),x=pi(x,C,S)}return[{coord:M,height:x},{coord:v,height:C}]}prepareEdges(a,l){if(l.length===0)return;l.sort((x,C)=>x.hash===C.hash?C.polygonIdx-x.polygonIdx:C.hash>x.hash?1:-1);let d=0,p=0,h=0,_=l[d].polygonIdx;do p++,(p===l.length||l[d].hash!==l[p].hash)&&((p-d==1||l[p-1].polygonIdx!==_)&&(h<d&&(l[h]=l[d],l[d]=null),l[h].type="none",h++),d=p,d!==l.length&&(_=l[d].polygonIdx));while(d!==l.length);if(l.splice(h),l.length!==0&&a.length!==0){l.sort((M,v)=>M.hash<v.hash?1:-1);let x=0,C=0;for(;x!==l.length&&C!==a.length;){let M=l[x],v=a[C];M.portalHash>v.hash?x++:v.hash>M.portalHash?C++:(M.type=v.type,x++)}}}isOnBorder(a,l){return a<=0&&l<=0||a>=$t&&l>=$t}static computeEdgeHash(a,l){return(a.y===l.y&&a.x>l.x||a.y>l.y)&&([a,l]=[l,a]),BigInt(yd.computePosHash(a))<<32n|BigInt(yd.computePosHash(l))}static computePosHash(a){return((65535&a.x)<<16|65535&a.y)>>>0}}class JI{constructor(a,l){this.layoutVertexArray=new pd,this.indexArray=new Ra,this.lineIndexArray=new gh,this.triangleSegments=new Zr,this.lineSegments=new Zr,this.programConfigurations=new yh(a.layers,{zoom:a.zoom,lut:a.lut}),this.uploaded=!1,l&&(this.elevatedLayoutVertexArray=new cp)}update(a,l,d,p,h,_,x){this.programConfigurations.updatePaintArrays(a,l,h,d,p,_,x)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,YK.members),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.lineIndexBuffer=a.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=a.createVertexBuffer(this.elevatedLayoutVertexArray,KK.members))),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(a,l,d,p,h,_){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,l,d,p,h,_)}}class eA{constructor(a){this.zoom=a.zoom,this.pixelRatio=a.pixelRatio,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.bufferData=new JI(a,!1),this.elevationBufferData=new JI(a,!0),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.projection=a.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference")}updateFootprints(a,l){}populate(a,l,d,p){this.hasPattern=WI("fill",this.layers,this.pixelRatio,l);let h=this.layers[0].layout.get("fill-sort-key"),_=[];for(let{feature:x,id:C,index:M,sourceLayerIndex:v}of a){let S=this.layers[0]._featureFilter.needGeometry,A=F(x,S);if(!this.layers[0]._featureFilter.filter(new Ar(this.zoom),A,d))continue;let D=h?h.evaluate(A,{},d,l.availableImages):void 0,I={id:C,properties:x.properties,type:x.type,sourceLayerIndex:v,index:M,geometry:S?A.geometry:L(x,d,p),patterns:{},sortKey:D};_.push(I)}h&&_.sort((x,C)=>x.sortKey-C.sortKey);for(let x of _){let{geometry:C,index:M,sourceLayerIndex:v}=x;if(this.hasPattern){let S=ZI("fill",this.layers,x,this.zoom,this.pixelRatio,l);this.patternFeatures.push(S)}else this.addFeature(x,C,M,d,{},l.availableImages,l.brightness,l.elevationFeatures);l.featureIndex.insert(a[M].feature,C,M,v,this.index)}}update(a,l,d,p,h,_,x){this.bufferData.update(a,l,d,p,h,_,x),this.elevationBufferData.update(a,l,d,p,h,_,x)}addFeatures(a,l,d,p,h,_){for(let x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,l,d,p,_,a.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(a){this.bufferData.upload(a),this.elevationBufferData.upload(a),this.elevatedStructures&&this.elevatedStructures.upload(a)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(a,l,d,p,h,_=[],x,C){let M=$E(l,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(a,M,p,d,C):this.addGeometry(M,this.bufferData),this.bufferData.populatePaintArrays(a,d,h,_,p,x),this.elevationBufferData.populatePaintArrays(a,d,h,_,p,x)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(a){this.elevatedStructures&&this.elevatedStructures.construct(a)}addElevatedRoadFeature(a,l,d,p,h){let _=new Array,x=this.getElevationFeature(a,h);if(x){_.push({polygons:l,elevationFeature:x,elevationTileID:d});for(let C of _)if(C.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new yd(C.elevationTileID));let v=C.elevationFeature.isTunnel(),S=0;a.properties.hasOwnProperty(YF)&&(S=+a.properties[YF]);for(let A of C.polygons)this.elevatedStructures.addPortalCandidates(C.elevationFeature.id,A,v,C.elevationFeature,S)}let M=new hX(d,C.elevationTileID);this.addElevatedGeometry(C.polygons,M,C.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,p)}}else this.addGeometry(l,this.bufferData)}addElevatedGeometry(a,l,d,p,h){let _={elevation:d,elevationSampler:l,bias:p,index:h},[x,C]=this.addGeometry(a,this.elevationBufferData,_);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:x,max:C}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,x),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,C))}addGeometry(a,l,d){let p=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,_=null;d&&(_=d.elevationSampler.constantElevation(d.elevation,d.bias),_!=null&&(p=_,h=_));let x=(C,M,v)=>{if(d!=null)if(M.push(C),_!=null)l.elevatedLayoutVertexArray.emplaceBack(_),v.push(_);else{let S=d.elevationSampler.pointElevation(C,d.elevation,d.bias);l.elevatedLayoutVertexArray.emplaceBack(S),v.push(S),p=Math.min(p,S),h=Math.max(h,S)}};for(let C of a){let M=0;for(let $ of C)M+=$.length;let v=l.triangleSegments.prepareSegment(M,l.layoutVertexArray,l.indexArray),S=v.vertexLength,A=[],D=[],I=[],O=[],z=[],B=l.layoutVertexArray.length;for(let $ of C){if($.length===0)continue;$!==C[0]&&D.push(A.length/2);let H=l.lineSegments.prepareSegment($.length,l.layoutVertexArray,l.lineIndexArray),K=H.vertexLength;d&&z.push(l.layoutVertexArray.length-B),x($[0],I,O),l.layoutVertexArray.emplaceBack($[0].x,$[0].y),l.lineIndexArray.emplaceBack(K+$.length-1,K),A.push($[0].x),A.push($[0].y);for(let ee=1;ee<$.length;ee++)x($[ee],I,O),l.layoutVertexArray.emplaceBack($[ee].x,$[ee].y),l.lineIndexArray.emplaceBack(K+ee-1,K+ee),A.push($[ee].x),A.push($[ee].y);H.vertexLength+=$.length,H.primitiveLength+=$.length}let G=Ub(A,D);for(let $=0;$<G.length;$+=3)l.indexArray.emplaceBack(S+G[$],S+G[$+1],S+G[$+2]);if(d&&this.elevationMode==="hd-road-base"){let $=d.elevation.isTunnel(),H=d.elevation.safeArea,K=this.elevatedStructures.addVertices(I,O);this.elevatedStructures.addTriangles(G,K,$);let ee=z.length;if(ee>0){for(let ne=0;ne<ee-1;ne++)this.elevatedStructures.addRenderableRing(d.index,z[ne]+K,z[ne+1]-z[ne],$,H);this.elevatedStructures.addRenderableRing(d.index,z[ee-1]+K,I.length-z[ee-1],$,H)}}v.vertexLength+=M,v.primitiveLength+=G.length/3}return[p,h]}getElevationFeature(a,l){if(!l)return;let d=+a.properties[vg];return d!=null?l.find(p=>p.id===d):void 0}}let QF,JF,e6,t6;ii(eA,"FillBucket",{omit:["layers","patternFeatures"]}),ii(JI,"FillBufferData"),ii(yd,"ElevatedStructures");class tA{constructor(a,l,d,p){if(this.triangleCount=l.length/3,this.min=new Wt(0,0),this.max=new Wt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||a.length===0)return;let[h,_]=[a[0].clone(),a[0].clone()];for(let S=1;S<a.length;++S){let A=a[S];h.x=Math.min(h.x,A.x),h.y=Math.min(h.y,A.y),_.x=Math.max(_.x,A.x),_.y=Math.max(_.y,A.y)}if(p){let S=Math.ceil(Math.max(_.x-h.x,_.y-h.y)/p);d=Math.max(d,S)}if(d===0)return;this.min=h,this.max=_;let x=this.max.sub(this.min);x.x=Math.max(x.x,1),x.y=Math.max(x.y,1);let C=Math.max(x.x,x.y)/d;this.cellsX=Math.max(1,Math.ceil(x.x/C)),this.cellsY=Math.max(1,Math.ceil(x.y/C)),this.xScale=1/C,this.yScale=1/C;let M=[];for(let S=0;S<this.triangleCount;S++){let A=a[l[3*S+0]].sub(this.min),D=a[l[3*S+1]].sub(this.min),I=a[l[3*S+2]].sub(this.min),O=xh(Math.floor(Math.min(A.x,D.x,I.x)),this.xScale,this.cellsX),z=xh(Math.floor(Math.max(A.x,D.x,I.x)),this.xScale,this.cellsX),B=xh(Math.floor(Math.min(A.y,D.y,I.y)),this.yScale,this.cellsY),G=xh(Math.floor(Math.max(A.y,D.y,I.y)),this.yScale,this.cellsY),$=new Wt(0,0),H=new Wt(0,0),K=new Wt(0,0),ee=new Wt(0,0);for(let ne=B;ne<=G;++ne){$.y=H.y=ne*C,K.y=ee.y=(ne+1)*C;for(let ve=O;ve<=z;++ve)$.x=K.x=ve*C,H.x=ee.x=(ve+1)*C,(dt(A,D,I,$,H,ee)||dt(A,D,I,$,ee,K))&&M.push({cellIdx:ne*this.cellsX+ve,triIdx:S})}}if(M.length===0)return;M.sort((S,A)=>S.cellIdx-A.cellIdx||S.triIdx-A.triIdx);let v=0;for(;v<M.length;){let S=M[v].cellIdx,A={start:this.payload.length,len:0};for(;v<M.length&&M[v].cellIdx===S;)++A.len,this.payload.push(M[v++].triIdx);this.cells[S]=A}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(a,l){if(this.triangleCount===0||this.cells.length===0||a.x>this.max.x||this.min.x>a.x||a.y>this.max.y||this.min.y>a.y)return;let d=xh(a.x-this.min.x,this.xScale,this.cellsX),p=xh(a.y-this.min.y,this.yScale,this.cellsY),h=this.cells[p*this.cellsX+d];if(h){this._lazyInitLookup();for(let _=0;_<h.len;_++){let x=this.payload[h.start+_],C=Math.floor(x/8),M=1<<x%8;if(!(this.lookup[C]&M)&&(this.lookup[C]|=M,l.push(x),l.length===this.triangleCount))return}}}query(a,l,d){if(this.triangleCount===0||this.cells.length===0||a.x>this.max.x||this.min.x>l.x||a.y>this.max.y||this.min.y>l.y)return;this._lazyInitLookup();let p=xh(a.x-this.min.x,this.xScale,this.cellsX),h=xh(l.x-this.min.x,this.xScale,this.cellsX),_=xh(a.y-this.min.y,this.yScale,this.cellsY),x=xh(l.y-this.min.y,this.yScale,this.cellsY);for(let C=_;C<=x;C++)for(let M=p;M<=h;M++){let v=this.cells[C*this.cellsX+M];if(v)for(let S=0;S<v.len;S++){let A=this.payload[v.start+S],D=Math.floor(A/8),I=1<<A%8;if(!(this.lookup[D]&I)&&(this.lookup[D]|=I,d.push(A),d.length===this.triangleCount))return}}}}function xh(u,a,l){return Math.max(0,Math.min(l-1,Math.floor(u*a)))}ii(tA,"TriangleGridIndex");class i6{constructor(a){this.zoom=a.zoom,this.layers=a.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=a.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.footprints=[]}updateFootprints(a,l){for(let d of this.footprints)l.push({footprint:d,id:a})}populate(a,l,d,p){let h=[];for(let{feature:_,id:x,index:C,sourceLayerIndex:M}of a){let v=this.layers[0]._featureFilter.needGeometry,S=F(_,v);if(!this.layers[0]._featureFilter.filter(new Ar(this.zoom),S,d))continue;let A={id:x,properties:_.properties,type:_.type,sourceLayerIndex:M,index:C,geometry:v?S.geometry:L(_,d,p),patterns:{}};h.push(A)}for(let _ of h){let{geometry:x,index:C,sourceLayerIndex:M}=_;this.addFeature(_,x,C,d,{},l.availableImages,l.brightness),l.featureIndex.insert(a[C].feature,x,C,M,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(a){}update(a,l,d,p,h,_,x){}destroy(){}addFeature(a,l,d,p,h,_=[],x){for(let C of $E(l,2)){let M=[],v=[],S=[],A=new Wt(1/0,1/0),D=new Wt(-1/0,-1/0);for(let z of C)if(z.length!==0){z!==C[0]&&S.push(v.length/2);for(let B=0;B<z.length;B++)v.push(z[B].x),v.push(z[B].y),M.push(z[B]),A.x=Math.min(A.x,z[B].x),A.y=Math.min(A.y,z[B].y),D.x=Math.max(D.x,z[B].x),D.y=Math.max(D.y,z[B].y)}let I=Ub(v,S),O=new tA(M,I,8,256);this.footprints.push({vertices:M,indices:I,grid:O,min:A,max:D})}}}ii(i6,"ClipBucket",{omit:["layers"]});let fX=Jn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),mX=Jn([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),gX=Jn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),_X=Jn([{name:"a_join_normal_inside",components:3,type:"Int16"}]),yX=Jn([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),vX=Jn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:bX}=fX;class xg extends Wt{constructor(a,l,d){super(a,l),this.z=d}}class n6 extends xg{constructor(a,l,d,p){super(a,l,d),this.w=p}}function WE(u,a,l,d){let p=[],h=d===0?(_,x,C,M,v,S)=>{_.push(new Wt(S,C+(S-x)/(M-x)*(v-C)))}:(_,x,C,M,v,S)=>{_.push(new Wt(x+(S-C)/(v-C)*(M-x),S))};for(let _ of u){let x=[];for(let C of _){if(C.length<=2)continue;let M=[];for(let A=0;A<C.length-1;A++){let D=C[A].x,I=C[A].y,O=C[A+1].x,z=C[A+1].y,B=d===0?D:I,G=d===0?O:z;B<a?G>a&&h(M,D,I,O,z,a):B>l?G<l&&h(M,D,I,O,z,l):M.push(C[A]),G<a&&B>=a&&h(M,D,I,O,z,a),G>l&&B<=l&&h(M,D,I,O,z,l)}let v=C[C.length-1],S=d===0?v.x:v.y;S>=a&&S<=l&&M.push(v),M.length&&(v=M[M.length-1],M[0].x===v.x&&M[0].y===v.y||M.push(M[0]),x.push(M))}x.length&&p.push(x)}return p}function r6(u,a,l,d){let p=l==="x"?"y":"x",h=(d-u[l])/(a[l]-u[l]);u[p]=u[p]+(a[p]-u[p])*h,u[l]=d,u.hasOwnProperty("z")&&(u.z=pi(u.z,a.z,h)),u.hasOwnProperty("w")&&(u.w=pi(u.w,a.w,h))}function o6(u,a,l,d){let p=l,h=d;for(let _ of["x","y"]){let x=u,C=a;x[_]>=C[_]&&(x=a,C=u),x[_]<p&&C[_]>p&&r6(x,C,_,p),x[_]<h&&C[_]>h&&r6(C,x,_,h)}}let ZE=Number.MAX_SAFE_INTEGER;function a6(u,a,l,d){return u.order<a||u.order===ZE||!(u.clipMask&l)||function(p,h){return h.length!==0&&h.find(_=>_===p)===void 0}(d,u.clipScope)}function YE(u,a){return u.x-a.x||u.y-a.y}function s6(u,a){return YE(u.min,a.min)===0&&YE(u.max,a.max)===0}function iA(u,a){return!(u.min.x>a.max.x||u.max.x<a.min.x||u.min.y>a.max.y||u.max.y<a.min.y)}function nA(u,a){if(u.length!==a.length)return!1;for(let l=0;l<u.length;l++)if(u[l].sourceId!==a[l].sourceId||!s6(u[l],a[l])||u[l].order!==a[l].order||u[l].clipMask!==a[l].clipMask||!Cs(u[l].clipScope,a[l].clipScope))return!1;return!0}function l6(u,a,l){let d=1/$t,p=1/(1<<l.canonical.z),h=(a.x*d+l.canonical.x)*p+l.wrap,_=(a.y*d+l.canonical.y)*p;return{min:new Wt((u.x*d+l.canonical.x)*p+l.wrap,(u.y*d+l.canonical.y)*p),max:new Wt(h,_)}}function xX(u,a,l){let d=1<<l.canonical.z,p=((a.x-l.wrap)*d-l.canonical.x)*$t,h=(a.y*d-l.canonical.y)*$t;return{min:new Wt(((u.x-l.wrap)*d-l.canonical.x)*$t,(u.y*d-l.canonical.y)*$t),max:new Wt(p,h)}}function c6(u,a,l,d,p,h,_){let x=u.indices,C=u.vertices,M=[];for(let v=d;v<d+p;v+=3){let S=a[l[v+0]+h],A=a[l[v+1]+h],D=a[l[v+2]+h],I=Math.min(S.x,A.x,D.x),O=Math.max(S.x,A.x,D.x),z=Math.min(S.y,A.y,D.y),B=Math.max(S.y,A.y,D.y);M.length=0,u.grid.query(new Wt(I,z),new Wt(O,B),M);for(let G=0;G<M.length;G++){let $=M[G];if(dt(C[x[3*$+0]],C[x[3*$+1]],C[x[3*$+2]],S,A,D,_))return!0}}return!1}function u6(u,a,l,d){if(!u||!l)return!1;let p=u.vertices;if(!a.canonical.equals(d.canonical)||a.wrap!==d.wrap){if(l.vertices.length<u.vertices.length)return u6(l,d,u,a);let h=a.canonical,_=d.canonical,x=Math.pow(2,_.z-h.z);p=u.vertices.map(C=>new Wt((C.x+h.x*$t)*x-_.x*$t,(C.y+h.y*$t)*x-_.y*$t))}return c6(l,p,u.indices,0,u.indices.length,0,0)}function d6(u,a,l,d){let p=Math.pow(2,d.z-l.z);return new Wt((u+l.x*$t)*p-d.x*$t,(a+l.y*$t)*p-d.y*$t)}function h6(u,a){let l=[];a.grid.queryPoint(u,l);let d=a.indices,p=a.vertices;for(let h=0;h<l.length;h++){let _=l[h];if(Ae([p[d[3*_+0]],p[d[3*_+1]],p[d[3*_+2]]],u))return!0}return!1}let rA=[new Wt(0,0),new Wt($t,0),new Wt($t,$t),new Wt(0,$t)];function p6(u,a){let l=[],d=[];if(!a||u.length<2)return[u];if(u.length===2)return Ve(u[0],u[1],rA)?[u]:[];for(let p=0;p<u.length+2;p++){let h=u[p%u.length],_=u[(p+1)%u.length],x=Ve(p===0?u[u.length-1]:u[(p-1)%u.length],h,rA),C=Ve(h,_,rA),M=x||C;M&&d.push(h),M&&C||d.length>0&&(d.length>1&&l.push(d),d=[])}return d.length>1&&l.push(d),l}let oA=Mf.VectorTileFeature.types,wX=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],EX=["fill-extrusion-flood-light-ground-radius"],CX=Math.pow(2,13),SX=Math.pow(2,15)-1,f6=new Wt(0,1),If=2147483648;function Gb(u,a,l,d,p,h,_,x){u.emplaceBack((a<<1)+_,(l<<1)+h,(Math.floor(d*CX)<<1)+p,Math.round(x))}function Wb(u,a,l){u.emplaceBack(a.x*$t,a.y*$t,l?1:0)}function KE(u,a,l,d,p,h){u.emplaceBack(a.x,a.y,(l.x<<1)+d,(l.y<<1)+p,h)}function Zb(u,a,l){u.emplaceBack(a.x,a.y,a.z,l[0]*16384,l[1]*16384,l[2]*16384)}class m6{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class g6{constructor(){this.centroidXY=new Wt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Wt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Wt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Wt(this.max.x-this.min.x,this.max.y-this.min.y)}}class _6{constructor(){this.acc=new Wt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(a,l){a.min.x===Number.MAX_VALUE&&(a.min.x=a.max.x=l.x,a.min.y=a.max.y=l.y)}appendEdge(a,l,d){this.accCount++,this.acc._add(l);let p=!!this.borders;l.x<a.min.x?(a.min.x=l.x,p=!0):l.x>a.max.x&&(a.max.x=l.x,p=!0),l.y<a.min.y?(a.min.y=l.y,p=!0):l.y>a.max.y&&(a.max.y=l.y,p=!0),((l.x===0||l.x===$t)&&l.x===d.x)!=((l.y===0||l.y===$t)&&l.y===d.y)&&this.processBorderOverlap(l,d),p&&this.checkBorderIntersection(l,d)}checkBorderIntersection(a,l){l.x<0!=a.x<0&&this.addBorderIntersection(0,pi(l.y,a.y,(0-l.x)/(a.x-l.x))),l.x>$t!=a.x>$t&&this.addBorderIntersection(1,pi(l.y,a.y,($t-l.x)/(a.x-l.x))),l.y<0!=a.y<0&&this.addBorderIntersection(2,pi(l.x,a.x,(0-l.y)/(a.y-l.y))),l.y>$t!=a.y>$t&&this.addBorderIntersection(3,pi(l.x,a.x,($t-l.y)/(a.y-l.y)))}addBorderIntersection(a,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);let d=this.borders[a];l<d[0]&&(d[0]=l),l>d[1]&&(d[1]=l)}processBorderOverlap(a,l){if(a.x===l.x){if(a.y===l.y)return;let d=a.x===0?0:1;this.addBorderIntersection(d,l.y),this.addBorderIntersection(d,a.y)}else{let d=a.y===0?2:3;this.addBorderIntersection(d,l.x),this.addBorderIntersection(d,a.x)}}centroid(){return this.accCount===0?new Wt(0,0):new Wt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((a,l)=>a+ +(l[0]!==Number.MAX_VALUE),0):0}}function y6(u,a){let l=u.add(a)._unit(),d=pn(u.x*l.x+u.y*l.y,-1,1);var p,h,_;return _=Math.acos(d),Math.min(4,Math.max(-4,Math.tan(_)))/4*SX*((p=u).x*(h=a).y-p.y*h.x<0?-1:1)}let TX=[u=>u.x<0,u=>u.x>$t,u=>u.y<0,u=>u.y>$t];function DX(u,a,l,d){let p=[4];if(d===0)return p;l._mult(d);let h=u.sub(l),_=a.sub(l),x=[u,a,h,_];for(let C=0;C<4;C++)for(let M of x)if(TX[C](M)){p.push(C);break}return p}class v6{constructor(a){this.vertexArray=new cc,this.indexArray=new Ra,this.programConfigurations=new yh(a.layers,{zoom:a.zoom,lut:a.lut},l=>EX.includes(l)),this._segments=new Zr,this.hiddenByLandmarkVertexArray=new Ab,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Zr}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(a,l,d,p=!1){let h=a.length;if(h>2){let _=Math.max(0,this._segments.get().length-1),x=this._segments._prepareSegment(4*h,this.vertexArray.length,2*this._segmentToGroundQuads[_].length),C;_!==this._segments.get().length-1&&(_++,this._segmentToGroundQuads[_]=[],this._segmentToRegionTriCounts[_]=[0,0,0,0,0]);{let M=a[0],v=a[1];C=y6(M.sub(a[h-1])._perp()._unit(),v.sub(M)._perp()._unit())}for(let M=0;M<h;M++){let v=M===h-1?0:M+1,S=a[M],A=a[v],D=a[v===h-1?0:v+1],I=A.sub(S)._perp()._unit(),O=y6(I,D.sub(A)._perp()._unit()),z=C,B=O;if(aA(S,A,l)||p&&w6(S,l)&&w6(A,l)){C=O;continue}let G=x.vertexLength;KE(this.vertexArray,S,A,1,1,z),KE(this.vertexArray,S,A,1,0,z),KE(this.vertexArray,S,A,0,1,B),KE(this.vertexArray,S,A,0,0,B),x.vertexLength+=4;let $=DX(S,A,I,d);for(let H of $)this._segmentToGroundQuads[_].push({id:G,region:H}),this._segmentToRegionTriCounts[_][H]+=2,x.primitiveLength+=2;C=O}}}prepareBorderSegments(){if(!this.hasData())return;let a=this._segments.get(),l=a.length;for(let d=0;d<l;d++)this._segmentToGroundQuads[d].sort((p,h)=>p.region-h.region);for(let d=0;d<l;d++){let p=this._segmentToGroundQuads[d],h=a[d],_=this._segmentToRegionTriCounts[d];_.reduce((C,M)=>C+M,0);let x=0;for(let C=0;C<=4;C++){let M=_[C];if(M!==0){let v=this.regionSegments[C];v||(v=this.regionSegments[C]=new Zr);let S={vertexOffset:h.vertexOffset,primitiveOffset:h.primitiveOffset+x,vertexLength:h.vertexLength,primitiveLength:M};v.get().push(S)}x+=M}for(let C=0;C<p.length;C++){let M=p[C].id;this.indexArray.emplaceBack(M,M+1,M+3),this.indexArray.emplaceBack(M,M+3,M+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(a,l,d,p,h,_){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,a,l,d,p,h,_)}upload(a){this.hasData()&&(this.vertexBuffer=a.createVertexBuffer(this.vertexArray,mX.members),this.indexBuffer=a.createIndexBuffer(this.indexArray))}uploadPaintProperties(a){this.hasData()&&this.programConfigurations.upload(a)}update(a,l,d,p,h,_,x){this.hasData()&&this.programConfigurations.updatePaintArrays(a,l,d,p,h,_,x)}updateHiddenByLandmark(a){if(!this.hasData())return;let l=a.groundVertexCount+a.groundVertexArrayOffset;if(a.groundVertexCount===0)return;let d=a.flags&If?1:0;for(let p=a.groundVertexArrayOffset;p<l;++p)this.hiddenByLandmarkVertexArray.emplace(p,d);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(a){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=a.createVertexBuffer(this.hiddenByLandmarkVertexArray,yX.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let a=0;a<=4;a++){let l=this.regionSegments[a];l&&l.destroy()}}}}class XE{constructor(a){this.zoom=a.zoom,this.canonical=a.canonical,this.overscaling=a.overscaling,this.layers=a.layers,this.pixelRatio=a.pixelRatio,this.layerIds=this.layers.map(l=>l.fqid),this.index=a.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=a.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Ra,this.footprintVertices=new pd,this.footprintSegments=[],this.layoutVertexArray=new fd,this.centroidVertexArray=new dg,this.wallVertexArray=new PE,this.indexArray=new Ra,this.programConfigurations=new yh(a.layers,{zoom:a.zoom,lut:a.lut},l=>wX.includes(l)),this.segments=new Zr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.groundEffect=new v6(a),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(a,l){}populate(a,l,d,p){this.features=[],this.hasPattern=WI("fill-extrusion",this.layers,this.pixelRatio,l),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=m(d),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(let{feature:h,id:_,index:x,sourceLayerIndex:C}of a){let M=this.layers[0]._featureFilter.needGeometry,v=F(h,M);if(!this.layers[0]._featureFilter.filter(new Ar(this.zoom),v,d))continue;let S={id:_,sourceLayerIndex:C,index:x,geometry:M?v.geometry:L(h,d,p),properties:h.properties,type:h.type,patterns:{}},A=this.layoutVertexArray.length,D=oA[S.type]==="Polygon";if(this.hasPattern)this.features.push(ZI("fill-extrusion",this.layers,S,this.zoom,this.pixelRatio,l));else if(this.wallMode)for(let I of S.geometry)for(let O of p6(I,D))this.addFeature(S,[O],x,d,{},l.availableImages,p,l.brightness);else this.addFeature(S,S.geometry,x,d,{},l.availableImages,p,l.brightness);l.featureIndex.insert(h,S.geometry,x,C,this.index,A)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(a,l,d,p,h,_){for(let x of this.features){let C=oA[x.type]==="Polygon",{geometry:M}=x;if(this.wallMode)for(let v of M)for(let S of p6(v,C))this.addFeature(x,[S],x.index,l,d,p,h,_);else this.addFeature(x,M,x.index,l,d,p,h,_)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(a,l,d,p,h,_,x){this.programConfigurations.updatePaintArrays(a,l,h,d,p,_,x),this.groundEffect.update(a,l,h,d,p,_,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,bX),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.wallVertexBuffer=a.createVertexBuffer(this.wallVertexArray,_X.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=a.createVertexBuffer(this.layoutVertexExtArray,vX.members,!0)),this.groundEffect.upload(a)),this.groundEffect.uploadPaintProperties(a),this.programConfigurations.upload(a),this.uploaded=!0}uploadCentroid(a){this.groundEffect.uploadHiddenByLandmark(a),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,gX.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,l,d,p,h,_,x,C){let M=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(a,{})/this.tileToMeter,v=[new Wt(0,0),new Wt($t,$t)],S=x.projection,A=S.name==="globe",D=this.wallMode||oA[a.type]==="Polygon",I=new _6;I.centroidDataIndex=this.centroidData.length;let O=new g6,z=this.layers[0].paint.get("fill-extrusion-base").evaluate(a,{},p)<=0,B=this.layers[0].paint.get("fill-extrusion-height").evaluate(a,{},p),G;if(O.height=B,O.vertexArrayOffset=this.layoutVertexArray.length,O.groundVertexArrayOffset=this.groundEffect.vertexArray.length,A&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new x_),this.wallMode){if(A)return void Gt("Non zero fill-extrusion-line-width is not yet supported on globe.");if(l.length!==1)return;G=function(fe){let Fe=fe[0].x===fe[fe.length-1].x&&fe[0].y===fe[fe.length-1].y;(function(qt){let Lt=0,Ri=qt.length;for(let Jt=0;Jt<Ri;Jt++)Lt+=(qt[(Jt+1)%Ri].x-qt[Jt].x)*(qt[(Jt+1)%Ri].y+qt[Jt].y);return Lt>=0})(fe)||(fe=fe.reverse());let Be={geometry:[],joinNormals:[],indices:[]},$e=[],Ue=[],Ye=[],Ze=fe.length;for(;Ze>=2&&fe[Ze-1].equals(fe[Ze-2]);)Ze--;if(Ze<(Fe?3:2))return Be;let rt,Je,ot,kt,Mt,ni=0;for(;ni<Ze-1&&fe[ni].equals(fe[ni+1]);)ni++;Fe&&(rt=fe[Ze-2],Mt=fe[ni].sub(rt)._unit()._perp());for(let qt=ni;qt<Ze;qt++){if(ot=qt===Ze-1?Fe?fe[ni+1]:void 0:fe[qt+1],ot&&fe[qt].equals(ot))continue;Mt&&(kt=Mt),rt&&(Je=rt),rt=fe[qt],Mt=ot?ot.sub(rt)._unit()._perp():kt,kt=kt||Mt;let Lt=kt.add(Mt);Lt.x===0&&Lt.y===0||Lt._unit();let Ri=Lt.x*Mt.x+Lt.y*Mt.y,Jt=Ri!==0?1/Ri:1/0,mi=kt.x*Mt.y-kt.y*Mt.x>0,Hi="miter",mn=2;Hi==="miter"&&Jt>mn&&(Hi="bevel"),Hi==="bevel"&&(Jt>100&&(Hi="flipbevel"),Jt<mn&&(Hi="miter"));let Xi=(bn,fn,Dn,Kn)=>{let Rr=new Wt(bn.x,bn.y),Wi=new Wt(bn.x,bn.y);Rr.x+=fn.x*Kn,Rr.y+=fn.y*Kn,Wi.x-=fn.x*Math.max(Dn,1),Wi.y-=fn.y*Math.max(Dn,1),Ye.push(fn),$e.push(Rr),Ue.push(Wi)};if(Hi==="miter")Lt._mult(Jt),Xi(rt,Lt,0,0);else if(Hi==="flipbevel")Lt=Mt.mult(-1),Xi(rt,Lt,0,0),Xi(rt,Lt.mult(-1),0,0);else{let bn=-Math.sqrt(Jt*Jt-1),fn=mi?bn:0,Dn=mi?0:bn;Je&&Xi(rt,kt,fn,Dn),ot&&Xi(rt,Mt,fn,Dn)}}Be.geometry=[...$e,...Ue.reverse(),$e[0]],Be.joinNormals=[...Ye,...Ye.reverse(),Ye[Ye.length-1]];let Vt=Be.geometry.length-1;for(let qt=0;qt<Vt/2;qt++)if(qt+1<Vt/2){let Lt=qt,Ri=qt+1,Jt=Vt-1-qt,mi=Vt-2-qt;Lt=Lt===0?Vt-1:Lt-1,Ri=Ri===0?Vt-1:Ri-1,Jt=Jt===0?Vt-1:Jt-1,mi=mi===0?Vt-1:mi-1,Be.indices.push(Jt),Be.indices.push(Ri),Be.indices.push(Lt),Be.indices.push(Jt),Be.indices.push(mi),Be.indices.push(Ri)}return Be}(l[0]),l=[G.geometry]}let $=(fe,Fe)=>fe<(Fe.length-1)/2||fe===Fe.length-1,H=this.wallMode?[l]:$E(l,500);for(let fe=H.length-1;fe>=0;fe--){let Fe=H[fe];(Fe.length===0||(K=Fe[0]).every(be=>be.x<=0)||K.every(be=>be.x>=$t)||K.every(be=>be.y<=0)||K.every(be=>be.y>=$t))&&H.splice(fe,1)}var K;let ee;if(A)ee=T6(H,v,p);else{ee=[];for(let fe of H)ee.push({polygon:fe,bounds:v})}let ne=D?this.edgeRadius:0,ve=ne>0&&this.zoom<17,pe=(fe,Fe)=>{if(fe.length===0)return!1;let be=fe[fe.length-1];return Fe.x===be.x&&Fe.y===be.y};for(let{polygon:fe,bounds:Fe}of ee){let be=0,Be=0;for(let Ze of fe)D&&!Ze[0].equals(Ze[Ze.length-1])&&Ze.push(Ze[0]),Be+=D?Ze.length-1:Ze.length;let $e=this.segments.prepareSegment((D?5:4)*Be,this.layoutVertexArray,this.indexArray);O.footprintSegIdx<0&&(O.footprintSegIdx=this.footprintSegments.length),O.polygonSegIdx<0&&(O.polygonSegIdx=this.polygonSegments.length);let Ue={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Ye=new m6;if(Ye.vertexOffset=this.footprintVertices.length,Ye.indexOffset=3*this.footprintIndices.length,Ye.ringIndices=[],D){let Ze=[],rt=[];be=$e.vertexLength;for(let ot=0;ot<fe.length;ot++){let kt=fe[ot];kt.length&&ot!==0&&rt.push(Ze.length/2);let Mt=[],ni,Vt;ni=kt[1].sub(kt[0])._perp()._unit(),Ye.ringIndices.push(kt.length-1);for(let qt=1;qt<kt.length;qt++){let Lt=kt[qt],Ri=kt[qt===kt.length-1?1:qt+1],Jt=Lt.clone();if(ne){Vt=Ri.sub(Lt)._perp()._unit();let mi=ni.add(Vt)._unit(),Hi=ne*Math.min(4,1/(ni.x*mi.x+ni.y*mi.y));Jt.x+=Hi*mi.x,Jt.y+=Hi*mi.y,Jt.x=Math.round(Jt.x),Jt.y=Math.round(Jt.y),ni=Vt}if(!z||ne!==0&&!ve||pe(Mt,Jt)||Mt.push(Jt),Gb(this.layoutVertexArray,Jt.x,Jt.y,0,0,1,1,0),this.wallMode){let mi=$(qt,kt);Wb(this.wallVertexArray,G.joinNormals[qt],!mi)}$e.vertexLength++,this.footprintVertices.emplaceBack(Lt.x,Lt.y),Ze.push(Lt.x,Lt.y),A&&Zb(this.layoutVertexExtArray,S.projectTilePoint(Jt.x,Jt.y,p),S.upVector(p,Jt.x,Jt.y))}z&&(ne===0||ve)&&(Mt.length!==0&&pe(Mt,Mt[0])&&Mt.pop(),this.groundEffect.addData(Mt,Fe,M))}let Je=this.wallMode?G.indices:Ub(Ze,rt);for(let ot=0;ot<Je.length;ot+=3)this.footprintIndices.emplaceBack(Ye.vertexOffset+Je[ot+0],Ye.vertexOffset+Je[ot+1],Ye.vertexOffset+Je[ot+2]),this.indexArray.emplaceBack(be+Je[ot],be+Je[ot+2],be+Je[ot+1]),$e.primitiveLength++;Ye.indexCount+=Je.length,Ye.vertexCount+=this.footprintVertices.length-Ye.vertexOffset}for(let Ze=0;Ze<fe.length;Ze++){let rt=fe[Ze];I.startRing(O,rt[0]);let Je=rt.length>4&&E6(rt[rt.length-2],rt[0],rt[1]),ot=ne?MX(rt[rt.length-2],rt[0],rt[1],ne):0,kt=[],Mt,ni,Vt;ni=rt[1].sub(rt[0])._perp()._unit();let qt=!0;for(let Lt=1,Ri=0;Lt<rt.length;Lt++){let Jt=rt[Lt-1],mi=rt[Lt],Hi=rt[Lt===rt.length-1?1:Lt+1];if(I.appendEdge(O,mi,Jt),aA(mi,Jt,Fe)){ne&&(ni=Hi.sub(mi)._perp()._unit(),qt=!qt);continue}let mn=mi.sub(Jt)._perp(),Xi=mn.x/(Math.abs(mn.x)+Math.abs(mn.y)),bn=mn.y>0?1:0,fn=Jt.dist(mi);if(Ri+fn>32768&&(Ri=0),ne){Vt=Hi.sub(mi)._perp()._unit();let Wi=x6(Jt,mi,Hi,b6(ni,Vt),ne);isNaN(Wi)&&(Wi=0);let Nn=mi.sub(Jt)._unit();Jt=Jt.add(Nn.mult(ot))._round(),mi=mi.add(Nn.mult(-Wi))._round(),ot=Wi,ni=Vt,z&&this.zoom>=17&&(pe(kt,Jt)||kt.push(Jt),pe(kt,mi)||kt.push(mi))}let Dn=$e.vertexLength,Kn=rt.length>4&&E6(Jt,mi,Hi),Rr=C6(Ri,Je,qt);if(Gb(this.layoutVertexArray,Jt.x,Jt.y,Xi,bn,0,0,Rr),Gb(this.layoutVertexArray,Jt.x,Jt.y,Xi,bn,0,1,Rr),this.wallMode){let Wi=$(Lt-1,rt),Nn=G.joinNormals[Lt-1];Wb(this.wallVertexArray,Nn,Wi),Wb(this.wallVertexArray,Nn,Wi)}if(Ri+=fn,Rr=C6(Ri,Kn,!qt),Je=Kn,Gb(this.layoutVertexArray,mi.x,mi.y,Xi,bn,0,0,Rr),Gb(this.layoutVertexArray,mi.x,mi.y,Xi,bn,0,1,Rr),this.wallMode){let Wi=$(Lt,rt),Nn=G.joinNormals[Lt];Wb(this.wallVertexArray,Nn,Wi),Wb(this.wallVertexArray,Nn,Wi)}if($e.vertexLength+=4,this.indexArray.emplaceBack(Dn+0,Dn+1,Dn+2),this.indexArray.emplaceBack(Dn+1,Dn+3,Dn+2),$e.primitiveLength+=2,ne){let Wi=be+(Lt===1?rt.length-2:Lt-2),Nn=Lt===1?be:Wi+1;if(this.indexArray.emplaceBack(Dn+1,Wi,Dn+3),this.indexArray.emplaceBack(Wi,Nn,Dn+3),$e.primitiveLength+=2,Mt===void 0&&(Mt=Dn),!aA(Hi,rt[Lt],Fe)){let Hr=Lt===rt.length-1?Mt:$e.vertexLength;this.indexArray.emplaceBack(Dn+2,Dn+3,Hr),this.indexArray.emplaceBack(Dn+3,Hr+1,Hr),this.indexArray.emplaceBack(Dn+3,Nn,Hr+1),$e.primitiveLength+=3}qt=!qt}if(A){let Wi=this.layoutVertexExtArray,Nn=S.projectTilePoint(Jt.x,Jt.y,p),Hr=S.projectTilePoint(mi.x,mi.y,p),Xr=S.upVector(p,Jt.x,Jt.y),ro=S.upVector(p,mi.x,mi.y);Zb(Wi,Nn,Xr),Zb(Wi,Nn,Xr),Zb(Wi,Hr,ro),Zb(Wi,Hr,ro)}}D&&(be+=rt.length-1),z&&ne&&this.zoom>=17&&(kt.length!==0&&pe(kt,kt[0])&&kt.pop(),this.groundEffect.addData(kt,Fe,M,ne>0))}this.footprintSegments.push(Ye),Ue.triangleCount=this.indexArray.length-Ue.triangleArrayOffset,this.polygonSegments.push(Ue),++O.footprintSegLen,++O.polygonSegLen}if(O.vertexCount=this.layoutVertexArray.length-O.vertexArrayOffset,O.groundVertexCount=this.groundEffect.vertexArray.length-O.groundVertexArrayOffset,O.vertexCount!==0){if(O.centroidXY=I.borders?f6:this.encodeCentroid(I,O),this.centroidData.push(O),I.borders){this.featuresOnBorder.push(I);let fe=this.featuresOnBorder.length-1;for(let Fe=0;Fe<I.borders.length;Fe++)I.borders[Fe][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Fe].push(fe)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,d,h,_,p,C),this.groundEffect.addPaintPropertiesData(a,d,h,_,p,C),this.maxHeight=Math.max(this.maxHeight,B)}}sortBorders(){for(let a=0;a<this.borderFeatureIndices.length;a++)this.borderFeatureIndices[a].sort((l,d)=>this.featuresOnBorder[l].borders[a][0]-this.featuresOnBorder[d].borders[a][0])}splitToSubtiles(){let a=[];for(let x=0;x<this.centroidData.length;x++){let C=this.centroidData[x],M=+(C.min.y+C.max.y>$t),v=2*M+(+(C.min.x+C.max.x>$t)^M);for(let S=0;S<C.polygonSegLen;S++){let A=C.polygonSegIdx+S;a.push({centroidIdx:x,subtile:v,polygonSegmentIdx:A,triangleSegmentIdx:this.polygonSegments[A].triangleSegIdx})}}let l=new Ra;a.sort((x,C)=>x.triangleSegmentIdx===C.triangleSegmentIdx?x.subtile-C.subtile:x.triangleSegmentIdx-C.triangleSegmentIdx);let d=0,p=0,h=0;for(let x of a){if(x.triangleSegmentIdx!==d)break;h++}let _=a.length;for(;p!==a.length;){d=a[p].triangleSegmentIdx;let x=0,C=p,M=p;for(let v=C;v<h&&a[v].subtile===x;v++)M++;for(;C!==h;){let v=a[C];x=v.subtile;let S=this.centroidData[v.centroidIdx].min.clone(),A=this.centroidData[v.centroidIdx].max.clone(),D={vertexOffset:this.segments.segments[d].vertexOffset,primitiveOffset:l.length,vertexLength:this.segments.segments[d].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let I=C;I<M;I++){let O=a[I],z=this.polygonSegments[O.polygonSegmentIdx],B=this.centroidData[O.centroidIdx].min,G=this.centroidData[O.centroidIdx].max,$=this.indexArray.uint16;for(let H=z.triangleArrayOffset;H<z.triangleArrayOffset+z.triangleCount;H++)l.emplaceBack($[3*H],$[3*H+1],$[3*H+2]);D.primitiveLength+=z.triangleCount,S.x=Math.min(S.x,B.x),S.y=Math.min(S.y,B.y),A.x=Math.max(A.x,G.x),A.y=Math.max(A.y,G.y)}D.primitiveLength>0&&this.triangleSubSegments.push({segment:D,min:S,max:A}),C=M;for(let I=C;I<h&&a[I].subtile===a[C].subtile;I++)M++}p=h;for(let v=p;v<_&&a[v].triangleSegmentIdx===a[p].triangleSegmentIdx;v++)h++}l._trim(),this.indexArray=l}getVisibleSegments(a,l,d){let p=new Zr;if(this.wallMode){for(let O of this.triangleSubSegments)p.segments.push(O.segment);return p}let h=0,_=0,x=1<<a.canonical.z;if(l){let O=l.getMinMaxForTile(a);O&&(h=O.min,_=O.max)}_+=this.maxHeight;let C=a.toUnwrapped(),M,v=[C.canonical.x/x+C.wrap,C.canonical.y/x],S=[(C.canonical.x+1)/x+C.wrap,(C.canonical.y+1)/x],A=(O,z,B)=>[O[0]*(1-B[0])+z[0]*B[0],O[1]*(1-B[1])+z[1]*B[1]],D=[],I=[];for(let O of this.triangleSubSegments){D[0]=O.min.x/$t,D[1]=O.min.y/$t,I[0]=O.max.x/$t,I[1]=O.max.y/$t;let z=A(v,S,D),B=A(v,S,I);if(new yi([z[0],z[1],h],[B[0],B[1],_]).intersectsPrecise(d)===0){M&&(p.segments.push(M),M=void 0);continue}let G=O.segment;M&&M.vertexOffset!==G.vertexOffset&&(p.segments.push(M),M=void 0),M?(M.vertexLength+=G.vertexLength,M.primitiveLength+=G.primitiveLength):M={vertexOffset:G.vertexOffset,primitiveLength:G.primitiveLength,vertexLength:G.vertexLength,primitiveOffset:G.primitiveOffset,sortKey:void 0,vaos:{}}}return M&&p.segments.push(M),p}encodeCentroid(a,l){let d=a.centroid(),p=l.span(),h=Math.min(7,Math.round(p.x*this.tileToMeter/10)),_=Math.min(7,Math.round(p.y*this.tileToMeter/10));return new Wt(pn(d.x,1,$t-1)<<3|h,pn(d.y,1,$t-1)<<3|_)}encodeBorderCentroid(a){if(!a.borders)return new Wt(0,0);let l=a.borders,d=Number.MAX_VALUE;if(l[0][0]!==d||l[1][0]!==d){let p=l[0][0]!==d?0:1;return new Wt(6|(l[0][0]!==d?0:65528),(l[p][0]+l[p][1])/2<<3|6)}{let p=l[2][0]!==d?2:3;return new Wt((l[p][0]+l[p][1])/2<<3|6,6|(l[2][0]!==d?0:65528))}}showCentroid(a){let l=this.centroidData[a.centroidDataIndex];l.flags&=If,l.centroidXY.x=0,l.centroidXY.y=0,this.writeCentroidToBuffer(l)}writeCentroidToBuffer(a){this.groundEffect.updateHiddenByLandmark(a);let l=a.vertexArrayOffset,d=a.vertexCount+a.vertexArrayOffset,p=a.flags&If?f6:a.centroidXY,h=this.centroidVertexArray.geta_centroid_pos0(l);if(this.centroidVertexArray.geta_centroid_pos1(l)!==p.y||h!==p.x){for(let _=l;_<d;++_)this.centroidVertexArray.emplace(_,p.x,p.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(let a of this.centroidData)this.writeCentroidToBuffer(a)}updateReplacement(a,l,d){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;let p=l.getReplacementRegionsForTile(a.toUnwrapped());if(nA(this.activeReplacements,p))return;if(this.activeReplacements=p,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(let _ of this.centroidData)_.flags&=2147483647;let h=[];for(let _ of this.activeReplacements){if(_.order<d)continue;let x=Math.max(1,Math.pow(2,_.footprintTileId.canonical.z-a.canonical.z));for(let C of this.centroidData)if(!(C.flags&If||_.min.x>C.max.x||C.min.x>_.max.x||_.min.y>C.max.y||C.min.y>_.max.y))for(let M=0;M<C.footprintSegLen;M++){let v=this.footprintSegments[C.footprintSegIdx+M];if(h.length=0,IX(this.footprintVertices,v.vertexOffset,v.vertexCount,_.footprintTileId.canonical,a.canonical,h),c6(_.footprint,h,this.footprintIndices.uint16,v.indexOffset,v.indexCount,-v.vertexOffset,-x)){C.flags|=If;break}}}for(let _ of this.centroidData)this.writeCentroidToBuffer(_);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(a,l,d){let p=!1;for(let h=0;h<d.footprintSegLen;h++){let _=this.footprintSegments[d.footprintSegIdx+h],x=0;for(let C of _.ringIndices){for(let M=x,v=C+x-1;M<C+x;v=M++){let S=this.footprintVertices.int16[2*(M+_.vertexOffset)+0],A=this.footprintVertices.int16[2*(M+_.vertexOffset)+1],D=this.footprintVertices.int16[2*(v+_.vertexOffset)+1];A>l!=D>l&&a<(this.footprintVertices.int16[2*(v+_.vertexOffset)+0]-S)*(l-A)/(D-A)+S&&(p=!p)}x=C}}return p}getHeightAtTileCoord(a,l){let d=Number.NEGATIVE_INFINITY,p=!0,h=4*(a+$t)*$t+(l+$t);if(this.partLookup.hasOwnProperty(h)){let _=this.partLookup[h];return _?{height:_.height,hidden:!!(_.flags&If)}:void 0}for(let _ of this.centroidData)a>_.max.x||_.min.x>a||l>_.max.y||_.min.y>l||this.footprintContainsPoint(a,l,_)&&_&&_.height>d&&(d=_.height,this.partLookup[h]=_,p=!!(_.flags&If));if(d!==Number.NEGATIVE_INFINITY)return{height:d,hidden:p};this.partLookup[h]=void 0}}function b6(u,a){let l=u.add(a)._unit();return u.x*l.x+u.y*l.y}function MX(u,a,l,d){let p=a.sub(u)._perp()._unit(),h=l.sub(a)._perp()._unit();return x6(u,a,l,b6(p,h),d)}function x6(u,a,l,d,p){let h=Math.sqrt(1-d*d);return Math.min(u.dist(a)/3,a.dist(l)/3,p*h/d)}function aA(u,a,l){return u.x<l[0].x&&a.x<l[0].x||u.x>l[1].x&&a.x>l[1].x||u.y<l[0].y&&a.y<l[0].y||u.y>l[1].y&&a.y>l[1].y}function w6(u,a){return u.x<a[0].x||u.x>a[1].x||u.y<a[0].y||u.y>a[1].y}function E6(u,a,l){if(u.x<0||u.x>=$t||a.x<0||a.x>=$t||l.x<0||l.x>=$t)return!1;let d=l.sub(a),p=d.perp(),h=u.sub(a);return(d.x*h.x+d.y*h.y)/Math.sqrt((d.x*d.x+d.y*d.y)*(h.x*h.x+h.y*h.y))>-.866&&p.x*h.x+p.y*h.y<0}function C6(u,a,l){let d=a?2|u:-3&u;return l?1|d:-2&d}function S6(){let u=Math.PI/32,a=Math.tan(u),l=fp;return l*Math.sqrt(1+2*a*a)-l}function T6(u,a,l){let d=1<<l.z,p=dl(l.x/d),h=dl((l.x+1)/d),_=ka(l.y/d),x=ka((l.y+1)/d);return function(C,M,v,S,A=0,D){let I=[];if(!C.length||!v||!S)return I;let O=(ee,ne)=>{for(let ve of ee)I.push({polygon:ve,bounds:ne})},z=Math.ceil(Math.log2(v)),B=Math.ceil(Math.log2(S)),G=z-B,$=[];for(let ee=0;ee<Math.abs(G);ee++)$.push(G>0?0:1);for(let ee=0;ee<Math.min(z,B);ee++)$.push(0),$.push(1);let H=C;if(H=WE(H,M[0].y-A,M[1].y+A,1),H=WE(H,M[0].x-A,M[1].x+A,0),!H.length)return I;let K=[];for($.length?K.push({polygons:H,bounds:M,depth:0}):O(H,M);K.length;){let ee=K.pop(),ne=ee.depth,ve=$[ne],pe=ee.bounds[0],fe=ee.bounds[1],Fe=ve===0?pe.x:pe.y,be=ve===0?fe.x:fe.y,Be=D?D(ve,Fe,be):.5*(Fe+be),$e=WE(ee.polygons,Fe-A,Be+A,ve),Ue=WE(ee.polygons,Be-A,be+A,ve);if($e.length){let Ye=[pe,new Wt(ve===0?Be:fe.x,ve===1?Be:fe.y)];$.length>ne+1?K.push({polygons:$e,bounds:Ye,depth:ne+1}):O($e,Ye)}if(Ue.length){let Ye=[new Wt(ve===0?Be:pe.x,ve===1?Be:pe.y),fe];$.length>ne+1?K.push({polygons:Ue,bounds:Ye,depth:ne+1}):O(Ue,Ye)}}return I}(u,a,Math.ceil((h-p)/11.25),Math.ceil((_-x)/11.25),1,(C,M,v)=>{if(C===0)return .5*(M+v);{let S=ka((l.y+M/$t)/d);return(ul(.5*(ka((l.y+v/$t)/d)+S))*d-l.y)*$t}})}function IX(u,a,l,d,p,h){let _=Math.pow(2,d.z-p.z);for(let x=0;x<l;x++){let C=u.int16[2*(x+a)+0],M=u.int16[2*(x+a)+1];C=(C+p.x*$t)*_-d.x*$t,M=(M+p.y*$t)*_-d.y*$t,h.push(new Wt(C,M))}}let D6,M6;function Yb(u,a){return u.x*a.x+u.y*a.y}function I6(u,a){if(u.length===1){let l=0,d=a[l++],p;for(;!p||d.equals(p);)if(p=a[l++],!p)return 1/0;for(;l<a.length;l++){let h=a[l],_=u[0],x=p.sub(d),C=h.sub(d),M=_.sub(d),v=Yb(x,x),S=Yb(x,C),A=Yb(C,C),D=Yb(M,x),I=Yb(M,C),O=v*A-S*S,z=(A*D-S*I)/O,B=(v*I-S*D)/O,G=d.z*(1-z-B)+p.z*z+h.z*B;if(isFinite(G))return G}return 1/0}{let l=1/0;for(let d of a)l=Math.min(l,d.z);return l}}function A6(u,a,l,d,p,h,_,x){let C=_*p.getElevationAt(u,a,!0,!0),M=h[0]!==0,v=M?h[1]===0?_*(h[0]/7-450):_*function(S,A,D){let I=Math.floor(A[0]/8),O=Math.floor(A[1]/8),z=10*(A[0]-8*I),B=10*(A[1]-8*O),G=S.getElevationAt(I,O,!0,!0),$=S.getMeterToDEM(D),H=Math.floor(.5*(z*$-1)),K=Math.floor(.5*(B*$-1)),ee=S.tileCoordToPixel(I,O),ne=2*H+1,ve=2*K+1,pe=function(Ue,Ye,Ze,rt,Je){return[Ue.getElevationAtPixel(Ye,Ze,!0),Ue.getElevationAtPixel(Ye+Je,Ze,!0),Ue.getElevationAtPixel(Ye,Ze+Je,!0),Ue.getElevationAtPixel(Ye+rt,Ze+Je,!0)]}(S,ee.x-H,ee.y-K,ne,ve),fe=Math.abs(pe[0]-pe[1]),Fe=Math.abs(pe[2]-pe[3]),be=Math.abs(pe[0]-pe[2])+Math.abs(pe[1]-pe[3]),Be=Math.min(.25,.5*$*(fe+Fe)/ne),$e=Math.min(.25,.5*$*be/ve);return G+Math.max(Be*z,$e*B)}(p,h,x):C;return{base:C+(l===0?-1:l),top:M?Math.max(v+d,C+l+2):C+d}}ii(XE,"FillExtrusionBucket",{omit:["layers","features"]}),ii(g6,"PartData"),ii(m6,"FootprintSegment"),ii(_6,"BorderCentroidData"),ii(v6,"GroundEffect");let AX=Jn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),RX=Jn([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:kX}=AX,OX=Jn([{name:"a_packed",components:3,type:"Float32"}]),{members:PX}=OX,NX=Jn([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:LX}=NX;class R6{constructor(a,l){this.width=a,this.height=l,this.nextRow=0,this.image=new Df({width:a,height:l}),this.positions={},this.uploaded=!1}getDash(a,l){let d=this.getKey(a,l);return this.positions[d]}trim(){let a=this.width,l=this.height=Jd(this.nextRow);this.image.resize({width:a,height:l})}getKey(a,l){return a.join(",")+l}getDashRanges(a,l,d){let p=[],h=a.length%2==1?-a[a.length-1]*d:0,_=a[0]*d,x=!0;p.push({left:h,right:_,isDash:x,zeroLength:a[0]===0});let C=a[0];for(let M=1;M<a.length;M++){x=!x;let v=a[M];h=C*d,C+=v,_=C*d,p.push({left:h,right:_,isDash:x,zeroLength:v===0})}return p}addRoundDash(a,l,d){let p=l/2;for(let h=-d;h<=d;h++){let _=this.width*(this.nextRow+d+h),x=0,C=a[x];for(let M=0;M<this.width;M++){M/C.right>1&&(C=a[++x]);let v=Math.abs(M-C.left),S=Math.abs(M-C.right),A=Math.min(v,S),D,I=h/d*(p+1);if(C.isDash){let O=p-Math.abs(I);D=Math.sqrt(A*A+O*O)}else D=p-Math.sqrt(A*A+I*I);this.image.data[_+M]=Math.max(0,Math.min(255,D+128))}}}addRegularDash(a,l){for(let C=a.length-1;C>=0;--C){let M=a[C],v=a[C+1];M.zeroLength?a.splice(C,1):v&&v.isDash===M.isDash&&(v.left=M.left,a.splice(C,1))}let d=a[0],p=a[a.length-1];d.isDash===p.isDash&&(d.left=p.left-this.width,p.right=d.right+this.width);let h=this.width*this.nextRow,_=0,x=a[_];for(let C=0;C<this.width;C++){C/x.right>1&&(x=a[++_]);let M=Math.abs(C-x.left),v=Math.abs(C-x.right),S=Math.min(M,v);this.image.data[h+C]=Math.max(0,Math.min(255,(x.isDash?S:-S)+l+128))}}addDash(a,l){let d=this.getKey(a,l);if(this.positions[d])return this.positions[d];let p=l==="round",h=p?7:0,_=2*h+1;if(this.nextRow+_>this.height)return Gt("LineAtlas out of space"),null;a.length===0&&a.push(1);let x=0;for(let v=0;v<a.length;v++)a[v]<0&&(Gt("Negative value is found in line dasharray, replacing values with 0"),a[v]=0),x+=a[v];if(x!==0){let v=this.width/x,S=this.getDashRanges(a,this.width,v);p?this.addRoundDash(S,v,h):this.addRegularDash(S,l==="square"?.5*v:0)}let C=this.nextRow+h;this.nextRow+=_;let M={tl:[C,h],br:[x,0]};return this.positions[d]=M,M}}ii(R6,"LineAtlas");let FX=Mf.VectorTileFeature.types,zX=Math.cos(Math.PI/180*37.5),BX=Math.cos(Math.PI/180*5);class sA{constructor(a){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=a.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=a.overscaling,this.pixelRatio=a.pixelRatio,this.layers=a.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=a.index,this.projection=a.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new xb,this.layoutVertexArray2=new Zc,this.patternVertexArray=new Zc,this.indexArray=new Ra,this.programConfigurations=new yh(a.layers,{zoom:a.zoom,lut:a.lut}),this.segments=new Zr,this.maxLineLength=0,this.zOffsetVertexArray=new Zc,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.tessellationStep=a.tessellationStep?a.tessellationStep:$t/64}updateFootprints(a,l){}populate(a,l,d,p){this.hasPattern=WI("line",this.layers,this.pixelRatio,l);let h=this.layers[0].layout.get("line-sort-key");this.tileToMeter=m(d);let _=this.layers[0].layout.get("line-z-offset"),x=_.isConstant()&&!_.constantOr(0),C=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset=C==="sea"||C==="ground"||!x&&C==="none",this.hasZOffset&&C==="none"&&Gt(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);let M=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&M!==void 0;let v=[];for(let{feature:I,id:O,index:z,sourceLayerIndex:B}of a){let G=this.layers[0]._featureFilter.needGeometry,$=F(I,G);if(!this.layers[0]._featureFilter.filter(new Ar(this.zoom),$,d))continue;let H=h?h.evaluate($,{},d):void 0,K={id:O,properties:I.properties,type:I.type,sourceLayerIndex:B,index:z,geometry:G?$.geometry:L(I,d,p),patterns:{},sortKey:H};v.push(K)}h&&v.sort((I,O)=>I.sortKey-O.sortKey);let{lineAtlas:S,featureIndex:A}=l,D=this.addConstantDashes(S);for(let I of v){let{geometry:O,index:z,sourceLayerIndex:B}=I;if(D&&this.addFeatureDashes(I,S),this.hasPattern){let G=ZI("line",this.layers,I,this.zoom,this.pixelRatio,l);this.patternFeatures.push(G)}else this.addFeature(I,O,z,d,S.positions,l.availableImages,l.brightness);A.insert(a[z].feature,O,z,B,this.index)}}addConstantDashes(a){let l=!1;for(let d of this.layers){let p=d.paint.get("line-dasharray").value,h=d.layout.get("line-cap").value;if(p.kind!=="constant"||h.kind!=="constant")l=!0;else{let _=h.value,x=p.value;if(!x)continue;a.addDash(x,_)}}return l}addFeatureDashes(a,l){let d=this.zoom;for(let p of this.layers){let h=p.paint.get("line-dasharray").value,_=p.layout.get("line-cap").value;if(h.kind==="constant"&&_.kind==="constant")continue;let x,C;if(h.kind==="constant"){if(x=h.value,!x)continue}else x=h.evaluate({zoom:d},a);C=_.kind==="constant"?_.value:_.evaluate({zoom:d},a),l.addDash(x,C),a.patterns[p.id]=l.getKey(x,C)}}update(a,l,d,p,h,_,x){this.programConfigurations.updatePaintArrays(a,l,h,d,p,_,x)}addFeatures(a,l,d,p,h,_){for(let x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,l,d,p,_)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,PX)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=a.createVertexBuffer(this.patternVertexArray,LX)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=a.createVertexBuffer(this.zOffsetVertexArray,RX.members,!0)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,kX),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&a.properties.hasOwnProperty("mapbox_clip_start")&&a.properties.hasOwnProperty("mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,l,d,p,h,_,x){let C=this.layers[0].layout,M=C.get("line-join").evaluate(a,{}),v=C.get("line-cap").evaluate(a,{}),S=C.get("line-miter-limit"),A=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(a),this.lineFeature=a,this.zOffsetValue=C.get("line-z-offset").value;let D=this.layers[0].paint.get("line-width").value;D.kind!=="constant"&&D.isLineProgressConstant===!1&&(this.variableWidthValue=D);for(let I of l)this.addLine(I,a,p,M,v,S,A);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,d,h,_,p,x)}addLine(a,l,d,p,h,_,x){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;let C=p==="none";if(this.patternJoinNone=this.hasPattern&&C,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let $=0;$<a.length-1;$++)this.totalDistance+=a[$].dist(a[$+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let M=FX[l.type]==="Polygon",v=a.length;for(;v>=2&&a[v-1].equals(a[v-2]);)v--;let S=0;for(;S<v-1&&a[S].equals(a[S+1]);)S++;if(v<(M?3:2))return;p==="bevel"&&(_=1.05);let A=this.segments.prepareSegment(10*v,this.layoutVertexArray,this.indexArray),D,I,O,z,B,G;this.e1=this.e2=-1,M&&(D=a[v-2],B=a[S].sub(D)._unit()._perp());for(let $=S;$<v;$++){if(O=$===v-1?M?a[S+1]:void 0:a[$+1],O&&a[$].equals(O))continue;B&&(z=B),D&&(I=D),D=a[$],G=this.evaluateLineProgressFeatures(I?I.dist(D):0),B=O?O.sub(D)._unit()._perp():z,z=z||B;let H=I&&O,K=H?p:M||C?"butt":h,ee=z.x*B.x+z.y*B.y;if(C){let $e=function(Ue){if(Ue.patternJoinNone){let Ye=Ue.segmentPoints.length/2,Ze=Ue.lineSoFar-Ue.segmentStart;for(let rt=0;rt<Ye;++rt){let Je=Ue.segmentPoints[2*rt+1],ot=Math.round(Ue.segmentPoints[2*rt])+.5+.25*Je;Ue.patternVertexArray.emplaceBack(ot,Ze,Ue.segmentStart),Ue.patternVertexArray.emplaceBack(ot,Ze,Ue.segmentStart)}Ue.segmentPoints.length=0}Ue.e1=Ue.e2=-1};if(H&&ee<BX){this.updateDistance(I,D),this.addCurrentVertex(D,z,1,1,A,G),$e(this),this.addCurrentVertex(D,B,-1,-1,A,G);continue}if(I){if(!O){this.updateDistance(I,D),this.addCurrentVertex(D,z,1,1,A,G),$e(this);continue}K="miter"}}let ne=z.add(B);ne.x===0&&ne.y===0||ne._unit();let ve=ne.x*B.x+ne.y*B.y,pe=ve!==0?1/ve:1/0,fe=2*Math.sqrt(2-2*ve),Fe=ve<zX&&I&&O,be=z.x*B.y-z.y*B.x>0,Be=this.overscaling<=16?15*$t/(512*this.overscaling):0;if(H&&K==="round"){if(pe<x)K="miter";else if(pe<=2){let $e=lA(D,-10,$t+10);K=this.hasZOffset&&($e||this.hasCrossSlope)?"miter":"fakeround"}}if(K==="miter"&&pe>_&&(K="bevel"),K==="bevel"&&(pe>2&&(K="flipbevel"),pe<_&&(K="miter")),I&&!(K==="miter"&&Fe)&&this.updateDistance(I,D),K==="miter")if(Fe){let $e=D.dist(I);if($e>2*Be){let Ye=D.sub(D.sub(I)._mult(Be/$e)._round());this.updateDistance(I,Ye),this.addCurrentVertex(Ye,z,0,0,A,G),I=Ye}this.updateDistance(I,D),ne._mult(pe),this.addCurrentVertex(D,ne,0,0,A,G);let Ue=D.dist(O);if(Ue>2*Be){let Ye=D.add(O.sub(D)._mult(Be/Ue)._round());this.updateDistance(D,Ye),this.addCurrentVertex(Ye,B,0,0,A,G),D=Ye}}else ne._mult(pe),this.addCurrentVertex(D,ne,0,0,A,G);else if(K==="flipbevel"){if(pe>100)ne=B.mult(-1);else{let $e=pe*z.add(B).mag()/z.sub(B).mag();ne._perp()._mult($e*(be?-1:1))}this.addCurrentVertex(D,ne,0,0,A,G),this.addCurrentVertex(D,ne.mult(-1),0,0,A,G)}else if(K==="bevel"||K==="fakeround"){G!=null&&I&&this.addCurrentVertex(D,z,-1,-1,A,G);let $e=D.dist(I)<=2*Be&&K!=="bevel",Ue=ne.mult(be?1:-1);Ue._mult(pe);let Ye=B.mult(be?-1:1),Ze=z.mult(be?-1:1),rt=this.evaluateLineProgressFeatures(this.distance);if(G==null&&(this.addHalfVertex(D,Ue.x,Ue.y,!1,!be,0,A,rt),$e||this.addHalfVertex(D,Ue.x+2*Ze.x,Ue.y+2*Ze.y,!1,be,0,A,rt)),K==="fakeround"){let Je=Math.round(180*fe/Math.PI/20);this.addHalfVertex(D,Ze.x,Ze.y,!1,be,0,A,rt);for(let ot=0;ot<Je;ot++){let kt=ot/Je;if(kt!==.5){let ni=kt-.5;kt+=kt*ni*(kt-1)*((1.0904+ee*(ee*(3.55645-1.43519*ee)-3.2452))*ni*ni+(.848013+ee*(.215638*ee-1.06021)))}let Mt=Ye.sub(Ze)._mult(kt)._add(Ze)._unit();this.addHalfVertex(D,Mt.x,Mt.y,!1,be,0,A,rt)}this.addHalfVertex(D,Ye.x,Ye.y,!1,be,0,A,rt)}$e||G!=null||this.addHalfVertex(D,Ue.x+2*Ye.x,Ue.y+2*Ye.y,!1,be,0,A,rt),G!=null&&O&&this.addCurrentVertex(D,B,1,1,A,G)}else K==="butt"?this.addCurrentVertex(D,ne,0,0,A,G):K==="square"?(I||this.addCurrentVertex(D,ne,-1,-1,A,G),this.addCurrentVertex(D,ne,0,0,A,G),I&&this.addCurrentVertex(D,ne,1,1,A,G)):K==="round"&&(I&&(this.addCurrentVertex(D,z,0,0,A,G),this.addCurrentVertex(D,z,1,1,A,G,!0)),O&&(this.addCurrentVertex(D,B,-1,-1,A,G,!0),this.addCurrentVertex(D,B,0,0,A,G)))}}addVerticesTo(a,l,d,p,h,_,x,C,M,v){let S=(l.w-a.w)/this.tessellationStep|0,A=0,D=this.scaledDistance;if(S>1){this.lineSoFar=a.w;let O=(l.x-a.x)/S,z=(l.y-a.y)/S,B=(l.z-a.z)/S,G=(l.w-a.w)/S;for(let $=1;$<S;++$){a.x+=O,a.y+=z,a.z+=B,this.lineSoFar+=G,A+=G;let H=this.evaluateLineProgressFeatures(this.prevDistance+A);this.scaledDistance=(this.prevDistance+A)/this.totalDistance,this.addHalfVertex(a,d,p,v,!1,x,M,H),this.addHalfVertex(a,h,_,v,!0,-C,M,H)}}this.lineSoFar=l.w,this.scaledDistance=D;let I=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(l,d,p,v,!1,x,M,I),this.addHalfVertex(l,h,_,v,!0,-C,M,I)}evaluateLineProgressFeatures(a){if(!this.variableWidthValue&&!this.hasZOffset)return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+a)/this.totalFeatureLength):Gt(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let l=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(l=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.hasZOffset?this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:l}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:l}:{zOffset:0,variableWidth:l}}addCurrentVertex(a,l,d,p,h,_,x=!1){let C=l.x+l.y*d,M=l.y-l.x*d,v=l.y*p-l.x,S=-l.y-l.x*p;if(_!=null){let A=this.hasZOffset,D=-10,I=$t+10,O=_.zOffset,z=new n6(a.x,a.y,O,this.lineSoFar),B=!!A&&lA(a,D,I),G=this.lineSoFar,$=this.distance;if(this.currentVertex)if(B){let H=this.currentVertexIsOutside,K=this.currentVertex,ee=new n6(a.x,a.y,O,this.lineSoFar);if(o6(K,ee,D,I),!lA(ee,D,I)){if(H){this.e1=this.e2=-1,this.distance-=K.dist(z),this.lineSoFar=K.w;let ne=this.evaluateLineProgressFeatures(K.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(K,C,M,x,!1,d,h,ne),this.addHalfVertex(K,v,S,x,!0,-p,h,ne),this.prevDistance=this.distance}this.distance=this.prevDistance+K.dist(ee),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(K,ee,C,M,v,S,d,p,h,x),this.distance=$,this.scaledDistance=this.distance/this.totalDistance}}else{let H=this.currentVertex;if(this.currentVertexIsOutside){o6(H,z,D,I),this.e1=this.e2=-1,this.distance-=H.dist(z),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=H.w;let K=this.evaluateLineProgressFeatures(H.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(H,C,M,x,!1,d,h,K),this.addHalfVertex(H,v,S,x,!0,-p,h,K),this.prevDistance=this.distance,this.distance=$,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(H,z,C,M,v,S,d,p,h,x)}else B||(this.addHalfVertex(a,C,M,x,!1,d,h,_),this.addHalfVertex(a,v,S,x,!0,-p,h,_));this.currentVertex=z,this.currentVertexIsOutside=B,this.lineSoFar=G}else this.addHalfVertex(a,C,M,x,!1,d,h,_),this.addHalfVertex(a,v,S,x,!0,-p,h,_)}addHalfVertex({x:a,y:l},d,p,h,_,x,C,M){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),_||this.segmentPoints.push(this.lineSoFar-this.segmentStart,x)),this.layoutVertexArray.emplaceBack((a<<1)+(h?1:0),(l<<1)+(_?1:0),Math.round(63*d)+128,Math.round(63*p)+128,1+(x===0?0:x<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){let S=pi(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,S)}let v=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,v),C.primitiveLength++),_?this.e2=v:this.e1=v,M!=null&&this.zOffsetVertexArray.emplaceBack(M.zOffset,M.variableWidth,M.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(a,l){this.prevDistance=this.distance,this.distance+=a.dist(l),this.updateScaledDistance()}}function lA(u,a,l){return u.x<a||u.x>l||u.y<a||u.y>l}let k6,O6;function P6(u,a,l){return a*($t/(u.tileSize*Math.pow(2,l-u.tileID.overscaledZ)))}ii(sA,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});let N6=(u,a,l)=>(1-l)*u+l*a;function L6(u,a){return 1/P6(u,1,a.tileZoom)}function F6(u,a,l,d){return u.translatePosMatrix(d||a.tileID.projMatrix,a,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}let z6=u=>{let a=[];B6(u)&&a.push("RENDER_LINE_DASH"),u.paint.get("line-gradient")&&a.push("RENDER_LINE_GRADIENT");let l=u.paint.get("line-trim-offset");l[0]===0&&l[1]===0||a.push("RENDER_LINE_TRIM_OFFSET"),u.paint.get("line-border-width").constantOr(1)!==0&&a.push("RENDER_LINE_BORDER");let d=u.layout.get("line-join").constantOr("miter")==="none",p=!!u.paint.get("line-pattern").constantOr(1);return d&&p&&a.push("LINE_JOIN_NONE"),a};function B6(u){let a=u.paint.get("line-dasharray").value;return a.value||a.kind!=="constant"}let cA,V6=()=>cA||(cA={layout:k6||(k6=new no({"line-cap":new ti(lt.layout_line["line-cap"]),"line-join":new ti(lt.layout_line["line-join"]),"line-miter-limit":new Ht(lt.layout_line["line-miter-limit"]),"line-round-limit":new Ht(lt.layout_line["line-round-limit"]),"line-sort-key":new ti(lt.layout_line["line-sort-key"]),"line-z-offset":new ti(lt.layout_line["line-z-offset"]),"line-elevation-reference":new Ht(lt.layout_line["line-elevation-reference"]),"line-cross-slope":new Ht(lt.layout_line["line-cross-slope"]),visibility:new Ht(lt.layout_line.visibility),"line-width-unit":new Ht(lt.layout_line["line-width-unit"])})),paint:O6||(O6=new no({"line-opacity":new ti(lt.paint_line["line-opacity"]),"line-color":new ti(lt.paint_line["line-color"]),"line-translate":new Ht(lt.paint_line["line-translate"]),"line-translate-anchor":new Ht(lt.paint_line["line-translate-anchor"]),"line-width":new ti(lt.paint_line["line-width"]),"line-gap-width":new ti(lt.paint_line["line-gap-width"]),"line-offset":new ti(lt.paint_line["line-offset"]),"line-blur":new ti(lt.paint_line["line-blur"]),"line-dasharray":new ti(lt.paint_line["line-dasharray"]),"line-pattern":new ti(lt.paint_line["line-pattern"]),"line-gradient":new _f(lt.paint_line["line-gradient"]),"line-trim-offset":new Ht(lt.paint_line["line-trim-offset"]),"line-trim-fade-range":new Ht(lt.paint_line["line-trim-fade-range"]),"line-trim-color":new Ht(lt.paint_line["line-trim-color"]),"line-emissive-strength":new Ht(lt.paint_line["line-emissive-strength"]),"line-border-width":new ti(lt.paint_line["line-border-width"]),"line-border-color":new ti(lt.paint_line["line-border-color"]),"line-occlusion-opacity":new Ht(lt.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"})}))},cA);class VX extends ti{possiblyEvaluate(a,l){return l=new Ar(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,transition:l.transition}),super.possiblyEvaluate(a,l)}evaluate(a,l,d,p){return l=Da({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(a,l,d,p)}}let Kb;function j6(u,a){return a>0?a+2*u:u}let jX=Jn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),UX=Jn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),HX=Jn([{name:"a_projected_pos",components:4,type:"Float32"}],4);Jn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);let qX=Jn([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),$X=Jn([{name:"a_texb",components:2,type:"Uint16"}]),GX=Jn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),WX=Jn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Jn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);let U6=Jn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ZX=Jn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Jn([{name:"triangle",components:3,type:"Uint16"}]),Jn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Jn([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),Jn([{type:"Float32",name:"offsetX"}]),Jn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Wa=24;let vd=128;function H6(u,a,l,d,p){if(u.kind==="camera")return u.maxSize;if(u.kind==="composite"){let h=a.possiblyEvaluate(new Ar(u.maxZoom),l).evaluate(p,{},l),_=a.possiblyEvaluate(new Ar(u.minZoom),l).evaluate(p,{},l);return Math.max(h,_)}return a.possiblyEvaluate(new Ar(d)).evaluate(p,{},l)}function uA(u,a){let{expression:l}=a;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new Ar(u+1))};if(l.kind==="source")return{kind:"source"};{let{zoomStops:d,interpolationType:p}=l,h=0;for(;h<d.length&&d[h]<=u;)h++;h=Math.max(0,h-1);let _=h;for(;_<d.length&&d[_]<u+1;)_++;_=Math.min(d.length-1,_);let x=d[h],C=d[_];return l.kind==="composite"?{kind:"composite",minZoom:x,maxZoom:C,interpolationType:p}:{kind:"camera",minZoom:x,maxZoom:C,minSize:l.evaluate(new Ar(x)),maxSize:l.evaluate(new Ar(C)),interpolationType:p}}}function QE(u,{uSize:a,uSizeT:l},{lowerSize:d,upperSize:p}){return u.kind==="source"?d/vd:u.kind==="composite"?pi(d/vd,p/vd,l):a}function N_(u,a,l=1){let d=0,p=0;if(u.kind==="constant")p=u.layoutSize*l;else if(u.kind!=="source"){let{interpolationType:h,minZoom:_,maxZoom:x}=u,C=h?pn($s.interpolationFactor(h,a,_,x),0,1):0;u.kind==="camera"?p=pi(u.minSize,u.maxSize,C)*l:d=C*l}return{uSizeT:d,uSize:p}}var YX=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:vd,evaluateSizeForFeature:QE,evaluateSizeForZoom:N_,getRasterizedIconSize:H6,getSizeData:uA});function KX(u,a,l){return u.sections.forEach(d=>{d.text=function(p,h,_){let x=h.layout.get("text-transform").evaluate(_,{});return x==="uppercase"?p=p.toLocaleUpperCase():x==="lowercase"&&(p=p.toLocaleLowerCase()),lc.applyArabicShaping&&(p=lc.applyArabicShaping(p)),p}(d.text,a,l)}),u}let Xb={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42","\u2190":"\u2191","\u2192":"\u2193"};function XX(u){return u==="\uFE36"||u==="\uFE48"||u==="\uFE38"||u==="\uFE44"||u==="\uFE42"||u==="\uFE3E"||u==="\uFE3C"||u==="\uFE3A"||u==="\uFE18"||u==="\uFE40"||u==="\uFE10"||u==="\uFE13"||u==="\uFE14"||u==="\uFF40"||u==="\uFFE3"||u==="\uFE11"||u==="\uFE12"}function QX(u){return u==="\uFE35"||u==="\uFE47"||u==="\uFE37"||u==="\uFE43"||u==="\uFE41"||u==="\uFE3D"||u==="\uFE3B"||u==="\uFE39"||u==="\uFE17"||u==="\uFE3F"}var q6,dA,$6,hA={};function JX(){return q6||(q6=1,hA.read=function(u,a,l,d,p){var h,_,x=8*p-d-1,C=(1<<x)-1,M=C>>1,v=-7,S=l?p-1:0,A=l?-1:1,D=u[a+S];for(S+=A,h=D&(1<<-v)-1,D>>=-v,v+=x;v>0;h=256*h+u[a+S],S+=A,v-=8);for(_=h&(1<<-v)-1,h>>=-v,v+=d;v>0;_=256*_+u[a+S],S+=A,v-=8);if(h===0)h=1-M;else{if(h===C)return _?NaN:1/0*(D?-1:1);_+=Math.pow(2,d),h-=M}return(D?-1:1)*_*Math.pow(2,h-d)},hA.write=function(u,a,l,d,p,h){var _,x,C,M=8*h-p-1,v=(1<<M)-1,S=v>>1,A=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,D=d?0:h-1,I=d?1:-1,O=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(x=isNaN(a)?1:0,_=v):(_=Math.floor(Math.log(a)/Math.LN2),a*(C=Math.pow(2,-_))<1&&(_--,C*=2),(a+=_+S>=1?A/C:A*Math.pow(2,1-S))*C>=2&&(_++,C/=2),_+S>=v?(x=0,_=v):_+S>=1?(x=(a*C-1)*Math.pow(2,p),_+=S):(x=a*Math.pow(2,S-1)*Math.pow(2,p),_=0));p>=8;u[l+D]=255&x,D+=I,x/=256,p-=8);for(_=_<<p|x,M+=p;M>0;u[l+D]=255&_,D+=I,_/=256,M-=8);u[l+D-I]|=128*O}),hA}function G6(){if($6)return dA;$6=1,dA=a;var u=JX();function a(H){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(H)?H:new Uint8Array(H||0),this.pos=0,this.type=0,this.length=this.buf.length}a.Varint=0,a.Fixed64=1,a.Bytes=2,a.Fixed32=5;var l=4294967296,d=1/l,p=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function h(H){return H.type===a.Bytes?H.readVarint()+H.pos:H.pos+1}function _(H,K,ee){return ee?4294967296*K+(H>>>0):4294967296*(K>>>0)+(H>>>0)}function x(H,K,ee){var ne=K<=16383?1:K<=2097151?2:K<=268435455?3:Math.floor(Math.log(K)/(7*Math.LN2));ee.realloc(ne);for(var ve=ee.pos-1;ve>=H;ve--)ee.buf[ve+ne]=ee.buf[ve]}function C(H,K){for(var ee=0;ee<H.length;ee++)K.writeVarint(H[ee])}function M(H,K){for(var ee=0;ee<H.length;ee++)K.writeSVarint(H[ee])}function v(H,K){for(var ee=0;ee<H.length;ee++)K.writeFloat(H[ee])}function S(H,K){for(var ee=0;ee<H.length;ee++)K.writeDouble(H[ee])}function A(H,K){for(var ee=0;ee<H.length;ee++)K.writeBoolean(H[ee])}function D(H,K){for(var ee=0;ee<H.length;ee++)K.writeFixed32(H[ee])}function I(H,K){for(var ee=0;ee<H.length;ee++)K.writeSFixed32(H[ee])}function O(H,K){for(var ee=0;ee<H.length;ee++)K.writeFixed64(H[ee])}function z(H,K){for(var ee=0;ee<H.length;ee++)K.writeSFixed64(H[ee])}function B(H,K){return(H[K]|H[K+1]<<8|H[K+2]<<16)+16777216*H[K+3]}function G(H,K,ee){H[ee]=K,H[ee+1]=K>>>8,H[ee+2]=K>>>16,H[ee+3]=K>>>24}function $(H,K){return(H[K]|H[K+1]<<8|H[K+2]<<16)+(H[K+3]<<24)}return a.prototype={destroy:function(){this.buf=null},readFields:function(H,K,ee){for(ee=ee||this.length;this.pos<ee;){var ne=this.readVarint(),ve=ne>>3,pe=this.pos;this.type=7&ne,H(ve,K,this),this.pos===pe&&this.skip(ne)}return K},readMessage:function(H,K){return this.readFields(H,K,this.readVarint()+this.pos)},readFixed32:function(){var H=B(this.buf,this.pos);return this.pos+=4,H},readSFixed32:function(){var H=$(this.buf,this.pos);return this.pos+=4,H},readFixed64:function(){var H=B(this.buf,this.pos)+B(this.buf,this.pos+4)*l;return this.pos+=8,H},readSFixed64:function(){var H=B(this.buf,this.pos)+$(this.buf,this.pos+4)*l;return this.pos+=8,H},readFloat:function(){var H=u.read(this.buf,this.pos,!0,23,4);return this.pos+=4,H},readDouble:function(){var H=u.read(this.buf,this.pos,!0,52,8);return this.pos+=8,H},readVarint:function(H){var K,ee,ne=this.buf;return K=127&(ee=ne[this.pos++]),ee<128?K:(K|=(127&(ee=ne[this.pos++]))<<7,ee<128?K:(K|=(127&(ee=ne[this.pos++]))<<14,ee<128?K:(K|=(127&(ee=ne[this.pos++]))<<21,ee<128?K:function(ve,pe,fe){var Fe,be,Be=fe.buf;if(Fe=(112&(be=Be[fe.pos++]))>>4,be<128||(Fe|=(127&(be=Be[fe.pos++]))<<3,be<128)||(Fe|=(127&(be=Be[fe.pos++]))<<10,be<128)||(Fe|=(127&(be=Be[fe.pos++]))<<17,be<128)||(Fe|=(127&(be=Be[fe.pos++]))<<24,be<128)||(Fe|=(1&(be=Be[fe.pos++]))<<31,be<128))return _(ve,Fe,pe);throw new Error("Expected varint not more than 10 bytes")}(K|=(15&(ee=ne[this.pos]))<<28,H,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var H=this.readVarint();return H%2==1?(H+1)/-2:H/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var H=this.readVarint()+this.pos,K=this.pos;return this.pos=H,H-K>=12&&p?function(ee,ne,ve){return p.decode(ee.subarray(ne,ve))}(this.buf,K,H):function(ee,ne,ve){for(var pe="",fe=ne;fe<ve;){var Fe,be,Be,$e=ee[fe],Ue=null,Ye=$e>239?4:$e>223?3:$e>191?2:1;if(fe+Ye>ve)break;Ye===1?$e<128&&(Ue=$e):Ye===2?(192&(Fe=ee[fe+1]))==128&&(Ue=(31&$e)<<6|63&Fe)<=127&&(Ue=null):Ye===3?(be=ee[fe+2],(192&(Fe=ee[fe+1]))==128&&(192&be)==128&&((Ue=(15&$e)<<12|(63&Fe)<<6|63&be)<=2047||Ue>=55296&&Ue<=57343)&&(Ue=null)):Ye===4&&(be=ee[fe+2],Be=ee[fe+3],(192&(Fe=ee[fe+1]))==128&&(192&be)==128&&(192&Be)==128&&((Ue=(15&$e)<<18|(63&Fe)<<12|(63&be)<<6|63&Be)<=65535||Ue>=1114112)&&(Ue=null)),Ue===null?(Ue=65533,Ye=1):Ue>65535&&(Ue-=65536,pe+=String.fromCharCode(Ue>>>10&1023|55296),Ue=56320|1023&Ue),pe+=String.fromCharCode(Ue),fe+=Ye}return pe}(this.buf,K,H)},readBytes:function(){var H=this.readVarint()+this.pos,K=this.buf.subarray(this.pos,H);return this.pos=H,K},readPackedVarint:function(H,K){if(this.type!==a.Bytes)return H.push(this.readVarint(K));var ee=h(this);for(H=H||[];this.pos<ee;)H.push(this.readVarint(K));return H},readPackedSVarint:function(H){if(this.type!==a.Bytes)return H.push(this.readSVarint());var K=h(this);for(H=H||[];this.pos<K;)H.push(this.readSVarint());return H},readPackedBoolean:function(H){if(this.type!==a.Bytes)return H.push(this.readBoolean());var K=h(this);for(H=H||[];this.pos<K;)H.push(this.readBoolean());return H},readPackedFloat:function(H){if(this.type!==a.Bytes)return H.push(this.readFloat());var K=h(this);for(H=H||[];this.pos<K;)H.push(this.readFloat());return H},readPackedDouble:function(H){if(this.type!==a.Bytes)return H.push(this.readDouble());var K=h(this);for(H=H||[];this.pos<K;)H.push(this.readDouble());return H},readPackedFixed32:function(H){if(this.type!==a.Bytes)return H.push(this.readFixed32());var K=h(this);for(H=H||[];this.pos<K;)H.push(this.readFixed32());return H},readPackedSFixed32:function(H){if(this.type!==a.Bytes)return H.push(this.readSFixed32());var K=h(this);for(H=H||[];this.pos<K;)H.push(this.readSFixed32());return H},readPackedFixed64:function(H){if(this.type!==a.Bytes)return H.push(this.readFixed64());var K=h(this);for(H=H||[];this.pos<K;)H.push(this.readFixed64());return H},readPackedSFixed64:function(H){if(this.type!==a.Bytes)return H.push(this.readSFixed64());var K=h(this);for(H=H||[];this.pos<K;)H.push(this.readSFixed64());return H},skip:function(H){var K=7&H;if(K===a.Varint)for(;this.buf[this.pos++]>127;);else if(K===a.Bytes)this.pos=this.readVarint()+this.pos;else if(K===a.Fixed32)this.pos+=4;else{if(K!==a.Fixed64)throw new Error("Unimplemented type: "+K);this.pos+=8}},writeTag:function(H,K){this.writeVarint(H<<3|K)},realloc:function(H){for(var K=this.length||16;K<this.pos+H;)K*=2;if(K!==this.length){var ee=new Uint8Array(K);ee.set(this.buf),this.buf=ee,this.length=K}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(H){this.realloc(4),G(this.buf,H,this.pos),this.pos+=4},writeSFixed32:function(H){this.realloc(4),G(this.buf,H,this.pos),this.pos+=4},writeFixed64:function(H){this.realloc(8),G(this.buf,-1&H,this.pos),G(this.buf,Math.floor(H*d),this.pos+4),this.pos+=8},writeSFixed64:function(H){this.realloc(8),G(this.buf,-1&H,this.pos),G(this.buf,Math.floor(H*d),this.pos+4),this.pos+=8},writeVarint:function(H){(H=+H||0)>268435455||H<0?function(K,ee){var ne,ve;if(K>=0?(ne=K%4294967296|0,ve=K/4294967296|0):(ve=~(-K/4294967296),4294967295^(ne=~(-K%4294967296))?ne=ne+1|0:(ne=0,ve=ve+1|0)),K>=18446744073709552e3||K<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ee.realloc(10),function(pe,fe,Fe){Fe.buf[Fe.pos++]=127&pe|128,pe>>>=7,Fe.buf[Fe.pos++]=127&pe|128,pe>>>=7,Fe.buf[Fe.pos++]=127&pe|128,pe>>>=7,Fe.buf[Fe.pos++]=127&pe|128,Fe.buf[Fe.pos]=127&(pe>>>=7)}(ne,0,ee),function(pe,fe){var Fe=(7&pe)<<4;fe.buf[fe.pos++]|=Fe|((pe>>>=3)?128:0),pe&&(fe.buf[fe.pos++]=127&pe|((pe>>>=7)?128:0),pe&&(fe.buf[fe.pos++]=127&pe|((pe>>>=7)?128:0),pe&&(fe.buf[fe.pos++]=127&pe|((pe>>>=7)?128:0),pe&&(fe.buf[fe.pos++]=127&pe|((pe>>>=7)?128:0),pe&&(fe.buf[fe.pos++]=127&pe)))))}(ve,ee)}(H,this):(this.realloc(4),this.buf[this.pos++]=127&H|(H>127?128:0),H<=127||(this.buf[this.pos++]=127&(H>>>=7)|(H>127?128:0),H<=127||(this.buf[this.pos++]=127&(H>>>=7)|(H>127?128:0),H<=127||(this.buf[this.pos++]=H>>>7&127))))},writeSVarint:function(H){this.writeVarint(H<0?2*-H-1:2*H)},writeBoolean:function(H){this.writeVarint(!!H)},writeString:function(H){H=String(H),this.realloc(4*H.length),this.pos++;var K=this.pos;this.pos=function(ne,ve,pe){for(var fe,Fe,be=0;be<ve.length;be++){if((fe=ve.charCodeAt(be))>55295&&fe<57344){if(!Fe){fe>56319||be+1===ve.length?(ne[pe++]=239,ne[pe++]=191,ne[pe++]=189):Fe=fe;continue}if(fe<56320){ne[pe++]=239,ne[pe++]=191,ne[pe++]=189,Fe=fe;continue}fe=Fe-55296<<10|fe-56320|65536,Fe=null}else Fe&&(ne[pe++]=239,ne[pe++]=191,ne[pe++]=189,Fe=null);fe<128?ne[pe++]=fe:(fe<2048?ne[pe++]=fe>>6|192:(fe<65536?ne[pe++]=fe>>12|224:(ne[pe++]=fe>>18|240,ne[pe++]=fe>>12&63|128),ne[pe++]=fe>>6&63|128),ne[pe++]=63&fe|128)}return pe}(this.buf,H,this.pos);var ee=this.pos-K;ee>=128&&x(K,ee,this),this.pos=K-1,this.writeVarint(ee),this.pos+=ee},writeFloat:function(H){this.realloc(4),u.write(this.buf,H,this.pos,!0,23,4),this.pos+=4},writeDouble:function(H){this.realloc(8),u.write(this.buf,H,this.pos,!0,52,8),this.pos+=8},writeBytes:function(H){var K=H.length;this.writeVarint(K),this.realloc(K);for(var ee=0;ee<K;ee++)this.buf[this.pos++]=H[ee]},writeRawMessage:function(H,K){this.pos++;var ee=this.pos;H(K,this);var ne=this.pos-ee;ne>=128&&x(ee,ne,this),this.pos=ee-1,this.writeVarint(ne),this.pos+=ne},writeMessage:function(H,K,ee){this.writeTag(H,a.Bytes),this.writeRawMessage(K,ee)},writePackedVarint:function(H,K){K.length&&this.writeMessage(H,C,K)},writePackedSVarint:function(H,K){K.length&&this.writeMessage(H,M,K)},writePackedBoolean:function(H,K){K.length&&this.writeMessage(H,A,K)},writePackedFloat:function(H,K){K.length&&this.writeMessage(H,v,K)},writePackedDouble:function(H,K){K.length&&this.writeMessage(H,S,K)},writePackedFixed32:function(H,K){K.length&&this.writeMessage(H,D,K)},writePackedSFixed32:function(H,K){K.length&&this.writeMessage(H,I,K)},writePackedFixed64:function(H,K){K.length&&this.writeMessage(H,O,K)},writePackedSFixed64:function(H,K){K.length&&this.writeMessage(H,z,K)},writeBytesField:function(H,K){this.writeTag(H,a.Bytes),this.writeBytes(K)},writeFixed32Field:function(H,K){this.writeTag(H,a.Fixed32),this.writeFixed32(K)},writeSFixed32Field:function(H,K){this.writeTag(H,a.Fixed32),this.writeSFixed32(K)},writeFixed64Field:function(H,K){this.writeTag(H,a.Fixed64),this.writeFixed64(K)},writeSFixed64Field:function(H,K){this.writeTag(H,a.Fixed64),this.writeSFixed64(K)},writeVarintField:function(H,K){this.writeTag(H,a.Varint),this.writeVarint(K)},writeSVarintField:function(H,K){this.writeTag(H,a.Varint),this.writeSVarint(K)},writeStringField:function(H,K){this.writeTag(H,a.Bytes),this.writeString(K)},writeFloatField:function(H,K){this.writeTag(H,a.Fixed32),this.writeFloat(K)},writeDoubleField:function(H,K){this.writeTag(H,a.Fixed64),this.writeDouble(K)},writeBooleanField:function(H,K){this.writeVarintField(H,!!K)}},dA}var JE=g(G6());let pA=3;function eQ(u,a,l){a.glyphs=[],u===1&&l.readMessage(tQ,a)}function tQ(u,a,l){if(u===3){let{id:d,bitmap:p,width:h,height:_,left:x,top:C,advance:M}=l.readMessage(iQ,{});a.glyphs.push({id:d,bitmap:new Df({width:h+2*pA,height:_+2*pA},p),metrics:{width:h,height:_,left:x,top:C,advance:M}})}else u===4?a.ascender=l.readSVarint():u===5&&(a.descender=l.readSVarint())}function iQ(u,a,l){u===1?a.id=l.readVarint():u===2?a.bitmap=l.readBytes():u===3?a.width=l.readVarint():u===4?a.height=l.readVarint():u===5?a.left=l.readSVarint():u===6?a.top=l.readSVarint():u===7&&(a.advance=l.readVarint())}let W6=pA,Vl={horizontal:1,vertical:2,horizontalOnly:3};class Qb{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(a,l){let d=new Qb;return d.scale=a||1,d.fontStack=l,d}static forImage(a){let l=new Qb;return l.image=a,l}}class L_{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,l,d){let p=new L_;for(let h=0;h<a.sections.length;h++){let _=a.sections[h];_.image?p.addImageSection(_,d):p.addTextSection(_,l)}return p}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSections(){return this.sections}getSectionIndex(a){return this.sectionIndex[a]}getCodePoint(a){return this.text.codePointAt(a)}verticalizePunctuation(a){this.text=function(l,d){let p="";for(let h=0;h<l.length;h++){let _=l.charCodeAt(h+1)||null,x=l.charCodeAt(h-1)||null;p+=!d&&(_&&cb(_)&&!Xb[l[h+1]]||x&&cb(x)&&!Xb[l[h-1]])||!Xb[l[h]]?l[h]:Xb[l[h]]}return p}(this.text,a)}trim(){let a=0;for(let d=0;d<this.text.length&&eC[this.text.charCodeAt(d)];d++)a++;let l=this.text.length;for(let d=this.text.length-1;d>=0&&d>=a&&eC[this.text.charCodeAt(d)];d--)l--;this.text=this.text.substring(a,l),this.sectionIndex=this.sectionIndex.slice(a,l)}substring(a,l){let d=new L_;return d.text=this.text.substring(a,l),d.sectionIndex=this.sectionIndex.slice(a,l),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,l)=>Math.max(a,this.sections[l].scale),0)}addTextSection(a,l){this.text+=a.text,this.sections.push(Qb.forText(a.scale,a.fontStack||l));let d=this.sections.length-1;for(let p=0;p<a.text.length;++p)this.sectionIndex.push(d)}addImageSection(a,l){let d=a.image?a.image.getPrimary():null;if(!d)return void Gt("Can't add FormattedSection with an empty image.");d.scaleSelf(l);let p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCodePoint(p),this.sections.push(Qb.forImage(d)),this.sectionIndex.push(this.sections.length-1)):Gt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function fA(u,a,l,d,p,h,_,x,C,M,v,S,A,D,I,O=1){let z=L_.fromFeature(u,p,O);S===Vl.vertical&&z.verticalizePunctuation(A);let B=[],G=function(ne,ve,pe,fe,Fe,be){if(!ne)return[];let Be=[],$e=function(rt,Je,ot,kt,Mt,ni){let Vt=0;for(let qt=0;qt<rt.length();qt++){let Lt=rt.getSection(qt);Vt+=Z6(rt.getCodePoint(qt),Lt,kt,Mt,Je,ni)}return Vt/Math.max(1,Math.ceil(Vt/ot))}(ne,ve,pe,fe,Fe,be),Ue=ne.text.indexOf("\u200B")>=0,Ye=0;for(let rt=0;rt<ne.length();rt++){let Je=ne.getSection(rt),ot=ne.getCodePoint(rt);if(eC[ot]||(Ye+=Z6(ot,Je,fe,Fe,ve,be)),rt<ne.length()-1){let kt=!((Ze=ot)<11904||!(Ii["Bopomofo Extended"](Ze)||Ii.Bopomofo(Ze)||Ii["CJK Compatibility Forms"](Ze)||Ii["CJK Compatibility Ideographs"](Ze)||Ii["CJK Compatibility"](Ze)||Ii["CJK Radicals Supplement"](Ze)||Ii["CJK Strokes"](Ze)||Ii["CJK Symbols and Punctuation"](Ze)||Ii["CJK Unified Ideographs Extension A"](Ze)||Ii["CJK Unified Ideographs"](Ze)||Ii["Enclosed CJK Letters and Months"](Ze)||Ii["Halfwidth and Fullwidth Forms"](Ze)||Ii.Hiragana(Ze)||Ii["Ideographic Description Characters"](Ze)||Ii["Kangxi Radicals"](Ze)||Ii["Katakana Phonetic Extensions"](Ze)||Ii.Katakana(Ze)||Ii["Vertical Forms"](Ze)||Ii["Yi Radicals"](Ze)||Ii["Yi Syllables"](Ze)));(nQ[ot]||kt||Je.image)&&Be.push(K6(rt+1,Ye,$e,Be,rQ(ot,ne.getCodePoint(rt+1),kt&&Ue),!1))}}var Ze;return X6(K6(ne.length(),Ye,$e,Be,0,!0))}(z,M,h,a,d,D),{processBidirectionalText:$,processStyledBidirectionalText:H}=lc;if($&&z.sections.length===1){let ne=$(z.toString(),G);for(let ve of ne){let pe=new L_;pe.text=ve,pe.sections=z.sections;for(let fe=0;fe<ve.length;fe++)pe.sectionIndex.push(0);B.push(pe)}}else if(H){let ne=H(z.text,z.sectionIndex,G);for(let ve of ne){let pe=new L_;pe.text=ve[0],pe.sectionIndex=ve[1],pe.sections=z.sections,B.push(pe)}}else B=function(ne,ve){let pe=[],fe=ne.text,Fe=0;for(let be of ve)pe.push(ne.substring(Fe,be)),Fe=be;return Fe<fe.length&&pe.push(ne.substring(Fe,fe.length)),pe}(z,G);let K=[],ee={positionedLines:K,text:z.toString(),top:v[1],bottom:v[1],left:v[0],right:v[0],writingMode:S,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if(function(ne,ve,pe,fe,Fe,be,Be,$e,Ue,Ye,Ze,rt){let Je=0,ot=0,kt=0,Mt=$e==="right"?1:$e==="left"?0:.5,ni=!1;for(let mi of Fe){let Hi=mi.getSections();for(let mn of Hi){if(mn.image)continue;let Xi=ve[mn.fontStack];if(Xi&&(ni=Xi.ascender!==void 0&&Xi.descender!==void 0,!ni))break}if(!ni)break}let Vt=0;for(let mi of Fe){mi.trim();let Hi=mi.getMaxScale(),mn=(Hi-1)*Wa,Xi={positionedGlyphs:[],lineOffset:0};ne.positionedLines[Vt]=Xi;let bn=Xi.positionedGlyphs,fn=0;if(!mi.length()){ot+=be,++Vt;continue}let Dn=0,Kn=0;for(let Wi=0;Wi<mi.length();Wi++){let Nn=mi.getSection(Wi),Hr=mi.getSectionIndex(Wi),Xr=mi.getCodePoint(Wi),ro=Nn.scale,uo=null,Dr=null,fa=null,Zs=Wa,Fo=0;Ue===Vl.vertical&&((qt=Xr)===12312||qt===12313||qt===12316||qt===12540||qt===12448)&&(Ue=Vl.horizontal);let $o=!(Ue===Vl.horizontal||!Ze&&!d_(Xr)||Ze&&(eC[Xr]||vE(Xr)));if(Nn.image){let hs=fe.get(Nn.image.toString());if(!hs)continue;fa=Nn.image,ne.iconsInText=ne.iconsInText||!0,Dr=hs.paddedRect;let Pa=hs.displaySize;ro=ro*Wa/rt,uo={width:Pa[0],height:Pa[1],left:0,top:-W6,advance:$o?Pa[1]:Pa[0],localGlyph:!1},Fo=ni?-uo.height*ro:Hi*Wa-17-Pa[1]*ro,Zs=uo.advance;let Xc=($o?Pa[0]:Pa[1])*ro-Wa*Hi;Xc>0&&Xc>fn&&(fn=Xc)}else{let hs=pe[Nn.fontStack];if(!hs)continue;hs[Xr]&&(Dr=hs[Xr]);let Pa=ve[Nn.fontStack];if(!Pa)continue;let Xc=Pa.glyphs[Xr];if(!Xc)continue;if(uo=Xc.metrics,Zs=Xr!==8203?Wa:0,ni){let Nf=Pa.ascender!==void 0?Math.abs(Pa.ascender):0,Iu=Pa.descender!==void 0?Math.abs(Pa.descender):0,Cd=(Nf+Iu)*ro;Dn<Cd&&(Dn=Cd,Kn=(Nf-Iu)/2*ro),Fo=-Nf*ro}else Fo=(Hi-ro)*Wa-17}$o?(ne.verticalizable=!0,bn.push({glyph:Xr,image:fa,x:Je,y:ot+Fo,vertical:$o,scale:ro,localGlyph:uo.localGlyph,fontStack:Nn.fontStack,sectionIndex:Hr,metrics:uo,rect:Dr}),Je+=Zs*ro+Ye):(bn.push({glyph:Xr,image:fa,x:Je,y:ot+Fo,vertical:$o,scale:ro,localGlyph:uo.localGlyph,fontStack:Nn.fontStack,sectionIndex:Hr,metrics:uo,rect:Dr}),Je+=uo.advance*ro+Ye)}bn.length!==0&&(kt=Math.max(Je-Ye,kt),ni?Q6(bn,Mt,fn,Kn,be*Hi/2):Q6(bn,Mt,fn,0,be/2)),Je=0;let Rr=be*Hi+fn;Xi.lineOffset=Math.max(fn,mn),ot+=Rr,++Vt}var qt;let Lt=ot,{horizontalAlign:Ri,verticalAlign:Jt}=mA(Be);(function(mi,Hi,mn,Xi,bn,fn){let Dn=(Hi-mn)*bn,Kn=-fn*Xi;for(let Rr of mi)for(let Wi of Rr.positionedGlyphs)Wi.x+=Dn,Wi.y+=Kn})(ne.positionedLines,Mt,Ri,Jt,kt,Lt),ne.top+=-Jt*Lt,ne.bottom=ne.top+Lt,ne.left+=-Ri*kt,ne.right=ne.left+kt,ne.hasBaseline=ni}(ee,a,l,d,B,_,x,C,S,M,A,I),!function(ne){for(let ve of ne)if(ve.positionedGlyphs.length!==0)return!1;return!0}(K))return ee}let eC={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},nQ={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Z6(u,a,l,d,p,h){if(a.image){let _=d.get(a.image.toString());return _?_.displaySize[0]*a.scale*Wa/h+p:0}{let _=l[a.fontStack],x=_&&_.glyphs[u];return x?x.metrics.advance*a.scale+p:0}}function Y6(u,a,l,d){let p=Math.pow(u-a,2);return d?u<a?p/2:2*p:p+Math.abs(l)*l}function rQ(u,a,l){let d=0;return u===10&&(d-=1e4),l&&(d+=150),u!==40&&u!==65288||(d+=50),a!==41&&a!==65289||(d+=50),d}function K6(u,a,l,d,p,h){let _=null,x=Y6(a,l,p,h);for(let C of d){let M=Y6(a-C.x,l,p,h)+C.badness;M<=x&&(_=C,x=M)}return{index:u,x:a,priorBreak:_,badness:x}}function X6(u){return u?X6(u.priorBreak).concat(u.index):[]}function mA(u){let a=.5,l=.5;switch(u){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:a,verticalAlign:l}}function Q6(u,a,l,d,p){if(!(a||l||d||p))return;let h=u.length-1,_=u[h],x=(_.x+_.metrics.advance*_.scale)*a;for(let C=0;C<=h;C++)u[C].x-=x,u[C].y+=l+d+p}function oQ(u,a,l,d){let{horizontalAlign:p,verticalAlign:h}=mA(d),_=l[0]-u.displaySize[0]*p,x=l[1]-u.displaySize[1]*h;return{imagePrimary:u,imageSecondary:a,top:x,bottom:x+u.displaySize[1],left:_,right:_+u.displaySize[0]}}function J6(u,a,l,d,p,h){let _=u.imagePrimary,x;if(_.content){let z=_.content,B=_.pixelRatio||1;x=[z[0]/B,z[1]/B,_.displaySize[0]-z[2]/B,_.displaySize[1]-z[3]/B]}let C=a.left*h,M=a.right*h,v,S,A,D;l==="width"||l==="both"?(D=p[0]+C-d[3],S=p[0]+M+d[1]):(D=p[0]+(C+M-_.displaySize[0])/2,S=D+_.displaySize[0]);let I=a.top*h,O=a.bottom*h;return l==="height"||l==="both"?(v=p[1]+I-d[0],A=p[1]+O+d[2]):(v=p[1]+(I+O-_.displaySize[1])/2,A=v+_.displaySize[1]),{imagePrimary:_,imageSecondary:void 0,top:v,right:S,bottom:A,left:D,collisionPadding:x}}class gp extends Wt{constructor(a,l,d,p,h){super(a,l),this.angle=p,this.z=d,h!==void 0&&(this.segment=h)}clone(){return new gp(this.x,this.y,this.z,this.angle,this.segment)}}function e5(u,a,l,d,p){if(a.segment===void 0)return!0;let h=a,_=a.segment+1,x=0;for(;x>-l/2;){if(_--,_<0)return!1;x-=u[_].dist(h),h=u[_]}x+=u[_].dist(u[_+1]),_++;let C=[],M=0;for(;x<l/2;){let v=u[_],S=u[_+1];if(!S)return!1;let A=u[_-1].angleTo(v)-v.angleTo(S);for(A=Math.abs((A+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:x,angleDelta:A}),M+=A;x-C[0].distance>d;)M-=C.shift().angleDelta;if(M>p)return!1;_++,x+=v.dist(S)}return!0}function t5(u){let a=0;for(let l=0;l<u.length-1;l++)a+=u[l].dist(u[l+1]);return a}function i5(u,a,l){return u?.6*a*l:0}function n5(u,a){return Math.max(u?u.right-u.left:0,a?a.right-a.left:0)}function aQ(u,a,l,d,p,h){let _=i5(l,p,h),x=n5(l,d)*h,C=0,M=t5(u)/2;for(let v=0;v<u.length-1;v++){let S=u[v],A=u[v+1],D=S.dist(A);if(C+D>M){let I=(M-C)/D,O=pi(S.x,A.x,I),z=pi(S.y,A.y,I),B=new gp(O,z,0,A.angleTo(S),v);return!_||e5(u,B,x,_,a)?B:void 0}C+=D}}function sQ(u,a,l,d,p,h,_,x,C){let M=i5(d,h,_),v=n5(d,p),S=v*_,A=u[0].x===0||u[0].x===C||u[0].y===0||u[0].y===C;return a-S<a/4&&(a=S+a/4),r5(u,A?a/2*x%a:(v/2+2*h)*_*x%a,a,M,l,S,A,!1,C)}function r5(u,a,l,d,p,h,_,x,C){let M=h/2,v=t5(u),S=0,A=a-l,D=[];for(let I=0;I<u.length-1;I++){let O=u[I],z=u[I+1],B=O.dist(z),G=z.angleTo(O);for(;A+l<S+B;){A+=l;let $=(A-S)/B,H=pi(O.x,z.x,$),K=pi(O.y,z.y,$);if(H>=0&&H<C&&K>=0&&K<C&&A-M>=0&&A+M<=v){let ee=new gp(H,K,0,G,I);d&&!e5(u,ee,h,d,p)||D.push(ee)}}S+=B}return x||D.length||_||(D=r5(u,S/2,l,d,p,h,_,!0,C)),D}function o5(u,a,l,d,p){let h=[];for(let _=0;_<u.length;_++){let x=u[_],C;for(let M=0;M<x.length-1;M++){let v=x[M],S=x[M+1];v.x<a&&S.x<a||(v.x<a?v=new Wt(a,v.y+(a-v.x)/(S.x-v.x)*(S.y-v.y))._round():S.x<a&&(S=new Wt(a,v.y+(a-v.x)/(S.x-v.x)*(S.y-v.y))._round()),v.y<l&&S.y<l||(v.y<l?v=new Wt(v.x+(l-v.y)/(S.y-v.y)*(S.x-v.x),l)._round():S.y<l&&(S=new Wt(v.x+(l-v.y)/(S.y-v.y)*(S.x-v.x),l)._round()),v.x>=d&&S.x>=d||(v.x>=d?v=new Wt(d,v.y+(d-v.x)/(S.x-v.x)*(S.y-v.y))._round():S.x>=d&&(S=new Wt(d,v.y+(d-v.x)/(S.x-v.x)*(S.y-v.y))._round()),v.y>=p&&S.y>=p||(v.y>=p?v=new Wt(v.x+(p-v.y)/(S.y-v.y)*(S.x-v.x),p)._round():S.y>=p&&(S=new Wt(v.x+(p-v.y)/(S.y-v.y)*(S.x-v.x),p)._round()),C&&v.equals(C[C.length-1])||(C=[v],h.push(C)),C.push(S)))))}}return h}function a5(u){let a=0,l=0;for(let _ of u)a+=_.w*_.h,l=Math.max(l,_.w);u.sort((_,x)=>x.h-_.h);let d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),l),h:1/0}],p=0,h=0;for(let _ of u)for(let x=d.length-1;x>=0;x--){let C=d[x];if(!(_.w>C.w||_.h>C.h)){if(_.x=C.x,_.y=C.y,h=Math.max(h,_.y+_.h),p=Math.max(p,_.x+_.w),_.w===C.w&&_.h===C.h){let M=d.pop();x<d.length&&(d[x]=M)}else _.h===C.h?(C.x+=_.w,C.w-=_.w):_.w===C.w?(C.y+=_.h,C.h-=_.h):(d.push({x:C.x+_.w,y:C.y,w:C.w-_.w,h:_.h}),C.y+=_.h,C.h-=_.h);break}}return{w:p,h,fill:a/(p*h)||0}}ii(gp,"Anchor");let F_=1;class Jb{static getImagePositionScale(a,l,d){if(l&&a&&a.options&&a.options.transform){let p=a.options.transform;return{x:p.a,y:p.d}}return{x:d,y:d}}constructor(a,l,d,p){this.paddedRect=a;let{pixelRatio:h,version:_,stretchX:x,stretchY:C,content:M,sdf:v,usvg:S}=l;this.pixelRatio=h,this.stretchX=x,this.stretchY=C,this.content=M,this.version=_,this.padding=d,this.sdf=v,this.scale=Jb.getImagePositionScale(p,S,h)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function s5(u,a,l){let d=ic.parse(u),p=function(h,_,x=[1,1]){return{x:0,y:0,w:(h.data?h.data.width:h.width*x[0])+2*_,h:(h.data?h.data.height:h.height*x[1])+2*_}}(a,l,[d.options.transform.a,d.options.transform.d]);return{bin:p,imagePosition:new Jb(p,a,l,d),imageVariant:d}}class l5{constructor(a,l,d){let p=new Map,h=new Map;this.haveRenderCallbacks=[];let _=[];this.addImages(a,p,F_,_),this.addImages(l,h,2,_);let{w:x,h:C}=a5(_),M=new Ga({width:x||1,height:C||1});for(let[v,S]of a.entries()){let A=p.get(v).paddedRect;Ga.copy(S.data,M,{x:0,y:0},{x:A.x+F_,y:A.y+F_},S.data,d,S.sdf)}for(let[v,S]of l.entries()){let A=h.get(v),D=A.paddedRect,I=A.padding,O=D.x+I,z=D.y+I,B=S.data.width,G=S.data.height;I=I>1?I-1:I,Ga.copy(S.data,M,{x:0,y:0},{x:O,y:z},S.data,d),Ga.copy(S.data,M,{x:0,y:G-I},{x:O,y:z-I},{width:B,height:I},d),Ga.copy(S.data,M,{x:0,y:0},{x:O,y:z+G},{width:B,height:I},d),Ga.copy(S.data,M,{x:B-I,y:0},{x:O-I,y:z},{width:I,height:G},d),Ga.copy(S.data,M,{x:0,y:0},{x:O+B,y:z},{width:I,height:G},d),Ga.copy(S.data,M,{x:B-I,y:G-I},{x:O-I,y:z-I},{width:I,height:I},d),Ga.copy(S.data,M,{x:0,y:G-I},{x:O+B,y:z-I},{width:I,height:I},d),Ga.copy(S.data,M,{x:0,y:0},{x:O+B,y:z+G},{width:I,height:I},d),Ga.copy(S.data,M,{x:B-I,y:0},{x:O-I,y:z+G},{width:I,height:I},d)}this.lut=d,this.image=M,this.iconPositions=p,this.patternPositions=h}addImages(a,l,d,p){for(let[h,_]of a.entries()){let{bin:x,imagePosition:C,imageVariant:M}=s5(h,_,d);l.set(h,C),p.push(x),_.hasRenderCallback&&this.haveRenderCallbacks.push(M.id)}}patchUpdatedImages(a,l,d){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(p=>a.hasImage(p,d)),a.dispatchRenderCallbacks(this.haveRenderCallbacks,d);for(let p of a.getUpdatedImages(d)){for(let h of this.iconPositions.keys()){let _=ic.parse(h);if(ls.isEqual(_.id,p)){let x=a.getImage(p,d);this.patchUpdatedImage(this.iconPositions.get(h),x,l)}}for(let h of this.patternPositions.keys()){let _=ic.parse(h);if(ls.isEqual(_.id,p)){let x=a.getImage(p,d);this.patchUpdatedImage(this.patternPositions.get(h),x,l)}}}}patchUpdatedImage(a,l,d){if(!a||!l||a.version===l.version)return;a.version=l.version;let[p,h]=a.tl,_=a.sdf;if(this.lut||_){let x={width:l.data.width,height:l.data.height},C=new Ga(x);Ga.copy(l.data,C,{x:0,y:0},{x:0,y:0},x,this.lut,_),d.update(C,{position:{x:p,y:h}})}else d.update(l.data,{position:{x:p,y:h}})}}ii(Jb,"ImagePosition"),ii(l5,"ImageAtlas");let e1=1e20;function c5(u,a,l,d,p,h,_,x,C){for(let M=a;M<a+d;M++)u5(u,l*h+M,h,p,_,x,C);for(let M=l;M<l+p;M++)u5(u,M*h+a,1,d,_,x,C)}function u5(u,a,l,d,p,h,_){h[0]=0,_[0]=-e1,_[1]=e1,p[0]=u[a];for(let x=1,C=0,M=0;x<d;x++){p[x]=u[a+x*l];let v=x*x;do{let S=h[C];M=(p[x]-p[S]+v-S*S)/(x-S)/2}while(M<=_[C]&&--C>-1);C++,h[C]=x,_[C]=M,_[C+1]=e1}for(let x=0,C=0;x<d;x++){for(;_[C+1]<x;)C++;let M=h[C],v=x-M;u[a+x*l]=p[M]+v*v}}let bd=2,gA={none:0,ideographs:1,all:2};class z_{constructor(a,l,d){this.requestManager=a,this.localGlyphMode=l,this.localFontFamily=d,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(a,l){this.urls[l]=a}getGlyphs(a,l,d){let p=[],h=this.urls[l]||Y.GLYPHS_URL;for(let _ in a)for(let x of a[_])p.push({stack:_,id:x});Cr(p,({stack:_,id:x},C)=>{let M=this.entries[_];M||(M=this.entries[_]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let v=M.glyphs[x];if(v!==void 0)return void C(null,{stack:_,id:x,glyph:v});if(v=this._tinySDF(M,_,x),v)return M.glyphs[x]=v,void C(null,{stack:_,id:x,glyph:v});let S=Math.floor(x/256);if(256*S>65535)return Gt("glyphs > 65535 not supported"),void C(null,{stack:_,id:x,glyph:v});if(M.ranges[S])return void C(null,{stack:_,id:x,glyph:v});let A=M.requests[S];A||(A=M.requests[S]=[],z_.loadGlyphRange(_,S,h,this.requestManager,(D,I)=>{if(I){M.ascender=I.ascender,M.descender=I.descender;for(let O in I.glyphs)this._doesCharSupportLocalGlyph(+O)||(M.glyphs[+O]=I.glyphs[+O]);M.ranges[S]=!0}for(let O of A)O(D,I);delete M.requests[S]})),A.push((D,I)=>{D?C(D):I&&C(null,{stack:_,id:x,glyph:I.glyphs[x]||null})})},(_,x)=>{if(_)d(_);else if(x){let C={};for(let{stack:M,id:v,glyph:S}of x)C[M]===void 0&&(C[M]={}),C[M].glyphs===void 0&&(C[M].glyphs={}),C[M].glyphs[v]=S&&{id:S.id,bitmap:S.bitmap.clone(),metrics:S.metrics},C[M].ascender=this.entries[M].ascender,C[M].descender=this.entries[M].descender;d(null,C)}})}_doesCharSupportLocalGlyph(a){return this.localGlyphMode!==gA.none&&(this.localGlyphMode===gA.all?!!this.localFontFamily:!!this.localFontFamily&&(Ii["CJK Unified Ideographs"](a)||Ii["Hangul Syllables"](a)||Ii.Hiragana(a)||Ii.Katakana(a)||Ii["CJK Symbols and Punctuation"](a)||Ii["CJK Unified Ideographs Extension A"](a)||Ii["CJK Unified Ideographs Extension B"](a)||Ii.Osage(a)))}_tinySDF(a,l,d){let p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(d))return;let h=a.tinySDF;if(!h){let O="400";/bold/i.test(l)?O="900":/medium/i.test(l)?O="500":/light/i.test(l)&&(O="200"),h=a.tinySDF=new z_.TinySDF({fontFamily:p,fontWeight:O,fontSize:24*bd,buffer:3*bd,radius:8*bd}),h.fontWeight=O}if(this.localGlyphs[h.fontWeight][d])return this.localGlyphs[h.fontWeight][d];let _=String.fromCodePoint(d),{data:x,width:C,height:M,glyphWidth:v,glyphHeight:S,glyphLeft:A,glyphTop:D,glyphAdvance:I}=h.draw(_);return this.localGlyphs[h.fontWeight][d]={id:d,bitmap:new Df({width:C,height:M},x),metrics:{width:v/bd,height:S/bd,left:A/bd,top:D/bd-27,advance:I/bd,localGlyph:!0}}}}z_.loadGlyphRange=function(u,a,l,d,p){let h=256*a,_=h+255,x=d.transformRequest(d.normalizeGlyphsURL(l).replace("{fontstack}",u).replace("{range}",`${h}-${_}`),lo.Glyphs);js(x,(C,M)=>{if(C)p(C);else if(M){let v={},S=function(A){return new JE(A).readFields(eQ,{})}(M);for(let A of S.glyphs)v[A.id]=A;p(null,{glyphs:v,ascender:S.ascender,descender:S.descender})}})},z_.TinySDF=class{constructor({fontSize:u=24,buffer:a=3,radius:l=8,cutoff:d=.25,fontFamily:p="sans-serif",fontWeight:h="normal",fontStyle:_="normal"}={}){this.buffer=a,this.cutoff=d,this.radius=l;let x=this.size=u+4*a,C=this._createCanvas(x),M=this.ctx=C.getContext("2d",{willReadFrequently:!0});M.font=`${_} ${h} ${u}px ${p}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Uint16Array(x)}_createCanvas(u){let a=document.createElement("canvas");return a.width=a.height=u,a}draw(u){let{width:a,actualBoundingBoxAscent:l,actualBoundingBoxDescent:d,actualBoundingBoxLeft:p,actualBoundingBoxRight:h}=this.ctx.measureText(u),_=Math.ceil(l),x=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(h-p))),C=Math.min(this.size-this.buffer,_+Math.ceil(d)),M=x+2*this.buffer,v=C+2*this.buffer,S=Math.max(M*v,0),A=new Uint8ClampedArray(S),D={data:A,width:M,height:v,glyphWidth:x,glyphHeight:C,glyphTop:_,glyphLeft:0,glyphAdvance:a};if(x===0||C===0)return D;let{ctx:I,buffer:O,gridInner:z,gridOuter:B}=this;I.clearRect(O,O,x,C),I.fillText(u,O,O+_);let G=I.getImageData(O,O,x,C);B.fill(e1,0,S),z.fill(0,0,S);for(let $=0;$<C;$++)for(let H=0;H<x;H++){let K=G.data[4*($*x+H)+3]/255;if(K===0)continue;let ee=($+O)*M+H+O;if(K===1)B[ee]=0,z[ee]=e1;else{let ne=.5-K;B[ee]=ne>0?ne*ne:0,z[ee]=ne<0?ne*ne:0}}c5(B,0,0,M,v,M,this.f,this.v,this.z),c5(z,O,O,x,C,M,this.f,this.v,this.z);for(let $=0;$<S;$++){let H=Math.sqrt(B[$])-Math.sqrt(z[$]);A[$]=Math.round(255-255*(H/this.radius+this.cutoff))}return D}};let Af=F_;function d5(u,a){return u+a[1]-a[0]}function h5(u,a,l,d,p=1){let h=[],_=u.imagePrimary,x=_.pixelRatio,C=_.paddedRect.w-2*Af,M=_.paddedRect.h-2*Af,v=(u.right-u.left)*p,S=(u.bottom-u.top)*p,A=_.stretchX||[[0,C]],D=_.stretchY||[[0,M]],I=A.reduce(d5,0),O=D.reduce(d5,0),z=C-I,B=M-O,G=0,$=I,H=0,K=O,ee=0,ne=z,ve=0,pe=B;if(_.content&&d){let Fe=_.content;G=tC(A,0,Fe[0]),H=tC(D,0,Fe[1]),$=tC(A,Fe[0],Fe[2]),K=tC(D,Fe[1],Fe[3]),ee=Fe[0]-G,ve=Fe[1]-H,ne=Fe[2]-Fe[0]-$,pe=Fe[3]-Fe[1]-K}let fe=(Fe,be,Be,$e)=>{let Ue=iC(Fe.stretch-G,$,v,u.left*p),Ye=nC(Fe.fixed-ee,ne,Fe.stretch,I),Ze=iC(be.stretch-H,K,S,u.top*p),rt=nC(be.fixed-ve,pe,be.stretch,O),Je=iC(Be.stretch-G,$,v,u.left*p),ot=nC(Be.fixed-ee,ne,Be.stretch,I),kt=iC($e.stretch-H,K,S,u.top*p),Mt=nC($e.fixed-ve,pe,$e.stretch,O),ni=new Wt(Ue,Ze),Vt=new Wt(Je,Ze),qt=new Wt(Je,kt),Lt=new Wt(Ue,kt),Ri=new Wt(Ye/x,rt/x),Jt=new Wt(ot/x,Mt/x),mi=a*Math.PI/180;if(mi){let Dn=Math.sin(mi),Kn=Math.cos(mi),Rr=[Kn,-Dn,Dn,Kn];ni._matMult(Rr),Vt._matMult(Rr),Lt._matMult(Rr),qt._matMult(Rr)}let Hi=Fe.stretch+Fe.fixed,mn=Be.stretch+Be.fixed,Xi=be.stretch+be.fixed,bn=$e.stretch+$e.fixed,fn=u.imageSecondary;return{tl:ni,tr:Vt,bl:Lt,br:qt,texPrimary:{x:_.paddedRect.x+Af+Hi,y:_.paddedRect.y+Af+Xi,w:mn-Hi,h:bn-Xi},texSecondary:fn?{x:fn.paddedRect.x+Af+Hi,y:fn.paddedRect.y+Af+Xi,w:mn-Hi,h:bn-Xi}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ri,pixelOffsetBR:Jt,minFontScaleX:ne/x/v,minFontScaleY:pe/x/S,isSDF:l}};if(d&&(_.stretchX||_.stretchY)){let Fe=p5(A,z,I),be=p5(D,B,O);for(let Be=0;Be<Fe.length-1;Be++){let $e=Fe[Be],Ue=Fe[Be+1];for(let Ye=0;Ye<be.length-1;Ye++)h.push(fe($e,be[Ye],Ue,be[Ye+1]))}}else h.push(fe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:M+1}));return h}function tC(u,a,l){let d=0;for(let p of u)d+=Math.max(a,Math.min(l,p[1]))-Math.max(a,Math.min(l,p[0]));return d}function p5(u,a,l){let d=[{fixed:-Af,stretch:0}];for(let[p,h]of u){let _=d[d.length-1];d.push({fixed:p-_.stretch,stretch:_.stretch}),d.push({fixed:p-_.stretch,stretch:_.stretch+(h-p)})}return d.push({fixed:a+Af,stretch:l}),d}function iC(u,a,l,d){return u/a*l+d}function nC(u,a,l,d){return u-a*l/d}function lQ(u,a,l,d){let p=a+u.positionedLines[d].lineOffset;return d===0?l+p/2:l+(p+(a+u.positionedLines[d-1].lineOffset))/2}function cQ(u,a=1,l=!1){let d=1/0,p=1/0,h=-1/0,_=-1/0,x=u[0];for(let D=0;D<x.length;D++){let I=x[D];(!D||I.x<d)&&(d=I.x),(!D||I.y<p)&&(p=I.y),(!D||I.x>h)&&(h=I.x),(!D||I.y>_)&&(_=I.y)}let C=Math.min(h-d,_-p),M=C/2,v=new np([],uQ);if(C===0)return new Wt(d,p);for(let D=d;D<h;D+=C)for(let I=p;I<_;I+=C)v.push(new B_(D+M,I+M,M,u));let S=function(D){let I=0,O=0,z=0,B=D[0];for(let G=0,$=B.length,H=$-1;G<$;H=G++){let K=B[G],ee=B[H],ne=K.x*ee.y-ee.x*K.y;O+=(K.x+ee.x)*ne,z+=(K.y+ee.y)*ne,I+=3*ne}return new B_(O/I,z/I,0,D)}(u),A=v.length;for(;v.length;){let D=v.pop();(D.d>S.d||!S.d)&&(S=D,l&&console.log("found best %d after %d probes",Math.round(1e4*D.d)/1e4,A)),D.max-S.d<=a||(M=D.h/2,v.push(new B_(D.p.x-M,D.p.y-M,M,u)),v.push(new B_(D.p.x+M,D.p.y-M,M,u)),v.push(new B_(D.p.x-M,D.p.y+M,M,u)),v.push(new B_(D.p.x+M,D.p.y+M,M,u)),A+=4)}return l&&(console.log(`num probes: ${A}`),console.log(`best distance: ${S.d}`)),S.p}function uQ(u,a){return a.max-u.max}class B_{constructor(a,l,d,p){this.p=new Wt(a,l),this.h=d,this.d=function(h,_){let x=!1,C=1/0;for(let M=0;M<_.length;M++){let v=_[M];for(let S=0,A=v.length,D=A-1;S<A;D=S++){let I=v[S],O=v[D];I.y>h.y!=O.y>h.y&&h.x<(O.x-I.x)*(h.y-I.y)/(O.y-I.y)+I.x&&(x=!x),C=Math.min(C,Le(h,I,O))}}return(x?1:-1)*Math.sqrt(C)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}}let _A=Number.POSITIVE_INFINITY,dQ=Math.sqrt(2);function f5(u,[a,l]){let d=0,p=0;if(l===_A){a<0&&(a=0);let h=a/dQ;switch(u){case"top-right":case"top-left":p=h-7;break;case"bottom-right":case"bottom-left":p=7-h;break;case"bottom":p=7-a;break;case"top":p=a-7}switch(u){case"top-right":case"bottom-right":d=-h;break;case"top-left":case"bottom-left":d=h;break;case"left":d=a;break;case"right":d=-a}}else{switch(a=Math.abs(a),l=Math.abs(l),u){case"top-right":case"top-left":case"top":p=l-7;break;case"bottom-right":case"bottom-left":case"bottom":p=7-l}switch(u){case"top-right":case"bottom-right":case"right":d=-a;break;case"top-left":case"bottom-left":case"left":d=a}}return[d,p]}function m5(u,a,l,d,p,h,_,x){if(!u)return;let C=H6(a,l,d,p,h);return u.scaleSelf(C*x*_)}function g5(u,a,l,d,p,h,_,x){return{iconPrimary:m5(u.getPrimary(),a,l,d,p,h,_,x),iconSecondary:m5(u.getSecondary(),a,l,d,p,h,_,x)}}function _5(u,a,l,d){if(!u)return;let p=a.get(l.toString());if(u.imagePrimary=p,d){let h=a.get(d.toString());u.imageSecondary=h}}function hQ(u,a){for(let l in u.horizontal)y5(u.horizontal[l],a);y5(u.vertical,a)}function y5(u,a){if(u){for(let l of u.positionedLines)for(let d of l.positionedGlyphs)if(d.image!==null){let p=d.image.toString();d.rect=a.get(p).paddedRect}}}function yA(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function pQ(u,a,l,d,p,h,_,x,C){let M=vA(h.horizontal)||h.vertical,v=l.get("icon-text-fit-padding").evaluate(d,{},p),S,A=a;return a&&C!=="none"&&(u.allowVerticalPlacement&&h.vertical&&(S=J6(a,h.vertical,C,v,x,_)),M&&(A=J6(a,M,C,v,x,_))),{defaultShapedIcon:A,verticallyShapedIcon:S}}function fQ(u,a,l,d,p,h,_,x,C,M,v,S,A,D,I,O,z,B,G,$){let H=_.textMaxSize.evaluate(a,{},A);H===void 0?H=x*_.textScaleFactor:H*=_.textScaleFactor;let K=u.layers[0].layout,ee=vA(l.horizontal)||l.vertical,ne=D.name==="globe",ve=Wa,pe=u.tilePixelRatio*H/ve,fe=(Ye=u.overscaling,u.zoom>18&&Ye>2&&(Ye>>=1),Math.max($t/(512*Ye),1)*K.get("symbol-spacing")),Fe=K.get("text-padding")*u.tilePixelRatio,be=K.get("icon-padding")*u.tilePixelRatio,Be=Mn(K.get("text-max-angle")),$e=K.get("icon-rotation-alignment")==="map"&&$!=="point",Ue=fe/2;var Ye;u.hasAnyIconTextFit===!1&&z!=="none"&&(u.hasAnyIconTextFit=!0);let Ze=a.properties?+a.properties[vg]:null,rt=Ze&&u.elevationFeatureIdToIndex?u.elevationFeatureIdToIndex.get(Ze):65535,Je=(ot,kt,Mt)=>{if(kt.x<0||kt.x>=$t||kt.y<0||kt.y>=$t)return;let ni=null;if(ne){let{x:Vt,y:qt,z:Lt}=D.projectTilePoint(kt.x,kt.y,Mt);ni={anchor:new gp(Vt,qt,Lt,0,void 0),up:D.upVector(Mt,kt.x,kt.y)}}(function(Vt,qt,Lt,Ri,Jt,mi,Hi,mn,Xi,bn,fn,Dn,Kn,Rr,Wi,Nn,Hr,Xr,ro,uo,Dr,fa,Zs,Fo,$o,hs,Pa,Xc,Nf){let Iu=Vt.addToLineVertexArray(qt,Ri),Cd,Lf,Ff,Sg,ez,tz,iz,nz=0,rz=0,oz=0,az=0,QA=-1,JA=-1,wh={},sz=rr(""),Tg=Lt?Lt.anchor:qt,eR=Xc!=="none",tR=0,iR=0;if(Xi._unevaluatedLayout.getValue("text-radial-offset")===void 0?[tR,iR]=Xi.layout.get("text-offset").evaluate(Dr,{},$o).map(Qc=>Qc*Wa):(tR=Xi.layout.get("text-radial-offset").evaluate(Dr,{},$o)*Wa,iR=_A),Vt.allowVerticalPlacement&&Jt.vertical){let Qc=Jt.vertical;if(Wi)tz=bA(Qc),mn&&(iz=bA(mn));else{let jl=Xi.layout.get("text-rotate").evaluate(Dr,{},$o)+90;Ff=rC(bn,Tg,qt,fn,Dn,Kn,Qc,Rr,jl,Nn),mn&&(Sg=rC(bn,Tg,qt,fn,Dn,Kn,mn,Xr,jl))}}if(mi){let Qc=Vt.iconSizeData,jl=Xi.layout.get("icon-rotate").evaluate(Dr,{},$o),v1=h5(mi,jl,Zs,eR,fa.iconScaleFactor),rR=mn?h5(mn,jl,Zs,eR,fa.iconScaleFactor):void 0;Lf=rC(bn,Tg,qt,fn,Dn,Kn,mi,Xr,jl,null),nz=4*v1.length;let Dg=null;Qc.kind==="source"?(Dg=[vd*Xi.layout.get("icon-size").evaluate(Dr,{},$o)*fa.iconScaleFactor],Dg[0]>Rf&&Gt(`${Vt.layerIds[0]}: Value for "icon-size" is >= ${t1}. Reduce your "icon-size".`)):Qc.kind==="composite"&&(Dg=[vd*fa.compositeIconSizes[0].evaluate(Dr,{},$o)*fa.iconScaleFactor,vd*fa.compositeIconSizes[1].evaluate(Dr,{},$o)*fa.iconScaleFactor],(Dg[0]>Rf||Dg[1]>Rf)&&Gt(`${Vt.layerIds[0]}: Value for "icon-size" is >= ${t1}. Reduce your "icon-size".`)),Vt.addSymbols(Vt.icon,v1,Dg,uo,ro,Dr,!1,Lt,qt,Iu.lineStartIndex,Iu.lineLength,-1,Fo,$o,hs,Pa),QA=Vt.icon.placedSymbolArray.length-1,rR&&(rz=4*rR.length,Vt.addSymbols(Vt.icon,rR,Dg,uo,ro,Dr,Vl.vertical,Lt,qt,Iu.lineStartIndex,Iu.lineLength,-1,Fo,$o,hs,Pa),JA=Vt.icon.placedSymbolArray.length-1)}for(let Qc in Jt.horizontal){let jl=Jt.horizontal[Qc];Cd||(sz=rr(jl.text),Wi?ez=bA(jl):Cd=rC(bn,Tg,qt,fn,Dn,Kn,jl,Rr,Xi.layout.get("text-rotate").evaluate(Dr,{},$o),Nn));let v1=jl.positionedLines.length===1;if(oz+=v5(Vt,Lt,qt,jl,Hi,Xi,Wi,Dr,Nn,Iu,Jt.vertical?Vl.horizontal:Vl.horizontalOnly,v1?Object.keys(Jt.horizontal):[Qc],wh,QA,fa,Fo,$o,hs),v1)break}Jt.vertical&&(az+=v5(Vt,Lt,qt,Jt.vertical,Hi,Xi,Wi,Dr,Nn,Iu,Vl.vertical,["vertical"],wh,JA,fa,Fo,$o,hs));let zf=-1,nR=(Qc,jl)=>Qc?Math.max(Qc,jl):jl;zf=nR(ez,zf),zf=nR(tz,zf),zf=nR(iz,zf);let GJ=zf>-1?1:0;Vt.glyphOffsetArray.length>=65535&&Gt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Dr.sortKey!==void 0&&Vt.addToSortKeyRanges(Vt.symbolInstances.length,Dr.sortKey),Vt.symbolInstances.emplaceBack(qt.x,qt.y,Tg.x,Tg.y,Tg.z,wh.right>=0?wh.right:-1,wh.center>=0?wh.center:-1,wh.left>=0?wh.left:-1,wh.vertical>=0?wh.vertical:-1,QA,JA,sz,Cd!==void 0?Cd:Vt.collisionBoxArray.length,Cd!==void 0?Cd+1:Vt.collisionBoxArray.length,Ff!==void 0?Ff:Vt.collisionBoxArray.length,Ff!==void 0?Ff+1:Vt.collisionBoxArray.length,Lf!==void 0?Lf:Vt.collisionBoxArray.length,Lf!==void 0?Lf+1:Vt.collisionBoxArray.length,Sg||Vt.collisionBoxArray.length,Sg?Sg+1:Vt.collisionBoxArray.length,fn,oz,az,nz,rz,GJ,0,tR,iR,zf,0,eR?1:0,Nf)})(u,kt,ni,ot,l,d,h,p,u.layers[0],u.collisionBoxArray,a.index,a.sourceLayerIndex,u.index,Fe,G,M,0,be,$e,B,a,_,v,S,A,I,O,z,rt)};if($==="line")for(let ot of o5(a.geometry,0,0,$t,$t)){let kt=sQ(ot,fe,Be,l.vertical||ee,d,ve,pe,u.overscaling,$t);for(let Mt of kt)ee&&mQ(u,ee.text,Ue,Mt)||Je(ot,Mt,A)}else if($==="line-center"){for(let ot of a.geometry)if(ot.length>1){let kt=aQ(ot,Be,l.vertical||ee,d,ve,pe);kt&&Je(ot,kt,A)}}else if(a.type==="Polygon")for(let ot of $E(a.geometry,0)){let kt=cQ(ot,16);Je(ot[0],new gp(kt.x,kt.y,0,0,void 0),A)}else if(a.type==="LineString")for(let ot of a.geometry)Je(ot,new gp(ot[0].x,ot[0].y,0,0,void 0),A);else if(a.type==="Point")for(let ot of a.geometry)for(let kt of ot)Je([kt],new gp(kt.x,kt.y,0,0,void 0),A)}let t1=255,Rf=t1*vd;function v5(u,a,l,d,p,h,_,x,C,M,v,S,A,D,I,O,z,B){let G=function(K,ee,ne,ve,pe,fe,Fe,be){let Be=[];if(ee.positionedLines.length===0)return Be;let $e=ve.layout.get("text-rotate").evaluate(fe,{})*Math.PI/180,Ue=function(ot){let kt=ot[0],Mt=ot[1],ni=kt*Mt;return ni>0?[kt,-Mt]:ni<0?[-kt,Mt]:kt===0?[Mt,kt]:[Mt,-kt]}(ne),Ye=Math.abs(ee.top-ee.bottom);for(let ot of ee.positionedLines)Ye-=ot.lineOffset;let Ze=ee.positionedLines.length,rt=Ye/Ze,Je=ee.top-ne[1];for(let ot=0;ot<Ze;++ot){let kt=ee.positionedLines[ot];Je=lQ(ee,rt,Je,ot);for(let Mt of kt.positionedGlyphs){if(!Mt.rect)continue;let ni=Mt.rect||{},Vt=W6+1,qt=!0,Lt=1,Ri=0;if(Mt.image){let Dr=Fe.get(Mt.image.toString());if(!Dr)continue;if(Dr.sdf){Gt("SDF images are not supported in formatted text and will be ignored.");continue}qt=!1,Lt=Dr.pixelRatio,Vt=F_/Lt}let Jt=(pe||be)&&Mt.vertical,mi=Mt.metrics.advance*Mt.scale/2,Hi=Mt.metrics,mn=Mt.rect;if(mn===null)continue;be&&ee.verticalizable&&(Ri=Mt.image?mi-Mt.metrics.width*Mt.scale/2:0);let Xi=pe?[Mt.x+mi,Mt.y]:[0,0],bn=[0,0],fn=[0,0],Dn=!1;pe||(Jt?(fn=[Mt.x+mi+Ue[0],Mt.y+Ue[1]-Ri],Dn=!0):bn=[Mt.x+mi+ne[0],Mt.y+ne[1]-Ri]);let Kn=mn.w*Mt.scale/(Lt*(Mt.localGlyph?bd:1)),Rr=mn.h*Mt.scale/(Lt*(Mt.localGlyph?bd:1)),Wi,Nn,Hr,Xr;if(Jt){let Dr=Mt.y-Je,fa=new Wt(-mi,mi-Dr),Zs=-Math.PI/2,Fo=new Wt(...fn);Wi=new Wt(-mi+bn[0],bn[1]),Wi._rotateAround(Zs,fa)._add(Fo),Wi.x+=-Dr+mi,Wi.y-=(Hi.left-Vt)*Mt.scale;let $o=Mt.image?Hi.advance*Mt.scale:Wa*Mt.scale,hs=String.fromCodePoint(Mt.glyph);XX(hs)?Wi.x+=(1-Vt)*Mt.scale:QX(hs)?Wi.x+=$o-Hi.height*Mt.scale+(-Vt-1)*Mt.scale:Wi.x+=Mt.image||Hi.width+2*Vt===mn.w&&Hi.height+2*Vt===mn.h?($o-Rr)/2:($o-(Hi.height+2*Vt)*Mt.scale)/2,Nn=new Wt(Wi.x,Wi.y-Kn),Hr=new Wt(Wi.x+Rr,Wi.y),Xr=new Wt(Wi.x+Rr,Wi.y-Kn)}else{let Dr=(Hi.left-Vt)*Mt.scale-mi+bn[0],fa=(-Hi.top-Vt)*Mt.scale+bn[1],Zs=Dr+Kn,Fo=fa+Rr;Wi=new Wt(Dr,fa),Nn=new Wt(Zs,fa),Hr=new Wt(Dr,Fo),Xr=new Wt(Zs,Fo)}if($e){let Dr;Dr=pe?new Wt(0,0):Dn?new Wt(Ue[0],Ue[1]):new Wt(ne[0],ne[1]),Wi._rotateAround($e,Dr),Nn._rotateAround($e,Dr),Hr._rotateAround($e,Dr),Xr._rotateAround($e,Dr)}let ro=new Wt(0,0),uo=new Wt(0,0);Be.push({tl:Wi,tr:Nn,bl:Hr,br:Xr,texPrimary:ni,texSecondary:void 0,writingMode:ee.writingMode,glyphOffset:Xi,sectionIndex:Mt.sectionIndex,isSDF:qt,pixelOffsetTL:ro,pixelOffsetBR:uo,minFontScaleX:0,minFontScaleY:0})}}return Be}(0,d,C,h,_,x,p,u.allowVerticalPlacement),$=u.textSizeData,H=null;$.kind==="source"?(H=[vd*h.layout.get("text-size").evaluate(x,{},z)*I.textScaleFactor],H[0]>Rf&&Gt(`${u.layerIds[0]}: Value for "text-size" is >= ${t1}. Reduce your "text-size".`)):$.kind==="composite"&&(H=[vd*I.compositeTextSizes[0].evaluate(x,{},z)*I.textScaleFactor,vd*I.compositeTextSizes[1].evaluate(x,{},z)*I.textScaleFactor],(H[0]>Rf||H[1]>Rf)&&Gt(`${u.layerIds[0]}: Value for "text-size" is >= ${t1}. Reduce your "text-size".`)),u.addSymbols(u.text,G,H,C,_,x,v,a,l,M.lineStartIndex,M.lineLength,D,O,z,B,!1);for(let K of S)A[K]=u.text.placedSymbolArray.length-1;return 4*G.length}function vA(u){for(let a in u)return u[a];return null}function rC(u,a,l,d,p,h,_,x,C,M){let v=_.top,S=_.bottom,A=_.left,D=_.right,I=_.collisionPadding;if(I&&(A-=I[0],v-=I[1],D+=I[2],S+=I[3]),C){let O=new Wt(A,v),z=new Wt(D,v),B=new Wt(A,S),G=new Wt(D,S),$=Mn(C),H=new Wt(0,0);M&&(H=new Wt(M[0],M[1])),O._rotateAround($,H),z._rotateAround($,H),B._rotateAround($,H),G._rotateAround($,H),A=Math.min(O.x,z.x,B.x,G.x),D=Math.max(O.x,z.x,B.x,G.x),v=Math.min(O.y,z.y,B.y,G.y),S=Math.max(O.y,z.y,B.y,G.y)}return u.emplaceBack(a.x,a.y,a.z,l.x,l.y,A,v,D,S,x,d,p,h),u.length-1}function bA(u){u.collisionPadding&&(u.top-=u.collisionPadding[1],u.bottom+=u.collisionPadding[3]);let a=u.bottom-u.top;return a>0?Math.max(10,a):null}function mQ(u,a,l,d){let p=u.compareText;if(a in p){let h=p[a];for(let _=h.length-1;_>=0;_--)if(d.dist(h[_])<l)return!0}else p[a]=[];return p[a].push(d),!1}function b5(u,a){let l=u.fovAboveCenter,d=u.elevation?u.elevation.getMinElevationBelowMSL()*a:0,p=(u._camera.position[2]*u.worldSize-d)/Math.cos(u._pitch),h=Math.sin(l)*p/Math.sin(Math.max(Math.PI/2-u._pitch-l,.01)),_=Math.sin(u._pitch)*h+p,x=p*(1/u._horizonShift);if(!u.elevation||u.elevation.exaggeration()===0){let C=Math.max(u.zoom-17,0);u.isOrthographic&&(C/=10),_*=1+C}return Math.min(1.01*_,x)}function i1(u,a){if(!a.isReprojectedInTileSpace)return{scale:1<<u.z,x:u.x,y:u.y,x2:u.x+1,y2:u.y+1,projection:a};let l=Math.pow(2,-u.z),d=u.x*l,p=(u.x+1)*l,h=u.y*l,_=(u.y+1)*l,x=dl(d),C=dl(p),M=ka(h),v=ka(_),S=a.project(x,M),A=a.project(C,M),D=a.project(C,v),I=a.project(x,v),O=Math.min(S.x,A.x,D.x,I.x),z=Math.min(S.y,A.y,D.y,I.y),B=Math.max(S.x,A.x,D.x,I.x),G=Math.max(S.y,A.y,D.y,I.y),$=l/16;function H(ee,ne,ve,pe,fe,Fe){let be=(ve+fe)/2,Be=(pe+Fe)/2,$e=a.project(dl(be),ka(Be)),Ue=Math.max(0,O-$e.x,z-$e.y,$e.x-B,$e.y-G);O=Math.min(O,$e.x),B=Math.max(B,$e.x),z=Math.min(z,$e.y),G=Math.max(G,$e.y),Ue>$&&(H(ee,$e,ve,pe,be,Be),H($e,ne,be,Be,fe,Fe))}H(S,A,d,h,p,h),H(A,D,p,h,p,_),H(D,I,p,_,d,_),H(I,S,d,_,d,h),O-=$,z-=$,B+=$,G+=$;let K=1/Math.max(B-O,G-z);return{scale:K,x:O*K,y:z*K,x2:B*K,y2:G*K,projection:a}}function x5(u,{x:a,y:l},d=0){return new Wt(((a-d)*u.scale-u.x)*$t,(l*u.scale-u.y)*$t)}let gQ=ge.mat4.identity(new Float32Array(16));class kf{constructor(a){this.spec=a,this.name=a.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(a,l){return{x:0,y:0,z:0}}unproject(a,l){return new er(0,0)}projectTilePoint(a,l,d){return{x:a,y:l,z:0}}locationPoint(a,l,d,p=!0){return a._coordinatePoint(a.locationCoordinate(l,d),p)}pixelsPerMeter(a,l){return $a(1,a)*l}pixelSpaceConversion(a,l,d){return 1}farthestPixelDistance(a){return b5(a,a.pixelsPerMeter)}pointCoordinate(a,l,d,p){let h=a.horizonLineFromTop(!1),_=new Wt(l,Math.max(h,d));return a.rayIntersectionCoordinate(a.pointRayIntersection(_,p))}pointCoordinate3D(a,l,d){let p=new Wt(l,d);if(a.elevation)return a.elevation.pointCoordinate(p);{let h=this.pointCoordinate(a,p.x,p.y,0);return[h.x,h.y,h.z]}}isPointAboveHorizon(a,l){if(a.elevation&&a.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(a,l.x,l.y);let d=a.horizonLineFromTop();return l.y<d}createInversionMatrix(a,l){return gQ}createTileMatrix(a,l,d){let p,h,_,x=d.canonical,C=ge.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){let M=i1(x,this);p=1,h=M.x+d.wrap*M.scale,_=M.y,ge.mat4.scale(C,C,[p/M.scale,p/M.scale,a.pixelsPerMeter/l])}else p=l/a.zoomScale(x.z),h=(x.x+Math.pow(2,x.z)*d.wrap)*p,_=x.y*p;return ge.mat4.translate(C,C,[h,_,0]),ge.mat4.scale(C,C,[p/$t,p/$t,1]),C}upVector(a,l,d){return[0,0,1]}upVectorScale(a,l,d){return{metersToTile:1}}}class _Q extends kf{constructor(a){super(a),this.range=[4,7],this.center=a.center||[-96,37.5];let[l,d]=this.parallels=a.parallels||[29.5,45.5],p=Math.sin(Mn(l));this.n=(p+Math.sin(Mn(d)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(a,l){let{n:d,c:p,r0:h}=this,_=Mn(a-this.center[0]),x=Mn(l),C=Math.sqrt(p-2*d*Math.sin(x))/d;return{x:C*Math.sin(_*d),y:C*Math.cos(_*d)-h,z:0}}unproject(a,l){let{n:d,c:p,r0:h}=this,_=h+l,x=Math.atan2(a,Math.abs(_))*Math.sign(_);_*d<0&&(x-=Math.PI*Math.sign(a)*Math.sign(_));let C=Mn(this.center[0])*d;x=hu(x,-Math.PI-C,Math.PI-C);let M=pn(Ho(x/d)+this.center[0],-180,180),v=Math.asin(pn((p-(a*a+_*_)*d*d)/(2*d),-1,1)),S=pn(Ho(v),-vo,vo);return new er(M,S)}}let n1=1.340264,r1=-.081106,o1=893e-6,a1=.003796,oC=Math.sqrt(3)/2;class yQ extends kf{project(a,l){l=l/180*Math.PI,a=a/180*Math.PI;let d=Math.asin(oC*Math.sin(l)),p=d*d,h=p*p*p;return{x:.5*(a*Math.cos(d)/(oC*(n1+3*r1*p+h*(7*o1+9*a1*p)))/Math.PI+.5),y:1-.5*(d*(n1+r1*p+h*(o1+a1*p))/Math.PI+1),z:0}}unproject(a,l){a=(2*a-.5)*Math.PI;let d=l=(2*(1-l)-1)*Math.PI,p=d*d,h=p*p*p;for(let v,S,A,D=0;D<12&&(S=d*(n1+r1*p+h*(o1+a1*p))-l,A=n1+3*r1*p+h*(7*o1+9*a1*p),v=S/A,d=pn(d-v,-Math.PI/3,Math.PI/3),p=d*d,h=p*p*p,!(Math.abs(v)<1e-12));++D);let _=oC*a*(n1+3*r1*p+h*(7*o1+9*a1*p))/Math.cos(d),x=Math.asin(Math.sin(d)/oC),C=pn(180*_/Math.PI,-180,180),M=pn(180*x/Math.PI,-vo,vo);return new er(C,M)}}class vQ extends kf{constructor(a){super(a),this.wrap=!0,this.supportsWorldCopies=!0}project(a,l){return{x:.5+a/360,y:.5-l/360,z:0}}unproject(a,l){let d=360*(a-.5),p=pn(360*(.5-l),-vo,vo);return new er(d,p)}}let V_=Math.PI/2;function aC(u){return Math.tan((V_+u)/2)}class bQ extends kf{constructor(a){super(a),this.center=a.center||[0,30];let[l,d]=this.parallels=a.parallels||[30,30],p=Mn(l),h=Mn(d);this.southernCenter=p+h<0,this.southernCenter&&(p=-p,h=-h);let _=Math.cos(p),x=aC(p);this.n=p===h?Math.sin(p):Math.log(_/Math.cos(h))/Math.log(aC(h)/x),this.f=_*Math.pow(aC(p),this.n)/this.n}project(a,l){l=Mn(l),this.southernCenter&&(l=-l),a=Mn(a-this.center[0]);let d=1e-6,{n:p,f:h}=this;h>0?l<-V_+d&&(l=-V_+d):l>V_-d&&(l=V_-d);let _=h/Math.pow(aC(l),p),x=_*Math.sin(p*a),C=h-_*Math.cos(p*a);return x=.5*(x/Math.PI+.5),C=.5*(C/Math.PI+.5),{x,y:this.southernCenter?C:1-C,z:0}}unproject(a,l){a=(2*a-.5)*Math.PI,this.southernCenter&&(l=1-l),l=(2*(1-l)-.5)*Math.PI;let{n:d,f:p}=this,h=p-l,_=Math.sign(h),x=Math.sign(d)*Math.sqrt(a*a+h*h),C=Math.atan2(a,Math.abs(h))*_;h*d<0&&(C-=Math.PI*Math.sign(a)*_);let M=pn(Ho(C/d)+this.center[0],-180,180),v=pn(Ho(2*Math.atan(Math.pow(p/x,1/d))-V_),-vo,vo);return new er(M,this.southernCenter?-v:v)}}class w5 extends kf{constructor(a){super(a),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(a,l){return{x:Su(a),y:ul(l),z:0}}unproject(a,l){let d=dl(a),p=ka(l);return new er(d,p)}}let E5=Mn(vo);class xQ extends kf{project(a,l){let d=(l=Mn(l))*l,p=d*d;return{x:.5*((a=Mn(a))*(.8707-.131979*d+p*(p*(.003971*d-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(l*(1.007226+d*(.015085+p*(.028874*d-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(a,l){a=(2*a-.5)*Math.PI;let d=l=(2*(1-l)-1)*Math.PI,p=25,h=0,_=d*d;do{_=d*d;let M=_*_;h=(d*(1.007226+_*(.015085+M*(.028874*_-.044475-.005916*M)))-l)/(1.007226+_*(.045255+M*(.259866*_-.311325-.005916*11*M))),d=pn(d-h,-E5,E5)}while(Math.abs(h)>1e-6&&--p>0);_=d*d;let x=pn(Ho(a/(.8707+_*(_*(_*_*_*(.003971-.001529*_)-.013791)-.131979))),-180,180),C=Ho(d);return new er(x,C)}}let C5=Mn(vo);class wQ extends kf{project(a,l){l=Mn(l),a=Mn(a);let d=Math.cos(l),p=2/Math.PI,h=Math.acos(d*Math.cos(a/2)),_=Math.sin(h)/h,x=.5*(a*p+2*d*Math.sin(a/2)/_)||0,C=.5*(l+Math.sin(l)/_)||0;return{x:.5*(x/Math.PI+.5),y:1-.5*(C/Math.PI+1),z:0}}unproject(a,l){let d=a=(2*a-.5)*Math.PI,p=l=(2*(1-l)-1)*Math.PI,h=25,_=1e-6,x=0,C=0;do{let M=Math.cos(p),v=Math.sin(p),S=2*v*M,A=v*v,D=M*M,I=Math.cos(d/2),O=Math.sin(d/2),z=2*I*O,B=O*O,G=1-D*I*I,$=G?1/G:0,H=G?Math.acos(M*I)*Math.sqrt(1/G):0,K=.5*(2*H*M*O+2*d/Math.PI)-a,ee=.5*(H*v+p)-l,ne=.5*$*(D*B+H*M*I*A)+1/Math.PI,ve=$*(z*S/4-H*v*O),pe=.125*$*(S*O-H*v*D*z),fe=.5*$*(A*I+H*B*M)+.5,Fe=ve*pe-fe*ne;x=(ee*ve-K*fe)/Fe,C=(K*pe-ee*ne)/Fe,d=pn(d-x,-Math.PI,Math.PI),p=pn(p-C,-C5,C5)}while((Math.abs(x)>_||Math.abs(C)>_)&&--h>0);return new er(Ho(d),Ho(p))}}class S5 extends kf{constructor(a){super(a),this.center=a.center||[0,0],this.parallels=a.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Mn(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(a,l){let{scale:d,cosPhi:p}=this;return{x:Mn(a)*p*d+.5,y:-Math.sin(Mn(l))/p*d+.5,z:0}}unproject(a,l){let{scale:d,cosPhi:p}=this,h=-(l-.5)/d,_=pn(Ho((a-.5)/d)/p,-180,180),x=Math.asin(pn(h*p,-1,1)),C=pn(Ho(x),-vo,vo);return new er(_,C)}}class EQ extends w5{constructor(a){super(a),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(a,l,d){let p=ir(a,l,d),h=Ur(Jo(d));return ge.vec3.transformMat4(p,p,h),{x:p[0],y:p[1],z:p[2]}}locationPoint(a,l,d){let p=pp(l.lat,l.lng),h=ge.vec3.normalize([],p),_=d?a._centerAltitude+d:a.elevation?a.elevation.getAtPointOrZero(a.locationCoordinate(l),a._centerAltitude):a._centerAltitude,x=$a(1,0)*$t*_;ge.vec3.scaleAndAdd(p,p,h,x);let C=ge.mat4.identity(new Float64Array(16));return ge.mat4.multiply(C,a.pixelMatrix,a.globeMatrix),ge.vec3.transformMat4(p,p,C),new Wt(p[0],p[1])}pixelsPerMeter(a,l){return $a(1,0)*l}pixelSpaceConversion(a,l,d){let p=$a(1,a)*l,h=pi($a(1,45)*l,p,d);return this.pixelsPerMeter(a,l)/h}createTileMatrix(a,l,d){let p=ea(Jo(d.canonical));return ge.mat4.multiply(new Float64Array(16),a.globeMatrix,p)}createInversionMatrix(a,l){let{center:d}=a,p=Ur(Jo(l));return ge.mat4.rotateY(p,p,Mn(d.lng)),ge.mat4.rotateX(p,p,Mn(d.lat)),ge.mat4.scale(p,p,[a._pixelsPerMercatorPixel,a._pixelsPerMercatorPixel,1]),Float32Array.from(p)}pointCoordinate(a,l,d,p){return Yn(a,l,d,!0)||new s(0,0)}pointCoordinate3D(a,l,d){let p=this.pointCoordinate(a,l,d,0);return[p.x,p.y,p.z]}isPointAboveHorizon(a,l){return!Yn(a,l.x,l.y,!1)}farthestPixelDistance(a){let l=function(p,h){let _=p.cameraToCenterDistance,x=p._centerAltitude*h,C=p._camera,M=p._camera.forward(),v=ge.vec3.add([],ge.vec3.scale([],M,-_),[0,0,x]),S=p.worldSize/(2*Math.PI),A=[0,0,-S],D=p.width/p.height,I=Math.tan(p.fovAboveCenter),O=ge.vec3.scale([],C.up(),I),z=ge.vec3.scale([],C.right(),I*D),B=ge.vec3.normalize([],ge.vec3.add([],ge.vec3.add([],M,O),z)),G=[],$;if(new Fi(v,B).closestPointOnSphere(A,S,G)){let H=ge.vec3.add([],G,A),K=ge.vec3.sub([],H,v);$=Math.cos(p.fovAboveCenter)*ge.vec3.length(K)}else{let H=ge.vec3.sub([],v,A),K=ge.vec3.sub([],A,v);ge.vec3.normalize(K,K);let ee=ge.vec3.length(H)-S;$=Math.sqrt(ee*(ee+2*S));let ne=Math.acos($/(S+ee))-Math.acos(ge.vec3.dot(M,K));$*=Math.cos(ne)}return 1.01*$}(a,this.pixelsPerMeter(a.center.lat,a.worldSize)),d=Ws(a.zoom);if(d>0){let p=b5(a,$a(1,a.center.lat)*a.worldSize),h=a.worldSize/(2*Math.PI),_=Math.max(a.width,a.height)/a.worldSize*Math.PI;return pi(l,p+h*(1-Math.cos(_)),Math.pow(d,10))}return l}upVector(a,l,d){return ir(l,d,a,1)}upVectorScale(a){return{metersToTile:Pn(Tr(Jo(a)))}}}function T5(u){let a=u.parallels,l=!!a&&Math.abs(a[0]+a[1])<.01;switch(u.name){case"mercator":return new w5(u);case"equirectangular":return new vQ(u);case"naturalEarth":return new xQ(u);case"equalEarth":return new yQ(u);case"winkelTripel":return new wQ(u);case"albers":return l?new S5(u):new _Q(u);case"lambertConformalConic":return l?new S5(u):new bQ(u);case"globe":return new EQ(u)}throw new Error(`Invalid projection name: ${u.name}`)}let CQ=Mf.VectorTileFeature.types,SQ=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function sC(u,a,l,d,p,h,_,x,C,M,v,S,A){let D=x?Math.min(Rf,Math.round(x[0])):0,I=x?Math.min(Rf,Math.round(x[1])):0;u.emplaceBack(a,l,Math.round(32*d),Math.round(32*p),h,_,(D<<1)+(C?1:0),I,16*M,16*v,256*S,256*A)}function lC(u,a,l){u.emplaceBack(a,l)}function cC(u,a,l,d,p,h,_){u.emplaceBack(a,l,d,p,h,_)}function uC(u,a,l,d,p){u.emplaceBack(a,l,d,p),u.emplaceBack(a,l,d,p),u.emplaceBack(a,l,d,p),u.emplaceBack(a,l,d,p)}function TQ(u){for(let a of u.sections)if(bE(a.text))return!0;return!1}class xA{constructor(a){this.layoutVertexArray=new wb,this.indexArray=new Ra,this.programConfigurations=a,this.segments=new Zr,this.dynamicLayoutVertexArray=new up,this.opacityVertexArray=new Cb,this.placedSymbolArray=new IE,this.iconTransitioningVertexArray=new gh,this.globeExtVertexArray=new Eb,this.zOffsetVertexArray=new cp}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(a,l,d,p,h){this.isEmpty()||(d&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,jX.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,HX.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,SQ,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=a.createVertexBuffer(this.iconTransitioningVertexArray,$X.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=a.createVertexBuffer(this.globeExtVertexArray,UX.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||h)&&(this.zOffsetVertexBuffer=a.createVertexBuffer(this.zOffsetVertexArray,qX.members,!0)),this.opacityVertexBuffer.itemSize=1),(d||p)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}ii(xA,"SymbolBuffers");class wA{constructor(a,l,d){this.layoutVertexArray=new a,this.layoutAttributes=l,this.indexArray=new d,this.segments=new Zr,this.collisionVertexArray=new Db,this.collisionVertexArrayExt=new up}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,GX.members,!0),this.collisionVertexBufferExt=a.createVertexBuffer(this.collisionVertexArrayExt,WX.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}ii(wA,"CollisionBuffers");class dC{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.lut=a.lut,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(_=>_.fqid),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ge.mat4.identity([]),this.placementViewportMatrix=ge.mat4.identity([]);let l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=uA(this.zoom,l["text-size"]),this.iconSizeData=uA(this.zoom,l["icon-size"]);let d=this.layers[0].layout,p=d.get("symbol-sort-key"),h=d.get("symbol-z-order");this.canOverlap=d.get("text-allow-overlap")||d.get("icon-allow-overlap")||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=h!=="viewport-y"&&p.constantOr(1)!==void 0,this.sortFeaturesByY=(h==="viewport-y"||h==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=d.get("text-writing-mode").map(_=>Vl[_]),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=a.sourceID,this.projection=a.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new xA(new yh(this.layers,{zoom:this.zoom,lut:this.lut},a=>a.startsWith("text")||a.startsWith("symbol"))),this.icon=new xA(new yh(this.layers,{zoom:this.zoom,lut:this.lut},a=>a.startsWith("icon")||a.startsWith("symbol"))),this.glyphOffsetArray=new kE,this.lineVertexArray=new cg,this.symbolInstances=new RE}calculateGlyphDependencies(a,l,d,p,h){for(let _ of a){let x=_.codePointAt(0);if(x===void 0)break;if(l[x]=!0,p&&h&&x<=65535){let C=Xb[_];C&&(l[C.charCodeAt(0)]=!0)}}}updateFootprints(a,l){}updateReplacement(a,l){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;let d=l.getReplacementRegionsForTile(a.toUnwrapped(),!0);return!nA(this.activeReplacements,d)&&(this.activeReplacements=d,!0)}populate(a,l,d,p){let h=this.layers[0],_=h.layout,x=this.projection.name==="globe",C=_.get("text-font"),M=_.get("text-field"),v=_.get("icon-image"),[S,A]=_.get("icon-size-scale-range"),D=pn(l.scaleFactor||1,S,A),I=(M.value.kind!=="constant"||M.value.value instanceof Aa&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&(C.value.kind!=="constant"||C.value.value.length>0),O=v.value.kind!=="constant"||!!v.value.value||Object.keys(v.parameters).length>0,z=_.get("symbol-sort-key");if(this.features=[],!I&&!O)return;let B=l.iconDependencies,G=l.glyphDependencies,$=l.availableImages,H=new Ar(this.zoom);for(let{feature:K,id:ee,index:ne,sourceLayerIndex:ve}of a){let pe=h._featureFilter.needGeometry,fe=F(K,pe);if(!h._featureFilter.filter(H,fe,d))continue;if(pe||(fe.geometry=L(K,d,p)),x&&K.type!==1&&d.z<=5){let Ue=fe.geometry,Ye=.98078528056,Ze=(rt,Je)=>{let ot=ir(rt.x,rt.y,d,1),kt=ir(Je.x,Je.y,d,1);return ge.vec3.dot(ot,kt)<Ye};for(let rt=0;rt<Ue.length;rt++)Ue[rt]=b(Ue[rt],Ze)}let Fe,be;if(I){let Ue=h.getValueAndResolveTokens("text-field",fe,d,$),Ye=Aa.factory(Ue);TQ(Ye)&&(this.hasRTLText=!0),(!this.hasRTLText||m_()==="unavailable"||this.hasRTLText&&lc.isParsed())&&(Fe=KX(Ye,h,fe))}if(O){let Ue=h.getValueAndResolveTokens("icon-image",fe,d,$);be=Ue instanceof va?Ue:va.build(Ue)}if(!Fe&&!be)continue;let Be=this.sortFeaturesByKey?z.evaluate(fe,{},d):void 0,$e={id:ee,text:Fe,icon:be,index:ne,sourceLayerIndex:ve,geometry:fe.geometry,properties:K.properties,type:CQ[K.type],sortKey:Be};if(this.features.push($e),be){let Ue=this.layers[0]._unevaluatedLayout._values,{iconPrimary:Ye,iconSecondary:Ze}=g5(be,this.iconSizeData,Ue["icon-size"],d,this.zoom,$e,this.pixelRatio,D),rt=Ye.id.toString();if(B.has(rt)?B.get(rt).push(Ye):B.set(rt,[Ye]),Ze){let Je=Ze.id.toString();B.has(Je)?B.get(Je).push(Ze):B.set(Je,[Ze])}}if(Fe){let Ue=C.evaluate(fe,{},d).join(","),Ye=_.get("text-rotation-alignment")==="map"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Vl.vertical)>=0;for(let Ze of Fe.sections)if(Ze.image){let rt=Ze.image.getPrimary().scaleSelf(this.pixelRatio),Je=rt.id.toString(),ot=B.get(Je)||[];ot.push(rt),B.set(Je,ot)}else{let rt=lb(Fe.toString()),Je=Ze.fontStack||Ue,ot=G[Je]=G[Je]||{};this.calculateGlyphDependencies(Ze.text,ot,Ye,this.allowVerticalPlacement,rt)}}}if(_.get("symbol-placement")==="line"&&(this.features=function(K){let ee={},ne={},ve=[],pe=0;function fe($e){ve.push(K[$e]),pe++}function Fe($e,Ue,Ye){let Ze=ne[$e];return delete ne[$e],ne[Ue]=Ze,ve[Ze].geometry[0].pop(),ve[Ze].geometry[0]=ve[Ze].geometry[0].concat(Ye[0]),Ze}function be($e,Ue,Ye){let Ze=ee[Ue];return delete ee[Ue],ee[$e]=Ze,ve[Ze].geometry[0].shift(),ve[Ze].geometry[0]=Ye[0].concat(ve[Ze].geometry[0]),Ze}function Be($e,Ue,Ye){let Ze=Ye?Ue[0][Ue[0].length-1]:Ue[0][0];return`${$e}:${Ze.x}:${Ze.y}`}for(let $e=0;$e<K.length;$e++){let Ue=K[$e],Ye=Ue.geometry,Ze=Ue.text?Ue.text.toString():null;if(!Ze){fe($e);continue}let rt=Be(Ze,Ye),Je=Be(Ze,Ye,!0);if(rt in ne&&Je in ee&&ne[rt]!==ee[Je]){let ot=be(rt,Je,Ye),kt=Fe(rt,Je,ve[ot].geometry);delete ee[rt],delete ne[Je],ne[Be(Ze,ve[kt].geometry,!0)]=kt,ve[ot].geometry=null}else rt in ne?Fe(rt,Je,Ye):Je in ee?be(rt,Je,Ye):(fe($e),ee[rt]=pe-1,ne[Je]=pe-1)}return ve.filter($e=>$e.geometry)}(this.features)),_.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",l.elevationFeatures){!this.elevationFeatures&&l.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(let K of l.elevationFeatures)this.elevationFeatureIdToIndex.set(K.id,this.elevationFeatures.length),this.elevationFeatures.push(K)}}else _.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((K,ee)=>K.sortKey-ee.sortKey)}update(a,l,d,p,h,_,x){this.text.programConfigurations.updatePaintArrays(a,l,h,d,p,_,x),this.icon.programConfigurations.updatePaintArrays(a,l,h,d,p,_,x)}updateRoadElevation(){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let a=!1;for(let l=0;l<this.symbolInstances.length;l++){let d=this.symbolInstances.get(l);if(d.elevationFeatureIndex===65535)continue;let p=this.elevationFeatures[d.elevationFeatureIndex];if(p){let h=.05+p.pointElevation(new Wt(d.tileAnchorX,d.tileAnchorY));d.zOffset!==h&&(a=!0,d.zOffset=h)}}a&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){let a=(h,_,x)=>{d+=_,d>h.length&&h.resize(d);for(let C=-_;C<0;C++)h.emplace(C+d,x)},l=(h,_,x)=>{p+=_,p>h.length&&h.resize(p);for(let C=-_;C<0;C++)h.emplace(C+p,x)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let d=0,p=0;for(let h=0;h<this.symbolInstances.length;h++){let _=this.symbolInstances.get(h),{numHorizontalGlyphVertices:x,numVerticalGlyphVertices:C,numIconVertices:M}=_,v=_.zOffset,S=M>0;if((x>0||C>0)&&(a(this.text.zOffsetVertexArray,x,v),a(this.text.zOffsetVertexArray,C,v)),S){let{placedIconSymbolIndex:A,verticalPlacedIconSymbolIndex:D}=_;A>=0&&l(this.icon.zOffsetVertexArray,M,v),D>=0&&l(this.icon.zOffsetVertexArray,_.numVerticalIconVertices,v)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=T5(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,l){let d=this.lineVertexArray.length;if(a.segment!==void 0)for(let{x:p,y:h}of l)this.lineVertexArray.emplaceBack(p,h);return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(a,l,d,p,h,_,x,C,M,v,S,A,D,I,O,z){let B=a.indexArray,G=a.layoutVertexArray,$=a.globeExtVertexArray,H=a.segments.prepareSegment(4*l.length,G,B,this.canOverlap?_.sortKey:void 0),K=this.glyphOffsetArray.length,ee=H.vertexLength,ne=this.allowVerticalPlacement&&x===Vl.vertical?Math.PI/2:0,ve=_.text&&_.text.sections;for(let fe=0;fe<l.length;fe++){let{tl:Fe,tr:be,bl:Be,br:$e,texPrimary:Ue,texSecondary:Ye,pixelOffsetTL:Ze,pixelOffsetBR:rt,minFontScaleX:Je,minFontScaleY:ot,glyphOffset:kt,isSDF:Mt,sectionIndex:ni}=l[fe],Vt=H.vertexLength,qt=kt[1];if(sC(G,M.x,M.y,Fe.x,qt+Fe.y,Ue.x,Ue.y,d,Mt,Ze.x,Ze.y,Je,ot),sC(G,M.x,M.y,be.x,qt+be.y,Ue.x+Ue.w,Ue.y,d,Mt,rt.x,Ze.y,Je,ot),sC(G,M.x,M.y,Be.x,qt+Be.y,Ue.x,Ue.y+Ue.h,d,Mt,Ze.x,rt.y,Je,ot),sC(G,M.x,M.y,$e.x,qt+$e.y,Ue.x+Ue.w,Ue.y+Ue.h,d,Mt,rt.x,rt.y,Je,ot),C){let{x:Lt,y:Ri,z:Jt}=C.anchor,[mi,Hi,mn]=C.up;cC($,Lt,Ri,Jt,mi,Hi,mn),cC($,Lt,Ri,Jt,mi,Hi,mn),cC($,Lt,Ri,Jt,mi,Hi,mn),cC($,Lt,Ri,Jt,mi,Hi,mn),uC(a.dynamicLayoutVertexArray,Lt,Ri,Jt,ne)}else uC(a.dynamicLayoutVertexArray,M.x,M.y,M.z,ne);if(z){let Lt=Ye||Ue;lC(a.iconTransitioningVertexArray,Lt.x,Lt.y),lC(a.iconTransitioningVertexArray,Lt.x+Lt.w,Lt.y),lC(a.iconTransitioningVertexArray,Lt.x,Lt.y+Lt.h),lC(a.iconTransitioningVertexArray,Lt.x+Lt.w,Lt.y+Lt.h)}B.emplaceBack(Vt,Vt+1,Vt+2),B.emplaceBack(Vt+1,Vt+2,Vt+3),H.vertexLength+=4,H.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(kt[0]),fe!==l.length-1&&ni===l[fe+1].sectionIndex||a.programConfigurations.populatePaintArrays(G.length,_,_.index,{},D,I,O,ve&&ve[ni])}let pe=C?C.anchor:M;a.placedSymbolArray.emplaceBack(pe.x,pe.y,pe.z,M.x,M.y,K,this.glyphOffsetArray.length-K,ee,v,S,M.segment,d?d[0]:0,d?d[1]:0,p[0],p[1],x,0,!1,0,A,0)}_commitLayoutVertex(a,l,d,p,h,_,x){a.emplaceBack(l,d,p,h,_,Math.round(x.x),Math.round(x.y))}_addCollisionDebugVertices(a,l,d,p,h,_,x){let C=d.segments.prepareSegment(4,d.layoutVertexArray,d.indexArray),M=C.vertexLength,v=x.tileAnchorX,S=x.tileAnchorY;for(let D=0;D<4;D++)d.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(d.collisionVertexArrayExt,l,a.padding,x.zOffset),this._commitLayoutVertex(d.layoutVertexArray,p,h,_,v,S,new Wt(a.x1,a.y1)),this._commitLayoutVertex(d.layoutVertexArray,p,h,_,v,S,new Wt(a.x2,a.y1)),this._commitLayoutVertex(d.layoutVertexArray,p,h,_,v,S,new Wt(a.x2,a.y2)),this._commitLayoutVertex(d.layoutVertexArray,p,h,_,v,S,new Wt(a.x1,a.y2)),C.vertexLength+=4;let A=d.indexArray;A.emplaceBack(M,M+1),A.emplaceBack(M+1,M+2),A.emplaceBack(M+2,M+3),A.emplaceBack(M+3,M),C.primitiveLength+=4}_addTextDebugCollisionBoxes(a,l,d,p,h,_){for(let x=p;x<h;x++){let C=d.get(x),M=this.getSymbolInstanceTextSize(a,_,l,x);this._addCollisionDebugVertices(C,M,this.textCollisionBox,C.projectedAnchorX,C.projectedAnchorY,C.projectedAnchorZ,_)}}_addIconDebugCollisionBoxes(a,l,d,p,h,_){for(let x=p;x<h;x++){let C=d.get(x),M=this.getSymbolInstanceIconSize(a,l,_.placedIconSymbolIndex);this._addCollisionDebugVertices(C,M,this.iconCollisionBox,C.projectedAnchorX,C.projectedAnchorY,C.projectedAnchorZ,_)}}generateCollisionDebugBuffers(a,l,d){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new wA(ag,U6.members,gh),this.iconCollisionBox=new wA(ag,U6.members,gh);let p=N_(this.iconSizeData,a),h=N_(this.textSizeData,a,d);for(let _=0;_<this.symbolInstances.length;_++){let x=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(h,a,l,x.textBoxStartIndex,x.textBoxEndIndex,x),this._addTextDebugCollisionBoxes(h,a,l,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._addIconDebugCollisionBoxes(p,a,l,x.iconBoxStartIndex,x.iconBoxEndIndex,x),this._addIconDebugCollisionBoxes(p,a,l,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x)}}getSymbolInstanceTextSize(a,l,d,p){let h=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:p),_=QE(this.textSizeData,a,h)/Wa;return this.tilePixelRatio*_}getSymbolInstanceIconSize(a,l,d){let p=this.icon.placedSymbolArray.get(d),h=QE(this.iconSizeData,a,p);return this.tilePixelRatio*h}_commitDebugCollisionVertexUpdate(a,l,d,p){a.emplaceBack(l,-d,-d,p),a.emplaceBack(l,d,-d,p),a.emplaceBack(l,d,d,p),a.emplaceBack(l,-d,d,p)}_updateTextDebugCollisionBoxes(a,l,d,p,h,_,x){for(let C=p;C<h;C++){let M=d.get(C),v=this.getSymbolInstanceTextSize(a,_,l,C);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,v,M.padding,_.zOffset)}}_updateIconDebugCollisionBoxes(a,l,d,p,h,_,x){for(let C=p;C<h;C++){let M=d.get(C),v=this.getSymbolInstanceIconSize(a,l,_.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,v,M.padding,_.zOffset)}}updateCollisionDebugBuffers(a,l,d,p){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();let h=N_(this.iconSizeData,a,p),_=N_(this.textSizeData,a,d);for(let x=0;x<this.symbolInstances.length;x++){let C=this.symbolInstances.get(x);this._updateTextDebugCollisionBoxes(_,a,l,C.textBoxStartIndex,C.textBoxEndIndex,C,d),this._updateTextDebugCollisionBoxes(_,a,l,C.verticalTextBoxStartIndex,C.verticalTextBoxEndIndex,C,d),this._updateIconDebugCollisionBoxes(h,a,l,C.iconBoxStartIndex,C.iconBoxEndIndex,C,p),this._updateIconDebugCollisionBoxes(h,a,l,C.verticalIconBoxStartIndex,C.verticalIconBoxEndIndex,C,p)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(a,l,d,p,h,_,x,C,M){let v={};if(l<d){let{x1:S,y1:A,x2:D,y2:I,padding:O,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:G,tileAnchorX:$,tileAnchorY:H,featureIndex:K}=a.get(l);v.textBox={x1:S,y1:A,x2:D,y2:I,padding:O,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:G,tileAnchorX:$,tileAnchorY:H},v.textFeatureIndex=K}if(p<h){let{x1:S,y1:A,x2:D,y2:I,padding:O,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:G,tileAnchorX:$,tileAnchorY:H,featureIndex:K}=a.get(p);v.verticalTextBox={x1:S,y1:A,x2:D,y2:I,padding:O,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:G,tileAnchorX:$,tileAnchorY:H},v.verticalTextFeatureIndex=K}if(_<x){let{x1:S,y1:A,x2:D,y2:I,padding:O,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:G,tileAnchorX:$,tileAnchorY:H,featureIndex:K}=a.get(_);v.iconBox={x1:S,y1:A,x2:D,y2:I,padding:O,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:G,tileAnchorX:$,tileAnchorY:H},v.iconFeatureIndex=K}if(C<M){let{x1:S,y1:A,x2:D,y2:I,padding:O,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:G,tileAnchorX:$,tileAnchorY:H,featureIndex:K}=a.get(C);v.verticalIconBox={x1:S,y1:A,x2:D,y2:I,padding:O,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:G,tileAnchorX:$,tileAnchorY:H},v.verticalIconFeatureIndex=K}return v}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){let d=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(a,l){let d=a.placedSymbolArray.get(l),p=d.vertexStartIndex+4*d.numGlyphs;for(let h=d.vertexStartIndex;h<p;h+=4)a.indexArray.emplaceBack(h,h+1,h+2),a.indexArray.emplaceBack(h+1,h+2,h+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let l=Math.sin(a),d=Math.cos(a),p=[],h=[],_=[];for(let x=0;x<this.symbolInstances.length;++x){_.push(x);let C=this.symbolInstances.get(x);p.push(0|Math.round(l*C.tileAnchorX+d*C.tileAnchorY)),h.push(C.featureIndex)}return _.sort((x,C)=>p[x]-p[C]||h[C]-h[x]),_}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let a=0;a<this.symbolInstances.length;++a)this.symbolInstanceIndexesSortedZOffset.push(a)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((a,l)=>this.symbolInstances.get(l).zOffset-this.symbolInstances.get(a).zOffset)}addToSortKeyRanges(a,l){let d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===l?d.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let l of this.symbolInstanceIndexes){let d=this.symbolInstances.get(l);this.featureSortOrder.push(d.featureIndex);let{rightJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:h,leftJustifiedTextSymbolIndex:_,verticalPlacedTextSymbolIndex:x,placedIconSymbolIndex:C,verticalPlacedIconSymbolIndex:M}=d;p>=0&&this.addIndicesForPlacedSymbol(this.text,p),h>=0&&h!==p&&this.addIndicesForPlacedSymbol(this.text,h),_>=0&&_!==h&&_!==p&&this.addIndicesForPlacedSymbol(this.text,_),x>=0&&this.addIndicesForPlacedSymbol(this.text,x),C>=0&&this.addIndicesForPlacedSymbol(this.icon,C),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let D5,M5,EA;ii(dC,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),dC.addDynamicAttributes=uC;class I5{constructor(a){this.type=a.property.overrides?a.property.overrides.runtimeType:_u,this.defaultValue=a}evaluate(a){if(a.formattedSection){let l=this.defaultValue.property.overrides;if(l&&l.hasOverride(a.formattedSection))return l.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ii(I5,"FormatSectionOverride",{omit:["defaultValue"]});let CA=()=>EA||(EA={layout:D5||(D5=new no({"symbol-placement":new Ht(lt.layout_symbol["symbol-placement"]),"symbol-spacing":new Ht(lt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ht(lt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ti(lt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ht(lt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Ht(lt.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Ht(lt.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Ht(lt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ht(lt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ht(lt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ht(lt.layout_symbol["icon-rotation-alignment"]),"icon-size":new ti(lt.layout_symbol["icon-size"]),"icon-size-scale-range":new Ht(lt.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new ti(lt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ti(lt.layout_symbol["icon-text-fit-padding"]),"icon-image":new ti(lt.layout_symbol["icon-image"]),"icon-rotate":new ti(lt.layout_symbol["icon-rotate"]),"icon-padding":new Ht(lt.layout_symbol["icon-padding"]),"icon-keep-upright":new Ht(lt.layout_symbol["icon-keep-upright"]),"icon-offset":new ti(lt.layout_symbol["icon-offset"]),"icon-anchor":new ti(lt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ht(lt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ht(lt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ht(lt.layout_symbol["text-rotation-alignment"]),"text-field":new ti(lt.layout_symbol["text-field"]),"text-font":new ti(lt.layout_symbol["text-font"]),"text-size":new ti(lt.layout_symbol["text-size"]),"text-size-scale-range":new Ht(lt.layout_symbol["text-size-scale-range"]),"text-max-width":new ti(lt.layout_symbol["text-max-width"]),"text-line-height":new ti(lt.layout_symbol["text-line-height"]),"text-letter-spacing":new ti(lt.layout_symbol["text-letter-spacing"]),"text-justify":new ti(lt.layout_symbol["text-justify"]),"text-radial-offset":new ti(lt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ht(lt.layout_symbol["text-variable-anchor"]),"text-anchor":new ti(lt.layout_symbol["text-anchor"]),"text-max-angle":new Ht(lt.layout_symbol["text-max-angle"]),"text-writing-mode":new Ht(lt.layout_symbol["text-writing-mode"]),"text-rotate":new ti(lt.layout_symbol["text-rotate"]),"text-padding":new Ht(lt.layout_symbol["text-padding"]),"text-keep-upright":new Ht(lt.layout_symbol["text-keep-upright"]),"text-transform":new ti(lt.layout_symbol["text-transform"]),"text-offset":new ti(lt.layout_symbol["text-offset"]),"text-allow-overlap":new Ht(lt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ht(lt.layout_symbol["text-ignore-placement"]),"text-optional":new Ht(lt.layout_symbol["text-optional"]),visibility:new Ht(lt.layout_symbol.visibility)})),paint:M5||(M5=new no({"icon-opacity":new ti(lt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new ti(lt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new ti(lt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new ti(lt.paint_symbol["text-emissive-strength"]),"icon-color":new ti(lt.paint_symbol["icon-color"]),"icon-halo-color":new ti(lt.paint_symbol["icon-halo-color"]),"icon-halo-width":new ti(lt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ti(lt.paint_symbol["icon-halo-blur"]),"icon-translate":new Ht(lt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ht(lt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new ti(lt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new ti(lt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new ti(lt.paint_symbol["text-occlusion-opacity"]),"text-color":new ti(lt.paint_symbol["text-color"],{runtimeType:Xo,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new ti(lt.paint_symbol["text-halo-color"]),"text-halo-width":new ti(lt.paint_symbol["text-halo-width"]),"text-halo-blur":new ti(lt.paint_symbol["text-halo-blur"]),"text-translate":new Ht(lt.paint_symbol["text-translate"]),"text-translate-anchor":new Ht(lt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Ht(lt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Ht(lt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Ht(lt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Ht(lt.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new ti(lt.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"})}))},EA);class hC extends xa{constructor(a,l,d,p){super(a,CA(),l,d,p),this._colorAdjustmentMatrix=ge.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=a.paint!==void 0&&("icon-occlusion-opacity"in a.paint||"text-occlusion-opacity"in a.paint)}recalculate(a,l){super.recalculate(a,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));let d=this.layout.get("text-writing-mode");if(d){let p=[];for(let h of d)p.indexOf(h)<0&&p.push(h);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(a,l,d,p){return this._saturation===a&&this._contrast===l&&this._brightnessMin===d&&this._brightnessMax===p||(this._colorAdjustmentMatrix=function(h,_,x,C){h=mt(h),_=fu(_);let M=ge.mat4.create(),v=h/3,S=1-2*v,A=[S,v,v,0,v,S,v,0,v,v,S,0,0,0,0,1],D=.5-.5*_,I=C-x;return ge.mat4.multiply(M,[I,0,0,0,0,I,0,0,0,0,I,0,x,x,x,1],[_,0,0,0,0,_,0,0,0,0,_,0,D,D,D,1]),ge.mat4.multiply(M,M,A),M}(a,l,d,p),this._saturation=a,this._contrast=l,this._brightnessMin=d,this._brightnessMax=p),this._colorAdjustmentMatrix}getValueAndResolveTokens(a,l,d,p){let h=this.layout.get(a).evaluate(l,{},d,p),_=this._unevaluatedLayout._values[a];return _.isDataDriven()||s_(_.value)||!h?h:function(x,C){return C.replace(/{([^{}]+)}/g,(M,v)=>v in x?String(x[v]):"")}(l.properties,h)}createBucket(a){return new dC(a)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(let a of CA().paint.overridableProperties){if(!hC.hasPaintOverride(this.layout,a))continue;let l=this.paint.get(a),d=new I5(l),p=new nb(d,l.property.specification,this.scope,this.options),h=null;h=l.value.kind==="constant"||l.value.kind==="source"?new rb("source",p):new uf("composite",p,l.value.zoomStops,l.value._interpolationType),this.paint._values[a]=new mf(l.property,h,l.parameters)}}_handleOverridablePaintPropertyUpdate(a,l,d){return!(!this.layout||l.isDataDriven()||d.isDataDriven())&&hC.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,l){let d=a.get("text-field"),p=CA().paint.properties[l],h=!1,_=x=>{for(let C of x)if(p.overrides&&p.overrides.hasOverride(C))return void(h=!0)};if(d.value.kind==="constant"&&d.value.value instanceof Aa)_(d.value.value.sections);else if(d.value.kind==="source"){let x=M=>{h||(M instanceof Fc&&Do(M.value)===yu?_(M.value.sections):M instanceof nh?_(M.sections):M.eachChild(x))},C=d.value;C._styleExpression&&x(C._styleExpression.expression)}return h}getProgramIds(){return["symbol"]}getDefaultProgramParams(a,l,d){return{config:new hp(this,{zoom:l,lut:d}),overrideFog:!1}}}let A5,R5,k5,O5;var SA=Jn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function TA(u){switch(u){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function DA(u){switch(u){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class MA{constructor(a,l,d,p){this.context=a,this.format=d,this.useMipmap=p&&p.useMipmap,this.texture=a.gl.createTexture(),this.update(l,{premultiply:p&&p.premultiply})}update(a,l){let d=a&&a instanceof HTMLVideoElement&&a.width===0?a.videoWidth:a.width,p=a&&a instanceof HTMLVideoElement&&a.height===0?a.videoHeight:a.height,{context:h}=this,{gl:_}=h,{x,y:C}=l&&l.position?l.position:{x:0,y:0},M=x+d,v=C+p;!this.size||this.size[0]===M&&this.size[1]===v||(_.bindTexture(_.TEXTURE_2D,null),_.deleteTexture(this.texture),this.texture=_.createTexture(),this.size=null),_.bindTexture(_.TEXTURE_2D,this.texture),h.pixelStoreUnpackFlipY.set(!1),h.pixelStoreUnpack.set(1),h.pixelStoreUnpackPremultiplyAlpha.set(this.format===_.RGBA8&&(!l||l.premultiply!==!1));let S=a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||ImageBitmap&&a instanceof ImageBitmap;if(!this.size&&M>0&&v>0){let A=this.useMipmap?Math.floor(Math.log2(Math.max(M,v)))+1:1;_.texStorage2D(_.TEXTURE_2D,A,this.format,M,v),this.size=[M,v]}if(this.size)if(S)_.texSubImage2D(_.TEXTURE_2D,0,x,C,TA(this.format),DA(this.format),a);else{let A=a.data;A&&_.texSubImage2D(_.TEXTURE_2D,0,x,C,d,p,TA(this.format),DA(this.format),A)}this.useMipmap&&_.generateMipmap(_.TEXTURE_2D)}bind(a,l,d=!1){let{context:p}=this,{gl:h}=p;h.bindTexture(h.TEXTURE_2D,this.texture),a!==this.minFilter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,a),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap&&!d?a===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_LINEAR:a),this.minFilter=a),l!==this.wrapS&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,l),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,l),this.wrapS=l)}bindExtraParam(a,l,d,p){let{context:h}=this,{gl:_}=h;_.bindTexture(_.TEXTURE_2D,this.texture),l!==this.magFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,l),this.magFilter=l),a!==this.minFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,this.useMipmap?a===_.NEAREST?_.NEAREST_MIPMAP_NEAREST:_.LINEAR_MIPMAP_LINEAR:a),this.minFilter=a),d!==this.wrapS&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,d),this.wrapS=d),p!==this.wrapT&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,p),this.wrapT=p)}destroy(){let{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}class pC{constructor(a,l){this.context=a,this.texture=l}bind(a,l){let{context:d}=this,{gl:p}=d;p.bindTexture(p.TEXTURE_2D,this.texture),a!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,a),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,a),this.minFilter=a),l!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,l),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,l),this.wrapS=l)}}function fC(u,a,l,d,p,h,_,x){let C=[u,a,1,l,d,1,p,h,1],M=[_,x,1],v=ge.mat3.adjoint([],C),[S,A,D]=ge.vec3.transformMat3(M,M,v);return ge.mat3.multiply(C,C,[S,0,0,0,A,0,0,0,D])}function P5(u,a,l,d,p,h,_,x){let C=function(M,v,S,A,D,I,O,z){let B=fC(0,0,1,0,1,1,0,1),G=fC(M,v,S,A,D,I,O,z),$=ge.mat3.adjoint([],B);return ge.mat3.multiply(G,G,$)}(u,a,l,d,p,h,_,x);return[C[2]/C[8]/$t,C[5]/C[8]/$t]}function mC(u){return[u[0],Math.min(Math.max(u[1],-vo),vo)]}class N5 extends ss{constructor(a,l,d,p){super(),this.id=a,this.dispatcher=d,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(p),this.options=l,this._dirty=!1}load(a,l){if(this._loaded=l||!1,this.fire(new Ts("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return a&&(this.coordinates=a),this._loaded=!0,void this._finishLoading();this._imageRequest=Ju(this.map._requestManager.transformRequest(this.url,lo.Image),(d,p)=>{this._imageRequest=null,this._loaded=!0,d?this.fire(new Ia(d)):p&&(this.image=p instanceof HTMLImageElement?ft.getImageData(p):p,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,a&&(this.coordinates=a),this._finishLoading())})}loaded(){return this._loaded}updateImage(a){return a.url?(this._imageRequest&&a.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=a.url,this.load(a.coordinates,this._loaded),this):this}setTexture(a){if(!(a.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new pC(this.map.painter.context,a.handle),this.width=a.dimensions[0],this.height=a.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Ts("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(a){this.map=a,this.load()}onRemove(a){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof pC||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(a){if(this.coordinates=a,this._boundsArray=void 0,this._unsupportedCoords=!1,!a.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let l=a[0][1],d=a[0][1];for(let h of a)h[1]>d&&(d=h[1]),h[1]<l&&(l=h[1]);let p=(d+l)/2;if(p>vo?this.onNorthPole=!0:p<-vo&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){let h=a.map(s.fromLngLat);this.tileID=function(_){let x=1/0,C=1/0,M=-1/0,v=-1/0;for(let O of _)x=Math.min(x,O.x),C=Math.min(C,O.y),M=Math.max(M,O.x),v=Math.max(v,O.y);let S=Math.max(M-x,v-C),A=Math.max(0,Math.floor(-Math.log(S)/Math.LN2)),D=Math.pow(2,A),I=Math.floor((x+M)/2*D);return I>1&&(I-=1),new St(A,I,Math.floor((C+v)/2*D))}(h),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Ts("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(a){for(let B in this.tiles){let G=this.tiles[B];G.state!=="loaded"&&(G.state="loaded",G.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;let l=i1(new St(0,0,0),this.map.transform.projection),d=[l.projection.project(this.coordinates[0][0],this.coordinates[0][1]),l.projection.project(this.coordinates[1][0],this.coordinates[1][1]),l.projection.project(this.coordinates[2][0],this.coordinates[2][1]),l.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(B){let G=B[1].x-B[0].x,$=B[1].y-B[0].y,H=B[2].x-B[1].x,K=B[2].y-B[1].y,ee=B[3].x-B[2].x,ne=B[3].y-B[2].y,ve=B[0].x-B[3].x,pe=B[0].y-B[3].y,fe=G*K-H*$,Fe=H*ne-ee*K,be=ee*pe-ve*ne,Be=ve*$-G*pe;return fe>0&&Fe>0&&be>0&&Be>0||fe<0&&Fe<0&&be<0&&Be<0}(d))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);let p=i1(this.tileID,this.map.transform.projection),[h,_,x,C]=this.coordinates.map(B=>{let G=p.projection.project(B[0],B[1]);return x5(p,G)._round()});this.perspectiveTransform=P5(h.x,h.y,_.x,_.y,x.x,x.y,C.x,C.y);let M=this._boundsArray=new fd;M.emplaceBack(h.x,h.y,0,0),M.emplaceBack(_.x,_.y,$t,0),M.emplaceBack(C.x,C.y,0,$t),M.emplaceBack(x.x,x.y,$t,$t),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=a.createVertexBuffer(M,SA.members),this.boundsSegments=Zr.simpleSegment(0,0,4,2);let v=[],S=[mC((A=this.coordinates)[0]),mC(A[1]),mC(A[2]),mC(A[3])];var A;let[D,I,O,z]=function(B){let G=B[0][0],$=G,H=B[0][1],K=H;for(let ee=1;ee<B.length;ee++)B[ee][0]<G?G=B[ee][0]:B[ee][0]>$&&($=B[ee][0]),B[ee][1]<H?H=B[ee][1]:B[ee][1]>K&&(K=B[ee][1]);return[G,H,$-G,K-H]}(S);{let B=new fd,[G,$,H,K]=function(Ze){let rt=Ze[0].x,Je=rt,ot=Ze[0].y,kt=ot;for(let Mt=1;Mt<Ze.length;Mt++)Ze[Mt].x<rt?rt=Ze[Mt].x:Ze[Mt].x>Je&&(Je=Ze[Mt].x),Ze[Mt].y<ot?ot=Ze[Mt].y:Ze[Mt].y>kt&&(kt=Ze[Mt].y);return[rt,ot,Je-rt,kt-ot]}(d),ee=Ze=>[(Ze.x-G)/H,(Ze.y-$)/K],[ne,ve,pe,fe]=d.map(ee),Fe=function(Ze,rt,Je,ot,kt,Mt,ni,Vt){let qt=fC(0,0,1,0,1,1,0,1),Lt=fC(Ze,rt,Je,ot,kt,Mt,ni,Vt),Ri=ge.mat3.adjoint([],Lt);return ge.mat3.multiply(qt,qt,Ri)}(ne[0],ne[1],ve[0],ve[1],pe[0],pe[1],fe[0],fe[1]);this.elevatedGlobePerspectiveTransform=P5(ne[0],ne[1],ve[0],ve[1],pe[0],pe[1],fe[0],fe[1]);let be=(Ze,rt)=>{v.push(Ze.lng);let Je=Math.round((Ze.lng-D)/O*$t),ot=Math.round((Ze.lat-I)/z*$t),kt=ee(rt),Mt=ge.vec3.transformMat3([],[kt[0],kt[1],1],Fe),ni=Math.round(Mt[0]/Mt[2]*$t),Vt=Math.round(Mt[1]/Mt[2]*$t);B.emplaceBack(Je,ot,ni,Vt)},Be=d[3].x-d[0].x,$e=d[3].y-d[0].y,Ue=d[2].x-d[1].x,Ye=d[2].y-d[1].y;for(let Ze=0;Ze<65;Ze++){let rt=Ze/64,Je=[d[0].x+rt*Be,d[0].y+rt*$e],ot=[d[1].x+rt*Ue,d[1].y+rt*Ye],kt=ot[0]-Je[0],Mt=ot[1]-Je[1];for(let ni=0;ni<65;ni++){let Vt=ni/64,qt={x:Je[0]+kt*Vt,y:Je[1]+Mt*Vt,z:0};be(l.projection.unproject(qt.x,qt.y),qt)}}this.elevatedGlobeVertexBuffer=a.createVertexBuffer(B,SA.members)}{this.maxLongitudeTriangleSize=0;let B=[],G=new Ra,$=(H,K,ee)=>{G.emplaceBack(H,K,ee);let ne=v[H],ve=v[K],pe=v[ee],fe=Math.min(Math.min(ne,ve),pe),Fe=Math.max(Math.max(ne,ve),pe)-fe;Fe>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Fe),B.push(fe+Fe/2)};for(let H=0;H<64;H++)for(let K=0;K<64;K++){let ee=65*H+K,ne=ee+1,ve=ee+65,pe=ve+1;$(ee,ve,ne),$(ne,ve,pe)}[B,G]=function(H,K){let ee=Array.from({length:H.length},(pe,fe)=>fe);ee.sort((pe,fe)=>H[pe]-H[fe]);let ne=[],ve=new Ra;for(let pe=0;pe<ee.length;pe++){let fe=ee[pe];ne.push(H[fe]);let Fe=3*fe,be=Fe+1;ve.emplaceBack(K.uint16[Fe],K.uint16[be],K.uint16[be+1])}return[ne,ve]}(B,G),this.elevatedGlobeTrianglesCenterLongitudes=B,this.elevatedGlobeIndexBuffer=a.createIndexBuffer(G)}this.elevatedGlobeSegments=Zr.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,O/$t,0,z/$t,0,0,I,D,0])}prepare(){let a=Object.keys(this.tiles).length!==0;if(this.tileID&&!a)return;let l=this.map.painter.context,d=l.gl;!this._dirty||this.texture instanceof pC||(this.texture?this.texture.update(this.image):(this.texture=new MA(l,this.image,d.RGBA8),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE)),this._dirty=!1),a&&this._prepareData(l)}loadTile(a,l){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[String(a.tileID.wrap)]=a,a.buckets={},l(null)):(a.state="errored",l(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(a){let l=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!l)return null;let d=this.elevatedGlobeTrianglesCenterLongitudes,p=(h=a+180)+360*Math.round((d[0]-h)/360);var h;let _=new Zr,x=(S,A)=>{_.segments.push({vertexOffset:0,primitiveOffset:S,vertexLength:l.segments[0].vertexLength,primitiveLength:A,sortKey:void 0,vaos:{}})},C=.51*this.maxLongitudeTriangleSize;if(Math.abs(d[0]-p)<=C){let S=Ma(d,0,d.length,p+C);return S===d.length||x(S,ol(d,S+1,d.length,p+360-C)-S),_}p<d[0]&&(p+=360);let M=ol(d,0,d.length,p-C);if(M===d.length)return x(0,d.length),_;x(0,M-0);let v=Ma(d,M+1,d.length,p+C);return v!==d.length&&x(v,d.length-v),_}}let DQ=(Math.pow(256,2)-1)/16907520;class L5 extends xa{constructor(a,l,d,p){super(a,{layout:k5||(k5=new no({visibility:new Ht(lt.layout_raster.visibility)})),paint:O5||(O5=new no({"raster-opacity":new Ht(lt.paint_raster["raster-opacity"]),"raster-color":new _f(lt.paint_raster["raster-color"]),"raster-color-mix":new Ht(lt.paint_raster["raster-color-mix"]),"raster-color-range":new Ht(lt.paint_raster["raster-color-range"]),"raster-hue-rotate":new Ht(lt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ht(lt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ht(lt.paint_raster["raster-brightness-max"]),"raster-saturation":new Ht(lt.paint_raster["raster-saturation"]),"raster-contrast":new Ht(lt.paint_raster["raster-contrast"]),"raster-resampling":new Ht(lt.paint_raster["raster-resampling"]),"raster-fade-duration":new Ht(lt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Ht(lt.paint_raster["raster-emissive-strength"]),"raster-array-band":new Ht(lt.paint_raster["raster-array-band"]),"raster-elevation":new Ht(lt.paint_raster["raster-elevation"]),"raster-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"})}))},l,d,p),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(a){return!(a&&a._source instanceof N5&&(a._source.onNorthPole||a._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(a){a!=="raster-color"&&a!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(a){if(!this.hasColorMap()||!this._curRampRange)return;let l=this._transitionablePaint._values["raster-color"].value.expression,[d,p]=a||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(d)&&isNaN(p)||d===this._curRampRange[0]&&p===this._curRampRange[1]||(this.colorRamp=jb({expression:l,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:d,end:p}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[d,p])}}let F5,z5,B5,V5,j5;class U5 extends xa{constructor(a,l,d,p){super(a,{layout:F5||(F5=new no({visibility:new Ht(lt["layout_raster-particle"].visibility)})),paint:z5||(z5=new no({"raster-particle-array-band":new Ht(lt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Ht(lt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new _f(lt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Ht(lt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Ht(lt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Ht(lt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Ht(lt["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Ht(lt["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"})}))},l,d,p),this._updateColorRamp(),this.lastInvalidatedAt=ft.now()}onRemove(a){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(a){return!1}_handleSpecialPaintPropertyUpdate(a){a!=="raster-particle-color"&&a!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),a==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;let a=this._transitionablePaint._values["raster-particle-color"].value.expression,l=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=jb({expression:a,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:l}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=ft.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class MQ extends xa{constructor(a,l){super(a,{},l,null),this.implementation=a,a.slot&&(this.slot=a.slot)}is3D(a){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(a){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(a){this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)}onRemove(a){this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)}}function IA(u,a,l){let d=[0,0,1],p=ge.quat.identity([]);return ge.quat.rotateY(p,p,l?-Mn(u)+Math.PI:Mn(u)),ge.quat.rotateX(p,p,-Mn(a)),ge.vec3.transformQuat(d,d,p),ge.vec3.normalize(d,d)}function H5(u,a){let l=gC(u.projection,u.zoom,u.width,u.height),d=function(h,_,x,C,M){let v=new er(x.lng-180*Of,x.lat),S=new er(x.lng+180*Of,x.lat),A=h.project(v.lng,v.lat),D=h.project(S.lng,S.lat),I=-Math.atan2(D.y-A.y,D.x-A.x),O=s.fromLngLat(x);O.y=pn(O.y,-1+Of,1-Of);let z=O.toLngLat(),B=h.project(z.lng,z.lat),G=s.fromLngLat(z);G.x+=Of;let $=G.toLngLat(),H=h.project($.lng,$.lat),K=$5(H.x-B.x,H.y-B.y,I),ee=s.fromLngLat(z);ee.y+=Of;let ne=ee.toLngLat(),ve=h.project(ne.lng,ne.lat),pe=$5(ve.x-B.x,ve.y-B.y,I),fe=Math.abs(K.x)/Math.abs(pe.y),Fe=ge.mat4.identity([]);ge.mat4.rotateZ(Fe,Fe,-I*(1-(M?0:C)));let be=ge.mat4.identity([]);return ge.mat4.scale(be,be,[1,1-(1-fe)*C,1]),be[4]=-pe.x/pe.y*C,ge.mat4.rotateZ(be,be,I),ge.mat4.multiply(be,Fe,be),be}(u.projection,0,u.center,l,a),p=q5(u);return ge.mat4.scale(d,d,[p,p,1]),d}function q5(u){let a=u.projection,l=gC(u.projection,u.zoom,u.width,u.height),d=AA(a,u.center),p=AA(a,er.convert(a.center));return Math.pow(2,d*l+(1-l)*p)}function gC(u,a,l,d,p=1/0){let h=u.range;if(!h)return 0;let _=Math.min(p,Math.max(l,d)),x=Math.log(_/1024)/Math.LN2;return Gr(h[0]+x,h[1]+x,a)}let Of=1/4e4;function AA(u,a){let l=pn(a.lat,-vo,vo),d=new er(a.lng-180*Of,l),p=new er(a.lng+180*Of,l),h=u.project(d.lng,l),_=u.project(p.lng,l),x=s.fromLngLat(d),C=s.fromLngLat(p),M=_.x-h.x,v=_.y-h.y,S=C.x-x.x,A=C.y-x.y,D=Math.sqrt((S*S+A*A)/(M*M+v*v));return Math.log(D)/Math.LN2}function $5(u,a,l){let d=Math.cos(l),p=Math.sin(l);return{x:u*d-a*p,y:u*p+a*d}}function G5(u,a,l){ge.mat4.identity(u),ge.mat4.rotateZ(u,u,Mn(a[2])),ge.mat4.rotateX(u,u,Mn(a[0])),ge.mat4.rotateY(u,u,Mn(a[1])),ge.mat4.scale(u,u,l),ge.mat4.multiply(u,u,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function _C(u,a,l,d,p,h,_,x){let C=[l[0]-a[0],l[1]-a[1],0],M=[d[0]-a[0],d[1]-a[1],0];if(ge.vec3.length(C)<1e-12||ge.vec3.length(M)<1e-12)return ge.quat.identity(u);let v=ge.vec3.cross([],C,M);ge.vec3.normalize(v,v),ge.vec3.subtract(M,d,a),C[2]=(h-p)*x,M[2]=(_-p)*x;let S=C;return ge.vec3.cross(S,C,M),ge.vec3.normalize(S,S),ge.quat.rotationTo(u,v,S)}function RA(u,a,l=!1){let d=Ws(a.zoom),p=function(h,_,x){let C=_.worldSize,M=[h[12],h[13],h[14]],v=ka(M[1]/C),S=dl(M[0]/C),A=ge.mat4.identity([]),D=$a(1,v)*C,I=$a(1,0)*C*bh(v,_.zoom),O=1/Tu(C),z=I*O;if(x){let H=gC(_.projection,_.zoom,_.width,_.height,1024);z=O*_.projection.pixelSpaceConversion(_.center.lat,C,H)}let B=pp(v,S);ge.vec3.add(B,B,ge.vec3.scale([],ge.vec3.normalize([],B),D*z*M[2]));let G=function(H){let K=[H[0],H[1],H[2]],ee=[0,1,0],ne=ge.vec3.cross([],ee,K);return ge.vec3.cross(ee,K,ne),ge.vec3.squaredLength(ee)===0&&(ee=[0,1,0],ge.vec3.cross(ne,K,ee)),ge.vec3.normalize(ne,ne),ge.vec3.normalize(ee,ee),ge.vec3.normalize(K,K),[ne[0],ne[1],ne[2],0,ee[0],ee[1],ee[2],0,K[0],K[1],K[2],0,H[0],H[1],H[2],1]}(B);ge.mat4.scale(A,A,[z,z,z*D]),ge.mat4.translate(A,A,[-M[0],-M[1],-M[2]]);let $=ge.mat4.multiply([],_.globeMatrix,G);return ge.mat4.multiply($,$,A),ge.mat4.multiply($,$,h),$}(u,a,l);if(d>0){let h=function(_,x){let C=x.worldSize,M=$a(1,0)*C*bh(x.center.lat,x.zoom)/Tu(C),v=$a(1,x.center.lat)*C,S=ge.mat4.identity([]);return ge.mat4.rotateY(S,S,Mn(x.center.lng)),ge.mat4.rotateX(S,S,Mn(x.center.lat)),ge.mat4.translate(S,S,[0,0,As]),ge.mat4.scale(S,S,[M,M,M*v]),ge.mat4.translate(S,S,[x.point.x-.5*C,x.point.y-.5*C,0]),ge.mat4.multiply(S,S,_),ge.mat4.multiply(S,x.globeMatrix,S)}(u,a);return function(_,x,C){let M=(I,O,z)=>{let B=ge.vec3.length(I),G=ge.vec3.length(O),$=ha(I,O,z);return ge.vec3.scale($,$,1/ge.vec3.length($)*pi(B,G,z))},v=M([_[0],_[1],_[2]],[x[0],x[1],x[2]],C),S=M([_[4],_[5],_[6]],[x[4],x[5],x[6]],C),A=M([_[8],_[9],_[10]],[x[8],x[9],x[10]],C),D=ha([_[12],_[13],_[14]],[x[12],x[13],x[14]],C);return[v[0],v[1],v[2],0,S[0],S[1],S[2],0,A[0],A[1],A[2],0,D[0],D[1],D[2],1]}(p,h,d)}return p}function W5(u,a,l,d){let p=yi.projectAabbCorners(d,l),h=Number.MAX_VALUE,_=-1;for(let M=0;M<p.length;++M){let v=p[M];v[0]=(.5*v[0]+.5)*a.width,v[1]=(.5-.5*v[1])*a.height,v[2]<h&&(_=M,h=v[2])}let x=M=>new Wt(p[M][0],p[M][1]),C;switch(_){case 0:case 6:C=[x(1),x(5),x(4),x(7),x(3),x(2),x(1)];break;case 1:case 7:C=[x(0),x(4),x(5),x(6),x(2),x(3),x(0)];break;case 3:case 5:C=[x(1),x(0),x(4),x(7),x(6),x(2),x(1)];break;default:C=[x(1),x(5),x(6),x(7),x(3),x(0),x(1)]}if(ie(u,C))return h}let IQ=Jn([{name:"a_pos_3f",components:3,type:"Float32"}]),AQ=Jn([{name:"a_color_3f",components:3,type:"Float32"}]),RQ=Jn([{name:"a_color_4f",components:4,type:"Float32"}]),kQ=Jn([{name:"a_uv_2f",components:2,type:"Float32"}]),OQ=Jn([{name:"a_normal_3f",components:3,type:"Float32"}]),PQ=Jn([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),NQ=Jn([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),Z5={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class yC{constructor(a,l,d,p){this.message=(a?`${a}: `:"")+d,p&&(this.identifier=p),l!=null&&l.__line__&&(this.line=l.__line__)}}function Y5(u,a){let l=u.indexOf("://")===-1;try{return new URL(u,l&&a?"http://example.com":void 0),!0}catch{return!1}}class K5{constructor(a,l){this.feature=a,this.instancedDataOffset=l,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class X5{constructor(){this.instancedDataArray=new T_,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class kA{constructor(a){this.zoom=a.zoom,this.canonical=a.canonical,this.layers=a.layers,this.layerIds=this.layers.map(l=>l.fqid),this.projection=a.projection,this.index=a.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(a,l){}populate(a,l,d,p){this.tileToMeter=m(d);let h=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(let{feature:_,id:x,index:C,sourceLayerIndex:M}of a){let v=x??(_.properties&&_.properties.hasOwnProperty("id")?_.properties.id:void 0),S=F(_,h);if(!this.layers[0]._featureFilter.filter(new Ar(this.zoom),S,d))continue;let A={id:v,sourceLayerIndex:M,index:C,geometry:h?S.geometry:L(_,d,p),properties:_.properties,type:_.type,patterns:{}},D=this.addFeature(A,A.geometry,S);D&&l.featureIndex.insert(_,A.geometry,C,M,this.index,this.instancesPerModel[D].instancedDataArray.length,$t/32)}this.lookup=null}update(a,l,d,p){for(let h in this.instancesPerModel){let _=this.instancesPerModel[h];for(let x in a)_.idToFeaturesIndex.hasOwnProperty(x)&&(this.evaluate(_.features[_.idToFeaturesIndex[x]],a[x],_,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let a=!1;for(let l in this.instancesPerModel){let d=this.instancesPerModel[l];for(let p of d.features){let h=this.layers[0],_=p.feature,x=this.canonical,C=h.paint.get("model-rotation").evaluate(_,{},x),M=h.paint.get("model-scale").evaluate(_,{},x),v=h.paint.get("model-translation").evaluate(_,{},x);ge.vec3.exactEquals(p.rotation,C)&&ge.vec3.exactEquals(p.scale,M)&&ge.vec3.exactEquals(p.translation,v)||(this.evaluate(p,p.featureStates,d,!0),a=!0)}}return a}updateReplacement(a,l,d,p){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;let h=l.getReplacementRegionsForTile(a.toUnwrapped(),!0);if(nA(this.activeReplacements,h))return!1;this.activeReplacements=h;let _=!1;for(let x in this.instancesPerModel){let C=this.instancesPerModel[x],M=C.instancedDataArray;for(let v of C.features){let S=v.instancedDataOffset,A=v.instancedDataCount;for(let D=0;D<A;D++){let I=16*(D+S),O=M.float32[I+0],z=O>$t;O=z?O-$t:O;let B=Math.floor(O),G=M.float32[I+1],$=!1;for(let H of this.activeReplacements)if(!a6(H,d,Z5.Model,p)&&!(H.min.x>B||B>H.max.x||H.min.y>G||G>H.max.y)&&($=h6(d6(B,G,a.canonical,H.footprintTileId.canonical),H.footprint),$))break;M.float32[I]=$?O+$t:O,_=_||$!==z}}}return _}isEmpty(){for(let a in this.instancesPerModel)if(this.instancesPerModel[a].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(a){if(!this.uploaded)for(let l in this.instancesPerModel){let d=this.instancesPerModel[l];d.instancedDataArray.length<0||d.instancedDataArray.length===0||(d.instancedDataBuffer?d.instancedDataBuffer.updateData(d.instancedDataArray):d.instancedDataBuffer=a.createVertexBuffer(d.instancedDataArray,PQ.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(let l in this.instancesPerModel){let d=this.instancesPerModel[l];d.instancedDataArray.length!==0&&d.instancedDataBuffer&&d.instancedDataBuffer.destroy()}let a=this.layers[0].modelManager;if(a&&this.modelUris)for(let l of this.modelUris)a.removeModel(l,"")}addFeature(a,l,d){let p=this.layers[0],h=p.layout.get("model-id").evaluate(d,{},this.canonical);if(!h)return Gt(`modelId is not evaluated for layer ${p.id} and it is not going to get rendered.`),h;Y5(h,!1)&&(this.modelUris.includes(h)||this.modelUris.push(h)),this.instancesPerModel[h]||(this.instancesPerModel[h]=new X5);let _=this.instancesPerModel[h],x=_.instancedDataArray,C=new K5(d,x.length);for(let M of l)for(let v of M){if(v.x<0||v.x>=$t||v.y<0||v.y>=$t)continue;let S=(this.lookupDim-1)/$t,A=this.lookupDim*(v.y*S|0)+v.x*S|0;if(this.lookup){if(this.lookup[A]!==0)continue;this.lookup[A]=1}this.instanceCount++;let D=x.length;x.resize(D+1),_.instancesEvaluatedElevation.push(0),x.float32[16*D]=v.x,x.float32[16*D+1]=v.y}return C.instancedDataCount=_.instancedDataArray.length-C.instancedDataOffset,C.instancedDataCount>0&&(a.id&&(_.idToFeaturesIndex[a.id]=_.features.length),_.features.push(C),this.evaluate(C,{},_,!1)),h}getModelUris(){return this.modelUris}evaluate(a,l,d,p){let h=this.layers[0],_=a.feature,x=this.canonical,C=a.rotation=h.paint.get("model-rotation").evaluate(_,l,x),M=a.scale=h.paint.get("model-scale").evaluate(_,l,x),v=a.translation=h.paint.get("model-translation").evaluate(_,l,x),S=h.paint.get("model-color").evaluate(_,l,x);S.a=h.paint.get("model-color-mix-intensity").evaluate(_,l,x);let A=[];this.maxVerticalOffset<v[2]&&(this.maxVerticalOffset=v[2]),this.maxScale=Math.max(Math.max(this.maxScale,M[0]),Math.max(M[1],M[2])),G5(A,C,M);let D=Math.round(100*S.a)+S.b/1.05;for(let I=0;I<a.instancedDataCount;++I){let O=a.instancedDataOffset+I,z=16*O,B=d.instancedDataArray.float32,G=0;p&&(G=B[z+6]-d.instancesEvaluatedElevation[O]);let $=0|B[z+1];B[z]=(0|B[z])+S.r/1.05,B[z+1]=$+S.g/1.05,B[z+2]=D,B[z+3]=1/(x.z>10?this.tileToMeter:m(x,$)),B[z+4]=v[0],B[z+5]=v[1],B[z+6]=v[2]+G,B[z+7]=A[0],B[z+8]=A[1],B[z+9]=A[2],B[z+10]=A[4],B[z+11]=A[5],B[z+12]=A[6],B[z+13]=A[8],B[z+14]=A[9],B[z+15]=A[10],d.instancesEvaluatedElevation[O]=v[2]}}}let Q5,J5;ii(kA,"ModelBucket",{omit:["layers"]}),ii(X5,"PerModelAttributes"),ii(K5,"ModelFeature");let wg=64,j_={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function e8(u,a,l,d,p,h,_,x,C,M=!1){let v=l.zoom,S=l.project(d),A=bh(d.lat,v),D=1/A;ge.mat4.identity(u),ge.mat4.translate(u,u,[S.x+_[0]*D,S.y+_[1]*D,_[2]]);let I=1,O=1,z=l.worldSize;if(M){if(l.projection.name==="mercator"){let H=0;l.elevation&&(H=l.elevation.getAtPointOrZero(new s(S.x/z,S.y/z),0));let K=ge.vec4.transformMat4([],[S.x,S.y,H,1],l.projMatrix)[3]/l.cameraToCenterDistance;I=K,O=K*bh(l.center.lat,v)}else if(l.projection.name==="globe"){let H=RA(u,l),K=ge.mat4.multiply([],l.projMatrix,H),ee=[0,0,0,1];ge.vec4.transformMat4(ee,ee,K);let ne=ee[3]/l.cameraToCenterDistance,ve=Ws(v),pe=l.projection.pixelsPerMeter(d.lat,z)*bh(d.lat,v),fe=l.projection.pixelsPerMeter(l.center.lat,z)*bh(l.center.lat,v);I=ne/pi(pe,jE(l.center.lat),ve),O=ne*A/pe,I*=fe,O*=fe}}else I=D;ge.mat4.scale(u,u,[I,I,O]);let B=[...u],G=a.orientation,$=[];if(G5($,[G[0]+p[0],G[1]+p[1],G[2]+p[2]],h),ge.mat4.multiply(u,B,$),x&&l.elevation){let H=0,K=[];if(C&&l.elevation){H=function(ve,pe,fe,Fe,be){let Be=pe.elevation;if(!Be)return 0;let $e=yi.projectAabbCorners(fe,Fe),Ue=$a(1,be.lat)*pe.worldSize,Ye=function(Ri,Jt){let mi=[0,0,1],Hi=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(let mn of Hi){let Xi=Ri[mn.corners[0]],bn=Ri[mn.corners[1]],fn=Ri[mn.corners[2]],Dn=[bn[0]-Xi[0],bn[1]-Xi[1],Jt*(bn[2]-Xi[2])],Kn=ge.vec3.cross(Dn,Dn,[fn[0]-Xi[0],fn[1]-Xi[1],Jt*(fn[2]-Xi[2])]);ge.vec3.normalize(Kn,Kn),mn.dotProductWithUp=ge.vec3.dot(Kn,mi)}return Hi.sort((mn,Xi)=>mn.dotProductWithUp-Xi.dotProductWithUp),Hi[0].corners}($e,Ue),Ze=$e[Ye[0]],rt=$e[Ye[1]],Je=$e[Ye[2]],ot=$e[Ye[3]],kt=Be.getAtPointOrZero(new s(Ze[0]/pe.worldSize,Ze[1]/pe.worldSize),0),Mt=Be.getAtPointOrZero(new s(rt[0]/pe.worldSize,rt[1]/pe.worldSize),0),ni=Be.getAtPointOrZero(new s(Je[0]/pe.worldSize,Je[1]/pe.worldSize),0),Vt=Be.getAtPointOrZero(new s(ot[0]/pe.worldSize,ot[1]/pe.worldSize),0),qt=(kt+Vt)/2,Lt=(Mt+ni)/2;return qt>Lt?Mt<ni?_C(ve,rt,ot,Ze,Mt,Vt,kt,Ue):_C(ve,Je,Ze,ot,ni,kt,Vt,Ue):kt<Vt?_C(ve,Ze,rt,Je,kt,Mt,ni,Ue):_C(ve,ot,Je,rt,Vt,ni,Mt,Ue),Math.max(qt,Lt)}(K,l,a.aabb,u,d);let ee=ge.mat4.fromQuat([],K),ne=ge.mat4.multiply([],ee,$);ge.mat4.multiply(u,B,ne)}else H=l.elevation.getAtPointOrZero(new s(S.x/z,S.y/z),0);H!==0&&(u[14]+=H)}}function s1(u,a,l=!1){u.uploaded||(u.gfxTexture=new MA(a,u.image,l?a.gl.R8:a.gl.RGBA8,{useMipmap:u.sampler.minFilter>=a.gl.NEAREST_MIPMAP_NEAREST}),u.uploaded=!0,u.image=null)}function LQ(u,a,l){u.indexBuffer=a.createIndexBuffer(u.indexArray,!1,!0),u.vertexBuffer=a.createVertexBuffer(u.vertexArray,IQ.members,!1,!0),u.normalArray&&(u.normalBuffer=a.createVertexBuffer(u.normalArray,OQ.members,!1,!0)),u.texcoordArray&&(u.texcoordBuffer=a.createVertexBuffer(u.texcoordArray,kQ.members,!1,!0)),u.colorArray&&(u.colorBuffer=a.createVertexBuffer(u.colorArray,(u.colorArray.bytesPerElement===12?AQ:RQ).members,!1,!0)),u.featureArray&&(u.pbrBuffer=a.createVertexBuffer(u.featureArray,NQ.members,!0)),u.segments=Zr.simpleSegment(0,0,u.vertexArray.length,u.indexArray.length);let d=u.material;d.pbrMetallicRoughness.baseColorTexture&&s1(d.pbrMetallicRoughness.baseColorTexture,a),d.pbrMetallicRoughness.metallicRoughnessTexture&&s1(d.pbrMetallicRoughness.metallicRoughnessTexture,a),d.normalTexture&&s1(d.normalTexture,a),d.occlusionTexture&&s1(d.occlusionTexture,a,l),d.emissionTexture&&s1(d.emissionTexture,a)}function OA(u,a,l){if(u.meshes)for(let d of u.meshes)LQ(d,a,l);if(u.children)for(let d of u.children)OA(d,a,l)}function vC(u){if(u.meshes)for(let a of u.meshes)a.indexArray.destroy(),a.vertexArray.destroy(),a.colorArray&&a.colorArray.destroy(),a.normalArray&&a.normalArray.destroy(),a.texcoordArray&&a.texcoordArray.destroy(),a.featureArray&&a.featureArray.destroy();if(u.children)for(let a of u.children)vC(a)}function PA(u){if(u.meshes)for(let l of u.meshes)l.vertexBuffer&&(l.vertexBuffer.destroy(),l.indexBuffer.destroy(),l.normalBuffer&&l.normalBuffer.destroy(),l.texcoordBuffer&&l.texcoordBuffer.destroy(),l.colorBuffer&&l.colorBuffer.destroy(),l.pbrBuffer&&l.pbrBuffer.destroy(),l.segments.destroy(),l.material&&((a=l.material).pbrMetallicRoughness.baseColorTexture&&a.pbrMetallicRoughness.baseColorTexture.gfxTexture&&a.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),a.pbrMetallicRoughness.metallicRoughnessTexture&&a.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&a.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),a.normalTexture&&a.normalTexture.gfxTexture&&a.normalTexture.gfxTexture.destroy(),a.emissionTexture&&a.emissionTexture.gfxTexture&&a.emissionTexture.gfxTexture.destroy(),a.occlusionTexture&&a.occlusionTexture.gfxTexture&&a.occlusionTexture.gfxTexture.destroy()));var a;if(u.children)for(let l of u.children)PA(l)}class U_{constructor(a,l,d){this._demTile=a,this._dem=this._demTile.dem,this._scale=l,this._offset=d}static create(a,l,d){let p=d||a.findDEMTileFor(l);if(!p||!p.dem)return;let h=p.dem,_=p.tileID,x=1<<l.canonical.z-_.canonical.z;return new U_(p,h.dim/$t/x,[(l.canonical.x/x-_.canonical.x)*h.dim,(l.canonical.y/x-_.canonical.y)*h.dim])}tileCoordToPixel(a,l){let d=l*this._scale+this._offset[1],p=Math.floor(a*this._scale+this._offset[0]),h=Math.floor(d);return new Wt(p,h)}getElevationAt(a,l,d,p){let h=a*this._scale+this._offset[0],_=l*this._scale+this._offset[1],x=Math.floor(h),C=Math.floor(_),M=this._dem;return p=!!p,d?pi(pi(M.get(x,C,p),M.get(x,C+1,p),_-C),pi(M.get(x+1,C,p),M.get(x+1,C+1,p),_-C),h-x):M.get(x,C,p)}getElevationAtPixel(a,l,d){return this._dem.get(a,l,!!d)}getMeterToDEM(a){return(1<<this._demTile.tileID.canonical.z)*$a(1,a)*this._dem.stride}}let NA=new Float32Array(262144),Eg=new Uint8Array(262144);function t8(u){let a=0;if(u.meshes)for(let l of u.meshes)a=Math.max(a,l.aabb.max[2]);if(u.children)for(let l of u.children)a=Math.max(a,t8(l));return a}function i8(u,a,l){if(u.meshes)for(let d of u.meshes){if(d.aabb.min[0]===1/0)continue;let p=yi.applyTransform(d.aabb,u.matrix);l.insert(a,p.min[0],p.min[1],p.max[0],p.max[1])}if(u.children)for(let d of u.children)i8(d,a,l)}let n8=["","wall","door","roof","window","lamp","logo"];class r8{constructor(a){this.node=a,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:a.id,geometry:[],properties:{height:t8(a)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new yi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let a=0,l=new yi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(let d of this.node.meshes)this.node.lightMeshIndex!==a&&(d.transformedAabb=yi.applyTransformFast(d.aabb,this.node.matrix),l.encapsulate(d.transformedAabb)),a++;this.aabb=l}return this.aabb}}class bC{constructor(a,l,d,p,h,_,x){this.id=d,this.layers=a,this.layerIds=this.layers.map(C=>C.fqid),this.stateDependentLayerIds=this.layers.filter(C=>C.isStateDependent()).map(C=>C.id),this.modelTraits|=j_.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,p&&(this.modelTraits|=j_.HasMapboxMeshFeatures),h&&(this.modelTraits|=j_.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=_,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(let C of l)this.nodesInfo.push(new r8(C)),i8(C,x.featureIndexArray.length,x.grid),x.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,x.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(a,l){for(let d of this.getNodesInfo()){let p=d.node;p.footprint&&l.push({footprint:p.footprint,id:a})}}update(a){let l=Object.keys(a).length!==0;if(l&&!this.stateDependentLayers.length)return;let d=l?this.stateDependentLayers:this.layers;if(!Cs(a,this.states))for(let p of d)this.evaluate(p,a);this.states=structuredClone(a)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(a){if(!this.needsUpload)return;let l=this.getNodesInfo();for(let d of l){let p=d.node;this.uploaded?this.updatePbrBuffer(p):OA(p,a,!0)}for(let d of l)vC(d.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(a){let l=!1;if(!a.meshes)return l;for(let d of a.meshes)d.pbrBuffer&&(d.pbrBuffer.updateData(d.featureArray),l=!0);return l}needsReEvaluation(a,l,d){let p=a.transform.projectionOptions,h=a.style.getBrightness(),_=this.brightness!==h;if(!this.uploaded||this.dirty||p.name!==this.projection.name||l1(d.paint.get("model-color").value,_)||l1(d.paint.get("model-color-mix-intensity").value,_)||l1(d.paint.get("model-roughness").value,_)||l1(d.paint.get("model-emissive-strength").value,_)||l1(d.paint.get("model-height-based-emissive-strength-multiplier").value,_)){this.projection=p,this.brightness=h;let x=this.getNodesInfo();for(let C of x)C.state=null;return!0}return!1}evaluateScale(a,l){if(a.transform.zoom===this.zoom)return;this.zoom=a.transform.zoom;let d=this.getNodesInfo(),p=this.id.canonical;for(let h of d){let _=h.feature;h.evaluatedScale=l.paint.get("model-scale").evaluate(_,{},p)}}evaluate(a,l){let d=this.getNodesInfo();for(let p of d){if(!p.node.meshes)continue;let h=p.feature,_=l&&l[h.id];if(Cs(_,p.state))continue;p.state=structuredClone(_);let x=p.node.meshes&&p.node.meshes[0].featureData,C=p.evaluatedColor[2],M=p.evaluatedRMEA[2],v=this.id.canonical;if(p.hasTranslucentParts=!1,x){for(let S=0;S<n8.length;S++){let A=n8[S];A.length&&(h.properties.part=A);let D=a.paint.get("model-color").evaluate(h,_,v).toRenderColor(null),I=a.paint.get("model-color-mix-intensity").evaluate(h,_,v);p.evaluatedColor[S]=[D.r,D.g,D.b,I],p.evaluatedRMEA[S][0]=a.paint.get("model-roughness").evaluate(h,_,v),p.evaluatedRMEA[S][2]=a.paint.get("model-emissive-strength").evaluate(h,_,v),p.evaluatedRMEA[S][3]=D.a,p.emissionHeightBasedParams[S]=a.paint.get("model-height-based-emissive-strength-multiplier").evaluate(h,_,v),!p.hasTranslucentParts&&D.a<1&&(p.hasTranslucentParts=!0)}delete h.properties.part,zQ(p,C!==p.evaluatedColor[2]||M!==p.evaluatedRMEA[2],this.modelTraits)}else p.evaluatedRMEA[0][2]=a.paint.get("model-emissive-strength").evaluate(h,_,v);p.evaluatedScale=a.paint.get("model-scale").evaluate(h,_,v),this.updatePbrBuffer(p.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(a,l,d,p){let h=a.findDEMTileFor(d);if(h&&(h.tileID.canonical!==this.terrainTile||l!==this.terrainExaggeration)){if(h.dem&&h.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=h.tileID.overscaledZ;let _=U_.create(a,d,h);if(!_)return;this.modelTraits&j_.HasMapboxMeshFeatures&&this.updateDEM(a,_,d,p);for(let x of this.getNodesInfo()){let C=x.node;if(!C.footprint||!C.footprint.vertices||!C.footprint.vertices.length)continue;let M=C.footprint.vertices,v=_.getElevationAt(M[0].x,M[0].y,!0,!0);for(let S=1;S<M.length;S++)v=Math.min(v,_.getElevationAt(M[S].x,M[S].y,!0,!0));C.elevation=v}}this.terrainTile=h.tileID.canonical,this.terrainExaggeration=l}}updateDEM(a,l,d,p){let h=l._dem._modifiedForSources[p];if(h===void 0&&(l._dem._modifiedForSources[p]=[],h=l._dem._modifiedForSources[p]),h.includes(d.canonical))return;let _=l._dem.dim;h.push(d.canonical);let x=!1;for(let C of this.getNodesInfo()){let M=C.node;if(!M.footprint||!M.footprint.grid)continue;let v=M.footprint.grid,S=l.tileCoordToPixel(v.min.x,v.min.y),A=l.tileCoordToPixel(v.max.x,v.max.y),D=Math.min(Math.min(_-A.y,S.x),Math.min(S.y,_-A.x));if(D<0)continue;let I=pn(D,2,5),O=Math.max(0,S.x-I),z=Math.max(0,S.y-I),B=Math.min(A.x+I,_-1),G=Math.min(A.y+I,_-1);for(let ee=z;ee<=G;++ee)for(let ne=O;ne<=B;++ne)Eg[ee*_+ne]=255;let $=0,H=0;for(let ee=0;ee<v.cellsY;++ee)for(let ne=0;ne<v.cellsX;++ne){if(!v.cells[ee*v.cellsX+ne])continue;let ve=l.tileCoordToPixel(v.min.x+ne/v.xScale,v.min.y+ee/v.yScale),pe=l.tileCoordToPixel(v.min.x+(ne+1)/v.xScale,v.min.y+(ee+1)/v.yScale);for(let fe=ve.y;fe<=Math.min(pe.y+1,_-1);++fe)for(let Fe=ve.x;Fe<=Math.min(pe.x+1,_-1);++Fe)Eg[fe*_+Fe]===255&&(Eg[fe*_+Fe]=0,$+=l.getElevationAtPixel(Fe,fe),H++)}let K=$/H;O=Math.max(1,S.x-I),z=Math.max(1,S.y-I),B=Math.min(A.x+I,_-2),G=Math.min(A.y+I,_-2),x=!0;for(let ee=z;ee<=G;++ee)for(let ne=O;ne<=B;++ne)Eg[ee*_+ne]===0&&(NA[ee*_+ne]=l._dem.set(ne,ee,K));for(let ee=1;ee<I;++ee){O=Math.max(1,S.x-ee),z=Math.max(1,S.y-ee),B=Math.min(A.x+ee,_-2),G=Math.min(A.y+ee,_-2);for(let ne=z;ne<=G;++ne)for(let ve=O;ve<=B;++ve){let pe=ne*_+ve;if(Eg[pe]===255){let fe=0,Fe=0,be=-1,Be=-1;for(let $e=-1;$e<=1;++$e)for(let Ue=-1;Ue<=1;++Ue){let Ye=(ne+$e)*_+ve+Ue;if(Eg[Ye]>=ee)continue;let Ze=NA[Ye],rt=Math.abs(Ze);rt>Fe&&(fe=Ze,Fe=rt,be=Ue,Be=$e)}if(Fe>.1){let $e=1-(ee+.5*Math.abs(be*Be))/I,Ue=l._dem.get(ve,ne)+fe*$e,Ye=l._dem.get(ve+be,ne+Be),Ze=l._dem.get(ve-be,ne-Be,!0);(Ue-Ye)*(Ue-Ze)>0&&(Ue=(Ye+Ze)/2),NA[pe]=l._dem.set(ve,ne,Ue),Eg[pe]=ee}}}}}x&&(l._demTile.needsDEMTextureUpload=!0,l._dem._timestamp=ft.now())}setFilter(a){this.filter=a?_b(a):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(a=>this.filter.filter(new Ar(this.id.overscaledZ),a.feature,this.id.canonical)):this.nodesInfo}destroy(){let a=this.getNodesInfo();for(let l of a)vC(l.node),PA(l.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(a,l){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;let d=l.getReplacementRegionsForTile(a.toUnwrapped()),p=this.getNodesInfo();for(let h=0;h<this.nodesInfo.length;h++){let _=p[h].node;p[h].hiddenByReplacement=!!_.footprint&&!d.find(x=>x.footprint===_.footprint)}}getHeightAtTileCoord(a,l){let d=this.getNodesInfo(),p=[],h=[0,0,0],_=ge.mat4.identity([]);for(let x=0;x<this.nodesInfo.length;x++){let C=d[x],M=C.node.meshes[0],v=M.transformedAabb;if(a<v.min[0]||l<v.min[1]||a>v.max[0]||l>v.max[1])continue;if(C.node.hidden===!0)return{height:1/0,maxHeight:C.feature.properties.height,hidden:!1,verticalScale:C.evaluatedScale[2]};ge.mat4.invert(_,C.node.matrix),h[0]=a,h[1]=l,ge.vec3.transformMat4(h,h,_);let S=(h[0]-M.aabb.min[0])/(M.aabb.max[0]-M.aabb.min[0])*wg|0,A=Math.min(63,(h[1]-M.aabb.min[1])/(M.aabb.max[1]-M.aabb.min[1])*wg|0)*wg+Math.min(63,S),D=M.heightmap[A];if(!(D<0&&C.node.footprint))return C.hiddenByReplacement?void 0:{height:D,maxHeight:C.feature.properties.height,hidden:!1,verticalScale:C.evaluatedScale[2]};if(C.node.footprint.grid.query(new Wt(a,l),new Wt(a,l),p),p.length>0)return{height:void 0,maxHeight:C.feature.properties.height,hidden:C.hiddenByReplacement,verticalScale:C.evaluatedScale[2]}}}}function l1(u,a){return!u.isLightConstant&&a}function FQ(u,a,l,d,p,h,_,x){let C=(61440&a|(61440&a)>>4)>>8,M=(3840&a|(3840&a)>>4)>>4,v=240&a|(240&a)>>4;l[3]>0&&(C=pi(C,255*l[0],l[3]),M=pi(M,255*l[1],l[3]),v=pi(v,255*l[2],l[3]));let S=C<<8|M,A=v<<8|Math.floor(255*d[3]),D=function(ee){let ne=pn(ee,0,2);return Math.min(Math.round(.5*ne*255),255)}(d[2])<<8|15*d[0]<<4|15*d[1],I=pn(p[0],0,1),O=pn(p[1],0,1),z=pn(p[2],0,1),B=pn(p[3],0,1),G,$,H,K;if(I!==O&&_!==h&&O!==I){let ee=_-h;$=1/(ee*(O-I)),H=-(h+ee*I)/(ee*(O-I));let ne=pn(p[4],-1,1);K=Math.pow(10,ne),G=255*z<<8|255*B}else G=65535,$=0,H=1,K=1;if(u.emplaceBack(S,A,D,G,$,H,K),x){let ee=x.length;x.clear();for(let ne=0;ne<ee;ne++)x.emplaceBack(S,A,D,G,$,H,K)}}function zQ(u,a,l){let d=u.node,p=0,h=l&j_.HasMeshoptCompression;for(let _ of d.meshes){if(d.lights&&d.lightMeshIndex===p||!_.featureData)continue;_.featureArray=new D_,_.featureArray.reserve(_.featureData.length);let x=a;for(let C of _.featureData){let M=h?65535&C:C>>16&65535,v=h?C>>16&65535:65535&C,S=(15&v)<8?15&v:0,A=u.evaluatedRMEA[S],D=u.evaluatedColor[S],I=u.emissionHeightBasedParams[S],O;if(x&&S===2&&d.lights&&(O=new D_,O.resize(10*d.lights.length)),FQ(_.featureArray,M,D,A,I,_.aabb.min[2],_.aabb.max[2],O),O&&x){x=!1;let z=d.meshes[d.lightMeshIndex];z.featureArray=O,z.featureArray._trim()}}_.featureArray._trim(),p++}}function o8(u,a,l,d){let p=1<<u.z;a.lat=ka((d/$t+u.y)/p),a.lng=dl((l/$t+u.x)/p)}ii(bC,"Tiled3dModelBucket",{omit:["layers"]}),ii(r8,"Tiled3dModelFeature");let BQ={circle:class extends xa{constructor(u,a,l,d){super(u,{layout:tt||(tt=new no({"circle-sort-key":new ti(lt.layout_circle["circle-sort-key"]),"circle-elevation-reference":new Ht(lt.layout_circle["circle-elevation-reference"]),visibility:new Ht(lt.layout_circle.visibility)})),paint:xt||(xt=new no({"circle-radius":new ti(lt.paint_circle["circle-radius"]),"circle-color":new ti(lt.paint_circle["circle-color"]),"circle-blur":new ti(lt.paint_circle["circle-blur"]),"circle-opacity":new ti(lt.paint_circle["circle-opacity"]),"circle-translate":new Ht(lt.paint_circle["circle-translate"]),"circle-translate-anchor":new Ht(lt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ht(lt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ht(lt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ti(lt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ti(lt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ti(lt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Ht(lt.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"})}))},a,l,d)}createBucket(u){return new W(u)}queryRadius(u){let a=u;return nt("circle-radius",this,a)+nt("circle-stroke-width",this,a)+Et(this.paint.get("circle-translate"))}queryIntersectsFeature(u,a,l,d,p,h,_,x){let C=Ut(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),h.angle,u.pixelToTileUnitsFactor),M=this.paint.get("circle-radius").evaluate(a,l)+this.paint.get("circle-stroke-width").evaluate(a,l);return O_(u,d,h,_,x,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",C,M)}getProgramIds(){return["circle"]}getDefaultProgramParams(u,a,l){let d=Tf(this);return{config:new hp(this,{zoom:a,lut:l}),defines:d,overrideFog:!1}}},heatmap:class extends xa{createBucket(u){return new IF(u)}constructor(u,a,l,d){super(u,{layout:AF||(AF=new no({visibility:new Ht(lt.layout_heatmap.visibility)})),paint:RF||(RF=new no({"heatmap-radius":new ti(lt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ti(lt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ht(lt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new _f(lt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ht(lt.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"})}))},a,l,d),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=jb({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(u){return nt("heatmap-radius",this,u)}queryIntersectsFeature(u,a,l,d,p,h,_,x){let C=this.paint.get("heatmap-radius").evaluate(a,l);return O_(u,d,h,_,x,!0,!0,new Wt(0,0),C)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(u,a,l){return u==="heatmap"?{config:new hp(this,{zoom:a,lut:l}),overrideFog:!1}:{}}},hillshade:class extends xa{constructor(u,a,l,d){super(u,{layout:kF||(kF=new no({visibility:new Ht(lt.layout_hillshade.visibility)})),paint:OF||(OF=new no({"hillshade-illumination-direction":new Ht(lt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ht(lt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ht(lt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ht(lt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ht(lt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ht(lt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Ht(lt.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"})}))},a,l,d)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(u,a,l){return{overrideFog:!1}}},fill:class extends xa{constructor(u,a,l,d){super(u,{layout:QF||(QF=new no({"fill-sort-key":new ti(lt.layout_fill["fill-sort-key"]),visibility:new Ht(lt.layout_fill.visibility),"fill-elevation-reference":new Ht(lt.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new ti(lt.layout_fill["fill-construct-bridge-guard-rail"])})),paint:JF||(JF=new no({"fill-antialias":new Ht(lt.paint_fill["fill-antialias"]),"fill-opacity":new ti(lt.paint_fill["fill-opacity"]),"fill-color":new ti(lt.paint_fill["fill-color"]),"fill-outline-color":new ti(lt.paint_fill["fill-outline-color"]),"fill-translate":new Ht(lt.paint_fill["fill-translate"]),"fill-translate-anchor":new Ht(lt.paint_fill["fill-translate-anchor"]),"fill-pattern":new ti(lt.paint_fill["fill-pattern"]),"fill-emissive-strength":new Ht(lt.paint_fill["fill-emissive-strength"]),"fill-z-offset":new ti(lt.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new ti(lt.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new ti(lt.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"})}))},a,l,d)}getProgramIds(){let u=this.paint.get("fill-pattern"),a=u&&u.constantOr(1),l=[a?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(a&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getDefaultProgramParams(u,a,l){return{config:new hp(this,{zoom:a,lut:l}),overrideFog:!1}}recalculate(u,a){super.recalculate(u,a);let l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new eA(u)}queryRadius(){return Et(this.paint.get("fill-translate"))}queryIntersectsFeature(u,a,l,d,p,h){return!u.queryGeometry.isAboveHorizon&&re(Ct(u.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),h.angle,u.pixelToTileUnitsFactor),d)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(u){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;let a=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return u!=null?a&&!u:a}},"fill-extrusion":class extends xa{constructor(u,a,l,d){super(u,{layout:D6||(D6=new no({visibility:new Ht(lt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Ht(lt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:M6||(M6=new no({"fill-extrusion-opacity":new Ht(lt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ti(lt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ht(lt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ht(lt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ti(lt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ti(lt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ti(lt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Ht(lt["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Ht(lt["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Ht(lt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Ht(lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Ht(lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Ht(lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Ht(lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Ht(lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Ht(lt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Ht(lt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new ti(lt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new ti(lt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Ht(lt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Ht(lt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Ht(lt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Ht(lt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new ti(lt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new ti(lt["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Ht(lt["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"})}))},a,l,d),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new XE(u)}queryRadius(){return Et(this.paint.get("fill-extrusion-translate"))}is3D(u){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(u,a,l,d,p,h,_,x,C){let M=Ut(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),h.angle,u.pixelToTileUnitsFactor),v=this.paint.get("fill-extrusion-height").evaluate(a,l),S=this.paint.get("fill-extrusion-base").evaluate(a,l),A=[0,0],D=x&&h.elevation,I=h.elevation?h.elevation.exaggeration():1,O=u.tile.getBucket(this);if(D&&O instanceof XE){let H=O.centroidVertexArray,K=C+1;K<H.length&&(A[0]=H.geta_centroid_pos0(K),A[1]=H.geta_centroid_pos1(K))}if(A[0]===0&&A[1]===1)return!1;h.projection.name==="globe"&&(d=T6([d],[new Wt(0,0),new Wt($t,$t)],u.tileID.canonical).map(H=>H.polygon).flat());let z=D?x:null,[B,G]=function(H,K,ee,ne,ve,pe,fe,Fe,be,Be,$e){return H.projection.name==="globe"?function(Ue,Ye,Ze,rt,Je,ot,kt,Mt,ni,Vt,qt){let Lt=[],Ri=[],Jt=Ue.projection.upVectorScale(qt,Ue.center.lat,Ue.worldSize).metersToTile,mi=[0,0,0,1],Hi=[0,0,0,1],mn=(bn,fn,Dn,Kn)=>{bn[0]=fn,bn[1]=Dn,bn[2]=Kn,bn[3]=1},Xi=S6();Ze>0&&(Ze+=Xi),rt+=Xi;for(let bn of Ye){let fn=[],Dn=[];for(let Kn of bn){let Rr=Kn.x+Je.x,Wi=Kn.y+Je.y,Nn=Ue.projection.projectTilePoint(Rr,Wi,qt),Hr=Ue.projection.upVector(qt,Kn.x,Kn.y),Xr=Ze,ro=rt;if(kt){let uo=A6(Rr,Wi,Ze,rt,kt,Mt,ni,Vt);Xr+=uo.base,ro+=uo.top}Ze!==0?mn(mi,Nn.x+Hr[0]*Jt*Xr,Nn.y+Hr[1]*Jt*Xr,Nn.z+Hr[2]*Jt*Xr):mn(mi,Nn.x,Nn.y,Nn.z),mn(Hi,Nn.x+Hr[0]*Jt*ro,Nn.y+Hr[1]*Jt*ro,Nn.z+Hr[2]*Jt*ro),ge.vec3.transformMat4(mi,mi,ot),ge.vec3.transformMat4(Hi,Hi,ot),fn.push(new xg(mi[0],mi[1],mi[2])),Dn.push(new xg(Hi[0],Hi[1],Hi[2]))}Lt.push(fn),Ri.push(Dn)}return[Lt,Ri]}(H,K,ee,ne,ve,pe,fe,Fe,be,Be,$e):fe?function(Ue,Ye,Ze,rt,Je,ot,kt,Mt,ni){let Vt=[],qt=[],Lt=[0,0,0,1];for(let Ri of Ue){let Jt=[],mi=[];for(let Hi of Ri){let mn=Hi.x+rt.x,Xi=Hi.y+rt.y,bn=A6(mn,Xi,Ye,Ze,ot,kt,Mt,ni);Lt[0]=mn,Lt[1]=Xi,Lt[2]=bn.base,Lt[3]=1,ge.vec4.transformMat4(Lt,Lt,Je),Lt[3]=Math.max(Lt[3],1e-5);let fn=new xg(Lt[0]/Lt[3],Lt[1]/Lt[3],Lt[2]/Lt[3]);Lt[0]=mn,Lt[1]=Xi,Lt[2]=bn.top,Lt[3]=1,ge.vec4.transformMat4(Lt,Lt,Je),Lt[3]=Math.max(Lt[3],1e-5);let Dn=new xg(Lt[0]/Lt[3],Lt[1]/Lt[3],Lt[2]/Lt[3]);Jt.push(fn),mi.push(Dn)}Vt.push(Jt),qt.push(mi)}return[Vt,qt]}(K,ee,ne,ve,pe,fe,Fe,be,Be):function(Ue,Ye,Ze,rt,Je){let ot=[],kt=[],Mt=Je[8]*Ye,ni=Je[9]*Ye,Vt=Je[10]*Ye,qt=Je[11]*Ye,Lt=Je[8]*Ze,Ri=Je[9]*Ze,Jt=Je[10]*Ze,mi=Je[11]*Ze;for(let Hi of Ue){let mn=[],Xi=[];for(let bn of Hi){let fn=bn.x+rt.x,Dn=bn.y+rt.y,Kn=Je[0]*fn+Je[4]*Dn+Je[12],Rr=Je[1]*fn+Je[5]*Dn+Je[13],Wi=Je[2]*fn+Je[6]*Dn+Je[14],Nn=Je[3]*fn+Je[7]*Dn+Je[15],Hr=Kn+Mt,Xr=Rr+ni,ro=Wi+Vt,uo=Math.max(Nn+qt,1e-5),Dr=Kn+Lt,fa=Rr+Ri,Zs=Wi+Jt,Fo=Math.max(Nn+mi,1e-5);mn.push(new xg(Hr/uo,Xr/uo,ro/uo)),Xi.push(new xg(Dr/Fo,fa/Fo,Zs/Fo))}ot.push(mn),kt.push(Xi)}return[ot,kt]}(K,ee,ne,ve,pe)}(h,d,S,v,M,_,z,A,I,h.center.lat,u.tileID.canonical),$=u.queryGeometry;return function(H,K,ee){let ne=1/0;re(ee,K)&&(ne=I6(ee,K[0]));for(let ve=0;ve<K.length;ve++){let pe=K[ve],fe=H[ve];for(let Fe=0;Fe<pe.length-1;Fe++){let be=pe[Fe],Be=[be,pe[Fe+1],fe[Fe+1],fe[Fe],be];ie(ee,Be)&&(ne=Math.min(ne,I6(ee,Be)))}}return ne!==1/0&&ne}(B,G,$.isPointQuery()?$.screenBounds:$.screenGeometry)}},line:class extends xa{constructor(u,a,l,d){let p=V6();super(u,p,a,l,d),p.layout&&(this.layout=new gf(p.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){let a=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=a._styleExpression&&a._styleExpression.expression instanceof ac,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(u,a){super.recalculate(u,a),this.paint._values["line-floorwidth"]=(()=>{if(Kb)return Kb;let l=V6();return Kb=new VX(l.paint.properties["line-width"].specification),Kb.useIntegerZoom=!0,Kb})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new sA(u)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(u,a,l){let d=z6(this);return{config:new hp(this,{zoom:a,lut:l}),defines:d,overrideFog:!1}}queryRadius(u){let a=u,l=j6(nt("line-width",this,a),nt("line-gap-width",this,a)),d=nt("line-offset",this,a);return l/2+Math.abs(d)+Et(this.paint.get("line-translate"))}queryIntersectsFeature(u,a,l,d,p,h){if(u.queryGeometry.isAboveHorizon)return!1;let _=Ct(u.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),h.angle,u.pixelToTileUnitsFactor),x=u.pixelToTileUnitsFactor/2*j6(this.paint.get("line-width").evaluate(a,l),this.paint.get("line-gap-width").evaluate(a,l)),C=this.paint.get("line-offset").evaluate(a,l);return C&&(d=function(M,v){let S=[],A=new Wt(0,0);for(let D=0;D<M.length;D++){let I=M[D],O=[];for(let z=0;z<I.length;z++){let B=I[z],G=I[z+1],$=z===0?A:B.sub(I[z-1])._unit()._perp(),H=z===I.length-1?A:G.sub(B)._unit()._perp(),K=$._add(H)._unit();K._mult(1/(K.x*H.x+K.y*H.y)),O.push(K._mult(v)._add(B))}S.push(O)}return S}(d,C*u.pixelToTileUnitsFactor)),function(M,v,S){for(let A=0;A<v.length;A++){let D=v[A];if(M.length>=3){for(let I=0;I<D.length;I++)if(Ae(M,D[I]))return!0}if(oe(M,D,S))return!0}return!1}(_,d,x)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(u){return!this.hasElevatedBuckets}},symbol:hC,background:class extends xa{constructor(u,a,l,d){super(u,{layout:A5||(A5=new no({visibility:new Ht(lt.layout_background.visibility)})),paint:R5||(R5=new no({"background-pitch-alignment":new Ht(lt.paint_background["background-pitch-alignment"]),"background-color":new Ht(lt.paint_background["background-color"]),"background-pattern":new Ht(lt.paint_background["background-pattern"]),"background-opacity":new Ht(lt.paint_background["background-opacity"]),"background-emissive-strength":new Ht(lt.paint_background["background-emissive-strength"]),"background-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"})}))},a,l,d)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(u,a,l){return{overrideFog:!1}}is3D(u){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:L5,"raster-particle":U5,sky:class extends xa{constructor(u,a,l,d){super(u,{layout:B5||(B5=new no({visibility:new Ht(lt.layout_sky.visibility)})),paint:V5||(V5=new no({"sky-type":new Ht(lt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ht(lt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ht(lt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ht(lt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ht(lt.paint_sky["sky-gradient-radius"]),"sky-gradient":new _f(lt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ht(lt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ht(lt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ht(lt.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"})}))},a,l,d),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="sky-gradient"?this._updateColorRamp():u!=="sky-atmosphere-sun"&&u!=="sky-atmosphere-halo-color"&&u!=="sky-atmosphere-color"&&u!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=jb({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(u){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){let a=u.style.light.properties.get("position");return this._lightPosition.azimuthal!==a.azimuthal||this._lightPosition.polar!==a.polar}return!1}getCenter(u,a){if(this.paint.get("sky-type")==="atmosphere"){let d=this.paint.get("sky-atmosphere-sun"),p=!d,h=u.style.light,_=h.properties.get("position");return p&&h.properties.get("anchor")==="viewport"&&Gt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?IA(_.azimuthal,90-_.polar,a):IA(d[0],90-d[1],a)}let l=this.paint.get("sky-gradient-center");return IA(l[0],90-l[1],a)}isSky(){return!0}markSkyboxValid(u){this._skyboxInvalidated=!1,this._lightPosition=u.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){let u=this.paint.get("sky-type");return u==="atmosphere"?["skyboxCapture","skybox"]:u==="gradient"?["skyboxGradient"]:null}},slot:class extends xa{constructor(u,a,l,d){super(u,{paint:j5||(j5=new no({}))},a,null)}},model:class extends xa{constructor(u,a,l,d){super(u,{layout:Q5||(Q5=new no({visibility:new Ht(lt.layout_model.visibility),"model-id":new ti(lt.layout_model["model-id"])})),paint:J5||(J5=new no({"model-opacity":new ti(lt.paint_model["model-opacity"]),"model-rotation":new ti(lt.paint_model["model-rotation"]),"model-scale":new ti(lt.paint_model["model-scale"]),"model-translation":new ti(lt.paint_model["model-translation"]),"model-color":new ti(lt.paint_model["model-color"]),"model-color-mix-intensity":new ti(lt.paint_model["model-color-mix-intensity"]),"model-type":new Ht(lt.paint_model["model-type"]),"model-cast-shadows":new Ht(lt.paint_model["model-cast-shadows"]),"model-receive-shadows":new Ht(lt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Ht(lt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new ti(lt.paint_model["model-emissive-strength"]),"model-roughness":new ti(lt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new ti(lt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Ht(lt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Ht(lt.paint_model["model-front-cutoff"]),"model-color-use-theme":new ti({type:"string",default:"default","property-type":"data-driven"})}))},a,l,d),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new kA(u)}getProgramIds(){return["model"]}is3D(u){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(u){return u instanceof bC?$t-1:0}queryIntersectsFeature(u,a,l,d,p,h){if(!this.modelManager)return!1;let _=this.modelManager,x=u.tile.getBucket(this);if(!(x&&x instanceof kA))return!1;for(let C in x.instancesPerModel){let M=x.instancesPerModel[C],v=a.id!==void 0?a.id:a.properties&&a.properties.hasOwnProperty("id")?a.properties.id:void 0;if(M.idToFeaturesIndex.hasOwnProperty(v)){let S=M.features[M.idToFeaturesIndex[v]],A=_.getModel(C,this.scope);if(!A)return!1;let D=ge.mat4.create(),I=new er(0,0),O=x.canonical,z=Number.MAX_VALUE;for(let B=0;B<S.instancedDataCount;++B){let G=16*(S.instancedDataOffset+B),$=M.instancedDataArray.float32,H=[$[G+4],$[G+5],$[G+6]];o8(O,I,$[G],0|$[G+1]),e8(D,A,h,I,S.rotation,S.scale,H,!1,!1,!1),h.projection.name==="globe"&&(D=RA(D,h));let K=ge.mat4.multiply([],h.projMatrix,D),ee=u.queryGeometry,ne=W5(ee.isPointQuery()?ee.screenBounds:ee.screenGeometry,h,K,A.aabb);ne!=null&&(z=Math.min(ne,z))}return z!==Number.MAX_VALUE&&z}}return!1}_handleOverridablePaintPropertyUpdate(u,a,l){return!(!this.layout||a.isDataDriven()||l.isDataDriven()||u!=="model-color"&&u!=="model-color-mix-intensity"&&u!=="model-rotation"&&u!=="model-scale"&&u!=="model-translation"&&u!=="model-emissive-strength")}_isPropertyZoomDependent(u){let a=this._transitionablePaint._values[u];return a!=null&&a.value!=null&&a.value.expression!=null&&a.value.expression instanceof uf}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends xa{constructor(u,a,l,d){super(u,{layout:e6||(e6=new no({"clip-layer-types":new Ht(lt.layout_clip["clip-layer-types"]),"clip-layer-scope":new Ht(lt.layout_clip["clip-layer-scope"])})),paint:t6||(t6=new no({}))},a,l,d)}recalculate(u,a){super.recalculate(u,a)}createBucket(u){return new i6(u)}is3D(u){return!0}}};class VQ{constructor(a){this._callback=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class jQ{constructor(){this.tasks={},this.taskQueue=[],eh(["process"],this),this.invoker=new VQ(this.process),this.nextId=0}add(a,l){let d=this.nextId++,p=function({type:h,isSymbolTile:_,zoom:x}){return x=x||0,h==="message"?0:h!=="maybePrepare"||_?h!=="parseTile"||_?h==="parseTile"&&_?300-x:h==="maybePrepare"&&_?400-x:500:200-x:100-x}(l);if(p===0){try{a()}finally{}return null}return this.tasks[d]={fn:a,metadata:l,priority:p,id:d},this.taskQueue.push(d),this.invoker.trigger(),{cancel:()=>{delete this.tasks[d]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(d=>!!this.tasks[d]),!this.taskQueue.length)return;let a=this.pick();if(a===null)return;let l=this.tasks[a];if(delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let a=null,l=1/0;for(let p=0;p<this.taskQueue.length;p++){let h=this.tasks[this.taskQueue[p]];h.priority<l&&(l=h.priority,a=p)}if(a===null)return null;let d=this.taskQueue[a];return this.taskQueue.splice(a,1),d}remove(){this.invoker.remove()}}class a8{constructor(a,l,d){this.target=a,this.parent=l,this.mapId=d,this.callbacks={},this.cancelCallbacks={},eh(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new jQ}send(a,l,d,p,h=!1,_){let x=Math.round(1e18*Math.random()).toString(36).substring(0,10);d&&(d.metadata=_,this.callbacks[x]=d);let C=new Set;return this.target.postMessage({id:x,type:a,hasCallback:!!d,targetMapId:p,mustQueue:h,sourceMapId:this.mapId,data:hh(l,C)},C),{cancel:()=>{d&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(a){let l=a.data;if(!l)return;let d=l.id;if(d&&(!l.targetMapId||this.mapId===l.targetMapId))if(l.type==="<cancel>"){let p=this.cancelCallbacks[d];delete this.cancelCallbacks[d],p&&p.cancel()}else if(l.mustQueue||Pi()){let p=this.callbacks[d],h=this.scheduler.add(()=>this.processTask(d,l),p&&p.metadata||{type:"message"});h&&(this.cancelCallbacks[d]=h)}else this.processTask(d,l)}processTask(a,l){if(delete this.cancelCallbacks[a],l.type==="<response>"){let d=this.callbacks[a];delete this.callbacks[a],d&&(l.error?d(Ll(l.error)):d(null,Ll(l.data)))}else{let d=new Set,p=l.hasCallback?(_,x)=>{this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:_?hh(_):null,data:hh(x,d)},d)}:()=>{},h=Ll(l.data);if(this.parent[l.type])this.parent[l.type](l.sourceMapId,h,p);else if(this.parent.getWorkerSource){let _=l.type.split(".");this.parent.getWorkerSource(l.sourceMapId,_[0],h.source,h.scope)[_[1]](h,p)}else p(new Error(`Could not find function ${l.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var c1={workerUrl:"",workerClass:null,workerParams:void 0};let LA="mapboxgl_preloaded_worker_pool",xC=(()=>{class u{constructor(){this.active={}}acquire(l,d=u.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<d;)this.workers.push(c1.workerClass!=null?new c1.workerClass:new self.Worker(c1.workerUrl,c1.workerParams));return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.workers&&this.numActive()===0&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[LA]}numActive(){return Object.keys(this.active).length}}return u.workerCount=2,u})();class H_{constructor(a,l,d="Worker",p=xC.workerCount){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=Xl();let h=this.workerPool.acquire(this.id,p);for(let _=0;_<h.length;_++){let x=new H_.Actor(h[_],l,this.id);x.name=`${d} ${_}`,this.actors.push(x)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(a,l,d){Cr(this.actors,(p,h)=>{p.send(a,l,h)},d=d||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(a=>{a.remove()}),this.actors=[],this.workerPool.release(this.id)}}let u1,FA;function wC(){return u1||(u1=new xC),u1}H_.Actor=a8;let zA=new Ui(0,0,0);var BA=(u=>(u[u.PATH_RULE_UNSPECIFIED=0]="PATH_RULE_UNSPECIFIED",u[u.PATH_RULE_NON_ZERO=1]="PATH_RULE_NON_ZERO",u[u.PATH_RULE_EVEN_ODD=2]="PATH_RULE_EVEN_ODD",u))(BA||{}),EC=(u=>(u[u.LINE_CAP_UNSPECIFIED=0]="LINE_CAP_UNSPECIFIED",u[u.LINE_CAP_BUTT=1]="LINE_CAP_BUTT",u[u.LINE_CAP_ROUND=2]="LINE_CAP_ROUND",u[u.LINE_CAP_SQUARE=3]="LINE_CAP_SQUARE",u))(EC||{}),d1=(u=>(u[u.LINE_JOIN_UNSPECIFIED=0]="LINE_JOIN_UNSPECIFIED",u[u.LINE_JOIN_MITER=1]="LINE_JOIN_MITER",u[u.LINE_JOIN_MITER_CLIP=2]="LINE_JOIN_MITER_CLIP",u[u.LINE_JOIN_ROUND=3]="LINE_JOIN_ROUND",u[u.LINE_JOIN_BEVEL=4]="LINE_JOIN_BEVEL",u))(d1||{}),s8=(u=>(u[u.PAINT_ORDER_UNSPECIFIED=0]="PAINT_ORDER_UNSPECIFIED",u[u.PAINT_ORDER_FILL_AND_STROKE=1]="PAINT_ORDER_FILL_AND_STROKE",u[u.PAINT_ORDER_STROKE_AND_FILL=2]="PAINT_ORDER_STROKE_AND_FILL",u))(s8||{}),q_=(u=>(u[u.PATH_COMMAND_UNSPECIFIED=0]="PATH_COMMAND_UNSPECIFIED",u[u.PATH_COMMAND_MOVE=1]="PATH_COMMAND_MOVE",u[u.PATH_COMMAND_LINE=2]="PATH_COMMAND_LINE",u[u.PATH_COMMAND_QUAD=3]="PATH_COMMAND_QUAD",u[u.PATH_COMMAND_CUBIC=4]="PATH_COMMAND_CUBIC",u[u.PATH_COMMAND_CLOSE=5]="PATH_COMMAND_CLOSE",u))(q_||{}),l8=(u=>(u[u.MASK_TYPE_UNSPECIFIED=0]="MASK_TYPE_UNSPECIFIED",u[u.MASK_TYPE_LUMINANCE=1]="MASK_TYPE_LUMINANCE",u[u.MASK_TYPE_ALPHA=2]="MASK_TYPE_ALPHA",u))(l8||{});function UQ(u,a,l){u===1&&a.icons.push(function(d,p){return function(h){if(h.usvg_tree.height||(h.usvg_tree.height=h.usvg_tree.width),!h.metadata)return h;let{metadata:_}=h;if(_.content_area){let{content_area:x}=_;x.top==null&&(x.top=x.left),x.width==null&&(x.width=h.usvg_tree.width),x.height==null&&(x.height=x.width)}return _.stretch_x&&_.stretch_x.length&&c8(_,"x"),_.stretch_y&&_.stretch_y.length&&c8(_,"y"),h}(d.readFields(HQ,{name:void 0},p))}(l,l.readVarint()+l.pos))}function c8(u,a){let l=[],d=u[`stretch_${a}`],p=null;for(let h=0;h<d.length;h++)p===null?p=l.length===0?d[0]:l[l.length-1][1]+d[h]:(l.push([p,p+d[h]]),p=null);u[`stretch_${a}_areas`]=l}function HQ(u,a,l){u===1?a.name=l.readString():u===2?a.metadata=function(d,p){return d.readFields(qQ,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},p)}(l,l.readVarint()+l.pos):u===3&&(a.usvg_tree=function(d,p){return d.readFields(WQ,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},p)}(l,l.readVarint()+l.pos),a.data="usvg_tree")}function qQ(u,a,l){u===1?a.stretch_x=l.readPackedVarint():u===2?a.stretch_y=l.readPackedVarint():u===3?a.content_area=function(d,p){return d.readFields($Q,{left:0},p)}(l,l.readVarint()+l.pos):u===4&&a.variables.push(function(d,p){return d.readFields(GQ,{name:void 0},p)}(l,l.readVarint()+l.pos))}function $Q(u,a,l){u===1?a.left=l.readVarint():u===2?a.width=l.readVarint():u===3?a.top=l.readVarint():u===4&&(a.height=l.readVarint())}function GQ(u,a,l){u===1?a.name=l.readString():u===2&&(a.rgb_color=TC(l.readVarint()),a.value="rgb_color")}function WQ(u,a,l){u===1?a.width=a.height=l.readVarint():u===2?a.height=l.readVarint():u===3?a.children.push(CC(l,l.readVarint()+l.pos)):u===4?a.linear_gradients.push(function(d,p){return d.readFields(eJ,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},p)}(l,l.readVarint()+l.pos)):u===5?a.radial_gradients.push(function(d,p){return d.readFields(iJ,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},p)}(l,l.readVarint()+l.pos)):u===7?a.clip_paths.push(function(d,p){return d.readFields(nJ,{children:[]},p)}(l,l.readVarint()+l.pos)):u===8&&a.masks.push(function(d,p){let h=d.readFields(rJ,{left:0,width:20,mask_type:1,children:[]},p);return h.height==null&&(h.height=h.width),h.top==null&&(h.top=h.left),h}(l,l.readVarint()+l.pos))}function CC(u,a){return u.readFields(ZQ,{},a)}function ZQ(u,a,l){u===1?(a.group=function(d,p){return d.readFields(YQ,{opacity:255,children:[]},p)}(l,l.readVarint()+l.pos),a.node="group"):u===2&&(a.path=function(d,p){return d.readFields(XQ,{paint_order:1,commands:[],step:1,diffs:[],rule:1},p)}(l,l.readVarint()+l.pos),a.node="path")}function YQ(u,a,l){u===1?a.transform=SC(l,l.readVarint()+l.pos):u===2?a.opacity=l.readVarint():u===5?a.clip_path_idx=l.readVarint():u===6?a.mask_idx=l.readVarint():u===7&&a.children.push(CC(l,l.readVarint()+l.pos))}function SC(u,a){return u.readFields(KQ,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},a)}function KQ(u,a,l){u===1?a.sx=l.readFloat():u===2?a.ky=l.readFloat():u===3?a.kx=l.readFloat():u===4?a.sy=l.readFloat():u===5?a.tx=l.readFloat():u===6&&(a.ty=l.readFloat())}function XQ(u,a,l){u===1?a.fill=function(d,p){return d.readFields(QQ,{rgb_color:zA,paint:"rgb_color",opacity:255},p)}(l,l.readVarint()+l.pos):u===2?a.stroke=function(d,p){return d.readFields(JQ,{rgb_color:zA,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},p)}(l,l.readVarint()+l.pos):u===3?a.paint_order=l.readVarint():u===5?l.readPackedVarint(a.commands):u===6?a.step=l.readFloat():u===7?l.readPackedSVarint(a.diffs):u===8&&(a.rule=l.readVarint())}function QQ(u,a,l){u===1?(a.rgb_color=TC(l.readVarint()),a.paint="rgb_color"):u===2?(a.linear_gradient_idx=l.readVarint(),a.paint="linear_gradient_idx"):u===3?(a.radial_gradient_idx=l.readVarint(),a.paint="radial_gradient_idx"):u===5&&(a.opacity=l.readVarint())}function TC(u){return new Ui((u>>16&255)/255,(u>>8&255)/255,(255&u)/255,1)}function JQ(u,a,l){u===1?(a.rgb_color=TC(l.readVarint()),a.paint="rgb_color"):u===2?(a.linear_gradient_idx=l.readVarint(),a.paint="linear_gradient_idx"):u===3?(a.radial_gradient_idx=l.readVarint(),a.paint="radial_gradient_idx"):u===5?l.readPackedFloat(a.dasharray):u===6?a.dashoffset=l.readFloat():u===7?a.miterlimit=l.readFloat():u===8?a.opacity=l.readVarint():u===9?a.width=l.readFloat():u===10?a.linecap=l.readVarint():u===11&&(a.linejoin=l.readVarint())}function eJ(u,a,l){u===1?a.transform=SC(l,l.readVarint()+l.pos):u===2?a.spread_method=l.readVarint():u===3?a.stops.push(u8(l,l.readVarint()+l.pos)):u===4?a.x1=l.readFloat():u===5?a.y1=l.readFloat():u===6?a.x2=l.readFloat():u===7&&(a.y2=l.readFloat())}function u8(u,a){return u.readFields(tJ,{offset:0,opacity:255,rgb_color:zA},a)}function tJ(u,a,l){u===1?a.offset=l.readFloat():u===2?a.opacity=l.readVarint():u===3&&(a.rgb_color=TC(l.readVarint()))}function iJ(u,a,l){u===1?a.transform=SC(l,l.readVarint()+l.pos):u===2?a.spread_method=l.readVarint():u===3?a.stops.push(u8(l,l.readVarint()+l.pos)):u===4?a.cx=l.readFloat():u===5?a.cy=l.readFloat():u===6?a.r=l.readFloat():u===7?a.fx=l.readFloat():u===8?a.fy=l.readFloat():u===9&&(a.fr=l.readFloat())}function nJ(u,a,l){u===1?a.transform=SC(l,l.readVarint()+l.pos):u===2?a.clip_path_idx=l.readVarint():u===3&&a.children.push(CC(l,l.readVarint()+l.pos))}function rJ(u,a,l){u===1?a.left=a.top=l.readFloat():u===2?a.width=a.height=l.readFloat():u===3?a.top=l.readFloat():u===4?a.height=l.readFloat():u===5?a.mask_type=l.readVarint():u===6?a.mask_idx=l.readVarint():u===7&&a.children.push(CC(l,l.readVarint()+l.pos))}class oJ{static calculate(a={},l=[]){let d=new Map,p=new Map;if(Object.keys(a).length===0)return d;l.forEach(h=>{p.set(h.name,h.rgb_color||new Ui(0,0,0))});for(let[h,_]of Object.entries(a))p.has(h)?d.set(p.get(h).toStringPremultipliedAlpha(),_):console.warn(`Ignoring unknown image variable "${h}"`);return d}}function $_(u,a=255,l){let d=a/255,p=u.toStringPremultipliedAlpha(),h=l.has(p)?l.get(p).clone():u.clone();return h.a*=d,h.toString()}function h1(u,a){if(!gt()){let l=document.createElement("canvas");return l.width=u,l.height=a,l}return new OffscreenCanvas(u,a)}function aJ(u,a){let l=oJ.calculate(a.params,u.metadata?u.metadata.variables:[]),d=u.usvg_tree,p=d.width,h=d.height,_=a.transform?a.transform:new DOMMatrix,x=Math.max(1,Math.round(p*_.a)),C=Math.max(1,Math.round(h*_.d)),M=new DOMMatrix([x/p,0,0,C/h,0,0]),v=h1(x,C).getContext("2d");return VA(v,M,d,d,l),v.getImageData(0,0,x,C)}function VA(u,a,l,d,p){for(let h of d.children)d8(u,a,l,h,p)}function d8(u,a,l,d,p){d.group?(u.save(),function(h,_,x,C,M){let v=C.mask_idx!=null?x.masks[C.mask_idx]:null,S=C.clip_path_idx!=null?x.clip_paths[C.clip_path_idx]:null;if(C.transform&&(_=DC(C.transform).preMultiplySelf(_)),!function(I,O,z){return I.opacity!==255||O||z}(C,S!=null,v!=null))return void VA(h,_,x,C,M);let A=h1(h.canvas.width,h.canvas.height),D=A.getContext("2d");VA(D,_,x,C,M),S&&y8(D,_,x,S),v&&v8(D,_,x,v,M),h.globalAlpha=C.opacity/255,h.drawImage(A,0,0)}(u,a,l,d.group,p),u.restore()):d.path&&(u.save(),function(h,_,x,C,M){let v=b8(C);h.setTransform(_),C.paint_order===s8.PAINT_ORDER_FILL_AND_STROKE?(h8(h,x,C,v,M),f8(h,x,C,v,M)):(f8(h,x,C,v,M),h8(h,x,C,v,M))}(u,a,l,d.path,p),u.restore())}function h8(u,a,l,d,p){let h=l.fill;if(!h)return;let _=h.opacity/255;switch(h.paint){case"rgb_color":u.fillStyle=$_(h.rgb_color,h.opacity,p);break;case"linear_gradient_idx":u.fillStyle=m8(u,a.linear_gradients[h.linear_gradient_idx],_,p);break;case"radial_gradient_idx":u.fillStyle=g8(u,a.radial_gradients[h.radial_gradient_idx],_,p)}u.fill(d,p8(l))}function p8(u){return u.rule===BA.PATH_RULE_NON_ZERO?"nonzero":u.rule===BA.PATH_RULE_EVEN_ODD?"evenodd":void 0}function f8(u,a,l,d,p){let h=l.stroke;if(!h)return;u.lineWidth=h.width,u.miterLimit=h.miterlimit,u.setLineDash(h.dasharray),u.lineDashOffset=h.dashoffset;let _=h.opacity/255;switch(h.paint){case"rgb_color":u.strokeStyle=$_(h.rgb_color,h.opacity,p);break;case"linear_gradient_idx":u.strokeStyle=m8(u,a.linear_gradients[h.linear_gradient_idx],_,p);break;case"radial_gradient_idx":u.strokeStyle=g8(u,a.radial_gradients[h.radial_gradient_idx],_,p)}switch(h.linejoin){case d1.LINE_JOIN_MITER_CLIP:case d1.LINE_JOIN_MITER:u.lineJoin="miter";break;case d1.LINE_JOIN_ROUND:u.lineJoin="round";break;case d1.LINE_JOIN_BEVEL:u.lineJoin="bevel"}switch(h.linecap){case EC.LINE_CAP_BUTT:u.lineCap="butt";break;case EC.LINE_CAP_ROUND:u.lineCap="round";break;case EC.LINE_CAP_SQUARE:u.lineCap="square"}u.stroke(d)}function m8(u,a,l,d){if(a.stops.length===1){let A=a.stops[0];return $_(A.rgb_color,A.opacity*l,d)}let p=DC(a.transform),{x1:h,y1:_,x2:x,y2:C}=a,M=p.transformPoint(new DOMPoint(h,_)),v=p.transformPoint(new DOMPoint(x,C)),S=u.createLinearGradient(M.x,M.y,v.x,v.y);for(let A of a.stops)S.addColorStop(A.offset,$_(A.rgb_color,A.opacity*l,d));return S}function g8(u,a,l,d){if(a.stops.length===1){let A=a.stops[0];return $_(A.rgb_color,A.opacity*l,d)}let p=DC(a.transform),{fx:h,fy:_,cx:x,cy:C}=a,M=p.transformPoint(new DOMPoint(h,_)),v=p.transformPoint(new DOMPoint(x,C)),S=u.createRadialGradient(M.x,M.y,0,v.x,v.y,a.r*((p.a+p.d)/2));for(let A of a.stops)S.addColorStop(A.offset,$_(A.rgb_color,A.opacity*l,d));return S}function _8(u,a,l,d){let p=d.transform?DC(d.transform).preMultiplySelf(a):a,h=h1(u.canvas.width,u.canvas.height),_=h.getContext("2d");for(let C of d.children)if(C.group)_8(_,p,l,C.group);else if(C.path){let M=C.path,v=new Path2D;v.addPath(b8(M),p),_.fill(v,p8(M))}let x=d.clip_path_idx!=null?l.clip_paths[d.clip_path_idx]:null;x&&y8(_,p,l,x),u.globalCompositeOperation="source-over",u.drawImage(h,0,0)}function y8(u,a,l,d){let p=h1(u.canvas.width,u.canvas.height);_8(p.getContext("2d"),a,l,d),u.globalCompositeOperation="destination-in",u.drawImage(p,0,0)}function v8(u,a,l,d,p){if(d.children.length===0)return;let h=d.mask_idx!=null?l.masks[d.mask_idx]:null;h&&v8(u,a,l,h,p);let _=u.canvas.width,x=u.canvas.height,C=h1(_,x),M=C.getContext("2d"),v=d.width,S=d.height,A=d.left,D=d.top,I=new Path2D,O=new Path2D;O.rect(A,D,v,S),I.addPath(O,a),M.clip(I);for(let G of d.children)d8(M,a,l,G,p);let z=M.getImageData(0,0,_,x),B=z.data;if(d.mask_type===l8.MASK_TYPE_LUMINANCE)for(let G=0;G<B.length;G+=4)B[G+3]=B[G+3]/255*(.2126*B[G]+.7152*B[G+1]+.0722*B[G+2]);M.putImageData(z,0,0),u.globalCompositeOperation="destination-in",u.drawImage(C,0,0)}function DC(u){return u?new DOMMatrix([u.sx,u.ky,u.kx,u.sy,u.tx,u.ty]):new DOMMatrix}function b8(u){let a=new Path2D,l=u.step,d=u.diffs[0]*l,p=u.diffs[1]*l;a.moveTo(d,p);for(let h=0,_=2;h<u.commands.length;h++)switch(u.commands[h]){case q_.PATH_COMMAND_MOVE:d+=u.diffs[_++]*l,p+=u.diffs[_++]*l,a.moveTo(d,p);break;case q_.PATH_COMMAND_LINE:d+=u.diffs[_++]*l,p+=u.diffs[_++]*l,a.lineTo(d,p);break;case q_.PATH_COMMAND_QUAD:{let x=d+u.diffs[_++]*l,C=p+u.diffs[_++]*l;d=x+u.diffs[_++]*l,p=C+u.diffs[_++]*l,a.quadraticCurveTo(x,C,d,p);break}case q_.PATH_COMMAND_CUBIC:{let x=d+u.diffs[_++]*l,C=p+u.diffs[_++]*l,M=x+u.diffs[_++]*l,v=C+u.diffs[_++]*l;d=M+u.diffs[_++]*l,p=v+u.diffs[_++]*l,a.bezierCurveTo(x,C,M,v,d,p);break}case q_.PATH_COMMAND_CLOSE:a.closePath()}return a}class MC{constructor(a){this.capacity=a,this.cache=new Map}get(a){if(!this.cache.has(a))return;let l=this.cache.get(a);return this.cache.delete(a),this.cache.set(a,l),l}put(a,l){this.cache.has(a)?this.cache.delete(a):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(a,l)}delete(a){this.cache.delete(a)}}ii(MC,"LRUCache");class jA{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(a){return new Ga(a,a.data)}getFromCache(a,l,d){return this.cacheMap.has(d)||this.cacheMap.set(d,new MC(150)),this.cacheMap.get(d).get(vf(a.toString(),l))}setInCache(a,l,d,p){this.cacheDependenciesMap.has(p)||this.cacheDependenciesMap.set(p,new Map),this.cacheMap.has(p)||this.cacheMap.set(p,new MC(150));let h=this.cacheDependenciesMap.get(p),_=vf(a.id.toString(),d);h.get(_)||h.set(_,new Set);let x=this.cacheMap.get(p),C=a.toString();h.get(_).add(C),x.put(vf(a.toString(),d),l)}removeImagesFromCacheByIds(a,l,d=0){if(!this.cacheMap.has(d)||!this.cacheDependenciesMap.has(d))return;let p=this.cacheMap.get(d),h=this.cacheDependenciesMap.get(d);for(let _ of a){let x=vf(_.toString(),l);if(h.has(x)){for(let C of h.get(x))p.delete(C);h.delete(x)}}}rasterize(a,l,d,p,h=aJ){let _=this.getFromCache(a,d,p);if(_)return _.clone();let x=h(l.icon,a.options),C=jA._getImage(x);return this.setInCache(a,C,d,p),C.clone()}}class x8{constructor(a){this.size=a,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(a,l){let d=this.toIdx(a,l);return{min:this.minimums[d],max:this.maximums[d]}}isLeaf(a,l){return this.leaves[this.toIdx(a,l)]}toIdx(a,l){return l*this.size+a}}function w8(u,a,l,d){let p=0,h=Number.MAX_VALUE;for(let _=0;_<3;_++)if(Math.abs(d[_])<1e-15){if(l[_]<u[_]||l[_]>a[_])return null}else{let x=1/d[_],C=(u[_]-l[_])*x,M=(a[_]-l[_])*x;if(C>M){let v=C;C=M,M=v}if(C>p&&(p=C),M<h&&(h=M),p>h)return null}return p}function E8(u,a,l,d,p,h,_,x,C,M,v){let S=d-u,A=p-a,D=h-l,I=_-u,O=x-a,z=C-l,B=v[1]*z-v[2]*O,G=v[2]*I-v[0]*z,$=v[0]*O-v[1]*I,H=S*B+A*G+D*$;if(Math.abs(H)<1e-15)return null;let K=1/H,ee=M[0]-u,ne=M[1]-a,ve=M[2]-l,pe=(ee*B+ne*G+ve*$)*K;if(pe<0||pe>1)return null;let fe=ne*D-ve*A,Fe=ve*S-ee*D,be=ee*A-ne*S,Be=(v[0]*fe+v[1]*Fe+v[2]*be)*K;return Be<0||pe+Be>1?null:(I*fe+O*Fe+z*be)*K}function C8(u,a,l){return(u-a)/(l-a)}function S8(u,a,l,d,p,h,_,x,C){let M=1<<l,v=h-d,S=_-p,A=(u+1)/M*v+d,D=(a+0)/M*S+p,I=(a+1)/M*S+p;x[0]=(u+0)/M*v+d,x[1]=D,C[0]=A,C[1]=I}class T8{constructor(a){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=a,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;let l=function(h){let _=Math.ceil(Math.log2(h.dim/8)),x=[],C=Math.ceil(Math.pow(2,_)),M=1/C,v=(D,I,O,z,B)=>{let G=z?1:0,$=(D+1)*O-G,H=I*O,K=(I+1)*O-G;B[0]=D*O,B[1]=H,B[2]=$,B[3]=K},S=new x8(C),A=[];for(let D=0;D<C*C;D++){v(D%C,Math.floor(D/C),M,!1,A);let I=Pf(A[0],A[1],h),O=Pf(A[2],A[1],h),z=Pf(A[2],A[3],h),B=Pf(A[0],A[3],h);S.minimums.push(Math.min(I,O,z,B)),S.maximums.push(Math.max(I,O,z,B)),S.leaves.push(1)}for(x.push(S),C/=2;C>=1;C/=2){let D=x[x.length-1];S=new x8(C);for(let I=0;I<C*C;I++){v(I%C,Math.floor(I/C),2,!0,A);let O=D.getElevation(A[0],A[1]),z=D.getElevation(A[2],A[1]),B=D.getElevation(A[2],A[3]),G=D.getElevation(A[0],A[3]),$=D.isLeaf(A[0],A[1]),H=D.isLeaf(A[2],A[1]),K=D.isLeaf(A[2],A[3]),ee=D.isLeaf(A[0],A[3]),ne=Math.min(O.min,z.min,B.min,G.min),ve=Math.max(O.max,z.max,B.max,G.max),pe=$&&H&&K&&ee;S.maximums.push(ve),S.minimums.push(ne),S.leaves.push(ve-ne<=5&&pe?1:0)}x.push(S)}return x}(this.dem),d=l.length-1,p=l[d];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(l,0,0,d,0)}raycastRoot(a,l,d,p,h,_,x=1){return w8([a,l,-100],[d,p,this.maximums[0]*x],h,_)}raycast(a,l,d,p,h,_,x=1){if(!this.nodeCount)return null;let C=this.raycastRoot(a,l,d,p,h,_,x);if(C==null)return null;let M=[],v=[],S=[],A=[],D=[{idx:0,t:C,nodex:0,nodey:0,depth:0}];for(;D.length>0;){let{idx:I,t:O,nodex:z,nodey:B,depth:G}=D.pop();if(this.leaves[I]){S8(z,B,G,a,l,d,p,S,A);let H=1<<G,K=(z+0)/H,ee=(z+1)/H,ne=(B+0)/H,ve=(B+1)/H,pe=Pf(K,ne,this.dem)*x,fe=Pf(ee,ne,this.dem)*x,Fe=Pf(ee,ve,this.dem)*x,be=Pf(K,ve,this.dem)*x,Be=E8(S[0],S[1],pe,A[0],S[1],fe,A[0],A[1],Fe,h,_),$e=E8(A[0],A[1],Fe,S[0],A[1],be,S[0],S[1],pe,h,_),Ue=Math.min(Be!==null?Be:Number.MAX_VALUE,$e!==null?$e:Number.MAX_VALUE);if(Ue!==Number.MAX_VALUE)return Ue;{let Ye=ge.vec3.scaleAndAdd([],h,_,O);if(D8(pe,fe,be,Fe,C8(Ye[0],S[0],A[0]),C8(Ye[1],S[1],A[1]))>=Ye[2])return O}continue}let $=0;for(let H=0;H<this._siblingOffset.length;H++){S8((z<<1)+this._siblingOffset[H][0],(B<<1)+this._siblingOffset[H][1],G+1,a,l,d,p,S,A),S[2]=-100,A[2]=this.maximums[this.childOffsets[I]+H]*x;let K=w8(S,A,h,_);if(K!=null){let ee=K;M[H]=ee;let ne=!1;for(let ve=0;ve<$&&!ne;ve++)ee>=M[v[ve]]&&(v.splice(ve,0,H),ne=!0);ne||(v[$]=H),$++}}for(let H=0;H<$;H++){let K=v[H];D.push({idx:this.childOffsets[I]+K,t:M[K],nodex:(z<<1)+this._siblingOffset[K][0],nodey:(B<<1)+this._siblingOffset[K][1],depth:G+1})}}return null}_addNode(a,l,d){return this.minimums.push(a),this.maximums.push(l),this.leaves.push(d),this.childOffsets.push(0),this.nodeCount++}_construct(a,l,d,p,h){if(a[p].isLeaf(l,d)===1)return;this.childOffsets[h]||(this.childOffsets[h]=this.nodeCount);let _=p-1,x=a[_],C=0,M=0;for(let v=0;v<this._siblingOffset.length;v++){let S=2*l+this._siblingOffset[v][0],A=2*d+this._siblingOffset[v][1],D=x.getElevation(S,A),I=x.isLeaf(S,A),O=this._addNode(D.min,D.max,I);I&&(C|=1<<v),M||(M=O)}for(let v=0;v<this._siblingOffset.length;v++)C&1<<v||this._construct(a,2*l+this._siblingOffset[v][0],2*d+this._siblingOffset[v][1],_,M+v)}}function D8(u,a,l,d,p,h){return pi(pi(u,l,h),pi(a,d,h),p)}function Pf(u,a,l){let d=l.dim,p=pn(u*d-.5,0,d-1),h=pn(a*d-.5,0,d-1),_=Math.floor(p),x=Math.floor(h),C=Math.min(_+1,d-1),M=Math.min(x+1,d-1);return D8(l.get(_,x),l.get(C,x),l.get(_,M),l.get(C,M),p-_,h-x)}let sJ={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function lJ(u,a,l){return(256*u*256+256*a+l)/10-1e4}function cJ(u,a,l){return 256*u+a+l/256-32768}class IC{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(a,l,d,p=!1){if(this.uid=a,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(d&&d!=="mapbox"&&d!=="terrarium")return void Gt(`"${d}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;let h=this.dim=l.height-2,_=new Uint32Array(l.data.buffer);if(this.pixels=new Uint8Array(l.data.buffer),this.floatView=new Float32Array(l.data.buffer),this.borderReady=p,this._modifiedForSources={},!p){for(let C=0;C<h;C++)_[this._idx(-1,C)]=_[this._idx(0,C)],_[this._idx(h,C)]=_[this._idx(h-1,C)],_[this._idx(C,-1)]=_[this._idx(C,0)],_[this._idx(C,h)]=_[this._idx(C,h-1)];_[this._idx(-1,-1)]=_[this._idx(0,0)],_[this._idx(h,-1)]=_[this._idx(h-1,0)],_[this._idx(-1,h)]=_[this._idx(0,h-1)],_[this._idx(h,h)]=_[this._idx(h-1,h-1)]}let x=d==="terrarium"?cJ:lJ;for(let C=0;C<_.length;++C){let M=4*C;this.floatView[C]=x(this.pixels[M],this.pixels[M+1],this.pixels[M+2])}this._timestamp=ft.now()}_buildQuadTree(){this._tree=new T8(this)}get(a,l,d=!1){d&&(a=pn(a,-1,this.dim),l=pn(l,-1,this.dim));let p=this._idx(a,l);return this.floatView[p]}set(a,l,d){let p=this._idx(a,l),h=this.floatView[p];return this.floatView[p]=d,d-h}static getUnpackVector(a){return sJ[a]}_idx(a,l){if(a<-1||a>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(a+1)}static pack(a,l){let d=[0,0,0,0],p=IC.getUnpackVector(l),h=Math.floor((a+p[3])/p[2]);return d[2]=h%256,h=Math.floor(h/256),d[1]=h%256,h=Math.floor(h/256),d[0]=h,d}getPixels(){return new LF({width:this.stride,height:this.stride},this.pixels)}backfillBorder(a,l,d){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let p=l*this.dim,h=l*this.dim+this.dim,_=d*this.dim,x=d*this.dim+this.dim;switch(l){case-1:p=h-1;break;case 1:h=p+1}switch(d){case-1:_=x-1;break;case 1:x=_+1}let C=-l*this.dim,M=-d*this.dim;for(let v=_;v<x;v++)for(let S=p;S<h;S++){let A=4*this._idx(S,v),D=4*this._idx(S+C,v+M);this.pixels[A+0]=a.pixels[D+0],this.pixels[A+1]=a.pixels[D+1],this.pixels[A+2]=a.pixels[D+2],this.pixels[A+3]=a.pixels[D+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function uJ(u,a,l){u===1?a.headerLength=l.readFixed32():u===2?a.x=l.readVarint():u===3?a.y=l.readVarint():u===4?a.z=l.readVarint():u===5&&a.layers.push(function(d,p){return d.readFields(mJ,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},p)}(l,l.readVarint()+l.pos))}function dJ(u,a,l){u===1?(a.delta_filter=function(d,p){return d.readFields(hJ,{blockSize:0},p)}(l,l.readVarint()+l.pos),a.filter="delta_filter"):u===2?(l.readVarint(),a.filter="zigzag_filter"):u===3?(l.readVarint(),a.filter="bitshuffle_filter"):u===4&&(l.readVarint(),a.filter="byteshuffle_filter")}function hJ(u,a,l){u===1&&(a.blockSize=l.readVarint())}function pJ(u,a,l){u===1?(l.readVarint(),a.codec="gzip_data"):u===2?(l.readVarint(),a.codec="jpeg_image"):u===3?(l.readVarint(),a.codec="webp_image"):u===4&&(l.readVarint(),a.codec="png_image")}function fJ(u,a,l){let d=0,p=0;u===1?a.firstByte=l.readFixed64():u===2?a.lastByte=l.readFixed64():u===3?a.filters.push(function(h,_){return h.readFields(dJ,{},_)}(l,l.readVarint()+l.pos)):u===4?a.codec=function(h,_){return h.readFields(pJ,{},_)}(l,l.readVarint()+l.pos):u===5?p=l.readFloat():u===6?d=l.readFloat():u===7?a.bands.push(l.readString()):u===8?a.offset=l.readDouble():u===9&&(a.scale=l.readDouble()),a.offset===0&&(a.offset=p),a.scale===0&&(a.scale=d)}function mJ(u,a,l){u===1?a.version=l.readVarint():u===2?a.name=l.readString():u===3?a.units=l.readString():u===4?a.tileSize=l.readVarint():u===5?a.buffer=l.readVarint():u===6?a.pixelFormat=l.readVarint():u===7&&a.dataIndex.push(function(d,p){return d.readFields(fJ,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},p)}(l,l.readVarint()+l.pos))}function gJ(u,a,l){if(u===2)(function(d,p,h){d.readFields(_J,h,p)})(l,l.readVarint()+l.pos,a);else if(u===3)throw new Error("Not implemented")}function _J(u,a,l){if(u===1){let d=0,p=l.readVarint()+l.pos;for(;l.pos<p;)a[d++]=l.readVarint()}}function yJ(u,a){if(a.length!==4)throw new Error(`Expected data of dimension 4 but got ${a.length}.`);let l=a[3];for(let d=2;d>=1;d--){let p=d===1?1:0,h=d===2?1:0;for(let _=0;_<a[0];_++){let x=a[1]*_;for(let C=p;C<a[1];C++){let M=a[2]*(C+x);for(let v=h;v<a[2];v++){let S=a[3]*(v+M);for(let A=0;A<a[3];A++){let D=S+A;u[D]+=u[D-l]}}}}l*=a[d]}return u}function vJ(u){for(let a=0,l=u.length;a<l;a++)u[a]=u[a]>>>1^-(1&u[a]);return u}function bJ(u,a){switch(a){case"uint32":return u;case"uint16":for(let l=0;l<u.length;l+=2){let d=u[l],p=u[l+1];u[l]=(240&d)>>4|(61440&d)>>8|(240&p)<<4|61440&p,u[l+1]=15&d|(3840&d)>>4|(15&p)<<8|(3840&p)<<4}return u;case"uint8":for(let l=0;l<u.length;l+=4){let d=u[l],p=u[l+1],h=u[l+2],_=u[l+3];u[l+0]=(192&d)>>6|(192&p)>>4|(192&h)>>2|192&_,u[l+1]=(48&d)>>4|(48&p)>>2|48&h|(48&_)<<2,u[l+2]=(12&d)>>2|12&p|(12&h)<<2|(12&_)<<4,u[l+3]=3&d|(3&p)<<2|(3&h)<<4|(3&_)<<6}return u;default:throw new Error(`Invalid pixel format, "${a}"`)}}ii(IC,"DEMData"),ii(T8,"DemMinMaxQuadTree",{omit:["dem"]});var Kc=Uint8Array,p1=Uint16Array,xJ=Int32Array,M8=new Kc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),I8=new Kc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),wJ=new Kc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),A8=function(u,a){for(var l=new p1(31),d=0;d<31;++d)l[d]=a+=1<<u[d-1];var p=new xJ(l[30]);for(d=1;d<30;++d)for(var h=l[d];h<l[d+1];++h)p[h]=h-l[d]<<5|d;return{b:l,r:p}},R8=A8(M8,2),k8=R8.b,EJ=R8.r;k8[28]=258,EJ[258]=28;for(var CJ=A8(I8,0).b,O8=new p1(32768),qo=0;qo<32768;++qo){var G_=(43690&qo)>>1|(21845&qo)<<1;O8[qo]=((65280&(G_=(61680&(G_=(52428&G_)>>2|(13107&G_)<<2))>>4|(3855&G_)<<4))>>8|(255&G_)<<8)>>1}var f1=function(u,a,l){for(var d=u.length,p=0,h=new p1(a);p<d;++p)u[p]&&++h[u[p]-1];var _,x=new p1(a);for(p=1;p<a;++p)x[p]=x[p-1]+h[p-1]<<1;_=new p1(1<<a);var C=15-a;for(p=0;p<d;++p)if(u[p])for(var M=p<<4|u[p],v=a-u[p],S=x[u[p]-1]++<<v,A=S|(1<<v)-1;S<=A;++S)_[O8[S]>>C]=M;return _},m1=new Kc(288);for(qo=0;qo<144;++qo)m1[qo]=8;for(qo=144;qo<256;++qo)m1[qo]=9;for(qo=256;qo<280;++qo)m1[qo]=7;for(qo=280;qo<288;++qo)m1[qo]=8;var P8=new Kc(32);for(qo=0;qo<32;++qo)P8[qo]=5;var SJ=f1(m1,9),TJ=f1(P8,5),UA=function(u){for(var a=u[0],l=1;l<u.length;++l)u[l]>a&&(a=u[l]);return a},xd=function(u,a,l){var d=a/8|0;return(u[d]|u[d+1]<<8)>>(7&a)&l},HA=function(u,a){var l=a/8|0;return(u[l]|u[l+1]<<8|u[l+2]<<16)>>(7&a)},DJ=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],wd=function(u,a,l){var d=new Error(a||DJ[u]);if(d.code=u,Error.captureStackTrace&&Error.captureStackTrace(d,wd),!l)throw d;return d},MJ=new Kc(0),IJ=typeof TextDecoder<"u"&&new TextDecoder;try{IJ.decode(MJ,{stream:!0})}catch{}let AJ={gzip_data:"gzip"};class Mu extends Error{constructor(a){super(a),this.name="MRTError"}}let RJ={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},N8={uint32:1,uint16:2,uint8:4},kJ={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array},qA;class AC{constructor(a=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=a}getLayer(a){let l=this.layers[a];if(!l)throw new Mu(`Layer '${a}' not found`);return l}getHeaderLength(a){let l=new Uint8Array(a),d=new DataView(a);if(l[0]!==13)throw new Mu("File is not a valid MRT.");return d.getUint32(1,!0)}parseHeader(a){let l=new Uint8Array(a),d=this.getHeaderLength(a);if(l.length<d)throw new Mu(`Expected header with length >= ${d} but got buffer of length ${l.length}`);let p=function(h,_){return h.readFields(uJ,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new qA(l.subarray(0,d)));if(!isNaN(this.x)&&(this.x!==p.x||this.y!==p.y||this.z!==p.z))throw new Mu(`Invalid attempt to parse header ${p.z}/${p.x}/${p.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=p.x,this.y=p.y,this.z=p.z;for(let h of p.layers)this.layers[h.name]=new L8(h,{cacheSize:this._cacheSize});return this}createDecodingTask(a){let l=[],d=this.getLayer(a.layerName);for(let p of a.blockIndices){let h=d.dataIndex[p],_=h.firstByte-a.firstByte,x=h.lastByte-a.firstByte;if(d._blocksInProgress.has(p))continue;let C={layerName:d.name,firstByte:_,lastByte:x,pixelFormat:d.pixelFormat,blockIndex:p,blockShape:[h.bands.length].concat(d.bandShape),buffer:d.buffer,codec:h.codec.codec,filters:h.filters.map(M=>M.filter)};d._blocksInProgress.add(p),l.push(C)}return new F8(l,()=>{l.forEach(p=>d._blocksInProgress.delete(p.blockIndex))},(p,h)=>{if(l.forEach(_=>d._blocksInProgress.delete(_.blockIndex)),p)throw p;h.forEach(_=>{this.getLayer(_.layerName).processDecodedData(_)})})}}class L8{constructor({version:a,name:l,units:d,tileSize:p,pixelFormat:h,buffer:_,dataIndex:x},C){if(this.version=a,this.version!==1)throw new Mu(`Cannot parse raster layer encoded with MRT version ${a}`);this.name=l,this.units=d,this.tileSize=p,this.buffer=_,this.pixelFormat=RJ[h],this.dataIndex=x,this.bandShape=[p+2*_,p+2*_,N8[this.pixelFormat]],this._decodedBlocks=new MC(C?C.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return N8[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:a})=>a).flat()}processDecodedData(a){let l=a.blockIndex.toString();this._decodedBlocks.get(l)||this._decodedBlocks.put(l,a.data)}getBlockForBand(a){let l=0;switch(typeof a){case"string":for(let[d,p]of this.dataIndex.entries()){for(let[h,_]of p.bands.entries())if(_===a)return{bandIndex:l+h,blockIndex:d,blockBandIndex:h};l+=p.bands.length}break;case"number":for(let[d,p]of this.dataIndex.entries()){if(a>=l&&a<l+p.bands.length)return{bandIndex:a,blockIndex:d,blockBandIndex:a-l};l+=p.bands.length}break;default:throw new Mu(`Invalid band \`${JSON.stringify(a)}\`. Expected string or integer.`)}throw new Mu(`Band not found: ${JSON.stringify(a)}`)}getDataRange(a){let l=1/0,d=-1/0,p=[],h=new Set;for(let _ of a){let{blockIndex:x}=this.getBlockForBand(_);if(x<0)throw new Mu(`Invalid band: ${JSON.stringify(_)}`);let C=this.dataIndex[x];p.includes(x)||p.push(x),h.add(x),l=Math.min(l,C.firstByte),d=Math.max(d,C.lastByte)}if(h.size>this.cacheSize)throw new Mu(`Number of blocks to decode (${h.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:l,lastByte:d,blockIndices:p}}hasBand(a){let{blockIndex:l}=this.getBlockForBand(a);return l>=0}hasDataForBand(a){let{blockIndex:l}=this.getBlockForBand(a);return l>=0&&!!this._decodedBlocks.get(l.toString())}getBandView(a){let{blockIndex:l,blockBandIndex:d}=this.getBlockForBand(a),p=this._decodedBlocks.get(l.toString());if(!p)throw new Mu(`Data for band ${JSON.stringify(a)} of layer "${this.name}" not decoded.`);let h=this.dataIndex[l],_=this.bandShape.reduce((M,v)=>M*v,1),x=d*_,C=p.subarray(x,x+_);return{data:C,bytes:new Uint8Array(C.buffer).subarray(C.byteOffset,C.byteOffset+C.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:h.offset,scale:h.scale}}}AC.setPbf=function(u){qA=u};class F8{constructor(a,l,d){this.tasks=a,this._onCancel=l,this._onComplete=d,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(a,l){this._finalized||(this._onComplete(a,l),this._finalized=!0)}}AC.performDecoding=function(u,a){let l=new Uint8Array(u);return Promise.all(a.tasks.map(d=>{let{layerName:p,firstByte:h,lastByte:_,pixelFormat:x,blockShape:C,blockIndex:M,filters:v,codec:S}=d,A=l.subarray(h,_+1),D=new Uint32Array(C[0]*C[1]*C[2]),I;if(S!=="gzip_data")throw new Mu(`Unhandled codec: ${S}`);return I=function(O,z){if(!globalThis.DecompressionStream&&z==="gzip_data")return Promise.resolve(((H=function(ne){ne[0]==31&&ne[1]==139&&ne[2]==8||wd(6,"invalid gzip data");var ve=ne[3],pe=10;4&ve&&(pe+=2+(ne[10]|ne[11]<<8));for(var fe=(ve>>3&1)+(ve>>4&1);fe>0;fe-=!ne[pe++]);return pe+(2&ve)}($=O))+8>$.length&&wd(6,"invalid gzip data"),function(ne,ve,pe,fe){var Fe=ne.length;if(!Fe||ve.f&&!ve.l)return pe||new Kc(0);var be=!pe,Be=be||ve.i!=2,$e=ve.i;be&&(pe=new Kc(3*Fe));var Ue,Ye,Ze=function(Lf){var Ff=pe.length;if(Lf>Ff){var Sg=new Kc(Math.max(2*Ff,Lf));Sg.set(pe),pe=Sg}},rt=ve.f||0,Je=ve.p||0,ot=ve.b||0,kt=ve.l,Mt=ve.d,ni=ve.m,Vt=ve.n,qt=8*Fe;do{if(!kt){rt=xd(ne,Je,1);var Lt=xd(ne,Je+1,3);if(Je+=3,!Lt){var Ri=ne[(Wi=4+((Je+7)/8|0))-4]|ne[Wi-3]<<8,Jt=Wi+Ri;if(Jt>Fe){$e&&wd(0);break}Be&&Ze(ot+Ri),pe.set(ne.subarray(Wi,Jt),ot),ve.b=ot+=Ri,ve.p=Je=8*Jt,ve.f=rt;continue}if(Lt==1)kt=SJ,Mt=TJ,ni=9,Vt=5;else if(Lt==2){var mi=xd(ne,Je,31)+257,Hi=xd(ne,Je+10,15)+4,mn=mi+xd(ne,Je+5,31)+1;Je+=14;for(var Xi=new Kc(mn),bn=new Kc(19),fn=0;fn<Hi;++fn)bn[wJ[fn]]=xd(ne,Je+3*fn,7);Je+=3*Hi;var Dn=UA(bn),Kn=(1<<Dn)-1,Rr=f1(bn,Dn);for(fn=0;fn<mn;){var Wi,Nn=Rr[xd(ne,Je,Kn)];if(Je+=15&Nn,(Wi=Nn>>4)<16)Xi[fn++]=Wi;else{var Hr=0,Xr=0;for(Wi==16?(Xr=3+xd(ne,Je,3),Je+=2,Hr=Xi[fn-1]):Wi==17?(Xr=3+xd(ne,Je,7),Je+=3):Wi==18&&(Xr=11+xd(ne,Je,127),Je+=7);Xr--;)Xi[fn++]=Hr}}var ro=Xi.subarray(0,mi),uo=Xi.subarray(mi);ni=UA(ro),Vt=UA(uo),kt=f1(ro,ni),Mt=f1(uo,Vt)}else wd(1);if(Je>qt){$e&&wd(0);break}}Be&&Ze(ot+131072);for(var Dr=(1<<ni)-1,fa=(1<<Vt)-1,Zs=Je;;Zs=Je){var Fo=(Hr=kt[HA(ne,Je)&Dr])>>4;if((Je+=15&Hr)>qt){$e&&wd(0);break}if(Hr||wd(2),Fo<256)pe[ot++]=Fo;else{if(Fo==256){Zs=Je,kt=null;break}var $o=Fo-254;Fo>264&&($o=xd(ne,Je,(1<<(Xc=M8[fn=Fo-257]))-1)+k8[fn],Je+=Xc);var hs=Mt[HA(ne,Je)&fa],Pa=hs>>4;if(hs||wd(3),Je+=15&hs,uo=CJ[Pa],Pa>3){var Xc=I8[Pa];uo+=HA(ne,Je)&(1<<Xc)-1,Je+=Xc}if(Je>qt){$e&&wd(0);break}Be&&Ze(ot+131072);var Nf=ot+$o;if(ot<uo){var Iu=0-uo,Cd=Math.min(uo,Nf);for(Iu+ot<0&&wd(3);ot<Cd;++ot)pe[ot]=(void 0)[Iu+ot]}for(;ot<Nf;++ot)pe[ot]=pe[ot-uo]}}ve.l=kt,ve.p=Zs,ve.b=ot,ve.f=rt,kt&&(rt=1,ve.m=ni,ve.d=Mt,ve.n=Vt)}while(!rt);return ot!=pe.length&&be?(Ue=pe,((Ye=ot)==null||Ye>Ue.length)&&(Ye=Ue.length),new Kc(Ue.subarray(0,Ye))):pe.subarray(0,ot)}($.subarray(H,-8),{i:2},new Kc(((B=$)[(G=B.length)-4]|B[G-3]<<8|B[G-2]<<16|B[G-1]<<24)>>>0))));var B,G,$,H;let K=AJ[z];if(!K)throw new Error(`Unhandled codec: ${z}`);let ee=new globalThis.DecompressionStream(K);return new Response(new Blob([O]).stream().pipeThrough(ee)).arrayBuffer().then(ne=>new Uint8Array(ne))}(A,S).then(O=>(function(z,B){z.readFields(gJ,B)}(new qA(O),D),new kJ[x](D.buffer))),I.then(O=>{for(let z=v.length-1;z>=0;z--)switch(v[z]){case"delta_filter":yJ(O,C);break;case"zigzag_filter":vJ(O);break;case"bitshuffle_filter":bJ(O,x);break;default:throw new Mu(`Unhandled filter "${v[z]}"`)}return{layerName:p,blockIndex:M,data:O}}).catch(O=>{throw O})}))},ii(F8,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),ii(AC,"MapboxRasterTile"),ii(L8,"MapboxRasterLayer",{omit:["_blocksInProgress"]});let g1,$A,Ed,W_,GA,Z_=null;function z8(){return Pi()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:$A||Y.DRACO_URL}function B8(){if(Pi()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(W_)return W_;let u=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return W_=WebAssembly.validate(u)?Y.MESHOPT_SIMD_URL:Y.MESHOPT_URL,W_}let RC={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},OJ={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},_1={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function V8(u,a,l){let d=l.json.bufferViews.length,p=l.buffers.length;a.bufferView=d,l.json.bufferViews[d]={buffer:p,byteLength:u.byteLength},l.buffers[p]=u}let WA="KHR_draco_mesh_compression";function PJ(u,a){let l=u.extensions&&u.extensions[WA];if(!l)return;let d=new Ed.Decoder,p=q8(a,l.bufferView),h=new Ed.Mesh;if(!d.DecodeArrayToMesh(p,p.byteLength,h))throw new Error("Failed to decode Draco mesh");let _=a.json.accessors[u.indices],x=RC[_.componentType],C=_.count*x.BYTES_PER_ELEMENT,M=Ed._malloc(C);x===Uint16Array?d.GetTrianglesUInt16Array(h,C,M):d.GetTrianglesUInt32Array(h,C,M),V8(Ed.memory.buffer.slice(M,M+C),_,a),Ed._free(M);for(let v of Object.keys(l.attributes)){let S=d.GetAttributeByUniqueId(h,l.attributes[v]),A=a.json.accessors[u.attributes[v]],D=OJ[A.componentType],I=A.count*_1[A.type]*RC[A.componentType].BYTES_PER_ELEMENT,O=Ed._malloc(I);d.GetAttributeDataArrayForAllPoints(h,S,Ed[D],I,O),V8(Ed.memory.buffer.slice(O,O+I),A,a),Ed._free(O)}d.destroy(),h.destroy(),delete u.extensions[WA]}let kC="EXT_meshopt_compression";function NJ(u,a){if(!u.extensions||!u.extensions[kC])return;let l=u.extensions[kC],d=new Uint8Array(a.buffers[l.buffer],l.byteOffset||0,l.byteLength||0),p=new Uint8Array(l.count*l.byteStride);GA.decodeGltfBuffer(p,l.count,l.byteStride,d,l.mode,l.filter),u.buffer=a.buffers.length,u.byteOffset=0,a.buffers[u.buffer]=p.buffer,delete u.extensions[kC]}let j8=1179937895,U8=new TextDecoder("utf8");function H8(u,a){return new URL(u,a).href}function LJ(u,a,l,d){return fetch(H8(u.uri,d)).then(p=>p.arrayBuffer()).then(p=>{a.buffers[l]=p})}function q8(u,a){let l=u.json.bufferViews[a];return new Uint8Array(u.buffers[l.buffer],l.byteOffset||0,l.byteLength)}function FJ(u,a,l,d){if(u.uri){let p=H8(u.uri,d);return fetch(p).then(h=>h.blob()).then(h=>createImageBitmap(h)).then(h=>{a.images[l]=h})}if(u.bufferView!==void 0){let p=q8(a,u.bufferView),h=new Blob([p],{type:u.mimeType});return createImageBitmap(h).then(_=>{a.images[l]=_})}}function $8(u,a=0,l){let d={json:null,images:[],buffers:[]};if(new Uint32Array(u,a,1)[0]===j8){let v=new Uint32Array(u,a),S=2,A=(v[S++]>>2)-3,D=v[S++]>>2;if(S++,d.json=JSON.parse(U8.decode(v.subarray(S,S+D))),S+=D,S<A){let I=v[S++];S++;let O=a+(S<<2);d.buffers[0]=u.slice(O,O+I)}}else d.json=JSON.parse(U8.decode(new Uint8Array(u,a)));let{buffers:p,images:h,meshes:_,extensionsUsed:x,bufferViews:C}=d.json,M=Promise.resolve();if(p){let v=[];for(let S=0;S<p.length;S++){let A=p[S];A.uri?v.push(LJ(A,d,S,l)):d.buffers[S]||(d.buffers[S]=null)}M=Promise.all(v)}return M.then(()=>{let v=[],S=x&&x.includes(WA),A=x&&x.includes(kC);if(S&&v.push(function(){if(!Ed)return g1??(g1=function(D){let I,O=null;function z(){I=new Uint8Array(O.buffer)}function B(){throw new Error("Unexpected Draco error.")}let G={a:{a:B,d:function($,H,K){return I.copyWithin($,H,H+K)},c:function($){let H=I.length,K=Math.max($>>>0,Math.ceil(1.2*H)),ee=Math.ceil((K-H)/65536);try{return O.grow(ee),z(),!0}catch{return!1}},b:B}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(D,G):D.then($=>$.arrayBuffer()).then($=>WebAssembly.instantiate($,G))).then($=>{let{Rb:H,Qb:K,P:ee,T:ne,X:ve,Ja:pe,La:fe,Qa:Fe,Va:be,Wa:Be,eb:$e,jb:Ue,f:Ye,e:Ze,yb:rt,zb:Je,Ab:ot,Bb:kt,Db:Mt,Gb:ni}=$.instance.exports;O=Ze;let Vt=(()=>{let qt=0,Lt=0,Ri=0,Jt=0;return mi=>{Ri&&(H(Jt),H(qt),Lt+=Ri,Ri=qt=0),qt||(Lt+=128,qt=K(Lt));let Hi=mi.length+7&-8,mn=qt;Hi>=Lt&&(Ri=Hi,mn=Jt=K(Hi));for(let Xi=0;Xi<mi.length;Xi++)I[mn+Xi]=mi[Xi];return mn}})();return z(),Ye(),{memory:Ze,_free:H,_malloc:K,Mesh:class{constructor(){this.ptr=ee()}destroy(){ne(this.ptr)}},Decoder:class{constructor(){this.ptr=pe()}destroy(){Ue(this.ptr)}DecodeArrayToMesh(qt,Lt,Ri){let Jt=Vt(qt),mi=fe(this.ptr,Jt,Lt,Ri.ptr);return!!ve(mi)}GetAttributeByUniqueId(qt,Lt){return{ptr:Fe(this.ptr,qt.ptr,Lt)}}GetTrianglesUInt16Array(qt,Lt,Ri){be(this.ptr,qt.ptr,Lt,Ri)}GetTrianglesUInt32Array(qt,Lt,Ri){Be(this.ptr,qt.ptr,Lt,Ri)}GetAttributeDataArrayForAllPoints(qt,Lt,Ri,Jt,mi){$e(this.ptr,qt.ptr,Lt.ptr,Ri,Jt,mi)}},DT_INT8:rt(),DT_UINT8:Je(),DT_INT16:ot(),DT_UINT16:kt(),DT_UINT32:Mt(),DT_FLOAT32:ni()}})}(fetch(z8())),g1.then(D=>{Ed=D,g1=void 0}))}()),A&&v.push(function(){if(GA)return;let D=function(I){let O,z=WebAssembly.instantiateStreaming(I,{}).then($=>{O=$.instance,O.exports.__wasm_call_ctors()}),B={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},G={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:z,supported:!0,decodeGltfBuffer($,H,K,ee,ne,ve){(function(pe,fe,Fe,be,Be,$e,Ue){let Ye=pe.exports.sbrk,Ze=be+3&-4,rt=Ye(Ze*Be),Je=Ye($e.length),ot=new Uint8Array(pe.exports.memory.buffer);ot.set($e,Je);let kt=fe(rt,be,Be,Je,$e.length);if(kt===0&&Ue&&Ue(rt,Ze,Be),Fe.set(ot.subarray(rt,rt+be*Be)),Ye(rt-Ye(0)),kt!==0)throw new Error(`Malformed buffer data: ${kt}`)})(O,O.exports[G[ne]],$,H,K,ee,O.exports[B[ve]])}}}(fetch(B8()));return D.ready.then(()=>{GA=D})}()),h)for(let D=0;D<h.length;D++)v.push(FJ(h[D],d,D,l));return(v.length?Promise.all(v):Promise.resolve()).then(()=>{if(S&&_)for(let{primitives:D}of _)for(let I of D)PJ(I,d);if(A&&_&&C)for(let D of C)NJ(D,d);return d})})}function Cg(u,a){let l=u.json.bufferViews[a.bufferView],d=RC[a.componentType];return new d(u.buffers[l.buffer],(a.byteOffset||0)+(l.byteOffset||0),a.count*(l.byteStride&&l.byteStride!==_1[a.type]*d.BYTES_PER_ELEMENT?l.byteStride/d.BYTES_PER_ELEMENT:_1[a.type]))}function ZA(u,a,l,d){let p=RC[a.componentType],h=function(v){switch(v){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(p),_=u.json.bufferViews[a.bufferView],x=_.byteStride?_.byteStride/p.BYTES_PER_ELEMENT:_1[a.type],C=l.float32,M=C.length/l.capacity;for(let v=0,S=0;v<a.count*x;v+=x,S+=M)for(let A=0;A<M;A++)C[S+A]=d[v+A]*h;l._trim()}function zJ(u,a,l){let d=u.indices,p=u.attributes,h={};h.indexArray=new Ra;let _=a.json.accessors[d],x=_.count/3;h.indexArray.reserve(x);let C=Cg(a,_);for(let A=0;A<x;A++)h.indexArray.emplaceBack(C[3*A],C[3*A+1],C[3*A+2]);h.indexArray._trim(),h.vertexArray=new Zc;let M=a.json.accessors[p.POSITION];h.vertexArray.reserve(M.count);let v=Cg(a,M);for(let A=0;A<M.count;A++)h.vertexArray.emplaceBack(v[3*A],v[3*A+1],v[3*A+2]);if(h.vertexArray._trim(),h.aabb=new yi(M.min,M.max),h.centroid=function(A,D){let I=[0,0,0],O=A.length;if(O>0){for(let z=0;z<O;z++){let B=3*A[z];I[0]+=D[B],I[1]+=D[B+1],I[2]+=D[B+2]}I[0]/=O,I[1]/=O,I[2]/=O}return I}(C,v),p.COLOR_0!==void 0){let A=a.json.accessors[p.COLOR_0],D=_1[A.type],I=Cg(a,A);h.colorArray=D===3?new Zc:new up,h.colorArray.resize(A.count),ZA(a,A,h.colorArray,I)}if(p.NORMAL!==void 0){h.normalArray=new Zc;let A=a.json.accessors[p.NORMAL];h.normalArray.resize(A.count);let D=Cg(a,A);ZA(a,A,h.normalArray,D)}if(p.TEXCOORD_0!==void 0&&l.length>0){h.texcoordArray=new xf;let A=a.json.accessors[p.TEXCOORD_0];h.texcoordArray.resize(A.count);let D=Cg(a,A);ZA(a,A,h.texcoordArray,D)}if(p._FEATURE_ID_RGBA4444!==void 0){let A=a.json.accessors[p._FEATURE_ID_RGBA4444];a.json.extensionsUsed&&a.json.extensionsUsed.includes("EXT_meshopt_compression")&&(h.featureData=Cg(a,A))}p._FEATURE_RGBA4444!==void 0&&(h.featureData=new Uint32Array(Cg(a,a.json.accessors[p._FEATURE_RGBA4444]).buffer));let S=u.material;return h.material=function(A,D){let{emissiveFactor:I=[0,0,0],alphaMode:O="OPAQUE",alphaCutoff:z=.5,normalTexture:B,occlusionTexture:G,emissiveTexture:$,doubleSided:H}=A,{baseColorFactor:K=[1,1,1,1],metallicFactor:ee=1,roughnessFactor:ne=1,baseColorTexture:ve,metallicRoughnessTexture:pe}=A.pbrMetallicRoughness||{},fe=G?D[G.index]:void 0;if(G&&G.extensions&&G.extensions.KHR_texture_transform&&fe){let Fe=G.extensions.KHR_texture_transform;fe.offsetScale=[Fe.offset[0],Fe.offset[1],Fe.scale[0],Fe.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Ui(...K),metallicFactor:ee,roughnessFactor:ne,baseColorTexture:ve?D[ve.index]:void 0,metallicRoughnessTexture:pe?D[pe.index]:void 0},doubleSided:H,emissiveFactor:I,alphaMode:O,alphaCutoff:z,normalTexture:B?D[B.index]:void 0,occlusionTexture:fe,emissionTexture:$?D[$.index]:void 0,defined:A.defined===void 0}}(S!==void 0?a.json.materials[S]:{defined:!1},l),h}function G8(u,a,l){let{matrix:d,rotation:p,translation:h,scale:_,mesh:x,extras:C,children:M}=u,v={};if(v.matrix=d||ge.mat4.fromRotationTranslationScale([],p||[0,0,0,1],h||[0,0,0],_||[1,1,1]),x!==void 0){v.meshes=l[x];let S=v.anchor=[0,0];for(let A of v.meshes){let{min:D,max:I}=A.aabb;S[0]+=D[0]+I[0],S[1]+=D[1]+I[1]}S[0]=Math.floor(S[0]/v.meshes.length/2),S[1]=Math.floor(S[1]/v.meshes.length/2)}if(C&&(C.id&&(v.id=C.id),C.lights&&(v.lights=function(S){if(!S.length)return[];let A=function(B){let G=atob(B),$=new Uint8Array(G.length);for(let H=0;H<G.length;H++)$[H]=G.codePointAt(H);return $}(S),D=[],I=A.length/24,O=new Uint16Array(A.buffer),z=new Float32Array(A.buffer);for(let B=0;B<I;B++){let G=O[2*B*6]/30,$=O[2*B*6+1]/30,H=O[2*B*6+10]/100,K=z[6*B+1],ee=z[6*B+2],ne=z[6*B+3],ve=z[6*B+4],pe=ne-K,fe=ve-ee,Fe=Math.hypot(pe,fe);D.push({pos:[K+.5*pe,ee+.5*fe,$],normal:[fe/Fe,-pe/Fe,0],width:Fe,height:G,depth:H,points:[K,ee,ne,ve]})}return D}(C.lights))),M){let S=[];for(let A of M)S.push(G8(a.json.nodes[A],a,l));v.children=S}return v}function BJ(u){if(u.vertices.length===0||u.indices.length===0)return null;let a=new tA(u.vertices,u.indices,8,256),[l,d]=[a.min.clone(),a.max.clone()];return{vertices:u.vertices,indices:u.indices,grid:a,min:l,max:d}}function VJ(u){if(!u.extras||!u.extras.ground)return null;let a=u.extras.ground;if(!a||!Array.isArray(a)||a.length===0)return null;let l=a[0];if(!l||!Array.isArray(l)||l.length===0)return null;let d=[];for(let _ of l){if(!Array.isArray(_)||_.length!==2)continue;let x=_[0],C=_[1];typeof x=="number"&&typeof C=="number"&&d.push(new Wt(x,C))}if(d.length<3)return null;d.length>1&&d[d.length-1].equals(d[0])&&d.pop();let p=0;for(let _=0;_<d.length;_++){let x=d[_],C=d[(_+1)%d.length],M=d[(_+2)%d.length];p+=(x.x-C.x)*(M.y-C.y)-(M.x-C.x)*(x.y-C.y)}p>0&&d.reverse();let h=Ub(d.flatMap(_=>[_.x,_.y]),[]);return h.length===0?null:{vertices:d,indices:h}}function jJ(u,a){let l=[],d=[],p=0,h=[];for(let _ of u){p=l.length;let x=_.vertexArray.float32,C=_.indexArray.uint16;for(let M=0;M<_.vertexArray.length;M++)h[0]=x[3*M+0],h[1]=x[3*M+1],h[2]=x[3*M+2],ge.vec3.transformMat4(h,h,a),l.push(new Wt(h[0],h[1]));for(let M=0;M<3*_.indexArray.length;M++)d.push(C[M]+p)}if(d.length%3!=0)return null;for(let _=0;_<d.length;_+=3){let x=l[d[_+0]],C=l[d[_+1]],M=l[d[_+2]];(x.x-C.x)*(M.y-C.y)-(M.x-C.x)*(x.y-C.y)>0&&([d[_+1],d[_+2]]=[d[_+2],d[_+1]])}return{vertices:l,indices:d}}function W8(u){let a=function(C,M){let v=[],S=WebGL2RenderingContext;if(C.json.textures)for(let A of C.json.textures){let D={magFilter:S.LINEAR,minFilter:S.NEAREST,wrapS:S.REPEAT,wrapT:S.REPEAT};A.sampler!==void 0&&Object.assign(D,C.json.samplers[A.sampler]),v.push({image:M[A.source],sampler:D,uploaded:!1})}return v}(u,u.images),l=function(C,M){let v=[];for(let S of C.json.meshes){let A=[];for(let D of S.primitives)A.push(zJ(D,C,M));v.push(A)}return v}(u,a),{scenes:d,scene:p,nodes:h}=u.json,_=d?d[p||0].nodes:h,x=[];for(let C of _)x.push(G8(h[C],u,l));return function(C,M,v){let S={},A=new Set;for(let D=0;D<C.length;D++){let I=v[M[D]];if(!I.extras)continue;let O=I.extras["mapbox:footprint:version"],z=I.extras["mapbox:footprint:id"];(O||z)&&A.add(D),O==="1.0.0"&&z&&(S[z]=D)}for(let D=0;D<C.length;D++){if(A.has(D))continue;let I=C[D],O=v[M[D]];if(!O.extras)continue;let z=null;I.id in S&&(z=jJ(C[S[I.id]].meshes,I.matrix)),z||(z=VJ(O)),z&&(I.footprint=BJ(z))}if(A.size>0){let D=Array.from(A.values()).sort((I,O)=>I-O);for(let I=D.length-1;I>=0;I--)C.splice(D[I],1)}}(x,_,u.json.nodes),x}function UJ(u){u.heightmap=new Float32Array(4096),u.heightmap.fill(-1);let a=u.vertexArray.float32,l=u.aabb.min[0]-1,d=u.aabb.min[1]-1,p=wg/(u.aabb.max[0]-l+2),h=wg/(u.aabb.max[1]-d+2);for(let _=0;_<a.length;_+=3){let x=a[_+2],C=(a[_+0]-l)*p|0,M=(a[_+1]-d)*h|0;x>u.heightmap[M*wg+C]&&(u.heightmap[M*wg+C]=x)}}function HJ(u,a){let l={};l.indexArray=new Ra,l.indexArray.reserve(4*u.length),l.vertexArray=new Zc,l.vertexArray.reserve(10*u.length),l.colorArray=new up,l.vertexArray.reserve(10*u.length);let d=0;for(let _ of u){let x=Math.min(10,Math.max(4,1.3*_.height))*a,C=[-_.normal[1],_.normal[0],0],M=Math.min(.29,.1*_.width/_.depth),v=_.width-2*_.depth*a*(M+.01),S=ge.vec3.scaleAndAdd([],_.pos,C,v/2),A=ge.vec3.scaleAndAdd([],_.pos,C,-v/2),D=[S[0],S[1],S[2]+_.height],I=[A[0],A[1],A[2]+_.height],O=ge.vec3.scaleAndAdd([],_.normal,C,M);ge.vec3.scale(O,O,x);let z=ge.vec3.scaleAndAdd([],_.normal,C,-M);ge.vec3.scale(z,z,x),ge.vec3.add(O,S,O),ge.vec3.add(z,A,z),S[2]+=.1,A[2]+=.1,l.vertexArray.emplaceBack(O[0],O[1],O[2]),l.vertexArray.emplaceBack(z[0],z[1],z[2]),l.vertexArray.emplaceBack(S[0],S[1],S[2]),l.vertexArray.emplaceBack(A[0],A[1],A[2]),l.vertexArray.emplaceBack(D[0],D[1],D[2]),l.vertexArray.emplaceBack(I[0],I[1],I[2]),l.vertexArray.emplaceBack(S[0],S[1],S[2]),l.vertexArray.emplaceBack(A[0],A[1],A[2]),l.vertexArray.emplaceBack(O[0],O[1],O[2]),l.vertexArray.emplaceBack(z[0],z[1],z[2]);let B=v/x/2;l.colorArray.emplaceBack(-B-M,-1,B,.8),l.colorArray.emplaceBack(B+M,-1,B,.8),l.colorArray.emplaceBack(-B,0,B,1.3),l.colorArray.emplaceBack(B,0,B,1.3),l.colorArray.emplaceBack(B+M,-.8,B,.7),l.colorArray.emplaceBack(B+M,-.8,B,.7),l.colorArray.emplaceBack(0,0,B,1.3),l.colorArray.emplaceBack(0,0,B,1.3),l.colorArray.emplaceBack(B+M,-1.2,B,.8),l.colorArray.emplaceBack(B+M,-1.2,B,.8),l.indexArray.emplaceBack(6+d,4+d,8+d),l.indexArray.emplaceBack(7+d,9+d,5+d),l.indexArray.emplaceBack(0+d,1+d,2+d),l.indexArray.emplaceBack(1+d,3+d,2+d),d+=10}let p={defined:!0,emissiveFactor:[0,0,0]},h={};return h.baseColorFactor=Ui.white,p.pbrMetallicRoughness=h,l.material=p,l.aabb=new yi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),l}class Z8{constructor(a){this._stringToNumber={},this._numberToString=[];for(let l=0;l<a.length;l++){let d=a[l];this._stringToNumber[d]=l,this._numberToString[l]=d}}encode(a){return this._stringToNumber[a]}decode(a){return this._numberToString[a]}}let qJ=["id","tile","layer","source","sourceLayer","state"];class Y_{constructor(a,l,d,p,h){this.type="Feature",this._vectorTileFeature=a,this._z=l,this._x=d,this._y=p,this.properties=a.properties,this.id=h}clone(){let a=new Y_(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(a.state=Object.assign({},this.state)),this.layer&&(a.layer=Object.assign({},this.layer)),this.source&&(a.source=this.source),this.sourceLayer&&(a.sourceLayer=this.sourceLayer),a}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){let a={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(let l of qJ)this[l]!==void 0&&(a[l]=this[l]);return a}}class Y8{constructor(a,l){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new df($t,16,0),this.featureIndexArray=new cl,this.promoteId=l,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(a,l,d,p,h,_=0,x=0){let C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,p,h,_);let M=this.grid;for(let v=0;v<l.length;v++){let S=l[v],A=[1/0,1/0,-1/0,-1/0];for(let D=0;D<S.length;D++){let I=S[D];A[0]=Math.min(A[0],I.x),A[1]=Math.min(A[1],I.y),A[2]=Math.max(A[2],I.x),A[3]=Math.max(A[3],I.y)}x!==0&&(A[0]-=x,A[1]-=x,A[2]+=x,A[3]+=x),A[0]<$t&&A[1]<$t&&A[2]>=0&&A[3]>=0&&M.insert(C,A[0],A[1],A[2],A[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Mf.VectorTile(new JE(this.rawTileData)).layers,this.sourceLayerCoder=new Z8(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(let a in this.vtLayers)this.vtFeatures[a]=[]}return this.vtLayers}query(a,l){let{tilespaceGeometry:d,transform:p,tileTransform:h,pixelPosMatrix:_,availableImages:x}=l;this.loadVTLayers(),this.serializedLayersCache.clear();let C=d.bufferedTilespaceBounds,M=this.grid.query(C.min.x,C.min.y,C.max.x,C.max.y,(D,I,O,z)=>Re(d.bufferedTilespaceGeometry,D,I,O,z));M.sort($J);let v=null;p.elevation&&M.length>0&&(v=U_.create(p.elevation,this.tileID));let S={},A;for(let D=0;D<M.length;D++){let I=M[D];if(I===A)continue;A=I;let O=this.featureIndexArray.get(I),z=null;this.is3DTile?this.loadMatchingModelFeature(S,O,a,d,p):this.loadMatchingFeature(S,O,a,x,(B,G,$,H=0)=>(z||(z=L(B,this.tileID.canonical,h)),G.queryIntersectsFeature(d,B,$,z,this.z,p,_,v,H)))}return S}loadMatchingFeature(a,l,d,p,h){let{featureIndex:_,bucketIndex:x,sourceLayerIndex:C,layoutVertexArrayOffset:M}=l,v=this.bucketLayerIDs[x],S=d.layers,A=Object.keys(S);if(A.length&&!function(B,G){for(let $=0;$<B.length;$++)if(G.indexOf(B[$])>=0)return!0;return!1}(A,v))return;let D=d.sourceCache,I=this.sourceLayerCoder.decode(C),O=this.vtLayers[I].feature(_),z=this.getId(O,I);for(let B=0;B<v.length;B++){let G=v[B];if(!S[G])continue;let{styleLayer:$,targets:H}=S[G],K={};z!==void 0&&(K=D.getFeatureState($.sourceLayer,z));let ee=!h||h(O,$,K,M);if(!ee)continue;let ne=new Y_(O,this.z,this.x,this.y,z);ne.tile=this.tileID.canonical,ne.state=K;let ve=this.serializedLayersCache.get(G);ve||(ve=$.serialize(),ve.id=G,this.serializedLayersCache.set(G,ve)),ne.source=ve.source,ne.sourceLayer=ve["source-layer"],ne.layer=Da({},ve),ne.layer.paint=K8(ve.paint,$.paint,O,K,p),ne.layer.layout=K8(ve.layout,$.layout,O,K,p);let pe=!1;for(let fe of H){this.updateFeatureProperties(ne,fe);let{filter:Fe}=fe;if(Fe){if(O.properties=ne.properties,Fe.needGeometry){let be=F(O,!0);if(!Fe.filter(new Ar(this.tileID.overscaledZ),be,this.tileID.canonical))continue}else if(!Fe.filter(new Ar(this.tileID.overscaledZ),O))continue}pe=!0,fe.targetId&&this.addFeatureVariant(ne,fe)}pe&&this.appendToResult(a,G,_,ne,ee)}}loadMatchingModelFeature(a,l,d,p,h){let _=this.bucketLayerIDs[0][0],x=d.layers;if(!x[_])return;let{styleLayer:C,targets:M}=x[_];if(C.type!=="model")return;let v=p.tile,S=l.featureIndex,A=v.getBucket(C);if(!(A&&A instanceof bC))return;let D=function(ve,pe,fe,Fe){let be=ve.getNodesInfo()[pe];if(be.hiddenByReplacement||!be.node.meshes)return;let Be=Number.MAX_VALUE,$e=be.node,Ue=fe.tile,Ye=Fe.calculatePosMatrix(Ue.tileID.toUnwrapped(),Fe.worldSize),Ze=be.evaluatedScale,rt=0;Fe.elevation&&$e.elevation&&(rt=$e.elevation*Fe.elevation.exaggeration()),ge.mat4.translate(Ye,Ye,[($e.anchor?$e.anchor[0]:0)*(Ze[0]-1),($e.anchor?$e.anchor[1]:0)*(Ze[1]-1),rt]),ge.mat4.scale(Ye,Ye,Ze);let Je=fe.queryGeometry,ot=Je.isPointQuery()?Je.screenBounds:Je.screenGeometry,kt=function(ni){let Vt=ge.mat4.multiply([],Ye,ni.matrix);ge.mat4.multiply(Vt,Fe.expandedFarZProjMatrix,Vt);for(let qt=0;qt<ni.meshes.length;++qt){let Lt=ni.meshes[qt];if(qt===ni.lightMeshIndex)continue;let Ri=W5(ot,Fe,Vt,Lt.aabb);Ri!=null&&(Be=Math.min(Ri,Be))}if(ni.children)for(let qt of ni.children)kt(qt)};if(kt($e),Be===Number.MAX_VALUE)return;let Mt=new er(0,0);return o8(Ue.tileID.canonical,Mt,be.node.anchor[0],be.node.anchor[1]),{intersectionZ:Be,position:Mt,feature:be.feature}}(A,S,p,h);if(!D)return;let{z:I,x:O,y:z}=v.tileID.canonical,{feature:B,intersectionZ:G,position:$}=D,H={};B.id!==void 0&&(H=d.sourceCache.getFeatureState(C.sourceLayer,B.id));let K=new Y_({},I,O,z,B.id);K.tile=this.tileID.canonical,K.state=H,K.properties=B.properties,K.geometry={type:"Point",coordinates:[$.lng,$.lat]};let ee=this.serializedLayersCache.get(_);ee||(ee=C.serialize(),ee.id=_,this.serializedLayersCache.set(_,ee)),K.source=ee.source,K.sourceLayer=ee["source-layer"],K.layer=Da({},ee);let ne=!1;for(let ve of M){this.updateFeatureProperties(K,ve);let{filter:pe}=ve;if(pe){if(B.properties=K.properties,pe.needGeometry){if(!pe.filter(new Ar(this.tileID.overscaledZ),B,this.tileID.canonical))continue}else if(!pe.filter(new Ar(this.tileID.overscaledZ),B))continue}ne=!0,ve.targetId&&this.addFeatureVariant(K,ve)}ne&&this.appendToResult(a,_,S,K,G)}updateFeatureProperties(a,l,d){if(l.properties){let p={};for(let h in l.properties){let _=l.properties[h].evaluate({zoom:this.z},a._vectorTileFeature,a.state,a.tile,d);_!=null&&(p[h]=_)}a.properties=p}}addFeatureVariant(a,l,d){let p={target:l.target,namespace:l.namespace,uniqueFeatureID:l.uniqueFeatureID};l.properties&&(p.properties=a.properties),a.variants=a.variants||{},a.variants[l.targetId]=a.variants[l.targetId]||[],a.variants[l.targetId].push(p)}appendToResult(a,l,d,p,h){let _=a[l];_===void 0&&(_=a[l]=[]),_.push({featureIndex:d,feature:p,intersectionZ:h})}lookupSymbolFeatures(a,l,d,p,h){let _={};this.loadVTLayers();for(let x of a)this.loadMatchingFeature(_,{bucketIndex:l,sourceLayerIndex:d,featureIndex:x,layoutVertexArrayOffset:0},p,h);return _}loadFeature(a){let{featureIndex:l,sourceLayerIndex:d}=a;this.loadVTLayers();let p=this.sourceLayerCoder.decode(d),h=this.vtFeatures[p];if(h[l])return h[l];let _=this.vtLayers[p].feature(l);return h[l]=_,_}hasLayer(a){for(let l of this.bucketLayerIDs)for(let d of l)if(a===d)return!0;return!1}getId(a,l){let d=a.id;if(this.promoteId){let p=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[l];if(p!=null)if(Array.isArray(p)){if(!this.promoteIdExpression){let h=cf(p);if(h.result!=="success"){let _=h.value.map(x=>`${x.key}: ${x.message}`).join(", ");return void Gt(`Failed to create expression for promoteId: ${_}`)}this.promoteIdExpression=h.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new rh),d=this.promoteIdExpression.evaluate({zoom:0},a)}else d=a.properties[p];typeof d=="boolean"&&(d=Number(d))}return d}}function K8(u,a,l,d,p){return Pc(u,(h,_)=>{let x=a instanceof gf?a.get(_):null;return x&&x.evaluate?x.evaluate(l,d,p):x})}function $J(u,a){return a-u}ii(Y8,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});let X8=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class YA{static from(a){if(!(a instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[l,d]=new Uint8Array(a,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");let p=d>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);let h=X8[15&d];if(!h)throw new Error("Unrecognized array type.");let[_]=new Uint16Array(a,2,1),[x]=new Uint32Array(a,4,1);return new YA(x,_,h,a)}constructor(a,l=64,d=Float64Array,p){if(isNaN(a)||a<0)throw new Error(`Unpexpected numItems value: ${a}.`);this.numItems=+a,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=d,this.IndexArrayType=a<65536?Uint16Array:Uint32Array;let h=X8.indexOf(this.ArrayType),_=2*a*this.ArrayType.BYTES_PER_ELEMENT,x=a*this.IndexArrayType.BYTES_PER_ELEMENT,C=(8-x%8)%8;if(h<0)throw new Error(`Unexpected typed array class: ${d}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+x+C,2*a),this._pos=2*a,this._finished=!0):(this.data=new ArrayBuffer(8+_+x+C),this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+x+C,2*a),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+h]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=a)}add(a,l){let d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=a,this.coords[this._pos++]=l,d}finish(){let a=this._pos>>1;if(a!==this.numItems)throw new Error(`Added ${a} items when expected ${this.numItems}.`);return KA(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(a,l,d,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:h,coords:_,nodeSize:x}=this,C=[0,h.length-1,0],M=[];for(;C.length;){let v=C.pop()||0,S=C.pop()||0,A=C.pop()||0;if(S-A<=x){for(let z=A;z<=S;z++){let B=_[2*z],G=_[2*z+1];B>=a&&B<=d&&G>=l&&G<=p&&M.push(h[z])}continue}let D=A+S>>1,I=_[2*D],O=_[2*D+1];I>=a&&I<=d&&O>=l&&O<=p&&M.push(h[D]),(v===0?a<=I:l<=O)&&(C.push(A),C.push(D-1),C.push(1-v)),(v===0?d>=I:p>=O)&&(C.push(D+1),C.push(S),C.push(1-v))}return M}within(a,l,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:p,coords:h,nodeSize:_}=this,x=[0,p.length-1,0],C=[],M=d*d;for(;x.length;){let v=x.pop()||0,S=x.pop()||0,A=x.pop()||0;if(S-A<=_){for(let z=A;z<=S;z++)J8(h[2*z],h[2*z+1],a,l)<=M&&C.push(p[z]);continue}let D=A+S>>1,I=h[2*D],O=h[2*D+1];J8(I,O,a,l)<=M&&C.push(p[D]),(v===0?a-d<=I:l-d<=O)&&(x.push(A),x.push(D-1),x.push(1-v)),(v===0?a+d>=I:l+d>=O)&&(x.push(D+1),x.push(S),x.push(1-v))}return C}}function KA(u,a,l,d,p,h){if(p-d<=l)return;let _=d+p>>1;Q8(u,a,_,d,p,h),KA(u,a,l,d,_-1,1-h),KA(u,a,l,_+1,p,1-h)}function Q8(u,a,l,d,p,h){for(;p>d;){if(p-d>600){let M=p-d+1,v=l-d+1,S=Math.log(M),A=.5*Math.exp(2*S/3),D=.5*Math.sqrt(S*A*(M-A)/M)*(v-M/2<0?-1:1);Q8(u,a,l,Math.max(d,Math.floor(l-v*A/M+D)),Math.min(p,Math.floor(l+(M-v)*A/M+D)),h)}let _=a[2*l+h],x=d,C=p;for(y1(u,a,d,l),a[2*p+h]>_&&y1(u,a,d,p);x<C;){for(y1(u,a,x,C),x++,C--;a[2*x+h]<_;)x++;for(;a[2*C+h]>_;)C--}a[2*d+h]===_?y1(u,a,d,C):(C++,y1(u,a,C,p)),C<=l&&(d=C+1),l<=C&&(p=C-1)}}function y1(u,a,l,d){XA(u,l,d),XA(a,2*l,2*d),XA(a,2*l+1,2*d+1)}function XA(u,a,l){let d=u[a];u[a]=u[l],u[l]=d}function J8(u,a,l,d){let p=u-l,h=a-d;return p*p+h*h}r.$=qa,r.A=Ts,r.B=ic,r.C=vf,r.D=H_,r.E=ss,r.F=2,r.G=Jb,r.H=a5,r.I=ls,r.J=class extends yC{},r.K=zc,r.L=Sn,r.M=wE,r.N=tb,r.O=lf,r.P=Wt,r.Q=hE,r.R=lo,r.S=s_,r.T=MA,r.U=__,r.V=yC,r.W=ob,r.X=cf,r.Y=Ol,r.Z=Is,r._=$c,r.a=function(u){return Y.API_CDN_URL_REGEX.test(u)},r.a$=F,r.a0=al,r.a1=gb,r.a2=o_,r.a3=r_,r.a4=function(u){let a=u.value,l=[];if(!a)return l;let d=zc(a);return d!=="string"?(l=l.concat([new yC(u.key,a,`string expected, "${d}" found`)]),l):(Y5(a,!0)||(l=l.concat([new yC(u.key,a,`invalid url "${a}"`)])),l)},r.a5=lt,r.a6=mb,r.a7=no,r.a8=Ht,r.a9=class{constructor(u){this.specification=u}possiblyEvaluate(u,a){return Wr(u.expression.evaluate(a))}interpolate(u,a,l){return{x:pi(u.x,a.x,l),y:pi(u.y,a.y,l),z:pi(u.z,a.z,l),azimuthal:pi(u.azimuthal,a.azimuthal,l),polar:pi(u.polar,a.polar,l)}}},r.aA=function(u,a){let l={};for(let d=0;d<a.length;d++){let p=a[d];p in u&&(l[p]=u[p])}return l},r.aB=vh,r.aC=ul,r.aD=class{constructor(u){this.entries={},this.scheduler=u}request(u,a,l,d){let p=this.entries[u]=this.entries[u]||{callbacks:[]};if(p.result){let[h,_]=p.result;return this.scheduler?this.scheduler.add(()=>{d(h,_)},a):d(h,_),()=>{}}return p.callbacks.push(d),p.cancel||(p.cancel=l((h,_)=>{p.result=[h,_];for(let x of p.callbacks)this.scheduler?this.scheduler.add(()=>{x(h,_)},a):x(h,_);setTimeout(()=>delete this.entries[u],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(h=>h!==d),p.callbacks.length||(p.cancel(),delete this.entries[u]))}}},r.aE=function(u,a,l){let d=JSON.stringify(u.request);return u.data&&(this.deduped.entries[d]={result:[null,u.data]}),this.deduped.request(d,{type:"parseTile",isSymbolTile:u.isSymbolTile,zoom:u.tileZoom},p=>{let h=js(u.request,(_,x,C,M)=>{_?p(_):x&&p(null,{vectorTile:l?void 0:new Mf.VectorTile(new JE(x)),rawData:x,cacheControl:C,expires:M})});return()=>{h.cancel(),p()}},a)},r.aF=function(u){Rn++,Rn>Zi&&(u.getActor().send("enforceCacheSizeLimit",Dt),Rn=0)},r.aG=function(u){return u<=1?1:Math.pow(2,Math.floor(Math.log(u)/Math.LN2))},r.aH=At,r.aI=L5,r.aJ=U5,r.aK=N5,r.aL=function(u,a){let l=document.createElement("video");l.muted=!0,l.onloadstart=function(){a(null,l)};for(let d=0;d<u.length;d++){let p=document.createElement("source");Qp(u[d])||(l.crossOrigin="Anonymous"),p.src=u[d],l.appendChild(p)}return{cancel:()=>{}}},r.aM=pC,r.aN=function(u){return fetch(u).then(a=>a.arrayBuffer()).then(a=>$8(a,0,u))},r.aO=W8,r.aP=class{constructor(u,a,l,d){this.id=u,this.position=a!=null?new er(a[0],a[1]):new er(0,0),this.orientation=l??[0,0,0],this.nodes=d,this.uploaded=!1,this.aabb=new yi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(u,a){if(ge.mat4.multiply(u.matrix,a,u.matrix),u.meshes)for(let l of u.meshes){let d=yi.applyTransformFast(l.aabb,u.matrix);this.aabb.encapsulate(d)}if(u.children)for(let l of u.children)this._applyTransformations(l,u.matrix)}computeBoundsAndApplyParent(){let u=ge.mat4.identity([]);for(let a of this.nodes)this._applyTransformations(a,u)}computeModelMatrix(u,a,l,d,p,h,_=!1){e8(this.matrix,this,u.transform,this.position,a,l,d,p,h,_)}upload(u){if(!this.uploaded){for(let a of this.nodes)OA(a,u);for(let a of this.nodes)vC(a);this.uploaded=!0}}destroy(){for(let u of this.nodes)PA(u)}},r.aQ=eh,r.aR=i1,r.aS=dl,r.aT=ka,r.aU=fd,r.aV=Ra,r.aW=Xl,r.aX=lg,r.aY=dC,r.aZ=function(){lc.isLoading()||lc.isLoaded()||m_()!=="deferred"||xE()},r.a_=_b,r.aa=Ar,r.ab=uf,r.ac=s,r.ad=ge,r.ae=Gr,r.af=gf,r.ag=Ws,r.ah=pi,r.ai=$t,r.aj=Tl,r.ak=Mn,r.al=Ui,r.am=class{constructor(u){this.specification=u}possiblyEvaluate(u,a){return function([l,d]){let p=Wr([1,l,d]);return{x:p.x,y:p.y,z:p.z}}(u.expression.evaluate(a))}interpolate(u,a,l){return{x:pi(u.x,a.x,l),y:pi(u.y,a.y,l),z:pi(u.z,a.z,l)}}},r.an=function(u,a,l=0,d=!0){let p=new Wt(l,l),h=u.sub(p),_=a.add(p),x=[h,new Wt(_.x,h.y),_,new Wt(h.x,_.y)];return d&&x.push(h.clone()),x},r.ao=function(u,a){let l=[];for(let d=0;d<u.length;d++){let p=hu(d-1,-1,u.length-1),h=hu(d+1,-1,u.length-1),_=u[d],x=u[h],C=u[p].sub(_).unit(),M=x.sub(_).unit(),v=M.angleWithSep(C.x,C.y),S=C.add(M).unit().mult(-1*a/Math.sin(v/2));l.push(_.add(S))}return l},r.ap=x5,r.aq=Re,r.ar=function(u,a,l=0){return ge.vec3.fromValues(((a.x-l)*u.scale-u.x)*$t,(a.y*u.scale-u.y)*$t,zb(a.z,a.y))},r.as=Fi,r.at=P6,r.au=function(u){let a=1/0,l=1/0,d=-1/0,p=-1/0;for(let h of u)a=Math.min(a,h.x),l=Math.min(l,h.y),d=Math.max(d,h.x),p=Math.max(p,h.y);return{min:new Wt(a,l),max:new Wt(d,p)}},r.av=Su,r.aw=Ae,r.ax=f,r.ay=pn,r.az=As,r.b=function(u){return Y.API_FONTS_REGEX.test(u)},r.b$=gC,r.b0=Y_,r.b1=Bs,r.b2=sA,r.b3=eA,r.b4=L,r.b5=pd,r.b6=S_,r.b7=ki,r.b8=Zr,r.b9=Ub,r.bA=h6,r.bB=yA,r.bC=f5,r.bD=mA,r.bE=YA,r.bF=hu,r.bG=rl,r.bH=$a,r.bI=function(u,a,l){u[4*a+0]=l[0],u[4*a+1]=l[1],u[4*a+2]=l[2],u[4*a+3]=l[3]},r.bJ=gg,r.bK=uc,r.bL=wf,r.bM=Mo,r.bN=fg,r.bO=er,r.bP=T5,r.bQ=ht,r.bR=on,r.bS=q5,r.bT=St,r.bU=ds,r.bV=function(u,a,l,d,p,h,_,x,C){if(C.name==="globe")return ds(u,a,new St(l,d,p),!1);let M=i1({z:l,x:d,y:p},C);return new yi([(h+M.x/M.scale)*a,a*(M.y/M.scale),_],[(h+M.x2/M.scale)*a,a*(M.y2/M.scale),x])},r.bW=function(u,a,l){let d=0;for(let p=0;p<2;++p)u[p]>0&&(d+=(u[p]-0)*(u[p]-0)),a[p]<0&&(d+=(0-a[p])*(0-a[p]));return d},r.bX=vo,r.bY=BE,r.bZ=function(u){let a=ge.mat4.identity(new Float64Array(16));ge.mat4.multiply(a,u.pixelMatrix,u.globeMatrix);let l=[0,Fl,0],d=[0,zl,0];return ge.vec3.transformMat4(l,l,a),ge.vec3.transformMat4(d,d,a),[l[0]>0&&l[0]<=u.width&&l[1]>0&&l[1]<=u.height&&!pl(u,new er(u.center.lat,90)),d[0]>0&&d[0]<=u.width&&d[1]>0&&d[1]<=u.height&&!pl(u,new er(u.center.lat,-90))]},r.b_=function(u,a){let{scale:l}=u.tileTransform,d=l*$t/(u.tileSize*Math.pow(2,a.zoom-u.tileID.overscaledZ+u.tileID.canonical.z));return ge.mat2.scale(new Float32Array(4),a.inverseAdjustmentMatrix,[d,d])},r.ba=SA,r.bb=function(u,a){let l=Ws(a.zoom);if(l===0)return Jo(u);let d=Hn(u),p=Kr(d),h=Su(d.getWest())*a.worldSize,_=Su(d.getEast())*a.worldSize,x=ul(d.getNorth())*a.worldSize,C=ul(d.getSouth())*a.worldSize,M=[h,x,0],v=[_,x,0],S=[h,C,0],A=[_,C,0],D=ge.mat4.invert([],a.globeMatrix);return ge.vec3.transformMat4(M,M,D),ge.vec3.transformMat4(v,v,D),ge.vec3.transformMat4(S,S,D),ge.vec3.transformMat4(A,A,D),p[0]=ha(p[0],S,l),p[1]=ha(p[1],A,l),p[2]=ha(p[2],v,l),p[3]=ha(p[3],M,l),yi.fromPoints(p)},r.bc=Ur,r.bd=ir,r.be=ha,r.bf=bf,r.bg=tn,r.bh=AC,r.bi=JE,r.bj=js,r.bk=function(u,a){let l=[];for(let d in u)d in a||l.push(d);return l},r.bl=Cr,r.bm=["type","source","source-layer","minzoom","maxzoom","filter","layout"],r.bn=Cs,r.bo=function(u,a){let{x:l,y:d}=u.point,p=dc(l,d,u.worldSize/u._pixelsPerMercatorPixel,0,0);return ge.mat4.multiply(p,p,ea(Jo(a)))},r.bp=N_,r.bq=Vl,r.br=QE,r.bs=function(u,a,l,d,p){let h=5*a+2;u.float32[h+0]=l,u.float32[h+1]=d,u.float32[h+2]=p},r.bt=uC,r.bu=o5,r.bv=ie,r.bw=Wa,r.bx=a6,r.by=Z5,r.bz=d6,r.c=Te,r.c$=z6,r.c0=H5,r.c1=function(u){let a=H5(u,!0);return ge.mat2.invert([],[a[0],a[1],a[4],a[5]])},r.c2=An,r.c3=function(u){let{x:a,y:l}=u.point,{lng:d,lat:p}=u._center;return dc(a,l,u.worldSize,d,p)},r.c4=Ho,r.c5=Kt,r.c6=Ef,r.c7=function(u){let a=Math.round((u+45+360)%360/90)%4;return zs[a]},r.c8=45,r.c9=Dl,r.cA=LE,r.cB=class extends Cu{constructor(u){super(u),this.current=Pb}set(u,a,l){if(this.fetchUniformLocation(u,a)){for(let d=0;d<9;d++)if(l[d]!==this.current[d]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}}},r.cC=kc,r.cD=function(u,a,l){let d=Ws(l.zoom),p=u.style.map._antialias,h=u.terrain&&u.terrain.exaggeration()>0;return d===0&&!p&&!h},r.cE=function(u){let a=u.pixelsPerMeter,l=a/$a(1,u.center.lat),d=ge.mat4.identity(new Float64Array(16));return ge.mat4.translate(d,d,[u.point.x,u.point.y,0]),ge.mat4.scale(d,d,[l,l,a]),Float32Array.from(d)},r.cF=Hn,r.cG=function(u){let a=vo-5;u=pn(u,-a,a)/a*90;let l=Math.pow(Math.abs(Math.sin(Mn(u))),3);return Math.round(l*(R_.length-1))},r.cH=function(u,a,l,d){let p=a.getNorth(),h=a.getSouth(),_=a.getWest(),x=a.getEast(),C=1<<u.z,M=x-_,v=p-h,S=M/Cf,A=-v/R_[l],D=[0,S,0,A,0,0,p,_,0];if(u.z>0){let I=180/d;ge.mat3.multiply(D,D,[I/M+1,0,0,0,I/v+1,0,-.5*I/S,.5*I/A,1])}return D[2]=C,D[5]=u.x,D[8]=u.y,D},r.cI=Jo,r.cJ=function(u,a,l){let d=ge.mat4.identity(new Float64Array(16)),p=(a/(1<<u)-.5)*Math.PI*2;return ge.mat4.rotateY(d,l.globeMatrix,p),Float32Array.from(d)},r.cK=class{isDataAvailableAtPoint(u){let a=this._source();if(this.isUsingMockSource()||!a||u.y<0||u.y>1)return!1;let l=a.getSource().maxzoom,d=1<<l,p=Math.floor(u.x),h=Math.floor((u.x-p)*d),_=Math.floor(u.y*d),x=this.findDEMTileFor(new At(l,p,l,h,_));return!(!x||!x.dem)}getAtPointOrZero(u,a=0){return this.getAtPoint(u,a)||0}getAtPoint(u,a,l=!0){if(this.isUsingMockSource())return null;a==null&&(a=null);let d=this._source();if(!d||u.y<0||u.y>1)return a;let p=d.getSource().maxzoom,h=1<<p,_=Math.floor(u.x),x=u.x-_,C=new At(p,_,p,Math.floor(x*h),Math.floor(u.y*h)),M=this.findDEMTileFor(C);if(!M||!M.dem)return a;let v=M.dem,S=1<<M.tileID.canonical.z,A=(x*S-M.tileID.canonical.x)*v.dim,D=(u.y*S-M.tileID.canonical.y)*v.dim,I=Math.floor(A),O=Math.floor(D);return(l?this.exaggeration():1)*pi(pi(v.get(I,O),v.get(I,O+1),D-O),pi(v.get(I+1,O),v.get(I+1,O+1),D-O),A-I)}getAtTileOffset(u,a,l){let d=1<<u.canonical.z;return this.getAtPointOrZero(new s(u.wrap+(u.canonical.x+a/$t)/d,(u.canonical.y+l/$t)/d))}getAtTileOffsetFunc(u,a,l,d){return p=>{let h=this.getAtTileOffset(u,p.x,p.y),_=d.upVector(u.canonical,p.x,p.y),x=d.upVectorScale(u.canonical,a,l).metersToTile;return ge.vec3.scale(_,_,h*x),_}}getForTilePoints(u,a,l,d){if(this.isUsingMockSource())return!1;let p=U_.create(this,u,d);return!!p&&(a.forEach(h=>{h[2]=this.exaggeration()*p.getElevationAt(h[0],h[1],l)}),!0)}getMinMaxForTile(u){if(this.isUsingMockSource())return null;let a=this.findDEMTileFor(u);if(!a||!a.dem)return null;let l=a.dem.tree,d=a.tileID,p=1<<u.canonical.z-d.canonical.z,h=u.canonical.x/p-d.canonical.x,_=u.canonical.y/p-d.canonical.y,x=0;for(let C=0;C<u.canonical.z-d.canonical.z&&!l.leaves[x];C++){h*=2,_*=2;let M=2*Math.floor(_)+Math.floor(h);x=l.childOffsets[x]+M,h%=1,_%=1}return{min:this.exaggeration()*l.minimums[x],max:this.exaggeration()*l.maximums[x]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(u,a,l){throw new Error("Pure virtual method called.")}pointCoordinate(u){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(u){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){let u=this.visibleDemTiles;if(u.length===0)return null;let a=!1,l=Number.MAX_VALUE,d=Number.MIN_VALUE;for(let p of u){let h=this.getMinMaxForTile(p.tileID);h&&(l=Math.min(l,h.min),d=Math.max(d,h.max),a=!0)}return a?{min:l,max:d}:null}},r.cL=LF,r.cM=Pn,r.cN=function(u,a){return[Math.pow(u[0],2.2)*a,Math.pow(u[1],2.2)*a,Math.pow(u[2],2.2)*a]},r.cO=hl,r.cP=mt,r.cQ=fu,r.cR=256,r.cS=function(u,a){let l=[0,0,0],d=Ur(Jo(a.canonical));return ge.vec3.transformMat4(l,l,d),ge.vec3.transformMat4(l,l,u),l},r.cT=u=>({u_camera_to_center_distance:new Mo(u),u_extrude_scale:new Nb(u),u_device_pixel_ratio:new Mo(u),u_matrix:new gg(u),u_inv_rot_matrix:new gg(u),u_merc_center:new uc(u),u_tile_id:new wf(u),u_zoom_transition:new Mo(u),u_up_dir:new wf(u),u_emissive_strength:new Mo(u)}),r.cU=u=>({u_matrix:new gg(u),u_pixels_to_tile_units:new Nb(u),u_device_pixel_ratio:new Mo(u),u_width_scale:new Mo(u),u_floor_width_scale:new Mo(u),u_units_to_pixels:new uc(u),u_dash_image:new fg(u),u_gradient_image:new fg(u),u_image_height:new Mo(u),u_texsize:new uc(u),u_tile_units_to_pixels:new Mo(u),u_alpha_discard_threshold:new Mo(u),u_trim_offset:new uc(u),u_trim_fade_range:new uc(u),u_trim_color:new mg(u),u_emissive_strength:new Mo(u),u_zbias_factor:new Mo(u),u_tile_to_meter:new Mo(u)}),r.cV=u=>({u_matrix:new gg(u),u_texsize:new uc(u),u_pixels_to_tile_units:new Nb(u),u_device_pixel_ratio:new Mo(u),u_width_scale:new Mo(u),u_floor_width_scale:new Mo(u),u_image:new fg(u),u_units_to_pixels:new uc(u),u_tile_units_to_pixels:new Mo(u),u_alpha_discard_threshold:new Mo(u),u_trim_offset:new uc(u),u_trim_fade_range:new uc(u),u_trim_color:new mg(u),u_emissive_strength:new Mo(u),u_zbias_factor:new Mo(u),u_tile_to_meter:new Mo(u)}),r.cW=Tb,r.cX=ZX,r.cY=YX,r.cZ=Tf,r.c_=(u,a,l,d,p,h)=>{let _=u.transform,x=_.projection.name==="globe",C;if(h.paint.get("circle-pitch-alignment")==="map")if(x){let v=hl(_.zoom,a.canonical)*_._pixelsPerMercatorPixel;C=Float32Array.from([v,0,0,v])}else C=_.calculatePixelsToTileUnitsMatrix(l);else C=new Float32Array([_.pixelsToGLUnits[0],0,0,_.pixelsToGLUnits[1]]);let M={u_camera_to_center_distance:u.transform.getCameraToCenterDistance(_.projection),u_matrix:u.translatePosMatrix(a.projMatrix,l,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_device_pixel_ratio:ft.devicePixelRatio,u_extrude_scale:C,u_inv_rot_matrix:Bb,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:h.paint.get("circle-emissive-strength")};if(x){M.u_inv_rot_matrix=d,M.u_merc_center=p,M.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],M.u_zoom_transition=Ws(_.zoom);let v=p[0]*$t,S=p[1]*$t;M.u_up_dir=_.projection.upVector(new St(0,0,0),v,S)}return M},r.ca=k_,r.cb=mg,r.cc=function(u,a,l){let d=Math.sqrt(u*u+a*a+l*l),p=d>0?Math.acos(l/d)*Yl:0,h=u!==0||a!==0?Math.atan2(-a,-u)*Yl+90:0;return h<0&&(h+=360),[d,h,p]},r.cd=m,r.ce=yi,r.cf=Wr,r.cg=function(u){return[Math.pow(u[0],1/2.2),Math.pow(u[1],1/2.2),Math.pow(u[2],1/2.2)]},r.ch=function(u,a){return u.readFields(UQ,{icons:[]},a)},r.ci=function(u){return u({pluginStatus:Gs,pluginURL:ph}),hf.on("pluginStateChange",u),u},r.cj=wC,r.ck=z_,r.cl=gA,r.cm=xr,r.cn=ig,r.co=Yt,r.cp=rr,r.cq=Zn,r.cr=function(u){let a=u.indexOf(v_);return a>=0?u.slice(0,a):u},r.cs=function(u){return u.indexOf(v_)>=0},r.ct=function(u){let a=u.indexOf(v_);return a>=0?u.slice(a+1):""},r.cu=function(u){let a=[],l=u.id;return l===void 0&&a.push({message:`layers.${l}: missing required property "id"`}),u.render===void 0&&a.push({message:`layers.${l}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&a.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),a},r.cv=function(u,a,l,d){return u.type==="custom"?new MQ(u,a):new BQ[u.type](u,a,l,d)},r.cw=pu,r.cx=class extends Y_{constructor(u,a){super(u._vectorTileFeature,u._z,u._x,u._y,u.id),u.state&&(this.state=Object.assign({},u.state)),this.target=a.target,this.namespace=a.namespace,a.properties&&(this.properties=a.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=u.source,this.sourceLayer=u.sourceLayer,this.layer=u.layer)}toJSON(){let u=super.toJSON();return u.target=this.target,u.namespace=this.namespace,u}},r.cy=hf,r.cz=Vs,r.d=function(u){return Y.API_TILEJSON_REGEX.test(u)},r.d$=Z8,r.d0=va,r.d1=(u,a,l,d,p,h,_,x)=>{let C=u.transform,M=C.pitch<15?N6(.07,.7,pn((14-C.zoom)/5,0,1)):.07,v=l.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:F6(u,a,l,d),u_texsize:a.imageAtlasTexture?a.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:C.calculatePixelsToTileUnitsMatrix(a),u_device_pixel_ratio:p,u_width_scale:h,u_floor_width_scale:_,u_image:0,u_tile_units_to_pixels:L6(a,C),u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:x,u_trim_fade_range:l.paint.get("line-trim-fade-range"),u_trim_color:l.paint.get("line-trim-color").toRenderColor(v?null:l.lut).toArray01(),u_emissive_strength:l.paint.get("line-emissive-strength"),u_zbias_factor:M,u_tile_to_meter:m(a.tileID.canonical,0)}},r.d2=(u,a,l,d,p,h,_,x,C)=>{let M=u.transform,v=M.calculatePixelsToTileUnitsMatrix(a),S=l.paint.get("line-trim-color-use-theme").constantOr("default")==="none",A=M.pitch<15?N6(.07,.7,pn((14-M.zoom)/5,0,1)):.07;return{u_matrix:F6(u,a,l,d),u_pixels_to_tile_units:v,u_device_pixel_ratio:h,u_width_scale:_,u_floor_width_scale:x,u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:p,u_texsize:B6(l)&&a.lineAtlasTexture?a.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:L6(a,u.transform),u_alpha_discard_threshold:0,u_trim_offset:C,u_trim_fade_range:l.paint.get("line-trim-fade-range"),u_trim_color:l.paint.get("line-trim-color").toRenderColor(S?null:l.lut).toArray01(),u_emissive_strength:l.paint.get("line-emissive-strength"),u_zbias_factor:A,u_tile_to_meter:m(a.tileID.canonical,0)}},r.d3=Jd,r.d4=jb,r.d5=zb,r.d6=S6,r.d7=Xt,r.d8=XE,r.d9=If,r.dA=ZE,r.dB=Oc,r.dC=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},r.dD=il,r.dE=HI,r.dF=pp,r.dG=function([u,a,l]){let d=Math.hypot(u,a,l),p=Math.atan2(u,l),h=.5*Math.PI-Math.acos(-a/d);return new er(Ho(p),Ho(h))},r.dH=AA,r.dI=function(u){let a=u.navigator?u.navigator.userAgent:null;return!!function(l){if(nl==null){let d=l.navigator?l.navigator.userAgent:null;nl=!!l.safari||!(!d||!(/\b(iPad|iPhone|iPod)\b/.test(d)||d.match("Safari")&&!d.match("Chrome")))}return nl}(u)&&a&&(a.match("Version/15.4")||a.match("Version/15.5")||a.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},r.dJ=function(u,a){Dt=u,Zi=a},r.dK=pl,r.dL=hc,r.dM=function(u){let a=[0,0,0],l=ge.mat4.identity(new Float64Array(16));return ge.mat4.multiply(l,u.pixelMatrix,u.globeMatrix),ge.vec3.transformMat4(a,a,l),new Wt(a[0],a[1])},r.dN=function(u,a,l=!1){if(Gs===db||Gs===p_||Gs===hb)throw new Error("setRTLTextPlugin cannot be called multiple times.");ph=ft.resolveURL(u),Gs=db,pb=a,f_(),l||xE()},r.dO=m_,r.dP=function(){wC().acquire(LA)},r.dQ=function(){let u=u1;u&&(u.isPreloaded()&&u.numActive()===1?(u.release(LA),u1=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},r.dR=xC,r.dS=function(u){let a=Sr();if(!a)return;let l=a.delete(ei);u&&l.catch(u).then(()=>u())},r.dT=c1,r.dU=z8,r.dV=function(u){$A=ft.resolveURL(u),Z_||(Z_=new H_(wC(),new ss)),Z_.broadcast("setDracoUrl",$A)},r.dW=B8,r.dX=function(u){W_=ft.resolveURL(u),Z_||(Z_=new H_(wC(),new ss)),Z_.broadcast("setMeshoptUrl",W_)},r.dY=ii,r.dZ=Df,r.d_=bd,r.da=450,r.db=7,r.dc=DQ,r.dd=Jn,r.de=M_,r.df=256,r.dg=ea,r.dh=Zc,r.di=ll,r.dj=C_,r.dk=function(u,a,l,d,p){return pn((u-a)/(l-a)*(p-d)+d,d,p)},r.dl=Xv,r.dm=bh,r.dn=class{constructor(u,a,l,d){this.context=u,this.format=d,this.size=l,this.texture=u.gl.createTexture();let[p,h,_]=this.size,{gl:x}=u;x.bindTexture(x.TEXTURE_3D,this.texture),u.pixelStoreUnpackFlipY.set(!1),u.pixelStoreUnpack.set(1),u.pixelStoreUnpackPremultiplyAlpha.set(!1),x.texImage3D(x.TEXTURE_3D,0,this.format,p,h,_,0,TA(this.format),DA(this.format),a.data)}bind(u,a){let{context:l}=this,{gl:d}=l;d.bindTexture(d.TEXTURE_3D,this.texture),u!==this.minFilter&&(d.texParameteri(d.TEXTURE_3D,d.TEXTURE_MAG_FILTER,u),d.texParameteri(d.TEXTURE_3D,d.TEXTURE_MIN_FILTER,u),this.minFilter=u),a!==this.wrapS&&(d.texParameteri(d.TEXTURE_3D,d.TEXTURE_WRAP_S,a),d.texParameteri(d.TEXTURE_3D,d.TEXTURE_WRAP_T,a),this.wrapS=a)}destroy(){let{gl:u}=this.context;u.deleteTexture(this.texture),this.texture=null}},r.dp=RA,r.dq=[1,1,1],r.dr=U_,r.ds=j_,r.dt=gh,r.du=xf,r.dv=fp,r.dw=Ib,r.dx=Mb,r.dy=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Wt(1/0,1/0),max:new Wt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(u,a=!1){let l=l6(new Wt(0,0),new Wt($t,$t),u),d=[];if(a&&!iA(l,this._globalClipBounds))return d;for(let p of this._activeRegions){if(p.hiddenByOverlap||!iA(l,p))continue;let h=xX(p.min,p.max,u);d.push({min:h.min,max:h.max,sourceId:this._sourceIds[p.priority],footprint:p.footprint,footprintTileId:p.tileId,order:p.order,clipMask:p.clipMask,clipScope:p.clipScope})}return d}setSources(u){this._setSources(u.map(a=>({getSourceId:()=>a.cache.id,getFootprints:()=>{let l=[];for(let d of a.cache.getVisibleCoordinates()){let p=a.cache.getTile(d).buckets[a.layer];p&&p.updateFootprints(d.toUnwrapped(),l)}return l},getOrder:()=>a.order,getClipMask:()=>a.clipMask,getClipScope:()=>a.clipScope})))}_addSource(u){let a=u.getFootprints();if(a.length===0)return;let l=u.getOrder(),d=u.getClipMask(),p=u.getClipScope();for(let h of a){if(!h.footprint)continue;let _=l6(h.footprint.min,h.footprint.max,h.id);this._activeRegions.push({min:_.min,max:_.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:h.id,footprint:h.footprint,order:l,clipMask:d,clipScope:p})}this._sourceIds.push(u.getSourceId())}_computeReplacement(){this._activeRegions.sort((a,l)=>a.priority-l.priority||YE(a.min,l.min)||YE(a.max,l.max)||a.order-l.order||a.clipMask-l.clipMask||function(d,p){let h=(_,x)=>_+x;return d.length-p.length||d.reduce(h,"").localeCompare(p.reduce(h,""))}(a.clipScope,l.clipScope));let u=this._activeRegions.length!==this._prevRegions.length;if(!u){let a=0;for(;!u&&a!==this._activeRegions.length;){let l=this._activeRegions[a],d=this._prevRegions[a];u=l.priority!==d.priority||!s6(l,d)||l.order!==d.order||l.clipMask!==d.clipMask||!Cs(l.clipScope,d.clipScope),++a}}if(u){++this._updateTime;for(let l of this._activeRegions)l.order!==ZE&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,l.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,l.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,l.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,l.max.y));let a=l=>{let d=this._activeRegions;if(l>=d.length)return l;let p=d[l].priority;for(;l<d.length&&d[l].priority===p;)++l;return l};if(this._sourceIds.length>1){let l=0,d=a(l);for(;l!==d;){let p=l,h=l;for(;p!==d;){let _=this._activeRegions[p];_.hiddenByOverlap=!1;for(let x=0;x<h;x++){let C=this._activeRegions[x];if(!C.hiddenByOverlap&&_.order===ZE&&iA(_,C)&&(_.hiddenByOverlap=u6(_.footprint,_.tileId,C.footprint,C.tileId),_.hiddenByOverlap))break}++p}l=d,d=a(l)}}}}_setSources(u){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let a=u.length-1;a>=0;a--)this._addSource(u[a]);this._computeReplacement()}},r.dz=class{constructor(u){this._createGrid(u),this._createPoles(u)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(let u of this._poleSegments)u.destroy();for(let u of this._gridSegments)u.withSkirts.destroy(),u.withoutSkirts.destroy()}_fillGridMeshWithLods(u,a){let l=new pd,d=new Ra,p=[],h=u+1+2,_=a[0]+1,x=a[0]+1+(1+a.length),C=(M,v,S)=>{let A=M===h-1?M-2:M===0?M:M-1;return A+=S?24575:0,[A,v]};for(let M=0;M<h;++M)l.emplaceBack(...C(M,0,!0));for(let M=0;M<_;++M)for(let v=0;v<h;++v)l.emplaceBack(...C(v,M,(v===0||v===h-1)&&!0));for(let M=0;M<a.length;++M){let v=a[M];for(let S=0;S<h;++S)l.emplaceBack(...C(S,v,!0))}for(let M=0;M<a.length;++M){let v=d.length,S=a[M]+1+2,A=new Ra;for(let O=0;O<S-1;O++){let z=O===S-2,B=z?h*(x-a.length+M-O):h;for(let G=0;G<h-1;G++){let $=O*h+G;O===0||z||G===0||G===h-2?(A.emplaceBack($+1,$,$+B),A.emplaceBack($+B,$+B+1,$+1)):(d.emplaceBack($+1,$,$+B),d.emplaceBack($+B,$+B+1,$+1))}}let D=Zr.simpleSegment(0,v,l.length,d.length-v);for(let O=0;O<A.uint16.length;O+=3)d.emplaceBack(A.uint16[O],A.uint16[O+1],A.uint16[O+2]);let I=Zr.simpleSegment(0,v,l.length,d.length-v);p.push({withoutSkirts:D,withSkirts:I})}return{vertices:l,indices:d,segments:p}}_createGrid(u){let a=this._fillGridMeshWithLods(Cf,R_);this._gridSegments=a.segments,this._gridBuffer=u.createVertexBuffer(a.vertices,ki.members),this._gridIndexBuffer=u.createIndexBuffer(a.indices,!0)}_createPoles(u){let a=new Ra;for(let _=0;_<=Cf;_++)a.emplaceBack(0,_+1,_+2);this._poleIndexBuffer=u.createIndexBuffer(a,!0);let l=new ll,d=new ll,p=new ll,h=new ll;this._poleSegments=[];for(let _=0,x=0;_<Ef;_++){let C=360/(1<<_);l.emplaceBack(0,-As,0,.5,0),d.emplaceBack(0,-As,0,.5,1),p.emplaceBack(0,-As,0,.5,.5),h.emplaceBack(0,-As,0,.5,.5);for(let M=0;M<=Cf;M++){let v=M/Cf,S=0,A=pi(0,C,v),[D,I,O]=Sf(Du,_d,A,As);l.emplaceBack(D,I,O,v,S),d.emplaceBack(D,I,O,v,1-S);let z=Mn(A);v=.5+.5*Math.sin(z),S=.5+.5*Math.cos(z),p.emplaceBack(D,I,O,v,S),h.emplaceBack(D,I,O,v,1-S)}this._poleSegments.push(Zr.simpleSegment(x,0,66,64)),x+=66}this._poleNorthVertexBuffer=u.createVertexBuffer(l,_i,!1),this._poleSouthVertexBuffer=u.createVertexBuffer(d,_i,!1),this._texturedPoleNorthVertexBuffer=u.createVertexBuffer(p,_i,!1),this._texturedPoleSouthVertexBuffer=u.createVertexBuffer(h,_i,!1)}getGridBuffers(u,a){return[this._gridBuffer,this._gridIndexBuffer,a?this._gridSegments[u].withSkirts:this._gridSegments[u].withoutSkirts]}getPoleBuffers(u,a){return[a?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,a?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[u]]}},r.e=Y,r.e0=Y8,r.e1=R6,r.e2=vg,r.e3="hd_road_elevation",r.e4=class{static parseFrom(u,a){let l=mp.parse(u);if(!l)return[];let{vertices:d,features:p}=l,h=1/m(a);p.sort((M,v)=>M.id-v.id),d.sort((M,v)=>M.id-v.id||M.idx-v.idx),d=d.filter((M,v,S)=>v===S.findIndex(A=>A.id===M.id&&A.idx===M.idx));let _=new Array,x=0,C=d.length;for(let M of p){if(M.constantHeight){_.push(new QI(M.id,M.bounds,M.constantHeight));continue}for(;x!==C&&d[x].id<M.id;)x++;if(x===C||d[x].id!==M.id)continue;let v=new Array,S=new Array,A=x;for(;x!==C&&d[x].id===M.id;){let D=d[x];if(v.push({position:D.position,height:D.height,extent:D.extent}),x!==A&&d[x-1].idx===D.idx-1){let I=x-A;S.push({a:I-1,b:I})}x++}_.push(new QI(M.id,M.bounds,void 0,v,S,h))}return _}},r.e5=Pc,r.e6=bg,r.e7=s5,r.e8=F_,r.e9=function(u,a,l,d,p,h,_,x=1,C){u.createArrays(),u.tilePixelRatio=$t/(512*u.overscaling),u.compareText={},u.iconsNeedLinear=!1;let M=u.layers[0].layout,v=u.layers[0]._unevaluatedLayout._values,S={};S.scaleFactor=x,S.textSizeScaleRange=M.get("text-size-scale-range"),S.iconSizeScaleRange=M.get("icon-size-scale-range");let[A,D]=S.textSizeScaleRange,[I,O]=S.iconSizeScaleRange;S.textScaleFactor=pn(S.scaleFactor,A,D),S.iconScaleFactor=pn(S.scaleFactor,I,O);let z=v["text-size"],B=v["icon-size"];if(u.textSizeData.kind==="composite"){let{minZoom:ne,maxZoom:ve}=u.textSizeData;S.compositeTextSizes=[z.possiblyEvaluate(new Ar(ne),h),z.possiblyEvaluate(new Ar(ve),h)]}if(u.iconSizeData.kind==="composite"){let{minZoom:ne,maxZoom:ve}=u.iconSizeData;S.compositeIconSizes=[B.possiblyEvaluate(new Ar(ne),h),B.possiblyEvaluate(new Ar(ve),h)]}S.layoutTextSize=z.possiblyEvaluate(new Ar(_+1),h),S.layoutIconSize=B.possiblyEvaluate(new Ar(_+1),h),S.textMaxSize=z.possiblyEvaluate(new Ar(18),h);let G=M.get("symbol-placement"),$=M.get("text-rotation-alignment")==="map"&&G!=="point",H=M.get("text-size"),K=!1,ee=[];for(let ne of u.features){let ve=M.get("text-font").evaluate(ne,{},h).join(","),pe=H.evaluate(ne,{},h)*S.textScaleFactor,fe=S.layoutTextSize.evaluate(ne,{},h)*S.textScaleFactor,Fe=S.layoutIconSize.evaluate(ne,{},h)*S.iconScaleFactor,be={horizontal:{},vertical:void 0},Be=ne.text,$e,Ue=[0,0];if(Be){let Lt=Be.toString(),Ri=M.get("text-letter-spacing").evaluate(ne,{},h)*Wa,Jt=M.get("text-line-height").evaluate(ne,{},h)*Wa,mi=AI(Lt)?Ri:0,Hi=M.get("text-anchor").evaluate(ne,{},h),mn=M.get("text-variable-anchor");if(!mn){let Kn=M.get("text-radial-offset").evaluate(ne,{},h);Ue=Kn?f5(Hi,[Kn*Wa,_A]):M.get("text-offset").evaluate(ne,{},h).map(Rr=>Rr*Wa)}let Xi=$?"center":M.get("text-justify").evaluate(ne,{},h),bn=G==="point",fn=bn?M.get("text-max-width").evaluate(ne,{},h)*Wa:1/0,Dn=Kn=>{u.allowVerticalPlacement&&lb(Lt)&&(be.vertical=fA(Be,a,l,p,ve,fn,Jt,Hi,Kn,mi,Ue,Vl.vertical,!0,fe,pe,C))};if(!$&&mn){let Kn=Xi==="auto"?mn.map(Wi=>yA(Wi)):[Xi],Rr=!1;for(let Wi=0;Wi<Kn.length;Wi++){let Nn=Kn[Wi];if(!be.horizontal[Nn])if(Rr)be.horizontal[Nn]=be.horizontal[0];else{let Hr=fA(Be,a,l,p,ve,fn,Jt,"center",Nn,mi,Ue,Vl.horizontal,!1,fe,pe,C);Hr&&(be.horizontal[Nn]=Hr,Rr=Hr.positionedLines.length===1)}}Dn("left")}else{if(Xi==="auto"&&(Xi=yA(Hi)),bn||M.get("text-writing-mode").indexOf("horizontal")>=0||!lb(Lt)){let Kn=fA(Be,a,l,p,ve,fn,Jt,Hi,Xi,mi,Ue,Vl.horizontal,!1,fe,pe,C);Kn&&(be.horizontal[Xi]=Kn)}Dn(bn?"left":Xi)}}let Ye,Ze,rt,Je,ot,kt=!1;if(ne.icon&&ne.icon.hasPrimary()){let Lt=g5(ne.icon,u.iconSizeData,v["icon-size"],h,u.zoom,ne,C,S.iconScaleFactor);Ye=Lt.iconPrimary,Ze=Lt.iconSecondary;let Ri=Ye.toString(),Jt=d.get(Ri);Jt&&(rt=M.get("icon-offset").evaluate(ne,{},h),Je=M.get("icon-anchor").evaluate(ne,{},h),ot=M.get("icon-text-fit").evaluate(ne,{},h),$e=oQ(p.get(Ri),Ze?p.get(Ze.toString()):void 0,rt,Je),kt=Jt.sdf,u.sdfIcons===void 0?u.sdfIcons=Jt.sdf:u.sdfIcons!==Jt.sdf&&Gt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Jt.pixelRatio!==u.pixelRatio||M.get("icon-rotate").constantOr(1)!==0)&&(u.iconsNeedLinear=!0))}K=K||!(!ne.icon||!ne.icon.hasSecondary());let Mt=vA(be.horizontal)||be.vertical;u.iconsInText||(u.iconsInText=!!Mt&&Mt.iconsInText);let ni=fe*S.textScaleFactor/Wa,{defaultShapedIcon:Vt,verticallyShapedIcon:qt}=pQ(u,$e,M,ne,h,be,ni,rt,ot);$e=Vt,ee.push({feature:ne,shapedTextOrientations:be,shapedText:Mt,shapedIcon:$e,iconPrimary:Ye,iconSecondary:Ze,iconOffset:rt,iconAnchor:Je,verticallyShapedIcon:qt,layoutTextSize:fe,layoutIconSize:Fe,textOffset:Ue,isSDFIcon:kt,iconTextFit:ot})}return{featureData:ee,sizes:S,hasAnySecondaryIcon:K,textAlongLine:$,symbolPlacement:G}},r.ea=l5,r.eb=function(u,a,l,d,p,h,_,x,C,M){let{featureData:v,hasAnySecondaryIcon:S,sizes:A,textAlongLine:D,symbolPlacement:I}=a;for(let O of v){let{shapedIcon:z,verticallyShapedIcon:B,feature:G,shapedTextOrientations:$,shapedText:H,layoutTextSize:K,textOffset:ee,isSDFIcon:ne,iconPrimary:ve,iconSecondary:pe,iconTextFit:fe,iconOffset:Fe}=O;_5(z,M.iconPositions,ve,pe),_5(B,M.iconPositions,ve,pe),hQ($,M.iconPositions),(H||z)&&fQ(u,G,$,z,B,C,A,K,0,ee,ne,d,p,_,x,S,fe,Fe,D,I)}l&&u.generateCollisionDebugBuffers(h,u.collisionBoxArray,A.textScaleFactor)},r.ec=Mf,r.ed=IC,r.ee=ca,r.ef=ZF,r.eg=G6,r.eh=g,r.ei=function(u){let a=0;if(new Uint32Array(u,0,1)[0]!==j8){let l=new Uint32Array(u,0,7),[,,d,p,h,_]=l;a=l.byteLength+p+h+_+h,(d!==u.byteLength||a>=u.byteLength)&&Gt("Invalid b3dm header information.")}return $8(u,a)},r.ej=function(u,a){let l=W8(u);for(let d of l){for(let p of d.meshes)UJ(p);d.lights&&(d.lightMeshIndex=d.meshes.length,d.meshes.push(HJ(d.lights,a)))}return l},r.ek=bC,r.el=a8,r.em=lc,r.en=function(u){gn(),Ke?.then(a=>{a.keys().then(l=>{for(let d=0;d<l.length-u;d++)a.delete(l[d])})})},r.f=function(u){return u.indexOf("mapbox:")===0},r.g=function(u,a){return Vs(Da(u,{method:"GET"}),a)},r.h=ue,r.i=function(u){return Y.API_STYLE_REGEX.test(u)&&!Te(u)},r.j=function(u){return decodeURIComponent(atob(u).split("").map(a=>"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)).join(""))},r.k=function(u){return btoa(encodeURIComponent(u).replace(/%([0-9A-F]{2})/g,(a,l)=>String.fromCharCode(+("0x"+l))))},r.l=Da,r.m=Un,r.n=function(u,a){return Vs(Da(u,{type:"json"}),a)},r.o=Ju,r.p=function(u,a){return Vs(Da(u,{method:"POST"}),a)},r.q=ft,r.r=Ga,r.s=function(u){try{let a=self[u];return a.setItem("_mapbox_test_",1),a.removeItem("_mapbox_test_"),!0}catch{return!1}},r.t=gt,r.u=function(){return function u(a){return a?(a^Math.random()*(16>>a/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,u)}()},r.v=function(u){return!!u&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(u)},r.w=Gt,r.x=function(){return FA||(FA=new xC),FA},r.y=jA,r.z=Ia}),n(["./shared"],function(r){function g(mt){let Y=mt?mt.url.toString():void 0;return Y?performance.getEntriesByName(Y):[]}function w(mt){if(typeof mt=="number"||typeof mt=="boolean"||typeof mt=="string"||mt==null)return JSON.stringify(mt);if(Array.isArray(mt)){let ue="[";for(let Te of mt)ue+=`${w(Te)},`;return`${ue}]`}let Y="{";for(let ue of Object.keys(mt).sort())Y+=`${ue}:${w(mt[ue])},`;return`${Y}}`}function T(mt){let Y="";for(let ue of r.bm)(mt.type!=="model"||ue!=="minzoom"&&ue!=="maxzoom")&&(Y+=`/${w(mt[ue])}`);return Y}class k{constructor(Y){this.keyCache={},this._layers={},this._layerConfigs={},Y&&this.replace(Y)}replace(Y,ue){this._layerConfigs={},this._layers={},this.update(Y,[],ue)}update(Y,ue,Te){this._options=Te;for(let ze of Y)this._layerConfigs[ze.id]=ze,(this._layers[ze.id]=r.cv(ze,this.scope,null,this._options)).compileFilter(Te),this.keyCache[ze.id]&&delete this.keyCache[ze.id];for(let ze of ue)delete this.keyCache[ze],delete this._layerConfigs[ze],delete this._layers[ze];this.familiesBySource={};let Ne=function(ze,je){let st={};for(let at=0;at<ze.length;at++){let gt=ze[at],ft=je&&je[gt.id];!ft&&(ft=T(gt),gt.type==="line"&&gt.paint)&&function Yt(ei){return typeof ei=="string"&&ei==="line-progress"||(Array.isArray(ei)?ei.some(Yt):!(!ei||typeof ei!="object")&&Object.values(ei).some(Yt))}(gt.paint["line-width"])&&(ft+=`/${w(gt.paint["line-width"])}`),je&&(je[gt.id]=ft);let Bt=st[ft];Bt||(Bt=st[ft]=[]),Bt.push(gt)}let Ge=[];for(let at in st)Ge.push(st[at]);return Ge}(Object.values(this._layerConfigs),this.keyCache);for(let ze of Ne){let je=ze.map(Bt=>this._layers[Bt.id]),st=je[0];if(st.visibility==="none")continue;let Ge=st.source||"",at=this.familiesBySource[Ge];at||(at=this.familiesBySource[Ge]={});let gt=st.sourceLayer||"_geojsonTileLayer",ft=at[gt];ft||(ft=at[gt]=[]),ft.push(je)}}}let N=1*r.d_;class V{constructor(Y){let ue={},Te=[];for(let st in Y){let Ge=Y[st],at=ue[st]={};for(let gt in Ge.glyphs){let ft=Ge.glyphs[+gt];if(!ft||ft.bitmap.width===0||ft.bitmap.height===0)continue;let Bt=ft.metrics.localGlyph?N:1,Yt={x:0,y:0,w:ft.bitmap.width+2*Bt,h:ft.bitmap.height+2*Bt};Te.push(Yt),at[gt]=Yt}}let{w:Ne,h:ze}=r.H(Te),je=new r.dZ({width:Ne||1,height:ze||1});for(let st in Y){let Ge=Y[st];for(let at in Ge.glyphs){let gt=Ge.glyphs[+at];if(!gt||gt.bitmap.width===0||gt.bitmap.height===0)continue;let ft=ue[st][at],Bt=gt.metrics.localGlyph?N:1;r.dZ.copy(gt.bitmap,je,{x:0,y:0},{x:ft.x+Bt,y:ft.y+Bt},gt.bitmap)}}this.image=je,this.positions=ue}}r.dY(V,"GlyphAtlas");class q{constructor(Y){this.tileID=new r.aH(Y.tileID.overscaledZ,Y.tileID.wrap,Y.tileID.canonical.z,Y.tileID.canonical.x,Y.tileID.canonical.y),this.tileZoom=Y.tileZoom,this.uid=Y.uid,this.zoom=Y.zoom,this.lut=Y.lut,this.canonical=Y.tileID.canonical,this.pixelRatio=Y.pixelRatio,this.tileSize=Y.tileSize,this.source=Y.source,this.scope=Y.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Y.showCollisionBoxes,this.collectResourceTiming=!!Y.request&&Y.request.collectResourceTiming,this.promoteId=Y.promoteId,this.isSymbolTile=Y.isSymbolTile,this.tileTransform=r.aR(Y.tileID.canonical,Y.projection),this.projection=Y.projection,this.worldview=Y.worldview,this.localizableLayerIds=Y.localizableLayerIds,this.brightness=Y.brightness,this.extraShadowCaster=!!Y.extraShadowCaster,this.tessellationStep=Y.tessellationStep,this.scaleFactor=Y.scaleFactor}parse(Y,ue,Te,Ne,ze){this.status="parsing",this.data=Y,this.collisionBoxArray=new r.aX;let je=new r.d$(Object.keys(Y.layers).sort()),st=new r.e0(this.tileID,this.promoteId);st.bucketLayerIDs=[];let Ge={},at=new r.e1(256,256),gt={featureIndex:st,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:at,availableImages:Te,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},ft=ue.familiesBySource[this.source];for(let gn in ft){let Rn=Y.layers[gn];if(!Rn)continue;let Un=!1,dn=!1,Jr=!1;for(let So of ft[gn])So[0].type==="symbol"?Un=!0:dn=!0,So[0].is3D()&&So[0].type!=="model"&&(Jr=!0);if(this.extraShadowCaster&&!Jr||this.isSymbolTile===!0&&!Un||this.isSymbolTile===!1&&!dn)continue;Rn.version===1&&r.w(`Vector tile source "${this.source}" layer "${gn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let Co=je.encode(gn),ua=[],Ei=!1;for(let So=0,lo=0;So<Rn.length;So++){let No=Rn.feature(So),xr=st.getId(No,gn);if(this.localizableLayerIds&&this.localizableLayerIds.has(gn)){let Vs=No.properties?No.properties.worldview:null;if(this.worldview&&typeof Vs=="string")if(Vs==="all")No.properties.$localized=!0;else{if(!Vs.split(",").includes(this.worldview))continue;No.properties.$localized=!0,No.properties.worldview=this.worldview}}!Ei&&No.properties&&No.properties.hasOwnProperty(r.e2)&&(Ei=!0),ua.push({feature:No,id:xr,index:lo,sourceLayerIndex:Co}),lo++}Ei&&!gt.elevationFeatures&&Y.layers.hasOwnProperty(r.e3)&&(gt.elevationFeatures=r.e4.parseFrom(Y.layers[r.e3],this.canonical));for(let So of ft[gn]){let lo=So[0];(!this.extraShadowCaster||lo.is3D()&&lo.type!=="model")&&(this.isSymbolTile!==void 0&&lo.type==="symbol"!==this.isSymbolTile||lo.minzoom&&this.zoom<Math.floor(lo.minzoom)||lo.maxzoom&&this.zoom>=lo.maxzoom||lo.visibility!=="none"&&(Z(So,this.zoom,gt.brightness,Te),(Ge[lo.id]=lo.createBucket({index:st.bucketLayerIDs.length,layers:So,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Co,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(ua,gt,this.tileID.canonical,this.tileTransform),st.bucketLayerIDs.push(So.map(No=>r.C(No.id,No.scope)))))}}let Bt,Yt,ei,Dt,Zi,Yi;at.trim();let Ke={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Gi=()=>{if(Bt)return this.status="done",ze(Bt);if(this.extraShadowCaster)this.status="done",ze(null,{buckets:Object.values(Ge).filter(gn=>!gn.isEmpty()),featureIndex:st,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:gt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Yt&&ei&&Dt){let gn=new V(Yt),Rn=new Map;for(let[Jr,Co]of ei.entries()){let{imagePosition:ua}=r.e7(Jr,Co,r.e8);Rn.set(Jr,ua)}let Un={};for(let Jr in Ge){let Co=Ge[Jr];Co instanceof r.aY&&(Z(Co.layers,this.zoom,gt.brightness,Te),Un[Jr]=r.e9(Co,Yt,gn.positions,ei,Rn,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio))}let dn={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(Ne,ei,Zi,()=>{dn.iconsPending=!1,Sr(Un,gn,dn)}),this.rasterizeIfNeeded(Ne,Dt,Yi,()=>{dn.patternsPending=!1,Sr(Un,gn,dn)})}},Sr=(gn,Rn,Un,dn)=>{if(Un.iconsPending||Un.patternsPending)return;let Jr=new r.ea(ei,Dt,this.lut);for(let Co in Ge){let ua=Ge[Co];if(Co in gn)r.eb(ua,gn[Co],this.showCollisionBoxes,Te,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,ei,Jr);else if(ua.hasPattern&&(ua instanceof r.b2||ua instanceof r.b3||ua instanceof r.d8)){Z(ua.layers,this.zoom,gt.brightness,Te);let Ei=Object.fromEntries(Jr.patternPositions);ua.addFeatures(gt,this.tileID.canonical,Ei,Te,this.tileTransform,this.brightness)}}this.status="done",ze(null,{buckets:Object.values(Ge).filter(Co=>!Co.isEmpty()),featureIndex:st,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Rn.image,lineAtlas:at,imageAtlas:Jr,brightness:gt.brightness})};if(!this.extraShadowCaster){let gn=r.e5(gt.glyphDependencies,dn=>Object.keys(dn).map(Number));Object.keys(gn).length?Ne.send("getGlyphs",{uid:this.uid,stacks:gn,scope:this.scope},(dn,Jr)=>{Bt||(Bt=dn,Yt=Jr,Gi())},void 0,!1,Ke):Yt={};let Rn=Array.from(gt.iconDependencies.keys()).map(dn=>r.I.parse(dn));Rn.length?Ne.send("getImages",{images:Rn,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(dn,Jr)=>{Bt||(Bt=dn,ei=new Map,Zi=this.updateImageMapAndGetImageTaskQueue(ei,Jr,gt.iconDependencies),Gi())},void 0,!1,Ke):(ei=new Map,Zi=new Map);let Un=Array.from(gt.patternDependencies.keys()).map(dn=>r.I.parse(dn));Un.length?Ne.send("getImages",{images:Un,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(dn,Jr)=>{Bt||(Bt=dn,Dt=new Map,Yi=this.updateImageMapAndGetImageTaskQueue(Dt,Jr,gt.patternDependencies),Gi())},void 0,!1,Ke):(Dt=new Map,Yi=new Map)}if(gt.elevationFeatures&&gt.elevationFeatures.length>0){let gn=[];for(let Un of Object.values(Ge))if(Un instanceof r.b3){let dn=Un.getUnevaluatedPortalGraph();dn&&gn.push(dn)}let Rn=r.e6.evaluate(gn);for(let Un of Object.values(Ge))Un instanceof r.b3&&Un.setEvaluatedPortalGraph(Rn)}Gi()}rasterizeIfNeeded(Y,ue,Te,Ne){Array.from(ue.values()).some(ze=>ze.usvg)?this.rasterize(Y,ue,Te,Ne):Ne()}updateImageMapAndGetImageTaskQueue(Y,ue,Te){let Ne=new Map;for(let ze of ue.keys()){let je=Te.get(ze)||[];for(let st of je){let Ge=st.toString(),at=ue.get(st.id.toString());at.usvg?Ne.has(Ge)||(Ne.set(Ge,st),Y.set(Ge,Object.assign({},at))):Y.set(Ge,at)}}return Ne}rasterize(Y,ue,Te,Ne){this.rasterizeTask=Y.send("rasterizeImages",{scope:this.scope,tasks:Te},(ze,je)=>{if(!ze)for(let[st,Ge]of je.entries()){let at=Object.assign(ue.get(st),{data:Ge});ue.set(st,at)}Ne()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function Z(mt,Y,ue,Te){let Ne=new r.aa(Y,{brightness:ue});for(let ze of mt)ze.recalculate(Ne,Te)}class X extends r.E{constructor(Y,ue,Te,Ne,ze,je){super(),this.actor=Y,this.layerIndex=ue,this.availableImages=Te,this.loadVectorData=ze||r.aE,this.loading={},this.loaded={},this.deduped=new r.aD(Y.scheduler),this.isSpriteLoaded=Ne,this.scheduler=Y.scheduler,this.brightness=je}loadTile(Y,ue){let Te=Y.uid,Ne=Y&&Y.request,ze=Ne&&Ne.collectResourceTiming,je=this.loading[Te]=new q(Y);je.abort=this.loadVectorData(Y,(st,Ge)=>{let at=!this.loading[Te];if(delete this.loading[Te],je.cancelRasterize(),at||st||!Ge)return je.status="done",at||(this.loaded[Te]=je),ue(st);let gt=Ge.rawData,ft={};Ge.expires&&(ft.expires=Ge.expires),Ge.cacheControl&&(ft.cacheControl=Ge.cacheControl),je.vectorTile=Ge.vectorTile||new r.ec.VectorTile(new r.bi(gt));let Bt=()=>{je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.actor,(Yt,ei)=>{if(Yt||!ei)return ue(Yt);let Dt={};if(ze){let Zi=g(Ne);Zi.length>0&&(Dt.resourceTiming=JSON.parse(JSON.stringify(Zi)))}ue(null,r.l({rawTileData:gt.slice(0)},ei,ft,Dt))})};this.isSpriteLoaded?Bt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Bt,{type:"parseTile",isSymbolTile:Y.isSymbolTile,zoom:Y.tileZoom}):Bt()}),this.loaded=this.loaded||{},this.loaded[Te]=je})}reloadTile(Y,ue){let Te=this.loaded,Ne=Y.uid;if(Te&&Te[Ne]){let ze=Te[Ne];ze.scaleFactor=Y.scaleFactor,ze.showCollisionBoxes=Y.showCollisionBoxes,ze.projection=Y.projection,ze.brightness=Y.brightness,ze.tileTransform=r.aR(Y.tileID.canonical,Y.projection),ze.extraShadowCaster=Y.extraShadowCaster,ze.lut=Y.lut;let je=(st,Ge)=>{let at=ze.reloadCallback;at&&(delete ze.reloadCallback,ze.parse(ze.vectorTile,this.layerIndex,this.availableImages,this.actor,at)),ue(st,Ge)};ze.status==="parsing"?ze.reloadCallback=je:ze.status==="done"&&(ze.vectorTile?ze.parse(ze.vectorTile,this.layerIndex,this.availableImages,this.actor,je):je())}else ue(null,void 0)}abortTile(Y,ue){let Te=Y.uid,Ne=this.loading[Te];Ne&&(Ne.abort&&Ne.abort(),delete this.loading[Te]),ue()}removeTile(Y,ue){let Te=this.loaded,Ne=Y.uid;Te&&Te[Ne]&&delete Te[Ne],ue()}}class te{loadTile(Y,ue){let{uid:Te,encoding:Ne,rawImageData:ze,padding:je}=Y,st=ImageBitmap&&ze instanceof ImageBitmap?this.getImageData(ze,je):ze;ue(null,new r.ed(Te,st,Ne,je<1))}reloadTile(Y,ue){ue(null,null)}abortTile(Y,ue){ue()}removeTile(Y,ue){ue()}getImageData(Y,ue){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Y.width,Y.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Y.width,this.offscreenCanvas.height=Y.height,this.offscreenCanvasContext.drawImage(Y,0,0,Y.width,Y.height);let Te=this.offscreenCanvasContext.getImageData(-ue,-ue,Y.width+2*ue,Y.height+2*ue);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Te}}r.bh.setPbf(r.bi);class De{constructor(Y){this._mrt=new r.bh(Y.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=Y.uid,this.tileID=Y.tileID,this.source=Y.source}parse(Y,ue){let Te=this._mrt;this.status="parsing",this._entireBuffer=Y;try{Te.parseHeader(Y),this._isHeaderLoaded=!0;let Ne=[];for(let ze in Te.layers){let je=Te.getLayer(ze),st=je.getDataRange(je.getBandList()),Ge=Te.createDecodingTask(st),at=Y.slice(st.firstByte,st.lastByte+1),gt=r.bh.performDecoding(at,Ge).then(ft=>Ge.complete(null,ft)).catch(ft=>Ge.complete(ft,null));Ne.push(gt)}Promise.allSettled(Ne).then(()=>ue(null,Te))}catch(Ne){ue(Ne)}}}class _e{constructor(Y){this.actor=Y,this.loading={},this.loaded={}}loadTile(Y,ue){let Te=Y.uid,Ne=Y.request,ze=this.loading[Te]=new De(Y),{cancel:je}=r.bj(Ne,(st,Ge,at,gt)=>{let ft=!this.loading[Te];if(delete this.loading[Te],ft||st||!Ge)return ze.status="done",ft||(this.loaded[Te]=ze),ue(st);ze.parse(Ge,(Bt,Yt)=>{if(Bt||!Yt)return ue(Bt);ue(null,Yt,at,gt)}),this.loaded[Te]=ze});ze.abort=je}reloadTile(Y,ue){ue(null,void 0)}abortTile(Y,ue){let Te=Y.uid,Ne=this.loading[Te];Ne&&(Ne.abort&&Ne.abort(),delete this.loading[Te]),ue()}removeTile(Y,ue){let Te=Y.uid;this.loaded[Te]&&delete this.loaded[Te],ue()}decodeRasterArray({task:Y,buffer:ue},Te){r.bh.performDecoding(ue,Y).then(Ne=>Te(null,Ne)).catch(Ne=>Te(Ne))}}let he=r.ec.VectorTileFeature.prototype.toGeoJSON;class Ce{constructor(Y){this._feature=Y,this.extent=r.ai,this.type=Y.type,this.properties=Y.tags,"id"in Y&&!isNaN(Y.id)&&(this.id=parseInt(Y.id,10))}loadGeometry(){if(this._feature.type===1){let Y=[];for(let ue of this._feature.geometry)Y.push([new r.P(ue[0],ue[1])]);return Y}{let Y=[];for(let ue of this._feature.geometry){let Te=[];for(let Ne of ue)Te.push(new r.P(Ne[0],Ne[1]));Y.push(Te)}return Y}}toGeoJSON(Y,ue,Te){return he.call(this,Y,ue,Te)}}class Pe{constructor(Y){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=r.ai,this.length=Y.length,this._features=Y}feature(Y){return new Ce(this._features[Y])}}let ye=64/4096,vt=128;class Rt{constructor(){this.features=new Map}clear(){this.features.clear()}load(Y=[],ue){for(let Te of Y){let Ne=Te.id;if(Ne==null)continue;let ze=this.features.get(Ne);ze&&this.updateCache(ze,ue),Te.geometry?(ze=ct(Te),this.updateCache(ze,ue),this.features.set(Ne,ze)):this.features.delete(Ne),this.updateCache(ze,ue)}}updateCache(Y,ue){for(let{canonical:Te,uid:Ne}of Object.values(ue)){let{z:ze,x:je,y:st}=Te;ut(Y,Math.pow(2,ze),je,st)&&delete ue[Ne]}}getTile(Y,ue,Te){let Ne=Math.pow(2,Y),ze=[];for(let je of this.features.values())ut(je,Ne,ue,Te)&&ze.push(we(je,Ne,ue,Te));return{features:ze}}getFeatures(){return[...this.features.values()]}}function ut({minX:mt,minY:Y,maxX:ue,maxY:Te},Ne,ze,je){return mt<(ze+1+ye)/Ne&&Y<(je+1+ye)/Ne&&ue>(ze-ye)/Ne&&Te>(je-ye)/Ne}function ct(mt){let{id:Y,geometry:ue,properties:Te}=mt;if(!ue)return;if(ue.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");let{type:Ne,coordinates:ze}=ue,je={id:Y,type:1,geometry:[],tags:Te,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},st=je.geometry;if(Ne==="Point")We(ze,st,je);else if(Ne==="MultiPoint")for(let Ge of ze)We(Ge,st,je);else if(Ne==="LineString")je.type=2,Pt(ze,st,je);else if(Ne==="MultiLineString")je.type=2,ui(ze,st,je);else if(Ne==="Polygon")je.type=3,ui(ze,st,je,!0);else{if(Ne!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");je.type=3;for(let Ge of ze)ui(Ge,st,je,!0)}return je}function We([mt,Y],ue,Te){let Ne=r.av(mt),ze=r.aC(Y);ze=ze<0?0:ze>1?1:ze,ue.push(Ne,ze),Te.minX=Math.min(Te.minX,Ne),Te.minY=Math.min(Te.minY,ze),Te.maxX=Math.max(Te.maxX,Ne),Te.maxY=Math.max(Te.maxY,ze)}function Pt(mt,Y,ue,Te=!1,Ne=!1){let ze=[];for(let je of mt)We(je,ze,ue);Y.push(ze),Te&&function(je,st){let Ge=0;for(let at=0,gt=je.length,ft=gt-2;at<gt;ft=at,at+=2)Ge+=(je[at]-je[ft])*(je[at+1]+je[ft+1]);if(Ge>0===st)for(let at=0,gt=je.length;at<gt/2;at+=2){let ft=je[at],Bt=je[at+1];je[at]=je[gt-2-at],je[at+1]=je[gt-1-at],je[gt-2-at]=ft,je[gt-1-at]=Bt}}(ze,Ne)}function ui(mt,Y,ue,Te=!1){for(let Ne=0;Ne<mt.length;Ne++)Pt(mt[Ne],Y,ue,Te,Ne===0)}function we(mt,Y,ue,Te){let{id:Ne,type:ze,geometry:je,tags:st}=mt,Ge=[];if(ze===1)(function(at,gt,ft,Bt,Yt){for(let ei=0;ei<at.length;ei+=2){let Dt=Math.round(r.ai*(at[ei+0]*gt-ft)),Zi=Math.round(r.ai*(at[ei+1]*gt-Bt));Yt.push([Dt,Zi])}})(je,Y,ue,Te,Ge);else for(let at of je)xe(at,Y,ue,Te,Ge);return{id:Ne,type:ze,geometry:Ge,tags:st}}function xe(mt,Y,ue,Te,Ne){let ze=-vt,je=r.ai+vt,st;for(let Ge=0;Ge<mt.length-2;Ge+=2){let at=Math.round(r.ai*(mt[Ge+0]*Y-ue)),gt=Math.round(r.ai*(mt[Ge+1]*Y-Te)),ft=Math.round(r.ai*(mt[Ge+2]*Y-ue)),Bt=Math.round(r.ai*(mt[Ge+3]*Y-Te)),Yt=ft-at,ei=Bt-gt;at<ze&&ft<ze||(at<ze?(gt+=Math.round(ei*((ze-at)/Yt)),at=ze):ft<ze&&(Bt=gt+Math.round(ei*((ze-at)/Yt)),ft=ze),gt<ze&&Bt<ze||(gt<ze?(at+=Math.round(Yt*((ze-gt)/ei)),gt=ze):Bt<ze&&(ft=at+Math.round(Yt*((ze-gt)/ei)),Bt=ze),at>=je&&ft>=je||(at>=je?(gt+=Math.round(ei*((je-at)/Yt)),at=je):ft>=je&&(Bt=gt+Math.round(ei*((je-at)/Yt)),ft=je),gt>=je&&Bt>=je||(gt>=je?(at+=Math.round(Yt*((je-gt)/ei)),gt=je):Bt>=je&&(ft=at+Math.round(Yt*((je-gt)/ei)),Bt=je),st&&at===st[st.length-1][0]&&gt===st[st.length-1][1]||(st=[[at,gt]],Ne.push(st)),st.push([ft,Bt])))))}}var le,ke,He,yt={exports:{}},li=function(){if(He)return yt.exports;He=1;var mt=r.eg(),Y=function(){if(ke)return le;ke=1;var gt=r.ee(),ft=r.ef().VectorTileFeature;function Bt(ei,Dt){this.options=Dt||{},this.features=ei,this.length=ei.length}function Yt(ei,Dt){this.id=typeof ei.id=="number"?ei.id:void 0,this.type=ei.type,this.rawGeometry=ei.type===1?[ei.geometry]:ei.geometry,this.properties=ei.tags,this.extent=Dt||4096}return le=Bt,Bt.prototype.feature=function(ei){return new Yt(this.features[ei],this.options.extent)},Yt.prototype.loadGeometry=function(){var ei=this.rawGeometry;this.geometry=[];for(var Dt=0;Dt<ei.length;Dt++){for(var Zi=ei[Dt],Yi=[],Ke=0;Ke<Zi.length;Ke++)Yi.push(new gt(Zi[Ke][0],Zi[Ke][1]));this.geometry.push(Yi)}return this.geometry},Yt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ei=this.geometry,Dt=1/0,Zi=-1/0,Yi=1/0,Ke=-1/0,Gi=0;Gi<ei.length;Gi++)for(var Sr=ei[Gi],gn=0;gn<Sr.length;gn++){var Rn=Sr[gn];Dt=Math.min(Dt,Rn.x),Zi=Math.max(Zi,Rn.x),Yi=Math.min(Yi,Rn.y),Ke=Math.max(Ke,Rn.y)}return[Dt,Yi,Zi,Ke]},Yt.prototype.toGeoJSON=ft.prototype.toGeoJSON,le}();function ue(gt){var ft=new mt;return function(Bt,Yt){for(var ei in Bt.layers)Yt.writeMessage(3,Te,Bt.layers[ei])}(gt,ft),ft.finish()}function Te(gt,ft){var Bt;ft.writeVarintField(15,gt.version||1),ft.writeStringField(1,gt.name||""),ft.writeVarintField(5,gt.extent||4096);var Yt={keys:[],values:[],keycache:{},valuecache:{}};for(Bt=0;Bt<gt.length;Bt++)Yt.feature=gt.feature(Bt),ft.writeMessage(2,Ne,Yt);var ei=Yt.keys;for(Bt=0;Bt<ei.length;Bt++)ft.writeStringField(3,ei[Bt]);var Dt=Yt.values;for(Bt=0;Bt<Dt.length;Bt++)ft.writeMessage(4,at,Dt[Bt])}function Ne(gt,ft){var Bt=gt.feature;Bt.id!==void 0&&ft.writeVarintField(1,Bt.id),ft.writeMessage(2,ze,gt),ft.writeVarintField(3,Bt.type),ft.writeMessage(4,Ge,Bt)}function ze(gt,ft){var Bt=gt.feature,Yt=gt.keys,ei=gt.values,Dt=gt.keycache,Zi=gt.valuecache;for(var Yi in Bt.properties){var Ke=Bt.properties[Yi],Gi=Dt[Yi];if(Ke!==null){Gi===void 0&&(Yt.push(Yi),Dt[Yi]=Gi=Yt.length-1),ft.writeVarint(Gi);var Sr=typeof Ke;Sr!=="string"&&Sr!=="boolean"&&Sr!=="number"&&(Ke=JSON.stringify(Ke));var gn=Sr+":"+Ke,Rn=Zi[gn];Rn===void 0&&(ei.push(Ke),Zi[gn]=Rn=ei.length-1),ft.writeVarint(Rn)}}}function je(gt,ft){return(ft<<3)+(7&gt)}function st(gt){return gt<<1^gt>>31}function Ge(gt,ft){for(var Bt=gt.loadGeometry(),Yt=gt.type,ei=0,Dt=0,Zi=Bt.length,Yi=0;Yi<Zi;Yi++){var Ke=Bt[Yi],Gi=1;Yt===1&&(Gi=Ke.length),ft.writeVarint(je(1,Gi));for(var Sr=Yt===3?Ke.length-1:Ke.length,gn=0;gn<Sr;gn++){gn===1&&Yt!==1&&ft.writeVarint(je(2,Sr-1));var Rn=Ke[gn].x-ei,Un=Ke[gn].y-Dt;ft.writeVarint(st(Rn)),ft.writeVarint(st(Un)),ei+=Rn,Dt+=Un}Yt===3&&ft.writeVarint(je(7,1))}}function at(gt,ft){var Bt=typeof gt;Bt==="string"?ft.writeStringField(1,gt):Bt==="boolean"?ft.writeBooleanField(7,gt):Bt==="number"&&(gt%1!=0?ft.writeDoubleField(3,gt):gt<0?ft.writeSVarintField(6,gt):ft.writeVarintField(5,gt))}return yt.exports=ue,yt.exports.fromVectorTileJs=ue,yt.exports.fromGeojsonVt=function(gt,ft){ft=ft||{};var Bt={};for(var Yt in gt)Bt[Yt]=new Y(gt[Yt].features,ft),Bt[Yt].name=Yt,Bt[Yt].version=ft.version,Bt[Yt].extent=ft.extent;return ue({layers:Bt})},yt.exports.GeoJSONWrapper=Y,yt.exports}(),Ai=r.eh(li);let hi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:mt=>mt},it=Math.fround||(pt=new Float32Array(1),mt=>(pt[0]=+mt,pt[0]));var pt;let di=3,Cn=5,Oo=6;class io{constructor(Y){this.options=Object.assign(Object.create(hi),Y),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Y){let{log:ue,minZoom:Te,maxZoom:Ne}=this.options;ue&&console.time("total time");let ze=`prepare ${Y.length} points`;ue&&console.time(ze),this.points=Y;let je=[];for(let Ge=0;Ge<Y.length;Ge++){let at=Y[Ge];if(!at.geometry)continue;let[gt,ft]=at.geometry.coordinates,Bt=it(os(gt)),Yt=it(ca(ft));je.push(Bt,Yt,1/0,Ge,-1,1),this.options.reduce&&je.push(0)}let st=this.trees[Ne+1]=this._createTree(je);ue&&console.timeEnd(ze);for(let Ge=Ne;Ge>=Te;Ge--){let at=+Date.now();st=this.trees[Ge]=this._createTree(this._cluster(st,Ge)),ue&&console.log("z%d: %d clusters in %dms",Ge,st.numItems,+Date.now()-at)}return ue&&console.timeEnd("total time"),this}getClusters(Y,ue){let Te=((Y[0]+180)%360+360)%360-180,Ne=Math.max(-90,Math.min(90,Y[1])),ze=Y[2]===180?180:((Y[2]+180)%360+360)%360-180,je=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)Te=-180,ze=180;else if(Te>ze){let ft=this.getClusters([Te,Ne,180,je],ue),Bt=this.getClusters([-180,Ne,ze,je],ue);return ft.concat(Bt)}let st=this.trees[this._limitZoom(ue)],Ge=st.range(os(Te),ca(je),os(ze),ca(Ne)),at=st.data,gt=[];for(let ft of Ge){let Bt=this.stride*ft;gt.push(at[Bt+Cn]>1?ge(at,Bt,this.clusterProps):this.points[at[Bt+di]])}return gt}getChildren(Y){let ue=this._getOriginId(Y),Te=this._getOriginZoom(Y),Ne="No cluster with the specified id.",ze=this.trees[Te];if(!ze)throw new Error(Ne);let je=ze.data;if(ue*this.stride>=je.length)throw new Error(Ne);let st=this.options.radius/(this.options.extent*Math.pow(2,Te-1)),Ge=ze.within(je[ue*this.stride],je[ue*this.stride+1],st),at=[];for(let gt of Ge){let ft=gt*this.stride;je[ft+4]===Y&&at.push(je[ft+Cn]>1?ge(je,ft,this.clusterProps):this.points[je[ft+di]])}if(at.length===0)throw new Error(Ne);return at}getLeaves(Y,ue,Te){let Ne=[];return this._appendLeaves(Ne,Y,ue=ue||10,Te=Te||0,0),Ne}getTile(Y,ue,Te){let Ne=this.trees[this._limitZoom(Y)],ze=Math.pow(2,Y),{extent:je,radius:st}=this.options,Ge=st/je,at=(Te-Ge)/ze,gt=(Te+1+Ge)/ze,ft={features:[]};return this._addTileFeatures(Ne.range((ue-Ge)/ze,at,(ue+1+Ge)/ze,gt),Ne.data,ue,Te,ze,ft),ue===0&&this._addTileFeatures(Ne.range(1-Ge/ze,at,1,gt),Ne.data,ze,Te,ze,ft),ue===ze-1&&this._addTileFeatures(Ne.range(0,at,Ge/ze,gt),Ne.data,-1,Te,ze,ft),ft.features.length?ft:null}getClusterExpansionZoom(Y){let ue=this._getOriginZoom(Y)-1;for(;ue<=this.options.maxZoom;){let Te=this.getChildren(Y);if(ue++,Te.length!==1)break;Y=Te[0].properties.cluster_id}return ue}_appendLeaves(Y,ue,Te,Ne,ze){let je=this.getChildren(ue);for(let st of je){let Ge=st.properties;if(Ge&&Ge.cluster?ze+Ge.point_count<=Ne?ze+=Ge.point_count:ze=this._appendLeaves(Y,Ge.cluster_id,Te,Ne,ze):ze<Ne?ze++:Y.push(st),Y.length===Te)break}return ze}_createTree(Y){let ue=new r.bE(Y.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Te=0;Te<Y.length;Te+=this.stride)ue.add(Y[Te],Y[Te+1]);return ue.finish(),ue.data=Y,ue}_addTileFeatures(Y,ue,Te,Ne,ze,je){for(let st of Y){let Ge=st*this.stride,at=ue[Ge+Cn]>1,gt,ft,Bt;if(at)gt=Po(ue,Ge,this.clusterProps),ft=ue[Ge],Bt=ue[Ge+1];else{let Dt=this.points[ue[Ge+di]];gt=Dt.properties;let[Zi,Yi]=Dt.geometry.coordinates;ft=os(Zi),Bt=ca(Yi)}let Yt={type:1,geometry:[[Math.round(this.options.extent*(ft*ze-Te)),Math.round(this.options.extent*(Bt*ze-Ne))]],tags:gt},ei;ei=at||this.options.generateId?ue[Ge+di]:this.points[ue[Ge+di]].id,ei!==void 0&&(Yt.id=ei),je.features.push(Yt)}}_limitZoom(Y){return Math.max(this.options.minZoom,Math.min(Math.floor(+Y),this.options.maxZoom+1))}_cluster(Y,ue){let{radius:Te,extent:Ne,reduce:ze,minPoints:je}=this.options,st=Te/(Ne*Math.pow(2,ue)),Ge=Y.data,at=[],gt=this.stride;for(let ft=0;ft<Ge.length;ft+=gt){if(Ge[ft+2]<=ue)continue;Ge[ft+2]=ue;let Bt=Ge[ft],Yt=Ge[ft+1],ei=Y.within(Ge[ft],Ge[ft+1],st),Dt=Ge[ft+Cn],Zi=Dt;for(let Yi of ei){let Ke=Yi*gt;Ge[Ke+2]>ue&&(Zi+=Ge[Ke+Cn])}if(Zi>Dt&&Zi>=je){let Yi,Ke=Bt*Dt,Gi=Yt*Dt,Sr=-1,gn=(ft/gt<<5)+(ue+1)+this.points.length;for(let Rn of ei){let Un=Rn*gt;if(Ge[Un+2]<=ue)continue;Ge[Un+2]=ue;let dn=Ge[Un+Cn];Ke+=Ge[Un]*dn,Gi+=Ge[Un+1]*dn,Ge[Un+4]=gn,ze&&(Yi||(Yi=this._map(Ge,ft,!0),Sr=this.clusterProps.length,this.clusterProps.push(Yi)),ze(Yi,this._map(Ge,Un)))}Ge[ft+4]=gn,at.push(Ke/Zi,Gi/Zi,1/0,gn,-1,Zi),ze&&at.push(Sr)}else{for(let Yi=0;Yi<gt;Yi++)at.push(Ge[ft+Yi]);if(Zi>1)for(let Yi of ei){let Ke=Yi*gt;if(!(Ge[Ke+2]<=ue)){Ge[Ke+2]=ue;for(let Gi=0;Gi<gt;Gi++)at.push(Ge[Ke+Gi])}}}}return at}_getOriginId(Y){return Y-this.points.length>>5}_getOriginZoom(Y){return(Y-this.points.length)%32}_map(Y,ue,Te){if(Y[ue+Cn]>1){let je=this.clusterProps[Y[ue+Oo]];return Te?Object.assign({},je):je}let Ne=this.points[Y[ue+di]].properties,ze=this.options.map(Ne);return Te&&ze===Ne?Object.assign({},ze):ze}}function ge(mt,Y,ue){return{type:"Feature",id:mt[Y+di],properties:Po(mt,Y,ue),geometry:{type:"Point",coordinates:[(Te=mt[Y],360*(Te-.5)),Wt(mt[Y+1])]}};var Te}function Po(mt,Y,ue){let Te=mt[Y+Cn],Ne=Te>=1e4?`${Math.round(Te/1e3)}k`:Te>=1e3?Math.round(Te/100)/10+"k":Te,ze=mt[Y+Oo],je=ze===-1?{}:Object.assign({},ue[ze]);return Object.assign(je,{cluster:!0,cluster_id:mt[Y+di],point_count:Te,point_count_abbreviated:Ne})}function os(mt){return mt/360+.5}function ca(mt){let Y=Math.sin(mt*Math.PI/180),ue=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return ue<0?0:ue>1?1:ue}function Wt(mt){let Y=(180-360*mt)*Math.PI/180;return 360*Math.atan(Math.exp(Y))/Math.PI-90}function Cs(mt,Y,ue,Te){let Ne=Te,ze=Y+(ue-Y>>1),je,st=ue-Y,Ge=mt[Y],at=mt[Y+1],gt=mt[ue],ft=mt[ue+1];for(let Bt=Y+3;Bt<ue;Bt+=3){let Yt=Ha(mt[Bt],mt[Bt+1],Ge,at,gt,ft);if(Yt>Ne)je=Bt,Ne=Yt;else if(Yt===Ne){let ei=Math.abs(Bt-ze);ei<st&&(je=Bt,st=ei)}}Ne>Te&&(je-Y>3&&Cs(mt,Y,je,Te),mt[je+2]=Ne,ue-je>3&&Cs(mt,je,ue,Te))}function Ha(mt,Y,ue,Te,Ne,ze){let je=Ne-ue,st=ze-Te;if(je!==0||st!==0){let Ge=((mt-ue)*je+(Y-Te)*st)/(je*je+st*st);Ge>1?(ue=Ne,Te=ze):Ge>0&&(ue+=je*Ge,Te+=st*Ge)}return je=mt-ue,st=Y-Te,je*je+st*st}function Yl(mt,Y,ue,Te){let Ne={id:mt??null,type:Y,geometry:ue,tags:Te,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Y==="Point"||Y==="MultiPoint"||Y==="LineString")Mn(Ne,ue);else if(Y==="Polygon")Mn(Ne,ue[0]);else if(Y==="MultiLineString")for(let ze of ue)Mn(Ne,ze);else if(Y==="MultiPolygon")for(let ze of ue)Mn(Ne,ze[0]);return Ne}function Mn(mt,Y){for(let ue=0;ue<Y.length;ue+=3)mt.minX=Math.min(mt.minX,Y[ue]),mt.minY=Math.min(mt.minY,Y[ue+1]),mt.maxX=Math.max(mt.maxX,Y[ue]),mt.maxY=Math.max(mt.maxY,Y[ue+1])}function Ho(mt,Y,ue,Te){if(!Y.geometry)return;let Ne=Y.geometry.coordinates;if(Ne&&Ne.length===0)return;let ze=Y.geometry.type,je=Math.pow(ue.tolerance/((1<<ue.maxZoom)*ue.extent),2),st=[],Ge=Y.id;if(ue.promoteId?Ge=Y.properties[ue.promoteId]:ue.generateId&&(Ge=Te||0),ze==="Point")zs(Ne,st);else if(ze==="MultiPoint")for(let at of Ne)zs(at,st);else if(ze==="LineString")kc(Ne,st,je,!1);else if(ze==="MultiLineString"){if(ue.lineMetrics){for(let at of Ne)st=[],kc(at,st,je,!1),mt.push(Yl(Ge,"LineString",st,Y.properties));return}Oc(Ne,st,je,!1)}else if(ze==="Polygon")Oc(Ne,st,je,!0);else{if(ze!=="MultiPolygon"){if(ze==="GeometryCollection"){for(let at of Y.geometry.geometries)Ho(mt,{id:Ge,geometry:at,properties:Y.properties},ue,Te);return}throw new Error("Input data is not a valid GeoJSON object.")}for(let at of Ne){let gt=[];Oc(at,gt,je,!0),st.push(gt)}}mt.push(Yl(Ge,ze,st,Y.properties))}function zs(mt,Y){Y.push(il(mt[0]),pn(mt[1]),0)}function kc(mt,Y,ue,Te){let Ne,ze,je=0;for(let Ge=0;Ge<mt.length;Ge++){let at=il(mt[Ge][0]),gt=pn(mt[Ge][1]);Y.push(at,gt,0),Ge>0&&(je+=Te?(Ne*gt-at*ze)/2:Math.sqrt(Math.pow(at-Ne,2)+Math.pow(gt-ze,2))),Ne=at,ze=gt}let st=Y.length-3;Y[2]=1,Cs(Y,0,st,ue),Y[st+2]=1,Y.size=Math.abs(je),Y.start=0,Y.end=Y.size}function Oc(mt,Y,ue,Te){for(let Ne=0;Ne<mt.length;Ne++){let ze=[];kc(mt[Ne],ze,ue,Te),Y.push(ze)}}function il(mt){return mt/360+.5}function pn(mt){let Y=Math.sin(mt*Math.PI/180),ue=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return ue<0?0:ue>1?1:ue}function Gr(mt,Y,ue,Te,Ne,ze,je,st){if(Te/=Y,ze>=(ue/=Y)&&je<Te)return mt;if(je<ue||ze>=Te)return null;let Ge=[];for(let at of mt){let gt=at.geometry,ft=at.type,Bt=Ne===0?at.minX:at.minY,Yt=Ne===0?at.maxX:at.maxY;if(Bt>=ue&&Yt<Te){Ge.push(at);continue}if(Yt<ue||Bt>=Te)continue;let ei=[];if(ft==="Point"||ft==="MultiPoint")hu(gt,ei,ue,Te,Ne);else if(ft==="LineString")Cr(gt,ei,ue,Te,Ne,!1,st.lineMetrics);else if(ft==="MultiLineString")Kl(gt,ei,ue,Te,Ne,!1);else if(ft==="Polygon")Kl(gt,ei,ue,Te,Ne,!0);else if(ft==="MultiPolygon")for(let Dt of gt){let Zi=[];Kl(Dt,Zi,ue,Te,Ne,!0),Zi.length&&ei.push(Zi)}if(ei.length){if(st.lineMetrics&&ft==="LineString"){for(let Dt of ei)Ge.push(Yl(at.id,ft,Dt,at.tags));continue}ft!=="LineString"&&ft!=="MultiLineString"||(ei.length===1?(ft="LineString",ei=ei[0]):ft="MultiLineString"),ft!=="Point"&&ft!=="MultiPoint"||(ft=ei.length===3?"Point":"MultiPoint"),Ge.push(Yl(at.id,ft,ei,at.tags))}}return Ge.length?Ge:null}function hu(mt,Y,ue,Te,Ne){for(let ze=0;ze<mt.length;ze+=3){let je=mt[ze+Ne];je>=ue&&je<=Te&&Xl(Y,mt[ze],mt[ze+1],mt[ze+2])}}function Cr(mt,Y,ue,Te,Ne,ze,je){let st=Da(mt),Ge=Ne===0?Jd:eh,at,gt,ft=mt.start;for(let Zi=0;Zi<mt.length-3;Zi+=3){let Yi=mt[Zi],Ke=mt[Zi+1],Gi=mt[Zi+2],Sr=mt[Zi+3],gn=mt[Zi+4],Rn=Ne===0?Yi:Ke,Un=Ne===0?Sr:gn,dn=!1;je&&(at=Math.sqrt(Math.pow(Yi-Sr,2)+Math.pow(Ke-gn,2))),Rn<ue?Un>ue&&(gt=Ge(st,Yi,Ke,Sr,gn,ue),je&&(st.start=ft+at*gt)):Rn>Te?Un<Te&&(gt=Ge(st,Yi,Ke,Sr,gn,Te),je&&(st.start=ft+at*gt)):Xl(st,Yi,Ke,Gi),Un<ue&&Rn>=ue&&(gt=Ge(st,Yi,Ke,Sr,gn,ue),dn=!0),Un>Te&&Rn<=Te&&(gt=Ge(st,Yi,Ke,Sr,gn,Te),dn=!0),!ze&&dn&&(je&&(st.end=ft+at*gt),Y.push(st),st=Da(mt)),je&&(ft+=at)}let Bt=mt.length-3,Yt=mt[Bt],ei=mt[Bt+1],Dt=Ne===0?Yt:ei;Dt>=ue&&Dt<=Te&&Xl(st,Yt,ei,mt[Bt+2]),Bt=st.length-3,ze&&Bt>=3&&(st[Bt]!==st[0]||st[Bt+1]!==st[1])&&Xl(st,st[0],st[1],st[2]),st.length&&Y.push(st)}function Da(mt){let Y=[];return Y.size=mt.size,Y.start=mt.start,Y.end=mt.end,Y}function Kl(mt,Y,ue,Te,Ne,ze){for(let je of mt)Cr(je,Y,ue,Te,Ne,ze,!1)}function Xl(mt,Y,ue,Te){mt.push(Y,ue,Te)}function Jd(mt,Y,ue,Te,Ne,ze){let je=(ze-Y)/(Te-Y);return Xl(mt,ze,ue+(Ne-ue)*je,1),je}function eh(mt,Y,ue,Te,Ne,ze){let je=(ze-ue)/(Ne-ue);return Xl(mt,Y+(Te-Y)*je,ze,1),je}function Pc(mt,Y){let ue=[];for(let Te=0;Te<mt.length;Te++){let Ne=mt[Te],ze=Ne.type,je;if(ze==="Point"||ze==="MultiPoint"||ze==="LineString")je=pu(Ne.geometry,Y);else if(ze==="MultiLineString"||ze==="Polygon"){je=[];for(let st of Ne.geometry)je.push(pu(st,Y))}else if(ze==="MultiPolygon"){je=[];for(let st of Ne.geometry){let Ge=[];for(let at of st)Ge.push(pu(at,Y));je.push(Ge)}}ue.push(Yl(Ne.id,ze,je,Ne.tags))}return ue}function pu(mt,Y){let ue=[];ue.size=mt.size,mt.start!==void 0&&(ue.start=mt.start,ue.end=mt.end);for(let Te=0;Te<mt.length;Te+=3)ue.push(mt[Te]+Y,mt[Te+1],mt[Te+2]);return ue}function Zn(mt,Y){if(mt.transformed)return mt;let ue=1<<mt.z,Te=mt.x,Ne=mt.y;for(let ze of mt.features){let je=ze.geometry,st=ze.type;if(ze.geometry=[],st===1)for(let Ge=0;Ge<je.length;Ge+=2)ze.geometry.push(ci(je[Ge],je[Ge+1],Y,ue,Te,Ne));else for(let Ge=0;Ge<je.length;Ge++){let at=[];for(let gt=0;gt<je[Ge].length;gt+=2)at.push(ci(je[Ge][gt],je[Ge][gt+1],Y,ue,Te,Ne));ze.geometry.push(at)}}return mt.transformed=!0,mt}function ci(mt,Y,ue,Te,Ne,ze){return[Math.round(ue*(mt*Te-Ne)),Math.round(ue*(Y*Te-ze))]}function Gt(mt,Y,ue,Te,Ne){let ze=Y===Ne.maxZoom?0:Ne.tolerance/((1<<Y)*Ne.extent),je={features:[],numPoints:0,numSimplified:0,numFeatures:mt.length,source:null,x:ue,y:Te,z:Y,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(let st of mt)wi(je,st,ze,Ne);return je}function wi(mt,Y,ue,Te){let Ne=Y.geometry,ze=Y.type,je=[];if(mt.minX=Math.min(mt.minX,Y.minX),mt.minY=Math.min(mt.minY,Y.minY),mt.maxX=Math.max(mt.maxX,Y.maxX),mt.maxY=Math.max(mt.maxY,Y.maxY),ze==="Point"||ze==="MultiPoint")for(let st=0;st<Ne.length;st+=3)je.push(Ne[st],Ne[st+1]),mt.numPoints++,mt.numSimplified++;else if(ze==="LineString")nn(je,Ne,mt,ue,!1,!1);else if(ze==="MultiLineString"||ze==="Polygon")for(let st=0;st<Ne.length;st++)nn(je,Ne[st],mt,ue,ze==="Polygon",st===0);else if(ze==="MultiPolygon")for(let st=0;st<Ne.length;st++){let Ge=Ne[st];for(let at=0;at<Ge.length;at++)nn(je,Ge[at],mt,ue,!0,at===0)}if(je.length){let st=Y.tags||null;if(ze==="LineString"&&Te.lineMetrics){st={};for(let at in Y.tags)st[at]=Y.tags[at];st.mapbox_clip_start=Ne.start/Ne.size,st.mapbox_clip_end=Ne.end/Ne.size}let Ge={geometry:je,type:ze==="Polygon"||ze==="MultiPolygon"?3:ze==="LineString"||ze==="MultiLineString"?2:1,tags:st};Y.id!==null&&(Ge.id=Y.id),mt.features.push(Ge)}}function nn(mt,Y,ue,Te,Ne,ze){let je=Te*Te;if(Te>0&&Y.size<(Ne?je:Te))return void(ue.numPoints+=Y.length/3);let st=[];for(let Ge=0;Ge<Y.length;Ge+=3)(Te===0||Y[Ge+2]>je)&&(ue.numSimplified++,st.push(Y[Ge],Y[Ge+1])),ue.numPoints++;Ne&&function(Ge,at){let gt=0;for(let ft=0,Bt=Ge.length,Yt=Bt-2;ft<Bt;Yt=ft,ft+=2)gt+=(Ge[ft]-Ge[Yt])*(Ge[ft+1]+Ge[Yt+1]);if(gt>0===at)for(let ft=0,Bt=Ge.length;ft<Bt/2;ft+=2){let Yt=Ge[ft],ei=Ge[ft+1];Ge[ft]=Ge[Bt-2-ft],Ge[ft+1]=Ge[Bt-1-ft],Ge[Bt-2-ft]=Yt,Ge[Bt-1-ft]=ei}}(st,ze),mt.push(st)}let Wr={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Pi{constructor(Y,ue){let Te=(ue=this.options=function(ze,je){for(let st in je)ze[st]=je[st];return ze}(Object.create(Wr),ue)).debug;if(Te&&console.time("preprocess data"),ue.maxZoom<0||ue.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ue.promoteId&&ue.generateId)throw new Error("promoteId and generateId cannot be used together.");let Ne=function(ze,je){let st=[];if(ze.type==="FeatureCollection")for(let Ge=0;Ge<ze.features.length;Ge++)Ho(st,ze.features[Ge],je,Ge);else Ho(st,ze.type==="Feature"?ze:{geometry:ze},je);return st}(Y,ue);this.tiles={},this.tileCoords=[],Te&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ue.indexMaxZoom,ue.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ne=function(ze,je){let st=je.buffer/je.extent,Ge=ze,at=Gr(ze,1,-1-st,st,0,-1,2,je),gt=Gr(ze,1,1-st,2+st,0,-1,2,je);return(at||gt)&&(Ge=Gr(ze,1,-st,1+st,0,-1,2,je)||[],at&&(Ge=Pc(at,1).concat(Ge)),gt&&(Ge=Ge.concat(Pc(gt,-1)))),Ge}(Ne,ue),Ne.length&&this.splitTile(Ne,0,0,0),Te&&(Ne.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Y,ue,Te,Ne,ze,je,st){let Ge=[Y,ue,Te,Ne],at=this.options,gt=at.debug;for(;Ge.length;){Ne=Ge.pop(),Te=Ge.pop(),ue=Ge.pop(),Y=Ge.pop();let ft=1<<ue,Bt=Bs(ue,Te,Ne),Yt=this.tiles[Bt];if(!Yt&&(gt>1&&console.time("creation"),Yt=this.tiles[Bt]=Gt(Y,ue,Te,Ne,at),this.tileCoords.push({z:ue,x:Te,y:Ne}),gt)){gt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ue,Te,Ne,Yt.numFeatures,Yt.numPoints,Yt.numSimplified),console.timeEnd("creation"));let dn=`z${ue}`;this.stats[dn]=(this.stats[dn]||0)+1,this.total++}if(Yt.source=Y,ze==null){if(ue===at.indexMaxZoom||Yt.numPoints<=at.indexMaxPoints)continue}else{if(ue===at.maxZoom||ue===ze)continue;if(ze!=null){let dn=ze-ue;if(Te!==je>>dn||Ne!==st>>dn)continue}}if(Yt.source=null,Y.length===0)continue;gt>1&&console.time("clipping");let ei=.5*at.buffer/at.extent,Dt=.5-ei,Zi=.5+ei,Yi=1+ei,Ke=null,Gi=null,Sr=null,gn=null,Rn=Gr(Y,ft,Te-ei,Te+Zi,0,Yt.minX,Yt.maxX,at),Un=Gr(Y,ft,Te+Dt,Te+Yi,0,Yt.minX,Yt.maxX,at);Y=null,Rn&&(Ke=Gr(Rn,ft,Ne-ei,Ne+Zi,1,Yt.minY,Yt.maxY,at),Gi=Gr(Rn,ft,Ne+Dt,Ne+Yi,1,Yt.minY,Yt.maxY,at),Rn=null),Un&&(Sr=Gr(Un,ft,Ne-ei,Ne+Zi,1,Yt.minY,Yt.maxY,at),gn=Gr(Un,ft,Ne+Dt,Ne+Yi,1,Yt.minY,Yt.maxY,at),Un=null),gt>1&&console.timeEnd("clipping"),Ge.push(Ke||[],ue+1,2*Te,2*Ne),Ge.push(Gi||[],ue+1,2*Te,2*Ne+1),Ge.push(Sr||[],ue+1,2*Te+1,2*Ne),Ge.push(gn||[],ue+1,2*Te+1,2*Ne+1)}}getTile(Y,ue,Te){Y=+Y,ue=+ue,Te=+Te;let Ne=this.options,{extent:ze,debug:je}=Ne;if(Y<0||Y>24)return null;let st=1<<Y,Ge=Bs(Y,ue=ue+st&st-1,Te);if(this.tiles[Ge])return Zn(this.tiles[Ge],ze);je>1&&console.log("drilling down to z%d-%d-%d",Y,ue,Te);let at,gt=Y,ft=ue,Bt=Te;for(;!at&&gt>0;)gt--,ft>>=1,Bt>>=1,at=this.tiles[Bs(gt,ft,Bt)];return at&&at.source?(je>1&&(console.log("found parent tile z%d-%d-%d",gt,ft,Bt),console.time("drilling down")),this.splitTile(at.source,gt,ft,Bt,Y,ue,Te),je>1&&console.timeEnd("drilling down"),this.tiles[Ge]?Zn(this.tiles[Ge],ze):null):null}}function Bs(mt,Y,ue){return 32*((1<<mt)*ue+Y)+mt}function nl(mt,Y){let ue=mt.tileID.canonical;if(!this._geoJSONIndex)return void Y(null,null);let Te=this._geoJSONIndex.getTile(ue.z,ue.x,ue.y);if(!Te)return void Y(null,null);let Ne=new Pe(Te.features),ze=Ai(Ne);ze.byteOffset===0&&ze.byteLength===ze.buffer.byteLength||(ze=new Uint8Array(ze)),Y(null,{vectorTile:Ne,rawData:ze.buffer})}class rl extends X{constructor(Y,ue,Te,Ne,ze,je){super(Y,ue,Te,Ne,nl,je),ze&&(this.loadGeoJSON=ze),this._dynamicIndex=new Rt}loadData(Y,ue){let Te=Y&&Y.request,Ne=Te&&Te.collectResourceTiming;this.loadGeoJSON(Y,(ze,je)=>{if(ze||!je)return ue(ze);if(typeof je!="object")return ue(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));{try{if(Y.filter){let Ge=r.X(Y.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ge.result==="error")throw new Error(Ge.value.map(at=>`${at.key}: ${at.message}`).join(", "));je.features=je.features.filter(at=>Ge.value.evaluate({zoom:0},at))}Y.dynamic?(je.type==="Feature"&&(je={type:"FeatureCollection",features:[je]}),Y.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(je.features,this.loaded),Y.cluster&&(je.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=Y.cluster?new io(function({superclusterOptions:Ge,clusterProperties:at}){if(!at||!Ge)return Ge;let gt={},ft={},Bt={accumulated:null,zoom:0},Yt={properties:null},ei=Object.keys(at);for(let Dt of ei){let[Zi,Yi]=at[Dt],Ke=r.X(Yi),Gi=r.X(typeof Zi=="string"?[Zi,["accumulated"],["get",Dt]]:Zi);gt[Dt]=Ke.value,ft[Dt]=Gi.value}return Ge.map=Dt=>{Yt.properties=Dt;let Zi={};for(let Yi of ei)Zi[Yi]=gt[Yi].evaluate(Bt,Yt);return Zi},Ge.reduce=(Dt,Zi)=>{Yt.properties=Zi;for(let Yi of ei)Bt.accumulated=Dt[Yi],Dt[Yi]=ft[Yi].evaluate(Bt,Yt)},Ge}(Y)).load(je.features):Y.dynamic?this._dynamicIndex:function(Ge,at){return new Pi(Ge,at)}(je,Y.geojsonVtOptions)}catch(Ge){return ue(Ge)}let st={};if(Ne){let Ge=g(Te);Ge&&(st.resourceTiming={},st.resourceTiming[Y.source]=JSON.parse(JSON.stringify(Ge)))}ue(null,st)}})}reloadTile(Y,ue){let Te=this.loaded;return Te&&Te[Y.uid]?Y.partial?ue(null,void 0):super.reloadTile(Y,ue):this.loadTile(Y,ue)}loadGeoJSON(Y,ue){if(Y.request)r.n(Y.request,ue);else{if(typeof Y.data!="string")return ue(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));try{return ue(null,JSON.parse(Y.data))}catch{return ue(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Y,ue){try{ue(null,this._geoJSONIndex.getClusterExpansionZoom(Y.clusterId))}catch(Te){ue(Te)}}getClusterChildren(Y,ue){try{ue(null,this._geoJSONIndex.getChildren(Y.clusterId))}catch(Te){ue(Te)}}getClusterLeaves(Y,ue){try{ue(null,this._geoJSONIndex.getLeaves(Y.clusterId,Y.limit,Y.offset))}catch(Te){ue(Te)}}}class ol{constructor(Y,ue){this.tileID=new r.aH(Y.tileID.overscaledZ,Y.tileID.wrap,Y.tileID.canonical.z,Y.tileID.canonical.x,Y.tileID.canonical.y),this.tileZoom=Y.tileZoom,this.uid=Y.uid,this.zoom=Y.zoom,this.canonical=Y.tileID.canonical,this.pixelRatio=Y.pixelRatio,this.tileSize=Y.tileSize,this.source=Y.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=Y.projection,this.brightness=ue}parse(Y,ue,Te,Ne){this.status="parsing";let ze=new r.aH(Te.tileID.overscaledZ,Te.tileID.wrap,Te.tileID.canonical.z,Te.tileID.canonical.x,Te.tileID.canonical.y),je=[],st=ue.familiesBySource[Te.source],Ge=new r.e0(ze,Te.promoteId);return Ge.bucketLayerIDs=[],Ge.is3DTile=!0,r.ei(Y).then(at=>{if(!at)return Ne(new Error("Could not parse tile"));let gt=r.ej(at,1/r.cd(Te.tileID.canonical)),ft=at.json.extensionsUsed&&at.json.extensionsUsed.includes("MAPBOX_mesh_features")||at.json.asset.extras&&at.json.asset.extras.MAPBOX_mesh_features,Bt=at.json.extensionsUsed&&at.json.extensionsUsed.includes("EXT_meshopt_compression"),Yt=new r.aa(this.zoom,{brightness:this.brightness});for(let ei in st)for(let Dt of st[ei]){let Zi=Dt[0];Ge.bucketLayerIDs.push(Dt.map(Ke=>r.C(Ke.id,Ke.scope))),Zi.recalculate(Yt,[]);let Yi=new r.ek(Dt,gt,ze,ft,Bt,this.brightness,Ge);ft||(Yi.needsUpload=!0),je.push(Yi),Yi.evaluate(Zi)}this.status="done",Ne(null,{buckets:je,featureIndex:Ge,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(at=>Ne(new Error(at.message)))}}class Ma{constructor(Y,ue,Te,Ne,ze,je){this.actor=Y,this.layerIndex=ue,this.availableImages=Te,this.brightness=je,this.loading={},this.loaded={}}loadTile(Y,ue){let Te=Y.uid,Ne=this.loading[Te]=new ol(Y,this.brightness);r.bj(Y.request,(ze,je)=>{let st=!this.loading[Te];return delete this.loading[Te],st||ze?(Ne.status="done",st||(this.loaded[Te]=Ne),ue(ze)):je&&je.byteLength!==0?void Ne.parse(je,this.layerIndex,Y,(Ge,at)=>{Ne.status="done",this.loaded=this.loaded||{},this.loaded[Te]=Ne,Ge||!at?ue(Ge):ue(null,at)}):(Ne.status="done",this.loaded[Te]=Ne,ue())})}reloadTile(Y,ue){let Te=this.loaded,Ne=Y.uid;if(Te&&Te[Ne]){let ze=Te[Ne];ze.projection=Y.projection,ze.brightness=Y.brightness;let je=(st,Ge)=>{ze.reloadCallback&&(delete ze.reloadCallback,this.loadTile(Y,ue)),ue(st,Ge)};ze.status==="parsing"?ze.reloadCallback=je:ze.status==="done"&&this.loadTile(Y,ue)}}abortTile(Y,ue){let Te=Y.uid;this.loading[Te]&&delete this.loading[Te],ue()}removeTile(Y,ue){let Te=this.loaded,Ne=Y.uid;Te&&Te[Ne]&&delete Te[Ne],ue()}}class fu{constructor(Y){this.self=Y,this.actor=new r.el(Y,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.imageRasterizer=new r.y,this.projections={},this.defaultProjection=r.bP({name:"mercator"}),this.workerSourceTypes={vector:X,geojson:rl,"raster-dem":te,"raster-array":_e,"batched-model":Ma},this.workerSources={},this.self.registerWorkerSource=(ue,Te)=>{if(this.workerSourceTypes[ue])throw new Error(`Worker source with name "${ue}" already registered.`);this.workerSourceTypes[ue]=Te},this.self.registerRTLTextPlugin=ue=>{if(r.em.isParsed())throw new Error("RTL text plugin already registered.");r.em.applyArabicShaping=ue.applyArabicShaping,r.em.processBidirectionalText=ue.processBidirectionalText,r.em.processStyledBidirectionalText=ue.processStyledBidirectionalText}}clearCaches(Y,ue,Te){delete this.layerIndexes[Y],delete this.availableImages[Y],delete this.workerSources[Y],Te()}checkIfReady(Y,ue,Te){Te()}setReferrer(Y,ue){this.referrer=ue}spriteLoaded(Y,{scope:ue,isLoaded:Te}){if(this.isSpriteLoaded[Y]||(this.isSpriteLoaded[Y]={}),this.isSpriteLoaded[Y][ue]=Te,this.workerSources[Y]&&this.workerSources[Y][ue])for(let Ne in this.workerSources[Y][ue]){let ze=this.workerSources[Y][ue][Ne];for(let je in ze){let st=ze[je];st instanceof X&&(st.isSpriteLoaded=Te,st.fire(new r.A("isSpriteLoaded")))}}}setImages(Y,{scope:ue,images:Te},Ne){if(this.availableImages[Y]||(this.availableImages[Y]={}),this.availableImages[Y][ue]=Te,this.workerSources[Y]&&this.workerSources[Y][ue]){for(let ze in this.workerSources[Y][ue]){let je=this.workerSources[Y][ue][ze];for(let st in je)je[st].availableImages=Te}Ne()}else Ne()}setProjection(Y,ue){this.projections[Y]=r.bP(ue)}setBrightness(Y,ue,Te){this.brightness=ue,Te()}setLayers(Y,ue,Te){this.getLayerIndex(Y,ue.scope).replace(ue.layers,ue.options),Te()}updateLayers(Y,ue,Te){this.getLayerIndex(Y,ue.scope).update(ue.layers,ue.removedIds,ue.options),Te()}loadTile(Y,ue,Te){ue.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,ue.type,ue.source,ue.scope).loadTile(ue,Te)}decodeRasterArray(Y,ue,Te){this.getWorkerSource(Y,ue.type,ue.source,ue.scope).decodeRasterArray(ue,Te)}reloadTile(Y,ue,Te){ue.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,ue.type,ue.source,ue.scope).reloadTile(ue,Te)}abortTile(Y,ue,Te){this.getWorkerSource(Y,ue.type,ue.source,ue.scope).abortTile(ue,Te)}removeTile(Y,ue,Te){this.getWorkerSource(Y,ue.type,ue.source,ue.scope).removeTile(ue,Te)}removeSource(Y,ue,Te){if(!(this.workerSources[Y]&&this.workerSources[Y][ue.scope]&&this.workerSources[Y][ue.scope][ue.type]&&this.workerSources[Y][ue.scope][ue.type][ue.source]))return;let Ne=this.workerSources[Y][ue.scope][ue.type][ue.source];delete this.workerSources[Y][ue.scope][ue.type][ue.source],Ne.removeSource!==void 0?Ne.removeSource(ue,Te):Te()}loadWorkerSource(Y,ue,Te){try{this.self.importScripts(ue.url),Te()}catch(Ne){Te(Ne.toString())}}syncRTLPluginState(Y,ue,Te){try{r.em.setState(ue);let Ne=r.em.getPluginURL();if(r.em.isLoaded()&&!r.em.isParsed()&&Ne!=null){this.self.importScripts(Ne);let ze=r.em.isParsed();Te(ze?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ne}`),ze)}}catch(Ne){Te(Ne.toString())}}setDracoUrl(Y,ue){this.dracoUrl=ue}getAvailableImages(Y,ue){this.availableImages[Y]||(this.availableImages[Y]={});let Te=this.availableImages[Y][ue];return Te||(Te=[]),Te}getLayerIndex(Y,ue){this.layerIndexes[Y]||(this.layerIndexes[Y]={});let Te=this.layerIndexes[Y][ue];return Te||(Te=this.layerIndexes[Y][ue]=new k,Te.scope=ue),Te}getWorkerSource(Y,ue,Te,Ne){let ze=this.workerSources;return ze[Y]||(ze[Y]={}),ze[Y][Ne]||(ze[Y][Ne]={}),ze[Y][Ne][ue]||(ze[Y][Ne][ue]={}),this.isSpriteLoaded[Y]||(this.isSpriteLoaded[Y]={}),ze[Y][Ne][ue][Te]||(ze[Y][Ne][ue][Te]=new this.workerSourceTypes[ue]({send:(je,st,Ge,at,gt,ft)=>{this.actor.send(je,st,Ge,Y,gt,ft)},scheduler:this.actor.scheduler},this.getLayerIndex(Y,Ne),this.getAvailableImages(Y,Ne),this.isSpriteLoaded[Y][Ne],void 0,this.brightness)),ze[Y][Ne][ue][Te]}rasterizeImages(Y,ue,Te){let Ne=new Map;for(let[ze,{image:je,imageVariant:st}]of ue.tasks.entries()){let Ge=this.imageRasterizer.rasterize(st,je,ue.scope,Y);Ne.set(ze,Ge)}Te(void 0,Ne)}removeRasterizedImages(Y,ue,Te){this.imageRasterizer.removeImagesFromCacheByIds(ue.imageIds,ue.scope,Y),Te()}enforceCacheSizeLimit(Y,ue){r.en(ue)}getWorkerPerformanceMetrics(Y,ue,Te){Te(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new fu(self)),fu}),n(["./shared"],function(r){var g="3.11.0";let w={create:"create",load:"load",fullLoad:"fullLoad"},T={mark(m){performance.mark(m)},measure(m,s,c){performance.measure(m,s,c)}};function k(m){let s=m.name.split("?")[0];return r.a(s)&&s.includes("mapbox-gl.js")?"javascript":r.a(s)&&s.includes("mapbox-gl.css")?"css":r.b(s)?"fontRange":r.c(s)?"sprite":r.i(s)?"style":r.d(s)?"tilejson":"other"}var N,V={},q=function(){if(N)return V;function m(f){return!s(f)}function s(f){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var b,E,R=new Blob([""],{type:"text/javascript"}),P=URL.createObjectURL(R);try{E=new Worker(P),b=!0}catch{b=!1}return E&&E.terminate(),URL.revokeObjectURL(P),b}()?function(){var b=document.createElement("canvas");b.width=b.height=1;var E=b.getContext("2d");if(!E)return!1;var R=E.getImageData(0,0,1,1);return R&&R.width===b.width}()?(c[y=f&&f.failIfMajorPerformanceCaveat]===void 0&&(c[y]=function(b){var E,R=function(P){var L=document.createElement("canvas"),F=Object.create(m.webGLContextAttributes);return F.failIfMajorPerformanceCaveat=P,L.getContext("webgl2",F)}(b);if(!R)return!1;try{E=R.createShader(R.VERTEX_SHADER)}catch{return!1}return!(!E||R.isContextLost())&&(R.shaderSource(E,"void main() {}"),R.compileShader(E),R.getShaderParameter(E,R.COMPILE_STATUS)===!0)}(y)),c[y]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var y}N=1,V.supported=m,V.notSupportedReason=s;var c={};return m.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},V}();function Z(m,s,c){let f=document.createElement(m);return s!=null&&(f.className=s),c&&c.appendChild(f),f}function X(m,s,c){let f=document.createElementNS("http://www.w3.org/2000/svg",m);for(let y of Object.keys(s))f.setAttributeNS(null,y,String(s[y]));return c&&c.appendChild(f),f}let te=typeof document<"u"?document.documentElement&&document.documentElement.style:null,De=te&&te.userSelect!==void 0?"userSelect":"WebkitUserSelect",_e;function he(){te&&De&&(_e=te[De],te[De]="none")}function Ce(){te&&De&&(te[De]=_e)}function Pe(m){m.preventDefault(),m.stopPropagation(),window.removeEventListener("click",Pe,!0)}function ye(){window.addEventListener("click",Pe,!0),window.setTimeout(()=>{window.removeEventListener("click",Pe,!0)},0)}function vt(m,s){let c=m.getBoundingClientRect();return ct(m,c,s)}function Rt(m,s){let c=m.getBoundingClientRect(),f=[];for(let y=0;y<s.length;y++)f.push(ct(m,c,s[y]));return f}function ut(m){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&m.button===2&&m.ctrlKey?0:m.button}function ct(m,s,c){let f=m.offsetWidth===s.width?1:m.offsetWidth/s.width;return new r.P((c.clientX-s.left)*f,(c.clientY-s.top)*f)}let We="01",Pt="NO_ACCESS_TOKEN";class ui{constructor(s,c,f){this._transformRequestFn=s,this._customAccessToken=c,this._silenceAuthErrors=!!f,this._createSkuToken()}_createSkuToken(){let s=function(){let c="";for(let f=0;f<10;f++)c+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",We,c].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(s,c){return this._transformRequestFn&&this._transformRequestFn(s,c)||{url:s}}normalizeStyleURL(s,c){if(!r.f(s))return s;let f=xe(s);return f.params.push(`sdk=js-${g}`),f.path=`/styles/v1${f.path}`,this._makeAPIURL(f,this._customAccessToken||c)}normalizeGlyphsURL(s,c){if(!r.f(s))return s;let f=xe(s);return f.path=`/fonts/v1${f.path}`,this._makeAPIURL(f,this._customAccessToken||c)}normalizeModelURL(s,c){if(!r.f(s))return s;let f=xe(s);return f.path=`/models/v1${f.path}`,this._makeAPIURL(f,this._customAccessToken||c)}normalizeSourceURL(s,c,f,y){if(!r.f(s))return s;let b=xe(s);return b.path=`/v4/${b.authority}.json`,b.params.push("secure"),f&&b.params.push(`language=${f}`),y&&b.params.push(`worldview=${y}`),this._makeAPIURL(b,this._customAccessToken||c)}normalizeIconsetURL(s,c){let f=xe(s);return r.f(s)?(f.path=`/styles/v1${f.path}/iconset.pbf`,this._makeAPIURL(f,this._customAccessToken||c)):le(f)}normalizeSpriteURL(s,c,f,y){let b=xe(s);return r.f(s)?(b.path=`/styles/v1${b.path}/sprite${c}${f}`,this._makeAPIURL(b,this._customAccessToken||y)):(b.path+=`${c}${f}`,le(b))}normalizeTileURL(s,c,f){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!r.f(s))return s;let y=xe(s);y.path=y.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${c||f&&y.authority!=="raster"&&f===512?"@2x":""}${r.m.supported?".webp":"$1"}`),y.authority==="raster"?y.path=`/${r.e.RASTER_URL_PREFIX}${y.path}`:y.authority==="rasterarrays"?y.path=`/${r.e.RASTERARRAYS_URL_PREFIX}${y.path}`:y.authority==="3dtiles"?y.path=`/${r.e.TILES3D_URL_PREFIX}${y.path}`:(y.path=y.path.replace(/^.+\/v4\//,"/"),y.path=`/${r.e.TILE_URL_VERSION}${y.path}`);let b=this._customAccessToken||function(E){for(let R of E){let P=R.match(/^access_token=(.*)$/);if(P)return P[1]}return null}(y.params)||r.e.ACCESS_TOKEN;return r.e.REQUIRE_ACCESS_TOKEN&&b&&this._skuToken&&y.params.push(`sku=${this._skuToken}`),this._makeAPIURL(y,b)}canonicalizeTileURL(s,c){let f=xe(s);if(!f.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!f.path.match(/\.[\w]+$/))return s;let y="mapbox://";f.path.match(/^\/raster\/v1\//)?y+=`raster/${f.path.replace(`/${r.e.RASTER_URL_PREFIX}/`,"")}`:f.path.match(/^\/rasterarrays\/v1\//)?y+=`rasterarrays/${f.path.replace(`/${r.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:y+=`tiles/${f.path.replace(`/${r.e.TILE_URL_VERSION}/`,"")}`;let b=f.params;return c&&(b=b.filter(E=>!E.match(/^access_token=/))),b.length&&(y+=`?${b.join("&")}`),y}canonicalizeTileset(s,c){let f=!!c&&r.f(c),y=[];for(let b of s.tiles||[])r.h(b)?y.push(this.canonicalizeTileURL(b,f)):y.push(b);return y}_makeAPIURL(s,c){let f="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",y=xe(r.e.API_URL);if(s.protocol=y.protocol,s.authority=y.authority,s.protocol==="http"){let b=s.params.indexOf("secure");b>=0&&s.params.splice(b,1)}if(y.path!=="/"&&(s.path=`${y.path}${s.path}`),!r.e.REQUIRE_ACCESS_TOKEN)return le(s);if(c=c||r.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!c)throw new Error(`An API access token is required to use Mapbox GL. ${f}`);if(c[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${f}`)}return s.params=s.params.filter(b=>b.indexOf("access_token")===-1),s.params.push(`access_token=${c||""}`),le(s)}}let we=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function xe(m){let s=m.match(we);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function le(m){let s=m.params.length?`?${m.params.join("&")}`:"";return`${m.protocol}://${m.authority}${m.path}${s}`}let ke="mapbox.eventData";function He(m){if(!m)return null;let s=m.split(".");if(!s||s.length!==3)return null;try{return JSON.parse(r.j(s[1]))}catch{return null}}class yt{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){let c=He(r.e.ACCESS_TOKEN),f="";return f=c&&c.u?r.k(c.u):r.e.ACCESS_TOKEN||"",s?`${ke}.${s}:${f}`:`${ke}:${f}`}fetchEventData(){let s=r.s("localStorage"),c=this.getStorageKey(),f=this.getStorageKey("uuid");if(s)try{let y=localStorage.getItem(c);y&&(this.eventData=JSON.parse(y));let b=localStorage.getItem(f);b&&(this.anonId=b)}catch{r.w("Unable to read from LocalStorage")}}saveEventData(){let s=r.s("localStorage"),c=this.getStorageKey(),f=this.getStorageKey("uuid"),y=this.anonId;if(s&&y)try{localStorage.setItem(f,y),Object.keys(this.eventData).length>=1&&localStorage.setItem(c,JSON.stringify(this.eventData))}catch{r.w("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,c,f,y){if(!r.e.EVENTS_URL)return;let b=xe(r.e.EVENTS_URL);b.params.push(`access_token=${y||r.e.ACCESS_TOKEN||""}`);let E={event:this.type,created:new Date(s).toISOString()},R=c?r.l(E,c):E,P={url:le(b),headers:{"Content-Type":"text/plain"},body:JSON.stringify([R])};this.pendingRequest=r.p(P,L=>{this.pendingRequest=null,f(L),this.saveEventData(),this.processRequests(y)})}queueRequest(s,c){this.queue.push(s),this.processRequests(c)}}let li=new class extends yt{constructor(m){super("appUserTurnstile"),this._customAccessToken=m}postTurnstileEvent(m,s){r.e.EVENTS_URL&&r.e.ACCESS_TOKEN&&Array.isArray(m)&&m.some(c=>r.f(c)||r.h(c))&&this.queueRequest(Date.now(),s)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();let s=He(r.e.ACCESS_TOKEN),c=s?s.u:r.e.ACCESS_TOKEN,f=c!==this.eventData.tokenU;r.v(this.anonId)||(this.anonId=r.u(),f=!0);let y=this.queue.shift();if(this.eventData.lastSuccess){let b=new Date(this.eventData.lastSuccess),E=new Date(y),R=(y-this.eventData.lastSuccess)/864e5;f=f||R>=1||R<-1||b.getDate()!==E.getDate()}else f=!0;f?this.postEvent(y,{sdkIdentifier:"mapbox-gl-js",sdkVersion:g,skuId:We,"enabled.telemetry":!1,userId:this.anonId},b=>{b||(this.eventData.lastSuccess=y,this.eventData.tokenU=c)},m):this.processRequests()}},Ai=li.postTurnstileEvent.bind(li),hi=new class extends yt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(m,s,c,f){this.skuToken=s,this.errorCb=f,r.e.EVENTS_URL&&(c||r.e.ACCESS_TOKEN?this.queueRequest({id:m,timestamp:Date.now()},c):this.errorCb(new Error(Pt)))}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;let{id:s,timestamp:c}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),r.v(this.anonId)||(this.anonId=r.u()),this.postEvent(c,{sdkIdentifier:"mapbox-gl-js",sdkVersion:g,skuId:We,skuToken:this.skuToken,userId:this.anonId},f=>{f?this.errorCb(f):s&&(this.success[s]=!0)},m))}remove(){this.errorCb=null}},it=hi.postMapLoadEvent.bind(hi),pt=new class extends yt{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(m){let s=this.mapInstanceIdMap.get(m);return s||(s=r.u(),this.mapInstanceIdMap.set(m,s)),s}getEventId(m){let s=this.eventIdPerMapInstanceMap.get(m)||0;return this.eventIdPerMapInstanceMap.set(m,s+1),s}postStyleLoadEvent(m,s){let{map:c,style:f,importedStyles:y}=s;if(!r.e.EVENTS_URL||!m&&!r.e.ACCESS_TOKEN)return;let b=this.getMapInstanceId(c),E={mapInstanceId:b,eventId:this.getEventId(b),style:f};y.length&&(E.importedStyles=y),this.queueRequest({timestamp:Date.now(),payload:E},m)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;let{timestamp:s,payload:c}=this.queue.shift();this.postEvent(s,c,()=>{},m)}},di=pt.postStyleLoadEvent.bind(pt),Cn=new class extends yt{constructor(){super("gljs.performance")}postPerformanceEvent(m,s){r.e.EVENTS_URL&&(m||r.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},m)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;let{timestamp:s,performanceData:c}=this.queue.shift(),f=function(y){let b=performance.getEntriesByType("resource"),E=performance.getEntriesByType("mark"),R=function(W){let ie={};if(W){for(let Q in W)if(Q!=="other")for(let re of W[Q]){let oe=`${Q}ResolveRangeMin`,me=`${Q}ResolveRangeMax`,Me=`${Q}RequestCount`,Ee=`${Q}RequestCachedCount`;ie[oe]=Math.min(ie[oe]||1/0,re.startTime),ie[me]=Math.max(ie[me]||-1/0,re.responseEnd);let Le=Ie=>{ie[Ie]===void 0&&(ie[Ie]=0),++ie[Ie]};re.transferSize!==void 0&&re.transferSize===0&&Le(Ee),Le(Me)}}return ie}(function(W,ie){let Q={};if(W)for(let re of W){let oe=ie(re);Q[oe]===void 0&&(Q[oe]=[]),Q[oe].push(re)}return Q}(b,k)),P=window.devicePixelRatio,L=navigator.connection||navigator.mozConnection||navigator.webkitConnection,F=L?L.effectiveType:void 0,j={counters:[],metadata:[],attributes:[]},U=(W,ie,Q)=>{Q!=null&&W.push({name:ie,value:Q.toString()})};for(let W in R)U(j.counters,W,R[W]);if(y.interactionRange[0]!==1/0&&y.interactionRange[1]!==-1/0&&(U(j.counters,"interactionRangeMin",y.interactionRange[0]),U(j.counters,"interactionRangeMax",y.interactionRange[1])),E)for(let W of Object.keys(w)){let ie=w[W],Q=E.find(re=>re.name===ie);Q&&U(j.counters,ie,Q.startTime)}return U(j.counters,"visibilityHidden",y.visibilityHidden),U(j.attributes,"style",function(W){if(W)for(let ie of W){let Q=ie.name.split("?")[0];if(r.i(Q)){let re=Q.split("/").slice(-2);if(re.length===2)return`mapbox://styles/${re[0]}/${re[1]}`}}}(b)),U(j.attributes,"terrainEnabled",y.terrainEnabled?"true":"false"),U(j.attributes,"fogEnabled",y.fogEnabled?"true":"false"),U(j.attributes,"projection",y.projection),U(j.attributes,"zoom",y.zoom),U(j.metadata,"devicePixelRatio",P),U(j.metadata,"connectionEffectiveType",F),U(j.metadata,"navigatorUserAgent",navigator.userAgent),U(j.metadata,"screenWidth",window.screen.width),U(j.metadata,"screenHeight",window.screen.height),U(j.metadata,"windowWidth",window.innerWidth),U(j.metadata,"windowHeight",window.innerHeight),U(j.metadata,"mapWidth",y.width/P),U(j.metadata,"mapHeight",y.height/P),U(j.metadata,"webglRenderer",y.renderer),U(j.metadata,"webglVendor",y.vendor),U(j.metadata,"sdkVersion",g),U(j.metadata,"sdkIdentifier","mapbox-gl-js"),j}(c);for(let y of f.metadata);for(let y of f.counters);for(let y of f.attributes);this.postEvent(s,f,()=>{},m)}},Oo=Cn.postPerformanceEvent.bind(Cn),io=new class extends yt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(m,s,c,f){if(!r.e.API_URL||!r.e.SESSION_PATH)return;let y=xe(r.e.API_URL+r.e.SESSION_PATH);y.params.push(`sku=${s||""}`),y.params.push(`access_token=${f||r.e.ACCESS_TOKEN||""}`);let b={url:le(y),headers:{"Content-Type":"text/plain"}};this.pendingRequest=r.g(b,E=>{this.pendingRequest=null,c(E),this.saveEventData(),this.processRequests(f)})}getSessionAPI(m,s,c,f){this.skuToken=s,this.errorCb=f,r.e.SESSION_PATH&&r.e.API_URL&&(c||r.e.ACCESS_TOKEN?this.queueRequest({id:m,timestamp:Date.now()},c):this.errorCb(new Error(Pt)))}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;let{id:s,timestamp:c}=this.queue.shift();s&&this.success[s]||this.getSession(c,this.skuToken,f=>{f?this.errorCb(f):s&&(this.success[s]=!0)},m)}remove(){this.errorCb=null}},ge=io.getSessionAPI.bind(io),Po=new Set;function os(m,s){s?Po.add(m):Po.delete(m)}class ca{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(s,c){this._updatedSourceCaches[s]=c,this.setDirty()}discardSourceCacheUpdate(s){delete this._updatedSourceCaches[s]}updateLayer(s){let c=s.scope;this._updatedLayers[c]=this._updatedLayers[c]||new Set,this._updatedLayers[c].add(s.id),this.setDirty()}removeLayer(s){let c=s.scope;this._removedLayers[c]=this._removedLayers[c]||{},this._updatedLayers[c]=this._updatedLayers[c]||new Set,this._removedLayers[c][s.id]=s,this._updatedLayers[c].delete(s.id),this._updatedPaintProps.delete(s.fqid),this.setDirty()}getRemovedLayer(s){return this._removedLayers[s.scope]?this._removedLayers[s.scope][s.id]:null}discardLayerRemoval(s){this._removedLayers[s.scope]&&delete this._removedLayers[s.scope][s.id]}getLayerUpdatesByScope(){let s={};for(let c in this._updatedLayers)s[c]=s[c]||{},s[c].updatedIds=Array.from(this._updatedLayers[c].values());for(let c in this._removedLayers)s[c]=s[c]||{},s[c].removedIds=Object.keys(this._removedLayers[c]);return s}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(s){this._updatedPaintProps.add(s.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(s){this._updatedImages.add(r.I.toString(s)),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function Wt(m){let{userImage:s}=m;return!!(s&&s.render&&s.render())&&(m.data.replace(new Uint8Array(s.data.buffer)),!0)}class Cs extends r.E{constructor(s){super(),this._images={},this._iconsets={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.patternsInFlight=new Set,this.atlasImage={},this.atlasTexture={},this.dirty=!0,this.spriteFormat=s,s!=="raster"&&r.t()&&(this.imageRasterizerDispatcher=new r.D(r.x(),this,"Image Rasterizer Worker",1))}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new r.y),this._imageRasterizer}createScope(s){this._images[s]={},this._iconsets[s]={},this.loaded[s]=!1,this.updatedImages[s]=new Set,this.patterns[s]={},this.callbackDispatchedThisFrame[s]=new Set,this.atlasImage[s]=new r.r({width:1,height:1})}createIconset(s,c){this._iconsets[s][c]={}}isLoaded(){for(let s in this.loaded)if(!this.loaded[s])return!1;return!0}setLoaded(s,c){if(this.loaded[c]!==s&&(this.loaded[c]=s,s)){for(let{ids:f,callback:y}of this.requestors)this._notify(f,c,y);this.requestors=[]}}hasImage(s,c){return!!this.getImage(s,c)}getImage(s,c){return(s.iconsetId?this._iconsets[c][s.iconsetId]:this._images[c])[s.name]}addImage(s,c,f){let y=s.iconsetId?this._iconsets[c][s.iconsetId]:this._images[c];this._validate(s,f)&&(y[s.name]=f)}_validate(s,c){let f=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new r.z(new Error(`Image "${s.name}" has invalid "stretchX" value`))),f=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new r.z(new Error(`Image "${s.name}" has invalid "stretchY" value`))),f=!1),this._validateContent(c.content,c)||(this.fire(new r.z(new Error(`Image "${s.name}" has invalid "content" value`))),f=!1),f}_validateStretch(s,c){if(!s)return!0;let f=0;for(let y of s){if(y[0]<f||y[1]<y[0]||c<y[1])return!1;f=y[1]}return!0}_validateContent(s,c){return s?s.length!==4||!c.usvg&&(s[0]<0||c.data.width<s[0]||s[1]<0||c.data.height<s[1]||s[2]<0||c.data.width<s[2]||s[3]<0||c.data.height<s[3])?!1:!(s[2]<s[0]||s[3]<s[1]):!0}updateImage(s,c,f){let y=s.iconsetId?this._iconsets[c][s.iconsetId]:this._images[c];f.version=y[s.name].version+1,y[s.name]=f,this.updatedImages[c].add(s),this.removeFromImageRasterizerCache(s,c)}clearUpdatedImages(s){this.updatedImages[s].clear()}removeFromImageRasterizerCache(s,c){if(this.spriteFormat!=="raster")if(r.t()){let f={imageIds:[s],scope:c};this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",f)}else this.imageRasterizer.removeImagesFromCacheByIds([s],c)}removeImage(s,c){let f=s.iconsetId?this._iconsets[c][s.iconsetId]:this._images[c],y=f[s.name];delete f[s.name],delete this.patterns[c][s.name],this.removeFromImageRasterizerCache(s,c),y.userImage&&y.userImage.onRemove&&y.userImage.onRemove()}listImages(s){let c=[];for(let f of Object.keys(this._images[s]))c.push(new r.I(f));for(let f in this._iconsets[s])for(let y of Object.keys(this._iconsets[s][f]))c.push(new r.I({name:y,iconsetId:f}));return c}getImages(s,c,f){let y=!0,b=!!this.loaded[c];if(!b)for(let E of s)(E.iconsetId?this._iconsets[c][E.iconsetId]:this._images[c])[E.name]||(y=!1);b||y?this._notify(s,c,f):this.requestors.push({ids:s,scope:c,callback:f})}rasterizeImages({scope:s,tasks:c},f){let y=new Map;for(let[b,E]of c.entries()){let R=this.getImage(E.id,s);R&&y.set(b,{image:R,imageVariant:E})}this._rasterizeImages(s,y,f)}_rasterizeImages(s,c,f){if(r.t())this.imageRasterizerDispatcher.getActor().send("rasterizeImages",{tasks:c,scope:s},f);else{let y=new Map;for(let[b,{image:E,imageVariant:R}]of c.entries())y.set(b,this.imageRasterizer.rasterize(R,E,s,0));f(void 0,y)}}getUpdatedImages(s){return this.updatedImages[s]||new Set}_notify(s,c,f){let y=new Map;for(let b of s){b.iconsetId&&(this._iconsets[c][b.iconsetId]=this._iconsets[c][b.iconsetId]||{});let E=(b.iconsetId?this._iconsets[c][b.iconsetId]:this._images[c])[b.name];if(!E){if(b.iconsetId)continue;r.w(`Image "${b.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`),this.fire(new r.A("styleimagemissing",{id:b.name}));continue}let R={data:E.usvg?null:E.data.clone(),pixelRatio:E.pixelRatio,sdf:E.sdf,usvg:E.usvg,version:E.version,stretchX:E.stretchX,stretchY:E.stretchY,content:E.content,hasRenderCallback:!!(E.userImage&&E.userImage.render)};E.usvg&&Object.assign(R,{width:E.icon.usvg_tree.width,height:E.icon.usvg_tree.height}),y.set(r.I.toString(b),R)}f(null,y)}getPixelSize(s){let{width:c,height:f}=this.atlasImage[s];return{width:c,height:f}}getPattern(s,c,f){let y=this.patterns[c][s.name],b=this.getImage(s,c);if(!b)return null;if(y){if(y.position.version===b.version)return y.position;y.position.version=b.version}else{if(b.usvg&&!b.data){let E=this.getPatternInFlightId(s.toString(),c);if(this.patternsInFlight.has(E))return null;this.patternsInFlight.add(E);let R=new r.B(s).scaleSelf(r.q.devicePixelRatio),P=new Map([[R.toString(),{image:b,imageVariant:R}]]);return this._rasterizeImages(c,P,(L,F)=>this.storePatternImage(R,c,b,f,F)),null}this.storePattern(s,c,b)}return this._updatePatternAtlas(c,f),this.patterns[c][s.name].position}getPatternInFlightId(s,c){return r.C(s,c)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(s,c,f,y,b){let E=s.toString(),R=b?b.get(E):void 0;R&&(f.data=R,this.storePattern(s.id,c,f),this._updatePatternAtlas(c,y),this.patternsInFlight.delete(this.getPatternInFlightId(s.id.toString(),c)))}storePattern(s,c,f){let y={w:f.data.width+2*r.F,h:f.data.height+2*r.F,x:0,y:0},b=new r.G(y,f,r.F);this.patterns[c][s.name]={bin:y,position:b}}bind(s,c){let f=s.gl,y=this.atlasTexture[c];y?this.dirty&&(y.update(this.atlasImage[c]),this.dirty=!1):(y=new r.T(s,this.atlasImage[c],f.RGBA8),this.atlasTexture[c]=y),y.bind(f.LINEAR,f.CLAMP_TO_EDGE)}_updatePatternAtlas(s,c){let f=[];for(let R in this.patterns[s])f.push(this.patterns[s][R].bin);let{w:y,h:b}=r.H(f),E=this.atlasImage[s];E.resize({width:y||1,height:b||1});for(let R in this.patterns[s]){let{bin:P,position:L}=this.patterns[s][R],F=L.padding,j=P.x+F,U=P.y+F,W=this._images[s][R].data,ie=W.width,Q=W.height;F=F>1?F-1:F,r.r.copy(W,E,{x:0,y:0},{x:j,y:U},{width:ie,height:Q},c),r.r.copy(W,E,{x:0,y:Q-F},{x:j,y:U-F},{width:ie,height:F},c),r.r.copy(W,E,{x:0,y:0},{x:j,y:U+Q},{width:ie,height:F},c),r.r.copy(W,E,{x:ie-F,y:0},{x:j-F,y:U},{width:F,height:Q},c),r.r.copy(W,E,{x:0,y:0},{x:j+ie,y:U},{width:F,height:Q},c),r.r.copy(W,E,{x:ie-F,y:Q-F},{x:j-F,y:U-F},{width:F,height:F},c),r.r.copy(W,E,{x:0,y:Q-F},{x:j+ie,y:U-F},{width:F,height:F},c),r.r.copy(W,E,{x:0,y:0},{x:j+ie,y:U+Q},{width:F,height:F},c),r.r.copy(W,E,{x:ie-F,y:0},{x:j-F,y:U+Q},{width:F,height:F},c)}this.dirty=!0}beginFrame(){for(let s in this._images)this.callbackDispatchedThisFrame[s]=new Set}dispatchRenderCallbacks(s,c){for(let f of s){if(this.callbackDispatchedThisFrame[c].has(f.toString()))continue;this.callbackDispatchedThisFrame[c].add(f.toString());let y=(f.iconsetId?this._iconsets[c][f.iconsetId]:this._images[c])[f.name];Wt(y)&&this.updateImage(f,c,y)}}}function Ha(m){let s=m.key,c=m.value,f=m.valueSpec||{},y=m.objectElementValidators||{},b=m.style,E=m.styleSpec,R=[],P=r.K(c);if(P!=="object")return[new r.V(s,c,`object expected, ${P} found`)];for(let L in c){let F=L.split(".")[0],j;y[F]?j=y[F]:f[F]?j=wi:y["*"]?j=y["*"]:f["*"]&&(j=wi),j?R=R.concat(j({key:(s&&`${s}.`)+L,value:c[L],valueSpec:f[F]||f["*"],style:b,styleSpec:E,object:c,objectKey:L},c)):R.push(new r.J(s,c[L],`unknown property "${L}"`))}for(let L in f)y[L]||f[L].required&&f[L].default===void 0&&c[L]===void 0&&R.push(new r.V(s,c,`missing required property "${L}"`));return R}function Yl(m){let s=m.value,c=m.valueSpec,f=m.style,y=m.styleSpec,b=m.key,E=m.arrayElementValidator||wi;if(r.K(s)!=="array")return[new r.V(b,s,`array expected, ${r.K(s)} found`)];if(c.length&&s.length!==c.length)return[new r.V(b,s,`array length ${c.length} expected, length ${s.length} found`)];if(c["min-length"]&&s.length<c["min-length"])return[new r.V(b,s,`array length at least ${c["min-length"]} expected, length ${s.length} found`)];let R={type:c.value,values:c.values,minimum:c.minimum,maximum:c.maximum,function:void 0};y.$version<7&&(R.function=c.function),r.K(c.value)==="object"&&(R=c.value);let P=[];for(let L=0;L<s.length;L++)P=P.concat(E({array:s,arrayIndex:L,value:s[L],valueSpec:R,style:f,styleSpec:y,key:`${b}[${L}]`},!0));return P}function Mn(m){let s=m.key,c=m.value,f=m.valueSpec,y=r.K(c);if(y==="number"&&c!=c&&(y="NaN"),y!=="number")return[new r.V(s,c,`number expected, ${y} found`)];if("minimum"in f){let b=f.minimum;if(r.K(f.minimum)==="array"&&(b=f.minimum[m.arrayIndex]),c<b)return[new r.V(s,c,`${c} is less than the minimum value ${b}`)]}if("maximum"in f){let b=f.maximum;if(r.K(f.maximum)==="array"&&(b=f.maximum[m.arrayIndex]),c>b)return[new r.V(s,c,`${c} is greater than the maximum value ${b}`)]}return[]}function Ho(m){let s=m.valueSpec,c=r.M(m.value.type),f,y,b,E={},R=c!=="categorical"&&m.value.property===void 0,P=!R,L=r.K(m.value.stops)==="array"&&r.K(m.value.stops[0])==="array"&&r.K(m.value.stops[0][0])==="object",F=Ha({key:m.key,value:m.value,valueSpec:m.styleSpec.function,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{stops:function(W){if(c==="identity")return[new r.V(W.key,W.value,'identity function may not have a "stops" property')];let ie=[],Q=W.value;return ie=ie.concat(Yl({key:W.key,value:Q,valueSpec:W.valueSpec,style:W.style,styleSpec:W.styleSpec,arrayElementValidator:j})),r.K(Q)==="array"&&Q.length===0&&ie.push(new r.V(W.key,Q,"array must have at least one stop")),ie},default:function(W){return wi({key:W.key,value:W.value,valueSpec:s,style:W.style,styleSpec:W.styleSpec})}}});return c==="identity"&&R&&F.push(new r.V(m.key,m.value,'missing required property "property"')),c==="identity"||m.value.stops||F.push(new r.V(m.key,m.value,'missing required property "stops"')),c==="exponential"&&m.valueSpec.expression&&!r.N(m.valueSpec)&&F.push(new r.V(m.key,m.value,"exponential functions not supported")),m.styleSpec.$version>=8&&(P&&!r.O(m.valueSpec)?F.push(new r.V(m.key,m.value,"property functions not supported")):R&&!r.Q(m.valueSpec)&&F.push(new r.V(m.key,m.value,"zoom functions not supported"))),c!=="categorical"&&!L||m.value.property!==void 0||F.push(new r.V(m.key,m.value,'"property" property is required')),F;function j(W){let ie=[],Q=W.value,re=W.key;if(r.K(Q)!=="array")return[new r.V(re,Q,`array expected, ${r.K(Q)} found`)];if(Q.length!==2)return[new r.V(re,Q,`array length 2 expected, length ${Q.length} found`)];if(L){if(r.K(Q[0])!=="object")return[new r.V(re,Q,`object expected, ${r.K(Q[0])} found`)];if(Q[0].zoom===void 0)return[new r.V(re,Q,"object stop key must have zoom")];if(Q[0].value===void 0)return[new r.V(re,Q,"object stop key must have value")];let oe=r.M(Q[0].zoom);if(typeof oe!="number")return[new r.V(re,Q[0].zoom,"stop zoom values must be numbers")];if(b&&b>oe)return[new r.V(re,Q[0].zoom,"stop zoom values must appear in ascending order")];oe!==b&&(b=oe,y=void 0,E={}),ie=ie.concat(Ha({key:`${re}[0]`,value:Q[0],valueSpec:{zoom:{}},style:W.style,styleSpec:W.styleSpec,objectElementValidators:{zoom:Mn,value:U}}))}else ie=ie.concat(U({key:`${re}[0]`,value:Q[0],valueSpec:{},style:W.style,styleSpec:W.styleSpec},Q));return r.S(r.U(Q[1]))?ie.concat([new r.V(`${re}[1]`,Q[1],"expressions are not allowed in function stops.")]):ie.concat(wi({key:`${re}[1]`,value:Q[1],valueSpec:s,style:W.style,styleSpec:W.styleSpec}))}function U(W,ie){let Q=r.K(W.value),re=r.M(W.value),oe=W.value!==null?W.value:ie;if(f){if(Q!==f)return[new r.V(W.key,oe,`${Q} stop domain type must match previous stop domain type ${f}`)]}else f=Q;if(Q!=="number"&&Q!=="string"&&Q!=="boolean"&&typeof re!="number"&&typeof re!="string"&&typeof re!="boolean")return[new r.V(W.key,oe,"stop domain value must be a number, string, or boolean")];if(Q!=="number"&&c!=="categorical"){let me=`number expected, ${Q} found`;return r.O(s)&&c===void 0&&(me+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new r.V(W.key,oe,me)]}return c!=="categorical"||Q!=="number"||typeof re=="number"&&isFinite(re)&&Math.floor(re)===re?c!=="categorical"&&Q==="number"&&typeof re=="number"&&typeof y=="number"&&y!==void 0&&re<y?[new r.V(W.key,oe,"stop domain values must appear in ascending order")]:(y=re,c==="categorical"&&re in E?[new r.V(W.key,oe,"stop domain values must be unique")]:(E[re]=!0,[])):[new r.V(W.key,oe,`integer expected, found ${String(re)}`)]}}function zs(m){let s=(m.expressionContext==="property"?r.W:r.X)(r.U(m.value),m.valueSpec);if(s.result==="error")return s.value.map(f=>new r.V(`${m.key}${f.key}`,m.value,f.message));let c=s.value.expression||s.value._styleExpression.expression;if(m.expressionContext==="property"&&m.propertyKey==="text-font"&&!c.outputDefined())return[new r.V(m.key,m.value,`Invalid data expression for "${m.propertyKey}". Output values must be contained as literals within the expression.`)];if(m.expressionContext==="property"&&m.propertyType==="layout"&&!r.Y(c))return[new r.V(m.key,m.value,'"feature-state" data expressions are not supported with layout properties.')];if(m.expressionContext==="filter")return kc(c,m);if(m.expressionContext&&m.expressionContext.indexOf("cluster")===0){if(!r.Z(c,["zoom","feature-state"]))return[new r.V(m.key,m.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(m.expressionContext==="cluster-initial"&&!r._(c))return[new r.V(m.key,m.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function kc(m,s){let c=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(s.valueSpec&&s.valueSpec.expression)for(let y of s.valueSpec.expression.parameters)c.delete(y);if(c.size===0)return[];let f=[];return m instanceof r.$&&c.has(m.name)?[new r.V(s.key,s.value,`["${m.name}"] expression is not supported in a filter for a ${s.object.type} layer with id: ${s.object.id}`)]:(m.eachChild(y=>{f.push(...kc(y,s))}),f)}function Oc(m){let s=m.key,c=m.value,f=m.valueSpec,y=[];return Array.isArray(f.values)?f.values.indexOf(r.M(c))===-1&&y.push(new r.V(s,c,`expected one of [${f.values.join(", ")}], ${JSON.stringify(c)} found`)):Object.keys(f.values).indexOf(r.M(c))===-1&&y.push(new r.V(s,c,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(c)} found`)),y}function il(m){return r.a1(r.U(m.value))?zs(r.L({},m,{expressionContext:"filter",valueSpec:m.styleSpec[`filter_${m.layerType||"fill"}`]})):pn(m)}function pn(m){let s=m.value,c=m.key;if(r.K(s)!=="array")return[new r.V(c,s,`array expected, ${r.K(s)} found`)];let f=m.styleSpec,y,b=[];if(s.length<1)return[new r.V(c,s,"filter array must have at least 1 element")];switch(b=b.concat(Oc({key:`${c}[0]`,value:s[0],valueSpec:f.filter_operator,style:m.style,styleSpec:m.styleSpec})),r.M(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&r.M(s[1])==="$type"&&b.push(new r.V(c,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&b.push(new r.V(c,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(y=r.K(s[1]),y!=="string"&&b.push(new r.V(`${c}[1]`,s[1],`string expected, ${y} found`)));for(let E=2;E<s.length;E++)y=r.K(s[E]),r.M(s[1])==="$type"?b=b.concat(Oc({key:`${c}[${E}]`,value:s[E],valueSpec:f.geometry_type,style:m.style,styleSpec:m.styleSpec})):y!=="string"&&y!=="number"&&y!=="boolean"&&b.push(new r.V(`${c}[${E}]`,s[E],`string, number, or boolean expected, ${y} found`));break;case"any":case"all":case"none":for(let E=1;E<s.length;E++)b=b.concat(pn({key:`${c}[${E}]`,value:s[E],style:m.style,styleSpec:m.styleSpec}));break;case"has":case"!has":y=r.K(s[1]),s.length!==2?b.push(new r.V(c,s,`filter array for "${s[0]}" operator must have 2 elements`)):y!=="string"&&b.push(new r.V(`${c}[1]`,s[1],`string expected, ${y} found`))}return b}function Gr(m,s){let c=m.key,f=m.style,y=m.layer,b=m.styleSpec,E=m.value,R=m.objectKey,P=b[`${s}_${m.layerType}`];if(!P)return[];let L=R.match(/^(.*)-use-theme$/);if(s==="paint"&&L&&P[L[1]])return r.S(E)?[].concat(wi({key:m.key,value:E,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:f,styleSpec:b,expressionContext:"property",propertyType:s,propertyKey:R})):wi({key:c,value:E,valueSpec:{type:"string"},style:f,styleSpec:b});let F=R.match(/^(.*)-transition$/);if(s==="paint"&&F&&P[F[1]]&&P[F[1]].transition)return wi({key:c,value:E,valueSpec:b.transition,style:f,styleSpec:b});let j=m.valueSpec||P[R];if(!j)return[new r.J(c,E,`unknown property "${R}"`)];let U;if(r.K(E)==="string"&&r.O(j)&&!j.tokens&&(U=/^{([^}]+)}$/.exec(E))){let ie=`\`{ "type": "identity", "property": ${U?JSON.stringify(U[1]):'"_"'} }\``;return[new r.V(c,E,`"${R}" does not support interpolation syntax
Use an identity property function instead: ${ie}.`)]}let W=[];if(m.layerType==="symbol")R!=="text-field"||!f||f.glyphs||f.imports||W.push(new r.V(c,E,'use of "text-field" requires a style "glyphs" property')),R==="text-font"&&r.a2(r.U(E))&&r.M(E.type)==="identity"&&W.push(new r.V(c,E,'"text-font" does not support identity functions'));else if(m.layerType==="model"&&s==="paint"&&y&&y.layout&&y.layout.hasOwnProperty("model-id")&&r.O(j)&&(r.a3(j)||r.Q(j))){let ie=r.W(r.U(E),j),Q=ie.value.expression||ie.value._styleExpression.expression;Q&&!r.Z(Q,["measure-light"])&&(R==="model-emissive-strength"&&r._(Q)&&r.Y(Q)||W.push(new r.V(c,E,`${R} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return W.concat(wi({key:m.key,value:E,valueSpec:j,style:f,styleSpec:b,expressionContext:"property",propertyType:s,propertyKey:R}))}function hu(m){return Gr(m,"paint")}function Cr(m){return Gr(m,"layout")}function Da(m){let s=[],c=m.value,f=m.key,y=m.style,b=m.styleSpec;c.type||c.ref||s.push(new r.V(f,c,'either "type" or "ref" is required'));let E=r.M(c.type),R=r.M(c.ref);if(c.id){let P=r.M(c.id);for(let L=0;L<m.arrayIndex;L++){let F=y.layers[L];r.M(F.id)===P&&s.push(new r.V(f,c.id,`duplicate layer id "${c.id}", previously used at line ${F.id.__line__}`))}}if("ref"in c){let P;["type","source","source-layer","filter","layout"].forEach(L=>{L in c&&s.push(new r.V(f,c[L],`"${L}" is prohibited for ref layers`))}),y.layers.forEach(L=>{r.M(L.id)===R&&(P=L)}),P?P.ref?s.push(new r.V(f,c.ref,"ref cannot reference another ref layer")):E=r.M(P.type):typeof R=="string"&&s.push(new r.V(f,c.ref,`ref layer "${R}" not found`))}else if(E!=="background"&&E!=="sky"&&E!=="slot")if(c.source){let P=y.sources&&y.sources[c.source],L=P&&r.M(P.type);P?L==="vector"&&E==="raster"?s.push(new r.V(f,c.source,`layer "${c.id}" requires a raster source`)):L==="raster"&&E!=="raster"?s.push(new r.V(f,c.source,`layer "${c.id}" requires a vector source`)):L!=="vector"||c["source-layer"]?L==="raster-dem"&&E!=="hillshade"?s.push(new r.V(f,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):L!=="raster-array"||["raster","raster-particle"].includes(E)?E!=="line"||!c.paint||!c.paint["line-gradient"]&&!c.paint["line-trim-offset"]||L==="geojson"&&P.lineMetrics?E==="raster-particle"&&L!=="raster-array"&&s.push(new r.V(f,c.source,`layer "${c.id}" requires a 'raster-array' source.`)):s.push(new r.V(f,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new r.V(f,c.source,"raster-array source can only be used with layer type 'raster'.")):s.push(new r.V(f,c,`layer "${c.id}" must specify a "source-layer"`)):s.push(new r.V(f,c.source,`source "${c.source}" not found`))}else s.push(new r.V(f,c,'missing required property "source"'));return s=s.concat(Ha({key:f,value:c,valueSpec:b.layer,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{"*":()=>[],type:()=>wi({key:`${f}.type`,value:c.type,valueSpec:b.layer.type,style:m.style,styleSpec:m.styleSpec,object:c,objectKey:"type"}),filter:P=>il(r.L({layerType:E},P)),layout:P=>Ha({layer:c,key:P.key,value:P.value,valueSpec:{},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":L=>Cr(r.L({layerType:E},L))}}),paint:P=>Ha({layer:c,key:P.key,value:P.value,valueSpec:{},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":L=>hu(r.L({layerType:E,layer:c},L))}})}})),s}function Kl(m){let s=m.value,c=m.key,f=r.K(s);return f!=="string"?[new r.V(c,s,`string expected, ${f} found`)]:[]}let Xl={promoteId:function m({key:s,value:c}){if(r.K(c)==="string")return Kl({key:s,value:c});if(Array.isArray(c)){let f=[],y=r.U(c),b=r.X(y);return b.result==="error"&&b.value.forEach(E=>{f.push(new r.V(`${s}${E.key}`,null,`${E.message}`))}),r.Z(b.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||f.push(new r.V(`${s}`,null,"promoteId expression should be only feature dependent")),f}{let f=[];for(let y in c)f.push(...m({key:`${s}.${y}`,value:c[y]}));return f}}};function Jd(m){let s=m.value,c=m.key,f=m.styleSpec,y=m.style;if(!s.type)return[new r.V(c,s,'"type" is required')];let b=r.M(s.type),E=[];switch(["vector","raster","raster-dem","raster-array"].includes(b)&&(s.url||s.tiles||E.push(new r.J(c,s,'Either "url" or "tiles" is required.'))),b){case"vector":case"raster":case"raster-dem":case"raster-array":return E=E.concat(Ha({key:c,value:s,valueSpec:f[`source_${b.replace("-","_")}`],style:m.style,styleSpec:f,objectElementValidators:Xl})),E;case"geojson":if(E=Ha({key:c,value:s,valueSpec:f.source_geojson,style:y,styleSpec:f,objectElementValidators:Xl}),s.cluster)for(let R in s.clusterProperties){let[P,L]=s.clusterProperties[R],F=typeof P=="string"?[P,["accumulated"],["get",R]]:P;E.push(...zs({key:`${c}.${R}.map`,value:L,expressionContext:"cluster-map"})),E.push(...zs({key:`${c}.${R}.reduce`,value:F,expressionContext:"cluster-reduce"}))}return E;case"video":return Ha({key:c,value:s,valueSpec:f.source_video,style:y,styleSpec:f});case"image":return Ha({key:c,value:s,valueSpec:f.source_image,style:y,styleSpec:f});case"canvas":return[new r.V(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Oc({key:`${c}.type`,value:s.type,valueSpec:{values:eh(f)},style:y,styleSpec:f})}}function eh(m){return m.source.reduce((s,c)=>{let f=m[c];return f.type.type==="enum"&&(s=s.concat(Object.keys(f.type.values))),s},[])}function Pc(m){let s=m.value,c=m.styleSpec,f=c.light,y=m.style,b=[],E=r.K(s);if(s===void 0)return b;if(E!=="object")return b=b.concat([new r.V("light",s,`object expected, ${E} found`)]),b;for(let R in s){let P=R.match(/^(.*)-transition$/),L=R.match(/^(.*)-use-theme$/);b=b.concat(L&&f[L[1]]?wi({key:R,value:s[R],valueSpec:{type:"string"},style:y,styleSpec:c}):P&&f[P[1]]&&f[P[1]].transition?wi({key:R,value:s[R],valueSpec:c.transition,style:y,styleSpec:c}):f[R]?wi({key:R,value:s[R],valueSpec:f[R],style:y,styleSpec:c}):[new r.V(R,s[R],`unknown property "${R}"`)])}return b}function pu(m){let s=m.value,c=[];if(!s)return c;let f=r.K(s);if(f!=="object")return c=c.concat([new r.V("light-3d",s,`object expected, ${f} found`)]),c;let y=m.styleSpec,b=y["light-3d"],E=m.key,R=m.style,P=m.style.lights;for(let j of["type","id"])if(!(j in s))return c=c.concat([new r.V("light-3d",s,`missing property ${j} on light`)]),c;if(s.type&&P)for(let j=0;j<m.arrayIndex;j++){let U=r.M(s.type),W=P[j];r.M(W.type)===U&&c.push(new r.V(E,s.id,`duplicate light type "${s.type}", previously defined at line ${W.id.__line__}`))}let L=`properties_light_${s.type}`;if(!(L in y))return c=c.concat([new r.V("light-3d",s,`Invalid light type ${s.type}`)]),c;let F=y[L];for(let j in s)if(j==="properties"){let U=s[j],W=r.K(U);if(W!=="object")return c=c.concat([new r.V("properties",U,`object expected, ${W} found`)]),c;for(let ie in U)c=c.concat(F[ie]?wi({key:ie,value:U[ie],valueSpec:F[ie],style:R,styleSpec:y}):[new r.J(m.key,U[ie],`unknown property "${ie}"`)])}else{let U=j.match(/^(.*)-transition$/),W=j.match(/^(.*)-use-theme$/);c=c.concat(W&&b[W[1]]?wi({key:j,value:s[j],valueSpec:{type:"string"},style:R,styleSpec:y}):U&&b[U[1]]&&b[U[1]].transition?wi({key:j,value:s[j],valueSpec:y.transition,style:R,styleSpec:y}):b[j]?wi({key:j,value:s[j],valueSpec:b[j],style:R,styleSpec:y}):[new r.J(j,s[j],`unknown property "${j}"`)])}return c}function Zn(m){let s=m.value,c=m.key,f=m.style,y=m.styleSpec,b=y.terrain,E=[],R=r.K(s);if(s===void 0||R==="null")return E;if(R!=="object")return E=E.concat([new r.V("terrain",s,`object expected, ${R} found`)]),E;for(let P in s){let L=P.match(/^(.*)-transition$/),F=P.match(/^(.*)-use-theme$/);E=E.concat(F&&b[F[1]]?wi({key:P,value:s[P],valueSpec:{type:"string"},style:f,styleSpec:y}):L&&b[L[1]]&&b[L[1]].transition?wi({key:P,value:s[P],valueSpec:y.transition,style:f,styleSpec:y}):b[P]?wi({key:P,value:s[P],valueSpec:b[P],style:f,styleSpec:y}):[new r.J(P,s[P],`unknown property "${P}"`)])}if(s.source){let P=f.sources&&f.sources[s.source],L=P&&r.M(P.type);P?L!=="raster-dem"&&E.push(new r.V(c,s.source,`terrain cannot be used with a source of type ${String(L)}, it only be used with a "raster-dem" source type`)):E.push(new r.V(c,s.source,`source "${s.source}" not found`))}else E.push(new r.V(c,s,'terrain is missing required property "source"'));return E}function ci(m){let s=m.value,c=m.style,f=m.styleSpec,y=f.fog,b=[],E=r.K(s);if(s===void 0)return b;if(E!=="object")return b=b.concat([new r.V("fog",s,`object expected, ${E} found`)]),b;for(let R in s){let P=R.match(/^(.*)-transition$/),L=R.match(/^(.*)-use-theme$/);b=b.concat(L&&y[L[1]]?wi({key:R,value:s[R],valueSpec:{type:"string"},style:c,styleSpec:f}):P&&y[P[1]]&&y[P[1]].transition?wi({key:R,value:s[R],valueSpec:f.transition,style:c,styleSpec:f}):y[R]?wi({key:R,value:s[R],valueSpec:y[R],style:c,styleSpec:f}):[new r.J(R,s[R],`unknown property "${R}"`)])}return b}let Gt={"*":()=>[],array:Yl,boolean:function(m){let s=m.value,c=m.key,f=r.K(s);return f!=="boolean"?[new r.V(c,s,`boolean expected, ${f} found`)]:[]},number:Mn,color:function(m){let s=m.key,c=m.value,f=r.K(c);return f!=="string"?[new r.V(s,c,`color expected, ${f} found`)]:r.a0.parseCSSColor(c)===null?[new r.V(s,c,`color expected, "${c}" found`)]:[]},enum:Oc,filter:il,function:Ho,layer:Da,object:Ha,source:Jd,model:r.a4,light:Pc,"light-3d":pu,terrain:Zn,fog:ci,string:Kl,formatted:function(m){return Kl(m).length===0?[]:zs(m)},resolvedImage:function(m){return Kl(m).length===0?[]:zs(m)},projection:function(m){let s=m.value,c=m.styleSpec,f=c.projection,y=m.style,b=[],E=r.K(s);if(E==="object")for(let R in s)b=b.concat(wi({key:R,value:s[R],valueSpec:f[R],style:y,styleSpec:c}));else E!=="string"&&(b=b.concat([new r.V("projection",s,`object or string expected, ${E} found`)]));return b},import:function(m){let{value:s,styleSpec:c}=m,E=s,{data:f}=E,y=Ys(E,["data"]);Object.defineProperty(y,"__line__",{value:s.__line__,enumerable:!1});let b=Ha(r.L({},m,{value:y,valueSpec:c.import}));return r.M(y.id)===""&&b.push(new r.V(`${m.key}.id`,y,"import id can't be an empty string")),f&&(b=b.concat(Wr(f,c,{key:`${m.key}.data`}))),b},iconset:function(m){let s=m.value,c=m.key,f=m.styleSpec,y=m.style;if(!s.type)return[new r.V(c,s,'"type" is required')];let b=r.M(s.type),E=[];if(E=E.concat(Ha({key:c,value:s,valueSpec:f[`iconset_${b}`],style:y,styleSpec:f})),b==="source"&&s.source){let R=y.sources&&y.sources[s.source],P=R&&r.M(R.type);R?P!=="raster-array"&&E.push(new r.V(c,s.source,`iconset cannot be used with a source of type ${String(P)}, it only be used with a "raster-array" source type`)):E.push(new r.V(c,s.source,`source "${s.source}" not found`))}return E}};function wi(m,s=!1){let c=m.value,f=m.valueSpec,y=m.styleSpec;if(f.expression&&r.a2(r.M(c)))return Ho(m);if(f.expression&&r.S(r.U(c)))return zs(m);if(f.type&&Gt[f.type]){let b=Gt[f.type](m);return s===!0&&b.length>0&&r.K(m.value)==="array"?zs(m):b}return Ha(r.L({},m,{valueSpec:f.type?y[f.type]:f}))}function nn(m){let s=m.value,c=m.key,f=Kl(m);return f.length||(s.indexOf("{fontstack}")===-1&&f.push(new r.V(c,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&f.push(new r.V(c,s,'"glyphs" url must include a "{range}" token'))),f}function Wr(m,s=r.a5,c={}){return wi({key:c.key||"",value:m,valueSpec:s.$root,styleSpec:s,style:m,objectElementValidators:{glyphs:nn,"*":()=>[]}})}function Pi(m,s=r.a5){return je(Wr(m,s))}let Bs=m=>je(Jd(m)),nl=m=>je(Pc(m)),rl=m=>je(pu(m)),ol=m=>je(Zn(m)),Ma=m=>je(ci(m)),fu=m=>je(function(s){let c=s.value,f=s.style,y=s.styleSpec,b=y.snow,E=[],R=r.K(c);if(c===void 0)return E;if(R!=="object")return E=E.concat([new r.V("snow",c,`object expected, ${R} found`)]),E;for(let P in c){let L=P.match(/^(.*)-transition$/);E=E.concat(L&&b[L[1]]&&b[L[1]].transition?wi({key:P,value:c[P],valueSpec:y.transition,style:f,styleSpec:y}):b[P]?wi({key:P,value:c[P],valueSpec:b[P],style:f,styleSpec:y}):[new r.J(P,c[P],`unknown property "${P}"`)])}return E}(m)),mt=m=>je(function(s){let c=s.value,f=s.style,y=s.styleSpec,b=y.rain,E=[],R=r.K(c);if(c===void 0)return E;if(R!=="object")return E=E.concat([new r.V("rain",c,`object expected, ${R} found`)]),E;for(let P in c){let L=P.match(/^(.*)-transition$/);E=E.concat(L&&b[L[1]]&&b[L[1]].transition?wi({key:P,value:c[P],valueSpec:y.transition,style:f,styleSpec:y}):b[P]?wi({key:P,value:c[P],valueSpec:b[P],style:f,styleSpec:y}):[new r.J(P,c[P],`unknown property "${P}"`)])}return E}(m)),Y=m=>je(Da(m)),ue=m=>je(il(m)),Te=m=>je(hu(m)),Ne=m=>je(Cr(m)),ze=m=>je(r.a4(m));function je(m){return m.slice().sort((s,c)=>s.line&&c.line?s.line-c.line:0)}function st(m,s){let c=!1;if(s&&s.length)for(let f of s)f instanceof r.J?r.w(f.message):(m.fire(new r.z(new Error(f.message))),c=!0);return c}let Ge;class at extends r.E{constructor(s,c="flat"){super(),this._transitionable=new r.a6(Ge||(Ge=new r.a7({anchor:new r.a8(r.a5.light.anchor),position:new r.a9(r.a5.light.position),color:new r.a8(r.a5.light.color),intensity:new r.a8(r.a5.light.intensity)}))),this.setLight(s,c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,c,f={}){this._validate(nl,s,f)||(this._transitionable.setTransitionOrValue(s),this.id=c)}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,c,f){return(!f||f.validate!==!1)&&st(this,s.call(Pi,r.l({value:c,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}}let gt=class extends r.E{constructor(m,s,c,f){super(),this.scope=c,this._transitionable=new r.a6(new r.a7({source:new r.a8(r.a5.terrain.source),exaggeration:new r.a8(r.a5.terrain.exaggeration)}),c,f),this._transitionable.setTransitionOrValue(m,f),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=s}get(){return this._transitionable.serialize()}set(m,s){this._transitionable.setTransitionOrValue(m,s)}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}getExaggeration(m){return this._transitioning.possiblyEvaluate(new r.aa(m)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;let m=this._transitionable._values.exaggeration;if(!m)return null;let s=m.value.expression;if(!s)return null;let c=-1,f=-1,y=1;for(let b of s.zoomStops)y=s.evaluate(new r.aa(b)),y>.01?(c=b,f=-1):f=b;return y<.01&&c>0&&f>c?[c,f]:null}isZoomDependent(){let m=this._transitionable._values.exaggeration;return m!=null&&m.value!=null&&m.value.expression!=null&&m.value.expression instanceof r.ab}},ft=45,Bt=65,Yt=.05;function ei(m,s,c,f){let y=r.ae(ft,Bt,c),[b,E]=Dt(m,f),R=1-Math.min(1,Math.exp((s-b)/(E-b)*-6));return R*=R*R,R=Math.min(1,1.00747*R),R*y*m.alpha}function Dt(m,s){let c=.5/Math.tan(.5*s);return[m.range[0]+c,m.range[1]+c]}function Zi(m,s,c,f,y){let b=r.ad.vec3.transformMat4([],[s,c,f],y.mercatorFogMatrix);return ei(m,r.ad.vec3.length(b),y.pitch,y._fov)}function Yi(m,s,c,f,y,b,E){let R=[[c,f,0],[y,f,0],[y,b,0],[c,b,0]],P=Number.MAX_VALUE,L=-Number.MAX_VALUE;for(let F of R){let j=r.ad.vec3.transformMat4([],F,s),U=r.ad.vec3.length(j);P=Math.min(P,U),L=Math.max(L,U)}return[ei(m,P,E.pitch,E._fov),ei(m,L,E.pitch,E._fov)]}class Ke extends r.E{constructor(s,c,f,y){super();let b=new r.a7({range:new r.a8(r.a5.fog.range),color:new r.a8(r.a5.fog.color),"color-use-theme":new r.a8({type:"string","property-type":"data-constant",default:"default"}),"high-color":new r.a8(r.a5.fog["high-color"]),"high-color-use-theme":new r.a8({type:"string","property-type":"data-constant",default:"default"}),"space-color":new r.a8(r.a5.fog["space-color"]),"space-color-use-theme":new r.a8({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new r.a8(r.a5.fog["horizon-blend"]),"star-intensity":new r.a8(r.a5.fog["star-intensity"]),"vertical-range":new r.a8(r.a5.fog["vertical-range"])});this._transitionable=new r.a6(b,f,new Map(y)),this.set(s,y),this._transitioning=this._transitionable.untransitioned(),this._transform=c,this.properties=new r.af(b),this.scope=f}get state(){let s=this._transform,c=s.projection.name==="globe",f=r.ag(s.zoom),y=this.properties.get("range"),b=[.5,3];return{range:c?[r.ah(b[0],y[0],f),r.ah(b[1],y[1],f)]:y,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(s,c,f={}){if(this._validate(Ma,s,f))return;let y=r.l({},s);for(let b of Object.keys(r.a5.fog))y[b]===void 0&&(y[b]=r.a5.fog[b].default);this._options=y,this._transitionable.setTransitionOrValue(this._options,c)}getOpacity(s){if(!this._transform.projection.supportsFog)return 0;let c=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:r.ae(ft,Bt,s))*c.a}getOpacityAtLatLng(s,c){return this._transform.projection.supportsFog?function(f,y,b){let E=r.ac.fromLngLat(y),R=b.elevation?b.elevation.getAtPointOrZero(E):0;return Zi(f,E.x,E.y,R,b)}(this.state,s,c):0}getOpacityForTile(s){if(!this._transform.projection.supportsFog)return[1,1];let c=this._transform.calculateFogTileMatrix(s.toUnwrapped());return Yi(this.state,c,0,0,r.ai,r.ai,this._transform)}getOpacityForBounds(s,c,f,y,b){return this._transform.projection.supportsFog?Yi(this.state,s,c,f,y,b,this._transform):[1,1]}getFovAdjustedRange(s){return this._transform.projection.supportsFog?Dt(this.state,s):[0,1]}isVisibleOnFrustum(s){if(!this._transform.projection.supportsFog)return!1;let c=[4,5,6,7];for(let f of c){let y=s.points[f],b;if(y[2]>=0)b=y;else{let E=s.points[f-4];b=r.aj(E,y,E[2]/(E[2]-y[2]))}if(Zi(this.state,b[0],b[1],0,this._transform)>=Yt)return!0}return!1}updateConfig(s){this._transitionable.setTransitionOrValue(this._options,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,c,f){return(!f||f.validate!==!1)&&st(this,s.call(Pi,r.l({value:c,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}}let Gi,Sr,gn,Rn,Un=class extends r.E{constructor(m,s,c,f){super();let y=Gi||(Gi=new r.a7({density:new r.a8(r.a5.snow.density),intensity:new r.a8(r.a5.snow.intensity),color:new r.a8(r.a5.snow.color),opacity:new r.a8(r.a5.snow.opacity),vignette:new r.a8(r.a5.snow.vignette),"vignette-color":new r.a8(r.a5.snow["vignette-color"]),"center-thinning":new r.a8(r.a5.snow["center-thinning"]),direction:new r.a8(r.a5.snow.direction),"flake-size":new r.a8(r.a5.snow["flake-size"])}));this._transitionable=new r.a6(y,c,new Map(f)),this.set(m,f),this._transitioning=this._transitionable.untransitioned(),this.properties=new r.af(y),this.scope=c}get state(){let m=this.properties.get("opacity"),s=this.properties.get("color"),c=this.properties.get("direction"),f=r.ak(c[0]),y=-Math.max(r.ak(c[1]),.01),b=[Math.cos(f)*Math.cos(y),Math.sin(f)*Math.cos(y),Math.sin(y)],E=this.properties.get("vignette"),R=this.properties.get("vignette-color");return R.a=E,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new r.al(s.r,s.g,s.b,s.a*m),direction:b,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:R}}get(){return this._transitionable.serialize()}set(m,s,c={}){if(this._validate(fu,m,c))return;let f=r.l({},m);for(let y of Object.keys(r.a5.snow))f[y]===void 0&&(f[y]=r.a5.snow[y].default);this._options=f,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(m){this._transitionable.setTransitionOrValue(this._options,new Map(m))}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}_validate(m,s,c){return(!c||c.validate!==!1)&&st(this,m.call(Pi,r.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}},dn=class extends r.E{constructor(m,s,c,f){super();let y=Sr||(Sr=new r.a7({density:new r.a8(r.a5.rain.density),intensity:new r.a8(r.a5.rain.intensity),color:new r.a8(r.a5.rain.color),opacity:new r.a8(r.a5.rain.opacity),vignette:new r.a8(r.a5.rain.vignette),"vignette-color":new r.a8(r.a5.rain["vignette-color"]),"center-thinning":new r.a8(r.a5.rain["center-thinning"]),direction:new r.a8(r.a5.rain.direction),"droplet-size":new r.a8(r.a5.rain["droplet-size"]),"distortion-strength":new r.a8(r.a5.rain["distortion-strength"])}));this._transitionable=new r.a6(y,c,new Map(f)),this.set(m,f),this._transitioning=this._transitionable.untransitioned(),this.properties=new r.af(y),this.scope=c}get state(){let m=this.properties.get("opacity"),s=this.properties.get("color"),c=this.properties.get("direction"),f=r.ak(c[0]),y=-Math.max(r.ak(c[1]),.01),b=[Math.cos(f)*Math.cos(y),Math.sin(f)*Math.cos(y),Math.sin(y)],E=this.properties.get("vignette-color");return E.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new r.al(s.r,s.g,s.b,s.a*m),direction:b,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:E}}get(){return this._transitionable.serialize()}set(m,s,c={}){if(this._validate(mt,m,c))return;let f=r.l({},m);for(let y of Object.keys(r.a5.rain))f[y]===void 0&&(f[y]=r.a5.rain[y].default);this._options=f,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(m){this._transitionable.setTransitionOrValue(this._options,new Map(m))}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}_validate(m,s,c){return(!c||c.validate!==!1)&&st(this,m.call(Pi,r.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}};class Jr extends r.E{constructor(s,c,f,y){super(),this.scope=f,this._options=s,this.properties=new r.af(c),this._transitionable=new r.a6(c,f,new Map(y)),this._transitionable.setTransitionOrValue(s.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(s){this._transitionable.setTransitionOrValue(this._options.properties,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(s,c){this._options=s,this._transitionable.setTransitionOrValue(s.properties,c)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Co{constructor(s,c,f,y){this.screenBounds=s,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=f,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,y)}static createFromScreenPoints(s,c){let f,y;if(s instanceof r.P||typeof s[0]=="number"){let b=r.P.convert(s);f=[b],y=c.isPointAboveHorizon(b)}else{let b=r.P.convert(s[0]),E=r.P.convert(s[1]);f=[b,E],y=r.an(b,E).every(R=>c.isPointAboveHorizon(R))}return new Co(f,c.getCameraPoint(),y,c)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(s){return r.an(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],s)}bufferedCameraGeometry(s){let c=this.screenBounds[0],f=this.screenBounds.length===1?this.screenBounds[0].add(new r.P(1,1)):this.screenBounds[1],y=r.an(c,f,0,!1);return this.cameraPoint.y>f.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<f.x?y.splice(3,0,this.cameraPoint):this.cameraPoint.x>=f.x?y[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(y[3]=this.cameraPoint)),r.ao(y,s)}bufferedCameraGeometryGlobe(s){let c=this.screenBounds[0],f=this.screenBounds.length===1?this.screenBounds[0].add(new r.P(1,1)):this.screenBounds[1],y=r.an(c,f,s),b=this.cameraPoint.clone();switch(3*((b.y>c.y)+(b.y>f.y))+((b.x>c.x)+(b.x>f.x))){case 0:y[0]=b,y[4]=b.clone();break;case 1:y.splice(1,0,b);break;case 2:y[1]=b;break;case 3:y.splice(4,0,b);break;case 5:y.splice(2,0,b);break;case 6:y[3]=b;break;case 7:y.splice(3,0,b);break;case 8:y[2]=b}return y}containsTile(s,c,f,y=0){let b=s.queryPadding/c._pixelsPerMercatorPixel+1,E=f?this._bufferedCameraMercator(b,c):this._bufferedScreenMercator(b,c),R=s.tileID.wrap+(E.unwrapped?y:0),P=E.polygon.map(re=>r.ap(s.tileTransform,re,R));if(!r.aq(P,0,0,r.ai,r.ai))return;R=s.tileID.wrap+(this.screenGeometryMercator.unwrapped?y:0);let L=this.screenGeometryMercator.polygon.map(re=>r.ar(s.tileTransform,re,R)),F=L.map(re=>new r.P(re[0],re[1])),j=c.getFreeCameraOptions().position||new r.ac(0,0,0),U=r.ar(s.tileTransform,j,R),W=L.map(re=>{let oe=r.ad.vec3.sub(re,re,U);return r.ad.vec3.normalize(oe,oe),new r.as(U,oe)}),ie=r.at(s,1,c.zoom)*c._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:F,tilespaceRays:W,bufferedTilespaceGeometry:P,bufferedTilespaceBounds:(Q=r.au(P),Q.min.x=r.ay(Q.min.x,0,r.ai),Q.min.y=r.ay(Q.min.y,0,r.ai),Q.max.x=r.ay(Q.max.x,0,r.ai),Q.max.y=r.ay(Q.max.y,0,r.ai),Q),tile:s,tileID:s.tileID,pixelToTileUnitsFactor:ie};var Q}_bufferedScreenMercator(s,c){let f=So(s);if(this._screenRaycastCache[f])return this._screenRaycastCache[f];{let y;return y=c.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(s),c):{polygon:this.bufferedScreenGeometry(s).map(b=>c.pointCoordinate3D(b)),unwrapped:!0},this._screenRaycastCache[f]=y,y}}_bufferedCameraMercator(s,c){let f=So(s);if(this._cameraRaycastCache[f])return this._cameraRaycastCache[f];{let y;return y=c.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(s),c):{polygon:this.bufferedCameraGeometry(s).map(b=>c.pointCoordinate3D(b)),unwrapped:!0},this._cameraRaycastCache[f]=y,y}}_projectAndResample(s,c){let f=function(b,E){let R=r.ad.mat4.multiply([],E.pixelMatrix,E.globeMatrix),P=[0,-r.az,0,1],L=[0,r.az,0,1],F=[0,0,0,1];r.ad.vec4.transformMat4(P,P,R),r.ad.vec4.transformMat4(L,L,R),r.ad.vec4.transformMat4(F,F,R);let j=new r.P(P[0]/P[3],P[1]/P[3]),U=new r.P(L[0]/L[3],L[1]/L[3]),W=r.aw(b,j)&&P[3]<F[3],ie=r.aw(b,U)&&L[3]<F[3];if(!W&&!ie)return null;let Q=function(Ae,Re,Ve){for(let qe=1;qe<Ae.length;qe++){let dt=Ei(Re.pointCoordinate3D(Ae[qe-1]).x),nt=Ei(Re.pointCoordinate3D(Ae[qe]).x);if(Ve<0){if(dt<nt)return{idx:qe,t:-dt/(nt-1-dt)}}else if(nt<dt)return{idx:qe,t:(1-dt)/(nt+1-dt)}}return null}(b,E,W?-1:1);if(!Q)return null;let{idx:re,t:oe}=Q,me=re>1?ua(b.slice(0,re),E):[],Me=re<b.length?ua(b.slice(re),E):[];me=me.map(Ae=>new r.P(Ei(Ae.x),Ae.y)),Me=Me.map(Ae=>new r.P(Ei(Ae.x),Ae.y));let Ee=[...me];Ee.length===0&&Ee.push(Me[Me.length-1]);let Le=r.ah(Ee[Ee.length-1].y,(Me.length===0?me[0]:Me[0]).y,oe),Ie;return Ie=W?[new r.P(0,Le),new r.P(0,0),new r.P(1,0),new r.P(1,Le)]:[new r.P(1,Le),new r.P(1,1),new r.P(0,1),new r.P(0,Le)],Ee.push(...Ie),Me.length===0?Ee.push(me[0]):Ee.push(...Me),{polygon:Ee.map(Ae=>new r.ac(Ae.x,Ae.y)),unwrapped:!1}}(s,c);if(f)return f;let y=function(b,E){let R=!1,P=-1/0,L=0;for(let j=0;j<b.length-1;j++)b[j].x>P&&(P=b[j].x,L=j);for(let j=0;j<b.length-1;j++){let U=(L+j)%(b.length-1),W=b[U],ie=b[U+1];Math.abs(W.x-ie.x)>.5&&(W.x<ie.x?(W.x+=1,U===0&&(b[b.length-1].x+=1)):(ie.x+=1,U+1===b.length-1&&(b[0].x+=1)),R=!0)}let F=r.av(E.center.lng);return R&&F<Math.abs(F-1)&&b.forEach(j=>{j.x-=1}),{polygon:b,unwrapped:R}}(ua(s,c).map(b=>new r.P(Ei(b.x),b.y)),c);return{polygon:y.polygon.map(b=>new r.ac(b.x,b.y)),unwrapped:y.unwrapped}}}function ua(m,s){return r.ax(m,c=>{let f=s.pointCoordinate3D(c);c.x=f.x,c.y=f.y},1/256)}function Ei(m){return m<0?1+m%1:m%1}function So(m){return 100*m|0}function lo(m,s,c,f,y){let b=function(R,P){if(R)return y(R);if(P){if(m.url&&P.tiles&&m.tiles&&delete m.tiles,P.variants){if(!Array.isArray(P.variants))return y(new Error("variants must be an array"));for(let F of P.variants){if(F==null||typeof F!="object"||F.constructor!==Object)return y(new Error("variant must be an object"));if(!Array.isArray(F.capabilities))return y(new Error("capabilities must be an array"));if(F.capabilities.length===1&&F.capabilities[0]==="meshopt"){P=r.l(P,F);break}}}let L=r.aA(r.l({},P,m),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);L.tiles=s.canonicalizeTileset(L,m.url),y(null,L)}},E=function(R,P,L){if(!R)return null;if(!P&&!L)return R;L=L||R.worldview_default;let F=Object.values(R.language||{});if(F.length===0)return null;let j=Object.values(R.worldview||{});if(j.length===0)return null;let U=F.every(ie=>ie===P),W=j.every(ie=>ie===L);return U&&W?R:P in(R.language_options||{})||L in(R.worldview_options||{})?null:R.language_options&&R.worldview_options?R:null}(m.data,c,f);return E?r.q.frame(()=>b(null,E)):m.url?r.n(s.transformRequest(s.normalizeSourceURL(m.url,null,c,f),r.R.Source),b):r.q.frame(()=>{let L=m,{data:R}=L,P=Ys(L,["data"]);b(null,P)})}class No{constructor(s,c,f){this.bounds=r.aB.convert(this.validateBounds(s)),this.minzoom=c||0,this.maxzoom=f||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){let c=Math.pow(2,s.z),f=Math.floor(r.av(this.bounds.getWest())*c),y=Math.floor(r.aC(this.bounds.getNorth())*c),b=Math.ceil(r.av(this.bounds.getEast())*c),E=Math.ceil(r.aC(this.bounds.getSouth())*c);return s.x>=f&&s.x<b&&s.y>=y&&s.y<E}}class xr extends r.E{constructor(s,c,f,y){if(super(),this.id=s,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,r.l(this,r.aA(c,["url","scheme","tileSize","promoteId"])),this._options=r.l({type:"vector"},c),this._collectResourceTiming=!!c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y),this._tileWorkers={},this._deduped=new r.aD}load(s){this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"}));let c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,f=this.map.getWorldview();this._tileJSONRequest=lo(this._options,this.map._requestManager,c,f,(y,b)=>{if(this._tileJSONRequest=null,this._loaded=!0,y)c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),f&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${f}`),this.fire(new r.z(y));else if(b){if(r.l(this,b),this.hasWorldviews=!!b.worldview_options,b.worldview_default&&(this.worldviewDefault=b.worldview_default),b.vector_layers){this.vectorLayers=b.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(let E of b.vector_layers)this.vectorLayerIds.push(E.id),b.worldview&&b.worldview[E.source]&&this.localizableLayerIds.add(E.id)}b.bounds&&(this.tileBounds=new No(b.bounds,this.minzoom,this.maxzoom)),Ai(b.tiles,this.map._requestManager._customAccessToken),this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))}s&&s(y)})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();let s=r.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return r.l({},this._options)}loadTile(s,c){let f=s.tileID.canonical.url(this.tiles,this.scheme),y=this.map._requestManager.normalizeTileURL(f),b=this.map._requestManager.transformRequest(y,r.R.Tile),E=this.map.style?this.map.style.getLut(this.scope):null,R=E?{image:E.image.clone()}:null,P={request:b,data:void 0,uid:s.uid,tileID:s.tileID,tileZoom:s.tileZoom,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,lut:R,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:r.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:s.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:s.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&r.f(f)&&(P.worldview=this.map.getWorldview()||this.worldviewDefault,P.localizableLayerIds=this.localizableLayerIds),P.request.collectResourceTiming=this._collectResourceTiming,s.actor&&s.state!=="expired")s.state==="loading"?s.reloadCallback=c:s.request=s.actor.send("reloadTile",P,L.bind(this));else if(s.actor=this._tileWorkers[y]=this._tileWorkers[y]||this.dispatcher.getActor(),this.dispatcher.ready)s.request=s.actor.send("loadTile",P,L.bind(this),void 0,!0);else{let F=r.aE.call({deduped:this._deduped},P,(j,U)=>{j||!U?L.call(this,j):(P.data={cacheControl:U.cacheControl,expires:U.expires,rawData:U.rawData.slice(0)},s.actor&&s.actor.send("loadTile",P,L.bind(this),void 0,!0))},!0);s.request={cancel:F}}function L(F,j){return delete s.request,s.aborted?c(null):F&&F.status!==404?c(F):(j&&j.resourceTiming&&(s.resourceTiming=j.resourceTiming),this.map._refreshExpiredTiles&&j&&s.setExpiryData(j),s.loadVectorData(j,this.map.painter),r.aF(this.dispatcher),c(null),void(s.reloadCallback&&(this.loadTile(s,s.reloadCallback),s.reloadCallback=null)))}}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(s,c){s.actor&&s.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope}),s.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Vs extends r.E{constructor(s,c,f,y){super(),this.id=s,this.dispatcher=f,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=r.l({type:"raster"},c),r.l(this,r.aA(c,["url","scheme","tileSize"]))}load(s){this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"})),this._tileJSONRequest=lo(this._options,this.map._requestManager,null,null,(c,f)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new r.z(c)):f&&(r.l(this,f),f.raster_layers&&(this.rasterLayers=f.raster_layers,this.rasterLayerIds=this.rasterLayers.map(y=>y.id)),f.bounds&&(this.tileBounds=new No(f.bounds,this.minzoom,this.maxzoom)),Ai(f.tiles),this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))),s&&s(c)})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();let s=r.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return r.l({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s,c){let f=r.q.devicePixelRatio>=2,y=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),f,this.tileSize);s.request=r.o(this.map._requestManager.transformRequest(y,r.R.Tile),(b,E,R,P)=>(delete s.request,s.aborted?(s.state="unloaded",c(null)):b?(s.state="errored",c(b)):E?(this.map._refreshExpiredTiles&&s.setExpiryData({cacheControl:R,expires:P}),s.setTexture(E,this.map.painter),s.state="loaded",r.aF(this.dispatcher),void c(null)):c(null)))}abortTile(s,c){s.request&&(s.request.cancel(),delete s.request),c&&c()}unloadTile(s,c){s.texture&&s.texture instanceof r.T?(s.destroy(!0),s.texture&&s.texture instanceof r.T&&this.map.painter.saveTileTexture(s.texture)):s.destroy(),c&&c()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class js extends Vs{constructor(s,c,f,y){super(s,c,f,y),this.type="raster-array",this.maxzoom=22,this.partial=!0,this.iconsets={},this._options=r.l({type:"raster-array"},c)}triggerRepaint(s){let c=this.map.painter._terrain,f=this.map.style.getSourceCache(this.id);c&&c.enabled&&f&&c._clearRenderCacheForTile(f.id,s.tileID),this.map.triggerRepaint()}loadTile(s,c){let f=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),y=this.map._requestManager.transformRequest(f,r.R.Tile),b={request:y,uid:s.uid,tileID:s.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};s.source=this.id,s.scope=this.scope,s.requestParams=y,s.actor||(s.actor=this.dispatcher.getActor());let E=(R,P,L,F)=>{if(delete s.request,s.aborted)return s.state="unloaded",c(null);if(R)return R.name==="AbortError"?void 0:(s.state="errored",c(R));if(this.map._refreshExpiredTiles&&P&&s.setExpiryData({cacheControl:L,expires:F}),this.partial)s.state="empty";else{if(!P)return c(null);s.state="loaded",s._isHeaderLoaded=!0,s._mrt=P;let j=new Map;for(let U in s._mrt.layers){let W=s.getLayer(U);if(W)for(let ie of W.getBandList()){let{bytes:Q,tileSize:re,buffer:oe}=W.getBandView(ie),me=re+2*oe,Me={data:new r.r({width:me,height:me},Q),pixelRatio:2,sdf:!1,usvg:!1,version:0};j.set(`${U}/${ie}`,Me)}}for(let U in this.iconsets)this.iconsets[U].addIcons(j)}c(null)};s.request=this.partial?s.fetchHeader(void 0,E.bind(this)):s.actor.send("loadTile",b,E.bind(this),void 0,!0)}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(s,c){let f=s.texture;f&&f instanceof r.T?(s.destroy(!0),this.map.painter.saveTileTexture(f)):(s.destroy(),s.flushQueues(),s._isHeaderLoaded=!1,delete s._mrt,delete s.textureDescriptor),s.fbo&&(s.fbo.destroy(),delete s.fbo),delete s.request,delete s.requestParams,delete s.neighboringTiles,s.state="unloaded"}prepareTile(s,c,f){s._isHeaderLoaded&&(s.state!=="empty"&&(s.state="reloading"),s.fetchBand(c,f,(y,b)=>{if(y)return s.state="errored",this.fire(new r.z(y)),void this.triggerRepaint(s);b&&(s._isHeaderLoaded=!0,s.setTexture(b,this.map.painter),s.state="loaded",this.triggerRepaint(s))}))}getInitialBand(s){if(!this.rasterLayers)return 0;let c=this.rasterLayers.find(({id:b})=>b===s),f=c&&c.fields,y=f&&f.bands&&f.bands;return y?y[0]:0}getTextureDescriptor(s,c,f){if(!s)return;let y=c.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!y)return;let b=null;c instanceof r.aI?b=c.paint.get("raster-array-band"):c instanceof r.aJ&&(b=c.paint.get("raster-particle-array-band"));let E=b||this.getInitialBand(y);if(E!=null)if(s.textureDescriptor){if(!s.updateNeeded(y,E)||f)return Object.assign({},s.textureDescriptor,{texture:s.texture})}else this.prepareTile(s,y,E)}addIconset(s,c){this.iconsets[s]=c,this.partial=!1}}let Qp={vector:xr,raster:Vs,"raster-dem":class extends Vs{constructor(m,s,c,f){super(m,s,c,f),this.type="raster-dem",this.maxzoom=22,this._options=r.l({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}loadTile(m,s){let c=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function f(y,b){y&&(m.state="errored",s(y)),b&&(m.dem=b,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",s(null))}m.request=r.o(this.map._requestManager.transformRequest(c,r.R.Tile),function(y,b,E,R){if(delete m.request,m.aborted)m.state="unloaded",s(null);else if(y)m.state="errored",s(y);else if(b){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:E,expires:R});let P=ImageBitmap&&b instanceof ImageBitmap&&r.t(),L=1-(b.width-r.aG(b.width))/2;L<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));let F=P?b:r.q.getImageData(b,L),j={uid:m.uid,tileID:m.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:F,encoding:this.encoding,padding:L};m.actor&&m.state!=="expired"||(m.actor=this.dispatcher.getActor(),m.actor.send("loadTile",j,f.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(m){let s=m.canonical,c=Math.pow(2,s.z),f=(s.x-1+c)%c,y=s.x===0?m.wrap-1:m.wrap,b=(s.x+1+c)%c,E=s.x+1===c?m.wrap+1:m.wrap,R={};return R[new r.aH(m.overscaledZ,y,s.z,f,s.y).key]={backfilled:!1},R[new r.aH(m.overscaledZ,E,s.z,b,s.y).key]={backfilled:!1},s.y>0&&(R[new r.aH(m.overscaledZ,y,s.z,f,s.y-1).key]={backfilled:!1},R[new r.aH(m.overscaledZ,m.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},R[new r.aH(m.overscaledZ,E,s.z,b,s.y-1).key]={backfilled:!1}),s.y+1<c&&(R[new r.aH(m.overscaledZ,y,s.z,f,s.y+1).key]={backfilled:!1},R[new r.aH(m.overscaledZ,m.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},R[new r.aH(m.overscaledZ,E,s.z,b,s.y+1).key]={backfilled:!1}),R}},"raster-array":js,geojson:class extends r.E{constructor(m,s,c,f){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(f),this._data=s.data,this._options=r.l({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.minzoom!==void 0&&(this.minzoom=s.minzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;let y=r.ai/this.tileSize;this.workerOptions=r.l({source:this.id,scope:this.scope,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*y,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*y,extent:r.ai,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:r.ai,radius:(s.clusterRadius!==void 0?s.clusterRadius:50)*y,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter,dynamic:s.dynamic},s.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}updateData(m){if(!this._options.dynamic)return this.fire(new r.z(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof m!="string"&&(m.type==="Feature"&&(m={type:"FeatureCollection",features:[m]}),m.type!=="FeatureCollection"))return this.fire(new r.z(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof m!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){let s=new Map;for(let c of this._data.features)s.set(c.id,c);for(let c of m.features)s.set(c.id,c);this._data.features=[...s.values()]}else this._data=m;return this._updateWorkerData(!0),this}getClusterExpansionZoom(m,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id,scope:this.scope},s),this}getClusterChildren(m,s){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id,scope:this.scope},s),this}getClusterLeaves(m,s,c,f){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:m,limit:s,offset:c},f),this}_updateWorkerData(m=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new r.A("dataloading",{dataType:"source"})),this._loaded=!1;let s=r.l({append:m},this.workerOptions);s.scope=this.scope;let c=this._data;typeof c=="string"?(s.request=this.map._requestManager.transformRequest(r.q.resolveURL(c),r.R.Source),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(c),this._pendingLoad=this.actor.send(`${this.type}.loadData`,s,(f,y)=>{if(this._loaded=!0,this._pendingLoad=null,f)this.fire(new r.z(f));else{let b={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&y&&y.resourceTiming&&y.resourceTiming[this.id]&&(b.resourceTiming=y.resourceTiming[this.id]),m&&(this._partialReload=!0),this.fire(new r.A("data",b)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(m),this._coalesce=!1)})}loaded(){return this._loaded}reload(){let m=r.C(this.id,this.scope);this.map.style.clearSource(m),this._updateWorkerData()}loadTile(m,s){let c=m.actor?"reloadTile":"loadTile";m.actor=this.actor;let f=this.map.style?this.map.style.getLut(this.scope):null,y=f?{image:f.image.clone()}:null,b=this._partialReload,E={type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:y,scope:this.scope,pixelRatio:r.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:b};m.request=this.actor.send(c,E,(R,P)=>b&&!P?(m.state="loaded",s(null)):(delete m.request,m.destroy(),m.aborted?s(null):R?s(R):(m.loadVectorData(P,this.map.painter,c==="reloadTile"),s(null))),void 0,c==="loadTile")}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m,s){this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id,scope:this.scope}),m.destroy()}onRemove(m){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return r.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends r.aK{constructor(m,s,c,f){super(m,s,c,f),this.roundZoom=!0,this.type="video",this.options=s}load(){this._loaded=!1;let m=this.options;this.urls=[];for(let s of m.urls)this.urls.push(this.map._requestManager.transformRequest(s,r.R.Source).url);r.aL(this.urls,(s,c)=>{this._loaded=!0,s?this.fire(new r.z(s)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){let s=this.video.seekable;m<s.start(0)||m>s.end(0)?this.fire(new r.z(new r.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let m=this.map.painter.context,s=m.gl;this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new r.T(m,this.video,s.RGBA8),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:r.aK,model:class extends r.E{constructor(m,s,c,f){super(),this.id=m,this.type="model",this.models=[],this._loaded=!1,this._options=s}load(){let m=[];for(let s in this._options.models){let c=this._options.models[s],f=r.aN(this.map._requestManager.transformRequest(c.uri,r.R.Model).url).then(y=>{if(!y)return;let b=r.aO(y),E=new r.aP(s,c.position,c.orientation,b);E.computeBoundsAndApplyParent(),this.models.push(E)}).catch(y=>{this.fire(new r.z(new Error(`Could not load model ${s} from ${c.uri}: ${y.message}`)))});m.push(f)}return Promise.allSettled(m).then(()=>{this._loaded=!0,this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(s=>{this.fire(new r.z(new Error(`Could not load models: ${s.message}`)))})}onAdd(m){this.map=m,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(m,s){}serialize(){return{type:"model"}}},"batched-model":class extends r.E{constructor(m,s,c,f){super(),this.type="batched-model",this.id=m,this.tileSize=512,this._options=s,this.tiles=this._options.tiles,this.maxzoom=s.maxzoom||19,this.minzoom=s.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=c,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(f)}onAdd(m){this.map=m,this.load()}reload(){this.cancelTileJSONRequest();let m=r.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(m))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(m){this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"}));let s=Array.isArray(this.map._language)?this.map._language.join():this.map._language,c=this.map.getWorldview();this._tileJSONRequest=lo(this._options,this.map._requestManager,s,c,(f,y)=>{this._tileJSONRequest=null,this._loaded=!0,f?(s&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${s}`),c&&c.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${c}`),this.fire(new r.z(f))):y&&(r.l(this,y),y.bounds&&(this.tileBounds=new No(y.bounds,this.minzoom,this.maxzoom)),Ai(y.tiles,this.map._requestManager._customAccessToken),this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))),m&&m(f)})}hasTransition(){return!1}hasTile(m){return!this.tileBounds||this.tileBounds.contains(m.canonical)}loaded(){return this._loaded}loadTile(m,s){let c=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme)),f={request:this.map._requestManager.transformRequest(c,r.R.Tile),data:void 0,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,tileSize:this.tileSize*m.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:m.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:r.q.devicePixelRatio,promoteId:this.promoteId};if(m.actor&&m.state!=="expired")if(m.state==="loading")m.reloadCallback=s;else{if(m.buckets){let b=Object.values(m.buckets);for(let E of b)E.dirty=!0;return void(m.state="loaded")}m.request=m.actor.send("reloadTile",f,y.bind(this))}else m.actor=this.dispatcher.getActor(),m.request=m.actor.send("loadTile",f,y.bind(this),void 0,!0);function y(b,E){return m.aborted?s(null):b&&b.status!==404?s(b):(this.map._refreshExpiredTiles&&E&&m.setExpiryData(E),m.loadModelData(E,this.map.painter),m.state="loaded",void s(null))}}serialize(){return r.l({},this._options)}},canvas:class extends r.aK{constructor(m,s,c,f){super(m,s,c,f),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(b=>typeof b!="number"))||this.fire(new r.z(new r.V(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new r.z(new r.V(`sources.${m}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new r.z(new r.V(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new r.z(new r.V(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new r.z(new r.V(`sources.${m}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new r.z(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(m){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let s=this.map.painter.context;this.texture?!m&&!this._playing||this.texture instanceof r.aM||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new r.T(s,this.canvas,s.gl.RGBA8,{premultiply:!0}),this._prepareData(s)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends r.E{constructor(m,s,c,f){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=s,this.setEventedParent(f),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new r.z(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new r.z(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new No(this._implementation.bounds,this.minzoom,this.maxzoom)),s.update=this._update.bind(this),s.clearTiles=this._clearTiles.bind(this),s.coveringTiles=this._coveringTiles.bind(this),r.l(this,r.aA(s,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return r.aA(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this.map=m,this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){let{x:s,y:c,z:f}=m.canonical;return this._implementation.hasTile({x:s,y:c,z:f})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,s){let{x:c,y:f,z:y}=m.tileID.canonical,b=new AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:c,y:f,z:y},{signal:b.signal})).then(function(E){return delete m.request,m.aborted?(m.state="unloaded",s(null)):E===void 0?(m.state="errored",s(null)):E===null?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",s(null)):function(R){return R instanceof ImageData||R instanceof HTMLCanvasElement||R instanceof ImageBitmap||R instanceof HTMLImageElement}(E)?(this.loadTileData(m,E),m.state="loaded",void s(null)):(m.state="errored",s(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch(E=>{E.name!=="AbortError"&&(m.state="errored",s(E))}),m.request.cancel=()=>b.abort()}loadTileData(m,s){m.setTexture(s,this.map.painter)}unloadTile(m,s){if(m.texture&&m.texture instanceof r.T?(m.destroy(!0),m.texture&&m.texture instanceof r.T&&this.map.painter.saveTileTexture(m.texture)):m.destroy(),this._implementation.unloadTile){let{x:c,y:f,z:y}=m.tileID.canonical;this._implementation.unloadTile({x:c,y:f,z:y})}s&&s()}abortTile(m,s){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),s&&s()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_clearTiles(){let m=r.C(this.id,this.scope);this.map.style.clearSource(m)}_update(){this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))}}},Sl=function(m,s,c,f){let y=new Qp[s.type](m,s,c,f);if(y.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${y.id}`);return r.aQ(["load","abort","unload","serialize","prepare"],y),y};function Xh(m,s,c=""){return`${c}:${s.id||""}:${s.layer.id}:${function(f){if("layerId"in f)return`layer:${f.layerId}`;{let{featuresetId:y,importId:b}=f;return`featureset:${y}${b?`:import:${b}`:""}`}}(m.target)}`}function th(m,s,c,f=""){if(m.uniqueFeatureID){let y=Xh(m,s,f);if(c.has(y))return!0;c.add(y)}return!1}function Ju(m,s,c,f,y=!1){let b=s.sourceCache.transform,E=s.sourceCache.tilesIn(m,s.has3DLayers,y);E.sort(Qh);let R=[];for(let P of E){let L=P.tile.queryRenderedFeatures(s,P,c,f,b,y);Object.keys(L).length&&R.push({wrappedTileID:P.tile.tileID.wrapped().key,queryResults:L})}return R.length===0?{}:function(P){let L={},F={};for(let j of P){let U=j.queryResults,W=j.wrappedTileID,ie=F[W]=F[W]||{};for(let Q in U){let re=U[Q],oe=ie[Q]=ie[Q]||{},me=L[Q]=L[Q]||[];for(let Me of re)oe[Me.featureIndex]||(oe[Me.featureIndex]=!0,me.push(Me))}}return L}(R)}function Ql(m,s,c,f,y){let b={},E=f.queryRenderedSymbols(m),R=[];for(let P of Object.keys(E).map(Number))R.push(y[P]);R.sort(Qh);for(let P of R){let L=P.featureIndex.lookupSymbolFeatures(E[P.bucketInstanceId],P.bucketIndex,P.sourceLayerIndex,s,c);for(let F in L){let j=b[F]=b[F]||[],U=L[F];U.sort((W,ie)=>{let Q=P.featureSortOrder;if(Q){let re=Q.indexOf(W.featureIndex);return Q.indexOf(ie.featureIndex)-re}return ie.featureIndex-W.featureIndex});for(let W of U)j.push(W)}}return b}function Jp(m,s){let c=m.getRenderableIds().map(b=>m.getTileByID(b)),f=[],y={};for(let b=0;b<c.length;b++){let E=c[b],R=E.tileID.canonical.key;y[R]||(y[R]=!0,E.querySourceFeatures(f,s))}return f}function Qh(m,s){let c=m.tileID,f=s.tileID;return c.overscaledZ-f.overscaledZ||c.canonical.y-f.canonical.y||c.wrap-f.wrap||c.canonical.x-f.canonical.x}function ed(m,s){let c={};if(!s)return c;for(let f of m){let y=f.layerIds.map(b=>s.getLayer(b)).filter(Boolean);if(y.length!==0){f.layers=y,f.stateDependentLayerIds&&(f.stateDependentLayers=f.stateDependentLayerIds.map(b=>y.filter(E=>E.id===b)[0]));for(let b of y)c[b.fqid]=f}}return c}let _a=32,Ss=33,as=new Uint16Array(8184);for(let m=0;m<2046;m++){let s=m+2,c=0,f=0,y=0,b=0,E=0,R=0;for(1&s?y=b=E=_a:c=f=R=_a;(s>>=1)>1;){let L=c+y>>1,F=f+b>>1;1&s?(y=c,b=f,c=E,f=R):(c=y,f=b,y=E,b=R),E=L,R=F}let P=4*m;as[P+0]=c,as[P+1]=f,as[P+2]=y,as[P+3]=b}let rr=new Uint16Array(2178),Ts=new Uint8Array(1089),Ia=new Uint16Array(1089);function mu(m){return m===0?-.03125:m===32?.03125:0}let gu={type:2,extent:r.ai,loadGeometry:()=>[[new r.P(0,0),new r.P(r.ai+1,0),new r.P(r.ai+1,r.ai+1),new r.P(0,r.ai+1),new r.P(0,0)]]};class ss{constructor(s,c,f,y,b){this.tileID=s,this.uid=r.aW(),this.uses=0,this.tileSize=c,this.tileZoom=f,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=b,y&&y.style&&(this._lastUpdatedBrightness=y.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",y&&y.transform&&(this.projection=y.transform.projection)}registerFadeDuration(s){let c=s+this.timeAdded;c<r.q.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=r.aR(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(s,c,f){if(this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=ed(s.buckets,c.style),this.hasSymbolBuckets=!1;for(let y in this.buckets){let b=this.buckets[y];if(b instanceof r.aY){if(this.hasSymbolBuckets=!0,!f)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let y in this.buckets){let b=this.buckets[y];if(b instanceof r.aY&&b.hasRTLText){this.hasRTLText=!0,r.aZ();break}}this.queryPadding=0;for(let y in this.buckets){let b=this.buckets[y],E=c.style.getOwnLayer(y);if(!E)continue;let R=E.queryRadius(b);this.queryPadding=Math.max(this.queryPadding,R)}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage),s.lineAtlas&&(this.lineAtlas=s.lineAtlas),this._lastUpdatedBrightness=s.brightness}else this.collisionBoxArray=new r.aX}unloadVectorData(){if(this.hasData()){for(let s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(s,c,f){s&&(s.resourceTiming&&(this.resourceTiming=s.resourceTiming),this.buckets=Object.assign({},this.buckets,ed(s.buckets,c.style)),s.featureIndex&&(this.latestFeatureIndex=s.featureIndex))}getBucket(s){return this.buckets[s.fqid]}upload(s){for(let y in this.buckets){let b=this.buckets[y];b.uploadPending()&&b.upload(s)}let c=s.gl,f=this.imageAtlas;f&&!f.uploaded&&(this.imageAtlasTexture=new r.T(s,f.image,c.RGBA8,{useMipmap:!!f.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new r.T(s,this.glyphAtlasImage,c.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new r.T(s,this.lineAtlas.image,c.R8),this.lineAtlas.uploaded=!0)}prepare(s,c,f){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture,f),!c||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;let y=c.style.getBrightness();(this._lastUpdatedBrightness||y)&&(this._lastUpdatedBrightness&&y&&Math.abs(this._lastUpdatedBrightness-y)<.001||(this.updateBuckets(c,this._lastUpdatedBrightness!==y),this._lastUpdatedBrightness=y))}queryRenderedFeatures(s,c,f,y,b,E){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};let R=function(P,L){let F=r.ad.mat4.fromScaling([],[.5*P.width,.5*-P.height,1]);return r.ad.mat4.translate(F,F,[1,-1,0]),r.ad.mat4.multiply(F,F,P.calculateProjMatrix(L.toUnwrapped())),Float32Array.from(F)}(b,this.tileID);return this.latestFeatureIndex.query(s,{tilespaceGeometry:c,pixelPosMatrix:R,transform:y,availableImages:f,tileTransform:this.tileTransform})}querySourceFeatures(s,c){let f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;let y=f.loadVTLayers(),b=c?c.sourceLayer:"",E=y._geojsonTileLayer||y[b];if(!E)return;let R=r.a_(c&&c.filter),{z:P,x:L,y:F}=this.tileID.canonical,j={z:P,x:L,y:F};for(let U=0;U<E.length;U++){let W=E.feature(U);if(R.needGeometry){let re=r.a$(W,!0);if(!R.filter(new r.aa(this.tileID.overscaledZ),re,this.tileID.canonical))continue}else if(!R.filter(new r.aa(this.tileID.overscaledZ),W))continue;let ie=f.getId(W,b),Q=new r.b0(W,P,L,F,ie);Q.tile=j,s.push(Q)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(s){let c=this.expirationTime;if(s.cacheControl){let f=r.b1(s.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){let f=Date.now(),y=!1;if(this.expirationTime>f)y=!1;else if(c)if(this.expirationTime<c)y=!0;else{let b=this.expirationTime-c;b?this.expirationTime=f+Math.max(b,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(s){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&s&&this.updateBuckets(s)}updateBuckets(s,c){if(!this.latestFeatureIndex||!s.style)return;let f=this.latestFeatureIndex.loadVTLayers(),y=s.style.listImages(),b=s.style.getBrightness();for(let E in this.buckets){if(!s.style.hasLayer(E))continue;let R=this.buckets[E],P=R.layers[0],L=P.sourceLayer||"_geojsonTileLayer",F=f[L],j=s.style.getLayerSourceCache(P),U={};j&&(U=j._state.getState(L,void 0));let W=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},ie=Object.keys(U).length>0&&!c;ie&&!R.stateDependentLayers.length&&!c||R.update(U,F,y,W,ie?R.stateDependentLayers:R.layers,c,b),(R instanceof r.b2||R instanceof r.b3)&&s._terrain&&s._terrain.enabled&&j&&R.uploadPending()&&s._terrain._clearRenderCacheForTile(j.id,this.tileID);let Q=s&&s.style&&s.style.getOwnLayer(E);Q&&(this.queryPadding=Math.max(this.queryPadding,Q.queryRadius(R)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<r.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=r.q.now()+s}setTexture(s,c){let f=c.context,y=f.gl;this.texture=this.texture||c.getTileTexture(s.width),this.texture&&this.texture instanceof r.T?this.texture.update(s):(this.texture=new r.T(f,s,y.RGBA8,{useMipmap:!0}),this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE))}setDependencies(s,c){let f={};for(let y of c)f[y]=!0;this.dependencies[s]=f}hasDependency(s,c){for(let f of s){let y=this.dependencies[f];if(y){for(let b of c)if(y[b])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(s,c){if(!c||c.name==="mercator"||this._tileDebugBuffer)return;let f=r.b4(gu,this.tileID.canonical,this.tileTransform)[0],y=new r.b5,b=new r.b6;for(let E=0;E<f.length;E++){let{x:R,y:P}=f[E];y.emplaceBack(R,P),b.emplaceBack(E)}b.emplaceBack(0),this._tileDebugIndexBuffer=s.createIndexBuffer(b),this._tileDebugBuffer=s.createVertexBuffer(y,r.b7.members),this._tileDebugSegments=r.b8.simpleSegment(0,0,y.length,b.length)}_makeTileBoundsBuffers(s,c){if(this._tileBoundsBuffer||!c||c.name==="mercator")return;let f=r.b4(gu,this.tileID.canonical,this.tileTransform)[0],y,b;if(this.isRaster){let E=function(R,P){let L=r.aR(R,P),F=Math.pow(2,R.z);for(let re=0;re<Ss;re++)for(let oe=0;oe<Ss;oe++){let me=r.aS((R.x+(oe+mu(oe))/_a)/F),Me=r.aT((R.y+(re+mu(re))/_a)/F),Ee=P.project(me,Me),Le=re*Ss+oe;rr[2*Le+0]=Math.round((Ee.x*L.scale-L.x)*r.ai),rr[2*Le+1]=Math.round((Ee.y*L.scale-L.y)*r.ai)}Ts.fill(0),Ia.fill(0);for(let re=2045;re>=0;re--){let oe=4*re,me=as[oe+0],Me=as[oe+1],Ee=as[oe+2],Le=as[oe+3],Ie=me+Ee>>1,Ae=Me+Le>>1,Re=Ie+Ae-Me,Ve=Ae+me-Ie,qe=Me*Ss+me,dt=Le*Ss+Ee,nt=Ae*Ss+Ie,Et=Math.hypot((rr[2*qe+0]+rr[2*dt+0])/2-rr[2*nt+0],(rr[2*qe+1]+rr[2*dt+1])/2-rr[2*nt+1])>=16;Ts[nt]=Ts[nt]||(Et?1:0),re<1022&&(Ts[nt]=Ts[nt]||Ts[(Me+Ve>>1)*Ss+(me+Re>>1)]||Ts[(Le+Ve>>1)*Ss+(Ee+Re>>1)])}let j=new r.aU,U=new r.aV,W=0;function ie(re,oe){let me=oe*Ss+re;return Ia[me]===0&&(j.emplaceBack(rr[2*me+0],rr[2*me+1],re*r.ai/_a,oe*r.ai/_a),Ia[me]=++W),Ia[me]-1}function Q(re,oe,me,Me,Ee,Le){let Ie=re+me>>1,Ae=oe+Me>>1;if(Math.abs(re-Ee)+Math.abs(oe-Le)>1&&Ts[Ae*Ss+Ie])Q(Ee,Le,re,oe,Ie,Ae),Q(me,Me,Ee,Le,Ie,Ae);else{let Re=ie(re,oe),Ve=ie(me,Me),qe=ie(Ee,Le);U.emplaceBack(Re,Ve,qe)}}return Q(0,0,_a,_a,_a,0),Q(_a,_a,0,0,0,_a),{vertices:j,indices:U}}(this.tileID.canonical,c);y=E.vertices,b=E.indices}else{y=new r.aU,b=new r.aV;for(let{x:R,y:P}of f)y.emplaceBack(R,P,0,0);let E=r.b9(y.int16,void 0,4);for(let R=0;R<E.length;R+=3)b.emplaceBack(E[R],E[R+1],E[R+2])}this._tileBoundsBuffer=s.createVertexBuffer(y,r.ba.members),this._tileBoundsIndexBuffer=s.createIndexBuffer(b),this._tileBoundsSegments=r.b8.simpleSegment(0,0,y.length,b.length)}_makeGlobeTileDebugBuffers(s,c){let f=c.projection;if(!f||f.name!=="globe"||c.freezeTileCoverage)return;let y=this.tileID.canonical,b=r.bb(y,c),E=r.bc(b),R=r.ag(c.zoom),P;R>0&&(P=r.ad.mat4.invert(new Float64Array(16),c.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(s,y,c,E,P,R),this._makeGlobeTileDebugTextBuffer(s,y,c,E,P,R)}_globePoint(s,c,f,y,b,E,R){let P=r.bd(s,c,f);if(E){let L=1<<f.z,F=r.av(y.center.lng),j=r.aC(y.center.lat),U=(f.x+.5)/L-F,W=0;U>.5?W=-1:U<-.5&&(W=1);let ie=(s/r.ai+f.x)/L+W,Q=(c/r.ai+f.y)/L;ie=(ie-F)*y._pixelsPerMercatorPixel+F,Q=(Q-j)*y._pixelsPerMercatorPixel+j;let re=[ie*y.worldSize,Q*y.worldSize,0];r.ad.vec3.transformMat4(re,re,E),P=r.be(P,re,R)}return r.ad.vec3.transformMat4(P,P,b)}_makeGlobeTileDebugBorderBuffer(s,c,f,y,b,E){let R=new r.b5,P=new r.b6,L=new r.bf,F=(U,W,ie,Q,re)=>{let oe=(ie-U)/(re-1),me=(Q-W)/(re-1),Me=R.length;for(let Ee=0;Ee<re;Ee++){let Le=U+Ee*oe,Ie=W+Ee*me;R.emplaceBack(Le,Ie);let Ae=this._globePoint(Le,Ie,c,f,y,b,E);L.emplaceBack(Ae[0],Ae[1],Ae[2]),P.emplaceBack(Me+Ee)}},j=r.ai;F(0,0,j,0,16),F(j,0,j,j,16),F(j,j,0,j,16),F(0,j,0,0,16),this._tileDebugIndexBuffer=s.createIndexBuffer(P),this._tileDebugBuffer=s.createVertexBuffer(R,r.b7.members),this._globeTileDebugBorderBuffer=s.createVertexBuffer(L,r.bg.members),this._tileDebugSegments=r.b8.simpleSegment(0,0,R.length,P.length)}_makeGlobeTileDebugTextBuffer(s,c,f,y,b,E){let R=r.ai/4,P=new r.b5,L=new r.aV,F=new r.bf,j=25;L.reserve(32),P.reserve(j),F.reserve(j);let U=(W,ie)=>j*W+ie;for(let W=0;W<j;W++){let ie=W*R;for(let Q=0;Q<j;Q++){let re=Q*R;P.emplaceBack(re,ie);let oe=this._globePoint(re,ie,c,f,y,b,E);F.emplaceBack(oe[0],oe[1],oe[2])}}for(let W=0;W<4;W++)for(let ie=0;ie<4;ie++){let Q=U(W,ie),re=U(W,ie+1),oe=U(W+1,ie),me=U(W+1,ie+1);L.emplaceBack(Q,re,oe),L.emplaceBack(oe,re,me)}this._tileDebugTextIndexBuffer=s.createIndexBuffer(L),this._tileDebugTextBuffer=s.createVertexBuffer(P,r.b7.members),this._globeTileDebugTextBuffer=s.createVertexBuffer(F,r.bg.members),this._tileDebugTextSegments=r.b8.simpleSegment(0,0,j,32)}destroy(s=!1){for(let c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!s&&this.texture&&this.texture instanceof r.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}r.bh.setPbf(r.bi);class ls extends ss{constructor(s,c,f,y,b){super(s,c,f,y,b),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(s){return this._mrt&&this._mrt.getLayer(s)}setTexture(s,c){let f=c.context,y=f.gl;this.texture=this.texture||c.getTileTexture(s.width),this.texture&&this.texture instanceof r.T?this.texture.update(s,{premultiply:!1}):this.texture=new r.T(f,s,y.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(s=16384,c){let f=this._mrt=new r.bh(30),y=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(s-1)}});return this.entireBuffer=null,this.request=r.bj(y,(b,E,R,P)=>{if(b)c(b);else try{let L=f.getHeaderLength(E);if(L>s)return void(this.request=this.fetchHeader(L,c));f.parseHeader(E),this._isHeaderLoaded=!0;let F=0;for(let j of Object.values(f.layers))F=Math.max(F,j.dataIndex[j.dataIndex.length-1].lastByte);E.byteLength>=F&&(this.entireBuffer=E),c(null,this.entireBuffer||E,R,P)}catch(L){c(L)}}),this.request}fetchBand(s,c,f){let y=this._mrt;if(!this._isHeaderLoaded||!y)return void f(new Error("Tile header is not ready"));let b=this.actor;if(!b)return void f(new Error("Can't fetch tile band without an actor"));let E,R=(j,U)=>{E.complete(j,U),j?f(j):(this.updateTextureDescriptor(s,c),f(null,this.textureDescriptor&&this.textureDescriptor.img))},P=(j,U)=>{if(j)return f(j);let W=b.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:U,task:E},R,void 0,!0);this._workQueue.push(()=>{W&&W.cancel(),E.cancel()})},L=y.getLayer(s);if(!L)return void f(new Error(`Unknown sourceLayer "${s}"`));if(L.hasDataForBand(c))return this.updateTextureDescriptor(s,c),void f(null,this.textureDescriptor?this.textureDescriptor.img:null);let F=L.getDataRange([c]);if(E=y.createDecodingTask(F),!E||E.tasks.length)if(this.flushQueues(),this.entireBuffer)P(null,this.entireBuffer.slice(F.firstByte,F.lastByte+1));else{let j=Object.assign({},this.requestParams,{headers:{Range:`bytes=${F.firstByte}-${F.lastByte}`}}),U=r.bj(j,P);this._fetchQueue.push(()=>{U.cancel(),E.cancel()})}else f(null)}updateNeeded(s,c){return(!this.textureDescriptor||this.textureDescriptor.band!==c||this.textureDescriptor.layer!==s)&&this.state!=="errored"}updateTextureDescriptor(s,c){if(!this._mrt)return;let f=this._mrt.getLayer(s);if(!f||!f.hasBand(c)||!f.hasDataForBand(c))return;let{bytes:y,tileSize:b,buffer:E,offset:R,scale:P}=f.getBandView(c),L=b+2*E,F=new r.r({width:L,height:L},y),j=this.texture;j&&j instanceof r.T&&j.update(F,{premultiply:!1}),this.textureDescriptor={layer:s,band:c,img:F,buffer:E,offset:R,tileSize:b,format:f.pixelFormat,mix:[P,256*P,65536*P,16777216*P]}}}class Jl{constructor(s,c){this.max=s,this.onRemove=c,this.reset()}reset(){for(let s in this.data)for(let c of this.data[s])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(s,c,f){let y=s.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);let b={value:c,timeout:void 0};if(f!==void 0&&(b.timeout=setTimeout(()=>{this.remove(s,b)},f)),this.data[y].push(b),this.order.push(y),this.order.length>this.max){let E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){let c=this.data[s].shift();return c.timeout&&clearTimeout(c.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),c.value}getByKey(s){let c=this.data[s];return c?c[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,c){if(!this.has(s))return this;let f=s.wrapped().key,y=c===void 0?0:this.data[f].indexOf(c),b=this.data[f][y];return this.data[f].splice(y,1),b.timeout&&clearTimeout(b.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(b.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){let c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(s){let c=[];for(let f in this.data)for(let y of this.data[f])s(y.value)||c.push(y);for(let f of c)this.remove(f.value.tileID,f)}}class Hm{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,c,f){let y=String(c);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][y]=this.stateChanges[s][y]||{},r.l(this.stateChanges[s][y],f),this.deletedStates[s]===null){this.deletedStates[s]={};for(let b in this.state[s])b!==y&&(this.deletedStates[s][b]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][y]===null){this.deletedStates[s][y]={};for(let b in this.state[s][y])f[b]||(this.deletedStates[s][y][b]=null)}else for(let b in f)this.deletedStates[s]&&this.deletedStates[s][y]&&this.deletedStates[s][y][b]===null&&delete this.deletedStates[s][y][b]}removeFeatureState(s,c,f){if(this.deletedStates[s]===null)return;let y=String(c);if(this.deletedStates[s]=this.deletedStates[s]||{},f&&c!==void 0)this.deletedStates[s][y]!==null&&(this.deletedStates[s][y]=this.deletedStates[s][y]||{},this.deletedStates[s][y][f]=null);else if(c!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][y])for(f in this.deletedStates[s][y]={},this.stateChanges[s][y])this.deletedStates[s][y][f]=null;else this.deletedStates[s][y]=null;else this.deletedStates[s]=null}getState(s,c){let f=this.state[s]||{},y=this.stateChanges[s]||{},b=this.deletedStates[s];if(b===null)return{};if(c!==void 0){let R=String(c),P=r.l({},f[R],y[R]);if(b){let L=b[c];if(L===null)return{};for(let F in L)delete P[F]}return P}let E=r.l({},f,y);if(b)for(let R in b)delete E[R];return E}initializeTileState(s,c){s.refreshFeatureState(c)}coalesceChanges(s,c){let f={};for(let y in this.stateChanges){this.state[y]=this.state[y]||{};let b={};for(let E in this.stateChanges[y])this.state[y][E]||(this.state[y][E]={}),r.l(this.state[y][E],this.stateChanges[y][E]),b[E]=this.state[y][E];f[y]=b}for(let y in this.deletedStates){this.state[y]=this.state[y]||{};let b={};if(this.deletedStates[y]===null)for(let E in this.state[y])b[E]={},this.state[y][E]={};else for(let E in this.deletedStates[y]){if(this.deletedStates[y][E]===null)this.state[y][E]={};else if(this.state[y][E])for(let R of Object.keys(this.deletedStates[y][E]))delete this.state[y][E][R];b[E]=this.state[y][E]}f[y]=f[y]||{},r.l(f[y],b)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(let y in s)s[y].refreshFeatureState(c)}}class al extends r.E{constructor(s,c,f){super(),this.id=s,this._onlySymbols=f,c.on("data",y=>{y.dataType==="source"&&y.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&y.dataType==="source"&&y.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),c.on("error",()=>{this._sourceErrored=!0}),this._source=c,this._tiles={},this._cache=new Jl(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=c.minTileCacheSize,this._maxTileCacheSize=c.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Hm,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(s){this.map=s,this._minTileCacheSize=this._minTileCacheSize===void 0&&s?s._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&s?s._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(let s in this._tiles)if(!this._tiles[s].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(s,c){return s.isSymbolTile=this._onlySymbols,s.isExtraShadowCaster=this._shadowCasterTiles[s.tileID.key],this._source.loadTile(s,c)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s)}_abortTile(s){if(this._source.abortTile)return this._source.abortTile(s)}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let c in this._tiles){let f=this._tiles[c];f.upload(s),f.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(s=>s.tileID).sort(Ui).map(s=>s.key)}getRenderableIds(s,c){let f=[];for(let y in this._tiles)this._isIdRenderable(+y,s,c)&&f.push(this._tiles[y]);return s?f.sort((y,b)=>{let E=y.tileID,R=b.tileID,P=new r.P(E.canonical.x,E.canonical.y)._rotate(this.transform.angle),L=new r.P(R.canonical.x,R.canonical.y)._rotate(this.transform.angle);return E.overscaledZ-R.overscaledZ||L.y-P.y||L.x-P.x}).map(y=>y.tileID.key):f.map(y=>y.tileID).sort(Ui).map(y=>y.key)}hasRenderableParent(s){let c=this.findLoadedParent(s,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(s,c,f){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(c||!this._tiles[s].holdingForFade())&&(f||!this._shadowCasterTiles[s])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(let s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(+s,"reloading")}}_reloadTile(s,c){let f=this._tiles[s];f&&(f.state!=="loading"&&(f.state=c),this._loadTile(f,this._tileLoaded.bind(this,f,s,c)))}_tileLoaded(s,c,f,y){if(y)if(s.state="errored",y.status!==404)this._source.fire(new r.z(y,{tile:s}));else{if(this._source.fire(new r.A("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:s})),!(s.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){let b=this.map.painter.terrain;this.update(this.transform,b.getScaledDemTileSize(),!0),b.resetTileLookupCache(this.id)}else this.update(this.transform)}else s.timeAdded=r.q.now(),f==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(c,s),this._source.type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),this._source.fire(new r.A("data",{dataType:"source",tile:s,coord:s.tileID,sourceCacheId:this.id}))}_backfillDEM(s){let c=this.getRenderableIds();for(let y=0;y<c.length;y++){let b=c[y];if(s.neighboringTiles&&s.neighboringTiles[b]){let E=this.getTileByID(b);f(s,E),f(E,s)}}function f(y,b){if(!y.dem||y.dem.borderReady)return;y.needsHillshadePrepare=!0,y.needsDEMTextureUpload=!0;let E=b.tileID.canonical.x-y.tileID.canonical.x,R=b.tileID.canonical.y-y.tileID.canonical.y,P=Math.pow(2,y.tileID.canonical.z),L=b.tileID.key;E===0&&R===0||Math.abs(R)>1||(Math.abs(E)>1&&(Math.abs(E+P)===1?E+=P:Math.abs(E-P)===1&&(E-=P)),b.dem&&y.dem&&(y.dem.backfillBorder(b.dem,E,R),y.neighboringTiles&&y.neighboringTiles[L]&&(y.neighboringTiles[L].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,c,f,y){for(let b in this._tiles){let E=this._tiles[b];if(y[b]||!E.hasData()||E.tileID.overscaledZ<=c||E.tileID.overscaledZ>f)continue;let R=E.tileID;for(;E&&E.tileID.overscaledZ>c+1;){let L=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[L.key],E&&E.hasData()&&(R=L)}let P=R;for(;P.overscaledZ>c;)if(P=P.scaledTo(P.overscaledZ-1),s[P.key]){y[R.key]=R;break}}}findLoadedParent(s,c){if(s.key in this._loadedParentTiles){let f=this._loadedParentTiles[s.key];return f&&f.tileID.overscaledZ>=c?f:null}for(let f=s.overscaledZ-1;f>=c;f--){let y=s.scaledTo(f),b=this._getLoadedTile(y);if(b)return b}}_getLoadedTile(s){let c=this._tiles[s.key];return c&&c.hasData()?c:this._cache.getByKey(this._source.reparseOverscaled?s.wrapped().key:s.canonical.key)}updateCacheSize(s,c){c=c||this._source.tileSize;let f=Math.ceil(s.width/c)+1,y=Math.ceil(s.height/c)+1,b=Math.floor(f*y*5),E=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,b):b,R=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(R)}handleWrapJump(s){let c=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,c){let f={};for(let y in this._tiles){let b=this._tiles[y];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+c),f[b.tileID.key]=b}this._tiles=f;for(let y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(let y in this._tiles)this._setTileReloadTimer(+y,this._tiles[y])}}update(s,c,f,y){if(this.transform=s,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!f)return;this.updateCacheSize(s,c),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};let b=this._source.type==="batched-model",E,R=this._source.maxzoom,P=this.map&&this.map.painter?this.map.painter._terrain:null;if(P&&P.sourceCache===this&&P.attenuationRange()){let j=P.attenuationRange()[0],U=Math.floor(j)-Math.log2(P.getDemUpscale());R>U&&(R=U)}if(this.used||this.usedForTerrain){if(this._source.tileID)E=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(j=>new r.aH(j.canonical.z,j.wrap,j.canonical.z,j.canonical.x,j.canonical.y));else if(this.tileCoverLift!==0){let j=s.clone();j.tileCoverLift=this.tileCoverLift,E=j.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:R,roundZoom:this._source.roundZoom&&!f,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:b}),this._source.minzoom<=1&&s.projection.name==="globe"&&(E.push(new r.aH(1,0,1,0,0)),E.push(new r.aH(1,0,1,1,0)),E.push(new r.aH(1,0,1,0,1)),E.push(new r.aH(1,0,1,1,1)))}else if(E=s.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:R,roundZoom:this._source.roundZoom&&!f,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:b}),this._source.hasTile){let j=this._source.hasTile.bind(this._source);E=E.filter(U=>j(U))}}else E=[];if(E.length>0&&this.castsShadows&&y&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!or(this._source.type)){let j=s.coveringZoomLevel({tileSize:c||this._source.tileSize,roundZoom:this._source.roundZoom&&!f}),U=Math.min(j,this._source.maxzoom);if(b){let W=s.extendTileCover(E,U);for(let ie of W)E.push(ie)}else{let W=s.extendTileCover(E,U,y);for(let ie of W)this._shadowCasterTiles[ie.key]=!0,E.push(ie)}}let L=this._updateRetainedTiles(E);if(or(this._source.type)&&E.length!==0){let j={},U={},W=Object.keys(L);for(let Q of W){let re=L[Q],oe=this._tiles[Q];if(!oe||oe.fadeEndTime&&oe.fadeEndTime<=r.q.now())continue;let me=this.findLoadedParent(re,Math.max(re.overscaledZ-al.maxOverzooming,this._source.minzoom));me&&(this._addTile(me.tileID),j[me.tileID.key]=me.tileID),U[Q]=re}let ie=E[E.length-1].overscaledZ;for(let Q in this._tiles){let re=this._tiles[Q];if(L[Q]||!re.hasData())continue;let oe=re.tileID;for(;oe.overscaledZ>ie;){oe=oe.scaledTo(oe.overscaledZ-1);let me=this._tiles[oe.key];if(me&&me.hasData()&&U[oe.key]){L[Q]=re.tileID;break}}}for(let Q in j)L[Q]||(this._coveredTiles[Q]=!0,L[Q]=j[Q])}for(let j in L)this._tiles[j].clearFadeHold();let F=r.bk(this._tiles,L);for(let j of F){let U=this._tiles[j];U.hasSymbolBuckets&&!U.holdingForFade()?U.setHoldDuration(this.map._fadeDuration):U.hasSymbolBuckets&&!U.symbolFadeFinished()||this._removeTile(+j)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(let s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(+s)}_updateRetainedTiles(s){let c={};if(s.length===0)return c;let f={},y=s.reduce((L,F)=>Math.min(L,F.overscaledZ),1/0),b=s[0].overscaledZ,E=Math.max(b-al.maxOverzooming,this._source.minzoom),R=Math.max(b+al.maxUnderzooming,this._source.minzoom),P={};for(let L of s){let F=this._addTile(L);c[L.key]=L,F.hasData()||y<this._source.maxzoom&&(P[L.key]=L)}this._retainLoadedChildren(P,y,R,c);for(let L of s){let F=this._tiles[L.key];if(F.hasData())continue;if(L.canonical.z>=this._source.maxzoom){let U=L.children(this._source.maxzoom)[0],W=this.getTile(U);if(W&&W.hasData()){c[U.key]=U;continue}}else{let U=L.children(this._source.maxzoom);if(c[U[0].key]&&c[U[1].key]&&c[U[2].key]&&c[U[3].key])continue}let j=F.wasRequested();for(let U=L.overscaledZ-1;U>=E;--U){let W=L.scaledTo(U);if(f[W.key]||(f[W.key]=!0,F=this.getTile(W),!F&&j&&(F=this._addTile(W)),F&&(c[W.key]=W,j=F.wasRequested(),F.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let s in this._tiles){let c=[],f,y=this._tiles[s].tileID;for(;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){f=this._loadedParentTiles[y.key];break}c.push(y.key);let b=y.scaledTo(y.overscaledZ-1);if(f=this._getLoadedTile(b),f)break;y=b}for(let b of c)this._loadedParentTiles[b]=f}}_addTile(s){let c=this._tiles[s.key];if(c)return c.isExtraShadowCaster!==!0||this._shadowCasterTiles[s.key]||this._reloadTile(s.key,"reloading"),c;c=this._cache.getAndRemove(s),c&&(this._setTileReloadTimer(s.key,c),c.tileID=s,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,c)));let f=!!c;if(!f){let y=this.map?this.map.painter:null,b=this._source.tileSize*s.overscaleFactor();c=this._source.type==="raster-array"?new ls(s,b,this.transform.tileZoom,y,this._isRaster):new ss(s,b,this.transform.tileZoom,y,this._isRaster),this._loadTile(c,this._tileLoaded.bind(this,c,s.key,c.state))}return c?(c.uses++,this._tiles[s.key]=c,f||this._source.fire(new r.A("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null}_setTileReloadTimer(s,c){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);let f=c.getExpiryTimeout();f&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},f))}_removeTile(s){let c=this._tiles[s];c&&(c.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),c.uses>0||(c.hasData()&&c.state!=="reloading"||c.state==="empty"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let s in this._tiles)this._removeTile(+s);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(s,c,f){let y=[],b=this.transform;if(!b)return y;let E=b.projection.name==="globe",R=r.av(b.center.lng);for(let P in this._tiles){let L=this._tiles[P];if(f&&L.clearQueryDebugViz(),L.holdingForFade())continue;let F;if(E){let j=L.tileID.canonical;if(j.z===0){let U=[Math.abs(r.ay(R,...pi(j,-1))-R),Math.abs(r.ay(R,...pi(j,1))-R)];F=[0,2*U.indexOf(Math.min(...U))-1]}else{let U=[Math.abs(r.ay(R,...pi(j,-1))-R),Math.abs(r.ay(R,...pi(j,0))-R),Math.abs(r.ay(R,...pi(j,1))-R)];F=[U.indexOf(Math.min(...U))-1]}}else F=[0];for(let j of F){let U=s.containsTile(L,b,c,j);U&&y.push(U)}}return y}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(s){return this._getRenderableCoordinates(s)}_getRenderableCoordinates(s,c){let f=this.getRenderableIds(s,c).map(b=>this._tiles[b].tileID),y=this.transform.projection.name==="globe";for(let b of f)b.projMatrix=this.transform.calculateProjMatrix(b.toUnwrapped()),b.expandedProjMatrix=y?this.transform.calculateProjMatrix(b.toUnwrapped(),!1,!0):b.projMatrix;return f}sortCoordinatesByDistance(s){let c=s.slice(),f=this.transform._camera.position,y=this.transform._camera.forward(),b={};for(let E of c){let R=1/(1<<E.canonical.z);b[E.key]=((E.canonical.x+.5)*R+E.wrap-f[0])*y[0]+((E.canonical.y+.5)*R-f[1])*y[1]-f[2]*y[2]}return c.sort((E,R)=>b[E.key]-b[R.key]),c}hasTransition(){if(this._source.hasTransition())return!0;if(or(this._source.type))for(let s in this._tiles){let c=this._tiles[s];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=r.q.now())return!0}return!1}setFeatureState(s,c,f){this._state.updateState(s=s||"_geojsonTileLayer",c,f)}removeFeatureState(s,c,f){this._state.removeFeatureState(s=s||"_geojsonTileLayer",c,f)}getFeatureState(s,c){return this._state.getState(s=s||"_geojsonTileLayer",c)}setDependencies(s,c,f){let y=this._tiles[s];y&&y.setDependencies(c,f)}reloadTilesForDependencies(s,c){for(let f in this._tiles)this._tiles[f].hasDependency(s,c)&&this._reloadTile(+f,"reloading");this._cache.filter(f=>!f.hasDependency(s,c))}_preloadTiles(s,c){if(!this._sourceLoaded){let P=()=>{this._sourceLoaded&&(this._source.off("data",P),this._preloadTiles(s,c))};return void this._source.on("data",P)}let f=new Map,y=Array.isArray(s)?s:[s],b=this.map.painter.terrain,E=this.usedForTerrain&&b?b.getScaledDemTileSize():this._source.tileSize;for(let P of y){let L=P.coveringTiles({tileSize:E,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(let F of L)f.set(F.key,F);this.usedForTerrain&&P.updateElevation(!1)}let R=Array.from(f.values());r.bl(R,(P,L)=>{let F=new ss(P,this._source.tileSize*P.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(F,j=>{this._source.type==="raster-dem"&&F.dem&&this._backfillDEM(F),L(j,F)})},c)}}function Ui(m,s){let c=Math.abs(2*m.wrap)-+(m.wrap<0),f=Math.abs(2*s.wrap)-+(s.wrap<0);return m.overscaledZ-s.overscaledZ||f-c||s.canonical.y-m.canonical.y||s.canonical.x-m.canonical.x}function or(m){return m==="raster"||m==="image"||m==="video"||m==="custom"}function pi(m,s){let c=1<<m.z;return[m.x/c+s,(m.x+1)/c+s]}al.maxOverzooming=10,al.maxUnderzooming=3;class Tl{constructor(s){this.style=s,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];let s=!1,c=!1;for(let f in this.style._mergedLayers){let y=this.style._mergedLayers[f];if(y.type==="fill-extrusion")this.layers.push({layer:y,visible:s,visibilityChanged:c});else if(y.type==="model"){let b=this.style.getLayerSource(y);b&&b.type==="batched-model"&&this.layers.push({layer:y,visible:s,visibilityChanged:c})}}}onNewFrame(s){this.layersGotHidden=!1;for(let c of this.layers){let f=c.layer,y=!1;f.type==="fill-extrusion"?y=!f.isHidden(s)&&f.paint.get("fill-extrusion-opacity")>0:f.type==="model"&&(y=!f.isHidden(s)&&f.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!y&&c.visible,c.visible=y}}updateZOffset(s,c){this.currentBuildingBuckets=[];for(let y of this.layers){let b=y.layer,E=this.style.getLayerSourceCache(b),R=1;b.type==="fill-extrusion"&&(R=y.visible?b.paint.get("fill-extrusion-vertical-scale"):0);let P=E?E.getTile(c):null;if(!P&&E&&c.canonical.z>E.getSource().minzoom){let L=c.scaledTo(Math.min(E.getSource().maxzoom,c.overscaledZ-1));for(;L.overscaledZ>=E.getSource().minzoom&&(P=E.getTile(L),!P&&L.overscaledZ!==0);)L=L.scaledTo(L.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:P?P.getBucket(b):null,tileID:P?P.tileID:c,verticalScale:R})}s.hasAnyZOffset=!1;let f=!1;for(let y=0;y<s.symbolInstances.length;y++){let b=s.symbolInstances.get(y),E=b.zOffset,R=this._getHeightAtTileOffset(c,b.tileAnchorX,b.tileAnchorY);b.zOffset=R!==Number.NEGATIVE_INFINITY?R:E,f||E===b.zOffset||(f=!0),s.hasAnyZOffset||b.zOffset===0||(s.hasAnyZOffset=!0)}f&&(s.zOffsetBuffersNeedUpload=!0,s.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(s,c,f,y){let b=c,E=f;if(s.canonical.z!==y.canonical.z){let R=y.canonical,P=1/(1<<s.canonical.z-R.z);b=(c+s.canonical.x*r.ai)*P-R.x*r.ai|0,E=(f+s.canonical.y*r.ai)*P-R.y*r.ai|0}return{tileX:b,tileY:E}}_getHeightAtTileOffset(s,c,f){let y,b;for(let E=0;E<this.layers.length;++E){if(this.layers[E].layer.type!=="fill-extrusion")continue;let{bucket:R,tileID:P,verticalScale:L}=this.currentBuildingBuckets[E];if(!R)continue;let{tileX:F,tileY:j}=this._mapCoordToOverlappingTile(s,c,f,P),U=R.getHeightAtTileCoord(F,j);U&&U.height!==void 0&&(U.hidden?y=U.height:b=Math.max(U.height*L,b||0))}if(b!==void 0)return b;for(let E=0;E<this.layers.length;++E){let R=this.layers[E];if(R.layer.type!=="model"||!R.visible)continue;let{bucket:P,tileID:L}=this.currentBuildingBuckets[E];if(!P)continue;let{tileX:F,tileY:j}=this._mapCoordToOverlappingTile(s,c,f,L),U=P.getHeightAtTileCoord(F,j);if(U&&!U.hidden)return U.height===void 0&&y!==void 0?Math.min(U.maxHeight,y)*U.verticalScale:U.height?U.height*U.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Dl(m,s){let c={};for(let f in m)f!=="ref"&&(c[f]=m[f]);return r.bm.forEach(f=>{f in s&&(c[f]=s[f])}),c}function Nc(m){m=m.slice();let s=Object.create(null);for(let c=0;c<m.length;c++)s[m[c].id]=m[c];for(let c=0;c<m.length;c++)"ref"in m[c]&&(m[c]=Dl(m[c],s[m[c].ref]));return m}let Sn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function yn(m,s,c){c.push({command:Sn.addSource,args:[m,s[m]]})}function td(m,s,c){s.push({command:Sn.removeSource,args:[m]}),c[m]=!0}function _u(m,s,c,f){td(m,c,f),yn(m,s,c)}function fi(m,s,c){let f;for(f in m[c])if(m[c].hasOwnProperty(f)&&f!=="data"&&!r.bn(m[c][f],s[c][f]))return!1;for(f in s[c])if(s[c].hasOwnProperty(f)&&f!=="data"&&!r.bn(m[c][f],s[c][f]))return!1;return!0}function jn(m,s,c,f,y,b){let E;for(E in s=s||{},m=m||{})m.hasOwnProperty(E)&&(r.bn(m[E],s[E])||c.push({command:b,args:[f,E,s[E],y]}));for(E in s)s.hasOwnProperty(E)&&!m.hasOwnProperty(E)&&(r.bn(m[E],s[E])||c.push({command:b,args:[f,E,s[E],y]}))}function kn(m){return m.id}function Xo(m,s){return m[s.id]=s,m}class ih{constructor(s,c){this.reset(s,c)}reset(s,c){this.points=s||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=r.ay(s,0,1);let c=1,f=this._distances[c],y=s*this.paddedLength+this.padding;for(;f<y&&c<this._distances.length;)f=this._distances[++c];let b=c-1,E=this._distances[b],R=f-E,P=R>0?(y-E)/R:0;return this.points[b].mult(1-P).add(this.points[c].mult(P))}}class Vn{constructor(s,c,f){let y=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(s/f),this.yCellCount=Math.ceil(c/f);for(let E=0;E<this.xCellCount*this.yCellCount;E++)y.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=c,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,c,f,y,b){this._forEachCell(c,f,y,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(y),this.bboxes.push(b)}insertCircle(s,c,f,y){this._forEachCell(c-y,f-y,c+y,f+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(c),this.circles.push(f),this.circles.push(y)}_insertBoxCell(s,c,f,y,b,E){this.boxCells[b].push(E)}_insertCircleCell(s,c,f,y,b,E){this.circleCells[b].push(E)}_query(s,c,f,y,b,E){if(f<0||s>this.width||y<0||c>this.height)return!b&&[];let R=[];if(s<=0&&c<=0&&this.width<=f&&this.height<=y){if(b)return!0;for(let P=0;P<this.boxKeys.length;P++)R.push({key:this.boxKeys[P],x1:this.bboxes[4*P],y1:this.bboxes[4*P+1],x2:this.bboxes[4*P+2],y2:this.bboxes[4*P+3]});for(let P=0;P<this.circleKeys.length;P++){let L=this.circles[3*P],F=this.circles[3*P+1],j=this.circles[3*P+2];R.push({key:this.circleKeys[P],x1:L-j,y1:F-j,x2:L+j,y2:F+j})}return E?R.filter(E):R}return this._forEachCell(s,c,f,y,this._queryCell,R,{hitTest:b,seenUids:{box:{},circle:{}}},E),b?R.length>0:R}_queryCircle(s,c,f,y,b){let E=s-f,R=s+f,P=c-f,L=c+f;if(R<0||E>this.width||L<0||P>this.height)return!y&&[];let F=[];return this._forEachCell(E,P,R,L,this._queryCellCircle,F,{hitTest:y,circle:{x:s,y:c,radius:f},seenUids:{box:{},circle:{}}},b),y?F.length>0:F}query(s,c,f,y,b){return this._query(s,c,f,y,!1,b)}hitTest(s,c,f,y,b){return this._query(s,c,f,y,!0,b)}hitTestCircle(s,c,f,y){return this._queryCircle(s,c,f,!0,y)}_queryCell(s,c,f,y,b,E,R,P){let L=R.seenUids,F=this.boxCells[b];if(F!==null){let U=this.bboxes;for(let W of F)if(!L.box[W]){L.box[W]=!0;let ie=4*W;if(s<=U[ie+2]&&c<=U[ie+3]&&f>=U[ie+0]&&y>=U[ie+1]&&(!P||P(this.boxKeys[W]))){if(R.hitTest)return E.push(!0),!0;E.push({key:this.boxKeys[W],x1:U[ie],y1:U[ie+1],x2:U[ie+2],y2:U[ie+3]})}}}let j=this.circleCells[b];if(j!==null){let U=this.circles;for(let W of j)if(!L.circle[W]){L.circle[W]=!0;let ie=3*W;if(this._circleAndRectCollide(U[ie],U[ie+1],U[ie+2],s,c,f,y)&&(!P||P(this.circleKeys[W]))){if(R.hitTest)return E.push(!0),!0;{let Q=U[ie],re=U[ie+1],oe=U[ie+2];E.push({key:this.circleKeys[W],x1:Q-oe,y1:re-oe,x2:Q+oe,y2:re+oe})}}}}}_queryCellCircle(s,c,f,y,b,E,R,P){let L=R.circle,F=R.seenUids,j=this.boxCells[b];if(j!==null){let W=this.bboxes;for(let ie of j)if(!F.box[ie]){F.box[ie]=!0;let Q=4*ie;if(this._circleAndRectCollide(L.x,L.y,L.radius,W[Q+0],W[Q+1],W[Q+2],W[Q+3])&&(!P||P(this.boxKeys[ie])))return E.push(!0),!0}}let U=this.circleCells[b];if(U!==null){let W=this.circles;for(let ie of U)if(!F.circle[ie]){F.circle[ie]=!0;let Q=3*ie;if(this._circlesCollide(W[Q],W[Q+1],W[Q+2],L.x,L.y,L.radius)&&(!P||P(this.circleKeys[ie])))return E.push(!0),!0}}}_forEachCell(s,c,f,y,b,E,R,P){let L=this._convertToXCellCoord(s),F=this._convertToYCellCoord(c),j=this._convertToXCellCoord(f),U=this._convertToYCellCoord(y);for(let W=L;W<=j;W++)for(let ie=F;ie<=U;ie++)if(b.call(this,s,c,f,y,this.xCellCount*ie+W,E,R,P))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,c,f,y,b,E){let R=y-s,P=b-c,L=f+E;return L*L>R*R+P*P}_circleAndRectCollide(s,c,f,y,b,E,R){let P=(E-y)/2,L=Math.abs(s-(y+P));if(L>P+f)return!1;let F=(R-b)/2,j=Math.abs(c-(b+F));if(j>F+f)return!1;if(L<=P||j<=F)return!0;let U=L-P,W=j-F;return U*U+W*W<=f*f}}let To={unknown:0,flipRequired:1,flipNotRequired:2},yu=Math.tan(85*Math.PI/180);function Lc(m,s,c,f,y,b,E){let R=r.ad.mat4.create();if(c)if(b.name==="globe"){let P=r.bo(y,s);r.ad.mat4.multiply(R,R,P)}else{let P=r.ad.mat2.invert([],E);R[0]=P[0],R[1]=P[1],R[4]=P[2],R[5]=P[3],f||r.ad.mat4.rotateZ(R,R,y.angle)}else r.ad.mat4.multiply(R,y.labelPlaneMatrix,m);return R}function ya(m,s,c,f,y,b,E){let R=Lc(m,s,c,f,y,b,E);return b.name==="globe"&&c||(R[2]=R[6]=R[10]=R[14]=0),R}function jr(m,s,c,f,y,b,E){if(c){if(b.name==="globe"){let R=Lc(m,s,c,f,y,b,E);return r.ad.mat4.invert(R,R),r.ad.mat4.multiply(R,m,R),R}{let R=r.ad.mat4.clone(m),P=r.ad.mat4.identity([]);return P[0]=E[0],P[1]=E[1],P[4]=E[2],P[5]=E[3],r.ad.mat4.multiply(R,R,P),f||r.ad.mat4.rotateZ(R,R,-y.angle),R}}return y.glCoordMatrix}function rn(m,s,c,f){let y=[m,s,c,1];c?r.ad.vec4.transformMat4(y,y,f):Do(y,y,f);let b=y[3];return y[0]/=b,y[1]/=b,y[2]/=b,y}function cr(m,s){return Math.min(.5+m/s*.5,1.5)}function ec(m,s){let c=m[0]/m[3],f=m[1]/m[3];return c>=-s[0]&&c<=s[0]&&f>=-s[1]&&f<=s[1]}function tc(m,s,c,f,y,b,E,R,P,L){let F=c.transform,j=f?m.textSizeData:m.iconSizeData,U=r.bp(j,c.transform.zoom),W=F.projection.name==="globe",ie=[256/c.width*2+1,256/c.height*2+1],Q=f?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;Q.clear();let re=null;W&&(re=f?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);let oe=m.lineVertexArray,me=f?m.text.placedSymbolArray:m.icon.placedSymbolArray,Me=c.transform.width/c.transform.height,Ee,Le=!1;for(let Ie=0;Ie<me.length;Ie++){let Ae=me.get(Ie),{numGlyphs:Re,writingMode:Ve}=Ae;if(Ve!==r.bq.vertical||Le||Ee===r.bq.horizontal||(Le=!0),Ee=Ve,(Ae.hidden||Ve===r.bq.vertical)&&!Le){Il(Re,Q);continue}Le=!1;let qe=new r.P(Ae.tileAnchorX,Ae.tileAnchorY),{x:dt,y:nt,z:Et}=F.projection.projectTilePoint(qe.x,qe.y,L.canonical);if(P){let[Xt,Qt,_i]=P(qe);dt+=Xt,nt+=Qt,Et+=_i}let Ct=[dt,nt,Et,1];if(r.ad.vec4.transformMat4(Ct,Ct,s),!ec(Ct,ie)){Il(Re,Q);continue}let Ut=Ct[3],tt=cr(c.transform.getCameraToCenterDistance(F.projection),Ut),xt=r.br(j,U,Ae),Qe=E?xt/tt:xt*tt,bt=rn(dt,nt,Et,y);if(bt[3]<=0){Il(Re,Q);continue}let _t={},St=r.ak(m.layers[0].layout.get("text-max-angle")),ht=Math.cos(St),At=E?null:P,Kt=Aa(Ae,Qe,!1,R,s,y,b,m.glyphOffsetArray,oe,Q,re,bt,qe,_t,Me,At,F.projection,L,E,ht);Le=Kt.useVertical,At&&Kt.needsFlipping&&(_t={}),(Kt.notEnoughRoom||Le||Kt.needsFlipping&&Aa(Ae,Qe,!0,R,s,y,b,m.glyphOffsetArray,oe,Q,re,bt,qe,_t,Me,At,F.projection,L,E,ht).notEnoughRoom)&&Il(Re,Q)}f?(m.text.dynamicLayoutVertexBuffer.updateData(Q),re&&m.text.globeExtVertexBuffer&&m.text.globeExtVertexBuffer.updateData(re)):(m.icon.dynamicLayoutVertexBuffer.updateData(Q),re&&m.icon.globeExtVertexBuffer&&m.icon.globeExtVertexBuffer.updateData(re))}function Ml(m,s,c,f,y,b,E,R,P,L,F,j,U,W,ie,Q,re){let{lineStartIndex:oe,glyphStartIndex:me,segment:Me}=R,Ee=me+R.numGlyphs,Le=oe+R.lineLength,Ie=s.getoffsetX(me),Ae=s.getoffsetX(Ee-1),Re=Jh(m*Ie,c,f,y,b,E,Me,oe,Le,P,L,F,j,U,!0,W,ie,Q,re);if(!Re)return null;let Ve=Jh(m*Ae,c,f,y,b,E,Me,oe,Le,P,L,F,j,U,!0,W,ie,Q,re);return Ve?{first:Re,last:Ve}:null}function id(m,s,c,f){return m===r.bq.horizontal&&Math.abs(f)>Math.abs(c)?{useVertical:!0}:m===r.bq.vertical?f>0?{needsFlipping:!0}:null:s!==To.unknown&&function(y,b){return y===0||Math.abs(b/y)>yu}(c,f)?s===To.flipRequired?{needsFlipping:!0}:null:c<0?{needsFlipping:!0}:null}function Aa(m,s,c,f,y,b,E,R,P,L,F,j,U,W,ie,Q,re,oe,me,Me){let Ee=s/24,Le=m.lineOffsetX*Ee,Ie=m.lineOffsetY*Ee,{lineStartIndex:Ae,glyphStartIndex:Re,numGlyphs:Ve,segment:qe,writingMode:dt,flipState:nt}=m,Et=Ae+m.lineLength,Ct=Ut=>{if(F){let[bt,_t,St]=Ut.up,ht=L.length;r.bs(F,ht+0,bt,_t,St),r.bs(F,ht+1,bt,_t,St),r.bs(F,ht+2,bt,_t,St),r.bs(F,ht+3,bt,_t,St)}let[tt,xt,Qe]=Ut.point;r.bt(L,tt,xt,Qe,Ut.angle)};if(Ve>1){let Ut=Ml(Ee,R,Le,Ie,c,j,U,m,P,b,W,Q,!1,re,oe,me,Me);if(!Ut)return{notEnoughRoom:!0};if(f&&!c){let[tt,xt,Qe]=Ut.first.point,[bt,_t,St]=Ut.last.point;[tt,xt]=rn(tt,xt,Qe,E),[bt,_t]=rn(bt,_t,St,E);let ht=id(dt,nt,(bt-tt)*ie,_t-xt);if(m.flipState=ht&&ht.needsFlipping?To.flipRequired:To.flipNotRequired,ht)return ht}Ct(Ut.first);for(let tt=Re+1;tt<Re+Ve-1;tt++){let xt=Jh(Ee*R.getoffsetX(tt),Le,Ie,c,j,U,qe,Ae,Et,P,b,W,Q,!1,!1,re,oe,me,Me);if(!xt)return L.length-=4*(tt-Re),{notEnoughRoom:!0};Ct(xt)}Ct(Ut.last)}else{if(f&&!c){let tt=rn(U.x,U.y,0,y),xt=Ae+qe+1,Qe=new r.P(P.getx(xt),P.gety(xt)),bt=rn(Qe.x,Qe.y,0,y),_t=bt[3]>0?bt:va(U,Qe,tt,1,y,void 0,re,oe.canonical),St=id(dt,nt,(_t[0]-tt[0])*ie,_t[1]-tt[1]);if(m.flipState=St&&St.needsFlipping?To.flipRequired:To.flipNotRequired,St)return St}let Ut=Jh(Ee*R.getoffsetX(Re),Le,Ie,c,j,U,qe,Ae,Et,P,b,W,Q,!1,!1,re,oe,me,Me);if(!Ut)return{notEnoughRoom:!0};Ct(Ut)}return{}}function ic(m,s,c,f,y){let{x:b,y:E,z:R}=f.projectTilePoint(m.x,m.y,s);if(!y)return rn(b,E,R,c);let[P,L,F]=y(m);return rn(b+P,E+L,R+F,c)}function va(m,s,c,f,y,b,E,R){let P=ic(m.sub(s)._unit()._add(m),R,y,E,b);return r.ad.vec3.sub(P,c,P),r.ad.vec3.normalize(P,P),r.ad.vec3.scaleAndAdd(P,c,P,f)}function Jh(m,s,c,f,y,b,E,R,P,L,F,j,U,W,ie,Q,re,oe,me){let Me=f?m-s:m+s,Ee=Me>0?1:-1,Le=0;f&&(Ee*=-1,Le=Math.PI),Ee<0&&(Le+=Math.PI);let Ie=R+E+(Ee>0?0:1)|0,Ae=y,Re=y,Ve=0,qe=0,dt=Math.abs(Me),nt=[],Et=[],Ct=b,Ut=Ct,tt=r.ad.vec3.zero([]),xt=()=>va(Ut,Ct,Re,dt-Ve+1,F,U,Q,re.canonical);for(;Ve+qe<=dt;){if(Ie+=Ee,Ie<R||Ie>=P)return null;if(Re=Ae,Ut=Ct,nt.push(Re),W&&Et.push(Ut),Ct=new r.P(L.getx(Ie),L.gety(Ie)),Ae=j[Ie],!Ae){let _i=ic(Ct,re.canonical,F,Q,U);Ae=_i[3]>0?j[Ie]=_i:xt()}Ve+=qe;let Xt=r.ad.vec3.sub([],Ae,Re),Qt=r.ad.vec3.distance(Re,Ae);if(c&&Qt>0&&qe>0&&r.ad.vec3.dot(tt,Xt)/(qe*Qt)<me)return null;qe=Qt,tt=Xt}ie&&U&&(j[Ie]&&(Ae=xt(),qe=r.ad.vec3.distance(Re,Ae),tt=r.ad.vec3.sub([],Ae,Re)),j[Ie]=Ae);let Qe=(dt-Ve)/qe,bt=Ct.sub(Ut)._mult(Qe)._add(Ut),_t=r.ad.vec3.scaleAndAdd([],Re,tt,Qe),St=[0,0,1],ht=tt[0],At=tt[1];if(oe&&(St=Q.upVector(re.canonical,bt.x,bt.y),St[0]!==0||St[1]!==0||St[2]!==1)){let Xt=[St[2],0,-St[0]],Qt=r.ad.vec3.cross([],St,Xt);r.ad.vec3.normalize(Xt,Xt),r.ad.vec3.normalize(Qt,Qt),ht=r.ad.vec3.dot(tt,Xt),At=r.ad.vec3.dot(tt,Qt)}if(c){let Xt=r.ad.vec3.cross([],St,tt);r.ad.vec3.normalize(Xt,Xt),r.ad.vec3.scaleAndAdd(_t,_t,Xt,c*Ee)}let Kt=Le+Math.atan2(At,ht);return nt.push(_t),W&&Et.push(bt),{point:_t,angle:Kt,path:nt,tilePath:Et,up:St}}function Il(m,s){let c=s.length,f=c+4*m;s.resize(f),s.float32.fill(-1/0,4*c,4*f)}function Do(m,s,c){let f=s[0],y=s[1];return m[0]=c[0]*f+c[4]*y+c[12],m[1]=c[1]*f+c[5]*y+c[13],m[3]=c[3]*f+c[7]*y+c[15],m}let Qo=100;class Fc{constructor(s,c,f=new Vn(s.width+200,s.height+200,25),y=new Vn(s.width+200,s.height+200,25)){this.transform=s,this.grid=f,this.ignoredGrid=y,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+Qo,this.screenBottomBoundary=s.height+Qo,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.fogState=c}placeCollisionBox(s,c,f,y,b,E,R,P){let L=f.projectedAnchorX,F=f.projectedAnchorY,j=f.projectedAnchorZ,U=f.elevation,W=f.tileID,ie=s.getProjection();if(U&&W){let[Ie,Ae,Re]=ie.upVector(W.canonical,f.tileAnchorX,f.tileAnchorY),Ve=ie.upVectorScale(W.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;L+=Ie*U*Ve,F+=Ae*U*Ve,j+=Re*U*Ve}let Q=this.projectAndGetPerspectiveRatio(R,L,F,j,f.tileID,ie.name==="globe"||!!U||this.transform.pitch>0,ie),re=E*Q.perspectiveRatio,oe=(f.x1*c+y.x-f.padding)*re+Q.point.x,me=(f.y1*c+y.y-f.padding)*re+Q.point.y,Me=(f.x2*c+y.x+f.padding)*re+Q.point.x,Ee=(f.y2*c+y.y+f.padding)*re+Q.point.y,Le=Q.perspectiveRatio<=.55||Q.occluded;return!this.isInsideGrid(oe,me,Me,Ee)||!b&&this.grid.hitTest(oe,me,Me,Ee,P)||Le?{box:[],offscreen:!1,occluded:Q.occluded}:{box:[oe,me,Me,Ee],offscreen:this.isOffscreen(oe,me,Me,Ee),occluded:!1}}placeCollisionCircles(s,c,f,y,b,E,R,P,L,F,j,U,W,ie,Q){let re=[],oe=this.transform.elevation,me=s.getProjection(),Me=oe?oe.getAtTileOffsetFunc(Q,this.transform.center.lat,this.transform.worldSize,me):null,Ee=new r.P(f.tileAnchorX,f.tileAnchorY),{x:Le,y:Ie,z:Ae}=me.projectTilePoint(Ee.x,Ee.y,Q.canonical);if(Me){let[St,ht,At]=Me(Ee);Le+=St,Ie+=ht,Ae+=At}let Re=me.name==="globe",Ve=this.projectAndGetPerspectiveRatio(R,Le,Ie,Ae,Q,Re||!!oe||this.transform.pitch>0,me),{perspectiveRatio:qe}=Ve,dt=(j?E/qe:E*qe)/r.bw,nt=rn(Le,Ie,Ae,P),Et=f.lineOffsetX*dt,Ct=f.lineOffsetY*dt,Ut=r.ak(s.layers[0].layout.get("text-max-angle")),tt=Math.cos(Ut),xt=Ve.signedDistanceFromCamera>0?Ml(dt,b,Et,Ct,!1,nt,Ee,f,y,P,{},oe&&!j?Me:null,j&&!!oe,me,Q,j,tt):null,Qe=!1,bt=!1,_t=!0;if(xt&&!Ve.occluded){let St=.5*W*qe+ie,ht=new r.P(-100,-100),At=new r.P(this.screenRightBoundary,this.screenBottomBoundary),Kt=new ih,{first:Xt,last:Qt}=xt,_i=Xt.path.length,tn=[];for(let Fi=_i-1;Fi>=1;Fi--)tn.push(Xt.path[Fi]);for(let Fi=1;Fi<Qt.path.length;Fi++)tn.push(Qt.path[Fi]);let ki=2.5*St;L&&(tn=tn.map(([Fi,An,tr],Lr)=>(Me&&!Re&&(tr=Me(Lr<_i-1?Xt.tilePath[_i-1-Lr]:Qt.tilePath[Lr-_i+2])[2]),rn(Fi,An,tr,L))),tn.some(Fi=>Fi[3]<=0)&&(tn=[]));let Ki=[];if(tn.length>0){let Fi=1/0,An=-1/0,tr=1/0,Lr=-1/0;for(let vn of tn)Fi=Math.min(Fi,vn[0]),tr=Math.min(tr,vn[1]),An=Math.max(An,vn[0]),Lr=Math.max(Lr,vn[1]);An>=ht.x&&Fi<=At.x&&Lr>=ht.y&&tr<=At.y&&(Ki=[tn.map(vn=>new r.P(vn[0],vn[1]))],(Fi<ht.x||An>At.x||tr<ht.y||Lr>At.y)&&(Ki=r.bu(Ki,ht.x,ht.y,At.x,At.y)))}for(let Fi of Ki){Kt.reset(Fi,.25*St);let An=0;An=Kt.length<=.5*St?1:Math.ceil(Kt.paddedLength/ki)+1;for(let tr=0;tr<An;tr++){let Lr=tr/Math.max(An-1,1),vn=Kt.lerp(Lr),Yr=vn.x+Qo,on=vn.y+Qo;re.push(Yr,on,St,0);let yi=Yr-St,Pn=on-St,dr=Yr+St,Yn=on+St;if(_t=_t&&this.isOffscreen(yi,Pn,dr,Yn),bt=bt||this.isInsideGrid(yi,Pn,dr,Yn),!c&&this.grid.hitTestCircle(Yr,on,St,U)&&(Qe=!0,!F))return{circles:[],offscreen:!1,collisionDetected:Qe,occluded:!1}}}}return{circles:!F&&Qe||!bt?[]:re,offscreen:_t,collisionDetected:Qe,occluded:Ve.occluded}}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let c=[],f=1/0,y=1/0,b=-1/0,E=-1/0;for(let F of s){let j=new r.P(F.x+Qo,F.y+Qo);f=Math.min(f,j.x),y=Math.min(y,j.y),b=Math.max(b,j.x),E=Math.max(E,j.y),c.push(j)}let R=this.grid.query(f,y,b,E).concat(this.ignoredGrid.query(f,y,b,E)),P={},L={};for(let F of R){let j=F.key;if(P[j.bucketInstanceId]===void 0&&(P[j.bucketInstanceId]={}),P[j.bucketInstanceId][j.featureIndex])continue;let U=[new r.P(F.x1,F.y1),new r.P(F.x2,F.y1),new r.P(F.x2,F.y2),new r.P(F.x1,F.y2)];r.bv(c,U)&&(P[j.bucketInstanceId][j.featureIndex]=!0,L[j.bucketInstanceId]===void 0&&(L[j.bucketInstanceId]=[]),L[j.bucketInstanceId].push(j.featureIndex))}return L}insertCollisionBox(s,c,f,y,b){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:y,collisionGroupID:b},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,c,f,y,b){let E=c?this.ignoredGrid:this.grid,R={bucketInstanceId:f,featureIndex:y,collisionGroupID:b};for(let P=0;P<s.length;P+=4)E.insertCircle(R,s[P],s[P+1],s[P+2])}projectAndGetPerspectiveRatio(s,c,f,y,b,E,R){let P=[c,f,y,1],L=!1;y||this.transform.pitch>0?(r.ad.vec4.transformMat4(P,P,s),this.fogState&&b&&R.name!=="globe"&&(L=function(U,W,ie,Q,re,oe){let me=oe.calculateFogTileMatrix(re),Me=[W,ie,Q];return r.ad.vec3.transformMat4(Me,Me,me),ei(U,r.ad.vec3.length(Me),oe.pitch,oe._fov)}(this.fogState,c,f,y,b.toUnwrapped(),this.transform)>.9)):Do(P,P,s);let F=P[3];return{point:new r.P((P[0]/F+1)/2*this.transform.width+Qo,(-P[1]/F+1)/2*this.transform.height+Qo),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(R)/F*.5,1.5),signedDistanceFromCamera:F,occluded:E&&P[2]>F||L}}isOffscreen(s,c,f,y){return f<Qo||s>=this.screenRightBoundary||y<Qo||c>this.screenBottomBoundary}isInsideGrid(s,c,f,y){return f>=0&&s<this.gridRightBoundary&&y>=0&&c<this.gridBottomBoundary}getViewportMatrix(){let s=r.ad.mat4.identity([]);return r.ad.mat4.translate(s,s,[-100,-100,0]),s}}function mo(m,s,c){let f=s.createTileMatrix(m,m.worldSize,c.toUnwrapped());return r.ad.mat4.multiply(new Float32Array(16),m.projMatrix,f)}function qm(m,s,c){if(s.projection.name===c.projection.name)return m.projMatrix;let f=c.clone();return f.setProjection(s.projection),mo(f,s.getProjection(),m)}function Us(m,s,c){return s.name===c.projection.name?m.projMatrix:mo(c,s,m)}class nh{constructor(s,c,f,y){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?c:-c))):y&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class vu{constructor(s,c,f,y,b,E=!1){this.text=new nh(s?s.text:null,c,f,b),this.icon=new nh(s?s.icon:null,c,y,b),this.clipped=E}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class zc{constructor(s,c,f,y=!1){this.text=s,this.icon=c,this.skipFade=f,this.clipped=y}}class nc{constructor(){this.invProjMatrix=r.ad.mat4.create(),this.viewportMatrix=r.ad.mat4.create(),this.circles=[]}}class Bc{constructor(s,c,f,y,b){this.bucketInstanceId=s,this.featureIndex=c,this.sourceLayerIndex=f,this.bucketIndex=y,this.tileID=b}}class W0{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){let c=++this.maxGroupID;this.collisionGroups[s]={ID:c,predicate:f=>f.collisionGroupID===c}}return this.collisionGroups[s]}}function rh(m,s,c,f,y){let{horizontalAlign:b,verticalAlign:E}=r.bD(m),R=-(b-.5)*s,P=-(E-.5)*c,L=r.bC(m,f);return new r.P(R+L[0]*y,P+L[1]*y)}function qa(m,s,c,f,y){let b=new r.P(m,s);return c&&b._rotate(f?y:-y),b}class Bv{constructor(s,c,f,y,b,E){this.transform=s.clone(),this.projection=s.projection.name,this.collisionIndex=new Fc(this.transform,b),this.buildingIndex=E,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new W0(f),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,c,f,y,b=1){let E=f.getBucket(c),R=f.latestFeatureIndex;if(!E||!R||c.fqid!==E.layerIds[0])return;let P=E.layers[0].layout,L=E.layers[0].paint,F=f.collisionBoxArray,j=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),U=f.tileSize/r.ai,W=f.tileID.toUnwrapped();this.transform.setProjection(E.projection);let ie=(Q=f.tileID,re=E.getProjection(),oe=this.transform,re.name===this.projection?oe.calculateProjMatrix(Q.toUnwrapped()):mo(oe,re,Q));var Q,re,oe;let me=P.get("text-pitch-alignment")==="map",Me=P.get("text-rotation-alignment")==="map";c.compileFilter(c.options);let Ee=c.dynamicFilter(),Le=c.dynamicFilterNeedsFeature(),Ie=this.transform.calculatePixelsToTileUnitsMatrix(f),Ae=ya(ie,f.tileID.canonical,me,Me,this.transform,E.getProjection(),Ie),Re=null;if(me){let xt=jr(ie,f.tileID.canonical,me,Me,this.transform,E.getProjection(),Ie);Re=r.ad.mat4.multiply([],this.transform.labelPlaneMatrix,xt)}let Ve=null;Ee&&f.latestFeatureIndex&&(Ve={unwrappedTileID:W,dynamicFilter:Ee,dynamicFilterNeedsFeature:Le}),this.retainedQueryData[E.bucketInstanceId]=new Bc(E.bucketInstanceId,R,E.sourceLayerIndex,E.index,f.tileID);let[qe,dt]=E.layers[0].layout.get("text-size-scale-range"),nt=r.ay(b,qe,dt),[Et,Ct]=P.get("icon-size-scale-range"),Ut=r.ay(b,Et,Ct),tt={bucket:E,layout:P,paint:L,posMatrix:ie,textLabelPlaneMatrix:Ae,labelToScreenMatrix:Re,clippingData:Ve,scale:j,textPixelRatio:U,holdingForFade:f.holdingForFade(),collisionBoxArray:F,partiallyEvaluatedTextSize:r.bp(E.textSizeData,this.transform.zoom,nt),partiallyEvaluatedIconSize:r.bp(E.iconSizeData,this.transform.zoom,Ut),collisionGroup:this.collisionGroups.get(E.sourceID),latestFeatureIndex:f.latestFeatureIndex};if(y)for(let xt of E.sortKeyRanges){let{sortKey:Qe,symbolInstanceStart:bt,symbolInstanceEnd:_t}=xt;s.push({sortKey:Qe,symbolInstanceStart:bt,symbolInstanceEnd:_t,parameters:tt})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:tt})}attemptAnchorPlacement(s,c,f,y,b,E,R,P,L,F,j,U,W,ie,Q,re,oe,me){let{textOffset0:Me,textOffset1:Ee,crossTileID:Le}=U,Ie=[Me,Ee],Ae=rh(s,f,y,Ie,b),Re=this.collisionIndex.placeCollisionBox(ie,b,c,qa(Ae.x,Ae.y,E,R,this.transform.angle),j,P,L,F.predicate);if(re){let Ve=ie.getSymbolInstanceIconSize(me,this.transform.zoom,U.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ie,Ve,re,qa(Ae.x,Ae.y,E,R,this.transform.angle),j,P,L,F.predicate).box.length===0)return}if(Re.box.length>0){let Ve;return this.prevPlacement&&this.prevPlacement.variableOffsets[Le]&&this.prevPlacement.placements[Le]&&this.prevPlacement.placements[Le].text&&(Ve=this.prevPlacement.variableOffsets[Le].anchor),this.variableOffsets[Le]={textOffset:Ie,width:f,height:y,anchor:s,textScale:b,prevAnchor:Ve},this.markUsedJustification(ie,s,U,Q),ie.allowVerticalPlacement&&(this.markUsedOrientation(ie,Q,U),this.placedOrientations[Le]=Q),{shift:Ae,placedGlyphBoxes:Re}}}placeLayerBucketPart(s,c,f,y,b=1){let{bucket:E,layout:R,paint:P,posMatrix:L,textLabelPlaneMatrix:F,labelToScreenMatrix:j,clippingData:U,textPixelRatio:W,holdingForFade:ie,collisionBoxArray:Q,partiallyEvaluatedTextSize:re,partiallyEvaluatedIconSize:oe,collisionGroup:me,latestFeatureIndex:Me}=s.parameters,Ee=R.get("text-optional"),Le=R.get("icon-optional"),Ie=R.get("text-allow-overlap"),Ae=R.get("icon-allow-overlap"),Re=R.get("text-rotation-alignment")==="map",Ve=R.get("text-pitch-alignment")==="map",qe=P.get("symbol-z-offset"),dt=R.get("symbol-elevation-reference")==="sea",[nt,Et]=R.get("text-size-scale-range"),[Ct,Ut]=R.get("icon-size-scale-range"),tt=r.ay(b,nt,Et),xt=r.ay(b,Ct,Ut);this.transform.setProjection(E.projection);let Qe=Ie&&(Ae||!E.hasIconData()||Le),bt=Ae&&(Ie||!E.hasTextData()||Ee),_t=!qe.isConstant();!E.collisionArrays&&Q&&E.deserializeCollisionBoxes(Q),f&&y&&E.updateCollisionDebugBuffers(this.transform.zoom,Q,tt,xt);let St=(ht,At,Kt)=>{let{crossTileID:Xt,numVerticalGlyphVertices:Qt}=ht,_i=null;if(U&&U.dynamicFilterNeedsFeature||_t){let Hn=this.retainedQueryData[E.bucketInstanceId];_i=Me.loadFeature({featureIndex:ht.featureIndex,bucketIndex:Hn.bucketIndex,sourceLayerIndex:Hn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(U&&!(0,U.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},_i,this.retainedQueryData[E.bucketInstanceId].tileID.canonical,new r.P(ht.tileAnchorX,ht.tileAnchorY),this.transform.calculateDistanceTileData(U.unwrappedTileID)))return this.placements[Xt]=new zc(!1,!1,!1,!0),void c.add(Xt);let tn=qe.evaluate(_i,{});if(c.has(Xt))return;if(ie)return void(this.placements[Xt]=new zc(!1,!1,!1));let ki=!1,Ki=!1,Fi=!0,An=!1,tr=!1,Lr=null,vn={box:null,offscreen:null,occluded:null},Yr={box:null,offscreen:null,occluded:null},on=null,yi=null,Pn=null,dr=0,Yn=0,co=0;Kt.textFeatureIndex?dr=Kt.textFeatureIndex:ht.useRuntimeCollisionCircles&&(dr=ht.featureIndex),Kt.verticalTextFeatureIndex&&(Yn=Kt.verticalTextFeatureIndex);let Lo=Hn=>{Hn.tileID=this.retainedQueryData[E.bucketInstanceId].tileID;let Kr=this.transform.elevation;Hn.elevation=dt?tn:tn+(Kr?Kr.getAtTileOffset(Hn.tileID,Hn.tileAnchorX,Hn.tileAnchorY):0),Hn.elevation+=ht.zOffset},Jo=Kt.textBox;if(Jo){Lo(Jo);let Hn=ir=>{let Tr=r.bq.horizontal;if(E.allowVerticalPlacement&&!ir&&this.prevPlacement){let Oa=this.prevPlacement.placedOrientations[Xt];Oa&&(this.placedOrientations[Xt]=Oa,Tr=Oa,this.markUsedOrientation(E,Tr,ht))}return Tr},Kr=(ir,Tr)=>{if(E.allowVerticalPlacement&&Qt>0&&Kt.verticalTextBox){for(let Oa of E.writingModes)if(Oa===r.bq.vertical?(vn=Tr(),Yr=vn):vn=ir(),vn&&vn.box&&vn.box.length)break}else vn=ir()};if(R.get("text-variable-anchor")){let ir=R.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Xt]){let Ur=this.prevPlacement.variableOffsets[Xt];ir.indexOf(Ur.anchor)>0&&(ir=ir.filter(ea=>ea!==Ur.anchor),ir.unshift(Ur.anchor))}let Tr=(Ur,ea,Tu)=>{let hl=E.getSymbolInstanceTextSize(re,ht,this.transform.zoom,At),dc=(Ur.x2-Ur.x1)*hl+2*Ur.padding,Ws=(Ur.y2-Ur.y1)*hl+2*Ur.padding,hc=ht.hasIconTextFit&&!Ae?ea:null;hc&&Lo(hc);let pl={box:[],offscreen:!1,occluded:!1},gd=Ie?2*ir.length:ir.length;for(let Du=0;Du<gd;++Du){let _d=this.attemptAnchorPlacement(ir[Du%ir.length],Ur,dc,Ws,hl,Re,Ve,W,L,me,Du>=ir.length,ht,At,E,Tu,hc,re,oe);if(_d&&(pl=_d.placedGlyphBoxes,pl&&pl.box&&pl.box.length)){ki=!0,Lr=_d.shift;break}}return pl};Kr(()=>Tr(Jo,Kt.iconBox,r.bq.horizontal),()=>{let Ur=Kt.verticalTextBox;return Ur&&Lo(Ur),E.allowVerticalPlacement&&!(vn&&vn.box&&vn.box.length)&&Qt>0&&Ur?Tr(Ur,Kt.verticalIconBox,r.bq.vertical):{box:null,offscreen:null,occluded:null}}),vn&&(ki=vn.box,Fi=vn.offscreen,An=vn.occluded);let Oa=Hn(!(!vn||!vn.box));if(!ki&&this.prevPlacement){let Ur=this.prevPlacement.variableOffsets[Xt];Ur&&(this.variableOffsets[Xt]=Ur,this.markUsedJustification(E,Ur.anchor,ht,Oa))}}else{let ir=(Tr,Oa)=>{let Ur=E.getSymbolInstanceTextSize(re,ht,this.transform.zoom,At,b),ea=this.collisionIndex.placeCollisionBox(E,Ur,Tr,new r.P(0,0),Ie,W,L,me.predicate);return ea&&ea.box&&ea.box.length&&(this.markUsedOrientation(E,Oa,ht),this.placedOrientations[Xt]=Oa),ea};Kr(()=>ir(Jo,r.bq.horizontal),()=>{let Tr=Kt.verticalTextBox;return E.allowVerticalPlacement&&Qt>0&&Tr?(Lo(Tr),ir(Tr,r.bq.vertical)):{box:null,offscreen:null,occluded:null}}),Hn(!!(vn&&vn.box&&vn.box.length))}}if(on=vn,ki=on&&on.box&&on.box.length>0,Fi=on&&on.offscreen,An=on&&on.occluded,ht.useRuntimeCollisionCircles){let Hn=E.text.placedSymbolArray.get(ht.centerJustifiedTextSymbolIndex>=0?ht.centerJustifiedTextSymbolIndex:ht.verticalPlacedTextSymbolIndex),Kr=r.br(E.textSizeData,re,Hn),ir=R.get("text-padding");yi=this.collisionIndex.placeCollisionCircles(E,Ie,Hn,E.lineVertexArray,E.glyphOffsetArray,Kr,L,F,j,f,Ve,me.predicate,ht.collisionCircleDiameter*Kr/r.bw,ir,this.retainedQueryData[E.bucketInstanceId].tileID),ki=Ie||yi.circles.length>0&&!yi.collisionDetected,Fi=Fi&&yi.offscreen,An=yi.occluded}if(Kt.iconFeatureIndex&&(co=Kt.iconFeatureIndex),Kt.iconBox){let Hn=Kr=>{Lo(Kr);let ir=ht.hasIconTextFit&&Lr?qa(Lr.x,Lr.y,Re,Ve,this.transform.angle):new r.P(0,0),Tr=E.getSymbolInstanceIconSize(oe,this.transform.zoom,ht.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(E,Tr,Kr,ir,Ae,W,L,me.predicate)};Yr&&Yr.box&&Yr.box.length&&Kt.verticalIconBox?(Pn=Hn(Kt.verticalIconBox),Ki=Pn.box.length>0):(Pn=Hn(Kt.iconBox),Ki=Pn.box.length>0),Fi=Fi&&Pn.offscreen,tr=Pn.occluded}let ha=Ee||ht.numHorizontalGlyphVertices===0&&Qt===0,Bl=Le||ht.numIconVertices===0;if(ha||Bl?Bl?ha||(Ki=Ki&&ki):ki=Ki&&ki:Ki=ki=Ki&&ki,ki&&on&&on.box&&this.collisionIndex.insertCollisionBox(on.box,R.get("text-ignore-placement"),E.bucketInstanceId,Yr&&Yr.box&&Yn?Yn:dr,me.ID),Ki&&Pn&&this.collisionIndex.insertCollisionBox(Pn.box,R.get("icon-ignore-placement"),E.bucketInstanceId,co,me.ID),yi&&(ki&&this.collisionIndex.insertCollisionCircles(yi.circles,R.get("text-ignore-placement"),E.bucketInstanceId,dr,me.ID),f)){let Hn=E.bucketInstanceId,Kr=this.collisionCircleArrays[Hn];Kr===void 0&&(Kr=this.collisionCircleArrays[Hn]=new nc);for(let ir=0;ir<yi.circles.length;ir+=4)Kr.circles.push(yi.circles[ir+0]),Kr.circles.push(yi.circles[ir+1]),Kr.circles.push(yi.circles[ir+2]),Kr.circles.push(yi.collisionDetected?1:0)}let ds=E.projection.name!=="globe";Qe=Qe&&(ds||!An),bt=bt&&(ds||!tr),this.placements[Xt]=new zc(ki||Qe,Ki||bt,Fi||E.justReloaded),c.add(Xt)};if(E.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(E,this.retainedQueryData[E.bucketInstanceId].tileID),E.elevationType==="road"&&E.updateRoadElevation(),E.updateZOffset(),E.sortFeaturesByY){let ht=E.getSortedSymbolIndexes(this.transform.angle);for(let At=ht.length-1;At>=0;--At){let Kt=ht[At];St(E.symbolInstances.get(Kt),Kt,E.collisionArrays[Kt])}E.hasAnyZOffset&&r.w(`${E.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(E.hasAnyZOffset){let ht=E.getSortedIndexesByZOffset();for(let At=0;At<ht.length;++At){let Kt=ht[At];St(E.symbolInstances.get(Kt),Kt,E.collisionArrays[Kt])}}else for(let ht=s.symbolInstanceStart;ht<s.symbolInstanceEnd;ht++)St(E.symbolInstances.get(ht),ht,E.collisionArrays[ht]);if(f&&E.bucketInstanceId in this.collisionCircleArrays){let ht=this.collisionCircleArrays[E.bucketInstanceId];r.ad.mat4.invert(ht.invProjMatrix,L),ht.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(s,c,f,y){let{leftJustifiedTextSymbolIndex:b,centerJustifiedTextSymbolIndex:E,rightJustifiedTextSymbolIndex:R,verticalPlacedTextSymbolIndex:P,crossTileID:L}=f,F=r.bB(c),j=y===r.bq.vertical?P:F==="left"?b:F==="center"?E:F==="right"?R:-1;b>=0&&(s.text.placedSymbolArray.get(b).crossTileID=j>=0&&b!==j?0:L),E>=0&&(s.text.placedSymbolArray.get(E).crossTileID=j>=0&&E!==j?0:L),R>=0&&(s.text.placedSymbolArray.get(R).crossTileID=j>=0&&R!==j?0:L),P>=0&&(s.text.placedSymbolArray.get(P).crossTileID=j>=0&&P!==j?0:L)}markUsedOrientation(s,c,f){let y=c===r.bq.horizontal||c===r.bq.horizontalOnly?c:0,b=c===r.bq.vertical?c:0,{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:R,rightJustifiedTextSymbolIndex:P,verticalPlacedTextSymbolIndex:L}=f,F=s.text.placedSymbolArray;E>=0&&(F.get(E).placedOrientation=y),R>=0&&(F.get(R).placedOrientation=y),P>=0&&(F.get(P).placedOrientation=y),L>=0&&(F.get(L).placedOrientation=b)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;let c=this.prevPlacement,f=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;let y=c?c.symbolFadeChange(s):1,b=c?c.opacities:{},E=c?c.variableOffsets:{},R=c?c.placedOrientations:{};for(let P in this.placements){let L=this.placements[P],F=b[P];F?(this.opacities[P]=new vu(F,y,L.text,L.icon,null,L.clipped),f=f||L.text!==F.text.placed||L.icon!==F.icon.placed):(this.opacities[P]=new vu(null,y,L.text,L.icon,L.skipFade,L.clipped),f=f||L.text||L.icon)}for(let P in b){let L=b[P];if(!this.opacities[P]){let F=new vu(L,y,!1,!1);F.isHidden()||(this.opacities[P]=F,f=f||L.text.placed||L.icon.placed)}}for(let P in E)this.variableOffsets[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.variableOffsets[P]=E[P]);for(let P in R)this.placedOrientations[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.placedOrientations[P]=R[P]);f?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:s)}updateLayerOpacities(s,c,f,y){let b=new Set;for(let E of c){let R=E.getBucket(s);R&&E.latestFeatureIndex&&s.fqid===R.layerIds[0]&&(this.updateBucketOpacities(R,b,E,E.collisionBoxArray,f,y,E.tileID,s.scope),R.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(R,E.tileID),R.elevationType==="road"&&R.updateRoadElevation(),R.updateZOffset())}}updateBucketOpacities(s,c,f,y,b,E,R,P){s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();let L=s.layers[0].layout,F=s.layers[0].paint,j=!!s.layers[0].dynamicFilter(),U=new vu(null,0,!1,!1,!0),W=L.get("text-allow-overlap"),ie=L.get("icon-allow-overlap"),Q=L.get("text-variable-anchor"),re=L.get("text-rotation-alignment")==="map",oe=L.get("text-pitch-alignment")==="map",me=F.get("symbol-z-offset"),Me=L.get("symbol-elevation-reference")==="sea",Ee=!me.isConstant(),Le=new vu(null,0,W&&(ie||!s.hasIconData()||L.get("icon-optional")),ie&&(W||!s.hasTextData()||L.get("text-optional")),!0);!s.collisionArrays&&y&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(y);let Ie=(Re,Ve,qe)=>{for(let dt=0;dt<Ve/4;dt++)Re.opacityVertexArray.emplaceBack(qe)},Ae=0;E&&s.updateReplacement(R,E);for(let Re=0;Re<s.symbolInstances.length;Re++){let Ve=s.symbolInstances.get(Re),{numHorizontalGlyphVertices:qe,numVerticalGlyphVertices:dt,crossTileID:nt,numIconVertices:Et,tileAnchorX:Ct,tileAnchorY:Ut}=Ve,tt=null,xt=this.retainedQueryData[s.bucketInstanceId];Ee&&Ve&&xt&&(tt=f.latestFeatureIndex.loadFeature({featureIndex:Ve.featureIndex,bucketIndex:xt.bucketIndex,sourceLayerIndex:xt.sourceLayerIndex,layoutVertexArrayOffset:0}));let Qe=me.evaluate(tt,{}),bt=c.has(nt),_t=this.opacities[nt];bt?_t=U:_t||(_t=Le,this.opacities[nt]=_t),c.add(nt);let St=qe>0||dt>0,ht=Et>0,At=this.placedOrientations[nt],Kt=At===r.bq.vertical,Xt=At===r.bq.horizontal||At===r.bq.horizontalOnly;!St&&!ht||_t.isHidden()||Ae++;let Qt=!1;if((St||ht)&&E)for(let _i of s.activeReplacements){if(r.bx(_i,b,r.by.Symbol,P)||_i.min.x>Ct||Ct>_i.max.x||_i.min.y>Ut||Ut>_i.max.y)continue;let tn=r.bz(Ct,Ut,R.canonical,_i.footprintTileId.canonical);if(Qt=r.bA(tn,_i.footprint),Qt)break}if(St){let _i=Qt?bu:rd(_t.text);Ie(s.text,qe,Kt?bu:_i),Ie(s.text,dt,Xt?bu:_i);let tn=_t.text.isHidden(),{leftJustifiedTextSymbolIndex:ki,centerJustifiedTextSymbolIndex:Ki,rightJustifiedTextSymbolIndex:Fi,verticalPlacedTextSymbolIndex:An}=Ve,tr=s.text.placedSymbolArray,Lr=tn||Kt?1:0;ki>=0&&(tr.get(ki).hidden=Lr),Ki>=0&&(tr.get(Ki).hidden=Lr),Fi>=0&&(tr.get(Fi).hidden=Lr),An>=0&&(tr.get(An).hidden=tn||Xt?1:0);let vn=this.variableOffsets[nt];vn&&this.markUsedJustification(s,vn.anchor,Ve,At);let Yr=this.placedOrientations[nt];Yr&&(this.markUsedJustification(s,"left",Ve,Yr),this.markUsedOrientation(s,Yr,Ve))}if(ht){let _i=Qt?bu:rd(_t.icon),{placedIconSymbolIndex:tn,verticalPlacedIconSymbolIndex:ki}=Ve,Ki=s.icon.placedSymbolArray,Fi=_t.icon.isHidden()?1:0;tn>=0&&(Ie(s.icon,Et,Kt?bu:_i),Ki.get(tn).hidden=Fi),ki>=0&&(Ie(s.icon,Ve.numVerticalIconVertices,Xt?bu:_i),Ki.get(ki).hidden=Fi)}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){let _i=s.collisionArrays[Re];if(_i){let tn=new r.P(0,0),ki=!0;if(_i.textBox||_i.verticalTextBox){if(Q){let Fi=this.variableOffsets[nt];Fi?(tn=rh(Fi.anchor,Fi.width,Fi.height,Fi.textOffset,Fi.textScale),re&&tn._rotate(oe?this.transform.angle:-this.transform.angle)):ki=!1}j&&(ki=!_t.clipped),_i.textBox&&nd(s.textCollisionBox.collisionVertexArray,_t.text.placed,!ki||Kt,Qe,Me,tn.x,tn.y),_i.verticalTextBox&&nd(s.textCollisionBox.collisionVertexArray,_t.text.placed,!ki||Xt,Qe,Me,tn.x,tn.y)}let Ki=ki&&!!(!Xt&&_i.verticalIconBox);_i.iconBox&&nd(s.iconCollisionBox.collisionVertexArray,_t.icon.placed,Ki,Qe,Me,Ve.hasIconTextFit?tn.x:0,Ve.hasIconTextFit?tn.y:0),_i.verticalIconBox&&nd(s.iconCollisionBox.collisionVertexArray,_t.icon.placed,!Ki,Qe,Me,Ve.hasIconTextFit?tn.x:0,Ve.hasIconTextFit?tn.y:0)}}}if(s.fullyClipped=Ae===0,s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){let Re=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=Re.invProjMatrix,s.placementViewportMatrix=Re.viewportMatrix,s.collisionCircleArray=Re.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,c){let f=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*f>s}setStale(){this.stale=!0}}function nd(m,s,c,f,y,b,E){m.emplaceBack(s?1:0,c?1:0,b||0,E||0,f,y?1:0),m.emplaceBack(s?1:0,c?1:0,b||0,E||0,f,y?1:0),m.emplaceBack(s?1:0,c?1:0,b||0,E||0,f,y?1:0),m.emplaceBack(s?1:0,c?1:0,b||0,E||0,f,y?1:0)}let Vc=Math.pow(2,25),ep=Math.pow(2,24),Vv=Math.pow(2,17),$m=Math.pow(2,16),tp=Math.pow(2,9),Ds=Math.pow(2,8),Gm=Math.pow(2,1);function rd(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;let s=m.placed?1:0,c=Math.floor(127*m.opacity);return c*Vc+s*ep+c*Vv+s*$m+c*tp+s*Ds+c*Gm+s}let bu=0;class od{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&s.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(s,c,f,y,b,E){let R=this._bucketParts;for(;this._currentTileIndex<s.length;)if(c.getBucketParts(R,y,s[this._currentTileIndex],this._sortAcrossTiles,E),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,R.sort((P,L)=>P.sortKey-L.sortKey));this._currentPartIndex<R.length;){let P=R[this._currentPartIndex];if(c.placeLayerBucketPart(P,this._seenCrossTileIDs,f,P.symbolInstanceStart===0,E),this._currentPartIndex++,b())return!0}return!1}}class Al{constructor(s,c,f,y,b,E,R,P,L){this.placement=new Bv(s,b,E,R,P,L),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(s,c,f,y,b){let E=r.q.now(),R=()=>{let P=r.q.now()-E;return!this._forceFullPlacement&&P>2};for(;this._currentPlacementIndex>=0;){let P=c[s[this._currentPlacementIndex]],L=this.placement.collisionIndex.transform.zoom;if(P.type==="symbol"&&(!P.minzoom||P.minzoom<=L)&&(!P.maxzoom||P.maxzoom>L)){let F=P,j=F.layout.get("symbol-z-elevate"),U=F.layout.get("symbol-sort-key").constantOr(1)!==void 0,W=F.layout.get("symbol-z-order"),ie=W==="viewport-y"||W==="auto"&&!(W!=="viewport-y"&&U),Q=F.layout.get("text-allow-overlap")||F.layout.get("icon-allow-overlap")||F.layout.get("text-ignore-placement")||F.layout.get("icon-ignore-placement"),re=ie&&Q,oe=this._inProgressLayer=this._inProgressLayer||new od(F),me=r.C(P.source,P.scope);if(oe.continuePlacement(j||re?y[me]:f[me],this.placement,this._showCollisionBoxes,P,R,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}let oh=512/r.ai/2;class Wm{constructor(s,c,f){this.tileID=s,this.bucketInstanceId=f,this.index=new r.bE(c.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];let y=s.canonical.x*r.ai,b=s.canonical.y*r.ai;for(let E=0;E<c.length;E++){let{key:R,crossTileID:P,tileAnchorX:L,tileAnchorY:F}=c.get(E),j=Math.floor((y+L)*oh),U=Math.floor((b+F)*oh);this.index.add(j,U),this.keys.push(R),this.crossTileIDs.push(P)}this.index.finish()}findMatches(s,c,f){let y=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z),b=oh/Math.pow(2,c.canonical.z-this.tileID.canonical.z),E=c.canonical.x*r.ai,R=c.canonical.y*r.ai;for(let P=0;P<s.length;P++){let L=s.get(P);if(L.crossTileID)continue;let{key:F,tileAnchorX:j,tileAnchorY:U}=L,W=Math.floor((E+j)*b),ie=Math.floor((R+U)*b),Q=this.index.range(W-y,ie-y,W+y,ie+y);for(let re of Q){let oe=this.crossTileIDs[re];if(this.keys[re]===F&&!f.has(oe)){f.add(oe),L.crossTileID=oe;break}}}}}class xu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ip{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){let c=Math.round((s-this.lng)/360);if(c!==0)for(let f in this.indexes){let y=this.indexes[f],b={};for(let E in y){let R=y[E];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+c),b[R.tileID.key]=R}this.indexes[f]=b}this.lng=s}addBucket(s,c,f){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let b=0;b<c.symbolInstances.length;b++)c.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]=new Set);let y=this.usedCrossTileIDs[s.overscaledZ];for(let b in this.indexes){let E=this.indexes[b];if(Number(b)>s.overscaledZ)for(let R in E){let P=E[R];P.tileID.isChildOf(s)&&P.findMatches(c.symbolInstances,s,y)}else{let R=E[s.scaledTo(Number(b)).key];R&&R.findMatches(c.symbolInstances,s,y)}}for(let b=0;b<c.symbolInstances.length;b++){let E=c.symbolInstances.get(b);E.crossTileID||(E.crossTileID=f.generate(),y.add(E.crossTileID))}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new Wm(s,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(s,c){for(let f of c.crossTileIDs)this.usedCrossTileIDs[s].delete(f)}removeStaleBuckets(s){let c=!1;for(let f in this.indexes){let y=this.indexes[f];for(let b in y)s[y[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,y[b]),delete y[b],c=!0)}return c}}class Z0{constructor(){this.layerIndexes={},this.crossTileIDs=new xu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,c,f,y){let b=this.layerIndexes[s.fqid];b===void 0&&(b=this.layerIndexes[s.fqid]=new ip);let E=!1,R={};y.name!=="globe"&&b.handleWrapJump(f);for(let P of c){let L=P.getBucket(s);L&&s.fqid===L.layerIds[0]&&(L.bucketInstanceId||(L.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(P.tileID,L,this.crossTileIDs)&&(E=!0),R[L.bucketInstanceId]=!0)}return b.removeStaleBuckets(R)&&(E=!0),E}pruneUnusedLayers(s){let c={};s.forEach(f=>{c[f]=!0});for(let f in this.layerIndexes)c[f]||delete this.layerIndexes[f]}}let wu=771;class _n{constructor(s,c,f,y){this.blendFunction=s,this.blendColor=c,this.mask=f,this.blendEquation=y}}_n.Replace=[1,0,1,0],_n.disabled=new _n(_n.Replace,r.al.transparent,[!1,!1,!1,!1]),_n.unblended=new _n(_n.Replace,r.al.transparent,[!0,!0,!0,!0]),_n.alphaBlended=new _n([1,wu,1,wu],r.al.transparent,[!0,!0,!0,!0]),_n.alphaBlendedNonPremultiplied=new _n([770,wu,770,wu],r.al.transparent,[!0,!0,!0,!0]),_n.multiply=new _n([774,0,774,0],r.al.transparent,[!0,!0,!0,!0]);class xi{constructor(s,c,f){this.func=s,this.mask=c,this.range=f}}xi.ReadOnly=!1,xi.ReadWrite=!0,xi.disabled=new xi(519,xi.ReadOnly,[0,1]);let ef=7680;class en{constructor(s,c,f,y,b,E){this.test=s,this.ref=c,this.mask=f,this.fail=y,this.depthFail=b,this.pass=E}}en.disabled=new en({func:519,mask:0},0,0,ef,ef,ef);let jc=1029,ah=2305;class Vi{constructor(s,c,f){this.enable=s,this.mode=c,this.frontFace=f}}function sh(m,s){let c=r.bG(m,3);r.ad.mat4.fromQuat(m,s),r.bI(m,3,c)}function ad(m,s){let c=r.ad.quat.identity([]);return r.ad.quat.rotateZ(c,c,-s),r.ad.quat.rotateX(c,c,-m),c}function lh(m,s){let c=[m[0],m[1],0],f=[s[0],s[1],0];if(r.ad.vec3.length(c)>=1e-15){let E=r.ad.vec3.normalize([],c);r.ad.vec3.scale(f,E,r.ad.vec3.dot(f,E)),s[0]=f[0],s[1]=f[1]}let y=r.ad.vec3.cross([],s,m);if(r.ad.vec3.len(y)<1e-15)return null;let b=Math.atan2(-y[1],y[0]);return ad(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),b)}Vi.disabled=new Vi(!1,jc,ah),Vi.backCCW=new Vi(!0,jc,ah),Vi.backCW=new Vi(!0,jc,2304),Vi.frontCW=new Vi(!0,1028,2304),Vi.frontCCW=new Vi(!0,1028,ah);class tf{constructor(s,c){this.position=s,this.orientation=c}get position(){return this._position}set position(s){if(s){let c=s instanceof r.ac?s:new r.ac(s[0],s[1],s[2]);this._renderWorldCopies&&(c.x=r.bF(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(s,c){if(this.orientation=null,!this.position)return;let f=this.position,y=this._elevation?this._elevation.getAtPointOrZero(r.ac.fromLngLat(s)):0,b=r.ac.fromLngLat(s,y),E=[b.x-f.x,b.y-f.y,b.z-f.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=lh(E,c)}setPitchBearing(s,c){this.orientation=ad(r.ak(s),r.ak(-c))}}class Eu{constructor(s,c){this._transform=r.ad.mat4.identity([]),this.orientation=c,this.position=s}get mercatorPosition(){let s=this.position;return new r.ac(s[0],s[1],s[2])}get position(){let s=r.bG(this._transform,3);return[s[0],s[1],s[2]]}set position(s){var c;s&&r.bI(this._transform,3,[(c=s)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(s){this._orientation=s||r.ad.quat.identity([]),s&&sh(this._transform,this._orientation)}getPitchBearing(){let s=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(s[0]*s[0]+s[1]*s[1]),-s[2])}}setPitchBearing(s,c){this._orientation=ad(s,c),sh(this._transform,this._orientation)}forward(){let s=r.bG(this._transform,2);return[-s[0],-s[1],-s[2]]}up(){let s=r.bG(this._transform,1);return[-s[0],-s[1],-s[2]]}right(){let s=r.bG(this._transform,0);return[s[0],s[1],s[2]]}getCameraToWorld(s,c){let f=new Float64Array(16);return r.ad.mat4.invert(f,this.getWorldToCamera(s,c)),f}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(s,c,f){let y=this.position;r.ad.vec3.scale(y,y,-s);let b=new Float64Array(16);return r.ad.mat4.fromScaling(b,[f,f,f]),r.ad.mat4.translate(b,b,y),b[10]*=c,b}getWorldToCamera(s,c){let f=new Float64Array(16),y=new Float64Array(4),b=this.position;return r.ad.quat.conjugate(y,this._orientation),r.ad.vec3.scale(b,b,-s),r.ad.mat4.fromQuat(f,y),r.ad.mat4.translate(f,f,b),f[1]*=-1,f[5]*=-1,f[9]*=-1,f[13]*=-1,f[8]*=c,f[9]*=c,f[10]*=c,f[11]*=c,f}getCameraToClipPerspective(s,c,f,y){let b=new Float64Array(16);return r.ad.mat4.perspective(b,s,c,f,y),b}getCameraToClipOrthographic(s,c,f,y,b,E){let R=new Float64Array(16);return r.ad.mat4.ortho(R,s,c,f,y,b,E),R}getDistanceToElevation(s,c=!1){let f=s===0?0:r.bH(s,c?r.aT(this.position[1]):this.position[1]),y=this.forward();return(f-this.position[2])/y[2]}clone(){return new Eu([...this.position],[...this.orientation])}}let eo={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class np{constructor(s=0,c=0,f=0,y=0){if(isNaN(s)||s<0||isNaN(c)||c<0||isNaN(f)||f<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=c,this.left=f,this.right=y}interpolate(s,c,f){return c.top!=null&&s.top!=null&&(this.top=r.ah(s.top,c.top,f)),c.bottom!=null&&s.bottom!=null&&(this.bottom=r.ah(s.bottom,c.bottom,f)),c.left!=null&&s.left!=null&&(this.left=r.ah(s.left,c.left,f)),c.right!=null&&s.right!=null&&(this.right=r.ah(s.right,c.right,f)),this}getCenter(s,c){let f=r.ay((this.left+s-this.right)/2,0,s),y=r.ay((this.top+c-this.bottom)/2,0,c);return new r.P(f,y)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new np(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}let $t=15;class rp{constructor(s,c,f,y,b,E,R){this.tileSize=512,this._renderWorldCopies=b===void 0||b,this._minZoom=s||0,this._maxZoom=c||22,this._minPitch=f??0,this._maxPitch=y??60,this.setProjection(E),this.setMaxBounds(R),this.width=0,this.height=0,this._center=new r.bO(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new np,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Eu,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){let s=new rp(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return s._elevation=this._elevation,s._centerAltitude=this._centerAltitude,s._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,s.tileSize=this.tileSize,s.mercatorFromTransition=this.mercatorFromTransition,s.width=this.width,s.height=this.height,s.cameraElevationReference=this.cameraElevationReference,s._center=this._center,s._setZoom(this.zoom),s._seaLevelZoom=this._seaLevelZoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._nearZ=this._nearZ,s._farZ=this._farZ,s._averageElevation=this._averageElevation,s._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._camera=this._camera.clone(),s._calcMatrices(),s.freezeTileCoverage=this.freezeTileCoverage,s.frustumCorners=this.frustumCorners,s._allowWorldUnderZoom=this._allowWorldUnderZoom,s}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<$t}get elevation(){return this._elevation}set elevation(s){this._elevation!==s&&(this._elevation=s,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(s,c=!1){let f=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||f)&&this._updateCameraOnTerrain(),(s||f)&&this._constrainCamera(c),this._calcMatrices()}getProjection(){return r.aA(this.projection,["name","center","parallels"])}setProjection(s){this.projectionOptions=s||{name:"mercator"};let c=this.projection?this.getProjection():void 0;this.projection=r.bP(this.projectionOptions);let f=this.getProjection(),y=!r.bn(c,f);return y&&this._calcMatrices(),this.mercatorFromTransition=!1,y}setOrthographicProjectionAtLowPitch(s){return this._orthographicProjectionAtLowPitch!==s&&(this._orthographicProjectionAtLowPitch=s,this._calcMatrices(),!0)}setMercatorFromTransition(){let s=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=r.bP({name:"mercator"});let c=s!==this.projection.name;return c&&this._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){let s=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get cameraWorldSize(){let s=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return r.bH(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new r.P(this.width,this.height)}get bearing(){return r.bF(this.rotation,-180,180)}set bearing(s){this.rotation=s}get rotation(){return-this.angle/Math.PI*180}set rotation(s){let c=-s*Math.PI/180;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=r.ad.mat2.create(),r.ad.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){let c=r.ay(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=r.ak(s),this._calcMatrices())}get fovX(){return this._fov}get fovY(){let s=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/s)}get averageElevation(){return this._averageElevation}set averageElevation(s){this._averageElevation=s,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(s){let c=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(s){this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(s){this._tileCoverLift!==s&&(this._tileCoverLift=s)}_updateCameraOnTerrain(){let s=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,c=this.elevation&&s===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||s===Number.NEGATIVE_INFINITY&&(!c||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);let f=this._elevation;c||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&f.exaggeration()&&this._centerAltitudeValidForExaggeration!==f.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*f.exaggeration(),this._centerAltitudeValidForExaggeration=f.exaggeration()):(this._centerAltitude=s||0,this._centerAltitudeValidForExaggeration=f.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;let s=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],f=this.horizonLineFromTop(),y=0,b=0;for(let E=0;E<c.length;E++){let R=new r.P(c[E][0]*this.width,f+c[E][1]*(this.height-f)),P=s.pointCoordinate(R);if(!P)continue;let L=1/Math.hypot(P[0]-this._camera.position[0],P[1]-this._camera.position[1]);y+=P[3]*L,b+=L}return b===0?NaN:y/b}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;let s=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),f=this.pixelsPerMeter/this.worldSize*c,y=this._mercatorZfromZoom(s),b=this._mercatorZfromZoom(this._maxZoom),E=Math.max(y-f,b);this._setZoom(this._zoomFromMercatorZ(E))}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}computeZoomRelativeTo(s){let c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,s.toAltitude())),f;f=s.z<this._camera.position[2]?[c.x,c.y,c.z]:[s.x,s.y,s.z];let y=r.ad.vec3.length(r.ad.vec3.sub([],this._camera.position,f));return r.ay(this._zoomFromMercatorZ(y),this._minZoom,this._maxZoom)}setFreeCameraOptions(s){if(!this.height||!s.position&&!s.orientation)return;this._updateCameraState();let c=!1;if(s.orientation&&!r.ad.quat.exactEquals(s.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(s.orientation)),s.position){let f=[s.position.x,s.position.y,s.position.z];r.ad.vec3.exactEquals(f,this._camera.position)||(this._setCameraPosition(f),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();let s=this._camera.position,c=new tf;return c.position=new r.ac(s[0],s[1],s[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(s){if(!r.ad.quat.length(s))return!1;r.ad.quat.normalize(s,s);let c=r.ad.vec3.transformQuat([],[0,0,-1],s),f=r.ad.vec3.transformQuat([],[0,-1,0],s);if(f[2]<0)return!1;let y=lh(c,f);return!!y&&(this._camera.orientation=y,!0)}_setCameraPosition(s){let c=this.zoomScale(this.minZoom)*this.tileSize,f=this.zoomScale(this.maxZoom)*this.tileSize,y=this.cameraToCenterDistance;s[2]=r.ay(s[2],y/f,y/c),this._camera.position=s}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,c,f){this._unmodified=!1,this._edgeInsets.interpolate(s,c,f),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){let c=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(s){let c=[new r.bQ(0,s)];if(this.renderWorldCopies){let f=this.pointCoordinate(new r.P(0,0)),y=this.pointCoordinate(new r.P(this.width,0)),b=this.pointCoordinate(new r.P(this.width,this.height)),E=this.pointCoordinate(new r.P(0,this.height)),R=Math.floor(Math.min(f.x,y.x,b.x,E.x)),P=Math.floor(Math.max(f.x,y.x,b.x,E.x)),L=1;for(let F=R-L;F<=P+L;F++)F!==0&&c.push(new r.bQ(F,s))}return c}isLODDisabled(s){return(!s||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(s,c,f){let y=[],b=f!==void 0,E=!b;if(E&&this.zoom<c||b&&f[0]===0&&f[1]===0)return y;let R=new Set,P=(F,j,U,W,ie)=>{let Q=r.c5(j,F,U,W,ie);R.has(Q)||(y.push(new r.aH(F,j,U,W,ie)),R.add(Q))};for(let F=0;F<s.length;F++){let j=s[F];if(E&&j.canonical.z!==c)continue;let U=j.canonical,W=j.overscaledZ,ie=j.wrap,Q=1<<U.z,re=U.x+1<Q,oe=U.x>0,me=U.y+1<Q,Me=U.y>0,Ee=j.wrap-(oe?0:1),Le=j.wrap+(re?0:1),Ie=oe?U.x-1:Q-1,Ae=re?U.x+1:0;if(b)f[0]<0?(P(W,Le,U.z,Ae,U.y),f[1]<0&&me&&(P(W,ie,U.z,U.x,U.y+1),P(W,Le,U.z,Ae,U.y+1)),f[1]>0&&Me&&(P(W,ie,U.z,U.x,U.y-1),P(W,Le,U.z,Ae,U.y-1))):f[0]>0?(P(W,Ee,U.z,Ie,U.y),f[1]<0&&me&&(P(W,ie,U.z,U.x,U.y+1),P(W,Ee,U.z,Ie,U.y+1)),f[1]>0&&Me&&(P(W,ie,U.z,U.x,U.y-1),P(W,Ee,U.z,Ie,U.y-1))):f[1]<0&&me?P(W,ie,U.z,U.x,U.y+1):Me&&P(W,ie,U.z,U.x,U.y-1);else{let Re=j.visibleQuadrants;1&Re&&(P(W,Ee,U.z,Ie,U.y),Me&&(P(W,ie,U.z,U.x,U.y-1),P(W,Ee,U.z,Ie,U.y-1))),2&Re&&(P(W,Le,U.z,Ae,U.y),Me&&(P(W,ie,U.z,U.x,U.y-1),P(W,Le,U.z,Ae,U.y-1))),4&Re&&(P(W,Ee,U.z,Ie,U.y),me&&(P(W,ie,U.z,U.x,U.y+1),P(W,Ee,U.z,Ie,U.y+1))),8&Re&&(P(W,Le,U.z,Ae,U.y),me&&(P(W,ie,U.z,U.x,U.y+1),P(W,Le,U.z,Ae,U.y+1)))}}let L=[];for(let F of y)y.some(j=>F.isChildOf(j))||L.push(F);if(y=L.filter(F=>!s.some(j=>!!(F.overscaledZ<c&&j.isChildOf(F))||F.equals(j)||F.isChildOf(j))),E){let F=1<<c,j=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),U=[F*j.x,F*j.y],W=4,ie=W*W;y=y.filter(Q=>{let re=Q.canonical.x+.5-U[0],oe=Q.canonical.y+.5-U[1];return re*re+oe*oe<ie})}return y}coveringTiles(s){let c=this.coveringZoomLevel(s),f=c,y=this.elevation&&this.elevation.exaggeration(),b=y&&!s.isTerrainDEM,E=this.projection.name==="mercator";if(s.minzoom!==void 0&&c<s.minzoom)return[];s.maxzoom!==void 0&&c>s.maxzoom&&(c=s.maxzoom);let R=this.locationCoordinate(this.center),P=this.center.lat,L=1<<c,F=[L*R.x,L*R.y,0],j=this.projection.name==="globe",U=!j,W=r.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,U),ie=j?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Q=L*r.bH(1,this.center.lat),re=this._camera.position[2]/r.bH(1,this.center.lat),oe=[L*ie.x,L*ie.y,re*(U?1:Q)],me=j||y,Me=this.cameraToCenterDistance/s.tileSize*(s.roundZoom?1:.502),Ee=this.isLODDisabled(!0)?c:0,Le;if(this._elevation&&s.isTerrainDEM)Le=1e4*this._elevation.exaggeration();else if(this._elevation){let Qe=this._elevation.getMinMaxForVisibleTiles();Le=Qe?Qe.max:this._centerAltitude}else Le=this._centerAltitude;let Ie=s.isTerrainDEM?-Le:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ae=this.projection.isReprojectedInTileSpace?r.bS(this):1,Re=Qe=>{let _t=new r.ac(Qe.x+25e-6,Qe.y,Qe.z),St=new r.ac(Qe.x,Qe.y+25e-6,Qe.z),ht=Qe.toLngLat(),At=_t.toLngLat(),Kt=St.toLngLat(),Xt=this.locationCoordinate(ht),Qt=this.locationCoordinate(At),_i=this.locationCoordinate(Kt),tn=Math.hypot(Qt.x-Xt.x,Qt.y-Xt.y),ki=Math.hypot(_i.x-Xt.x,_i.y-Xt.y);return Math.sqrt(tn*ki)*Ae/25e-6},Ve=Qe=>{let bt=Le,_t=Ie;return{aabb:r.bV(this,L,0,0,0,Qe,_t,bt,this.projection),zoom:0,x:0,y:0,minZ:_t,maxZ:bt,wrap:Qe,fullyVisible:!1}},qe=[],dt=[],nt=c,Et=s.reparseOverscaled?f:c,Ct=(re-this._centerAltitude)*Q,Ut=Qe=>{if(!this._elevation||!Qe.tileID||!E)return;let bt=this._elevation.getMinMaxForTile(Qe.tileID),_t=Qe.aabb;bt?(_t.min[2]=bt.min,_t.max[2]=bt.max,_t.center[2]=(_t.min[2]+_t.max[2])/2):(Qe.shouldSplit=xt(Qe),Qe.shouldSplit||(_t.min[2]=_t.max[2]=_t.center[2]=this._centerAltitude))},tt=(Qe,bt)=>{if(.707*bt<Qe)return 1;let _t=bt/Qe;return _t/(1.4144271570014144+(Math.pow(1.1,_t-1.4144271570014144+1)-1)/(1.1-1)-1)},xt=Qe=>{if(Qe.zoom<Ee)return!0;if(Qe.zoom===nt)return!1;if(Qe.shouldSplit!=null)return Qe.shouldSplit;let bt=Qe.aabb.distanceX(oe),_t=Qe.aabb.distanceY(oe),St=Ct,ht=1;if(j){St=Qe.aabb.distanceZ(oe);let ki=Math.pow(2,Qe.zoom),Ki=r.aT((Qe.y+1)/ki),Fi=r.aT(Qe.y/ki),An=Math.min(Math.max(P,Ki),Fi),tr=r.ca(An)/r.ca(P);if(ht=An===P?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,tr/this._mercatorScaleRatio),this.zoom<=r.c6&&Qe.zoom===nt-1&&tr>=.9)return!0}else if(b&&(St=Qe.aabb.distanceZ(oe)*Q),this.projection.isReprojectedInTileSpace&&f<=5){let ki=Math.pow(2,Qe.zoom),Ki=Re(new r.ac((Qe.x+.5)/ki,(Qe.y+.5)/ki));ht=Ki>.85?1:Ki}if(!E){let ki=Math.sqrt(bt*bt+_t*_t+St*St),Ki=(1<<nt-Qe.zoom)*Me*ht;return Ki*=tt(Math.max(St,Ct),ki),ki<Ki}let At=Number.MAX_VALUE,Kt=0,Xt=Qe.aabb.getCorners(),Qt=[];for(let ki of Xt){r.ad.vec3.sub(Qt,ki,oe),j||(b?Qt[2]*=Q:Qt[2]=Ct);let Ki=r.ad.vec3.dot(Qt,this._camera.forward());Ki<At&&(At=Ki,Kt=Math.abs(Qt[2]))}let _i=(1<<nt-Qe.zoom)*Me*ht;if(_i*=tt(Math.max(Kt,Ct),At),At<_i)return!0;let tn=Qe.aabb.closestPoint(F);return tn[0]===F[0]&&tn[1]===F[1]};if(this.renderWorldCopies)for(let Qe=1;Qe<=3;Qe++)qe.push(Ve(-Qe)),qe.push(Ve(Qe));for(qe.push(Ve(0));qe.length>0;){let Qe=qe.pop(),bt=Qe.x,_t=Qe.y,St=Qe.fullyVisible,ht=()=>this.projection.name==="globe"&&(Qe.y===0||Qe.y===(1<<Qe.zoom)-1);if(!St){let At=me?Qe.aabb.intersects(W):Qe.aabb.intersectsFlat(W);if(At===0&&ht()){let Kt=new r.bT(Qe.zoom,bt,_t);At=r.bU(this,L,Kt,!0).intersects(W)}if(At===0)continue;St=At===2}if(Qe.zoom!==nt&&xt(Qe))for(let At=0;At<4;At++){let Kt=(bt<<1)+At%2,Xt=(_t<<1)+(At>>1),Qt={aabb:E?Qe.aabb.quadrant(At):r.bV(this,L,Qe.zoom+1,Kt,Xt,Qe.wrap,Qe.minZ,Qe.maxZ,this.projection),zoom:Qe.zoom+1,x:Kt,y:Xt,wrap:Qe.wrap,fullyVisible:St,tileID:void 0,shouldSplit:void 0,minZ:Qe.minZ,maxZ:Qe.maxZ};b&&!j&&(Qt.tileID=new r.aH(Qe.zoom+1===nt?Et:Qe.zoom+1,Qe.wrap,Qe.zoom+1,Kt,Xt),Ut(Qt)),qe.push(Qt)}else{let At=Qe.zoom===nt?Et:Qe.zoom;if(s.minzoom&&s.minzoom>At)continue;let Kt=0;if(!St){let tn=me?Qe.aabb.intersectsPrecise(W):Qe.aabb.intersectsPreciseFlat(W);if(tn===0&&ht()){let ki=new r.bT(Qe.zoom,bt,_t);tn=r.bU(this,L,ki,!0).intersectsPrecise(W)}if(tn===0)continue;if(s.calculateQuadrantVisibility)if(W.containsPoint(Qe.aabb.center))Kt=15;else for(let ki=0;ki<4;ki++)Qe.aabb.quadrant(ki).intersects(W)!==0&&(Kt|=1<<ki)}let Xt=F[0]-(.5+bt+(Qe.wrap<<Qe.zoom))*(1<<c-Qe.zoom),Qt=F[1]-.5-_t,_i=Qe.tileID?Qe.tileID:new r.aH(At,Qe.wrap,Qe.zoom,bt,_t);s.calculateQuadrantVisibility&&(_i.visibleQuadrants=Kt),dt.push({tileID:_i,distanceSq:Xt*Xt+Qt*Qt})}}if(this.fogCullDistSq){let Qe=this.fogCullDistSq,bt=this.horizonLineFromTop();dt=dt.filter(_t=>{let St=[0,0,0,1],ht=[r.ai,r.ai,0,1],At=this.calculateFogTileMatrix(_t.tileID.toUnwrapped());r.ad.vec4.transformMat4(St,St,At),r.ad.vec4.transformMat4(ht,ht,At);let Kt=r.ad.vec4.min([],St,ht),Xt=r.ad.vec4.max([],St,ht),Qt=r.bW(Kt,Xt);if(Qt===0)return!0;let _i=!1,tn=this._elevation;if(tn&&Qt>Qe&&bt!==0){let ki=this.calculateProjMatrix(_t.tileID.toUnwrapped()),Ki;s.isTerrainDEM||(Ki=tn.getMinMaxForTile(_t.tileID)),Ki||(Ki={min:Ie,max:Le});let Fi=r.c7(this.rotation),An=[Fi[0]*r.ai,Fi[1]*r.ai,Ki.max];r.ad.vec3.transformMat4(An,An,ki),_i=(1-An[1])*this.height*.5<bt}return Qt<Qe||_i})}return dt.sort((Qe,bt)=>Qe.distanceSq-bt.distanceSq).map(Qe=>Qe.tileID)}resize(s,c){this.width=s,this.height=c,this.pixelsToGLUnits=[2/s,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){let c=r.ay(s.lat,-r.bX,r.bX),f=this.projection.project(s.lng,c);return new r.P(f.x*this.worldSize,f.y*this.worldSize)}unproject(s){return this.projection.unproject(s.x/this.worldSize,s.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/r.bH(1,this.center.lat)/this.worldSize}setLocationAtPoint(s,c){let f,y,b=this.centerPoint;if(this.projection.name==="globe"){let R=this.worldSize;f=(c.x-b.x)/R,y=(c.y-b.y)/R}else{let R=this.pointCoordinate(c),P=this.pointCoordinate(b);f=R.x-P.x,y=R.y-P.y}let E=this.locationCoordinate(s);this.setLocation(new r.ac(E.x-f,E.y-y))}setLocation(s){this.center=this.coordinateLocation(s),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(s,c){return this.projection.locationPoint(this,s,c)}locationPoint3D(s,c){return this.projection.locationPoint(this,s,c,!0)}pointLocation(s){return this.coordinateLocation(this.pointCoordinate(s))}pointLocation3D(s,c){return this.coordinateLocation(this.pointCoordinate3D(s,c))}locationCoordinate(s,c){let f=c?r.bH(c,s.lat):void 0,y=this.projection.project(s.lng,s.lat);return new r.ac(y.x,y.y,f)}coordinateLocation(s){return this.projection.unproject(s.x,s.y)}pointRayIntersection(s,c){let f=c??this._centerAltitude,y=[s.x,s.y,0,1],b=[s.x,s.y,1,1];r.ad.vec4.transformMat4(y,y,this.pixelMatrixInverse),r.ad.vec4.transformMat4(b,b,this.pixelMatrixInverse);let E=b[3];r.ad.vec4.scale(y,y,1/y[3]),r.ad.vec4.scale(b,b,1/E);let R=y[2],P=b[2];return{p0:y,p1:b,t:R===P?0:(f-R)/(P-R)}}screenPointToMercatorRay(s){let c=[s.x,s.y,0,1],f=[s.x,s.y,1,1];return r.ad.vec4.transformMat4(c,c,this.pixelMatrixInverse),r.ad.vec4.transformMat4(f,f,this.pixelMatrixInverse),r.ad.vec4.scale(c,c,1/c[3]),r.ad.vec4.scale(f,f,1/f[3]),c[2]=r.bH(c[2],this._center.lat)*this.worldSize,f[2]=r.bH(f[2],this._center.lat)*this.worldSize,r.ad.vec4.scale(c,c,1/this.worldSize),r.ad.vec4.scale(f,f,1/this.worldSize),new r.as([c[0],c[1],c[2]],r.ad.vec3.normalize([],r.ad.vec3.sub([],f,c)))}rayIntersectionCoordinate(s){let{p0:c,p1:f,t:y}=s,b=r.bH(c[2],this._center.lat),E=r.bH(f[2],this._center.lat);return new r.ac(r.ah(c[0],f[0],y)/this.worldSize,r.ah(c[1],f[1],y)/this.worldSize,r.ah(b,E,y))}pointCoordinate(s,c=this._centerAltitude){return this.projection.pointCoordinate(this,s.x,s.y,c)}pointCoordinate3D(s,c){if(!this.elevation)return this.pointCoordinate(s,c);let f=this.projection.pointCoordinate3D(this,s.x,s.y);if(f)return new r.ac(f[0],f[1],f[2]);let y=0,b=this.horizonLineFromTop();if(s.y>b)return this.pointCoordinate(s,c);let E=.02*b,R=s.clone();for(let P=0;P<10&&b-y>E;P++){R.y=r.ah(y,b,.66);let L=this.projection.pointCoordinate3D(this,R.x,R.y);L?(b=R.y,f=L):y=R.y}return f?new r.ac(f[0],f[1],f[2]):this.pointCoordinate(s)}isPointAboveHorizon(s){return this.projection.isPointAboveHorizon(this,s)}isPointOnSurface(s){if(s.y<0||s.y>this.height||s.x<0||s.x>this.width)return!1;if(this.elevation||this.zoom>=r.bY)return!this.isPointAboveHorizon(s);let c=this.pointCoordinate(s);return c.y>=0&&c.y<=1}_coordinatePoint(s,c){let f=c&&this.elevation?this.elevation.getAtPointOrZero(s,this._centerAltitude):this._centerAltitude,y=[s.x*this.worldSize,s.y*this.worldSize,f+s.toAltitude(),1];return r.ad.vec4.transformMat4(y,y,this.pixelMatrix),y[3]>0?new r.P(y[0]/y[3],y[1]/y[3]):new r.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){let{top:s,left:c}=this._edgeInsets,f=this.height-this._edgeInsets.bottom,y=this.width-this._edgeInsets.right,b=this.pointLocation3D(new r.P(c,s)),E=this.pointLocation3D(new r.P(y,s)),R=this.pointLocation3D(new r.P(y,f)),P=this.pointLocation3D(new r.P(c,f)),L=Math.min(b.lng,E.lng,R.lng,P.lng),F=Math.max(b.lng,E.lng,R.lng,P.lng),j=Math.min(b.lat,E.lat,R.lat,P.lat),U=Math.max(b.lat,E.lat,R.lat,P.lat),W=Math.pow(2,-this.zoom)/16*270,ie=this.projection.name==="globe"?1:4,Q=(re,oe,me,Me,Ee)=>{let Le=(re+me)/2,Ie=(oe+Me)/2,Ae=new r.P(Le,Ie),{lng:Re,lat:Ve}=this.pointLocation3D(Ae),qe=Math.max(0,L-Re,j-Ve,Re-F,Ve-U);L=Math.min(L,Re),F=Math.max(F,Re),j=Math.min(j,Ve),U=Math.max(U,Ve),(Ee<ie||qe>W)&&(Q(re,oe,Le,Ie,Ee+1),Q(Le,Ie,me,Me,Ee+1))};if(Q(c,s,y,s,1),Q(y,s,y,f,1),Q(y,f,c,f,1),Q(c,f,c,s,1),this.projection.name==="globe"){let[re,oe]=r.bZ(this);re?(U=90,F=180,L=-180):oe&&(j=-90,F=180,L=-180)}return new r.aB(new r.bO(L,j),new r.bO(F,U))}_getBoundsRectangular(s,c){let{top:f,left:y}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,E=this.width-this._edgeInsets.right,R=new r.P(y,f),P=new r.P(E,f),L=new r.P(E,b),F=new r.P(y,b),j=this.pointCoordinate(R,s),U=this.pointCoordinate(P,s),W=this.pointCoordinate(L,c),ie=this.pointCoordinate(F,c),Q=(re,oe)=>(oe.y-re.y)/(oe.x-re.x);return j.y>1&&U.y>=0?j=new r.ac((1-ie.y)/Q(ie,j)+ie.x,1):j.y<0&&U.y<=1&&(j=new r.ac(-ie.y/Q(ie,j)+ie.x,0)),U.y>1&&j.y>=0?U=new r.ac((1-W.y)/Q(W,U)+W.x,1):U.y<0&&j.y<=1&&(U=new r.ac(-W.y/Q(W,U)+W.x,0)),new r.aB().extend(this.coordinateLocation(j)).extend(this.coordinateLocation(U)).extend(this.coordinateLocation(ie)).extend(this.coordinateLocation(W))}_getBoundsRectangularTerrain(){let s=this.elevation;if(!s.visibleDemTiles.length||s.isUsingMockSource())return this._getBoundsRectangular(0,0);let c=s.visibleDemTiles.reduce((f,y)=>{if(y.dem){let b=y.dem.tree;f.min=Math.min(f.min,b.minimums[0]),f.max=Math.max(f.max,b.maximums[0])}return f},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(c.min*s.exaggeration(),c.max*s.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(s=!0){let c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,f=this.height/2-c*(1-this._horizonShift);return s?Math.max(0,f):f}getMaxBounds(){return this.maxBounds}setMaxBounds(s){this.maxBounds=s,this.minLat=-r.bX,this.maxLat=r.bX,this.minLng=-180,this.maxLng=180,s&&(this.minLat=s.getSouth(),this.maxLat=s.getNorth(),this.minLng=s.getWest(),this.maxLng=s.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=r.av(this.minLng)*this.tileSize,this.worldMaxX=r.av(this.maxLng)*this.tileSize,this.worldMinY=r.aC(this.maxLat)*this.tileSize,this.worldMaxY=r.aC(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(s,c){return this.projection.createTileMatrix(this,c,s)}calculateDistanceTileData(s){let c=s.key,f=this._distanceTileDataCache;if(f[c])return f[c];let y=s.canonical,b=1/this.height,E=this.cameraWorldSize,R=E/this.zoomScale(y.z),P=(y.x+Math.pow(2,y.z)*s.wrap)*R,L=y.y*R,F=this.point;F.x*=E/this.worldSize,F.y*=E/this.worldSize;let j=this.angle,U=Math.sin(-j),W=-Math.cos(-j);return f[c]={bearing:[U,W],center:[(F.x-P)*b,(F.y-L)*b],scale:R/r.ai*b},f[c]}calculateFogTileMatrix(s){let c=s.key,f=this._fogTileMatrixCache;if(f[c])return f[c];let y=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,s);return r.ad.mat4.multiply(y,this.worldToFogMatrix,y),f[c]=new Float32Array(y),f[c]}calculateProjMatrix(s,c=!1,f=!1){let y=s.key,b;if(b=f?this._expandedProjMatrixCache:c?this._alignedProjMatrixCache:this._projMatrixCache,b[y])return b[y];let E=this.calculatePosMatrix(s,this.worldSize),R;return R=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:f?this.expandedFarZProjMatrix:c?this.alignedProjMatrix:this.projMatrix,r.ad.mat4.multiply(E,R,E),b[y]=new Float32Array(E),b[y]}calculatePixelsToTileUnitsMatrix(s){let c=s.tileID.key,f=this._pixelsToTileUnitsCache;if(f[c])return f[c];let y=r.b_(s,this);return f[c]=y,f[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){let s=1/this.worldSize,c=r.ad.mat4.fromScaling([],[s,s,s]);return r.ad.mat4.multiply(c,c,this.globeMatrix),c}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;let s=this._elevation;this._updateCameraState();let c=r.bH(1,this._center.lat)*this.worldSize,f=this._computeCameraPosition(c),y=this._camera.forward(),b=r.bH(1,this._center.lat);f[2]/=b,y[2]/=b,r.ad.vec3.normalize(y,y);let E=s.raycast(f,y,s.exaggeration());if(E){let R=r.ad.vec3.scaleAndAdd([],f,y,E),P=new r.ac(R[0],R[1],r.bH(R[2],r.aT(R[1]))),L=(P.z+r.ad.vec3.length([P.x-f[0],P.y-f[1],P.z-f[2]*b]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(L),this._centerAltitude=P.toAltitude(),this._center=this.coordinateLocation(P),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(s=!1){if(!this._elevation)return;let c=this._elevation,f=r.bH(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(f),b=c.getAtPointOrZero(new r.ac(...y)),E=this.pixelsPerMeter/this.worldSize*b,R=this._minimumHeightOverTerrain(),P=y[2]-E;if(P<=R)if(P<0||s){let L=this.locationCoordinate(this._center,this._centerAltitude),F=[y[0],y[1],L.z-y[2]],j=r.ad.vec3.length(F);F[2]-=(R-P)/this._pixelsPerMercatorPixel;let U=r.ad.vec3.length(F);if(U===0)return;r.ad.vec3.scale(F,F,j/U*this._pixelsPerMercatorPixel),this._camera.position=[y[0],y[1],L.z*this._pixelsPerMercatorPixel-F[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let s=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||s){let U=this.center;return U.lat=r.ay(U.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!s)&&(U.lng=r.ay(U.lng,this.minLng,this.maxLng)),this.center=U,void(this._constraining=!1)}let c=this._unmodified,{x:f,y}=this.point,b=0,E=f,R=y,P=this.width/2,L=this.height/2,F=this.worldMinY*this.scale,j=this.worldMaxY*this.scale;if(y-L<F&&(R=F+L),y+L>j&&(R=j-L),j-F<this.height&&(b=Math.max(b,this.height/(j-F)),R=(j+F)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){let U=this.worldMinX*this.scale,W=this.worldMaxX*this.scale,ie=this.worldSize/2-(U+W)/2;E=(f+ie+this.worldSize)%this.worldSize-ie,E-P<U&&(E=U+P),E+P>W&&(E=W-P),W-U<this.width&&(b=Math.max(b,this.width/(W-U)),E=(W+U)/2)}E===f&&R===y||this._allowWorldUnderZoom||(this.center=this.unproject(new r.P(E,R))),b&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(b)),this._constrainCamera(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){let s=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(s=Math.max(s,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),s}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;let s=this.centerOffset,c=this.projection.name==="globe",f=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=r.bH(1,this.center.lat)/r.bH(1,r.c8));let y=r.b$(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,y),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;let b=this.projection.zAxisUnit==="meters"?f:1,E=this._camera.getWorldToCamera(this.worldSize,b),R,P=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(P[8]=2*-s.x/this.width,P[9]=2*s.y/this.height,this.isOrthographic){let Ve=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),qe=Ve*this.aspect,dt=-qe,nt=-Ve;qe-=s.x,dt-=s.x,Ve+=s.y,nt+=s.y,R=this._camera.getCameraToClipOrthographic(dt,qe,nt,Ve,this._nearZ,this._farZ),((Et,Ct,Ut,tt)=>{for(let xt=0;xt<16;xt++)Et[xt]=r.ah(Ct[xt],Ut[xt],tt)})(R,R,P,r.c9(this.pitch>=$t?1:this.pitch/$t))}else R=P;let L=r.ad.mat4.mul([],P,E),F=r.ad.mat4.mul([],R,E);if(this.projection.isReprojectedInTileSpace){let Ve=this.locationCoordinate(this.center),qe=r.ad.mat4.identity([]);r.ad.mat4.translate(qe,qe,[Ve.x*this.worldSize,Ve.y*this.worldSize,0]),r.ad.mat4.multiply(qe,qe,r.c0(this)),r.ad.mat4.translate(qe,qe,[-Ve.x*this.worldSize,-Ve.y*this.worldSize,0]),r.ad.mat4.multiply(F,F,qe),r.ad.mat4.multiply(L,L,qe),this.inverseAdjustmentMatrix=r.c1(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=r.ad.mat4.scale([],F,[this.worldSize,this.worldSize,this.worldSize/b,1]),this.projMatrix=F,this.invProjMatrix=r.ad.mat4.invert(new Float64Array(16),this.projMatrix),c){let Ve=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Ve[8]=2*-s.x/this.width,Ve[9]=2*s.y/this.height,this.expandedFarZProjMatrix=r.ad.mat4.mul([],Ve,E)}else this.expandedFarZProjMatrix=this.projMatrix;let j=r.ad.mat4.invert([],R);this.frustumCorners=r.c2.fromInvProjectionMatrix(j,this.horizonLineFromTop(),this.height),this.cameraFrustum=r.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!c);let U=new Float32Array(16);r.ad.mat4.identity(U),r.ad.mat4.scale(U,U,[1,-1,1]),r.ad.mat4.rotateX(U,U,this._pitch),r.ad.mat4.rotateZ(U,U,this.angle);let W=r.ad.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=r.ad.mat4.clone(W);let ie=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;W[8]=2*-s.x/this.width,W[9]=2*(s.y+ie)/this.height,this.skyboxMatrix=r.ad.mat4.multiply(U,W,U);let Q=this.point,re=Q.x,oe=Q.y,me=this.width%2/2,Me=this.height%2/2,Ee=Math.cos(this.angle),Le=Math.sin(this.angle),Ie=re-Math.round(re)+Ee*me+Le*Me,Ae=oe-Math.round(oe)+Ee*Me+Le*me,Re=new Float64Array(F);if(r.ad.mat4.translate(Re,Re,[Ie>.5?Ie-1:Ie,Ae>.5?Ae-1:Ae,0]),this.alignedProjMatrix=Re,F=r.ad.mat4.create(),r.ad.mat4.scale(F,F,[this.width/2,-this.height/2,1]),r.ad.mat4.translate(F,F,[1,-1,0]),this.labelPlaneMatrix=F,F=r.ad.mat4.create(),r.ad.mat4.scale(F,F,[1,-1,1]),r.ad.mat4.translate(F,F,[-1,-1,0]),r.ad.mat4.scale(F,F,[2/this.width,2/this.height,1]),this.glCoordMatrix=F,this.pixelMatrix=r.ad.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,L),this._calcFogMatrices(),this._distanceTileDataCache={},F=r.ad.mat4.invert(new Float64Array(16),this.pixelMatrix),!F)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=F,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=r.c3(this);let Ve=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=r.ad.vec3.transformMat4(Ve,Ve,E),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=F;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};let s=this.cameraWorldSizeForFog,c=this.cameraPixelsPerMeter,f=this._camera.position,y=1/this.height/this._pixelsPerMercatorPixel,b=[s,s,c];r.ad.vec3.scale(b,b,y),r.ad.vec3.scale(f,f,-1),r.ad.vec3.multiply(f,f,b);let E=r.ad.mat4.create();r.ad.mat4.translate(E,E,f),r.ad.mat4.scale(E,E,b),this.mercatorFogMatrix=E,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(s,c,y)}_computeCameraPosition(s){let c=(s=s||this.pixelsPerMeter)/this.pixelsPerMeter,f=this._camera.forward(),y=this.point,b=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-s/this.worldSize*this._centerAltitude;return[y.x/this.worldSize-f[0]*b,y.y/this.worldSize-f[1]*b,s/this.worldSize*this._centerAltitude-f[2]*b]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(s){let c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),f=this._camera.position[2],y=s[2],b=1;this.projection.wrap&&(this.center=this.center.wrap()),y>0&&(b=Math.min((c-f)/y,1)),this._camera.position=r.ad.vec3.scaleAndAdd([],this._camera.position,s,b),this._updateStateFromCamera()}_updateStateFromCamera(){let s=this._camera.position,c=this._camera.forward(),{pitch:f,bearing:y}=this._camera.getPitchBearing(),b=r.bH(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,E=this._mercatorZfromZoom(this._maxZoom)*Math.cos(r.ak(this._maxPitch)),R=Math.max((s[2]-b)/Math.cos(f),E),P=this._zoomFromMercatorZ(R);r.ad.vec3.scaleAndAdd(s,s,c,R),this._pitch=r.ay(f,r.ak(this.minPitch),r.ak(this.maxPitch)),this.angle=r.bF(y,-Math.PI,Math.PI),this._setZoom(r.ay(P,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new r.ac(s[0],s[1],s[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(s){return Math.pow(2,s)*this.tileSize}_mercatorZfromZoom(s){return this.cameraToCenterDistance/this._worldSizeFromZoom(s)}_minimumHeightOverTerrain(){let s=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(s)}_zoomFromMercatorZ(s){return this.scaleZoom(this.cameraToCenterDistance/(s*this.tileSize))}zoomFromMercatorZAdjusted(s){let c=0,f=r.bY,y=0,b=1/0;for(;f-c>1e-6&&f>c;){let E=c+.5*(f-c),R=this.tileSize*Math.pow(2,E),P=this.getCameraToCenterDistance(this.projection,E,R),L=this.scaleZoom(P/(s*this.tileSize)),F=Math.abs(E-L);F<b&&(b=F,y=E),E<L?c=E:f=E}return y}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(r.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(s,c){let f=Math.min(s.x,c.x),y=Math.max(s.x,c.x),b=Math.min(s.y,c.y),E=Math.max(s.y,c.y);if(b<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;let R=[new r.P(f,b),new r.P(y,E),new r.P(f,E),new r.P(y,b)],P=this.renderWorldCopies?-3:0,L=this.renderWorldCopies?4:1;for(let F of R){let j=this.pointRayIntersection(F);if(j.t<0)return!0;let U=this.rayIntersectionCoordinate(j);if(U.x<P||U.y<0||U.x>L||U.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+r.c4(this.fovAboveCenter)>88||this.anyCornerOffEdge(new r.P(0,0),new r.P(this.width,this.height))}zoomDeltaToMovement(s,c){let f=r.ad.vec3.length(r.ad.vec3.sub([],this._camera.position,s)),y=this._zoomFromMercatorZ(f)+c;return f-this._mercatorZfromZoom(y)}getCameraPoint(){if(this.projection.name==="globe"){let s=function([c,f,y],b){let E=[c,f,y,1];r.ad.vec4.transformMat4(E,E,b);let R=E[3]=Math.max(E[3],1e-6);return E[0]/=R,E[1]/=R,E[2]/=R,E}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new r.P(s[0],s[1])}{let s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new r.P(0,s))}}getCameraToCenterDistance(s,c=this.zoom,f=this.worldSize){let y=r.b$(s,c,this.width,this.height,1024),b=s.pixelSpaceConversion(this.center.lat,f,y),E=.5/Math.tan(.5*this._fov)*this.height*b;return this.isOrthographic&&(E=r.ah(1,E,r.c9(this.pitch>=$t?1:this.pitch/$t))),E}getWorldToCameraMatrix(){let s=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&r.ad.mat4.multiply(s,s,this.globeMatrix),s}getFrustum(s){return r.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,this.projection.zAxisUnit==="meters")}}let rc=(m,s)=>{if(s>0&&m.terrain&&r.w("Cutoff is currently disabled on terrain"),s<=0||m.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};let c=m.transform,f=Math.max(Math.abs(c._zoom-(m.minCutoffZoom-1)),1),y=c.isLODDisabled(!1)?r.ae(60,45,c.pitch):r.ae(30,15,c.pitch),b=c._farZ-c._nearZ,E=s*c.height,R=((1-(P=y))*c.cameraToCenterDistance+P*(c._farZ+E))*f;var P;return{shouldRenderCutoff:y<1,uniformValues:{u_cutoff_params:[c._nearZ,c._farZ,(R-c._nearZ)/b,(R-E-c._nearZ)/b]}}},da={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Y0{constructor(s,c){this.aabb=s,this.lastCascade=c}}class nf{add(s,c){let f=this.receivers[s.key];f!==void 0?(f.aabb.min[0]=Math.min(f.aabb.min[0],c.min[0]),f.aabb.min[1]=Math.min(f.aabb.min[1],c.min[1]),f.aabb.min[2]=Math.min(f.aabb.min[2],c.min[2]),f.aabb.max[0]=Math.max(f.aabb.max[0],c.max[0]),f.aabb.max[1]=Math.max(f.aabb.max[1],c.max[1]),f.aabb.max[2]=Math.max(f.aabb.max[2],c.max[2])):this.receivers[s.key]=new Y0(c,null)}clear(){this.receivers={}}get(s){return this.receivers[s.key]}computeRequiredCascades(s,c,f){let y=r.ce.fromPoints(s.points),b=0;for(let E in this.receivers){let R=this.receivers[E];if(!R||!y.intersectsAabb(R.aabb))continue;R.aabb.min=y.closestPoint(R.aabb.min),R.aabb.max=y.closestPoint(R.aabb.max);let P=R.aabb.getCorners();for(let L=0;L<f.length;L++){let F=!0;for(let j of P){let U=[j[0]*c,j[1]*c,j[2]];if(r.ad.vec3.transformMat4(U,U,f[L].matrix),U[0]<-1||U[0]>1||U[1]<-1||U[1]>1){F=!1;break}}if(R.lastCascade=L,b=Math.max(b,L),F)break}}return b+1}}class Uc{constructor(s){this.painter=s,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new nf,this._depthMode=new xi(s.context.gl.LEQUAL,xi.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,s.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),s.tp.registerParameter(da,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),s.tp.registerParameter(da,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),s.tp.registerParameter(da,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),s.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(let s of this._cascades)s.texture.destroy(),s.framebuffer.destroy();this._cascades=[]}updateShadowParameters(s,c){let f=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!c||!c.properties)return;let y=c.properties.get("shadow-intensity");if(!c.shadowsEnabled()||y<=0||(this._shadowLayerCount=f.style.order.reduce((ie,Q)=>{let re=f.style._mergedLayers[Q];return ie+(re.hasShadowPass()&&!re.isHidden(s.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;let b=f.context,E=da.shadowMapResolution,R=da.shadowMapResolution;if(this._cascades.length===0||da.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ie=0;ie<da.cascadeCount;++ie){let Q=f._shadowMapDebug,re=b.gl,oe=b.createFramebuffer(E,R,Q,"texture"),me=new r.T(b,{width:E,height:R,data:null},re.DEPTH_COMPONENT16);if(oe.depthAttachment.set(me.texture),Q){let Me=new r.T(b,{width:E,height:R,data:null},re.RGBA8);oe.colorAttachment.set(Me.texture)}this._cascades.push({framebuffer:oe,texture:me,matrix:[],far:0,boundingSphereRadius:0,frustum:new r.bR,scale:0})}}this.shadowDirection=Rl(c);let P=0;if(s.elevation){let ie=s.elevation,Q=[1e4,-1e4];ie.visibleDemTiles.filter(re=>re.dem).forEach(re=>{let oe=re.dem.tree;Q[0]=Math.min(Q[0],oe.minimums[0]),Q[1]=Math.max(Q[1],oe.maximums[0])}),Q[0]!==1e4&&(P=(Q[1]-Q[0])*ie.exaggeration())}let L=1.5*s.cameraToCenterDistance,F=3*L,j=new Float64Array(16);for(let ie=0;ie<this._cascades.length;++ie){let Q=this._cascades[ie],re=s.height/50,oe=1;da.cascadeCount===1?oe=F:ie===0?oe=L:(re=L,oe=F);let[me,Me]=Hs(s,this.shadowDirection,re,oe,da.shadowMapResolution,P);Q.scale=s.scale,Q.matrix=me,Q.boundingSphereRadius=Me,r.ad.mat4.invert(j,Q.matrix),Q.frustum=r.bR.fromInvProjectionMatrix(j,1,0,!0),Q.far=oe}let U=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[U].far,this._cascades[U].far],this._uniformValues.u_shadow_intensity=y,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/da.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=da.shadowMapResolution,this._uniformValues.u_shadowmap_0=eo.ShadowMap0,this._uniformValues.u_shadowmap_1=eo.ShadowMap0+1,this._groundShadowTiles=f.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});let W=f.transform.elevation;for(let ie of this._groundShadowTiles){let Q={min:0,max:0};if(W){let re=W.getMinMaxForTile(ie);re&&(Q=re)}this.addShadowReceiver(ie.toUnwrapped(),Q.min,Q.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(s){this._enabled=s}drawShadowPass(s,c){if(!this.enabled)return;let f=this.painter,y=f.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(f.transform.getFrustum(0),f.transform.worldSize,this._cascades),y.viewport.set([0,0,da.shadowMapResolution,da.shadowMapResolution]);for(let b=0;b<this._numCascadesToRender;++b){f.currentShadowCascade=b,y.bindFramebuffer.set(this._cascades[b].framebuffer.framebuffer),y.clear({color:r.al.white,depth:1});for(let E of s.order){let R=s._mergedLayers[E];if(!R.hasShadowPass()||R.isHidden(f.transform.zoom))continue;let P=s.getLayerSourceCache(R),L=P?c[P.id]:void 0;(R.type==="model"||L&&L.length)&&f.renderLayer(f,P,R,L)}}f.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;let s=this.painter,c=s.style,f=s.context,y=c.directionalLight,b=c.ambientLight;if(!y||!b)return;let E=[],R=rc(s,s.longestCutoffRange);R.shouldRenderCutoff&&E.push("RENDER_CUTOFF"),E.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&E.push("NORMAL_OFFSET");let P=sd(c,y,b),L=new xi(f.gl.LEQUAL,xi.ReadOnly,s.depthRangeFor3D);for(let F of this._groundShadowTiles){let j=F.toUnwrapped(),U=s.isTileAffectedByFog(F),W=s.getOrCreateProgram("groundShadow",{defines:E,overrideFog:U});this.setupShadows(j,W),s.uploadCommonUniforms(f,W,j,null,R);let ie={u_matrix:s.transform.calculateProjMatrix(j),u_ground_shadow_factor:P};W.draw(s,f.gl.TRIANGLES,L,en.disabled,_n.multiply,Vi.disabled,ie,"ground_shadow",s.tileExtentBuffer,s.quadTriangleIndexBuffer,s.tileExtentSegments,null,s.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?_n.unblended:_n.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(s){let c=this.painter.transform,f=c.calculatePosMatrix(s,c.worldSize);return r.ad.mat4.multiply(f,this._cascades[this.painter.currentShadowCascade].matrix,f),Float32Array.from(f)}calculateShadowPassMatrixFromMatrix(s){return r.ad.mat4.multiply(s,this._cascades[this.painter.currentShadowCascade].matrix,s),Float32Array.from(s)}setupShadows(s,c,f,y=0){if(!this.enabled)return;let b=this.painter.transform,E=this.painter.context,R=E.gl,P=this._uniformValues,L=new Float64Array(16),F=b.calculatePosMatrix(s,b.worldSize);for(let j=0;j<this._cascades.length;j++)r.ad.mat4.multiply(L,this._cascades[j].matrix,F),P[j===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(L),E.activeTexture.set(R.TEXTURE0+eo.ShadowMap0+j),this._cascades[j].texture.bind(R.NEAREST,R.CLAMP_TO_EDGE);if(this.useNormalOffset=!!f,this.useNormalOffset){let j=r.cd(s.canonical),U=2/b.tileSize*r.ai/da.shadowMapResolution,W=U*this._cascades[0].boundingSphereRadius,ie=U*this._cascades[this._cascades.length-1].boundingSphereRadius,Q=(f==="vector-tile"?1:3)/Math.pow(2,y-s.canonical.z-(1-b.zoom+Math.floor(b.zoom)));P.u_shadow_normal_offset=[j,W*Q,ie*Q],P.u_shadow_bias=[6e-5,.0012,.012]}else P.u_shadow_bias=[36e-5,.0012,.012];c.setShadowUniformValues(E,P)}setupShadowsFromMatrix(s,c,f=!1){if(!this.enabled)return;let y=this.painter.context,b=y.gl,E=this._uniformValues,R=new Float64Array(16);for(let P=0;P<da.cascadeCount;P++)r.ad.mat4.multiply(R,this._cascades[P].matrix,s),E[P===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(R),y.activeTexture.set(b.TEXTURE0+eo.ShadowMap0+P),this._cascades[P].texture.bind(b.NEAREST,b.CLAMP_TO_EDGE);if(this.useNormalOffset=f,f){let P=da.normalOffset;E.u_shadow_normal_offset=[1,P,P],E.u_shadow_bias=[6e-5,.0012,.012]}else E.u_shadow_bias=[36e-5,.0012,.012];c.setShadowUniformValues(y,E)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(s,c,f,y){if(y[2]>=0)return{};let b=function(P,L,F){let j=F/(1<<P.canonical.z);return new r.ce([P.canonical.x*j+P.wrap*F,P.canonical.y*j+P.wrap*F,0],[(P.canonical.x+1)*j+P.wrap*F,(P.canonical.y+1)*j+P.wrap*F,L])}(s,c,f).getCorners(),E=c/-y[2];y[0]<0?(r.ad.vec3.add(b[0],b[0],[y[0]*E,0,0]),r.ad.vec3.add(b[3],b[3],[y[0]*E,0,0])):y[0]>0&&(r.ad.vec3.add(b[1],b[1],[y[0]*E,0,0]),r.ad.vec3.add(b[2],b[2],[y[0]*E,0,0])),y[1]<0?(r.ad.vec3.add(b[0],b[0],[0,y[1]*E,0]),r.ad.vec3.add(b[1],b[1],[0,y[1]*E,0])):y[1]>0&&(r.ad.vec3.add(b[2],b[2],[0,y[1]*E,0]),r.ad.vec3.add(b[3],b[3],[0,y[1]*E,0]));let R={};return R.vertices=b,R.planes=[Hc(b[1],b[0],b[4]),Hc(b[2],b[1],b[5]),Hc(b[3],b[2],b[6]),Hc(b[0],b[3],b[7])],R}addShadowReceiver(s,c,f){this._receivers.add(s,r.ce.fromTileIdAndHeight(s,c,f))}getMaxCascadeForTile(s){let c=this._receivers.get(s);return c&&c.lastCascade?c.lastCascade:0}}function Hc(m,s,c){let f=r.ad.vec3.sub([],c,s),y=r.ad.vec3.sub([],m,s),b=r.ad.vec3.cross([],f,y),E=r.ad.vec3.length(b);return E===0?[0,0,1,0]:(r.ad.vec3.scale(b,b,1/E),[b[0],b[1],b[2],-r.ad.vec3.dot(b,s)])}function Rl(m){let s=m.properties.get("direction"),c=r.cc(s.x,s.y,s.z);c[2]=r.ay(c[2],0,75);let f=r.cf([c[0],c[1],c[2]]);return r.ad.vec3.fromValues(f.x,f.y,f.z)}function sd(m,s,c){let f=s.properties.get("color-use-theme")==="none",y=s.properties.get("color"),b=s.properties.get("intensity"),E=s.properties.get("direction"),R=[E.x,E.y,E.z],P=c.properties.get("color-use-theme")==="none",L=c.properties.get("color"),F=c.properties.get("intensity"),j=Math.max(r.ad.vec3.dot([0,0,1],R),0),U=[0,0,0];r.ad.vec3.scale(U,L.toRenderColor(P?null:m.getLut(s.scope)).toArray01Linear().slice(0,3),F);let W=[0,0,0];return r.ad.vec3.scale(W,y.toRenderColor(f?null:m.getLut(c.scope)).toArray01Linear().slice(0,3),j*b),r.cg([U[0]>0?U[0]/(U[0]+W[0]):0,U[1]>0?U[1]/(U[1]+W[1]):0,U[2]>0?U[2]/(U[2]+W[2]):0])}function Hs(m,s,c,f,y,b){let E=m.zoom,R=m.scale,P=m.worldSize,L=1/P,F=m.aspect,j=Math.sqrt(1+F*F)*Math.tan(.5*m.fovX),U=j*j,W=f-c,ie=f+c,Q,re;U>W/ie?(Q=f,re=f*j):(Q=.5*ie*(1+U),re=.5*Math.sqrt(W*W+2*(f*f+c*c)*U+ie*ie*U*U));let oe=m.projection.pixelsPerMeter(m.center.lat,P),me=m._camera.getCameraToWorldMercator(),Me=[0,0,-Q*L];r.ad.vec3.transformMat4(Me,Me,me);let Ee=re*L,Le=m._edgeInsets;if(!(Le.left===0&&Le.top===0&&Le.right===0&&Le.bottom===0||Le.left===Le.right&&Le.top===Le.bottom)){let St=m._camera.getWorldToCamera(m.worldSize,m.projection.zAxisUnit==="meters"?oe:1),ht=m._camera.getCameraToClipPerspective(m._fov,m.width/m.height,c,f);ht[8]=2*-m.centerOffset.x/m.width,ht[9]=2*m.centerOffset.y/m.height;let At=new Float64Array(16);r.ad.mat4.mul(At,ht,St);let Kt=new Float64Array(16);r.ad.mat4.invert(Kt,At);let Xt=r.bR.fromInvProjectionMatrix(Kt,P,E,!0);for(let Qt of Xt.points){let _i=((Ie=Qt)[0]/=R,Ie[1]/=R,Ie[2]=r.bH(Ie[2],m._center.lat),Ie);Ee=Math.max(Ee,r.ad.vec3.len(r.ad.vec3.subtract([],Me,_i)))}}var Ie;Ee*=y/(y-1);let Ae=Math.acos(s[2]),Re=Math.atan2(-s[0],-s[1]),Ve=new Eu;Ve.position=Me,Ve.setPitchBearing(Ae,Re);let qe=Ve.getWorldToCamera(P,oe),dt=Ee*P,nt=Math.min(m._mercatorZfromZoom(17)*P*-2,-2*dt),Et=Ve.getCameraToClipOrthographic(-dt,dt,-dt,dt,nt,(dt+b*oe)/s[2]),Ct=new Float64Array(16);r.ad.mat4.multiply(Ct,Et,qe);let Ut=r.ad.vec3.fromValues(Math.floor(1e6*Me[0])/1e6*P,Math.floor(1e6*Me[1])/1e6*P,0),tt=.5*y,xt=[0,0,0];r.ad.vec3.transformMat4(xt,Ut,Ct),r.ad.vec3.scale(xt,xt,tt);let Qe=[Math.floor(xt[0]),Math.floor(xt[1]),Math.floor(xt[2])],bt=[0,0,0];r.ad.vec3.sub(bt,xt,Qe),r.ad.vec3.scale(bt,bt,-1/tt);let _t=new Float64Array(16);return r.ad.mat4.identity(_t),r.ad.mat4.translate(_t,_t,bt),r.ad.mat4.multiply(Ct,_t,Ct),[Ct,dt]}class Zm extends r.E{constructor(s){super(),this.requestManager=s,this.models={"":{}},this.modelUris={"":{}},this.numModelsLoading={}}loadModel(s,c){return r.aN(this.requestManager.transformRequest(c,r.R.Model).url).then(f=>{if(!f)return;let y=r.aO(f),b=new r.aP(s,void 0,void 0,y);return b.computeBoundsAndApplyParent(),b}).catch(f=>{if(f&&f.status===404)return null;this.fire(new r.z(new Error(`Could not load model ${s} from ${c}: ${f.message}`)))})}load(s,c,f={keepNumReferences:!1}){this.models[c]||(this.models[c]={});let y=Object.keys(s);this.numModelsLoading[c]=(this.numModelsLoading[c]||0)+y.length;let b=[];for(let E of y)b.push(this.loadModel(E,s[E]));Promise.allSettled(b).then(E=>{for(let R=0;R<E.length;R++){let{status:P,value:L}=E[R];if(P==="fulfilled"&&L){let F=this.models[c][y[R]];this.models[c][y[R]]={model:L,numReferences:f.keepNumReferences&&F?F.numReferences:1}}}this.numModelsLoading[c]-=y.length,this.fire(new r.A("data",{dataType:"style"}))}).catch(E=>{this.fire(new r.z(new Error(`Could not load models: ${E.message}`)))})}isLoaded(){for(let s in this.numModelsLoading)if(this.numModelsLoading[s]>0)return!1;return!0}hasModel(s,c){return!!this.getModel(s,c)}getModel(s,c){return this.models[c]||(this.models[c]={}),this.models[c][s]?this.models[c][s].model:void 0}addModel(s,c,f){this.models[f]||(this.models[f]={}),this.modelUris[f]||(this.modelUris[f]={}),this.hasModel(s,f)&&this.models[f][s].numReferences++,this.modelUris[f][s]=this.requestManager.normalizeModelURL(c),this.load({[s]:this.modelUris[f][s]},f)}addModels(s,c){this.models[c]||(this.models[c]={}),this.modelUris[c]||(this.modelUris[c]={});let f=this.modelUris[c];for(let y in s)this.models[c][y]={},f[y]=this.requestManager.normalizeModelURL(s[y]);this.load(f,c,{keepNumReferences:!0})}reloadModels(s){this.load(this.modelUris[s],s)}addModelsFromBucket(s,c){this.models[c]||(this.models[c]={}),this.modelUris[c]||(this.modelUris[c]={});let f={};for(let y of s)this.hasModel(y,c)?this.models[c][y].numReferences++:(this.modelUris[c][y]=this.requestManager.normalizeModelURL(y),f[y]=this.modelUris[c][y]);this.load(f,c)}removeModel(s,c){if(this.models[c]&&this.models[c][s]&&(this.models[c][s].numReferences--,this.models[c][s].numReferences===0)){let f=this.models[c][s].model;delete this.models[c][s],delete this.modelUris[c][s],f.destroy()}}listModels(s){return this.models[s]||(this.models[s]={}),Object.keys(this.models[s])}upload(s,c){this.models[c]||(this.models[c]={});for(let f in this.models[c])this.models[c][f].model&&this.models[c][f].model.upload(s.context)}}let jv=new r.a7({data:new r.a8(r.a5.colorTheme.data)}),Ym={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function ch(m){return m=m||{},Object.assign(m,Ym)}class Km extends r.E{constructor(s){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},r.aQ(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=s,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(s=>{s.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new r.z(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=s.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=s.stylesheet.indoor.buildingFeaturesetId,this._scope=s.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:s=>(s.feature&&s.feature.properties.floorplan&&this.selectFloorplan(s.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(s){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(E,R){let[P,L]=E,{center:F,radius:j}=R,[U,W]=F,ie=Math.abs(P-U);return Math.sqrt((ie>180?360-ie:ie)**2+(L-W)**2)<=j}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new r.A("floorplangone")));let c={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},f=new r.P(this._map.transform.width/2,this._map.transform.height/2),y=[new r.P(0,0),new r.P(this._map.transform.width,this._map.transform.height)],b=this._map.queryRenderedFeatures(s?y:f,c);b.length>0&&(this._selectedFloorplan&&b[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=b[0],this._floorplanSelected(!1)))}_floorplanSelected(s){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(b){let[[E,R],[P,L]]=b,F=(P-E+360)%360,j=F>180?360-F:F;return{center:[(E+j/2+360)%360,(R+L)/2],radius:Math.sqrt(j**2+(L-R)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});let c=this._floorplanStates[this._indoorData.id].selectedBuilding,f=this._floorplanStates[this._indoorData.id].selectedLevel,y;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(let b of this._indoorData.levels)b.id===this._selectedLevel.id&&(y=b.id);if(this.fire(new r.A("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:y})),c){let b=this._indoorData.buildings.find(E=>E.id===c);this._buildingSelected(b,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(f){let b=this._indoorData.levels.find(E=>E.id===f);this._updateLevels(b,s)}else s&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(s,c){c&&s&&s.extent&&this._map.fitBounds(s.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=s?s.id:void 0;let f=this._indoorData.levels.filter(y=>s.levels.includes(y.id));this.fire(new r.A("buildingselected",{buildingId:s.id,levels:f}))}_levelSelected(s){if(s==="overview")this._updateLevels(void 0,!0);else{let c=this._indoorData.levels.find(f=>f.id===s);this._updateLevels(c,!0)}this.fire(new r.A("levelselected",{levelId:s==="overview"?void 0:s}))}_updateLevels(s,c){if(!s)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(c&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function f(L){let F=L.indexOf("/floor/");if(F===-1)return L;let j=F+7,U=L.indexOf("/",j);return U===-1?L.slice(j):L.slice(j,U)}this._selectedLevel=s,this._floorplanStates[this._indoorData.id].selectedLevel=s?s.id:void 0;let y=[],b={},E={},R={},P={};for(let L of this._indoorData.levels)if(y.push(L.id),b[L.id]=L.height,E[L.id]=L.base,s){if(this.mergeFloors){let F=f(s.id),j=f(L.id);R[L.id]=j===F?"true":"false"}else R[L.id]=L.id===s.id?"true":"false";P[L.id]=L.base<s.base?"true":"false"}else P[L.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",y]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",b]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",E]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",R]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",P]),s&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!s.isUnderground),c&&s.extent)){let L=this._map.cameraForBounds(s.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),F=this._map.getZoom(),j=L.zoom?Math.abs(F-L.zoom):0;this._map.fitBounds(s.extent,j>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:F})}}selectFloorplan(s){let c={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},f=[new r.P(0,0),new r.P(this._map.transform.width,this._map.transform.height)],y=this._map.queryRenderedFeatures(f,c);if(y.length>0){for(let b of y)if(JSON.parse(b.properties["indoor-data"]).floorplanIDs.includes(s)){this._selectedFloorplan=b,this._floorplanSelected(!0);break}}}selectBuilding(s){let c=this._indoorData.buildings.find(f=>f.id===s);this._buildingSelected(c,!0)}selectLevel(s){this._levelSelected(s)}}function K0(m){if(!m.metadata||!m.metadata.content_area)return;let s=r.q.devicePixelRatio,{left:c,top:f,width:y,height:b}=m.metadata.content_area,E=c*s,R=f*s;return[E,R,E+y*s,R+b*s]}function rf(m){if(m)return m.map(([s,c])=>[s*r.q.devicePixelRatio,c*r.q.devicePixelRatio])}class Uv{constructor(s,c){this.id=s,this.style=c}addIcons(s){let c=new Map;for(let[f,y]of s.entries()){let b=r.I.from({name:f,iconsetId:this.id});c.set(b,y)}this.style.addImages(c)}}let ld=(m,s)=>st(m,s&&s.filter(c=>c.identifier!=="source.canvas")),Hv=r.aA(Sn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport"]),of=r.aA(Sn,["setCenter","setZoom","setBearing","setPitch"]),oc=new Set(["background","sky","slot","custom"]),X0={version:8,layers:[],sources:{}},uh={duration:300,delay:0};class Ms extends r.E{constructor(s,c={}){super(),this.map=s,this.scope=c.scope||"",this.globalId=null,this.fragments=[],this.importDepth=c.importDepth||0,this.importsCache=c.importsCache||new Map,this.resolvedImports=c.resolvedImports||new Set,this.transition=r.l({},uh),this._buildingIndex=new Tl(this),this.crossTileSymbolIndex=new Z0,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=c.styleChanges||new ca,this.dispatcher=c.dispatcher?c.dispatcher:new r.D(r.cj(),this),c.imageManager?this.imageManager=c.imageManager:(this.imageManager=new Cs(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=c.glyphManager?c.glyphManager:new r.ck(s._requestManager,c.localFontFamily?r.cl.all:c.localIdeographFontFamily?r.cl.ideographs:r.cl.none,c.localFontFamily||c.localIdeographFontFamily),c.modelManager?this.modelManager=c.modelManager:(this.modelManager=new Zm(s._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=c.configOptions?c.configOptions:new Map,this._configDependentLayers=c.configDependentLayers?c.configDependentLayers:new Set,this._config=c.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:c.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=c.initialConfig,this.dispatcher.broadcast("setReferrer",r.cm());let f=this;this._rtlTextPluginCallback=Ms.registerForPluginStateChange(y=>{f.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},(b,E)=>{if(r.cn(b),E&&E.every(R=>R))for(let R in f._sourceCaches){let P=f._sourceCaches[R],L=P.getSource().type;L!=="vector"&&L!=="geojson"||P.reload()}})}),this.on("data",y=>{if(y.dataType!=="source"||y.sourceDataType!=="metadata")return;let b=this.getOwnSource(y.sourceId);if(b&&b.vectorLayerIds)for(let E in this._layers){let R=this._layers[E];R.source===b.id&&this._validateLayer(R)}})}load(s){return s?(typeof s=="string"?this.loadURL(s):this.loadJSON(s),this):this}_getGlobalId(s){if(!s)return null;if(typeof s=="string"){if(r.f(s))return s;let c=r.co(s);if(!c.startsWith("http"))try{return new URL(c,location.href).toString()}catch{return c}return c}return`json://${r.cp(JSON.stringify(s))}`}_diffStyle(s,c,f){this.globalId=this._getGlobalId(s);let y=(b,E)=>{try{E(null,this.setState(b,f))}catch(R){E(R,!1)}};if(typeof s=="string"){let b=this.map._requestManager.normalizeStyleURL(s),E=this.map._requestManager.transformRequest(b,r.R.Style);r.n(E,(R,P)=>{R?this.fire(new r.z(R)):P&&y(P,c)})}else typeof s=="object"&&y(s,c)}loadURL(s,c={}){this.fire(new r.A("dataloading",{dataType:"style"}));let f=typeof c.validate=="boolean"?c.validate:!r.f(s);this.globalId=this._getGlobalId(s),s=this.map._requestManager.normalizeStyleURL(s,c.accessToken),this.resolvedImports.add(s);let y=this.importsCache.get(s);if(y)return this._load(y,f);let b=this.map._requestManager.transformRequest(s,r.R.Style);this._request=r.n(b,(E,R)=>{if(this._request=null,E)this.fire(new r.z(E));else if(R)return this.importsCache.set(s,R),this._load(R,f)})}loadJSON(s,c={}){this.fire(new r.A("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(s),this._request=r.q.frame(()=>{this._request=null,this._load(s,c.validate!==!1)})}loadEmpty(){this.fire(new r.A("dataloading",{dataType:"style"})),this._load(X0,!1)}_loadImports(s,c,f){if(this.importDepth>=4)return r.w("Style doesn't support nesting deeper than 5"),Promise.resolve();let y=[];for(let b of s){let E=this._createFragmentStyle(b),R=new Promise(F=>{E.once("style.import.load",F),E.once("error",F)}).then(()=>this.mergeAll());if(y.push(R),this.resolvedImports.has(b.url)){E.loadEmpty();continue}let P=b.data||this.importsCache.get(b.url);P?(E.loadJSON(P,{validate:c}),this._isInternalStyle(P)&&(E.globalId=null)):b.url?E.loadURL(b.url,{validate:c}):E.loadEmpty();let L={style:E,id:b.id,config:b.config};if(f){let F=this.fragments.findIndex(({id:j})=>j===f);this.fragments=this.fragments.slice(0,F).concat(L).concat(this.fragments.slice(F))}else this.fragments.push(L)}return Promise.allSettled(y)}getImportGlobalIds(s=this,c=new Set){for(let f of s.fragments)f.style.globalId&&c.add(f.style.globalId),this.getImportGlobalIds(f.style,c);return[...c.values()]}_createFragmentStyle(s){let c=this.scope?r.C(s.id,this.scope):s.id,f,y=this._initialConfig&&this._initialConfig[c];(s.config||y)&&(f=r.l({},s.config,y));let b=new Ms(this.map,{scope:c,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:f,configOptions:this.options,colorThemeOverride:s["color-theme"],configDependentLayers:this._configDependentLayers});return b.setEventedParent(this.map,{style:b}),b}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(s){return this.isRootStyle()&&(s.fragment||!!s.schema&&s.fragment!==!1)}_load(s,c){let f=s.indoor?ch(s.schema):s.schema;if(this._isInternalStyle(s)){let E=r.l({},X0,{imports:[{id:"basemap",data:s,url:""}]});return void this._load(E,c)}if(this.updateConfig(this._config,f),c&&ld(this,Pi(s)))return;this._loaded=!0,this.stylesheet=r.cq(s);let y=()=>{for(let L in s.sources)this.addSource(L,s.sources[L],{validate:!1,isInitialLoad:!0});if(s.iconsets)for(let L in s.iconsets)this.addIconset(L,s.iconsets[L]);s.sprite?this._loadIconset(s.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.setGlyphsUrl(s.glyphs);let E=Nc(this.stylesheet.layers);if(this._order=E.map(L=>L.id),this.stylesheet.light&&r.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){let L=this.stylesheet.lights[0];this.light=new at(L.properties,L.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new at(this.stylesheet.light)),this._layers={};for(let L of E){let F=r.cv(L,this.scope,this._styleColorTheme.lut,this.options);F.configDependencies.size!==0&&this._configDependentLayers.add(F.fqid),F.setEventedParent(this,{layer:{id:F.id}}),this._layers[F.id]=F;let j=this.getOwnLayerSourceCache(F),U=!!this.directionalLight&&this.directionalLight.shadowsEnabled();j&&F.canCastShadows()&&U&&(j.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);let R=this.stylesheet.terrain;R&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(R,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new r.A("data",{dataType:"style"}));let P=this.isRootStyle();s.imports?this._loadImports(s.imports,c).then(()=>{this._reloadImports(),this.fire(new r.A(P?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new r.A(P?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];let b=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(b){let E=this._evaluateColorThemeData(b);this._loadColorTheme(E).then(()=>{y()}).catch(R=>{r.w(`Couldn't load color theme from the stylesheet: ${R}`),y()})}else this._styleColorTheme.lut=null,y()}isRootStyle(){return this.importDepth===0}mergeAll(){let s,c,f,y,b,E,R,P,L,F,j={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(U=>{if(U.stylesheet){if(U.light!=null&&(s=U.light),U.stylesheet.lights)for(let W of U.stylesheet.lights)W.type==="ambient"&&U.ambientLight!=null&&(c=U.ambientLight),W.type==="directional"&&U.directionalLight!=null&&(f=U.directionalLight);y=this._prioritizeTerrain(y,U.terrain,U.stylesheet.terrain),U.stylesheet.fog&&U.fog!=null&&(b=U.fog),U.stylesheet.snow&&U.snow!=null&&(E=U.snow),U.stylesheet.rain&&U.rain!=null&&(R=U.rain),U.stylesheet.camera!=null&&(F=U.stylesheet.camera),U.stylesheet.projection!=null&&(P=U.stylesheet.projection),U.stylesheet.transition!=null&&(L=U.stylesheet.transition),j[U.scope]=U._styleColorTheme}}),this.light=s,this.ambientLight=c,this.directionalLight=f,this.fog=b,this.snow=E,this.rain=R,this._styleColorThemeForScope=j,y===null?delete this.terrain:this.terrain=y,this.camera=F||{"camera-projection":"perspective"},this.projection=P||{name:"mercator"},this.transition=r.l({},uh,L),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(s){let c=f=>{for(let y of f.fragments)c(y.style);s(f)};c(this)}_prioritizeTerrain(s,c,f){let y=s&&s.drapeRenderMode===0;return f===null?c&&c.drapeRenderMode===0?c:y?s:null:c!=null&&(!s||y||c&&c.drapeRenderMode===1)?c:s}mergeTerrain(){let s;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(c=>{s=this._prioritizeTerrain(s,c.terrain,c.stylesheet.terrain)}),s===null?delete this.terrain:this.terrain=s}mergeProjection(){let s;this.forEachFragmentStyle(c=>{c.stylesheet.projection!=null&&(s=c.stylesheet.projection)}),this.projection=s||{name:"mercator"}}mergeSources(){let s={},c={},f={};this.forEachFragmentStyle(y=>{for(let b in y._sourceCaches){let E=r.C(b,y.scope);s[E]=y._sourceCaches[b]}for(let b in y._otherSourceCaches){let E=r.C(b,y.scope);c[E]=y._otherSourceCaches[b]}for(let b in y._symbolSourceCaches){let E=r.C(b,y.scope);f[E]=y._symbolSourceCaches[b]}}),this._mergedSourceCaches=s,this._mergedOtherSourceCaches=c,this._mergedSymbolSourceCaches=f}mergeLayers(){let s={},c=[],f={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(b=>{for(let E of b._order){let R=b._layers[E];if(R.type==="slot"){let P=r.cr(E);if(s[P])continue;s[P]=[]}R.slot&&s[R.slot]?s[R.slot].push(R):c.push(R)}}),this._mergedOrder=[];let y=(b=[])=>{for(let E of b)if(E.type==="slot"){let R=r.cr(E.id);s[R]&&y(s[R]),this._mergedSlots.push(R)}else{let R=r.C(E.id,E.scope);this._mergedOrder.push(R),f[R]=E,E.is3D(!!this.terrain)&&(this._has3DLayers=!0),E.type==="circle"&&(this._hasCircleLayers=!0),E.type==="symbol"&&(this._hasSymbolLayers=!0),E.type==="clip"&&(this._clipLayerPresent=!0)}};y(c),this._mergedOrder.sort((b,E)=>{let R=f[b],P=f[E];return R.hasInitialOcclusionOpacityProperties?P.is3D(!!this.terrain)?1:0:R.is3D(!!this.terrain)&&P.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=f,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(s){return this.stylesheet.camera=r.l({},this.stylesheet.camera,s),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(s){return s.data?function(c,f,y){let b=r.l({},f);for(let R of Object.keys(r.a5.colorTheme))b[R]===void 0&&(b[R]=r.a5.colorTheme[R].default);let E=new r.a6(jv,c,new Map(y));return E.setTransitionOrValue(b,y),E.untransitioned().possiblyEvaluate(new r.aa(0))}(this.scope,s,this.options).get("data"):null}_loadColorTheme(s){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;let c=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((f,y)=>{let b="data:image/png;base64,";if(!s||s.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void f();let E=s;E.startsWith(b)||(E=b+E);let R=r.I.from("mapbox-reserved-lut"),P=new Image;P.src=E,P.onerror=()=>{this._styleColorTheme.lutLoading=!1,y(new Error("Failed to load image data"))},P.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==c)return void f();this._styleColorTheme.lutLoading=!1;let{width:L,height:F,data:j}=r.q.getImageData(P);if(F>32)return void y(new Error("The height of the image must be less than or equal to 32 pixels."));if(L!==F*F)return void y(new Error("The width of the image must be equal to the height squared."));this.getImage(R)&&this.removeImage(R),this.addImage(R,{data:new r.r({width:L,height:F},j),pixelRatio:1,sdf:!1,usvg:!1,version:0});let U=this.imageManager.getImage(R,this.scope);U?(this._styleColorTheme.lut={image:U.data,data:s},f()):y(new Error("Missing LUT image."))}})}getLut(s){let c=this._styleColorThemeForScope[s];return c?c.lut:null}setProjection(s){s?this.stylesheet.projection=s:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(s){this._spriteRequest=function(c,f,y){let b,E,R,P=r.q.devicePixelRatio>1?"@2x":"",L=r.n(f.transformRequest(f.normalizeSpriteURL(c,P,".json"),r.R.SpriteJSON),(U,W)=>{L=null,R||(R=U,b=W,j())}),F=r.o(f.transformRequest(f.normalizeSpriteURL(c,P,".png"),r.R.SpriteImage),(U,W)=>{F=null,R||(R=U,E=W,j())});function j(){if(R)y(R);else if(b&&E){let U=r.q.getImageData(E),W={};for(let ie in b){let{width:Q,height:re,x:oe,y:me,sdf:Me,pixelRatio:Ee,stretchX:Le,stretchY:Ie,content:Ae}=b[ie],Re=new r.r({width:Q,height:re});r.r.copy(U,Re,{x:oe,y:me},{x:0,y:0},{width:Q,height:re},null),W[ie]={data:Re,pixelRatio:Ee,sdf:Me,stretchX:Le,stretchY:Ie,content:Ae,usvg:!1}}y(null,W)}}return{cancel(){L&&(L.cancel(),L=null),F&&(F.cancel(),F=null)}}}(s,this.map._requestManager,(c,f)=>{if(this._spriteRequest=null,c)this.fire(new r.z(c));else if(f){let y=new Map;for(let b in f)y.set(r.I.from(b),f[b]);this.addImages(y)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new r.A("data",{dataType:"style"}))})}addIconset(s,c){if(c.type==="sprite")return void this._loadSprite(c.url);let f=this.getOwnSource(c.source);if(!f)return void this.fire(new r.z(new Error(`Source "${c.source}" as specified by iconset "${s}" does not exist and cannot be used as an iconset source`)));if(f.type!=="raster-array")return void this.fire(new r.z(new Error(`Source "${c.source}" as specified by iconset "${s}" is not a "raster-array" source and cannot be used as an iconset source`)));this.imageManager.createIconset(this.scope,s);let y=new Uv(s,this);f.addIconset(s,y)}_loadIconset(s){if(!r.f(s)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(s);let c=this.map._spriteFormat==="auto";var f,y;this._spriteRequest=(y=(b,E)=>{if(this._spriteRequest=null,b)c?this._loadSprite(s):this.fire(new r.z(b));else if(E){let R=new Map;for(let P in E)R.set(r.I.from(P),E[P]);this.addImages(R)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new r.A("data",{dataType:"style"}))},r.bj((f=this.map._requestManager).transformRequest(f.normalizeIconsetURL(s),r.R.Iconset),(b,E)=>{if(b)return void y(b);let R={},P=r.ch(new r.bi(E));for(let L of P.icons){let F={version:1,pixelRatio:r.q.devicePixelRatio,content:K0(L),stretchX:L.metadata?rf(L.metadata.stretch_x_areas):void 0,stretchY:L.metadata?rf(L.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:L};R[L.name]=F}y(null,R)}))}_validateLayer(s){let c=this.getOwnSource(s.source);if(!c)return;let f=s.sourceLayer;f&&(c.type==="geojson"||c.vectorLayerIds&&c.vectorLayerIds.indexOf(f)===-1)&&this.fire(new r.z(new Error(`Source layer "${f}" does not exist on source "${c.id}" as specified by style layer "${s.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(let s in this._sourceCaches)if(!this._sourceCaches[s].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(let{style:s}of this.fragments)if(!s.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((s,c)=>{let f=this.fragments[c];return f&&f.style&&(s.data=f.style.serialize()),s})}_serializeSources(){let s={};for(let c in this._sourceCaches){let f=this._sourceCaches[c].getSource();s[f.id]||(s[f.id]=f.serialize())}return s}_serializeLayers(s){let c=[];for(let f of s){let y=this._layers[f];y&&y.type!=="custom"&&c.push(y.serialize())}return c}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(let s in this._sourceCaches)if(this._sourceCaches[s].hasTransition())return!0;for(let s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(s){return s?this.order:this._mergedOrder}isLayerDraped(s){return!!this.terrain&&s.isDraped(this.getLayerSourceCache(s))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(s){let c=this.getOwnLayer(s);if(c)return c;this.fire(new r.z(new Error(`The layer '${s}' does not exist in the map's style.`)))}_checkSource(s){let c=this.getOwnSource(s);if(c)return c;this.fire(new r.z(new Error(`The source '${s}' does not exist in the map's style.`)))}precompilePrograms(s,c){let f=this.map.painter;if(f)for(let y=s.minzoom||0;y<(s.maxzoom||25.5);y++){let b=s.getProgramIds();if(b)for(let E of b){let R=s.getDefaultProgramParams(E,c.zoom,this._styleColorTheme.lut);R&&(f.style=this,this.fog&&(f._fogVisible=!0,R.overrideFog=!0,f.getOrCreateProgram(E,R)),f._fogVisible=!1,R.overrideFog=!1,f.getOrCreateProgram(E,R),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(R.overrideRtt=!0,f.getOrCreateProgram(E,R)))}}}update(s){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(s),this.directionalLight&&this.directionalLight.recalculate(s);let c=this.calculateLightsBrightness();s.brightness=c||0,c!==this._brightness&&(this._brightness=c,this.dispatcher.broadcast("setBrightness",c));let f=this._changes.isDirty(),y=!1;if(this._changes.isDirty()){let E=this._changes.getLayerUpdatesByScope();for(let R in E){let{updatedIds:P,removedIds:L}=E[R];(P||L)&&(this._updateWorkerLayers(R,P,L),y=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(s),this.light&&this.light.updateTransitions(s),this.ambientLight&&this.ambientLight.updateTransitions(s),this.directionalLight&&this.directionalLight.updateTransitions(s),this.fog&&this.fog.updateTransitions(s),this.snow&&this.snow.updateTransitions(s),this.rain&&this.rain.updateTransitions(s),this._changes.reset()}let b={};for(let E in this._mergedSourceCaches){let R=this._mergedSourceCaches[E];b[E]=R.used,R.used=!1,R.tileCoverLift=0}for(let E of this._mergedOrder){let R=this._mergedLayers[E];if(R.recalculate(s,this._availableImages),!R.isHidden(s.zoom)){let P=this.getLayerSourceCache(R);P&&(P.used=!0,P.tileCoverLift=Math.max(P.tileCoverLift,R.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(R,s)}):this.precompilePrograms(R,s))}for(let E in this._mergedSourceCaches){let R=this._mergedSourceCaches[E];if(!R)continue;let P=R._source;P.type==="raster-array"&&P.iconsets&&(R.used=!0)}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&y&&this.mergeLayers();for(let E in b){let R=this._mergedSourceCaches[E];b[E]!==R.used&&R.getSource().fire(new r.A("data",{sourceDataType:"visibility",dataType:"source",sourceId:R.getSource().id}))}this.light&&this.light.recalculate(s),this.terrain&&this.terrain.recalculate(s),this.fog&&this.fog.recalculate(s),this.snow&&this.snow.recalculate(s),this.rain&&this.rain.recalculate(s),this.z=s.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),f&&this.fire(new r.A("data",{dataType:"style"}))}_updateTilesForChangedImages(){let s=this._changes.getUpdatedImages();if(s.length){for(let c in this._mergedSourceCaches)this._mergedSourceCaches[c].reloadTilesForDependencies(["icons","patterns"],s);this._changes.resetUpdatedImages()}}_updateWorkerLayers(s,c,f){let y=this.getFragmentStyle(s);y&&this.dispatcher.broadcast("updateLayers",{layers:c?y._serializeLayers(c):[],scope:s,removedIds:f||[],options:y.options})}setState(s,c){if(this._checkLoaded(),ld(this,Pi(s)))return!1;(s=r.cq(s)).layers=Nc(s.layers);let f=function(E,R){if(!E)return[{command:Sn.setStyle,args:[R]}];let P=[];try{if(!r.bn(E.version,R.version))return[{command:Sn.setStyle,args:[R]}];if(r.bn(E.center,R.center)||P.push({command:Sn.setCenter,args:[R.center]}),r.bn(E.zoom,R.zoom)||P.push({command:Sn.setZoom,args:[R.zoom]}),r.bn(E.bearing,R.bearing)||P.push({command:Sn.setBearing,args:[R.bearing]}),r.bn(E.pitch,R.pitch)||P.push({command:Sn.setPitch,args:[R.pitch]}),r.bn(E.sprite,R.sprite)||P.push({command:Sn.setSprite,args:[R.sprite]}),r.bn(E.glyphs,R.glyphs)||P.push({command:Sn.setGlyphs,args:[R.glyphs]}),r.bn(E.imports,R.imports)||function(W=[],ie=[],Q){ie=ie||[];let re=(W=W||[]).map(kn),oe=ie.map(kn),me=W.reduce(Xo,{}),Me=ie.reduce(Xo,{}),Ee=re.slice(),Le,Ie,Ae,Re;for(Le=0,Ie=0;Le<re.length;Le++)Ae=re[Le],Me.hasOwnProperty(Ae)?Ie++:(Q.push({command:Sn.removeImport,args:[Ae]}),Ee.splice(Ee.indexOf(Ae,Ie),1));for(Le=0,Ie=0;Le<oe.length;Le++)Ae=oe[oe.length-1-Le],Ee[Ee.length-1-Le]!==Ae&&(me.hasOwnProperty(Ae)?(Q.push({command:Sn.removeImport,args:[Ae]}),Ee.splice(Ee.lastIndexOf(Ae,Ee.length-Ie),1)):Ie++,Re=Ee[Ee.length-Le],Q.push({command:Sn.addImport,args:[Me[Ae],Re]}),Ee.splice(Ee.length-Le,0,Ae));for(let Ve of ie){let qe=me[Ve.id];qe&&!r.bn(qe,Ve)&&Q.push({command:Sn.updateImport,args:[Ve.id,Ve]})}}(E.imports,R.imports,P),r.bn(E.transition,R.transition)||P.push({command:Sn.setTransition,args:[R.transition]}),r.bn(E.light,R.light)||P.push({command:Sn.setLight,args:[R.light]}),r.bn(E.fog,R.fog)||P.push({command:Sn.setFog,args:[R.fog]}),r.bn(E.snow,R.snow)||P.push({command:Sn.setSnow,args:[R.snow]}),r.bn(E.rain,R.rain)||P.push({command:Sn.setRain,args:[R.rain]}),r.bn(E.projection,R.projection)||P.push({command:Sn.setProjection,args:[R.projection]}),r.bn(E.lights,R.lights)||P.push({command:Sn.setLights,args:[R.lights]}),r.bn(E.camera,R.camera)||P.push({command:Sn.setCamera,args:[R.camera]}),!r.bn(E["color-theme"],R["color-theme"]))return[{command:Sn.setStyle,args:[R]}];let L={},F=[];(function(W,ie,Q,re){let oe;for(oe in ie=ie||{},W=W||{})W.hasOwnProperty(oe)&&(ie.hasOwnProperty(oe)||td(oe,Q,re));for(oe in ie){if(!ie.hasOwnProperty(oe))continue;let me=ie[oe];W.hasOwnProperty(oe)?r.bn(W[oe],me)||(W[oe].type==="geojson"&&me.type==="geojson"&&fi(W,ie,oe)?Q.push({command:Sn.setGeoJSONSourceData,args:[oe,me.data]}):_u(oe,ie,Q,re)):yn(oe,ie,Q)}})(E.sources,R.sources,F,L);let j=[];E.layers&&E.layers.forEach(W=>{W.source&&L[W.source]?P.push({command:Sn.removeLayer,args:[W.id]}):j.push(W)});let U=E.terrain;U&&L[U.source]&&(P.push({command:Sn.setTerrain,args:[void 0]}),U=void 0),P=P.concat(F),r.bn(U,R.terrain)||P.push({command:Sn.setTerrain,args:[R.terrain]}),function(W,ie,Q){ie=ie||[];let re=(W=W||[]).map(kn),oe=ie.map(kn),me=W.reduce(Xo,{}),Me=ie.reduce(Xo,{}),Ee=re.slice(),Le=Object.create(null),Ie,Ae,Re,Ve,qe,dt,nt;for(Ie=0,Ae=0;Ie<re.length;Ie++)Re=re[Ie],Me.hasOwnProperty(Re)?Ae++:(Q.push({command:Sn.removeLayer,args:[Re]}),Ee.splice(Ee.indexOf(Re,Ae),1));for(Ie=0,Ae=0;Ie<oe.length;Ie++)Re=oe[oe.length-1-Ie],Ee[Ee.length-1-Ie]!==Re&&(me.hasOwnProperty(Re)?(Q.push({command:Sn.removeLayer,args:[Re]}),Ee.splice(Ee.lastIndexOf(Re,Ee.length-Ae),1)):Ae++,dt=Ee[Ee.length-Ie],Q.push({command:Sn.addLayer,args:[Me[Re],dt]}),Ee.splice(Ee.length-Ie,0,Re),Le[Re]=!0);for(Ie=0;Ie<oe.length;Ie++)if(Re=oe[Ie],Ve=me[Re],qe=Me[Re],!Le[Re]&&!r.bn(Ve,qe))if(r.bn(Ve.source,qe.source)&&r.bn(Ve["source-layer"],qe["source-layer"])&&r.bn(Ve.type,qe.type)){for(nt in jn(Ve.layout,qe.layout,Q,Re,null,Sn.setLayoutProperty),jn(Ve.paint,qe.paint,Q,Re,null,Sn.setPaintProperty),r.bn(Ve.slot,qe.slot)||Q.push({command:Sn.setSlot,args:[Re,qe.slot]}),r.bn(Ve.filter,qe.filter)||Q.push({command:Sn.setFilter,args:[Re,qe.filter]}),r.bn(Ve.minzoom,qe.minzoom)&&r.bn(Ve.maxzoom,qe.maxzoom)||Q.push({command:Sn.setLayerZoomRange,args:[Re,qe.minzoom,qe.maxzoom]}),Ve)Ve.hasOwnProperty(nt)&&nt!=="layout"&&nt!=="paint"&&nt!=="filter"&&nt!=="metadata"&&nt!=="minzoom"&&nt!=="maxzoom"&&nt!=="slot"&&(nt.indexOf("paint.")===0?jn(Ve[nt],qe[nt],Q,Re,nt.slice(6),Sn.setPaintProperty):r.bn(Ve[nt],qe[nt])||Q.push({command:Sn.setLayerProperty,args:[Re,nt,qe[nt]]}));for(nt in qe)qe.hasOwnProperty(nt)&&!Ve.hasOwnProperty(nt)&&nt!=="layout"&&nt!=="paint"&&nt!=="filter"&&nt!=="metadata"&&nt!=="minzoom"&&nt!=="maxzoom"&&nt!=="slot"&&(nt.indexOf("paint.")===0?jn(Ve[nt],qe[nt],Q,Re,nt.slice(6),Sn.setPaintProperty):r.bn(Ve[nt],qe[nt])||Q.push({command:Sn.setLayerProperty,args:[Re,nt,qe[nt]]}))}else Q.push({command:Sn.removeLayer,args:[Re]}),dt=Ee[Ee.lastIndexOf(Re)+1],Q.push({command:Sn.addLayer,args:[qe,dt]})}(j,R.layers,P)}catch(L){console.warn("Unable to compute style diff:",L),P=[{command:Sn.setStyle,args:[R]}]}return P}(this.serialize(),s).filter(E=>!(E.command in of));if(f.length===0)return!1;let y=f.filter(E=>!(E.command in Hv));if(y.length>0)throw new Error(`Unimplemented: ${y.map(E=>E.command).join(", ")}.`);let b=[];return f.forEach(E=>{b.push(this[E.command].apply(this,E.args))}),c&&Promise.all(b).then(c),this.stylesheet=s,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}addImages(s){for(let[c,f]of s.entries()){if(this.getImage(c)&&!c.iconsetId)return this.fire(new r.z(new Error(`An image with the name "${c.name}" already exists.`)));this.imageManager.addImage(c,this.scope,f),this._changes.updateImage(c)}return this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})),this}addImage(s,c){return this.getImage(s)&&!s.iconsetId?this.fire(new r.z(new Error(`An image with the name "${s.name}" already exists.`))):(this.imageManager.addImage(s,this.scope,c),this._changes.updateImage(s),this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})),this)}updateImage(s,c,f=!1){this.imageManager.updateImage(s,this.scope,c),f&&(this._changes.updateImage(s),this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})))}getImage(s){return this.imageManager.getImage(s,this.scope)}removeImage(s){return this.getImage(s)?(this.imageManager.removeImage(s,this.scope),this._changes.updateImage(s),this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})),this):this.fire(new r.z(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(s,c,f={}){return this._checkLoaded(),this._validate(ze,`models.${s}`,c,null,f)||(this.modelManager.addModel(s,c,this.scope),this._changes.setDirty()),this}hasModel(s){return this.modelManager.hasModel(s,this.scope)}removeModel(s){return this.hasModel(s)?(this.modelManager.removeModel(s,this.scope),this):this.fire(new r.z(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(s,c,f={}){if(this._checkLoaded(),this.getOwnSource(s)!==void 0)throw new Error(`There is already a source with ID "${s}".`);if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(Bs,`sources.${s}`,c,null,f))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);let y=Sl(s,c,this.dispatcher,this);y.scope=this.scope,y.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(y.id),source:y.serialize(),sourceId:y.id}));let b=E=>{let R=(E?"symbol:":"other:")+y.id,P=r.C(R,this.scope),L=this._sourceCaches[R]=new al(P,y,E);(E?this._symbolSourceCaches:this._otherSourceCaches)[y.id]=L,L.onAdd(this.map)};b(!1),c.type!=="vector"&&c.type!=="geojson"||b(!0),y.onAdd&&y.onAdd(this.map),f.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(s){this._checkLoaded();let c=this.getOwnSource(s);if(!c)throw new Error("There is no source with this ID");for(let y in this._layers)if(this._layers[y].source===s)return this.fire(new r.z(new Error(`Source "${s}" cannot be removed while layer "${y}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===s)return this.fire(new r.z(new Error(`Source "${s}" cannot be removed while terrain is using it.`)));let f=this.getOwnSourceCaches(s);for(let y of f){let b=r.cr(y.id);delete this._sourceCaches[b],this._changes.discardSourceCacheUpdate(y.id),y.fire(new r.A("data",{sourceDataType:"metadata",dataType:"source",sourceId:y.getSource().id})),y.setEventedParent(null),y.clearTiles()}return delete this._otherSourceCaches[s],delete this._symbolSourceCaches[s],this.mergeSources(),c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(s,c){this._checkLoaded(),this.getOwnSource(s).setData(c),this._changes.setDirty()}getOwnSource(s){let c=this.getOwnSourceCache(s);return c&&c.getSource()}getOwnSources(){let s=[];for(let c in this._otherSourceCaches){let f=this.getOwnSourceCache(c);f&&s.push(f.getSource())}return s}areTilesLoaded(){let s=this._mergedSourceCaches;for(let c in s){let f=s[c]._tiles;for(let y in f){let b=f[y];if(b.state!=="loaded"&&b.state!=="errored")return!1}}return!0}setLights(s){if(this._checkLoaded(),!s)return delete this.ambientLight,void delete this.directionalLight;let c=this._getTransitionParameters();for(let y of s){if(this._validate(rl,"lights",y))return;switch(y.type){case"ambient":if(this.ambientLight){let b=this.ambientLight;b.set(y),b.updateTransitions(c)}else this.ambientLight=new Jr(y,gn||(gn=new r.a7({color:new r.a8(r.a5.properties_light_ambient.color),"color-use-theme":new r.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new r.a8(r.a5.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){let b=this.directionalLight;b.set(y),b.updateTransitions(c)}else this.directionalLight=new Jr(y,Rn||(Rn=new r.a7({direction:new r.am(r.a5.properties_light_directional.direction),color:new r.a8(r.a5.properties_light_directional.color),"color-use-theme":new r.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new r.a8(r.a5.properties_light_directional.intensity),"cast-shadows":new r.a8(r.a5.properties_light_directional["cast-shadows"]),"shadow-quality":new r.a8(r.a5.properties_light_directional["shadow-quality"]),"shadow-intensity":new r.a8(r.a5.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}let f=new r.aa(this.z||0,c);this.ambientLight&&this.ambientLight.recalculate(f),this.directionalLight&&this.directionalLight.recalculate(f),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){let s=this.directionalLight,c=this.ambientLight;if(!s||!c)return;let f=U=>.2126*(U[0]<=.03928?U[0]/12.92:Math.pow((U[0]+.055)/1.055,2.4))+.7152*(U[1]<=.03928?U[1]/12.92:Math.pow((U[1]+.055)/1.055,2.4))+.0722*(U[2]<=.03928?U[2]/12.92:Math.pow((U[2]+.055)/1.055,2.4)),y=s.properties.get("color").toRenderColor(null).toArray01(),b=s.properties.get("intensity"),E=s.properties.get("direction"),R=1-r.cc(E.x,E.y,E.z)[2]/90,P=f(y)*b*R,L=c.properties.get("color").toRenderColor(null).toArray01(),F=c.properties.get("intensity"),j=f(L)*F;return Number(((P+j)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;let s=[];return this.directionalLight&&s.push(this.directionalLight.get()),this.ambientLight&&s.push(this.ambientLight.get()),s}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(s){if(!s)return this;if(r.cs(s)){let c=r.ct(s),f=this.fragments.find(({id:b})=>b===c);if(!f)throw new Error(`Style import '${s}' not found`);let y=r.cr(s);return f.style.getFragmentStyle(y)}{let c=this.fragments.find(({id:f})=>f===s);return c?c.style:void 0}}setFeaturesetSelectors(s){if(!s)return;let c={},f=(y,b="")=>`${y}::${b}`;this._featuresetSelectors={};for(let y in s){let b=this._featuresetSelectors[y]=[];for(let E of s[y].selectors){if(E.featureNamespace){let P=this.getOwnLayer(E.layer);if(!P){r.w(`Layer is undefined for selector: ${E.layer}`);continue}let L=f(P.source,P.sourceLayer);if(L in c&&c[L]!==E.featureNamespace){r.w(`"featureNamespace ${E.featureNamespace} of featureset ${y}'s selector is not associated to the same source, skip this selector`);continue}c[L]=E.featureNamespace}let R;if(E.properties)for(let P in E.properties){let L=r.X(E.properties[P]);L.result==="success"&&(R=R||{},R[P]=L.value)}b.push({layerId:E.layer,namespace:E.featureNamespace,properties:R,uniqueFeatureID:E._uniqueFeatureID})}}}getFeaturesetDescriptors(s){let c=this.getFragmentStyle(s);if(!c||!c.stylesheet.featuresets)return[];let f=[];for(let y in c.stylesheet.featuresets)f.push({featuresetId:y,importId:c.scope?c.scope:void 0});return f}getFeaturesetLayers(s,c){let f=this.getFragmentStyle(c),y=f.stylesheet.featuresets;if(!y||!y[s])return this.fire(new r.z(new Error(`The featureset '${s}' does not exist in the map's style and cannot be queried.`))),[];let b=[];for(let E of y[s].selectors){let R=f.getOwnLayer(E.layer);R&&b.push(R)}return b}getConfigProperty(s,c){let f=this.getFragmentStyle(s);if(!f)return null;let y=r.C(c,f.scope),b=f.options.get(y),E=b?b.value||b.default:null;return E?E.serialize():null}setConfigProperty(s,c,f){let y=this.getFragmentStyle(s);if(!y)return;let b=y.stylesheet.indoor?ch(y.stylesheet.schema):y.stylesheet.schema;if(!b||!b[c])return;let E=r.X(f);if(E.result!=="success")return void ld(this,E.value);let R=E.value.expression,P=r.C(c,y.scope),L=y.options.get(P);if(!L)return;let F,{minValue:j,maxValue:U,stepValue:W,type:ie,values:Q}=b[c],re=r.X(b[c].default);re.result==="success"&&(F=re.value.expression),F?(this.options.set(P,Object.assign({},L,{value:R,default:F,minValue:j,maxValue:U,stepValue:W,type:ie,values:Q})),this.updateConfigDependencies(c)):this.fire(new r.z(new Error(`No schema defined for the config option "${c}" in the "${s}" fragment.`)))}getConfig(s){let c=this.getFragmentStyle(s);if(!c)return null;let f=c.stylesheet.schema;if(!f)return null;let y={};for(let b in f){let E=r.C(b,c.scope),R=c.options.get(E),P=R?R.value||R.default:null;y[b]=P?P.serialize():null}return y}setConfig(s,c){let f=this.getFragmentStyle(s);f&&(f.updateConfig(c,f.stylesheet.schema),this.updateConfigDependencies())}getSchema(s){let c=this.getFragmentStyle(s);return c?c.stylesheet.schema:null}setSchema(s,c){let f=this.getFragmentStyle(s);f&&(f.stylesheet.schema=c,f.updateConfig(f._config,c),this.updateConfigDependencies())}updateConfig(s,c){if(this._config=s,s||c)if(c)for(let f in c){let y,b,E=r.X(c[f].default);if(E.result==="success"&&(y=E.value.expression),s&&s[f]!==void 0){let U=r.X(s[f]);U.result==="success"&&(b=U.value.expression)}let{minValue:R,maxValue:P,stepValue:L,type:F,values:j}=c[f];if(y){let U=r.C(f,this.scope);this.options.set(U,{default:y,value:b,minValue:R,maxValue:P,stepValue:L,type:F,values:j})}else this.fire(new r.z(new Error(`No schema defined for config option "${f}".`)))}else this.fire(new r.z(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(s){for(let c of this._configDependentLayers){let f=this.getLayer(c);if(f){if(s&&!f.configDependencies.has(s))continue;f.possiblyEvaluateVisibility(),this._updateLayer(f)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(c=>{let f=c._styleColorTheme.colorThemeOverride?c._styleColorTheme.colorThemeOverride:c._styleColorTheme.colorTheme;if(f){let y=c._evaluateColorThemeData(f);(!c._styleColorTheme.lut&&y!==""||c._styleColorTheme.lut&&y!==c._styleColorTheme.lut.data)&&c.setColorTheme(f)}}),this._changes.setDirty()}addLayer(s,c,f={}){this._checkLoaded();let y=s.id;if(this._layers[y])return void this.fire(new r.z(new Error(`Layer with id "${y}" already exists on this map`)));let b;if(s.type==="custom"){if(ld(this,r.cu(s)))return;b=r.cv(s,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof s.source=="object"&&(this.addSource(y,s.source),s=r.cq(s),s=r.l(s,{source:y})),this._validate(Y,`layers.${y}`,s,{arrayIndex:-1},f))return;b=r.cv(s,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(b),b.setEventedParent(this,{layer:{id:y}})}b.configDependencies.size!==0&&this._configDependentLayers.add(b.fqid);let E=this._order.length;if(c){let F=this._order.indexOf(c);if(F===-1)return void this.fire(new r.z(new Error(`Layer with id "${c}" does not exist on this map.`)));b.slot===this._layers[c].slot?E=F:r.w(`Layer with id "${c}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(E,0,y),this._layerOrderChanged=!0,this._layers[y]=b;let R=this.getOwnLayerSourceCache(b),P=!!this.directionalLight&&this.directionalLight.shadowsEnabled();R&&b.canCastShadows()&&P&&(R.castsShadows=!0);let L=this._changes.getRemovedLayer(b);if(L&&b.source&&R&&b.type!=="custom"){this._changes.discardLayerRemoval(b);let F=r.C(b.source,b.scope);L.type!==b.type?this._changes.updateSourceCache(F,"clear"):(this._changes.updateSourceCache(F,"reload"),R.pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map),b.scope=this.scope,this.mergeLayers()}moveLayer(s,c){this._checkLoaded();let f=this._checkLayer(s);if(!f||s===c)return;let y=this._order.indexOf(s);this._order.splice(y,1);let b=this._order.length;if(c){let E=this._order.indexOf(c);if(E===-1)return void this.fire(new r.z(new Error(`Layer with id "${c}" does not exist on this map.`)));f.slot===this._layers[c].slot?b=E:r.w(`Layer with id "${c}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(b,0,s),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(s){this._checkLoaded();let c=this._checkLayer(s);if(!c)return;c.setEventedParent(null);let f=this._order.indexOf(s);this._order.splice(f,1),delete this._layers[s],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(c.fqid),this._changes.removeLayer(c);let y=this.getOwnLayerSourceCache(c);if(y&&y.castsShadows){let b=!1;for(let E in this._layers)if(this._layers[E].source===c.source&&this._layers[E].canCastShadows()){b=!0;break}y.castsShadows=b}c.onRemove&&c.onRemove(this.map),this.mergeLayers()}getOwnLayer(s){return this._layers[s]}hasLayer(s){return s in this._mergedLayers}hasLayerType(s){for(let c in this._layers)if(this._layers[c].type===s)return!0;return!1}setLayerZoomRange(s,c,f){this._checkLoaded();let y=this._checkLayer(s);y&&(y.minzoom===c&&y.maxzoom===f||(c!=null&&(y.minzoom=c),f!=null&&(y.maxzoom=f),this._updateLayer(y)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(s,c){this._checkLoaded();let f=this._checkLayer(s);f&&f.slot!==c&&(f.slot=c,this._updateLayer(f))}setFilter(s,c,f={}){this._checkLoaded();let y=this._checkLayer(s);if(y&&!r.bn(y.filter,c))return c==null?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(ue,`layers.${y.id}.filter`,c,{layerType:y.type},f)||(y.filter=r.cq(c),this._updateLayer(y)))}getFilter(s){let c=this._checkLayer(s);if(c)return r.cq(c.filter)}setLayoutProperty(s,c,f,y={}){this._checkLoaded();let b=this._checkLayer(s);if(b&&!r.bn(b.getLayoutProperty(c),f)){if(f!=null&&(!y||y.validate!==!1)&&ld(b,Ne.call(Pi,{key:`layers.${s}.layout.${c}`,layerType:b.type,objectKey:c,value:f,styleSpec:r.a5,style:{glyphs:!0,sprite:!0}})))return;b.setLayoutProperty(c,f),b.configDependencies.size!==0&&this._configDependentLayers.add(b.fqid),this._updateLayer(b)}}getLayoutProperty(s,c){let f=this._checkLayer(s);if(f)return f.getLayoutProperty(c)}setPaintProperty(s,c,f,y={}){this._checkLoaded();let b=this._checkLayer(s);if(!b||r.bn(b.getPaintProperty(c),f)||f!=null&&(!y||y.validate!==!1)&&ld(b,Te.call(Pi,{key:`layers.${s}.paint.${c}`,layerType:b.type,objectKey:c,value:f,styleSpec:r.a5})))return;let E=b.setPaintProperty(c,f);b.configDependencies.size!==0&&this._configDependentLayers.add(b.fqid),E&&this._updateLayer(b),this._changes.updatePaintProperties(b)}getPaintProperty(s,c){let f=this._checkLayer(s);if(f)return f.getPaintProperty(c)}setFeatureState(s,c){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){let{featuresetId:P,importId:L}=s.target,F=this.getFragmentStyle(L),j=F.getFeaturesetLayers(P);for(let{source:U,sourceLayer:W}of j)F.setFeatureState({id:s.id,source:U,sourceLayer:W},c)}else if("layerId"in s.target){let{layerId:P}=s.target,L=this.getLayer(P);this.setFeatureState({id:s.id,source:L.source,sourceLayer:L.sourceLayer},c)}return}let f=s.source,y=s.sourceLayer,b=this._checkSource(f);if(!b)return;let E=b.type;if(E==="geojson"&&y)return void this.fire(new r.z(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(E==="vector"&&!y)return void this.fire(new r.z(new Error("The sourceLayer parameter must be provided for vector source types.")));s.id===void 0&&this.fire(new r.z(new Error("The feature id parameter must be provided.")));let R=this.getOwnSourceCaches(f);for(let P of R)P.setFeatureState(y,s.id,c)}removeFeatureState(s,c){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){let{featuresetId:P,importId:L}=s.target,F=this.getFragmentStyle(L),j=F.getFeaturesetLayers(P);for(let{source:U,sourceLayer:W}of j)F.removeFeatureState({id:s.id,source:U,sourceLayer:W},c)}else if("layerId"in s.target){let{layerId:P}=s.target,L=this.getLayer(P);this.removeFeatureState({id:s.id,source:L.source,sourceLayer:L.sourceLayer},c)}return}let f=s.source,y=this._checkSource(f);if(!y)return;let b=y.type,E=b==="vector"?s.sourceLayer:void 0;if(b==="vector"&&!E)return void this.fire(new r.z(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&typeof s.id!="string"&&typeof s.id!="number")return void this.fire(new r.z(new Error("A feature id is required to remove its specific state property.")));let R=this.getOwnSourceCaches(f);for(let P of R)P.removeFeatureState(E,s.id,c)}getFeatureState(s){if(this._checkLoaded(),"target"in s){let b;if("featuresetId"in s.target){let{featuresetId:E,importId:R}=s.target,P=this.getFragmentStyle(R),L=P.getFeaturesetLayers(E);for(let{source:F,sourceLayer:j}of L){let U=P.getFeatureState({id:s.id,source:F,sourceLayer:j});if(U&&!b)b=U;else if(!r.bn(b,U))return void this.fire(new r.z(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in s.target){let{layerId:E}=s.target,R=this.getLayer(E);b=this.getFeatureState({id:s.id,source:R.source,sourceLayer:R.sourceLayer})}return b}let c=s.source,f=s.sourceLayer,y=this._checkSource(c);if(y){if(y.type!=="vector"||f)return s.id===void 0&&this.fire(new r.z(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(c)[0].getFeatureState(f,s.id);this.fire(new r.z(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(s){return this.stylesheet.transition=r.l({},this.stylesheet.transition,s),this.transition=this.stylesheet.transition,this}getTransition(){return r.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();let s=this.getTerrain(),c=s&&this.terrain&&this.terrain.scope===this.scope?s:this.stylesheet.terrain;return r.cw({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:c,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},f=>f!==void 0)}_updateFilteredLayers(s){for(let c of Object.values(this._mergedLayers))s(c)&&this._updateLayer(c)}_updateLayer(s){this._changes.updateLayer(s);let c=this.getLayerSourceCache(s),f=r.C(s.source,s.scope),y=this._changes.getUpdatedSourceCaches();s.source&&!y[f]&&c&&c.getSource().type!=="raster"&&(this._changes.updateSourceCache(f,"reload"),c.pause()),s.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(s){let c=R=>this._mergedLayers[R].is3D(!!this.terrain),f=this.order,y={},b=[];for(let R=f.length-1;R>=0;R--){let P=f[R];if(c(P)){y[P]=R;for(let L of s){let F=L[P];if(F)for(let j of F)b.push(j)}}}b.sort((R,P)=>P.intersectionZ-R.intersectionZ);let E=[];for(let R=f.length-1;R>=0;R--){let P=f[R];if(c(P))for(let L=b.length-1;L>=0;L--){let F=b[L].feature;if(F.layer&&y[F.layer.id]<R)break;E.push(F),b.pop()}else for(let L of s){let F=L[P];if(F)for(let j of F)E.push(j.feature)}}return E}queryRenderedFeatures(s,c,f){let y;c&&!Array.isArray(c)&&c.filter&&(this._validate(ue,"queryRenderedFeatures.filter",c.filter,null,c),y=r.a_(c.filter));let b={},E=F=>{if(oc.has(F.type))return;let j=this.getOwnLayerSourceCache(F),U=b[j.id]=b[j.id]||{sourceCache:j,layers:{},has3DLayers:!1};F.is3D(!!this.terrain)&&(U.has3DLayers=!0),U.layers[F.fqid]=U.layers[F.fqid]||{styleLayer:F,targets:[]},U.layers[F.fqid].targets.push({filter:y})};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new r.z(new Error("parameters.layers must be an Array."))),[];for(let F of c.layers){let j=this._layers[F];if(!j)return this.fire(new r.z(new Error(`The layer '${F}' does not exist in the map's style and cannot be queried for features.`))),[];E(j)}}else for(let F in this._layers)E(this._layers[F]);let R=this._queryRenderedFeatures(s,b,f),P=this._flattenAndSortRenderedFeatures(R),L=[];for(let F of P)r.ct(F.layer.id)===this.scope&&L.push(F);return L}queryRenderedFeatureset(s,c,f){let y;c&&!Array.isArray(c)&&c.filter&&(this._validate(ue,"queryRenderedFeatures.filter",c.filter,null,c),y=r.a_(c.filter));let b="mock",E=[];if(c&&c.target)E.push(Object.assign({},c,{targetId:b,filter:y}));else{let F=this.getFeaturesetDescriptors();for(let j of F)E.push({targetId:b,filter:y,target:j});for(let{style:j}of this.fragments){let U=j.getFeaturesetDescriptors();for(let W of U)E.push({targetId:b,filter:y,target:W})}}let R=this.queryRenderedTargets(s,E,f),P=[],L=new Set;for(let F of R)for(let j of F.variants[b])th(j,F,L)||P.push(new r.cx(F,j));return P}queryRenderedTargets(s,c,f){let y={},b=(R,P,L,F)=>{let j=y[P.id]=y[P.id]||{sourceCache:P,layers:{},has3DLayers:!1};if(j.layers[R.fqid]=j.layers[R.fqid]||{styleLayer:R,targets:[]},R.is3D(!!this.terrain)&&(j.has3DLayers=!0),!F)return L.uniqueFeatureID=!1,void j.layers[R.fqid].targets.push(L);j.layers[R.fqid].targets.push(Object.assign({},L,{namespace:F.namespace,properties:F.properties,uniqueFeatureID:F.uniqueFeatureID}))};for(let R of c)if("featuresetId"in R.target){let{featuresetId:P,importId:L}=R.target,F=this.getFragmentStyle(L);if(!F||!F._featuresetSelectors)continue;let j=F._featuresetSelectors[P];if(!j){this.fire(new r.z(new Error(`The featureset '${P}' does not exist in the map's style and cannot be queried for features.`)));continue}for(let U of j){let W=F.getOwnLayer(U.layerId);W&&!oc.has(W.type)&&b(W,F.getOwnLayerSourceCache(W),R,U)}}else if("layerId"in R.target){let{layerId:P}=R.target,L=this.getLayer(P);if(!L||oc.has(L.type))continue;b(L,this.getLayerSourceCache(L),R)}let E=this._queryRenderedFeatures(s,y,f);return this._flattenAndSortRenderedFeatures(E)}_queryRenderedFeatures(s,c,f){let y=[],b=!!this.map._showQueryGeometry,E=Co.createFromScreenPoints(s,f);for(let R in c){let P=Ju(E,c[R],this._availableImages,f,b);Object.keys(P).length&&y.push(P)}if(this.placement)for(let R in c){if(!c[R].sourceCache._onlySymbols)continue;let P=Ql(E.screenGeometry,c[R],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(P).length&&y.push(P)}return y}querySourceFeatures(s,c){let f=c&&c.filter;f&&this._validate(ue,"querySourceFeatures.filter",f,null,c);let y=[],b=this.getOwnSourceCaches(s);for(let E of b)y=y.concat(Jp(E,c));return y}addSourceType(s,c,f){return Ms.getSourceType(s)?f(new Error(`A source type called "${s}" already exists.`)):(Ms.setSourceType(s,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:s,url:c.workerSourceURL},f):f(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(s,c,f={}){this._checkLoaded();let y=this.light.getLight(),b=!1;for(let R in s)if(!r.bn(s[R],y[R])){b=!0;break}if(!b)return;let E=this._getTransitionParameters();this.light.setLight(s,c,f),this.light.updateTransitions(E)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=r.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&r.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(s,c=1){if(this._checkLoaded(),!s)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),c===0&&delete this.terrain,s===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let f=s,y=s.source==null;if(c===1){if(this.disableElevatedTerrain)return;if(typeof f.source=="object"){let R="terrain-dem-src";this.addSource(R,f.source),f=r.cq(f),f=r.l(f,{source:R})}let b=r.l({},f),E={};if(this.terrain&&y){b.source=this.terrain.get().source;let R=this.terrain?this.getFragmentStyle(this.terrain.scope):null;R&&(E.style=R.serialize())}if(this._validate(ol,"terrain",b,E))return}if(!this.terrain||this.terrain.scope!==this.scope&&!y||this.terrain&&c!==this.terrain.drapeRenderMode){if(!f)return;this._createTerrain(f,c),this.fire(new r.A("data",{dataType:"style"}))}else{let b=this.terrain,E=b.get();for(let R of Object.keys(r.a5.terrain))!f.hasOwnProperty(R)&&r.a5.terrain[R].default&&(f[R]=r.a5.terrain[R].default);for(let R in s)if(!r.bn(s[R],E[R])){b.set(s,this.options),this.stylesheet.terrain=s;let P=this._getTransitionParameters({duration:0});b.updateTransitions(P),this.fire(new r.A("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(s){let c=this.fog=new Ke(s,this.map.transform,this.scope,this.options);this.stylesheet.fog=c.get();let f=this._getTransitionParameters({duration:0});c.updateTransitions(f)}_createSnow(s){let c=this.snow=new Un(s,this.map.transform,this.scope,this.options);this.stylesheet.snow=c.get();let f=this._getTransitionParameters({duration:0});c.updateTransitions(f)}_createRain(s){let c=this.rain=new dn(s,this.map.transform,this.scope,this.options);this.stylesheet.rain=c.get();let f=this._getTransitionParameters({duration:0});c.updateTransitions(f)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(let s of this.map._markers)s._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(s){if(this._checkLoaded(),!s)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){let c=this.fog;if(!r.bn(c.get(),s)){c.set(s,this.options),this.stylesheet.fog=c.get();let f=this._getTransitionParameters({duration:0});c.updateTransitions(f)}}else this._createFog(s);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(s){if(this._checkLoaded(),!s)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){let c=this.snow;if(!r.bn(c.get(),s)){c.set(s,this.options),this.stylesheet.snow=c.get();let f=this._getTransitionParameters({duration:0});c.updateTransitions(f)}}else this._createSnow(s);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(s){if(this._checkLoaded(),!s)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){let c=this.rain;if(!r.bn(c.get(),s)){c.set(s,this.options),this.stylesheet.rain=c.get();let f=this._getTransitionParameters({duration:0});c.updateTransitions(f)}}else this._createRain(s);this._markersNeedUpdate=!0}_reloadColorTheme(){let s=()=>{for(let y in this._layers)this._layers[y].lut=this._styleColorTheme.lut;for(let y in this._sourceCaches)this._sourceCaches[y].clearTiles()},c=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!c)return this._styleColorTheme.lut=null,void s();let f=this._evaluateColorThemeData(c);this._loadColorTheme(f).then(()=>{this.fire(new r.A("colorthemeset")),s()}).catch(y=>{r.w(`Couldn't set color theme: ${y}`)})}setColorTheme(s){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&r.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=s,this._reloadColorTheme()}setImportColorTheme(s,c){let f=this.getFragmentStyle(s);f&&(f._styleColorTheme.colorThemeOverride=c,f._reloadColorTheme())}_getTransitionParameters(s){return{now:r.q.now(),transition:r.l(this.transition,s)}}updateDrapeFirstLayers(){if(!this.terrain)return;let s=[],c=[];for(let f of this._mergedOrder)this.isLayerDraped(this._mergedLayers[f])?s.push(f):c.push(f);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...s),this._drapedFirstOrder.push(...c)}_createTerrain(s,c){let f=this.terrain=new gt(s,c,this.scope,this.options);c===1&&(this.stylesheet.terrain=s),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();let y=this._getTransitionParameters({duration:0});f.updateTransitions(y)}_force3DLayerUpdate(){for(let s in this._layers){let c=this._layers[s];c.type==="fill-extrusion"&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(let s in this._layers){let c=this._layers[s];c.type==="symbol"&&this._updateLayer(c)}}_validate(s,c,f,y,b={}){if(b&&b.validate===!1)return!1;let E=r.l({},this.serialize());return ld(this,s.call(Pi,r.l({key:c,style:E,value:f,styleSpec:r.a5},y)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),r.cy.off("pluginStateChange",this._rtlTextPluginCallback);for(let s in this._mergedLayers)this._mergedLayers[s].setEventedParent(null);for(let s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles(),this._mergedSourceCaches[s].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(s){let c=this.getSourceCaches(s);for(let f of c)f.clearTiles()}clearSources(){for(let s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles()}reloadSource(s){let c=this.getSourceCaches(s);for(let f of c)f.resume(),f.reload()}reloadSources(){for(let s of this.getSources())s.reload&&s.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(s=>{s.modelManager.reloadModels(s.scope)})}updateSources(s){let c;this.directionalLight&&(c=Rl(this.directionalLight));for(let f in this._mergedSourceCaches)this._mergedSourceCaches[f].update(s,void 0,void 0,c)}_generateCollisionBoxes(){for(let s in this._sourceCaches){let c=this._sourceCaches[s];c.resume(),c.reload()}}_updatePlacement(s,c,f,y,b,E,R=!1){let P=!1,L=!1,F={},j={};for(let U of this._mergedOrder){let W=this._mergedLayers[U];if(W.type!=="symbol")continue;let ie=r.C(W.source,W.scope),Q=F[ie];if(!Q){let oe=this.getLayerSourceCache(W);if(!oe)continue;let me=oe.getRenderableIds(!0).map(Me=>oe.getTileByID(Me));j[ie]=me.slice(),Q=F[ie]=me.sort((Me,Ee)=>Ee.tileID.overscaledZ-Me.tileID.overscaledZ||(Me.tileID.isLessThan(Ee.tileID)?-1:1))}let re=this.crossTileSymbolIndex.addLayer(W,Q,c.center.lng,c.projection);P=P||re}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),R=R||this._layerOrderChanged||y===0,this._layerOrderChanged&&this.fire(new r.A("neworder")),(R||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(r.q.now(),c.zoom))&&(this.pauseablePlacement=new Al(c,this._mergedOrder,R,f,y,b,this.placement,this.fog&&c.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,F,j,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(r.q.now()),L=!0),P&&this.pauseablePlacement.placement.setStale()),L||P){this._buildingIndex.onNewFrame(c.zoom);for(let U=0;U<this._mergedOrder.length;U++){let W=this._mergedLayers[this._mergedOrder[U]];if(W.type!=="symbol")continue;let ie=this.isLayerClipped(W);this.placement.updateLayerOpacities(W,F[r.C(W.source,W.scope)],U,ie?E:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(r.q.now())}}_releaseSymbolFadeTiles(){for(let s in this._sourceCaches)this._sourceCaches[s].releaseSymbolFadeTiles()}addImport(s,c){this._checkLoaded();let f=this.stylesheet.imports=this.stylesheet.imports||[];if(f.findIndex(({id:b})=>b===s.id)!==-1)return void this.fire(new r.z(new Error(`Import with id '${s.id}' already exists in the map's style.`)));if(!c)return f.push(s),this._loadImports([s],!0);let y=f.findIndex(({id:b})=>b===c);return y===-1&&this.fire(new r.z(new Error(`Import with id "${c}" does not exist on this map.`))),this.stylesheet.imports=f.slice(0,y).concat(s).concat(f.slice(y)),this._loadImports([s],!0,c)}updateImport(s,c){this._checkLoaded();let f=this.stylesheet.imports||[],y=this.getImportIndex(s);return y===-1?this:typeof c=="string"?(this.setImportUrl(s,c),this):(c.url&&c.url!==f[y].url&&this.setImportUrl(s,c.url),r.bn(c.config,f[y].config)||this.setImportConfig(s,c.config,c.data.schema),r.bn(c.data,f[y].data)||this.setImportData(s,c.data),this)}moveImport(s,c){this._checkLoaded();let f=this.stylesheet.imports||[],y=this.getImportIndex(s);if(y===-1)return this;let b=this.getImportIndex(c);if(b===-1)return this;let E=f[y],R=this.fragments[y];return f=f.filter(({id:P})=>P!==s),this.fragments=this.fragments.filter(({id:P})=>P!==s),this.stylesheet.imports=f.slice(0,b).concat(E).concat(f.slice(b)),this.fragments=this.fragments.slice(0,b).concat(R).concat(this.fragments.slice(b)),this.mergeLayers(),this}setImportUrl(s,c){this._checkLoaded();let f=this.stylesheet.imports||[],y=this.getImportIndex(s);if(y===-1)return this;f[y].url=c;let b=this.fragments[y];return b.style=this._createFragmentStyle(f[y]),b.style.on("style.import.load",()=>this.mergeAll()),b.style.loadURL(c),this}setImportData(s,c){this._checkLoaded();let f=this.getImportIndex(s),y=this.stylesheet.imports||[];return f===-1?this:c?(this.fragments[f].style.setState(c),this._reloadImports(),this):(delete y[f].data,this.setImportUrl(s,y[f].url))}setImportConfig(s,c,f){this._checkLoaded();let y=this.getImportIndex(s),b=this.stylesheet.imports||[];if(y===-1)return this;c?b[y].config=c:delete b[y].config;let E=this.fragments[y];f&&E.style.stylesheet&&(E.style.stylesheet.schema=f);let R=E.style.stylesheet&&E.style.stylesheet.schema;return E.config=c,E.style.updateConfig(c,R),this.updateConfigDependencies(),this}removeImport(s){this._checkLoaded();let c=this.stylesheet.imports||[],f=this.getImportIndex(s);f!==-1&&(c.splice(f,1),this.fragments[f].style._remove(),this.fragments.splice(f,1),this._reloadImports())}getImportIndex(s){let c=(this.stylesheet.imports||[]).findIndex(f=>f.id===s);return c===-1&&this.fire(new r.z(new Error(`Import '${s}' does not exist in the map's style and cannot be updated.`))),c}getLayer(s){return this._mergedLayers[s]}getSources(){let s=[];for(let c in this._mergedOtherSourceCaches){let f=this._mergedOtherSourceCaches[c];f&&s.push(f.getSource())}return s}getSource(s,c){let f=this.getSourceCache(s,c);return f&&f.getSource()}getLayerSource(s){let c=this.getLayerSourceCache(s);return c&&c.getSource()}getSourceCache(s,c){let f=r.C(s,c);return this._mergedOtherSourceCaches[f]}getLayerSourceCache(s){let c=r.C(s.source,s.scope);return s.type==="symbol"?this._mergedSymbolSourceCaches[c]:this._mergedOtherSourceCaches[c]}getSourceCaches(s){if(s==null)return Object.values(this._mergedSourceCaches);let c=[];return this._mergedOtherSourceCaches[s]&&c.push(this._mergedOtherSourceCaches[s]),this._mergedSymbolSourceCaches[s]&&c.push(this._mergedSymbolSourceCaches[s]),c}updateSourceCaches(){let s=this._changes.getUpdatedSourceCaches();for(let c in s){let f=s[c];f==="reload"?this.reloadSource(c):f==="clear"&&this.clearSource(c)}}updateLayers(s){let c=this._changes.getUpdatedPaintProperties();for(let f of c){let y=this.getLayer(f);y&&y.updateTransitions(s)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(s){this.stylesheet.glyphs=s,this.glyphManager.setURL(s,this.scope)}getImages(s,c,f){this.imageManager.getImages(c.images,c.scope,f),this._updateTilesForChangedImages();let y=E=>{if(E){let R=c.images.map(P=>r.I.toString(P));E.setDependencies(c.tileID.key,c.type,R)}},b=r.C(c.source,c.scope);y(this._mergedOtherSourceCaches[b]),y(this._mergedSymbolSourceCaches[b])}rasterizeImages(s,c,f){this.imageManager.rasterizeImages(c,f)}getGlyphs(s,c,f){this.glyphManager.getGlyphs(c.stacks,c.scope,f)}getResource(s,c,f){return r.cz(c,f)}getOwnSourceCache(s){return this._otherSourceCaches[s]}getOwnLayerSourceCache(s){return s.type==="symbol"?this._symbolSourceCaches[s.source]:this._otherSourceCaches[s.source]}getOwnSourceCaches(s){let c=[];return this._otherSourceCaches[s]&&c.push(this._otherSourceCaches[s]),this._symbolSourceCaches[s]&&c.push(this._symbolSourceCaches[s]),c}_isSourceCacheLoaded(s){let c=this.getOwnSourceCaches(s);return c.length===0?(this.fire(new r.z(new Error(`There is no source with ID '${s}'`))),!1):c.every(f=>f.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(s,c){if(!this._clipLayerPresent&&s.type!=="fill-extrusion")return!1;let f=s.type==="fill-extrusion"&&s.sourceLayer==="building";if(s.is3D(!!this.terrain)){if(f||c&&c.type==="batched-model"||s.type==="model")return!0}else if(s.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(s=>{s.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Ms.getSourceType=function(m){return Qp[m]},Ms.setSourceType=function(m,s){Qp[m]=s},Ms.registerForPluginStateChange=r.ci;var yo=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,op=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,cd=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,xn="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",kl=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,cs=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Xm=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,qc=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,$c=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Ol=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Gc=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return clamp(mix(lerpx.x,lerpx.y,f.y),0.0,1.0);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;let Is=[];ac(yo,Is),ac(cd,Is),ac(op,Is);let us={"_prelude_fog.vertex.glsl":cs,"_prelude_terrain.vertex.glsl":kl,"_prelude_shadow.vertex.glsl":Ol,"_prelude_fog.fragment.glsl":Xm,"_prelude_shadow.fragment.glsl":Gc,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":qc,"_prelude_raster_particle.glsl":$c},Wc={};In("",kl),In(Xm,cs),In(Gc,Ol),In(qc,""),In($c,"");let ap=In(op,cd),sp=yo;var ud={background:In(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:In(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:In(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:In("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:In(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:In(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:In("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:In("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:In("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:In(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:In(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:In(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
void main() {vec3 color=vec3(241.0/255.0,236.0/255.0,225.0/255.0);
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,normal);
#endif
if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(v_normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:In(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:In(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:In(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:In(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:In(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:In(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:In(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:In(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:In(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:In(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:In(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:In(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),0.001);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:In(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:In(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:In(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:In("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:In("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:In(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:In(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#endif
}`),terrainRaster:In(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:In("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:In(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,xn),skyboxGradient:In(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,xn),skyboxCapture:In(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:In(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:In(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:In(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:In(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:In(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:In("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:In("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:In("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:In("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function ac(m,s){let c=m.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let f of c)if(f=f.trim(),f[0]==="#"&&f.includes("if")&&!f.includes("endif")){f=f.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();let y=f.split(" ");for(let b of y)s.includes(b)||s.push(b)}}function In(m,s){let c=/#include\s+"([^"]+)"/g,f=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g,y=s.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);y&&(y=y.map(L=>{let F=L.split(" ");return F[F.length-1]}),y=[...new Set(y)]);let b={},E=[],R=[];if(m=m.replace(c,(L,F)=>(R.push(F),"")),(s=s.replace(c,(L,F)=>(E.push(F),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let P=[...Is];ac(m,P),ac(s,P);for(let L of[...E,...R])us[L]||console.error(`Undefined include: ${L}`),Wc[L]||(Wc[L]=[],ac(us[L],Wc[L])),P=[...P,...Wc[L]];return{fragmentSource:m=m.replace(f,(L,F,j,U,W)=>(b[W]=!0,F==="define"?`
#ifndef HAS_UNIFORM_u_${W}
in ${j} ${U} ${W};
#else
uniform ${j} ${U} u_${W};
#endif
`:F==="initialize"?`
#ifdef HAS_UNIFORM_u_${W}
    ${j} ${U} ${W} = u_${W};
#endif
`:F==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    in ${j} ${U} ${W};
#endif
`:F==="initialize-attribute"?"":void 0)),vertexSource:s=s.replace(f,(L,F,j,U,W)=>{let ie=U==="float"?"vec2":U,Q=W.match(/color/)?"color":ie;return F==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${W}
in ${j} ${U} a_${W};
#endif
`:b[W]?F==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
in ${j} ${ie} a_${W};
out ${j} ${U} ${W};
#else
uniform ${j} ${U} u_${W};
#endif
`:F==="initialize"?Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = a_${W};
#else
    ${j} ${U} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = unpack_mix_${Q}(a_${W}, u_${W}_t);
#else
    ${j} ${U} ${W} = u_${W};
#endif
`:F==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    in ${j} ${U} a_${W};
    out ${j} ${U} ${W};
#endif
`:F==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    ${W} = a_${W};
#endif
`:void 0:F==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
in ${j} ${ie} a_${W};
#else
uniform ${j} ${U} u_${W};
#endif
`:F==="define-instanced"?Q==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${W}0;
in vec4 a_${W}1;
in vec4 a_${W}2;
in vec4 a_${W}3;
#else
uniform ${j} ${U} u_${W};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${j} ${ie} a_${W};
#else
uniform ${j} ${U} u_${W};
#endif
`:F==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    ${j} ${U} ${W} = a_${W};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${j} ${U} ${W} = a_${W};
#else
    ${j} ${U} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${j} ${U} ${W} = unpack_mix_${Q}(a_${W}, u_${W}_t);
#else
    ${j} ${U} ${W} = u_${W};
#endif
`}),staticAttributes:y,usedDefines:P,vertexIncludes:E,fragmentIncludes:R}}class Q0{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(s,c,f,y,b,E,R,P){this.context=s;let L=this.boundPaintVertexBuffers.length!==y.length;for(let j=0;!L&&j<y.length;j++)this.boundPaintVertexBuffers[j]!==y[j]&&(L=!0);let F=this.boundDynamicVertexBuffers.length!==R.length;for(let j=0;!F&&j<R.length;j++)this.boundDynamicVertexBuffers[j]!==R[j]&&(F=!0);if(!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==f||L||F||this.boundIndexBuffer!==b||this.boundVertexOffset!==E)this.freshBind(c,f,y,b,E,R,P);else{s.bindVertexArrayOES.set(this.vao);for(let j of R)j&&(j.bind(),P&&j.instanceCount&&j.setVertexAttribDivisor(s.gl,c,P));b&&b.dynamicDraw&&b.bind()}}freshBind(s,c,f,y,b,E,R){let P=s.numAttributes,L=this.context,F=L.gl;this.vao&&this.destroy(),this.vao=L.gl.createVertexArray(),L.bindVertexArrayOES.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=y,this.boundVertexOffset=b,this.boundDynamicVertexBuffers=E,c.enableAttributes(F,s),c.bind(),c.setVertexAttribPointers(F,s,b);for(let j of f)j.enableAttributes(F,s),j.bind(),j.setVertexAttribPointers(F,s,b);for(let j of E)j&&(j.enableAttributes(F,s),j.bind(),j.setVertexAttribPointers(F,s,b),R&&j.instanceCount&&j.setVertexAttribDivisor(F,s,R));y&&y.bind(),L.currentNumAttributes=P}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Qm(m,s){let c=Math.pow(2,s.canonical.z),f=s.canonical.y;return[new r.ac(0,f/c).toLngLat().lat,new r.ac(0,(f+1)/c).toLngLat().lat]}function ce(m,s,c,f,y,b,E){let R=m.context,P=R.gl,L=c.hillshadeFBO;if(!L)return;m.prepareDrawTile();let F=m.isTileAffectedByFog(s),j=m.getOrCreateProgram("hillshade",{overrideFog:F});R.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,L.colorAttachment.get());let U=((re,oe,me,Me)=>{let Ee=me.paint.get("hillshade-shadow-color"),Le=me.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Ie=me.paint.get("hillshade-highlight-color"),Ae=me.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Re=me.paint.get("hillshade-accent-color"),Ve=me.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",qe=me.paint.get("hillshade-emissive-strength"),dt=r.ak(me.paint.get("hillshade-illumination-direction"));if(me.paint.get("hillshade-illumination-anchor")==="viewport")dt-=re.transform.angle;else if(re.style&&re.style.enable3dLights()&&re.style.directionalLight){let Et=re.style.directionalLight.properties.get("direction"),Ct=r.cc(Et.x,Et.y,Et.z);dt=r.ak(Ct[1])}let nt=!re.options.moving;return{u_matrix:Me||re.transform.calculateProjMatrix(oe.tileID.toUnwrapped(),nt),u_image:0,u_latrange:Qm(0,oe.tileID),u_light:[me.paint.get("hillshade-exaggeration"),dt],u_shadow:Ee.toRenderColor(Le?null:me.lut),u_highlight:Ie.toRenderColor(Ae?null:me.lut),u_emissive_strength:qe,u_accent:Re.toRenderColor(Ve?null:me.lut)}})(m,c,f,m.terrain?s.projMatrix:null);m.uploadCommonUniforms(R,j,s.toUnwrapped());let{tileBoundsBuffer:W,tileBoundsIndexBuffer:ie,tileBoundsSegments:Q}=m.getTileBoundsBuffers(c);j.draw(m,P.TRIANGLES,y,b,E,Vi.disabled,U,f.id,W,ie,Q)}function de(m,s,c){if(!s.needsDEMTextureUpload)return;let f=m.context,y=f.gl;f.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||m.getTileTexture(c.stride);let b=c.getPixels();s.demTexture?s.demTexture.update(b,{premultiply:!1}):s.demTexture=new r.T(f,b,y.R32F,{premultiply:!1}),s.needsDEMTextureUpload=!1}function et(m,s,c){let f=m.context,y=f.gl;if(!s.dem)return;let b=s.dem;if(f.activeTexture.set(y.TEXTURE1),de(m,s,b),!s.demTexture)return;s.demTexture.bind(y.NEAREST,y.CLAMP_TO_EDGE);let E=b.dim;f.activeTexture.set(y.TEXTURE0);let R=s.hillshadeFBO;if(!R){let U=new r.T(f,{width:E,height:E,data:null},y.RGBA8);U.bind(y.LINEAR,y.CLAMP_TO_EDGE),R=s.hillshadeFBO=f.createFramebuffer(E,E,!0,"renderbuffer"),R.colorAttachment.set(U.texture)}f.bindFramebuffer.set(R.framebuffer),f.viewport.set([0,0,E,E]);let{tileBoundsBuffer:P,tileBoundsIndexBuffer:L,tileBoundsSegments:F}=m.getMercatorTileBoundsBuffers(),j=[];m.linearFloatFilteringSupported()&&j.push("TERRAIN_DEM_FLOAT_FORMAT"),m.getOrCreateProgram("hillshadePrepare",{defines:j}).draw(m,y.TRIANGLES,xi.disabled,en.disabled,_n.unblended,Vi.disabled,((U,W)=>{let ie=W.stride,Q=r.ad.mat4.create();return r.ad.mat4.ortho(Q,0,r.ai,-r.ai,0,0,1),r.ad.mat4.translate(Q,Q,[0,-r.ai,0]),{u_matrix:Q,u_image:1,u_dimension:[ie,ie],u_zoom:U.overscaledZ}})(s.tileID,b),c.id,P,L,F),s.needsHillshadePrepare=!1}class wt{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Zt extends wt{getDefault(){return r.al.transparent}set(s){let c=this.current;(s.r!==c.r||s.g!==c.g||s.b!==c.b||s.a!==c.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Li extends wt{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class Tn extends wt{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class mr extends wt{getDefault(){return[!0,!0,!0,!0]}set(s){let c=this.current;(s[0]!==c[0]||s[1]!==c[1]||s[2]!==c[2]||s[3]!==c[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class go extends wt{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class ba extends wt{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class qs extends wt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){let c=this.current;(s.func!==c.func||s.ref!==c.ref||s.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class Pl extends wt{getDefault(){let s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){let c=this.current;(s[0]!==c[0]||s[1]!==c[1]||s[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class Nl extends wt{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;s?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=s,this.dirty=!1}}class sl extends wt{getDefault(){return[0,1]}set(s){let c=this.current;(s[0]!==c[0]||s[1]!==c[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class dh extends wt{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;s?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=s,this.dirty=!1}}class $s extends wt{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class qv extends wt{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;s?c.enable(c.BLEND):c.disable(c.BLEND),this.current=s,this.dirty=!1}}class J0 extends wt{getDefault(){let s=this.gl;return[s.ONE,s.ZERO,s.ONE,s.ZERO]}set(s){let c=this.current;(s[0]!==c[0]||s[1]!==c[1]||s[2]!==c[2]||s[3]!==c[3]||this.dirty)&&(this.gl.blendFuncSeparate(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class e_ extends wt{getDefault(){return r.al.transparent}set(s){let c=this.current;(s.r!==c.r||s.g!==c.g||s.b!==c.b||s.a!==c.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class $v extends wt{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(s,s),this.current=s,this.dirty=!1)}}class Gv extends wt{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;s?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=s,this.dirty=!1}}class Wv extends wt{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class t_ extends wt{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}let Zv=class extends wt{getDefault(){return null}set(m){(m!==this.current||this.dirty)&&(this.gl.useProgram(m),this.current=m,this.dirty=!1)}};class Yv extends wt{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class i_ extends wt{getDefault(){let s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){let c=this.current;(s[0]!==c[0]||s[1]!==c[1]||s[2]!==c[2]||s[3]!==c[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class lE extends wt{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class cE extends wt{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class af extends wt{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;c.bindTexture(c.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class EI extends wt{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class CI extends wt{getDefault(){return null}set(s){let c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class SI extends wt{getDefault(){return null}set(s){this.gl&&(s!==this.current||this.dirty)&&(this.gl.bindVertexArray(s),this.current=s,this.dirty=!1)}}class TI extends wt{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class DI extends wt{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class MI extends wt{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class Jm extends wt{constructor(s,c){super(s),this.context=s,this.parent=c}getDefault(){return null}}class Kv extends Jm{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class Xv extends Jm{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class sf extends Jm{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,this.attachment(),c.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class uE extends Xv{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}let dE=(m,s,c)=>({u_matrix:m,u_image0:0,u_skirt_height:s,u_ground_shadow_factor:c}),Qv=(m,s,c,f,y,b,E,R,P,L,F,j,U,W,ie,Q)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:s,u_normalize_matrix:Float32Array.from(f),u_merc_matrix:c,u_zoom_transition:y,u_merc_center:b,u_image0:0,u_frustum_tl:E,u_frustum_tr:R,u_frustum_br:P,u_frustum_bl:L,u_globe_pos:F,u_globe_radius:j,u_viewport:U,u_grid_matrix:Q?Float32Array.from(Q):new Float32Array(9),u_skirt_height:W,u_far_z_cutoff:ie});function n_(m,s){return m!=null&&s!=null&&!(!m.hasData()||!s.hasData())&&m.demTexture!=null&&s.demTexture!=null&&m.tileID.key!==s.tileID.key}let sc=new class{constructor(){this.operations={}}newMorphing(m,s,c,f,y){if(m in this.operations){let b=this.operations[m];b.to.tileID.key!==c.tileID.key&&(b.queued=c)}else this.operations[m]={startTime:f,phase:0,duration:y,from:s,to:c,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;let s=this.operations[m];return{from:s.from,to:s.to,phase:s.phase}}update(m){for(let s in this.operations){let c=this.operations[s];for(c.phase=(m-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,m)){delete this.operations[s];break}}}_nextOp(m,s){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=s,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},Jv={0:null,1:"TERRAIN_VERTEX_MORPHING"};function dd(m,s,c){if(s===0)return 0;let f=s<1&&c===514?.25/s:1;return 6*Math.pow(1.5,22-m)*Math.max(s,1)*f}function eb(m,s){let c=1<<m.z;return!s&&(m.x===0||m.x===c-1)||m.y===0||m.y===c-1}let lf=m=>({u_matrix:m});function r_(m,s,c,f,y){if(y>0){let b=r.q.now(),E=(b-m.timeAdded)/y,R=s?(b-s.timeAdded)/y:-1,P=c.getSource(),L=f.coveringZoomLevel({tileSize:P.tileSize,roundZoom:P.roundZoom}),F=!s||Math.abs(s.tileID.overscaledZ-L)>Math.abs(m.tileID.overscaledZ-L),j=F&&m.refreshedUponExpiration?1:r.ay(F?E:1-R,0,1);return m.refreshedUponExpiration&&E>=1&&(m.refreshedUponExpiration=!1),s?{opacity:1,mix:1-j}:{opacity:j,mix:0}}return{opacity:1,mix:0}}class hE extends al{constructor(s){let c={type:"raster-dem",maxzoom:s.transform.maxZoom},f=new r.D(r.cj(),null),y=Sl("mock-dem",c,f,s.style);super("mock-dem",y,!1),y.setEventedParent(this),this._sourceLoaded=!0}_loadTile(s,c){s.state="loaded",c(null)}}class tb extends al{constructor(s){let c=Sl("proxy",{type:"geojson",maxzoom:s.transform.maxZoom},new r.D(r.cj(),null),s.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=s,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(s,c,f){if(s.freezeTileCoverage)return;this.transform=s;let y=s.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((b,E)=>{if(b[E.key]="",!this._tiles[E.key]){let R=new ss(E,this._source.tileSize*E.overscaleFactor(),s.tileZoom);R.state="loaded",this._tiles[E.key]=R}return b},{});for(let b in this._tiles)b in y||(this.freeFBO(b),this._tiles[b].unloadVectorData(),delete this._tiles[b])}freeFBO(s){let c=this.proxyCachedFBO[s];if(c!==void 0){let f=Object.values(c);this.renderCachePool.push(...f),delete this.proxyCachedFBO[s]}}deallocRenderCache(){this.renderCache.forEach(s=>s.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class o_ extends r.aH{constructor(s,c,f){super(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,s.canonical.y),this.proxyTileKey=c,this.projMatrix=f}}class pE extends r.cK{constructor(s,c){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},s.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=s,this.terrainTileForTile={},this.prevTerrainTileForTile={};let[f,y,b]=function(P){let L=new r.b5,F=new r.aV,j=131;L.reserve(17161),F.reserve(33800);let U=r.ai/128,W=r.ai+U/2,ie=W+U;for(let re=-U;re<ie;re+=U)for(let oe=-U;oe<ie;oe+=U){let me=oe<0||oe>W||re<0||re>W?24575:0,Me=r.ay(Math.round(oe),0,r.ai),Ee=r.ay(Math.round(re),0,r.ai);L.emplaceBack(Me+me,Ee)}let Q=(re,oe)=>{let me=oe*j+re;F.emplaceBack(me+1,me,me+j),F.emplaceBack(me+j,me+j+1,me+1)};for(let re=1;re<129;re++)for(let oe=1;oe<129;oe++)Q(oe,re);return[0,129].forEach(re=>{for(let oe=0;oe<130;oe++)Q(oe,re),Q(re,oe)}),[L,F,32768]}(),E=s.context;this.gridBuffer=E.createVertexBuffer(f,r.b7.members),this.gridIndexBuffer=E.createIndexBuffer(y),this.gridSegments=r.b8.simpleSegment(0,0,f.length,y.length),this.gridNoSkirtSegments=r.b8.simpleSegment(0,0,f.length,b),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new tb(c.map),this.orthoMatrix=r.ad.mat4.create(),r.ad.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,r.ai,0,r.ai,0,1);let R=E.gl;this._overlapStencilMode=new en({func:R.GEQUAL,mask:255},0,255,R.KEEP,R.KEEP,R.REPLACE),this._previousZoom=s.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new hE(c.map),this._pendingGroundEffectLayers=[]}set style(s){s.on("data",this._onStyleDataEvent.bind(this)),this._style=s,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(s,c,f){if(s&&s.terrain){this._style!==s&&(this.style=s,this._evaluationZoom=void 0);let y=s.terrain.properties,b=s.terrain.drapeRenderMode===0,E=s.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=r.q.now();let R=s.terrain&&s.terrain.scope,P=y.get("source"),L=b?this._mockSourceCache:s.getSourceCache(P,R);if(!L)return void r.w(`Couldn't find terrain source "${P}".`);if(this.sourceCache=L,this._attenuationRange=s.terrain.getAttenuationRange(),this._exaggeration=E?this.calculateExaggeration(c):y.get("exaggeration"),!c.projection.requiresDraping&&E&&this._exaggeration===0)return void this._disable();this.enabled=!0;let F=()=>{this.sourceCache.used&&r.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);let j=this.getScaledDemTileSize();this.sourceCache.update(c,j,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,F(),this._initializing=!0),F(),c.updateElevation(!0,f),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0,this._previousZoom=c.zoom}else this._disable()}calculateExaggeration(s){if(this._attenuationRange&&s.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(s.zoom);let c=this._previousCameraAltitude,f=s.getFreeCameraOptions().position.z/s.pixelsPerMeter*s.worldSize;this._previousCameraAltitude=f;let y=c!=null?f-c:Number.MAX_VALUE;if(Math.abs(y)<2)return this._exaggeration;let b=s.zoom,E=this._style.terrain;if(!this._previousUpdateTimestamp)return E.getExaggeration(b);let R=b-this._previousZoom,P=this._previousUpdateTimestamp,L=b;this._evaluationZoom!=null&&(L=this._evaluationZoom,Math.abs(b-L)>.5&&(R=.5*(b-L+R)),R*y<0&&(L+=R)),this._evaluationZoom=L;let F=E.getExaggeration(L),j=F===E.getExaggeration(Math.max(0,L-.1));if(j&&Math.abs(F-this._exaggeration)<.01)return F;let U=Math.min(.1,.00375*(this._updateTimestamp-P));return(j||F<.1||Math.abs(R)<1e-4)&&(U=Math.min(.2,4*U)),r.ah(this._exaggeration,F,U)}resetTileLookupCache(s){this._findCoveringTileCache[s]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(s){s.coord&&s.dataType==="source"?this._clearRenderCacheForTile(s.sourceCacheId,s.coord):s.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(let s in this._style._mergedSourceCaches)this._style._mergedSourceCaches[s].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(s=>s.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){let s=2*this.proxySourceCache.getSource().tileSize;return[s,s]}set useVertexMorphing(s){this._useVertexMorphing=s}updateTileBinding(s){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;let c=this.proxySourceCache,f=this.painter.transform;this._initializing&&(this._initializing=f._centerAltitude===0&&this.getAtPointOrZero(r.ac.fromLngLat(f.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);let y=this.proxyCoords=c.getIds().map(P=>{let L=c.getTileByID(P).tileID;return L.projMatrix=f.calculateProjMatrix(L.toUnwrapped()),L});(function(P,L){let F=L.transform.pointCoordinate(L.transform.getCameraPoint()),j=new r.P(F.x,F.y);P.sort((U,W)=>{if(W.overscaledZ-U.overscaledZ)return W.overscaledZ-U.overscaledZ;let ie=new r.P(U.canonical.x+(1<<U.canonical.z)*U.wrap,U.canonical.y),Q=new r.P(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),re=j.mult(1<<U.canonical.z);return re.x-=.5,re.y-=.5,re.distSqr(ie)-re.distSqr(Q)})})(y,this.painter);let b=this.proxyToSource||{};this.proxyToSource={},y.forEach(P=>{this.proxyToSource[P.key]={}}),this.terrainTileForTile={};let E=this._style._mergedSourceCaches;for(let P in E){let L=E[P];if(!L.used||(L!==this.sourceCache&&this.resetTileLookupCache(L.id),this._setupProxiedCoordsForOrtho(L,s[P],b),L.usedForTerrain))continue;let F=s[P];L.getSource().reparseOverscaled&&this._assignTerrainTiles(F)}this.proxiedCoords[c.id]=y.map(P=>new o_(P,P.key,this.orthoMatrix)),this._assignTerrainTiles(y),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(b),this.renderingToTexture=!1;let R={};this._visibleDemTiles=[];for(let P of this.proxyCoords){let L=this.terrainTileForTile[P.key];if(!L)continue;let F=L.tileID.key;F in R||(this._visibleDemTiles.push(L),R[F]=F)}}_assignTerrainTiles(s){this._initializing||s.forEach(c=>{if(this.terrainTileForTile[c.key])return;let f=this._findTileCoveringTileID(c,this.sourceCache);f&&(this.terrainTileForTile[c.key]=f)})}_prepareDEMTextures(){let s=this.painter.context,c=s.gl;for(let f in this.terrainTileForTile){let y=this.terrainTileForTile[f],b=y.dem;!b||y.demTexture&&!y.needsDEMTextureUpload||(s.activeTexture.set(c.TEXTURE1),de(this.painter,y,b))}}_prepareDemTileUniforms(s,c,f,y){if(!c||c.demTexture==null)return!1;let b=s.tileID.canonical,E=Math.pow(2,c.tileID.canonical.z-b.z),R=y||"";return f[`u_dem_tl${R}`]=[b.x*E%1,b.y*E%1],f[`u_dem_scale${R}`]=E,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let s=0,c=this._visibleDemTiles.reduce((f,y)=>{if(!y.dem)return f;let b=y.dem.tree.minimums[0];return b>0&&s++,f+b},0);return s?c/s:0}_updateEmptyDEMTexture(){let s=this.painter.context,c=s.gl;s.activeTexture.set(c.TEXTURE2);let f=this._getLoadedAreaMinimum(),y=new r.cL({width:1,height:1},new Float32Array([f]));this._emptyDEMTextureDirty=!1;let b=this._emptyDEMTexture;return b?b.update(y,{premultiply:!1}):b=this._emptyDEMTexture=new r.T(s,y,c.R32F,{premultiply:!1}),b}setupElevationDraw(s,c,f){let y=this.painter.context,b=y.gl,E={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};E.u_exaggeration=this.exaggeration();let R=null,P=null,L=1;if(f&&f.morphing&&this._useVertexMorphing){let W=f.morphing.srcDemTile,ie=f.morphing.dstDemTile;L=f.morphing.phase,W&&ie&&(this._prepareDemTileUniforms(s,W,E,"_prev")&&(P=W),this._prepareDemTileUniforms(s,ie,E)&&(R=ie))}let F=W=>W&&W.demTexture&&this.painter.linearFloatFilteringSupported()?b.LINEAR:b.NEAREST,j=null;var U;if(this.enabled?P&&R?(j=R.demTexture,y.activeTexture.set(b.TEXTURE4),P.demTexture.bind(F(P),b.CLAMP_TO_EDGE),E.u_dem_lerp=L):(R=this.terrainTileForTile[s.tileID.key],j=this._prepareDemTileUniforms(s,R,E)?R.demTexture:this.emptyDEMTexture):j=this.emptyDEMTexture,y.activeTexture.set(b.TEXTURE2),j&&(E.u_dem_size=(U=j).size[0]===1?1:U.size[0]-2,j.bind(F(R),b.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(f&&f.useDepthForOcclusion,c,E),f&&f.useMeterToDem&&R){let W=(1<<R.tileID.canonical.z)*r.bH(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;E.u_meter_to_dem=W}if(f&&f.labelPlaneMatrixInv&&(E.u_label_plane_matrix_inv=f.labelPlaneMatrixInv),c.setTerrainUniformValues(y,E),this.painter.transform.projection.name==="globe"){let W=this.globeUniformValues(this.painter.transform,s.tileID.canonical,f&&f.useDenormalizedUpVectorScale);c.setGlobeUniformValues(y,W)}}globeUniformValues(s,c,f){let y=s.projection;return{u_tile_tl_up:y.upVector(c,0,0),u_tile_tr_up:y.upVector(c,r.ai,0),u_tile_br_up:y.upVector(c,r.ai,r.ai),u_tile_bl_up:y.upVector(c,0,r.ai),u_tile_up_scale:f?r.cM(1):y.upVectorScale(c,s.center.lat,s.worldSize).metersToTile}}renderToBackBuffer(s){let c=this.painter,f=this.painter.context;s.length!==0&&(f.bindFramebuffer.set(null),f.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(y,b,E,R,P){if(y.transform.projection.name==="globe")(function(L,F,j,U,W){let ie=L.context,Q=ie.gl,re,oe,me=L.transform,Me=r.cD(L,ie,me),Ee=(Et,Ct)=>{if(oe===Ct)return;let Ut=[Jv[Ct],"PROJECTION_GLOBE_VIEW"];Me&&Ut.push("CUSTOM_ANTIALIASING");let tt=L.isTileAffectedByFog(Et);re=L.getOrCreateProgram("globeRaster",{defines:Ut,overrideFog:tt}),oe=Ct},Le=L.colorModeForRenderPass(),Ie=new xi(Q.LEQUAL,xi.ReadWrite,L.depthRangeFor3D);sc.update(W);let Ae=r.cE(me),Re=[r.av(me.center.lng),r.aC(me.center.lat)],Ve=L.globeSharedBuffers,qe=[me.width*r.q.devicePixelRatio,me.height*r.q.devicePixelRatio],dt=Float32Array.from(me.globeMatrix),nt={useDenormalizedUpVectorScale:!0};{let Et=L.transform,Ct=dd(Et.zoom,F.exaggeration(),F.sourceCache._source.tileSize);oe=-1;let Ut=Q.TRIANGLES;for(let tt of U){let xt=j.getTile(tt),Qe=en.disabled,bt=F.prevTerrainTileForTile[tt.key],_t=F.terrainTileForTile[tt.key];n_(bt,_t)&&sc.newMorphing(tt.key,bt,_t,W,250),ie.activeTexture.set(Q.TEXTURE0),xt.texture&&xt.texture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);let St=sc.getMorphValuesForProxy(tt.key),ht=St?1:0;St&&r.L(nt,{morphing:{srcDemTile:St.from,dstDemTile:St.to,phase:r.cC(St.phase)}});let At=r.cF(tt.canonical),Kt=r.cG(At.getCenter().lat),Xt=r.cH(tt.canonical,At,Kt,Et.worldSize/Et._pixelsPerMercatorPixel),Qt=r.bc(r.cI(tt.canonical)),_i=Qv(Et.expandedFarZProjMatrix,dt,Ae,Qt,r.ag(Et.zoom),Re,Et.frustumCorners.TL,Et.frustumCorners.TR,Et.frustumCorners.BR,Et.frustumCorners.BL,Et.globeCenterInViewSpace,Et.globeRadius,qe,Ct,Et._farZ,Xt);if(Ee(tt,ht),re&&(F.setupElevationDraw(xt,re,nt),L.uploadCommonUniforms(ie,re,tt.toUnwrapped()),Ve)){let[tn,ki,Ki]=Ve.getGridBuffers(Kt,Ct!==0);re.draw(L,Ut,Ie,Qe,Le,Vi.backCCW,_i,"globe_raster",tn,ki,Ki)}}}if(Ve&&(L.renderDefaultNorthPole||L.renderDefaultSouthPole)){let Et=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Me&&Et.push("CUSTOM_ANTIALIASING"),re=L.getOrCreateProgram("globeRaster",{defines:Et});for(let Ct of U){let{x:Ut,y:tt,z:xt}=Ct.canonical,Qe=tt===0,bt=tt===(1<<xt)-1,[_t,St,ht,At]=Ve.getPoleBuffers(xt,!1);if(At&&(Qe||bt)){let Kt=j.getTile(Ct);ie.activeTexture.set(Q.TEXTURE0),Kt.texture&&Kt.texture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);let Xt=r.cJ(xt,Ut,me),Qt=r.bc(r.cI(Ct.canonical)),_i=(tn,ki)=>tn.draw(L,Q.TRIANGLES,Ie,en.disabled,Le,Vi.disabled,Qv(me.expandedFarZProjMatrix,Xt,Xt,Qt,0,Re,me.frustumCorners.TL,me.frustumCorners.TR,me.frustumCorners.BR,me.frustumCorners.BL,me.globeCenterInViewSpace,me.globeRadius,qe,0,me._farZ),"globe_pole_raster",ki,ht,At);F.setupElevationDraw(Kt,re,nt),L.uploadCommonUniforms(ie,re,Ct.toUnwrapped()),Qe&&L.renderDefaultNorthPole&&_i(re,_t),bt&&L.renderDefaultSouthPole&&(Xt=r.ad.mat4.scale(r.ad.mat4.create(),Xt,[1,-1,1]),_i(re,St))}}}})(y,b,E,R,P);else{let L=y.context,F=L.gl,j,U,W=y.shadowRenderer,ie=rc(y,y.longestCutoffRange),Q=Le=>{if(U===Le)return;let Ie=[];Ie.push(Jv[Le]),ie.shouldRenderCutoff&&Ie.push("RENDER_CUTOFF"),W&&(Ie.push("RENDER_SHADOWS","DEPTH_TEXTURE"),W.useNormalOffset&&Ie.push("NORMAL_OFFSET")),j=y.getOrCreateProgram("terrainRaster",{defines:Ie}),U=Le},re=y.colorModeForRenderPass(),oe=new xi(F.LEQUAL,xi.ReadWrite,y.depthRangeFor3D);sc.update(P);let me=y.transform,Me=dd(me.zoom,b.exaggeration(),b.sourceCache._source.tileSize),Ee=[0,0,0];if(W){let Le=y.style.directionalLight,Ie=y.style.ambientLight;Le&&Ie&&(Ee=sd(y.style,Le,Ie))}{U=-1;let Le=F.TRIANGLES,[Ie,Ae]=[b.gridIndexBuffer,b.gridSegments];for(let Re of R){let Ve=E.getTile(Re),qe=en.disabled,dt=b.prevTerrainTileForTile[Re.key],nt=b.terrainTileForTile[Re.key];n_(dt,nt)&&sc.newMorphing(Re.key,dt,nt,P,250),L.activeTexture.set(F.TEXTURE0),Ve.texture&&Ve.texture.bind(F.LINEAR,F.CLAMP_TO_EDGE);let Et=sc.getMorphValuesForProxy(Re.key),Ct=Et?1:0,Ut;Et&&(Ut={morphing:{srcDemTile:Et.from,dstDemTile:Et.to,phase:r.cC(Et.phase)}});let tt=dE(Re.projMatrix,eb(Re.canonical,me.renderWorldCopies)?Me/10:Me,Ee);if(Q(Ct),!j)continue;b.setupElevationDraw(Ve,j,Ut);let xt=Re.toUnwrapped();W&&W.setupShadows(xt,j),y.uploadCommonUniforms(L,j,xt,null,ie),j.draw(y,Le,oe,qe,re,Vi.backCCW,tt,"terrain_raster",b.gridBuffer,Ie,Ae)}}}}(c,this,this.proxySourceCache,s,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),s.splice(0,s.length))}renderBatch(s){if(this._drapedRenderBatches.length===0)return s+1;this.renderingToTexture=!0;let c=this.painter,f=this.painter.context,y=this.proxySourceCache,b=this.proxiedCoords[y.id],E=this._drapedRenderBatches.shift(),R=c.style.order,P=[],L=0;for(let F of b){let j=y.getTileByID(F.proxyTileKey),U=y.proxyCachedFBO[F.key]?y.proxyCachedFBO[F.key][s]:void 0,W=U!==void 0?y.renderCache[U]:this.pool[L++],ie=U!==void 0;if(j.texture=W.tex,ie&&!W.dirty){P.push(j.tileID);continue}let Q;f.bindFramebuffer.set(W.fb.framebuffer),this.renderedToTile=!1,W.dirty&&(f.clear({color:r.al.transparent,stencil:0}),W.dirty=!1);for(let re=E.start;re<=E.end;++re){let oe=c.style._mergedLayers[R[re]];if(oe.isHidden(c.transform.zoom))continue;let me=c.style.getLayerSourceCache(oe),Me=me?this.proxyToSource[F.key][me.id]:[F];if(!Me)continue;let Ee=Me;f.viewport.set([0,0,W.fb.width,W.fb.height]),Q!==(me?me.id:null)&&(this._setupStencil(W,Me,oe,me),Q=me?me.id:null),c.renderLayer(c,me,oe,Ee)}if(this._drapedRenderBatches.length===0)for(let re of this._pendingGroundEffectLayers){let oe=c.style._mergedLayers[R[re]];if(oe.isHidden(c.transform.zoom))continue;let me=c.style.getLayerSourceCache(oe),Me=me?this.proxyToSource[F.key][me.id]:[F];if(!Me)continue;let Ee=Me;f.viewport.set([0,0,W.fb.width,W.fb.height]),Q!==(me?me.id:null)&&(this._setupStencil(W,Me,oe,me),Q=me?me.id:null),c.renderLayer(c,me,oe,Ee)}this.renderedToTile?(W.dirty=!0,P.push(j.tileID)):ie||--L,L===5&&(L=0,this.renderToBackBuffer(P))}return this.renderToBackBuffer(P),this.renderingToTexture=!1,f.bindFramebuffer.set(null),f.viewport.set([0,0,c.width,c.height]),E.end+1}postRender(){}isLayerOrderingCorrect(s){let c=s.order.length,f=-1,y=c;for(let b=0;b<c;++b)this._style.isLayerDraped(s._mergedLayers[s.order[b]])?f=Math.max(f,b):y=Math.min(y,b);return y>f}getMinElevationBelowMSL(){let s=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{s=Math.min(s,c.dem.tree.minimums[0])}),s===0?s:(s-30)*this._exaggeration}raycast(s,c,f){if(!this._visibleDemTiles)return null;let y=this._visibleDemTiles.filter(b=>b.dem).map(b=>{let E=b.tileID,R=1<<E.overscaledZ,{x:P,y:L}=E.canonical,F=P/R,j=(P+1)/R,U=L/R,W=(L+1)/R;return{minx:F,miny:U,maxx:j,maxy:W,t:b.dem.tree.raycastRoot(F,U,j,W,s,c,f),tile:b}});y.sort((b,E)=>(b.t!==null?b.t:Number.MAX_VALUE)-(E.t!==null?E.t:Number.MAX_VALUE));for(let b of y){if(b.t==null)return null;let E=b.tile.dem.tree.raycast(b.minx,b.miny,b.maxx,b.maxy,s,c,f);if(E!=null)return E}return null}_createFBO(){let s=this.painter.context,c=s.gl,f=this.drapeBufferSize;s.activeTexture.set(c.TEXTURE0);let y=new r.T(s,{width:f[0],height:f[1],data:null},c.RGBA8);y.bind(c.LINEAR,c.CLAMP_TO_EDGE);let b=s.createFramebuffer(f[0],f[1],!0,null);return b.colorAttachment.set(y.texture),b.depthAttachment=new uE(s,b.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=s.createRenderbuffer(s.gl.DEPTH_STENCIL,f[0],f[1]),this._stencilRef=0,b.depthAttachment.set(this._sharedDepthStencil),s.clear({stencil:0})):b.depthAttachment.set(this._sharedDepthStencil),s.extTextureFilterAnisotropic&&c.texParameterf(c.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax),{fb:b,tex:y,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(let s in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[s].hasTransition())return!0;return this._style.order.some(s=>{let c=this._style._mergedLayers[s],f=c.isHidden(this.painter.transform.zoom);return c.type==="hillshade"||c.type==="custom"?!f&&c.shouldRedrape():!f&&c.hasTransition()})}_clearLineLayersFromRenderCache(){let s=!1;for(let f of this._style.getSources())if(f instanceof xr){s=!0;break}if(!s)return;let c={};for(let f=0;f<this._style.order.length;++f){let y=this._style._mergedLayers[this._style.order[f]],b=this._style.getLayerSourceCache(y);if(b&&!c[b.id]&&!y.isHidden(this.painter.transform.zoom)&&y.type==="line"&&y.widthExpression()instanceof r.ab){c[b.id]=!0;for(let E of this.proxyCoords){let R=this.proxyToSource[E.key][b.id];if(R)for(let P of R)this._clearRenderCacheForTile(b.id,P)}}}}_clearRasterLayersFromRenderCache(){let s=!1;for(let f in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[f]._source instanceof Vs){s=!0;break}if(!s)return;let c={};for(let f=0;f<this._style.order.length;++f){let y=this._style._mergedLayers[this._style.order[f]],b=this._style.getLayerSourceCache(y);if(!b||c[b.id]||y.isHidden(this.painter.transform.zoom)||y.type!=="raster")continue;let E=y.paint.get("raster-fade-duration");for(let R of this.proxyCoords){let P=this.proxyToSource[R.key][b.id];if(P)for(let L of P){let F=r_(b.getTile(L),b.findLoadedParent(L,0),b,this.painter.transform,E);(F.opacity!==1||F.mix!==0)&&this._clearRenderCacheForTile(b.id,L)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();let s=this._style.order,c=s.length;if(c===0)return;let f=[];this._pendingGroundEffectLayers=[];let y,b=0,E=this._style._mergedLayers[s[b]];for(;!this._style.isLayerDraped(E)&&E.isHidden(this.painter.transform.zoom)&&++b<c;)E=this._style._mergedLayers[s[b]];for(;b<c;++b){let R=this._style._mergedLayers[s[b]];R.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(R)?y===void 0&&(y=b):(R.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(b),y!==void 0&&(f.push({start:y,end:b-1}),y=void 0)))}if(y!==void 0&&f.push({start:y,end:b-1}),f.length!==0){let R=f[f.length-1];this._pendingGroundEffectLayers.every(P=>P>R.end)||r.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=f}_setupRenderCache(s){let c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){let E=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let R=0;R<E.length;++R){let P=Object.values(E[R]);c.renderCachePool.push(...P)}}return}this._clearRasterLayersFromRenderCache();let f=this.proxyCoords,y=this._tilesDirty;for(let E=f.length-1;E>=0;E--){let R=f[E];if(c.getTileByID(R.key),c.proxyCachedFBO[R.key]!==void 0){let P=s[R.key],L=this.proxyToSource[R.key],F=0;for(let j in L){let U=L[j],W=P[j];if(!W||W.length!==U.length||U.some((ie,Q)=>ie!==W[Q]||y[j]&&y[j].hasOwnProperty(ie.key))){F=-1;break}++F}for(let j in c.proxyCachedFBO[R.key])c.renderCache[c.proxyCachedFBO[R.key][j]].dirty=F<0||F!==Object.values(P).length}}let b=[...this._drapedRenderBatches];b.sort((E,R)=>R.end-R.start-(E.end-E.start));for(let E of b)for(let R of f){if(c.proxyCachedFBO[R.key])continue;let P=c.renderCachePool.pop();P===void 0&&c.renderCache.length<50&&(P=c.renderCache.length,c.renderCache.push(this._createFBO())),P!==void 0&&(c.proxyCachedFBO[R.key]={},c.proxyCachedFBO[R.key][E.start]=P,c.renderCache[P].dirty=!0)}this._tilesDirty={}}_setupStencil(s,c,f,y){if(!y||!this._sourceTilesOverlap[y.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));let b=this.painter.context,E=b.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let R;if(f.isTileClipped())R=c.length,this._overlapStencilMode.test={func:E.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);R=1,this._overlapStencilMode.test={func:E.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+R>255&&(b.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=R,this._overlapStencilMode.ref=this._stencilRef,f.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(s){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[s.key]),this._overlapStencilMode):en.disabled}_renderTileClippingMasks(s,c){let f=this.painter,y=this.painter.context,b=y.gl;f._tileClippingMaskIDs={},y.setColorMode(_n.disabled),y.setDepthMode(xi.disabled);let E=f.getOrCreateProgram("clippingMask");for(let R of s){let P=f._tileClippingMaskIDs[R.key]=--c;E.draw(f,b.TRIANGLES,xi.disabled,new en({func:b.ALWAYS,mask:0},P,255,b.KEEP,b.KEEP,b.REPLACE),_n.disabled,Vi.disabled,lf(R.projMatrix),"$clipping",f.tileExtentBuffer,f.quadTriangleIndexBuffer,f.tileExtentSegments)}}pointCoordinate(s){let c=this.painter.transform;if(s.x<0||s.x>c.width||s.y<0||s.y>c.height)return null;let f=[s.x,s.y,1,1];r.ad.vec4.transformMat4(f,f,c.pixelMatrixInverse),r.ad.vec4.scale(f,f,1/f[3]),f[0]/=c.worldSize,f[1]/=c.worldSize;let y=c._camera.position,b=r.bH(1,c.center.lat),E=[y[0],y[1],y[2]/b,0],R=r.ad.vec3.subtract([],f.slice(0,3),E);r.ad.vec3.normalize(R,R);let P=this.raycast(E,R,this._exaggeration);return P!==null&&P?(r.ad.vec3.scaleAndAdd(E,E,R,P),E[3]=E[2],E[2]*=b,E):null}_setupProxiedCoordsForOrtho(s,c,f){if(s.getSource()instanceof r.aK)return this._setupProxiedCoordsForImageSource(s,c,f);this._findCoveringTileCache[s.id]=this._findCoveringTileCache[s.id]||{};let y=this.proxiedCoords[s.id]=[],b=this.proxyCoords;for(let P=0;P<b.length;P++){let L=b[P],F=this._findTileCoveringTileID(L,s);if(F){let j=this._createProxiedId(L,F,f[L.key]&&f[L.key][s.id]);y.push(j),this.proxyToSource[L.key][s.id]=[j]}}let E=!1,R=new Set;for(let P=0;P<c.length;P++){let L=s.getTile(c[P]);if(!L||!L.hasData())continue;let F=this._findTileCoveringTileID(L.tileID,this.proxySourceCache);if(F&&F.tileID.canonical.z!==L.tileID.canonical.z){let j=this.proxyToSource[F.tileID.key][s.id],U=this._createProxiedId(F.tileID,L,f[F.tileID.key]&&f[F.tileID.key][s.id]);j?j.splice(j.length-1,0,U):this.proxyToSource[F.tileID.key][s.id]=[U];let W=this.proxyToSource[F.tileID.key][s.id];R.has(W)||R.add(W),y.push(U),E=!0}}if(this._sourceTilesOverlap[s.id]=E,E&&this._debugParams.sortTilesHiZFirst)for(let P of R)P.sort((L,F)=>F.overscaledZ-L.overscaledZ)}_setupProxiedCoordsForImageSource(s,c,f){if(!s.getSource().loaded())return;let y=this.proxiedCoords[s.id]=[],b=this.proxyCoords,E=s.getSource(),R=E.tileID;if(!R)return;let P=new r.P(R.x,R.y)._div(1<<R.z),L=E.coordinates.map(r.ac.fromLngLat).reduce((j,U)=>(j.min.x=Math.min(j.min.x,U.x-P.x),j.min.y=Math.min(j.min.y,U.y-P.y),j.max.x=Math.max(j.max.x,U.x-P.x),j.max.y=Math.max(j.max.y,U.y-P.y),j),{min:new r.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new r.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),F=(j,U)=>{let W=j.wrap+j.canonical.x/(1<<j.canonical.z),ie=j.canonical.y/(1<<j.canonical.z),Q=r.ai/(1<<j.canonical.z),re=U.wrap+U.canonical.x/(1<<U.canonical.z),oe=U.canonical.y/(1<<U.canonical.z);return W+Q<re+L.min.x||W>re+L.max.x||ie+Q<oe+L.min.y||ie>oe+L.max.y};for(let j=0;j<b.length;j++){let U=b[j];for(let W=0;W<c.length;W++){let ie=s.getTile(c[W]);if(!ie||!ie.hasData()||F(U,ie.tileID))continue;let Q=this._createProxiedId(U,ie,f[U.key]&&f[U.key][s.id]),re=this.proxyToSource[U.key][s.id];re?re.push(Q):this.proxyToSource[U.key][s.id]=[Q],y.push(Q)}}}_createProxiedId(s,c,f){let y=this.orthoMatrix;if(f){let b=f.find(E=>E.key===c.tileID.key);if(b)return b}if(c.tileID.key!==s.key){let b=s.canonical.z-c.tileID.canonical.z,E,R,P;y=r.ad.mat4.create();let L=c.tileID.wrap-s.wrap<<s.overscaledZ;b>0?(E=r.ai>>b,R=E*((c.tileID.canonical.x<<b)-s.canonical.x+L),P=E*((c.tileID.canonical.y<<b)-s.canonical.y)):(E=r.ai<<-b,R=r.ai*(c.tileID.canonical.x-(s.canonical.x+L<<-b)),P=r.ai*(c.tileID.canonical.y-(s.canonical.y<<-b))),r.ad.mat4.ortho(y,0,E,0,E,0,1),r.ad.mat4.translate(y,y,[R,P,0])}return new o_(c.tileID,s.key,y)}_findTileCoveringTileID(s,c){let f=c.getTile(s);if(f&&f.hasData())return f;let y=this._findCoveringTileCache[c.id],b=y[s.key];if(f=b?c.getTileByID(b):null,f&&f.hasData()||b===null)return f;let E=f?f.tileID:s,R=E.overscaledZ,P=c.getSource().minzoom,L=[];if(!b){let j=c.getSource().maxzoom;if(s.canonical.z>=j){let U=s.canonical.z-j;c.getSource().reparseOverscaled?(R=Math.max(s.canonical.z+2,c.transform.tileZoom),E=new r.aH(R,s.wrap,j,s.canonical.x>>U,s.canonical.y>>U)):U!==0&&(R=j,E=new r.aH(R,s.wrap,j,s.canonical.x>>U,s.canonical.y>>U))}E.key!==s.key&&(L.push(E.key),f=c.getTile(E))}let F=j=>{L.forEach(U=>{y[U]=j}),L.length=0};for(R-=1;R>=P&&(!f||!f.hasData());R--){f&&F(f.tileID.key);let j=E.calculateScaledKey(R);if(f=c.getTileByID(j),f&&f.hasData())break;let U=y[j];if(U===null)break;U===void 0?L.push(j):f=c.getTileByID(U)}return F(f?f.tileID.key:null),f&&f.hasData()?f:null}findDEMTileFor(s){return this.enabled?this._findTileCoveringTileID(s,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(s,c){let f=this._tilesDirty[s];f||(f=this._tilesDirty[s]={}),f[c.key]=!0}}function fE(m,s,c){let f=function(R,P,L){let F=r.ad.vec3.dot(P,R),j=r.ad.vec3.dot(L,[.2126,.7152,.0722]),U=(ie,Q,re)=>(1-re)*ie+re*Q,W=U(1-.3*Math.min(j,1),1,Math.min(F+1,1));return U(.92,1,Math.asin(r.ay(P[2],-1,1))/Math.PI+.5)*W}(m,[0,0,1],s),y=[0,0,0];r.ad.vec3.scale(y,c.slice(0,3),f);let b=[0,0,0];r.ad.vec3.scale(b,s.slice(0,3),m[2]);let E=[0,0,0];return r.ad.vec3.add(E,y,b),r.cg(E)}let eg=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],II=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class mE{static cacheKey(s,c,f,y){let b=`${c}${y?y.cacheKey:""}`;for(let E of f)s.usedDefines.includes(E)&&(b+=`/${E}`);return b}constructor(s,c,f,y,b,E){let R=s.gl;this.program=R.createProgram(),this.configuration=y,this.name=c,this.fixedDefines=[...E];let P=y?y.getBinderAttributes():[],L=(f.staticAttributes||[]).concat(P),F=y?y.defines():[];F=F.concat(E.map(re=>`#define ${re}`));let j=`#version 300 es
`,U=j+F.concat("precision mediump float;",sp,ap.fragmentSource).join(`
`);for(let re of f.fragmentIncludes)U+=`
${us[re]}`;U+=`
${f.fragmentSource}`;let W=j+F.concat("precision highp float;",sp,ap.vertexSource).join(`
`);for(let re of f.vertexIncludes)W+=`
${us[re]}`;this.forceManualRenderingForInstanceIDShaders=s.forceManualRenderingForInstanceIDShaders&&f.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(W+=`
uniform int u_instanceID;
`),W+=`
${f.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(W=W.replaceAll("gl_InstanceID","u_instanceID"));let ie=R.createShader(R.FRAGMENT_SHADER);if(R.isContextLost())return void(this.failedToCreate=!0);R.shaderSource(ie,U),R.compileShader(ie),R.attachShader(this.program,ie);let Q=R.createShader(R.VERTEX_SHADER);if(R.isContextLost())this.failedToCreate=!0;else{R.shaderSource(Q,W),R.compileShader(Q),R.attachShader(this.program,Q),this.attributes={},this.numAttributes=L.length;for(let re=0;re<this.numAttributes;re++)if(L[re]){let oe=L[re].startsWith("a_")?L[re]:`a_${L[re]}`;R.bindAttribLocation(this.program,re,oe),this.attributes[oe]=re}R.linkProgram(this.program),R.deleteShader(Q),R.deleteShader(ie),this.fixedUniforms=b(s),this.binderUniforms=y?y.getUniforms(s):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(re=>({u_instanceID:new r.bN(re)}))(s)),(E.includes("TERRAIN")||c.indexOf("symbol")!==-1||c.indexOf("circle")!==-1)&&(this.terrainUniforms=(re=>({u_dem:new r.bN(re),u_dem_prev:new r.bN(re),u_dem_tl:new r.bK(re),u_dem_scale:new r.bM(re),u_dem_tl_prev:new r.bK(re),u_dem_scale_prev:new r.bM(re),u_dem_size:new r.bM(re),u_dem_lerp:new r.bM(re),u_exaggeration:new r.bM(re),u_depth:new r.bN(re),u_depth_size_inv:new r.bK(re),u_depth_range_unpack:new r.bK(re),u_occluder_half_size:new r.bM(re),u_occlusion_depth_offset:new r.bM(re),u_meter_to_dem:new r.bM(re),u_label_plane_matrix_inv:new r.bJ(re)}))(s)),E.includes("GLOBE")&&(this.globeUniforms=(re=>({u_tile_tl_up:new r.bL(re),u_tile_tr_up:new r.bL(re),u_tile_br_up:new r.bL(re),u_tile_bl_up:new r.bL(re),u_tile_up_scale:new r.bM(re)}))(s)),E.includes("FOG")&&(this.fogUniforms=(re=>({u_fog_matrix:new r.bJ(re),u_fog_range:new r.bK(re),u_fog_color:new r.cb(re),u_fog_horizon_blend:new r.bM(re),u_fog_vertical_limit:new r.bK(re),u_fog_temporal_offset:new r.bM(re),u_frustum_tl:new r.bL(re),u_frustum_tr:new r.bL(re),u_frustum_br:new r.bL(re),u_frustum_bl:new r.bL(re),u_globe_pos:new r.bL(re),u_globe_radius:new r.bM(re),u_globe_transition:new r.bM(re),u_is_globe:new r.bN(re),u_viewport:new r.bK(re)}))(s)),E.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(re=>({u_cutoff_params:new r.cb(re)}))(s)),E.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(re=>({u_lighting_ambient_color:new r.bL(re),u_lighting_directional_dir:new r.bL(re),u_lighting_directional_color:new r.bL(re),u_ground_radiance:new r.bL(re)}))(s)),E.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(re=>({u_light_matrix_0:new r.bJ(re),u_light_matrix_1:new r.bJ(re),u_fade_range:new r.bK(re),u_shadow_normal_offset:new r.bL(re),u_shadow_intensity:new r.bM(re),u_shadow_texel_size:new r.bM(re),u_shadow_map_resolution:new r.bM(re),u_shadow_direction:new r.bL(re),u_shadow_bias:new r.bL(re),u_shadowmap_0:new r.bN(re),u_shadowmap_1:new r.bN(re)}))(s))}}setTerrainUniformValues(s,c){if(!this.terrainUniforms)return;let f=this.terrainUniforms;if(!this.failedToCreate){s.program.set(this.program);for(let y in c)f[y]&&f[y].set(this.program,y,c[y])}}setGlobeUniformValues(s,c){if(!this.globeUniforms)return;let f=this.globeUniforms;if(!this.failedToCreate){s.program.set(this.program);for(let y in c)f[y]&&f[y].set(this.program,y,c[y])}}setFogUniformValues(s,c){if(!this.fogUniforms)return;let f=this.fogUniforms;if(!this.failedToCreate){s.program.set(this.program);for(let y in c)f[y].set(this.program,y,c[y])}}setCutoffUniformValues(s,c){if(!this.cutoffUniforms)return;let f=this.cutoffUniforms;if(!this.failedToCreate){s.program.set(this.program);for(let y in c)f[y].set(this.program,y,c[y])}}setLightsUniformValues(s,c){if(!this.lightsUniforms)return;let f=this.lightsUniforms;if(!this.failedToCreate){s.program.set(this.program);for(let y in c)f[y].set(this.program,y,c[y])}}setShadowUniformValues(s,c){if(this.failedToCreate||!this.shadowUniforms)return;let f=this.shadowUniforms;s.program.set(this.program);for(let y in c)f[y].set(this.program,y,c[y])}_drawDebugWireframe(s,c,f,y,b,E,R,P,L,F){let j=s.options.wireframe;if(j.terrain===!1&&j.layers2D===!1&&j.layers3D===!1)return;let U=s.context;if(!(!(!j.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!j.layers2D||s._terrain&&s._terrain.renderingToTexture||!eg.includes(this.name))||!(!j.layers3D||!II.includes(this.name))))return;let W=U.gl,ie=s.wireframeDebugCache.getLinesFromTrianglesBuffer(s.frameCounter,b,U);if(!ie)return;let Q=[...this.fixedDefines];Q.push("DEBUG_WIREFRAME");let re=s.getOrCreateProgram(this.name,{config:this.configuration,defines:Q});U.program.set(re.program);let oe=(Ee,Le,Ie)=>{if(Le[Ee]&&Ie[Ee])for(let Ae in Le[Ee])Ie[Ee][Ae]&&Ie[Ee][Ae].set(Ie.program,Ae,Le[Ee][Ae].current)};L&&L.setUniforms(re.program,U,re.binderUniforms,R,{zoom:P}),oe("fixedUniforms",this,re),oe("terrainUniforms",this,re),oe("globeUniforms",this,re),oe("fogUniforms",this,re),oe("lightsUniforms",this,re),oe("shadowUniforms",this,re),ie.bind(),U.setColorMode(new _n([W.ONE,W.ONE_MINUS_SRC_ALPHA,W.ZERO,W.ONE],r.al.transparent,[!0,!0,!0,!1])),U.setDepthMode(new xi(c.func===W.LESS?W.LEQUAL:c.func,xi.ReadOnly,c.range)),U.setStencilMode(en.disabled);let me=3*E.primitiveLength*2,Me=3*E.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){let Ee=F||1;for(let Le=0;Le<Ee;++Le)re.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Le),W.drawElements(W.LINES,me,W.UNSIGNED_SHORT,Me)}else F&&F>1?W.drawElementsInstanced(W.LINES,me,W.UNSIGNED_SHORT,Me,F):W.drawElements(W.LINES,me,W.UNSIGNED_SHORT,Me);b.bind(),U.program.set(this.program),U.setDepthMode(c),U.setStencilMode(f),U.setColorMode(y)}checkUniforms(s,c,f){if(this.fixedDefines.includes(c)){for(let y of Object.keys(f))if(!f[y].initialized)throw new Error(`Program '${this.name}', from draw '${s}': uniform ${y} not set but required by ${c} being defined`)}}draw(s,c,f,y,b,E,R,P,L,F,j,U,W,ie,Q,re){let oe=s.context,me=oe.gl;if(this.failedToCreate)return;oe.program.set(this.program),oe.setDepthMode(f),oe.setStencilMode(y),oe.setColorMode(b),oe.setCullFace(E);for(let Le of Object.keys(this.fixedUniforms))this.fixedUniforms[Le].set(this.program,Le,R[Le]);ie&&ie.setUniforms(this.program,oe,this.binderUniforms,U,{zoom:W});let Me={[me.POINTS]:1,[me.LINES]:2,[me.TRIANGLES]:3,[me.LINE_STRIP]:1}[c];this.checkUniforms(P,"RENDER_SHADOWS",this.shadowUniforms);let Ee=re&&re>0?1:void 0;for(let Le of j.get()){let Ie=Le.vaos||(Le.vaos={});if((Ie[P]||(Ie[P]=new Q0)).bind(oe,this,L,ie?ie.getPaintVertexBuffers():[],F,Le.vertexOffset,Q||[],Ee),this.forceManualRenderingForInstanceIDShaders){let Ae=re||1;for(let Re=0;Re<Ae;++Re)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Re),F?me.drawElements(c,Le.primitiveLength*Me,me.UNSIGNED_SHORT,Le.primitiveOffset*Me*2):me.drawArrays(c,Le.vertexOffset,Le.vertexLength)}else re&&re>1?me.drawElementsInstanced(c,Le.primitiveLength*Me,me.UNSIGNED_SHORT,Le.primitiveOffset*Me*2,re):F?me.drawElements(c,Le.primitiveLength*Me,me.UNSIGNED_SHORT,Le.primitiveOffset*Me*2):me.drawArrays(c,Le.vertexOffset,Le.vertexLength);c===me.TRIANGLES&&F&&this._drawDebugWireframe(s,f,y,b,F,Le,U,W,ie,re)}}}function ib(m,s){let c=Math.pow(2,s.tileID.overscaledZ),f=s.tileSize*Math.pow(2,m.transform.tileZoom)/c,y=f*(s.tileID.canonical.x+s.tileID.wrap*c),b=f*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture?s.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/r.at(s,1,m.transform.tileZoom),u_pixel_coord_upper:[y>>16,b>>16],u_pixel_coord_lower:[65535&y,65535&b]}}let a_={terrain:0,flat:1},nb=r.ad.mat4.create(),s_=(m,s,c,f,y,b,E,R,P,L,F,j,U,W,ie,Q,re,oe)=>{let me=s.style.light,Me=me.properties.get("position"),Ee=[Me.x,Me.y,Me.z],Le=r.ad.mat3.create();me.properties.get("anchor")==="viewport"&&(r.ad.mat3.fromRotation(Le,-s.transform.angle),r.ad.vec3.transformMat3(Ee,Ee,Le));let Ie=me.properties.get("color"),Ae=s.transform,Re={u_matrix:m,u_lightpos:Ee,u_lightintensity:me.properties.get("intensity"),u_lightcolor:[Ie.r,Ie.g,Ie.b],u_vertical_gradient:+c,u_opacity:f,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:nb,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:a_[L],u_base_type:a_[F],u_ao:y,u_edge_radius:b,u_width_scale:E,u_flood_light_color:ie,u_vertical_scale:Q,u_flood_light_intensity:re,u_ground_shadow_factor:oe};return Ae.projection.name==="globe"&&(Re.u_tile_id=[R.canonical.x,R.canonical.y,1<<R.canonical.z],Re.u_zoom_transition=j,Re.u_inv_rot_matrix=W,Re.u_merc_center=U,Re.u_up_dir=Ae.projection.upVector(new r.bT(0,0,0),U[0]*r.ai,U[1]*r.ai),Re.u_height_lift=P),Re},cf=(m,s,c,f,y,b)=>({u_matrix:m,u_edge_radius:s,u_width_scale:c,u_vertical_scale:f,u_height_type:a_[y],u_base_type:a_[b]}),rb=(m,s,c,f,y,b,E,R,P,L,F,j,U,W,ie,Q,re)=>{let oe=s_(m,s,c,f,y,b,E,R,L,F,j,U,W,ie,Q,re,1,[0,0,0]),me={u_height_factor:-Math.pow(2,R.overscaledZ)/P.tileSize/8};return r.l(oe,ib(s,P),me)},uf=(m,s)=>({u_matrix:m,u_emissive_strength:s}),ob=(m,s,c,f)=>r.l(uf(m,s),ib(c,f)),l_=(m,s,c)=>({u_matrix:m,u_world:c,u_emissive_strength:s}),c_=(m,s,c,f,y)=>r.l(ob(m,s,c,f),{u_world:y}),tg=(m,s,c,f,y)=>({u_matrix:m,u_camera_pos:[s[0],s[1],s[2]],u_depth_bias:c,u_height_scale:f,u_reset_depth:y}),gE=(m,s,c,f)=>{let y=r.ai/c.tileSize;return{u_matrix:m,u_camera_to_center_distance:s.getCameraToCenterDistance(f),u_extrude_scale:[s.pixelsToGLUnits[0]/y,s.pixelsToGLUnits[1]/y]}},_E=(m,s,c=1)=>({u_matrix:m,u_color:s.toRenderColor(null),u_overlay:0,u_overlay_scale:c}),df=r.ad.mat4.create(),u_=(m,s,c,f,y,b,E)=>{let R=m.transform,P=R.projection.name==="globe",L=P?r.cO(R.zoom,s.canonical)*R._pixelsPerMercatorPixel:r.at(c,1,b),F={u_matrix:s.projMatrix,u_extrude_scale:L,u_intensity:E,u_inv_rot_matrix:df,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(P){F.u_inv_rot_matrix=f,F.u_merc_center=y,F.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],F.u_zoom_transition=r.ag(R.zoom);let j=y[0]*r.ai,U=y[1]*r.ai;F.u_up_dir=R.projection.upVector(new r.bT(0,0,0),j,U)}return F};function ii(m,[s,c,f,y],[b,E]){if(b===E)return[0,0,0,0];let R=255*(m-1)/(m*(E-b));return[s*R,c*R,f*R,y*R]}function ab(m,s,[c,f]){return c===f?0:.5/m+(s-c)*(m-1)/(m*(f-c))}let sb=(m,s,c,f,y,b,E,R,P,L,F,j,U,W,ie,Q,re,oe,me,Me,Ee)=>({u_matrix:m,u_normalize_matrix:s,u_globe_matrix:c,u_merc_matrix:f,u_grid_matrix:y,u_tl_parent:b,u_scale_parent:L,u_fade_t:F.mix,u_opacity:F.opacity*j.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:j.paint.get("raster-brightness-min"),u_brightness_high:j.paint.get("raster-brightness-max"),u_saturation_factor:r.cP(j.paint.get("raster-saturation")),u_contrast_factor:r.cQ(j.paint.get("raster-contrast")),u_spin_weights:hh(j.paint.get("raster-hue-rotate")),u_perspective_transform:U,u_raster_elevation:W,u_zoom_transition:E,u_merc_center:R,u_cutoff_params:P,u_colorization_mix:ii(r.cR,Q,oe),u_colorization_offset:ab(r.cR,re,oe),u_color_ramp:ie,u_texture_offset:[Me/(me+2*Me),me/(me+2*Me)],u_texture_res:[me+2*Me,me+2*Me],u_emissive_strength:Ee});function hh(m){m*=Math.PI/180;let s=Math.sin(m),c=Math.cos(m);return[(2*c+1)/3,(-Math.sqrt(3)*s-c+1)/3,(Math.sqrt(3)*s-c+1)/3]}let Ll=.05,Ii=(m,s,c,f,y,b,E,R,P,L,F,j)=>({u_matrix:m,u_normalize_matrix:s,u_globe_matrix:c,u_merc_matrix:f,u_grid_matrix:y,u_tl_parent:b,u_scale_parent:L,u_fade_t:F.mix,u_opacity:F.opacity,u_image0:0,u_image1:1,u_raster_elevation:j,u_zoom_transition:E,u_merc_center:R,u_cutoff_params:P}),lb=(m,s,c,f,y,b,E,R,P,L)=>({u_particle_texture:m,u_particle_texture_side_len:s,u_tile_offset:c,u_velocity:f,u_color_ramp:b,u_velocity_res:y,u_max_speed:E,u_uv_offset:R,u_data_scale:[255*P[0],255*P[1]],u_data_offset:L,u_particle_pos_scale:1.1,u_particle_pos_offset:[Ll,Ll]}),AI=(m,s,c,f,y,b,E,R,P,L)=>({u_particle_texture:m,u_particle_texture_side_len:s,u_velocity:c,u_velocity_res:f,u_max_speed:y,u_speed_factor:b,u_reset_rate:E,u_rand_seed:Math.random(),u_uv_offset:R,u_data_scale:[255*P[0],255*P[1]],u_data_offset:L,u_particle_pos_scale:1.1,u_particle_pos_offset:[Ll,Ll]}),yE=r.ad.mat4.create(),d_=(m,s,c,f,y,b,E,R,P,L,F,j,U,W,ie,Q,re,oe,me,Me,Ee,Le)=>{let Ie=y.transform,Ae={u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Ie.getCameraToCenterDistance(me),u_rotate_symbol:+c,u_aspect_ratio:Ie.width/Ie.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:E,u_coord_matrix:R,u_is_text:+L,u_elevation_from_sea:P?1:0,u_pitch_with_map:+f,u_texsize:F,u_texsize_icon:j,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:yE,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:yE,u_up_vector:[0,-1,0],u_color_adj_mat:Me,u_icon_transition:Ee||0,u_gamma_scale:f?y.transform.getCameraToCenterDistance(me)*Math.cos(y.terrain?0:y.transform._pitch):1,u_device_pixel_ratio:r.q.devicePixelRatio,u_is_halo:+U,u_scale_factor:Le||1};return me.name==="globe"&&(Ae.u_tile_id=[W.canonical.x,W.canonical.y,1<<W.canonical.z],Ae.u_zoom_transition=ie,Ae.u_inv_rot_matrix=re,Ae.u_merc_center=Q,Ae.u_camera_forward=Ie._camera.forward(),Ae.u_ecef_origin=r.cS(Ie.globeMatrix,W.toUnwrapped()),Ae.u_tile_matrix=Float32Array.from(Ie.globeMatrix),Ae.u_up_vector=oe),Ae},cb=(m,s,c,f)=>({u_matrix:m,u_emissive_strength:s,u_opacity:c,u_color:f}),vE=(m,s,c,f,y,b,E,R,P)=>r.l(function(L,F,j,U,W,ie){let{width:Q,height:re}=U.imageManager.getPixelSize(F),oe=Math.pow(2,ie.tileID.overscaledZ),me=ie.tileSize*Math.pow(2,U.transform.tileZoom)/oe,Me=me*(ie.tileID.canonical.x+ie.tileID.wrap*oe),Ee=me*ie.tileID.canonical.y;return{u_image:0,u_pattern_tl:j.tl,u_pattern_br:j.br,u_texsize:[Q,re],u_pattern_size:j.displaySize,u_pattern_units_to_pixels:W?[U.transform.width,-1*U.transform.height]:[1/r.at(ie,1,U.transform.tileZoom),1/r.at(ie,1,U.transform.tileZoom)],u_pixel_coord_upper:[Me>>16,Ee>>16],u_pixel_coord_lower:[65535&Me,65535&Ee]}}(0,b,E,f,R,P),{u_matrix:m,u_emissive_strength:s,u_opacity:c}),h_=new Float32Array(r.ad.mat4.identity([])),ub=(m,s,c,f,y,b,E,R,P,L,F,j,U,W=[0,0,0],ie)=>{let Q=y.style.light,re=Q.properties.get("position"),oe=[-re.x,-re.y,re.z],me=r.ad.mat3.create();Q.properties.get("anchor")==="viewport"&&(r.ad.mat3.fromRotation(me,-y.transform.angle),r.ad.vec3.transformMat3(oe,oe,me));let Me=F.alphaMode==="MASK",Ee=Q.properties.get("color").toRenderColor(null),Le=U.paint.get("model-ambient-occlusion-intensity"),Ie=U.paint.get("model-color").constantOr(r.al.white).toRenderColor(null),Ae=U.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:m,u_lighting_matrix:s,u_normal_matrix:c,u_node_matrix:f||h_,u_lightpos:oe,u_lightintensity:Q.properties.get("intensity"),u_lightcolor:[Ee.r,Ee.g,Ee.b],u_camera_pos:W,u_opacity:b,u_baseTextureIsAlpha:0,u_alphaMask:+Me,u_alphaCutoff:F.alphaCutoff,u_baseColorFactor:[E.r,E.g,E.b,E.a],u_emissiveFactor:[R[0],R[1],R[2],1],u_metallicFactor:P,u_roughnessFactor:L,u_baseColorTexture:eo.BaseColor,u_metallicRoughnessTexture:eo.MetallicRoughness,u_normalTexture:eo.Normal,u_occlusionTexture:eo.Occlusion,u_emissionTexture:eo.Emission,u_lutTexture:eo.LUT,u_color_mix:[Ie.r,Ie.g,Ie.b,Ae],u_aoIntensity:Le,u_emissive_strength:j,u_occlusionTextureTransform:ie||[0,0,0,0]}},bE=(m,s=h_,c=h_)=>({u_matrix:m,u_instance:s,u_node_matrix:c}),db={fillExtrusion:m=>({u_matrix:new r.bJ(m),u_lightpos:new r.bL(m),u_lightintensity:new r.bM(m),u_lightcolor:new r.bL(m),u_vertical_gradient:new r.bM(m),u_opacity:new r.bM(m),u_edge_radius:new r.bM(m),u_width_scale:new r.bM(m),u_ao:new r.bK(m),u_height_type:new r.bN(m),u_base_type:new r.bN(m),u_tile_id:new r.bL(m),u_zoom_transition:new r.bM(m),u_inv_rot_matrix:new r.bJ(m),u_merc_center:new r.bK(m),u_up_dir:new r.bL(m),u_height_lift:new r.bM(m),u_flood_light_color:new r.bL(m),u_vertical_scale:new r.bM(m),u_flood_light_intensity:new r.bM(m),u_ground_shadow_factor:new r.bL(m)}),fillExtrusionDepth:m=>({u_matrix:new r.bJ(m),u_edge_radius:new r.bM(m),u_width_scale:new r.bM(m),u_vertical_scale:new r.bM(m),u_height_type:new r.bN(m),u_base_type:new r.bN(m)}),fillExtrusionPattern:m=>({u_matrix:new r.bJ(m),u_lightpos:new r.bL(m),u_lightintensity:new r.bM(m),u_lightcolor:new r.bL(m),u_vertical_gradient:new r.bM(m),u_height_factor:new r.bM(m),u_edge_radius:new r.bM(m),u_width_scale:new r.bM(m),u_ao:new r.bK(m),u_height_type:new r.bN(m),u_base_type:new r.bN(m),u_tile_id:new r.bL(m),u_zoom_transition:new r.bM(m),u_inv_rot_matrix:new r.bJ(m),u_merc_center:new r.bK(m),u_up_dir:new r.bL(m),u_height_lift:new r.bM(m),u_image:new r.bN(m),u_texsize:new r.bK(m),u_pixel_coord_upper:new r.bK(m),u_pixel_coord_lower:new r.bK(m),u_tile_units_to_pixels:new r.bM(m),u_opacity:new r.bM(m)}),fillExtrusionGroundEffect:m=>({u_matrix:new r.bJ(m),u_opacity:new r.bM(m),u_ao_pass:new r.bM(m),u_meter_to_tile:new r.bM(m),u_ao:new r.bK(m),u_flood_light_intensity:new r.bM(m),u_flood_light_color:new r.bL(m),u_attenuation:new r.bM(m),u_edge_radius:new r.bM(m),u_fb:new r.bN(m),u_fb_size:new r.bM(m),u_dynamic_offset:new r.bM(m)}),fill:m=>({u_matrix:new r.bJ(m),u_emissive_strength:new r.bM(m)}),fillPattern:m=>({u_matrix:new r.bJ(m),u_emissive_strength:new r.bM(m),u_image:new r.bN(m),u_texsize:new r.bK(m),u_pixel_coord_upper:new r.bK(m),u_pixel_coord_lower:new r.bK(m),u_tile_units_to_pixels:new r.bM(m)}),fillOutline:m=>({u_matrix:new r.bJ(m),u_emissive_strength:new r.bM(m),u_world:new r.bK(m)}),fillOutlinePattern:m=>({u_matrix:new r.bJ(m),u_emissive_strength:new r.bM(m),u_world:new r.bK(m),u_image:new r.bN(m),u_texsize:new r.bK(m),u_pixel_coord_upper:new r.bK(m),u_pixel_coord_lower:new r.bK(m),u_tile_units_to_pixels:new r.bM(m)}),elevatedStructures:m=>({u_matrix:new r.bJ(m)}),elevatedStructuresDepthReconstruct:m=>({u_matrix:new r.bJ(m),u_camera_pos:new r.bL(m),u_depth_bias:new r.bM(m),u_height_scale:new r.bM(m),u_reset_depth:new r.bM(m)}),circle:r.cT,collisionBox:m=>({u_matrix:new r.bJ(m),u_camera_to_center_distance:new r.bM(m),u_extrude_scale:new r.bK(m)}),collisionCircle:m=>({u_matrix:new r.bJ(m),u_inv_matrix:new r.bJ(m),u_camera_to_center_distance:new r.bM(m),u_viewport_size:new r.bK(m)}),debug:m=>({u_color:new r.cA(m),u_matrix:new r.bJ(m),u_overlay:new r.bN(m),u_overlay_scale:new r.bM(m)}),clippingMask:m=>({u_matrix:new r.bJ(m)}),heatmap:m=>({u_extrude_scale:new r.bM(m),u_intensity:new r.bM(m),u_matrix:new r.bJ(m),u_inv_rot_matrix:new r.bJ(m),u_merc_center:new r.bK(m),u_tile_id:new r.bL(m),u_zoom_transition:new r.bM(m),u_up_dir:new r.bL(m)}),heatmapTexture:m=>({u_image:new r.bN(m),u_color_ramp:new r.bN(m),u_opacity:new r.bM(m)}),hillshade:m=>({u_matrix:new r.bJ(m),u_image:new r.bN(m),u_latrange:new r.bK(m),u_light:new r.bK(m),u_shadow:new r.cA(m),u_highlight:new r.cA(m),u_emissive_strength:new r.bM(m),u_accent:new r.cA(m)}),hillshadePrepare:m=>({u_matrix:new r.bJ(m),u_image:new r.bN(m),u_dimension:new r.bK(m),u_zoom:new r.bM(m)}),line:r.cU,linePattern:r.cV,raster:m=>({u_matrix:new r.bJ(m),u_normalize_matrix:new r.bJ(m),u_globe_matrix:new r.bJ(m),u_merc_matrix:new r.bJ(m),u_grid_matrix:new r.cB(m),u_tl_parent:new r.bK(m),u_scale_parent:new r.bM(m),u_fade_t:new r.bM(m),u_opacity:new r.bM(m),u_image0:new r.bN(m),u_image1:new r.bN(m),u_brightness_low:new r.bM(m),u_brightness_high:new r.bM(m),u_saturation_factor:new r.bM(m),u_contrast_factor:new r.bM(m),u_spin_weights:new r.bL(m),u_perspective_transform:new r.bK(m),u_raster_elevation:new r.bM(m),u_zoom_transition:new r.bM(m),u_merc_center:new r.bK(m),u_cutoff_params:new r.cb(m),u_colorization_mix:new r.cb(m),u_colorization_offset:new r.bM(m),u_color_ramp:new r.bN(m),u_texture_offset:new r.bK(m),u_texture_res:new r.bK(m),u_emissive_strength:new r.bM(m)}),rasterParticle:m=>({u_matrix:new r.bJ(m),u_normalize_matrix:new r.bJ(m),u_globe_matrix:new r.bJ(m),u_merc_matrix:new r.bJ(m),u_grid_matrix:new r.cB(m),u_tl_parent:new r.bK(m),u_scale_parent:new r.bM(m),u_fade_t:new r.bM(m),u_opacity:new r.bM(m),u_image0:new r.bN(m),u_image1:new r.bN(m),u_raster_elevation:new r.bM(m),u_zoom_transition:new r.bM(m),u_merc_center:new r.bK(m),u_cutoff_params:new r.cb(m)}),rasterParticleTexture:m=>({u_texture:new r.bN(m),u_opacity:new r.bM(m)}),rasterParticleDraw:m=>({u_particle_texture:new r.bN(m),u_particle_texture_side_len:new r.bM(m),u_tile_offset:new r.bK(m),u_velocity:new r.bN(m),u_color_ramp:new r.bN(m),u_velocity_res:new r.bK(m),u_max_speed:new r.bM(m),u_uv_offset:new r.bK(m),u_data_scale:new r.bK(m),u_data_offset:new r.bM(m),u_particle_pos_scale:new r.bM(m),u_particle_pos_offset:new r.bK(m)}),rasterParticleUpdate:m=>({u_particle_texture:new r.bN(m),u_particle_texture_side_len:new r.bM(m),u_velocity:new r.bN(m),u_velocity_res:new r.bK(m),u_max_speed:new r.bM(m),u_speed_factor:new r.bM(m),u_reset_rate:new r.bM(m),u_rand_seed:new r.bM(m),u_uv_offset:new r.bK(m),u_data_scale:new r.bK(m),u_data_offset:new r.bM(m),u_particle_pos_scale:new r.bM(m),u_particle_pos_offset:new r.bK(m)}),symbol:m=>({u_is_size_zoom_constant:new r.bN(m),u_is_size_feature_constant:new r.bN(m),u_size_t:new r.bM(m),u_size:new r.bM(m),u_camera_to_center_distance:new r.bM(m),u_rotate_symbol:new r.bN(m),u_aspect_ratio:new r.bM(m),u_fade_change:new r.bM(m),u_matrix:new r.bJ(m),u_label_plane_matrix:new r.bJ(m),u_coord_matrix:new r.bJ(m),u_is_text:new r.bN(m),u_elevation_from_sea:new r.bN(m),u_pitch_with_map:new r.bN(m),u_texsize:new r.bK(m),u_texsize_icon:new r.bK(m),u_texture:new r.bN(m),u_texture_icon:new r.bN(m),u_gamma_scale:new r.bM(m),u_device_pixel_ratio:new r.bM(m),u_tile_id:new r.bL(m),u_zoom_transition:new r.bM(m),u_inv_rot_matrix:new r.bJ(m),u_merc_center:new r.bK(m),u_camera_forward:new r.bL(m),u_tile_matrix:new r.bJ(m),u_up_vector:new r.bL(m),u_ecef_origin:new r.bL(m),u_is_halo:new r.bN(m),u_icon_transition:new r.bM(m),u_color_adj_mat:new r.bJ(m),u_scale_factor:new r.bM(m)}),background:m=>({u_matrix:new r.bJ(m),u_emissive_strength:new r.bM(m),u_opacity:new r.bM(m),u_color:new r.cA(m)}),backgroundPattern:m=>({u_matrix:new r.bJ(m),u_emissive_strength:new r.bM(m),u_opacity:new r.bM(m),u_image:new r.bN(m),u_pattern_tl:new r.bK(m),u_pattern_br:new r.bK(m),u_texsize:new r.bK(m),u_pattern_size:new r.bK(m),u_pixel_coord_upper:new r.bK(m),u_pixel_coord_lower:new r.bK(m),u_pattern_units_to_pixels:new r.bK(m)}),terrainRaster:m=>({u_matrix:new r.bJ(m),u_image0:new r.bN(m),u_skirt_height:new r.bM(m),u_ground_shadow_factor:new r.bL(m)}),skybox:m=>({u_matrix:new r.bJ(m),u_sun_direction:new r.bL(m),u_cubemap:new r.bN(m),u_opacity:new r.bM(m),u_temporal_offset:new r.bM(m)}),skyboxGradient:m=>({u_matrix:new r.bJ(m),u_color_ramp:new r.bN(m),u_center_direction:new r.bL(m),u_radius:new r.bM(m),u_opacity:new r.bM(m),u_temporal_offset:new r.bM(m)}),skyboxCapture:m=>({u_matrix_3f:new r.cB(m),u_sun_direction:new r.bL(m),u_sun_intensity:new r.bM(m),u_color_tint_r:new r.cb(m),u_color_tint_m:new r.cb(m),u_luminance:new r.bM(m)}),globeRaster:m=>({u_proj_matrix:new r.bJ(m),u_globe_matrix:new r.bJ(m),u_normalize_matrix:new r.bJ(m),u_merc_matrix:new r.bJ(m),u_zoom_transition:new r.bM(m),u_merc_center:new r.bK(m),u_image0:new r.bN(m),u_grid_matrix:new r.cB(m),u_skirt_height:new r.bM(m),u_far_z_cutoff:new r.bM(m),u_frustum_tl:new r.bL(m),u_frustum_tr:new r.bL(m),u_frustum_br:new r.bL(m),u_frustum_bl:new r.bL(m),u_globe_pos:new r.bL(m),u_globe_radius:new r.bM(m),u_viewport:new r.bK(m)}),globeAtmosphere:m=>({u_frustum_tl:new r.bL(m),u_frustum_tr:new r.bL(m),u_frustum_br:new r.bL(m),u_frustum_bl:new r.bL(m),u_horizon:new r.bM(m),u_transition:new r.bM(m),u_fadeout_range:new r.bM(m),u_color:new r.cb(m),u_high_color:new r.cb(m),u_space_color:new r.cb(m),u_temporal_offset:new r.bM(m),u_horizon_angle:new r.bM(m)}),model:m=>({u_matrix:new r.bJ(m),u_lighting_matrix:new r.bJ(m),u_normal_matrix:new r.bJ(m),u_node_matrix:new r.bJ(m),u_lightpos:new r.bL(m),u_lightintensity:new r.bM(m),u_lightcolor:new r.bL(m),u_camera_pos:new r.bL(m),u_opacity:new r.bM(m),u_baseColorFactor:new r.cb(m),u_emissiveFactor:new r.cb(m),u_metallicFactor:new r.bM(m),u_roughnessFactor:new r.bM(m),u_baseTextureIsAlpha:new r.bN(m),u_alphaMask:new r.bN(m),u_alphaCutoff:new r.bM(m),u_baseColorTexture:new r.bN(m),u_metallicRoughnessTexture:new r.bN(m),u_normalTexture:new r.bN(m),u_occlusionTexture:new r.bN(m),u_emissionTexture:new r.bN(m),u_lutTexture:new r.bN(m),u_color_mix:new r.cb(m),u_aoIntensity:new r.bM(m),u_emissive_strength:new r.bM(m),u_occlusionTextureTransform:new r.cb(m)}),modelDepth:m=>({u_matrix:new r.bJ(m),u_instance:new r.bJ(m),u_node_matrix:new r.bJ(m)}),groundShadow:m=>({u_matrix:new r.bJ(m),u_ground_shadow_factor:new r.bL(m)}),stars:m=>({u_matrix:new r.bJ(m),u_up:new r.bL(m),u_right:new r.bL(m),u_intensity_multiplier:new r.bM(m)}),snowParticle:m=>({u_modelview:new r.bJ(m),u_projection:new r.bJ(m),u_time:new r.bM(m),u_cam_pos:new r.bL(m),u_velocityConeAperture:new r.bM(m),u_velocity:new r.bM(m),u_horizontalOscillationRadius:new r.bM(m),u_horizontalOscillationRate:new r.bM(m),u_boxSize:new r.bM(m),u_billboardSize:new r.bM(m),u_simpleShapeParameters:new r.bK(m),u_screenSize:new r.bK(m),u_thinningCenterPos:new r.bK(m),u_thinningShape:new r.bL(m),u_thinningAffectedRatio:new r.bM(m),u_thinningParticleOffset:new r.bM(m),u_particleColor:new r.cb(m),u_direction:new r.bL(m)}),rainParticle:m=>({u_modelview:new r.bJ(m),u_projection:new r.bJ(m),u_time:new r.bM(m),u_cam_pos:new r.bL(m),u_texScreen:new r.bN(m),u_velocityConeAperture:new r.bM(m),u_velocity:new r.bM(m),u_boxSize:new r.bM(m),u_rainDropletSize:new r.bK(m),u_distortionStrength:new r.bM(m),u_rainDirection:new r.bL(m),u_color:new r.cb(m),u_screenSize:new r.bK(m),u_thinningCenterPos:new r.bK(m),u_thinningShape:new r.bL(m),u_thinningAffectedRatio:new r.bM(m),u_thinningParticleOffset:new r.bM(m),u_shapeDirectionalPower:new r.bM(m),u_shapeNormalPower:new r.bM(m),u_mode:new r.bM(m)}),vignette:m=>({u_vignetteShape:new r.bL(m),u_vignetteColor:new r.cb(m)}),occlusion:m=>({u_matrix:new r.bJ(m),u_anchorPos:new r.bL(m),u_screenSizePx:new r.bK(m),u_occluderSizePx:new r.bK(m),u_color:new r.cb(m)})},p_=(()=>{class m{constructor(c,f,y,b){this.id=m.uniqueIdxCounter,m.uniqueIdxCounter++,this.context=c;let E=c.gl;this.buffer=E.createBuffer(),this.dynamicDraw=!!y,this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),E.bufferData(E.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||b||f.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){this.id=m.uniqueIdxCounter,m.uniqueIdxCounter++;let f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}return m.uniqueIdxCounter=0,m})(),hb={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class pb{constructor(s,c,f,y,b,E){this.length=c.length,this.attributes=f,this.itemSize=c.bytesPerElement,this.dynamicDraw=y,this.instanceCount=E,this.context=s;let R=s.gl;this.buffer=R.createBuffer(),s.bindVertexBuffer.set(this.buffer),R.bufferData(R.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?R.DYNAMIC_DRAW:R.STATIC_DRAW),this.dynamicDraw||b||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){let c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,c){for(let f=0;f<this.attributes.length;f++){let y=c.attributes[this.attributes[f].name];y!==void 0&&s.enableVertexAttribArray(y)}}setVertexAttribPointers(s,c,f){for(let y=0;y<this.attributes.length;y++){let b=this.attributes[y],E=c.attributes[b.name];E!==void 0&&s.vertexAttribPointer(E,b.components,s[hb[b.type]],!1,this.itemSize,b.offset+this.itemSize*(f||0))}}setVertexAttribDivisor(s,c,f){for(let y=0;y<this.attributes.length;y++){let b=c.attributes[this.attributes[y].name];b!==void 0&&this.instanceCount&&this.instanceCount>0&&s.vertexAttribDivisor(b,f)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Gs{constructor(s,c,f,y,b){this.context=s,this.width=c,this.height=f;let E=this.framebuffer=s.gl.createFramebuffer();y&&(this.colorAttachment=new Kv(s,E)),b&&(this.depthAttachmentType=b,this.depthAttachment=b==="renderbuffer"?new Xv(s,E):new sf(s,E))}destroy(){let s=this.context.gl;if(this.colorAttachment){let c=this.colorAttachment.get();c&&s.deleteTexture(c)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){let c=this.depthAttachment.get();c&&s.deleteRenderbuffer(c)}else{let c=this.depthAttachment.get();c&&s.deleteTexture(c)}s.deleteFramebuffer(this.framebuffer)}}class ph{constructor(s,c){this.gl=s,this.clearColor=new Zt(this),this.clearDepth=new Li(this),this.clearStencil=new Tn(this),this.colorMask=new mr(this),this.depthMask=new go(this),this.stencilMask=new ba(this),this.stencilFunc=new qs(this),this.stencilOp=new Pl(this),this.stencilTest=new Nl(this),this.depthRange=new sl(this),this.depthTest=new dh(this),this.depthFunc=new $s(this),this.blend=new qv(this),this.blendFunc=new J0(this),this.blendColor=new e_(this),this.blendEquation=new $v(this),this.cullFace=new Gv(this),this.cullFaceSide=new Wv(this),this.frontFace=new t_(this),this.program=new Zv(this),this.activeTexture=new Yv(this),this.viewport=new i_(this),this.bindFramebuffer=new lE(this),this.bindRenderbuffer=new cE(this),this.bindTexture=new af(this),this.bindVertexBuffer=new EI(this),this.bindElementBuffer=new CI(this),this.bindVertexArrayOES=new SI(this),this.pixelStoreUnpack=new TI(this),this.pixelStoreUnpackPremultiplyAlpha=new DI(this),this.pixelStoreUnpackFlipY=new MI(this),this.options=c?Object.assign({},c):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=s.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=s.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=s.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=c&&!!c.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=s.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=s.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=s.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),this.maxPointSize=s.getParameter(s.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,c,f){return new p_(this,s,c,f)}createVertexBuffer(s,c,f,y,b){return new pb(this,s,c,f,y,b)}createRenderbuffer(s,c,f){let y=this.gl,b=y.createRenderbuffer();return this.bindRenderbuffer.set(b),y.renderbufferStorage(y.RENDERBUFFER,s,c,f),this.bindRenderbuffer.set(null),b}createFramebuffer(s,c,f,y){return new Gs(this,s,c,f,y)}clear({color:s,depth:c,stencil:f,colorMask:y}){let b=this.gl,E=0;s&&(E|=b.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set(y||[!0,!0,!0,!0])),c!==void 0&&(E|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),f!==void 0&&(E|=b.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),b.clear(E)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){r.bn(s.blendFunction,_n.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor),s.blendEquation?this.blendEquation.set(s.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(s.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let ig;function f_(m,s,c,f,y,b,E){let R=m.context,P=R.gl,L=m.transform,F=m.getOrCreateProgram("collisionBox"),j=[],U=0,W=0;for(let Ee=0;Ee<f.length;Ee++){let Le=f[Ee],Ie=s.getTile(Le),Ae=Ie.getBucket(c);if(!Ae)continue;let Re=qm(Le,Ae,L),Ve=Re;y[0]===0&&y[1]===0||(Ve=m.translatePosMatrix(Re,Ie,y,b));let qe=E?Ae.textCollisionBox:Ae.iconCollisionBox,dt=Ae.collisionCircleArray;if(dt.length>0){let nt=r.ad.mat4.create(),Et=Ve;r.ad.mat4.mul(nt,Ae.placementInvProjMatrix,L.glCoordMatrix),r.ad.mat4.mul(nt,nt,Ae.placementViewportMatrix),j.push({circleArray:dt,circleOffset:W,transform:Et,invTransform:nt,projection:Ae.getProjection()}),U+=dt.length/4,W=U}qe&&(m.terrain&&m.terrain.setupElevationDraw(Ie,F),F.draw(m,P.LINES,xi.disabled,en.disabled,m.colorModeForRenderPass(),Vi.disabled,gE(Ve,L,Ie,Ae.getProjection()),c.id,qe.layoutVertexBuffer,qe.indexBuffer,qe.segments,null,L.zoom,null,[qe.collisionVertexBuffer,qe.collisionVertexBufferExt]))}if(!E||!j.length)return;let ie=m.getOrCreateProgram("collisionCircle"),Q=new r.cW;Q.resize(4*U),Q._trim();let re=0;for(let Ee of j)for(let Le=0;Le<Ee.circleArray.length/4;Le++){let Ie=4*Le,Ae=Ee.circleArray[Ie+0],Re=Ee.circleArray[Ie+1],Ve=Ee.circleArray[Ie+2],qe=Ee.circleArray[Ie+3];Q.emplace(re++,Ae,Re,Ve,qe,0),Q.emplace(re++,Ae,Re,Ve,qe,1),Q.emplace(re++,Ae,Re,Ve,qe,2),Q.emplace(re++,Ae,Re,Ve,qe,3)}(!ig||ig.length<2*U)&&(ig=function(Ee){let Le=2*Ee,Ie=new r.aV;Ie.resize(Le),Ie._trim();for(let Ae=0;Ae<Le;Ae++){let Re=6*Ae;Ie.uint16[Re+0]=4*Ae+0,Ie.uint16[Re+1]=4*Ae+1,Ie.uint16[Re+2]=4*Ae+2,Ie.uint16[Re+3]=4*Ae+2,Ie.uint16[Re+4]=4*Ae+3,Ie.uint16[Re+5]=4*Ae+0}return Ie}(U));let oe=R.createIndexBuffer(ig,!0),me=R.createVertexBuffer(Q,r.cX.members,!0);for(let Ee of j){let Le={u_matrix:Ee.transform,u_inv_matrix:Ee.invTransform,u_camera_to_center_distance:(Me=L).getCameraToCenterDistance(Ee.projection),u_viewport_size:[Me.width,Me.height]};ie.draw(m,P.TRIANGLES,xi.disabled,en.disabled,m.colorModeForRenderPass(),Vi.disabled,Le,c.id,me,oe,r.b8.simpleSegment(0,2*Ee.circleOffset,Ee.circleArray.length,Ee.circleArray.length/2),null,L.zoom)}var Me;me.destroy(),oe.destroy()}let hf=r.ad.mat4.create();function m_(m){let s=m._camera.getWorldToCamera(m.worldSize,1),c=r.ad.mat4.multiply([],s,m.globeMatrix);r.ad.mat4.invert(c,c);let f=[0,0,0],y=[0,1,0,0];return r.ad.vec4.transformMat4(y,y,c),f[0]=y[0],f[1]=y[1],f[2]=y[2],r.ad.vec3.normalize(f,f),f}function xE({width:m,height:s,anchor:c,textOffset:f,textScale:y},b){let{horizontalAlign:E,verticalAlign:R}=r.bD(c),P=-(E-.5)*m,L=-(R-.5)*s,F=r.bC(c,f);return new r.P((P/y+F[0])*b,(L/y+F[1])*b)}function lc(m,s,c,f,y,b,E,R,P,L,F){let j=m.text.placedSymbolArray,U=m.text.dynamicLayoutVertexArray,W=m.icon.dynamicLayoutVertexArray,ie={},Q=m.getProjection(),re=Us(R,Q,b),oe=b.elevation,me=Q.upVectorScale(R.canonical,b.center.lat,b.worldSize).metersToTile;U.clear();for(let Me=0;Me<j.length;Me++){let Ee=j.get(Me),{tileAnchorX:Le,tileAnchorY:Ie,numGlyphs:Ae}=Ee,Re=Ee.hidden||!Ee.crossTileID||m.allowVerticalPlacement&&!Ee.placedOrientation?null:f[Ee.crossTileID];if(Re){let Ve=0,qe=0,dt=0;if(oe){let _t=oe?oe.getAtTileOffset(R,Le,Ie):0,[St,ht,At]=Q.upVector(R.canonical,Le,Ie);Ve=_t*St*me,qe=_t*ht*me,dt=_t*At*me}let[nt,Et,Ct,Ut]=rn(Ee.projectedAnchorX+Ve,Ee.projectedAnchorY+qe,Ee.projectedAnchorZ+dt,c?re:E),tt=cr(b.getCameraToCenterDistance(Q),Ut),xt=y.evaluateSizeForFeature(m.textSizeData,L,Ee)*tt/r.bw;c&&(xt*=m.tilePixelRatio/P);let Qe=xE(Re,xt);c?({x:nt,y:Et,z:Ct}=Q.projectTilePoint(Le+Qe.x,Ie+Qe.y,R.canonical),[nt,Et,Ct]=rn(nt+Ve,Et+qe,Ct+dt,E)):(s&&Qe._rotate(-b.angle),nt+=Qe.x,Et+=Qe.y,Ct=0);let bt=m.allowVerticalPlacement&&Ee.placedOrientation===r.bq.vertical?Math.PI/2:0;for(let _t=0;_t<Ae;_t++)r.bt(U,nt,Et,Ct,bt);F&&Ee.associatedIconIndex>=0&&(ie[Ee.associatedIconIndex]={x:nt,y:Et,z:Ct,angle:bt})}else Il(Ae,U)}if(F){W.clear();let Me=m.icon.placedSymbolArray;for(let Ee=0;Ee<Me.length;Ee++){let Le=Me.get(Ee),{numGlyphs:Ie}=Le,Ae=ie[Ee];if(Le.hidden||!Ae)Il(Ie,W);else{let{x:Re,y:Ve,z:qe,angle:dt}=Ae;for(let nt=0;nt<Ie;nt++)r.bt(W,Re,Ve,qe,dt)}}m.icon.dynamicLayoutVertexBuffer.updateData(W)}m.text.dynamicLayoutVertexBuffer.updateData(U)}function Ar(m,s,c,f,y,b,E={}){let R=c.paint.get("icon-translate"),P=c.paint.get("text-translate"),L=c.paint.get("icon-translate-anchor"),F=c.paint.get("text-translate-anchor"),j=c.layout.get("icon-rotation-alignment"),U=c.layout.get("text-rotation-alignment"),W=c.layout.get("icon-pitch-alignment"),ie=c.layout.get("text-pitch-alignment"),Q=c.layout.get("icon-keep-upright"),re=c.layout.get("text-keep-upright"),oe=c.paint.get("icon-color-saturation"),me=c.paint.get("icon-color-contrast"),Me=c.paint.get("icon-color-brightness-min"),Ee=c.paint.get("icon-color-brightness-max"),Le=c.layout.get("symbol-elevation-reference")==="sea",Ie=m.context,Ae=Ie.gl,Re=m.transform,Ve=j==="map",qe=U==="map",dt=W==="map",nt=ie==="map",Et=c.layout.get("symbol-sort-key").constantOr(1)!==void 0,Ct=!1,Ut=m.depthModeForSublayer(0,xi.ReadOnly),tt=[r.av(Re.center.lng),r.aC(Re.center.lat)],xt=c.layout.get("text-variable-anchor"),Qe=Re.projection.name==="globe",bt=[],_t=[0,-1,0];for(let St of f){let ht=s.getTile(St),At=ht.getBucket(c);if(!At||At.projection.name==="mercator"&&Qe||At.fullyClipped)continue;let Kt=At.projection.name==="globe",Xt=Kt?r.ag(Re.zoom):0,Qt=Us(St,At.getProjection(),Re),_i=Re.calculatePixelsToTileUnitsMatrix(ht),tn=xt&&At.hasTextData(),ki=At.hasIconTextFit()&&tn&&At.hasIconData(),Ki=At.getProjection().createInversionMatrix(Re,St.canonical),Fi=dr=>{Re.depthOcclusionForSymbolsAndCircles&&(c.hasInitialOcclusionOpacityProperties||m.terrain)&&(dr.push("DEPTH_D24"),dr.push("DEPTH_OCCLUSION"))},An=()=>{let dr=Ve&&c.layout.get("symbol-placement")!=="point",Yn=[];Fi(Yn);let co=dr||ki,Lo=c.paint.get("icon-image-cross-fade").constantOr(0);m.terrainRenderModeElevated()&&dt&&Yn.push("PITCH_WITH_MAP_TERRAIN"),Kt&&(Yn.push("PROJECTION_GLOBE_VIEW"),co&&Yn.push("PROJECTED_POS_ON_VIEWPORT")),Lo>0&&Yn.push("ICON_TRANSITION"),At.icon.zOffsetVertexBuffer&&Yn.push("Z_OFFSET"),oe===0&&me===0&&Me===0&&Ee===1||Yn.push("COLOR_ADJUSTMENT"),At.sdfIcons&&Yn.push("RENDER_SDF");let Jo=At.icon.programConfigurations.get(c.id),ha=m.getOrCreateProgram("symbol",{config:Jo,defines:Yn}),Bl=ht.imageAtlasTexture?ht.imageAtlasTexture.size:[0,0],ds=At.iconSizeData,Hn=r.bp(ds,Re.zoom),Kr=dt||Re.pitch!==0,ir=Lc(Qt,ht.tileID.canonical,dt,Ve,Re,At.getProjection(),_i),Tr=jr(Qt,ht.tileID.canonical,dt,Ve,Re,At.getProjection(),_i),Oa=m.translatePosMatrix(Tr,ht,R,L,!0),Ur=m.translatePosMatrix(Qt,ht,R,L),ea=co?hf:ir,Tu=Ve&&!dt&&!dr,hl=_t;!Qe&&!Re.mercatorFromTransition||Ve||(hl=m_(Re));let dc=Kt?hl:_t,Ws=c.getColorAdjustmentMatrix(oe,me,Me,Ee),hc=d_(ds.kind,Hn,Tu,dt,m,Ur,ea,Oa,Le,!1,Bl,[0,0],!0,St,Xt,tt,Ki,dc,At.getProjection(),Ws,Lo),pl=ht.imageAtlasTexture?ht.imageAtlasTexture:null,gd=c.layout.get("icon-size").constantOr(0)!==1||At.iconsNeedLinear,Du=At.sdfIcons||m.options.rotating||m.options.zooming||gd||Kr?Ae.LINEAR:Ae.NEAREST,_d=At.sdfIcons&&c.paint.get("icon-halo-width").constantOr(1)!==0,Bb=m.terrain&&dt&&dr?r.ad.mat4.invert(r.ad.mat4.create(),ir):hf;if(dr&&At.icon){let Tf=Re.elevation,O_=Tf?Tf.getAtTileOffsetFunc(St,Re.center.lat,Re.worldSize,At.getProjection()):null,Vb=ya(Qt,ht.tileID.canonical,dt,Ve,Re,At.getProjection(),_i);tc(At,Qt,m,!1,Vb,Tr,dt,Q,O_,St)}return{program:ha,buffers:At.icon,uniformValues:hc,atlasTexture:pl,atlasTextureIcon:null,atlasInterpolation:Du,atlasInterpolationIcon:null,isSDF:At.sdfIcons,hasHalo:_d,tile:ht,labelPlaneMatrixInv:Bb}},tr=()=>{let dr=qe&&c.layout.get("symbol-placement")!=="point",Yn=[],co=dr||xt||ki;m.terrainRenderModeElevated()&&nt&&Yn.push("PITCH_WITH_MAP_TERRAIN"),Kt&&(Yn.push("PROJECTION_GLOBE_VIEW"),co&&Yn.push("PROJECTED_POS_ON_VIEWPORT")),At.text.zOffsetVertexBuffer&&Yn.push("Z_OFFSET"),At.iconsInText&&Yn.push("RENDER_TEXT_AND_SYMBOL"),Yn.push("RENDER_SDF"),Fi(Yn);let Lo=At.text.programConfigurations.get(c.id),Jo=m.getOrCreateProgram("symbol",{config:Lo,defines:Yn}),ha,Bl=[0,0],ds=null,Hn=At.textSizeData;At.iconsInText&&(Bl=ht.imageAtlasTexture?ht.imageAtlasTexture.size:[0,0],ds=ht.imageAtlasTexture?ht.imageAtlasTexture:null,ha=nt||Re.pitch!==0||m.options.rotating||m.options.zooming||Hn.kind==="composite"||Hn.kind==="camera"?Ae.LINEAR:Ae.NEAREST);let Kr=ht.glyphAtlasTexture?ht.glyphAtlasTexture.size:[0,0],ir=c.layout.get("text-size-scale-range"),Tr=r.ay(m.scaleFactor,ir[0],ir[1]),Oa=r.bp(Hn,Re.zoom,Tr),Ur=Lc(Qt,ht.tileID.canonical,nt,qe,Re,At.getProjection(),_i),ea=jr(Qt,ht.tileID.canonical,nt,qe,Re,At.getProjection(),_i),Tu=m.translatePosMatrix(ea,ht,P,F,!0),hl=m.translatePosMatrix(Qt,ht,P,F),dc=co?hf:Ur,Ws=qe&&!nt&&!dr,hc=_t;!Qe&&!Re.mercatorFromTransition||qe||(hc=m_(Re));let pl=d_(Hn.kind,Oa,Ws,nt,m,hl,dc,Tu,Le,!0,Kr,Bl,!0,St,Xt,tt,Ki,Kt?hc:_t,At.getProjection(),null,null,Tr),gd=ht.glyphAtlasTexture?ht.glyphAtlasTexture:null,Du=Ae.LINEAR,_d=c.paint.get("text-halo-width").constantOr(1)!==0,Bb=m.terrain&&nt&&dr?r.ad.mat4.invert(r.ad.mat4.create(),Ur):hf;if(dr&&At.text){let Tf=Re.elevation,O_=Tf?Tf.getAtTileOffsetFunc(St,Re.center.lat,Re.worldSize,At.getProjection()):null,Vb=ya(Qt,ht.tileID.canonical,nt,qe,Re,At.getProjection(),_i);tc(At,Qt,m,!0,Vb,ea,nt,re,O_,St)}return{program:Jo,buffers:At.text,uniformValues:pl,atlasTexture:gd,atlasTextureIcon:ds,atlasInterpolation:Du,atlasInterpolationIcon:ha,isSDF:!0,hasHalo:_d,tile:ht,labelPlaneMatrixInv:Bb}},Lr=At.icon.segments.get().length,vn=At.text.segments.get().length,Yr=Lr&&!E.onlyText?An():null,on=vn&&!E.onlyIcons?tr():null,yi=c.paint.get("icon-opacity").constantOr(1),Pn=c.paint.get("text-opacity").constantOr(1);if(Et&&At.canOverlap){Ct=!0;let dr=yi&&!E.onlyText?At.icon.segments.get():[],Yn=Pn&&!E.onlyIcons?At.text.segments.get():[];for(let co of dr)bt.push({segments:new r.b8([co]),sortKey:co.sortKey,state:Yr});for(let co of Yn)bt.push({segments:new r.b8([co]),sortKey:co.sortKey,state:on})}else E.onlyText||bt.push({segments:yi?At.icon.segments:new r.b8([]),sortKey:0,state:Yr}),E.onlyIcons||bt.push({segments:Pn?At.text.segments:new r.b8([]),sortKey:0,state:on})}Ct&&bt.sort((St,ht)=>St.sortKey-ht.sortKey);for(let St of bt){let ht=St.state;if(ht)if(m.terrain?m.terrain.setupElevationDraw(ht.tile,ht.program,{useDepthForOcclusion:Re.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:ht.labelPlaneMatrixInv}):m.setupDepthForOcclusion(Re.depthOcclusionForSymbolsAndCircles,ht.program),Ie.activeTexture.set(Ae.TEXTURE0),ht.atlasTexture&&ht.atlasTexture.bind(ht.atlasInterpolation,Ae.CLAMP_TO_EDGE,!0),ht.atlasTextureIcon&&(Ie.activeTexture.set(Ae.TEXTURE1),ht.atlasTextureIcon&&ht.atlasTextureIcon.bind(ht.atlasInterpolationIcon,Ae.CLAMP_TO_EDGE,!0)),m.uploadCommonLightUniforms(m.context,ht.program),ht.hasHalo){let At=ht.uniformValues;At.u_is_halo=1,pf(ht.buffers,St.segments,c,m,ht.program,Ut,y,b,At,2),At.u_is_halo=0}else{if(ht.isSDF){let At=ht.uniformValues;ht.hasHalo&&(At.u_is_halo=1,pf(ht.buffers,St.segments,c,m,ht.program,Ut,y,b,At,1)),At.u_is_halo=0}pf(ht.buffers,St.segments,c,m,ht.program,Ut,y,b,ht.uniformValues,1)}}}function pf(m,s,c,f,y,b,E,R,P,L){let F=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.iconTransitioningVertexBuffer,m.globeExtVertexBuffer,m.zOffsetVertexBuffer];y.draw(f,f.context.gl.TRIANGLES,b,E,R,Vi.disabled,P,c.id,m.layoutVertexBuffer,m.indexBuffer,s,c.paint,f.transform.zoom,m.programConfigurations.get(c.id),F,L)}function fb(m,s){let c=1<<m.canonical.z,f=(s.x*c-m.canonical.x-m.wrap*c)*r.ai,y=(s.y*c-m.canonical.y)*r.ai,b=r.d5(s.z,s.y);return r.ad.vec3.fromValues(f,y,b)}function mb(m,s,c,f,y){if(!c.layout||c.layout.get("fill-elevation-reference")==="none")return;let b=m.context.gl,E=new xi(m.context.gl.LEQUAL,xi.ReadWrite,m.depthRangeFor3D),R=new xi(m.context.gl.GREATER,xi.ReadWrite,m.depthRangeFor3D),P=function(W){let ie=r.c4(W.pitch),Q=.01;return W.isOrthographic&&(Q=r.ah(1e-4,Q,r.c9(ie>=$t?1:ie/$t))),2*Q}(m.transform),L=m.transform.getFreeCameraOptions().position,F="elevatedStructuresDepthReconstruct",j=m.getOrCreateProgram(F,{defines:["DEPTH_RECONSTRUCTION"]}),U=m.getOrCreateProgram(F);for(let W of f){let ie=s.getTile(W),Q=ie.getBucket(c);if(!Q)continue;let re=Q.elevatedStructures;if(!re)continue;let oe=Q.elevationBufferData.heightRange,me=fb(W.toUnwrapped(),L),Me=m.translatePosMatrix(W.projMatrix,ie,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor")),Ee,Le,Ie,Ae;if(y==="initialize"){if(!oe||oe.min>=1||re.depthSegments.segments[0].primitiveLength===0)continue;Ee=tg(Me,me,P,1,0),Le=E,Ie=re.depthSegments,Ae=j}else if(y==="reset"){if(!oe||oe.min>=0||re.maskSegments.segments[0].primitiveLength===0)continue;Ee=tg(Me,me,0,0,1),Le=R,Ie=re.maskSegments,Ae=j}else if(y==="geometry"){if(re.depthSegments.segments[0].primitiveLength===0)continue;Ee=tg(Me,me,P,1,0),Le=E,Ie=re.depthSegments,Ae=U}Ae.draw(m,b.TRIANGLES,Le,en.disabled,_n.disabled,Vi.disabled,Ee,c.id,re.vertexBuffer,re.indexBuffer,Ie,c.paint,m.transform.zoom)}}function g_(m,s,c){let{painter:f,sourceCache:y,layer:b,coords:E,colorMode:R,elevationType:P,terrainEnabled:L,pass:F}=m,j=f.context.gl,U=b.paint.get("fill-pattern"),W=P;P!=="road"||s&&!L||(W="none");let ie=W==="road",Q=new xi(f.context.gl.LEQUAL,xi.ReadWrite,f.depthRangeFor3D),re=U&&U.constantOr(1),oe=(me,Me)=>{let Ee,Le,Ie,Ae,Re;Me?(Le=re&&!b.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Ee=j.LINES):(Le=re?"fillPattern":"fill",Ee=j.TRIANGLES);for(let Ve of E){let qe=y.getTile(Ve);if(re&&!qe.patternsLoaded())continue;let dt=qe.getBucket(b);if(!dt)continue;let nt=s?dt.elevationBufferData:dt.bufferData;if(nt.isEmpty())continue;f.prepareDrawTile();let Et=nt.programConfigurations.get(b.id),Ct=f.isTileAffectedByFog(Ve),Ut=[],tt=[];ie&&(Ut.push("ELEVATED_ROADS"),tt.push(nt.elevatedLayoutVertexBuffer));let xt=f.getOrCreateProgram(Le,{config:Et,overrideFog:Ct,defines:Ut});re&&(f.context.activeTexture.set(j.TEXTURE0),qe.imageAtlasTexture&&qe.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),Et.updatePaintBuffers());let Qe=U.constantOr(null);if(Qe&&qe.imageAtlas){let St=qe.imageAtlas,ht=r.d0.from(Qe).getPrimary().scaleSelf(r.q.devicePixelRatio).toString(),At=St.patternPositions.get(ht);At&&Et.setConstantPatternPositions(At)}let bt=f.translatePosMatrix(Ve.projMatrix,qe,b.paint.get("fill-translate"),b.paint.get("fill-translate-anchor")),_t=b.paint.get("fill-emissive-strength");if(Me){Ae=nt.lineIndexBuffer,Re=nt.lineSegments;let St=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[j.drawingBufferWidth,j.drawingBufferHeight];Ie=Le==="fillOutlinePattern"&&re?c_(bt,_t,f,qe,St):l_(bt,_t,St)}else Ae=nt.indexBuffer,Re=nt.triangleSegments,Ie=re?ob(bt,_t,f,qe):uf(bt,_t);f.uploadCommonUniforms(f.context,xt,Ve.toUnwrapped()),xt.draw(f,Ee,W!=="none"?Q:me,c||f.stencilModeForClipping(Ve),R,Vi.disabled,Ie,b.id,nt.layoutVertexBuffer,Ae,Re,b.paint,f.transform.zoom,Et,tt)}};f.renderPass===F&&oe(f.depthModeForSublayer(1,f.renderPass==="opaque"?xi.ReadWrite:xi.ReadOnly),!1),W==="none"&&f.renderPass==="translucent"&&b.paint.get("fill-antialias")&&oe(f.depthModeForSublayer(b.getPaintProperty("fill-outline-color")?2:0,xi.ReadOnly),!0)}function ng(m,s,c,f,y,b,E,R){c.resetLayerRenderingStats(m);let P=m.context,L=P.gl,F=m.transform,j=c.paint.get("fill-extrusion-pattern"),U=j.constantOr(1),W=c.paint.get("fill-extrusion-opacity"),ie=m.style.enable3dLights(),Q=c.paint.get(ie&&!U?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),re=[c.paint.get("fill-extrusion-ambient-occlusion-intensity"),Q],oe=c.layout.get("fill-extrusion-edge-radius"),me=oe>0&&!c.paint.get("fill-extrusion-rounded-roof"),Me=me?0:oe,Ee=F.projection.name==="globe"?r.d6():0,Le=F.projection.name==="globe",Ie=Le?r.ag(F.zoom):0,Ae=[r.av(F.center.lng),r.aC(F.center.lat)],Re=c.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Ve=c.paint.get("fill-extrusion-flood-light-color").toRenderColor(Re?null:c.lut).toArray01().slice(0,3),qe=c.paint.get("fill-extrusion-flood-light-intensity"),dt=c.paint.get("fill-extrusion-vertical-scale"),nt=c.paint.get("fill-extrusion-line-width").constantOr(1)!==0,Et=c.paint.get("fill-extrusion-height-alignment"),Ct=c.paint.get("fill-extrusion-base-alignment"),Ut=rc(m,c.paint.get("fill-extrusion-cutoff-fade-range")),tt=[],xt;Le&&tt.push("PROJECTION_GLOBE_VIEW"),re[0]>0&&tt.push("FAUX_AO"),me&&tt.push("ZERO_ROOF_RADIUS"),R&&tt.push("HAS_CENTROID"),qe>0&&tt.push("FLOOD_LIGHT"),Ut.shouldRenderCutoff&&tt.push("RENDER_CUTOFF"),nt&&tt.push("RENDER_WALL_MODE");let Qe=m.renderPass==="shadow",bt=m.shadowRenderer,_t=Qe&&!!bt;m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!0);let St=[0,0,0];if(bt){let Kt=m.style.directionalLight,Xt=m.style.ambientLight;Kt&&Xt&&(St=sd(m.style,Kt,Xt)),Qe||(tt.push("RENDER_SHADOWS","DEPTH_TEXTURE"),bt.useNormalOffset&&tt.push("NORMAL_OFFSET")),xt=tt.concat(["SHADOWS_SINGLE_CASCADE"])}let ht=_t?"fillExtrusionDepth":U?"fillExtrusionPattern":"fillExtrusion",At=c.getLayerRenderingStats();for(let Kt of f){let Xt=s.getTile(Kt),Qt=Xt.getBucket(c);if(!Qt||Qt.projection.name!==F.projection.name)continue;let _i=!1;bt&&(_i=bt.getMaxCascadeForTile(Kt.toUnwrapped())===0);let tn=m.isTileAffectedByFog(Kt),ki=Qt.programConfigurations.get(c.id),Ki=m.getOrCreateProgram(ht,{config:ki,defines:_i?xt:tt,overrideFog:tn});if(m.terrain&&m.terrain.setupElevationDraw(Xt,Ki,{useMeterToDem:!0}),!Qt.centroidVertexBuffer){let on=Ki.attributes.a_centroid_pos;on!==void 0&&L.vertexAttrib2f(on,0,0)}!Qe&&bt&&bt.setupShadows(Xt.tileID.toUnwrapped(),Ki,"vector-tile",Xt.tileID.overscaledZ),U&&(m.context.activeTexture.set(L.TEXTURE0),Xt.imageAtlasTexture&&Xt.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),ki.updatePaintBuffers());let Fi=j.constantOr(null);if(Fi&&Xt.imageAtlas){let on=Xt.imageAtlas,yi=r.d0.from(Fi).getPrimary().scaleSelf(r.q.devicePixelRatio),Pn=on.patternPositions.get(yi.toString());Pn&&ki.setConstantPatternPositions(Pn)}let An=c.paint.get("fill-extrusion-vertical-gradient"),tr=1/Qt.tileToMeter,Lr;if(Qe&&bt){if(_f(Xt.tileID,Qt,m))continue;let on=bt.calculateShadowPassMatrixFromTile(Xt.tileID.toUnwrapped());Lr=cf(on,Me,tr,dt,Et,Ct)}else{let on=m.translatePosMatrix(Kt.expandedProjMatrix,Xt,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),yi=F.projection.createInversionMatrix(F,Kt.canonical);Lr=U?rb(on,m,An,W,re,Me,tr,Kt,Xt,Ee,Et,Ct,Ie,Ae,yi,Ve,dt):s_(on,m,An,W,re,Me,tr,Kt,Ee,Et,Ct,Ie,Ae,yi,Ve,dt,qe,St)}m.uploadCommonUniforms(P,Ki,Kt.toUnwrapped(),null,Ut);let vn=Qt.segments;if(F.projection.name==="mercator"&&!Qe&&(vn=Qt.getVisibleSegments(Xt.tileID,m.terrain,m.transform.getFrustum(0)),!vn.get().length))continue;if(At)if(Qe)for(let on of vn.get())At.numRenderedVerticesInShadowPass+=on.primitiveLength;else for(let on of vn.get())At.numRenderedVerticesInTransparentPass+=on.primitiveLength;let Yr=[];(m.terrain||R)&&Yr.push(Qt.centroidVertexBuffer),Le&&Yr.push(Qt.layoutVertexExtBuffer),nt&&Yr.push(Qt.wallVertexBuffer),Ki.draw(m,P.gl.TRIANGLES,y,b,E,Vi.backCCW,Lr,c.id,Qt.layoutVertexBuffer,Qt.indexBuffer,vn,c.paint,m.transform.zoom,ki,Yr)}m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!1)}function ff(m,s,c,f,y,b,E,R,P,L,F,j,U,W,ie,Q,re,oe,me){let Me=m.context,Ee=Me.gl,Le=m.transform,Ie=m.transform.zoom,Ae=[],Re=rc(m,c.paint.get("fill-extrusion-cutoff-fade-range"));L==="clear"?(Ae.push("CLEAR_SUBPASS"),me&&(Ae.push("CLEAR_FROM_TEXTURE"),Me.activeTexture.set(Ee.TEXTURE0),me.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE))):L==="sdf"&&Ae.push("SDF_SUBPASS"),re&&Ae.push("HAS_CENTROID"),Re.shouldRenderCutoff&&Ae.push("RENDER_CUTOFF");let Ve=c.layout.get("fill-extrusion-edge-radius"),qe=(dt,nt,Et,Ct,Ut)=>{let tt=nt.programConfigurations.get(c.id),xt=m.isTileAffectedByFog(dt),Qe=m.getOrCreateProgram("fillExtrusionGroundEffect",{config:tt,defines:Ae,overrideFog:xt}),bt=((St,ht,At,Kt,Xt,Qt,_i,tn,ki,Ki,Fi)=>({u_matrix:ht,u_opacity:At,u_ao_pass:Kt?1:0,u_meter_to_tile:Xt,u_ao:Qt,u_flood_light_intensity:_i,u_flood_light_color:tn,u_attenuation:ki,u_edge_radius:Ki,u_fb:0,u_fb_size:Fi,u_dynamic_offset:1}))(0,Ct,F,P,Ut,[j,U*Ut],W,ie,Q,Ie>=17?0:Ve*Ut,me?me.size[0]:0),_t=[];re&&_t.push(nt.hiddenByLandmarkVertexBuffer),m.uploadCommonUniforms(Me,Qe,dt.toUnwrapped(),null,Re),Qe.draw(m,Me.gl.TRIANGLES,y,b,E,R,bt,c.id,nt.vertexBuffer,nt.indexBuffer,Et,c.paint,Ie,tt,_t)};for(let dt of f){let nt=s.getTile(dt),Et=nt.getBucket(c);if(!Et||Et.projection.name!==Le.projection.name||!Et.groundEffect||Et.groundEffect&&!Et.groundEffect.hasData())continue;let Ct=Et.groundEffect,Ut=1/Et.tileToMeter;{let tt=m.translatePosMatrix(dt.projMatrix,nt,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),xt=Ct.getDefaultSegment();qe(dt,Ct,xt,tt,Ut)}if(oe)for(let tt=0;tt<4;tt++){let xt=r.d7[tt](dt),Qe=s.getTile(xt);if(!Qe)continue;let bt=Qe.getBucket(c);if(!bt||bt.projection.name!==Le.projection.name||!bt.groundEffect||bt.groundEffect&&!bt.groundEffect.hasData())continue;let _t=bt.groundEffect,St,ht;tt===0?(St=[-r.ai,0,0],ht=1):tt===1?(St=[r.ai,0,0],ht=0):tt===2?(St=[0,-r.ai,0],ht=3):(St=[0,r.ai,0],ht=2);let At=_t.regionSegments[ht];if(!At)continue;let Kt=new Float32Array(16);r.ad.mat4.translate(Kt,dt.projMatrix,St),qe(dt,_t,At,m.translatePosMatrix(Kt,nt,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),Ut)}}}function mf(m,s,c,f,y,b,E){f.centroidVertexArray.length===0&&f.createCentroidsBuffer();let R=b?b.findDEMTileFor(c):null;if(!(R&&R.dem||E))return;b&&R&&R.dem&&f.selfDEMTileTimestamp!==R.dem._timestamp&&(f.borderDoneWithNeighborZ=[-1,-1,-1,-1],f.selfDEMTileTimestamp=R.dem._timestamp);let P=oe=>new r.P(Math.ceil((oe+r.da)*r.db),0),L=oe=>{let me=s.getSource().minzoom,Me=Le=>{let Ie=s.getTileByID(Le);if(Ie&&Ie.hasData())return Ie.getBucket(y)},Ee=[0,-1,1];for(let Le of Ee){if(oe.overscaledZ+Le<me)continue;let Ie=Me(oe.calculateScaledKey(oe.overscaledZ+Le));if(Ie)return Ie}},F=[0,0,0],j=(oe,me)=>(F[0]=Math.min(oe.min.y,me.min.y),F[1]=Math.max(oe.max.y,me.max.y),F[2]=r.ai-me.min.x>oe.max.x?me.min.x-r.ai:oe.max.x,F),U=(oe,me)=>(F[0]=Math.min(oe.min.x,me.min.x),F[1]=Math.max(oe.max.x,me.max.x),F[2]=r.ai-me.min.y>oe.max.y?me.min.y-r.ai:oe.max.y,F),W=[(oe,me)=>j(oe,me),(oe,me)=>j(me,oe),(oe,me)=>U(oe,me),(oe,me)=>U(me,oe)],ie=(oe,me,Me,Ee,Le,Ie,Ae)=>{if(!b)return 0;let Re=[[Ie?Me:oe,Ie?oe:Me,0],[Ie?Me:me,Ie?me:Me,0]],Ve=Ae<0?r.ai+Ae:Ae,qe=[Ie?Ve:(oe+me)/2,Ie?(oe+me)/2:Ve,0];return Me===0&&Ae<0||Me!==0&&Ae>0?b.getForTilePoints(Le,[qe],!0,Ee):Re.push(qe),b.getForTilePoints(c,Re,!0,R),Math.max(Re[0][2],Re[1][2],qe[2])/b.exaggeration()};for(let oe=0;oe<4;oe++){let me=f.borderFeatureIndices[oe];if(me.length===0)continue;let Me=r.d7[oe](c),Ee=L(Me);if(!(Ee&&Ee instanceof r.d8))continue;let Le=b?b.findDEMTileFor(Me):null;if(!(Le&&Le.dem||E)||(b&&Le&&Le.dem&&f.borderDEMTileTimestamp[oe]!==Le.dem._timestamp&&(f.borderDoneWithNeighborZ[oe]=-1,f.borderDEMTileTimestamp[oe]=Le.dem._timestamp),f.borderDoneWithNeighborZ[oe]===Ee.canonical.z))continue;Ee.centroidVertexArray.length===0&&Ee.createCentroidsBuffer();let Ie=(oe<2?1:5)-oe,Ae=Ee.borderDoneWithNeighborZ[Ie]!==f.canonical.z,Re=Ee.borderFeatureIndices[Ie],Ve=0;if(f.canonical.z!==Ee.canonical.z){for(let qe of me)f.showCentroid(f.featuresOnBorder[qe]);if(Ae)for(let qe of Re)Ee.showCentroid(Ee.featuresOnBorder[qe]);f.borderDoneWithNeighborZ[oe]=Ee.canonical.z,Ee.borderDoneWithNeighborZ[Ie]=f.canonical.z}for(let qe of me){let dt=f.featuresOnBorder[qe],nt=f.centroidData[dt.centroidDataIndex],Et=dt.borders[oe],Ct;for(;Ve<Re.length;){Ct=Ee.featuresOnBorder[Re[Ve]];let Ut=Ct.borders[Ie];if(Ut[1]>Et[0]+3||Ut[0]>Et[0]-3)break;Ee.showCentroid(Ct),Ve++}if(Ct&&Ve<Re.length){let Ut=Ve,tt=0;for(;!(Ct.borders[Ie][0]>Et[1]-3)&&(tt++,++Ve!==Re.length);)Ct=Ee.featuresOnBorder[Re[Ve]];Ct=Ee.featuresOnBorder[Re[Ut]];let xt=!1;if(tt>=1){let _t=Ct.borders[Ie];Math.abs(Et[0]-_t[0])<3&&Math.abs(Et[1]-_t[1])<3&&(tt=1,xt=!0,Ve=Ut+1)}else if(tt===0){f.showCentroid(dt);continue}let Qe=Ee.centroidData[Ct.centroidDataIndex];E&&xt&&(((Q=nt).flags|(re=Qe).flags)&r.d9?(Q.flags|=r.d9,re.flags|=r.d9):(Q.flags&=~r.d9,re.flags&=~r.d9));let bt=dt.intersectsCount()>1||Ct.intersectsCount()>1;if(tt>1)Ve=Ut,nt.centroidXY=Qe.centroidXY=new r.P(0,0);else if(Le&&Le.dem&&!bt){let _t=W[oe](nt,Qe),St=oe%2?r.ai-1:0,ht=ie(_t[0],Math.min(r.ai-1,_t[1]),St,Le,Me,oe<2,_t[2]);nt.centroidXY=Qe.centroidXY=P(ht)}else bt?nt.centroidXY=Qe.centroidXY=new r.P(0,0):(nt.centroidXY=f.encodeBorderCentroid(dt),Qe.centroidXY=Ee.encodeBorderCentroid(Ct));f.writeCentroidToBuffer(nt),Ee.writeCentroidToBuffer(Qe)}else f.showCentroid(dt)}f.borderDoneWithNeighborZ[oe]=Ee.canonical.z,Ee.borderDoneWithNeighborZ[Ie]=f.canonical.z}var Q,re;(f.needsCentroidUpdate||!f.centroidVertexBuffer&&f.centroidVertexArray.length!==0)&&f.uploadCentroid(m)}let gf=[1,0,0],Ht=[0,1,0],ti=[0,0,1];function _f(m,s,c){let f=c.transform,y=c.shadowRenderer;if(!y)return!0;let b=m.toUnwrapped(),E=f.tileSize*y._cascades[c.currentShadowCascade].scale,R=s.maxHeight;if(f.elevation){let Q=f.elevation.getMinMaxForTile(m);Q&&(R+=Q.max)}let P=[...y.shadowDirection];P[2]=-P[2];let L=y.computeSimplifiedTileShadowVolume(b,R,E,P);if(!L)return!1;let F=[gf,Ht,ti,P,[P[0],0,P[2]],[0,P[1],P[2]]],j=f.projection.name==="globe",U=f.scaleZoom(E),W=r.bR.fromInvProjectionMatrix(f.invProjMatrix,f.worldSize,U,!j),ie=y.getCurrentCascadeFrustum();return W.intersectsPrecise(L.vertices,L.planes,F)===0||ie.intersectsPrecise(L.vertices,L.planes,F)===0}function no(m){return[m[0]*r.dc,m[1]*r.dc,m[2]*r.dc,0]}function lt(m,s,c,f,y,b,E,R,P){let L=f.getSource(),F=c.globeSharedBuffers;if(!F)return;let j,U,W;if(s&&(j=f.getTile(s)),L instanceof r.aK?(U=L.texture,W=r.cJ(0,0,c.transform)):j&&s&&(U=j.texture,W=r.cJ(s.canonical.z,s.canonical.x,c.transform)),!U||!W)return;m||(W=r.ad.mat4.scale(r.ad.mat4.create(),W,[1,-1,1]));let ie=c.context,Q=ie.gl,re=y.paint.get("raster-resampling")==="nearest"?Q.NEAREST:Q.LINEAR,oe=c.colorModeForDrapableLayerRenderPass(b),me=E.defines;me.push("GLOBE_POLES");let Me=new xi(Q.LEQUAL,xi.ReadWrite,c.depthRangeFor3D),Ee=Float32Array.from(c.transform.expandedFarZProjMatrix),Le=Float32Array.from(r.bc(r.cI(new r.bT(0,0,0))));c.terrain&&c.terrain.prepareDrawTile(),ie.activeTexture.set(Q.TEXTURE0),U.bind(re,Q.CLAMP_TO_EDGE),ie.activeTexture.set(Q.TEXTURE1),U.bind(re,Q.CLAMP_TO_EDGE),"useMipmap"in U&&ie.extTextureFilterAnisotropic&&c.transform.pitch>20&&Q.texParameterf(Q.TEXTURE_2D,ie.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ie.extTextureFilterAnisotropicMax);let[Ie,Ae,Re,Ve]=s?F.getPoleBuffers(s.canonical.z,!1):F.getPoleBuffers(0,!0),qe=y.paint.get("raster-elevation"),dt;m?(dt=Ie,c.renderDefaultNorthPole=qe!==0):(dt=Ae,c.renderDefaultSouthPole=qe!==0);let nt=no(E.mix),Et=((Ut,tt,xt,Qe,bt,_t,St,ht,At,Kt,Xt,Qt,_i)=>sb(Ut,tt,xt,new Float32Array(16),new Float32Array(9),[0,0],Qe,[0,0],[0,0,0,0],1,{opacity:1,mix:0},_t,[0,0],ht,2,Kt,Xt,Qt,1,0,_i))(Ee,Le,W,r.ag(c.transform.zoom),0,y,0,qe,0,nt,E.offset,E.range,b),Ct=c.getOrCreateProgram("raster",{defines:me});c.uploadCommonUniforms(ie,Ct,null),Ct.draw(c,Q.TRIANGLES,Me,P,oe,R,Et,y.id,dt,Re,Ve)}function wE(m){let s=m._nearZ,c=m.projection.farthestPixelDistance(m),f=c-s,y=.2*m.height,b=s+y;return[s,c,(b-y-s)/f,(b-s)/f]}function __(m,s,c,f){if(m)return s instanceof js&&m instanceof ls?s.getTextureDescriptor(m,c,!0):{texture:m.texture,mix:no(f.mix),offset:f.offset,buffer:0,tileSize:1}}var gb=r.dd([{name:"a_index",type:"Int16",components:1}]);class _b{constructor(s,c,f,y){let b={width:f[0],height:f[1],data:null},E=s.gl;this.targetColorTexture=new r.T(s,b,E.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new r.T(s,b,E.RGBA8,{useMipmap:!1}),this.context=s,this.updateParticleTexture(c,y),this.lastInvalidatedAt=0}updateParticleTexture(s,c){if(this.particleTextureDimension===c.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());let f=this.context.gl,y=c.width*c.height;this.particleTexture0=new r.T(this.context,c,f.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new r.T(this.context,c,f.RGBA8,{premultiply:!1,useMipmap:!1});let b=new r.de;b.reserve(y);for(let E=0;E<y;E++)b.emplaceBack(E);this.particleIndexBuffer=this.context.createVertexBuffer(b,gb.members,!0),this.particleSegment=r.b8.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=c.width}update(s){return!(this.lastInvalidatedAt<s&&(this.lastInvalidatedAt=r.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function EE(m,s,c){if(!m)return null;let f=s.getTextureDescriptor(m,c,!0);if(!f)return null;let{texture:y,mix:b,offset:E,tileSize:R,buffer:P,format:L}=f;if(!y||!L)return null;let F=!1;return L==="uint32"&&(F=!0,b[3]=0,b=ii(r.df,b,[0,c.paint.get("raster-particle-max-speed")]),E=ab(r.df,E,[0,c.paint.get("raster-particle-max-speed")])),{texture:y,textureOffset:[P/(R+2*P),R/(R+2*P)],tileSize:R,scalarData:F,scale:b,offset:E,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[L]]}}function CE(m){let s=m._nearZ,c=m.projection.farthestPixelDistance(m),f=c-s,y=.2*m.height,b=s+y;return[s,c,(b-y-s)/f,(b-s)/f]}let yf=new r.al(1,0,0,1),RI=new r.al(0,1,0,1),kI=new r.al(0,0,1,1),SE=new r.al(1,0,1,1),y_=new r.al(0,1,1,1);function fh(m,s,c,f,y,b,E){let R=m.context,P=m.transform,L=R.gl,F=P.projection.name==="globe",j=F?["PROJECTION_GLOBE_VIEW"]:[],U=r.ad.mat4.clone(c.projMatrix);if(F&&r.ag(P.zoom)>0){let nt=r.bb(c.canonical,P),Et=r.dg(nt);U=r.ad.mat4.multiply(new Float32Array(16),P.globeMatrix,Et),r.ad.mat4.multiply(U,P.projMatrix,U)}let W=r.ad.mat4.create();W[12]+=2*y/(r.q.devicePixelRatio*P.width),W[13]+=2*b/(r.q.devicePixelRatio*P.height),r.ad.mat4.multiply(U,W,U);let ie=m.getOrCreateProgram("debug",{defines:j}),Q=s.getTileByID(c.key);m.terrain&&m.terrain.setupElevationDraw(Q,ie);let re=xi.disabled,oe=en.disabled,me=m.colorModeForRenderPass(),Me="$debug";R.activeTexture.set(L.TEXTURE0),m.emptyTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),F?Q._makeGlobeTileDebugBuffers(m.context,P):Q._makeDebugTileBoundsBuffers(m.context,P.projection);let Ee=Q._tileDebugBuffer||m.debugBuffer,Le=Q._tileDebugIndexBuffer||m.debugIndexBuffer,Ie=Q._tileDebugSegments||m.debugSegments;if(ie.draw(m,L.LINE_STRIP,re,oe,me,Vi.disabled,_E(U,f),Me,Ee,Le,Ie,null,null,null,[Q._globeTileDebugBorderBuffer]),E){let nt=Q.latestRawTileData,Et=Math.floor((nt&&nt.byteLength||0)/1024),Ct=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(Ct+=` => ${c.overscaledZ}`),Ct+=` ${Q.state}`,Ct+=` ${Et}kb`,function(Ut,tt){Ut.initDebugOverlayCanvas();let xt=Ut.debugOverlayCanvas,Qe=Ut.context.gl,bt=Ut.debugOverlayCanvas.getContext("2d");bt.clearRect(0,0,xt.width,xt.height),bt.shadowColor="white",bt.shadowBlur=2,bt.lineWidth=1.5,bt.strokeStyle="white",bt.textBaseline="top",bt.font="bold 36px Open Sans, sans-serif",bt.fillText(tt,5,5),bt.strokeText(tt,5,5),Ut.debugOverlayTexture.update(xt),Ut.debugOverlayTexture.bind(Qe.LINEAR,Qe.CLAMP_TO_EDGE)}(m,Ct)}let Ae=s.getTile(c).tileSize,Re=512/Math.min(Ae,512)*(c.overscaledZ/P.zoom)*.5,Ve=Q._tileDebugTextBuffer||m.debugBuffer,qe=Q._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,dt=Q._tileDebugTextSegments||m.debugSegments;ie.draw(m,L.TRIANGLES,re,oe,_n.alphaBlended,Vi.disabled,_E(U,r.al.transparent,Re),Me,Ve,qe,dt,null,null,null,[Q._globeTileDebugTextBuffer])}function yb(m,s,c,f){lp(m,0,s+c/2,m.transform.width,c,f)}function vb(m,s,c,f){lp(m,s-c/2,0,c,m.transform.height,f)}function lp(m,s,c,f,y,b){let E=m.context,R=E.gl;R.enable(R.SCISSOR_TEST),R.scissor(s*r.q.devicePixelRatio,c*r.q.devicePixelRatio,f*r.q.devicePixelRatio,y*r.q.devicePixelRatio),E.clear({color:b}),R.disable(R.SCISSOR_TEST)}let v_=r.dd([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:vf}=v_;function hd(m,s,c,f){m.emplaceBack(s,c,f)}class TE{constructor(s){this.vertexArray=new r.dh,this.indices=new r.aV,hd(this.vertexArray,-1,-1,1),hd(this.vertexArray,1,-1,1),hd(this.vertexArray,-1,1,1),hd(this.vertexArray,1,1,1),hd(this.vertexArray,-1,-1,-1),hd(this.vertexArray,1,-1,-1),hd(this.vertexArray,-1,1,-1),hd(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=s.createVertexBuffer(this.vertexArray,vf),this.indexBuffer=s.createIndexBuffer(this.indices),this.segment=r.b8.simpleSegment(0,0,36,12)}}function xa(m,s,c,f,y,b){let E=m.context.gl,R=s.paint.get("sky-atmosphere-color"),P=s.paint.get("sky-atmosphere-halo-color"),L=s.paint.get("sky-atmosphere-sun-intensity"),F=((j,U,W,ie,Q)=>({u_matrix_3f:j,u_sun_direction:U,u_sun_intensity:W,u_color_tint_r:[ie.r,ie.g,ie.b,ie.a],u_color_tint_m:[Q.r,Q.g,Q.b,Q.a],u_luminance:5e-5}))(r.ad.mat3.fromMat4(r.ad.mat3.create(),f),y,L,R,P);E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_CUBE_MAP_POSITIVE_X+b,s.skyboxTexture,0),c.draw(m,E.TRIANGLES,xi.disabled,en.disabled,_n.unblended,Vi.frontCW,F,"skyboxCapture",s.skyboxGeometry.vertexBuffer,s.skyboxGeometry.indexBuffer,s.skyboxGeometry.segment)}let OI=r.dd([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class rg{constructor(s){let c=new r.di;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);let f=new r.aV;f.emplaceBack(0,1,2),f.emplaceBack(2,3,0),this.vertexBuffer=s.createVertexBuffer(c,OI.members),this.indexBuffer=s.createIndexBuffer(f),this.segments=r.b8.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}let Fr=r.dd([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Jn{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class DE{constructor(s){this.colorModeAlphaBlendedWriteRGB=new _n([1,wu,1,wu],r.al.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new _n([1,0,1,0],r.al.transparent,[!1,!1,!1,!0]),this.params=new Jn,this.updateNeeded=!0,s.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),s.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(s){let c=s.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new rg(c);let f=this.params.sizeRange,y=this.params.intensityRange,b=function(F){let j=r.dl(30),U=[];for(let W=0;W<F;++W){let ie=2*Math.PI*j(),Q=Math.acos(1-2*j())-.5*Math.PI;U.push(r.ad.vec3.fromValues(Math.cos(Q)*Math.cos(ie),Math.cos(Q)*Math.sin(ie),Math.sin(Q)))}return U}(this.params.starsCount),E=r.dl(300),R=new r.dj,P=new r.aV,L=0;for(let F=0;F<b.length;++F){let j=r.ad.vec3.scale([],b[F],200),U=Math.max(0,1+.01*f*(1*E()-.5)),W=Math.max(0,1+.01*y*(1*E()-.5));R.emplaceBack(j[0],j[1],j[2],-1,-1,U,W),R.emplaceBack(j[0],j[1],j[2],1,-1,U,W),R.emplaceBack(j[0],j[1],j[2],1,1,U,W),R.emplaceBack(j[0],j[1],j[2],-1,1,U,W),P.emplaceBack(L+0,L+1,L+2),P.emplaceBack(L+0,L+2,L+3),L+=4}this.starsVx=c.createVertexBuffer(R,Fr.members),this.starsIdx=c.createIndexBuffer(P),this.starsSegments=r.b8.simpleSegment(0,0,R.length,P.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(s,c){let f=s.context,y=f.gl,b=s.transform,E=new xi(y.LEQUAL,xi.ReadOnly,[0,1]),R=r.ag(b.zoom),P=s.style.getLut(c.scope),L=c.properties.get("color-use-theme")==="none",F=c.properties.get("color").toRenderColor(L?null:P).toArray01(),j=c.properties.get("high-color-use-theme")==="none",U=c.properties.get("high-color").toRenderColor(j?null:P).toArray01(),W=c.properties.get("space-color-use-theme")==="none",ie=c.properties.get("space-color").toRenderColor(W?null:P).toArray01PremultipliedAlpha(),Q=5e-4,re=r.dk(c.properties.get("horizon-blend"),0,1,Q,.25),oe=r.cD(s,f,b)&&re===Q?b.worldSize/(2*Math.PI*1.025)-1:b.globeRadius,me=s.frameCounter/1e3%1,Me=r.ad.vec3.length(b.globeCenterInViewSpace),Ee=Math.sqrt(Math.pow(Me,2)-Math.pow(oe,2)),Le=Math.acos(Ee/Me),Ie=Ae=>{let Re=b.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Ae&&Re.push("ALPHA_PASS");let Ve=s.getOrCreateProgram("globeAtmosphere",{defines:Re}),qe=((nt,Et,Ct,Ut,tt,xt,Qe,bt,_t,St,ht,At)=>({u_frustum_tl:nt,u_frustum_tr:Et,u_frustum_br:Ct,u_frustum_bl:Ut,u_horizon:tt,u_transition:xt,u_fadeout_range:Qe,u_color:bt,u_high_color:_t,u_space_color:St,u_temporal_offset:ht,u_horizon_angle:At}))(b.frustumCorners.TL,b.frustumCorners.TR,b.frustumCorners.BR,b.frustumCorners.BL,b.frustumCorners.horizon,R,re,F,U,ie,me,Le);s.uploadCommonUniforms(f,Ve);let dt=this.atmosphereBuffer;dt&&Ve.draw(s,y.TRIANGLES,E,en.disabled,Ae?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Vi.backCW,qe,Ae?"atmosphere_glow_alpha":"atmosphere_glow",dt.vertexBuffer,dt.indexBuffer,dt.segments)};Ie(!1),Ie(!0)}drawStars(s,c){let f=r.ay(c.properties.get("star-intensity"),0,1);if(f===0)return;let y=s.context,b=y.gl,E=s.transform,R=s.getOrCreateProgram("stars"),P=r.ad.quat.identity([]);r.ad.quat.rotateX(P,P,-E._pitch),r.ad.quat.rotateZ(P,P,-E.angle),r.ad.quat.rotateX(P,P,r.ak(E._center.lat)),r.ad.quat.rotateY(P,P,-r.ak(E._center.lng));let L=r.ad.mat4.fromQuat(new Float32Array(16),P),F=r.ad.mat4.multiply([],E.starsProjMatrix,L),j=r.ad.mat3.fromMat4([],L),U=r.ad.mat3.invert([],j),W=[0,1,0];r.ad.vec3.transformMat3(W,W,U),r.ad.vec3.scale(W,W,this.params.sizeMultiplier);let ie=[1,0,0];r.ad.vec3.transformMat3(ie,ie,U),r.ad.vec3.scale(ie,ie,this.params.sizeMultiplier);let Q=(re=W,oe=ie,me=f,{u_matrix:Float32Array.from(F),u_up:re,u_right:oe,u_intensity_multiplier:me});var re,oe,me;s.uploadCommonUniforms(y,R),this.starsVx&&this.starsIdx&&R.draw(s,b.TRIANGLES,xi.disabled,en.disabled,this.colorModeAlphaBlendedWriteRGB,Vi.disabled,Q,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function pd(m,s){let c=[...m],f=s.cameraWorldSizeForFog/s.worldSize,y=r.ad.mat4.identity([]);return r.ad.mat4.scale(y,y,[f,f,1]),r.ad.mat4.multiply(c,y,c),r.ad.mat4.multiply(c,s.worldToFogMatrix,c),c}function bf(m,s,c,f,y){let b=c.material,E=f.context,{baseColorTexture:R,metallicRoughnessTexture:P}=b.pbrMetallicRoughness,{normalTexture:L,occlusionTexture:F,emissionTexture:j}=b;function U(ie,Q,re){if(ie&&(m.push(Q),E.activeTexture.set(E.gl.TEXTURE0+re),ie.gfxTexture)){let{minFilter:oe,magFilter:me,wrapS:Me,wrapT:Ee}=ie.sampler;ie.gfxTexture.bindExtraParam(oe,me,Me,Ee)}}U(R,"HAS_TEXTURE_u_baseColorTexture",eo.BaseColor),U(P,"HAS_TEXTURE_u_metallicRoughnessTexture",eo.MetallicRoughness),U(L,"HAS_TEXTURE_u_normalTexture",eo.Normal),U(F,"HAS_TEXTURE_u_occlusionTexture",eo.Occlusion),U(j,"HAS_TEXTURE_u_emissionTexture",eo.Emission),y&&(y.texture||(y.texture=new r.dn(f.context,y.image,[y.image.height,y.image.height,y.image.height],E.gl.RGBA8)),E.activeTexture.set(E.gl.TEXTURE0+eo.LUT),y.texture&&y.texture.bind(E.gl.LINEAR,E.gl.CLAMP_TO_EDGE),m.push("APPLY_LUT_ON_GPU")),c.texcoordBuffer&&(m.push("HAS_ATTRIBUTE_a_uv_2f"),s.push(c.texcoordBuffer)),c.colorBuffer&&(m.push(c.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),s.push(c.colorBuffer)),c.normalBuffer&&(m.push("HAS_ATTRIBUTE_a_normal_3f"),s.push(c.normalBuffer)),c.pbrBuffer&&(m.push("HAS_ATTRIBUTE_a_pbr"),m.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),s.push(c.pbrBuffer)),b.alphaMode!=="OPAQUE"&&b.alphaMode!=="MASK"||m.push("UNPREMULT_TEXTURE_IN_SHADER"),b.defined||m.push("DIFFUSE_SHADED");let W=f.shadowRenderer;W&&(m.push("RENDER_SHADOWS","DEPTH_TEXTURE"),W.useNormalOffset&&m.push("NORMAL_OFFSET"))}function fd(m,s,c,f,y,b){let E=c.paint.get("model-opacity").constantOr(1),R=s.context,P=new xi(s.context.gl.LEQUAL,xi.ReadWrite,s.depthRangeFor3D),L=s.transform,F=m.mesh,j=F.material,U=j.pbrMetallicRoughness,W=s.style.fog,ie;ie=s.transform.projection.zAxisUnit==="pixels"?[...m.nodeModelMatrix]:r.ad.mat4.multiply([],f.zScaleMatrix,m.nodeModelMatrix),r.ad.mat4.multiply(ie,f.negCameraPosMatrix,ie);let Q=r.ad.mat4.invert([],ie);r.ad.mat4.transpose(Q,Q);let re=c.paint.get("model-color-use-theme").constantOr("default")==="none",oe=c.paint.get("model-emissive-strength").constantOr(0),me=ub(new Float32Array(m.worldViewProjection),new Float32Array(ie),new Float32Array(Q),null,s,E,U.baseColorFactor.toRenderColor(null),j.emissiveFactor,U.metallicFactor,U.roughnessFactor,j,oe,c),Me={defines:[]},Ee=[],Le=s.shadowRenderer;Le&&(Le.useNormalOffset=!1),bf(Me.defines,Ee,F,s,re?null:c.lut);let Ie=null;if(W){let Ve=pd(m.nodeModelMatrix,s.transform);if(Ie=new Float32Array(Ve),L.projection.name!=="globe"){let qe=F.aabb.min,dt=F.aabb.max,[nt,Et]=W.getOpacityForBounds(Ve,qe[0],qe[1],dt[0],dt[1]);Me.overrideFog=nt>=Yt||Et>=Yt}}let Ae=rc(s,c.paint.get("model-cutoff-fade-range"));Ae.shouldRenderCutoff&&Me.defines.push("RENDER_CUTOFF");let Re=s.getOrCreateProgram("model",Me);s.uploadCommonUniforms(R,Re,null,Ie,Ae),s.renderPass!=="shadow"&&Le&&Le.setupShadowsFromMatrix(m.nodeModelMatrix,Re),Re.draw(s,R.gl.TRIANGLES,P,y,b,F.material.doubleSided?Vi.disabled:Vi.backCCW,me,c.id,F.vertexBuffer,F.indexBuffer,F.segments,c.paint,s.transform.zoom,void 0,Ee)}function cp(m,s,c,f,y,b,E){let R;R=m.projection.name==="globe"?r.dp(c,m):[...c],r.ad.mat4.multiply(R,R,s.matrix);let P=r.ad.mat4.multiply([],f,R);if(s.meshes)for(let L of s.meshes){if(L.material.alphaMode!=="BLEND"){E.push({mesh:L,depth:0,modelIndex:y,worldViewProjection:P,nodeModelMatrix:R});continue}let F=r.ad.vec3.transformMat4([],L.centroid,P);!m.isOrthographic&&F[2]<=0||b.push({mesh:L,depth:F[2],modelIndex:y,worldViewProjection:P,nodeModelMatrix:R})}if(s.children)for(let L of s.children)cp(m,L,c,f,y,b,E)}function og(m,s,c,f){let y=c.shadowRenderer;if(!y)return;let b=y.getShadowPassDepthMode(),E=y.getShadowPassColorMode(),R=y.calculateShadowPassMatrixFromMatrix(s),P=bE(R);c.getOrCreateProgram("modelDepth",{defines:c._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(c,c.context.gl.TRIANGLES,b,en.disabled,E,Vi.backCCW,P,f.id,m.vertexBuffer,m.indexBuffer,m.segments,f.paint,c.transform.zoom,void 0,void 0)}function bb(m,s,c){let f=s.updateZoomBasedPaintProperties(),y=function(b,E,R){let P,L,F,j=b.terrain?b.terrain.exaggeration():0;if(b.terrain&&j>0){let U=b.terrain,W=U.findDEMTileFor(R);W&&W.dem?P=r.dr.create(U,R,W):j=0}if(j===0&&(E.terrainElevationMin=0,E.terrainElevationMax=0),j===E.validForExaggeration&&(j===0||P&&P._demTile&&P._demTile.tileID===E.validForDEMTile.id&&P._dem._timestamp===E.validForDEMTile.timestamp))return!1;for(let U in E.instancesPerModel){let W=E.instancesPerModel[U];for(let ie=0;ie<W.instancedDataArray.length;++ie){let Q=(P?j*P.getElevationAt(0|W.instancedDataArray.float32[16*ie],0|W.instancedDataArray.float32[16*ie+1],!0,!0):0)+W.instancesEvaluatedElevation[ie];W.instancedDataArray.float32[16*ie+6]=Q,L=L?Math.min(E.terrainElevationMin,Q):Q,F=F?Math.max(E.terrainElevationMax,Q):Q}}return E.terrainElevationMin=L||0,E.terrainElevationMax=F||0,E.validForExaggeration=j,E.validForDEMTile=P&&P._demTile?{id:P._demTile.tileID,timestamp:P._dem._timestamp}:{id:void 0,timestamp:0},!0}(m,s,c);(f||y)&&(s.uploaded=!1,s.upload(m.context))}let cc={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new r.ce([0,0,0],[r.ai,r.ai,0])};function xb(m,s){let c=1<<m.canonical.z,f=s.getFreeCameraOptions().position,y=s.elevation,b=m.canonical.x/c,E=(m.canonical.x+1)/c,R=m.canonical.y/c,P=(m.canonical.y+1)/c,L=s._centerAltitude;if(y){let W=y.getMinMaxForTile(m);W&&W.max>L&&(L=W.max)}let F=r.ay(f.x,b,E)-f.x,j=r.ay(f.y,R,P)-f.y,U=r.bH(L,s.center.lat)-f.z;return s._zoomFromMercatorZ(Math.sqrt(F*F+j*j+U*U))}function Zc(m,s,c,f,y,b,E){let R=m.context,P=m.renderPass==="shadow",L=m.shadowRenderer,F=P&&L?L.getShadowPassDepthMode():new xi(R.gl.LEQUAL,xi.ReadWrite,m.depthRangeFor3D),j=m.isTileAffectedByFog(b);if(c.meshes)for(let U of c.meshes){let W=["MODEL_POSITION_ON_GPU"],ie=[],Q,re,oe;f.instancedDataArray.length>20&&W.push("INSTANCED_ARRAYS");let me=rc(m,s.paint.get("model-cutoff-fade-range"));if(me.shouldRenderCutoff&&W.push("RENDER_CUTOFF"),P&&L)Q=m.getOrCreateProgram("modelDepth",{defines:W}),re=bE(E.shadowTileMatrix,E.shadowTileMatrix,Float32Array.from(c.matrix)),oe=L.getShadowPassColorMode();else{bf(W,ie,U,m,s.paint.get("model-color-use-theme").constantOr("default")==="none"?null:s.lut),Q=m.getOrCreateProgram("model",{defines:W,overrideFog:j});let Ee=U.material,Le=Ee.pbrMetallicRoughness,Ie=s.paint.get("model-opacity").constantOr(1),Ae=s.paint.get("model-emissive-strength").constantOr(0);re=ub(b.expandedProjMatrix,Float32Array.from(c.matrix),new Float32Array(16),null,m,Ie,Le.baseColorFactor.toRenderColor(null),Ee.emissiveFactor,Le.metallicFactor,Le.roughnessFactor,Ee,Ae,s,y),L&&(E.shadowUniformsInitialized?Q.setShadowUniformValues(R,L.getShadowUniformValues()):(L.setupShadows(b.toUnwrapped(),Q,"model-tile",b.overscaledZ),E.shadowUniformsInitialized=!0)),oe=me.shouldRenderCutoff||Ie<1||Ee.alphaMode!=="OPAQUE"?_n.alphaBlended:_n.unblended}m.uploadCommonUniforms(R,Q,b.toUnwrapped(),null,me);let Me=U.material.doubleSided?Vi.disabled:Vi.backCCW;if(f.instancedDataArray.length>20)ie.push(f.instancedDataBuffer),Q.draw(m,R.gl.TRIANGLES,F,en.disabled,oe,Me,re,s.id,U.vertexBuffer,U.indexBuffer,U.segments,s.paint,m.transform.zoom,void 0,ie,f.instancedDataArray.length);else{let Ee=P?"u_instance":"u_normal_matrix";for(let Le=0;Le<f.instancedDataArray.length;++Le)re[Ee]=new Float32Array(f.instancedDataArray.arrayBuffer,64*Le,16),Q.draw(m,R.gl.TRIANGLES,F,en.disabled,oe,Me,re,s.id,U.vertexBuffer,U.indexBuffer,U.segments,s.paint,m.transform.zoom,void 0,ie)}}if(c.children)for(let U of c.children)Zc(m,s,U,f,y,b,E)}let mh=[1,-1,1];function b_(m,s,c,f){if(!c.modelManager)return!0;let y=c.modelManager;if(!c.shadowRenderer)return!0;let b=c.shadowRenderer,E=s.aabb,R=!0,P=m.maxHeight;if(P===0){let F=0;for(let j in m.instancesPerModel){let U=y.getModel(j,f);U?F=Math.max(F,Math.max(Math.max(U.aabb.max[0],U.aabb.max[1]),U.aabb.max[2])):R=!1}P=m.maxScale*F*1.41+m.maxVerticalOffset,R&&(m.maxHeight=P)}E.max[2]=P,E.min[2]+=m.terrainElevationMin,E.max[2]+=m.terrainElevationMax,r.ad.vec3.transformMat4(E.min,E.min,s.tileMatrix),r.ad.vec3.transformMat4(E.max,E.max,s.tileMatrix);let L=E.intersects(b.getCurrentCascadeFrustum());return c.currentShadowCascade===0&&(m.isInsideFirstShadowMapFrustum=L===2),L===0}function x_(m,s){let c=m.uniformValues.u_cutoff_params[0],f=m.uniformValues.u_cutoff_params[1],y=m.uniformValues.u_cutoff_params[2],b=m.uniformValues.u_cutoff_params[3];return f===c||b===y?1:r.ay(((s-c)/(f-c)-y)/(b-y),0,1)}function wb(m,s,c,f){if(s.pitch<20)return 1;let y=s.getWorldToCameraMatrix();r.ad.mat4.multiply(y,y,m);let b=r.ad.vec4.fromValues(c.min[0],c.min[1],c.min[2],1),E=r.ad.vec4.transformMat4(r.ad.vec4.create(),b,y),R=E,P=E;b[1]=c.max[1],E=r.ad.vec4.transformMat4(r.ad.vec4.create(),b,y),R=E[1]<R[1]?E:R,P=E[1]>P[1]?E:P,b[0]=c.max[0],E=r.ad.vec4.transformMat4(r.ad.vec4.create(),b,y),R=E[1]<R[1]?E:R,P=E[1]>P[1]?E:P,b[1]=c.min[1],E=r.ad.vec4.transformMat4(r.ad.vec4.create(),b,y),R=E[1]<R[1]?E:R,P=E[1]>P[1]?E:P;let L=r.ay(f[0],0,1),F=100*s.pixelsPerMeter*r.ay(f[1],0,1),j=r.ay(f[2],0,1),U=r.ad.vec4.lerp(r.ad.vec4.create(),R,P,L),W=Math.tan(.5*s.fovX),ie=-U[2]*W;if(F===0)return U[1]<-Math.abs(ie)?j:1;let Q=(-Math.abs(ie)-U[1])/F,re=(me,Me,Ee)=>(1-Ee)*me+Ee*Me,oe=r.ay(re(1,j,Q),j,1);return re(1,oe,r.ay((s.pitch-20)/20,0,1))}class Eb{}class up{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(s,c,f){{let j=this._storage.get(c.id);if(j)return j.lastUsedFrameIdx=s,j.buf}let y=f.gl,b=y.getBufferParameter(y.ELEMENT_ARRAY_BUFFER,y.BUFFER_SIZE),E=new ArrayBuffer(b),R=new Int16Array(E);y.getBufferSubData(y.ELEMENT_ARRAY_BUFFER,0,new Int16Array(E));let P=new r.dt;for(let j=0;j<b/2;j+=3){let U=R[j],W=R[j+1],ie=R[j+2];P.emplaceBack(U,W),P.emplaceBack(W,ie),P.emplaceBack(ie,U)}let L=f.bindVertexArrayOES.current,F=new Eb;return F.buf=new p_(f,P),F.lastUsedFrameIdx=s,this._storage.set(c.id,F),f.bindVertexArrayOES.set(L),F.buf}update(s){for(let[c,f]of this._storage)s-f.lastUsedFrameIdx>30&&(f.buf.destroy(),this._storage.delete(c))}destroy(){for(let[s,c]of this._storage)c.buf.destroy(),this._storage.delete(s)}}class Cb{constructor(s){this.occluderSize=30,this.depthOffset=-1e-4,s.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),s.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}let gh=r.dd([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class Sb{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class ag{constructor(s,c){this.revealStart=11,this.revealRange=2,s.registerParameter(this,[...c,"Reveal"],"revealStart",{min:0,max:17,step:.05}),s.registerParameter(this,[...c,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}let Tb=r.dd([{type:"Float32",name:"a_pos_2f",components:2}]);class Db{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(s,c){let f=s.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){let E=new r.du,R=new r.aV;E.emplaceBack(-1,-1),E.emplaceBack(1,-1),E.emplaceBack(1,1),E.emplaceBack(-1,1),R.emplaceBack(0,1,2),R.emplaceBack(0,2,3),this.vignetteVx=s.context.createVertexBuffer(E,Tb.members),this.vignetteIdx=s.context.createIndexBuffer(R)}let y=r.b8.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){s.uploadCommonUniforms(s.context,f);let E={u_vignetteShape:(b={vignetteShape:[c.start,c.range,Math.pow(10,c.fadePower)],vignetteColor:[c.color.r,c.color.g,c.color.b,c.color.a*c.strength]}).vignetteShape,u_vignetteColor:b.vignetteColor};f.draw(s,s.context.gl.TRIANGLES,xi.disabled,en.disabled,_n.alphaBlended,Vi.disabled,E,"vignette",this.vignetteVx,this.vignetteIdx,y)}var b}}class Ra{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(s,c){let f=s.getFreeCameraOptions().position,y=f.toAltitude(),b=f.toLngLat(),E=r.ak(b.lng),R=r.ak(b.lat),P=s.pixelsPerMeter/c,L=E*r.dv,F=r.dv*Math.log(Math.tan(Math.PI/4+R/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{let j=-this._offsetYPrev+F,U=-this._elevationPrev+y;this._accumulatedOffsetX+=(-this._offsetXPrev+L)*P,this._accumulatedOffsetY+=j*P,this._accumulatedElevation+=U*P,this._offsetXPrev=L,this._offsetYPrev=F,this._elevationPrev=y}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function w_(m,s){return[-(m[0]-Math.floor(m[0]/s)*s),-(m[1]-Math.floor(m[1]/s)*s),-(m[2]-Math.floor(m[2]/s)*s)]}function E_(m){let s=r.dl(1323123451230),c=[];for(let f=0;f<m;++f){let y=2*s()-1,b=2*s()-1,E=2*s()-1;c.push(r.ad.vec3.fromValues(y,b,E))}return c}function ll(m,s,c,f,y){let b=r.ay((y-c)/(f-c),0,1);return(1-b)*m+b*s}class C_{constructor(s){this._movement=new Ra,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new Db,this._ppmScaleFactor=s}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(s,c){let f=s.transform;this._movement.update(f,this._ppmScaleFactor);let y=f.starsProjMatrix,b=r.ad.quat.identity([]);r.ad.quat.rotateX(b,b,r.ak(90)-f._pitch),r.ad.quat.rotateZ(b,b,-f.angle);let E=r.ad.mat4.fromQuat(new Float32Array(16),b),R=r.ad.mat4.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),P=r.ad.mat4.transpose([],R),L=r.ad.mat4.multiply([],P,E),F=Date.now()/1e3;return this._accumulatedTimeFromStart+=(F-this._prevTime)*c,this._prevTime=F,{projectionMatrix:y,modelviewMatrix:L}}}class Mb extends C_{constructor(s){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new ag(s.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(s){let c=s.context;if(!this.particlesVx){let f=E_(this.particlesCount),y=new r.dw,b=new r.aV,E=0,R=r.dl(1323123451230);for(let P=0;P<f.length;++P){let L=f[P],F=[2*R()-1,R(),R(),R()];y.emplaceBack(L[0],L[1],L[2],-1,-1,...F),y.emplaceBack(L[0],L[1],L[2],1,-1,...F),y.emplaceBack(L[0],L[1],L[2],1,1,...F),y.emplaceBack(L[0],L[1],L[2],-1,1,...F),b.emplaceBack(E+0,E+1,E+2),b.emplaceBack(E+0,E+2,E+3),E+=4}this.particlesVx=c.createVertexBuffer(y,gh.members),this.particlesIdx=c.createIndexBuffer(b)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.rain)return;let c=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},f=s.transform.zoom;if(c.revealStart>f)return;let y=ll(0,1,c.revealStart,c.revealStart+c.revealRange,f);if(!this.particlesVx||!this.particlesIdx)return;let b=structuredClone(this._params),E=[-b.direction.x,b.direction.y,-100];r.ad.vec3.normalize(E,E);let R=structuredClone(this._vignetteParams);R.strength*=y,b.overrideStyleParameters||(b.intensity=s.style.rain.state.density,b.timeFactor=s.style.rain.state.intensity,b.color=structuredClone(s.style.rain.state.color),E=structuredClone(s.style.rain.state.direction),b.screenThinning.intensity=s.style.rain.state.centerThinning,b.dropletSizeX=s.style.rain.state.dropletSize[0],b.dropletSizeYScale=s.style.rain.state.dropletSize[1]/s.style.rain.state.dropletSize[0],b.distortionStrength=100*s.style.rain.state.distortionStrength,R.strength=1,R.color=structuredClone(s.style.rain.state.vignetteColor));let P=this.updateOnRender(s,b.timeFactor),L=s.context,F=L.gl,j=s.transform;this.screenTexture&&this.screenTexture.size[0]===s.width&&this.screenTexture.size[1]===s.height||(this.screenTexture=new r.T(L,{width:s.width,height:s.height,data:null},F.RGBA8)),b.distortionStrength>0&&(L.activeTexture.set(F.TEXTURE0),this.screenTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),F.copyTexSubImage2D(F.TEXTURE_2D,0,0,0,0,0,s.width,s.height));let U=s.getOrCreateProgram("rainParticle");s.uploadCommonUniforms(L,U),L.activeTexture.set(F.TEXTURE0),this.screenTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE);let W=[b.color.r,b.color.g,b.color.b,b.color.a],ie=(Q,re)=>{let oe=w_(this._movement.getPosition(),Q),me=b.dropletSizeX,Me=b.dropletSizeX*b.dropletSizeYScale,Ee=s.width/2,Le=s.height/2,Ie=ll(0,b.screenThinning.start,0,1,b.screenThinning.intensity),Ae=ll(.001,b.screenThinning.range,0,1,b.screenThinning.intensity),Re=ll(0,b.screenThinning.particleOffset,0,1,b.screenThinning.intensity),Ve=(qe={modelview:P.modelviewMatrix,projection:P.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:oe,velocityConeAperture:b.velocityConeAperture,velocity:b.velocity,boxSize:Q,rainDropletSize:[me,Me],distortionStrength:b.distortionStrength,rainDirection:E,color:W,screenSize:[j.width,j.height],thinningCenterPos:[Ee,Le],thinningShape:[Ie,Ae,Math.pow(10,b.screenThinning.fadePower)],thinningAffectedRatio:b.screenThinning.affectedRatio,thinningParticleOffset:Re,shapeDirectionalPower:b.shapeDirPower,shapeNormalPower:b.shapeNormalPower,mode:re?0:1},{u_modelview:Float32Array.from(qe.modelview),u_projection:Float32Array.from(qe.projection),u_time:qe.time,u_cam_pos:qe.camPos,u_texScreen:0,u_velocityConeAperture:qe.velocityConeAperture,u_velocity:qe.velocity,u_boxSize:qe.boxSize,u_rainDropletSize:qe.rainDropletSize,u_distortionStrength:qe.distortionStrength,u_rainDirection:qe.rainDirection,u_color:qe.color,u_screenSize:qe.screenSize,u_thinningCenterPos:qe.thinningCenterPos,u_thinningShape:qe.thinningShape,u_thinningAffectedRatio:qe.thinningAffectedRatio,u_thinningParticleOffset:qe.thinningParticleOffset,u_shapeDirectionalPower:qe.shapeDirectionalPower,u_shapeNormalPower:qe.shapeNormalPower,u_mode:qe.mode});var qe;let dt=Math.round(b.intensity*this.particlesCount),nt=r.b8.simpleSegment(0,0,4*dt,2*dt);U.draw(s,F.TRIANGLES,xi.disabled,en.disabled,_n.alphaBlended,Vi.disabled,Ve,"rain_particles",this.particlesVx,this.particlesIdx,nt)};b.distortionStrength>0&&ie(b.boxSize,!0),ie(b.boxSize,!1),this._vignette.draw(s,R)}}let Ib=r.dd([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class xf extends C_{constructor(s){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new ag(s.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(s){let c=s.context;if(!this.particlesVx){let f=E_(this.particlesCount),y=new r.dx,b=new r.aV,E=0,R=r.dl(1323123451230);for(let P=0;P<f.length;++P){let L=f[P],F=R(),j=R(),U=R(),W=[P/f.length,F,j,U],ie=[R(),R()];y.emplaceBack(L[0],L[1],L[2],-1,-1,...W,...ie),y.emplaceBack(L[0],L[1],L[2],1,-1,...W,...ie),y.emplaceBack(L[0],L[1],L[2],1,1,...W,...ie),y.emplaceBack(L[0],L[1],L[2],-1,1,...W,...ie),b.emplaceBack(E+0,E+1,E+2),b.emplaceBack(E+0,E+2,E+3),E+=4}this.particlesVx=c.createVertexBuffer(y,Ib.members),this.particlesIdx=c.createIndexBuffer(b)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.snow)return;let c=structuredClone(this._params),f=[-c.direction.x,c.direction.y,-100];r.ad.vec3.normalize(f,f);let y=structuredClone(this._vignetteParams),b=c.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},E=s.transform.zoom;if(b.revealStart>E)return;let R=ll(0,1,b.revealStart,b.revealStart+b.revealRange,E);y.strength*=R,c.overrideStyleParameters||(c.intensity=s.style.snow.state.density,c.timeFactor=s.style.snow.state.intensity,c.color=structuredClone(s.style.snow.state.color),f=structuredClone(s.style.snow.state.direction),c.screenThinning.intensity=s.style.snow.state.centerThinning,c.billboardSize=2.79*s.style.snow.state.flakeSize,y.strength=1,y.color=structuredClone(s.style.snow.state.vignetteColor));let P=this.updateOnRender(s,c.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;let L=s.context,F=L.gl,j=s.transform,U=s.getOrCreateProgram("snowParticle");s.uploadCommonUniforms(L,U),((W,ie,Q)=>{let re=w_(this._movement.getPosition(),W),oe=j.width/2,me=j.height/2,Me=ll(0,Q.screenThinning.start,0,1,Q.screenThinning.intensity),Ee=ll(.001,Q.screenThinning.range,0,1,Q.screenThinning.intensity),Le=ll(0,Q.screenThinning.particleOffset,0,1,Q.screenThinning.intensity),Ie=(Ae={modelview:P.modelviewMatrix,projection:P.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:re,velocityConeAperture:Q.velocityConeAperture,velocity:Q.velocity,horizontalOscillationRadius:Q.horizontalOscillationRadius,horizontalOscillationRate:Q.horizontalOscillationRate,boxSize:W,billboardSize:1*Q.billboardSize,simpleShapeParameters:[Q.shapeFadeStart,Q.shapeFadePower],screenSize:[j.width,j.height],thinningCenterPos:[oe,me],thinningShape:[Me,Ee,Math.pow(10,Q.screenThinning.fadePower)],thinningAffectedRatio:Q.screenThinning.affectedRatio,thinningParticleOffset:Le,color:[Q.color.r,Q.color.g,Q.color.b,Q.color.a],direction:f},{u_modelview:Float32Array.from(Ae.modelview),u_projection:Float32Array.from(Ae.projection),u_time:Ae.time,u_cam_pos:Ae.camPos,u_velocityConeAperture:Ae.velocityConeAperture,u_velocity:Ae.velocity,u_horizontalOscillationRadius:Ae.horizontalOscillationRadius,u_horizontalOscillationRate:Ae.horizontalOscillationRate,u_boxSize:Ae.boxSize,u_billboardSize:Ae.billboardSize,u_simpleShapeParameters:Ae.simpleShapeParameters,u_screenSize:Ae.screenSize,u_thinningCenterPos:Ae.thinningCenterPos,u_thinningShape:Ae.thinningShape,u_thinningAffectedRatio:Ae.thinningAffectedRatio,u_thinningParticleOffset:Ae.thinningParticleOffset,u_particleColor:Ae.color,u_direction:Ae.direction});var Ae;let Re=Math.round(Q.intensity*this.particlesCount),Ve=r.b8.simpleSegment(0,0,4*Re,2*Re);this.particlesVx&&this.particlesIdx&&U.draw(s,F.TRIANGLES,xi.disabled,en.disabled,_n.alphaBlended,Vi.disabled,Ie,"snow_particles",this.particlesVx,this.particlesIdx,Ve)})(c.boxSize,0,c),this._vignette.draw(s,y)}}let sg={symbol:function(m,s,c,f,y){if(m.renderPass!=="translucent")return;let b=en.disabled,E=m.colorModeForRenderPass(),R=c.layout.get("text-variable-anchor"),P=c.layout.get("text-size-scale-range"),L=r.ay(m.scaleFactor,P[0],P[1]);R&&function(U,W,ie,Q,re,oe,me,Me){let Ee=W.transform,Le=re==="map",Ie=oe==="map";for(let Ae of U){let Re=Q.getTile(Ae),Ve=Re.getBucket(ie);if(!Ve||!Ve.text||!Ve.text.segments.get().length)continue;let qe=r.bp(Ve.textSizeData,Ee.zoom,Me),dt=Us(Ae,Ve.getProjection(),Ee),nt=Ee.calculatePixelsToTileUnitsMatrix(Re),Et=Lc(dt,Re.tileID.canonical,Ie,Le,Ee,Ve.getProjection(),nt),Ct=Ve.hasIconTextFit()&&Ve.hasIconData();if(qe){let Ut=Math.pow(2,Ee.zoom-Re.tileID.overscaledZ);lc(Ve,Le,Ie,me,r.cY,Ee,Et,Ae,Ut,qe,Ct)}}}(f,m,c,s,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),y,L);let F=c.paint.get("icon-opacity").constantOr(1)!==0,j=c.paint.get("text-opacity").constantOr(1)!==0;c.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(F||j)?Ar(m,s,c,f,b,E):(F&&Ar(m,s,c,f,b,E,{onlyIcons:!0}),j&&Ar(m,s,c,f,b,E,{onlyText:!0})),s.map.showCollisionBoxes&&(f_(m,s,c,f,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),f_(m,s,c,f,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(m,s,c,f){if(m.renderPass!=="translucent")return;let y=c.paint.get("circle-opacity"),b=c.paint.get("circle-stroke-width"),E=c.paint.get("circle-stroke-opacity"),R=c.layout.get("circle-sort-key").constantOr(1)!==void 0,P=c.paint.get("circle-emissive-strength");if(y.constantOr(1)===0&&(b.constantOr(1)===0||E.constantOr(1)===0))return;let L=m.context,F=L.gl,j=m.transform,U=m.depthModeForSublayer(0,xi.ReadOnly),W=en.disabled,ie=m.colorModeForDrapableLayerRenderPass(P),Q=j.projection.name==="globe",re=[r.av(j.center.lng),r.aC(j.center.lat)],oe=[];for(let Me=0;Me<f.length;Me++){let Ee=f[Me],Le=s.getTile(Ee),Ie=Le.getBucket(c);if(!Ie||Ie.projection.name!==j.projection.name)continue;let Ae=Ie.programConfigurations.get(c.id),Re=r.cZ(c),Ve=m.isTileAffectedByFog(Ee);Q&&Re.push("PROJECTION_GLOBE_VIEW"),Re.push("DEPTH_D24"),m.terrain&&j.depthOcclusionForSymbolsAndCircles&&Re.push("DEPTH_OCCLUSION");let qe=m.getOrCreateProgram("circle",{config:Ae,defines:Re,overrideFog:Ve}),dt=Ie.layoutVertexBuffer,nt=Ie.globeExtVertexBuffer,Et=Ie.indexBuffer,Ct=j.projection.createInversionMatrix(j,Ee.canonical),Ut={programConfiguration:Ae,program:qe,layoutVertexBuffer:dt,globeExtVertexBuffer:nt,indexBuffer:Et,uniformValues:r.c_(m,Ee,Le,Ct,re,c),tile:Le};if(R){let tt=Ie.segments.get();for(let xt of tt)oe.push({segments:new r.b8([xt]),sortKey:xt.sortKey,state:Ut})}else oe.push({segments:Ie.segments,sortKey:0,state:Ut})}R&&oe.sort((Me,Ee)=>Me.sortKey-Ee.sortKey);let me={useDepthForOcclusion:j.depthOcclusionForSymbolsAndCircles};for(let Me of oe){let{programConfiguration:Ee,program:Le,layoutVertexBuffer:Ie,globeExtVertexBuffer:Ae,indexBuffer:Re,uniformValues:Ve,tile:qe}=Me.state,dt=Me.segments;m.terrain&&m.terrain.setupElevationDraw(qe,Le,me),m.uploadCommonUniforms(L,Le,qe.tileID.toUnwrapped()),Le.draw(m,F.TRIANGLES,U,W,ie,Vi.disabled,Ve,c.id,Ie,Re,dt,c.paint,j.zoom,Ee,[Ae])}},heatmap:function(m,s,c,f){if(c.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){let y=m.context,b=y.gl,E=en.disabled,R=new _n([b.ONE,b.ONE,b.ONE,b.ONE],r.al.transparent,[!0,!0,!0,!0]);(function(W,ie,Q,re){let oe=W.gl,me=ie.width*re,Me=ie.height*re;W.activeTexture.set(oe.TEXTURE1),W.viewport.set([0,0,me,Me]);let Ee=Q.heatmapFbo;if(!Ee||Ee&&(Ee.width!==me||Ee.height!==Me)){Ee&&Ee.destroy();let Le=oe.createTexture();oe.bindTexture(oe.TEXTURE_2D,Le),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_WRAP_S,oe.CLAMP_TO_EDGE),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_WRAP_T,oe.CLAMP_TO_EDGE),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_MIN_FILTER,oe.LINEAR),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_MAG_FILTER,oe.LINEAR),Ee=Q.heatmapFbo=W.createFramebuffer(me,Me,!0,null),function(Ie,Ae,Re,Ve,qe,dt){let nt=Ie.gl;nt.texImage2D(nt.TEXTURE_2D,0,Ie.extRenderToTextureHalfFloat?nt.RGBA16F:nt.RGBA,qe,dt,0,nt.RGBA,Ie.extRenderToTextureHalfFloat?nt.HALF_FLOAT:nt.UNSIGNED_BYTE,null),Ve.colorAttachment.set(Re)}(W,0,Le,Ee,me,Me)}else oe.bindTexture(oe.TEXTURE_2D,Ee.colorAttachment.get()),W.bindFramebuffer.set(Ee.framebuffer)})(y,m,c,m.transform.projection.name==="globe"?.5:.25),y.clear({color:r.al.transparent});let P=m.transform,L=P.projection.name==="globe",F=L?["PROJECTION_GLOBE_VIEW"]:[],j=L?Vi.frontCCW:Vi.disabled,U=[r.av(P.center.lng),r.aC(P.center.lat)];for(let W=0;W<f.length;W++){let ie=f[W];if(s.hasRenderableParent(ie))continue;let Q=s.getTile(ie),re=Q.getBucket(c);if(!re||re.projection.name!==P.projection.name)continue;let oe=m.isTileAffectedByFog(ie),me=re.programConfigurations.get(c.id),Me=m.getOrCreateProgram("heatmap",{config:me,defines:F,overrideFog:oe}),{zoom:Ee}=m.transform;m.terrain&&m.terrain.setupElevationDraw(Q,Me),m.uploadCommonUniforms(y,Me,ie.toUnwrapped());let Le=P.projection.createInversionMatrix(P,ie.canonical);Me.draw(m,b.TRIANGLES,xi.disabled,E,R,j,u_(m,ie,Q,Le,U,Ee,c.paint.get("heatmap-intensity")),c.id,re.layoutVertexBuffer,re.indexBuffer,re.segments,c.paint,m.transform.zoom,me,L?[re.globeExtVertexBuffer]:null)}y.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(y,b){let E=y.context,R=E.gl,P=b.heatmapFbo;if(!P)return;E.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,P.colorAttachment.get()),E.activeTexture.set(R.TEXTURE1);let L=b.colorRampTexture;L||(L=b.colorRampTexture=new r.T(E,b.colorRamp,R.RGBA8)),L.bind(R.LINEAR,R.CLAMP_TO_EDGE),y.getOrCreateProgram("heatmapTexture").draw(y,R.TRIANGLES,xi.disabled,en.disabled,y.colorModeForRenderPass(),Vi.disabled,((F,j,U,W)=>({u_image:0,u_color_ramp:1,u_opacity:j.paint.get("heatmap-opacity")}))(0,b),b.id,y.viewportBuffer,y.quadTriangleIndexBuffer,y.viewportSegments,b.paint,y.transform.zoom)}(m,c))},line:function(m,s,c,f){if(m.renderPass!=="translucent")return;let y=c.paint.get("line-opacity"),b=c.paint.get("line-width");if(y.constantOr(1)===0||b.constantOr(1)===0)return;let E=c.paint.get("line-emissive-strength"),R=c.paint.get("line-occlusion-opacity"),P=c.layout.get("line-elevation-reference"),L=c.layout.get("line-width-unit")==="meters",F=P==="sea",j=m.context,U=j.gl;if(c.hasElevatedBuckets&&m.transform.projection.name==="globe")return;let W=c.layout.get("line-cross-slope"),ie=W!==void 0,Q=W<1,re=m.colorModeForDrapableLayerRenderPass(E),oe=m.terrain&&m.terrain.renderingToTexture,me=oe?1:r.q.devicePixelRatio,Me=c.paint.get("line-dasharray"),Ee=Me.constantOr(1),Le=c.layout.get("line-cap"),Ie=Me.constantOr(null),Ae=Le.constantOr(null),Re=c.paint.get("line-pattern"),Ve=Re.constantOr(1),qe=Re.constantOr(null),dt=c.paint.get("line-opacity").constantOr(1),nt=!Ve&&dt!==1||m.depthOcclusion&&R>0&&R<1,Et=c.paint.get("line-gradient"),Ct=Ve?"linePattern":"line",Ut=r.c$(c),tt;if(oe&&m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(nt=!1),R!==0&&m.depthOcclusion){let Qe=c.paint._values["line-opacity"];Qe&&Qe.value&&Qe.value.kind==="constant"?tt=Qe.value:r.w(`Occlusion opacity for layer ${c.id} is supported only when line-opacity isn't data-driven.`)}b.value.kind!=="constant"&&b.value.isLineProgressConstant===!1&&Ut.push("VARIABLE_LINE_WIDTH");let xt=(Qe,bt,_t,St,ht,At)=>{for(let Kt of Qe){let Xt=s.getTile(Kt);if(Ve&&!Xt.patternsLoaded())continue;let Qt=Xt.getBucket(c);if(!Qt||Qt.hasZOffset&&!ht||!Qt.hasZOffset&&ht)continue;m.prepareDrawTile();let _i=Qt.programConfigurations.get(c.id),tn=m.isTileAffectedByFog(Kt),ki=m.getOrCreateProgram(Ct,{config:_i,defines:bt,overrideFog:tn,overrideRtt:!ht&&void 0});if(qe&&Xt.imageAtlas){let on=r.d0.from(qe).getPrimary().scaleSelf(me).toString(),yi=Xt.imageAtlas.patternPositions.get(on);yi&&_i.setConstantPatternPositions(yi)}if(!Ve&&Ie&&Ae&&Xt.lineAtlas){let on=Xt.lineAtlas.getDash(Ie,Ae);on&&_i.setConstantPatternPositions(on)}let[Ki,Fi]=c.paint.get("line-trim-offset");(Ae==="round"||Ae==="square")&&Ki!==Fi&&(Ki===0&&(Ki-=1),Fi===1&&(Fi+=1));let An=oe?Kt.projMatrix:null,tr=L?1/Qt.tileToMeter/r.at(Xt,1,m.transform.zoom):1,Lr=L?1/Qt.tileToMeter/r.at(Xt,1,Math.floor(m.transform.zoom)):1,vn=Ve?r.d1(m,Xt,c,An,me,tr,Lr,[Ki,Fi]):r.d2(m,Xt,c,An,Qt.lineClipsArray.length,me,tr,Lr,[Ki,Fi]);if(Et){let on=Qt.gradients[c.id],yi=on.texture;if(c.gradientVersion!==on.version){let Pn=256;if(c.stepInterpolant){let dr=s.getSource().maxzoom,Yn=Kt.canonical.z===dr?Math.ceil(1<<m.transform.maxZoom-Kt.canonical.z):1;Pn=r.ay(r.d3(Qt.maxLineLength/r.ai*1024*Yn),256,j.maxTextureSize)}on.gradient=r.d4({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:Pn,image:on.gradient||void 0,clips:Qt.lineClipsArray}),on.texture?on.texture.update(on.gradient):on.texture=new r.T(j,on.gradient,U.RGBA8),on.version=c.gradientVersion,yi=on.texture}j.activeTexture.set(U.TEXTURE1),yi.bind(c.stepInterpolant?U.NEAREST:U.LINEAR,U.CLAMP_TO_EDGE)}Ee&&(j.activeTexture.set(U.TEXTURE0),Xt.lineAtlasTexture&&Xt.lineAtlasTexture.bind(U.LINEAR,U.REPEAT),_i.updatePaintBuffers()),Ve&&(j.activeTexture.set(U.TEXTURE0),Xt.imageAtlasTexture&&Xt.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),_i.updatePaintBuffers()),ht&&!F&&m.terrain.setupElevationDraw(Xt,ki),m.uploadCommonUniforms(j,ki,Kt.toUnwrapped());let Yr=on=>{tt!=null&&(tt.value=dt*R),ki.draw(m,U.TRIANGLES,_t,on,re,Vi.disabled,vn,c.id,Qt.layoutVertexBuffer,Qt.indexBuffer,Qt.segments,c.paint,m.transform.zoom,_i,[Qt.layoutVertexBuffer2,Qt.patternVertexBuffer,Qt.zOffsetVertexBuffer]),tt!=null&&(tt.value=dt)};if(nt&&!ht){let on=m.stencilModeForClipping(Kt).ref;on===0&&oe&&j.clear({stencil:0});let yi={func:U.EQUAL,mask:255};vn.u_alpha_discard_threshold=.8,Yr(new en(yi,on,255,U.KEEP,U.KEEP,U.INVERT)),vn.u_alpha_discard_threshold=0,Yr(new en(yi,on,255,U.KEEP,U.KEEP,U.KEEP))}else vn.u_alpha_discard_threshold=nt&&ht&&At?.8:0,Yr(ht?St:m.stencilModeForClipping(Kt))}};if(c.hasNonElevatedBuckets){let Qe=!oe&&m.terrain;R!==0&&Qe?r.w(`Occlusion opacity for layer ${c.id} is supported on terrain only if the layer has line-z-offset enabled.`):Qe?r.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${c.id}.`):xt(f,Ut,m.depthModeForSublayer(0,xi.ReadOnly),en.disabled,!1,!0)}if(c.hasElevatedBuckets){Ut.push("ELEVATED"),ie&&Ut.push(Q?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),F&&Ut.push("ELEVATION_REFERENCE_SEA");let Qe=nt?m.stencilModeFor3D():en.disabled,bt=new xi(m.depthOcclusion?U.GREATER:U.LEQUAL,xi.ReadOnly,m.depthRangeFor3D);m.forceTerrainMode=!0,xt(f,Ut,bt,Qe,!0,!0),nt&&xt(f,Ut,bt,Qe,!0,!1),m.forceTerrainMode=!1}nt&&(m.resetStencilClippingMasks(),oe&&j.clear({stencil:0})),R===0||m.depthOcclusion||oe||m.layersWithOcclusionOpacity.push(m.currentLayer)},fill:function(m,s,c,f){let y=c.paint.get("fill-color"),b=c.paint.get("fill-opacity");if(b.constantOr(1)===0)return;let E=c.paint.get("fill-emissive-strength"),R=m.colorModeForDrapableLayerRenderPass(E),P=c.paint.get("fill-pattern"),L=m.opaquePassEnabledForLayer()&&!P.constantOr(1)&&y.constantOr(r.al.transparent).a===1&&b.constantOr(0)===1?"opaque":"translucent",F="none";c.layout.get("fill-elevation-reference")!=="none"?F="road":c.paint.get("fill-z-offset").constantOr(1)!==0&&(F="offset");let j=!(!m.terrain||!m.terrain.enabled),U={painter:m,sourceCache:s,layer:c,coords:f,colorMode:R,elevationType:F,terrainEnabled:j,pass:L};if(F!=="offset"){if(g_(U,!1),F==="road"){let W=!j&&m.renderPass==="translucent";W&&mb(m,s,c,f,"geometry"),g_(U,!0,en.disabled),W&&function(ie){let{painter:Q,sourceCache:re,layer:oe,coords:me,colorMode:Me}=ie,Ee=Q.context.gl,Le=new xi(Q.context.gl.LEQUAL,xi.ReadOnly,Q.depthRangeFor3D);for(let Ie of me){let Ae=re.getTile(Ie),Re=Ae.getBucket(oe);if(!Re)continue;let Ve=Re.elevatedStructures;if(!Ve||!Ve.renderableSegments||Ve.renderableSegments.segments[0].primitiveLength===0)continue;Q.prepareDrawTile();let qe=Re.bufferData.programConfigurations.get(oe.id),dt=Q.isTileAffectedByFog(Ie),nt=Q.getOrCreateProgram("elevatedStructures",{config:qe,overrideFog:dt,defines:["NORMAL_OFFSET"]}),Et={u_matrix:Q.translatePosMatrix(Ie.projMatrix,Ae,oe.paint.get("fill-translate"),oe.paint.get("fill-translate-anchor"))};Q.uploadCommonUniforms(Q.context,nt,Ie.toUnwrapped()),nt.draw(Q,Ee.TRIANGLES,Le,en.disabled,Me,Vi.backCCW,Et,oe.id,Ve.vertexBuffer,Ve.indexBuffer,Ve.renderableSegments,oe.paint,Q.transform.zoom,qe,[Ve.vertexBufferNormal])}}(U)}}else g_(U,!1,m.stencilModeFor3D())},"fill-extrusion":function(m,s,c,f){let y=c.paint.get("fill-extrusion-opacity"),b=m.context,E=b.gl,R=m.terrain,P=R&&R.renderingToTexture;if(y===0)return;let L=m.conflationActive&&m.style.isLayerClipped(c,s.getSource()),F=m.style.order.indexOf(c.fqid);if(L&&function(j,U,W,ie,Q){for(let re of ie){let oe=U.getTile(re).getBucket(W);oe&&(oe.updateReplacement(re,j.replacementSource,Q),oe.uploadCentroid(j.context))}}(m,s,c,f,F),R||L)for(let j of f){let U=s.getTile(j).getBucket(c);U&&mf(m.context,s,j,U,c,R,L)}if(m.renderPass==="shadow"&&m.shadowRenderer){let j=m.shadowRenderer;if(R&&y<.65&&c._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof r.ab)return;let U=j.getShadowPassDepthMode(),W=j.getShadowPassColorMode();ng(m,s,c,f,U,en.disabled,W,L)}else if(m.renderPass==="translucent"){let j=!c.paint.get("fill-extrusion-pattern").constantOr(1),U=c.paint.get("fill-extrusion-color").constantOr(r.al.white);if(!P&&U.a!==0){let W=new xi(m.context.gl.LEQUAL,xi.ReadWrite,m.depthRangeFor3D);y===1&&j?ng(m,s,c,f,W,en.disabled,_n.unblended,L):(ng(m,s,c,f,W,en.disabled,_n.disabled,L),ng(m,s,c,f,W,m.stencilModeFor3D(),m.colorModeForRenderPass(),L),m.resetStencilClippingMasks())}if(m.style.enable3dLights()&&j&&(!R&&m.transform.projection.name!=="globe"||P)){let W=c.paint.get("fill-extrusion-opacity"),ie=c.paint.get("fill-extrusion-ambient-occlusion-intensity"),Q=c.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),re=c.paint.get("fill-extrusion-flood-light-intensity"),oe=c.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",me=c.paint.get("fill-extrusion-flood-light-color").toRenderColor(oe?null:c.lut).toArray01().slice(0,3),Me=ie>0&&Q>0,Ee=re>0,Le=(Ae,Re,Ve)=>(1-Ve)*Ae+Ve*Re,Ie=Ae=>{let Re=m.depthModeForSublayer(1,xi.ReadOnly,E.LEQUAL,!0),Ve=c.paint.get(Ae?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),qe=Le(.1,3,Ve),dt=m._showOverdrawInspector;if(!dt){let nt=new en({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),Et=new _n([E.ONE,E.ONE,E.ONE,E.ONE],r.al.transparent,[!1,!1,!1,!0],E.MIN);ff(m,s,c,f,Re,nt,Et,Vi.disabled,Ae,"sdf",W,ie,Q,re,me,qe,L,!1)}{let nt=dt?en.disabled:new en({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),Et=dt?m.colorModeForRenderPass():new _n([E.ONE_MINUS_DST_ALPHA,E.DST_ALPHA,E.ONE,E.ONE],r.al.transparent,[!0,!0,!0,!0]);ff(m,s,c,f,Re,nt,Et,Vi.disabled,Ae,"color",W,ie,Q,re,me,qe,L,!1)}};if(P){let Ae=(Re,Ve,qe)=>{let dt=m.depthModeForSublayer(1,xi.ReadOnly,E.LEQUAL,!1),nt=c.paint.get(Re?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Et=Le(.1,3,nt);{let Ct=new _n([E.ONE,E.ONE,E.ONE,E.ONE],r.al.transparent,[!1,!1,!1,!0]);ff(m,s,c,f,dt,en.disabled,Ct,Vi.disabled,Re,"clear",W,ie,Q,re,me,Et,L,Ve)}{let Ct=new en({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),Ut=new _n([E.ONE,E.ONE,E.ONE,E.ONE],r.al.transparent,[!1,!1,!1,!0],E.MIN);ff(m,s,c,f,dt,Ct,Ut,Vi.disabled,Re,"sdf",W,ie,Q,re,me,Et,L,Ve)}{let Ct=Re?E.ZERO:E.ONE_MINUS_DST_ALPHA,Ut=new en({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),tt=new _n([Ct,E.DST_ALPHA,E.ONE_MINUS_DST_ALPHA,E.ZERO],r.al.transparent,[!0,!0,!0,!0]);ff(m,s,c,f,dt,Ut,tt,Vi.disabled,Re,"color",W,ie,Q,re,me,Et,L,Ve)}{let Ct=new _n([E.ONE,E.ONE,E.ONE,Re?E.ZERO:E.ONE],r.al.transparent,[!1,!1,!1,!0],Re?E.FUNC_ADD:E.MAX);ff(m,s,c,f,dt,en.disabled,Ct,Vi.disabled,Re,"clear",W,ie,Q,re,me,Et,L,Ve,qe)}};if(Me||Ee){let Re;if(m.prepareDrawTile(),R){let Ve=R.drapeBufferSize[0],qe=R.drapeBufferSize[1];Re=R.framebufferCopyTexture,Re&&(!Re||Re.size[0]===Ve&&Re.size[1]===qe)||(Re&&Re.destroy(),Re=R.framebufferCopyTexture=new r.T(b,new r.r({width:Ve,height:qe}),E.RGBA8)),Re.bind(E.LINEAR,E.CLAMP_TO_EDGE),E.copyTexSubImage2D(E.TEXTURE_2D,0,0,0,0,0,Ve,qe)}Me&&Ae(!0,!1,Re),Ee&&Ae(!1,!0,Re)}}else Me&&Ie(!0),Ee&&Ie(!1),(Me||Ee)&&m.resetStencilClippingMasks()}}},hillshade:function(m,s,c,f){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent"||m.style.disableElevatedTerrain)return;let y=m.context,b=m.terrain&&m.terrain.renderingToTexture,[E,R]=m.renderPass!=="translucent"||b?[{},f]:m.stencilConfigForOverlap(f);for(let P of R){let L=s.getTile(P);if(L.needsHillshadePrepare&&m.renderPass==="offscreen")et(m,L,c);else if(m.renderPass==="translucent"){let F=m.depthModeForSublayer(0,xi.ReadOnly),j=c.paint.get("hillshade-emissive-strength"),U=m.colorModeForDrapableLayerRenderPass(j),W=b&&m.terrain?m.terrain.stencilModeForRTTOverlap(P):E[P.overscaledZ];ce(m,P,L,c,F,W,U)}}y.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,s,c,f,y,b){if(m.renderPass!=="translucent"||c.paint.get("raster-opacity")===0)return;let E=m.transform.projection.name==="globe",R=c.paint.get("raster-elevation")!==0,P=R&&E;if(m.renderElevatedRasterBackface&&!P)return;let L=m.context,F=L.gl,j=s.getSource(),U=function(Ie,Ae,Re,Ve){let qe=Ae.paint.get("raster-color"),dt=Ie.type==="raster-array",nt=[],Et=Ae.paint.get("raster-resampling"),Ct=Ae.paint.get("raster-color-mix"),Ut=Ae.paint.get("raster-color-range"),tt=[Ct[0],Ct[1],Ct[2],0],xt=Ct[3],Qe=Et==="nearest"?Ve.NEAREST:Ve.LINEAR;if(dt&&(nt.push("RASTER_ARRAY"),qe||nt.push("RASTER_COLOR"),Et==="linear"&&nt.push("RASTER_ARRAY_LINEAR"),Qe=Ve.NEAREST,!Ut&&Ie.rasterLayers)){let bt=Ie.rasterLayers.find(({id:_t})=>_t===Ae.sourceLayer);bt&&bt.fields&&bt.fields.range&&(Ut=bt.fields.range)}if(Ut=Ut||[0,1],qe){nt.push("RASTER_COLOR"),Re.activeTexture.set(Ve.TEXTURE2),Ae.updateColorRamp(Ut);let bt=Ae.colorRampTexture;bt||(bt=Ae.colorRampTexture=new r.T(Re,Ae.colorRamp,Ve.RGBA8)),bt.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE)}return{mix:tt,range:Ut,offset:xt,defines:nt,resampling:Qe}}(j,c,L,F);if(j instanceof r.aK&&!f.length&&!E)return;let W=c.paint.get("raster-emissive-strength"),ie=m.colorModeForDrapableLayerRenderPass(W),Q=m.terrain&&m.terrain.renderingToTexture,re=!m.options.moving,oe=c.paint.get("raster-resampling")==="nearest"?F.NEAREST:F.LINEAR;if(j instanceof r.aK&&!f.length&&(j.onNorthPole||j.onSouthPole)){let Ie=R?m.stencilModeFor3D():en.disabled;return void lt(!!j.onNorthPole,null,m,s,c,W,U,Vi.disabled,Ie)}if(!f.length)return;let[me,Me]=j instanceof r.aK||Q?[{},f]:m.stencilConfigForOverlap(f),Ee=Me[Me.length-1].overscaledZ;P&&U.defines.push("PROJECTION_GLOBE_VIEW"),R&&U.defines.push("RENDER_CUTOFF");let Le=(Ie,Ae,Re)=>{for(let Ve of Ie){let qe=Ve.toUnwrapped(),dt=s.getTile(Ve);if(Q&&(!dt||!dt.hasData()))continue;L.activeTexture.set(F.TEXTURE0);let nt=__(dt,j,c,U);if(!nt||!nt.texture)continue;let{texture:Et,mix:Ct,offset:Ut,tileSize:tt,buffer:xt}=nt,Qe,bt;Q?(Qe=xi.disabled,bt=Ve.projMatrix):R?(Qe=new xi(F.LEQUAL,xi.ReadWrite,m.depthRangeFor3D),bt=E?Float32Array.from(m.transform.expandedFarZProjMatrix):m.transform.calculateProjMatrix(qe,re)):(Qe=m.depthModeForSublayer(Ve.overscaledZ-Ee,c.paint.get("raster-opacity")===1?xi.ReadWrite:xi.ReadOnly,F.LESS),bt=m.transform.calculateProjMatrix(qe,re));let _t=m.terrain&&Q?m.terrain.stencilModeForRTTOverlap(Ve):me[Ve.overscaledZ],St=b?0:c.paint.get("raster-fade-duration");dt.registerFadeDuration(St);let ht=s.findLoadedParent(Ve,0),At=r_(dt,ht,s,m.transform,St),Kt,Xt;m.terrain&&m.terrain.prepareDrawTile(),L.activeTexture.set(F.TEXTURE0),Et.bind(oe,F.CLAMP_TO_EDGE),L.activeTexture.set(F.TEXTURE1),ht?(ht.texture&&ht.texture.bind(oe,F.CLAMP_TO_EDGE),Kt=Math.pow(2,ht.tileID.overscaledZ-dt.tileID.overscaledZ),Xt=[dt.tileID.canonical.x*Kt%1,dt.tileID.canonical.y*Kt%1]):Et.bind(oe,F.CLAMP_TO_EDGE),"useMipmap"in Et&&L.extTextureFilterAnisotropic&&m.transform.pitch>20&&F.texParameterf(F.TEXTURE_2D,L.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,L.extTextureFilterAnisotropicMax);let Qt=m.transform,_i,tn=R?wE(Qt):[0,0,0,0],ki,Ki,Fi,An,tr,Lr=0;if(P&&j instanceof r.aK&&j.coordinates.length>3)ki=Float32Array.from(r.bc(r.cI(new r.bT(0,0,0)))),Ki=Float32Array.from(Qt.globeMatrix),Fi=Float32Array.from(r.cE(Qt)),An=[r.av(Qt.center.lng),r.aC(Qt.center.lat)],_i=j.elevatedGlobePerspectiveTransform,tr=j.elevatedGlobeGridMatrix||new Float32Array(9);else if(P){let yi=r.cF(Ve.canonical);Lr=r.cG(yi.getCenter().lat),ki=Float32Array.from(r.bc(r.cI(Ve.canonical))),Ki=Float32Array.from(Qt.globeMatrix),Fi=Float32Array.from(r.cE(Qt)),An=[r.av(Qt.center.lng),r.aC(Qt.center.lat)],_i=[0,0],tr=Float32Array.from(r.cH(Ve.canonical,yi,Lr,Qt.worldSize/Qt._pixelsPerMercatorPixel))}else _i=j instanceof r.aK?j.perspectiveTransform:[0,0],ki=new Float32Array(16),Ki=new Float32Array(9),Fi=new Float32Array(16),An=[0,0],tr=new Float32Array(9);let vn=sb(bt,ki,Ki,Fi,tr,Xt||[0,0],r.ag(m.transform.zoom),An,tn,Kt||1,At,c,_i,R?c.paint.get("raster-elevation"):0,2,Ct,Ut,U.range,tt,xt,W),Yr=m.isTileAffectedByFog(Ve),on=m.getOrCreateProgram("raster",{defines:U.defines,overrideFog:Yr});if(m.uploadCommonUniforms(L,on,qe),j instanceof r.aK){let yi=j.elevatedGlobeVertexBuffer,Pn=j.elevatedGlobeIndexBuffer;if(Q||!E)j.boundsBuffer&&j.boundsSegments&&on.draw(m,F.TRIANGLES,Qe,en.disabled,ie,Vi.disabled,vn,c.id,j.boundsBuffer,m.quadTriangleIndexBuffer,j.boundsSegments);else if(yi&&Pn){let dr=Qt.zoom<=r.c6?j.elevatedGlobeSegments:j.getSegmentsForLongitude(Qt.center.lng);dr&&on.draw(m,F.TRIANGLES,Qe,en.disabled,ie,Ae,vn,c.id,yi,Pn,dr)}}else if(P){Qe=new xi(F.LEQUAL,xi.ReadOnly,m.depthRangeFor3D);let yi=m.globeSharedBuffers;if(yi){let[Pn,dr,Yn]=yi.getGridBuffers(Lr,!1);on.draw(m,F.TRIANGLES,Qe,Re||_t,m.colorModeForRenderPass(),Ae,vn,c.id,Pn,dr,Yn)}}else{let{tileBoundsBuffer:yi,tileBoundsIndexBuffer:Pn,tileBoundsSegments:dr}=m.getTileBoundsBuffers(dt);on.draw(m,F.TRIANGLES,Qe,_t,ie,Vi.disabled,vn,c.id,yi,Pn,dr)}}if(!(j instanceof r.aK)&&P)for(let Ve of Ie){let qe=Ve.canonical.y===(1<<Ve.canonical.z)-1;Ve.canonical.y===0&&lt(!0,Ve,m,s,c,W,U,Ae,Re||en.disabled),qe&&lt(!1,Ve,m,s,c,W,U,Ae===Vi.frontCW?Vi.backCW:Vi.frontCW,Re||en.disabled)}};P?Le(Me,m.renderElevatedRasterBackface?Vi.backCW:Vi.frontCW,m.stencilModeFor3D()):Le(Me,Vi.disabled,void 0),m.resetStencilClippingMasks()},"raster-particle":function(m,s,c,f,y,b){m.renderPass==="offscreen"&&function(E,R,P,L){if(!L.length)return;let F=E.context,j=F.gl,U=R.getSource();if(!(U instanceof js))return;let W=Math.ceil(Math.sqrt(P.paint.get("raster-particle-count"))),ie=P.particlePositionRGBAImage;if(!ie||ie.width!==W){let Me=function(Ee){let Le=Ee*Ee,Ie=new Uint8Array(4*Le),Ae=function(Ve){return Ve|=0,Ve=Math.imul(2747636419^Ve,2654435769),Ve=Math.imul(Ve^Ve>>>16,2654435769),((Ve=Math.imul(Ve^Ve>>>16,2654435769))>>>0)/4294967296},Re=1/1.1;for(let Ve=0;Ve<Le;Ve++){let qe=Re*(Ae(2*Ve+0)+Ll),dt=Re*(Ae(2*Ve+1)+Ll),nt=255*qe%1,Et=255*dt%1,Ct=nt,Ut=dt-Et/255,tt=Et;Ie[4*Ve+0]=255*(qe-nt/255),Ie[4*Ve+1]=255*Ct,Ie[4*Ve+2]=255*Ut,Ie[4*Ve+3]=255*tt}return Ie}(W);ie=P.particlePositionRGBAImage=new r.r({width:W,height:W},Me)}let Q=P.particleFramebuffer;Q?Q.width!==W&&(Q.destroy(),Q=P.particleFramebuffer=F.createFramebuffer(W,W,!0,null)):Q=P.particleFramebuffer=F.createFramebuffer(W,W,!0,null);let re=[];for(let Me of L){let Ee=R.getTile(Me);if(!(Ee instanceof ls))continue;let Le=EE(Ee,U,P);if(!Le)continue;let Ie=[Ee.tileSize,Ee.tileSize],Ae=P.tileFramebuffer;Ae||(Ae=P.tileFramebuffer=F.createFramebuffer(Ie[0],Ie[1],!0,null));let Re=Ee.rasterParticleState;Re||(Re=Ee.rasterParticleState=new _b(F,Me,Ie,ie));let Ve=Re.update(P.lastInvalidatedAt);Re.particleTextureDimension!==W&&Re.updateParticleTexture(Me,ie);let qe=Re.targetColorTexture;Re.targetColorTexture=Re.backgroundColorTexture,Re.backgroundColorTexture=qe;let dt=Re.particleTexture0;Re.particleTexture0=Re.particleTexture1,Re.particleTexture1=dt,re.push([Me,Le,Re,Ve])}if(re.length===0)return;let oe=r.q.now(),me=P.previousDrawTimestamp?.001*(oe-P.previousDrawTimestamp):.0167;if(P.previousDrawTimestamp=oe,P.hasColorMap()){F.activeTexture.set(j.TEXTURE0+2);let Me=P.colorRampTexture;Me||(Me=P.colorRampTexture=new r.T(F,P.colorRamp,j.RGBA8)),Me.bind(j.LINEAR,j.CLAMP_TO_EDGE)}F.bindFramebuffer.set(P.tileFramebuffer.framebuffer),function(Me,Ee,Le){let Ie=Me.context,Ae=Ie.gl,Re=Ee.tileFramebuffer;Ie.activeTexture.set(Ae.TEXTURE0);let Ve={u_texture:0,u_opacity:1.05*(dt=Ee.paint.get("raster-particle-fade-opacity-factor"))/(dt+.05)},qe=Me.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var dt;for(let nt of Le){let[,,Et,Ct]=nt;Re.colorAttachment.set(Et.targetColorTexture.texture),Ie.viewport.set([0,0,Re.width,Re.height]),Ie.clear({color:r.al.transparent}),Ct&&(Et.backgroundColorTexture.bind(Ae.NEAREST,Ae.CLAMP_TO_EDGE),qe.draw(Me,Ae.TRIANGLES,xi.disabled,en.disabled,_n.alphaBlended,Vi.disabled,Ve,Ee.id,Me.viewportBuffer,Me.quadTriangleIndexBuffer,Me.viewportSegments))}}(E,P,re),function(Me,Ee,Le,Ie){let Ae=Me.context,Re=Ae.gl,Ve=Le.tileFramebuffer,qe=Me.transform.projection.name==="globe",dt=Le.paint.get("raster-particle-max-speed");for(let nt of Ie){let[Et,Ct,Ut]=nt;Ae.activeTexture.set(Re.TEXTURE0+0),Ct.texture.bind(Re.LINEAR,Re.CLAMP_TO_EDGE),Ve.colorAttachment.set(Ut.targetColorTexture.texture);let tt=Me.getOrCreateProgram("rasterParticleDraw",{defines:Ct.defines,overrideFog:!1});Ae.activeTexture.set(Re.TEXTURE0+1);let xt=Ct.scalarData?[]:[0,1,2,3].map(_t=>r.d7[_t](Et));xt.push(Et);let Qe=Et.canonical.x,bt=Et.canonical.y;for(let _t of xt){let St=Ee.getTile(qe?_t.wrapped():_t);if(!St)continue;let ht=St.rasterParticleState;if(!ht)continue;let At=_t.canonical.x+(1<<_t.canonical.z)*(_t.wrap-Et.wrap),Kt=_t.canonical.y;ht.particleTexture0.bind(Re.NEAREST,Re.CLAMP_TO_EDGE);let Xt=lb(1,ht.particleTexture0.size[0],[At-Qe,Kt-bt],0,Ct.texture.size,2,dt,Ct.textureOffset,Ct.scale,Ct.offset);tt.draw(Me,Re.POINTS,xi.disabled,en.disabled,_n.alphaBlended,Vi.disabled,Xt,Le.id,ht.particleIndexBuffer,void 0,ht.particleSegment)}}}(E,R,P,re),F.bindFramebuffer.set(P.particleFramebuffer.framebuffer),function(Me,Ee,Le,Ie){let Ae=Me.context,Re=Ae.gl,Ve=Ee.paint.get("raster-particle-max-speed"),qe=Ie*Ee.paint.get("raster-particle-speed-factor")*.15,dt=function(Et){return Math.pow(Et,6)}(.01+1*Ee.paint.get("raster-particle-reset-rate-factor")),nt=Ee.particleFramebuffer;Ae.viewport.set([0,0,nt.width,nt.height]);for(let Et of Le){let[,Ct,Ut]=Et;Ae.activeTexture.set(Re.TEXTURE0+0),Ct.texture.bind(Re.LINEAR,Re.CLAMP_TO_EDGE),Ae.activeTexture.set(Re.TEXTURE0+1);let tt=Ut.particleTexture0;tt.bind(Re.NEAREST,Re.CLAMP_TO_EDGE);let xt=AI(1,tt.size[0],0,Ct.texture.size,Ve,qe,dt,Ct.textureOffset,Ct.scale,Ct.offset);nt.colorAttachment.set(Ut.particleTexture1.texture),Ae.clear({color:r.al.transparent}),Me.getOrCreateProgram("rasterParticleUpdate",{defines:Ct.defines}).draw(Me,Re.TRIANGLES,xi.disabled,en.disabled,_n.unblended,Vi.disabled,xt,Ee.id,Me.viewportBuffer,Me.quadTriangleIndexBuffer,Me.viewportSegments)}}(E,P,re,me)}(m,s,c,f),m.renderPass==="translucent"&&(function(E,R,P,L,F){let j=E.context,U=j.gl,W=R.getSource().tileSize,ie=5*(1-r.ae(r.bY,r.bY+1,E.transform.zoom))*W+P.paint.get("raster-particle-elevation"),Q=!E.options.moving,re=E.transform.projection.name==="globe";if(!L.length)return;let[oe,me]=E.stencilConfigForOverlap(L),Me=[];re&&Me.push("PROJECTION_GLOBE_VIEW");let Ee=E.stencilModeFor3D();for(let Le of me){let Ie=Le.toUnwrapped(),Ae=R.getTile(Le);if(!Ae.rasterParticleState)continue;let Re=Ae.rasterParticleState,Ve=100;Ae.registerFadeDuration(Ve);let qe=R.findLoadedParent(Le,0),dt=r_(Ae,qe,R,E.transform,Ve),nt,Et;E.terrain&&E.terrain.prepareDrawTile(),j.activeTexture.set(U.TEXTURE0),Re.targetColorTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),j.activeTexture.set(U.TEXTURE1),qe&&qe.rasterParticleState?(qe.rasterParticleState.targetColorTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),nt=Math.pow(2,qe.tileID.overscaledZ-Ae.tileID.overscaledZ),Et=[Ae.tileID.canonical.x*nt%1,Ae.tileID.canonical.y*nt%1]):Re.targetColorTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE);let Ct=re?Float32Array.from(E.transform.expandedFarZProjMatrix):E.transform.calculateProjMatrix(Ie,Q),Ut=E.transform,tt=CE(Ut),xt=r.cF(Le.canonical),Qe=r.cG(xt.getCenter().lat),bt,_t,St,ht,At;re?(bt=Float32Array.from(r.bc(r.cI(Le.canonical))),_t=Float32Array.from(Ut.globeMatrix),St=Float32Array.from(r.cE(Ut)),ht=[r.av(Ut.center.lng),r.aC(Ut.center.lat)],At=Float32Array.from(r.cH(Le.canonical,xt,Qe,Ut.worldSize/Ut._pixelsPerMercatorPixel))):(bt=new Float32Array(16),_t=new Float32Array(9),St=new Float32Array(16),ht=[0,0],At=new Float32Array(9));let Kt=Ii(Ct,bt,_t,St,At,Et||[0,0],r.ag(E.transform.zoom),ht,tt,nt||1,dt,ie),Xt=E.isTileAffectedByFog(Le),Qt=E.getOrCreateProgram("rasterParticle",{defines:Me,overrideFog:Xt});if(E.uploadCommonUniforms(j,Qt,Ie),re){let _i=new xi(U.LEQUAL,xi.ReadOnly,E.depthRangeFor3D),tn=0,ki=E.globeSharedBuffers;if(ki){let[Ki,Fi,An]=ki.getGridBuffers(Qe,tn!==0);Qt.draw(E,U.TRIANGLES,_i,Ee,_n.alphaBlended,E.renderElevatedRasterBackface?Vi.frontCCW:Vi.backCCW,Kt,P.id,Ki,Fi,An)}}else{let _i=E.depthModeForSublayer(0,xi.ReadOnly),tn=oe[Le.overscaledZ],{tileBoundsBuffer:ki,tileBoundsIndexBuffer:Ki,tileBoundsSegments:Fi}=E.getTileBoundsBuffers(Ae);Qt.draw(E,U.TRIANGLES,_i,tn,_n.alphaBlended,Vi.disabled,Kt,P.id,ki,Ki,Fi)}}E.resetStencilClippingMasks()}(m,s,c,f),m.style.map.triggerRepaint())},background:function(m,s,c,f){let y=c.paint.get("background-color"),b=c.paint.get("background-color-use-theme").constantOr("default")==="none",E=c.paint.get("background-opacity"),R=c.paint.get("background-emissive-strength"),P=c.paint.get("background-pitch-alignment")==="viewport";if(E===0)return;let L=m.context,F=L.gl,j=m.transform,U=j.tileSize,W=c.paint.get("background-pattern"),ie;if(W!==void 0&&(W===null||(ie=m.imageManager.getPattern(r.I.from(W.toString()),c.scope,m.style.getLut(c.scope)),!ie)))return;let Q=!W&&y.a===1&&E===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==Q)return;let re=en.disabled,oe=m.depthModeForSublayer(0,Q==="opaque"?xi.ReadWrite:xi.ReadOnly),me=m.colorModeForDrapableLayerRenderPass(R),Me=W?"backgroundPattern":"background",Ee,Le=f;if(Le||(Ee=m.getBackgroundTiles(),Le=Object.values(Ee).map(Ie=>Ie.tileID)),W&&(L.activeTexture.set(F.TEXTURE0),m.imageManager.bind(m.context,c.scope)),P){let Ie=m.getOrCreateProgram(Me,{overrideFog:!1,overrideRtt:!0}),Ae=new Float32Array(r.ad.mat4.identity([])),Re=new r.aH(0,0,0,0,0),Ve=W?vE(Ae,R,E,m,0,c.scope,ie,P,{tileID:Re,tileSize:U}):cb(Ae,R,E,y.toRenderColor(b?null:c.lut));Ie.draw(m,F.TRIANGLES,oe,re,me,Vi.disabled,Ve,c.id,m.viewportBuffer,m.quadTriangleIndexBuffer,m.viewportSegments)}else for(let Ie of Le){let Ae=m.isTileAffectedByFog(Ie),Re=m.getOrCreateProgram(Me,{overrideFog:Ae}),Ve=Ie.toUnwrapped(),qe=f?Ie.projMatrix:m.transform.calculateProjMatrix(Ve);m.prepareDrawTile();let dt=s?s.getTile(Ie):Ee?Ee[Ie.key]:new ss(Ie,U,j.zoom,m),nt=W?vE(qe,R,E,m,0,c.scope,ie,P,{tileID:Ie,tileSize:U}):cb(qe,R,E,y.toRenderColor(b?null:c.lut));m.uploadCommonUniforms(L,Re,Ve);let{tileBoundsBuffer:Et,tileBoundsIndexBuffer:Ct,tileBoundsSegments:Ut}=m.getTileBoundsBuffers(dt);Re.draw(m,F.TRIANGLES,oe,re,me,Vi.disabled,nt,c.id,Et,Ct,Ut)}},sky:function(m,s,c){let f=m._atmosphere?r.ag(m.transform.zoom):1,y=c.paint.get("sky-opacity")*f;if(y===0)return;let b=m.context,E=c.paint.get("sky-type"),R=new xi(b.gl.LEQUAL,xi.ReadOnly,[0,1]),P=m.frameCounter/1e3%1;E==="atmosphere"?m.renderPass==="offscreen"?c.needsSkyboxCapture(m)&&(function(L,F,j,U){let W=L.context,ie=W.gl,Q=F.skyboxFbo;if(!Q){Q=F.skyboxFbo=W.createFramebuffer(32,32,!0,null),F.skyboxGeometry=new TE(W),F.skyboxTexture=W.gl.createTexture(),ie.bindTexture(ie.TEXTURE_CUBE_MAP,F.skyboxTexture),ie.texParameteri(ie.TEXTURE_CUBE_MAP,ie.TEXTURE_WRAP_S,ie.CLAMP_TO_EDGE),ie.texParameteri(ie.TEXTURE_CUBE_MAP,ie.TEXTURE_WRAP_T,ie.CLAMP_TO_EDGE),ie.texParameteri(ie.TEXTURE_CUBE_MAP,ie.TEXTURE_MIN_FILTER,ie.LINEAR),ie.texParameteri(ie.TEXTURE_CUBE_MAP,ie.TEXTURE_MAG_FILTER,ie.LINEAR);for(let Me=0;Me<6;++Me)ie.texImage2D(ie.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,ie.RGBA,32,32,0,ie.RGBA,ie.UNSIGNED_BYTE,null)}W.bindFramebuffer.set(Q.framebuffer),W.viewport.set([0,0,32,32]);let re=F.getCenter(L,!0),oe=L.getOrCreateProgram("skyboxCapture"),me=new Float64Array(16);r.ad.mat4.identity(me),r.ad.mat4.rotateY(me,me,.5*-Math.PI),xa(L,F,oe,me,re,0),r.ad.mat4.identity(me),r.ad.mat4.rotateY(me,me,.5*Math.PI),xa(L,F,oe,me,re,1),r.ad.mat4.identity(me),r.ad.mat4.rotateX(me,me,.5*-Math.PI),xa(L,F,oe,me,re,2),r.ad.mat4.identity(me),r.ad.mat4.rotateX(me,me,.5*Math.PI),xa(L,F,oe,me,re,3),r.ad.mat4.identity(me),xa(L,F,oe,me,re,4),r.ad.mat4.identity(me),r.ad.mat4.rotateY(me,me,Math.PI),xa(L,F,oe,me,re,5),W.viewport.set([0,0,L.width,L.height])}(m,c),c.markSkyboxValid(m)):m.renderPass==="sky"&&function(L,F,j,U,W){let ie=L.context,Q=ie.gl,re=L.transform,oe=L.getOrCreateProgram("skybox");ie.activeTexture.set(Q.TEXTURE0),Q.bindTexture(Q.TEXTURE_CUBE_MAP,F.skyboxTexture);let me=((Me,Ee,Le,Ie,Ae)=>({u_matrix:Me,u_sun_direction:Ee,u_cubemap:0,u_opacity:Ie,u_temporal_offset:Ae}))(re.skyboxMatrix,F.getCenter(L,!1),0,U,W);L.uploadCommonUniforms(ie,oe),oe.draw(L,Q.TRIANGLES,j,en.disabled,L.colorModeForRenderPass(),Vi.backCW,me,"skybox",F.skyboxGeometry.vertexBuffer,F.skyboxGeometry.indexBuffer,F.skyboxGeometry.segment)}(m,c,R,y,P):E==="gradient"&&m.renderPass==="sky"&&function(L,F,j,U,W){let ie=L.context,Q=ie.gl,re=L.transform,oe=L.getOrCreateProgram("skyboxGradient");F.skyboxGeometry||(F.skyboxGeometry=new TE(ie)),ie.activeTexture.set(Q.TEXTURE0);let me=F.colorRampTexture;me||(me=F.colorRampTexture=new r.T(ie,F.colorRamp,Q.RGBA8)),me.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);let Me=((Ee,Le,Ie,Ae,Re)=>({u_matrix:Ee,u_color_ramp:0,u_center_direction:Le,u_radius:r.ak(Ie),u_opacity:Ae,u_temporal_offset:Re}))(re.skyboxMatrix,F.getCenter(L,!1),F.paint.get("sky-gradient-radius"),U,W);L.uploadCommonUniforms(ie,oe),oe.draw(L,Q.TRIANGLES,j,en.disabled,L.colorModeForRenderPass(),Vi.backCW,Me,"skyboxGradient",F.skyboxGeometry.vertexBuffer,F.skyboxGeometry.indexBuffer,F.skyboxGeometry.segment)}(m,c,R,y,P)},debug:function(m,s,c,f,y,b){for(let E=0;E<c.length;E++)if(y){let L=new r.al(f.r*.8,f.g*.8,f.b*.8,1);fh(m,s,c[E],f,-1,-1,b),fh(m,s,c[E],f,-1,1,b),fh(m,s,c[E],f,1,1,b),fh(m,s,c[E],f,1,-1,b),fh(m,s,c[E],L,0,0,b)}else fh(m,s,c[E],f,0,0,b)},custom:function(m,s,c,f){let y=m.context,b=c.implementation;if(!m.transform.projection.unsupportedLayers||!m.transform.projection.unsupportedLayers.includes("custom")||m.terrain&&(m.terrain.renderingToTexture||m.renderPass==="offscreen")&&c.isDraped(s)){if(m.renderPass==="offscreen"){let E=b.prerender;if(E){if(m.setCustomLayerDefaults(),y.setColorMode(m.colorModeForRenderPass()),m.transform.projection.name==="globe"){let R=m.transform.pointMerc;E.call(b,y.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),r.ag(m.transform.zoom),[R.x,R.y],m.transform.pixelsPerMeterRatio)}else E.call(b,y.gl,m.transform.customLayerMatrix());y.setDirty(),m.setBaseState()}}else if(m.renderPass==="translucent"){if(m.terrain&&m.terrain.renderingToTexture){let R=b.renderToTile;if(R){let P=f[0].canonical,L=new r.ac(P.x+f[0].wrap*(1<<P.z),P.y,P.z);y.setDepthMode(xi.disabled),y.setStencilMode(en.disabled),y.setColorMode(m.colorModeForRenderPass()),m.setCustomLayerDefaults(),R.call(b,y.gl,L),y.setDirty(),m.setBaseState()}return}m.setCustomLayerDefaults(),y.setColorMode(m.colorModeForRenderPass()),y.setStencilMode(en.disabled);let E=b.renderingMode==="3d"?new xi(m.context.gl.LEQUAL,xi.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,xi.ReadOnly);if(y.setDepthMode(E),m.transform.projection.name==="globe"){let R=m.transform.pointMerc;b.render(y.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),r.ag(m.transform.zoom),[R.x,R.y],m.transform.pixelsPerMeterRatio)}else b.render(y.gl,m.transform.customLayerMatrix());y.setDirty(),m.setBaseState(),y.bindFramebuffer.set(null)}}else r.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(m,s,c,f){if(m.renderPass==="opaque")return;let y=c.paint.get("model-opacity").constantOr(1);if(y===0)return;let b=c.paint.get("model-cast-shadows");if(m.renderPass==="shadow"&&(!b||m.terrain&&y<.65&&c._transitionablePaint._values["model-opacity"].value.expression instanceof r.ab))return;let E=m.shadowRenderer,R=c.paint.get("model-receive-shadows");E&&(E.useNormalOffset=!0,R||(E.enabled=!1));let P=()=>{E&&(E.useNormalOffset=!0,R||(E.enabled=!0))},L=s.getSource();if(m.renderPass==="light-beam"&&L.type!=="batched-model")return;if(L.type==="vector"||L.type==="geojson")return function(oe,me,Me,Ee,Le){let Ie=oe.transform;if(Ie.projection.name!=="mercator")return void r.w(`Drawing 3D models for ${Ie.projection.name} projection is not yet implemented`);let Ae=Ie.getFreeCameraOptions().position;if(!oe.modelManager)return;let Re=oe.modelManager;Me.modelManager=Re;let Ve=oe.shadowRenderer;if(!Me._unevaluatedLayout._values.hasOwnProperty("model-id"))return;let qe=Me._unevaluatedLayout._values["model-id"],dt=Object.assign({},Me.layout.get("model-id").parameters),nt=oe.style.order.indexOf(Me.fqid);for(let Et of Ee){let Ct=me.getTile(Et).getBucket(Me);if(!Ct||Ct.projection.name!==Ie.projection.name)continue;let Ut=Ct.getModelUris();Ut&&!Ct.modelsRequested&&(Re.addModelsFromBucket(Ut,Le),Ct.modelsRequested=!0);let tt=xb(Et,Ie);dt.zoom=tt;let xt=qe.possiblyEvaluate(dt);if(bb(oe,Ct,Et),cc.shadowUniformsInitialized=!1,cc.useSingleShadowCascade=!!Ve&&Ve.getMaxCascadeForTile(Et.toUnwrapped())===0,oe.renderPass==="shadow"&&Ve){if(oe.currentShadowCascade===1&&Ct.isInsideFirstShadowMapFrustum)continue;let _t=Ie.calculatePosMatrix(Et.toUnwrapped(),Ie.worldSize);if(cc.tileMatrix.set(_t),cc.shadowTileMatrix=Float32Array.from(Ve.calculateShadowPassMatrixFromMatrix(_t)),cc.aabb.min.fill(0),cc.aabb.max[0]=cc.aabb.max[1]=r.ai,cc.aabb.max[2]=0,b_(Ct,cc,oe,Me.scope))continue}let Qe=1<<Et.canonical.z,bt=[((Ae.x-Et.wrap)*Qe-Et.canonical.x)*r.ai,(Ae.y*Qe-Et.canonical.y)*r.ai,Ae.z*Qe*r.ai];oe.conflationActive&&Object.keys(Ct.instancesPerModel).length>0&&oe.style.isLayerClipped(Me,me.getSource())&&Ct.updateReplacement(Et,oe.replacementSource,nt,Le)&&(Ct.uploaded=!1,Ct.upload(oe.context));for(let _t in Ct.instancesPerModel){let St=Ct.instancesPerModel[_t];St.features.length>0&&(_t=xt.evaluate(St.features[0].feature,{}));let ht=Re.getModel(_t,Le);if(ht&&ht.uploaded)for(let At of ht.nodes)Zc(oe,Me,At,St,bt,Et,cc)}}}(m,s,c,f,L.type==="vector"?c.scope:""),void P();if(!L.loaded())return;if(L.type==="batched-model")return function(oe,me,Me,Ee){Me.resetLayerRenderingStats(oe);let Le=oe.context,Ie=oe.transform,Ae=oe.style.fog,Re=oe.shadowRenderer;if(Ie.projection.name!=="mercator")return void r.w(`Drawing 3D landmark models for ${Ie.projection.name} projection is not yet implemented`);let Ve=oe.transform.getFreeCameraOptions().position,qe=r.ad.vec3.scale([],[Ve.x,Ve.y,Ve.z],oe.transform.worldSize),dt=r.ad.vec3.negate([],qe),nt=r.ad.mat4.identity([]),Et=r.dm(Ie.center.lat,Ie.zoom),Ct=r.ad.mat4.fromScaling([],[1,1,1/Et]);r.ad.mat4.translate(nt,nt,dt);let Ut=Me.paint.get("model-opacity").constantOr(1),tt=new xi(Le.gl.LEQUAL,xi.ReadWrite,oe.depthRangeFor3D),xt=new xi(Le.gl.LEQUAL,xi.ReadOnly,oe.depthRangeFor3D),Qe=new r.ce([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),bt=oe.renderPass==="shadow",_t=bt&&Re?Re.getCurrentCascadeFrustum():Ie.getFrustum(Ie.scaleZoom(Ie.worldSize)),St=Me.paint.get("model-front-cutoff"),ht=St[2]<1,At=rc(oe,Me.paint.get("model-cutoff-fade-range")),Kt=Me.getLayerRenderingStats();(function(Xt,Qt,_i,tn){let ki=Xt.terrain?Xt.terrain.exaggeration():0,Ki=Xt.transform.zoom;for(let Fi of tn){let An=Qt.getTile(Fi).getBucket(_i);An&&(An.setFilter(_i.filter),Xt.conflationActive&&An.updateReplacement(Fi,Xt.replacementSource),An.evaluateScale(Xt,_i),Xt.terrain&&ki>0&&An.elevationUpdate(Xt.terrain,ki,Fi,_i.source),An.needsReEvaluation(Xt,Ki,_i)&&An.evaluate(_i))}})(oe,me,Me,Ee),function(){let Xt,Qt,_i;ht?(Xt=Ee.length-1,Qt=-1,_i=-1):(Xt=0,Qt=Ee.length,_i=1);let tn=new Float64Array(16),ki=r.ad.vec3.create(),Ki=new r.P(0,0);for(let Fi=Xt;Fi!==Qt;Fi+=_i){let An=Ee[Fi],tr=me.getTile(An).getBucket(Me);if(!tr||!tr.uploaded)continue;let Lr=!1;Re&&(Lr=Re.getMaxCascadeForTile(An.toUnwrapped())===0);let vn=Ie.calculatePosMatrix(An.toUnwrapped(),Ie.worldSize),Yr=tr.modelTraits;!bt&&ht&&(r.ad.mat4.invert(tn,vn),r.ad.vec3.transformMat4(ki,qe,tn),Ki.x=ki[0],Ki.y=ki[1]);let on=[];tr.setFilter(Me.filter);for(let yi of tr.getNodesInfo()){if(yi.hiddenByReplacement||!yi.node.meshes)continue;let Pn=yi.node,dr=0;oe.terrain&&Pn.elevation&&(dr=Pn.elevation*oe.terrain.exaggeration());let Yn=(()=>{let Tr=yi.aabb;return Qe.min=[...Tr.min],Qe.max=[...Tr.max],Qe.min[2]+=dr,Qe.max[2]+=dr,r.ad.vec3.transformMat4(Qe.min,Qe.min,vn),r.ad.vec3.transformMat4(Qe.max,Qe.max,vn),Qe})(),co=yi.evaluatedScale;if(co[0]<=1&&co[1]<=1&&co[2]<=1&&Yn.intersects(_t)===0)continue;if(!bt&&ht){let Tr=.16666666666666666;yi.cameraCollisionOpacity=qe[0]>Yn.min[0]&&qe[0]<Yn.max[0]&&qe[1]>Yn.min[1]&&qe[1]<Yn.max[1]&&qe[2]*Et<Yn.max[2]&&Pn.footprint&&r.bA(Ki,Pn.footprint)?Math.max(yi.cameraCollisionOpacity-Tr,0):Math.min(1,yi.cameraCollisionOpacity+Tr)}let Lo=[...vn],Jo=Pn.anchor?Pn.anchor[0]:0,ha=Pn.anchor?Pn.anchor[1]:0;r.ad.mat4.translate(Lo,Lo,[Jo*(co[0]-1),ha*(co[1]-1),dr]),r.ad.vec3.exactEquals(co,r.dq)||r.ad.mat4.scale(Lo,Lo,co);let Bl=r.ad.mat4.multiply([],Lo,Pn.matrix),ds=r.ad.mat4.multiply([],Ie.expandedFarZProjMatrix,Bl),Hn=r.ad.mat4.multiply([],Ie.expandedFarZProjMatrix,Lo),Kr=r.ad.vec4.transformMat4([],[Jo,ha,dr,1],ds)[2];Pn.hidden=!1;let ir=Ut;bt||(ht&&(ir*=yi.cameraCollisionOpacity,ir*=wb(Lo,Ie,yi.aabb,St)),ir*=x_(At,Kr)),ir!==0?on.push({nodeInfo:yi,depth:Kr,opacity:ir,wvpForNode:ds,wvpForTile:Hn,nodeModelMatrix:Bl,tileModelMatrix:Lo}):Pn.hidden=!0}bt||on.sort((yi,Pn)=>!ht||yi.opacity===1&&Pn.opacity===1?yi.depth<Pn.depth?-1:1:yi.opacity===1?-1:Pn.opacity===1?1:yi.depth>Pn.depth?-1:1);for(let yi of on){let Pn=yi.nodeInfo,dr=Pn.node,Yn=r.ad.mat4.multiply([],Ct,yi.tileModelMatrix);r.ad.mat4.multiply(Yn,nt,Yn);let co=r.ad.mat4.invert([],Yn);r.ad.mat4.transpose(co,co),r.ad.mat4.scale(co,co,mh),Yn=r.ad.mat4.multiply(Yn,Yn,dr.matrix);let Lo=oe.renderPass==="light-beam",Jo=Me.paint.get("model-color-use-theme").constantOr("default")==="none",ha=Yr&r.ds.HasMapboxMeshFeatures,Bl=ha?0:Pn.evaluatedRMEA[0][2];for(let ds=0;ds<dr.meshes.length;++ds){let Hn=dr.meshes[ds],Kr=ds===dr.lightMeshIndex,ir=yi.wvpForNode;if(Kr){if(!Lo&&!oe.terrain&&oe.shadowRenderer){oe.currentLayer<oe.firstLightBeamLayer&&(oe.firstLightBeamLayer=oe.currentLayer);continue}ir=yi.wvpForTile}else if(Lo)continue;let Tr={defines:[]},Oa=[];if(!bt&&Re&&(Re.useNormalOffset=!!Hn.normalBuffer),bf(Tr.defines,Oa,Hn,oe,Jo?null:Me.lut),ha||Tr.defines.push("DIFFUSE_SHADED"),Lr&&Tr.defines.push("SHADOWS_SINGLE_CASCADE"),Kt&&(bt?Kt.numRenderedVerticesInShadowPass+=Hn.vertexArray.length:Kt.numRenderedVerticesInTransparentPass+=Hn.vertexArray.length),bt){og(Hn,yi.nodeModelMatrix,oe,Me);continue}let Ur=null;if(Ae){let hc=pd(yi.nodeModelMatrix,oe.transform);if(Ur=new Float32Array(hc),Ie.projection.name!=="globe"){let pl=Hn.aabb.min,gd=Hn.aabb.max,[Du,_d]=Ae.getOpacityForBounds(hc,pl[0],pl[1],gd[0],gd[1]);Tr.overrideFog=Du>=Yt||_d>=Yt}}let ea=Hn.material,Tu;ea.occlusionTexture&&ea.occlusionTexture.offsetScale&&(Tu=ea.occlusionTexture.offsetScale,Tr.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));let hl=oe.getOrCreateProgram("model",Tr);!bt&&Re&&Re.setupShadowsFromMatrix(yi.tileModelMatrix,hl,Re.useNormalOffset),oe.uploadCommonUniforms(Le,hl,null,Ur);let dc=ea.pbrMetallicRoughness;dc.metallicFactor=.9,dc.roughnessFactor=.5;let Ws=ub(new Float32Array(ir),new Float32Array(Yn),new Float32Array(co),new Float32Array(dr.matrix),oe,yi.opacity,dc.baseColorFactor.toRenderColor(null),ea.emissiveFactor,dc.metallicFactor,dc.roughnessFactor,ea,Bl,Me,[0,0,0],Tu);!Kr&&(Pn.hasTranslucentParts||yi.opacity<1)&&hl.draw(oe,Le.gl.TRIANGLES,tt,en.disabled,_n.disabled,Vi.backCCW,Ws,Me.id,Hn.vertexBuffer,Hn.indexBuffer,Hn.segments,Me.paint,oe.transform.zoom,void 0,Oa),hl.draw(oe,Le.gl.TRIANGLES,Kr?xt:tt,en.disabled,Kr||yi.opacity<1||Pn.hasTranslucentParts?_n.alphaBlended:_n.unblended,Vi.backCCW,Ws,Me.id,Hn.vertexBuffer,Hn.indexBuffer,Hn.segments,Me.paint,oe.transform.zoom,void 0,Oa)}}}}()}(m,s,c,f),void P();if(L.type!=="model")return;let F=L.getModels(),j=[],U=m.transform.getFreeCameraOptions().position,W=r.ad.vec3.scale([],[U.x,U.y,U.z],m.transform.worldSize);r.ad.vec3.negate(W,W);let ie=[],Q=[],re=0;for(let oe of F){let me=c.paint.get("model-rotation").constantOr(null),Me=c.paint.get("model-scale").constantOr(null),Ee=c.paint.get("model-translation").constantOr(null);oe.computeModelMatrix(m,me,Me,Ee,!0,!0,!1);let Le=r.ad.mat4.identity([]),Ie=r.dm(oe.position.lat,m.transform.zoom),Ae=r.ad.mat4.fromScaling([],[1,1,1/Ie]);r.ad.mat4.translate(Le,Le,W),j.push({zScaleMatrix:Ae,negCameraPosMatrix:Le});for(let Re of oe.nodes)cp(m.transform,Re,oe.matrix,m.transform.expandedFarZProjMatrix,re,ie,Q);re++}if(ie.sort((oe,me)=>me.depth-oe.depth),m.renderPass!=="shadow"){if(y===1)for(let oe of Q)fd(oe,m,c,j[oe.modelIndex],en.disabled,m.colorModeForRenderPass());else{for(let oe of Q)fd(oe,m,c,j[oe.modelIndex],en.disabled,_n.disabled);for(let oe of Q)fd(oe,m,c,j[oe.modelIndex],m.stencilModeFor3D(),m.colorModeForRenderPass());m.resetStencilClippingMasks()}for(let oe of ie)fd(oe,m,c,j[oe.modelIndex],en.disabled,m.colorModeForRenderPass());P()}else{for(let oe of Q)og(oe.mesh,oe.nodeModelMatrix,m,c);for(let oe of ie)og(oe.mesh,oe.nodeModelMatrix,m,c);P()}}},S_={line:function(m,s,c){if(m.hasElevatedBuckets=!1,m.hasNonElevatedBuckets=!1,m._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||m._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(s){let f=s.getVisibleCoordinates();for(let y of f){let b=s.getTile(y).getBucket(m);if(b&&(b.hasZOffset?m.hasElevatedBuckets=!0:m.hasNonElevatedBuckets=!0,m.hasElevatedBuckets&&m.hasNonElevatedBuckets))break}}}else m.hasNonElevatedBuckets=!0},model:function(m,s,c){let f=s.getSource();if(!f.loaded())return;if(f.type==="vector"||f.type==="geojson")return void(c.modelManager&&c.modelManager.upload(c,f.type==="vector"?m.scope:""));if(f.type==="batched-model"||f.type!=="model")return;let y=f.getModels();for(let b of y)b.upload(c.context)},raster:function(m,s,c){let f=s.getSource();if(!(f instanceof js&&f.loaded()))return;let y=m.sourceLayer||f.rasterLayerIds&&f.rasterLayerIds[0];if(!y)return;let b=m.paint.get("raster-array-band")||f.getInitialBand(y);if(b==null)return;let E=s.getIds().map(R=>s.getTileByID(R));for(let R of E)R.updateNeeded(y,b)&&f.prepareTile(R,y,b)},"raster-particle":function(m,s,c){let f=s.getSource();if(!(f instanceof js&&f.loaded()))return;let y=m.sourceLayer||f.rasterLayerIds&&f.rasterLayerIds[0];if(!y)return;let b=m.paint.get("raster-particle-array-band")||f.getInitialBand(y);if(b==null)return;let E=s.getIds().map(R=>s.getTileByID(R));for(let R of E)R.updateNeeded(y,b)&&f.prepareTile(R,y,b)}},T_={fill:mb};class D_{constructor(s,c,f,y,b){this.context=new ph(s,c),this.transform=f,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=b,this._timeStamp=r.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};let E=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(let P of E)this._debugParams.enabledLayers[P]=!0;b.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),b.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),b.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),b.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),b.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),b.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(let P of E)b.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],P);this.occlusionParams=new Cb(b),this.setup(),this.numSublayers=al.maxUnderzooming+al.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new r.dy,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Uc(this),this._wireframeDebugCache=new up,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];let R=new r.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new r.T(this.context,R,s.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=y}updateTerrain(s,c){let f=!!s&&!!s.terrain&&this.transform.projection.supportsTerrain;if(!(f||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new pE(this,s));let y=this._terrain;this.transform.elevation=f?y:null,y.update(s,this.transform,c),this.transform.elevation&&!y.enabled&&(this.transform.elevation=null)}_updateFog(s){let c=s.fog;if(!c||this.transform.projection.name==="globe"||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);let[f,y]=c.getFovAdjustedRange(this.transform._fov);if(f>y)return void(this.transform.fogCullDistSq=null);let b=f+.78*(y-f);this.transform.fogCullDistSq=b*b}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(s){s&&!this._terrain&&(this._terrain=new pE(this,this.style)),this._forceTerrainMode=s}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(s,c){if(this.width=s*r.q.devicePixelRatio,this.height=c*r.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let f of this.style.order)this.style._mergedLayers[f].resize()}setup(){let s=this.context,c=new r.b5;c.emplaceBack(0,0),c.emplaceBack(r.ai,0),c.emplaceBack(0,r.ai),c.emplaceBack(r.ai,r.ai),this.tileExtentBuffer=s.createVertexBuffer(c,r.b7.members),this.tileExtentSegments=r.b8.simpleSegment(0,0,4,2);let f=new r.b5;f.emplaceBack(0,0),f.emplaceBack(r.ai,0),f.emplaceBack(0,r.ai),f.emplaceBack(r.ai,r.ai),this.debugBuffer=s.createVertexBuffer(f,r.b7.members),this.debugSegments=r.b8.simpleSegment(0,0,4,5);let y=new r.b5;y.emplaceBack(-1,-1),y.emplaceBack(1,-1),y.emplaceBack(-1,1),y.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(y,r.b7.members),this.viewportSegments=r.b8.simpleSegment(0,0,4,2);let b=new r.aU;b.emplaceBack(0,0,0,0),b.emplaceBack(r.ai,0,r.ai,0),b.emplaceBack(0,r.ai,0,r.ai),b.emplaceBack(r.ai,r.ai,r.ai,r.ai),this.mercatorBoundsBuffer=s.createVertexBuffer(b,r.ba.members),this.mercatorBoundsSegments=r.b8.simpleSegment(0,0,4,2);let E=new r.aV;E.emplaceBack(0,1,2),E.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(E);let R=new r.b6;for(let L of[0,1,3,2,0])R.emplaceBack(L);this.debugIndexBuffer=s.createIndexBuffer(R),this.emptyTexture=new r.T(s,new r.r({width:1,height:1},Uint8Array.of(0,0,0,0)),s.gl.RGBA8),this.identityMat=r.ad.mat4.create();let P=this.context.gl;this.stencilClearMode=new en({func:P.ALWAYS,mask:0},0,255,P.ZERO,P.ZERO,P.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(s){return s._makeTileBoundsBuffers(this.context,this.transform.projection),s._tileBoundsBuffer?{tileBoundsBuffer:s._tileBoundsBuffer,tileBoundsIndexBuffer:s._tileBoundsIndexBuffer,tileBoundsSegments:s._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){let s=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,s.TRIANGLES,xi.disabled,this.stencilClearMode,_n.disabled,Vi.disabled,lf(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(s,c,f){if(!c||this.currentStencilSource===c.id||!s.isTileClipped()||!f||f.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let R=!1;for(let P of f)if(this._tileClippingMaskIDs[P.key]===void 0){R=!0;break}if(!R)return}this.currentStencilSource=c.id;let y=this.context,b=y.gl;this.nextStencilID+f.length>256&&this.clearStencil(),y.setColorMode(_n.disabled),y.setDepthMode(xi.disabled);let E=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(let R of f){let P=c.getTile(R),L=this._tileClippingMaskIDs[R.key]=this.nextStencilID++,{tileBoundsBuffer:F,tileBoundsIndexBuffer:j,tileBoundsSegments:U}=this.getTileBoundsBuffers(P);E.draw(this,b.TRIANGLES,xi.disabled,new en({func:b.ALWAYS,mask:0},L,255,b.KEEP,b.KEEP,b.REPLACE),_n.disabled,Vi.disabled,lf(R.projMatrix),"$clipping",F,j,U)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let s=this.nextStencilID++,c=this.context.gl;return new en({func:c.NOTEQUAL,mask:255},s,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(s){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(s);let c=this.context.gl;return new en({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(s){let c=this.context.gl,f=s.sort((E,R)=>R.overscaledZ-E.overscaledZ),y=f[f.length-1].overscaledZ,b=f[0].overscaledZ-y+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();let E={};for(let R=0;R<b;R++)E[R+y]=new en({func:c.GEQUAL,mask:255},R+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=b,[E,f]}return[{[y]:en.disabled},f]}colorModeForRenderPass(){let s=this.context.gl;return this._showOverdrawInspector?new _n([s.CONSTANT_COLOR,s.ONE,s.CONSTANT_COLOR,s.ONE],new r.al(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?_n.unblended:_n.alphaBlended}colorModeForDrapableLayerRenderPass(s){let c=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new _n([c.ONE,c.ONE_MINUS_SRC_ALPHA,c.CONSTANT_ALPHA,c.ONE_MINUS_SRC_ALPHA],new r.al(0,0,0,s===void 0?0:s),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(s,c,f,y=!1){if(this.depthOcclusion)return new xi(this.context.gl.GREATER,xi.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!y)return xi.disabled;let b=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new xi(f||this.context.gl.LEQUAL,c,[b,b])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){let s=this.context.gl,c=Math.ceil(this.width),f=Math.ceil(this.height),y=this.context.bindFramebuffer.get(),b=s.getParameter(s.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===c&&this.depthFBO.height===f||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),c!==0&&f!==0&&(this.depthFBO=new Gs(this.context,c,f,!1,"texture"),this.depthTexture=new r.T(this.context,{width:c,height:f,data:null},s.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(y),s.bindTexture(s.TEXTURE_2D,b),this.depthFBO&&(s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),s.blitFramebuffer(0,0,c,f,0,0,c,f,s.DEPTH_BUFFER_BIT,s.NEAREST),s.bindFramebuffer(s.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((s,c)=>s+c/this._fpsHistory.length,0))}render(s,c){let f=r.q.now();this._dt=f-this._timeStamp,this._timeStamp=f,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=s.map.repaint,this.style=s,this.options=c;let y=this.style._mergedLayers,b=!(!this.terrain||!this.terrain.enabled),E=()=>this.style._getOrder(b).filter(tt=>{let xt=y[tt];return!(xt.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[xt.type]}),R=E(),P=!1,L=!1;for(let tt of R){let xt=y[tt];xt.type==="circle"&&(P=!0),xt.type==="symbol"&&(xt.hasInitialOcclusionOpacityProperties?L=!0:P=!0)}let F=R.map(tt=>y[tt]),j=this.style._mergedSourceCaches;this.imageManager=s.imageManager,this.modelManager=s.modelManager,this.symbolFadeChange=s.placement.symbolFadeChange(r.q.now()),this.imageManager.beginFrame();let U=0,W=!1;for(let tt in j){let xt=j[tt];xt.used&&(xt.prepare(this.context),xt.getSource().usedInConflation&&++U)}let ie=!1;for(let tt of F)tt.isHidden(this.transform.zoom)||(tt.type==="clip"&&(ie=!0),this.prepareLayer(tt));let Q={},re={},oe={},me={},Me={};for(let tt in j){let xt=j[tt];Q[tt]=xt.getVisibleCoordinates(),re[tt]=Q[tt].slice().reverse(),oe[tt]=xt.getVisibleCoordinates(!0).reverse(),me[tt]=xt.getShadowCasterCoordinates(),Me[tt]=xt.sortCoordinatesByDistance(Q[tt])}let Ee=tt=>{let xt=this.style.getLayerSourceCache(tt);return xt&&xt.used?xt.getSource():null};if(U||ie||this._clippingActiveLastFrame){let tt=[],xt=[],Qe=0;for(let bt of F)this.isSourceForClippingOrConflation(bt,Ee(bt))&&(tt.push(bt),xt.push(Qe)),Qe++;if(tt&&(ie||tt.length>1)||this._clippingActiveLastFrame){ie=!1;let bt=[];for(let _t=0;_t<tt.length;_t++){let St=tt[_t],ht=xt[_t],At=this.style.getLayerSourceCache(St);if(!At||!At.used||!At.getSource().usedInConflation&&St.type!=="clip")continue;let Kt=r.dA,Xt=r.by.None,Qt=[],_i=!0;if(St.type==="clip"){Kt=ht;for(let tn of St.layout.get("clip-layer-types"))Xt|=tn==="model"?r.by.Model:tn==="symbol"?r.by.Symbol:r.by.FillExtrusion;for(let tn of St.layout.get("clip-layer-scope"))Qt.push(tn);St.isHidden(this.transform.zoom)?_i=!1:ie=!0}_i&&bt.push({layer:St.fqid,cache:At,order:Kt,clipMask:Xt,clipScope:Qt})}this.replacementSource.setSources(bt),W=!0}}this._clippingActiveLastFrame=ie,W||this.replacementSource.clear(),this.conflationActive=W,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let tt=0;tt<F.length;tt++){let xt=F[tt],Qe=xt.cutoffRange();if(this.longestCutoffRange=Math.max(Qe,this.longestCutoffRange),Qe>0){let bt=Ee(xt);bt&&(this.minCutoffZoom=Math.max(bt.minzoom,this.minCutoffZoom)),xt.minzoom&&(this.minCutoffZoom=Math.max(xt.minzoom,this.minCutoffZoom))}xt.is3D(b)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=tt),this._lastOcclusionLayer=tt)}let Le=this.style&&this.style.fog;Le?(this._fogVisible=Le.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Le.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(oe),this.opaquePassCutoff=0,R=E(),F=R.map(tt=>y[tt]));let Ie=this._shadowRenderer;if(Ie){Ie.updateShadowParameters(this.transform,this.style.directionalLight);for(let tt in j)for(let xt of Q[tt]){let Qe={min:0,max:0};this.terrain&&(Qe=this.terrain.getMinMaxForTile(xt)||Qe),Ie.addShadowReceiver(xt.toUnwrapped(),Qe.min,Qe.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new r.dz(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new DE(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);let Ae=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Re=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Ae&&!this._snow&&(this._snow=new xf(this)),!Ae&&this._snow&&(this._snow.destroy(),delete this._snow),Re&&!this._rain&&(this._rain=new Mb(this)),!Re&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!Po.has(this.context.gl))return;this.renderPass="offscreen";for(let tt of F){let xt=s.getLayerSourceCache(tt);if(!tt.hasOffscreenPass()||tt.isHidden(this.transform.zoom))continue;let Qe=xt?re[xt.id]:void 0;(tt.type==="custom"||tt.type==="raster"||tt.type==="raster-particle"||tt.isSky()||Qe&&Qe.length)&&this.renderLayer(this,xt,tt,Qe)}this.depthRangeFor3D=[0,1-(F.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,me)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let Ve=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),qe=(()=>{if(c.showOverdrawInspector)return r.al.black;let tt=this.style.fog;if(tt&&this.transform.projection.supportsFog){let xt=this.style.getLut(tt.scope);if(!Ve){let Qe=tt.properties.get("color-use-theme")==="none",bt=tt.properties.get("color").toRenderColor(Qe?null:xt).toArray01();return new r.al(...bt)}if(Ve){let Qe=tt.properties.get("space-color-use-theme")==="none",bt=tt.properties.get("space-color").toRenderColor(Qe?null:xt).toArray01();return new r.al(...bt)}}return r.al.transparent})();if(this.context.clear({color:qe,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ve&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=R.length-1;this.currentLayer>=0;this.currentLayer--){let tt=F[this.currentLayer],xt=s.getLayerSourceCache(tt);if(tt.isSky())continue;let Qe=xt?(tt.is3D(b)?Me:re)[xt.id]:void 0;this._renderTileClippingMasks(tt,xt,Qe),this.renderLayer(this,xt,tt,Qe)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ve&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||r.ag(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<R.length;this.currentLayer++){let tt=F[this.currentLayer],xt=s.getLayerSourceCache(tt);tt.isSky()&&this.renderLayer(this,xt,tt,xt?re[xt.id]:void 0)}function dt(tt,xt){let Qe;return xt&&(Qe=(tt.type==="symbol"?oe:tt.is3D(b)?Me:re)[xt.id]),Qe}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<R.length;){let tt=F[this.currentLayer];if(tt.type==="raster"||tt.type==="raster-particle"){let xt=s.getLayerSourceCache(tt);this.renderLayer(this,xt,tt,dt(tt,xt))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let nt=0;Ie&&(nt=Ie.getShadowCastingLayerCount());let Et=!1,Ct=-1;for(let tt=0;tt<R.length;++tt){let xt=F[tt];xt.isHidden(this.transform.zoom)||xt.is3D(b)&&(Ct=tt)}L&&Ct===-1&&(P=!0);let Ut=!1;for(;this.currentLayer<R.length;){let tt=F[this.currentLayer],xt=s.getLayerSourceCache(tt);if(tt.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(tt)){if(tt.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!Ut&&tt.is3D(b)&&!b){let Qe=this.currentLayer,bt=_t=>{for(this.currentLayer=0;this.currentLayer<F.length;this.currentLayer++){let St=F[this.currentLayer];if(T_[St.type]){let ht=this.style.getLayerSourceCache(St);T_[St.type](this,ht,St,dt(St,ht),_t)}}};bt("initialize"),bt("reset"),this.currentLayer=Qe,Ut=!0}if(P&&!Et&&this.terrain&&!this.transform.isOrthographic&&(Et=!0,this.blitDepth()),L&&Ct!==-1&&this.currentLayer===Ct+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(tt,xt,xt?Q[xt.id]:void 0),this.renderLayer(this,xt,tt,dt(tt,xt)),!this.terrain&&Ie&&nt>0&&tt.hasShadowPass()&&--nt==0&&(Ie.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){let Qe=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Qe;this.currentLayer++){let bt=F[this.currentLayer];if(!bt.hasLightBeamPass())continue;let _t=s.getLayerSourceCache(bt);this.renderLayer(this,_t,bt,_t?re[_t.id]:void 0)}this.currentLayer=Qe,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){let Qe=this.currentLayer;this.depthOcclusion=!0;for(let bt of this.layersWithOcclusionOpacity){this.currentLayer=bt;let _t=F[this.currentLayer],St=s.getLayerSourceCache(_t),ht=St?re[St.id]:void 0;this.terrain||this._renderTileClippingMasks(_t,St,St?Q[St.id]:void 0),this.renderLayer(this,St,_t,ht)}this.depthOcclusion=!1,this.currentLayer=Qe,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let tt=null;F.forEach(xt=>{let Qe=s.getLayerSourceCache(xt);Qe&&!xt.isHidden(this.transform.zoom)&&Qe.getVisibleCoordinates().length&&(!tt||tt.getSource().maxzoom<Qe.getSource().maxzoom)&&(tt=Qe)}),tt&&this.options.showTileBoundaries&&sg.debug(this,tt,tt.getVisibleCoordinates(),r.al.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&sg.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new r.al(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(tt){let xt=tt.transform.padding;yb(tt,tt.transform.height-(xt.top||0),3,yf),yb(tt,xt.bottom||0,3,RI),vb(tt,xt.left||0,3,kI),vb(tt,tt.transform.width-(xt.right||0),3,SE);let Qe=tt.transform.centerPoint;(function(bt,_t,St,ht){lp(bt,_t-1,St-10,2,20,ht),lp(bt,_t-10,St-1,20,2,ht)})(tt,Qe.x,tt.transform.height-Qe.y,y_)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),W||(this.conflationActive=!1)}prepareLayer(s){this.gpuTimingStart(s);let{unsupportedLayers:c}=this.transform.projection,f=!c||!c.includes(s.type);if(S_[s.type]&&(f||this.terrain&&s.type==="custom")){let y=this.style.getLayerSourceCache(s);S_[s.type](s,y,this)}this.gpuTimingEnd()}renderLayer(s,c,f,y){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="sky"||f.type==="custom"||f.type==="model"||f.type==="raster"||f.type==="raster-particle"||y&&y.length)&&(this.id=f.id,this.gpuTimingStart(f),s.transform.projection.unsupportedLayers&&s.transform.projection.unsupportedLayers.includes(f.type)&&(!s.terrain||f.type!=="custom")||f.type==="clip"||sg[f.type](s,c,f,y,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(s){if(!this.options.gpuTiming)return;let c=this.context.extTimerQuery,f=this.context.gl,y=this.gpuTimers[s.id];y||(y=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:f.createQuery()}),y.calls++,f.beginQuery(c.TIME_ELAPSED_EXT,y.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){let s=this.context.extTimerQuery,c=this.context.gl,f=c.createQuery();this.deferredRenderGpuTimeQueries.push(f),c.beginQuery(s.TIME_ELAPSED_EXT,f)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){let s=this.gpuTimers;return this.gpuTimers={},s}collectDeferredRenderGpuQueries(){let s=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],s}queryGpuTimers(s){let c={};for(let f in s){let y=s[f],b=this.context.extTimerQuery,E=b.getQueryParameter(y.query,this.context.gl.QUERY_RESULT)/1e6;b.deleteQueryEXT(y.query),c[f]=E}return c}queryGpuTimeDeferredRender(s){if(!this.options.gpuTimingDeferredRender)return 0;let c=this.context.gl,f=0;for(let y of s)f+=c.getQueryParameter(y,c.QUERY_RESULT)/1e6,c.deleteQuery(y);return f}translatePosMatrix(s,c,f,y,b){if(!f[0]&&!f[1])return s;let E=b?y==="map"?this.transform.angle:0:y==="viewport"?-this.transform.angle:0;if(E){let L=Math.sin(E),F=Math.cos(E);f=[f[0]*F-f[1]*L,f[0]*L+f[1]*F]}let R=[b?f[0]:r.at(c,f[0],this.transform.zoom),b?f[1]:r.at(c,f[1],this.transform.zoom),0],P=new Float32Array(16);return r.ad.mat4.translate(P,s,R),P}saveTileTexture(s){let c=s.size[0],f=this._tileTextures[c];f?f.push(s):this._tileTextures[c]=[s]}getTileTexture(s){let c=this._tileTextures[s];return c&&c.length>0?c.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(s,c,f){let y=f===void 0?this.terrain&&this.terrain.renderingToTexture:f,b=[];return this.style&&this.style.enable3dLights()&&(s==="globeRaster"||s==="terrainRaster"?(b.push("LIGHTING_3D_MODE"),b.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):y||b.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||b.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(b.push("TERRAIN"),this.linearFloatFilteringSupported()&&b.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&b.push("GLOBE"),!this._fogVisible||y||c!==void 0&&!c||b.push("FOG","FOG_DITHERING"),y&&b.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&b.push("OVERDRAW_INSPECTOR"),b}getOrCreateProgram(s,c){this.cache=this.cache||{};let f=c&&c.defines||[],y=c&&c.config,b=this.currentGlobalDefines(s,c&&c.overrideFog,c&&c.overrideRtt).concat(f),E=mE.cacheKey(ud[s],s,b,y);return this.cache[E]||(this.cache[E]=new mE(this.context,s,ud[s],y,db[s],b)),this.cache[E]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new r.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(s,c){if(this.style.enable3dLights()){let f=this.style.directionalLight,y=this.style.ambientLight;if(f&&y){let b=((E,R,P)=>{let L=E.properties.get("direction"),F=E.properties.get("color-use-theme")==="none",j=E.properties.get("color").toRenderColor(F?null:P.getLut(E.scope)).toArray01(),U=E.properties.get("intensity"),W=R.properties.get("color-use-theme")==="none",ie=R.properties.get("color").toRenderColor(W?null:P.getLut(R.scope)).toArray01(),Q=R.properties.get("intensity"),re=[L.x,L.y,L.z],oe=r.cN(ie,Q),me=r.cN(j,U);return{u_lighting_ambient_color:oe,u_lighting_directional_dir:re,u_lighting_directional_color:me,u_ground_radiance:fE(re,me,oe)}})(f,y,this.style);c.setLightsUniformValues(s,b)}}}uploadCommonUniforms(s,c,f,y,b){if(this.uploadCommonLightUniforms(s,c),this.terrain&&this.terrain.renderingToTexture)return;let E=this.style.fog;if(E){let R=E.getOpacity(this.transform.pitch),P=((L,F,j,U,W,ie,Q,re,oe,me,Me,Ee)=>{let Le=L.transform,Ie=F.properties.get("color-use-theme")==="none",Ae=F.properties.get("color").toRenderColor(Ie?null:L.style.getLut(F.scope)).toArray01();Ae[3]=U;let Re=L.frameCounter/1e3%1,[Ve,qe]=F.properties.get("vertical-range");return{u_fog_matrix:j?Le.calculateFogTileMatrix(j):Ee||L.identityMat,u_fog_range:F.getFovAdjustedRange(Le._fov),u_fog_color:Ae,u_fog_horizon_blend:F.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Ve,qe),qe],u_fog_temporal_offset:Re,u_frustum_tl:W,u_frustum_tr:ie,u_frustum_br:Q,u_frustum_bl:re,u_globe_pos:oe,u_globe_radius:me,u_viewport:Me,u_globe_transition:r.ag(Le.zoom),u_is_globe:+(Le.projection.name==="globe")}})(this,E,f,R,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*r.q.devicePixelRatio,this.transform.height*r.q.devicePixelRatio],y);c.setFogUniformValues(s,P)}b&&c.setCutoffUniformValues(s,b.uniformValues)}setTileLoadedFlag(s){this.tileLoaded=s}saveCanvasCopy(){let s=this.canvasCopy();s&&(this.frameCopies.push(s),this.tileLoaded=!1)}canvasCopy(){let s=this.context.gl,c=s.createTexture();return s.bindTexture(s.TEXTURE_2D,c),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGBA,0,0,s.drawingBufferWidth,s.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;let s=this.style&&this.style.fog;return!!s&&s.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){let s=this._backgroundTiles,c=this._backgroundTiles={},f=this.transform.coveringTiles({tileSize:512});for(let y of f)c[y.key]=s[y.key]||new ss(y,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(s,c){return!(!s.is3D(!(!this.terrain||!this.terrain.enabled))||s.type!=="clip"&&(s.minzoom&&s.minzoom>this.transform.zoom||(this.style._clipLayerPresent||s.sourceLayer!=="building")&&(!c||c.type!=="batched-model")))}isTileAffectedByFog(s){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let c=this._cachedTileFogOpacities[s.key];return c||(this._cachedTileFogOpacities[s.key]=c=this.style.fog.getOpacityForTile(s)),c[0]>=Yt||c[1]>=Yt}setupDepthForOcclusion(s,c,f){let y=this.context,b=y.gl,E=!!f;var R;f||(f={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),y.activeTexture.set(b.TEXTURE3),s&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),f.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],f.u_depth_range_unpack=[2/((R=this.depthRangeFor3D)[1]-R[0]),-1-2*R[0]/(R[1]-R[0])],f.u_occluder_half_size=.5*this.occlusionParams.occluderSize,f.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),y.activeTexture.set(b.TEXTURE0),E||c.setTerrainUniformValues(y,f)}}function M_(m,s){let c=!1,f=null,y=()=>{f=null,c&&(m(),f=setTimeout(y,s),c=!1)};return()=>(c=!0,f||y(),f)}class Ab{constructor(s){this._hashName=s&&encodeURIComponent(s),r.aQ(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=M_(this._updateHashUnthrottled.bind(this),300)}addTo(s){return this._map=s,window.addEventListener("hashchange",this._onHashChange,!1),s.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){let s=this._map;if(!s)return"";let c=Rb(s);if(this._hashName){let f=this._hashName,y=!1,b=location.hash.slice(1).split("&").map(E=>{let R=E.split("=")[0];return R===f?(y=!0,`${R}=${c}`):E}).filter(E=>E);return y||b.push(`${f}=${c}`),`#${b.join("&")}`}return`#${c}`}_getCurrentHash(){let s=location.hash.replace("#","");if(this._hashName){let c;return s.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(c=f)}),(c&&c[1]||"").split("/")}return s.split("/")}_onHashChange(){let s=this._map;if(!s)return!1;let c=this._getCurrentHash();if(c.length>=3&&!c.some(f=>isNaN(f))){let f=s.dragRotate.isEnabled()&&s.touchZoomRotate.isEnabled()?+(c[3]||0):s.getBearing();return s.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:f,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Rb(m,s){let c=m.getCenter(),f=Math.round(100*m.getZoom())/100,y=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,y),E=Math.round(c.lng*b)/b,R=Math.round(c.lat*b)/b,P=m.getBearing(),L=m.getPitch(),F=s?`/${E}/${R}/${f}`:`${f}/${R}/${E}`;return(P||L)&&(F+="/"+Math.round(10*P)/10),L&&(F+=`/${Math.round(L)}`),F}let lg={linearity:.3,easing:r.dB(0,0,.3,1)},ME=r.l({deceleration:2500,maxSpeed:1400},lg),IE=r.l({deceleration:20,maxSpeed:1400},lg),AE=r.l({deceleration:1e3,maxSpeed:360},lg),RE=r.l({deceleration:1e3,maxSpeed:90},lg);class kE{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:r.q.now(),settings:s})}_drainInertiaBuffer(){let s=this._inertiaBuffer,c=r.q.now();for(;s.length>0&&c-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;let c={zoom:0,bearing:0,pitch:0,pan:new r.P(0,0),pinchAround:void 0,around:void 0};for(let{settings:b}of this._inertiaBuffer)c.zoom+=b.zoomDelta||0,c.bearing+=b.bearingDelta||0,c.pitch+=b.pitchDelta||0,b.panDelta&&c.pan._add(b.panDelta),b.around&&(c.around=b.around),b.pinchAround&&(c.pinchAround=b.pinchAround);let f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(c.pan.mag()){let b=ug(c.pan.mag(),f,r.l({},ME,s||{}));y.offset=c.pan.mult(b.amount/c.pan.mag()),y.center=this._map.transform.center,cg(y,b)}if(c.zoom){let b=ug(c.zoom,f,IE);y.zoom=this._map.transform.zoom+b.amount,cg(y,b)}if(c.bearing){let b=ug(c.bearing,f,AE);y.bearing=this._map.transform.bearing+r.ay(b.amount,-179,179),cg(y,b)}if(c.pitch){let b=ug(c.pitch,f,RE);y.pitch=this._map.transform.pitch+b.amount,cg(y,b)}if(y.zoom||y.bearing){let b=c.pinchAround===void 0?c.around:c.pinchAround;y.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),y.noMoveStart=!0,y}}function cg(m,s){(!m.duration||m.duration<s.duration)&&(m.duration=s.duration,m.easing=s.easing)}function ug(m,s,c){let{maxSpeed:f,linearity:y,deceleration:b}=c,E=r.ay(m*y/(s/1e3),-f,f),R=Math.abs(E)/(b*y);return{easing:c.easing,duration:1e3*R,amount:E*(R/2)}}class cl extends r.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,c,f,y={}){let b=vt(c.getCanvasContainer(),f),E=c.unproject(b);super(s,r.l({point:b,lngLat:E,originalEvent:f},y)),this._defaultPrevented=!1,this.target=c}}class dg extends r.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,c,f){let y=s==="touchend"?f.changedTouches:f.touches,b=Rt(c.getCanvasContainer(),y),E=b.map(P=>c.unproject(P)),R=b.reduce((P,L,F,j)=>P.add(L.div(j.length)),new r.P(0,0));super(s,{points:b,point:R,lngLats:E,lngLat:c.unproject(R),originalEvent:f}),this._defaultPrevented=!1}}class OE extends r.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,c){super("wheel",{originalEvent:c}),this._defaultPrevented=!1}}class PE{constructor(s,c){this._map=s,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(s){return this._firePreventable(new OE(this._map,s))}mousedown(s,c){return this._mousedownPos=c,this._firePreventable(new cl(s.type,this._map,s))}mouseup(s){this._map.fire(new cl(s.type,this._map,s))}preclick(s){let c=r.l({},s);c.type="preclick",this._map.fire(new cl(c.type,this._map,c))}click(s,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(s),this._map.fire(new cl(s.type,this._map,s)))}dblclick(s){return this._firePreventable(new cl(s.type,this._map,s))}mouseover(s){this._map.fire(new cl(s.type,this._map,s))}mouseout(s){this._map.fire(new cl(s.type,this._map,s))}touchstart(s){return this._firePreventable(new dg(s.type,this._map,s))}touchmove(s){this._map.fire(new dg(s.type,this._map,s))}touchend(s){this._map.fire(new dg(s.type,this._map,s))}touchcancel(s){this._map.fire(new dg(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class PI{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(s){this._map.fire(new cl(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new cl("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new cl(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class NI{constructor(s,c){this._map=s,this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,c){this.isEnabled()&&s.shiftKey&&s.button===0&&(he(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(s,c){if(!this._active)return;let f=c,y=this._startPos,b=this._lastPos;if(!y||!b||b.equals(f)||!this._box&&f.dist(y)<this._clickTolerance)return;this._lastPos=f,this._box||(this._box=Z("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));let E=Math.min(y.x,f.x),R=Math.max(y.x,f.x),P=Math.min(y.y,f.y),L=Math.max(y.y,f.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${E}px,${P}px)`,this._box.style.width=R-E+"px",this._box.style.height=L-P+"px")})}mouseupWindow(s,c){if(!this._active)return;let f=this._startPos,y=c;if(f&&s.button===0){if(this.reset(),ye(),f.x!==y.x||f.y!==y.y)return this._map.fire(new r.A("boxzoomend",{originalEvent:s})),{cameraAnimation:b=>b.fitScreenCoordinates(f,y,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",s)}}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Ce(),delete this._startPos,delete this._lastPos}_fireEvent(s,c){return this._map.fire(new r.A(s,{originalEvent:c}))}}function Zr(m,s){let c={};for(let f=0;f<m.length;f++)c[m[f].identifier]=s[f];return c}class NE{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(s,c,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=s.timeStamp),f.length===this.numTouches&&(this.centroid=function(y){let b=new r.P(0,0);for(let E of y)b._add(E);return b.div(y.length)}(c),this.touches=Zr(f,c)))}touchmove(s,c,f){if(this.aborted||!this.centroid)return;let y=Zr(f,c);for(let b in this.touches){let E=y[b];(!E||E.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(s,c,f){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){let y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class kb{constructor(s){this.singleTap=new NE(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(s,c,f){this.singleTap.touchstart(s,c,f)}touchmove(s,c,f){this.singleTap.touchmove(s,c,f)}touchend(s,c,f){let y=this.singleTap.touchend(s,c,f);if(y){let b=s.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(y)<30;if(b&&E||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class LI{constructor(){this._zoomIn=new kb({numTouches:1,numTaps:2}),this._zoomOut=new kb({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,c,f){this._zoomIn.touchstart(s,c,f),this._zoomOut.touchstart(s,c,f)}touchmove(s,c,f){this._zoomIn.touchmove(s,c,f),this._zoomOut.touchmove(s,c,f)}touchend(s,c,f){let y=this._zoomIn.touchend(s,c,f),b=this._zoomOut.touchend(s,c,f);return y?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()+1,around:E.unproject(y)},{originalEvent:s})}):b?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()-1,around:E.unproject(b)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}let hg={0:1,2:2},Ob={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class pg{constructor(s){this.reset(),this._clickTolerance=s.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(s,c){return!1}_move(s,c){return{}}mousedown(s,c){if(this._lastPoint)return;let f=ut(s);this._correctButton(s,f)&&(this._lastPoint=c,this._eventButton=f)}mousemoveWindow(s,c){let f=this._lastPoint;if(f){if(s.preventDefault(),this._eventButton!=null&&function(y,b){let E=hg[b];return y.buttons===void 0||(y.buttons&E)!==E}(s,this._eventButton))this.reset();else if(this._moved||!(c.dist(f)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(f,c)}}mouseupWindow(s){this._lastPoint&&ut(s)===this._eventButton&&(this._moved&&ye(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class I_ extends pg{mousedown(s,c){super.mousedown(s,c),this._lastPoint&&(this._active=!0)}_correctButton(s,c){return c===0&&!s.ctrlKey}_move(s,c){return{around:c,panDelta:c.sub(s)}}}class Cu extends pg{constructor(s){super(s),this._pitchRotateKey=s.pitchRotateKey?Ob[s.pitchRotateKey]:void 0}_correctButton(s,c){return this._pitchRotateKey?c===0&&s[this._pitchRotateKey]:c===0&&s.ctrlKey||c===2}_move(s,c){let f=.8*(c.x-s.x);if(f)return this._active=!0,{bearingDelta:f}}contextmenu(s){this._pitchRotateKey||s.preventDefault()}}class fg extends pg{constructor(s){super(s),this._pitchRotateKey=s.pitchRotateKey?Ob[s.pitchRotateKey]:void 0}_correctButton(s,c){return this._pitchRotateKey?c===0&&s[this._pitchRotateKey]:c===0&&s.ctrlKey||c===2}_move(s,c){let f=-.5*(c.y-s.y);if(f)return this._active=!0,{pitchDelta:f}}contextmenu(s){this._pitchRotateKey||s.preventDefault()}}class Mo{constructor(s,c){this._map=s,this._el=s.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),r.aQ(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new r.P(0,0)}touchstart(s,c,f){return this._calculateTransform(s,c,f)}touchmove(s,c,f){if(this._active&&!(f.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(f.length===1&&!r.dC())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return s.cancelable&&s.preventDefault(),this._calculateTransform(s,c,f)}}touchend(s,c,f){this._calculateTransform(s,c,f),this._active&&f.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,c,f){f.length>0&&(this._active=!0);let y=Zr(f,c),b=new r.P(0,0),E=new r.P(0,0),R=0;for(let L in y){let F=y[L],j=this._touches[L];j&&(b._add(F),E._add(F.sub(j)),R++,y[L]=F)}if(this._touches=y,R<this._minTouches||!E.mag())return;let P=E.div(R);return this._sum._add(P),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(R),panDelta:P}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Z("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class uc{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(s){}_move(s,c,f){return{}}touchstart(s,c,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([c[0],c[1]]))}touchmove(s,c,f){let y=this._firstTwoTouches;if(!y)return;s.preventDefault();let[b,E]=y,R=wf(f,c,b),P=wf(f,c,E);if(!R||!P)return;let L=this._aroundCenter?null:R.add(P).div(2);return this._move([R,P],L,s)}touchend(s,c,f){if(!this._firstTwoTouches)return;let[y,b]=this._firstTwoTouches,E=wf(f,c,y),R=wf(f,c,b);E&&R||(this._active&&ye(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function wf(m,s,c){for(let f=0;f<m.length;f++)if(m[f].identifier===c)return s[f]}function mg(m,s){return Math.log(m/s)/Math.LN2}class LE extends uc{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,c){let f=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(mg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:mg(this._distance,f),pinchAround:c}}}function FE(m,s){return 180*m.angleWith(s)/Math.PI}class gg extends uc{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,c){let f=this._vector;if(this._vector=s[0].sub(s[1]),f&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:FE(this._vector,f),pinchAround:c}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());let c=25/(Math.PI*this._minDiameter)*360,f=this._startVector;if(!f)return!1;let y=FE(s,f);return Math.abs(y)<c}}function Pb(m){return Math.abs(m.y)>Math.abs(m.x)}class FI extends uc{constructor(s){super(),this._map=s}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(s){this._lastPoints=s,Pb(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,c,f){let y=this._lastPoints;if(!y)return;let b=s[0].sub(y[0]),E=s[1].sub(y[1]);return this._map._cooperativeGestures&&!r.dC()&&f.touches.length<3||(this._valid=this.gestureBeginsVertically(b,E,f.timeStamp),!this._valid)?void 0:(this._lastPoints=s,this._active=!0,{pitchDelta:(b.y+E.y)/2*-.5})}gestureBeginsVertically(s,c,f){if(this._valid!==void 0)return this._valid;let y=s.mag()>=2,b=c.mag()>=2;if(!y&&!b)return;if(!y||!b)return this._firstMove==null&&(this._firstMove=f),f-this._firstMove<100&&void 0;let E=s.y>0==c.y>0;return Pb(s)&&Pb(c)&&E}}let Nb={panStep:100,bearingStep:15,pitchStep:10};class Lb{constructor(){let s=Nb;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let c=0,f=0,y=0,b=0,E=0;switch(s.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:s.shiftKey?f=-1:(s.preventDefault(),b=-1);break;case 39:s.shiftKey?f=1:(s.preventDefault(),b=1);break;case 38:s.shiftKey?y=1:(s.preventDefault(),E=-1);break;case 40:s.shiftKey?y=-1:(s.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(f=0,y=0),{cameraAnimation:R=>{let P=R.getZoom();R.easeTo({duration:300,easeId:"keyboardHandler",easing:_g,zoom:c?Math.round(P)+c*(s.shiftKey?2:1):P,bearing:R.getBearing()+f*this._bearingStep,pitch:R.getPitch()+y*this._pitchStep,offset:[-b*this._panStep,-E*this._panStep],center:R.getCenter()},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function _g(m){return m*(2-m)}let dp=4.000244140625,md=1/450;class Yc{constructor(s,c){this._map=s,this._el=s.getCanvasContainer(),this._handler=c,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=md,r.aQ(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(s){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(s.ctrlKey||s.metaKey||this.isZooming()||r.dC()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY,f=r.q.now(),y=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,c!==0&&c%dp==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=c,this._timeout=window.setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(y*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),s.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=s,this._delta-=c,this._active||this._start(s)),s.preventDefault()}_onTimeout(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let c=vt(this._el,s);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let s=this._map.transform;this._type==="wheel"&&s.projection.wrap&&(s._center.lng>=180||s._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);let c=()=>s._terrainEnabled()&&this._aroundCoord?s.computeZoomRelativeTo(this._aroundCoord):s.zoom;if(this._delta!==0){let L=this._type==="wheel"&&Math.abs(this._delta)>dp?this._wheelZoomRate:this._defaultZoomRate,F=2/(1+Math.exp(-Math.abs(this._delta*L)));this._delta<0&&F!==0&&(F=1/F);let j=c(),U=Math.pow(2,j),W=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):U;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(W*F))),this._type==="wheel"&&(this._startZoom=j,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}let f=typeof this._targetZoom=="number"?this._targetZoom:c(),y=this._startZoom,b=this._easing,E,R=!1;if(this._type==="wheel"&&y&&b){let L=Math.min((r.q.now()-this._lastWheelEventTime)/200,1),F=b(L);E=r.ah(y,f,F),L<1?this._frameId||(this._frameId=!0):R=!0}else E=f,R=!0;this._active=!0,R&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let P=E-c();return P*this._lastDelta<0&&(P=0),{noInertia:!0,needsRenderFrame:!R,zoomDelta:P,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let c=r.dD;if(this._prevEase){let f=this._prevEase,y=(r.q.now()-f.start)/f.duration,b=f.easing(y+.01)-f.easing(y),E=.27/Math.sqrt(b*b+1e-4)*.01,R=Math.sqrt(.0729-E*E);c=r.dB(E,R,.25,1)}return this._prevEase={start:r.q.now(),duration:s,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Z("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class _h{constructor(s,c){this._clickZoom=s,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class hp{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(s,c){return s.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:f.getZoom()+(s.shiftKey?-1:1),around:f.unproject(c)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yh{constructor(){this._tap=new kb({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(s,c,f){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?f.length>0&&(this._swipePoint=c[0],this._swipeTouch=f[0].identifier):this._tap.touchstart(s,c,f))}touchmove(s,c,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;let y=c[0],b=y.y-this._swipePoint.y;return this._swipePoint=y,s.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(s,c,f)}touchend(s,c,f){this._tapTime?this._swipePoint&&f.length===0&&this.reset():this._tap.touchend(s,c,f)&&(this._tapTime=s.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zI{constructor(s,c,f){this._el=s,this._mousePan=c,this._touchPan=f}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class BI{constructor(s,c,f){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=c,this._mousePitch=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class VI{constructor(s,c,f,y){this._el=s,this._touchZoom=c,this._touchRotate=f,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}let A_=m=>m.zoom||m.drag||m.pitch||m.rotate;class zE extends r.A{}class As{constructor(){this.constants=[1,1,.01],this.radius=0}setup(s,c){let f=r.ad.vec3.sub([],c,s);this.radius=r.ad.vec3.length(f[2]<0?r.ad.vec3.div([],f,this.constants):[f[0],f[1],0])}projectRay(s){r.ad.vec3.div(s,s,this.constants),r.ad.vec3.normalize(s,s),r.ad.vec3.mul(s,s,this.constants);let c=r.ad.vec3.scale([],s,this.radius);if(c[2]>0){let f=r.ad.vec3.scale([],[0,0,1],r.ad.vec3.dot(c,[0,0,1])),y=r.ad.vec3.scale([],r.ad.vec3.normalize([],[c[0],c[1],0]),this.radius),b=r.ad.vec3.add([],c,r.ad.vec3.scale([],r.ad.vec3.sub([],r.ad.vec3.add([],y,f),c),2));c[0]=b[0],c[1]=b[1]}return c}}function Ef(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class BE{constructor(s,c){this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new kE(s),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new As,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),r.aQ(["handleEvent","handleWindowEvent"],this);let f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(let[y,b,E]of this._listeners){let R=y===document?this.handleWindowEvent:this.handleEvent;y.addEventListener(b,R,E)}}destroy(){for(let[s,c,f]of this._listeners){let y=s===document?this.handleWindowEvent:this.handleEvent;s.removeEventListener(c,y,f)}}_addDefaultHandlers(s){let c=this._map,f=c.getCanvasContainer();this._add("mapEvent",new PE(c,s));let y=c.boxZoom=new NI(c,s);this._add("boxZoom",y);let b=new LI,E=new hp;c.doubleClickZoom=new _h(E,b),this._add("tapZoom",b),this._add("clickZoom",E);let R=new yh;this._add("tapDragZoom",R);let P=c.touchPitch=new FI(c);this._add("touchPitch",P);let L=new Cu(s),F=new fg(s);c.dragRotate=new BI(s,L,F),this._add("mouseRotate",L,["mousePitch"]),this._add("mousePitch",F,["mouseRotate"]);let j=new I_(s),U=new Mo(c,s);c.dragPan=new zI(f,j,U),this._add("mousePan",j),this._add("touchPan",U,["touchZoom","touchRotate"]);let W=new gg,ie=new LE;c.touchZoomRotate=new VI(f,ie,W,R),this._add("touchRotate",W,["touchPan","touchZoom"]),this._add("touchZoom",ie,["touchPan","touchRotate"]),this._add("blockableMapEvent",new PI(c));let Q=c.scrollZoom=new Yc(c,this);this._add("scrollZoom",Q,["mousePan"]);let re=c.keyboard=new Lb;this._add("keyboard",re);for(let oe of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])s.interactive&&s[oe]&&c[oe].enable(s[oe])}_add(s,c,f){this._handlers.push({handlerName:s,handler:c,allowed:f}),this._handlersById[s]=c}stop(s){if(!this._updatingCamera){for(let{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[],this._originalZoom=void 0}}isActive(){for(let{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!A_(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(s,c,f){for(let y in s)if(y!==f&&(!c||c.indexOf(y)<0))return!0;return!1}handleWindowEvent(s){this.handleEvent(s,`${s.type}Window`)}_getMapTouches(s){let c=[];for(let f of s)this._el.contains(f.target)&&c.push(f);return c}handleEvent(s,c){this._updatingCamera=!0;let f=s.type==="renderFrame",y=f?void 0:s,b={needsRenderFrame:!1},E={},R={},P=s.touches?this._getMapTouches(s.touches):void 0,L=P?Rt(this._el,P):f?void 0:vt(this._el,s);for(let{handlerName:U,handler:W,allowed:ie}of this._handlers){if(!W.isEnabled())continue;let Q;this._blockedByActive(R,ie,U)?W.reset():W[c||s.type]&&(Q=W[c||s.type](s,L,P),this.mergeHandlerResult(b,E,Q,U,y),Q&&Q.needsRenderFrame&&this._triggerRenderFrame()),(Q||W.isActive())&&(R[U]=W)}let F={};for(let U in this._previousActiveHandlers)R[U]||(F[U]=y);this._previousActiveHandlers=R,(Object.keys(F).length||Ef(b))&&(this._changes.push([b,E,F]),this._triggerRenderFrame()),(Object.keys(R).length||Ef(b))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:j}=b;j&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],j(this._map))}mergeHandlerResult(s,c,f,y,b){if(!f)return;r.l(s,f);let E={handlerName:y,originalEvent:f.originalEvent||b};f.zoomDelta!==void 0&&(c.zoom=E),f.panDelta!==void 0&&(c.drag=E),f.pitchDelta!==void 0&&(c.pitch=E),f.bearingDelta!==void 0&&(c.rotate=E)}_applyChanges(){let s={},c={},f={};for(let[y,b,E]of this._changes)y.panDelta&&(s.panDelta=(s.panDelta||new r.P(0,0))._add(y.panDelta)),y.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+y.pitchDelta),y.around!==void 0&&(s.around=y.around),y.aroundCoord!==void 0&&(s.aroundCoord=y.aroundCoord),y.pinchAround!==void 0&&(s.pinchAround=y.pinchAround),y.noInertia&&(s.noInertia=y.noInertia),r.l(c,b),r.l(f,E);this._updateMapTransform(s,c,f),this._changes=[]}_updateMapTransform(s,c,f){let y=this._map,b=y.transform,E=me=>[me.x,me.y,me.z];if((me=>{let Me=this._eventsInProgress.drag;return Me&&!this._handlersById[Me.handlerName].isActive()})()&&!Ef(s)){let me=b.zoom;b.cameraElevationReference="sea",this._originalZoom!=null&&b._orthographicProjectionAtLowPitch&&b.projection.name!=="globe"&&b.pitch===0?(b.cameraElevationReference="ground",b.zoom=this._originalZoom):(b.recenterOnTerrain(),b.cameraElevationReference="ground"),me!==b.zoom&&this._map._update(!0)}if(b._isCameraConstrained&&y._stop(!0),!Ef(s))return void this._fireEvents(c,f,!0);let{panDelta:R,zoomDelta:P,bearingDelta:L,pitchDelta:F,around:j,aroundCoord:U,pinchAround:W}=s;b._isCameraConstrained&&(P>0&&(P=0),b._isCameraConstrained=!1),W!==void 0&&(j=W),(P||(me=>c[me]&&!this._eventsInProgress[me])("drag"))&&j&&(this._dragOrigin=E(b.pointCoordinate3D(j)),this._originalZoom=b.zoom,this._trackingEllipsoid.setup(b._camera.position,this._dragOrigin)),b.cameraElevationReference="sea",y._stop(!0),j=j||y.transform.centerPoint,L&&(b.bearing+=L),F&&(b.pitch+=F),b._updateCameraState();let ie=[0,0,0];if(R)if(b.projection.name==="mercator"){let me=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(j).dir),Me=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(j.sub(R)).dir);ie[0]=Me[0]-me[0],ie[1]=Me[1]-me[1]}else{let me=b.pointCoordinate(j);if(b.projection.name==="globe"){R=R.rotate(-b.angle);let Me=b._pixelsPerMercatorPixel/b.worldSize;ie[0]=-R.x*r.dE(r.aT(me.y))*Me,ie[1]=-R.y*r.dE(b.center.lat)*Me}else{let Me=b.pointCoordinate(j.sub(R));me&&Me&&(ie[0]=Me.x-me.x,ie[1]=Me.y-me.y)}}let Q=b.zoom,re=[0,0,0];if(P){let me=E(U||b.pointCoordinate3D(j)),Me={dir:r.ad.vec3.normalize([],r.ad.vec3.sub([],me,b._camera.position))};if(Me.dir[2]<0){let Ee=b.zoomDeltaToMovement(me,P);r.ad.vec3.scale(re,Me.dir,Ee)}}let oe=r.ad.vec3.add(ie,ie,re);b._translateCameraConstrained(oe),P&&Math.abs(b.zoom-Q)>1e-4&&b.recenterOnTerrain(),b.cameraElevationReference="ground",this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(c,f,!0)}_fireEvents(s,c,f){let y=A_(this._eventsInProgress),b=A_(s),E={};for(let F in s){let{originalEvent:j}=s[F];this._eventsInProgress[F]||(E[`${F}start`]=j),this._eventsInProgress[F]=s[F]}!y&&b&&this._fireEvent("movestart",b.originalEvent);for(let F in E)this._fireEvent(F,E[F]);b&&this._fireEvent("move",b.originalEvent);for(let F in s){let{originalEvent:j}=s[F];this._fireEvent(F,j)}let R={},P;for(let F in this._eventsInProgress){let{handlerName:j,originalEvent:U}=this._eventsInProgress[F];this._handlersById[j].isActive()||(delete this._eventsInProgress[F],P=c[j]||U,R[`${F}end`]=P)}for(let F in R)this._fireEvent(F,R[F]);let L=A_(this._eventsInProgress);if(f&&(y||b)&&!L){this._updatingCamera=!0;let F=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),j=U=>U!==0&&-this._bearingSnap<U&&U<this._bearingSnap;F?(j(F.bearing||this._map.getBearing())&&(F.bearing=0),this._map.easeTo(F,{originalEvent:P})):(this._map.fire(new r.A("moveend",{originalEvent:P})),j(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(s,c){this._map.fire(new r.A(s,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{this._frameId=void 0,this.handleEvent(new zE("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}let VE="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Cf extends r.E{constructor(s,c){super(),this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=c.bearingSnap,this._respectPrefersReducedMotion=c.respectPrefersReducedMotion!==!1,r.aQ(["_renderFrameCallback"],this)}getCenter(){return new r.bO(this.transform.center.lng,this.transform.center.lat)}setCenter(s,c){return this.jumpTo({center:s},c)}panBy(s,c,f){return s=r.P.convert(s).mult(-1),this.panTo(this.transform.center,r.l({offset:s},c),f)}panTo(s,c,f){return this.easeTo(r.l({center:s},c),f)}getZoom(){return this.transform.zoom}setZoom(s,c){return this.jumpTo({zoom:s},c),this}zoomTo(s,c,f){return this.easeTo(r.l({zoom:s},c),f)}zoomIn(s,c){return this.zoomTo(this.getZoom()+1,s,c),this}zoomOut(s,c){return this.zoomTo(this.getZoom()-1,s,c),this}getBearing(){return this.transform.bearing}setBearing(s,c){return this.jumpTo({bearing:s},c),this}getPadding(){return this.transform.padding}setPadding(s,c){return this.jumpTo({padding:s},c),this}rotateTo(s,c,f){return this.easeTo(r.l({bearing:s},c),f)}resetNorth(s,c){return this.rotateTo(0,r.l({duration:1e3},s),c),this}resetNorthPitch(s,c){return this.easeTo(r.l({bearing:0,pitch:0,duration:1e3},s),c),this}snapToNorth(s,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,c):this}getPitch(){return this.transform.pitch}setPitch(s,c){return this.jumpTo({pitch:s},c),this}cameraForBounds(s,c){s=r.aB.convert(s);let f=c&&c.bearing||0,y=c&&c.pitch||0,b=s.getNorthWest(),E=s.getSouthEast();return this._cameraForBounds(this.transform,b,E,f,y,c)}_extendPadding(s){let c={top:0,right:0,bottom:0,left:0};return s==null?r.l({},c,this.transform.padding):typeof s=="number"?{top:s,bottom:s,right:s,left:s}:r.l({},c,s)}_extendCameraOptions(s){return(s=r.l({offset:[0,0],maxZoom:this.transform.maxZoom},s)).padding=this._extendPadding(s.padding),s}_minimumAABBFrustumDistance(s,c){let f=c.max[0]-c.min[0],y=c.max[1]-c.min[1];return f/y>s.aspect?f/(2*Math.tan(.5*s.fovX)*s.aspect):y/(2*Math.tan(.5*s.fovY)*s.aspect)}_cameraForBoundsOnGlobe(s,c,f,y,b,E){let R=s.clone(),P=this._extendCameraOptions(E);R.bearing=y,R.pitch=b;let L=r.bO.convert(c),F=r.bO.convert(f),j=.5*(L.lat+F.lat),U=.5*(L.lng+F.lng),W=r.dF(j,U),ie=r.ad.vec3.normalize([],W),Q=r.ad.vec3.normalize([],r.ad.vec3.cross([],ie,[0,1,0])),re=r.ad.vec3.cross([],Q,ie),oe=[Q[0],Q[1],Q[2],0,re[0],re[1],re[2],0,ie[0],ie[1],ie[2],0,0,0,0,1],me=[W,r.dF(L.lat,L.lng),r.dF(F.lat,L.lng),r.dF(F.lat,F.lng),r.dF(L.lat,F.lng),r.dF(j,L.lng),r.dF(j,F.lng),r.dF(L.lat,U),r.dF(F.lat,U)],Me=r.ce.fromPoints(me.map(_t=>[r.ad.vec3.dot(Q,_t),r.ad.vec3.dot(re,_t),r.ad.vec3.dot(ie,_t)])),Ee=r.ad.vec3.transformMat4([],Me.center,oe);r.ad.vec3.squaredLength(Ee)===0&&r.ad.vec3.set(Ee,0,0,1),r.ad.vec3.normalize(Ee,Ee),r.ad.vec3.scale(Ee,Ee,r.az),R.center=r.dG(Ee);let Le=R.getWorldToCameraMatrix(),Ie=r.ad.mat4.invert(new Float64Array(16),Le);Me=r.ce.applyTransform(Me,r.ad.mat4.multiply([],Le,oe));let Ae=this._extendAABB(Me,R,P,y);if(!Ae)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Me=Ae,r.ad.vec3.transformMat4(Ee,Ee,Le);let Re=.5*(Me.max[2]-Me.min[2]),Ve=this._minimumAABBFrustumDistance(R,Me),qe=r.ad.vec3.scale([],[0,0,1],Re),dt=r.ad.vec3.add(qe,Ee,qe),nt=Ve+(R.pitch===0?0:r.ad.vec3.distance(Ee,dt)),Et=R.globeCenterInViewSpace,Ct=r.ad.vec3.sub([],Ee,[Et[0],Et[1],Et[2]]);r.ad.vec3.normalize(Ct,Ct),r.ad.vec3.scale(Ct,Ct,nt);let Ut=r.ad.vec3.add([],Ee,Ct);r.ad.vec3.transformMat4(Ut,Ut,Ie);let tt=r.dv/r.az,xt=r.ad.vec3.length(Ut),Qe=r.bH(Math.max(xt*tt-r.dv,Number.EPSILON),0),bt=Math.min(R.zoomFromMercatorZAdjusted(Qe),P.maxZoom);return bt>.5*(r.c6+r.bY)?(R.setProjection({name:"mercator"}),R.zoom=bt,this._cameraForBounds(R,c,f,y,b,E)):{center:R.center,zoom:bt,bearing:y,pitch:b}}_extendAABB(s,c,f,y){let b=.5*((f.padding.left||0)+(f.padding.right||0)),E=.5*((f.padding.top||0)+(f.padding.bottom||0)),R=E,P=b,L=b,F=E,j=c.width-(P+L),U=c.height-(R+F),W=r.ad.vec3.sub([],s.max,s.min),ie=Math.min(j/W[0],U/W[1]),Q=Math.min(c.scaleZoom(c.scale*ie),f.maxZoom);if(isNaN(Q))return null;let re=c.scale/c.zoomScale(Q),oe=new r.ce([s.min[0]-P*re,s.min[1]-F*re,s.min[2]],[s.max[0]+L*re,s.max[1]+R*re,s.max[2]]),me=(typeof f.offset.x=="number"&&typeof f.offset.y=="number"?new r.P(f.offset.x,f.offset.y):r.P.convert(f.offset)).rotate(-r.ak(y));return oe.center[0]-=me.x*re,oe.center[1]+=me.y*re,oe}queryTerrainElevation(s,c){let f=this.transform.elevation;return f?(c=r.l({},{exaggerated:!0},c),f.getAtPoint(r.ac.fromLngLat(s),null,c.exaggerated)):null}_cameraForBounds(s,c,f,y,b,E){if(s.projection.name==="globe")return this._cameraForBoundsOnGlobe(s,c,f,y,b,E);let R=s.clone(),P=this._extendCameraOptions(E);R.bearing=y,R.pitch=b;let L=r.bO.convert(c),F=r.bO.convert(f),j=new r.bO(L.lng,F.lat),U=new r.bO(F.lng,L.lat),W=R.project(L),ie=R.project(F),Q=this.queryTerrainElevation(L),re=this.queryTerrainElevation(F),oe=this.queryTerrainElevation(j),me=this.queryTerrainElevation(U),Me=[[W.x,W.y,Math.min(Q||0,re||0,oe||0,me||0)],[ie.x,ie.y,Math.max(Q||0,re||0,oe||0,me||0)]],Ee=r.ce.fromPoints(Me),Le=R.getWorldToCameraMatrix(),Ie=r.ad.mat4.invert(new Float64Array(16),Le);Ee=r.ce.applyTransform(Ee,Le);let Ae=this._extendAABB(Ee,R,P,y);if(!Ae)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ee=Ae;let Re=.5*r.ad.vec3.sub([],Ee.max,Ee.min)[2],Ve=this._minimumAABBFrustumDistance(R,Ee),qe=[0,0,1,0];r.ad.vec4.transformMat4(qe,qe,Le),r.ad.vec4.normalize(qe,qe);let dt=r.ad.vec3.scale([],qe,Ve+Re),nt=r.ad.vec3.add([],Ee.center,dt);r.ad.vec3.transformMat4(Ee.center,Ee.center,Ie),r.ad.vec3.transformMat4(nt,nt,Ie);let Et=R.unproject(new r.P(Ee.center[0],Ee.center[1])),Ct=r.dH(R.projection,Et),Ut=Math.pow(2,Ct),tt=Math.min(R._zoomFromMercatorZ(nt[2]*R.pixelsPerMeter*Ut/R.worldSize),P.maxZoom);return R.mercatorFromTransition&&tt<.5*(r.c6+r.bY)?(R.setProjection({name:"globe"}),R.zoom=tt,this._cameraForBounds(R,c,f,y,b,E)):{center:Et,zoom:tt,bearing:y,pitch:b}}fitBounds(s,c,f){let y=this.cameraForBounds(s,c);return this._fitInternal(y,c,f)}fitScreenCoordinates(s,c,f,y,b){let E=r.P.convert(s),R=r.P.convert(c),P=new r.P(Math.min(E.x,R.x),Math.min(E.y,R.y)),L=new r.P(Math.max(E.x,R.x),Math.max(E.y,R.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(E,R))return this;let F=this.transform.pointLocation3D(P),j=this.transform.pointLocation3D(L),U=this.transform.pointLocation3D(new r.P(P.x,L.y)),W=this.transform.pointLocation3D(new r.P(L.x,P.y)),ie=[Math.min(F.lng,j.lng,U.lng,W.lng),Math.min(F.lat,j.lat,U.lat,W.lat)],Q=[Math.max(F.lng,j.lng,U.lng,W.lng),Math.max(F.lat,j.lat,U.lat,W.lat)],re=y&&y.pitch?y.pitch:this.getPitch(),oe=this._cameraForBounds(this.transform,ie,Q,f,re,y);return this._fitInternal(oe,y,b)}_fitInternal(s,c,f){return s?(c=r.l(s,c)).linear?this.easeTo(c,f):this.flyTo(c,f):this}jumpTo(s,c){this.stop();let f=s.preloadOnly?this.transform.clone():this.transform,y=!1,b=!1,E=!1;"zoom"in s&&f.zoom!==+s.zoom&&(y=!0,f.zoom=+s.zoom),s.center!==void 0&&(f.center=r.bO.convert(s.center)),"bearing"in s&&f.bearing!==+s.bearing&&(b=!0,f.bearing=+s.bearing),"pitch"in s&&f.pitch!==+s.pitch&&(E=!0,f.pitch=+s.pitch);let R=typeof s.padding=="number"?this._extendPadding(s.padding):s.padding;if(s.padding!=null&&!f.isPaddingEqual(R))if(s.retainPadding===!1){let P=f.clone();P.padding=R,f.setLocationAtPoint(f.center,P.centerPoint)}else f.padding=R;return s.preloadOnly?(this._preloadTiles(f),this):(this.fire(new r.A("movestart",c)).fire(new r.A("move",c)),y&&this.fire(new r.A("zoomstart",c)).fire(new r.A("zoom",c)).fire(new r.A("zoomend",c)),b&&this.fire(new r.A("rotatestart",c)).fire(new r.A("rotate",c)).fire(new r.A("rotateend",c)),E&&this.fire(new r.A("pitchstart",c)).fire(new r.A("pitch",c)).fire(new r.A("pitchend",c)),this.fire(new r.A("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||r.w(VE),this.transform.getFreeCameraOptions()}setFreeCameraOptions(s,c){let f=this.transform;if(!f.projection.supportsFreeCamera)return r.w(VE),this;this.stop();let y=f.zoom,b=f.pitch,E=f.bearing;f.setFreeCameraOptions(s);let R=y!==f.zoom,P=b!==f.pitch,L=E!==f.bearing;return this.fire(new r.A("movestart",c)).fire(new r.A("move",c)),R&&this.fire(new r.A("zoomstart",c)).fire(new r.A("zoom",c)).fire(new r.A("zoomend",c)),L&&this.fire(new r.A("rotatestart",c)).fire(new r.A("rotate",c)).fire(new r.A("rotateend",c)),P&&this.fire(new r.A("pitchstart",c)).fire(new r.A("pitch",c)).fire(new r.A("pitchend",c)),this.fire(new r.A("moveend",c)),this}easeTo(s,c){this._stop(!1,s.easeId),((s=r.l({offset:[0,0],duration:500,easing:r.dD},s)).animate===!1||this._prefersReducedMotion(s))&&(s.duration=0);let f=this.transform,y=this.getZoom(),b=this.getBearing(),E=this.getPitch(),R=this.getPadding(),P="zoom"in s?+s.zoom:y,L="bearing"in s?this._normalizeBearing(s.bearing,b):b,F="pitch"in s?+s.pitch:E,j=this._extendPadding(s.padding),U=r.P.convert(s.offset),W,ie,Q;if(f.projection.name==="globe"){let qe=r.ac.fromLngLat(f.center),dt=U.rotate(-f.angle);qe.x+=dt.x/f.worldSize,qe.y+=dt.y/f.worldSize;let nt=qe.toLngLat(),Et=r.bO.convert(s.center||nt);this._normalizeCenter(Et),W=f.centerPoint.add(dt),ie=new r.P(qe.x,qe.y).mult(f.worldSize),Q=new r.P(r.av(Et.lng),r.aC(Et.lat)).mult(f.worldSize).sub(ie)}else{W=f.centerPoint.add(U);let qe=f.pointLocation(W),dt=r.bO.convert(s.center||qe);this._normalizeCenter(dt),ie=f.project(qe),Q=f.project(dt).sub(ie)}let re=f.zoomScale(P-y),oe,me;s.around&&(oe=r.bO.convert(s.around),me=f.locationPoint(oe));let Me=this._zooming||P!==y,Ee=this._rotating||b!==L,Le=this._pitching||F!==E,Ie=!f.isPaddingEqual(j),Ae=s.retainPadding===!1?f.clone():f,Re=qe=>dt=>{if(Me&&(qe.zoom=r.ah(y,P,dt)),Ee&&(qe.bearing=r.ah(b,L,dt)),Le&&(qe.pitch=r.ah(E,F,dt)),Ie&&(Ae.interpolatePadding(R,j,dt),W=Ae.centerPoint.add(U)),oe)qe.setLocationAtPoint(oe,me);else{let nt=qe.zoomScale(qe.zoom-y),Et=P>y?Math.min(2,re):Math.max(.5,re),Ct=Math.pow(Et,1-dt),Ut=qe.unproject(ie.add(Q.mult(dt*Ct)).mult(nt));qe.setLocationAtPoint(qe.renderWorldCopies?Ut.wrap():Ut,W)}return s.preloadOnly||this._fireMoveEvents(c),qe};if(s.preloadOnly){let qe=this._emulate(Re,s.duration,f);return this._preloadTiles(qe),this}let Ve={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Me,this._rotating=Ee,this._pitching=Le,this._padding=Ie,this._easeId=s.easeId,this._prepareEase(c,s.noMoveStart,Ve),this._ease(Re(f),qe=>{f.cameraElevationReference==="sea"&&f.recenterOnTerrain(),this._afterEase(c,qe)},s),this}_prepareEase(s,c,f={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),c||f.moving||this.fire(new r.A("movestart",s)),this._zooming&&!f.zooming&&this.fire(new r.A("zoomstart",s)),this._rotating&&!f.rotating&&this.fire(new r.A("rotatestart",s)),this._pitching&&!f.pitching&&this.fire(new r.A("pitchstart",s))}_fireMoveEvents(s){this.fire(new r.A("move",s)),this._zooming&&this.fire(new r.A("zoom",s)),this._rotating&&this.fire(new r.A("rotate",s)),this._pitching&&this.fire(new r.A("pitch",s))}_afterEase(s,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";let f=this._zooming,y=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new r.A("zoomend",s)),y&&this.fire(new r.A("rotateend",s)),b&&this.fire(new r.A("pitchend",s)),this.fire(new r.A("moveend",s))}flyTo(s,c){if(this._prefersReducedMotion(s)){let _t=r.aA(s,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(_t,c)}this.stop(),s=r.l({offset:[0,0],speed:1.2,curve:1.42,easing:r.dD},s);let f=this.transform,y=this.getZoom(),b=this.getBearing(),E=this.getPitch(),R=this.getPadding(),P="zoom"in s?r.ay(+s.zoom,f.minZoom,f.maxZoom):y,L="bearing"in s?this._normalizeBearing(s.bearing,b):b,F="pitch"in s?+s.pitch:E,j=this._extendPadding(s.padding),U=f.zoomScale(P-y),W=r.P.convert(s.offset),ie=f.centerPoint.add(W),Q=f.pointLocation(ie),re=r.bO.convert(s.center||Q);this._normalizeCenter(re);let oe=f.project(Q),me=f.project(re).sub(oe),Me=s.curve,Ee=Math.max(f.width,f.height),Le=Ee/U,Ie=me.mag();if("minZoom"in s){let _t=r.ay(Math.min(s.minZoom,y,P),f.minZoom,f.maxZoom),St=Ee/f.zoomScale(_t-y);Me=Math.sqrt(St/Ie*2)}let Ae=Me*Me;function Re(_t){let St=(Le*Le-Ee*Ee+(_t?-1:1)*Ae*Ae*Ie*Ie)/(2*(_t?Le:Ee)*Ae*Ie);return Math.log(Math.sqrt(St*St+1)-St)}function Ve(_t){return(Math.exp(_t)-Math.exp(-_t))/2}function qe(_t){return(Math.exp(_t)+Math.exp(-_t))/2}let dt=Re(0),nt=function(_t){return qe(dt)/qe(dt+Me*_t)},Et=function(_t){return Ee*((qe(dt)*(Ve(St=dt+Me*_t)/qe(St))-Ve(dt))/Ae)/Ie;var St},Ct=(Re(1)-dt)/Me;if(Math.abs(Ie)<1e-6||!isFinite(Ct)){if(Math.abs(Ee-Le)<1e-6)return this.easeTo(s,c);let _t=Le<Ee?-1:1;Ct=Math.abs(Math.log(Le/Ee))/Me,Et=function(){return 0},nt=function(St){return Math.exp(_t*Me*St)}}s.duration="duration"in s?+s.duration:1e3*Ct/("screenSpeed"in s?+s.screenSpeed/Me:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0);let Ut=b!==L,tt=F!==E,xt=!f.isPaddingEqual(j),Qe=s.retainPadding===!1?f.clone():f,bt=_t=>St=>{let ht=St*Ct,At=1/nt(ht);_t.zoom=St===1?P:y+_t.scaleZoom(At),Ut&&(_t.bearing=r.ah(b,L,St)),tt&&(_t.pitch=r.ah(E,F,St)),xt&&(Qe.interpolatePadding(R,j,St),ie=Qe.centerPoint.add(W));let Kt=St===1?re:_t.unproject(oe.add(me.mult(Et(ht))).mult(At));return _t.setLocationAtPoint(_t.renderWorldCopies?Kt.wrap():Kt,ie),_t._updateCameraOnTerrain(),s.preloadOnly||this._fireMoveEvents(c),_t};if(s.preloadOnly){let _t=this._emulate(bt,s.duration,f);return this._preloadTiles(_t),this}return this._zooming=!0,this._rotating=Ut,this._pitching=tt,this._padding=xt,this._prepareEase(c,!1),this._ease(bt(f),()=>this._afterEase(c),s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(s){}_cancelRenderFrame(s){}_stop(s,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){let f=this._onEaseEnd;this._onEaseEnd=void 0,f.call(this,c)}if(!s){let f=this.handlers;f&&f.stop(!1)}return this}_ease(s,c,f){f.animate===!1||f.duration===0?(s(1),c()):(this._easeStart=r.q.now(),this._easeOptions=f,this._onEaseFrame=s,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){let s=Math.min((r.q.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(s)),s<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(s,c){s=r.bF(s,-180,180);let f=Math.abs(s-c);return Math.abs(s-360-c)<f&&(s-=360),Math.abs(s+360-c)<f&&(s+=360),s}_normalizeCenter(s){let c=this.transform;if(c.maxBounds||c.projection.name!=="globe"&&!c.renderWorldCopies)return;let f=s.lng-c.center.lng;s.lng+=f>180?-360:f<-180?360:0}_prefersReducedMotion(s){return this._respectPrefersReducedMotion&&r.q.prefersReducedMotion&&!(s&&s.essential)}_emulate(s,c,f){let y=Math.ceil(15*c/1e3),b=[],E=s(f.clone());for(let R=0;R<=y;R++){let P=E(R/y);b.push(P.clone())}return b}_preloadTiles(s,c){}}class R_{constructor(s={}){this.options=s,r.aQ(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(s){let c=this.options&&this.options.compact,f=s._getUIString("AttributionControl.ToggleAttribution");this._map=s,this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Z("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",f);let y=Z("span","mapboxgl-ctrl-icon",this._compactButton);return y.setAttribute("aria-hidden","true"),y.setAttribute("title",f),this._innerContainer=Z("div","mapboxgl-ctrl-attrib-inner",this._container),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),c===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));let c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||r.e.ACCESS_TOKEN}];if(s){let f=c.reduce((y,b,E)=>(b.value&&(y+=`${b.key}=${b.value}${E<c.length-1?"&":""}`),y),"?");s.href=`${r.e.FEEDBACK_URL}/${f}#${Rb(this._map,!0)}`,s.rel="noopener nofollow"}}_updateData(s){!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let s=[];if(this._map.style.stylesheet){let y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}let c=this._map.style._mergedSourceCaches;for(let y in c){let b=c[y];if(b.used){let E=b.getSource();E.attribution&&s.indexOf(E.attribution)<0&&s.push(E.attribution)}}s.sort((y,b)=>y.length-b.length),s=s.filter((y,b)=>{for(let E=b+1;E<s.length;E++)if(s[E].indexOf(y)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=[...this.options.customAttribution,...s]:s.unshift(this.options.customAttribution));let f=s.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,s.length?(this._innerContainer.innerHTML=f,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Fl{constructor(){r.aQ(["_updateLogo","_updateCompact"],this)}onAdd(s){this._map=s,this._container=Z("div","mapboxgl-ctrl");let c=Z("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;let s=this._map.style._sourceCaches;if(Object.entries(s).length===0)return!0;for(let c in s){let f=s[c].getSource();if(f.hasOwnProperty("mapbox_logo")&&!f.mapbox_logo)return!1}return!0}_updateCompact(){let s=this._container.children;if(s.length){let c=s[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class zl{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){let c=++this._id;return this._queue.push({callback:s,id:c,cancelled:!1}),c}remove(s){let c=this._currentlyRunning,f=c?this._queue.concat(c):this._queue;for(let y of f)if(y.id===s)return void(y.cancelled=!0)}run(s=0){let c=this._currentlyRunning=this._queue;this._queue=[];for(let f of c)if(!f.cancelled&&(f.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Sf{constructor(s){this.jumpTo(s)}getValue(s){if(s<=this._startTime)return this._start;if(s>=this._endTime)return this._end;let c=r.cC((s-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(s){return s>=this._startTime&&s<=this._endTime}jumpTo(s){this._startTime=-1/0,this._endTime=-1/0,this._start=s,this._end=s}easeTo(s,c,f){this._start=this.getValue(c),this._end=s,this._startTime=c,this._endTime=c+f}}let pp={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class fp extends r.A{constructor(s,c,f,y){let{point:b,lngLat:E,originalEvent:R,target:P}=s;super(s.type,{point:b,lngLat:E,originalEvent:R,target:P}),this.preventDefault=()=>{s.preventDefault()},this.id=c,this.interaction=f,this.feature=y}}class Fb{constructor(s){this.map=s,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(s,c){if(this.typeById.has(s))throw new Error(`Interaction id "${s}" already exists.`);let f=c.filter,y=c.type;f&&this.filters.set(s,r.a_(f)),y==="mouseover"&&(y="mouseenter"),y==="mouseout"&&(y="mouseleave");let b=this.interactionsByType.get(y)||new Map;y==="mouseenter"||y==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(s,c)):b.size===0&&this.map.on(y,this.handleType),b.size===0&&this.interactionsByType.set(y,b),b.set(s,c),this.typeById.set(s,y)}get(s){let c=this.typeById.get(s);if(!c)return;let f=this.interactionsByType.get(c);return f?f.get(s):void 0}remove(s){let c=this.typeById.get(s);if(!c)return;this.typeById.delete(s),this.filters.delete(s);let f=this.interactionsByType.get(c);f&&(f.delete(s),c==="mouseenter"||c==="mouseleave"?(this.delegatedInteractions.delete(s),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):f.size===0&&this.map.off(c,this.handleType))}queryTargets(s,c){let f=[];for(let[y,b]of c)b.target&&f.push({targetId:y,target:b.target,filter:this.filters.get(y)});return this.map.style.queryRenderedTargets(s,f,this.map.transform)}handleMove(s){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;let c=this.queryTargets(s.point,Array.from(this.delegatedInteractions).reverse());c.length&&(s.type="mouseenter",this.handleType(s,c));let f=new Map;for(let[y,{feature:b}]of this.prevHoveredFeatures)this.hoveredFeatures.has(y)||f.set(b.id,b);f.size&&(s.type="mouseleave",this.handleType(s,Array.from(f.values())))}handleOut(s){let c=Array.from(this.hoveredFeatures.values()).map(({feature:f})=>f);c.length&&(s.type="mouseleave",this.handleType(s,c)),this.hoveredFeatures.clear()}handleType(s,c){let f=Array.from(this.interactionsByType.get(s.type)).reverse(),y=!!c;c=c||this.queryTargets(s.point,f);let b=s.type==="mouseenter",E=!1,R=new Set;for(let P of c){for(let[L,F]of f){if(!F.target)continue;let j=P.variants?P.variants[L]:null;if(j){for(let U of j){if(th(U,P,R,L))continue;let W=new r.cx(P,U),ie=Xh(U,P,L);y&&(W.state=this.map.getFeatureState(W));let Q=b?this.prevHoveredFeatures.get(ie):null,re=new fp(s,L,F,W),oe=Q?Q.stop:F.handler(re);if(b&&this.hoveredFeatures.set(ie,{feature:P,stop:oe}),oe!==!1){E=!0;break}}if(E)break}}if(E)break}if(!E)for(let[P,L]of f){let{handler:F,target:j}=L;if(!j&&F(new fp(s,P,L,null))!==!1)break}}}function er(m,s){if(Array.isArray(m)&&Array.isArray(s)){let c=new Set(m),f=new Set(s);return c.size===f.size&&m.every(y=>f.has(y))}return r.bn(m,s)}let vh={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},jI={showCompass:!0,showZoom:!0,visualizePitch:!1};class UI{constructor(s,c,f=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new Cu({clickTolerance:s.dragRotate._mouseRotate._clickTolerance}),this.map=s,f&&(this.mousePitch=new fg({clickTolerance:s.dragRotate._mousePitch._clickTolerance})),r.aQ(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(s,c){this.mouseRotate.mousedown(s,c),this.mousePitch&&this.mousePitch.mousedown(s,c),he()}move(s,c){let f=this.map,y=this.mouseRotate.mousemoveWindow(s,c),b=y&&y.bearingDelta;if(b&&f.setBearing(f.getBearing()+b),this.mousePitch){let E=this.mousePitch.mousemoveWindow(s,c),R=E&&E.pitchDelta;R&&f.setPitch(f.getPitch()+R)}}off(){let s=this.element;s.removeEventListener("mousedown",this.mousedown),s.removeEventListener("touchstart",this.touchstart,{passive:!1}),s.removeEventListener("touchmove",this.touchmove),s.removeEventListener("touchend",this.touchend),s.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Ce(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(s){this.down(r.l({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),vt(this.element,s)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(s){this.move(s,vt(this.element,s))}mouseup(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()}touchstart(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Rt(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>s.preventDefault()},this._startPos))}touchmove(s){s.targetTouches.length!==1?this.reset():(this._lastPos=Rt(this.element,s.targetTouches)[0],this.move({preventDefault:()=>s.preventDefault()},this._lastPos))}touchend(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function k_(m,s,c){if(m=new r.bO(m.lng,m.lat),s){let f=new r.bO(m.lng-360,m.lat),y=new r.bO(m.lng+360,m.lat),b=360*Math.ceil(Math.abs(m.lng-c.center.lng)/360),E=c.locationPoint3D(m).distSqr(s),R=s.x<0||s.y<0||s.x>c.width||s.y>c.height;c.locationPoint3D(f).distSqr(s)<E&&(R||Math.abs(f.lng-c.center.lng)<b)?m=f:c.locationPoint3D(y).distSqr(s)<E&&(R||Math.abs(y.lng-c.center.lng)<b)&&(m=y)}for(;Math.abs(m.lng-c.center.lng)>180;){let f=c.locationPoint3D(m);if(f.x>=0&&f.y>=0&&f.x<=c.width&&f.y<=c.height)break;m.lng>c.center.lng?m.lng-=360:m.lng+=360}return m}let Su={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},ul={anchor:"center",color:"#3FB1CE",scale:1,draggable:!1,clickTolerance:0,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class $a extends r.E{constructor(s,c){super(),(s instanceof HTMLElement||c)&&(s=r.l({element:s},c)),r.aQ(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),s=r.l({},ul,s),this._anchor=s.anchor,this._color=s.color,this._scale=s.scale,this._draggable=s.draggable,this._clickTolerance=s.clickTolerance,this._rotation=s.rotation,this._rotationAlignment=s.rotationAlignment,this._pitchAlignment=s.pitchAlignment,this._occludedOpacity=s.occludedOpacity,this._altitude=s.altitude,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),s&&s.element?(this._element=s.element,this._offset=r.P.convert(s&&s.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=r.P.convert(s&&s.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",b=>{b.preventDefault()}),this._element.addEventListener("mousedown",b=>{b.preventDefault()});let f=this._element.classList;for(let b in Su)f.remove(`mapboxgl-marker-anchor-${b}`);f.add(`mapboxgl-marker-anchor-${this._anchor}`);let y=s&&s.className?s.className.trim().split(/\s+/):[];f.add(...y),this._popup=null}_createDefaultMarker(){let s=Z("div"),c=X("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},s);if(this._altitude===0){let f=X("radialGradient",{id:"shadowGradient"},X("defs",{},c));X("stop",{offset:"10%","stop-opacity":.4},f),X("stop",{offset:"100%","stop-opacity":.05},f),X("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},c)}return X("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},c),X("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},c),X("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},c),s}addTo(s){return s===this._map||(this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._updateMoving),s.on("moveend",this._update),s.on("remove",this._clearFadeTimer),s._addMarker(this),this.setDraggable(this._draggable),this._update(),s.on("click",this._onMapClick)),this}remove(){let s=this._map;return s&&(s.off("click",this._onMapClick),s.off("move",this._updateMoving),s.off("moveend",this._update),s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler),s.off("mouseup",this._onUp),s.off("touchend",this._onUp),s.off("mousemove",this._onMove),s.off("touchmove",this._onMove),s.off("remove",this._clearFadeTimer),s._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=r.bO.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(s){return s===this._altitude||(this._defaultMarker&&(this._altitude===0&&s!==0||this._altitude!==0&&s===0)&&(this._element=this._createDefaultMarker()),this._altitude=s||ul.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){let y=Math.sqrt(Math.pow(13.5,2)/2);s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,s._marker=this,s._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(s){let c=s.code,f=s.charCode||s.keyCode;c!=="Space"&&c!=="Enter"&&f!==32&&f!==13||this.togglePopup()}_onMapClick(s){let c=s.originalEvent.target,f=this._element;this._popup&&(c===f||f.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){let s=this._popup;return s?(s.isOpen()?(s.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(s.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){let s=this._map,c=this._pos;if(!s||!c)return!1;let f=s.unproject(c,this._altitude),y=s.getFreeCameraOptions();if(!y.position)return!1;let b=y.position.toLngLat();return b.distanceTo(f)<.9*b.distanceTo(this._lngLat)}_evaluateOpacity(){let s=this._map;if(!s)return;let c=this._pos;if(!c||c.x<0||c.x>s.transform.width||c.y<0||c.y>s.transform.height)return void this._clearFadeTimer();let f=s.unproject(c,this._altitude),y;s._showingGlobe()&&r.dK(s.transform,this._lngLat)?y=0:(y=1-s._queryFogOpacity(f),s.transform._terrainEnabled()&&s.getTerrain()&&this._behindTerrain()&&(y*=this._occludedOpacity)),this._element.style.opacity=`${y}`,this._element.style.pointerEvents=y>0?"auto":"none",this._popup&&this._popup._setOpacity(y),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){let s=this._pos;if(!s||!this._map)return;let c=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${s.x}px,${s.y}px)
            ${Su[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${c.x}px,${c.y}px)
        `}_calculateXYTransform(){let s=this._pos,c=this._map,f=this.getPitchAlignment();if(!c||!s||f!=="map")return"";if(!c._showingGlobe()){let P=c.getPitch();return P?`rotateX(${P}deg)`:""}let y=r.c4(r.dL(c.transform,this._lngLat)),b=s.sub(r.dM(c.transform)),E=Math.abs(b.x)+Math.abs(b.y);if(E===0)return"";let R=y/E;return`rotateX(${-b.y*R}deg) rotateY(${b.x*R}deg)`}_calculateZTransform(){let s=this._pos,c=this._map;if(!c||!s)return"";let f=0,y=this.getRotationAlignment();if(y==="map")if(c._showingGlobe()){let b=c.project(new r.bO(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),E=c.project(new r.bO(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(b);f=r.c4(Math.atan2(E.y,E.x))-90}else f=-c.getBearing();else if(y==="horizon"){let b=r.ae(4,6,c.getZoom()),E=r.dM(c.transform);E.y+=b*c.transform.height;let R=s.sub(E),P=r.c4(Math.atan2(R.y,R.x));f=(P>90?P-270:P+90)*(1-b)}return f+=this._rotation,f?`rotateZ(${f}deg)`:""}_update(s){cancelAnimationFrame(this._updateFrameId);let c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=k_(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat,this._altitude),s===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),c._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._showingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(s){return this._offset=r.P.convert(s),this._update(),this}addClassName(s){return this._element.classList.add(s),this}removeClassName(s){return this._element.classList.remove(s),this}toggleClassName(s){return this._element.classList.toggle(s)}_onMove(s){let c=this._map;if(!c)return;let f=this._pointerdownPos,y=this._positionDelta;if(f&&y){if(!this._isDragging){let b=this._clickTolerance||c._clickTolerance;if(s.point.dist(f)<b)return;this._isDragging=!0}this._pos=s.point.sub(y),this._lngLat=c.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new r.A("dragstart"))),this.fire(new r.A("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;let s=this._map;s&&(s.off("mousemove",this._onMove),s.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new r.A("dragend")),this._state="inactive"}_addDragHandler(s){let c=this._map,f=this._pos;c&&f&&this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(f),this._pointerdownPos=s.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(s){this._draggable=!!s;let c=this._map;return c&&(s?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||ul.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||ul.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s||ul.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(s){return this._occludedOpacity=s||ul.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}let dl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},ka={maxWidth:100,unit:"metric"},zb={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},vo={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},jE=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function bh(m=new r.P(0,0),s="bottom"){if(typeof m=="number"){let c=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(s){case"top":return new r.P(0,m);case"top-left":return new r.P(c,c);case"top-right":return new r.P(-c,c);case"bottom":return new r.P(0,-m);case"bottom-left":return new r.P(c,-c);case"bottom-right":return new r.P(-c,-c);case"left":return new r.P(m,0);case"right":return new r.P(-m,0)}return new r.P(0,0)}return m instanceof r.P||Array.isArray(m)?r.P.convert(m):r.P.convert(m[s]||[0,0])}return{version:g,supported:q.supported,setRTLTextPlugin:r.dN,getRTLTextPluginStatus:r.dO,Map:class extends Cf{constructor(m){T.mark(w.create);let s=m;if((m=r.l({},vh,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&r.dI(window)&&(m.antialias=!1,r.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new rp(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies,null,null),m),this._repaint=!!m.repaint,this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new zl,this._domRenderTaskQueue=new zl,this._controls=[],this._markers=[],this._popups=[],this._mapId=r.aW(),this._locale=r.l({},pp,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._tessellationStep=m.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=m.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Sf(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=m.scaleFactor,this._requestManager=new ui(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,this._contextCreateOptions=m.contextCreateOptions?Object.assign({},m.contextCreateOptions):{},typeof m.container=="string"){let c=document.getElementById(m.container);if(!c)throw new Error(`Container '${m.container.toString()}' not found.`);this._container=c}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&r.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),this._spriteFormat=m.spriteFormat,r.aQ(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Sb),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new BE(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,(m.style||!m.testMode)&&this.setStyle(m.style||r.e.DEFAULT_STYLE,{config:m.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),this.indoor=new Km(this),m.hash&&(this._hash=new Ab(typeof m.hash=="string"&&m.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){s.center==null&&s.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch});let c=m.bounds;c&&(this.resize(),this.fitBounds(c,r.l({},m.fitBoundsOptions,{duration:0})))}this.resize(),m.attributionControl&&this.addControl(new R_({customAttribution:m.customAttribution})),this._logoControl=new Fl,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",c=>{this._update(c.dataType==="style"),this.fire(new r.A(`${c.dataType}data`,c))}),this.on("dataloading",c=>{this.fire(new r.A(`${c.dataType}dataloading`,c))}),this._interactions=new Fb(this)}_getMapId(){return this._mapId}addControl(m,s){if(s===void 0&&(s=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new r.z(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let c=m.onAdd(this);this._controls.push(m);let f=this._controlPositions[s];return s.indexOf("bottom")!==-1?f.insertBefore(c,f.firstChild):f.appendChild(c),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new r.z(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let s=this._controls.indexOf(m);return s>-1&&this._controls.splice(s,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));let s=!this._moving;return s&&this.fire(new r.A("movestart",m)).fire(new r.A("move",m)),this.fire(new r.A("resize",m)),s&&this.fire(new r.A("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(r.aB.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new r.A("zoomstart")).fire(new r.A("zoom")).fire(new r.A("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new r.A("zoomstart")).fire(new r.A("zoom")).fire(new r.A("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new r.A("pitchstart")).fire(new r.A("pitch")).fire(new r.A("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new r.A("pitchstart")).fire(new r.A("pitch")).fire(new r.A("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(m){return this._scaleFactor=m,this.painter.scaleFactor=m,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(s=>s.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return m==="auto"?navigator.language:Array.isArray(m)?m.length===0?void 0:m.map(s=>s==="auto"?navigator.language:s):m}setLanguage(m){let s=this._parseLanguage(m);if(!this.style||s===this._language)return this;this._language=s,this.style.reloadSources();for(let c of this._controls)c._setLanguage&&c._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(m){return this._lazyInitEmptyStyle(),m?typeof m=="string"&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;let m=this.transform,s=m.projection.name,c;s==="globe"&&m.zoom>=r.bY?(m.setMercatorFromTransition(),c=!0):s==="mercator"&&m.zoom<r.bY&&(m.setProjection({name:"globe"}),c=!0),c&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(m,s){return this._updateProjection(m||s||{name:"mercator"})}_updateProjection(m){let s;return s=m.name==="globe"&&this.transform.zoom>=r.bY?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),s&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(m,s){return this.transform.locationPoint3D(r.bO.convert(m),s)}unproject(m,s){return this.transform.pointLocation3D(r.P.convert(m),s)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,s,c){let f=y=>{let b=[];if(Array.isArray(s)){let E=s.filter(R=>this.getLayer(R));b=E.length?this.queryRenderedFeatures(y,{layers:E}):[]}else b=this.queryRenderedFeatures(y,{target:s});return b};if(m==="mouseenter"||m==="mouseover"){let y=!1;return{listener:c,targets:s,delegates:{mousemove:E=>{let R=f(E.point);R.length?y||(y=!0,c.call(this,new cl(m,this,E.originalEvent,{features:R}))):y=!1},mouseout:()=>{y=!1}}}}if(m==="mouseleave"||m==="mouseout"){let y=!1;return{listener:c,targets:s,delegates:{mousemove:R=>{f(R.point).length?y=!0:y&&(y=!1,c.call(this,new cl(m,this,R.originalEvent)))},mouseout:R=>{y&&(y=!1,c.call(this,new cl(m,this,R.originalEvent)))}}}}{let y=b=>{let E=f(b.point);E.length&&(b.features=E,c.call(this,b),delete b.features)};return{listener:c,targets:s,delegates:{[m]:y}}}}on(m,s,c){if(typeof s=="function"||c===void 0)return super.on(m,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;let f=this._createDelegatedListener(m,s,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(f);for(let y in f.delegates)this.on(y,f.delegates[y]);return this}once(m,s,c){if(typeof s=="function"||c===void 0)return super.once(m,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;let f=this._createDelegatedListener(m,s,c);for(let y in f.delegates)this.once(y,f.delegates[y]);return this}off(m,s,c){if(typeof s=="function"||c===void 0)return super.off(m,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;let f=this._delegatedListeners?this._delegatedListeners[m]:void 0;return f&&(y=>{for(let b=0;b<y.length;b++){let E=y[b];if(E.listener===c&&er(E.targets,s)){for(let R in E.delegates)this.off(R,E.delegates[R]);return y.splice(b,1),this}}})(f),this}queryRenderedFeatures(m,s){if(!this.style)return[];if(m===void 0||m instanceof r.P||Array.isArray(m)||s!==void 0||(s=m,m=void 0),m=m||[[0,0],[this.transform.width,this.transform.height]],!s){let b=this.style.queryRenderedFeatures(m,void 0,this.transform),E=this.style.queryRenderedFeatureset(m,void 0,this.transform);return b.concat(E)}let c=!0;if(s.target&&(c=this._isTargetValid(s.target),c&&!s.layers))return this.style.queryRenderedFeatureset(m,s,this.transform);let f=!0;if(s.layers&&Array.isArray(s.layers)){for(let b of s.layers)if(!this._isValidId(b)){f=!1;break}if(f&&!s.target)return this.style.queryRenderedFeatures(m,s,this.transform)}let y=[];return f&&(y=y.concat(this.style.queryRenderedFeatures(m,s,this.transform))),c&&(y=y.concat(this.style.queryRenderedFeatureset(m,s,this.transform))),y}querySourceFeatures(m,s){return!m||typeof m=="string"&&!this._isValidId(m)?[]:this.style.querySourceFeatures(m,s)}isPointOnSurface(m){let{name:s}=this.transform.projection;return s!=="globe"&&s!=="mercator"&&r.w(`${s} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(r.P.convert(m))}addInteraction(m,s){return this._interactions.add(m,s),this}removeInteraction(m){return this._interactions.remove(m),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(m){return this._cooperativeGestures=m,this}setStyle(m,s){return s=r.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},s),this.style&&m&&s.diff!==!1&&s.localFontFamily===this._localFontFamily&&s.localIdeographFontFamily===this._localIdeographFontFamily&&!s.config?(this.style._diffStyle(m,(c,f)=>{c?(r.w(`Unable to perform style diff: ${String(c.message||c.error||c)}. Rebuilding the style from scratch.`),this._updateStyle(m,s)):f&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._localFontFamily=s.localFontFamily,this._updateStyle(m,s))}_getUIString(m){let s=this._locale[m];if(s==null)throw new Error(`Missing UI string '${m}'`);return s}_updateStyle(m,s){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m){let c=r.l({},s);s&&s.config&&(c.initialConfig=s.config,delete c.config),this.style=new Ms(this,c).load(m),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ms(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(r.w("There is no style added to the map."),!1)}_isValidId(m){return m==null?(this.fire(new r.z(new Error("IDs can't be empty."))),!1):!r.cs(m)||(this.fire(new r.z(new Error(`IDs can't contain special symbols: "${m}".`))),!1)}_isTargetValid(m){return"featuresetId"in m?this._isValidId("importId"in m?m.importId:m.featuresetId):"layerId"in m&&this._isValidId(m.layerId)}_areTargetsValid(m){if(Array.isArray(m)){for(let s of m)if(!this._isValidId(s))return!1;return!0}return this._isTargetValid(m)}addSource(m,s){return this._isValidId(m)?(this._lazyInitEmptyStyle(),this.style.addSource(m,s),this._update(!0)):this}isSourceLoaded(m){return!!this._isValidId(m)&&!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(m,s,c){this._lazyInitEmptyStyle(),this.style.addSourceType(m,s,c)}removeSource(m){return this._isValidId(m)?(this.style.removeSource(m),this._updateTerrain(),this._update(!0)):this}getSource(m){return this._isValidId(m)?this.style.getOwnSource(m):null}addImage(m,s,{pixelRatio:c=1,sdf:f=!1,stretchX:y,stretchY:b,content:E}={}){this._lazyInitEmptyStyle();let R=r.I.from(m);if(s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap){let{width:P,height:L,data:F}=r.q.getImageData(s);this.style.addImage(R,{data:new r.r({width:P,height:L},F),pixelRatio:c,stretchX:y,stretchY:b,content:E,sdf:f,version:0,usvg:!1})}else if(s.width===void 0||s.height===void 0)this.fire(new r.z(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{let{width:P,height:L}=s,F=s;this.style.addImage(R,{data:new r.r({width:P,height:L},new Uint8Array(F.data)),pixelRatio:c,stretchX:y,stretchY:b,content:E,sdf:f,usvg:!1,version:0,userImage:F}),F.onAdd&&F.onAdd(this,m)}}updateImage(m,s){this._lazyInitEmptyStyle();let c=r.I.from(m),f=this.style.getImage(c);if(!f)return void this.fire(new r.z(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let y=s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap?r.q.getImageData(s):s,{width:b,height:E,data:R}=y;if(b===void 0||E===void 0)return void this.fire(new r.z(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(b!==(f.usvg?f.icon.usvg_tree.width:f.data.width)||E!==(f.usvg?f.icon.usvg_tree.height:f.data.height))return void this.fire(new r.z(new Error(`The width and height of the updated image (${b}, ${E})
                must be that same as the previous version of the image
                (${f.data.width}, ${f.data.height})`)));let P=!(s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap),L=!1;f.usvg?(f.data=new r.r({width:b,height:E},new Uint8Array(R)),f.usvg=!1,f.icon=void 0,L=!0):f.data.replace(R,P),this.style.updateImage(c,f,L)}hasImage(m){return m?!!this.style&&!!this.style.getImage(r.I.from(m)):(this.fire(new r.z(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(r.I.from(m))}loadImage(m,s){r.o(this._requestManager.transformRequest(m,r.R.Image),(c,f)=>{s(c,f instanceof HTMLImageElement?r.q.getImageData(f):f)})}listImages(){return this.style.listImages().map(m=>m.name)}addModel(m,s){this._lazyInitEmptyStyle(),this.style.addModel(m,s)}hasModel(m){return m?this.style.hasModel(m):(this.fire(new r.z(new Error("Missing required model id"))),!1)}removeModel(m){this.style.removeModel(m)}listModels(){return this.style.listModels()}addLayer(m,s){return this._isValidId(m.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(m,s),this._update(!0)):this}getSlot(m){let s=this.getLayer(m);return s&&s.slot||null}setSlot(m,s){return this.style.setSlot(m,s),this.style.mergeLayers(),this._update(!0)}addImport(m,s){return this.style.addImport(m,s),this}updateImport(m,s){return typeof s!="string"&&s.id!==m?(this.removeImport(m),this.addImport(s)):(this.style.updateImport(m,s),this._update(!0))}removeImport(m){return this.style.removeImport(m),this}moveImport(m,s){return this.style.moveImport(m,s),this._update(!0)}moveLayer(m,s){return this._isValidId(m)?(this.style.moveLayer(m,s),this._update(!0)):this}removeLayer(m){return this._isValidId(m)?(this.style.removeLayer(m),this._update(!0)):this}getLayer(m){if(!this._isValidId(m))return null;let s=this.style.getOwnLayer(m);return s?s.type==="custom"?s.implementation:s.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(m,s,c){return this._isValidId(m)?(this.style.setLayerZoomRange(m,s,c),this._update(!0)):this}setFilter(m,s,c={}){return this._isValidId(m)?(this.style.setFilter(m,s,c),this._update(!0)):this}getFilter(m){return this._isValidId(m)?this.style.getFilter(m):null}setPaintProperty(m,s,c,f={}){return this._isValidId(m)?(this.style.setPaintProperty(m,s,c,f),this._update(!0)):this}getPaintProperty(m,s){return this._isValidId(m)?this.style.getPaintProperty(m,s):null}setLayoutProperty(m,s,c,f={}){return this._isValidId(m)?(this.style.setLayoutProperty(m,s,c,f),this._update(!0)):this}getLayoutProperty(m,s){return this._isValidId(m)?this.style.getLayoutProperty(m,s):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(m){return this.style.setGlyphsUrl(m),this._update(!0)}getSchema(m){return this.style.getSchema(m)}setSchema(m,s){return this.style.setSchema(m,s),this._update(!0)}getConfig(m){return this.style.getConfig(m)}setConfig(m,s){return this.style.setConfig(m,s),this._update(!0)}getConfigProperty(m,s){return this.style.getConfigProperty(m,s)}setConfigProperty(m,s,c){return this.style.setConfigProperty(m,s,c),this._update(!0)}getFeaturesetDescriptors(m){return this.style.getFeaturesetDescriptors(m)}setLights(m){if(this._lazyInitEmptyStyle(),m&&m.length===1&&m[0].type==="flat"){let s=m[0];s.properties?this.style.setFlatLight(s.properties,s.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(m),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){let m=this.style.getLights()||[];return m.length===0&&m.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),m}setLight(m,s={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:m}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(m){return this._lazyInitEmptyStyle(),this.style.setSnow(m),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(m){return this._lazyInitEmptyStyle(),this.style.setRain(m),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(m){return this._lazyInitEmptyStyle(),this.style.setColorTheme(m),this._update(!0)}setImportColorTheme(m,s){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(m,s),this._update(!0)}setCamera(m){return this.style.setCamera(m),this._triggerCameraUpdate(m)}_triggerCameraUpdate(m){return this._update(this.transform.setOrthographicProjectionAtLowPitch(m["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(r.bO.convert(m),this.transform):0}setFeatureState(m,s){return m.source&&!this._isValidId(m.source)?this:(this.style.setFeatureState(m,s),this._update())}removeFeatureState(m,s){return m.source&&!this._isValidId(m.source)?this:(this.style.removeFeatureState(m,s),this._update())}getFeatureState(m){return m.source&&!this._isValidId(m.source)?null:this.style.getFeatureState(m)}_updateContainerDimensions(){if(!this._container)return;let m=this._container.getBoundingClientRect().width||400,s=this._container.getBoundingClientRect().height||300,c,f,y,b=this._container;for(;b&&(!f||!y);){let E=window.getComputedStyle(b).transform;E&&E!=="none"&&(c=E.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&c[0]!=="0"&&c[0]!=="1"&&(f=c[0]),c[3]&&c[3]!=="0"&&c[3]!=="1"&&(y=c[3])),b=b.parentElement}this._containerWidth=f?Math.abs(m/f):m,this._containerHeight=y?Math.abs(s/y):s}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&r.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){let m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=Z("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();let s=this._canvasContainer=Z("div","mapboxgl-canvas-container",m);this._canvas=Z("canvas","mapboxgl-canvas",s),this._interactive&&(s.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);let c=this._controlContainer=Z("div","mapboxgl-control-container",m),f=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(y=>{f[y]=Z("div",`mapboxgl-ctrl-${y}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,s){let c=r.q.devicePixelRatio||1;this._canvas.width=c*Math.ceil(m),this._canvas.height=c*Math.ceil(s),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${s}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){let s=this._markers.indexOf(m);s!==-1&&this._markers.splice(s,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){let s=this._popups.indexOf(m);s!==-1&&this._popups.splice(s,1)}_setupPainter(){let m=r.l({},q.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),s=this._canvas.getContext("webgl2",m);s?(os(s,!0),this.painter=new D_(s,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",c=>{c.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),r.m.testSupport(s)):this.fire(new r.z(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new r.A("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style.reloadModels(),this.style.clearSources(),this._update(),this.fire(new r.A("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let s;this.fire(new r.A("renderstart")),++this._frameId;let c=this.painter.context.extTimerQuery,f=r.q.now(),y=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(s=y.createQuery(),y.beginQuery(c.TIME_ELAPSED_EXT,s)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();let b=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;let L=this.transform.zoom,F=this.transform.pitch,j=r.q.now(),U=new r.aa(L,{now:j,fadeDuration:b,pitch:F,transition:this.style.transition});this.style.update(U)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let E=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),E=this._updateAverageElevation(f),this.style.updateSources(this.transform),this.isMoving()||this._forceMarkerAndPopupUpdate()):E=this._updateAverageElevation(f);let R=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,b,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),R&&(this._placementDirty=R.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new r.A("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,T.mark(w.load),this.fire(new r.A("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),s){let L=r.q.now()-f;y.endQuery(c.TIME_ELAPSED_EXT),setTimeout(()=>{let F=y.getQueryParameter(s,y.QUERY_RESULT)/1e6;y.deleteQuery(s),this.fire(new r.A("gpu-timing-frame",{cpuTime:L,gpuTime:F}))},50)}if(this.listens("gpu-timing-layer")){let L=this.painter.collectGpuTimers();setTimeout(()=>{let F=this.painter.queryGpuTimers(L);this.fire(new r.A("gpu-timing-layer",{layerTimes:F}))},50)}if(this.listens("gpu-timing-deferred-render")){let L=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{let F=this.painter.queryGpuTimeDeferredRender(L);this.fire(new r.A("gpu-timing-deferred-render",{gpuTime:F}))},50)}let P=this._sourcesDirty||this._styleDirty||this._placementDirty||E;if(P||this._repaint)this.triggerRepaint();else{let L=this.idle();if(L&&(E=this._updateAverageElevation(f,!0)),E)this.triggerRepaint();else if(this._triggerFrame(!1),L&&(this.fire(new r.A("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){let F=this._calculateSpeedIndex();this.fire(new r.A("speedindexcompleted",{speedIndex:F})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||P||(this._fullyLoaded=!0,T.mark(w.fullLoad),this._performanceMetricsCollection&&Oo(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(let s of this._markers)m&&!this.getRenderWorldCopies()&&(s._lngLat=s._lngLat.wrap()),s._update();for(let s of this._popups)!m||this.getRenderWorldCopies()||s._trackPointer||(s._lngLat=s._lngLat.wrap()),s._update()}_updateAverageElevation(m,s=!1){let c=y=>(this.transform.averageElevation=y,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&c(0);let f=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(f||(s||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){let y=this.transform.averageElevation,b=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(b)?b=0:this._averageElevationLastSampledAt=m;let E=Math.abs(y-b);if(E>1){if(this._isInitialLoad||f)return this._averageElevation.jumpTo(b),c(b);this._averageElevation.easeTo(b,m,300)}else if(E>1e-4)return this._averageElevation.jumpTo(b),c(b)}return!!this._averageElevation.isEasing(m)&&c(this._averageElevation.getValue(m))}_authenticate(){ge(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===Pt||m.status===401)){let s=this.painter.context.gl;os(s,!1),this._logoControl instanceof Fl&&this._logoControl._updateLogo(),s&&s.clear(s.DEPTH_BUFFER_BIT|s.COLOR_BUFFER_BIT|s.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new r.z(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),it(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&di(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){let m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){let m=this.painter.canvasCopy(),s=this.painter.getCanvasCopiesAndTimestamps();s.timeStamps.push(performance.now());let c=this.painter.context.gl,f=c.createFramebuffer();function y(b){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,b,0);let E=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,E),E}return c.bindFramebuffer(c.FRAMEBUFFER,f),this._canvasPixelComparison(y(m),s.canvasCopies.map(y),s.timeStamps)}_canvasPixelComparison(m,s,c){let f=c[1]-c[0],y=m.length/4;for(let b=0;b<s.length;b++){let E=s[b],R=0;for(let P=0;P<E.length;P+=4)E[P]===m[P]&&E[P+1]===m[P+1]&&E[P+2]===m[P+2]&&E[P+3]===m[P+3]&&(R+=1);f+=(c[b+2]-c[b+1])*(1-R/y)}return f}remove(){this._hash&&this._hash.remove();for(let s of this._controls)s.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);let m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Po.delete(this.painter.context.gl),io.remove(),hi.remove(),this._removed=!0,this.fire(new r.A("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=r.q.frame(s=>{let c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(s)}))}_preloadTiles(m){let s=this.style?this.style.getSourceCaches():[];return r.bl(s,(c,f)=>c._preloadTiles(m,f),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(m){this._showParseStatus!==m&&(this._showParseStatus=m,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(m){this._showLayers2DWireframe!==m&&(this._showLayers2DWireframe=m,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(m){this._showLayers3DWireframe!==m&&(this._showLayers3DWireframe=m,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,this._tp.refreshUI(),m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,this._tp.refreshUI(),m&&this._update())}_setCacheLimits(m,s){r.dJ(m,s)}get version(){return g}},NavigationControl:class{constructor(m={}){this.options=r.l({},jI,m),this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(r.aQ(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",s=>{this._map&&this._map.zoomIn({},{originalEvent:s})}),Z("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",s=>{this._map&&this._map.zoomOut({},{originalEvent:s})}),Z("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(r.aQ(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",s=>{let c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:s}):c.resetNorth({},{originalEvent:s}))}),this._compassIcon=Z("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){let m=this._map;if(!m)return;let s=m.getZoom(),c=s===m.getMaxZoom(),f=s===m.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())}_rotateCompassArrow(){let m=this._map;if(!m)return;let s=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=s)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new UI(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){let m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,s){let c=Z("button",m,this._container);return c.type="button",c.addEventListener("click",s),c}_setButtonTitle(m,s){if(!this._map)return;let c=this._map._getUIString(`NavigationControl.${s}`);m.setAttribute("aria-label",c),m.firstElementChild&&m.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends r.E{constructor(m={}){super();let s=navigator.geolocation;this.options=r.l({geolocation:s},dl,m),r.aQ(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=M_(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){let s=(c=!!this.options.geolocation)=>{this._supportsGeolocation=c,m(c)};this._supportsGeolocation!==void 0?m(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(c=>s(c.state!=="denied")).catch(()=>s()):s()}_isOutOfMapMaxBounds(m){let s=this._map.getMaxBounds(),c=m.coords;return!!s&&(c.longitude<s.getWest()||c.longitude>s.getEast()||c.latitude<s.getSouth()||c.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new r.A("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new r.A("geolocate",m)),this._finish()}}_updateCamera(m){let s=new r.bO(m.coords.longitude,m.coords.latitude),c=m.coords.accuracy,f=this._map.getBearing(),y=r.l({bearing:f},this.options.fitBoundsOptions);this._map.fitBounds(s.toBounds(c),y,{geolocateSource:!0})}_updateMarker(m){if(m){let s=new r.bO(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){let m=this._map.transform,s=r.bH(1,m._center.lat)*m.worldSize,c=Math.ceil(2*this._accuracy*s);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new r.A("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=Z("button","mapboxgl-ctrl-geolocate",this._container),Z("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){r.w("Geolocation support is not available so the GeolocateControl will be disabled.");let s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}else{let s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Z("div","mapboxgl-user-location"),this._dotElement.appendChild(Z("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Z("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new $a({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Z("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new $a({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new r.A("trackuserlocationend")))})}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:m.absolute===!0&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return r.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new r.A("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new r.A("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new r.A("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){let m=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(s=>{s==="granted"&&m()}).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:R_,ScaleControl:class{constructor(m={}){this.options=r.l({},ka,m),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),r.aQ(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){let m=this.options.maxWidth||100,s=this._map,c=s._containerHeight/2,f=s._containerWidth/2-m/2,y=s.unproject([f,c]),b=s.unproject([f+m,c]),E=y.distanceTo(b);if(this.options.unit==="imperial"){let R=3.2808*E;R>5280?this._setScale(m,R/5280,"mile"):this._setScale(m,R,"foot")}else this.options.unit==="nautical"?this._setScale(m,E/1852,"nautical-mile"):E>=1e3?this._setScale(m,E/1e3,"kilometer"):this._setScale(m,E,"meter")}_setScale(m,s,c){this._map._requestDomTask(()=>{let f=function(b){let E=Math.pow(10,`${Math.floor(b)}`.length-1),R=b/E;return R=R>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:function(P){let L=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*L)/L}(R),E*R}(s),y=f/s;this._container.innerHTML=this._isNumberFormatSupported&&c!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:c}).format(f):`${f}&nbsp;${zb[c]}`,this._container.style.width=m*y+"px"})}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m={}){this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:r.w("Full screen control 'container' must be a DOM element.")),r.aQ(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=Z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",r.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){let m=this._fullscreenButton=Z("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Z("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){let m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends r.E{constructor(m){super(),this.options=r.l(Object.create(vo),m),this._altitude=this.options.altitude,r.aQ(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new r.A("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);let m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new r.A("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=r.bO.convert(m),this._pos=null,this._trackPointer=!1,this._update();let s=this._map;return s&&(s.on("move",this._update),s.off("mousemove",this._onMouseEvent),s._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(m){return this._altitude=m,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();let m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){let s=document.createDocumentFragment(),c=document.createElement("body"),f;for(c.innerHTML=m;f=c.firstChild,f;)s.appendChild(f);return this.setDOMContent(s)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let s=this._content;if(s)for(;s.hasChildNodes();)s.firstChild&&s.removeChild(s.firstChild);else s=this._content=Z("div","mapboxgl-popup-content",this._container||void 0);if(s.appendChild(m),this.options.closeButton){let c=this._closeButton=Z("button","mapboxgl-popup-close-button",s);c.type="button",c.setAttribute("aria-label","Close popup"),c.innerHTML='<span aria-hidden="true">&#215;</span>',c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let s;return this._classList.delete(m)?s=!1:(this._classList.add(m),s=!0),this._updateClassList(),s}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;let s=this._map,c=this._container,f=this._pos;if(!s||!c||!f)return"bottom";let y=c.offsetWidth,b=c.offsetHeight,E=f.x<y/2,R=f.x>s.transform.width-y/2;if(f.y+m<b)return E?"top-left":R?"top-right":"top";if(f.y>s.transform.height-b){if(E)return"bottom-left";if(R)return"bottom-right"}return E?"left":R?"right":"bottom"}_updateClassList(){let m=this._container;if(!m)return;let s=[...this._classList];s.push("mapboxgl-popup"),this._anchor&&s.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&s.push("mapboxgl-popup-track-pointer"),m.className=s.join(" ")}_update(m){let s=this._map,c=this._content;if(!s||!this._lngLat&&!this._trackPointer||!c)return;let f=this._container;if(f||(f=this._container=Z("div","mapboxgl-popup",s.getContainer()),this._tip=Z("div","mapboxgl-popup-tip",f),f.appendChild(c)),this.options.maxWidth&&f.style.maxWidth!==this.options.maxWidth&&(f.style.maxWidth=this.options.maxWidth),s.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=k_(this._lngLat,this._pos,s.transform)),!this._trackPointer||m){let y=this._pos=this._trackPointer&&m instanceof r.P?m:s.project(this._lngLat,this._altitude),b=bh(this.options.offset),E=this._anchor=this._getAnchor(b.y),R=bh(this.options.offset,E),P=y.add(R).round();s._requestDomTask(()=>{this._container&&E&&(this._container.style.transform=`${Su[E]} translate(${P.x}px,${P.y}px)`)})}if(!this._marker&&s._showingGlobe()){let y=r.dK(s.transform,this._lngLat)?0:1;this._setOpacity(y)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let m=this._container.querySelector(jE);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:$a,Style:Ms,LngLat:r.bO,LngLatBounds:r.aB,Point:r.P,MercatorCoordinate:r.ac,FreeCameraOptions:tf,Evented:r.E,config:r.e,prewarm:r.dP,clearPrewarmedResources:r.dQ,get accessToken(){return r.e.ACCESS_TOKEN},set accessToken(m){r.e.ACCESS_TOKEN=m},get baseApiUrl(){return r.e.API_URL},set baseApiUrl(m){r.e.API_URL=m},get workerCount(){return r.dR.workerCount},set workerCount(m){r.dR.workerCount=m},get maxParallelImageRequests(){return r.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){r.e.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){r.dS(m)},get workerUrl(){return r.dT.workerUrl},set workerUrl(m){r.dT.workerUrl=m},get workerClass(){return r.dT.workerClass},set workerClass(m){r.dT.workerClass=m},get workerParams(){return r.dT.workerParams},set workerParams(m){r.dT.workerParams=m},get dracoUrl(){return r.dU()},set dracoUrl(m){r.dV(m)},get meshoptUrl(){return r.dW()},set meshoptUrl(m){r.dX(m)},setNow:r.q.setNow,restoreNow:r.q.restoreNow}});var o=e;return o})});var UY=lz((J4,eF)=>{"use strict";(function(t,i){typeof define=="function"&&define.amd?define([],i):typeof J4<"u"?i():(i(),t.FileSaver={})})(J4,function(){"use strict";function t(w,T){return typeof T>"u"?T={autoBom:!1}:typeof T!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),T={autoBom:!T}),T.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(w.type)?new Blob(["\uFEFF",w],{type:w.type}):w}function i(w,T,k){var N=new XMLHttpRequest;N.open("GET",w),N.responseType="blob",N.onload=function(){g(N.response,T,k)},N.onerror=function(){console.error("could not download file")},N.send()}function e(w){var T=new XMLHttpRequest;T.open("HEAD",w,!1);try{T.send()}catch{}return 200<=T.status&&299>=T.status}function n(w){try{w.dispatchEvent(new MouseEvent("click"))}catch{var T=document.createEvent("MouseEvents");T.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),w.dispatchEvent(T)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,r=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!r?function(w,T,k){var N=o.URL||o.webkitURL,V=document.createElement("a");T=T||w.name||"download",V.download=T,V.rel="noopener",typeof w=="string"?(V.href=w,V.origin===location.origin?n(V):e(V.href)?i(w,T,k):n(V,V.target="_blank")):(V.href=N.createObjectURL(w),setTimeout(function(){N.revokeObjectURL(V.href)},4e4),setTimeout(function(){n(V)},0))}:"msSaveOrOpenBlob"in navigator?function(w,T,k){if(T=T||w.name||"download",typeof w!="string")navigator.msSaveOrOpenBlob(t(w,k),T);else if(e(w))i(w,T,k);else{var N=document.createElement("a");N.href=w,N.target="_blank",setTimeout(function(){n(N)})}}:function(w,T,k,N){if(N=N||open("","_blank"),N&&(N.document.title=N.document.body.innerText="downloading..."),typeof w=="string")return i(w,T,k);var V=w.type==="application/octet-stream",q=/constructor/i.test(o.HTMLElement)||o.safari,Z=/CriOS\/[\d]+/.test(navigator.userAgent);if((Z||V&&q||r)&&typeof FileReader<"u"){var X=new FileReader;X.onloadend=function(){var _e=X.result;_e=Z?_e:_e.replace(/^data:[^;]*;/,"data:attachment/file;"),N?N.location.href=_e:location=_e,N=null},X.readAsDataURL(w)}else{var te=o.URL||o.webkitURL,De=te.createObjectURL(w);N?N.location=De:location.href=De,N=null,setTimeout(function(){te.revokeObjectURL(De)},4e4)}});o.saveAs=g.saveAs=g,typeof eF<"u"&&(eF.exports=g)})});import Mfe from"./angular-app-manifest.mjs";function cR(t,i){return Object.is(t,i)}var ps=null,PC=!1,uR=1,pc=Symbol("SIGNAL");function Mr(t){let i=ps;return ps=t,i}function dR(){return ps}var X_={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function x1(t){if(PC)throw new Error("");if(ps===null)return;ps.consumerOnSignalRead(t);let i=ps.nextProducerIndex++;if(BC(ps),i<ps.producerNode.length&&ps.producerNode[i]!==t&&b1(ps)){let e=ps.producerNode[i];zC(e,ps.producerIndexOfThis[i])}ps.producerNode[i]!==t&&(ps.producerNode[i]=t,ps.producerIndexOfThis[i]=b1(ps)?hz(t,ps,i):0),ps.producerLastReadVersion[i]=t.version}function dz(){uR++}function hR(t){if(!(b1(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===uR)){if(!t.producerMustRecompute(t)&&!FC(t)){lR(t);return}t.producerRecomputeValue(t),lR(t)}}function pR(t){if(t.liveConsumerNode===void 0)return;let i=PC;PC=!0;try{for(let e of t.liveConsumerNode)e.dirty||WJ(e)}finally{PC=i}}function fR(){return ps?.consumerAllowSignalWrites!==!1}function WJ(t){t.dirty=!0,pR(t),t.consumerMarkedDirty?.(t)}function lR(t){t.dirty=!1,t.lastCleanEpoch=uR}function w1(t){return t&&(t.nextProducerIndex=0),Mr(t)}function LC(t,i){if(Mr(i),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(b1(t))for(let e=t.nextProducerIndex;e<t.producerNode.length;e++)zC(t.producerNode[e],t.producerIndexOfThis[e]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function FC(t){BC(t);for(let i=0;i<t.producerNode.length;i++){let e=t.producerNode[i],n=t.producerLastReadVersion[i];if(n!==e.version||(hR(e),n!==e.version))return!0}return!1}function E1(t){if(BC(t),b1(t))for(let i=0;i<t.producerNode.length;i++)zC(t.producerNode[i],t.producerIndexOfThis[i]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function hz(t,i,e){if(pz(t),t.liveConsumerNode.length===0&&fz(t))for(let n=0;n<t.producerNode.length;n++)t.producerIndexOfThis[n]=hz(t.producerNode[n],t,n);return t.liveConsumerIndexOfThis.push(e),t.liveConsumerNode.push(i)-1}function zC(t,i){if(pz(t),t.liveConsumerNode.length===1&&fz(t))for(let n=0;n<t.producerNode.length;n++)zC(t.producerNode[n],t.producerIndexOfThis[n]);let e=t.liveConsumerNode.length-1;if(t.liveConsumerNode[i]=t.liveConsumerNode[e],t.liveConsumerIndexOfThis[i]=t.liveConsumerIndexOfThis[e],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,i<t.liveConsumerNode.length){let n=t.liveConsumerIndexOfThis[i],o=t.liveConsumerNode[i];BC(o),o.producerIndexOfThis[n]=i}}function b1(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function BC(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function pz(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function fz(t){return t.producerNode!==void 0}function VC(t,i){let e=Object.create(ZJ);e.computation=t,i!==void 0&&(e.equal=i);let n=()=>{if(hR(e),x1(e),e.value===NC)throw e.error;return e.value};return n[pc]=e,n}var aR=Symbol("UNSET"),sR=Symbol("COMPUTING"),NC=Symbol("ERRORED"),ZJ=ji(It({},X_),{value:aR,dirty:!0,error:null,equal:cR,kind:"computed",producerMustRecompute(t){return t.value===aR||t.value===sR},producerRecomputeValue(t){if(t.value===sR)throw new Error("Detected cycle in computations.");let i=t.value;t.value=sR;let e=w1(t),n,o=!1;try{n=t.computation(),Mr(null),o=i!==aR&&i!==NC&&n!==NC&&t.equal(i,n)}catch(r){n=NC,t.error=r}finally{LC(t,e)}if(o){t.value=i;return}t.value=n,t.version++}});function YJ(){throw new Error}var mz=YJ;function gz(t){mz(t)}function mR(t){mz=t}var KJ=null;function gR(t,i){let e=Object.create(jC);e.value=t,i!==void 0&&(e.equal=i);let n=()=>(x1(e),e.value);return n[pc]=e,n}function C1(t,i){fR()||gz(t),t.equal(t.value,i)||(t.value=i,XJ(t))}function _R(t,i){fR()||gz(t),C1(t,i(t.value))}var jC=ji(It({},X_),{equal:cR,value:void 0,kind:"signal"});function XJ(t){t.version++,dz(),pR(t),KJ?.()}function yR(t){let i=Mr(null);try{return t()}finally{Mr(i)}}var vR;function S1(){return vR}function _p(t){let i=vR;return vR=t,i}var UC=Symbol("NotFound");function gr(t){return typeof t=="function"}function Q_(t){let e=t(n=>{Error.call(n),n.stack=new Error().stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var HC=Q_(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:
${e.map((n,o)=>`${o+1}) ${n.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=e});function Ig(t,i){if(t){let e=t.indexOf(i);0<=e&&t.splice(e,1)}}var nr=class t{constructor(i){this.initialTeardown=i,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let i;if(!this.closed){this.closed=!0;let{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(let r of e)r.remove(this);else e.remove(this);let{initialTeardown:n}=this;if(gr(n))try{n()}catch(r){i=r instanceof HC?r.errors:[r]}let{_finalizers:o}=this;if(o){this._finalizers=null;for(let r of o)try{_z(r)}catch(g){i=i??[],g instanceof HC?i=[...i,...g.errors]:i.push(g)}}if(i)throw new HC(i)}}add(i){var e;if(i&&i!==this)if(this.closed)_z(i);else{if(i instanceof t){if(i.closed||i._hasParent(this))return;i._addParent(this)}(this._finalizers=(e=this._finalizers)!==null&&e!==void 0?e:[]).push(i)}}_hasParent(i){let{_parentage:e}=this;return e===i||Array.isArray(e)&&e.includes(i)}_addParent(i){let{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(i),e):e?[e,i]:i}_removeParent(i){let{_parentage:e}=this;e===i?this._parentage=null:Array.isArray(e)&&Ig(e,i)}remove(i){let{_finalizers:e}=this;e&&Ig(e,i),i instanceof t&&i._removeParent(this)}};nr.EMPTY=(()=>{let t=new nr;return t.closed=!0,t})();var bR=nr.EMPTY;function qC(t){return t instanceof nr||t&&"closed"in t&&gr(t.remove)&&gr(t.add)&&gr(t.unsubscribe)}function _z(t){gr(t)?t():t.unsubscribe()}var Sd={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var J_={setTimeout(t,i,...e){let{delegate:n}=J_;return n?.setTimeout?n.setTimeout(t,i,...e):setTimeout(t,i,...e)},clearTimeout(t){let{delegate:i}=J_;return(i?.clearTimeout||clearTimeout)(t)},delegate:void 0};function $C(t){J_.setTimeout(()=>{let{onUnhandledError:i}=Sd;if(i)i(t);else throw t})}function T1(){}var yz=xR("C",void 0,void 0);function vz(t){return xR("E",void 0,t)}function bz(t){return xR("N",t,void 0)}function xR(t,i,e){return{kind:t,value:i,error:e}}var Ag=null;function ey(t){if(Sd.useDeprecatedSynchronousErrorHandling){let i=!Ag;if(i&&(Ag={errorThrown:!1,error:null}),t(),i){let{errorThrown:e,error:n}=Ag;if(Ag=null,e)throw n}}else t()}function xz(t){Sd.useDeprecatedSynchronousErrorHandling&&Ag&&(Ag.errorThrown=!0,Ag.error=t)}var Rg=class extends nr{constructor(i){super(),this.isStopped=!1,i?(this.destination=i,qC(i)&&i.add(this)):this.destination=nee}static create(i,e,n){return new yp(i,e,n)}next(i){this.isStopped?ER(bz(i),this):this._next(i)}error(i){this.isStopped?ER(vz(i),this):(this.isStopped=!0,this._error(i))}complete(){this.isStopped?ER(yz,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(i){this.destination.next(i)}_error(i){try{this.destination.error(i)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},tee=Function.prototype.bind;function wR(t,i){return tee.call(t,i)}var CR=class{constructor(i){this.partialObserver=i}next(i){let{partialObserver:e}=this;if(e.next)try{e.next(i)}catch(n){GC(n)}}error(i){let{partialObserver:e}=this;if(e.error)try{e.error(i)}catch(n){GC(n)}else GC(i)}complete(){let{partialObserver:i}=this;if(i.complete)try{i.complete()}catch(e){GC(e)}}},yp=class extends Rg{constructor(i,e,n){super();let o;if(gr(i)||!i)o={next:i??void 0,error:e??void 0,complete:n??void 0};else{let r;this&&Sd.useDeprecatedNextContext?(r=Object.create(i),r.unsubscribe=()=>this.unsubscribe(),o={next:i.next&&wR(i.next,r),error:i.error&&wR(i.error,r),complete:i.complete&&wR(i.complete,r)}):o=i}this.destination=new CR(o)}};function GC(t){Sd.useDeprecatedSynchronousErrorHandling?xz(t):$C(t)}function iee(t){throw t}function ER(t,i){let{onStoppedNotification:e}=Sd;e&&J_.setTimeout(()=>e(t,i))}var nee={closed:!0,next:T1,error:iee,complete:T1};var ty=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Ul(t){return t}function SR(...t){return TR(t)}function TR(t){return t.length===0?Ul:t.length===1?t[0]:function(e){return t.reduce((n,o)=>o(n),e)}}var wr=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){let n=new t;return n.source=this,n.operator=e,n}subscribe(e,n,o){let r=oee(e)?e:new yp(e,n,o);return ey(()=>{let{operator:g,source:w}=this;r.add(g?g.call(r,w):w?this._subscribe(r):this._trySubscribe(r))}),r}_trySubscribe(e){try{return this._subscribe(e)}catch(n){e.error(n)}}forEach(e,n){return n=wz(n),new n((o,r)=>{let g=new yp({next:w=>{try{e(w)}catch(T){r(T),g.unsubscribe()}},error:r,complete:o});this.subscribe(g)})}_subscribe(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)}[ty](){return this}pipe(...e){return TR(e)(this)}toPromise(e){return e=wz(e),new e((n,o)=>{let r;this.subscribe(g=>r=g,g=>o(g),()=>n(r))})}}return t.create=i=>new t(i),t})();function wz(t){var i;return(i=t??Sd.Promise)!==null&&i!==void 0?i:Promise}function ree(t){return t&&gr(t.next)&&gr(t.error)&&gr(t.complete)}function oee(t){return t&&t instanceof Rg||ree(t)&&qC(t)}function DR(t){return gr(t?.lift)}function ur(t){return i=>{if(DR(i))return i.lift(function(e){try{return t(e,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function ar(t,i,e,n,o){return new MR(t,i,e,n,o)}var MR=class extends Rg{constructor(i,e,n,o,r,g){super(i),this.onFinalize=r,this.shouldUnsubscribe=g,this._next=e?function(w){try{e(w)}catch(T){i.error(T)}}:super._next,this._error=o?function(w){try{o(w)}catch(T){i.error(T)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(w){i.error(w)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var i;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:e}=this;super.unsubscribe(),!e&&((i=this.onFinalize)===null||i===void 0||i.call(this))}}};function iy(){return ur((t,i)=>{let e=null;t._refCount++;let n=ar(i,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){e=null;return}let o=t._connection,r=e;e=null,o&&(!r||o===r)&&o.unsubscribe(),i.unsubscribe()});t.subscribe(n),n.closed||(e=t.connect())})}var Bf=class extends wr{constructor(i,e){super(),this.source=i,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,DR(i)&&(this.lift=i.lift)}_subscribe(i){return this.getSubject().subscribe(i)}getSubject(){let i=this._subject;return(!i||i.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:i}=this;this._subject=this._connection=null,i?.unsubscribe()}connect(){let i=this._connection;if(!i){i=this._connection=new nr;let e=this.getSubject();i.add(this.source.subscribe(ar(e,void 0,()=>{this._teardown(),e.complete()},n=>{this._teardown(),e.error(n)},()=>this._teardown()))),i.closed&&(this._connection=null,i=nr.EMPTY)}return i}refCount(){return iy()(this)}};var Ez=Q_(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var gi=(()=>{class t extends wr{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){let n=new WC(this,this);return n.operator=e,n}_throwIfClosed(){if(this.closed)throw new Ez}next(e){ey(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let n of this.currentObservers)n.next(e)}})}error(e){ey(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;let{observers:n}=this;for(;n.length;)n.shift().error(e)}})}complete(){ey(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){let{hasError:n,isStopped:o,observers:r}=this;return n||o?bR:(this.currentObservers=null,r.push(e),new nr(()=>{this.currentObservers=null,Ig(r,e)}))}_checkFinalizedStatuses(e){let{hasError:n,thrownError:o,isStopped:r}=this;n?e.error(o):r&&e.complete()}asObservable(){let e=new wr;return e.source=this,e}}return t.create=(i,e)=>new WC(i,e),t})(),WC=class extends gi{constructor(i,e){super(),this.destination=i,this.source=e}next(i){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.next)===null||n===void 0||n.call(e,i)}error(i){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.error)===null||n===void 0||n.call(e,i)}complete(){var i,e;(e=(i=this.destination)===null||i===void 0?void 0:i.complete)===null||e===void 0||e.call(i)}_subscribe(i){var e,n;return(n=(e=this.source)===null||e===void 0?void 0:e.subscribe(i))!==null&&n!==void 0?n:bR}};var to=class extends gi{constructor(i){super(),this._value=i}get value(){return this.getValue()}_subscribe(i){let e=super._subscribe(i);return!e.closed&&i.next(this._value),e}getValue(){let{hasError:i,thrownError:e,_value:n}=this;if(i)throw e;return this._throwIfClosed(),n}next(i){super.next(this._value=i)}};var D1={now(){return(D1.delegate||Date).now()},delegate:void 0};var kg=class extends gi{constructor(i=1/0,e=1/0,n=D1){super(),this._bufferSize=i,this._windowTime=e,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,i),this._windowTime=Math.max(1,e)}next(i){let{isStopped:e,_buffer:n,_infiniteTimeWindow:o,_timestampProvider:r,_windowTime:g}=this;e||(n.push(i),!o&&n.push(r.now()+g)),this._trimBuffer(),super.next(i)}_subscribe(i){this._throwIfClosed(),this._trimBuffer();let e=this._innerSubscribe(i),{_infiniteTimeWindow:n,_buffer:o}=this,r=o.slice();for(let g=0;g<r.length&&!i.closed;g+=n?1:2)i.next(r[g]);return this._checkFinalizedStatuses(i),e}_trimBuffer(){let{_bufferSize:i,_timestampProvider:e,_buffer:n,_infiniteTimeWindow:o}=this,r=(o?1:2)*i;if(i<1/0&&r<n.length&&n.splice(0,n.length-r),!o){let g=e.now(),w=0;for(let T=1;T<n.length&&n[T]<=g;T+=2)w=T;w&&n.splice(0,w+1)}}};var ZC=class extends nr{constructor(i,e){super()}schedule(i,e=0){return this}};var M1={setInterval(t,i,...e){let{delegate:n}=M1;return n?.setInterval?n.setInterval(t,i,...e):setInterval(t,i,...e)},clearInterval(t){let{delegate:i}=M1;return(i?.clearInterval||clearInterval)(t)},delegate:void 0};var YC=class extends ZC{constructor(i,e){super(i,e),this.scheduler=i,this.work=e,this.pending=!1}schedule(i,e=0){var n;if(this.closed)return this;this.state=i;let o=this.id,r=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(r,o,e)),this.pending=!0,this.delay=e,this.id=(n=this.id)!==null&&n!==void 0?n:this.requestAsyncId(r,this.id,e),this}requestAsyncId(i,e,n=0){return M1.setInterval(i.flush.bind(i,this),n)}recycleAsyncId(i,e,n=0){if(n!=null&&this.delay===n&&this.pending===!1)return e;e!=null&&M1.clearInterval(e)}execute(i,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let n=this._execute(i,e);if(n)return n;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(i,e){let n=!1,o;try{this.work(i)}catch(r){n=!0,o=r||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),o}unsubscribe(){if(!this.closed){let{id:i,scheduler:e}=this,{actions:n}=e;this.work=this.state=this.scheduler=null,this.pending=!1,Ig(n,this),i!=null&&(this.id=this.recycleAsyncId(e,i,null)),this.delay=null,super.unsubscribe()}}};var ny=class t{constructor(i,e=t.now){this.schedulerActionCtor=i,this.now=e}schedule(i,e=0,n){return new this.schedulerActionCtor(this,i).schedule(n,e)}};ny.now=D1.now;var KC=class extends ny{constructor(i,e=ny.now){super(i,e),this.actions=[],this._active=!1}flush(i){let{actions:e}=this;if(this._active){e.push(i);return}let n;this._active=!0;do if(n=i.execute(i.state,i.delay))break;while(i=e.shift());if(this._active=!1,n){for(;i=e.shift();)i.unsubscribe();throw n}}};var Og=new KC(YC),Cz=Og;var Rs=new wr(t=>t.complete());function XC(t){return t&&gr(t.schedule)}function IR(t){return t[t.length-1]}function QC(t){return gr(IR(t))?t.pop():void 0}function Eh(t){return XC(IR(t))?t.pop():void 0}function Sz(t,i){return typeof IR(t)=="number"?t.pop():i}function Dz(t,i,e,n){function o(r){return r instanceof e?r:new e(function(g){g(r)})}return new(e||(e=Promise))(function(r,g){function w(N){try{k(n.next(N))}catch(V){g(V)}}function T(N){try{k(n.throw(N))}catch(V){g(V)}}function k(N){N.done?r(N.value):o(N.value).then(w,T)}k((n=n.apply(t,i||[])).next())})}function Tz(t){var i=typeof Symbol=="function"&&Symbol.iterator,e=i&&t[i],n=0;if(e)return e.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pg(t){return this instanceof Pg?(this.v=t,this):new Pg(t)}function Mz(t,i,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(t,i||[]),o,r=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),w("next"),w("throw"),w("return",g),o[Symbol.asyncIterator]=function(){return this},o;function g(Z){return function(X){return Promise.resolve(X).then(Z,V)}}function w(Z,X){n[Z]&&(o[Z]=function(te){return new Promise(function(De,_e){r.push([Z,te,De,_e])>1||T(Z,te)})},X&&(o[Z]=X(o[Z])))}function T(Z,X){try{k(n[Z](X))}catch(te){q(r[0][3],te)}}function k(Z){Z.value instanceof Pg?Promise.resolve(Z.value.v).then(N,V):q(r[0][2],Z)}function N(Z){T("next",Z)}function V(Z){T("throw",Z)}function q(Z,X){Z(X),r.shift(),r.length&&T(r[0][0],r[0][1])}}function Iz(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t[Symbol.asyncIterator],e;return i?i.call(t):(t=typeof Tz=="function"?Tz(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(g){return new Promise(function(w,T){g=t[r](g),o(w,T,g.done,g.value)})}}function o(r,g,w,T){Promise.resolve(T).then(function(k){r({value:k,done:w})},g)}}var JC=t=>t&&typeof t.length=="number"&&typeof t!="function";function e2(t){return gr(t?.then)}function t2(t){return gr(t[ty])}function i2(t){return Symbol.asyncIterator&&gr(t?.[Symbol.asyncIterator])}function n2(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function aee(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var r2=aee();function o2(t){return gr(t?.[r2])}function a2(t){return Mz(this,arguments,function*(){let e=t.getReader();try{for(;;){let{value:n,done:o}=yield Pg(e.read());if(o)return yield Pg(void 0);yield yield Pg(n)}}finally{e.releaseLock()}})}function s2(t){return gr(t?.getReader)}function Io(t){if(t instanceof wr)return t;if(t!=null){if(t2(t))return see(t);if(JC(t))return lee(t);if(e2(t))return cee(t);if(i2(t))return Az(t);if(o2(t))return uee(t);if(s2(t))return dee(t)}throw n2(t)}function see(t){return new wr(i=>{let e=t[ty]();if(gr(e.subscribe))return e.subscribe(i);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function lee(t){return new wr(i=>{for(let e=0;e<t.length&&!i.closed;e++)i.next(t[e]);i.complete()})}function cee(t){return new wr(i=>{t.then(e=>{i.closed||(i.next(e),i.complete())},e=>i.error(e)).then(null,$C)})}function uee(t){return new wr(i=>{for(let e of t)if(i.next(e),i.closed)return;i.complete()})}function Az(t){return new wr(i=>{hee(t,i).catch(e=>i.error(e))})}function dee(t){return Az(a2(t))}function hee(t,i){var e,n,o,r;return Dz(this,void 0,void 0,function*(){try{for(e=Iz(t);n=yield e.next(),!n.done;){let g=n.value;if(i.next(g),i.closed)return}}catch(g){o={error:g}}finally{try{n&&!n.done&&(r=e.return)&&(yield r.call(e))}finally{if(o)throw o.error}}i.complete()})}function fc(t,i,e,n=0,o=!1){let r=i.schedule(function(){e(),o?t.add(this.schedule(null,n)):this.unsubscribe()},n);if(t.add(r),!o)return r}function l2(t,i=0){return ur((e,n)=>{e.subscribe(ar(n,o=>fc(n,t,()=>n.next(o),i),()=>fc(n,t,()=>n.complete(),i),o=>fc(n,t,()=>n.error(o),i)))})}function c2(t,i=0){return ur((e,n)=>{n.add(t.schedule(()=>e.subscribe(n),i))})}function Rz(t,i){return Io(t).pipe(c2(i),l2(i))}function kz(t,i){return Io(t).pipe(c2(i),l2(i))}function Oz(t,i){return new wr(e=>{let n=0;return i.schedule(function(){n===t.length?e.complete():(e.next(t[n++]),e.closed||this.schedule())})})}function Pz(t,i){return new wr(e=>{let n;return fc(e,i,()=>{n=t[r2](),fc(e,i,()=>{let o,r;try{({value:o,done:r}=n.next())}catch(g){e.error(g);return}r?e.complete():e.next(o)},0,!0)}),()=>gr(n?.return)&&n.return()})}function u2(t,i){if(!t)throw new Error("Iterable cannot be null");return new wr(e=>{fc(e,i,()=>{let n=t[Symbol.asyncIterator]();fc(e,i,()=>{n.next().then(o=>{o.done?e.complete():e.next(o.value)})},0,!0)})})}function Nz(t,i){return u2(a2(t),i)}function Lz(t,i){if(t!=null){if(t2(t))return Rz(t,i);if(JC(t))return Oz(t,i);if(e2(t))return kz(t,i);if(i2(t))return u2(t,i);if(o2(t))return Pz(t,i);if(s2(t))return Nz(t,i)}throw n2(t)}function bo(t,i){return i?Lz(t,i):Io(t)}function Ni(...t){let i=Eh(t);return bo(t,i)}function wa(t,i){let e=gr(t)?t:()=>t,n=o=>o.error(e());return new wr(i?o=>i.schedule(n,0,o):n)}function ry(t){return!!t&&(t instanceof wr||gr(t.lift)&&gr(t.subscribe))}var vp=Q_(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function Fz(t){return t instanceof Date&&!isNaN(t)}function hn(t,i){return ur((e,n)=>{let o=0;e.subscribe(ar(n,r=>{n.next(t.call(i,r,o++))}))})}var{isArray:pee}=Array;function fee(t,i){return pee(i)?t(...i):t(i)}function d2(t){return hn(i=>fee(t,i))}var{isArray:mee}=Array,{getPrototypeOf:gee,prototype:_ee,keys:yee}=Object;function h2(t){if(t.length===1){let i=t[0];if(mee(i))return{args:i,keys:null};if(vee(i)){let e=yee(i);return{args:e.map(n=>i[n]),keys:e}}}return{args:t,keys:null}}function vee(t){return t&&typeof t=="object"&&gee(t)===_ee}function p2(t,i){return t.reduce((e,n,o)=>(e[n]=i[o],e),{})}function Ng(...t){let i=Eh(t),e=QC(t),{args:n,keys:o}=h2(t);if(n.length===0)return bo([],i);let r=new wr(bee(n,i,o?g=>p2(o,g):Ul));return e?r.pipe(d2(e)):r}function bee(t,i,e=Ul){return n=>{zz(i,()=>{let{length:o}=t,r=new Array(o),g=o,w=o;for(let T=0;T<o;T++)zz(i,()=>{let k=bo(t[T],i),N=!1;k.subscribe(ar(n,V=>{r[T]=V,N||(N=!0,w--),w||n.next(e(r.slice()))},()=>{--g||n.complete()}))},n)},n)}}function zz(t,i,e){t?fc(e,t,i):i()}function Bz(t,i,e,n,o,r,g,w){let T=[],k=0,N=0,V=!1,q=()=>{V&&!T.length&&!k&&i.complete()},Z=te=>k<n?X(te):T.push(te),X=te=>{r&&i.next(te),k++;let De=!1;Io(e(te,N++)).subscribe(ar(i,_e=>{o?.(_e),r?Z(_e):i.next(_e)},()=>{De=!0},void 0,()=>{if(De)try{for(k--;T.length&&k<n;){let _e=T.shift();g?fc(i,g,()=>X(_e)):X(_e)}q()}catch(_e){i.error(_e)}}))};return t.subscribe(ar(i,Z,()=>{V=!0,q()})),()=>{w?.()}}function Na(t,i,e=1/0){return gr(i)?Na((n,o)=>hn((r,g)=>i(n,r,o,g))(Io(t(n,o))),e):(typeof i=="number"&&(e=i),ur((n,o)=>Bz(n,o,t,e)))}function Vf(t=1/0){return Na(Ul,t)}function Vz(){return Vf(1)}function jf(...t){return Vz()(bo(t,Eh(t)))}function Ch(t){return new wr(i=>{Io(t()).subscribe(i)})}function I1(...t){let i=QC(t),{args:e,keys:n}=h2(t),o=new wr(r=>{let{length:g}=e;if(!g){r.complete();return}let w=new Array(g),T=g,k=g;for(let N=0;N<g;N++){let V=!1;Io(e[N]).subscribe(ar(r,q=>{V||(V=!0,k--),w[N]=q},()=>T--,void 0,()=>{(!T||!V)&&(k||r.next(n?p2(n,w):w),r.complete())}))}});return i?o.pipe(d2(i)):o}function f2(t=0,i,e=Cz){let n=-1;return i!=null&&(XC(i)?e=i:n=i),new wr(o=>{let r=Fz(t)?+t-e.now():t;r<0&&(r=0);let g=0;return e.schedule(function(){o.closed||(o.next(g++),0<=n?this.schedule(void 0,n):o.complete())},r)})}function A1(t=0,i=Og){return t<0&&(t=0),f2(t,t,i)}function ks(...t){let i=Eh(t),e=Sz(t,1/0),n=t;return n.length?n.length===1?Io(n[0]):Vf(e)(bo(n,i)):Rs}function zr(t,i){return ur((e,n)=>{let o=0;e.subscribe(ar(n,r=>t.call(i,r,o++)&&n.next(r)))})}function jz(t){return ur((i,e)=>{let n=!1,o=null,r=null,g=!1,w=()=>{if(r?.unsubscribe(),r=null,n){n=!1;let k=o;o=null,e.next(k)}g&&e.complete()},T=()=>{r=null,g&&e.complete()};i.subscribe(ar(e,k=>{n=!0,o=k,r||Io(t(k)).subscribe(r=ar(e,w,T))},()=>{g=!0,(!n||!r||r.closed)&&e.complete()}))})}function m2(t,i=Og){return jz(()=>f2(t,i))}function Br(t){return ur((i,e)=>{let n=null,o=!1,r;n=i.subscribe(ar(e,void 0,void 0,g=>{r=Io(t(g,Br(t)(i))),n?(n.unsubscribe(),n=null,r.subscribe(e)):o=!0})),o&&(n.unsubscribe(),n=null,r.subscribe(e))})}function Uz(t,i,e,n,o){return(r,g)=>{let w=e,T=i,k=0;r.subscribe(ar(g,N=>{let V=k++;T=w?t(T,N,V):(w=!0,N),n&&g.next(T)},o&&(()=>{w&&g.next(T),g.complete()})))}}function Sh(t,i){return gr(i)?Na(t,i,1):Na(t,1)}function R1(t,i=Og){return ur((e,n)=>{let o=null,r=null,g=null,w=()=>{if(o){o.unsubscribe(),o=null;let k=r;r=null,n.next(k)}};function T(){let k=g+t,N=i.now();if(N<k){o=this.schedule(void 0,k-N),n.add(o);return}w()}e.subscribe(ar(n,k=>{r=k,g=i.now(),o||(o=i.schedule(T,t),n.add(o))},()=>{w(),n.complete()},void 0,()=>{r=o=null}))})}function Uf(t){return ur((i,e)=>{let n=!1;i.subscribe(ar(e,o=>{n=!0,e.next(o)},()=>{n||e.next(t),e.complete()}))})}function ta(t){return t<=0?()=>Rs:ur((i,e)=>{let n=0;i.subscribe(ar(e,o=>{++n<=t&&(e.next(o),t<=n&&e.complete())}))})}function g2(t,i=Ul){return t=t??xee,ur((e,n)=>{let o,r=!0;e.subscribe(ar(n,g=>{let w=i(g);(r||!t(o,w))&&(r=!1,o=w,n.next(g))}))})}function xee(t,i){return t===i}function _2(t=wee){return ur((i,e)=>{let n=!1;i.subscribe(ar(e,o=>{n=!0,e.next(o)},()=>n?e.complete():e.error(t())))})}function wee(){return new vp}function Th(t){return ur((i,e)=>{try{i.subscribe(e)}finally{e.add(t)}})}function bp(t,i){let e=arguments.length>=2;return n=>n.pipe(t?zr((o,r)=>t(o,r,n)):Ul,ta(1),e?Uf(i):_2(()=>new vp))}function oy(t){return t<=0?()=>Rs:ur((i,e)=>{let n=[];i.subscribe(ar(e,o=>{n.push(o),t<n.length&&n.shift()},()=>{for(let o of n)e.next(o);e.complete()},void 0,()=>{n=null}))})}function AR(t,i){let e=arguments.length>=2;return n=>n.pipe(t?zr((o,r)=>t(o,r,n)):Ul,oy(1),e?Uf(i):_2(()=>new vp))}function y2(){return ur((t,i)=>{let e,n=!1;t.subscribe(ar(i,o=>{let r=e;e=o,n&&i.next([r,o]),n=!0}))})}function RR(t,i){return ur(Uz(t,i,arguments.length>=2,!0))}function k1(t={}){let{connector:i=()=>new gi,resetOnError:e=!0,resetOnComplete:n=!0,resetOnRefCountZero:o=!0}=t;return r=>{let g,w,T,k=0,N=!1,V=!1,q=()=>{w?.unsubscribe(),w=void 0},Z=()=>{q(),g=T=void 0,N=V=!1},X=()=>{let te=g;Z(),te?.unsubscribe()};return ur((te,De)=>{k++,!V&&!N&&q();let _e=T=T??i();De.add(()=>{k--,k===0&&!V&&!N&&(w=kR(X,o))}),_e.subscribe(De),!g&&k>0&&(g=new yp({next:he=>_e.next(he),error:he=>{V=!0,q(),w=kR(Z,e,he),_e.error(he)},complete:()=>{N=!0,q(),w=kR(Z,n),_e.complete()}}),Io(te).subscribe(g))})(r)}}function kR(t,i,...e){if(i===!0){t();return}if(i===!1)return;let n=new yp({next:()=>{n.unsubscribe(),t()}});return Io(i(...e)).subscribe(n)}function v2(t,i,e){let n,o=!1;return t&&typeof t=="object"?{bufferSize:n=1/0,windowTime:i=1/0,refCount:o=!1,scheduler:e}=t:n=t??1/0,k1({connector:()=>new kg(n,i,e),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:o})}function O1(t){return zr((i,e)=>t<=e)}function ia(...t){let i=Eh(t);return ur((e,n)=>{(i?jf(t,e,i):jf(t,e)).subscribe(n)})}function Za(t,i){return ur((e,n)=>{let o=null,r=0,g=!1,w=()=>g&&!o&&n.complete();e.subscribe(ar(n,T=>{o?.unsubscribe();let k=0,N=r++;Io(t(T,N)).subscribe(o=ar(n,V=>n.next(i?i(T,V,N,k++):V),()=>{o=null,w()}))},()=>{g=!0,w()}))})}function _r(t){return ur((i,e)=>{Io(t).subscribe(ar(e,()=>e.complete(),T1)),!e.closed&&i.subscribe(e)})}function Lg(t,i=!1){return ur((e,n)=>{let o=0;e.subscribe(ar(n,r=>{let g=t(r,o++);(g||i)&&n.next(r),!g&&n.complete()}))})}function hr(t,i,e){let n=gr(t)||i||e?{next:t,error:i,complete:e}:t;return n?ur((o,r)=>{var g;(g=n.subscribe)===null||g===void 0||g.call(n);let w=!0;o.subscribe(ar(r,T=>{var k;(k=n.next)===null||k===void 0||k.call(n,T),r.next(T)},()=>{var T;w=!1,(T=n.complete)===null||T===void 0||T.call(n),r.complete()},T=>{var k;w=!1,(k=n.error)===null||k===void 0||k.call(n,T),r.error(T)},()=>{var T,k;w&&((T=n.unsubscribe)===null||T===void 0||T.call(n)),(k=n.finalize)===null||k===void 0||k.call(n)}))}):Ul}var OR={JSACTION:"jsaction"};var La={CLICK:"click",CLICKMOD:"clickmod",DBLCLICK:"dblclick",FOCUS:"focus",FOCUSIN:"focusin",BLUR:"blur",FOCUSOUT:"focusout",SUBMIT:"submit",KEYDOWN:"keydown",KEYPRESS:"keypress",KEYUP:"keyup",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",ERROR:"error",LOAD:"load",TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove",TOGGLE:"toggle"},DDe=[La.MOUSEENTER,La.MOUSELEAVE,"pointerenter","pointerleave"],Eee=[La.CLICK,La.DBLCLICK,La.FOCUSIN,La.FOCUSOUT,La.KEYDOWN,La.KEYUP,La.KEYPRESS,La.MOUSEOVER,La.MOUSEOUT,La.SUBMIT,La.TOUCHSTART,La.TOUCHEND,La.TOUCHMOVE,"touchcancel","auxclick","change","compositionstart","compositionupdate","compositionend","beforeinput","input","select","copy","cut","paste","mousedown","mouseup","wheel","contextmenu","dragover","dragenter","dragleave","drop","dragstart","dragend","pointerdown","pointermove","pointerup","pointercancel","pointerover","pointerout","gotpointercapture","lostpointercapture","ended","loadedmetadata","pagehide","pageshow","visibilitychange","beforematch"],Hz=[La.FOCUS,La.BLUR,La.ERROR,La.LOAD,La.TOGGLE],qz=t=>Hz.indexOf(t)>=0,Cee=Eee.concat(Hz),$z=t=>Cee.indexOf(t)>=0;var MDe=typeof navigator<"u"&&/Macintosh/.test(navigator.userAgent);var IDe=typeof navigator<"u"&&/iPhone|iPad|iPod/.test(navigator.userAgent);var ADe=La.CLICK;var $B="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",si=class extends Error{code;constructor(i,e){super(dS(i,e)),this.code=i}};function See(t){return`NG0${Math.abs(t)}`}function dS(t,i){return`${See(t)}${i?": "+i:""}`}var GB=Symbol("InputSignalNode#UNSET"),Tee=ji(It({},jC),{transformFn:void 0,applyValueToInputSignal(t,i){C1(t,i)}});function WB(t,i){let e=Object.create(Tee);e.value=t,e.transformFn=i?.transform;function n(){if(x1(e),e.value===GB){let o=null;throw new si(-950,o)}return e.value}return n[pc]=e,n}function tx(t){return{toString:t}.toString()}var b2="__parameters__";function Dee(t){return function(...e){if(t){let n=t(...e);for(let o in n)this[o]=n[o]}}}function fk(t,i,e){return tx(()=>{let n=Dee(i);function o(...r){if(this instanceof o)return n.apply(this,r),this;let g=new o(...r);return w.annotation=g,w;function w(T,k,N){let V=T.hasOwnProperty(b2)?T[b2]:Object.defineProperty(T,b2,{value:[]})[b2];for(;V.length<=N;)V.push(null);return(V[N]=V[N]||[]).push(g),T}}return o.prototype.ngMetadataName=t,o.annotationCls=o,o})}var Os=globalThis;function Ao(t){for(let i in t)if(t[i]===Ao)return i;throw Error("Could not find renamed property on target object.")}function Mee(t,i){for(let e in i)i.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=i[e])}function gc(t){if(typeof t=="string")return t;if(Array.isArray(t))return`[${t.map(gc).join(", ")}]`;if(t==null)return""+t;let i=t.overriddenName||t.name;if(i)return`${i}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n>=0?e.slice(0,n):e}function JR(t,i){return t?i?`${t} ${i}`:t:i||""}var Iee=Ao({__forward_ref__:Ao});function Ka(t){return t.__forward_ref__=Ka,t.toString=function(){return gc(this())},t}function Ks(t){return ZB(t)?t():t}function ZB(t){return typeof t=="function"&&t.hasOwnProperty(Iee)&&t.__forward_ref__===Ka}function Ft(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function qi(t){return{providers:t.providers||[],imports:t.imports||[]}}function hS(t){return Gz(t,KB)||Gz(t,XB)}function YB(t){return hS(t)!==null}function Gz(t,i){return t.hasOwnProperty(i)?t[i]:null}function Aee(t){let i=t&&(t[KB]||t[XB]);return i||null}function Wz(t){return t&&(t.hasOwnProperty(Zz)||t.hasOwnProperty(Ree))?t[Zz]:null}var KB=Ao({\u0275prov:Ao}),Zz=Ao({\u0275inj:Ao}),XB=Ao({ngInjectableDef:Ao}),Ree=Ao({ngInjectorDef:Ao}),Ot=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(i,e){this._desc=i,this.\u0275prov=void 0,typeof e=="number"?this.__NG_ELEMENT_ID__=e:e!==void 0&&(this.\u0275prov=Ft({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function QB(t){return t&&!!t.\u0275providers}var kee=Ao({\u0275cmp:Ao}),Oee=Ao({\u0275dir:Ao}),Pee=Ao({\u0275pipe:Ao}),Nee=Ao({\u0275mod:Ao}),k2=Ao({\u0275fac:Ao}),L1=Ao({__NG_ELEMENT_ID__:Ao}),Yz=Ao({__NG_ENV_ID__:Ao});function Ug(t){return typeof t=="string"?t:t==null?"":String(t)}function Lee(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():Ug(t)}function JB(t,i){throw new si(-200,t)}function mk(t,i){throw new si(-201,!1)}var kr=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(kr||{}),e3;function eV(){return e3}function mc(t){let i=e3;return e3=t,i}function tV(t,i,e){let n=hS(t);if(n&&n.providedIn=="root")return n.value===void 0?n.value=n.factory():n.value;if(e&kr.Optional)return null;if(i!==void 0)return i;mk(t,"Injector")}var Fee={},Bg=Fee,t3="__NG_DI_FLAG__",O2=class{injector;constructor(i){this.injector=i}retrieve(i,e){let n=e;return this.injector.get(i,n.optional?UC:Bg,n)}},P2="ngTempTokenPath",zee="ngTokenPath",Bee=/\n/gm,Vee="\u0275",Kz="__source";function jee(t,i=kr.Default){if(S1()===void 0)throw new si(-203,!1);if(S1()===null)return tV(t,void 0,i);{let e=S1(),n;return e instanceof O2?n=e.injector:n=e,n.get(t,i&kr.Optional?null:void 0,i)}}function bi(t,i=kr.Default){return(eV()||jee)(Ks(t),i)}function J(t,i=kr.Default){return bi(t,pS(i))}function pS(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function i3(t){let i=[];for(let e=0;e<t.length;e++){let n=Ks(t[e]);if(Array.isArray(n)){if(n.length===0)throw new si(900,!1);let o,r=kr.Default;for(let g=0;g<n.length;g++){let w=n[g],T=Uee(w);typeof T=="number"?T===-1?o=w.token:r|=T:o=w}i.push(bi(o,r))}else i.push(bi(n))}return i}function gk(t,i){return t[t3]=i,t.prototype[t3]=i,t}function Uee(t){return t[t3]}function Hee(t,i,e,n){let o=t[P2];throw i[Kz]&&o.unshift(i[Kz]),t.message=qee(`
`+t.message,o,e,n),t[zee]=o,t[P2]=null,t}function qee(t,i,e,n=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==Vee?t.slice(2):t;let o=gc(i);if(Array.isArray(i))o=i.map(gc).join(" -> ");else if(typeof i=="object"){let r=[];for(let g in i)if(i.hasOwnProperty(g)){let w=i[g];r.push(g+":"+(typeof w=="string"?JSON.stringify(w):gc(w)))}o=`{${r.join(", ")}}`}return`${e}${n?"("+n+")":""}[${o}]: ${t.replace(Bee,`
  `)}`}var _k=gk(fk("Inject",t=>({token:t})),-1),Rh=gk(fk("Optional"),8);var by=gk(fk("SkipSelf"),4);function Hg(t,i){let e=t.hasOwnProperty(k2);return e?t[k2]:null}function $ee(t,i,e){if(t.length!==i.length)return!1;for(let n=0;n<t.length;n++){let o=t[n],r=i[n];if(e&&(o=e(o),r=e(r)),r!==o)return!1}return!0}function Gee(t){return t.flat(Number.POSITIVE_INFINITY)}function yk(t,i){t.forEach(e=>Array.isArray(e)?yk(e,i):i(e))}function iV(t,i,e){i>=t.length?t.push(e):t.splice(i,0,e)}function N2(t,i){return i>=t.length-1?t.pop():t.splice(i,1)[0]}function Wee(t,i){let e=[];for(let n=0;n<t;n++)e.push(i);return e}function Zee(t,i,e,n){let o=t.length;if(o==i)t.push(e,n);else if(o===1)t.push(n,t[0]),t[0]=e;else{for(o--,t.push(t[o-1],t[o]);o>i;){let r=o-2;t[o]=t[r],o--}t[i]=e,t[i+1]=n}}function fS(t,i,e){let n=ix(t,i);return n>=0?t[n|1]=e:(n=~n,Zee(t,n,i,e)),n}function PR(t,i){let e=ix(t,i);if(e>=0)return t[e|1]}function ix(t,i){return Yee(t,i,1)}function Yee(t,i,e){let n=0,o=t.length>>e;for(;o!==n;){let r=n+(o-n>>1),g=t[r<<e];if(i===g)return r<<e;g>i?o=r:n=r+1}return~(o<<e)}var Mh={},fl=[],qg=new Ot(""),nV=new Ot("",-1),rV=new Ot(""),L2=class{get(i,e=Bg){if(e===Bg){let n=new Error(`NullInjectorError: No provider for ${gc(i)}!`);throw n.name="NullInjectorError",n}return e}};function oV(t,i){let e=t[Nee]||null;if(!e&&i===!0)throw new Error(`Type ${gc(t)} does not have '\u0275mod' property.`);return e}function xp(t){return t[kee]||null}function aV(t){return t[Oee]||null}function Kee(t){return t[Pee]||null}function eu(t){return{\u0275providers:t}}function vk(...t){return{\u0275providers:sV(!0,t),\u0275fromNgModule:!0}}function sV(t,...i){let e=[],n=new Set,o,r=g=>{e.push(g)};return yk(i,g=>{let w=g;n3(w,r,[],n)&&(o||=[],o.push(w))}),o!==void 0&&lV(o,r),e}function lV(t,i){for(let e=0;e<t.length;e++){let{ngModule:n,providers:o}=t[e];bk(o,r=>{i(r,n)})}}function n3(t,i,e,n){if(t=Ks(t),!t)return!1;let o=null,r=Wz(t),g=!r&&xp(t);if(!r&&!g){let T=t.ngModule;if(r=Wz(T),r)o=T;else return!1}else{if(g&&!g.standalone)return!1;o=t}let w=n.has(o);if(g){if(w)return!1;if(n.add(o),g.dependencies){let T=typeof g.dependencies=="function"?g.dependencies():g.dependencies;for(let k of T)n3(k,i,e,n)}}else if(r){if(r.imports!=null&&!w){n.add(o);let k;try{yk(r.imports,N=>{n3(N,i,e,n)&&(k||=[],k.push(N))})}finally{}k!==void 0&&lV(k,i)}if(!w){let k=Hg(o)||(()=>new o);i({provide:o,useFactory:k,deps:fl},o),i({provide:rV,useValue:o,multi:!0},o),i({provide:qg,useValue:()=>bi(o),multi:!0},o)}let T=r.providers;if(T!=null&&!w){let k=t;bk(T,N=>{i(N,k)})}}else return!1;return o!==t&&t.providers!==void 0}function bk(t,i){for(let e of t)QB(e)&&(e=e.\u0275providers),Array.isArray(e)?bk(e,i):i(e)}var Xee=Ao({provide:String,useValue:Ao});function cV(t){return t!==null&&typeof t=="object"&&Xee in t}function Qee(t){return!!(t&&t.useExisting)}function Jee(t){return!!(t&&t.useFactory)}function hy(t){return typeof t=="function"}function ete(t){return!!t.useClass}var mS=new Ot(""),T2={},Xz={},NR;function gS(){return NR===void 0&&(NR=new L2),NR}var Ea=class{},V1=class extends Ea{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(i,e,n,o){super(),this.parent=e,this.source=n,this.scopes=o,o3(i,g=>this.processProvider(g)),this.records.set(nV,ay(void 0,this)),o.has("environment")&&this.records.set(Ea,ay(void 0,this));let r=this.records.get(mS);r!=null&&typeof r.value=="string"&&this.scopes.add(r.value),this.injectorDefTypes=new Set(this.get(rV,fl,kr.Self))}retrieve(i,e){let n=e;return this.get(i,n.optional?UC:Bg,n)}destroy(){N1(this),this._destroyed=!0;let i=Mr(null);try{for(let n of this._ngOnDestroyHooks)n.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let n of e)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Mr(i)}}onDestroy(i){return N1(this),this._onDestroyHooks.push(i),()=>this.removeOnDestroy(i)}runInContext(i){N1(this);let e=_p(this),n=mc(void 0),o;try{return i()}finally{_p(e),mc(n)}}get(i,e=Bg,n=kr.Default){if(N1(this),i.hasOwnProperty(Yz))return i[Yz](this);n=pS(n);let o,r=_p(this),g=mc(void 0);try{if(!(n&kr.SkipSelf)){let T=this.records.get(i);if(T===void 0){let k=ote(i)&&hS(i);k&&this.injectableDefInScope(k)?T=ay(r3(i),T2):T=null,this.records.set(i,T)}if(T!=null)return this.hydrate(i,T)}let w=n&kr.Self?gS():this.parent;return e=n&kr.Optional&&e===Bg?null:e,w.get(i,e)}catch(w){if(w.name==="NullInjectorError"){if((w[P2]=w[P2]||[]).unshift(gc(i)),r)throw w;return Hee(w,i,"R3InjectorError",this.source)}else throw w}finally{mc(g),_p(r)}}resolveInjectorInitializers(){let i=Mr(null),e=_p(this),n=mc(void 0),o;try{let r=this.get(qg,fl,kr.Self);for(let g of r)g()}finally{_p(e),mc(n),Mr(i)}}toString(){let i=[],e=this.records;for(let n of e.keys())i.push(gc(n));return`R3Injector[${i.join(", ")}]`}processProvider(i){i=Ks(i);let e=hy(i)?i:Ks(i&&i.provide),n=ite(i);if(!hy(i)&&i.multi===!0){let o=this.records.get(e);o||(o=ay(void 0,T2,!0),o.factory=()=>i3(o.multi),this.records.set(e,o)),e=i,o.multi.push(i)}this.records.set(e,n)}hydrate(i,e){let n=Mr(null);try{return e.value===Xz?JB(gc(i)):e.value===T2&&(e.value=Xz,e.value=e.factory()),typeof e.value=="object"&&e.value&&rte(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}finally{Mr(n)}}injectableDefInScope(i){if(!i.providedIn)return!1;let e=Ks(i.providedIn);return typeof e=="string"?e==="any"||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(i){let e=this._onDestroyHooks.indexOf(i);e!==-1&&this._onDestroyHooks.splice(e,1)}};function r3(t){let i=hS(t),e=i!==null?i.factory:Hg(t);if(e!==null)return e;if(t instanceof Ot)throw new si(204,!1);if(t instanceof Function)return tte(t);throw new si(204,!1)}function tte(t){if(t.length>0)throw new si(204,!1);let e=Aee(t);return e!==null?()=>e.factory(t):()=>new t}function ite(t){if(cV(t))return ay(void 0,t.useValue);{let i=uV(t);return ay(i,T2)}}function uV(t,i,e){let n;if(hy(t)){let o=Ks(t);return Hg(o)||r3(o)}else if(cV(t))n=()=>Ks(t.useValue);else if(Jee(t))n=()=>t.useFactory(...i3(t.deps||[]));else if(Qee(t))n=()=>bi(Ks(t.useExisting));else{let o=Ks(t&&(t.useClass||t.provide));if(nte(t))n=()=>new o(...i3(t.deps));else return Hg(o)||r3(o)}return n}function N1(t){if(t.destroyed)throw new si(205,!1)}function ay(t,i,e=!1){return{factory:t,value:i,multi:e?[]:void 0}}function nte(t){return!!t.deps}function rte(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function ote(t){return typeof t=="function"||typeof t=="object"&&t instanceof Ot}function o3(t,i){for(let e of t)Array.isArray(e)?o3(e,i):e&&QB(e)?o3(e.\u0275providers,i):i(e)}function gl(t,i){let e;t instanceof V1?(N1(t),e=t):e=new O2(t);let n,o=_p(e),r=mc(void 0);try{return i()}finally{_p(o),mc(r)}}function dV(){return eV()!==void 0||S1()!=null}function _S(t){if(!dV())throw new si(-203,!1)}function ate(t){let i=Os.ng;if(i&&i.\u0275compilerFacade)return i.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function ste(t){return typeof t=="function"}var fs=0,Ln=1,sr=2,Ps=3,Md=4,_c=5,Id=6,j1=7,Ya=8,py=9,wp=10,_o=11,U1=12,Qz=13,xy=14,ml=15,$g=16,sy=17,Ep=18,yS=19,hV=20,Hf=21,LR=22,Gg=23,Au=24,uy=25,qr=26,xk=1,H1=6,Cp=7,F2=8,fy=9,Xs=10;function qf(t){return Array.isArray(t)&&typeof t[xk]=="object"}function ku(t){return Array.isArray(t)&&t[xk]===!0}function wk(t){return(t.flags&4)!==0}function Kf(t){return t.componentOffset>-1}function vS(t){return(t.flags&1)===1}function Ih(t){return!!t.template}function my(t){return(t[sr]&512)!==0}function pV(t){return(t.type&16)===16}function lte(t){return(t[sr]&32)===32}function nx(t){return(t[sr]&256)===256}var a3=class{previousValue;currentValue;firstChange;constructor(i,e,n){this.previousValue=i,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}};function fV(t,i,e,n){i!==null?i.applyValueToInputSignal(i,n):t[e]=n}var $r=(()=>{let t=()=>mV;return t.ngInherit=!0,t})();function mV(t){return t.type.prototype.ngOnChanges&&(t.setInput=ute),cte}function cte(){let t=_V(this),i=t?.current;if(i){let e=t.previous;if(e===Mh)t.previous=i;else for(let n in i)e[n]=i[n];t.current=null,this.ngOnChanges(i)}}function ute(t,i,e,n,o){let r=this.declaredInputs[n],g=_V(t)||dte(t,{previous:Mh,current:null}),w=g.current||(g.current={}),T=g.previous,k=T[r];w[r]=new a3(k&&k.currentValue,e,T===Mh),fV(t,i,o,e)}var gV="__ngSimpleChanges__";function _V(t){return t[gV]||null}function dte(t,i){return t[gV]=i}var Jz=null;var xo=function(t,i=null,e){Jz?.(t,i,e)},yV="svg",hte="math";function Wo(t){for(;Array.isArray(t);)t=t[fs];return t}function vV(t){for(;Array.isArray(t);){if(typeof t[xk]=="object")return t;t=t[fs]}return null}function bV(t,i){return Wo(i[t])}function Rd(t,i){return Wo(i[t.index])}function Ek(t,i){return t.data[i]}function Ck(t,i){return t[i]}function Ah(t,i){let e=i[t];return qf(e)?e:e[fs]}function pte(t){return(t[sr]&4)===4}function Sk(t){return(t[sr]&128)===128}function fte(t){return ku(t[Ps])}function Gf(t,i){return i==null?null:t[i]}function xV(t){t[sy]=0}function wV(t){t[sr]&1024||(t[sr]|=1024,Sk(t)&&wy(t))}function mte(t,i){for(;t>0;)i=i[xy],t--;return i}function bS(t){return!!(t[sr]&9216||t[Au]?.dirty)}function s3(t){t[wp].changeDetectionScheduler?.notify(8),t[sr]&64&&(t[sr]|=1024),bS(t)&&wy(t)}function wy(t){t[wp].changeDetectionScheduler?.notify(0);let i=Wg(t);for(;i!==null&&!(i[sr]&8192||(i[sr]|=8192,!Sk(i)));)i=Wg(i)}function EV(t,i){if(nx(t))throw new si(911,!1);t[Hf]===null&&(t[Hf]=[]),t[Hf].push(i)}function gte(t,i){if(t[Hf]===null)return;let e=t[Hf].indexOf(i);e!==-1&&t[Hf].splice(e,1)}function Wg(t){let i=t[Ps];return ku(i)?i[Ps]:i}function Tk(t){return t[j1]??=[]}function Dk(t){return t.cleanup??=[]}function _te(t,i,e,n){let o=Tk(i);o.push(e),t.firstCreatePass&&Dk(t).push(n,o.length-1)}var yr={lFrame:MV(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var l3=!1;function yte(){return yr.lFrame.elementDepthCount}function vte(){yr.lFrame.elementDepthCount++}function bte(){yr.lFrame.elementDepthCount--}function Mk(){return yr.bindingsEnabled}function Ey(){return yr.skipHydrationRootTNode!==null}function xte(t){return yr.skipHydrationRootTNode===t}function wte(t){yr.skipHydrationRootTNode=t}function Ete(){yr.skipHydrationRootTNode=null}function qn(){return yr.lFrame.lView}function Yo(){return yr.lFrame.tView}function ri(t){return yr.lFrame.contextLView=t,t[Ya]}function oi(t){return yr.lFrame.contextLView=null,t}function _l(){let t=CV();for(;t!==null&&t.type===64;)t=t.parent;return t}function CV(){return yr.lFrame.currentTNode}function Cte(){let t=yr.lFrame,i=t.currentTNode;return t.isParent?i:i.parent}function Xf(t,i){let e=yr.lFrame;e.currentTNode=t,e.isParent=i}function Ik(){return yr.lFrame.isParent}function Ak(){yr.lFrame.isParent=!1}function Ste(){return yr.lFrame.contextLView}function SV(){return l3}function z2(t){let i=l3;return l3=t,i}function Cy(){let t=yr.lFrame,i=t.bindingRootIndex;return i===-1&&(i=t.bindingRootIndex=t.tView.bindingStartIndex),i}function Tte(){return yr.lFrame.bindingIndex}function Dte(t){return yr.lFrame.bindingIndex=t}function Qg(){return yr.lFrame.bindingIndex++}function Rk(t){let i=yr.lFrame,e=i.bindingIndex;return i.bindingIndex=i.bindingIndex+t,e}function Mte(){return yr.lFrame.inI18n}function Ite(t,i){let e=yr.lFrame;e.bindingIndex=e.bindingRootIndex=t,c3(i)}function Ate(){return yr.lFrame.currentDirectiveIndex}function c3(t){yr.lFrame.currentDirectiveIndex=t}function Rte(t){let i=yr.lFrame.currentDirectiveIndex;return i===-1?null:t[i]}function kk(){return yr.lFrame.currentQueryIndex}function xS(t){yr.lFrame.currentQueryIndex=t}function kte(t){let i=t[Ln];return i.type===2?i.declTNode:i.type===1?t[_c]:null}function TV(t,i,e){if(e&kr.SkipSelf){let o=i,r=t;for(;o=o.parent,o===null&&!(e&kr.Host);)if(o=kte(r),o===null||(r=r[xy],o.type&10))break;if(o===null)return!1;i=o,t=r}let n=yr.lFrame=DV();return n.currentTNode=i,n.lView=t,!0}function Ok(t){let i=DV(),e=t[Ln];yr.lFrame=i,i.currentTNode=e.firstChild,i.lView=t,i.tView=e,i.contextLView=t,i.bindingIndex=e.bindingStartIndex,i.inI18n=!1}function DV(){let t=yr.lFrame,i=t===null?null:t.child;return i===null?MV(t):i}function MV(t){let i={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=i),i}function IV(){let t=yr.lFrame;return yr.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var AV=IV;function Pk(){let t=IV();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Ote(t){return(yr.lFrame.contextLView=mte(t,yr.lFrame.contextLView))[Ya]}function Mp(){return yr.lFrame.selectedIndex}function Zg(t){yr.lFrame.selectedIndex=t}function rx(){let t=yr.lFrame;return Ek(t.tView,t.selectedIndex)}function gs(){yr.lFrame.currentNamespace=yV}function Jg(){Pte()}function Pte(){yr.lFrame.currentNamespace=null}function RV(){return yr.lFrame.currentNamespace}var kV=!0;function wS(){return kV}function Qf(t){kV=t}function Nte(t,i,e){let{ngOnChanges:n,ngOnInit:o,ngDoCheck:r}=i.type.prototype;if(n){let g=mV(i);(e.preOrderHooks??=[]).push(t,g),(e.preOrderCheckHooks??=[]).push(t,g)}o&&(e.preOrderHooks??=[]).push(0-t,o),r&&((e.preOrderHooks??=[]).push(t,r),(e.preOrderCheckHooks??=[]).push(t,r))}function Nk(t,i){for(let e=i.directiveStart,n=i.directiveEnd;e<n;e++){let r=t.data[e].type.prototype,{ngAfterContentInit:g,ngAfterContentChecked:w,ngAfterViewInit:T,ngAfterViewChecked:k,ngOnDestroy:N}=r;g&&(t.contentHooks??=[]).push(-e,g),w&&((t.contentHooks??=[]).push(e,w),(t.contentCheckHooks??=[]).push(e,w)),T&&(t.viewHooks??=[]).push(-e,T),k&&((t.viewHooks??=[]).push(e,k),(t.viewCheckHooks??=[]).push(e,k)),N!=null&&(t.destroyHooks??=[]).push(e,N)}}function D2(t,i,e){OV(t,i,3,e)}function M2(t,i,e,n){(t[sr]&3)===e&&OV(t,i,e,n)}function FR(t,i){let e=t[sr];(e&3)===i&&(e&=16383,e+=1,t[sr]=e)}function OV(t,i,e,n){let o=n!==void 0?t[sy]&65535:0,r=n??-1,g=i.length-1,w=0;for(let T=o;T<g;T++)if(typeof i[T+1]=="number"){if(w=i[T],n!=null&&w>=n)break}else i[T]<0&&(t[sy]+=65536),(w<r||r==-1)&&(Lte(t,e,i,T),t[sy]=(t[sy]&4294901760)+T+2),T++}function eB(t,i){xo(4,t,i);let e=Mr(null);try{i.call(t)}finally{Mr(e),xo(5,t,i)}}function Lte(t,i,e,n){let o=e[n]<0,r=e[n+1],g=o?-e[n]:e[n],w=t[g];o?t[sr]>>14<t[sy]>>16&&(t[sr]&3)===i&&(t[sr]+=16384,eB(w,r)):eB(w,r)}var dy=-1,Yg=class{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(i,e,n){this.factory=i,this.canSeeViewProviders=e,this.injectImpl=n}};function PV(t){return t!=null&&typeof t=="object"&&(t.insertBeforeIndex===null||typeof t.insertBeforeIndex=="number"||Array.isArray(t.insertBeforeIndex))}function Fte(t){return!!(t.type&128)}function zte(t){return(t.flags&8)!==0}function Bte(t){return(t.flags&16)!==0}function Vte(t,i,e){let n=0;for(;n<e.length;){let o=e[n];if(typeof o=="number"){if(o!==0)break;n++;let r=e[n++],g=e[n++],w=e[n++];t.setAttribute(i,g,w,r)}else{let r=o,g=e[++n];jte(r)?t.setProperty(i,r,g):t.setAttribute(i,r,g),n++}}return n}function NV(t){return t===3||t===4||t===6}function jte(t){return t.charCodeAt(0)===64}function gy(t,i){if(!(i===null||i.length===0))if(t===null||t.length===0)t=i.slice();else{let e=-1;for(let n=0;n<i.length;n++){let o=i[n];typeof o=="number"?e=o:e===0||(e===-1||e===2?tB(t,e,o,null,i[++n]):tB(t,e,o,null,null))}}return t}function tB(t,i,e,n,o){let r=0,g=t.length;if(i===-1)g=-1;else for(;r<t.length;){let w=t[r++];if(typeof w=="number"){if(w===i){g=-1;break}else if(w>i){g=r-1;break}}}for(;r<t.length;){let w=t[r];if(typeof w=="number")break;if(w===e){o!==null&&(t[r+1]=o);return}r++,o!==null&&r++}g!==-1&&(t.splice(g,0,i),r=g+1),t.splice(r++,0,e),o!==null&&t.splice(r++,0,o)}function LV(t){return t!==dy}function B2(t){return t&32767}function Ute(t){return t>>16}function V2(t,i){let e=Ute(t),n=i;for(;e>0;)n=n[xy],e--;return n}var u3=!0;function j2(t){let i=u3;return u3=t,i}var Hte=256,FV=Hte-1,zV=5,qte=0,Dh={};function $te(t,i,e){let n;typeof e=="string"?n=e.charCodeAt(0)||0:e.hasOwnProperty(L1)&&(n=e[L1]),n==null&&(n=e[L1]=qte++);let o=n&FV,r=1<<o;i.data[t+(o>>zV)]|=r}function U2(t,i){let e=BV(t,i);if(e!==-1)return e;let n=i[Ln];n.firstCreatePass&&(t.injectorIndex=i.length,zR(n.data,t),zR(i,null),zR(n.blueprint,null));let o=Lk(t,i),r=t.injectorIndex;if(LV(o)){let g=B2(o),w=V2(o,i),T=w[Ln].data;for(let k=0;k<8;k++)i[r+k]=w[g+k]|T[g+k]}return i[r+8]=o,r}function zR(t,i){t.push(0,0,0,0,0,0,0,0,i)}function BV(t,i){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||i[t.injectorIndex+8]===null?-1:t.injectorIndex}function Lk(t,i){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let e=0,n=null,o=i;for(;o!==null;){if(n=qV(o),n===null)return dy;if(e++,o=o[xy],n.injectorIndex!==-1)return n.injectorIndex|e<<16}return dy}function d3(t,i,e){$te(t,i,e)}function Gte(t,i){if(i==="class")return t.classes;if(i==="style")return t.styles;let e=t.attrs;if(e){let n=e.length,o=0;for(;o<n;){let r=e[o];if(NV(r))break;if(r===0)o=o+2;else if(typeof r=="number")for(o++;o<n&&typeof e[o]=="string";)o++;else{if(r===i)return e[o+1];o=o+2}}}return null}function VV(t,i,e){if(e&kr.Optional||t!==void 0)return t;mk(i,"NodeInjector")}function jV(t,i,e,n){if(e&kr.Optional&&n===void 0&&(n=null),(e&(kr.Self|kr.Host))===0){let o=t[py],r=mc(void 0);try{return o?o.get(i,n,e&kr.Optional):tV(i,n,e&kr.Optional)}finally{mc(r)}}return VV(n,i,e)}function UV(t,i,e,n=kr.Default,o){if(t!==null){if(i[sr]&2048&&!(n&kr.Self)){let g=Kte(t,i,e,n,Dh);if(g!==Dh)return g}let r=HV(t,i,e,n,Dh);if(r!==Dh)return r}return jV(i,e,n,o)}function HV(t,i,e,n,o){let r=Zte(e);if(typeof r=="function"){if(!TV(i,t,n))return n&kr.Host?VV(o,e,n):jV(i,e,n,o);try{let g;if(g=r(n),g==null&&!(n&kr.Optional))mk(e);else return g}finally{AV()}}else if(typeof r=="number"){let g=null,w=BV(t,i),T=dy,k=n&kr.Host?i[ml][_c]:null;for((w===-1||n&kr.SkipSelf)&&(T=w===-1?Lk(t,i):i[w+8],T===dy||!nB(n,!1)?w=-1:(g=i[Ln],w=B2(T),i=V2(T,i)));w!==-1;){let N=i[Ln];if(iB(r,w,N.data)){let V=Wte(w,i,e,g,n,k);if(V!==Dh)return V}T=i[w+8],T!==dy&&nB(n,i[Ln].data[w+8]===k)&&iB(r,w,i)?(g=N,w=B2(T),i=V2(T,i)):w=-1}}return o}function Wte(t,i,e,n,o,r){let g=i[Ln],w=g.data[t+8],T=n==null?Kf(w)&&u3:n!=g&&(w.type&3)!==0,k=o&kr.Host&&r===w,N=I2(w,g,e,T,k);return N!==null?q1(i,g,N,w):Dh}function I2(t,i,e,n,o){let r=t.providerIndexes,g=i.data,w=r&1048575,T=t.directiveStart,k=t.directiveEnd,N=r>>20,V=n?w:w+N,q=o?w+N:k;for(let Z=V;Z<q;Z++){let X=g[Z];if(Z<T&&e===X||Z>=T&&X.type===e)return Z}if(o){let Z=g[T];if(Z&&Ih(Z)&&Z.type===e)return T}return null}function q1(t,i,e,n){let o=t[e],r=i.data;if(o instanceof Yg){let g=o;g.resolving&&JB(Lee(r[e]));let w=j2(g.canSeeViewProviders);g.resolving=!0;let T,k=g.injectImpl?mc(g.injectImpl):null,N=TV(t,n,kr.Default);try{o=t[e]=g.factory(void 0,r,t,n),i.firstCreatePass&&e>=n.directiveStart&&Nte(e,r[e],i)}finally{k!==null&&mc(k),j2(w),g.resolving=!1,AV()}}return o}function Zte(t){if(typeof t=="string")return t.charCodeAt(0)||0;let i=t.hasOwnProperty(L1)?t[L1]:void 0;return typeof i=="number"?i>=0?i&FV:Yte:i}function iB(t,i,e){let n=1<<t;return!!(e[i+(t>>zV)]&n)}function nB(t,i){return!(t&kr.Self)&&!(t&kr.Host&&i)}var Vg=class{_tNode;_lView;constructor(i,e){this._tNode=i,this._lView=e}get(i,e,n){return UV(this._tNode,this._lView,i,pS(n),e)}};function Yte(){return new Vg(_l(),qn())}function Vr(t){return tx(()=>{let i=t.prototype.constructor,e=i[k2]||h3(i),n=Object.prototype,o=Object.getPrototypeOf(t.prototype).constructor;for(;o&&o!==n;){let r=o[k2]||h3(o);if(r&&r!==e)return r;o=Object.getPrototypeOf(o)}return r=>new r})}function h3(t){return ZB(t)?()=>{let i=h3(Ks(t));return i&&i()}:Hg(t)}function Kte(t,i,e,n,o){let r=t,g=i;for(;r!==null&&g!==null&&g[sr]&2048&&!my(g);){let w=HV(r,g,e,n|kr.Self,Dh);if(w!==Dh)return w;let T=r.parent;if(!T){let k=g[hV];if(k){let N=k.get(e,Dh,n);if(N!==Dh)return N}T=qV(g),g=g[xy]}r=T}return o}function qV(t){let i=t[Ln],e=i.type;return e===2?i.declTNode:e===1?t[_c]:null}function ES(t){return Gte(_l(),t)}function rB(t,i=null,e=null,n){let o=$V(t,i,e,n);return o.resolveInjectorInitializers(),o}function $V(t,i=null,e=null,n,o=new Set){let r=[e||fl,vk(t)];return n=n||(typeof t=="object"?void 0:gc(t)),new V1(r,i||gS(),n||null,o)}var wn=class t{static THROW_IF_NOT_FOUND=Bg;static NULL=new L2;static create(i,e){if(Array.isArray(i))return rB({name:""},e,i,"");{let n=i.name??"";return rB({name:n},i.parent,i.providers,n)}}static \u0275prov=Ft({token:t,providedIn:"any",factory:()=>bi(nV)});static __NG_ELEMENT_ID__=-1};var Ru=class{attributeName;constructor(i){this.attributeName=i}__NG_ELEMENT_ID__=()=>ES(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}},Xte=new Ot("");Xte.__NG_ELEMENT_ID__=t=>{let i=_l();if(i===null)throw new si(204,!1);if(i.type&2)return i.value;if(t&kr.Optional)return null;throw new si(204,!1)};var GV=!1,Sy=(()=>{class t{static __NG_ELEMENT_ID__=Qte;static __NG_ENV_ID__=e=>e}return t})(),H2=class extends Sy{_lView;constructor(i){super(),this._lView=i}onDestroy(i){return EV(this._lView,i),()=>gte(this._lView,i)}};function Qte(){return new H2(qn())}var Wf=class{},CS=new Ot("",{providedIn:"root",factory:()=>!1});var WV=new Ot(""),ZV=new Ot(""),Ip=(()=>{class t{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new to(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let e=this.taskId++;return this.pendingTasks.add(e),e}has(e){return this.pendingTasks.has(e)}remove(e){this.pendingTasks.delete(e),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=Ft({token:t,providedIn:"root",factory:()=>new t})}return t})();var p3=class extends gi{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(i=!1){super(),this.__isAsync=i,dV()&&(this.destroyRef=J(Sy,{optional:!0})??void 0,this.pendingTasks=J(Ip,{optional:!0})??void 0)}emit(i){let e=Mr(null);try{super.next(i)}finally{Mr(e)}}subscribe(i,e,n){let o=i,r=e||(()=>null),g=n;if(i&&typeof i=="object"){let T=i;o=T.next?.bind(T),r=T.error?.bind(T),g=T.complete?.bind(T)}this.__isAsync&&(r=this.wrapInTimeout(r),o&&(o=this.wrapInTimeout(o)),g&&(g=this.wrapInTimeout(g)));let w=super.subscribe({next:o,error:r,complete:g});return i instanceof nr&&i.add(w),w}wrapInTimeout(i){return e=>{let n=this.pendingTasks?.add();setTimeout(()=>{i(e),n!==void 0&&this.pendingTasks?.remove(n)})}}},Mi=p3;function $1(...t){}function YV(t){let i,e;function n(){t=$1;try{e!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(e),i!==void 0&&clearTimeout(i)}catch{}}return i=setTimeout(()=>{t(),n()}),typeof requestAnimationFrame=="function"&&(e=requestAnimationFrame(()=>{t(),n()})),()=>n()}function oB(t){return queueMicrotask(()=>t()),()=>{t=$1}}var Fk="isAngularZone",q2=Fk+"_ID",Jte=0,Oi=class t{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new Mi(!1);onMicrotaskEmpty=new Mi(!1);onStable=new Mi(!1);onError=new Mi(!1);constructor(i){let{enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:o=!1,scheduleInRootZone:r=GV}=i;if(typeof Zone>"u")throw new si(908,!1);Zone.assertZonePatched();let g=this;g._nesting=0,g._outer=g._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(g._inner=g._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(g._inner=g._inner.fork(Zone.longStackTraceZoneSpec)),g.shouldCoalesceEventChangeDetection=!o&&n,g.shouldCoalesceRunChangeDetection=o,g.callbackScheduled=!1,g.scheduleInRootZone=r,iie(g)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Fk)===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new si(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new si(909,!1)}run(i,e,n){return this._inner.run(i,e,n)}runTask(i,e,n,o){let r=this._inner,g=r.scheduleEventTask("NgZoneEvent: "+o,i,eie,$1,$1);try{return r.runTask(g,e,n)}finally{r.cancelTask(g)}}runGuarded(i,e,n){return this._inner.runGuarded(i,e,n)}runOutsideAngular(i){return this._outer.run(i)}},eie={};function zk(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function tie(t){if(t.isCheckStableRunning||t.callbackScheduled)return;t.callbackScheduled=!0;function i(){YV(()=>{t.callbackScheduled=!1,f3(t),t.isCheckStableRunning=!0,zk(t),t.isCheckStableRunning=!1})}t.scheduleInRootZone?Zone.root.run(()=>{i()}):t._outer.run(()=>{i()}),f3(t)}function iie(t){let i=()=>{tie(t)},e=Jte++;t._inner=t._inner.fork({name:"angular",properties:{[Fk]:!0,[q2]:e,[q2+e]:!0},onInvokeTask:(n,o,r,g,w,T)=>{if(nie(T))return n.invokeTask(r,g,w,T);try{return aB(t),n.invokeTask(r,g,w,T)}finally{(t.shouldCoalesceEventChangeDetection&&g.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&i(),sB(t)}},onInvoke:(n,o,r,g,w,T,k)=>{try{return aB(t),n.invoke(r,g,w,T,k)}finally{t.shouldCoalesceRunChangeDetection&&!t.callbackScheduled&&!rie(T)&&i(),sB(t)}},onHasTask:(n,o,r,g)=>{n.hasTask(r,g),o===r&&(g.change=="microTask"?(t._hasPendingMicrotasks=g.microTask,f3(t),zk(t)):g.change=="macroTask"&&(t.hasPendingMacrotasks=g.macroTask))},onHandleError:(n,o,r,g)=>(n.handleError(r,g),t.runOutsideAngular(()=>t.onError.emit(g)),!1)})}function f3(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.callbackScheduled===!0?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function aB(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function sB(t){t._nesting--,zk(t)}var $2=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new Mi;onMicrotaskEmpty=new Mi;onStable=new Mi;onError=new Mi;run(i,e,n){return i.apply(e,n)}runGuarded(i,e,n){return i.apply(e,n)}runOutsideAngular(i){return i()}runTask(i,e,n,o){return i.apply(e,n)}};function nie(t){return KV(t,"__ignore_ng_zone__")}function rie(t){return KV(t,"__scheduler_tick__")}function KV(t,i){return!Array.isArray(t)||t.length!==1?!1:t[0]?.data?.[i]===!0}function oie(t="zone.js",i){return t==="noop"?new $2:t==="zone.js"?new Oi(i):t}var Hl=class{_console=console;handleError(i){this._console.error("ERROR",i)}},aie=new Ot("",{providedIn:"root",factory:()=>{let t=J(Oi),i=J(Hl);return e=>t.runOutsideAngular(()=>i.handleError(e))}});function lB(t,i){return WB(t,i)}function sie(t){return WB(GB,t)}var XV=(lB.required=sie,lB);function lie(){return Ty(_l(),qn())}function Ty(t,i){return new Qi(Rd(t,i))}var Qi=(()=>{class t{nativeElement;constructor(e){this.nativeElement=e}static __NG_ELEMENT_ID__=lie}return t})();function QV(t){return t instanceof Qi?t.nativeElement:t}function Jf(t){return typeof t=="function"&&t[pc]!==void 0}function ma(t,i){let e=gR(t,i?.equal),n=e[pc];return e.set=o=>C1(n,o),e.update=o=>_R(n,o),e.asReadonly=cie.bind(e),e}function cie(){let t=this[pc];if(t.readonlyFn===void 0){let i=()=>this();i[pc]=t,t.readonlyFn=i}return t.readonlyFn}function JV(t){return Jf(t)&&typeof t.set=="function"}function uie(){return this._results[Symbol.iterator]()}var Zf=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new gi}constructor(i=!1){this._emitDistinctChangesOnly=i}get(i){return this._results[i]}map(i){return this._results.map(i)}filter(i){return this._results.filter(i)}find(i){return this._results.find(i)}reduce(i,e){return this._results.reduce(i,e)}forEach(i){this._results.forEach(i)}some(i){return this._results.some(i)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(i,e){this.dirty=!1;let n=Gee(i);(this._changesDetected=!$ee(this._results,n,e))&&(this._results=n,this.length=n.length,this.last=n[this.length-1],this.first=n[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(i){this._onDirty=i}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=uie},G1="ngSkipHydration",die="ngskiphydration";function Bk(t){let i=t.mergedAttrs;if(i===null)return!1;for(let e=0;e<i.length;e+=2){let n=i[e];if(typeof n=="number")return!1;if(typeof n=="string"&&n.toLowerCase()===die)return!0}return!1}function e9(t){return t.hasAttribute(G1)}function W1(t){return(t.flags&128)===128}function Z1(t){if(W1(t))return!0;let i=t.parent;for(;i;){if(W1(t)||Bk(i))return!0;i=i.parent}return!1}function hie(t){return W1(t)||Bk(t)||Z1(t)}var t9=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(t9||{}),i9=new Map,pie=0;function fie(){return pie++}function mie(t){i9.set(t[yS],t)}function m3(t){i9.delete(t[yS])}var cB="__ngContext__";function Dy(t,i){qf(i)?(t[cB]=i[yS],mie(i)):t[cB]=i}function n9(t){return o9(t[U1])}function r9(t){return o9(t[Md])}function o9(t){for(;t!==null&&!ku(t);)t=t[Md];return t}var g3;function SS(t){g3=t}function Vk(){if(g3!==void 0)return g3;if(typeof document<"u")return document;throw new si(210,!1)}var Ou=new Ot("",{providedIn:"root",factory:()=>gie}),gie="ng",ox=new Ot(""),Ns=new Ot("",{providedIn:"platform",factory:()=>"unknown"});var oo=new Ot(""),e0=new Ot("",{providedIn:"root",factory:()=>Vk().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function _ie(){return new t0}var t0=(()=>{class t{static \u0275prov=Ft({token:t,providedIn:"root",factory:_ie});store={};onSerializeCallbacks={};get(e,n){return this.store[e]!==void 0?this.store[e]:n}set(e,n){this.store[e]=n}remove(e){delete this.store[e]}hasKey(e){return this.store.hasOwnProperty(e)}get isEmpty(){return Object.keys(this.store).length===0}onSerialize(e,n){this.onSerializeCallbacks[e]=n}toJson(){for(let e in this.onSerializeCallbacks)if(this.onSerializeCallbacks.hasOwnProperty(e))try{this.store[e]=this.onSerializeCallbacks[e]()}catch(n){console.warn("Exception in onSerialize callback: ",n)}return JSON.stringify(this.store).replace(/</g,"\\u003C")}}return t})();var jk="h",Uk="b",a9="f",s9="n",_3="e",y3="t",Y1="c",G2="x",jg="r",v3="i",b3="n",F1="d",uB="l",l9="di",dB="s",yie="p",vie="t",W2=new Ot(""),c9=!1,bie=new Ot("",{providedIn:"root",factory:()=>c9}),xie=new Ot(""),u9=new Ot(""),wie=!1,Eie=new Ot("");var Hk=function(t){return t[t.CHANGE_DETECTION=0]="CHANGE_DETECTION",t[t.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",t}(Hk||{}),My=new Ot(""),hB=new Set;function yc(t){hB.has(t)||(hB.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}var qk=(()=>{class t{view;node;constructor(e,n){this.view=e,this.node=n}static __NG_ELEMENT_ID__=Cie}return t})();function Cie(){return new qk(qn(),_l())}var ly=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(ly||{}),d9=(()=>{class t{impl=null;execute(){this.impl?.execute()}static \u0275prov=Ft({token:t,providedIn:"root",factory:()=>new t})}return t})(),Sie=[ly.EarlyRead,ly.Write,ly.MixedReadWrite,ly.Read],Tie=(()=>{class t{ngZone=J(Oi);scheduler=J(Wf);errorHandler=J(Hl,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){J(My,{optional:!0})}execute(){let e=this.sequences.size>0;e&&xo(16),this.executing=!0;for(let n of Sie)for(let o of this.sequences)if(!(o.erroredOrDestroyed||!o.hooks[n]))try{o.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let r=o.hooks[n];return r(o.pipelinedValue)},o.snapshot))}catch(r){o.erroredOrDestroyed=!0,this.errorHandler?.handleError(r)}this.executing=!1;for(let n of this.sequences)n.afterRun(),n.once&&(this.sequences.delete(n),n.destroy());for(let n of this.deferredRegistrations)this.sequences.add(n);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),e&&xo(17)}register(e){let{view:n}=e;n!==void 0?((n[uy]??=[]).push(e),wy(n),n[sr]|=8192):this.executing?this.deferredRegistrations.add(e):this.addSequence(e)}addSequence(e){this.sequences.add(e),this.scheduler.notify(7)}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}maybeTrace(e,n){return n?n.run(Hk.AFTER_NEXT_RENDER,e):e()}static \u0275prov=Ft({token:t,providedIn:"root",factory:()=>new t})}return t})(),x3=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(i,e,n,o,r,g=null){this.impl=i,this.hooks=e,this.view=n,this.once=o,this.snapshot=g,this.unregisterOnDestroy=r?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let i=this.view?.[uy];i&&(this.view[uy]=i.filter(e=>e!==this))}};function i0(t,i){!i?.injector&&_S(i0);let e=i?.injector??J(wn);return p9}function _s(t,i){!i?.injector&&_S(_s);let e=i?.injector??J(wn);return p9}function Die(t,i){if(t instanceof Function){let e=[void 0,void 0,void 0,void 0];return e[i]=t,e}else return[t.earlyRead,t.write,t.mixedReadWrite,t.read]}function h9(t,i,e,n){let o=i.get(d9);o.impl??=i.get(Tie);let r=i.get(My,null,{optional:!0}),g=e?.phase??ly.MixedReadWrite,w=e?.manualCleanup!==!0?i.get(Sy):null,T=i.get(qk,null,{optional:!0}),k=new x3(o.impl,Die(t,g),T?.view,n,w,r?.snapshot(null));return o.impl.register(k),k}var p9={destroy(){}};var pB=1;function $k(t){return t+1}function Mie(t,i){let e=t[Ln],n=$k(i.index);return t[n]}function f9(t,i){let e=$k(i.index);return t.data[e]}function Iie(t){return t!==null&&typeof t=="object"&&typeof t.primaryTmplIndex=="number"}function Aie(t,i){let e=null,n=$k(i.index);return qr<n&&n<t.bindingStartIndex&&(e=f9(t,i)),!!e&&Iie(e)}var Rie=["click","keydown"],kie=["mouseenter","mouseover","focusin"];var Oie="ngb";function m9(t,i,e=null){if(i.length===0||t.nodeType!==Node.ELEMENT_NODE)return;let n=t.getAttribute(OR.JSACTION),o=i.reduce((g,w)=>(n?.indexOf(w)??-1)===-1?g+w+":;":g,"");t.setAttribute(OR.JSACTION,`${n??""}${o}`);let r=e??"";r!==""&&o.length>0&&t.setAttribute(Oie,r)}var Pie="__nghData__",g9=Pie,Nie="__nghDeferData__",Lie=Nie,z1="ngh",Gk="nghm",_9=()=>null;function Fie(t,i,e=!1){let n=t.getAttribute(z1);if(n==null)return null;let[o,r]=n.split("|");if(n=e?r:o,!n)return null;let g=r?`|${r}`:"",w=e?o:g,T={};if(n!==""){let N=i.get(t0,null,{optional:!0});N!==null&&(T=N.get(g9,[])[Number(n)])}let k={data:T,firstChild:t.firstChild??null};return e&&(k.firstChild=t,TS(k,0,t.nextSibling)),w?t.setAttribute(z1,w):t.removeAttribute(z1),k}function zie(){_9=Fie}function y9(t,i,e=!1){return _9(t,i,e)}function Bie(t){let i=t._lView;return i[Ln].type===2?null:(my(i)&&(i=i[qr]),i)}function Vie(t){return t.textContent?.replace(/\s/gm,"")}function jie(t){let i=Vk(),e=i.createNodeIterator(t,NodeFilter.SHOW_COMMENT,{acceptNode(r){let g=Vie(r);return g==="ngetn"||g==="ngtns"?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),n,o=[];for(;n=e.nextNode();)o.push(n);for(let r of o)r.textContent==="ngetn"?r.replaceWith(i.createTextNode("")):r.remove()}function TS(t,i,e){t.segmentHeads??={},t.segmentHeads[i]=e}function w3(t,i){return t.segmentHeads?.[i]??null}function Uie(t){return t.get(Eie,!1,{optional:!0})}function Hie(t,i){let e=t.data,n=e[_3]?.[i]??null;return n===null&&e[Y1]?.[i]&&(n=Wk(t,i)),n}function v9(t,i){return t.data[Y1]?.[i]??null}function Wk(t,i){let e=v9(t,i)??[],n=0;for(let o of e)n+=o[jg]*(o[G2]??1);return n}function qie(t){if(typeof t.disconnectedNodes>"u"){let i=t.data[F1];t.disconnectedNodes=i?new Set(i):null}return t.disconnectedNodes}function ax(t,i){if(typeof t.disconnectedNodes>"u"){let e=t.data[F1];t.disconnectedNodes=e?new Set(e):null}return!!qie(t)?.has(i)}function b9(t,i){let e=i,n=t.corruptedTextNodes;e.textContent===""?n.set(e,"ngetn"):e.nextSibling?.nodeType===Node.TEXT_NODE&&n.set(e,"ngtns")}function $ie(t){let i=[];return t!==null&&(t.has(4)&&i.push(...kie),t.has(3)&&i.push(...Rie)),i}function BR(t){return!!t&&t.nodeType===Node.COMMENT_NODE&&t.textContent?.trim()===Gk}function fB(t){for(;t&&t.nodeType===Node.TEXT_NODE;)t=t.previousSibling;return t}function Gie(t){for(let n of t.body.childNodes)if(BR(n))return;let i=fB(t.body.previousSibling);if(BR(i))return;let e=fB(t.head.lastChild);if(!BR(e))throw new si(-507,!1)}function x9(t,i){let e=t.contentQueries;if(e!==null){let n=Mr(null);try{for(let o=0;o<e.length;o+=2){let r=e[o],g=e[o+1];if(g!==-1){let w=t.data[g];xS(r),w.contentQueries(2,i[g],g)}}}finally{Mr(n)}}}function E3(t,i,e){xS(0);let n=Mr(null);try{i(t,e)}finally{Mr(n)}}function Zk(t,i,e){if(wk(i)){let n=Mr(null);try{let o=i.directiveStart,r=i.directiveEnd;for(let g=o;g<r;g++){let w=t.data[g];if(w.contentQueries){let T=e[g];w.contentQueries(1,T,g)}}}finally{Mr(n)}}}var Ad=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(Ad||{}),x2;function Wie(){if(x2===void 0&&(x2=null,Os.trustedTypes))try{x2=Os.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return x2}function DS(t){return Wie()?.createHTML(t)||t}var w2;function Zie(){if(w2===void 0&&(w2=null,Os.trustedTypes))try{w2=Os.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return w2}function mB(t){return Zie()?.createScriptURL(t)||t}var Sp=class{changingThisBreaksApplicationSecurity;constructor(i){this.changingThisBreaksApplicationSecurity=i}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${$B})`}},C3=class extends Sp{getTypeName(){return"HTML"}},S3=class extends Sp{getTypeName(){return"Style"}},T3=class extends Sp{getTypeName(){return"Script"}},D3=class extends Sp{getTypeName(){return"URL"}},M3=class extends Sp{getTypeName(){return"ResourceURL"}};function kd(t){return t instanceof Sp?t.changingThisBreaksApplicationSecurity:t}function em(t,i){let e=Yie(t);if(e!=null&&e!==i){if(e==="ResourceURL"&&i==="URL")return!0;throw new Error(`Required a safe ${i}, got a ${e} (see ${$B})`)}return e===i}function Yie(t){return t instanceof Sp&&t.getTypeName()||null}function w9(t){return new C3(t)}function E9(t){return new S3(t)}function C9(t){return new T3(t)}function S9(t){return new D3(t)}function T9(t){return new M3(t)}function Kie(t){let i=new A3(t);return Xie()?new I3(i):i}var I3=class{inertDocumentHelper;constructor(i){this.inertDocumentHelper=i}getInertBodyElement(i){i="<body><remove></remove>"+i;try{let e=new window.DOMParser().parseFromString(DS(i),"text/html").body;return e===null?this.inertDocumentHelper.getInertBodyElement(i):(e.firstChild?.remove(),e)}catch{return null}}},A3=class{defaultDoc;inertDocument;constructor(i){this.defaultDoc=i,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(i){let e=this.inertDocument.createElement("template");return e.innerHTML=DS(i),e}};function Xie(){try{return!!new window.DOMParser().parseFromString(DS(""),"text/html")}catch{return!1}}var Qie=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function MS(t){return t=String(t),t.match(Qie)?t:"unsafe:"+t}function Ap(t){let i={};for(let e of t.split(","))i[e]=!0;return i}function sx(...t){let i={};for(let e of t)for(let n in e)e.hasOwnProperty(n)&&(i[n]=!0);return i}var D9=Ap("area,br,col,hr,img,wbr"),M9=Ap("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),I9=Ap("rp,rt"),Jie=sx(I9,M9),ene=sx(M9,Ap("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),tne=sx(I9,Ap("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),gB=sx(D9,ene,tne,Jie),A9=Ap("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),ine=Ap("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),nne=Ap("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext"),rne=sx(A9,ine,nne),one=Ap("script,style,template"),R3=class{sanitizedSomething=!1;buf=[];sanitizeChildren(i){let e=i.firstChild,n=!0,o=[];for(;e;){if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild){o.push(e),e=lne(e);continue}for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let r=sne(e);if(r){e=r;break}e=o.pop()}}return this.buf.join("")}startElement(i){let e=_B(i).toLowerCase();if(!gB.hasOwnProperty(e))return this.sanitizedSomething=!0,!one.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);let n=i.attributes;for(let o=0;o<n.length;o++){let r=n.item(o),g=r.name,w=g.toLowerCase();if(!rne.hasOwnProperty(w)){this.sanitizedSomething=!0;continue}let T=r.value;A9[w]&&(T=MS(T)),this.buf.push(" ",g,'="',yB(T),'"')}return this.buf.push(">"),!0}endElement(i){let e=_B(i).toLowerCase();gB.hasOwnProperty(e)&&!D9.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(i){this.buf.push(yB(i))}};function ane(t,i){return(t.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}function sne(t){let i=t.nextSibling;if(i&&t!==i.previousSibling)throw R9(i);return i}function lne(t){let i=t.firstChild;if(i&&ane(t,i))throw R9(i);return i}function _B(t){let i=t.nodeName;return typeof i=="string"?i:"FORM"}function R9(t){return new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`)}var cne=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,une=/([^\#-~ |!])/g;function yB(t){return t.replace(/&/g,"&amp;").replace(cne,function(i){let e=i.charCodeAt(0),n=i.charCodeAt(1);return"&#"+((e-55296)*1024+(n-56320)+65536)+";"}).replace(une,function(i){return"&#"+i.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var E2;function k9(t,i){let e=null;try{E2=E2||Kie(t);let n=i?String(i):"";e=E2.getInertBodyElement(n);let o=5,r=n;do{if(o===0)throw new Error("Failed to sanitize html because the input is unstable");o--,n=r,r=e.innerHTML,e=E2.getInertBodyElement(n)}while(n!==r);let w=new R3().sanitizeChildren(vB(e)||e);return DS(w)}finally{if(e){let n=vB(e)||e;for(;n.firstChild;)n.firstChild.remove()}}}function vB(t){return"content"in t&&dne(t)?t.content:null}function dne(t){return t.nodeType===Node.ELEMENT_NODE&&t.nodeName==="TEMPLATE"}var yl=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(yl||{});function n0(t){let i=P9();return i?i.sanitize(yl.URL,t)||"":em(t,"URL")?kd(t):MS(Ug(t))}function hne(t){let i=P9();if(i)return mB(i.sanitize(yl.RESOURCE_URL,t)||"");if(em(t,"ResourceURL"))return mB(kd(t));throw new si(904,!1)}function pne(t,i){return i==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||i==="href"&&(t==="base"||t==="link")?hne:n0}function O9(t,i,e){return pne(i,e)(t)}function P9(){let t=qn();return t&&t[wp].sanitizer}var fne=/^>|^->|<!--|-->|--!>|<!-$/g,mne=/(<|>)/g,gne="\u200B$1\u200B";function _ne(t){return t.replace(fne,i=>i.replace(mne,gne))}function yne(t){return t.ownerDocument.body}function N9(t){return t instanceof Function?t():t}function vne(t,i,e){let n=t.length;for(;;){let o=t.indexOf(i,e);if(o===-1)return o;if(o===0||t.charCodeAt(o-1)<=32){let r=i.length;if(o+r===n||t.charCodeAt(o+r)<=32)return o}e=o+1}}var L9="ng-template";function bne(t,i,e,n){let o=0;if(n){for(;o<i.length&&typeof i[o]=="string";o+=2)if(i[o]==="class"&&vne(i[o+1].toLowerCase(),e,0)!==-1)return!0}else if(Yk(t))return!1;if(o=i.indexOf(1,o),o>-1){let r;for(;++o<i.length&&typeof(r=i[o])=="string";)if(r.toLowerCase()===e)return!0}return!1}function Yk(t){return t.type===4&&t.value!==L9}function xne(t,i,e){let n=t.type===4&&!e?L9:t.value;return i===n}function wne(t,i,e){let n=4,o=t.attrs,r=o!==null?Sne(o):0,g=!1;for(let w=0;w<i.length;w++){let T=i[w];if(typeof T=="number"){if(!g&&!Td(n)&&!Td(T))return!1;if(g&&Td(T))continue;g=!1,n=T|n&1;continue}if(!g)if(n&4){if(n=2|n&1,T!==""&&!xne(t,T,e)||T===""&&i.length===1){if(Td(n))return!1;g=!0}}else if(n&8){if(o===null||!bne(t,o,T,e)){if(Td(n))return!1;g=!0}}else{let k=i[++w],N=Ene(T,o,Yk(t),e);if(N===-1){if(Td(n))return!1;g=!0;continue}if(k!==""){let V;if(N>r?V="":V=o[N+1].toLowerCase(),n&2&&k!==V){if(Td(n))return!1;g=!0}}}}return Td(n)||g}function Td(t){return(t&1)===0}function Ene(t,i,e,n){if(i===null)return-1;let o=0;if(n||!e){let r=!1;for(;o<i.length;){let g=i[o];if(g===t)return o;if(g===3||g===6)r=!0;else if(g===1||g===2){let w=i[++o];for(;typeof w=="string";)w=i[++o];continue}else{if(g===4)break;if(g===0){o+=4;continue}}o+=r?1:2}return-1}else return Tne(i,t)}function F9(t,i,e=!1){for(let n=0;n<i.length;n++)if(wne(t,i[n],e))return!0;return!1}function Cne(t){let i=t.attrs;if(i!=null){let e=i.indexOf(5);if((e&1)===0)return i[e+1]}return null}function Sne(t){for(let i=0;i<t.length;i++){let e=t[i];if(NV(e))return i}return t.length}function Tne(t,i){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){let n=t[e];if(typeof n=="number")return-1;if(n===i)return e;e++}return-1}function Dne(t,i){e:for(let e=0;e<i.length;e++){let n=i[e];if(t.length===n.length){for(let o=0;o<t.length;o++)if(t[o]!==n[o])continue e;return!0}}return!1}function bB(t,i){return t?":not("+i.trim()+")":i}function Mne(t){let i=t[0],e=1,n=2,o="",r=!1;for(;e<t.length;){let g=t[e];if(typeof g=="string")if(n&2){let w=t[++e];o+="["+g+(w.length>0?'="'+w+'"':"")+"]"}else n&8?o+="."+g:n&4&&(o+=" "+g);else o!==""&&!Td(g)&&(i+=bB(r,o),o=""),n=g,r=r||!Td(n);e++}return o!==""&&(i+=bB(r,o)),i}function Ine(t){return t.map(Mne).join(",")}function Ane(t){let i=[],e=[],n=1,o=2;for(;n<t.length;){let r=t[n];if(typeof r=="string")o===2?r!==""&&i.push(r,t[++n]):o===8&&e.push(r);else{if(!Td(o))break;o=r}n++}return e.length&&i.push(1,...e),i}var vc={};function z9(t,i){return t.createText(i)}function Rne(t,i,e){t.setValue(i,e)}function B9(t,i){return t.createComment(_ne(i))}function Kk(t,i,e){return t.createElement(i,e)}function Z2(t,i,e,n,o){t.insertBefore(i,e,n,o)}function V9(t,i,e){t.appendChild(i,e)}function xB(t,i,e,n,o){n!==null?Z2(t,i,e,n,o):V9(t,i,e)}function j9(t,i,e){t.removeChild(null,i,e)}function U9(t){t.textContent=""}function kne(t,i,e){t.setAttribute(i,"style",e)}function One(t,i,e){e===""?t.removeAttribute(i,"class"):t.setAttribute(i,"class",e)}function H9(t,i,e){let{mergedAttrs:n,classes:o,styles:r}=e;n!==null&&Vte(t,i,n),o!==null&&One(t,i,o),r!==null&&kne(t,i,r)}function Xk(t,i,e,n,o,r,g,w,T,k,N){let V=qr+n,q=V+o,Z=Pne(V,q),X=typeof k=="function"?k():k;return Z[Ln]={type:t,blueprint:Z,template:e,queries:null,viewQuery:w,declTNode:i,data:Z.slice().fill(null,V),bindingStartIndex:V,expandoStartIndex:q,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof r=="function"?r():r,pipeRegistry:typeof g=="function"?g():g,firstChild:null,schemas:T,consts:X,incompleteFirstPass:!1,ssrId:N}}function Pne(t,i){let e=[];for(let n=0;n<i;n++)e.push(n<t?null:vc);return e}function Nne(t){let i=t.tView;return i===null||i.incompleteFirstPass?t.tView=Xk(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):i}function Qk(t,i,e,n,o,r,g,w,T,k,N){let V=i.blueprint.slice();return V[fs]=o,V[sr]=n|4|128|8|64|1024,(k!==null||t&&t[sr]&2048)&&(V[sr]|=2048),xV(V),V[Ps]=V[xy]=t,V[Ya]=e,V[wp]=g||t&&t[wp],V[_o]=w||t&&t[_o],V[py]=T||t&&t[py]||null,V[_c]=r,V[yS]=fie(),V[Id]=N,V[hV]=k,V[ml]=i.type==2?t[ml]:V,V}function Lne(t,i,e){let n=Rd(i,t),o=Nne(e),r=t[wp].rendererFactory,g=Jk(t,Qk(t,o,null,q9(e),n,i,null,r.createRenderer(n,e),null,null,null));return t[i.index]=g}function q9(t){let i=16;return t.signals?i=4096:t.onPush&&(i=64),i}function $9(t,i,e,n){if(e===0)return-1;let o=i.length;for(let r=0;r<e;r++)i.push(n),t.blueprint.push(n),t.data.push(null);return o}function Jk(t,i){return t[U1]?t[Qz][Md]=i:t[U1]=i,t[Qz]=i,i}function Se(t=1){G9(Yo(),qn(),Mp()+t,!1)}function G9(t,i,e,n){if(!n)if((i[sr]&3)===3){let r=t.preOrderCheckHooks;r!==null&&D2(i,r,e)}else{let r=t.preOrderHooks;r!==null&&M2(i,r,0,e)}Zg(e)}var IS=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(IS||{});function k3(t,i,e,n){let o=Mr(null);try{let[r,g,w]=t.inputs[e],T=null;(g&IS.SignalBased)!==0&&(T=i[r][pc]),T!==null&&T.transformFn!==void 0?n=T.transformFn(n):w!==null&&(n=w.call(i,n)),t.setInput!==null?t.setInput(i,T,n,e,r):fV(i,T,r,n)}finally{Mr(o)}}function W9(t,i,e,n,o){let r=Mp(),g=n&2;try{Zg(-1),g&&i.length>qr&&G9(t,i,qr,!1),xo(g?2:0,o),e(n,o)}finally{Zg(r),xo(g?3:1,o)}}function AS(t,i,e){Hne(t,i,e),(e.flags&64)===64&&qne(t,i,e)}function eO(t,i,e=Rd){let n=i.localNames;if(n!==null){let o=i.index+1;for(let r=0;r<n.length;r+=2){let g=n[r+1],w=g===-1?e(i,t):t[g];t[o++]=w}}}function Fne(t,i,e,n){let r=n.get(bie,c9)||e===Ad.ShadowDom,g=t.selectRootElement(i,r);return zne(g),g}function zne(t){Z9(t)}var Z9=()=>null;function Bne(t){e9(t)?U9(t):jie(t)}function Vne(){Z9=Bne}function jne(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function RS(t,i,e,n,o,r,g,w){if(!w&&iO(i,t,e,n,o)){Kf(i)&&Une(e,i.index);return}if(i.type&3){let T=Rd(i,e);n=jne(n),o=g!=null?g(o,i.value||"",n):o,r.setProperty(T,n,o)}else i.type&12}function Une(t,i){let e=Ah(i,t);e[sr]&16||(e[sr]|=64)}function Hne(t,i,e){let n=e.directiveStart,o=e.directiveEnd;Kf(e)&&Lne(i,e,t.data[n+e.componentOffset]),t.firstCreatePass||U2(e,i);let r=e.initialInputs;for(let g=n;g<o;g++){let w=t.data[g],T=q1(i,t,g,e);if(Dy(T,i),r!==null&&Zne(i,g-n,T,w,e,r),Ih(w)){let k=Ah(e.index,i);k[Ya]=q1(i,t,g,e)}}}function qne(t,i,e){let n=e.directiveStart,o=e.directiveEnd,r=e.index,g=Ate();try{Zg(r);for(let w=n;w<o;w++){let T=t.data[w],k=i[w];c3(w),(T.hostBindings!==null||T.hostVars!==0||T.hostAttrs!==null)&&$ne(T,k)}}finally{Zg(-1),c3(g)}}function $ne(t,i){t.hostBindings!==null&&t.hostBindings(1,i)}function tO(t,i){let e=t.directiveRegistry,n=null;if(e)for(let o=0;o<e.length;o++){let r=e[o];F9(i,r.selectors,!1)&&(n??=[],Ih(r)?n.unshift(r):n.push(r))}return n}function Gne(t,i,e,n,o,r){let g=Rd(t,i);Wne(i[_o],g,r,t.value,e,n,o)}function Wne(t,i,e,n,o,r,g){if(r==null)t.removeAttribute(i,o,e);else{let w=g==null?Ug(r):g(r,n||"",o);t.setAttribute(i,o,w,e)}}function Zne(t,i,e,n,o,r){let g=r[i];if(g!==null)for(let w=0;w<g.length;w+=2){let T=g[w],k=g[w+1];k3(n,e,T,k)}}function Yne(t,i){let e=t[py],n=e?e.get(Hl,null):null;n&&n.handleError(i)}function iO(t,i,e,n,o){let r=t.inputs?.[n],g=t.hostDirectiveInputs?.[n],w=!1;if(g)for(let T=0;T<g.length;T+=2){let k=g[T],N=g[T+1],V=i.data[k];k3(V,e[k],N,o),w=!0}if(r)for(let T of r){let k=e[T],N=i.data[T];k3(N,k,n,o),w=!0}return w}function Kne(t,i){let e=Ah(i,t),n=e[Ln];Xne(n,e);let o=e[fs];o!==null&&e[Id]===null&&(e[Id]=y9(o,e[py])),xo(18),nO(n,e,e[Ya]),xo(19,e[Ya])}function Xne(t,i){for(let e=i.length;e<t.blueprint.length;e++)i.push(t.blueprint[e])}function nO(t,i,e){Ok(i);try{let n=t.viewQuery;n!==null&&E3(1,n,e);let o=t.template;o!==null&&W9(t,i,o,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),i[Ep]?.finishViewCreation(t),t.staticContentQueries&&x9(t,i),t.staticViewQueries&&E3(2,t.viewQuery,e);let r=t.components;r!==null&&Qne(i,r)}catch(n){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),n}finally{i[sr]&=-5,Pk()}}function Qne(t,i){for(let e=0;e<i.length;e++)Kne(t,i[e])}function lx(t,i,e,n){let o=Mr(null);try{let r=i.tView,w=t[sr]&4096?4096:16,T=Qk(t,r,e,w,null,i,null,null,n?.injector??null,n?.embeddedViewInjector??null,n?.dehydratedView??null),k=t[i.index];T[$g]=k;let N=t[Ep];return N!==null&&(T[Ep]=N.createEmbeddedView(r)),nO(r,T,e),T}finally{Mr(o)}}function _y(t,i){return!i||i.firstChild===null||W1(t)}var Jne;function rO(t,i){return Jne(t,i)}var Tp=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Tp||{});function tm(t){return(t.flags&32)===32}function cy(t,i,e,n,o){if(n!=null){let r,g=!1;ku(n)?r=n:qf(n)&&(g=!0,n=n[fs]);let w=Wo(n);t===0&&e!==null?o==null?V9(i,e,w):Z2(i,e,w,o||null,!0):t===1&&e!==null?Z2(i,e,w,o||null,!0):t===2?j9(i,w,g):t===3&&i.destroyNode(w),r!=null&&cre(i,t,r,e,o)}}function ere(t,i){Y9(t,i),i[fs]=null,i[_c]=null}function tre(t,i,e,n,o,r){n[fs]=o,n[_c]=i,PS(t,n,e,1,o,r)}function Y9(t,i){i[wp].changeDetectionScheduler?.notify(9),PS(t,i,i[_o],2,null,null)}function ire(t){let i=t[U1];if(!i)return VR(t[Ln],t);for(;i;){let e=null;if(qf(i))e=i[U1];else{let n=i[Xs];n&&(e=n)}if(!e){for(;i&&!i[Md]&&i!==t;)qf(i)&&VR(i[Ln],i),i=i[Ps];i===null&&(i=t),qf(i)&&VR(i[Ln],i),e=i&&i[Md]}i=e}}function oO(t,i){let e=t[fy],n=e.indexOf(i);e.splice(n,1)}function kS(t,i){if(nx(i))return;let e=i[_o];e.destroyNode&&PS(t,i,e,3,null,null),ire(i)}function VR(t,i){if(nx(i))return;let e=Mr(null);try{i[sr]&=-129,i[sr]|=256,i[Au]&&E1(i[Au]),rre(t,i),nre(t,i),i[Ln].type===1&&i[_o].destroy();let n=i[$g];if(n!==null&&ku(i[Ps])){n!==i[Ps]&&oO(n,i);let o=i[Ep];o!==null&&o.detachView(t)}m3(i)}finally{Mr(e)}}function nre(t,i){let e=t.cleanup,n=i[j1];if(e!==null)for(let g=0;g<e.length-1;g+=2)if(typeof e[g]=="string"){let w=e[g+3];w>=0?n[w]():n[-w].unsubscribe(),g+=2}else{let w=n[e[g+1]];e[g].call(w)}n!==null&&(i[j1]=null);let o=i[Hf];if(o!==null){i[Hf]=null;for(let g=0;g<o.length;g++){let w=o[g];w()}}let r=i[Gg];if(r!==null){i[Gg]=null;for(let g of r)g.destroy()}}function rre(t,i){let e;if(t!=null&&(e=t.destroyHooks)!=null)for(let n=0;n<e.length;n+=2){let o=i[e[n]];if(!(o instanceof Yg)){let r=e[n+1];if(Array.isArray(r))for(let g=0;g<r.length;g+=2){let w=o[r[g]],T=r[g+1];xo(4,w,T);try{T.call(w)}finally{xo(5,w,T)}}else{xo(4,o,r);try{r.call(o)}finally{xo(5,o,r)}}}}}function aO(t,i,e){return ore(t,i.parent,e)}function ore(t,i,e){let n=i;for(;n!==null&&n.type&168;)i=n,n=i.parent;if(n===null)return e[fs];if(Kf(n)){let{encapsulation:o}=t.data[n.directiveStart+n.componentOffset];if(o===Ad.None||o===Ad.Emulated)return null}return Rd(n,e)}function K9(t,i,e){return sre(t,i,e)}function are(t,i,e){return t.type&40?Rd(t,e):null}var sre=are,wB;function OS(t,i,e,n){let o=aO(t,n,i),r=i[_o],g=n.parent||i[_c],w=K9(g,n,i);if(o!=null)if(Array.isArray(e))for(let T=0;T<e.length;T++)xB(r,o,e[T],w,!1);else xB(r,o,e,w,!1);wB!==void 0&&wB(r,n,i,e,o)}function zg(t,i){if(i!==null){let e=i.type;if(e&3)return Rd(i,t);if(e&4)return O3(-1,t[i.index]);if(e&8){let n=i.child;if(n!==null)return zg(t,n);{let o=t[i.index];return ku(o)?O3(-1,o):Wo(o)}}else{if(e&128)return zg(t,i.next);if(e&32)return rO(i,t)()||Wo(t[i.index]);{let n=X9(t,i);if(n!==null){if(Array.isArray(n))return n[0];let o=Wg(t[ml]);return zg(o,n)}else return zg(t,i.next)}}}return null}function X9(t,i){if(i!==null){let n=t[ml][_c],o=i.projection;return n.projection[o]}return null}function O3(t,i){let e=Xs+t+1;if(e<i.length){let n=i[e],o=n[Ln].firstChild;if(o!==null)return zg(n,o)}return i[Cp]}function sO(t,i,e,n,o,r,g){for(;e!=null;){if(e.type===128){e=e.next;continue}let w=n[e.index],T=e.type;if(g&&i===0&&(w&&Dy(Wo(w),n),e.flags|=2),!tm(e))if(T&8)sO(t,i,e.child,n,o,r,!1),cy(i,t,o,w,r);else if(T&32){let k=rO(e,n),N;for(;N=k();)cy(i,t,o,N,r);cy(i,t,o,w,r)}else T&16?Q9(t,i,n,e,o,r):cy(i,t,o,w,r);e=g?e.projectionNext:e.next}}function PS(t,i,e,n,o,r){sO(e,n,t.firstChild,i,o,r,!1)}function lre(t,i,e){let n=i[_o],o=aO(t,e,i),r=e.parent||i[_c],g=K9(r,e,i);Q9(n,0,i,e,o,g)}function Q9(t,i,e,n,o,r){let g=e[ml],T=g[_c].projection[n.projection];if(Array.isArray(T))for(let k=0;k<T.length;k++){let N=T[k];cy(i,t,o,N,r)}else{let k=T,N=g[Ps];W1(n)&&(k.flags|=128),sO(t,i,k,N,o,r,!0)}}function cre(t,i,e,n,o){let r=e[Cp],g=Wo(e);r!==g&&cy(i,t,n,r,o);for(let w=Xs;w<e.length;w++){let T=e[w];PS(T[Ln],T,t,i,n,r)}}function ure(t,i,e,n,o){if(i)o?t.addClass(e,n):t.removeClass(e,n);else{let r=n.indexOf("-")===-1?void 0:Tp.DashCase;o==null?t.removeStyle(e,n,r):(typeof o=="string"&&o.endsWith("!important")&&(o=o.slice(0,-10),r|=Tp.Important),t.setStyle(e,n,o,r))}}function K1(t,i,e,n,o=!1){for(;e!==null;){if(e.type===128){e=o?e.projectionNext:e.next;continue}let r=i[e.index];r!==null&&n.push(Wo(r)),ku(r)&&lO(r,n);let g=e.type;if(g&8)K1(t,i,e.child,n);else if(g&32){let w=rO(e,i),T;for(;T=w();)n.push(T)}else if(g&16){let w=X9(i,e);if(Array.isArray(w))n.push(...w);else{let T=Wg(i[ml]);K1(T[Ln],T,w,n,!0)}}e=o?e.projectionNext:e.next}return n}function lO(t,i){for(let e=Xs;e<t.length;e++){let n=t[e],o=n[Ln].firstChild;o!==null&&K1(n[Ln],n,o,i)}t[Cp]!==t[fs]&&i.push(t[Cp])}function J9(t){if(t[uy]!==null){for(let i of t[uy])i.impl.addSequence(i);t[uy].length=0}}var e7=[];function dre(t){return t[Au]??hre(t)}function hre(t){let i=e7.pop()??Object.create(fre);return i.lView=t,i}function pre(t){t.lView[Au]!==t&&(t.lView=null,e7.push(t))}var fre=ji(It({},X_),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:t=>{wy(t.lView)},consumerOnSignalRead(){this.lView[Au]=this}});function mre(t){let i=t[Au]??Object.create(gre);return i.lView=t,i}var gre=ji(It({},X_),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:t=>{let i=Wg(t.lView);for(;i&&!t7(i[Ln]);)i=Wg(i);i&&wV(i)},consumerOnSignalRead(){this.lView[Au]=this}});function t7(t){return t.type!==2}function i7(t){if(t[Gg]===null)return;let i=!0;for(;i;){let e=!1;for(let n of t[Gg])n.dirty&&(e=!0,n.zone===null||Zone.current===n.zone?n.run():n.zone.run(()=>n.run()));i=e&&!!(t[sr]&8192)}}var _re=100;function n7(t,i=!0,e=0){let o=t[wp].rendererFactory,r=!1;r||o.begin?.();try{yre(t,e)}catch(g){throw i&&Yne(t,g),g}finally{r||o.end?.()}}function yre(t,i){let e=SV();try{z2(!0),P3(t,i);let n=0;for(;bS(t);){if(n===_re)throw new si(103,!1);n++,P3(t,1)}}finally{z2(e)}}function vre(t,i,e,n){if(nx(i))return;let o=i[sr],r=!1,g=!1;Ok(i);let w=!0,T=null,k=null;r||(t7(t)?(k=dre(i),T=w1(k)):dR()===null?(w=!1,k=mre(i),T=w1(k)):i[Au]&&(E1(i[Au]),i[Au]=null));try{xV(i),Dte(t.bindingStartIndex),e!==null&&W9(t,i,e,2,n);let N=(o&3)===3;if(!r)if(N){let Z=t.preOrderCheckHooks;Z!==null&&D2(i,Z,null)}else{let Z=t.preOrderHooks;Z!==null&&M2(i,Z,0,null),FR(i,0)}if(g||bre(i),i7(i),r7(i,0),t.contentQueries!==null&&x9(t,i),!r)if(N){let Z=t.contentCheckHooks;Z!==null&&D2(i,Z)}else{let Z=t.contentHooks;Z!==null&&M2(i,Z,1),FR(i,1)}wre(t,i);let V=t.components;V!==null&&a7(i,V,0);let q=t.viewQuery;if(q!==null&&E3(2,q,n),!r)if(N){let Z=t.viewCheckHooks;Z!==null&&D2(i,Z)}else{let Z=t.viewHooks;Z!==null&&M2(i,Z,2),FR(i,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),i[LR]){for(let Z of i[LR])Z();i[LR]=null}r||(J9(i),i[sr]&=-73)}catch(N){throw r||wy(i),N}finally{k!==null&&(LC(k,T),w&&pre(k)),Pk()}}function r7(t,i){for(let e=n9(t);e!==null;e=r9(e))for(let n=Xs;n<e.length;n++){let o=e[n];o7(o,i)}}function bre(t){for(let i=n9(t);i!==null;i=r9(i)){if(!(i[sr]&2))continue;let e=i[fy];for(let n=0;n<e.length;n++){let o=e[n];wV(o)}}}function xre(t,i,e){xo(18);let n=Ah(i,t);o7(n,e),xo(19,n[Ya])}function o7(t,i){Sk(t)&&P3(t,i)}function P3(t,i){let n=t[Ln],o=t[sr],r=t[Au],g=!!(i===0&&o&16);if(g||=!!(o&64&&i===0),g||=!!(o&1024),g||=!!(r?.dirty&&FC(r)),g||=!1,r&&(r.dirty=!1),t[sr]&=-9217,g)vre(n,t,n.template,t[Ya]);else if(o&8192){i7(t),r7(t,1);let w=n.components;w!==null&&a7(t,w,1),J9(t)}}function a7(t,i,e){for(let n=0;n<i.length;n++)xre(t,i[n],e)}function wre(t,i){let e=t.hostBindingOpCodes;if(e!==null)try{for(let n=0;n<e.length;n++){let o=e[n];if(o<0)Zg(~o);else{let r=o,g=e[++n],w=e[++n];Ite(g,r);let T=i[r];xo(24,T),w(2,T),xo(25,T)}}}finally{Zg(-1)}}function cO(t,i){let e=SV()?64:1088;for(t[wp].changeDetectionScheduler?.notify(i);t;){t[sr]|=e;let n=Wg(t);if(my(t)&&!n)return t;t=n}return null}function s7(t,i,e,n){return[t,!0,0,i,null,n,null,e,null,null]}function l7(t,i){let e=Xs+i;if(e<t.length)return t[e]}function cx(t,i,e,n=!0){let o=i[Ln];if(Ere(o,i,t,e),n){let g=O3(e,t),w=i[_o],T=w.parentNode(t[Cp]);T!==null&&tre(o,t[_c],w,i,T,g)}let r=i[Id];r!==null&&r.firstChild!==null&&(r.firstChild=null)}function c7(t,i){let e=X1(t,i);return e!==void 0&&kS(e[Ln],e),e}function X1(t,i){if(t.length<=Xs)return;let e=Xs+i,n=t[e];if(n){let o=n[$g];o!==null&&o!==t&&oO(o,n),i>0&&(t[e-1][Md]=n[Md]);let r=N2(t,Xs+i);ere(n[Ln],n);let g=r[Ep];g!==null&&g.detachView(r[Ln]),n[Ps]=null,n[Md]=null,n[sr]&=-129}return n}function Ere(t,i,e,n){let o=Xs+n,r=e.length;n>0&&(e[o-1][Md]=i),n<r-Xs?(i[Md]=e[o],iV(e,Xs+n,i)):(e.push(i),i[Md]=null),i[Ps]=e;let g=i[$g];g!==null&&e!==g&&u7(g,i);let w=i[Ep];w!==null&&w.insertView(t),s3(i),i[sr]|=128}function u7(t,i){let e=t[fy],n=i[Ps];if(qf(n))t[sr]|=2;else{let o=n[Ps][ml];i[ml]!==o&&(t[sr]|=2)}e===null?t[fy]=[i]:e.push(i)}var Q1=class{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){let i=this._lView,e=i[Ln];return K1(e,i,e.firstChild,[])}constructor(i,e,n=!0){this._lView=i,this._cdRefInjectingView=e,this.notifyErrorHandler=n}get context(){return this._lView[Ya]}set context(i){this._lView[Ya]=i}get destroyed(){return nx(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let i=this._lView[Ps];if(ku(i)){let e=i[F2],n=e?e.indexOf(this):-1;n>-1&&(X1(i,n),N2(e,n))}this._attachedToViewContainer=!1}kS(this._lView[Ln],this._lView)}onDestroy(i){EV(this._lView,i)}markForCheck(){cO(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[sr]&=-129}reattach(){s3(this._lView),this._lView[sr]|=128}detectChanges(){this._lView[sr]|=1024,n7(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new si(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let i=my(this._lView),e=this._lView[$g];e!==null&&!i&&oO(e,this._lView),Y9(this._lView[Ln],this._lView)}attachToAppRef(i){if(this._attachedToViewContainer)throw new si(902,!1);this._appRef=i;let e=my(this._lView),n=this._lView[$g];n!==null&&!e&&u7(n,this._lView),s3(this._lView)}};var Zo=(()=>{class t{static __NG_ELEMENT_ID__=Tre}return t})(),Cre=Zo,Sre=class extends Cre{_declarationLView;_declarationTContainer;elementRef;constructor(i,e,n){super(),this._declarationLView=i,this._declarationTContainer=e,this.elementRef=n}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(i,e){return this.createEmbeddedViewImpl(i,e)}createEmbeddedViewImpl(i,e,n){let o=lx(this._declarationLView,this._declarationTContainer,i,{embeddedViewInjector:e,dehydratedView:n});return new Q1(o)}};function Tre(){return NS(_l(),qn())}function NS(t,i){return t.type&4?new Sre(i,t,Ty(t,i)):null}var N3="<-- AT THIS LOCATION";function Dre(t){switch(t){case 4:return"view container";case 2:return"element";case 8:return"ng-container";case 32:return"icu";case 64:return"i18n";case 16:return"projection";case 1:return"text";case 128:return"@let";default:return"<unknown>"}}function Mre(t,i){let e=`During serialization, Angular was unable to find an element in the DOM:

`,n=`${Ore(t,i,!1)}

`,o=Nre();throw new si(-502,e+n+o)}function Ire(t){let i="During serialization, Angular detected DOM nodes that were created outside of Angular context and provided as projectable nodes (likely via `ViewContainerRef.createComponent` or `createComponent` APIs). Hydration is not supported for such cases, consider refactoring the code to avoid this pattern or using `ngSkipHydration` on the host element of the component.\n\n",e=`${Pre(t)}

`,n=i+e+Lre();return new si(-503,n)}function Are(t){let i=[];if(t.attrs)for(let e=0;e<t.attrs.length;){let n=t.attrs[e++];if(typeof n=="number")break;let o=t.attrs[e++];i.push(`${n}="${Y2(o)}"`)}return i.join(" ")}var Rre=new Set(["ngh","ng-version","ng-server-context"]);function kre(t){let i=[];for(let e=0;e<t.attributes.length;e++){let n=t.attributes[e];Rre.has(n.name)||i.push(`${n.name}="${Y2(n.value)}"`)}return i.join(" ")}function jR(t,i="\u2026"){switch(t.type){case 1:return`#text${t.value?`(${t.value})`:""}`;case 2:let n=Are(t),o=t.value.toLowerCase();return`<${o}${n?" "+n:""}>${i}</${o}>`;case 8:return"<!-- ng-container -->";case 4:return"<!-- container -->";default:return`#node(${Dre(t.type)})`}}function A2(t,i="\u2026"){let e=t;switch(e.nodeType){case Node.ELEMENT_NODE:let n=e.tagName.toLowerCase(),o=kre(e);return`<${n}${o?" "+o:""}>${i}</${n}>`;case Node.TEXT_NODE:let r=e.textContent?Y2(e.textContent):"";return`#text${r?`(${r})`:""}`;case Node.COMMENT_NODE:return`<!-- ${Y2(e.textContent??"")} -->`;default:return`#node(${e.nodeType})`}}function Ore(t,i,e){let n="  ",o="";i.prev?(o+=n+`\u2026
`,o+=n+jR(i.prev)+`
`):i.type&&i.type&12&&(o+=n+`\u2026
`),e?(o+=n+jR(i)+`
`,o+=n+`<!-- container -->  ${N3}
`):o+=n+jR(i)+`  ${N3}
`,o+=n+`\u2026
`;let r=i.type?aO(t[Ln],i,t):null;return r&&(o=A2(r,`
`+o)),o}function Pre(t){let i="  ",e="",n=t;return n.previousSibling&&(e+=i+`\u2026
`,e+=i+A2(n.previousSibling)+`
`),e+=i+A2(n)+`  ${N3}
`,t.nextSibling&&(e+=i+`\u2026
`),t.parentNode&&(e=A2(n.parentNode,`
`+e)),e}function Nre(t){return`To fix this problem:
  * check ${t?`the "${t}"`:"corresponding"} component for hydration-related issues
  * check to see if your template has valid HTML structure
  * or skip hydration by adding the \`ngSkipHydration\` attribute to its host node in a template

`}function Lre(){return`Note: attributes are only displayed to better represent the DOM but have no effect on hydration mismatches.

`}function Fre(t){return t.replace(/\s+/gm,"")}function Y2(t,i=50){return t?(t=Fre(t),t.length>i?`${t.substring(0,i-1)}\u2026`:t):""}function Iy(t,i,e,n,o){let r=t.data[i];if(r===null)r=zre(t,i,e,n,o),Mte()&&(r.flags|=32);else if(r.type&64){r.type=e,r.value=n,r.attrs=o;let g=Cte();r.injectorIndex=g===null?-1:g.injectorIndex}return Xf(r,!0),r}function zre(t,i,e,n,o){let r=CV(),g=Ik(),w=g?r:r&&r.parent,T=t.data[i]=Vre(t,w,e,i,n,o);return Bre(t,T,r,g),T}function Bre(t,i,e,n){t.firstChild===null&&(t.firstChild=i),e!==null&&(n?e.child==null&&i.parent!==null&&(e.child=i):e.next===null&&(e.next=i,i.prev=e))}function Vre(t,i,e,n,o,r){let g=i?i.injectorIndex:-1,w=0;return Ey()&&(w|=128),{type:e,index:n,insertBeforeIndex:null,injectorIndex:g,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:w,providerIndexes:0,value:o,attrs:r,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:i,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function jre(t,i){let e=i[t.currentCaseLViewIndex];return e===null?e:e<0?~e:e}function d7(t,i,e){t.index=0;let n=jre(i,e);n!==null?t.removes=i.remove[n]:t.removes=fl}function L3(t){if(t.index<t.removes.length){let i=t.removes[t.index++];if(i>0)return t.lView[i];{t.stack.push(t.index,t.removes);let e=~i,n=t.lView[Ln].data[e];return d7(t,n,t.lView),L3(t)}}else return t.stack.length===0?null:(t.removes=t.stack.pop(),t.index=t.stack.pop(),L3(t))}function Ure(t,i){let e={stack:[],index:-1,lView:i};return d7(e,t,i),L3.bind(null,e)}var Hre=new RegExp(`^(\\d+)*(${Uk}|${jk})*(.*)`);function qre(t,i){let e=[t];for(let n of i){let o=e.length-1;if(o>0&&e[o-1]===n){let r=e[o]||1;e[o]=r+1}else e.push(n,"")}return e.join("")}function $re(t){let i=t.match(Hre),[e,n,o,r]=i,g=n?parseInt(n,10):o,w=[];for(let[T,k,N]of r.matchAll(/(f|n)(\d*)/g)){let V=parseInt(N,10)||1;w.push(k,V)}return[g,...w]}function Gre(t){return!t.prev&&t.parent?.type===8}function UR(t){return t.index-qr}function J1(t,i){return!(t.type&144)&&!!i[t.index]&&h7(Wo(i[t.index]))}function h7(t){return!!t&&!t.isConnected}function Wre(t,i){let e=t.i18nNodes;if(e)return e.get(i)}function LS(t,i,e,n){let o=UR(n),r=Wre(t,o);if(r===void 0){let g=t.data[b3];if(g?.[o])r=Yre(g[o],e);else if(i.firstChild===n)r=t.firstChild;else{let w=n.prev===null,T=n.prev??n.parent;if(Gre(n)){let k=UR(n.parent);r=w3(t,k)}else{let k=Rd(T,e);if(w)r=k.firstChild;else{let N=UR(T),V=w3(t,N);if(T.type===2&&V){let Z=Wk(t,N)+1;r=FS(Z,V)}else r=k.nextSibling}}}}return r}function FS(t,i){let e=i;for(let n=0;n<t;n++)e=e.nextSibling;return e}function Zre(t,i){let e=t;for(let n=0;n<i.length;n+=2){let o=i[n],r=i[n+1];for(let g=0;g<r;g++)switch(o){case a9:e=e.firstChild;break;case s9:e=e.nextSibling;break}}return e}function Yre(t,i){let[e,...n]=$re(t),o;if(e===jk)o=i[ml][fs];else if(e===Uk)o=yne(i[ml][fs]);else{let r=Number(e);o=Wo(i[r+qr])}return Zre(o,n)}function F3(t,i){if(t===i)return[];if(t.parentElement==null||i.parentElement==null)return null;if(t.parentElement===i.parentElement)return Kre(t,i);{let e=i.parentElement,n=F3(t,e),o=F3(e.firstChild,i);return!n||!o?null:[...n,a9,...o]}}function Kre(t,i){let e=[],n=null;for(n=t;n!=null&&n!==i;n=n.nextSibling)e.push(s9);return n==null?null:e}function EB(t,i,e){let n=F3(t,i);return n===null?null:qre(e,n)}function Xre(t,i,e){let n=t.parent,o,r,g;for(;n!==null&&(J1(n,i)||e?.has(n.index));)n=n.parent;n===null||!(n.type&3)?(o=g=jk,r=i[ml][fs]):(o=n.index,r=Wo(i[o]),g=Ug(o-qr));let w=Wo(i[t.index]);if(t.type&44){let k=zg(i,t);k&&(w=k)}let T=EB(r,w,g);if(T===null&&r!==w){let k=r.ownerDocument.body;if(T=EB(k,w,Uk),T===null)throw Mre(i,t)}return T}var p7=!1;function Qre(t){p7=t}function Jre(){return p7}function eoe(t){return t=t??J(wn),t.get(xie,!1)}function toe(t,i){let e=i.i18nChildren.get(t);return e===void 0&&(e=ioe(t),i.i18nChildren.set(t,e)),e}function ioe(t){let i=new Set;function e(n){switch(i.add(n.index),n.kind){case 1:case 2:{for(let o of n.children)e(o);break}case 3:{for(let o of n.cases)for(let r of o)e(r);break}}}for(let n=qr;n<t.bindingStartIndex;n++){let o=t.data[n];if(!(!o||!o.ast))for(let r of o.ast)e(r)}return i.size===0?null:i}function noe(t,i,e){if(!e.isI18nHydrationEnabled)return null;let n=t[Ln],o=n.data[i];if(!o||!o.ast)return null;let r=n.data[o.parentTNodeIndex];if(r&&hie(r))return null;let g={caseQueue:[],disconnectedNodes:new Set,disjointNodes:new Set};return z3(t,g,e,o.ast),g.caseQueue.length===0&&g.disconnectedNodes.size===0&&g.disjointNodes.size===0?null:g}function z3(t,i,e,n){let o=null;for(let r of n){let g=ooe(t,i,e,r);g&&(roe(o,g)&&i.disjointNodes.add(r.index-qr),o=g)}return o}function roe(t,i){return t&&t.nextSibling!==i}function ooe(t,i,e,n){let o=Wo(t[n.index]);if(!o||h7(o))return i.disconnectedNodes.add(n.index-qr),null;let r=o;switch(n.kind){case 0:{b9(e,r);break}case 1:case 2:{z3(t,i,e,n.children);break}case 3:{let g=t[n.currentCaseLViewIndex];if(g!=null){let w=g<0?~g:g;i.caseQueue.push(w),z3(t,i,e,n.cases[w])}break}}return aoe(t,n)}function aoe(t,i){let n=t[Ln].data[i.index];return PV(n)?zg(t,n):i.kind===3?Ure(n,t)()??Wo(t[i.index]):Wo(t[i.index])??null}function soe(t){let i=t[H1]??[],n=t[Ps][_o],o=[];for(let r of i)r.data[l9]!==void 0?o.push(r):loe(r,n);t[H1]=o}function loe(t,i){let e=0,n=t.firstChild;if(n){let o=t.data[jg];for(;e<o;){let r=n.nextSibling;j9(i,n,!1),n=r,e++}}}function coe(t,i){let e=[];for(let n of i)for(let o=0;o<(n[G2]??1);o++){let r={data:n,firstChild:null};n[jg]>0&&(r.firstChild=t,t=FS(n[jg],t)),e.push(r)}return[t,e]}var f7=()=>null;function uoe(t,i){let e=t[H1];return!i||e===null||e.length===0?null:e[0].data[v3]===i?e.shift():(soe(t),null)}function doe(){f7=uoe}function yy(t,i){return f7(t,i)}var hoe=class{},m7=class{},B3=class{resolveComponentFactory(i){throw Error(`No component factory found for ${gc(i)}.`)}},zS=class{static NULL=new B3},Fa=class{},Ko=(()=>{class t{destroyNode=null;static __NG_ELEMENT_ID__=()=>poe()}return t})();function poe(){let t=qn(),i=_l(),e=Ah(i.index,t);return(qf(e)?e:t)[_o]}var foe=(()=>{class t{static \u0275prov=Ft({token:t,providedIn:"root",factory:()=>null})}return t})();var HR={},V3=class{injector;parentInjector;constructor(i,e){this.injector=i,this.parentInjector=e}get(i,e,n){n=pS(n);let o=this.injector.get(i,HR,n);return o!==HR||e===HR?o:this.parentInjector.get(i,e,n)}};function j3(t,i,e){let n=e?t.styles:null,o=e?t.classes:null,r=0;if(i!==null)for(let g=0;g<i.length;g++){let w=i[g];if(typeof w=="number")r=w;else if(r==1)o=JR(o,w);else if(r==2){let T=w,k=i[++g];n=JR(n,T+": "+k+";")}}e?t.styles=n:t.stylesWithoutHost=n,e?t.classes=o:t.classesWithoutHost=o}function Ci(t,i=kr.Default){let e=qn();if(e===null)return bi(t,i);let n=_l();return UV(n,e,Ks(t),i)}function BS(){let t="invalid";throw new Error(t)}function uO(t,i,e,n,o){let r=n===null?null:{"":-1},g=o(t,e);if(g!==null){let w,T=null,k=null,N=goe(g);N===null?w=g:[w,T,k]=N,voe(t,i,e,w,r,T,k)}r!==null&&n!==null&&moe(e,n,r)}function moe(t,i,e){let n=t.localNames=[];for(let o=0;o<i.length;o+=2){let r=e[i[o+1]];if(r==null)throw new si(-301,!1);n.push(i[o],r)}}function goe(t){let i=null,e=!1;for(let g=0;g<t.length;g++){let w=t[g];if(g===0&&Ih(w)&&(i=w),w.findHostDirectiveDefs!==null){e=!0;break}}if(!e)return null;let n=null,o=null,r=null;for(let g of t)g.findHostDirectiveDefs!==null&&(n??=[],o??=new Map,r??=new Map,_oe(g,n,r,o)),g===i&&(n??=[],n.push(g));return n!==null?(n.push(...i===null?t:t.slice(1)),[n,o,r]):null}function _oe(t,i,e,n){let o=i.length;t.findHostDirectiveDefs(t,i,n),e.set(t,[o,i.length-1])}function yoe(t,i,e){i.componentOffset=e,(t.components??=[]).push(i.index)}function voe(t,i,e,n,o,r,g){let w=n.length,T=!1;for(let q=0;q<w;q++){let Z=n[q];!T&&Ih(Z)&&(T=!0,yoe(t,e,q)),d3(U2(e,i),t,Z.type)}Soe(e,t.data.length,w);for(let q=0;q<w;q++){let Z=n[q];Z.providersResolver&&Z.providersResolver(Z)}let k=!1,N=!1,V=$9(t,i,w,null);w>0&&(e.directiveToIndex=new Map);for(let q=0;q<w;q++){let Z=n[q];if(e.mergedAttrs=gy(e.mergedAttrs,Z.hostAttrs),xoe(t,e,i,V,Z),Coe(V,Z,o),g!==null&&g.has(Z)){let[te,De]=g.get(Z);e.directiveToIndex.set(Z.type,[V,te+e.directiveStart,De+e.directiveStart])}else(r===null||!r.has(Z))&&e.directiveToIndex.set(Z.type,V);Z.contentQueries!==null&&(e.flags|=4),(Z.hostBindings!==null||Z.hostAttrs!==null||Z.hostVars!==0)&&(e.flags|=64);let X=Z.type.prototype;!k&&(X.ngOnChanges||X.ngOnInit||X.ngDoCheck)&&((t.preOrderHooks??=[]).push(e.index),k=!0),!N&&(X.ngOnChanges||X.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(e.index),N=!0),V++}boe(t,e,r)}function boe(t,i,e){for(let n=i.directiveStart;n<i.directiveEnd;n++){let o=t.data[n];if(e===null||!e.has(o))CB(0,i,o,n),CB(1,i,o,n),TB(i,n,!1);else{let r=e.get(o);SB(0,i,r,n),SB(1,i,r,n),TB(i,n,!0)}}}function CB(t,i,e,n){let o=t===0?e.inputs:e.outputs;for(let r in o)if(o.hasOwnProperty(r)){let g;t===0?g=i.inputs??={}:g=i.outputs??={},g[r]??=[],g[r].push(n),g7(i,r)}}function SB(t,i,e,n){let o=t===0?e.inputs:e.outputs;for(let r in o)if(o.hasOwnProperty(r)){let g=o[r],w;t===0?w=i.hostDirectiveInputs??={}:w=i.hostDirectiveOutputs??={},w[g]??=[],w[g].push(n,r),g7(i,g)}}function g7(t,i){i==="class"?t.flags|=8:i==="style"&&(t.flags|=16)}function TB(t,i,e){let{attrs:n,inputs:o,hostDirectiveInputs:r}=t;if(n===null||!e&&o===null||e&&r===null||Yk(t)){t.initialInputs??=[],t.initialInputs.push(null);return}let g=null,w=0;for(;w<n.length;){let T=n[w];if(T===0){w+=4;continue}else if(T===5){w+=2;continue}else if(typeof T=="number")break;if(!e&&o.hasOwnProperty(T)){let k=o[T];for(let N of k)if(N===i){g??=[],g.push(T,n[w+1]);break}}else if(e&&r.hasOwnProperty(T)){let k=r[T];for(let N=0;N<k.length;N+=2)if(k[N]===i){g??=[],g.push(k[N+1],n[w+1]);break}}w+=2}t.initialInputs??=[],t.initialInputs.push(g)}function xoe(t,i,e,n,o){t.data[n]=o;let r=o.factory||(o.factory=Hg(o.type,!0)),g=new Yg(r,Ih(o),Ci);t.blueprint[n]=g,e[n]=g,woe(t,i,n,$9(t,e,o.hostVars,vc),o)}function woe(t,i,e,n,o){let r=o.hostBindings;if(r){let g=t.hostBindingOpCodes;g===null&&(g=t.hostBindingOpCodes=[]);let w=~i.index;Eoe(g)!=w&&g.push(w),g.push(e,n,r)}}function Eoe(t){let i=t.length;for(;i>0;){let e=t[--i];if(typeof e=="number"&&e<0)return e}return 0}function Coe(t,i,e){if(e){if(i.exportAs)for(let n=0;n<i.exportAs.length;n++)e[i.exportAs[n]]=t;Ih(i)&&(e[""]=t)}}function Soe(t,i,e){t.flags|=1,t.directiveStart=i,t.directiveEnd=i+e,t.providerIndexes=i}function _7(t,i,e,n,o,r,g,w){let T=i.consts,k=Gf(T,g),N=Iy(i,t,2,n,k);return r&&uO(i,e,N,Gf(T,w),o),N.mergedAttrs=gy(N.mergedAttrs,N.attrs),N.attrs!==null&&j3(N,N.attrs,!1),N.mergedAttrs!==null&&j3(N,N.mergedAttrs,!0),i.queries!==null&&i.queries.elementStart(i,N),N}function y7(t,i){Nk(t,i),wk(i)&&t.queries.elementEnd(i)}var K2=class extends zS{ngModule;constructor(i){super(),this.ngModule=i}resolveComponentFactory(i){let e=xp(i);return new Kg(e,this.ngModule)}};function Toe(t){return Object.keys(t).map(i=>{let[e,n,o]=t[i],r={propName:e,templateName:i,isSignal:(n&IS.SignalBased)!==0};return o&&(r.transform=o),r})}function Doe(t){return Object.keys(t).map(i=>({propName:t[i],templateName:i}))}function Moe(t,i,e){let n=i instanceof Ea?i:i?.injector;return n&&t.getStandaloneInjector!==null&&(n=t.getStandaloneInjector(n)||n),n?new V3(e,n):e}function Ioe(t){let i=t.get(Fa,null);if(i===null)throw new si(407,!1);let e=t.get(foe,null),n=t.get(Wf,null);return{rendererFactory:i,sanitizer:e,changeDetectionScheduler:n}}function Aoe(t,i){let e=(t.selectors[0][0]||"div").toLowerCase();return Kk(i,e,e==="svg"?yV:e==="math"?hte:null)}var Kg=class extends m7{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=Toe(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=Doe(this.componentDef.outputs),this.cachedOutputs}constructor(i,e){super(),this.componentDef=i,this.ngModule=e,this.componentType=i.type,this.selector=Ine(i.selectors),this.ngContentSelectors=i.ngContentSelectors??[],this.isBoundToModule=!!e}create(i,e,n,o){xo(22);let r=Mr(null);try{let g=this.componentDef,w=n?["ng-version","19.2.8"]:Ane(this.componentDef.selectors[0]),T=Xk(0,null,null,1,0,null,null,null,null,[w],null),k=Moe(g,o||this.ngModule,i),N=Ioe(k),V=N.rendererFactory.createRenderer(null,g),q=n?Fne(V,n,g.encapsulation,k):Aoe(g,V),Z=Qk(null,T,null,512|q9(g),null,null,N,V,k,null,y9(q,k,!0));Z[qr]=q,Ok(Z);let X=null;try{let te=_7(qr,T,Z,"#host",()=>[this.componentDef],!0,0);q&&(H9(V,q,te),Dy(q,Z)),AS(T,Z,te),Zk(T,te,Z),y7(T,te),e!==void 0&&Roe(te,this.ngContentSelectors,e),X=Ah(te.index,Z),Z[Ya]=X[Ya],nO(T,Z,null)}catch(te){throw X!==null&&m3(X),m3(Z),te}finally{xo(23),Pk()}return new U3(this.componentType,Z)}finally{Mr(r)}}},U3=class extends hoe{_rootLView;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(i,e){super(),this._rootLView=e,this._tNode=Ek(e[Ln],qr),this.location=Ty(this._tNode,e),this.instance=Ah(this._tNode.index,e)[Ya],this.hostView=this.changeDetectorRef=new Q1(e,void 0,!1),this.componentType=i}setInput(i,e){let n=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(i)&&Object.is(this.previousInputValues.get(i),e))return;let o=this._rootLView,r=iO(n,o[Ln],o,i,e);this.previousInputValues.set(i,e);let g=Ah(n.index,o);cO(g,1)}get injector(){return new Vg(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(i){this.hostView.onDestroy(i)}};function Roe(t,i,e){let n=t.projection=[];for(let o=0;o<i.length;o++){let r=e[o];n.push(r!=null&&r.length?Array.from(r):null)}}var na=(()=>{class t{static __NG_ELEMENT_ID__=koe}return t})();function koe(){let t=_l();return b7(t,qn())}var Ooe=na,v7=class extends Ooe{_lContainer;_hostTNode;_hostLView;constructor(i,e,n){super(),this._lContainer=i,this._hostTNode=e,this._hostLView=n}get element(){return Ty(this._hostTNode,this._hostLView)}get injector(){return new Vg(this._hostTNode,this._hostLView)}get parentInjector(){let i=Lk(this._hostTNode,this._hostLView);if(LV(i)){let e=V2(i,this._hostLView),n=B2(i),o=e[Ln].data[n+8];return new Vg(o,e)}else return new Vg(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(i){let e=DB(this._lContainer);return e!==null&&e[i]||null}get length(){return this._lContainer.length-Xs}createEmbeddedView(i,e,n){let o,r;typeof n=="number"?o=n:n!=null&&(o=n.index,r=n.injector);let g=yy(this._lContainer,i.ssrId),w=i.createEmbeddedViewImpl(e||{},r,g);return this.insertImpl(w,o,_y(this._hostTNode,g)),w}createComponent(i,e,n,o,r){let g=i&&!ste(i),w;if(g)w=e;else{let X=e||{};w=X.index,n=X.injector,o=X.projectableNodes,r=X.environmentInjector||X.ngModuleRef}let T=g?i:new Kg(xp(i)),k=n||this.parentInjector;if(!r&&T.ngModule==null){let te=(g?k:this.parentInjector).get(Ea,null);te&&(r=te)}let N=xp(T.componentType??{}),V=yy(this._lContainer,N?.id??null),q=V?.firstChild??null,Z=T.create(k,o,q,r);return this.insertImpl(Z.hostView,w,_y(this._hostTNode,V)),Z}insert(i,e){return this.insertImpl(i,e,!0)}insertImpl(i,e,n){let o=i._lView;if(fte(o)){let w=this.indexOf(i);if(w!==-1)this.detach(w);else{let T=o[Ps],k=new v7(T,T[_c],T[Ps]);k.detach(k.indexOf(i))}}let r=this._adjustIndex(e),g=this._lContainer;return cx(g,o,r,n),i.attachToViewContainerRef(),iV(qR(g),r,i),i}move(i,e){return this.insert(i,e)}indexOf(i){let e=DB(this._lContainer);return e!==null?e.indexOf(i):-1}remove(i){let e=this._adjustIndex(i,-1),n=X1(this._lContainer,e);n&&(N2(qR(this._lContainer),e),kS(n[Ln],n))}detach(i){let e=this._adjustIndex(i,-1),n=X1(this._lContainer,e);return n&&N2(qR(this._lContainer),e)!=null?new Q1(n):null}_adjustIndex(i,e=0){return i??this.length+e}};function DB(t){return t[F2]}function qR(t){return t[F2]||(t[F2]=[])}function b7(t,i){let e,n=i[t.index];return ku(n)?e=n:(e=s7(n,i,null,t),i[t.index]=e,Jk(i,e)),x7(e,i,t,n),new v7(e,t,i)}function Poe(t,i){let e=t[_o],n=e.createComment(""),o=Rd(i,t),r=e.parentNode(o);return Z2(e,r,n,e.nextSibling(o),!1),n}var x7=w7,dO=()=>!1;function Noe(t,i,e){return dO(t,i,e)}function w7(t,i,e,n){if(t[Cp])return;let o;e.type&8?o=Wo(n):o=Poe(i,e),t[Cp]=o}function Loe(t,i,e){if(t[Cp]&&t[H1])return!0;let n=e[Id],o=i.index-qr;if(!n||Z1(i)||ax(n,o))return!1;let g=w3(n,o),w=n.data[Y1]?.[o],[T,k]=coe(g,w);return t[Cp]=T,t[H1]=k,!0}function Foe(t,i,e,n){dO(t,e,i)||w7(t,i,e,n)}function zoe(){x7=Foe,dO=Loe}var H3=class t{queryList;matches=null;constructor(i){this.queryList=i}clone(){return new t(this.queryList)}setDirty(){this.queryList.setDirty()}},q3=class t{queries;constructor(i=[]){this.queries=i}createEmbeddedView(i){let e=i.queries;if(e!==null){let n=i.contentQueries!==null?i.contentQueries[0]:e.length,o=[];for(let r=0;r<n;r++){let g=e.getByIndex(r),w=this.queries[g.indexInDeclarationView];o.push(w.clone())}return new t(o)}return null}insertView(i){this.dirtyQueriesWithMatches(i)}detachView(i){this.dirtyQueriesWithMatches(i)}finishViewCreation(i){this.dirtyQueriesWithMatches(i)}dirtyQueriesWithMatches(i){for(let e=0;e<this.queries.length;e++)pO(i,e).matches!==null&&this.queries[e].setDirty()}},X2=class{flags;read;predicate;constructor(i,e,n=null){this.flags=e,this.read=n,typeof i=="string"?this.predicate=qoe(i):this.predicate=i}},$3=class t{queries;constructor(i=[]){this.queries=i}elementStart(i,e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(i,e)}elementEnd(i){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(i)}embeddedTView(i){let e=null;for(let n=0;n<this.length;n++){let o=e!==null?e.length:0,r=this.getByIndex(n).embeddedTView(i,o);r&&(r.indexInDeclarationView=n,e!==null?e.push(r):e=[r])}return e!==null?new t(e):null}template(i,e){for(let n=0;n<this.queries.length;n++)this.queries[n].template(i,e)}getByIndex(i){return this.queries[i]}get length(){return this.queries.length}track(i){this.queries.push(i)}},G3=class t{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(i,e=-1){this.metadata=i,this._declarationNodeIndex=e}elementStart(i,e){this.isApplyingToNode(e)&&this.matchTNode(i,e)}elementEnd(i){this._declarationNodeIndex===i.index&&(this._appliesToNextNode=!1)}template(i,e){this.elementStart(i,e)}embeddedTView(i,e){return this.isApplyingToNode(i)?(this.crossesNgTemplate=!0,this.addMatch(-i.index,e),new t(this.metadata)):null}isApplyingToNode(i){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let e=this._declarationNodeIndex,n=i.parent;for(;n!==null&&n.type&8&&n.index!==e;)n=n.parent;return e===(n!==null?n.index:-1)}return this._appliesToNextNode}matchTNode(i,e){let n=this.metadata.predicate;if(Array.isArray(n))for(let o=0;o<n.length;o++){let r=n[o];this.matchTNodeWithReadOption(i,e,Boe(e,r)),this.matchTNodeWithReadOption(i,e,I2(e,i,r,!1,!1))}else n===Zo?e.type&4&&this.matchTNodeWithReadOption(i,e,-1):this.matchTNodeWithReadOption(i,e,I2(e,i,n,!1,!1))}matchTNodeWithReadOption(i,e,n){if(n!==null){let o=this.metadata.read;if(o!==null)if(o===Qi||o===na||o===Zo&&e.type&4)this.addMatch(e.index,-2);else{let r=I2(e,i,o,!1,!1);r!==null&&this.addMatch(e.index,r)}else this.addMatch(e.index,n)}}addMatch(i,e){this.matches===null?this.matches=[i,e]:this.matches.push(i,e)}};function Boe(t,i){let e=t.localNames;if(e!==null){for(let n=0;n<e.length;n+=2)if(e[n]===i)return e[n+1]}return null}function Voe(t,i){return t.type&11?Ty(t,i):t.type&4?NS(t,i):null}function joe(t,i,e,n){return e===-1?Voe(i,t):e===-2?Uoe(t,i,n):q1(t,t[Ln],e,i)}function Uoe(t,i,e){if(e===Qi)return Ty(i,t);if(e===Zo)return NS(i,t);if(e===na)return b7(i,t)}function E7(t,i,e,n){let o=i[Ep].queries[n];if(o.matches===null){let r=t.data,g=e.matches,w=[];for(let T=0;g!==null&&T<g.length;T+=2){let k=g[T];if(k<0)w.push(null);else{let N=r[k];w.push(joe(i,N,g[T+1],e.metadata.read))}}o.matches=w}return o.matches}function W3(t,i,e,n){let o=t.queries.getByIndex(e),r=o.matches;if(r!==null){let g=E7(t,i,o,e);for(let w=0;w<r.length;w+=2){let T=r[w];if(T>0)n.push(g[w/2]);else{let k=r[w+1],N=i[-T];for(let V=Xs;V<N.length;V++){let q=N[V];q[$g]===q[Ps]&&W3(q[Ln],q,k,n)}if(N[fy]!==null){let V=N[fy];for(let q=0;q<V.length;q++){let Z=V[q];W3(Z[Ln],Z,k,n)}}}}}return n}function hO(t,i){return t[Ep].queries[i].queryList}function C7(t,i,e){let n=new Zf((e&4)===4);return _te(t,i,n,n.destroy),(i[Ep]??=new q3).queries.push(new H3(n))-1}function Hoe(t,i,e){let n=Yo();return n.firstCreatePass&&(T7(n,new X2(t,i,e),-1),(i&2)===2&&(n.staticViewQueries=!0)),C7(n,qn(),i)}function S7(t,i,e,n){let o=Yo();if(o.firstCreatePass){let r=_l();T7(o,new X2(i,e,n),r.index),$oe(o,t),(e&2)===2&&(o.staticContentQueries=!0)}return C7(o,qn(),e)}function qoe(t){return t.split(",").map(i=>i.trim())}function T7(t,i,e){t.queries===null&&(t.queries=new $3),t.queries.track(new G3(i,e))}function $oe(t,i){let e=t.contentQueries||(t.contentQueries=[]),n=e.length?e[e.length-1]:-1;i!==n&&e.push(t.queries.length-1,i)}function pO(t,i){return t.queries.getByIndex(i)}function D7(t,i){let e=t[Ln],n=pO(e,i);return n.crossesNgTemplate?W3(e,t,i,[]):E7(e,t,n,i)}function M7(t,i,e){let n,o=VC(()=>{n._dirtyCounter();let r=Yoe(n,t);if(i&&r===void 0)throw new si(-951,!1);return r});return n=o[pc],n._dirtyCounter=ma(0),n._flatValue=void 0,o}function Goe(t){return M7(!0,!1,t)}function Woe(t){return M7(!0,!0,t)}function Zoe(t,i){let e=t[pc];e._lView=qn(),e._queryIndex=i,e._queryList=hO(e._lView,i),e._queryList.onDirty(()=>e._dirtyCounter.update(n=>n+1))}function Yoe(t,i){let e=t._lView,n=t._queryIndex;if(e===void 0||n===void 0||e[sr]&4)return i?void 0:fl;let o=hO(e,n),r=D7(e,n);return o.reset(r,QV),i?o.first:o._changesDetected||t._flatValue===void 0?t._flatValue=o.toArray():t._flatValue}function MB(t,i){return Goe(i)}function Koe(t,i){return Woe(i)}var I7=(MB.required=Koe,MB);function Xoe(t){let i=[],e=new Map;function n(o){let r=e.get(o);if(!r){let g=t(o);e.set(o,r=g.then(tae))}return r}return Q2.forEach((o,r)=>{let g=[];o.templateUrl&&g.push(n(o.templateUrl).then(k=>{o.template=k}));let w=typeof o.styles=="string"?[o.styles]:o.styles||[];if(o.styles=w,o.styleUrl&&o.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(o.styleUrls?.length){let k=o.styles.length,N=o.styleUrls;o.styleUrls.forEach((V,q)=>{w.push(""),g.push(n(V).then(Z=>{w[k+q]=Z,N.splice(N.indexOf(V),1),N.length==0&&(o.styleUrls=void 0)}))})}else o.styleUrl&&g.push(n(o.styleUrl).then(k=>{w.push(k),o.styleUrl=void 0}));let T=Promise.all(g).then(()=>iae(r));i.push(T)}),Joe(),Promise.all(i).then(()=>{})}var Q2=new Map,Qoe=new Set;function Joe(){let t=Q2;return Q2=new Map,t}function eae(){return Q2.size===0}function tae(t){return typeof t=="string"?t:t.text()}function iae(t){Qoe.delete(t)}var Dp=class{},fO=class{};var J2=class extends Dp{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new K2(this);constructor(i,e,n,o=!0){super(),this.ngModuleType=i,this._parent=e;let r=oV(i);this._bootstrapComponents=N9(r.bootstrap),this._r3Injector=$V(i,e,[{provide:Dp,useValue:this},{provide:zS,useValue:this.componentFactoryResolver},...n],gc(i),new Set(["environment"])),o&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let i=this._r3Injector;!i.destroyed&&i.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(i){this.destroyCbs.push(i)}},eS=class extends fO{moduleType;constructor(i){super(),this.moduleType=i}create(i){return new J2(this.moduleType,i,[])}};function nae(t,i,e){return new J2(t,i,e,!1)}var tS=class extends Dp{injector;componentFactoryResolver=new K2(this);instance=null;constructor(i){super();let e=new V1([...i.providers,{provide:Dp,useValue:this},{provide:zS,useValue:this.componentFactoryResolver}],i.parent||gS(),i.debugName,new Set(["environment"]));this.injector=e,i.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(i){this.injector.onDestroy(i)}};function ux(t,i,e=null){return new tS({providers:t,parent:i,debugName:e,runEnvironmentInitializers:!0}).injector}var rae=(()=>{class t{_injector;cachedInjectors=new Map;constructor(e){this._injector=e}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e)){let n=sV(!1,e.type),o=n.length>0?ux([n],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e,o)}return this.cachedInjectors.get(e)}ngOnDestroy(){try{for(let e of this.cachedInjectors.values())e!==null&&e.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=Ft({token:t,providedIn:"environment",factory:()=>new t(bi(Ea))})}return t})();function ai(t){return tx(()=>{let i=A7(t),e=ji(It({},i),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===t9.OnPush,directiveDefs:null,pipeDefs:null,dependencies:i.standalone&&t.dependencies||null,getStandaloneInjector:i.standalone?o=>o.get(rae).getOrCreateStandaloneInjector(e):null,getExternalStyles:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||Ad.Emulated,styles:t.styles||fl,_:null,schemas:t.schemas||null,tView:null,id:""});i.standalone&&yc("NgStandalone"),R7(e);let n=t.dependencies;return e.directiveDefs=IB(n,!1),e.pipeDefs=IB(n,!0),e.id=uae(e),e})}function oae(t){return xp(t)||aV(t)}function aae(t){return t!==null}function $i(t){return tx(()=>({type:t.type,bootstrap:t.bootstrap||fl,declarations:t.declarations||fl,imports:t.imports||fl,exports:t.exports||fl,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function sae(t,i){if(t==null)return Mh;let e={};for(let n in t)if(t.hasOwnProperty(n)){let o=t[n],r,g,w,T;Array.isArray(o)?(w=o[0],r=o[1],g=o[2]??r,T=o[3]||null):(r=o,g=o,w=IS.None,T=null),e[r]=[n,w,T],i[r]=g}return e}function lae(t){if(t==null)return Mh;let i={};for(let e in t)t.hasOwnProperty(e)&&(i[t[e]]=e);return i}function vi(t){return tx(()=>{let i=A7(t);return R7(i),i})}function mO(t){return{type:t.type,name:t.name,factory:null,pure:t.pure!==!1,standalone:t.standalone??!0,onDestroy:t.type.prototype.ngOnDestroy||null}}function A7(t){let i={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:i,inputConfig:t.inputs||Mh,exportAs:t.exportAs||null,standalone:t.standalone??!0,signals:t.signals===!0,selectors:t.selectors||fl,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:sae(t.inputs,i),outputs:lae(t.outputs),debugInfo:null}}function R7(t){t.features?.forEach(i=>i(t))}function IB(t,i){if(!t)return null;let e=i?Kee:oae;return()=>(typeof t=="function"?t():t).map(n=>e(n)).filter(aae)}var cae=new Map;function uae(t){let i=0,e=typeof t.consts=="function"?"":t.consts,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,e,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery];for(let r of n.join("|"))i=Math.imul(31,i)+r.charCodeAt(0)<<0;return i+=2147483648,"c"+i}function dae(t){return Object.getPrototypeOf(t.prototype).constructor}function Fn(t){let i=dae(t.type),e=!0,n=[t];for(;i;){let o;if(Ih(t))o=i.\u0275cmp||i.\u0275dir;else{if(i.\u0275cmp)throw new si(903,!1);o=i.\u0275dir}if(o){if(e){n.push(o);let g=t;g.inputs=$R(t.inputs),g.declaredInputs=$R(t.declaredInputs),g.outputs=$R(t.outputs);let w=o.hostBindings;w&&gae(t,w);let T=o.viewQuery,k=o.contentQueries;if(T&&fae(t,T),k&&mae(t,k),hae(t,o),Mee(t.outputs,o.outputs),Ih(o)&&o.data.animation){let N=t.data;N.animation=(N.animation||[]).concat(o.data.animation)}}let r=o.features;if(r)for(let g=0;g<r.length;g++){let w=r[g];w&&w.ngInherit&&w(t),w===Fn&&(e=!1)}}i=Object.getPrototypeOf(i)}pae(n)}function hae(t,i){for(let e in i.inputs){if(!i.inputs.hasOwnProperty(e)||t.inputs.hasOwnProperty(e))continue;let n=i.inputs[e];n!==void 0&&(t.inputs[e]=n,t.declaredInputs[e]=i.declaredInputs[e])}}function pae(t){let i=0,e=null;for(let n=t.length-1;n>=0;n--){let o=t[n];o.hostVars=i+=o.hostVars,o.hostAttrs=gy(o.hostAttrs,e=gy(e,o.hostAttrs))}}function $R(t){return t===Mh?{}:t===fl?[]:t}function fae(t,i){let e=t.viewQuery;e?t.viewQuery=(n,o)=>{i(n,o),e(n,o)}:t.viewQuery=i}function mae(t,i){let e=t.contentQueries;e?t.contentQueries=(n,o,r)=>{i(n,o,r),e(n,o,r)}:t.contentQueries=i}function gae(t,i){let e=t.hostBindings;e?t.hostBindings=(n,o)=>{i(n,o),e(n,o)}:t.hostBindings=i}function k7(t){let i=e=>{let n=Array.isArray(t);e.hostDirectives===null?(e.findHostDirectiveDefs=O7,e.hostDirectives=n?t.map(Z3):[t]):n?e.hostDirectives.unshift(...t.map(Z3)):e.hostDirectives.unshift(t)};return i.ngInherit=!0,i}function O7(t,i,e){if(t.hostDirectives!==null)for(let n of t.hostDirectives)if(typeof n=="function"){let o=n();for(let r of o)AB(Z3(r),i,e)}else AB(n,i,e)}function AB(t,i,e){let n=aV(t.directive);_ae(n.declaredInputs,t.inputs),O7(n,i,e),e.set(n,t),i.push(n)}function Z3(t){return typeof t=="function"?{directive:Ks(t),inputs:Mh,outputs:Mh}:{directive:Ks(t.directive),inputs:RB(t.inputs),outputs:RB(t.outputs)}}function RB(t){if(t===void 0||t.length===0)return Mh;let i={};for(let e=0;e<t.length;e+=2)i[t[e]]=t[e+1];return i}function _ae(t,i){for(let e in i)if(i.hasOwnProperty(e)){let n=i[e],o=t[e];t[n]=o}}function P7(t){return vae(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function yae(t,i){if(Array.isArray(t))for(let e=0;e<t.length;e++)i(t[e]);else{let e=t[Symbol.iterator](),n;for(;!(n=e.next()).done;)i(n.value)}}function vae(t){return t!==null&&(typeof t=="function"||typeof t=="object")}function dx(t,i,e){return t[i]=e}function N7(t,i){return t[i]}function Jc(t,i,e){let n=t[i];return Object.is(n,e)?!1:(t[i]=e,!0)}function iS(t,i,e,n){let o=Jc(t,i,e);return Jc(t,i+1,n)||o}function L7(t,i,e,n,o,r){let g=iS(t,i,e,n);return iS(t,i+2,o,r)||g}function bae(t,i,e,n,o,r,g,w,T){let k=i.consts,N=Iy(i,t,4,g||null,w||null);Mk()&&uO(i,e,N,Gf(k,T),tO),N.mergedAttrs=gy(N.mergedAttrs,N.attrs),Nk(i,N);let V=N.tView=Xk(2,N,n,o,r,i.directiveRegistry,i.pipeRegistry,null,i.schemas,k,null);return i.queries!==null&&(i.queries.template(i,N),V.queries=i.queries.embeddedTView(N)),N}function nS(t,i,e,n,o,r,g,w,T,k){let N=e+qr,V=i.firstCreatePass?bae(N,i,t,n,o,r,g,w,T):i.data[N];Xf(V,!1);let q=F7(i,t,V,e);wS()&&OS(i,t,q,V),Dy(q,t);let Z=s7(q,t,q,V);return t[N]=Z,Jk(t,Z),Noe(Z,V,t),vS(V)&&AS(i,t,V),T!=null&&eO(t,V,k),V}function Tt(t,i,e,n,o,r,g,w){let T=qn(),k=Yo(),N=Gf(k.consts,r);return nS(T,k,t,i,e,n,o,N,g,w),Tt}var F7=z7;function z7(t,i,e,n){return Qf(!0),i[_o].createComment("")}function xae(t,i,e,n){let o=i[Id],r=!o||Ey()||tm(e)||ax(o,n);if(Qf(r),r)return z7(t,i);let g=o.data[y3]?.[n]??null;g!==null&&e.tView!==null&&e.tView.ssrId===null&&(e.tView.ssrId=g);let w=LS(o,t,i,e);TS(o,n,w);let T=Wk(o,n);return FS(T,w)}function wae(){F7=xae}var r0=(()=>{class t{log(e){console.log(e)}warn(e){console.warn(e)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();var hx=new Ot(""),px=new Ot(""),Ay=(()=>{class t{_ngZone;registry;_isZoneStable=!0;_callbacks=[];taskTrackingZone=null;constructor(e,n,o){this._ngZone=e,this.registry=n,gO||(Eae(o),o.addToWindow(n)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Oi.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb()}});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(n=>n.updateCb&&n.updateCb(e)?(clearTimeout(n.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,n,o){let r=-1;n&&n>0&&(r=setTimeout(()=>{this._callbacks=this._callbacks.filter(g=>g.timeoutId!==r),e()},n)),this._callbacks.push({doneCb:e,timeoutId:r,updateCb:o})}whenStable(e,n,o){if(o&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,n,o),this._runCallbacksIfReady()}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,n,o){return[]}static \u0275fac=function(n){return new(n||t)(bi(Oi),bi(VS),bi(px))};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})(),VS=(()=>{class t{_applications=new Map;registerApplication(e,n){this._applications.set(e,n)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,n=!0){return gO?.findTestabilityInTree(this,e,n)??null}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();function Eae(t){gO=t}var gO,B7=(()=>{class t{static \u0275prov=Ft({token:t,providedIn:"root",factory:()=>new Y3})}return t})(),Y3=class{queuedEffectCount=0;queues=new Map;schedule(i){this.enqueue(i)}remove(i){let e=i.zone,n=this.queues.get(e);n.has(i)&&(n.delete(i),this.queuedEffectCount--)}enqueue(i){let e=i.zone;this.queues.has(e)||this.queues.set(e,new Set);let n=this.queues.get(e);n.has(i)||(this.queuedEffectCount++,n.add(i))}flush(){for(;this.queuedEffectCount>0;)for(let[i,e]of this.queues)i===null?this.flushQueue(e):i.run(()=>this.flushQueue(e))}flushQueue(i){for(let e of i)i.delete(e),this.queuedEffectCount--,e.run()}};function im(t){return!!t&&typeof t.then=="function"}function _O(t){return!!t&&typeof t.subscribe=="function"}var V7=new Ot("");function yO(t){return eu([{provide:V7,multi:!0,useValue:t}])}var j7=(()=>{class t{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((e,n)=>{this.resolve=e,this.reject=n});appInits=J(V7,{optional:!0})??[];injector=J(wn);constructor(){}runInitializers(){if(this.initialized)return;let e=[];for(let o of this.appInits){let r=gl(this.injector,o);if(im(r))e.push(r);else if(_O(r)){let g=new Promise((w,T)=>{r.subscribe({complete:w,error:T})});e.push(g)}}let n=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{n()}).catch(o=>{this.reject(o)}),e.length===0&&n(),this.initialized=!0}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Ry=new Ot("");function U7(){mR(()=>{throw new si(600,!1)})}function Cae(t){return t.isBoundToModule}var Sae=10;function H7(t,i){return Array.isArray(i)?i.reduce(H7,t):It(It({},t),i)}var ms=(()=>{class t{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=J(aie);afterRenderManager=J(d9);zonelessEnabled=J(CS);rootEffectScheduler=J(B7);dirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new gi;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=J(Ip).hasPendingTasks.pipe(hn(e=>!e));constructor(){J(My,{optional:!0})}whenStable(){let e;return new Promise(n=>{e=this.isStable.subscribe({next:o=>{o&&n()}})}).finally(()=>{e.unsubscribe()})}_injector=J(Ea);_rendererFactory=null;get injector(){return this._injector}bootstrap(e,n){return this.bootstrapImpl(e,n)}bootstrapImpl(e,n,o=wn.NULL){xo(10);let r=e instanceof m7;if(!this._injector.get(j7).done){let Z="";throw new si(405,Z)}let w;r?w=e:w=this._injector.get(zS).resolveComponentFactory(e),this.componentTypes.push(w.componentType);let T=Cae(w)?void 0:this._injector.get(Dp),k=n||w.selector,N=w.create(o,[],k,T),V=N.location.nativeElement,q=N.injector.get(hx,null);return q?.registerApplication(V),N.onDestroy(()=>{this.detachView(N.hostView),R2(this.components,N),q?.unregisterApplication(V)}),this._loadComponent(N),xo(11,N),N}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){xo(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(Hk.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new si(101,!1);let e=Mr(null);try{this._runningTick=!0,this.synchronize()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,Mr(e),this.afterTick.next(),xo(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Fa,null,{optional:!0}));let e=0;for(;this.dirtyFlags!==0&&e++<Sae;)xo(14),this.synchronizeOnce(),xo(15)}synchronizeOnce(){if(this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),this.dirtyFlags&7){let e=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:n,notifyErrorHandler:o}of this.allViews)Tae(n,o,e,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:e})=>bS(e))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(e){let n=e;this._views.push(n),n.attachToAppRef(this)}detachView(e){let n=e;R2(this._views,n),n.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(Ry,[]).forEach(o=>o(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>R2(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new si(406,!1);let e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function R2(t,i){let e=t.indexOf(i);e>-1&&t.splice(e,1)}function Tae(t,i,e,n){if(!e&&!bS(t))return;n7(t,i,e&&!n?0:1)}function un(t,i,e,n){let o=qn(),r=Qg();if(Jc(o,r,i)){let g=Yo(),w=rx();Gne(w,o,t,i,e,n)}return un}function vO(t,i,e,n){return Jc(t,Qg(),e)?i+Ug(e)+n:vc}function Dae(t,i,e,n,o,r){let g=Tte(),w=iS(t,g,e,o);return Rk(2),w?i+Ug(e)+n+Ug(o)+r:vc}function C2(t,i){return t<<17|i<<2}function Xg(t){return t>>17&32767}function Mae(t){return(t&2)==2}function Iae(t,i){return t&131071|i<<17}function K3(t){return t|2}function vy(t){return(t&131068)>>2}function GR(t,i){return t&-131069|i<<2}function Aae(t){return(t&1)===1}function X3(t){return t|1}function Rae(t,i,e,n,o,r){let g=r?i.classBindings:i.styleBindings,w=Xg(g),T=vy(g);t[n]=e;let k=!1,N;if(Array.isArray(e)){let V=e;N=V[1],(N===null||ix(V,N)>0)&&(k=!0)}else N=e;if(o)if(T!==0){let q=Xg(t[w+1]);t[n+1]=C2(q,w),q!==0&&(t[q+1]=GR(t[q+1],n)),t[w+1]=Iae(t[w+1],n)}else t[n+1]=C2(w,0),w!==0&&(t[w+1]=GR(t[w+1],n)),w=n;else t[n+1]=C2(T,0),w===0?w=n:t[T+1]=GR(t[T+1],n),T=n;k&&(t[n+1]=K3(t[n+1])),kB(t,N,n,!0),kB(t,N,n,!1),kae(i,N,t,n,r),g=C2(w,T),r?i.classBindings=g:i.styleBindings=g}function kae(t,i,e,n,o){let r=o?t.residualClasses:t.residualStyles;r!=null&&typeof i=="string"&&ix(r,i)>=0&&(e[n+1]=X3(e[n+1]))}function kB(t,i,e,n){let o=t[e+1],r=i===null,g=n?Xg(o):vy(o),w=!1;for(;g!==0&&(w===!1||r);){let T=t[g],k=t[g+1];Oae(T,i)&&(w=!0,t[g+1]=n?X3(k):K3(k)),g=n?Xg(k):vy(k)}w&&(t[e+1]=n?K3(o):X3(o))}function Oae(t,i){return t===null||i==null||(Array.isArray(t)?t[1]:t)===i?!0:Array.isArray(t)&&typeof i=="string"?ix(t,i)>=0:!1}var Dd={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Pae(t){return t.substring(Dd.key,Dd.keyEnd)}function Nae(t){return Lae(t),q7(t,$7(t,0,Dd.textEnd))}function q7(t,i){let e=Dd.textEnd;return e===i?-1:(i=Dd.keyEnd=Fae(t,Dd.key=i,e),$7(t,i,e))}function Lae(t){Dd.key=0,Dd.keyEnd=0,Dd.value=0,Dd.valueEnd=0,Dd.textEnd=t.length}function $7(t,i,e){for(;i<e&&t.charCodeAt(i)<=32;)i++;return i}function Fae(t,i,e){for(;i<e&&t.charCodeAt(i)>32;)i++;return i}function Xe(t,i,e){let n=qn(),o=Qg();if(Jc(n,o,i)){let r=Yo(),g=rx();RS(r,g,n,t,i,n[_o],e,!1)}return Xe}function Q3(t,i,e,n,o){iO(i,t,e,o?"class":"style",n)}function Pu(t,i,e){return W7(t,i,e,!1),Pu}function Ji(t,i){return W7(t,i,null,!0),Ji}function ql(t){Z7(Hae,G7,t,!0)}function G7(t,i){for(let e=Nae(i);e>=0;e=q7(i,e))fS(t,Pae(i),!0)}function W7(t,i,e,n){let o=qn(),r=Yo(),g=Rk(2);if(r.firstUpdatePass&&K7(r,t,g,n),i!==vc&&Jc(o,g,i)){let w=r.data[Mp()];X7(r,w,o,o[_o],t,o[g+1]=$ae(i,e),n,g)}}function Z7(t,i,e,n){let o=Yo(),r=Rk(2);o.firstUpdatePass&&K7(o,null,r,n);let g=qn();if(e!==vc&&Jc(g,r,e)){let w=o.data[Mp()];if(Q7(w,n)&&!Y7(o,r)){let T=n?w.classesWithoutHost:w.stylesWithoutHost;T!==null&&(e=JR(T,e||"")),Q3(o,w,g,e,n)}else qae(o,w,g,g[_o],g[r+1],g[r+1]=Uae(t,i,e),n,r)}}function Y7(t,i){return i>=t.expandoStartIndex}function K7(t,i,e,n){let o=t.data;if(o[e+1]===null){let r=o[Mp()],g=Y7(t,e);Q7(r,n)&&i===null&&!g&&(i=!1),i=zae(o,r,i,n),Rae(o,r,i,e,g,n)}}function zae(t,i,e,n){let o=Rte(t),r=n?i.residualClasses:i.residualStyles;if(o===null)(n?i.classBindings:i.styleBindings)===0&&(e=WR(null,t,i,e,n),e=ex(e,i.attrs,n),r=null);else{let g=i.directiveStylingLast;if(g===-1||t[g]!==o)if(e=WR(o,t,i,e,n),r===null){let T=Bae(t,i,n);T!==void 0&&Array.isArray(T)&&(T=WR(null,t,i,T[1],n),T=ex(T,i.attrs,n),Vae(t,i,n,T))}else r=jae(t,i,n)}return r!==void 0&&(n?i.residualClasses=r:i.residualStyles=r),e}function Bae(t,i,e){let n=e?i.classBindings:i.styleBindings;if(vy(n)!==0)return t[Xg(n)]}function Vae(t,i,e,n){let o=e?i.classBindings:i.styleBindings;t[Xg(o)]=n}function jae(t,i,e){let n,o=i.directiveEnd;for(let r=1+i.directiveStylingLast;r<o;r++){let g=t[r].hostAttrs;n=ex(n,g,e)}return ex(n,i.attrs,e)}function WR(t,i,e,n,o){let r=null,g=e.directiveEnd,w=e.directiveStylingLast;for(w===-1?w=e.directiveStart:w++;w<g&&(r=i[w],n=ex(n,r.hostAttrs,o),r!==t);)w++;return t!==null&&(e.directiveStylingLast=w),n}function ex(t,i,e){let n=e?1:2,o=-1;if(i!==null)for(let r=0;r<i.length;r++){let g=i[r];typeof g=="number"?o=g:o===n&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),fS(t,g,e?!0:i[++r]))}return t===void 0?null:t}function Uae(t,i,e){if(e==null||e==="")return fl;let n=[],o=kd(e);if(Array.isArray(o))for(let r=0;r<o.length;r++)t(n,o[r],!0);else if(typeof o=="object")for(let r in o)o.hasOwnProperty(r)&&t(n,r,o[r]);else typeof o=="string"&&i(n,o);return n}function Hae(t,i,e){let n=String(i);n!==""&&!n.includes(" ")&&fS(t,n,e)}function qae(t,i,e,n,o,r,g,w){o===vc&&(o=fl);let T=0,k=0,N=0<o.length?o[0]:null,V=0<r.length?r[0]:null;for(;N!==null||V!==null;){let q=T<o.length?o[T+1]:void 0,Z=k<r.length?r[k+1]:void 0,X=null,te;N===V?(T+=2,k+=2,q!==Z&&(X=V,te=Z)):V===null||N!==null&&N<V?(T+=2,X=N):(k+=2,X=V,te=Z),X!==null&&X7(t,i,e,n,X,te,g,w),N=T<o.length?o[T]:null,V=k<r.length?r[k]:null}}function X7(t,i,e,n,o,r,g,w){if(!(i.type&3))return;let T=t.data,k=T[w+1],N=Aae(k)?OB(T,i,e,o,vy(k),g):void 0;if(!rS(N)){rS(r)||Mae(k)&&(r=OB(T,null,e,o,w,g));let V=bV(Mp(),e);ure(n,g,V,o,r)}}function OB(t,i,e,n,o,r){let g=i===null,w;for(;o>0;){let T=t[o],k=Array.isArray(T),N=k?T[1]:T,V=N===null,q=e[o+1];q===vc&&(q=V?fl:void 0);let Z=V?PR(q,n):N===n?q:void 0;if(k&&!rS(Z)&&(Z=PR(T,n)),rS(Z)&&(w=Z,g))return w;let X=t[o+1];o=g?Xg(X):vy(X)}if(i!==null){let T=r?i.residualClasses:i.residualStyles;T!=null&&(w=PR(T,n))}return w}function rS(t){return t!==void 0}function $ae(t,i){return t==null||t===""||(typeof i=="string"?t=t+i:typeof t=="object"&&(t=gc(kd(t)))),t}function Q7(t,i){return(t.flags&(i?8:16))!==0}function J7(t,i,e){let n=qn(),o=vO(n,t,i,e);Z7(fS,G7,o,!0)}var J3=class{destroy(i){}updateValue(i,e){}swap(i,e){let n=Math.min(i,e),o=Math.max(i,e),r=this.detach(o);if(o-n>1){let g=this.detach(n);this.attach(n,r),this.attach(o,g)}else this.attach(n,r)}move(i,e){this.attach(e,this.detach(i))}};function ZR(t,i,e,n,o){return t===e&&Object.is(i,n)?1:Object.is(o(t,i),o(e,n))?-1:0}function Gae(t,i,e){let n,o,r=0,g=t.length-1,w=void 0;if(Array.isArray(i)){let T=i.length-1;for(;r<=g&&r<=T;){let k=t.at(r),N=i[r],V=ZR(r,k,r,N,e);if(V!==0){V<0&&t.updateValue(r,N),r++;continue}let q=t.at(g),Z=i[T],X=ZR(g,q,T,Z,e);if(X!==0){X<0&&t.updateValue(g,Z),g--,T--;continue}let te=e(r,k),De=e(g,q),_e=e(r,N);if(Object.is(_e,De)){let he=e(T,Z);Object.is(he,te)?(t.swap(r,g),t.updateValue(g,Z),T--,g--):t.move(g,r),t.updateValue(r,N),r++;continue}if(n??=new oS,o??=NB(t,r,g,e),ek(t,n,r,_e))t.updateValue(r,N),r++,g++;else if(o.has(_e))n.set(te,t.detach(r)),g--;else{let he=t.create(r,i[r]);t.attach(r,he),r++,g++}}for(;r<=T;)PB(t,n,e,r,i[r]),r++}else if(i!=null){let T=i[Symbol.iterator](),k=T.next();for(;!k.done&&r<=g;){let N=t.at(r),V=k.value,q=ZR(r,N,r,V,e);if(q!==0)q<0&&t.updateValue(r,V),r++,k=T.next();else{n??=new oS,o??=NB(t,r,g,e);let Z=e(r,V);if(ek(t,n,r,Z))t.updateValue(r,V),r++,g++,k=T.next();else if(!o.has(Z))t.attach(r,t.create(r,V)),r++,g++,k=T.next();else{let X=e(r,N);n.set(X,t.detach(r)),g--}}}for(;!k.done;)PB(t,n,e,t.length,k.value),k=T.next()}for(;r<=g;)t.destroy(t.detach(g--));n?.forEach(T=>{t.destroy(T)})}function ek(t,i,e,n){return i!==void 0&&i.has(n)?(t.attach(e,i.get(n)),i.delete(n),!0):!1}function PB(t,i,e,n,o){if(ek(t,i,n,e(n,o)))t.updateValue(n,o);else{let r=t.create(n,o);t.attach(n,r)}}function NB(t,i,e,n){let o=new Set;for(let r=i;r<=e;r++)o.add(n(r,t.at(r)));return o}var oS=class{kvMap=new Map;_vMap=void 0;has(i){return this.kvMap.has(i)}delete(i){if(!this.has(i))return!1;let e=this.kvMap.get(i);return this._vMap!==void 0&&this._vMap.has(e)?(this.kvMap.set(i,this._vMap.get(e)),this._vMap.delete(e)):this.kvMap.delete(i),!0}get(i){return this.kvMap.get(i)}set(i,e){if(this.kvMap.has(i)){let n=this.kvMap.get(i);this._vMap===void 0&&(this._vMap=new Map);let o=this._vMap;for(;o.has(n);)n=o.get(n);o.set(n,e)}else this.kvMap.set(i,e)}forEach(i){for(let[e,n]of this.kvMap)if(i(n,e),this._vMap!==void 0){let o=this._vMap;for(;o.has(n);)n=o.get(n),i(n,e)}}};function zn(t,i){yc("NgControlFlow");let e=qn(),n=Qg(),o=e[n]!==vc?e[n]:-1,r=o!==-1?aS(e,qr+o):void 0,g=0;if(Jc(e,n,t)){let w=Mr(null);try{if(r!==void 0&&c7(r,g),t!==-1){let T=qr+t,k=aS(e,T),N=rk(e[Ln],T),V=yy(k,N.tView.ssrId),q=lx(e,N,i,{dehydratedView:V});cx(k,q,g,_y(N,V))}}finally{Mr(w)}}else if(r!==void 0){let w=l7(r,g);w!==void 0&&(w[Ya]=i)}}var tk=class{lContainer;$implicit;$index;constructor(i,e,n){this.lContainer=i,this.$implicit=e,this.$index=n}get $count(){return this.lContainer.length-Xs}};function ej(t,i){return i}var ik=class{hasEmptyBlock;trackByFn;liveCollection;constructor(i,e,n){this.hasEmptyBlock=i,this.trackByFn=e,this.liveCollection=n}};function ky(t,i,e,n,o,r,g,w,T,k,N,V,q){yc("NgControlFlow");let Z=qn(),X=Yo(),te=T!==void 0,De=qn(),_e=w?g.bind(De[ml][Ya]):g,he=new ik(te,_e);De[qr+t]=he,nS(Z,X,t+1,i,e,n,o,Gf(X.consts,r)),te&&nS(Z,X,t+2,T,k,N,V,Gf(X.consts,q))}var nk=class extends J3{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(i,e,n){super(),this.lContainer=i,this.hostLView=e,this.templateTNode=n}get length(){return this.lContainer.length-Xs}at(i){return this.getLView(i)[Ya].$implicit}attach(i,e){let n=e[Id];this.needsIndexUpdate||=i!==this.length,cx(this.lContainer,e,i,_y(this.templateTNode,n))}detach(i){return this.needsIndexUpdate||=i!==this.length-1,Wae(this.lContainer,i)}create(i,e){let n=yy(this.lContainer,this.templateTNode.tView.ssrId),o=lx(this.hostLView,this.templateTNode,new tk(this.lContainer,e,i),{dehydratedView:n});return this.operationsCounter?.recordCreate(),o}destroy(i){kS(i[Ln],i),this.operationsCounter?.recordDestroy()}updateValue(i,e){this.getLView(i)[Ya].$implicit=e}reset(){this.needsIndexUpdate=!1,this.operationsCounter?.reset()}updateIndexes(){if(this.needsIndexUpdate)for(let i=0;i<this.length;i++)this.getLView(i)[Ya].$index=i}getLView(i){return Zae(this.lContainer,i)}};function Oy(t){let i=Mr(null),e=Mp();try{let n=qn(),o=n[Ln],r=n[e],g=e+1,w=aS(n,g);if(r.liveCollection===void 0){let k=rk(o,g);r.liveCollection=new nk(w,n,k)}else r.liveCollection.reset();let T=r.liveCollection;if(Gae(T,t,r.trackByFn),T.updateIndexes(),r.hasEmptyBlock){let k=Qg(),N=T.length===0;if(Jc(n,k,N)){let V=e+2,q=aS(n,V);if(N){let Z=rk(o,V),X=yy(q,Z.tView.ssrId),te=lx(n,Z,void 0,{dehydratedView:X});cx(q,te,0,_y(Z,X))}else c7(q,0)}}}finally{Mr(i)}}function aS(t,i){return t[i]}function Wae(t,i){return X1(t,i)}function Zae(t,i){return l7(t,i)}function rk(t,i){return Ek(t,i)}function ae(t,i,e,n){let o=qn(),r=Yo(),g=qr+t,w=o[_o],T=r.firstCreatePass?_7(g,r,o,i,tO,Mk(),e,n):r.data[g],k=tj(r,o,T,w,i,t);o[g]=k;let N=vS(T);return Xf(T,!0),H9(w,k,T),!tm(T)&&wS()&&OS(r,o,k,T),(yte()===0||N)&&Dy(k,o),vte(),N&&(AS(r,o,T),Zk(r,T,o)),n!==null&&eO(o,T),ae}function se(){let t=_l();Ik()?Ak():(t=t.parent,Xf(t,!1));let i=t;xte(i)&&Ete(),bte();let e=Yo();return e.firstCreatePass&&y7(e,i),i.classesWithoutHost!=null&&zte(i)&&Q3(e,i,qn(),i.classesWithoutHost,!0),i.stylesWithoutHost!=null&&Bte(i)&&Q3(e,i,qn(),i.stylesWithoutHost,!1),se}function jt(t,i,e,n){return ae(t,i,e,n),se(),jt}var tj=(t,i,e,n,o,r)=>(Qf(!0),Kk(n,o,RV()));function Yae(t,i,e,n,o,r){let g=i[Id],w=!g||Ey()||tm(e)||ax(g,r);if(Qf(w),w)return Kk(n,o,RV());let T=LS(g,t,i,e);return v9(g,r)&&TS(g,r,T.nextSibling),g&&(Bk(e)||e9(T))&&Kf(e)&&(wte(e),U9(T)),T}function Kae(){tj=Yae}function Xae(t,i,e,n,o){let r=i.consts,g=Gf(r,n),w=Iy(i,t,8,"ng-container",g);g!==null&&j3(w,g,!0);let T=Gf(r,o);return Mk()&&uO(i,e,w,T,tO),w.mergedAttrs=gy(w.mergedAttrs,w.attrs),i.queries!==null&&i.queries.elementStart(i,w),w}function Xn(t,i,e){let n=qn(),o=Yo(),r=t+qr,g=o.firstCreatePass?Xae(r,o,n,i,e):o.data[r];Xf(g,!0);let w=ij(o,n,g,t);return n[r]=w,wS()&&OS(o,n,w,g),Dy(w,n),vS(g)&&(AS(o,n,g),Zk(o,g,n)),e!=null&&eO(n,g),Xn}function Qn(){let t=_l(),i=Yo();return Ik()?Ak():(t=t.parent,Xf(t,!1)),i.firstCreatePass&&(Nk(i,t),wk(t)&&i.queries.elementEnd(t)),Qn}function ys(t,i,e){return Xn(t,i,e),Qn(),ys}var ij=(t,i,e,n)=>(Qf(!0),B9(i[_o],""));function Qae(t,i,e,n){let o,r=i[Id],g=!r||Ey()||ax(r,n)||tm(e);if(Qf(g),g)return B9(i[_o],"");let w=LS(r,t,i,e),T=Hie(r,n);return TS(r,n,w),o=FS(T,w),o}function Jae(){ij=Qae}function zi(){return qn()}function vs(t,i,e){let n=qn(),o=Qg();if(Jc(n,o,i)){let r=Yo(),g=rx();RS(r,g,n,t,i,n[_o],e,!0)}return vs}var Fg=void 0;function ese(t){let i=Math.floor(Math.abs(t)),e=t.toString().replace(/^[^.]*\.?/,"").length;return i===1&&e===0?1:5}var tse=["en",[["a","p"],["AM","PM"],Fg],[["AM","PM"],Fg,Fg],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Fg,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Fg,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Fg,"{1} 'at' {0}",Fg],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",ese],YR={};function Nu(t){let i=ise(t),e=LB(i);if(e)return e;let n=i.split("-")[0];if(e=LB(n),e)return e;if(n==="en")return tse;throw new si(701,!1)}function LB(t){return t in YR||(YR[t]=Os.ng&&Os.ng.common&&Os.ng.common.locales&&Os.ng.common.locales[t]),YR[t]}var za=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}(za||{});function ise(t){return t.toLowerCase().replace(/_/g,"-")}var sS="en-US";var nse=sS;function rse(t){typeof t=="string"&&(nse=t.toLowerCase().replace(/_/g,"-"))}function FB(t,i,e){return function n(o){if(o===Function)return e;let r=Kf(t)?Ah(t.index,i):i;cO(r,5);let g=i[Ya],w=zB(i,g,e,o),T=n.__ngNextListenerFn__;for(;T;)w=zB(i,g,T,o)&&w,T=T.__ngNextListenerFn__;return w}}function zB(t,i,e,n){let o=Mr(null);try{return xo(6,i,e),e(n)!==!1}catch(r){return ose(t,r),!1}finally{xo(7,i,e),Mr(o)}}function ose(t,i){let e=t[py],n=e?e.get(Hl,null):null;n&&n.handleError(i)}function BB(t,i,e,n,o,r){let g=i[e],w=i[Ln],k=w.data[e].outputs[n],N=g[k],V=w.firstCreatePass?Dk(w):null,q=Tk(i),Z=N.subscribe(r),X=q.length;q.push(r,Z),V&&V.push(o,t.index,X,-(X+1))}var ase=(t,i,e)=>{};function Nt(t,i,e,n){let o=qn(),r=Yo(),g=_l();return nj(r,o,o[_o],g,t,i,n),Nt}function sse(t,i,e,n){let o=t.cleanup;if(o!=null)for(let r=0;r<o.length-1;r+=2){let g=o[r];if(g===e&&o[r+1]===n){let w=i[j1],T=o[r+2];return w.length>T?w[T]:null}typeof g=="string"&&(r+=2)}return null}function nj(t,i,e,n,o,r,g){let w=vS(n),k=t.firstCreatePass?Dk(t):null,N=Tk(i),V=!0;if(n.type&3||g){let q=Rd(n,i),Z=g?g(q):q,X=N.length,te=g?_e=>g(Wo(_e[n.index])):n.index,De=null;if(!g&&w&&(De=sse(t,i,o,n.index)),De!==null){let _e=De.__ngLastListenerFn__||De;_e.__ngNextListenerFn__=r,De.__ngLastListenerFn__=r,V=!1}else{r=FB(n,i,r),ase(Z,o,r);let _e=e.listen(Z,o,r);N.push(r,_e),k&&k.push(o,te,X,X+1)}}else r=FB(n,i,r);if(V){let q=n.outputs?.[o],Z=n.hostDirectiveOutputs?.[o];if(Z&&Z.length)for(let X=0;X<Z.length;X+=2){let te=Z[X],De=Z[X+1];BB(n,i,te,De,o,r)}if(q&&q.length)for(let X of q)BB(n,i,X,o,o,r)}}function zt(t=1){return Ote(t)}function lse(t,i){let e=null,n=Cne(t);for(let o=0;o<i.length;o++){let r=i[o];if(r==="*"){e=o;continue}if(n===null?F9(t,r,!0):Dne(n,r))return o}return e}function Qr(t){let i=qn()[ml][_c];if(!i.projection){let e=t?t.length:1,n=i.projection=Wee(e,null),o=n.slice(),r=i.child;for(;r!==null;){if(r.type!==128){let g=t?lse(r,t):0;g!==null&&(o[g]?o[g].projectionNext=r:n[g]=r,o[g]=r)}r=r.next}}}function On(t,i=0,e,n,o,r){let g=qn(),w=Yo(),T=n?t+1:null;T!==null&&nS(g,w,T,n,o,r,null,e);let k=Iy(w,qr+t,16,null,e||null);k.projection===null&&(k.projection=i),Ak();let V=!g[Id]||Ey();g[ml][_c].projection[k.projection]===null&&T!==null?cse(g,w,T):V&&!tm(k)&&lre(w,g,k)}function cse(t,i,e){let n=qr+e,o=i.data[n],r=t[n],g=yy(r,o.tView.ssrId),w=lx(t,o,void 0,{dehydratedView:g});cx(r,w,0,_y(o,g))}function bO(t,i,e){return rj(t,"",i,"",e),bO}function rj(t,i,e,n,o){let r=qn(),g=vO(r,i,e,n);if(g!==vc){let w=Yo(),T=rx();RS(w,T,r,t,g,r[_o],o,!1)}return rj}function ao(t,i,e,n){S7(t,i,e,n)}function pr(t,i,e){Hoe(t,i,e)}function sn(t){let i=qn(),e=Yo(),n=kk();xS(n+1);let o=pO(e,n);if(t.dirty&&pte(i)===((o.metadata.flags&2)===2)){if(o.matches===null)t.reset([]);else{let r=D7(i,n);t.reset(r,QV),t.notifyOnChanges()}return!0}return!1}function ln(){return hO(qn(),kk())}function oj(t,i,e,n,o){Zoe(i,S7(t,e,n,o))}function aj(t=1){xS(kk()+t)}function sj(t,i,e,n){e>=t.data.length&&(t.data[e]=null,t.blueprint[e]=null),i[e]=n}function Ca(t){let i=Ste();return Ck(i,qr+t)}function Oe(t,i=""){let e=qn(),n=Yo(),o=t+qr,r=n.firstCreatePass?Iy(n,o,1,i,null):n.data[o],g=lj(n,e,r,i,t);e[o]=g,wS()&&OS(n,e,g,r),Xf(r,!1)}var lj=(t,i,e,n,o)=>(Qf(!0),z9(i[_o],n));function use(t,i,e,n,o){let r=i[Id],g=!r||Ey()||tm(e)||ax(r,o);return Qf(g),g?z9(i[_o],n):LS(r,t,i,e)}function dse(){lj=use}function En(t){return an("",t,""),En}function an(t,i,e){let n=qn(),o=vO(n,t,i,e);return o!==vc&&cj(n,Mp(),o),an}function kh(t,i,e,n,o){let r=qn(),g=Dae(r,t,i,e,n,o);return g!==vc&&cj(r,Mp(),g),kh}function cj(t,i,e){let n=bV(i,t);Rne(t[_o],n,e)}function Rp(t,i,e){JV(i)&&(i=i());let n=qn(),o=Qg();if(Jc(n,o,i)){let r=Yo(),g=rx();RS(r,g,n,t,i,n[_o],e,!1)}return Rp}function nm(t,i){let e=JV(t);return e&&t.set(i),e}function kp(t,i){let e=qn(),n=Yo(),o=_l();return nj(n,e,e[_o],o,t,i),kp}var hse={};function xO(t){let i=Yo(),e=qn(),n=t+qr,o=Iy(i,n,128,null,null);return Xf(o,!1),sj(i,e,n,hse),xO}function pse(t,i,e){let n=Yo();if(n.firstCreatePass){let o=Ih(t);ok(e,n.data,n.blueprint,o,!0),ok(i,n.data,n.blueprint,o,!1)}}function ok(t,i,e,n,o){if(t=Ks(t),Array.isArray(t))for(let r=0;r<t.length;r++)ok(t[r],i,e,n,o);else{let r=Yo(),g=qn(),w=_l(),T=hy(t)?t:Ks(t.provide),k=uV(t),N=w.providerIndexes&1048575,V=w.directiveStart,q=w.providerIndexes>>20;if(hy(t)||!t.multi){let Z=new Yg(k,o,Ci),X=XR(T,i,o?N:N+q,V);X===-1?(d3(U2(w,g),r,T),KR(r,t,i.length),i.push(T),w.directiveStart++,w.directiveEnd++,o&&(w.providerIndexes+=1048576),e.push(Z),g.push(Z)):(e[X]=Z,g[X]=Z)}else{let Z=XR(T,i,N+q,V),X=XR(T,i,N,N+q),te=Z>=0&&e[Z],De=X>=0&&e[X];if(o&&!De||!o&&!te){d3(U2(w,g),r,T);let _e=gse(o?mse:fse,e.length,o,n,k);!o&&De&&(e[X].providerFactory=_e),KR(r,t,i.length,0),i.push(T),w.directiveStart++,w.directiveEnd++,o&&(w.providerIndexes+=1048576),e.push(_e),g.push(_e)}else{let _e=uj(e[o?X:Z],k,!o&&n);KR(r,t,Z>-1?Z:X,_e)}!o&&n&&De&&e[X].componentProviders++}}}function KR(t,i,e,n){let o=hy(i),r=ete(i);if(o||r){let T=(r?Ks(i.useClass):i).prototype.ngOnDestroy;if(T){let k=t.destroyHooks||(t.destroyHooks=[]);if(!o&&i.multi){let N=k.indexOf(e);N===-1?k.push(e,[n,T]):k[N+1].push(n,T)}else k.push(e,T)}}}function uj(t,i,e){return e&&t.componentProviders++,t.multi.push(i)-1}function XR(t,i,e,n){for(let o=e;o<n;o++)if(i[o]===t)return o;return-1}function fse(t,i,e,n){return ak(this.multi,[])}function mse(t,i,e,n){let o=this.multi,r;if(this.providerFactory){let g=this.providerFactory.componentProviders,w=q1(e,e[Ln],this.providerFactory.index,n);r=w.slice(0,g),ak(o,r);for(let T=g;T<w.length;T++)r.push(w[T])}else r=[],ak(o,r);return r}function ak(t,i){for(let e=0;e<t.length;e++){let n=t[e];i.push(n())}return i}function gse(t,i,e,n,o){let r=new Yg(t,e,Ci);return r.multi=[],r.index=i,r.componentProviders=0,uj(r,o,n&&!e),r}function fr(t,i=[]){return e=>{e.providersResolver=(n,o)=>pse(n,o?o(t):t,i)}}function Py(t,i,e){let n=Cy()+t,o=qn();return o[n]===vc?dx(o,n,e?i.call(e):i()):N7(o,n)}function dj(t,i,e,n,o){return hj(qn(),Cy(),t,i,e,n,o)}function jS(t,i,e,n,o,r,g){return yse(qn(),Cy(),t,i,e,n,o,r,g)}function wO(t,i,e,n,o,r,g,w){let T=Cy()+t,k=qn(),N=L7(k,T,e,n,o,r);return Jc(k,T+4,g)||N?dx(k,T+5,w?i.call(w,e,n,o,r,g):i(e,n,o,r,g)):N7(k,T+5)}function EO(t,i){let e=t[i];return e===vc?void 0:e}function _se(t,i,e,n,o,r){let g=i+e;return Jc(t,g,o)?dx(t,g+1,r?n.call(r,o):n(o)):EO(t,g+1)}function hj(t,i,e,n,o,r,g){let w=i+e;return iS(t,w,o,r)?dx(t,w+2,g?n.call(g,o,r):n(o,r)):EO(t,w+2)}function yse(t,i,e,n,o,r,g,w,T){let k=i+e;return L7(t,k,o,r,g,w)?dx(t,k+4,T?n.call(T,o,r,g,w):n(o,r,g,w)):EO(t,k+4)}function bc(t,i){let e=Yo(),n,o=t+qr;e.firstCreatePass?(n=vse(i,e.pipeRegistry),e.data[o]=n,n.onDestroy&&(e.destroyHooks??=[]).push(o,n.onDestroy)):n=e.data[o];let r=n.factory||(n.factory=Hg(n.type,!0)),g,w=mc(Ci);try{let T=j2(!1),k=r();return j2(T),sj(e,qn(),o,k),k}finally{mc(w)}}function vse(t,i){if(i)for(let e=i.length-1;e>=0;e--){let n=i[e];if(t===n.name)return n}}function fx(t,i,e){let n=t+qr,o=qn(),r=Ck(o,n);return pj(o,n)?_se(o,Cy(),i,r.transform,e,r):r.transform(e)}function Oh(t,i,e,n){let o=t+qr,r=qn(),g=Ck(r,o);return pj(r,o)?hj(r,Cy(),i,g.transform,e,n,g):g.transform(e,n)}function pj(t,i){return t[Ln].data[i].pure}function rm(t,i){return NS(t,i)}var S2=null;function bse(t){S2!==null&&(t.defaultEncapsulation!==S2.defaultEncapsulation||t.preserveWhitespaces!==S2.preserveWhitespaces)||(S2=t)}var xse=[];var wse=new WeakMap,Ese=new WeakMap;function Cse(){wse=new WeakMap,Ese=new WeakMap,xse.length=0,cae.clear()}var Yf=class{full;major;minor;patch;constructor(i){this.full=i;let e=i.split(".");this.major=e[0],this.minor=e[1],this.patch=e.slice(2).join(".")}},CO=new Yf("19.2.8"),sk=class{ngModuleFactory;componentFactories;constructor(i,e){this.ngModuleFactory=i,this.componentFactories=e}},US=(()=>{class t{compileModuleSync(e){return new eS(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){let n=this.compileModuleSync(e),o=oV(e),r=N9(o.declarations).reduce((g,w)=>{let T=xp(w);return T&&g.push(new Kg(T)),g},[]);return new sk(n,r)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Sse=new Ot("");function Tse(t,i,e){let n=new eS(e);return Promise.resolve(n)}function VB(t){for(let i=t.length-1;i>=0;i--)if(t[i]!==void 0)return t[i]}var Dse=(()=>{class t{zone=J(Oi);changeDetectionScheduler=J(Wf);applicationRef=J(ms);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Mse=new Ot("",{factory:()=>!1});function SO({ngZoneFactory:t,ignoreChangesOutsideZone:i,scheduleInRootZone:e}){return t??=()=>new Oi(ji(It({},TO()),{scheduleInRootZone:e})),[{provide:Oi,useFactory:t},{provide:qg,multi:!0,useFactory:()=>{let n=J(Dse,{optional:!0});return()=>n.initialize()}},{provide:qg,multi:!0,useFactory:()=>{let n=J(Ise);return()=>{n.initialize()}}},i===!0?{provide:WV,useValue:!0}:[],{provide:ZV,useValue:e??GV}]}function fj(t){let i=t?.ignoreChangesOutsideZone,e=t?.scheduleInRootZone,n=SO({ngZoneFactory:()=>{let o=TO(t);return o.scheduleInRootZone=e,o.shouldCoalesceEventChangeDetection&&yc("NgZone_CoalesceEvent"),new Oi(o)},ignoreChangesOutsideZone:i,scheduleInRootZone:e});return eu([{provide:Mse,useValue:!0},{provide:CS,useValue:!1},n])}function TO(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var Ise=(()=>{class t{subscription=new nr;initialized=!1;zone=J(Oi);pendingTasks=J(Ip);initialize(){if(this.initialized)return;this.initialized=!0;let e=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(e=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Oi.assertNotInAngularZone(),queueMicrotask(()=>{e!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(e),e=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Oi.assertInAngularZone(),e??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var mj=(()=>{class t{appRef=J(ms);taskService=J(Ip);ngZone=J(Oi);zonelessEnabled=J(CS);tracing=J(My,{optional:!0});disableScheduling=J(WV,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new nr;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(q2):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(J(ZV,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof $2||!this.zoneIsDefined)}notify(e){if(!this.zonelessEnabled&&e===5)return;let n=!1;switch(e){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,n=!0;break}case 12:{this.appRef.dirtyFlags|=16,n=!0;break}case 13:{this.appRef.dirtyFlags|=2,n=!0;break}case 11:{n=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(n))return;let o=this.useMicrotaskScheduler?oB:YV;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>o(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>o(()=>this.tick()))}shouldScheduleTick(e){return!(this.disableScheduling&&!e||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(q2+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let e=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(n){throw this.taskService.remove(e),n}finally{this.cleanup()}this.useMicrotaskScheduler=!0,oB(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(e)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let e=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(e)}}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Ase(){return typeof $localize<"u"&&$localize.locale||sS}var om=new Ot("",{providedIn:"root",factory:()=>J(om,kr.Optional|kr.SkipSelf)||Ase()});var lS=new Ot(""),DO=new Ot("");function P1(t){return!t.moduleRef}function gj(t){let i=P1(t)?t.r3Injector:t.moduleRef.injector,e=i.get(Oi);return e.run(()=>{P1(t)?t.r3Injector.resolveInjectorInitializers():t.moduleRef.resolveInjectorInitializers();let n=i.get(Hl,null),o;if(e.runOutsideAngular(()=>{o=e.onError.subscribe({next:r=>{n.handleError(r)}})}),P1(t)){let r=()=>i.destroy(),g=t.platformInjector.get(lS);g.add(r),i.onDestroy(()=>{o.unsubscribe(),g.delete(r)})}else{let r=()=>t.moduleRef.destroy(),g=t.platformInjector.get(lS);g.add(r),t.moduleRef.onDestroy(()=>{R2(t.allPlatformModules,t.moduleRef),o.unsubscribe(),g.delete(r)})}return kse(n,e,()=>{let r=i.get(j7);return r.runInitializers(),r.donePromise.then(()=>{let g=i.get(om,sS);if(rse(g||sS),!i.get(DO,!0))return P1(t)?i.get(ms):(t.allPlatformModules.push(t.moduleRef),t.moduleRef);if(P1(t)){let T=i.get(ms);return t.rootComponent!==void 0&&T.bootstrap(t.rootComponent),T}else return Rse(t.moduleRef,t.allPlatformModules),t.moduleRef})})})}function Rse(t,i){let e=t.injector.get(ms);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(n=>e.bootstrap(n));else if(t.instance.ngDoBootstrap)t.instance.ngDoBootstrap(e);else throw new si(-403,!1);i.push(t)}function kse(t,i,e){try{let n=e();return im(n)?n.catch(o=>{throw i.runOutsideAngular(()=>t.handleError(o)),o}):n}catch(n){throw i.runOutsideAngular(()=>t.handleError(n)),n}}var _j=(()=>{class t{_injector;_modules=[];_destroyListeners=[];_destroyed=!1;constructor(e){this._injector=e}bootstrapModuleFactory(e,n){let o=n?.scheduleInRootZone,r=()=>oie(n?.ngZone,ji(It({},TO({eventCoalescing:n?.ngZoneEventCoalescing,runCoalescing:n?.ngZoneRunCoalescing})),{scheduleInRootZone:o})),g=n?.ignoreChangesOutsideZone,w=[SO({ngZoneFactory:r,ignoreChangesOutsideZone:g}),{provide:Wf,useExisting:mj}],T=nae(e.moduleType,this.injector,w);return gj({moduleRef:T,allPlatformModules:this._modules,platformInjector:this.injector})}bootstrapModule(e,n=[]){let o=H7({},n);return Tse(this.injector,o,e).then(r=>this.bootstrapModuleFactory(r,o))}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new si(404,!1);this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n());let e=this._injector.get(lS,null);e&&(e.forEach(n=>n()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static \u0275fac=function(n){return new(n||t)(bi(wn))};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})(),$f=null,HS=new Ot("");function Ose(t){if($f&&!$f.get(HS,!1))throw new si(400,!1);U7(),$f=t;let i=t.get(_j);return bj(t),i}function qS(t,i,e=[]){let n=`Platform: ${i}`,o=new Ot(n);return(r=[])=>{let g=vj();if(!g||g.injector.get(HS,!1)){let w=[...e,...r,{provide:o,useValue:!0}];t?t(w):Ose(yj(w,n))}return Pse(o)}}function yj(t=[],i){return wn.create({name:i,providers:[{provide:mS,useValue:"platform"},{provide:lS,useValue:new Set([()=>$f=null])},...t]})}function Pse(t){let i=vj();if(!i)throw new si(401,!1);return i}function vj(){return $f?.get(_j)??null}function Nse(t=[]){if($f)return $f;let i=yj(t);return $f=i,U7(),bj(i),i}function bj(t){let i=t.get(ox,null);gl(t,()=>{i?.forEach(e=>e())})}var vr=(()=>{class t{static __NG_ELEMENT_ID__=Lse}return t})();function Lse(t){return Fse(_l(),qn(),(t&16)===16)}function Fse(t,i,e){if(Kf(t)&&!e){let n=Ah(t.index,i);return new Q1(n,n)}else if(t.type&175){let n=i[ml];return new Q1(n,i)}return null}var lk=class{constructor(){}supports(i){return P7(i)}create(i){return new ck(i)}},zse=(t,i)=>i,ck=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(i){this._trackByFn=i||zse}forEachItem(i){let e;for(e=this._itHead;e!==null;e=e._next)i(e)}forEachOperation(i){let e=this._itHead,n=this._removalsHead,o=0,r=null;for(;e||n;){let g=!n||e&&e.currentIndex<jB(n,o,r)?e:n,w=jB(g,o,r),T=g.currentIndex;if(g===n)o--,n=n._nextRemoved;else if(e=e._next,g.previousIndex==null)o++;else{r||(r=[]);let k=w-o,N=T-o;if(k!=N){for(let q=0;q<k;q++){let Z=q<r.length?r[q]:r[q]=0,X=Z+q;N<=X&&X<k&&(r[q]=Z+1)}let V=g.previousIndex;r[V]=N-k}}w!==T&&i(g,w,T)}}forEachPreviousItem(i){let e;for(e=this._previousItHead;e!==null;e=e._nextPrevious)i(e)}forEachAddedItem(i){let e;for(e=this._additionsHead;e!==null;e=e._nextAdded)i(e)}forEachMovedItem(i){let e;for(e=this._movesHead;e!==null;e=e._nextMoved)i(e)}forEachRemovedItem(i){let e;for(e=this._removalsHead;e!==null;e=e._nextRemoved)i(e)}forEachIdentityChange(i){let e;for(e=this._identityChangesHead;e!==null;e=e._nextIdentityChange)i(e)}diff(i){if(i==null&&(i=[]),!P7(i))throw new si(900,!1);return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let e=this._itHead,n=!1,o,r,g;if(Array.isArray(i)){this.length=i.length;for(let w=0;w<this.length;w++)r=i[w],g=this._trackByFn(w,r),e===null||!Object.is(e.trackById,g)?(e=this._mismatch(e,r,g,w),n=!0):(n&&(e=this._verifyReinsertion(e,r,g,w)),Object.is(e.item,r)||this._addIdentityChange(e,r)),e=e._next}else o=0,yae(i,w=>{g=this._trackByFn(o,w),e===null||!Object.is(e.trackById,g)?(e=this._mismatch(e,w,g,o),n=!0):(n&&(e=this._verifyReinsertion(e,w,g,o)),Object.is(e.item,w)||this._addIdentityChange(e,w)),e=e._next,o++}),this.length=o;return this._truncate(e),this.collection=i,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let i;for(i=this._previousItHead=this._itHead;i!==null;i=i._next)i._nextPrevious=i._next;for(i=this._additionsHead;i!==null;i=i._nextAdded)i.previousIndex=i.currentIndex;for(this._additionsHead=this._additionsTail=null,i=this._movesHead;i!==null;i=i._nextMoved)i.previousIndex=i.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(i,e,n,o){let r;return i===null?r=this._itTail:(r=i._prev,this._remove(i)),i=this._unlinkedRecords===null?null:this._unlinkedRecords.get(n,null),i!==null?(Object.is(i.item,e)||this._addIdentityChange(i,e),this._reinsertAfter(i,r,o)):(i=this._linkedRecords===null?null:this._linkedRecords.get(n,o),i!==null?(Object.is(i.item,e)||this._addIdentityChange(i,e),this._moveAfter(i,r,o)):i=this._addAfter(new uk(e,n),r,o)),i}_verifyReinsertion(i,e,n,o){let r=this._unlinkedRecords===null?null:this._unlinkedRecords.get(n,null);return r!==null?i=this._reinsertAfter(r,i._prev,o):i.currentIndex!=o&&(i.currentIndex=o,this._addToMoves(i,o)),i}_truncate(i){for(;i!==null;){let e=i._next;this._addToRemovals(this._unlink(i)),i=e}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(i,e,n){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(i);let o=i._prevRemoved,r=i._nextRemoved;return o===null?this._removalsHead=r:o._nextRemoved=r,r===null?this._removalsTail=o:r._prevRemoved=o,this._insertAfter(i,e,n),this._addToMoves(i,n),i}_moveAfter(i,e,n){return this._unlink(i),this._insertAfter(i,e,n),this._addToMoves(i,n),i}_addAfter(i,e,n){return this._insertAfter(i,e,n),this._additionsTail===null?this._additionsTail=this._additionsHead=i:this._additionsTail=this._additionsTail._nextAdded=i,i}_insertAfter(i,e,n){let o=e===null?this._itHead:e._next;return i._next=o,i._prev=e,o===null?this._itTail=i:o._prev=i,e===null?this._itHead=i:e._next=i,this._linkedRecords===null&&(this._linkedRecords=new cS),this._linkedRecords.put(i),i.currentIndex=n,i}_remove(i){return this._addToRemovals(this._unlink(i))}_unlink(i){this._linkedRecords!==null&&this._linkedRecords.remove(i);let e=i._prev,n=i._next;return e===null?this._itHead=n:e._next=n,n===null?this._itTail=e:n._prev=e,i}_addToMoves(i,e){return i.previousIndex===e||(this._movesTail===null?this._movesTail=this._movesHead=i:this._movesTail=this._movesTail._nextMoved=i),i}_addToRemovals(i){return this._unlinkedRecords===null&&(this._unlinkedRecords=new cS),this._unlinkedRecords.put(i),i.currentIndex=null,i._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=i,i._prevRemoved=null):(i._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=i),i}_addIdentityChange(i,e){return i.item=e,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=i:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=i,i}},uk=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(i,e){this.item=i,this.trackById=e}},dk=class{_head=null;_tail=null;add(i){this._head===null?(this._head=this._tail=i,i._nextDup=null,i._prevDup=null):(this._tail._nextDup=i,i._prevDup=this._tail,i._nextDup=null,this._tail=i)}get(i,e){let n;for(n=this._head;n!==null;n=n._nextDup)if((e===null||e<=n.currentIndex)&&Object.is(n.trackById,i))return n;return null}remove(i){let e=i._prevDup,n=i._nextDup;return e===null?this._head=n:e._nextDup=n,n===null?this._tail=e:n._prevDup=e,this._head===null}},cS=class{map=new Map;put(i){let e=i.trackById,n=this.map.get(e);n||(n=new dk,this.map.set(e,n)),n.add(i)}get(i,e){let n=i,o=this.map.get(n);return o?o.get(i,e):null}remove(i){let e=i.trackById;return this.map.get(e).remove(i)&&this.map.delete(e),i}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function jB(t,i,e){let n=t.previousIndex;if(n===null)return n;let o=0;return e&&n<e.length&&(o=e[n]),n+i+o}function UB(){return new Ph([new lk])}var Ph=(()=>{class t{factories;static \u0275prov=Ft({token:t,providedIn:"root",factory:UB});constructor(e){this.factories=e}static create(e,n){if(n!=null){let o=n.factories.slice();e=e.concat(o)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>t.create(e,n||UB()),deps:[[t,new by,new Rh]]}}find(e){let n=this.factories.find(o=>o.supports(e));if(n!=null)return n;throw new si(901,!1)}}return t})();var MO=qS(null,"core",[]),xj=(()=>{class t{constructor(e){}static \u0275fac=function(n){return new(n||t)(bi(ms))};static \u0275mod=$i({type:t});static \u0275inj=qi({})}return t})();function wj(t){xo(8);try{let{rootComponent:i,appProviders:e,platformProviders:n}=t,o=Nse(n),r=[SO({}),{provide:Wf,useExisting:mj},...e||[]],g=new tS({providers:r,parent:o,debugName:"",runEnvironmentInitializers:!1});return gj({r3Injector:g.injector,platformInjector:o,rootComponent:i})}catch(i){return Promise.reject(i)}finally{xo(9)}}function Ej(){return[{provide:u9,useFactory:()=>{let i=!0;return i&&yc("NgEventReplay"),i}}]}function Bse(t,i,e){let n=new Map,o=i[j1],r=t.cleanup;if(!r||!o)return n;for(let g=0;g<r.length;){let w=r[g++],T=r[g++];if(typeof w!="string")continue;let k=w;if(!$z(k))continue;qz(k)?e.capture.add(k):e.regular.add(k);let N=Wo(i[T]);g++;let V=r[g++];(typeof V=="boolean"||V>=0)&&(n.has(N)?n.get(N).push(k):n.set(N,[k]))}return n}var hk=class{views=[];indexByContent=new Map;add(i){let e=JSON.stringify(i);if(!this.indexByContent.has(e)){let n=this.views.length;return this.views.push(i),this.indexByContent.set(e,n),n}return this.indexByContent.get(e)}getAll(){return this.views}},Vse=0;function Cj(t){return t.ssrId||(t.ssrId=`t${Vse++}`),t.ssrId}function Sj(t,i,e){let n=[];return K1(t,i,e,n),n.length}function jse(t){let i=[];return lO(t,i),i.length}function Tj(t,i,e){let n=t[fs];return n&&!n.hasAttribute(G1)?uS(n,t,null,i):null}function Dj(t,i,e){let n=vV(t[fs]),o=Tj(n,i);if(o===null)return;let r=Wo(n[fs]),g=t[Ps],w=uS(r,g,null,i),T=n[_o],k=`${o}|${w}`;T.setAttribute(r,z1,k)}function Mj(t,i){let e=t.injector,n=eoe(e),o=Uie(e),r=new hk,g=new Map,w=t._views,T=e.get(u9,wie),k={regular:new Set,capture:new Set},N=new Map;t.injector.get(Ou);for(let Z of w){let X=Bie(Z);if(X!==null){let te={serializedViewCollection:r,corruptedTextNodes:g,isI18nHydrationEnabled:n,isIncrementalHydrationEnabled:o,i18nChildren:new Map,eventTypesToReplay:k,shouldReplayEvents:T,deferBlocks:N};ku(X)?Dj(X,te):Tj(X,te),Gse(g,i)}}let V=r.getAll(),q=e.get(t0);if(q.set(g9,V),N.size>0){let Z={};for(let[X,te]of N.entries())Z[X]=te;q.set(Lie,Z)}return k}function Use(t,i,e,n,o){let r=[],g="";for(let w=Xs;w<t.length;w++){let T=t[w],k,N,V;if(my(T)&&(T=T[qr],ku(T))){N=jse(T)+1,Dj(T,o);let Z=vV(T[fs]);V={[v3]:Z[Ln].ssrId,[jg]:N}}if(!V){let Z=T[Ln];Z.type===1?(k=Z.ssrId,N=1):(k=Cj(Z),N=Sj(Z,T,Z.firstChild)),V={[v3]:k,[jg]:N};let X=!1;if(Aie(e[Ln],i)){let te=Mie(e,i),De=f9(e[Ln],i);if(o.isIncrementalHydrationEnabled&&De.hydrateTriggers!==null){let _e=`d${o.deferBlocks.size}`;De.hydrateTriggers.has(7)&&(X=!0);let he=[];lO(t,he);let Ce={[jg]:he.length,[dB]:te[pB]},Pe=Hse(De.hydrateTriggers);Pe.length>0&&(Ce[vie]=Pe),n!==null&&(Ce[yie]=n),o.deferBlocks.set(_e,Ce);let ye=Wo(t);ye!==void 0?ye.nodeType===Node.COMMENT_NODE&&HB(ye,_e):HB(ye,_e),X||Zse(De,he,_e,o),n=_e,V[l9]=_e}V[dB]=te[pB]}X||Object.assign(V,Ij(t[w],n,o))}let q=JSON.stringify(V);if(r.length>0&&q===g){let Z=r[r.length-1];Z[G2]??=1,Z[G2]++}else g=q,r.push(V)}return r}function Hse(t){let i=new Set([0,1,2,5]),e=[];for(let[n,o]of t)i.has(n)&&(o===null?e.push(n):e.push({trigger:n,delay:o.delay}));return e}function B1(t,i,e,n){let o=i.index-qr;t[b3]??={},t[b3][o]??=Xre(i,e,n)}function QR(t,i){let e=typeof i=="number"?i:i.index-qr;t[F1]??=[],t[F1].includes(e)||t[F1].push(e)}function Ij(t,i=null,e){let n={},o=t[Ln],r=toe(o,e),g=e.shouldReplayEvents?Bse(o,t,e.eventTypesToReplay):null;for(let w=qr;w<o.bindingStartIndex;w++){let T=o.data[w],k=w-qr,N=noe(t,w,e);if(N){n[uB]??={},n[uB][k]=N.caseQueue;for(let V of N.disconnectedNodes)QR(n,V);for(let V of N.disjointNodes){let q=o.data[V+qr];B1(n,q,t,r)}continue}if(PV(T)&&!tm(T)){if(J1(T,t)&&Wse(T)){QR(n,T);continue}if(Array.isArray(T.projection)){for(let V of T.projection)if(V)if(!Array.isArray(V))!pV(V)&&!Z1(V)&&(J1(V,t)?QR(n,V):B1(n,V,t,r));else throw Ire(Wo(t[w]))}if(qse(n,T,t,r),ku(t[w])){let V=T.tView;V!==null&&(n[y3]??={},n[y3][k]=Cj(V));let q=t[w][fs];if(Array.isArray(q)){let Z=Wo(q);Z.hasAttribute(G1)||uS(Z,q,i,e)}n[Y1]??={},n[Y1][k]=Use(t[w],T,t,i,e)}else if(Array.isArray(t[w])&&!Fte(T)){let V=Wo(t[w][fs]);V.hasAttribute(G1)||uS(V,t[w],i,e)}else if(T.type&8)n[_3]??={},n[_3][k]=Sj(o,t,T.child);else if(T.type&144){let V=T.next;for(;V!==null&&V.type&144;)V=V.next;V&&!Z1(V)&&B1(n,V,t,r)}else if(T.type&1){let V=Wo(t[w]);b9(e,V)}if(g&&T.type&2){let V=Wo(t[w]);g.has(V)&&m9(V,g.get(V),i)}}}return n}function qse(t,i,e,n){pV(i)||(i.projectionNext&&i.projectionNext!==i.next&&!Z1(i.projectionNext)&&B1(t,i.projectionNext,e,n),i.prev===null&&i.parent!==null&&J1(i.parent,e)&&!J1(i,e)&&B1(t,i,e,n))}function $se(t){let i=t[Ya];return i?.constructor?xp(i.constructor)?.encapsulation===Ad.ShadowDom:!1}function uS(t,i,e,n){let o=i[_o];if(lte(i)&&!Jre()||$se(i))return o.setAttribute(t,G1,""),null;{let r=Ij(i,e,n),g=n.serializedViewCollection.add(r);return o.setAttribute(t,z1,g.toString()),g}}function HB(t,i){t.textContent=`ngh=${i}`}function Gse(t,i){for(let[e,n]of t)e.after(i.createComment(n))}function Wse(t){let i=t;for(;i!=null;){if(Kf(i))return!0;i=i.parent}return!1}function Zse(t,i,e,n){let o=$ie(t.hydrateTriggers);for(let r of o)n.eventTypesToReplay.regular.add(r);if(o.length>0){let r=i.filter(g=>g.nodeType===Node.ELEMENT_NODE);for(let g of r)m9(g,o,e)}}var qB=!1;function Yse(){qB||(qB=!0,zie(),Kae(),dse(),Jae(),wae(),zoe(),doe(),Vne())}function Aj(){return eu([{provide:W2,useFactory:()=>{let i=!0;return i&&yc("NgHydration"),i}},{provide:qg,useValue:()=>{Qre(!1)},multi:!0}])}function Bi(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function bs(t,i=NaN){return!isNaN(parseFloat(t))&&!isNaN(Number(t))?Number(t):i}var Kse="\u{1F170}\uFE0F",Rj=!1;function Lu(t){if(!Rj)return;let{startLabel:i}=kj(t);performance.mark(i)}function Fu(t){if(!Rj)return;let{startLabel:i,labelName:e,endLabel:n}=kj(t);performance.mark(n),performance.measure(e,i,n),performance.clearMarks(i),performance.clearMarks(n)}function kj(t){let i=`${Kse}:${t}`;return{labelName:i,startLabel:`start:${i}`,endLabel:`end:${i}`}}function xc(t){return yR(t)}function wc(t,i){return VC(t,i?.equal)}var pk=class{[pc];constructor(i){this[pc]=i}destroy(){this[pc].destroy()}};function mx(t,i){!i?.injector&&_S(mx);let e=i?.injector??J(wn),n=i?.manualCleanup!==!0?e.get(Sy):null,o,r=e.get(qk,null,{optional:!0}),g=e.get(Wf);return r!==null&&!i?.forceRoot?(o=Jse(r.view,g,t),n instanceof H2&&n._lView===r.view&&(n=null)):o=ele(t,e.get(B7),g),o.injector=e,n!==null&&(o.onDestroyFn=n.onDestroy(()=>o.destroy())),new pk(o)}var Oj=ji(It({},X_),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,hasRun:!1,cleanupFns:void 0,zone:null,kind:"effect",onDestroyFn:$1,run(){if(this.dirty=!1,this.hasRun&&!FC(this))return;this.hasRun=!0;let t=n=>(this.cleanupFns??=[]).push(n),i=w1(this),e=z2(!1);try{this.maybeCleanup(),this.fn(t)}finally{z2(e),LC(this,i)}},maybeCleanup(){if(this.cleanupFns?.length)try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[]}}}),Xse=ji(It({},Oj),{consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(12)},destroy(){E1(this),this.onDestroyFn(),this.maybeCleanup(),this.scheduler.remove(this)}}),Qse=ji(It({},Oj),{consumerMarkedDirty(){this.view[sr]|=8192,wy(this.view),this.notifier.notify(13)},destroy(){E1(this),this.onDestroyFn(),this.maybeCleanup(),this.view[Gg]?.delete(this)}});function Jse(t,i,e){let n=Object.create(Qse);return n.view=t,n.zone=typeof Zone<"u"?Zone.current:null,n.notifier=i,n.fn=e,t[Gg]??=new Set,t[Gg].add(n),n.consumerMarkedDirty(n),n}function ele(t,i,e){let n=Object.create(Xse);return n.fn=t,n.scheduler=i,n.notifier=e,n.zone=typeof Zone<"u"?Zone.current:null,n.scheduler.schedule(n),n.notifier.notify(12),n}function $S(t,i){let e=xp(t),n=i.elementInjector||gS();return new Kg(e).create(n,i.projectableNodes,i.hostElement,i.environmentInjector)}function Pj(t){let i=xp(t);if(!i)return null;let e=new Kg(i);return{get selector(){return e.selector},get type(){return e.componentType},get inputs(){return e.inputs},get outputs(){return e.outputs},get ngContentSelectors(){return e.ngContentSelectors},get isStandalone(){return i.standalone},get isSignal(){return i.signals}}}function Nj(...t){return t.reduce((i,e)=>Object.assign(i,e,{providers:[...i.providers,...e.providers]}),{providers:[]})}var Lj=new Ot("",{providedIn:"platform",factory:()=>null}),Fj=new Ot("",{providedIn:"platform",factory:()=>null}),zj=new Ot("",{providedIn:"platform",factory:()=>null});var cn=new Ot("");var jj=null;function Qs(){return jj}function _x(t){jj??=t}var gx=class{},Nh=(()=>{class t{historyGo(e){throw new Error("")}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:()=>J(Uj),providedIn:"platform"})}return t})(),IO=new Ot(""),Uj=(()=>{class t extends Nh{_location;_history;_doc=J(cn);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Qs().getBaseHref(this._doc)}onPopState(e){let n=Qs().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",e,!1),()=>n.removeEventListener("popstate",e)}onHashChange(e){let n=Qs().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",e,!1),()=>n.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,n,o){this._history.pushState(e,n,o)}replaceState(e,n,o){this._history.replaceState(e,n,o)}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:()=>new t,providedIn:"platform"})}return t})();function GS(t,i){return t?i?t.endsWith("/")?i.startsWith("/")?t+i.slice(1):t+i:i.startsWith("/")?t+i:`${t}/${i}`:t:i}function Bj(t){let i=t.search(/#|\?|$/);return t[i-1]==="/"?t.slice(0,i-1)+t.slice(i):t}function Od(t){return t&&t[0]!=="?"?`?${t}`:t}var Pd=(()=>{class t{historyGo(e){throw new Error("")}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:()=>J(WS),providedIn:"root"})}return t})(),Ny=new Ot(""),WS=(()=>{class t extends Pd{_platformLocation;_baseHref;_removeListenerFns=[];constructor(e,n){super(),this._platformLocation=e,this._baseHref=n??this._platformLocation.getBaseHrefFromDOM()??J(cn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return GS(this._baseHref,e)}path(e=!1){let n=this._platformLocation.pathname+Od(this._platformLocation.search),o=this._platformLocation.hash;return o&&e?`${n}${o}`:n}pushState(e,n,o,r){let g=this.prepareExternalUrl(o+Od(r));this._platformLocation.pushState(e,n,g)}replaceState(e,n,o,r){let g=this.prepareExternalUrl(o+Od(r));this._platformLocation.replaceState(e,n,g)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(n){return new(n||t)(bi(Nh),bi(Ny,8))};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Lh=(()=>{class t{_subject=new gi;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(e){this._locationStrategy=e;let n=this._locationStrategy.getBaseHref();this._basePath=nle(Bj(Vj(n))),this._locationStrategy.onPopState(o=>{this._subject.next({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,n=""){return this.path()==this.normalize(e+Od(n))}normalize(e){return t.stripTrailingSlash(ile(this._basePath,Vj(e)))}prepareExternalUrl(e){return e&&e[0]!=="/"&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,n="",o=null){this._locationStrategy.pushState(o,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Od(n)),o)}replaceState(e,n="",o=null){this._locationStrategy.replaceState(o,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Od(n)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription??=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)}),()=>{let n=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(n,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",n){this._urlChangeListeners.forEach(o=>o(e,n))}subscribe(e,n,o){return this._subject.subscribe({next:e,error:n??void 0,complete:o??void 0})}static normalizeQueryParams=Od;static joinWithSlash=GS;static stripTrailingSlash=Bj;static \u0275fac=function(n){return new(n||t)(bi(Pd))};static \u0275prov=Ft({token:t,factory:()=>tle(),providedIn:"root"})}return t})();function tle(){return new Lh(bi(Pd))}function ile(t,i){if(!t||!i.startsWith(t))return i;let e=i.substring(t.length);return e===""||["/",";","?","#"].includes(e[0])?e:i}function Vj(t){return t.replace(/\/index.html$/,"")}function nle(t){if(new RegExp("^(https?:)?//").test(t)){let[,e]=t.split(/\/\/[^\/]+/);return e}return t}var LO=(()=>{class t extends Pd{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(e,n){super(),this._platformLocation=e,n!=null&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let n=this._platformLocation.hash??"#";return n.length>0?n.substring(1):n}prepareExternalUrl(e){let n=GS(this._baseHref,e);return n.length>0?"#"+n:n}pushState(e,n,o,r){let g=this.prepareExternalUrl(o+Od(r))||this._platformLocation.pathname;this._platformLocation.pushState(e,n,g)}replaceState(e,n,o,r){let g=this.prepareExternalUrl(o+Od(r))||this._platformLocation.pathname;this._platformLocation.replaceState(e,n,g)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(n){return new(n||t)(bi(Nh),bi(Ny,8))};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})();var vl=function(t){return t[t.Format=0]="Format",t[t.Standalone=1]="Standalone",t}(vl||{}),wo=function(t){return t[t.Narrow=0]="Narrow",t[t.Abbreviated=1]="Abbreviated",t[t.Wide=2]="Wide",t[t.Short=3]="Short",t}(wo||{}),Ec=function(t){return t[t.Short=0]="Short",t[t.Medium=1]="Medium",t[t.Long=2]="Long",t[t.Full=3]="Full",t}(Ec||{}),Pp={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function Wj(t){return Nu(t)[za.LocaleId]}function Zj(t,i,e){let n=Nu(t),o=[n[za.DayPeriodsFormat],n[za.DayPeriodsStandalone]],r=zu(o,i);return zu(r,e)}function Yj(t,i,e){let n=Nu(t),o=[n[za.DaysFormat],n[za.DaysStandalone]],r=zu(o,i);return zu(r,e)}function Kj(t,i,e){let n=Nu(t),o=[n[za.MonthsFormat],n[za.MonthsStandalone]],r=zu(o,i);return zu(r,e)}function Xj(t,i){let n=Nu(t)[za.Eras];return zu(n,i)}function yx(t,i){let e=Nu(t);return zu(e[za.DateFormat],i)}function vx(t,i){let e=Nu(t);return zu(e[za.TimeFormat],i)}function bx(t,i){let n=Nu(t)[za.DateTimeFormat];return zu(n,i)}function xx(t,i){let e=Nu(t),n=e[za.NumberSymbols][i];if(typeof n>"u"){if(i===Pp.CurrencyDecimal)return e[za.NumberSymbols][Pp.Decimal];if(i===Pp.CurrencyGroup)return e[za.NumberSymbols][Pp.Group]}return n}function Qj(t){if(!t[za.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[za.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Jj(t){let i=Nu(t);return Qj(i),(i[za.ExtraData][2]||[]).map(n=>typeof n=="string"?AO(n):[AO(n[0]),AO(n[1])])}function eU(t,i,e){let n=Nu(t);Qj(n);let o=[n[za.ExtraData][0],n[za.ExtraData][1]],r=zu(o,i)||[];return zu(r,e)||[]}function zu(t,i){for(let e=i;e>-1;e--)if(typeof t[e]<"u")return t[e];throw new Error("Locale data API: locale data undefined")}function AO(t){let[i,e]=t.split(":");return{hours:+i,minutes:+e}}var rle=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,ZS={},ole=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function tU(t,i,e,n){let o=fle(t);i=Op(e,i)||i;let g=[],w;for(;i;)if(w=ole.exec(i),w){g=g.concat(w.slice(1));let N=g.pop();if(!N)break;i=N}else{g.push(i);break}let T=o.getTimezoneOffset();n&&(T=nU(n,T),o=ple(o,n));let k="";return g.forEach(N=>{let V=dle(N);k+=V?V(o,e,T):N==="''"?"'":N.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),k}function JS(t,i,e){let n=new Date(0);return n.setFullYear(t,i,e),n.setHours(0,0,0),n}function Op(t,i){let e=Wj(t);if(ZS[e]??={},ZS[e][i])return ZS[e][i];let n="";switch(i){case"shortDate":n=yx(t,Ec.Short);break;case"mediumDate":n=yx(t,Ec.Medium);break;case"longDate":n=yx(t,Ec.Long);break;case"fullDate":n=yx(t,Ec.Full);break;case"shortTime":n=vx(t,Ec.Short);break;case"mediumTime":n=vx(t,Ec.Medium);break;case"longTime":n=vx(t,Ec.Long);break;case"fullTime":n=vx(t,Ec.Full);break;case"short":let o=Op(t,"shortTime"),r=Op(t,"shortDate");n=YS(bx(t,Ec.Short),[o,r]);break;case"medium":let g=Op(t,"mediumTime"),w=Op(t,"mediumDate");n=YS(bx(t,Ec.Medium),[g,w]);break;case"long":let T=Op(t,"longTime"),k=Op(t,"longDate");n=YS(bx(t,Ec.Long),[T,k]);break;case"full":let N=Op(t,"fullTime"),V=Op(t,"fullDate");n=YS(bx(t,Ec.Full),[N,V]);break}return n&&(ZS[e][i]=n),n}function YS(t,i){return i&&(t=t.replace(/\{([^}]+)}/g,function(e,n){return i!=null&&n in i?i[n]:e})),t}function Nd(t,i,e="-",n,o){let r="";(t<0||o&&t<=0)&&(o?t=-t+1:(t=-t,r=e));let g=String(t);for(;g.length<i;)g="0"+g;return n&&(g=g.slice(g.length-i)),r+g}function ale(t,i){return Nd(t,3).substring(0,i)}function Xa(t,i,e=0,n=!1,o=!1){return function(r,g){let w=sle(t,r);if((e>0||w>-e)&&(w+=e),t===3)w===0&&e===-12&&(w=12);else if(t===6)return ale(w,i);let T=xx(g,Pp.MinusSign);return Nd(w,i,T,n,o)}}function sle(t,i){switch(t){case 0:return i.getFullYear();case 1:return i.getMonth();case 2:return i.getDate();case 3:return i.getHours();case 4:return i.getMinutes();case 5:return i.getSeconds();case 6:return i.getMilliseconds();case 7:return i.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}function zo(t,i,e=vl.Format,n=!1){return function(o,r){return lle(o,r,t,i,e,n)}}function lle(t,i,e,n,o,r){switch(e){case 2:return Kj(i,o,n)[t.getMonth()];case 1:return Yj(i,o,n)[t.getDay()];case 0:let g=t.getHours(),w=t.getMinutes();if(r){let k=Jj(i),N=eU(i,o,n),V=k.findIndex(q=>{if(Array.isArray(q)){let[Z,X]=q,te=g>=Z.hours&&w>=Z.minutes,De=g<X.hours||g===X.hours&&w<X.minutes;if(Z.hours<X.hours){if(te&&De)return!0}else if(te||De)return!0}else if(q.hours===g&&q.minutes===w)return!0;return!1});if(V!==-1)return N[V]}return Zj(i,o,n)[g<12?0:1];case 3:return Xj(i,n)[t.getFullYear()<=0?0:1];default:let T=e;throw new Error(`unexpected translation type ${T}`)}}function KS(t){return function(i,e,n){let o=-1*n,r=xx(e,Pp.MinusSign),g=o>0?Math.floor(o/60):Math.ceil(o/60);switch(t){case 0:return(o>=0?"+":"")+Nd(g,2,r)+Nd(Math.abs(o%60),2,r);case 1:return"GMT"+(o>=0?"+":"")+Nd(g,1,r);case 2:return"GMT"+(o>=0?"+":"")+Nd(g,2,r)+":"+Nd(Math.abs(o%60),2,r);case 3:return n===0?"Z":(o>=0?"+":"")+Nd(g,2,r)+":"+Nd(Math.abs(o%60),2,r);default:throw new Error(`Unknown zone width "${t}"`)}}}var cle=0,QS=4;function ule(t){let i=JS(t,cle,1).getDay();return JS(t,0,1+(i<=QS?QS:QS+7)-i)}function iU(t){let i=t.getDay(),e=i===0?-3:QS-i;return JS(t.getFullYear(),t.getMonth(),t.getDate()+e)}function RO(t,i=!1){return function(e,n){let o;if(i){let r=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,g=e.getDate();o=1+Math.floor((g+r)/7)}else{let r=iU(e),g=ule(r.getFullYear()),w=r.getTime()-g.getTime();o=1+Math.round(w/6048e5)}return Nd(o,t,xx(n,Pp.MinusSign))}}function XS(t,i=!1){return function(e,n){let r=iU(e).getFullYear();return Nd(r,t,xx(n,Pp.MinusSign),i)}}var kO={};function dle(t){if(kO[t])return kO[t];let i;switch(t){case"G":case"GG":case"GGG":i=zo(3,wo.Abbreviated);break;case"GGGG":i=zo(3,wo.Wide);break;case"GGGGG":i=zo(3,wo.Narrow);break;case"y":i=Xa(0,1,0,!1,!0);break;case"yy":i=Xa(0,2,0,!0,!0);break;case"yyy":i=Xa(0,3,0,!1,!0);break;case"yyyy":i=Xa(0,4,0,!1,!0);break;case"Y":i=XS(1);break;case"YY":i=XS(2,!0);break;case"YYY":i=XS(3);break;case"YYYY":i=XS(4);break;case"M":case"L":i=Xa(1,1,1);break;case"MM":case"LL":i=Xa(1,2,1);break;case"MMM":i=zo(2,wo.Abbreviated);break;case"MMMM":i=zo(2,wo.Wide);break;case"MMMMM":i=zo(2,wo.Narrow);break;case"LLL":i=zo(2,wo.Abbreviated,vl.Standalone);break;case"LLLL":i=zo(2,wo.Wide,vl.Standalone);break;case"LLLLL":i=zo(2,wo.Narrow,vl.Standalone);break;case"w":i=RO(1);break;case"ww":i=RO(2);break;case"W":i=RO(1,!0);break;case"d":i=Xa(2,1);break;case"dd":i=Xa(2,2);break;case"c":case"cc":i=Xa(7,1);break;case"ccc":i=zo(1,wo.Abbreviated,vl.Standalone);break;case"cccc":i=zo(1,wo.Wide,vl.Standalone);break;case"ccccc":i=zo(1,wo.Narrow,vl.Standalone);break;case"cccccc":i=zo(1,wo.Short,vl.Standalone);break;case"E":case"EE":case"EEE":i=zo(1,wo.Abbreviated);break;case"EEEE":i=zo(1,wo.Wide);break;case"EEEEE":i=zo(1,wo.Narrow);break;case"EEEEEE":i=zo(1,wo.Short);break;case"a":case"aa":case"aaa":i=zo(0,wo.Abbreviated);break;case"aaaa":i=zo(0,wo.Wide);break;case"aaaaa":i=zo(0,wo.Narrow);break;case"b":case"bb":case"bbb":i=zo(0,wo.Abbreviated,vl.Standalone,!0);break;case"bbbb":i=zo(0,wo.Wide,vl.Standalone,!0);break;case"bbbbb":i=zo(0,wo.Narrow,vl.Standalone,!0);break;case"B":case"BB":case"BBB":i=zo(0,wo.Abbreviated,vl.Format,!0);break;case"BBBB":i=zo(0,wo.Wide,vl.Format,!0);break;case"BBBBB":i=zo(0,wo.Narrow,vl.Format,!0);break;case"h":i=Xa(3,1,-12);break;case"hh":i=Xa(3,2,-12);break;case"H":i=Xa(3,1);break;case"HH":i=Xa(3,2);break;case"m":i=Xa(4,1);break;case"mm":i=Xa(4,2);break;case"s":i=Xa(5,1);break;case"ss":i=Xa(5,2);break;case"S":i=Xa(6,1);break;case"SS":i=Xa(6,2);break;case"SSS":i=Xa(6,3);break;case"Z":case"ZZ":case"ZZZ":i=KS(0);break;case"ZZZZZ":i=KS(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":i=KS(1);break;case"OOOO":case"ZZZZ":case"zzzz":i=KS(2);break;default:return null}return kO[t]=i,i}function nU(t,i){t=t.replace(/:/g,"");let e=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(e)?i:e}function hle(t,i){return t=new Date(t.getTime()),t.setMinutes(t.getMinutes()+i),t}function ple(t,i,e){let o=t.getTimezoneOffset(),r=nU(i,o);return hle(t,-1*(r-o))}function fle(t){if(Hj(t))return t;if(typeof t=="number"&&!isNaN(t))return new Date(t);if(typeof t=="string"){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){let[o,r=1,g=1]=t.split("-").map(w=>+w);return JS(o,r-1,g)}let e=parseFloat(t);if(!isNaN(t-e))return new Date(e);let n;if(n=t.match(rle))return mle(n)}let i=new Date(t);if(!Hj(i))throw new Error(`Unable to convert "${t}" into a date`);return i}function mle(t){let i=new Date(0),e=0,n=0,o=t[8]?i.setUTCFullYear:i.setFullYear,r=t[8]?i.setUTCHours:i.setHours;t[9]&&(e=Number(t[9]+t[10]),n=Number(t[9]+t[11])),o.call(i,Number(t[1]),Number(t[2])-1,Number(t[3]));let g=Number(t[4]||0)-e,w=Number(t[5]||0)-n,T=Number(t[6]||0),k=Math.floor(parseFloat("0."+(t[7]||0))*1e3);return r.call(i,g,w,T,k),i}function Hj(t){return t instanceof Date&&!isNaN(t.valueOf())}var OO=/\s+/,qj=[],Js=(()=>{class t{_ngEl;_renderer;initialClasses=qj;rawClass;stateMap=new Map;constructor(e,n){this._ngEl=e,this._renderer=n}set klass(e){this.initialClasses=e!=null?e.trim().split(OO):qj}set ngClass(e){this.rawClass=typeof e=="string"?e.trim().split(OO):e}ngDoCheck(){for(let n of this.initialClasses)this._updateState(n,!0);let e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(let n of e)this._updateState(n,!0);else if(e!=null)for(let n of Object.keys(e))this._updateState(n,!!e[n]);this._applyStateDiff()}_updateState(e,n){let o=this.stateMap.get(e);o!==void 0?(o.enabled!==n&&(o.changed=!0,o.enabled=n),o.touched=!0):this.stateMap.set(e,{enabled:n,changed:!0,touched:!0})}_applyStateDiff(){for(let e of this.stateMap){let n=e[0],o=e[1];o.changed?(this._toggleClass(n,o.enabled),o.changed=!1):o.touched||(o.enabled&&this._toggleClass(n,!1),this.stateMap.delete(n)),o.touched=!1}}_toggleClass(e,n){e=e.trim(),e.length>0&&e.split(OO).forEach(o=>{n?this._renderer.addClass(this._ngEl.nativeElement,o):this._renderer.removeClass(this._ngEl.nativeElement,o)})}static \u0275fac=function(n){return new(n||t)(Ci(Qi),Ci(Ko))};static \u0275dir=vi({type:t,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return t})();var eT=class{$implicit;ngForOf;index;count;constructor(i,e,n,o){this.$implicit=i,this.ngForOf=e,this.index=n,this.count=o}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},bl=(()=>{class t{_viewContainer;_template;_differs;set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(e,n,o){this._viewContainer=e,this._template=n,this._differs=o}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){let e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){let n=this._viewContainer;e.forEachOperation((o,r,g)=>{if(o.previousIndex==null)n.createEmbeddedView(this._template,new eT(o.item,this._ngForOf,-1,-1),g===null?void 0:g);else if(g==null)n.remove(r===null?void 0:r);else if(r!==null){let w=n.get(r);n.move(w,g),$j(w,o)}});for(let o=0,r=n.length;o<r;o++){let w=n.get(o).context;w.index=o,w.count=r,w.ngForOf=this._ngForOf}e.forEachIdentityChange(o=>{let r=n.get(o.currentIndex);$j(r,o)})}static ngTemplateContextGuard(e,n){return!0}static \u0275fac=function(n){return new(n||t)(Ci(na),Ci(Zo),Ci(Ph))};static \u0275dir=vi({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return t})();function $j(t,i){t.context.$implicit=i.item}var Er=(()=>{class t{_viewContainer;_context=new tT;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(e,n){this._viewContainer=e,this._thenTemplateRef=n}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){Gj(e,!1),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){Gj(e,!1),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(e,n){return!0}static \u0275fac=function(n){return new(n||t)(Ci(na),Ci(Zo))};static \u0275dir=vi({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return t})(),tT=class{$implicit=null;ngIf=null};function Gj(t,i){if(t&&!t.createEmbeddedView)throw new si(2020,!1)}var wx=(()=>{class t{_viewContainerRef;_viewRef=null;ngTemplateOutletContext=null;ngTemplateOutlet=null;ngTemplateOutletInjector=null;constructor(e){this._viewContainerRef=e}ngOnChanges(e){if(this._shouldRecreateView(e)){let n=this._viewContainerRef;if(this._viewRef&&n.remove(n.indexOf(this._viewRef)),!this.ngTemplateOutlet){this._viewRef=null;return}let o=this._createContextForwardProxy();this._viewRef=n.createEmbeddedView(this.ngTemplateOutlet,o,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(e){return!!e.ngTemplateOutlet||!!e.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(e,n,o)=>this.ngTemplateOutletContext?Reflect.set(this.ngTemplateOutletContext,n,o):!1,get:(e,n,o)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,n,o)}})}static \u0275fac=function(n){return new(n||t)(Ci(na))};static \u0275dir=vi({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},features:[$r]})}return t})();function rU(t,i){return new si(2100,!1)}var PO=class{createSubscription(i,e){return xc(()=>i.subscribe({next:e,error:n=>{throw n}}))}dispose(i){xc(()=>i.unsubscribe())}},NO=class{createSubscription(i,e){return i.then(e,n=>{throw n})}dispose(i){}},gle=new NO,_le=new PO,Ex=(()=>{class t{_ref;_latestValue=null;markForCheckOnValueUpdate=!0;_subscription=null;_obj=null;_strategy=null;constructor(e){this._ref=e}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(e){if(!this._obj){if(e)try{this.markForCheckOnValueUpdate=!1,this._subscribe(e)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return e!==this._obj?(this._dispose(),this.transform(e)):this._latestValue}_subscribe(e){this._obj=e,this._strategy=this._selectStrategy(e),this._subscription=this._strategy.createSubscription(e,n=>this._updateLatestValue(e,n))}_selectStrategy(e){if(im(e))return gle;if(_O(e))return _le;throw rU(t,e)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(e,n){e===this._obj&&(this._latestValue=n,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static \u0275fac=function(n){return new(n||t)(Ci(vr,16))};static \u0275pipe=mO({name:"async",type:t,pure:!1})}return t})();var yle="mediumDate",oU=new Ot(""),aU=new Ot(""),Ld=(()=>{class t{locale;defaultTimezone;defaultOptions;constructor(e,n,o){this.locale=e,this.defaultTimezone=n,this.defaultOptions=o}transform(e,n,o,r){if(e==null||e===""||e!==e)return null;try{let g=n??this.defaultOptions?.dateFormat??yle,w=o??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return tU(e,g,r||this.locale,w)}catch(g){throw rU(t,g.message)}}static \u0275fac=function(n){return new(n||t)(Ci(om,16),Ci(oU,24),Ci(aU,24))};static \u0275pipe=mO({name:"date",type:t,pure:!0})}return t})();var Or=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({})}return t})();function Cx(t,i){i=encodeURIComponent(i);for(let e of t.split(";")){let n=e.indexOf("="),[o,r]=n==-1?[e,""]:[e.slice(0,n),e.slice(n+1)];if(o.trim()===i)return decodeURIComponent(r)}return null}var iT="browser",nT="server";function Cc(t){return t===iT}function rT(t){return t===nT}var Np=class{};var oT=(()=>{class t{static \u0275prov=Ft({token:t,providedIn:"root",factory:()=>new Sx})}return t})();var Sx=class{setOffset(i){}getScrollPosition(){return[0,0]}scrollToPosition(i){}scrollToAnchor(i){}setHistoryScrollRestoration(i){}};var o0=new Ot(""),VO=(()=>{class t{_zone;_plugins;_eventNameToPlugin=new Map;constructor(e,n){this._zone=n,e.forEach(o=>{o.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,n,o,r){return this._findPluginFor(n).addEventListener(e,n,o,r)}getZone(){return this._zone}_findPluginFor(e){let n=this._eventNameToPlugin.get(e);if(n)return n;if(n=this._plugins.find(r=>r.supports(e)),!n)throw new si(5101,!1);return this._eventNameToPlugin.set(e,n),n}static \u0275fac=function(n){return new(n||t)(bi(o0),bi(Oi))};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})(),am=class{_doc;constructor(i){this._doc=i}manager},aT="ng-app-id";function sU(t){for(let i of t)i.remove()}function lU(t,i){let e=i.createElement("style");return e.textContent=t,e}function vle(t,i,e,n){let o=t.head?.querySelectorAll(`style[${aT}="${i}"],link[${aT}="${i}"]`);if(o)for(let r of o)r.removeAttribute(aT),r instanceof HTMLLinkElement?n.set(r.href.slice(r.href.lastIndexOf("/")+1),{usage:0,elements:[r]}):r.textContent&&e.set(r.textContent,{usage:0,elements:[r]})}function zO(t,i){let e=i.createElement("link");return e.setAttribute("rel","stylesheet"),e.setAttribute("href",t),e}var jO=(()=>{class t{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(e,n,o,r={}){this.doc=e,this.appId=n,this.nonce=o,this.isServer=rT(r),vle(e,n,this.inline,this.external),this.hosts.add(e.head)}addStyles(e,n){for(let o of e)this.addUsage(o,this.inline,lU);n?.forEach(o=>this.addUsage(o,this.external,zO))}removeStyles(e,n){for(let o of e)this.removeUsage(o,this.inline);n?.forEach(o=>this.removeUsage(o,this.external))}addUsage(e,n,o){let r=n.get(e);r?r.usage++:n.set(e,{usage:1,elements:[...this.hosts].map(g=>this.addElement(g,o(e,this.doc)))})}removeUsage(e,n){let o=n.get(e);o&&(o.usage--,o.usage<=0&&(sU(o.elements),n.delete(e)))}ngOnDestroy(){for(let[,{elements:e}]of[...this.inline,...this.external])sU(e);this.hosts.clear()}addHost(e){this.hosts.add(e);for(let[n,{elements:o}]of this.inline)o.push(this.addElement(e,lU(n,this.doc)));for(let[n,{elements:o}]of this.external)o.push(this.addElement(e,zO(n,this.doc)))}removeHost(e){this.hosts.delete(e)}addElement(e,n){return this.nonce&&n.setAttribute("nonce",this.nonce),this.isServer&&n.setAttribute(aT,this.appId),e.appendChild(n)}static \u0275fac=function(n){return new(n||t)(bi(cn),bi(Ou),bi(e0,8),bi(Ns))};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})(),FO={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},UO=/%COMP%/g;var uU="%COMP%",ble=`_nghost-${uU}`,xle=`_ngcontent-${uU}`,wle=!0,Ele=new Ot("",{providedIn:"root",factory:()=>wle});function Cle(t){return xle.replace(UO,t)}function Sle(t){return ble.replace(UO,t)}function dU(t,i){return i.map(e=>e.replace(UO,t))}var Mx=(()=>{class t{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(e,n,o,r,g,w,T,k=null,N=null){this.eventManager=e,this.sharedStylesHost=n,this.appId=o,this.removeStylesOnCompDestroy=r,this.doc=g,this.platformId=w,this.ngZone=T,this.nonce=k,this.tracingService=N,this.platformIsServer=rT(w),this.defaultRenderer=new Tx(e,g,T,this.platformIsServer,this.tracingService)}createRenderer(e,n){if(!e||!n)return this.defaultRenderer;this.platformIsServer&&n.encapsulation===Ad.ShadowDom&&(n=ji(It({},n),{encapsulation:Ad.Emulated}));let o=this.getOrCreateRenderer(e,n);return o instanceof sT?o.applyToHost(e):o instanceof Dx&&o.applyStyles(),o}getOrCreateRenderer(e,n){let o=this.rendererByCompId,r=o.get(n.id);if(!r){let g=this.doc,w=this.ngZone,T=this.eventManager,k=this.sharedStylesHost,N=this.removeStylesOnCompDestroy,V=this.platformIsServer,q=this.tracingService;switch(n.encapsulation){case Ad.Emulated:r=new sT(T,k,n,this.appId,N,g,w,V,q);break;case Ad.ShadowDom:return new BO(T,k,e,n,g,w,this.nonce,V,q);default:r=new Dx(T,k,n,N,g,w,V,q);break}o.set(n.id,r)}return r}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(e){this.rendererByCompId.delete(e)}static \u0275fac=function(n){return new(n||t)(bi(VO),bi(jO),bi(Ou),bi(Ele),bi(cn),bi(Ns),bi(Oi),bi(e0),bi(My,8))};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})(),Tx=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(i,e,n,o,r){this.eventManager=i,this.doc=e,this.ngZone=n,this.platformIsServer=o,this.tracingService=r}destroy(){}destroyNode=null;createElement(i,e){return e?this.doc.createElementNS(FO[e]||e,i):this.doc.createElement(i)}createComment(i){return this.doc.createComment(i)}createText(i){return this.doc.createTextNode(i)}appendChild(i,e){(cU(i)?i.content:i).appendChild(e)}insertBefore(i,e,n){i&&(cU(i)?i.content:i).insertBefore(e,n)}removeChild(i,e){e.remove()}selectRootElement(i,e){let n=typeof i=="string"?this.doc.querySelector(i):i;if(!n)throw new si(-5104,!1);return e||(n.textContent=""),n}parentNode(i){return i.parentNode}nextSibling(i){return i.nextSibling}setAttribute(i,e,n,o){if(o){e=o+":"+e;let r=FO[o];r?i.setAttributeNS(r,e,n):i.setAttribute(e,n)}else i.setAttribute(e,n)}removeAttribute(i,e,n){if(n){let o=FO[n];o?i.removeAttributeNS(o,e):i.removeAttribute(`${n}:${e}`)}else i.removeAttribute(e)}addClass(i,e){i.classList.add(e)}removeClass(i,e){i.classList.remove(e)}setStyle(i,e,n,o){o&(Tp.DashCase|Tp.Important)?i.style.setProperty(e,n,o&Tp.Important?"important":""):i.style[e]=n}removeStyle(i,e,n){n&Tp.DashCase?i.style.removeProperty(e):i.style[e]=""}setProperty(i,e,n){i!=null&&(i[e]=n)}setValue(i,e){i.nodeValue=e}listen(i,e,n,o){if(typeof i=="string"&&(i=Qs().getGlobalEventTarget(this.doc,i),!i))throw new si(5102,!1);let r=this.decoratePreventDefault(n);return this.tracingService?.wrapEventListener&&(r=this.tracingService.wrapEventListener(i,e,r)),this.eventManager.addEventListener(i,e,r,o)}decoratePreventDefault(i){return e=>{if(e==="__ngUnwrap__")return i;(this.platformIsServer?this.ngZone.runGuarded(()=>i(e)):i(e))===!1&&e.preventDefault()}}};function cU(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var BO=class extends Tx{sharedStylesHost;hostEl;shadowRoot;constructor(i,e,n,o,r,g,w,T,k){super(i,r,g,T,k),this.sharedStylesHost=e,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let N=o.styles;N=dU(o.id,N);for(let q of N){let Z=document.createElement("style");w&&Z.setAttribute("nonce",w),Z.textContent=q,this.shadowRoot.appendChild(Z)}let V=o.getExternalStyles?.();if(V)for(let q of V){let Z=zO(q,r);w&&Z.setAttribute("nonce",w),this.shadowRoot.appendChild(Z)}}nodeOrShadowRoot(i){return i===this.hostEl?this.shadowRoot:i}appendChild(i,e){return super.appendChild(this.nodeOrShadowRoot(i),e)}insertBefore(i,e,n){return super.insertBefore(this.nodeOrShadowRoot(i),e,n)}removeChild(i,e){return super.removeChild(null,e)}parentNode(i){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(i)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Dx=class extends Tx{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(i,e,n,o,r,g,w,T,k){super(i,r,g,w,T),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=o;let N=n.styles;this.styles=k?dU(k,N):N,this.styleUrls=n.getExternalStyles?.(k)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},sT=class extends Dx{contentAttr;hostAttr;constructor(i,e,n,o,r,g,w,T,k){let N=o+"-"+n.id;super(i,e,n,r,g,w,T,k,N),this.contentAttr=Cle(N),this.hostAttr=Sle(N)}applyToHost(i){this.applyStyles(),this.setAttribute(i,this.hostAttr,"")}createElement(i,e){let n=super.createElement(i,e);return super.setAttribute(n,this.contentAttr,""),n}};var a0=class t extends gx{supportsDOMEvents=!0;static makeCurrent(){_x(new t)}onAndCancel(i,e,n,o){return i.addEventListener(e,n,o),()=>{i.removeEventListener(e,n,o)}}dispatchEvent(i,e){i.dispatchEvent(e)}remove(i){i.remove()}createElement(i,e){return e=e||this.getDefaultDocument(),e.createElement(i)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(i){return i.nodeType===Node.ELEMENT_NODE}isShadowRoot(i){return i instanceof DocumentFragment}getGlobalEventTarget(i,e){return e==="window"?window:e==="document"?i:e==="body"?i.body:null}getBaseHref(i){let e=Tle();return e==null?null:Dle(e)}resetBaseElement(){Ix=null}getUserAgent(){return window.navigator.userAgent}getCookie(i){return Cx(document.cookie,i)}},Ix=null;function Tle(){return Ix=Ix||document.querySelector("base"),Ix?Ix.getAttribute("href"):null}function Dle(t){return new URL(t,document.baseURI).pathname}var lT=class{addToWindow(i){Os.getAngularTestability=(n,o=!0)=>{let r=i.findTestabilityInTree(n,o);if(r==null)throw new si(5103,!1);return r},Os.getAllAngularTestabilities=()=>i.getAllTestabilities(),Os.getAllAngularRootElements=()=>i.getAllRootElements();let e=n=>{let o=Os.getAllAngularTestabilities(),r=o.length,g=function(){r--,r==0&&n()};o.forEach(w=>{w.whenStable(g)})};Os.frameworkStabilizers||(Os.frameworkStabilizers=[]),Os.frameworkStabilizers.push(e)}findTestabilityInTree(i,e,n){if(e==null)return null;let o=i.getTestability(e);return o??(n?Qs().isShadowRoot(e)?this.findTestabilityInTree(i,e.host,!0):this.findTestabilityInTree(i,e.parentElement,!0):null)}},Mle=(()=>{class t{build(){return new XMLHttpRequest}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})(),pU=(()=>{class t extends am{constructor(e){super(e)}supports(e){return!0}addEventListener(e,n,o,r){return e.addEventListener(n,o,r),()=>this.removeEventListener(e,n,o,r)}removeEventListener(e,n,o,r){return e.removeEventListener(n,o,r)}static \u0275fac=function(n){return new(n||t)(bi(cn))};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})(),hU=["alt","control","meta","shift"],Ile={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Ale={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},fU=(()=>{class t extends am{constructor(e){super(e)}supports(e){return t.parseEventName(e)!=null}addEventListener(e,n,o,r){let g=t.parseEventName(n),w=t.eventCallback(g.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Qs().onAndCancel(e,g.domEventName,w,r))}static parseEventName(e){let n=e.toLowerCase().split("."),o=n.shift();if(n.length===0||!(o==="keydown"||o==="keyup"))return null;let r=t._normalizeKey(n.pop()),g="",w=n.indexOf("code");if(w>-1&&(n.splice(w,1),g="code."),hU.forEach(k=>{let N=n.indexOf(k);N>-1&&(n.splice(N,1),g+=k+".")}),g+=r,n.length!=0||r.length===0)return null;let T={};return T.domEventName=o,T.fullKey=g,T}static matchEventFullKeyCode(e,n){let o=Ile[e.key]||e.key,r="";return n.indexOf("code.")>-1&&(o=e.code,r="code."),o==null||!o?!1:(o=o.toLowerCase(),o===" "?o="space":o==="."&&(o="dot"),hU.forEach(g=>{if(g!==o){let w=Ale[g];w(e)&&(r+=g+".")}}),r+=o,r===n)}static eventCallback(e,n,o){return r=>{t.matchEventFullKeyCode(r,e)&&o.runGuarded(()=>n(r))}}static _normalizeKey(e){return e==="esc"?"escape":e}static \u0275fac=function(n){return new(n||t)(bi(cn))};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})();function HO(t,i){return wj(It({rootComponent:t},Rle(i)))}function Rle(t){return{appProviders:[...mU,...t?.providers??[]],platformProviders:Nle}}function kle(){a0.makeCurrent()}function Ole(){return new Hl}function Ple(){return SS(document),document}var Nle=[{provide:Ns,useValue:iT},{provide:ox,useValue:kle,multi:!0},{provide:cn,useFactory:Ple}];var Lle=[{provide:px,useClass:lT},{provide:hx,useClass:Ay,deps:[Oi,VS,px]},{provide:Ay,useClass:Ay,deps:[Oi,VS,px]}],mU=[{provide:mS,useValue:"root"},{provide:Hl,useFactory:Ole},{provide:o0,useClass:pU,multi:!0,deps:[cn]},{provide:o0,useClass:fU,multi:!0,deps:[cn]},Mx,jO,VO,{provide:Fa,useExisting:Mx},{provide:Np,useClass:Mle},[]],cT=(()=>{class t{constructor(){}static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({providers:[...mU,...Lle],imports:[Or,xj]})}return t})();var Fy=class{},Ax=class{},Lp=class t{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(i){i?typeof i=="string"?this.lazyInit=()=>{this.headers=new Map,i.split(`
`).forEach(e=>{let n=e.indexOf(":");if(n>0){let o=e.slice(0,n),r=e.slice(n+1).trim();this.addHeaderEntry(o,r)}})}:typeof Headers<"u"&&i instanceof Headers?(this.headers=new Map,i.forEach((e,n)=>{this.addHeaderEntry(n,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(i).forEach(([e,n])=>{this.setHeaderEntries(e,n)})}:this.headers=new Map}has(i){return this.init(),this.headers.has(i.toLowerCase())}get(i){this.init();let e=this.headers.get(i.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(i){return this.init(),this.headers.get(i.toLowerCase())||null}append(i,e){return this.clone({name:i,value:e,op:"a"})}set(i,e){return this.clone({name:i,value:e,op:"s"})}delete(i,e){return this.clone({name:i,value:e,op:"d"})}maybeSetNormalizedName(i,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,i)}init(){this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(i=>this.applyUpdate(i)),this.lazyUpdate=null))}copyFrom(i){i.init(),Array.from(i.headers.keys()).forEach(e=>{this.headers.set(e,i.headers.get(e)),this.normalizedNames.set(e,i.normalizedNames.get(e))})}clone(i){let e=new t;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([i]),e}applyUpdate(i){let e=i.name.toLowerCase();switch(i.op){case"a":case"s":let n=i.value;if(typeof n=="string"&&(n=[n]),n.length===0)return;this.maybeSetNormalizedName(i.name,e);let o=(i.op==="a"?this.headers.get(e):void 0)||[];o.push(...n),this.headers.set(e,o);break;case"d":let r=i.value;if(!r)this.headers.delete(e),this.normalizedNames.delete(e);else{let g=this.headers.get(e);if(!g)return;g=g.filter(w=>r.indexOf(w)===-1),g.length===0?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,g)}break}}addHeaderEntry(i,e){let n=i.toLowerCase();this.maybeSetNormalizedName(i,n),this.headers.has(n)?this.headers.get(n).push(e):this.headers.set(n,[e])}setHeaderEntries(i,e){let n=(Array.isArray(e)?e:[e]).map(r=>r.toString()),o=i.toLowerCase();this.headers.set(o,n),this.maybeSetNormalizedName(i,o)}forEach(i){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>i(this.normalizedNames.get(e),this.headers.get(e)))}};var dT=class{encodeKey(i){return gU(i)}encodeValue(i){return gU(i)}decodeKey(i){return decodeURIComponent(i)}decodeValue(i){return decodeURIComponent(i)}};function Fle(t,i){let e=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(o=>{let r=o.indexOf("="),[g,w]=r==-1?[i.decodeKey(o),""]:[i.decodeKey(o.slice(0,r)),i.decodeValue(o.slice(r+1))],T=e.get(g)||[];T.push(w),e.set(g,T)}),e}var zle=/%(\d[a-f0-9])/gi,Ble={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function gU(t){return encodeURIComponent(t).replace(zle,(i,e)=>Ble[e]??i)}function uT(t){return`${t}`}var ws=class t{map;encoder;updates=null;cloneFrom=null;constructor(i={}){if(this.encoder=i.encoder||new dT,i.fromString){if(i.fromObject)throw new si(2805,!1);this.map=Fle(i.fromString,this.encoder)}else i.fromObject?(this.map=new Map,Object.keys(i.fromObject).forEach(e=>{let n=i.fromObject[e],o=Array.isArray(n)?n.map(uT):[uT(n)];this.map.set(e,o)})):this.map=null}has(i){return this.init(),this.map.has(i)}get(i){this.init();let e=this.map.get(i);return e?e[0]:null}getAll(i){return this.init(),this.map.get(i)||null}keys(){return this.init(),Array.from(this.map.keys())}append(i,e){return this.clone({param:i,value:e,op:"a"})}appendAll(i){let e=[];return Object.keys(i).forEach(n=>{let o=i[n];Array.isArray(o)?o.forEach(r=>{e.push({param:n,value:r,op:"a"})}):e.push({param:n,value:o,op:"a"})}),this.clone(e)}set(i,e){return this.clone({param:i,value:e,op:"s"})}delete(i,e){return this.clone({param:i,value:e,op:"d"})}toString(){return this.init(),this.keys().map(i=>{let e=this.encoder.encodeKey(i);return this.map.get(i).map(n=>e+"="+this.encoder.encodeValue(n)).join("&")}).filter(i=>i!=="").join("&")}clone(i){let e=new t({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(i),e}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(i=>this.map.set(i,this.cloneFrom.map.get(i))),this.updates.forEach(i=>{switch(i.op){case"a":case"s":let e=(i.op==="a"?this.map.get(i.param):void 0)||[];e.push(uT(i.value)),this.map.set(i.param,e);break;case"d":if(i.value!==void 0){let n=this.map.get(i.param)||[],o=n.indexOf(uT(i.value));o!==-1&&n.splice(o,1),n.length>0?this.map.set(i.param,n):this.map.delete(i.param)}else{this.map.delete(i.param);break}}}),this.cloneFrom=this.updates=null)}};var hT=class{map=new Map;set(i,e){return this.map.set(i,e),this}get(i){return this.map.has(i)||this.map.set(i,i.defaultValue()),this.map.get(i)}delete(i){return this.map.delete(i),this}has(i){return this.map.has(i)}keys(){return this.map.keys()}};function Vle(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function _U(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function yU(t){return typeof Blob<"u"&&t instanceof Blob}function vU(t){return typeof FormData<"u"&&t instanceof FormData}function jle(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}var bU="Content-Type",xU="Accept",EU="X-Request-URL",CU="text/plain",SU="application/json",Ule=`${SU}, ${CU}, */*`,Ly=class t{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(i,e,n,o){this.url=e,this.method=i.toUpperCase();let r;if(Vle(this.method)||o?(this.body=n!==void 0?n:null,r=o):r=n,r&&(this.reportProgress=!!r.reportProgress,this.withCredentials=!!r.withCredentials,r.responseType&&(this.responseType=r.responseType),r.headers&&(this.headers=r.headers),r.context&&(this.context=r.context),r.params&&(this.params=r.params),this.transferCache=r.transferCache),this.headers??=new Lp,this.context??=new hT,!this.params)this.params=new ws,this.urlWithParams=e;else{let g=this.params.toString();if(g.length===0)this.urlWithParams=e;else{let w=e.indexOf("?"),T=w===-1?"?":w<e.length-1?"&":"";this.urlWithParams=e+T+g}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||_U(this.body)||yU(this.body)||vU(this.body)||jle(this.body)?this.body:this.body instanceof ws?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||vU(this.body)?null:yU(this.body)?this.body.type||null:_U(this.body)?null:typeof this.body=="string"?CU:this.body instanceof ws?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?SU:null}clone(i={}){let e=i.method||this.method,n=i.url||this.url,o=i.responseType||this.responseType,r=i.transferCache??this.transferCache,g=i.body!==void 0?i.body:this.body,w=i.withCredentials??this.withCredentials,T=i.reportProgress??this.reportProgress,k=i.headers||this.headers,N=i.params||this.params,V=i.context??this.context;return i.setHeaders!==void 0&&(k=Object.keys(i.setHeaders).reduce((q,Z)=>q.set(Z,i.setHeaders[Z]),k)),i.setParams&&(N=Object.keys(i.setParams).reduce((q,Z)=>q.set(Z,i.setParams[Z]),N)),new t(e,n,g,{params:N,headers:k,context:V,reportProgress:T,responseType:o,withCredentials:w,transferCache:r})}},s0=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(s0||{}),zy=class{headers;status;statusText;url;ok;type;constructor(i,e=200,n="OK"){this.headers=i.headers||new Lp,this.status=i.status!==void 0?i.status:e,this.statusText=i.statusText||n,this.url=i.url||null,this.ok=this.status>=200&&this.status<300}},pT=class t extends zy{constructor(i={}){super(i)}type=s0.ResponseHeader;clone(i={}){return new t({headers:i.headers||this.headers,status:i.status!==void 0?i.status:this.status,statusText:i.statusText||this.statusText,url:i.url||this.url||void 0})}},l0=class t extends zy{body;constructor(i={}){super(i),this.body=i.body!==void 0?i.body:null}type=s0.Response;clone(i={}){return new t({body:i.body!==void 0?i.body:this.body,headers:i.headers||this.headers,status:i.status!==void 0?i.status:this.status,statusText:i.statusText||this.statusText,url:i.url||this.url||void 0})}},Rx=class extends zy{name="HttpErrorResponse";message;error;ok=!1;constructor(i){super(i,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${i.url||"(unknown url)"}`:this.message=`Http failure response for ${i.url||"(unknown url)"}: ${i.status} ${i.statusText}`,this.error=i.error||null}},Hle=200,qle=204;function qO(t,i){return{body:i,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials,transferCache:t.transferCache}}var Qa=(()=>{class t{handler;constructor(e){this.handler=e}request(e,n,o={}){let r;if(e instanceof Ly)r=e;else{let T;o.headers instanceof Lp?T=o.headers:T=new Lp(o.headers);let k;o.params&&(o.params instanceof ws?k=o.params:k=new ws({fromObject:o.params})),r=new Ly(e,n,o.body!==void 0?o.body:null,{headers:T,context:o.context,params:k,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials,transferCache:o.transferCache})}let g=Ni(r).pipe(Sh(T=>this.handler.handle(T)));if(e instanceof Ly||o.observe==="events")return g;let w=g.pipe(zr(T=>T instanceof l0));switch(o.observe||"body"){case"body":switch(r.responseType){case"arraybuffer":return w.pipe(hn(T=>{if(T.body!==null&&!(T.body instanceof ArrayBuffer))throw new si(2806,!1);return T.body}));case"blob":return w.pipe(hn(T=>{if(T.body!==null&&!(T.body instanceof Blob))throw new si(2807,!1);return T.body}));case"text":return w.pipe(hn(T=>{if(T.body!==null&&typeof T.body!="string")throw new si(2808,!1);return T.body}));case"json":default:return w.pipe(hn(T=>T.body))}case"response":return w;default:throw new si(2809,!1)}}delete(e,n={}){return this.request("DELETE",e,n)}get(e,n={}){return this.request("GET",e,n)}head(e,n={}){return this.request("HEAD",e,n)}jsonp(e,n){return this.request("JSONP",e,{params:new ws().append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,n={}){return this.request("OPTIONS",e,n)}patch(e,n,o={}){return this.request("PATCH",e,qO(o,n))}post(e,n,o={}){return this.request("POST",e,qO(o,n))}put(e,n,o={}){return this.request("PUT",e,qO(o,n))}static \u0275fac=function(n){return new(n||t)(bi(Fy))};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})();var $le=new Ot("");function TU(t,i){return i(t)}function Gle(t,i){return(e,n)=>i.intercept(e,{handle:o=>t(o,n)})}function Wle(t,i,e){return(n,o)=>gl(e,()=>i(n,r=>t(r,o)))}var DU=new Ot(""),GO=new Ot(""),Ox=new Ot(""),WO=new Ot("",{providedIn:"root",factory:()=>!0});function Zle(){let t=null;return(i,e)=>{t===null&&(t=(J(DU,{optional:!0})??[]).reduceRight(Gle,TU));let n=J(Ip);if(J(WO)){let r=n.add();return t(i,e).pipe(Th(()=>n.remove(r)))}else return t(i,e)}}var fT=(()=>{class t extends Fy{backend;injector;chain=null;pendingTasks=J(Ip);contributeToStability=J(WO);constructor(e,n){super(),this.backend=e,this.injector=n}handle(e){if(this.chain===null){let n=Array.from(new Set([...this.injector.get(GO),...this.injector.get(Ox,[])]));this.chain=n.reduceRight((o,r)=>Wle(o,r,this.injector),TU)}if(this.contributeToStability){let n=this.pendingTasks.add();return this.chain(e,o=>this.backend.handle(o)).pipe(Th(()=>this.pendingTasks.remove(n)))}else return this.chain(e,n=>this.backend.handle(n))}static \u0275fac=function(n){return new(n||t)(bi(Ax),bi(Ea))};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})();var Yle=/^\)\]\}',?\n/,Kle=RegExp(`^${EU}:`,"m");function Xle(t){return"responseURL"in t&&t.responseURL?t.responseURL:Kle.test(t.getAllResponseHeaders())?t.getResponseHeader(EU):null}var $O=(()=>{class t{xhrFactory;constructor(e){this.xhrFactory=e}handle(e){if(e.method==="JSONP")throw new si(-2800,!1);let n=this.xhrFactory;return(n.\u0275loadImpl?bo(n.\u0275loadImpl()):Ni(null)).pipe(Za(()=>new wr(r=>{let g=n.build();if(g.open(e.method,e.urlWithParams),e.withCredentials&&(g.withCredentials=!0),e.headers.forEach((te,De)=>g.setRequestHeader(te,De.join(","))),e.headers.has(xU)||g.setRequestHeader(xU,Ule),!e.headers.has(bU)){let te=e.detectContentTypeHeader();te!==null&&g.setRequestHeader(bU,te)}if(e.responseType){let te=e.responseType.toLowerCase();g.responseType=te!=="json"?te:"text"}let w=e.serializeBody(),T=null,k=()=>{if(T!==null)return T;let te=g.statusText||"OK",De=new Lp(g.getAllResponseHeaders()),_e=Xle(g)||e.url;return T=new pT({headers:De,status:g.status,statusText:te,url:_e}),T},N=()=>{let{headers:te,status:De,statusText:_e,url:he}=k(),Ce=null;De!==qle&&(Ce=typeof g.response>"u"?g.responseText:g.response),De===0&&(De=Ce?Hle:0);let Pe=De>=200&&De<300;if(e.responseType==="json"&&typeof Ce=="string"){let ye=Ce;Ce=Ce.replace(Yle,"");try{Ce=Ce!==""?JSON.parse(Ce):null}catch(vt){Ce=ye,Pe&&(Pe=!1,Ce={error:vt,text:Ce})}}Pe?(r.next(new l0({body:Ce,headers:te,status:De,statusText:_e,url:he||void 0})),r.complete()):r.error(new Rx({error:Ce,headers:te,status:De,statusText:_e,url:he||void 0}))},V=te=>{let{url:De}=k(),_e=new Rx({error:te,status:g.status||0,statusText:g.statusText||"Unknown Error",url:De||void 0});r.error(_e)},q=!1,Z=te=>{q||(r.next(k()),q=!0);let De={type:s0.DownloadProgress,loaded:te.loaded};te.lengthComputable&&(De.total=te.total),e.responseType==="text"&&g.responseText&&(De.partialText=g.responseText),r.next(De)},X=te=>{let De={type:s0.UploadProgress,loaded:te.loaded};te.lengthComputable&&(De.total=te.total),r.next(De)};return g.addEventListener("load",N),g.addEventListener("error",V),g.addEventListener("timeout",V),g.addEventListener("abort",V),e.reportProgress&&(g.addEventListener("progress",Z),w!==null&&g.upload&&g.upload.addEventListener("progress",X)),g.send(w),r.next({type:s0.Sent}),()=>{g.removeEventListener("error",V),g.removeEventListener("abort",V),g.removeEventListener("load",N),g.removeEventListener("timeout",V),e.reportProgress&&(g.removeEventListener("progress",Z),w!==null&&g.upload&&g.upload.removeEventListener("progress",X)),g.readyState!==g.DONE&&g.abort()}})))}static \u0275fac=function(n){return new(n||t)(bi(Np))};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})(),MU=new Ot(""),Qle="XSRF-TOKEN",Jle=new Ot("",{providedIn:"root",factory:()=>Qle}),ece="X-XSRF-TOKEN",tce=new Ot("",{providedIn:"root",factory:()=>ece}),kx=class{},ice=(()=>{class t{doc;platform;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(e,n,o){this.doc=e,this.platform=n,this.cookieName=o}getToken(){if(this.platform==="server")return null;let e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=Cx(e,this.cookieName),this.lastCookieString=e),this.lastToken}static \u0275fac=function(n){return new(n||t)(bi(cn),bi(Ns),bi(Jle))};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})();function nce(t,i){let e=t.url.toLowerCase();if(!J(MU)||t.method==="GET"||t.method==="HEAD"||e.startsWith("http://")||e.startsWith("https://"))return i(t);let n=J(kx).getToken(),o=J(tce);return n!=null&&!t.headers.has(o)&&(t=t.clone({headers:t.headers.set(o,n)})),i(t)}var ZO=function(t){return t[t.Interceptors=0]="Interceptors",t[t.LegacyInterceptors=1]="LegacyInterceptors",t[t.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",t[t.NoXsrfProtection=3]="NoXsrfProtection",t[t.JsonpSupport=4]="JsonpSupport",t[t.RequestsMadeViaParent=5]="RequestsMadeViaParent",t[t.Fetch=6]="Fetch",t}(ZO||{});function rce(t,i){return{\u0275kind:t,\u0275providers:i}}function YO(...t){let i=[Qa,$O,fT,{provide:Fy,useExisting:fT},{provide:Ax,useFactory:()=>J($le,{optional:!0})??J($O)},{provide:GO,useValue:nce,multi:!0},{provide:MU,useValue:!0},{provide:kx,useClass:ice}];for(let e of t)i.push(...e.\u0275providers);return eu(i)}var wU=new Ot("");function KO(){return rce(ZO.LegacyInterceptors,[{provide:wU,useFactory:Zle},{provide:GO,useExisting:wU,multi:!0}])}var oce=new Ot(""),IU="b",AU="h",RU="s",kU="st",OU="u",PU="rt",XO=new Ot(""),ace=["GET","HEAD"];function sce(t,i){let q=J(XO),{isCacheActive:e}=q,n=Ys(q,["isCacheActive"]),{transferCache:o,method:r}=t;if(!e||o===!1||r==="POST"&&!n.includePostRequests&&!o||r!=="POST"&&!ace.includes(r)||!n.includeRequestsWithAuthHeaders&&lce(t)||n.filter?.(t)===!1)return i(t);let g=J(t0),w=J(oce,{optional:!0}),T=w?hce(t.url,w):t.url,k=uce(t,T),N=g.get(k,null),V=n.includeHeaders;if(typeof o=="object"&&o.includeHeaders&&(V=o.includeHeaders),N){let{[IU]:Z,[PU]:X,[AU]:te,[RU]:De,[kU]:_e,[OU]:he}=N,Ce=Z;switch(X){case"arraybuffer":Ce=new TextEncoder().encode(Z).buffer;break;case"blob":Ce=new Blob([Z]);break}let Pe=new Lp(te);return Ni(new l0({body:Ce,headers:Pe,status:De,statusText:_e,url:he}))}return i(t).pipe(hr(Z=>{Z instanceof l0&&g.set(k,{[IU]:Z.body,[AU]:cce(Z.headers,V),[RU]:Z.status,[kU]:Z.statusText,[OU]:T,[PU]:t.responseType})}))}function lce(t){return t.headers.has("authorization")||t.headers.has("proxy-authorization")}function cce(t,i){if(!i)return{};let e={};for(let n of i){let o=t.getAll(n);o!==null&&(e[n]=o)}return e}function NU(t){return[...t.keys()].sort().map(i=>`${i}=${t.getAll(i)}`).join("&")}function uce(t,i){let{params:e,method:n,responseType:o}=t,r=NU(e),g=t.serializeBody();g instanceof URLSearchParams?g=NU(g):typeof g!="string"&&(g="");let w=[n,o,i,g,r].join("|"),T=dce(w);return T}function dce(t){let i=0;for(let e of t)i=Math.imul(31,i)+e.charCodeAt(0)<<0;return i+=2147483648,i.toString()}function LU(t){return[{provide:XO,useFactory:()=>(yc("NgHttpTransferCache"),It({isCacheActive:!0},t))},{provide:Ox,useValue:sce,multi:!0},{provide:Ry,multi:!0,useFactory:()=>{let i=J(ms),e=J(XO);return()=>{i.whenStable().then(()=>{e.isCacheActive=!1})}}}]}function hce(t,i){let e=new URL(t,"resolve://").origin,n=i[e];return n?t.replace(e,n):t}var FU=(()=>{class t{_doc;constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}static \u0275fac=function(n){return new(n||t)(bi(cn))};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var QO=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:function(n){let o=null;return n?o=new(n||t):o=bi(pce),o},providedIn:"root"})}return t})(),pce=(()=>{class t extends QO{_doc;constructor(e){super(),this._doc=e}sanitize(e,n){if(n==null)return null;switch(e){case yl.NONE:return n;case yl.HTML:return em(n,"HTML")?kd(n):k9(this._doc,String(n)).toString();case yl.STYLE:return em(n,"Style")?kd(n):n;case yl.SCRIPT:if(em(n,"Script"))return kd(n);throw new si(5200,!1);case yl.URL:return em(n,"URL")?kd(n):MS(String(n));case yl.RESOURCE_URL:if(em(n,"ResourceURL"))return kd(n);throw new si(5201,!1);default:throw new si(5202,!1)}}bypassSecurityTrustHtml(e){return w9(e)}bypassSecurityTrustStyle(e){return E9(e)}bypassSecurityTrustScript(e){return C9(e)}bypassSecurityTrustUrl(e){return S9(e)}bypassSecurityTrustResourceUrl(e){return T9(e)}static \u0275fac=function(n){return new(n||t)(bi(cn))};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),mT=function(t){return t[t.NoHttpTransferCache=0]="NoHttpTransferCache",t[t.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",t[t.I18nSupport=2]="I18nSupport",t[t.EventReplay=3]="EventReplay",t[t.IncrementalHydration=4]="IncrementalHydration",t}(mT||{});function fce(t,i=[],e={}){return{\u0275kind:t,\u0275providers:i}}function zU(){return fce(mT.EventReplay,Ej())}function BU(...t){let i=[],e=new Set;for(let{\u0275providers:o,\u0275kind:r}of t)e.add(r),o.length&&i.push(o);let n=e.has(mT.HttpTransferCacheOptions);return eu([[],Aj(),e.has(mT.NoHttpTransferCache)||n?[]:LU({}),i])}var br="primary",Gx=Symbol("RouteTitle"),nP=class{params;constructor(i){this.params=i||{}}has(i){return Object.prototype.hasOwnProperty.call(this.params,i)}get(i){if(this.has(i)){let e=this.params[i];return Array.isArray(e)?e[0]:e}return null}getAll(i){if(this.has(i)){let e=this.params[i];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}};function d0(t){return new nP(t)}function ZU(t,i,e){let n=e.path.split("/");if(n.length>t.length||e.pathMatch==="full"&&(i.hasChildren()||n.length<t.length))return null;let o={};for(let r=0;r<n.length;r++){let g=n[r],w=t[r];if(g[0]===":")o[g.substring(1)]=w;else if(g!==w.path)return null}return{consumed:t.slice(0,n.length),posParams:o}}function mce(t,i){if(t.length!==i.length)return!1;for(let e=0;e<t.length;++e)if(!Fh(t[e],i[e]))return!1;return!0}function Fh(t,i){let e=t?rP(t):void 0,n=i?rP(i):void 0;if(!e||!n||e.length!=n.length)return!1;let o;for(let r=0;r<e.length;r++)if(o=e[r],!YU(t[o],i[o]))return!1;return!0}function rP(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function YU(t,i){if(Array.isArray(t)&&Array.isArray(i)){if(t.length!==i.length)return!1;let e=[...t].sort(),n=[...i].sort();return e.every((o,r)=>n[r]===o)}else return t===i}function KU(t){return t.length>0?t[t.length-1]:null}function hm(t){return ry(t)?t:im(t)?bo(Promise.resolve(t)):Ni(t)}var gce={exact:QU,subset:JU},XU={exact:_ce,subset:yce,ignored:()=>!0};function jU(t,i,e){return gce[e.paths](t.root,i.root,e.matrixParams)&&XU[e.queryParams](t.queryParams,i.queryParams)&&!(e.fragment==="exact"&&t.fragment!==i.fragment)}function _ce(t,i){return Fh(t,i)}function QU(t,i,e){if(!c0(t.segments,i.segments)||!yT(t.segments,i.segments,e)||t.numberOfChildren!==i.numberOfChildren)return!1;for(let n in i.children)if(!t.children[n]||!QU(t.children[n],i.children[n],e))return!1;return!0}function yce(t,i){return Object.keys(i).length<=Object.keys(t).length&&Object.keys(i).every(e=>YU(t[e],i[e]))}function JU(t,i,e){return eH(t,i,i.segments,e)}function eH(t,i,e,n){if(t.segments.length>e.length){let o=t.segments.slice(0,e.length);return!(!c0(o,e)||i.hasChildren()||!yT(o,e,n))}else if(t.segments.length===e.length){if(!c0(t.segments,e)||!yT(t.segments,e,n))return!1;for(let o in i.children)if(!t.children[o]||!JU(t.children[o],i.children[o],n))return!1;return!0}else{let o=e.slice(0,t.segments.length),r=e.slice(t.segments.length);return!c0(t.segments,o)||!yT(t.segments,o,n)||!t.children[br]?!1:eH(t.children[br],i,r,n)}}function yT(t,i,e){return i.every((n,o)=>XU[e](t[o].parameters,n.parameters))}var Bh=class{root;queryParams;fragment;_queryParamMap;constructor(i=new so([],{}),e={},n=null){this.root=i,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap??=d0(this.queryParams),this._queryParamMap}toString(){return xce.serialize(this)}},so=class{segments;children;parent=null;constructor(i,e){this.segments=i,this.children=e,Object.values(e).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return vT(this)}},lm=class{path;parameters;_parameterMap;constructor(i,e){this.path=i,this.parameters=e}get parameterMap(){return this._parameterMap??=d0(this.parameters),this._parameterMap}toString(){return iH(this)}};function vce(t,i){return c0(t,i)&&t.every((e,n)=>Fh(e.parameters,i[n].parameters))}function c0(t,i){return t.length!==i.length?!1:t.every((e,n)=>e.path===i[n].path)}function bce(t,i){let e=[];return Object.entries(t.children).forEach(([n,o])=>{n===br&&(e=e.concat(i(o,n)))}),Object.entries(t.children).forEach(([n,o])=>{n!==br&&(e=e.concat(i(o,n)))}),e}var h0=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:()=>new cm,providedIn:"root"})}return t})(),cm=class{parse(i){let e=new aP(i);return new Bh(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(i){let e=`/${Px(i.root,!0)}`,n=Cce(i.queryParams),o=typeof i.fragment=="string"?`#${wce(i.fragment)}`:"";return`${e}${n}${o}`}},xce=new cm;function vT(t){return t.segments.map(i=>iH(i)).join("/")}function Px(t,i){if(!t.hasChildren())return vT(t);if(i){let e=t.children[br]?Px(t.children[br],!1):"",n=[];return Object.entries(t.children).forEach(([o,r])=>{o!==br&&n.push(`${o}:${Px(r,!1)}`)}),n.length>0?`${e}(${n.join("//")})`:e}else{let e=bce(t,(n,o)=>o===br?[Px(t.children[br],!1)]:[`${o}:${Px(n,!1)}`]);return Object.keys(t.children).length===1&&t.children[br]!=null?`${vT(t)}/${e[0]}`:`${vT(t)}/(${e.join("//")})`}}function tH(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function gT(t){return tH(t).replace(/%3B/gi,";")}function wce(t){return encodeURI(t)}function oP(t){return tH(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function bT(t){return decodeURIComponent(t)}function UU(t){return bT(t.replace(/\+/g,"%20"))}function iH(t){return`${oP(t.path)}${Ece(t.parameters)}`}function Ece(t){return Object.entries(t).map(([i,e])=>`;${oP(i)}=${oP(e)}`).join("")}function Cce(t){let i=Object.entries(t).map(([e,n])=>Array.isArray(n)?n.map(o=>`${gT(e)}=${gT(o)}`).join("&"):`${gT(e)}=${gT(n)}`).filter(e=>e);return i.length?`?${i.join("&")}`:""}var Sce=/^[^\/()?;#]+/;function JO(t){let i=t.match(Sce);return i?i[0]:""}var Tce=/^[^\/()?;=#]+/;function Dce(t){let i=t.match(Tce);return i?i[0]:""}var Mce=/^[^=?&#]+/;function Ice(t){let i=t.match(Mce);return i?i[0]:""}var Ace=/^[^&#]+/;function Rce(t){let i=t.match(Ace);return i?i[0]:""}var aP=class{url;remaining;constructor(i){this.url=i,this.remaining=i}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new so([],{}):new so([],this.parseChildren())}parseQueryParams(){let i={};if(this.consumeOptional("?"))do this.parseQueryParam(i);while(this.consumeOptional("&"));return i}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let i=[];for(this.peekStartsWith("(")||i.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),i.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(i.length>0||Object.keys(e).length>0)&&(n[br]=new so(i,e)),n}parseSegment(){let i=JO(this.remaining);if(i===""&&this.peekStartsWith(";"))throw new si(4009,!1);return this.capture(i),new lm(bT(i),this.parseMatrixParams())}parseMatrixParams(){let i={};for(;this.consumeOptional(";");)this.parseParam(i);return i}parseParam(i){let e=Dce(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){let o=JO(this.remaining);o&&(n=o,this.capture(n))}i[bT(e)]=bT(n)}parseQueryParam(i){let e=Ice(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){let g=Rce(this.remaining);g&&(n=g,this.capture(n))}let o=UU(e),r=UU(n);if(i.hasOwnProperty(o)){let g=i[o];Array.isArray(g)||(g=[g],i[o]=g),g.push(r)}else i[o]=r}parseParens(i){let e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let n=JO(this.remaining),o=this.remaining[n.length];if(o!=="/"&&o!==")"&&o!==";")throw new si(4010,!1);let r;n.indexOf(":")>-1?(r=n.slice(0,n.indexOf(":")),this.capture(r),this.capture(":")):i&&(r=br);let g=this.parseChildren();e[r]=Object.keys(g).length===1?g[br]:new so([],g),this.consumeOptional("//")}return e}peekStartsWith(i){return this.remaining.startsWith(i)}consumeOptional(i){return this.peekStartsWith(i)?(this.remaining=this.remaining.substring(i.length),!0):!1}capture(i){if(!this.consumeOptional(i))throw new si(4011,!1)}};function nH(t){return t.segments.length>0?new so([],{[br]:t}):t}function rH(t){let i={};for(let[n,o]of Object.entries(t.children)){let r=rH(o);if(n===br&&r.segments.length===0&&r.hasChildren())for(let[g,w]of Object.entries(r.children))i[g]=w;else(r.segments.length>0||r.hasChildren())&&(i[n]=r)}let e=new so(t.segments,i);return kce(e)}function kce(t){if(t.numberOfChildren===1&&t.children[br]){let i=t.children[br];return new so(t.segments.concat(i.segments),i.children)}return t}function um(t){return t instanceof Bh}function oH(t,i,e=null,n=null){let o=aH(t);return sH(o,i,e,n)}function aH(t){let i;function e(r){let g={};for(let T of r.children){let k=e(T);g[T.outlet]=k}let w=new so(r.url,g);return r===t&&(i=w),w}let n=e(t.root),o=nH(n);return i??o}function sH(t,i,e,n){let o=t;for(;o.parent;)o=o.parent;if(i.length===0)return eP(o,o,o,e,n);let r=Oce(i);if(r.toRoot())return eP(o,o,new so([],{}),e,n);let g=Pce(r,o,t),w=g.processChildren?Lx(g.segmentGroup,g.index,r.commands):cH(g.segmentGroup,g.index,r.commands);return eP(o,g.segmentGroup,w,e,n)}function wT(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function zx(t){return typeof t=="object"&&t!=null&&t.outlets}function eP(t,i,e,n,o){let r={};n&&Object.entries(n).forEach(([T,k])=>{r[T]=Array.isArray(k)?k.map(N=>`${N}`):`${k}`});let g;t===i?g=e:g=lH(t,i,e);let w=nH(rH(g));return new Bh(w,r,o)}function lH(t,i,e){let n={};return Object.entries(t.children).forEach(([o,r])=>{r===i?n[o]=e:n[o]=lH(r,i,e)}),new so(t.segments,n)}var ET=class{isAbsolute;numberOfDoubleDots;commands;constructor(i,e,n){if(this.isAbsolute=i,this.numberOfDoubleDots=e,this.commands=n,i&&n.length>0&&wT(n[0]))throw new si(4003,!1);let o=n.find(zx);if(o&&o!==KU(n))throw new si(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function Oce(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new ET(!0,0,t);let i=0,e=!1,n=t.reduce((o,r,g)=>{if(typeof r=="object"&&r!=null){if(r.outlets){let w={};return Object.entries(r.outlets).forEach(([T,k])=>{w[T]=typeof k=="string"?k.split("/"):k}),[...o,{outlets:w}]}if(r.segmentPath)return[...o,r.segmentPath]}return typeof r!="string"?[...o,r]:g===0?(r.split("/").forEach((w,T)=>{T==0&&w==="."||(T==0&&w===""?e=!0:w===".."?i++:w!=""&&o.push(w))}),o):[...o,r]},[]);return new ET(e,i,n)}var jy=class{segmentGroup;processChildren;index;constructor(i,e,n){this.segmentGroup=i,this.processChildren=e,this.index=n}};function Pce(t,i,e){if(t.isAbsolute)return new jy(i,!0,0);if(!e)return new jy(i,!1,NaN);if(e.parent===null)return new jy(e,!0,0);let n=wT(t.commands[0])?0:1,o=e.segments.length-1+n;return Nce(e,o,t.numberOfDoubleDots)}function Nce(t,i,e){let n=t,o=i,r=e;for(;r>o;){if(r-=o,n=n.parent,!n)throw new si(4005,!1);o=n.segments.length}return new jy(n,!1,o-r)}function Lce(t){return zx(t[0])?t[0].outlets:{[br]:t}}function cH(t,i,e){if(t??=new so([],{}),t.segments.length===0&&t.hasChildren())return Lx(t,i,e);let n=Fce(t,i,e),o=e.slice(n.commandIndex);if(n.match&&n.pathIndex<t.segments.length){let r=new so(t.segments.slice(0,n.pathIndex),{});return r.children[br]=new so(t.segments.slice(n.pathIndex),t.children),Lx(r,0,o)}else return n.match&&o.length===0?new so(t.segments,{}):n.match&&!t.hasChildren()?sP(t,i,e):n.match?Lx(t,0,o):sP(t,i,e)}function Lx(t,i,e){if(e.length===0)return new so(t.segments,{});{let n=Lce(e),o={};if(Object.keys(n).some(r=>r!==br)&&t.children[br]&&t.numberOfChildren===1&&t.children[br].segments.length===0){let r=Lx(t.children[br],i,e);return new so(t.segments,r.children)}return Object.entries(n).forEach(([r,g])=>{typeof g=="string"&&(g=[g]),g!==null&&(o[r]=cH(t.children[r],i,g))}),Object.entries(t.children).forEach(([r,g])=>{n[r]===void 0&&(o[r]=g)}),new so(t.segments,o)}}function Fce(t,i,e){let n=0,o=i,r={match:!1,pathIndex:0,commandIndex:0};for(;o<t.segments.length;){if(n>=e.length)return r;let g=t.segments[o],w=e[n];if(zx(w))break;let T=`${w}`,k=n<e.length-1?e[n+1]:null;if(o>0&&T===void 0)break;if(T&&k&&typeof k=="object"&&k.outlets===void 0){if(!qU(T,k,g))return r;n+=2}else{if(!qU(T,{},g))return r;n++}o++}return{match:!0,pathIndex:o,commandIndex:n}}function sP(t,i,e){let n=t.segments.slice(0,i),o=0;for(;o<e.length;){let r=e[o];if(zx(r)){let T=zce(r.outlets);return new so(n,T)}if(o===0&&wT(e[0])){let T=t.segments[i];n.push(new lm(T.path,HU(e[0]))),o++;continue}let g=zx(r)?r.outlets[br]:`${r}`,w=o<e.length-1?e[o+1]:null;g&&w&&wT(w)?(n.push(new lm(g,HU(w))),o+=2):(n.push(new lm(g,{})),o++)}return new so(n,{})}function zce(t){let i={};return Object.entries(t).forEach(([e,n])=>{typeof n=="string"&&(n=[n]),n!==null&&(i[e]=sP(new so([],{}),0,n))}),i}function HU(t){let i={};return Object.entries(t).forEach(([e,n])=>i[e]=`${n}`),i}function qU(t,i,e){return t==e.path&&Fh(i,e.parameters)}var xT="imperative",Es=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(Es||{}),iu=class{id;url;constructor(i,e){this.id=i,this.url=e}},dm=class extends iu{type=Es.NavigationStart;navigationTrigger;restoredState;constructor(i,e,n="imperative",o=null){super(i,e),this.navigationTrigger=n,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Bu=class extends iu{urlAfterRedirects;type=Es.NavigationEnd;constructor(i,e,n){super(i,e),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Sc=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(Sc||{}),Hy=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(Hy||{}),zh=class extends iu{reason;code;type=Es.NavigationCancel;constructor(i,e,n,o){super(i,e),this.reason=n,this.code=o}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Vh=class extends iu{reason;code;type=Es.NavigationSkipped;constructor(i,e,n,o){super(i,e),this.reason=n,this.code=o}},qy=class extends iu{error;target;type=Es.NavigationError;constructor(i,e,n,o){super(i,e),this.error=n,this.target=o}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Bx=class extends iu{urlAfterRedirects;state;type=Es.RoutesRecognized;constructor(i,e,n,o){super(i,e),this.urlAfterRedirects=n,this.state=o}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},CT=class extends iu{urlAfterRedirects;state;type=Es.GuardsCheckStart;constructor(i,e,n,o){super(i,e),this.urlAfterRedirects=n,this.state=o}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ST=class extends iu{urlAfterRedirects;state;shouldActivate;type=Es.GuardsCheckEnd;constructor(i,e,n,o,r){super(i,e),this.urlAfterRedirects=n,this.state=o,this.shouldActivate=r}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},TT=class extends iu{urlAfterRedirects;state;type=Es.ResolveStart;constructor(i,e,n,o){super(i,e),this.urlAfterRedirects=n,this.state=o}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},DT=class extends iu{urlAfterRedirects;state;type=Es.ResolveEnd;constructor(i,e,n,o){super(i,e),this.urlAfterRedirects=n,this.state=o}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},MT=class{route;type=Es.RouteConfigLoadStart;constructor(i){this.route=i}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},IT=class{route;type=Es.RouteConfigLoadEnd;constructor(i){this.route=i}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},AT=class{snapshot;type=Es.ChildActivationStart;constructor(i){this.snapshot=i}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},RT=class{snapshot;type=Es.ChildActivationEnd;constructor(i){this.snapshot=i}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},kT=class{snapshot;type=Es.ActivationStart;constructor(i){this.snapshot=i}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},OT=class{snapshot;type=Es.ActivationEnd;constructor(i){this.snapshot=i}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},$y=class{routerEvent;position;anchor;type=Es.Scroll;constructor(i,e,n){this.routerEvent=i,this.position=e,this.anchor=n}toString(){let i=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${i}')`}},Vx=class{},Gy=class{url;navigationBehaviorOptions;constructor(i,e){this.url=i,this.navigationBehaviorOptions=e}};function Bce(t,i){return t.providers&&!t._injector&&(t._injector=ux(t.providers,i,`Route: ${t.path}`)),t._injector??i}function Fd(t){return t.outlet||br}function Vce(t,i){let e=t.filter(n=>Fd(n)===i);return e.push(...t.filter(n=>Fd(n)!==i)),e}function Wx(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let i=t.parent;i;i=i.parent){let e=i.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}var PT=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return Wx(this.route?.snapshot)??this.rootInjector}constructor(i){this.rootInjector=i,this.children=new p0(this.rootInjector)}},p0=(()=>{class t{rootInjector;contexts=new Map;constructor(e){this.rootInjector=e}onChildOutletCreated(e,n){let o=this.getOrCreateContext(e);o.outlet=n,this.contexts.set(e,o)}onChildOutletDestroyed(e){let n=this.getContext(e);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){let e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let n=this.getContext(e);return n||(n=new PT(this.rootInjector),this.contexts.set(e,n)),n}getContext(e){return this.contexts.get(e)||null}static \u0275fac=function(n){return new(n||t)(bi(Ea))};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),NT=class{_root;constructor(i){this._root=i}get root(){return this._root.value}parent(i){let e=this.pathFromRoot(i);return e.length>1?e[e.length-2]:null}children(i){let e=lP(i,this._root);return e?e.children.map(n=>n.value):[]}firstChild(i){let e=lP(i,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(i){let e=cP(i,this._root);return e.length<2?[]:e[e.length-2].children.map(o=>o.value).filter(o=>o!==i)}pathFromRoot(i){return cP(i,this._root).map(e=>e.value)}};function lP(t,i){if(t===i.value)return i;for(let e of i.children){let n=lP(t,e);if(n)return n}return null}function cP(t,i){if(t===i.value)return[i];for(let e of i.children){let n=cP(t,e);if(n.length)return n.unshift(i),n}return[]}var tu=class{value;children;constructor(i,e){this.value=i,this.children=e}toString(){return`TreeNode(${this.value})`}};function Vy(t){let i={};return t&&t.children.forEach(e=>i[e.value.outlet]=e),i}var jx=class extends NT{snapshot;constructor(i,e){super(i),this.snapshot=e,_P(this,i)}toString(){return this.snapshot.toString()}};function uH(t){let i=jce(t),e=new to([new lm("",{})]),n=new to({}),o=new to({}),r=new to({}),g=new to(""),w=new Tc(e,n,r,g,o,br,t,i.root);return w.snapshot=i.root,new jx(new tu(w,[]),i)}function jce(t){let i={},e={},n={},o="",r=new u0([],i,n,o,e,br,t,null,{});return new Ux("",new tu(r,[]))}var Tc=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(i,e,n,o,r,g,w,T){this.urlSubject=i,this.paramsSubject=e,this.queryParamsSubject=n,this.fragmentSubject=o,this.dataSubject=r,this.outlet=g,this.component=w,this._futureSnapshot=T,this.title=this.dataSubject?.pipe(hn(k=>k[Gx]))??Ni(void 0),this.url=i,this.params=e,this.queryParams=n,this.fragment=o,this.data=r}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(hn(i=>d0(i))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(hn(i=>d0(i))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function LT(t,i,e="emptyOnly"){let n,{routeConfig:o}=t;return i!==null&&(e==="always"||o?.path===""||!i.component&&!i.routeConfig?.loadComponent)?n={params:It(It({},i.params),t.params),data:It(It({},i.data),t.data),resolve:It(It(It(It({},t.data),i.data),o?.data),t._resolvedData)}:n={params:It({},t.params),data:It({},t.data),resolve:It(It({},t.data),t._resolvedData??{})},o&&hH(o)&&(n.resolve[Gx]=o.title),n}var u0=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Gx]}constructor(i,e,n,o,r,g,w,T,k){this.url=i,this.params=e,this.queryParams=n,this.fragment=o,this.data=r,this.outlet=g,this.component=w,this.routeConfig=T,this._resolve=k}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=d0(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=d0(this.queryParams),this._queryParamMap}toString(){let i=this.url.map(n=>n.toString()).join("/"),e=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${i}', path:'${e}')`}},Ux=class extends NT{url;constructor(i,e){super(e),this.url=i,_P(this,e)}toString(){return dH(this._root)}};function _P(t,i){i.value._routerState=t,i.children.forEach(e=>_P(t,e))}function dH(t){let i=t.children.length>0?` { ${t.children.map(dH).join(", ")} } `:"";return`${t.value}${i}`}function tP(t){if(t.snapshot){let i=t.snapshot,e=t._futureSnapshot;t.snapshot=e,Fh(i.queryParams,e.queryParams)||t.queryParamsSubject.next(e.queryParams),i.fragment!==e.fragment&&t.fragmentSubject.next(e.fragment),Fh(i.params,e.params)||t.paramsSubject.next(e.params),mce(i.url,e.url)||t.urlSubject.next(e.url),Fh(i.data,e.data)||t.dataSubject.next(e.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function uP(t,i){let e=Fh(t.params,i.params)&&vce(t.url,i.url),n=!t.parent!=!i.parent;return e&&!n&&(!t.parent||uP(t.parent,i.parent))}function hH(t){return typeof t.title=="string"||t.title===null}var pH=new Ot(""),Zx=(()=>{class t{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=br;activateEvents=new Mi;deactivateEvents=new Mi;attachEvents=new Mi;detachEvents=new Mi;routerOutletData=XV(void 0);parentContexts=J(p0);location=J(na);changeDetector=J(vr);inputBinder=J(Yx,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(e){if(e.name){let{firstChange:n,previousValue:o}=e.name;if(n)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new si(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new si(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new si(4012,!1);this.location.detach();let e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,n){this.activated=e,this._activatedRoute=n,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){let e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,n){if(this.isActivated)throw new si(4013,!1);this._activatedRoute=e;let o=this.location,g=e.snapshot.component,w=this.parentContexts.getOrCreateContext(this.name).children,T=new dP(e,w,o.injector,this.routerOutletData);this.activated=o.createComponent(g,{index:o.length,injector:T,environmentInjector:n}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[$r]})}return t})(),dP=class{route;childContexts;parent;outletData;constructor(i,e,n,o){this.route=i,this.childContexts=e,this.parent=n,this.outletData=o}get(i,e){return i===Tc?this.route:i===p0?this.childContexts:i===pH?this.outletData:this.parent.get(i,e)}},Yx=new Ot(""),yP=(()=>{class t{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(e){this.unsubscribeFromRouteData(e),this.subscribeToRouteData(e)}unsubscribeFromRouteData(e){this.outletDataSubscriptions.get(e)?.unsubscribe(),this.outletDataSubscriptions.delete(e)}subscribeToRouteData(e){let{activatedRoute:n}=e,o=Ng([n.queryParams,n.params,n.data]).pipe(Za(([r,g,w],T)=>(w=It(It(It({},r),g),w),T===0?Ni(w):Promise.resolve(w)))).subscribe(r=>{if(!e.isActivated||!e.activatedComponentRef||e.activatedRoute!==n||n.component===null){this.unsubscribeFromRouteData(e);return}let g=Pj(n.component);if(!g){this.unsubscribeFromRouteData(e);return}for(let{templateName:w}of g.inputs)e.activatedComponentRef.setInput(w,r[w])});this.outletDataSubscriptions.set(e,o)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})();function Uce(t,i,e){let n=Hx(t,i._root,e?e._root:void 0);return new jx(n,i)}function Hx(t,i,e){if(e&&t.shouldReuseRoute(i.value,e.value.snapshot)){let n=e.value;n._futureSnapshot=i.value;let o=Hce(t,i,e);return new tu(n,o)}else{if(t.shouldAttach(i.value)){let r=t.retrieve(i.value);if(r!==null){let g=r.route;return g.value._futureSnapshot=i.value,g.children=i.children.map(w=>Hx(t,w)),g}}let n=qce(i.value),o=i.children.map(r=>Hx(t,r));return new tu(n,o)}}function Hce(t,i,e){return i.children.map(n=>{for(let o of e.children)if(t.shouldReuseRoute(n.value,o.value.snapshot))return Hx(t,n,o);return Hx(t,n)})}function qce(t){return new Tc(new to(t.url),new to(t.params),new to(t.queryParams),new to(t.fragment),new to(t.data),t.outlet,t.component,t)}var Wy=class{redirectTo;navigationBehaviorOptions;constructor(i,e){this.redirectTo=i,this.navigationBehaviorOptions=e}},fH="ngNavigationCancelingError";function FT(t,i){let{redirectTo:e,navigationBehaviorOptions:n}=um(i)?{redirectTo:i,navigationBehaviorOptions:void 0}:i,o=mH(!1,Sc.Redirect);return o.url=e,o.navigationBehaviorOptions=n,o}function mH(t,i){let e=new Error(`NavigationCancelingError: ${t||""}`);return e[fH]=!0,e.cancellationCode=i,e}function $ce(t){return gH(t)&&um(t.url)}function gH(t){return!!t&&t[fH]}var Gce=(t,i,e,n)=>hn(o=>(new hP(i,o.targetRouterState,o.currentRouterState,e,n).activate(t),o)),hP=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(i,e,n,o,r){this.routeReuseStrategy=i,this.futureState=e,this.currState=n,this.forwardEvent=o,this.inputBindingEnabled=r}activate(i){let e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,i),tP(this.futureState.root),this.activateChildRoutes(e,n,i)}deactivateChildRoutes(i,e,n){let o=Vy(e);i.children.forEach(r=>{let g=r.value.outlet;this.deactivateRoutes(r,o[g],n),delete o[g]}),Object.values(o).forEach(r=>{this.deactivateRouteAndItsChildren(r,n)})}deactivateRoutes(i,e,n){let o=i.value,r=e?e.value:null;if(o===r)if(o.component){let g=n.getContext(o.outlet);g&&this.deactivateChildRoutes(i,e,g.children)}else this.deactivateChildRoutes(i,e,n);else r&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(i,e){i.value.component&&this.routeReuseStrategy.shouldDetach(i.value.snapshot)?this.detachAndStoreRouteSubtree(i,e):this.deactivateRouteAndOutlet(i,e)}detachAndStoreRouteSubtree(i,e){let n=e.getContext(i.value.outlet),o=n&&i.value.component?n.children:e,r=Vy(i);for(let g of Object.values(r))this.deactivateRouteAndItsChildren(g,o);if(n&&n.outlet){let g=n.outlet.detach(),w=n.children.onOutletDeactivated();this.routeReuseStrategy.store(i.value.snapshot,{componentRef:g,route:i,contexts:w})}}deactivateRouteAndOutlet(i,e){let n=e.getContext(i.value.outlet),o=n&&i.value.component?n.children:e,r=Vy(i);for(let g of Object.values(r))this.deactivateRouteAndItsChildren(g,o);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(i,e,n){let o=Vy(e);i.children.forEach(r=>{this.activateRoutes(r,o[r.value.outlet],n),this.forwardEvent(new OT(r.value.snapshot))}),i.children.length&&this.forwardEvent(new RT(i.value.snapshot))}activateRoutes(i,e,n){let o=i.value,r=e?e.value:null;if(tP(o),o===r)if(o.component){let g=n.getOrCreateContext(o.outlet);this.activateChildRoutes(i,e,g.children)}else this.activateChildRoutes(i,e,n);else if(o.component){let g=n.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){let w=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),g.children.onOutletReAttached(w.contexts),g.attachRef=w.componentRef,g.route=w.route.value,g.outlet&&g.outlet.attach(w.componentRef,w.route.value),tP(w.route.value),this.activateChildRoutes(i,null,g.children)}else g.attachRef=null,g.route=o,g.outlet&&g.outlet.activateWith(o,g.injector),this.activateChildRoutes(i,null,g.children)}else this.activateChildRoutes(i,null,n)}},zT=class{path;route;constructor(i){this.path=i,this.route=this.path[this.path.length-1]}},Uy=class{component;route;constructor(i,e){this.component=i,this.route=e}};function Wce(t,i,e){let n=t._root,o=i?i._root:null;return Nx(n,o,e,[n.value])}function Zce(t){let i=t.routeConfig?t.routeConfig.canActivateChild:null;return!i||i.length===0?null:{node:t,guards:i}}function Yy(t,i){let e=Symbol(),n=i.get(t,e);return n===e?typeof t=="function"&&!YB(t)?t:i.get(t):n}function Nx(t,i,e,n,o={canDeactivateChecks:[],canActivateChecks:[]}){let r=Vy(i);return t.children.forEach(g=>{Yce(g,r[g.value.outlet],e,n.concat([g.value]),o),delete r[g.value.outlet]}),Object.entries(r).forEach(([g,w])=>Fx(w,e.getContext(g),o)),o}function Yce(t,i,e,n,o={canDeactivateChecks:[],canActivateChecks:[]}){let r=t.value,g=i?i.value:null,w=e?e.getContext(t.value.outlet):null;if(g&&r.routeConfig===g.routeConfig){let T=Kce(g,r,r.routeConfig.runGuardsAndResolvers);T?o.canActivateChecks.push(new zT(n)):(r.data=g.data,r._resolvedData=g._resolvedData),r.component?Nx(t,i,w?w.children:null,n,o):Nx(t,i,e,n,o),T&&w&&w.outlet&&w.outlet.isActivated&&o.canDeactivateChecks.push(new Uy(w.outlet.component,g))}else g&&Fx(i,w,o),o.canActivateChecks.push(new zT(n)),r.component?Nx(t,null,w?w.children:null,n,o):Nx(t,null,e,n,o);return o}function Kce(t,i,e){if(typeof e=="function")return e(t,i);switch(e){case"pathParamsChange":return!c0(t.url,i.url);case"pathParamsOrQueryParamsChange":return!c0(t.url,i.url)||!Fh(t.queryParams,i.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!uP(t,i)||!Fh(t.queryParams,i.queryParams);case"paramsChange":default:return!uP(t,i)}}function Fx(t,i,e){let n=Vy(t),o=t.value;Object.entries(n).forEach(([r,g])=>{o.component?i?Fx(g,i.children.getContext(r),e):Fx(g,null,e):Fx(g,i,e)}),o.component?i&&i.outlet&&i.outlet.isActivated?e.canDeactivateChecks.push(new Uy(i.outlet.component,o)):e.canDeactivateChecks.push(new Uy(null,o)):e.canDeactivateChecks.push(new Uy(null,o))}function Kx(t){return typeof t=="function"}function Xce(t){return typeof t=="boolean"}function Qce(t){return t&&Kx(t.canLoad)}function Jce(t){return t&&Kx(t.canActivate)}function eue(t){return t&&Kx(t.canActivateChild)}function tue(t){return t&&Kx(t.canDeactivate)}function iue(t){return t&&Kx(t.canMatch)}function _H(t){return t instanceof vp||t?.name==="EmptyError"}var _T=Symbol("INITIAL_VALUE");function Zy(){return Za(t=>Ng(t.map(i=>i.pipe(ta(1),ia(_T)))).pipe(hn(i=>{for(let e of i)if(e!==!0){if(e===_T)return _T;if(e===!1||nue(e))return e}return!0}),zr(i=>i!==_T),ta(1)))}function nue(t){return um(t)||t instanceof Wy}function rue(t,i){return Na(e=>{let{targetSnapshot:n,currentSnapshot:o,guards:{canActivateChecks:r,canDeactivateChecks:g}}=e;return g.length===0&&r.length===0?Ni(ji(It({},e),{guardsResult:!0})):oue(g,n,o,t).pipe(Na(w=>w&&Xce(w)?aue(n,r,t,i):Ni(w)),hn(w=>ji(It({},e),{guardsResult:w})))})}function oue(t,i,e,n){return bo(t).pipe(Na(o=>due(o.component,o.route,e,i,n)),bp(o=>o!==!0,!0))}function aue(t,i,e,n){return bo(i).pipe(Sh(o=>jf(lue(o.route.parent,n),sue(o.route,n),uue(t,o.path,e),cue(t,o.route,e))),bp(o=>o!==!0,!0))}function sue(t,i){return t!==null&&i&&i(new kT(t)),Ni(!0)}function lue(t,i){return t!==null&&i&&i(new AT(t)),Ni(!0)}function cue(t,i,e){let n=i.routeConfig?i.routeConfig.canActivate:null;if(!n||n.length===0)return Ni(!0);let o=n.map(r=>Ch(()=>{let g=Wx(i)??e,w=Yy(r,g),T=Jce(w)?w.canActivate(i,t):gl(g,()=>w(i,t));return hm(T).pipe(bp())}));return Ni(o).pipe(Zy())}function uue(t,i,e){let n=i[i.length-1],r=i.slice(0,i.length-1).reverse().map(g=>Zce(g)).filter(g=>g!==null).map(g=>Ch(()=>{let w=g.guards.map(T=>{let k=Wx(g.node)??e,N=Yy(T,k),V=eue(N)?N.canActivateChild(n,t):gl(k,()=>N(n,t));return hm(V).pipe(bp())});return Ni(w).pipe(Zy())}));return Ni(r).pipe(Zy())}function due(t,i,e,n,o){let r=i&&i.routeConfig?i.routeConfig.canDeactivate:null;if(!r||r.length===0)return Ni(!0);let g=r.map(w=>{let T=Wx(i)??o,k=Yy(w,T),N=tue(k)?k.canDeactivate(t,i,e,n):gl(T,()=>k(t,i,e,n));return hm(N).pipe(bp())});return Ni(g).pipe(Zy())}function hue(t,i,e,n){let o=i.canLoad;if(o===void 0||o.length===0)return Ni(!0);let r=o.map(g=>{let w=Yy(g,t),T=Qce(w)?w.canLoad(i,e):gl(t,()=>w(i,e));return hm(T)});return Ni(r).pipe(Zy(),yH(n))}function yH(t){return SR(hr(i=>{if(typeof i!="boolean")throw FT(t,i)}),hn(i=>i===!0))}function pue(t,i,e,n){let o=i.canMatch;if(!o||o.length===0)return Ni(!0);let r=o.map(g=>{let w=Yy(g,t),T=iue(w)?w.canMatch(i,e):gl(t,()=>w(i,e));return hm(T)});return Ni(r).pipe(Zy(),yH(n))}var qx=class{segmentGroup;constructor(i){this.segmentGroup=i||null}},$x=class extends Error{urlTree;constructor(i){super(),this.urlTree=i}};function By(t){return wa(new qx(t))}function fue(t){return wa(new si(4e3,!1))}function mue(t){return wa(mH(!1,Sc.GuardRejected))}var pP=class{urlSerializer;urlTree;constructor(i,e){this.urlSerializer=i,this.urlTree=e}lineralizeSegments(i,e){let n=[],o=e.root;for(;;){if(n=n.concat(o.segments),o.numberOfChildren===0)return Ni(n);if(o.numberOfChildren>1||!o.children[br])return fue(`${i.redirectTo}`);o=o.children[br]}}applyRedirectCommands(i,e,n,o,r){if(typeof e!="string"){let w=e,{queryParams:T,fragment:k,routeConfig:N,url:V,outlet:q,params:Z,data:X,title:te}=o,De=gl(r,()=>w({params:Z,data:X,queryParams:T,fragment:k,routeConfig:N,url:V,outlet:q,title:te}));if(De instanceof Bh)throw new $x(De);e=De}let g=this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),i,n);if(e[0]==="/")throw new $x(g);return g}applyRedirectCreateUrlTree(i,e,n,o){let r=this.createSegmentGroup(i,e.root,n,o);return new Bh(r,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(i,e){let n={};return Object.entries(i).forEach(([o,r])=>{if(typeof r=="string"&&r[0]===":"){let w=r.substring(1);n[o]=e[w]}else n[o]=r}),n}createSegmentGroup(i,e,n,o){let r=this.createSegments(i,e.segments,n,o),g={};return Object.entries(e.children).forEach(([w,T])=>{g[w]=this.createSegmentGroup(i,T,n,o)}),new so(r,g)}createSegments(i,e,n,o){return e.map(r=>r.path[0]===":"?this.findPosParam(i,r,o):this.findOrReturn(r,n))}findPosParam(i,e,n){let o=n[e.path.substring(1)];if(!o)throw new si(4001,!1);return o}findOrReturn(i,e){let n=0;for(let o of e){if(o.path===i.path)return e.splice(n),o;n++}return i}},fP={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function gue(t,i,e,n,o){let r=vH(t,i,e);return r.matched?(n=Bce(i,n),pue(n,i,e,o).pipe(hn(g=>g===!0?r:It({},fP)))):Ni(r)}function vH(t,i,e){if(i.path==="**")return _ue(e);if(i.path==="")return i.pathMatch==="full"&&(t.hasChildren()||e.length>0)?It({},fP):{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};let o=(i.matcher||ZU)(e,t,i);if(!o)return It({},fP);let r={};Object.entries(o.posParams??{}).forEach(([w,T])=>{r[w]=T.path});let g=o.consumed.length>0?It(It({},r),o.consumed[o.consumed.length-1].parameters):r;return{matched:!0,consumedSegments:o.consumed,remainingSegments:e.slice(o.consumed.length),parameters:g,positionalParamSegments:o.posParams??{}}}function _ue(t){return{matched:!0,parameters:t.length>0?KU(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function $U(t,i,e,n){return e.length>0&&bue(t,e,n)?{segmentGroup:new so(i,vue(n,new so(e,t.children))),slicedSegments:[]}:e.length===0&&xue(t,e,n)?{segmentGroup:new so(t.segments,yue(t,e,n,t.children)),slicedSegments:e}:{segmentGroup:new so(t.segments,t.children),slicedSegments:e}}function yue(t,i,e,n){let o={};for(let r of e)if(VT(t,i,r)&&!n[Fd(r)]){let g=new so([],{});o[Fd(r)]=g}return It(It({},n),o)}function vue(t,i){let e={};e[br]=i;for(let n of t)if(n.path===""&&Fd(n)!==br){let o=new so([],{});e[Fd(n)]=o}return e}function bue(t,i,e){return e.some(n=>VT(t,i,n)&&Fd(n)!==br)}function xue(t,i,e){return e.some(n=>VT(t,i,n))}function VT(t,i,e){return(t.hasChildren()||i.length>0)&&e.pathMatch==="full"?!1:e.path===""}function wue(t,i,e){return i.length===0&&!t.children[e]}var mP=class{};function Eue(t,i,e,n,o,r,g="emptyOnly"){return new gP(t,i,e,n,o,g,r).recognize()}var Cue=31,gP=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(i,e,n,o,r,g,w){this.injector=i,this.configLoader=e,this.rootComponentType=n,this.config=o,this.urlTree=r,this.paramsInheritanceStrategy=g,this.urlSerializer=w,this.applyRedirects=new pP(this.urlSerializer,this.urlTree)}noMatchError(i){return new si(4002,`'${i.segmentGroup}'`)}recognize(){let i=$U(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(i).pipe(hn(({children:e,rootSnapshot:n})=>{let o=new tu(n,e),r=new Ux("",o),g=oH(n,[],this.urlTree.queryParams,this.urlTree.fragment);return g.queryParams=this.urlTree.queryParams,r.url=this.urlSerializer.serialize(g),{state:r,tree:g}}))}match(i){let e=new u0([],Object.freeze({}),Object.freeze(It({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),br,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,i,br,e).pipe(hn(n=>({children:n,rootSnapshot:e})),Br(n=>{if(n instanceof $x)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof qx?this.noMatchError(n):n}))}processSegmentGroup(i,e,n,o,r){return n.segments.length===0&&n.hasChildren()?this.processChildren(i,e,n,r):this.processSegment(i,e,n,n.segments,o,!0,r).pipe(hn(g=>g instanceof tu?[g]:[]))}processChildren(i,e,n,o){let r=[];for(let g of Object.keys(n.children))g==="primary"?r.unshift(g):r.push(g);return bo(r).pipe(Sh(g=>{let w=n.children[g],T=Vce(e,g);return this.processSegmentGroup(i,T,w,g,o)}),RR((g,w)=>(g.push(...w),g)),Uf(null),AR(),Na(g=>{if(g===null)return By(n);let w=bH(g);return Sue(w),Ni(w)}))}processSegment(i,e,n,o,r,g,w){return bo(e).pipe(Sh(T=>this.processSegmentAgainstRoute(T._injector??i,e,T,n,o,r,g,w).pipe(Br(k=>{if(k instanceof qx)return Ni(null);throw k}))),bp(T=>!!T),Br(T=>{if(_H(T))return wue(n,o,r)?Ni(new mP):By(n);throw T}))}processSegmentAgainstRoute(i,e,n,o,r,g,w,T){return Fd(n)!==g&&(g===br||!VT(o,r,n))?By(o):n.redirectTo===void 0?this.matchSegmentAgainstRoute(i,o,n,r,g,T):this.allowRedirects&&w?this.expandSegmentAgainstRouteUsingRedirect(i,o,e,n,r,g,T):By(o)}expandSegmentAgainstRouteUsingRedirect(i,e,n,o,r,g,w){let{matched:T,parameters:k,consumedSegments:N,positionalParamSegments:V,remainingSegments:q}=vH(e,o,r);if(!T)return By(e);typeof o.redirectTo=="string"&&o.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Cue&&(this.allowRedirects=!1));let Z=new u0(r,k,Object.freeze(It({},this.urlTree.queryParams)),this.urlTree.fragment,GU(o),Fd(o),o.component??o._loadedComponent??null,o,WU(o)),X=LT(Z,w,this.paramsInheritanceStrategy);Z.params=Object.freeze(X.params),Z.data=Object.freeze(X.data);let te=this.applyRedirects.applyRedirectCommands(N,o.redirectTo,V,Z,i);return this.applyRedirects.lineralizeSegments(o,te).pipe(Na(De=>this.processSegment(i,n,e,De.concat(q),g,!1,w)))}matchSegmentAgainstRoute(i,e,n,o,r,g){let w=gue(e,n,o,i,this.urlSerializer);return n.path==="**"&&(e.children={}),w.pipe(Za(T=>T.matched?(i=n._injector??i,this.getChildConfig(i,n,o).pipe(Za(({routes:k})=>{let N=n._loadedInjector??i,{parameters:V,consumedSegments:q,remainingSegments:Z}=T,X=new u0(q,V,Object.freeze(It({},this.urlTree.queryParams)),this.urlTree.fragment,GU(n),Fd(n),n.component??n._loadedComponent??null,n,WU(n)),te=LT(X,g,this.paramsInheritanceStrategy);X.params=Object.freeze(te.params),X.data=Object.freeze(te.data);let{segmentGroup:De,slicedSegments:_e}=$U(e,q,Z,k);if(_e.length===0&&De.hasChildren())return this.processChildren(N,k,De,X).pipe(hn(Ce=>new tu(X,Ce)));if(k.length===0&&_e.length===0)return Ni(new tu(X,[]));let he=Fd(n)===r;return this.processSegment(N,k,De,_e,he?br:r,!0,X).pipe(hn(Ce=>new tu(X,Ce instanceof tu?[Ce]:[])))}))):By(e)))}getChildConfig(i,e,n){return e.children?Ni({routes:e.children,injector:i}):e.loadChildren?e._loadedRoutes!==void 0?Ni({routes:e._loadedRoutes,injector:e._loadedInjector}):hue(i,e,n,this.urlSerializer).pipe(Na(o=>o?this.configLoader.loadChildren(i,e).pipe(hr(r=>{e._loadedRoutes=r.routes,e._loadedInjector=r.injector})):mue(e))):Ni({routes:[],injector:i})}};function Sue(t){t.sort((i,e)=>i.value.outlet===br?-1:e.value.outlet===br?1:i.value.outlet.localeCompare(e.value.outlet))}function Tue(t){let i=t.value.routeConfig;return i&&i.path===""}function bH(t){let i=[],e=new Set;for(let n of t){if(!Tue(n)){i.push(n);continue}let o=i.find(r=>n.value.routeConfig===r.value.routeConfig);o!==void 0?(o.children.push(...n.children),e.add(o)):i.push(n)}for(let n of e){let o=bH(n.children);i.push(new tu(n.value,o))}return i.filter(n=>!e.has(n))}function GU(t){return t.data||{}}function WU(t){return t.resolve||{}}function Due(t,i,e,n,o,r){return Na(g=>Eue(t,i,e,n,g.extractedUrl,o,r).pipe(hn(({state:w,tree:T})=>ji(It({},g),{targetSnapshot:w,urlAfterRedirects:T}))))}function Mue(t,i){return Na(e=>{let{targetSnapshot:n,guards:{canActivateChecks:o}}=e;if(!o.length)return Ni(e);let r=new Set(o.map(T=>T.route)),g=new Set;for(let T of r)if(!g.has(T))for(let k of xH(T))g.add(k);let w=0;return bo(g).pipe(Sh(T=>r.has(T)?Iue(T,n,t,i):(T.data=LT(T,T.parent,t).resolve,Ni(void 0))),hr(()=>w++),oy(1),Na(T=>w===g.size?Ni(e):Rs))})}function xH(t){let i=t.children.map(e=>xH(e)).flat();return[t,...i]}function Iue(t,i,e,n){let o=t.routeConfig,r=t._resolve;return o?.title!==void 0&&!hH(o)&&(r[Gx]=o.title),Aue(r,t,i,n).pipe(hn(g=>(t._resolvedData=g,t.data=LT(t,t.parent,e).resolve,null)))}function Aue(t,i,e,n){let o=rP(t);if(o.length===0)return Ni({});let r={};return bo(o).pipe(Na(g=>Rue(t[g],i,e,n).pipe(bp(),hr(w=>{if(w instanceof Wy)throw FT(new cm,w);r[g]=w}))),oy(1),hn(()=>r),Br(g=>_H(g)?Rs:wa(g)))}function Rue(t,i,e,n){let o=Wx(i)??n,r=Yy(t,o),g=r.resolve?r.resolve(i,e):gl(o,()=>r(i,e));return hm(g)}function iP(t){return Za(i=>{let e=t(i);return e?bo(e).pipe(hn(()=>i)):Ni(i)})}var vP=(()=>{class t{buildTitle(e){let n,o=e.root;for(;o!==void 0;)n=this.getResolvedTitleForRoute(o)??n,o=o.children.find(r=>r.outlet===br);return n}getResolvedTitleForRoute(e){return e.data[Gx]}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:()=>J(wH),providedIn:"root"})}return t})(),wH=(()=>{class t extends vP{title;constructor(e){super(),this.title=e}updateTitle(e){let n=this.buildTitle(e);n!==void 0&&this.title.setTitle(n)}static \u0275fac=function(n){return new(n||t)(bi(FU))};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),f0=new Ot("",{providedIn:"root",factory:()=>({})}),bP=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(n,o){n&1&&jt(0,"router-outlet")},dependencies:[Zx],encapsulation:2})}return t})();function xP(t){let i=t.children&&t.children.map(xP),e=i?ji(It({},t),{children:i}):It({},t);return!e.component&&!e.loadComponent&&(i||e.loadChildren)&&e.outlet&&e.outlet!==br&&(e.component=bP),e}var pm=new Ot(""),jT=(()=>{class t{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=J(US);loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return Ni(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);let n=hm(e.loadComponent()).pipe(hn(EH),hr(r=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=r}),Th(()=>{this.componentLoaders.delete(e)})),o=new Bf(n,()=>new gi).pipe(iy());return this.componentLoaders.set(e,o),o}loadChildren(e,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return Ni({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);let r=UT(n,this.compiler,e,this.onLoadEndListener).pipe(Th(()=>{this.childrenLoaders.delete(n)})),g=new Bf(r,()=>new gi).pipe(iy());return this.childrenLoaders.set(n,g),g}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function UT(t,i,e,n){return hm(t.loadChildren()).pipe(hn(EH),Na(o=>o instanceof fO||Array.isArray(o)?Ni(o):bo(i.compileModuleAsync(o))),hn(o=>{n&&n(t);let r,g,w=!1;return Array.isArray(o)?(g=o,w=!0):(r=o.create(e).injector,g=r.get(pm,[],{optional:!0,self:!0}).flat()),{routes:g.map(xP),injector:r}}))}function kue(t){return t&&typeof t=="object"&&"default"in t}function EH(t){return kue(t)?t.default:t}var HT=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:()=>J(Oue),providedIn:"root"})}return t})(),Oue=(()=>{class t{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,n){return e}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),wP=new Ot(""),EP=new Ot("");function CH(t,i,e){let n=t.get(EP),o=t.get(cn);return t.get(Oi).runOutsideAngular(()=>{if(!o.startViewTransition||n.skipNextTransition)return n.skipNextTransition=!1,new Promise(k=>setTimeout(k));let r,g=new Promise(k=>{r=k}),w=o.startViewTransition(()=>(r(),Pue(t))),{onViewTransitionCreated:T}=n;return T&&gl(t,()=>T({transition:w,from:i,to:e})),g})}function Pue(t){return new Promise(i=>{_s({read:()=>setTimeout(i)},{injector:t})})}var CP=new Ot(""),qT=(()=>{class t{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new gi;transitionAbortSubject=new gi;configLoader=J(jT);environmentInjector=J(Ea);destroyRef=J(Sy);urlSerializer=J(h0);rootContexts=J(p0);location=J(Lh);inputBindingEnabled=J(Yx,{optional:!0})!==null;titleStrategy=J(vP);options=J(f0,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=J(HT);createViewTransition=J(wP,{optional:!0});navigationErrorHandler=J(CP,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>Ni(void 0);rootComponentType=null;destroyed=!1;constructor(){let e=o=>this.events.next(new MT(o)),n=o=>this.events.next(new IT(o));this.configLoader.onLoadEndListener=n,this.configLoader.onLoadStartListener=e,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(e){let n=++this.navigationId;this.transitions?.next(ji(It({},e),{extractedUrl:this.urlHandlingStrategy.extract(e.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:n}))}setupNavigations(e){return this.transitions=new to(null),this.transitions.pipe(zr(n=>n!==null),Za(n=>{let o=!1,r=!1;return Ni(n).pipe(Za(g=>{if(this.navigationId>n.id)return this.cancelNavigationTransition(n,"",Sc.SupersededByNewNavigation),Rs;this.currentTransition=n,this.currentNavigation={id:g.id,initialUrl:g.rawUrl,extractedUrl:g.extractedUrl,targetBrowserUrl:typeof g.extras.browserUrl=="string"?this.urlSerializer.parse(g.extras.browserUrl):g.extras.browserUrl,trigger:g.source,extras:g.extras,previousNavigation:this.lastSuccessfulNavigation?ji(It({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let w=!e.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),T=g.extras.onSameUrlNavigation??e.onSameUrlNavigation;if(!w&&T!=="reload"){let k="";return this.events.next(new Vh(g.id,this.urlSerializer.serialize(g.rawUrl),k,Hy.IgnoredSameUrlNavigation)),g.resolve(!1),Rs}if(this.urlHandlingStrategy.shouldProcessUrl(g.rawUrl))return Ni(g).pipe(Za(k=>(this.events.next(new dm(k.id,this.urlSerializer.serialize(k.extractedUrl),k.source,k.restoredState)),k.id!==this.navigationId?Rs:Promise.resolve(k))),Due(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,this.paramsInheritanceStrategy),hr(k=>{n.targetSnapshot=k.targetSnapshot,n.urlAfterRedirects=k.urlAfterRedirects,this.currentNavigation=ji(It({},this.currentNavigation),{finalUrl:k.urlAfterRedirects});let N=new Bx(k.id,this.urlSerializer.serialize(k.extractedUrl),this.urlSerializer.serialize(k.urlAfterRedirects),k.targetSnapshot);this.events.next(N)}));if(w&&this.urlHandlingStrategy.shouldProcessUrl(g.currentRawUrl)){let{id:k,extractedUrl:N,source:V,restoredState:q,extras:Z}=g,X=new dm(k,this.urlSerializer.serialize(N),V,q);this.events.next(X);let te=uH(this.rootComponentType).snapshot;return this.currentTransition=n=ji(It({},g),{targetSnapshot:te,urlAfterRedirects:N,extras:ji(It({},Z),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=N,Ni(n)}else{let k="";return this.events.next(new Vh(g.id,this.urlSerializer.serialize(g.extractedUrl),k,Hy.IgnoredByUrlHandlingStrategy)),g.resolve(!1),Rs}}),hr(g=>{let w=new CT(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot);this.events.next(w)}),hn(g=>(this.currentTransition=n=ji(It({},g),{guards:Wce(g.targetSnapshot,g.currentSnapshot,this.rootContexts)}),n)),rue(this.environmentInjector,g=>this.events.next(g)),hr(g=>{if(n.guardsResult=g.guardsResult,g.guardsResult&&typeof g.guardsResult!="boolean")throw FT(this.urlSerializer,g.guardsResult);let w=new ST(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot,!!g.guardsResult);this.events.next(w)}),zr(g=>g.guardsResult?!0:(this.cancelNavigationTransition(g,"",Sc.GuardRejected),!1)),iP(g=>{if(g.guards.canActivateChecks.length!==0)return Ni(g).pipe(hr(w=>{let T=new TT(w.id,this.urlSerializer.serialize(w.extractedUrl),this.urlSerializer.serialize(w.urlAfterRedirects),w.targetSnapshot);this.events.next(T)}),Za(w=>{let T=!1;return Ni(w).pipe(Mue(this.paramsInheritanceStrategy,this.environmentInjector),hr({next:()=>T=!0,complete:()=>{T||this.cancelNavigationTransition(w,"",Sc.NoDataFromResolver)}}))}),hr(w=>{let T=new DT(w.id,this.urlSerializer.serialize(w.extractedUrl),this.urlSerializer.serialize(w.urlAfterRedirects),w.targetSnapshot);this.events.next(T)}))}),iP(g=>{let w=T=>{let k=[];T.routeConfig?.loadComponent&&!T.routeConfig._loadedComponent&&k.push(this.configLoader.loadComponent(T.routeConfig).pipe(hr(N=>{T.component=N}),hn(()=>{})));for(let N of T.children)k.push(...w(N));return k};return Ng(w(g.targetSnapshot.root)).pipe(Uf(null),ta(1))}),iP(()=>this.afterPreactivation()),Za(()=>{let{currentSnapshot:g,targetSnapshot:w}=n,T=this.createViewTransition?.(this.environmentInjector,g.root,w.root);return T?bo(T).pipe(hn(()=>n)):Ni(n)}),hn(g=>{let w=Uce(e.routeReuseStrategy,g.targetSnapshot,g.currentRouterState);return this.currentTransition=n=ji(It({},g),{targetRouterState:w}),this.currentNavigation.targetRouterState=w,n}),hr(()=>{this.events.next(new Vx)}),Gce(this.rootContexts,e.routeReuseStrategy,g=>this.events.next(g),this.inputBindingEnabled),ta(1),hr({next:g=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Bu(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects))),this.titleStrategy?.updateTitle(g.targetRouterState.snapshot),g.resolve(!0)},complete:()=>{o=!0}}),_r(this.transitionAbortSubject.pipe(hr(g=>{throw g}))),Th(()=>{!o&&!r&&this.cancelNavigationTransition(n,"",Sc.SupersededByNewNavigation),this.currentTransition?.id===n.id&&(this.currentNavigation=null,this.currentTransition=null)}),Br(g=>{if(this.destroyed)return n.resolve(!1),Rs;if(r=!0,gH(g))this.events.next(new zh(n.id,this.urlSerializer.serialize(n.extractedUrl),g.message,g.cancellationCode)),$ce(g)?this.events.next(new Gy(g.url,g.navigationBehaviorOptions)):n.resolve(!1);else{let w=new qy(n.id,this.urlSerializer.serialize(n.extractedUrl),g,n.targetSnapshot??void 0);try{let T=gl(this.environmentInjector,()=>this.navigationErrorHandler?.(w));if(T instanceof Wy){let{message:k,cancellationCode:N}=FT(this.urlSerializer,T);this.events.next(new zh(n.id,this.urlSerializer.serialize(n.extractedUrl),k,N)),this.events.next(new Gy(T.redirectTo,T.navigationBehaviorOptions))}else throw this.events.next(w),g}catch(T){this.options.resolveNavigationPromiseOnError?n.resolve(!1):n.reject(T)}}return Rs}))}))}cancelNavigationTransition(e,n,o){let r=new zh(e.id,this.urlSerializer.serialize(e.extractedUrl),n,o);this.events.next(r),e.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let e=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),n=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return e.toString()!==n?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Nue(t){return t!==xT}var SH=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:()=>J(Lue),providedIn:"root"})}return t})(),BT=class{shouldDetach(i){return!1}store(i,e){}shouldAttach(i){return!1}retrieve(i){return null}shouldReuseRoute(i,e){return i.routeConfig===e.routeConfig}},Lue=(()=>{class t extends BT{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),TH=(()=>{class t{urlSerializer=J(h0);options=J(f0,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=J(Lh);urlHandlingStrategy=J(HT);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Bh;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:e,initialUrl:n,targetBrowserUrl:o}){let r=e!==void 0?this.urlHandlingStrategy.merge(e,n):n,g=o??r;return g instanceof Bh?this.urlSerializer.serialize(g):g}commitTransition({targetRouterState:e,finalUrl:n,initialUrl:o}){n&&e?(this.currentUrlTree=n,this.rawUrlTree=this.urlHandlingStrategy.merge(n,o),this.routerState=e):this.rawUrlTree=o}routerState=uH(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:e}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e??this.rawUrlTree)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:()=>J(Fue),providedIn:"root"})}return t})(),Fue=(()=>{class t extends TH{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(e){return this.location.subscribe(n=>{n.type==="popstate"&&setTimeout(()=>{e(n.url,n.state,"popstate")})})}handleRouterEvent(e,n){e instanceof dm?this.updateStateMemento():e instanceof Vh?this.commitTransition(n):e instanceof Bx?this.urlUpdateStrategy==="eager"&&(n.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(n),n)):e instanceof Vx?(this.commitTransition(n),this.urlUpdateStrategy==="deferred"&&!n.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(n),n)):e instanceof zh&&(e.code===Sc.GuardRejected||e.code===Sc.NoDataFromResolver)?this.restoreHistory(n):e instanceof qy?this.restoreHistory(n,!0):e instanceof Bu&&(this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId)}setBrowserUrl(e,{extras:n,id:o}){let{replaceUrl:r,state:g}=n;if(this.location.isCurrentPathEqualTo(e)||r){let w=this.browserPageId,T=It(It({},g),this.generateNgRouterState(o,w));this.location.replaceState(e,"",T)}else{let w=It(It({},g),this.generateNgRouterState(o,this.browserPageId+1));this.location.go(e,"",w)}}restoreHistory(e,n=!1){if(this.canceledNavigationResolution==="computed"){let o=this.browserPageId,r=this.currentPageId-o;r!==0?this.location.historyGo(r):this.getCurrentUrlTree()===e.finalUrl&&r===0&&(this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(n&&this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,n){return this.canceledNavigationResolution==="computed"?{navigationId:e,\u0275routerPageId:n}:{navigationId:e}}static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function $T(t,i){t.events.pipe(zr(e=>e instanceof Bu||e instanceof zh||e instanceof qy||e instanceof Vh),hn(e=>e instanceof Bu||e instanceof Vh?0:(e instanceof zh?e.code===Sc.Redirect||e.code===Sc.SupersededByNewNavigation:!1)?2:1),zr(e=>e!==2),ta(1)).subscribe(()=>{i()})}var zue={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Bue={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},$n=(()=>{class t{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=J(r0);stateManager=J(TH);options=J(f0,{optional:!0})||{};pendingTasks=J(Ip);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=J(qT);urlSerializer=J(h0);location=J(Lh);urlHandlingStrategy=J(HT);_events=new gi;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=J(SH);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=J(pm,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!J(Yx,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:e=>{this.console.warn(e)}}),this.subscribeToNavigationEvents()}eventsSubscription=new nr;subscribeToNavigationEvents(){let e=this.navigationTransitions.events.subscribe(n=>{try{let o=this.navigationTransitions.currentTransition,r=this.navigationTransitions.currentNavigation;if(o!==null&&r!==null){if(this.stateManager.handleRouterEvent(n,r),n instanceof zh&&n.code!==Sc.Redirect&&n.code!==Sc.SupersededByNewNavigation)this.navigated=!0;else if(n instanceof Bu)this.navigated=!0;else if(n instanceof Gy){let g=n.navigationBehaviorOptions,w=this.urlHandlingStrategy.merge(n.url,o.currentRawUrl),T=It({browserUrl:o.extras.browserUrl,info:o.extras.info,skipLocationChange:o.extras.skipLocationChange,replaceUrl:o.extras.replaceUrl||this.urlUpdateStrategy==="eager"||Nue(o.source)},g);this.scheduleNavigation(w,xT,null,T,{resolve:o.resolve,reject:o.reject,promise:o.promise})}}jue(n)&&this._events.next(n)}catch(o){this.navigationTransitions.transitionAbortSubject.next(o)}});this.eventsSubscription.add(e)}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),xT,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((e,n,o)=>{this.navigateToSyncWithBrowser(e,o,n)})}navigateToSyncWithBrowser(e,n,o){let r={replaceUrl:!0},g=o?.navigationId?o:null;if(o){let T=It({},o);delete T.navigationId,delete T.\u0275routerPageId,Object.keys(T).length!==0&&(r.state=T)}let w=this.parseUrl(e);this.scheduleNavigation(w,n,g,r)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(xP),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(e,n={}){let{relativeTo:o,queryParams:r,fragment:g,queryParamsHandling:w,preserveFragment:T}=n,k=T?this.currentUrlTree.fragment:g,N=null;switch(w??this.options.defaultQueryParamsHandling){case"merge":N=It(It({},this.currentUrlTree.queryParams),r);break;case"preserve":N=this.currentUrlTree.queryParams;break;default:N=r||null}N!==null&&(N=this.removeEmptyProps(N));let V;try{let q=o?o.snapshot:this.routerState.snapshot.root;V=aH(q)}catch{(typeof e[0]!="string"||e[0][0]!=="/")&&(e=[]),V=this.currentUrlTree.root}return sH(V,e,N,k??null)}navigateByUrl(e,n={skipLocationChange:!1}){let o=um(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(r,xT,null,n)}navigate(e,n={skipLocationChange:!1}){return Vue(e),this.navigateByUrl(this.createUrlTree(e,n),n)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){try{return this.urlSerializer.parse(e)}catch{return this.urlSerializer.parse("/")}}isActive(e,n){let o;if(n===!0?o=It({},zue):n===!1?o=It({},Bue):o=n,um(e))return jU(this.currentUrlTree,e,o);let r=this.parseUrl(e);return jU(this.currentUrlTree,r,o)}removeEmptyProps(e){return Object.entries(e).reduce((n,[o,r])=>(r!=null&&(n[o]=r),n),{})}scheduleNavigation(e,n,o,r,g){if(this.disposed)return Promise.resolve(!1);let w,T,k;g?(w=g.resolve,T=g.reject,k=g.promise):k=new Promise((V,q)=>{w=V,T=q});let N=this.pendingTasks.add();return $T(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(N))}),this.navigationTransitions.handleNavigationRequest({source:n,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:r,resolve:w,reject:T,promise:k,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),k.catch(V=>Promise.reject(V))}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Vue(t){for(let i=0;i<t.length;i++)if(t[i]==null)throw new si(4008,!1)}function jue(t){return!(t instanceof Vx)&&!(t instanceof Gy)}var Ky=(()=>{class t{router;route;tabIndexAttribute;renderer;el;locationStrategy;href=null;target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new gi;constructor(e,n,o,r,g,w){this.router=e,this.route=n,this.tabIndexAttribute=o,this.renderer=r,this.el=g,this.locationStrategy=w;let T=g.nativeElement.tagName?.toLowerCase();this.isAnchorElement=T==="a"||T==="area",this.isAnchorElement?this.subscription=e.events.subscribe(k=>{k instanceof Bu&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(e){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(e){e==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(um(e)?this.routerLinkInput=e:this.routerLinkInput=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0"))}onClick(e,n,o,r,g){let w=this.urlTree;if(w===null||this.isAnchorElement&&(e!==0||n||o||r||g||typeof this.target=="string"&&this.target!="_self"))return!0;let T={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(w,T),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let e=this.urlTree;this.href=e!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(e)):null;let n=this.href===null?null:O9(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",n)}applyAttributeValue(e,n){let o=this.renderer,r=this.el.nativeElement;n!==null?o.setAttribute(r,e,n):o.removeAttribute(r,e)}get urlTree(){return this.routerLinkInput===null?null:um(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(n){return new(n||t)(Ci($n),Ci(Tc),ES("tabindex"),Ci(Ko),Ci(Qi),Ci(Pd))};static \u0275dir=vi({type:t,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(n,o){n&1&&Nt("click",function(g){return o.onClick(g.button,g.ctrlKey,g.shiftKey,g.altKey,g.metaKey)}),n&2&&un("target",o.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Bi],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Bi],replaceUrl:[2,"replaceUrl","replaceUrl",Bi],routerLink:"routerLink"},features:[$r]})}return t})();var Xx=class{};var DH=(()=>{class t{router;injector;preloadingStrategy;loader;subscription;constructor(e,n,o,r){this.router=e,this.injector=n,this.preloadingStrategy=o,this.loader=r}setUpPreloading(){this.subscription=this.router.events.pipe(zr(e=>e instanceof Bu),Sh(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,n){let o=[];for(let r of n){r.providers&&!r._injector&&(r._injector=ux(r.providers,e,`Route: ${r.path}`));let g=r._injector??e,w=r._loadedInjector??g;(r.loadChildren&&!r._loadedRoutes&&r.canLoad===void 0||r.loadComponent&&!r._loadedComponent)&&o.push(this.preloadConfig(g,r)),(r.children||r._loadedRoutes)&&o.push(this.processRoutes(w,r.children??r._loadedRoutes))}return bo(o).pipe(Vf())}preloadConfig(e,n){return this.preloadingStrategy.preload(n,()=>{let o;n.loadChildren&&n.canLoad===void 0?o=this.loader.loadChildren(e,n):o=Ni(null);let r=o.pipe(Na(g=>g===null?Ni(void 0):(n._loadedRoutes=g.routes,n._loadedInjector=g.injector,this.processRoutes(g.injector??e,g.routes))));if(n.loadComponent&&!n._loadedComponent){let g=this.loader.loadComponent(n);return bo([r,g]).pipe(Vf())}else return r})}static \u0275fac=function(n){return new(n||t)(bi($n),bi(Ea),bi(Xx),bi(jT))};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),MH=new Ot(""),Uue=(()=>{class t{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource="imperative";restoredId=0;store={};constructor(e,n,o,r,g={}){this.urlSerializer=e,this.transitions=n,this.viewportScroller=o,this.zone=r,this.options=g,g.scrollPositionRestoration||="disabled",g.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof dm?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Bu?(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment)):e instanceof Vh&&e.code===Hy.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof $y&&(e.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(e.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,n){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new $y(e,this.lastSource==="popstate"?this.store[this.restoredId]:null,n))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(n){BS()};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})();function TP(t,...i){return eu([{provide:pm,multi:!0,useValue:t},[],{provide:Tc,useFactory:IH,deps:[$n]},{provide:Ry,multi:!0,useFactory:AH},i.map(e=>e.\u0275providers)])}function IH(t){return t.routerState.root}function Qx(t,i){return{\u0275kind:t,\u0275providers:i}}function AH(){let t=J(wn);return i=>{let e=t.get(ms);if(i!==e.components[0])return;let n=t.get($n),o=t.get(RH);t.get(DP)===1&&n.initialNavigation(),t.get(PH,null,kr.Optional)?.setUpPreloading(),t.get(MH,null,kr.Optional)?.init(),n.resetRootComponentType(e.componentTypes[0]),o.closed||(o.next(),o.complete(),o.unsubscribe())}}var RH=new Ot("",{factory:()=>new gi}),DP=new Ot("",{providedIn:"root",factory:()=>1});function kH(){let t=[{provide:DP,useValue:0},yO(()=>{let i=J(wn);return i.get(IO,Promise.resolve()).then(()=>new Promise(n=>{let o=i.get($n),r=i.get(RH);$T(o,()=>{n(!0)}),i.get(qT).afterPreactivation=()=>(n(!0),r.closed?Ni(void 0):r),o.initialNavigation()}))})];return Qx(2,t)}function OH(){let t=[yO(()=>{J($n).setUpLocationChangeListener()}),{provide:DP,useValue:2}];return Qx(3,t)}var PH=new Ot("");function NH(t){return Qx(0,[{provide:PH,useExisting:DH},{provide:Xx,useExisting:t}])}function GT(){return Qx(8,[yP,{provide:Yx,useExisting:yP}])}function LH(t){yc("NgRouterViewTransitions");let i=[{provide:wP,useValue:CH},{provide:EP,useValue:It({skipNextTransition:!!t?.skipInitialTransition},t)}];return Qx(9,i)}var FH=[Lh,{provide:h0,useClass:cm},$n,p0,{provide:Tc,useFactory:IH,deps:[$n]},jT,[]],nu=(()=>{class t{constructor(){}static forRoot(e,n){return{ngModule:t,providers:[FH,[],{provide:pm,multi:!0,useValue:e},[],n?.errorHandler?{provide:CP,useValue:n.errorHandler}:[],{provide:f0,useValue:n||{}},n?.useHash?que():$ue(),Hue(),n?.preloadingStrategy?NH(n.preloadingStrategy).\u0275providers:[],n?.initialNavigation?Gue(n):[],n?.bindToComponentInputs?GT().\u0275providers:[],n?.enableViewTransitions?LH().\u0275providers:[],Wue()]}}static forChild(e){return{ngModule:t,providers:[{provide:pm,multi:!0,useValue:e}]}}static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({})}return t})();function Hue(){return{provide:MH,useFactory:()=>{let t=J(oT),i=J(Oi),e=J(f0),n=J(qT),o=J(h0);return e.scrollOffset&&t.setOffset(e.scrollOffset),new Uue(o,n,t,i,e)}}}function que(){return{provide:Pd,useClass:LO}}function $ue(){return{provide:Pd,useClass:WS}}function Gue(t){return[t.initialNavigation==="disabled"?OH().\u0275providers:[],t.initialNavigation==="enabledBlocking"?kH().\u0275providers:[]]}var SP=new Ot("");function Wue(){return[{provide:SP,useFactory:AH},{provide:Ry,multi:!0,useExisting:SP}]}var Zue=Object.getOwnPropertyNames,Bn=(t,i)=>function(){return i||(0,t[Zue(t)[0]])((i={exports:{}}).exports,i),i.exports},Jx=Bn({"external/npm/node_modules/domino/lib/Event.js"(t,i){i.exports=e,e.CAPTURING_PHASE=1,e.AT_TARGET=2,e.BUBBLING_PHASE=3;function e(n,o){if(this.type="",this.target=null,this.currentTarget=null,this.eventPhase=e.AT_TARGET,this.bubbles=!1,this.cancelable=!1,this.isTrusted=!1,this.defaultPrevented=!1,this.timeStamp=Date.now(),this._propagationStopped=!1,this._immediatePropagationStopped=!1,this._initialized=!0,this._dispatching=!1,n&&(this.type=n),o)for(var r in o)this[r]=o[r]}e.prototype=Object.create(Object.prototype,{constructor:{value:e},stopPropagation:{value:function(){this._propagationStopped=!0}},stopImmediatePropagation:{value:function(){this._propagationStopped=!0,this._immediatePropagationStopped=!0}},preventDefault:{value:function(){this.cancelable&&(this.defaultPrevented=!0)}},initEvent:{value:function(o,r,g){this._initialized=!0,!this._dispatching&&(this._propagationStopped=!1,this._immediatePropagationStopped=!1,this.defaultPrevented=!1,this.isTrusted=!1,this.target=null,this.type=o,this.bubbles=r,this.cancelable=g)}}})}}),VH=Bn({"external/npm/node_modules/domino/lib/UIEvent.js"(t,i){var e=Jx();i.exports=n;function n(){e.call(this),this.view=null,this.detail=0}n.prototype=Object.create(e.prototype,{constructor:{value:n},initUIEvent:{value:function(o,r,g,w,T){this.initEvent(o,r,g),this.view=w,this.detail=T}}})}}),jH=Bn({"external/npm/node_modules/domino/lib/MouseEvent.js"(t,i){var e=VH();i.exports=n;function n(){e.call(this),this.screenX=this.screenY=this.clientX=this.clientY=0,this.ctrlKey=this.altKey=this.shiftKey=this.metaKey=!1,this.button=0,this.buttons=1,this.relatedTarget=null}n.prototype=Object.create(e.prototype,{constructor:{value:n},initMouseEvent:{value:function(o,r,g,w,T,k,N,V,q,Z,X,te,De,_e,he){switch(this.initEvent(o,r,g,w,T),this.screenX=k,this.screenY=N,this.clientX=V,this.clientY=q,this.ctrlKey=Z,this.altKey=X,this.shiftKey=te,this.metaKey=De,this.button=_e,_e){case 0:this.buttons=1;break;case 1:this.buttons=4;break;case 2:this.buttons=2;break;default:this.buttons=0;break}this.relatedTarget=he}},getModifierState:{value:function(o){switch(o){case"Alt":return this.altKey;case"Control":return this.ctrlKey;case"Shift":return this.shiftKey;case"Meta":return this.metaKey;default:return!1}}}})}}),MP=Bn({"external/npm/node_modules/domino/lib/DOMException.js"(t,i){i.exports=We;var e=1,n=3,o=4,r=5,g=7,w=8,T=9,k=11,N=12,V=13,q=14,Z=15,X=17,te=18,De=19,_e=20,he=21,Ce=22,Pe=23,ye=24,vt=25,Rt=[null,"INDEX_SIZE_ERR",null,"HIERARCHY_REQUEST_ERR","WRONG_DOCUMENT_ERR","INVALID_CHARACTER_ERR",null,"NO_MODIFICATION_ALLOWED_ERR","NOT_FOUND_ERR","NOT_SUPPORTED_ERR","INUSE_ATTRIBUTE_ERR","INVALID_STATE_ERR","SYNTAX_ERR","INVALID_MODIFICATION_ERR","NAMESPACE_ERR","INVALID_ACCESS_ERR",null,"TYPE_MISMATCH_ERR","SECURITY_ERR","NETWORK_ERR","ABORT_ERR","URL_MISMATCH_ERR","QUOTA_EXCEEDED_ERR","TIMEOUT_ERR","INVALID_NODE_TYPE_ERR","DATA_CLONE_ERR"],ut=[null,"INDEX_SIZE_ERR (1): the index is not in the allowed range",null,"HIERARCHY_REQUEST_ERR (3): the operation would yield an incorrect nodes model","WRONG_DOCUMENT_ERR (4): the object is in the wrong Document, a call to importNode is required","INVALID_CHARACTER_ERR (5): the string contains invalid characters",null,"NO_MODIFICATION_ALLOWED_ERR (7): the object can not be modified","NOT_FOUND_ERR (8): the object can not be found here","NOT_SUPPORTED_ERR (9): this operation is not supported","INUSE_ATTRIBUTE_ERR (10): setAttributeNode called on owned Attribute","INVALID_STATE_ERR (11): the object is in an invalid state","SYNTAX_ERR (12): the string did not match the expected pattern","INVALID_MODIFICATION_ERR (13): the object can not be modified in this way","NAMESPACE_ERR (14): the operation is not allowed by Namespaces in XML","INVALID_ACCESS_ERR (15): the object does not support the operation or argument",null,"TYPE_MISMATCH_ERR (17): the type of the object does not match the expected type","SECURITY_ERR (18): the operation is insecure","NETWORK_ERR (19): a network error occurred","ABORT_ERR (20): the user aborted an operation","URL_MISMATCH_ERR (21): the given URL does not match another URL","QUOTA_EXCEEDED_ERR (22): the quota has been exceeded","TIMEOUT_ERR (23): a timeout occurred","INVALID_NODE_TYPE_ERR (24): the supplied node is invalid or has an invalid ancestor for this operation","DATA_CLONE_ERR (25): the object can not be cloned."],ct={INDEX_SIZE_ERR:e,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:n,WRONG_DOCUMENT_ERR:o,INVALID_CHARACTER_ERR:r,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:g,NOT_FOUND_ERR:w,NOT_SUPPORTED_ERR:T,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:k,SYNTAX_ERR:N,INVALID_MODIFICATION_ERR:V,NAMESPACE_ERR:q,INVALID_ACCESS_ERR:Z,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:X,SECURITY_ERR:te,NETWORK_ERR:De,ABORT_ERR:_e,URL_MISMATCH_ERR:he,QUOTA_EXCEEDED_ERR:Ce,TIMEOUT_ERR:Pe,INVALID_NODE_TYPE_ERR:ye,DATA_CLONE_ERR:vt};function We(we){Error.call(this),Error.captureStackTrace(this,this.constructor),this.code=we,this.message=ut[we],this.name=Rt[we]}We.prototype.__proto__=Error.prototype;for(ui in ct)Pt={value:ct[ui]},Object.defineProperty(We,ui,Pt),Object.defineProperty(We.prototype,ui,Pt);var Pt,ui}}),IP=Bn({"external/npm/node_modules/domino/lib/config.js"(t){t.isApiWritable=!globalThis.__domino_frozen__}}),Ba=Bn({"external/npm/node_modules/domino/lib/utils.js"(t){var i=MP(),e=i,n=IP().isApiWritable;t.NAMESPACE={HTML:"http://www.w3.org/1999/xhtml",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/",MATHML:"http://www.w3.org/1998/Math/MathML",SVG:"http://www.w3.org/2000/svg",XLINK:"http://www.w3.org/1999/xlink"},t.IndexSizeError=function(){throw new i(e.INDEX_SIZE_ERR)},t.HierarchyRequestError=function(){throw new i(e.HIERARCHY_REQUEST_ERR)},t.WrongDocumentError=function(){throw new i(e.WRONG_DOCUMENT_ERR)},t.InvalidCharacterError=function(){throw new i(e.INVALID_CHARACTER_ERR)},t.NoModificationAllowedError=function(){throw new i(e.NO_MODIFICATION_ALLOWED_ERR)},t.NotFoundError=function(){throw new i(e.NOT_FOUND_ERR)},t.NotSupportedError=function(){throw new i(e.NOT_SUPPORTED_ERR)},t.InvalidStateError=function(){throw new i(e.INVALID_STATE_ERR)},t.SyntaxError=function(){throw new i(e.SYNTAX_ERR)},t.InvalidModificationError=function(){throw new i(e.INVALID_MODIFICATION_ERR)},t.NamespaceError=function(){throw new i(e.NAMESPACE_ERR)},t.InvalidAccessError=function(){throw new i(e.INVALID_ACCESS_ERR)},t.TypeMismatchError=function(){throw new i(e.TYPE_MISMATCH_ERR)},t.SecurityError=function(){throw new i(e.SECURITY_ERR)},t.NetworkError=function(){throw new i(e.NETWORK_ERR)},t.AbortError=function(){throw new i(e.ABORT_ERR)},t.UrlMismatchError=function(){throw new i(e.URL_MISMATCH_ERR)},t.QuotaExceededError=function(){throw new i(e.QUOTA_EXCEEDED_ERR)},t.TimeoutError=function(){throw new i(e.TIMEOUT_ERR)},t.InvalidNodeTypeError=function(){throw new i(e.INVALID_NODE_TYPE_ERR)},t.DataCloneError=function(){throw new i(e.DATA_CLONE_ERR)},t.nyi=function(){throw new Error("NotYetImplemented")},t.shouldOverride=function(){throw new Error("Abstract function; should be overriding in subclass.")},t.assert=function(o,r){if(!o)throw new Error("Assertion failed: "+(r||"")+`
`+new Error().stack)},t.expose=function(o,r){for(var g in o)Object.defineProperty(r.prototype,g,{value:o[g],writable:n})},t.merge=function(o,r){for(var g in r)o[g]=r[g]},t.documentOrder=function(o,r){return 3-(o.compareDocumentPosition(r)&6)},t.toASCIILowerCase=function(o){return o.replace(/[A-Z]+/g,function(r){return r.toLowerCase()})},t.toASCIIUpperCase=function(o){return o.replace(/[a-z]+/g,function(r){return r.toUpperCase()})}}}),UH=Bn({"external/npm/node_modules/domino/lib/EventTarget.js"(t,i){var e=Jx(),n=jH(),o=Ba();i.exports=r;function r(){}r.prototype={addEventListener:function(w,T,k){if(T){k===void 0&&(k=!1),this._listeners||(this._listeners=Object.create(null)),this._listeners[w]||(this._listeners[w]=[]);for(var N=this._listeners[w],V=0,q=N.length;V<q;V++){var Z=N[V];if(Z.listener===T&&Z.capture===k)return}var X={listener:T,capture:k};typeof T=="function"&&(X.f=T),N.push(X)}},removeEventListener:function(w,T,k){if(k===void 0&&(k=!1),this._listeners){var N=this._listeners[w];if(N)for(var V=0,q=N.length;V<q;V++){var Z=N[V];if(Z.listener===T&&Z.capture===k){N.length===1?this._listeners[w]=void 0:N.splice(V,1);return}}}},dispatchEvent:function(w){return this._dispatchEvent(w,!1)},_dispatchEvent:function(w,T){typeof T!="boolean"&&(T=!1);function k(te,De){var _e=De.type,he=De.eventPhase;if(De.currentTarget=te,he!==e.CAPTURING_PHASE&&te._handlers&&te._handlers[_e]){var Ce=te._handlers[_e],Pe;if(typeof Ce=="function")Pe=Ce.call(De.currentTarget,De);else{var ye=Ce.handleEvent;if(typeof ye!="function")throw new TypeError("handleEvent property of event handler object isnot a function.");Pe=ye.call(Ce,De)}switch(De.type){case"mouseover":Pe===!0&&De.preventDefault();break;case"beforeunload":default:Pe===!1&&De.preventDefault();break}}var vt=te._listeners&&te._listeners[_e];if(vt){vt=vt.slice();for(var Rt=0,ut=vt.length;Rt<ut;Rt++){if(De._immediatePropagationStopped)return;var ct=vt[Rt];if(!(he===e.CAPTURING_PHASE&&!ct.capture||he===e.BUBBLING_PHASE&&ct.capture))if(ct.f)ct.f.call(De.currentTarget,De);else{var We=ct.listener.handleEvent;if(typeof We!="function")throw new TypeError("handleEvent property of event listener object is not a function.");We.call(ct.listener,De)}}}}(!w._initialized||w._dispatching)&&o.InvalidStateError(),w.isTrusted=T,w._dispatching=!0,w.target=this;for(var N=[],V=this.parentNode;V;V=V.parentNode)N.push(V);w.eventPhase=e.CAPTURING_PHASE;for(var q=N.length-1;q>=0&&(k(N[q],w),!w._propagationStopped);q--);if(w._propagationStopped||(w.eventPhase=e.AT_TARGET,k(this,w)),w.bubbles&&!w._propagationStopped){w.eventPhase=e.BUBBLING_PHASE;for(var Z=0,X=N.length;Z<X&&(k(N[Z],w),!w._propagationStopped);Z++);}if(w._dispatching=!1,w.eventPhase=e.AT_TARGET,w.currentTarget=null,T&&!w.defaultPrevented&&w instanceof n)switch(w.type){case"mousedown":this._armed={x:w.clientX,y:w.clientY,t:w.timeStamp};break;case"mouseout":case"mouseover":this._armed=null;break;case"mouseup":this._isClick(w)&&this._doClick(w),this._armed=null;break}return!w.defaultPrevented},_isClick:function(g){return this._armed!==null&&g.type==="mouseup"&&g.isTrusted&&g.button===0&&g.timeStamp-this._armed.t<1e3&&Math.abs(g.clientX-this._armed.x)<10&&Math.abs(g.clientY-this._armed.Y)<10},_doClick:function(g){if(!this._click_in_progress){this._click_in_progress=!0;for(var w=this;w&&!w._post_click_activation_steps;)w=w.parentNode;w&&w._pre_click_activation_steps&&w._pre_click_activation_steps();var T=this.ownerDocument.createEvent("MouseEvent");T.initMouseEvent("click",!0,!0,this.ownerDocument.defaultView,1,g.screenX,g.screenY,g.clientX,g.clientY,g.ctrlKey,g.altKey,g.shiftKey,g.metaKey,g.button,null);var k=this._dispatchEvent(T,!0);w&&(k?w._post_click_activation_steps&&w._post_click_activation_steps(T):w._cancelled_activation_steps&&w._cancelled_activation_steps())}},_setEventHandler:function(w,T){this._handlers||(this._handlers=Object.create(null)),this._handlers[w]=T},_getEventHandler:function(w){return this._handlers&&this._handlers[w]||null}}}}),HH=Bn({"external/npm/node_modules/domino/lib/LinkedList.js"(t,i){var e=Ba(),n=i.exports={valid:function(o){return e.assert(o,"list falsy"),e.assert(o._previousSibling,"previous falsy"),e.assert(o._nextSibling,"next falsy"),!0},insertBefore:function(o,r){e.assert(n.valid(o)&&n.valid(r));var g=o,w=o._previousSibling,T=r,k=r._previousSibling;g._previousSibling=k,w._nextSibling=T,k._nextSibling=g,T._previousSibling=w,e.assert(n.valid(o)&&n.valid(r))},replace:function(o,r){e.assert(n.valid(o)&&(r===null||n.valid(r))),r!==null&&n.insertBefore(r,o),n.remove(o),e.assert(n.valid(o)&&(r===null||n.valid(r)))},remove:function(o){e.assert(n.valid(o));var r=o._previousSibling;if(r!==o){var g=o._nextSibling;r._nextSibling=g,g._previousSibling=r,o._previousSibling=o._nextSibling=o,e.assert(n.valid(o))}}}}}),qH=Bn({"external/npm/node_modules/domino/lib/NodeUtils.js"(t,i){i.exports={serializeOne:De,\u0275escapeMatchingClosingTag:q,\u0275escapeClosingCommentTag:X,\u0275escapeProcessingInstructionContent:te};var e=Ba(),n=e.NAMESPACE,o={STYLE:!0,SCRIPT:!0,XMP:!0,IFRAME:!0,NOEMBED:!0,NOFRAMES:!0,PLAINTEXT:!0},r={area:!0,base:!0,basefont:!0,bgsound:!0,br:!0,col:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},g={},w=/[&<>\u00A0]/g,T=/[&"<>\u00A0]/g;function k(_e){return w.test(_e)?_e.replace(w,he=>{switch(he){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case"\xA0":return"&nbsp;"}}):_e}function N(_e){return T.test(_e)?_e.replace(T,he=>{switch(he){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case'"':return"&quot;";case"\xA0":return"&nbsp;"}}):_e}function V(_e){var he=_e.namespaceURI;return he?he===n.XML?"xml:"+_e.localName:he===n.XLINK?"xlink:"+_e.localName:he===n.XMLNS?_e.localName==="xmlns"?"xmlns":"xmlns:"+_e.localName:_e.name:_e.localName}function q(_e,he){let Ce="</"+he;if(!_e.toLowerCase().includes(Ce))return _e;let Pe=[..._e],ye=_e.matchAll(new RegExp(Ce,"ig"));for(let vt of ye)Pe[vt.index]="&lt;";return Pe.join("")}var Z=/--!?>/;function X(_e){return Z.test(_e)?_e.replace(/(--\!?)>/g,"$1&gt;"):_e}function te(_e){return _e.includes(">")?_e.replaceAll(">","&gt;"):_e}function De(_e,he){var Ce="";switch(_e.nodeType){case 1:var Pe=_e.namespaceURI,ye=Pe===n.HTML,vt=ye||Pe===n.SVG||Pe===n.MATHML?_e.localName:_e.tagName;Ce+="<"+vt;for(var Rt=0,ut=_e._numattrs;Rt<ut;Rt++){var ct=_e._attr(Rt);Ce+=" "+V(ct),ct.value!==void 0&&(Ce+='="'+N(ct.value)+'"')}if(Ce+=">",!(ye&&r[vt])){var We=_e.serialize();o[vt.toUpperCase()]&&(We=q(We,vt)),ye&&g[vt]&&We.charAt(0)===`
`&&(Ce+=`
`),Ce+=We,Ce+="</"+vt+">"}break;case 3:case 4:var Pt;he.nodeType===1&&he.namespaceURI===n.HTML?Pt=he.tagName:Pt="",o[Pt]||Pt==="NOSCRIPT"&&he.ownerDocument._scripting_enabled?Ce+=_e.data:Ce+=k(_e.data);break;case 8:Ce+="<!--"+X(_e.data)+"-->";break;case 7:let ui=te(_e.data);Ce+="<?"+_e.target+" "+ui+"?>";break;case 10:Ce+="<!DOCTYPE "+_e.name,Ce+=">";break;default:e.InvalidStateError()}return Ce}}}),xl=Bn({"external/npm/node_modules/domino/lib/Node.js"(t,i){i.exports=g;var e=UH(),n=HH(),o=qH(),r=Ba();function g(){e.call(this),this.parentNode=null,this._nextSibling=this._previousSibling=this,this._index=void 0}var w=g.ELEMENT_NODE=1,T=g.ATTRIBUTE_NODE=2,k=g.TEXT_NODE=3,N=g.CDATA_SECTION_NODE=4,V=g.ENTITY_REFERENCE_NODE=5,q=g.ENTITY_NODE=6,Z=g.PROCESSING_INSTRUCTION_NODE=7,X=g.COMMENT_NODE=8,te=g.DOCUMENT_NODE=9,De=g.DOCUMENT_TYPE_NODE=10,_e=g.DOCUMENT_FRAGMENT_NODE=11,he=g.NOTATION_NODE=12,Ce=g.DOCUMENT_POSITION_DISCONNECTED=1,Pe=g.DOCUMENT_POSITION_PRECEDING=2,ye=g.DOCUMENT_POSITION_FOLLOWING=4,vt=g.DOCUMENT_POSITION_CONTAINS=8,Rt=g.DOCUMENT_POSITION_CONTAINED_BY=16,ut=g.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;g.prototype=Object.create(e.prototype,{baseURI:{get:r.nyi},parentElement:{get:function(){return this.parentNode&&this.parentNode.nodeType===w?this.parentNode:null}},hasChildNodes:{value:r.shouldOverride},firstChild:{get:r.shouldOverride},lastChild:{get:r.shouldOverride},isConnected:{get:function(){let ct=this;for(;ct!=null;){if(ct.nodeType===g.DOCUMENT_NODE)return!0;ct=ct.parentNode,ct!=null&&ct.nodeType===g.DOCUMENT_FRAGMENT_NODE&&(ct=ct.host)}return!1}},previousSibling:{get:function(){var ct=this.parentNode;return!ct||this===ct.firstChild?null:this._previousSibling}},nextSibling:{get:function(){var ct=this.parentNode,We=this._nextSibling;return!ct||We===ct.firstChild?null:We}},textContent:{get:function(){return null},set:function(ct){}},innerText:{get:function(){return null},set:function(ct){}},_countChildrenOfType:{value:function(ct){for(var We=0,Pt=this.firstChild;Pt!==null;Pt=Pt.nextSibling)Pt.nodeType===ct&&We++;return We}},_ensureInsertValid:{value:function(We,Pt,ui){var we=this,xe,le;if(!We.nodeType)throw new TypeError("not a node");switch(we.nodeType){case te:case _e:case w:break;default:r.HierarchyRequestError()}switch(We.isAncestor(we)&&r.HierarchyRequestError(),(Pt!==null||!ui)&&Pt.parentNode!==we&&r.NotFoundError(),We.nodeType){case _e:case De:case w:case k:case Z:case X:break;default:r.HierarchyRequestError()}if(we.nodeType===te)switch(We.nodeType){case k:r.HierarchyRequestError();break;case _e:switch(We._countChildrenOfType(k)>0&&r.HierarchyRequestError(),We._countChildrenOfType(w)){case 0:break;case 1:if(Pt!==null)for(ui&&Pt.nodeType===De&&r.HierarchyRequestError(),le=Pt.nextSibling;le!==null;le=le.nextSibling)le.nodeType===De&&r.HierarchyRequestError();xe=we._countChildrenOfType(w),ui?xe>0&&r.HierarchyRequestError():(xe>1||xe===1&&Pt.nodeType!==w)&&r.HierarchyRequestError();break;default:r.HierarchyRequestError()}break;case w:if(Pt!==null)for(ui&&Pt.nodeType===De&&r.HierarchyRequestError(),le=Pt.nextSibling;le!==null;le=le.nextSibling)le.nodeType===De&&r.HierarchyRequestError();xe=we._countChildrenOfType(w),ui?xe>0&&r.HierarchyRequestError():(xe>1||xe===1&&Pt.nodeType!==w)&&r.HierarchyRequestError();break;case De:if(Pt===null)we._countChildrenOfType(w)&&r.HierarchyRequestError();else for(le=we.firstChild;le!==null&&le!==Pt;le=le.nextSibling)le.nodeType===w&&r.HierarchyRequestError();xe=we._countChildrenOfType(De),ui?xe>0&&r.HierarchyRequestError():(xe>1||xe===1&&Pt.nodeType!==De)&&r.HierarchyRequestError();break}else We.nodeType===De&&r.HierarchyRequestError()}},insertBefore:{value:function(We,Pt){var ui=this;ui._ensureInsertValid(We,Pt,!0);var we=Pt;return we===We&&(we=We.nextSibling),ui.doc.adoptNode(We),We._insertOrReplace(ui,we,!1),We}},appendChild:{value:function(ct){return this.insertBefore(ct,null)}},_appendChild:{value:function(ct){ct._insertOrReplace(this,null,!1)}},removeChild:{value:function(We){var Pt=this;if(!We.nodeType)throw new TypeError("not a node");return We.parentNode!==Pt&&r.NotFoundError(),We.remove(),We}},replaceChild:{value:function(We,Pt){var ui=this;return ui._ensureInsertValid(We,Pt,!1),We.doc!==ui.doc&&ui.doc.adoptNode(We),We._insertOrReplace(ui,Pt,!0),Pt}},contains:{value:function(We){return We===null?!1:this===We?!0:(this.compareDocumentPosition(We)&Rt)!==0}},compareDocumentPosition:{value:function(We){if(this===We)return 0;if(this.doc!==We.doc||this.rooted!==We.rooted)return Ce+ut;for(var Pt=[],ui=[],we=this;we!==null;we=we.parentNode)Pt.push(we);for(we=We;we!==null;we=we.parentNode)ui.push(we);if(Pt.reverse(),ui.reverse(),Pt[0]!==ui[0])return Ce+ut;we=Math.min(Pt.length,ui.length);for(var xe=1;xe<we;xe++)if(Pt[xe]!==ui[xe])return Pt[xe].index<ui[xe].index?ye:Pe;return Pt.length<ui.length?ye+Rt:Pe+vt}},isSameNode:{value:function(We){return this===We}},isEqualNode:{value:function(We){if(!We||We.nodeType!==this.nodeType||!this.isEqual(We))return!1;for(var Pt=this.firstChild,ui=We.firstChild;Pt&&ui;Pt=Pt.nextSibling,ui=ui.nextSibling)if(!Pt.isEqualNode(ui))return!1;return Pt===null&&ui===null}},cloneNode:{value:function(ct){var We=this.clone();if(ct)for(var Pt=this.firstChild;Pt!==null;Pt=Pt.nextSibling)We._appendChild(Pt.cloneNode(!0));return We}},lookupPrefix:{value:function(We){var Pt;if(We===""||We===null||We===void 0)return null;switch(this.nodeType){case w:return this._lookupNamespacePrefix(We,this);case te:return Pt=this.documentElement,Pt?Pt.lookupPrefix(We):null;case q:case he:case _e:case De:return null;case T:return Pt=this.ownerElement,Pt?Pt.lookupPrefix(We):null;default:return Pt=this.parentElement,Pt?Pt.lookupPrefix(We):null}}},lookupNamespaceURI:{value:function(We){(We===""||We===void 0)&&(We=null);var Pt;switch(this.nodeType){case w:return r.shouldOverride();case te:return Pt=this.documentElement,Pt?Pt.lookupNamespaceURI(We):null;case q:case he:case De:case _e:return null;case T:return Pt=this.ownerElement,Pt?Pt.lookupNamespaceURI(We):null;default:return Pt=this.parentElement,Pt?Pt.lookupNamespaceURI(We):null}}},isDefaultNamespace:{value:function(We){(We===""||We===void 0)&&(We=null);var Pt=this.lookupNamespaceURI(null);return Pt===We}},index:{get:function(){var ct=this.parentNode;if(this===ct.firstChild)return 0;var We=ct.childNodes;if(this._index===void 0||We[this._index]!==this){for(var Pt=0;Pt<We.length;Pt++)We[Pt]._index=Pt;r.assert(We[this._index]===this)}return this._index}},isAncestor:{value:function(ct){if(this.doc!==ct.doc||this.rooted!==ct.rooted)return!1;for(var We=ct;We;We=We.parentNode)if(We===this)return!0;return!1}},ensureSameDoc:{value:function(ct){ct.ownerDocument===null?ct.ownerDocument=this.doc:ct.ownerDocument!==this.doc&&r.WrongDocumentError()}},removeChildren:{value:r.shouldOverride},_insertOrReplace:{value:function(We,Pt,ui){var we=this,xe,le;if(we.nodeType===_e&&we.rooted&&r.HierarchyRequestError(),We._childNodes&&(xe=Pt===null?We._childNodes.length:Pt.index,we.parentNode===We)){var ke=we.index;ke<xe&&xe--}ui&&(Pt.rooted&&Pt.doc.mutateRemove(Pt),Pt.parentNode=null);var He=Pt;He===null&&(He=We.firstChild);var yt=we.rooted&&We.rooted;if(we.nodeType===_e){for(var li=[0,ui?1:0],Ai,hi=we.firstChild;hi!==null;hi=Ai)Ai=hi.nextSibling,li.push(hi),hi.parentNode=We;var it=li.length;if(ui?n.replace(He,it>2?li[2]:null):it>2&&He!==null&&n.insertBefore(li[2],He),We._childNodes)for(li[0]=Pt===null?We._childNodes.length:Pt._index,We._childNodes.splice.apply(We._childNodes,li),le=2;le<it;le++)li[le]._index=li[0]+(le-2);else We._firstChild===Pt&&(it>2?We._firstChild=li[2]:ui&&(We._firstChild=null));if(we._childNodes?we._childNodes.length=0:we._firstChild=null,We.rooted)for(We.modify(),le=2;le<it;le++)We.doc.mutateInsert(li[le])}else{if(Pt===we)return;yt?we._remove():we.parentNode&&we.remove(),we.parentNode=We,ui?(n.replace(He,we),We._childNodes?(we._index=xe,We._childNodes[xe]=we):We._firstChild===Pt&&(We._firstChild=we)):(He!==null&&n.insertBefore(we,He),We._childNodes?(we._index=xe,We._childNodes.splice(xe,0,we)):We._firstChild===Pt&&(We._firstChild=we)),yt?(We.modify(),We.doc.mutateMove(we)):We.rooted&&(We.modify(),We.doc.mutateInsert(we))}}},lastModTime:{get:function(){return this._lastModTime||(this._lastModTime=this.doc.modclock),this._lastModTime}},modify:{value:function(){if(this.doc.modclock)for(var ct=++this.doc.modclock,We=this;We;We=We.parentElement)We._lastModTime&&(We._lastModTime=ct)}},doc:{get:function(){return this.ownerDocument||this}},rooted:{get:function(){return!!this._nid}},normalize:{value:function(){for(var ct,We=this.firstChild;We!==null;We=ct)if(ct=We.nextSibling,We.normalize&&We.normalize(),We.nodeType===g.TEXT_NODE){if(We.nodeValue===""){this.removeChild(We);continue}var Pt=We.previousSibling;Pt!==null&&Pt.nodeType===g.TEXT_NODE&&(Pt.appendData(We.nodeValue),this.removeChild(We))}}},serialize:{value:function(){if(this._innerHTML)return this._innerHTML;for(var ct="",We=this.firstChild;We!==null;We=We.nextSibling)ct+=o.serializeOne(We,this);return ct}},outerHTML:{get:function(){return o.serializeOne(this,{nodeType:0})},set:r.nyi},ELEMENT_NODE:{value:w},ATTRIBUTE_NODE:{value:T},TEXT_NODE:{value:k},CDATA_SECTION_NODE:{value:N},ENTITY_REFERENCE_NODE:{value:V},ENTITY_NODE:{value:q},PROCESSING_INSTRUCTION_NODE:{value:Z},COMMENT_NODE:{value:X},DOCUMENT_NODE:{value:te},DOCUMENT_TYPE_NODE:{value:De},DOCUMENT_FRAGMENT_NODE:{value:_e},NOTATION_NODE:{value:he},DOCUMENT_POSITION_DISCONNECTED:{value:Ce},DOCUMENT_POSITION_PRECEDING:{value:Pe},DOCUMENT_POSITION_FOLLOWING:{value:ye},DOCUMENT_POSITION_CONTAINS:{value:vt},DOCUMENT_POSITION_CONTAINED_BY:{value:Rt},DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:{value:ut}})}}),Yue=Bn({"external/npm/node_modules/domino/lib/NodeList.es6.js"(t,i){i.exports=class extends Array{constructor(n){if(super(n&&n.length||0),n)for(var o in n)this[o]=n[o]}item(n){return this[n]||null}}}}),Kue=Bn({"external/npm/node_modules/domino/lib/NodeList.es5.js"(t,i){function e(o){return this[o]||null}function n(o){return o||(o=[]),o.item=e,o}i.exports=n}}),Xy=Bn({"external/npm/node_modules/domino/lib/NodeList.js"(t,i){var e;try{e=Yue()}catch{e=Kue()}i.exports=e}}),AP=Bn({"external/npm/node_modules/domino/lib/ContainerNode.js"(t,i){i.exports=o;var e=xl(),n=Xy();function o(){e.call(this),this._firstChild=this._childNodes=null}o.prototype=Object.create(e.prototype,{hasChildNodes:{value:function(){return this._childNodes?this._childNodes.length>0:this._firstChild!==null}},childNodes:{get:function(){return this._ensureChildNodes(),this._childNodes}},firstChild:{get:function(){return this._childNodes?this._childNodes.length===0?null:this._childNodes[0]:this._firstChild}},lastChild:{get:function(){var r=this._childNodes,g;return r?r.length===0?null:r[r.length-1]:(g=this._firstChild,g===null?null:g._previousSibling)}},_ensureChildNodes:{value:function(){if(!this._childNodes){var r=this._firstChild,g=r,w=this._childNodes=new n;if(r)do w.push(g),g=g._nextSibling;while(g!==r);this._firstChild=null}}},removeChildren:{value:function(){for(var g=this.rooted?this.ownerDocument:null,w=this.firstChild,T;w!==null;)T=w,w=T.nextSibling,g&&g.mutateRemove(T),T.parentNode=null;this._childNodes?this._childNodes.length=0:this._firstChild=null,this.modify()}}})}}),RP=Bn({"external/npm/node_modules/domino/lib/xmlnames.js"(t){t.isValidName=te,t.isValidQName=De;var i=/^[_:A-Za-z][-.:\w]+$/,e=/^([_A-Za-z][-.\w]+|[_A-Za-z][-.\w]+:[_A-Za-z][-.\w]+)$/,n="_A-Za-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD",o="-._A-Za-z0-9\xB7\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0300-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD",r="["+n+"]["+o+"]*",g=n+":",w=o+":",T=new RegExp("^["+g+"]["+w+"]*$"),k=new RegExp("^("+r+"|"+r+":"+r+")$"),N=/[\uD800-\uDB7F\uDC00-\uDFFF]/,V=/[\uD800-\uDB7F\uDC00-\uDFFF]/g,q=/[\uD800-\uDB7F][\uDC00-\uDFFF]/g;n+="\uD800-\u{EFC00}-\uDFFF",o+="\uD800-\u{EFC00}-\uDFFF",r="["+n+"]["+o+"]*",g=n+":",w=o+":";var Z=new RegExp("^["+g+"]["+w+"]*$"),X=new RegExp("^("+r+"|"+r+":"+r+")$");function te(_e){if(i.test(_e)||T.test(_e))return!0;if(!N.test(_e)||!Z.test(_e))return!1;var he=_e.match(V),Ce=_e.match(q);return Ce!==null&&2*Ce.length===he.length}function De(_e){if(e.test(_e)||k.test(_e))return!0;if(!N.test(_e)||!X.test(_e))return!1;var he=_e.match(V),Ce=_e.match(q);return Ce!==null&&2*Ce.length===he.length}}}),$H=Bn({"external/npm/node_modules/domino/lib/attributes.js"(t){var i=Ba();t.property=function(n){if(Array.isArray(n.type)){var o=Object.create(null);n.type.forEach(function(w){o[w.value||w]=w.alias||w});var r=n.missing;r===void 0&&(r=null);var g=n.invalid;return g===void 0&&(g=r),{get:function(){var w=this._getattr(n.name);return w===null?r:(w=o[w.toLowerCase()],w!==void 0?w:g!==null?g:w)},set:function(w){this._setattr(n.name,w)}}}else{if(n.type===Boolean)return{get:function(){return this.hasAttribute(n.name)},set:function(w){w?this._setattr(n.name,""):this.removeAttribute(n.name)}};if(n.type===Number||n.type==="long"||n.type==="unsigned long"||n.type==="limited unsigned long with fallback")return e(n);if(!n.type||n.type===String)return{get:function(){return this._getattr(n.name)||""},set:function(w){n.treatNullAsEmptyString&&w===null&&(w=""),this._setattr(n.name,w)}};if(typeof n.type=="function")return n.type(n.name,n)}throw new Error("Invalid attribute definition")};function e(n){var o;typeof n.default=="function"?o=n.default:typeof n.default=="number"?o=function(){return n.default}:o=function(){i.assert(!1,typeof n.default)};var r=n.type==="unsigned long",g=n.type==="long",w=n.type==="limited unsigned long with fallback",T=n.min,k=n.max,N=n.setmin;return T===void 0&&(r&&(T=0),g&&(T=-2147483648),w&&(T=1)),k===void 0&&(r||g||w)&&(k=2147483647),{get:function(){var V=this._getattr(n.name),q=n.float?parseFloat(V):parseInt(V,10);if(V===null||!isFinite(q)||T!==void 0&&q<T||k!==void 0&&q>k)return o.call(this);if(r||g||w){if(!/^[ \t\n\f\r]*[-+]?[0-9]/.test(V))return o.call(this);q=q|0}return q},set:function(V){n.float||(V=Math.floor(V)),N!==void 0&&V<N&&i.IndexSizeError(n.name+" set to "+V),r?V=V<0||V>2147483647?o.call(this):V|0:w?V=V<1||V>2147483647?o.call(this):V|0:g&&(V=V<-2147483648||V>2147483647?o.call(this):V|0),this._setattr(n.name,String(V))}}}t.registerChangeHandler=function(n,o,r){var g=n.prototype;Object.prototype.hasOwnProperty.call(g,"_attributeChangeHandlers")||(g._attributeChangeHandlers=Object.create(g._attributeChangeHandlers||null)),g._attributeChangeHandlers[o]=r}}}),Xue=Bn({"external/npm/node_modules/domino/lib/FilteredElementList.js"(t,i){i.exports=n;var e=xl();function n(o,r){this.root=o,this.filter=r,this.lastModTime=o.lastModTime,this.done=!1,this.cache=[],this.traverse()}n.prototype=Object.create(Object.prototype,{length:{get:function(){return this.checkcache(),this.done||this.traverse(),this.cache.length}},item:{value:function(o){return this.checkcache(),!this.done&&o>=this.cache.length&&this.traverse(),this.cache[o]}},checkcache:{value:function(){if(this.lastModTime!==this.root.lastModTime){for(var o=this.cache.length-1;o>=0;o--)this[o]=void 0;this.cache.length=0,this.done=!1,this.lastModTime=this.root.lastModTime}}},traverse:{value:function(o){o!==void 0&&o++;for(var r;(r=this.next())!==null;)if(this[this.cache.length]=r,this.cache.push(r),o&&this.cache.length===o)return;this.done=!0}},next:{value:function(){var o=this.cache.length===0?this.root:this.cache[this.cache.length-1],r;for(o.nodeType===e.DOCUMENT_NODE?r=o.documentElement:r=o.nextElement(this.root);r;){if(this.filter(r))return r;r=r.nextElement(this.root)}return null}}})}}),GH=Bn({"external/npm/node_modules/domino/lib/DOMTokenList.js"(t,i){var e=Ba();i.exports=n;function n(T,k){this._getString=T,this._setString=k,this._length=0,this._lastStringValue="",this._update()}Object.defineProperties(n.prototype,{length:{get:function(){return this._length}},item:{value:function(T){var k=w(this);return T<0||T>=k.length?null:k[T]}},contains:{value:function(T){T=String(T);var k=w(this);return k.indexOf(T)>-1}},add:{value:function(){for(var T=w(this),k=0,N=arguments.length;k<N;k++){var V=r(arguments[k]);T.indexOf(V)<0&&T.push(V)}this._update(T)}},remove:{value:function(){for(var T=w(this),k=0,N=arguments.length;k<N;k++){var V=r(arguments[k]),q=T.indexOf(V);q>-1&&T.splice(q,1)}this._update(T)}},toggle:{value:function(k,N){return k=r(k),this.contains(k)?N===void 0||N===!1?(this.remove(k),!1):!0:N===void 0||N===!0?(this.add(k),!0):!1}},replace:{value:function(k,N){String(N)===""&&e.SyntaxError(),k=r(k),N=r(N);var V=w(this),q=V.indexOf(k);if(q<0)return!1;var Z=V.indexOf(N);return Z<0?V[q]=N:q<Z?(V[q]=N,V.splice(Z,1)):V.splice(q,1),this._update(V),!0}},toString:{value:function(){return this._getString()}},value:{get:function(){return this._getString()},set:function(T){this._setString(T),this._update()}},_update:{value:function(T){T?(o(this,T),this._setString(T.join(" ").trim())):o(this,w(this)),this._lastStringValue=this._getString()}}});function o(T,k){var N=T._length,V;for(T._length=k.length,V=0;V<k.length;V++)T[V]=k[V];for(;V<N;V++)T[V]=void 0}function r(T){return T=String(T),T===""&&e.SyntaxError(),/[ \t\r\n\f]/.test(T)&&e.InvalidCharacterError(),T}function g(T){for(var k=T._length,N=Array(k),V=0;V<k;V++)N[V]=T[V];return N}function w(T){var k=T._getString();if(k===T._lastStringValue)return g(T);var N=k.replace(/(^[ \t\r\n\f]+)|([ \t\r\n\f]+$)/g,"");if(N==="")return[];var V=Object.create(null);return N.split(/[ \t\r\n\f]+/g).filter(function(q){var Z="$"+q;return V[Z]?!1:(V[Z]=!0,!0)})}}}),kP=Bn({"external/npm/node_modules/domino/lib/select.js"(t,i){var e=Object.create(null,{location:{get:function(){throw new Error("window.location is not supported.")}}}),n=function(we,xe){return we.compareDocumentPosition(xe)},o=function(we,xe){return n(we,xe)&2?1:-1},r=function(we){for(;(we=we.nextSibling)&&we.nodeType!==1;);return we},g=function(we){for(;(we=we.previousSibling)&&we.nodeType!==1;);return we},w=function(we){if(we=we.firstChild)for(;we.nodeType!==1&&(we=we.nextSibling););return we},T=function(we){if(we=we.lastChild)for(;we.nodeType!==1&&(we=we.previousSibling););return we},k=function(we){if(!we.parentNode)return!1;var xe=we.parentNode.nodeType;return xe===1||xe===9},N=function(we){if(!we)return we;var xe=we[0];return xe==='"'||xe==="'"?(we[we.length-1]===xe?we=we.slice(1,-1):we=we.slice(1),we.replace(ye.str_escape,function(le){var ke=/^\\(?:([0-9A-Fa-f]+)|([\r\n\f]+))/.exec(le);if(!ke)return le.slice(1);if(ke[2])return"";var He=parseInt(ke[1],16);return String.fromCodePoint?String.fromCodePoint(He):String.fromCharCode(He)})):ye.ident.test(we)?V(we):we},V=function(we){return we.replace(ye.escape,function(xe){var le=/^\\([0-9A-Fa-f]+)/.exec(xe);if(!le)return xe[1];var ke=parseInt(le[1],16);return String.fromCodePoint?String.fromCodePoint(ke):String.fromCharCode(ke)})},q=function(){return Array.prototype.indexOf?Array.prototype.indexOf:function(we,xe){for(var le=this.length;le--;)if(this[le]===xe)return le;return-1}}(),Z=function(we,xe){var le=ye.inside.source.replace(/</g,we).replace(/>/g,xe);return new RegExp(le)},X=function(we,xe,le){return we=we.source,we=we.replace(xe,le.source||le),new RegExp(we)},te=function(we,xe){return we.replace(/^(?:\w+:\/\/|\/+)/,"").replace(/(?:\/+|\/*#.*?)$/,"").split("/",xe).join("/")},De=function(we,xe){var le=we.replace(/\s+/g,""),ke;return le==="even"?le="2n+0":le==="odd"?le="2n+1":le.indexOf("n")===-1&&(le="0n"+le),ke=/^([+-])?(\d+)?n([+-])?(\d+)?$/.exec(le),{group:ke[1]==="-"?-(ke[2]||1):+(ke[2]||1),offset:ke[4]?ke[3]==="-"?-ke[4]:+ke[4]:0}},_e=function(we,xe,le){var ke=De(we),He=ke.group,yt=ke.offset,li=le?T:w,Ai=le?g:r;return function(hi){if(k(hi))for(var it=li(hi.parentNode),pt=0;it;){if(xe(it,hi)&&pt++,it===hi)return pt-=yt,He&&pt?pt%He===0&&pt<0==He<0:!pt;it=Ai(it)}}},he={"*":function(){return function(){return!0}}(),type:function(we){return we=we.toLowerCase(),function(xe){return xe.nodeName.toLowerCase()===we}},attr:function(we,xe,le,ke){return xe=Ce[xe],function(He){var yt;switch(we){case"for":yt=He.htmlFor;break;case"class":yt=He.className,yt===""&&He.getAttribute("class")==null&&(yt=null);break;case"href":case"src":yt=He.getAttribute(we,2);break;case"title":yt=He.getAttribute("title")||null;break;case"id":case"lang":case"dir":case"accessKey":case"hidden":case"tabIndex":case"style":if(He.getAttribute){yt=He.getAttribute(we);break}default:if(He.hasAttribute&&!He.hasAttribute(we))break;yt=He[we]!=null?He[we]:He.getAttribute&&He.getAttribute(we);break}if(yt!=null)return yt=yt+"",ke&&(yt=yt.toLowerCase(),le=le.toLowerCase()),xe(yt,le)}},":first-child":function(we){return!g(we)&&k(we)},":last-child":function(we){return!r(we)&&k(we)},":only-child":function(we){return!g(we)&&!r(we)&&k(we)},":nth-child":function(we,xe){return _e(we,function(){return!0},xe)},":nth-last-child":function(we){return he[":nth-child"](we,!0)},":root":function(we){return we.ownerDocument.documentElement===we},":empty":function(we){return!we.firstChild},":not":function(we){var xe=Pt(we);return function(le){return!xe(le)}},":first-of-type":function(we){if(k(we)){for(var xe=we.nodeName;we=g(we);)if(we.nodeName===xe)return;return!0}},":last-of-type":function(we){if(k(we)){for(var xe=we.nodeName;we=r(we);)if(we.nodeName===xe)return;return!0}},":only-of-type":function(we){return he[":first-of-type"](we)&&he[":last-of-type"](we)},":nth-of-type":function(we,xe){return _e(we,function(le,ke){return le.nodeName===ke.nodeName},xe)},":nth-last-of-type":function(we){return he[":nth-of-type"](we,!0)},":checked":function(we){return!!(we.checked||we.selected)},":indeterminate":function(we){return!he[":checked"](we)},":enabled":function(we){return!we.disabled&&we.type!=="hidden"},":disabled":function(we){return!!we.disabled},":target":function(we){return we.id===e.location.hash.substring(1)},":focus":function(we){return we===we.ownerDocument.activeElement},":is":function(we){return Pt(we)},":matches":function(we){return he[":is"](we)},":nth-match":function(we,xe){var le=we.split(/\s*,\s*/),ke=le.shift(),He=Pt(le.join(","));return _e(ke,He,xe)},":nth-last-match":function(we){return he[":nth-match"](we,!0)},":links-here":function(we){return we+""==e.location+""},":lang":function(we){return function(xe){for(;xe;){if(xe.lang)return xe.lang.indexOf(we)===0;xe=xe.parentNode}}},":dir":function(we){return function(xe){for(;xe;){if(xe.dir)return xe.dir===we;xe=xe.parentNode}}},":scope":function(we,xe){var le=xe||we.ownerDocument;return le.nodeType===9?we===le.documentElement:we===le},":any-link":function(we){return typeof we.href=="string"},":local-link":function(we){if(we.nodeName)return we.href&&we.host===e.location.host;var xe=+we+1;return function(le){if(le.href){var ke=e.location+"",He=le+"";return te(ke,xe)===te(He,xe)}}},":default":function(we){return!!we.defaultSelected},":valid":function(we){return we.willValidate||we.validity&&we.validity.valid},":invalid":function(we){return!he[":valid"](we)},":in-range":function(we){return we.value>we.min&&we.value<=we.max},":out-of-range":function(we){return!he[":in-range"](we)},":required":function(we){return!!we.required},":optional":function(we){return!we.required},":read-only":function(we){if(we.readOnly)return!0;var xe=we.getAttribute("contenteditable"),le=we.contentEditable,ke=we.nodeName.toLowerCase();return ke=ke!=="input"&&ke!=="textarea",(ke||we.disabled)&&xe==null&&le!=="true"},":read-write":function(we){return!he[":read-only"](we)},":hover":function(){throw new Error(":hover is not supported.")},":active":function(){throw new Error(":active is not supported.")},":link":function(){throw new Error(":link is not supported.")},":visited":function(){throw new Error(":visited is not supported.")},":column":function(){throw new Error(":column is not supported.")},":nth-column":function(){throw new Error(":nth-column is not supported.")},":nth-last-column":function(){throw new Error(":nth-last-column is not supported.")},":current":function(){throw new Error(":current is not supported.")},":past":function(){throw new Error(":past is not supported.")},":future":function(){throw new Error(":future is not supported.")},":contains":function(we){return function(xe){var le=xe.innerText||xe.textContent||xe.value||"";return le.indexOf(we)!==-1}},":has":function(we){return function(xe){return ui(we,xe).length>0}}},Ce={"-":function(){return!0},"=":function(we,xe){return we===xe},"*=":function(we,xe){return we.indexOf(xe)!==-1},"~=":function(we,xe){var le,ke,He,yt;for(ke=0;;ke=le+1){if(le=we.indexOf(xe,ke),le===-1)return!1;if(He=we[le-1],yt=we[le+xe.length],(!He||He===" ")&&(!yt||yt===" "))return!0}},"|=":function(we,xe){var le=we.indexOf(xe),ke;if(le===0)return ke=we[le+xe.length],ke==="-"||!ke},"^=":function(we,xe){return we.indexOf(xe)===0},"$=":function(we,xe){var le=we.lastIndexOf(xe);return le!==-1&&le+xe.length===we.length},"!=":function(we,xe){return we!==xe}},Pe={" ":function(we){return function(xe){for(;xe=xe.parentNode;)if(we(xe))return xe}},">":function(we){return function(xe){if(xe=xe.parentNode)return we(xe)&&xe}},"+":function(we){return function(xe){if(xe=g(xe))return we(xe)&&xe}},"~":function(we){return function(xe){for(;xe=g(xe);)if(we(xe))return xe}},noop:function(we){return function(xe){return we(xe)&&xe}},ref:function(we,xe){var le;function ke(He){for(var yt=He.ownerDocument,li=yt.getElementsByTagName("*"),Ai=li.length;Ai--;)if(le=li[Ai],ke.test(He))return le=null,!0;le=null}return ke.combinator=function(He){if(!(!le||!le.getAttribute)){var yt=le.getAttribute(xe)||"";if(yt[0]==="#"&&(yt=yt.substring(1)),yt===He.id&&we(le))return le}},ke}},ye={escape:/\\(?:[^0-9A-Fa-f\r\n]|[0-9A-Fa-f]{1,6}[\r\n\t ]?)/g,str_escape:/(escape)|\\(\n|\r\n?|\f)/g,nonascii:/[\u00A0-\uFFFF]/,cssid:/(?:(?!-?[0-9])(?:escape|nonascii|[-_a-zA-Z0-9])+)/,qname:/^ *(cssid|\*)/,simple:/^(?:([.#]cssid)|pseudo|attr)/,ref:/^ *\/(cssid)\/ */,combinator:/^(?: +([^ \w*.#\\]) +|( )+|([^ \w*.#\\]))(?! *$)/,attr:/^\[(cssid)(?:([^\w]?=)(inside))?\]/,pseudo:/^(:cssid)(?:\((inside)\))?/,inside:/(?:"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|<[^"'>]*>|\\["'>]|[^"'>])*/,ident:/^(cssid)$/};ye.cssid=X(ye.cssid,"nonascii",ye.nonascii),ye.cssid=X(ye.cssid,"escape",ye.escape),ye.qname=X(ye.qname,"cssid",ye.cssid),ye.simple=X(ye.simple,"cssid",ye.cssid),ye.ref=X(ye.ref,"cssid",ye.cssid),ye.attr=X(ye.attr,"cssid",ye.cssid),ye.pseudo=X(ye.pseudo,"cssid",ye.cssid),ye.inside=X(ye.inside,`[^"'>]*`,ye.inside),ye.attr=X(ye.attr,"inside",Z("\\[","\\]")),ye.pseudo=X(ye.pseudo,"inside",Z("\\(","\\)")),ye.simple=X(ye.simple,"pseudo",ye.pseudo),ye.simple=X(ye.simple,"attr",ye.attr),ye.ident=X(ye.ident,"cssid",ye.cssid),ye.str_escape=X(ye.str_escape,"escape",ye.escape);var vt=function(we){for(var xe=we.replace(/^\s+|\s+$/g,""),le,ke=[],He=[],yt,li,Ai,hi,it;xe;){if(Ai=ye.qname.exec(xe))xe=xe.substring(Ai[0].length),li=V(Ai[1]),He.push(Rt(li,!0));else if(Ai=ye.simple.exec(xe))xe=xe.substring(Ai[0].length),li="*",He.push(Rt(li,!0)),He.push(Rt(Ai));else throw new SyntaxError("Invalid selector.");for(;Ai=ye.simple.exec(xe);)xe=xe.substring(Ai[0].length),He.push(Rt(Ai));if(xe[0]==="!"&&(xe=xe.substring(1),yt=We(),yt.qname=li,He.push(yt.simple)),Ai=ye.ref.exec(xe)){xe=xe.substring(Ai[0].length),it=Pe.ref(ut(He),V(Ai[1])),ke.push(it.combinator),He=[];continue}if(Ai=ye.combinator.exec(xe)){if(xe=xe.substring(Ai[0].length),hi=Ai[1]||Ai[2]||Ai[3],hi===","){ke.push(Pe.noop(ut(He)));break}}else hi="noop";if(!Pe[hi])throw new SyntaxError("Bad combinator.");ke.push(Pe[hi](ut(He))),He=[]}return le=ct(ke),le.qname=li,le.sel=xe,yt&&(yt.lname=le.qname,yt.test=le,yt.qname=yt.qname,yt.sel=le.sel,le=yt),it&&(it.test=le,it.qname=le.qname,it.sel=le.sel,le=it),le},Rt=function(we,xe){if(xe)return we==="*"?he["*"]:he.type(we);if(we[1])return we[1][0]==="."?he.attr("class","~=",V(we[1].substring(1)),!1):he.attr("id","=",V(we[1].substring(1)),!1);if(we[2])return we[3]?he[V(we[2])](N(we[3])):he[V(we[2])];if(we[4]){var le=we[6],ke=/["'\s]\s*I$/i.test(le);return ke&&(le=le.replace(/\s*I$/i,"")),he.attr(V(we[4]),we[5]||"-",N(le),ke)}throw new SyntaxError("Unknown Selector.")},ut=function(we){var xe=we.length,le;return xe<2?we[0]:function(ke){if(ke){for(le=0;le<xe;le++)if(!we[le](ke))return;return!0}}},ct=function(we){return we.length<2?function(xe){return!!we[0](xe)}:function(xe){for(var le=we.length;le--;)if(!(xe=we[le](xe)))return;return!0}},We=function(){var we;function xe(le){for(var ke=le.ownerDocument,He=ke.getElementsByTagName(xe.lname),yt=He.length;yt--;)if(xe.test(He[yt])&&we===le)return we=null,!0;we=null}return xe.simple=function(le){return we=le,!0},xe},Pt=function(we){for(var xe=vt(we),le=[xe];xe.sel;)xe=vt(xe.sel),le.push(xe);return le.length<2?xe:function(ke){for(var He=le.length,yt=0;yt<He;yt++)if(le[yt](ke))return!0}},ui=function(we,xe){for(var le=[],ke=vt(we),He=xe.getElementsByTagName(ke.qname),yt=0,li;li=He[yt++];)ke(li)&&le.push(li);if(ke.sel){for(;ke.sel;)for(ke=vt(ke.sel),He=xe.getElementsByTagName(ke.qname),yt=0;li=He[yt++];)ke(li)&&q.call(le,li)===-1&&le.push(li);le.sort(o)}return le};i.exports=t=function(we,xe){var le,ke;if(xe.nodeType!==11&&we.indexOf(" ")===-1){if(we[0]==="#"&&xe.rooted&&/^#[A-Z_][-A-Z0-9_]*$/i.test(we)&&xe.doc._hasMultipleElementsWithId&&(le=we.substring(1),!xe.doc._hasMultipleElementsWithId(le)))return ke=xe.doc.getElementById(le),ke?[ke]:[];if(we[0]==="."&&/^\.\w+$/.test(we))return xe.getElementsByClassName(we.substring(1));if(/^\w+$/.test(we))return xe.getElementsByTagName(we)}return ui(we,xe)},t.selectors=he,t.operators=Ce,t.combinators=Pe,t.matches=function(we,xe){var le={sel:xe};do if(le=vt(le.sel),le(we))return!0;while(le.sel);return!1}}}),OP=Bn({"external/npm/node_modules/domino/lib/ChildNode.js"(t,i){var e=xl(),n=HH(),o=function(g,w){for(var T=g.createDocumentFragment(),k=0;k<w.length;k++){var N=w[k],V=N instanceof e;T.appendChild(V?N:g.createTextNode(String(N)))}return T},r={after:{value:function(){var w=Array.prototype.slice.call(arguments),T=this.parentNode,k=this.nextSibling;if(T!==null){for(;k&&w.some(function(V){return V===k});)k=k.nextSibling;var N=o(this.doc,w);T.insertBefore(N,k)}}},before:{value:function(){var w=Array.prototype.slice.call(arguments),T=this.parentNode,k=this.previousSibling;if(T!==null){for(;k&&w.some(function(q){return q===k});)k=k.previousSibling;var N=o(this.doc,w),V=k?k.nextSibling:T.firstChild;T.insertBefore(N,V)}}},remove:{value:function(){this.parentNode!==null&&(this.doc&&(this.doc._preremoveNodeIterators(this),this.rooted&&this.doc.mutateRemove(this)),this._remove(),this.parentNode=null)}},_remove:{value:function(){var w=this.parentNode;w!==null&&(w._childNodes?w._childNodes.splice(this.index,1):w._firstChild===this&&(this._nextSibling===this?w._firstChild=null:w._firstChild=this._nextSibling),n.remove(this),w.modify())}},replaceWith:{value:function(){var w=Array.prototype.slice.call(arguments),T=this.parentNode,k=this.nextSibling;if(T!==null){for(;k&&w.some(function(V){return V===k});)k=k.nextSibling;var N=o(this.doc,w);this.parentNode===T?T.replaceChild(N,this):T.insertBefore(N,k)}}}};i.exports=r}}),WH=Bn({"external/npm/node_modules/domino/lib/NonDocumentTypeChildNode.js"(t,i){var e=xl(),n={nextElementSibling:{get:function(){if(this.parentNode){for(var o=this.nextSibling;o!==null;o=o.nextSibling)if(o.nodeType===e.ELEMENT_NODE)return o}return null}},previousElementSibling:{get:function(){if(this.parentNode){for(var o=this.previousSibling;o!==null;o=o.previousSibling)if(o.nodeType===e.ELEMENT_NODE)return o}return null}}};i.exports=n}}),ZH=Bn({"external/npm/node_modules/domino/lib/NamedNodeMap.js"(t,i){i.exports=n;var e=Ba();function n(o){this.element=o}Object.defineProperties(n.prototype,{length:{get:e.shouldOverride},item:{value:e.shouldOverride},getNamedItem:{value:function(r){return this.element.getAttributeNode(r)}},getNamedItemNS:{value:function(r,g){return this.element.getAttributeNodeNS(r,g)}},setNamedItem:{value:e.nyi},setNamedItemNS:{value:e.nyi},removeNamedItem:{value:function(r){var g=this.element.getAttributeNode(r);if(g)return this.element.removeAttribute(r),g;e.NotFoundError()}},removeNamedItemNS:{value:function(r,g){var w=this.element.getAttributeNodeNS(r,g);if(w)return this.element.removeAttributeNS(r,g),w;e.NotFoundError()}}})}}),ew=Bn({"external/npm/node_modules/domino/lib/Element.js"(t,i){i.exports=he;var e=RP(),n=Ba(),o=n.NAMESPACE,r=$H(),g=xl(),w=Xy(),T=qH(),k=Xue(),N=MP(),V=GH(),q=kP(),Z=AP(),X=OP(),te=WH(),De=ZH(),_e=Object.create(null);function he(xe,le,ke,He){Z.call(this),this.nodeType=g.ELEMENT_NODE,this.ownerDocument=xe,this.localName=le,this.namespaceURI=ke,this.prefix=He,this._tagName=void 0,this._attrsByQName=Object.create(null),this._attrsByLName=Object.create(null),this._attrKeys=[]}function Ce(xe,le){if(xe.nodeType===g.TEXT_NODE)le.push(xe._data);else for(var ke=0,He=xe.childNodes.length;ke<He;ke++)Ce(xe.childNodes[ke],le)}he.prototype=Object.create(Z.prototype,{isHTML:{get:function(){return this.namespaceURI===o.HTML&&this.ownerDocument.isHTML}},tagName:{get:function(){if(this._tagName===void 0){var le;if(this.prefix===null?le=this.localName:le=this.prefix+":"+this.localName,this.isHTML){var ke=_e[le];ke||(_e[le]=ke=n.toASCIIUpperCase(le)),le=ke}this._tagName=le}return this._tagName}},nodeName:{get:function(){return this.tagName}},nodeValue:{get:function(){return null},set:function(){}},textContent:{get:function(){var xe=[];return Ce(this,xe),xe.join("")},set:function(xe){this.removeChildren(),xe!=null&&xe!==""&&this._appendChild(this.ownerDocument.createTextNode(xe))}},innerText:{get:function(){var xe=[];return Ce(this,xe),xe.join("").replace(/[ \t\n\f\r]+/g," ").trim()},set:function(xe){this.removeChildren(),xe!=null&&xe!==""&&this._appendChild(this.ownerDocument.createTextNode(xe))}},innerHTML:{get:function(){return this.serialize()},set:n.nyi},outerHTML:{get:function(){return T.serializeOne(this,{nodeType:0})},set:function(xe){var le=this.ownerDocument,ke=this.parentNode;if(ke!==null){ke.nodeType===g.DOCUMENT_NODE&&n.NoModificationAllowedError(),ke.nodeType===g.DOCUMENT_FRAGMENT_NODE&&(ke=ke.ownerDocument.createElement("body"));var He=le.implementation.mozHTMLParser(le._address,ke);He.parse(xe===null?"":String(xe),!0),this.replaceWith(He._asDocumentFragment())}}},_insertAdjacent:{value:function(le,ke){var He=!1;switch(le){case"beforebegin":He=!0;case"afterend":var yt=this.parentNode;return yt===null?null:yt.insertBefore(ke,He?this:this.nextSibling);case"afterbegin":He=!0;case"beforeend":return this.insertBefore(ke,He?this.firstChild:null);default:return n.SyntaxError()}}},insertAdjacentElement:{value:function(le,ke){if(ke.nodeType!==g.ELEMENT_NODE)throw new TypeError("not an element");return le=n.toASCIILowerCase(String(le)),this._insertAdjacent(le,ke)}},insertAdjacentText:{value:function(le,ke){var He=this.ownerDocument.createTextNode(ke);le=n.toASCIILowerCase(String(le)),this._insertAdjacent(le,He)}},insertAdjacentHTML:{value:function(le,ke){le=n.toASCIILowerCase(String(le)),ke=String(ke);var He;switch(le){case"beforebegin":case"afterend":He=this.parentNode,(He===null||He.nodeType===g.DOCUMENT_NODE)&&n.NoModificationAllowedError();break;case"afterbegin":case"beforeend":He=this;break;default:n.SyntaxError()}(!(He instanceof he)||He.ownerDocument.isHTML&&He.localName==="html"&&He.namespaceURI===o.HTML)&&(He=He.ownerDocument.createElementNS(o.HTML,"body"));var yt=this.ownerDocument.implementation.mozHTMLParser(this.ownerDocument._address,He);yt.parse(ke,!0),this._insertAdjacent(le,yt._asDocumentFragment())}},children:{get:function(){return this._children||(this._children=new Rt(this)),this._children}},attributes:{get:function(){return this._attributes||(this._attributes=new ye(this)),this._attributes}},firstElementChild:{get:function(){for(var xe=this.firstChild;xe!==null;xe=xe.nextSibling)if(xe.nodeType===g.ELEMENT_NODE)return xe;return null}},lastElementChild:{get:function(){for(var xe=this.lastChild;xe!==null;xe=xe.previousSibling)if(xe.nodeType===g.ELEMENT_NODE)return xe;return null}},childElementCount:{get:function(){return this.children.length}},nextElement:{value:function(xe){xe||(xe=this.ownerDocument.documentElement);var le=this.firstElementChild;if(!le){if(this===xe)return null;le=this.nextElementSibling}if(le)return le;for(var ke=this.parentElement;ke&&ke!==xe;ke=ke.parentElement)if(le=ke.nextElementSibling,le)return le;return null}},getElementsByTagName:{value:function(le){var ke;return le?(le==="*"?ke=function(){return!0}:this.isHTML?ke=ct(le):ke=ut(le),new k(this,ke)):new w}},getElementsByTagNameNS:{value:function(le,ke){var He;return le==="*"&&ke==="*"?He=function(){return!0}:le==="*"?He=ut(ke):ke==="*"?He=We(le):He=Pt(le,ke),new k(this,He)}},getElementsByClassName:{value:function(le){if(le=String(le).trim(),le===""){var ke=new w;return ke}return le=le.split(/[ \t\r\n\f]+/),new k(this,ui(le))}},getElementsByName:{value:function(le){return new k(this,we(String(le)))}},clone:{value:function(){var le;this.namespaceURI!==o.HTML||this.prefix||!this.ownerDocument.isHTML?le=this.ownerDocument.createElementNS(this.namespaceURI,this.prefix!==null?this.prefix+":"+this.localName:this.localName):le=this.ownerDocument.createElement(this.localName);for(var ke=0,He=this._attrKeys.length;ke<He;ke++){var yt=this._attrKeys[ke],li=this._attrsByLName[yt],Ai=li.cloneNode();Ai._setOwnerElement(le),le._attrsByLName[yt]=Ai,le._addQName(Ai)}return le._attrKeys=this._attrKeys.concat(),le}},isEqual:{value:function(le){if(this.localName!==le.localName||this.namespaceURI!==le.namespaceURI||this.prefix!==le.prefix||this._numattrs!==le._numattrs)return!1;for(var ke=0,He=this._numattrs;ke<He;ke++){var yt=this._attr(ke);if(!le.hasAttributeNS(yt.namespaceURI,yt.localName)||le.getAttributeNS(yt.namespaceURI,yt.localName)!==yt.value)return!1}return!0}},_lookupNamespacePrefix:{value:function(le,ke){if(this.namespaceURI&&this.namespaceURI===le&&this.prefix!==null&&ke.lookupNamespaceURI(this.prefix)===le)return this.prefix;for(var He=0,yt=this._numattrs;He<yt;He++){var li=this._attr(He);if(li.prefix==="xmlns"&&li.value===le&&ke.lookupNamespaceURI(li.localName)===le)return li.localName}var Ai=this.parentElement;return Ai?Ai._lookupNamespacePrefix(le,ke):null}},lookupNamespaceURI:{value:function(le){if((le===""||le===void 0)&&(le=null),this.namespaceURI!==null&&this.prefix===le)return this.namespaceURI;for(var ke=0,He=this._numattrs;ke<He;ke++){var yt=this._attr(ke);if(yt.namespaceURI===o.XMLNS&&(yt.prefix==="xmlns"&&yt.localName===le||le===null&&yt.prefix===null&&yt.localName==="xmlns"))return yt.value||null}var li=this.parentElement;return li?li.lookupNamespaceURI(le):null}},getAttribute:{value:function(le){var ke=this.getAttributeNode(le);return ke?ke.value:null}},getAttributeNS:{value:function(le,ke){var He=this.getAttributeNodeNS(le,ke);return He?He.value:null}},getAttributeNode:{value:function(le){le=String(le),/[A-Z]/.test(le)&&this.isHTML&&(le=n.toASCIILowerCase(le));var ke=this._attrsByQName[le];return ke?(Array.isArray(ke)&&(ke=ke[0]),ke):null}},getAttributeNodeNS:{value:function(le,ke){le=le==null?"":String(le),ke=String(ke);var He=this._attrsByLName[le+"|"+ke];return He||null}},hasAttribute:{value:function(le){return le=String(le),/[A-Z]/.test(le)&&this.isHTML&&(le=n.toASCIILowerCase(le)),this._attrsByQName[le]!==void 0}},hasAttributeNS:{value:function(le,ke){le=le==null?"":String(le),ke=String(ke);var He=le+"|"+ke;return this._attrsByLName[He]!==void 0}},hasAttributes:{value:function(){return this._numattrs>0}},toggleAttribute:{value:function(le,ke){le=String(le),e.isValidName(le)||n.InvalidCharacterError(),/[A-Z]/.test(le)&&this.isHTML&&(le=n.toASCIILowerCase(le));var He=this._attrsByQName[le];return He===void 0?ke===void 0||ke===!0?(this._setAttribute(le,""),!0):!1:ke===void 0||ke===!1?(this.removeAttribute(le),!1):!0}},_setAttribute:{value:function(le,ke){var He=this._attrsByQName[le],yt;He?Array.isArray(He)&&(He=He[0]):(He=this._newattr(le),yt=!0),He.value=ke,this._attributes&&(this._attributes[le]=He),yt&&this._newattrhook&&this._newattrhook(le,ke)}},setAttribute:{value:function(le,ke){le=String(le),e.isValidName(le)||n.InvalidCharacterError(),/[A-Z]/.test(le)&&this.isHTML&&(le=n.toASCIILowerCase(le)),this._setAttribute(le,String(ke))}},_setAttributeNS:{value:function(le,ke,He){var yt=ke.indexOf(":"),li,Ai;yt<0?(li=null,Ai=ke):(li=ke.substring(0,yt),Ai=ke.substring(yt+1)),(le===""||le===void 0)&&(le=null);var hi=(le===null?"":le)+"|"+Ai,it=this._attrsByLName[hi],pt;it||(it=new Pe(this,Ai,li,le),pt=!0,this._attrsByLName[hi]=it,this._attributes&&(this._attributes[this._attrKeys.length]=it),this._attrKeys.push(hi),this._addQName(it)),it.value=He,pt&&this._newattrhook&&this._newattrhook(ke,He)}},setAttributeNS:{value:function(le,ke,He){le=le==null||le===""?null:String(le),ke=String(ke),e.isValidQName(ke)||n.InvalidCharacterError();var yt=ke.indexOf(":"),li=yt<0?null:ke.substring(0,yt);(li!==null&&le===null||li==="xml"&&le!==o.XML||(ke==="xmlns"||li==="xmlns")&&le!==o.XMLNS||le===o.XMLNS&&!(ke==="xmlns"||li==="xmlns"))&&n.NamespaceError(),this._setAttributeNS(le,ke,String(He))}},setAttributeNode:{value:function(le){if(le.ownerElement!==null&&le.ownerElement!==this)throw new N(N.INUSE_ATTRIBUTE_ERR);var ke=null,He=this._attrsByQName[le.name];if(He){if(Array.isArray(He)||(He=[He]),He.some(function(yt){return yt===le}))return le;if(le.ownerElement!==null)throw new N(N.INUSE_ATTRIBUTE_ERR);He.forEach(function(yt){this.removeAttributeNode(yt)},this),ke=He[0]}return this.setAttributeNodeNS(le),ke}},setAttributeNodeNS:{value:function(le){if(le.ownerElement!==null)throw new N(N.INUSE_ATTRIBUTE_ERR);var ke=le.namespaceURI,He=(ke===null?"":ke)+"|"+le.localName,yt=this._attrsByLName[He];return yt&&this.removeAttributeNode(yt),le._setOwnerElement(this),this._attrsByLName[He]=le,this._attributes&&(this._attributes[this._attrKeys.length]=le),this._attrKeys.push(He),this._addQName(le),this._newattrhook&&this._newattrhook(le.name,le.value),yt||null}},removeAttribute:{value:function(le){le=String(le),/[A-Z]/.test(le)&&this.isHTML&&(le=n.toASCIILowerCase(le));var ke=this._attrsByQName[le];if(ke){Array.isArray(ke)?ke.length>2?ke=ke.shift():(this._attrsByQName[le]=ke[1],ke=ke[0]):this._attrsByQName[le]=void 0;var He=ke.namespaceURI,yt=(He===null?"":He)+"|"+ke.localName;this._attrsByLName[yt]=void 0;var li=this._attrKeys.indexOf(yt);this._attributes&&(Array.prototype.splice.call(this._attributes,li,1),this._attributes[le]=void 0),this._attrKeys.splice(li,1);var Ai=ke.onchange;ke._setOwnerElement(null),Ai&&Ai.call(ke,this,ke.localName,ke.value,null),this.rooted&&this.ownerDocument.mutateRemoveAttr(ke)}}},removeAttributeNS:{value:function(le,ke){le=le==null?"":String(le),ke=String(ke);var He=le+"|"+ke,yt=this._attrsByLName[He];if(yt){this._attrsByLName[He]=void 0;var li=this._attrKeys.indexOf(He);this._attributes&&Array.prototype.splice.call(this._attributes,li,1),this._attrKeys.splice(li,1),this._removeQName(yt);var Ai=yt.onchange;yt._setOwnerElement(null),Ai&&Ai.call(yt,this,yt.localName,yt.value,null),this.rooted&&this.ownerDocument.mutateRemoveAttr(yt)}}},removeAttributeNode:{value:function(le){var ke=le.namespaceURI,He=(ke===null?"":ke)+"|"+le.localName;return this._attrsByLName[He]!==le&&n.NotFoundError(),this.removeAttributeNS(ke,le.localName),le}},getAttributeNames:{value:function(){var le=this;return this._attrKeys.map(function(ke){return le._attrsByLName[ke].name})}},_getattr:{value:function(le){var ke=this._attrsByQName[le];return ke?ke.value:null}},_setattr:{value:function(le,ke){var He=this._attrsByQName[le],yt;He||(He=this._newattr(le),yt=!0),He.value=String(ke),this._attributes&&(this._attributes[le]=He),yt&&this._newattrhook&&this._newattrhook(le,ke)}},_newattr:{value:function(le){var ke=new Pe(this,le,null,null),He="|"+le;return this._attrsByQName[le]=ke,this._attrsByLName[He]=ke,this._attributes&&(this._attributes[this._attrKeys.length]=ke),this._attrKeys.push(He),ke}},_addQName:{value:function(xe){var le=xe.name,ke=this._attrsByQName[le];ke?Array.isArray(ke)?ke.push(xe):this._attrsByQName[le]=[ke,xe]:this._attrsByQName[le]=xe,this._attributes&&(this._attributes[le]=xe)}},_removeQName:{value:function(xe){var le=xe.name,ke=this._attrsByQName[le];if(Array.isArray(ke)){var He=ke.indexOf(xe);n.assert(He!==-1),ke.length===2?(this._attrsByQName[le]=ke[1-He],this._attributes&&(this._attributes[le]=this._attrsByQName[le])):(ke.splice(He,1),this._attributes&&this._attributes[le]===xe&&(this._attributes[le]=ke[0]))}else n.assert(ke===xe),this._attrsByQName[le]=void 0,this._attributes&&(this._attributes[le]=void 0)}},_numattrs:{get:function(){return this._attrKeys.length}},_attr:{value:function(xe){return this._attrsByLName[this._attrKeys[xe]]}},id:r.property({name:"id"}),className:r.property({name:"class"}),classList:{get:function(){var xe=this;if(this._classList)return this._classList;var le=new V(function(){return xe.className||""},function(ke){xe.className=ke});return this._classList=le,le},set:function(xe){this.className=xe}},matches:{value:function(xe){return q.matches(this,xe)}},closest:{value:function(xe){var le=this;do{if(le.matches&&le.matches(xe))return le;le=le.parentElement||le.parentNode}while(le!==null&&le.nodeType===g.ELEMENT_NODE);return null}},querySelector:{value:function(xe){return q(xe,this)[0]}},querySelectorAll:{value:function(xe){var le=q(xe,this);return le.item?le:new w(le)}}}),Object.defineProperties(he.prototype,X),Object.defineProperties(he.prototype,te),r.registerChangeHandler(he,"id",function(xe,le,ke,He){xe.rooted&&(ke&&xe.ownerDocument.delId(ke,xe),He&&xe.ownerDocument.addId(He,xe))}),r.registerChangeHandler(he,"class",function(xe,le,ke,He){xe._classList&&xe._classList._update()});function Pe(xe,le,ke,He,yt){this.localName=le,this.prefix=ke===null||ke===""?null:""+ke,this.namespaceURI=He===null||He===""?null:""+He,this.data=yt,this._setOwnerElement(xe)}Pe.prototype=Object.create(Object.prototype,{ownerElement:{get:function(){return this._ownerElement}},_setOwnerElement:{value:function(le){this._ownerElement=le,this.prefix===null&&this.namespaceURI===null&&le?this.onchange=le._attributeChangeHandlers[this.localName]:this.onchange=null}},name:{get:function(){return this.prefix?this.prefix+":"+this.localName:this.localName}},specified:{get:function(){return!0}},value:{get:function(){return this.data},set:function(xe){var le=this.data;xe=xe===void 0?"":xe+"",xe!==le&&(this.data=xe,this.ownerElement&&(this.onchange&&this.onchange(this.ownerElement,this.localName,le,xe),this.ownerElement.rooted&&this.ownerElement.ownerDocument.mutateAttr(this,le)))}},cloneNode:{value:function(le){return new Pe(null,this.localName,this.prefix,this.namespaceURI,this.data)}},nodeType:{get:function(){return g.ATTRIBUTE_NODE}},nodeName:{get:function(){return this.name}},nodeValue:{get:function(){return this.value},set:function(xe){this.value=xe}},textContent:{get:function(){return this.value},set:function(xe){xe==null&&(xe=""),this.value=xe}},innerText:{get:function(){return this.value},set:function(xe){xe==null&&(xe=""),this.value=xe}}}),he._Attr=Pe;function ye(xe){De.call(this,xe);for(var le in xe._attrsByQName)this[le]=xe._attrsByQName[le];for(var ke=0;ke<xe._attrKeys.length;ke++)this[ke]=xe._attrsByLName[xe._attrKeys[ke]]}ye.prototype=Object.create(De.prototype,{length:{get:function(){return this.element._attrKeys.length},set:function(){}},item:{value:function(xe){return xe=xe>>>0,xe>=this.length?null:this.element._attrsByLName[this.element._attrKeys[xe]]}}});var vt;(vt=globalThis.Symbol)!=null&&vt.iterator&&(ye.prototype[globalThis.Symbol.iterator]=function(){var xe=0,le=this.length,ke=this;return{next:function(){return xe<le?{value:ke.item(xe++)}:{done:!0}}}});function Rt(xe){this.element=xe,this.updateCache()}Rt.prototype=Object.create(Object.prototype,{length:{get:function(){return this.updateCache(),this.childrenByNumber.length}},item:{value:function(le){return this.updateCache(),this.childrenByNumber[le]||null}},namedItem:{value:function(le){return this.updateCache(),this.childrenByName[le]||null}},namedItems:{get:function(){return this.updateCache(),this.childrenByName}},updateCache:{value:function(){var le=/^(a|applet|area|embed|form|frame|frameset|iframe|img|object)$/;if(this.lastModTime!==this.element.lastModTime){this.lastModTime=this.element.lastModTime;for(var ke=this.childrenByNumber&&this.childrenByNumber.length||0,He=0;He<ke;He++)this[He]=void 0;this.childrenByNumber=[],this.childrenByName=Object.create(null);for(var yt=this.element.firstChild;yt!==null;yt=yt.nextSibling)if(yt.nodeType===g.ELEMENT_NODE){this[this.childrenByNumber.length]=yt,this.childrenByNumber.push(yt);var li=yt.getAttribute("id");li&&!this.childrenByName[li]&&(this.childrenByName[li]=yt);var Ai=yt.getAttribute("name");Ai&&this.element.namespaceURI===o.HTML&&le.test(this.element.localName)&&!this.childrenByName[Ai]&&(this.childrenByName[li]=yt)}}}}});function ut(xe){return function(le){return le.localName===xe}}function ct(xe){var le=n.toASCIILowerCase(xe);return le===xe?ut(xe):function(ke){return ke.isHTML?ke.localName===le:ke.localName===xe}}function We(xe){return function(le){return le.namespaceURI===xe}}function Pt(xe,le){return function(ke){return ke.namespaceURI===xe&&ke.localName===le}}function ui(xe){return function(le){return xe.every(function(ke){return le.classList.contains(ke)})}}function we(xe){return function(le){return le.namespaceURI!==o.HTML?!1:le.getAttribute("name")===xe}}}}),YH=Bn({"external/npm/node_modules/domino/lib/Leaf.js"(t,i){i.exports=w;var e=xl(),n=Xy(),o=Ba(),r=o.HierarchyRequestError,g=o.NotFoundError;function w(){e.call(this)}w.prototype=Object.create(e.prototype,{hasChildNodes:{value:function(){return!1}},firstChild:{value:null},lastChild:{value:null},insertBefore:{value:function(T,k){if(!T.nodeType)throw new TypeError("not a node");r()}},replaceChild:{value:function(T,k){if(!T.nodeType)throw new TypeError("not a node");r()}},removeChild:{value:function(T){if(!T.nodeType)throw new TypeError("not a node");g()}},removeChildren:{value:function(){}},childNodes:{get:function(){return this._childNodes||(this._childNodes=new n),this._childNodes}}})}}),ZT=Bn({"external/npm/node_modules/domino/lib/CharacterData.js"(t,i){i.exports=g;var e=YH(),n=Ba(),o=OP(),r=WH();function g(){e.call(this)}g.prototype=Object.create(e.prototype,{substringData:{value:function(T,k){if(arguments.length<2)throw new TypeError("Not enough arguments");return T=T>>>0,k=k>>>0,(T>this.data.length||T<0||k<0)&&n.IndexSizeError(),this.data.substring(T,T+k)}},appendData:{value:function(T){if(arguments.length<1)throw new TypeError("Not enough arguments");this.data+=String(T)}},insertData:{value:function(T,k){return this.replaceData(T,0,k)}},deleteData:{value:function(T,k){return this.replaceData(T,k,"")}},replaceData:{value:function(T,k,N){var V=this.data,q=V.length;T=T>>>0,k=k>>>0,N=String(N),(T>q||T<0)&&n.IndexSizeError(),T+k>q&&(k=q-T);var Z=V.substring(0,T),X=V.substring(T+k);this.data=Z+N+X}},isEqual:{value:function(T){return this._data===T._data}},length:{get:function(){return this.data.length}}}),Object.defineProperties(g.prototype,o),Object.defineProperties(g.prototype,r)}}),KH=Bn({"external/npm/node_modules/domino/lib/Text.js"(t,i){i.exports=r;var e=Ba(),n=xl(),o=ZT();function r(w,T){o.call(this),this.nodeType=n.TEXT_NODE,this.ownerDocument=w,this._data=T,this._index=void 0}var g={get:function(){return this._data},set:function(w){w==null?w="":w=String(w),w!==this._data&&(this._data=w,this.rooted&&this.ownerDocument.mutateValue(this),this.parentNode&&this.parentNode._textchangehook&&this.parentNode._textchangehook(this))}};r.prototype=Object.create(o.prototype,{nodeName:{value:"#text"},nodeValue:g,textContent:g,innerText:g,data:{get:g.get,set:function(w){g.set.call(this,w===null?"":String(w))}},splitText:{value:function(T){(T>this._data.length||T<0)&&e.IndexSizeError();var k=this._data.substring(T),N=this.ownerDocument.createTextNode(k);this.data=this.data.substring(0,T);var V=this.parentNode;return V!==null&&V.insertBefore(N,this.nextSibling),N}},wholeText:{get:function(){for(var T=this.textContent,k=this.nextSibling;k&&k.nodeType===n.TEXT_NODE;k=k.nextSibling)T+=k.textContent;return T}},replaceWholeText:{value:e.nyi},clone:{value:function(){return new r(this.ownerDocument,this._data)}}})}}),XH=Bn({"external/npm/node_modules/domino/lib/Comment.js"(t,i){i.exports=o;var e=xl(),n=ZT();function o(g,w){n.call(this),this.nodeType=e.COMMENT_NODE,this.ownerDocument=g,this._data=w}var r={get:function(){return this._data},set:function(g){g==null?g="":g=String(g),this._data=g,this.rooted&&this.ownerDocument.mutateValue(this)}};o.prototype=Object.create(n.prototype,{nodeName:{value:"#comment"},nodeValue:r,textContent:r,innerText:r,data:{get:r.get,set:function(g){r.set.call(this,g===null?"":String(g))}},clone:{value:function(){return new o(this.ownerDocument,this._data)}}})}}),QH=Bn({"external/npm/node_modules/domino/lib/DocumentFragment.js"(t,i){i.exports=T;var e=xl(),n=Xy(),o=AP(),r=ew(),g=kP(),w=Ba();function T(k){o.call(this),this.nodeType=e.DOCUMENT_FRAGMENT_NODE,this.ownerDocument=k}T.prototype=Object.create(o.prototype,{nodeName:{value:"#document-fragment"},nodeValue:{get:function(){return null},set:function(){}},textContent:Object.getOwnPropertyDescriptor(r.prototype,"textContent"),innerText:Object.getOwnPropertyDescriptor(r.prototype,"innerText"),querySelector:{value:function(k){var N=this.querySelectorAll(k);return N.length?N[0]:null}},querySelectorAll:{value:function(k){var N=Object.create(this);N.isHTML=!0,N.getElementsByTagName=r.prototype.getElementsByTagName,N.nextElement=Object.getOwnPropertyDescriptor(r.prototype,"firstElementChild").get;var V=g(k,N);return V.item?V:new n(V)}},clone:{value:function(){return new T(this.ownerDocument)}},isEqual:{value:function(N){return!0}},innerHTML:{get:function(){return this.serialize()},set:w.nyi},outerHTML:{get:function(){return this.serialize()},set:w.nyi}})}}),JH=Bn({"external/npm/node_modules/domino/lib/ProcessingInstruction.js"(t,i){i.exports=o;var e=xl(),n=ZT();function o(g,w,T){n.call(this),this.nodeType=e.PROCESSING_INSTRUCTION_NODE,this.ownerDocument=g,this.target=w,this._data=T}var r={get:function(){return this._data},set:function(g){g==null?g="":g=String(g),this._data=g,this.rooted&&this.ownerDocument.mutateValue(this)}};o.prototype=Object.create(n.prototype,{nodeName:{get:function(){return this.target}},nodeValue:r,textContent:r,innerText:r,data:{get:r.get,set:function(g){r.set.call(this,g===null?"":String(g))}},clone:{value:function(){return new o(this.ownerDocument,this.target,this._data)}},isEqual:{value:function(w){return this.target===w.target&&this._data===w._data}}})}}),YT=Bn({"external/npm/node_modules/domino/lib/NodeFilter.js"(t,i){var e={FILTER_ACCEPT:1,FILTER_REJECT:2,FILTER_SKIP:3,SHOW_ALL:4294967295,SHOW_ELEMENT:1,SHOW_ATTRIBUTE:2,SHOW_TEXT:4,SHOW_CDATA_SECTION:8,SHOW_ENTITY_REFERENCE:16,SHOW_ENTITY:32,SHOW_PROCESSING_INSTRUCTION:64,SHOW_COMMENT:128,SHOW_DOCUMENT:256,SHOW_DOCUMENT_TYPE:512,SHOW_DOCUMENT_FRAGMENT:1024,SHOW_NOTATION:2048};i.exports=e.constructor=e.prototype=e}}),eq=Bn({"external/npm/node_modules/domino/lib/NodeTraversal.js"(t,i){i.exports={nextSkippingChildren:e,nextAncestorSibling:n,next:o,previous:g,deepLastChild:r};function e(w,T){return w===T?null:w.nextSibling!==null?w.nextSibling:n(w,T)}function n(w,T){for(w=w.parentNode;w!==null;w=w.parentNode){if(w===T)return null;if(w.nextSibling!==null)return w.nextSibling}return null}function o(w,T){var k;return k=w.firstChild,k!==null?k:w===T?null:(k=w.nextSibling,k!==null?k:n(w,T))}function r(w){for(;w.lastChild;)w=w.lastChild;return w}function g(w,T){var k;return k=w.previousSibling,k!==null?r(k):(k=w.parentNode,k===T?null:k)}}}),Que=Bn({"external/npm/node_modules/domino/lib/TreeWalker.js"(t,i){i.exports=N;var e=xl(),n=YT(),o=eq(),r=Ba(),g={first:"firstChild",last:"lastChild",next:"firstChild",previous:"lastChild"},w={first:"nextSibling",last:"previousSibling",next:"nextSibling",previous:"previousSibling"};function T(V,q){var Z,X,te,De,_e;for(X=V._currentNode[g[q]];X!==null;){if(De=V._internalFilter(X),De===n.FILTER_ACCEPT)return V._currentNode=X,X;if(De===n.FILTER_SKIP&&(Z=X[g[q]],Z!==null)){X=Z;continue}for(;X!==null;){if(_e=X[w[q]],_e!==null){X=_e;break}if(te=X.parentNode,te===null||te===V.root||te===V._currentNode)return null;X=te}}return null}function k(V,q){var Z,X,te;if(Z=V._currentNode,Z===V.root)return null;for(;;){for(te=Z[w[q]];te!==null;){if(Z=te,X=V._internalFilter(Z),X===n.FILTER_ACCEPT)return V._currentNode=Z,Z;te=Z[g[q]],(X===n.FILTER_REJECT||te===null)&&(te=Z[w[q]])}if(Z=Z.parentNode,Z===null||Z===V.root||V._internalFilter(Z)===n.FILTER_ACCEPT)return null}}function N(V,q,Z){(!V||!V.nodeType)&&r.NotSupportedError(),this._root=V,this._whatToShow=Number(q)||0,this._filter=Z||null,this._active=!1,this._currentNode=V}Object.defineProperties(N.prototype,{root:{get:function(){return this._root}},whatToShow:{get:function(){return this._whatToShow}},filter:{get:function(){return this._filter}},currentNode:{get:function(){return this._currentNode},set:function(q){if(!(q instanceof e))throw new TypeError("Not a Node");this._currentNode=q}},_internalFilter:{value:function(q){var Z,X;if(this._active&&r.InvalidStateError(),!(1<<q.nodeType-1&this._whatToShow))return n.FILTER_SKIP;if(X=this._filter,X===null)Z=n.FILTER_ACCEPT;else{this._active=!0;try{typeof X=="function"?Z=X(q):Z=X.acceptNode(q)}finally{this._active=!1}}return+Z}},parentNode:{value:function(){for(var q=this._currentNode;q!==this.root;){if(q=q.parentNode,q===null)return null;if(this._internalFilter(q)===n.FILTER_ACCEPT)return this._currentNode=q,q}return null}},firstChild:{value:function(){return T(this,"first")}},lastChild:{value:function(){return T(this,"last")}},previousSibling:{value:function(){return k(this,"previous")}},nextSibling:{value:function(){return k(this,"next")}},previousNode:{value:function(){var q,Z,X,te;for(q=this._currentNode;q!==this._root;){for(X=q.previousSibling;X;X=q.previousSibling)if(q=X,Z=this._internalFilter(q),Z!==n.FILTER_REJECT){for(te=q.lastChild;te&&(q=te,Z=this._internalFilter(q),Z!==n.FILTER_REJECT);te=q.lastChild);if(Z===n.FILTER_ACCEPT)return this._currentNode=q,q}if(q===this.root||q.parentNode===null)return null;if(q=q.parentNode,this._internalFilter(q)===n.FILTER_ACCEPT)return this._currentNode=q,q}return null}},nextNode:{value:function(){var q,Z,X,te;q=this._currentNode,Z=n.FILTER_ACCEPT;e:for(;;){for(X=q.firstChild;X;X=q.firstChild){if(q=X,Z=this._internalFilter(q),Z===n.FILTER_ACCEPT)return this._currentNode=q,q;if(Z===n.FILTER_REJECT)break}for(te=o.nextSkippingChildren(q,this.root);te;te=o.nextSkippingChildren(q,this.root)){if(q=te,Z=this._internalFilter(q),Z===n.FILTER_ACCEPT)return this._currentNode=q,q;if(Z===n.FILTER_SKIP)continue e}return null}}},toString:{value:function(){return"[object TreeWalker]"}}})}}),Jue=Bn({"external/npm/node_modules/domino/lib/NodeIterator.js"(t,i){i.exports=T;var e=YT(),n=eq(),o=Ba();function r(k,N,V){return V?n.next(k,N):k===N?null:n.previous(k,null)}function g(k,N){for(;N;N=N.parentNode)if(k===N)return!0;return!1}function w(k,N){var V,q;for(V=k._referenceNode,q=k._pointerBeforeReferenceNode;;){if(q===N)q=!q;else if(V=r(V,k._root,N),V===null)return null;var Z=k._internalFilter(V);if(Z===e.FILTER_ACCEPT)break}return k._referenceNode=V,k._pointerBeforeReferenceNode=q,V}function T(k,N,V){(!k||!k.nodeType)&&o.NotSupportedError(),this._root=k,this._referenceNode=k,this._pointerBeforeReferenceNode=!0,this._whatToShow=Number(N)||0,this._filter=V||null,this._active=!1,k.doc._attachNodeIterator(this)}Object.defineProperties(T.prototype,{root:{get:function(){return this._root}},referenceNode:{get:function(){return this._referenceNode}},pointerBeforeReferenceNode:{get:function(){return this._pointerBeforeReferenceNode}},whatToShow:{get:function(){return this._whatToShow}},filter:{get:function(){return this._filter}},_internalFilter:{value:function(N){var V,q;if(this._active&&o.InvalidStateError(),!(1<<N.nodeType-1&this._whatToShow))return e.FILTER_SKIP;if(q=this._filter,q===null)V=e.FILTER_ACCEPT;else{this._active=!0;try{typeof q=="function"?V=q(N):V=q.acceptNode(N)}finally{this._active=!1}}return+V}},_preremove:{value:function(N){if(!g(N,this._root)&&g(N,this._referenceNode)){if(this._pointerBeforeReferenceNode){for(var V=N;V.lastChild;)V=V.lastChild;if(V=n.next(V,this.root),V){this._referenceNode=V;return}this._pointerBeforeReferenceNode=!1}if(N.previousSibling===null)this._referenceNode=N.parentNode;else{this._referenceNode=N.previousSibling;var q;for(q=this._referenceNode.lastChild;q;q=this._referenceNode.lastChild)this._referenceNode=q}}}},nextNode:{value:function(){return w(this,!0)}},previousNode:{value:function(){return w(this,!1)}},detach:{value:function(){}},toString:{value:function(){return"[object NodeIterator]"}}})}}),PP=Bn({"external/npm/node_modules/domino/lib/URL.js"(t,i){i.exports=e;function e(n){if(!n)return Object.create(e.prototype);this.url=n.replace(/^[ \t\n\r\f]+|[ \t\n\r\f]+$/g,"");var o=e.pattern.exec(this.url);if(o){if(o[2]&&(this.scheme=o[2]),o[4]){var r=o[4].match(e.userinfoPattern);if(r&&(this.username=r[1],this.password=r[3],o[4]=o[4].substring(r[0].length)),o[4].match(e.portPattern)){var g=o[4].lastIndexOf(":");this.host=o[4].substring(0,g),this.port=o[4].substring(g+1)}else this.host=o[4]}o[5]&&(this.path=o[5]),o[6]&&(this.query=o[7]),o[8]&&(this.fragment=o[9])}}e.pattern=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/,e.userinfoPattern=/^([^@:]*)(:([^@]*))?@/,e.portPattern=/:\d+$/,e.authorityPattern=/^[^:\/?#]+:\/\//,e.hierarchyPattern=/^[^:\/?#]+:\//,e.percentEncode=function(o){var r=o.charCodeAt(0);if(r<256)return"%"+r.toString(16);throw Error("can't percent-encode codepoints > 255 yet")},e.prototype={constructor:e,isAbsolute:function(){return!!this.scheme},isAuthorityBased:function(){return e.authorityPattern.test(this.url)},isHierarchical:function(){return e.hierarchyPattern.test(this.url)},toString:function(){var n="";return this.scheme!==void 0&&(n+=this.scheme+":"),this.isAbsolute()&&(n+="//",(this.username||this.password)&&(n+=this.username||"",this.password&&(n+=":"+this.password),n+="@"),this.host&&(n+=this.host)),this.port!==void 0&&(n+=":"+this.port),this.path!==void 0&&(n+=this.path),this.query!==void 0&&(n+="?"+this.query),this.fragment!==void 0&&(n+="#"+this.fragment),n},resolve:function(n){var o=this,r=new e(n),g=new e;return r.scheme!==void 0?(g.scheme=r.scheme,g.username=r.username,g.password=r.password,g.host=r.host,g.port=r.port,g.path=T(r.path),g.query=r.query):(g.scheme=o.scheme,r.host!==void 0?(g.username=r.username,g.password=r.password,g.host=r.host,g.port=r.port,g.path=T(r.path),g.query=r.query):(g.username=o.username,g.password=o.password,g.host=o.host,g.port=o.port,r.path?(r.path.charAt(0)==="/"?g.path=T(r.path):(g.path=w(o.path,r.path),g.path=T(g.path)),g.query=r.query):(g.path=o.path,r.query!==void 0?g.query=r.query:g.query=o.query))),g.fragment=r.fragment,g.toString();function w(k,N){if(o.host!==void 0&&!o.path)return"/"+N;var V=k.lastIndexOf("/");return V===-1?N:k.substring(0,V+1)+N}function T(k){if(!k)return k;for(var N="";k.length>0;){if(k==="."||k===".."){k="";break}var V=k.substring(0,2),q=k.substring(0,3),Z=k.substring(0,4);if(q==="../")k=k.substring(3);else if(V==="./")k=k.substring(2);else if(q==="/./")k="/"+k.substring(3);else if(V==="/."&&k.length===2)k="/";else if(Z==="/../"||q==="/.."&&k.length===3)k="/"+k.substring(4),N=N.replace(/\/?[^\/]*$/,"");else{var X=k.match(/(\/?([^\/]*))/)[0];N+=X,k=k.substring(X.length)}}return N}}}}}),ede=Bn({"external/npm/node_modules/domino/lib/CustomEvent.js"(t,i){i.exports=n;var e=Jx();function n(o,r){e.call(this,o,r)}n.prototype=Object.create(e.prototype,{constructor:{value:n}})}}),tq=Bn({"external/npm/node_modules/domino/lib/events.js"(t,i){i.exports={Event:Jx(),UIEvent:VH(),MouseEvent:jH(),CustomEvent:ede()}}}),tde=Bn({"external/npm/node_modules/domino/lib/style_parser.js"(t){Object.defineProperty(t,"__esModule",{value:!0}),t.hyphenate=t.parse=void 0;function i(n){let o=[],r=0,g=0,w=0,T=0,k=0,N=null;for(;r<n.length;)switch(n.charCodeAt(r++)){case 40:g++;break;case 41:g--;break;case 39:w===0?w=39:w===39&&n.charCodeAt(r-1)!==92&&(w=0);break;case 34:w===0?w=34:w===34&&n.charCodeAt(r-1)!==92&&(w=0);break;case 58:!N&&g===0&&w===0&&(N=e(n.substring(k,r-1).trim()),T=r);break;case 59:if(N&&T>0&&g===0&&w===0){let q=n.substring(T,r-1).trim();o.push(N,q),k=r,T=0,N=null}break}if(N&&T){let V=n.slice(T).trim();o.push(N,V)}return o}t.parse=i;function e(n){return n.replace(/[a-z][A-Z]/g,o=>o.charAt(0)+"-"+o.charAt(1)).toLowerCase()}t.hyphenate=e}}),NP=Bn({"external/npm/node_modules/domino/lib/CSSStyleDeclaration.js"(t,i){var{parse:e}=tde();i.exports=function(T){let k=new o(T),N={get:function(V,q){return q in V?V[q]:V.getPropertyValue(n(q))},has:function(V,q){return!0},set:function(V,q,Z){return q in V?V[q]=Z:V.setProperty(n(q),Z??void 0),!0}};return new Proxy(k,N)};function n(T){return T.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function o(T){this._element=T}var r="!important";function g(T){let k={property:{},priority:{}};if(!T)return k;let N=e(T);if(N.length<2)return k;for(let V=0;V<N.length;V+=2){let q=N[V],Z=N[V+1];Z.endsWith(r)&&(k.priority[q]="important",Z=Z.slice(0,-r.length).trim()),k.property[q]=Z}return k}var w={};o.prototype=Object.create(Object.prototype,{_parsed:{get:function(){if(!this._parsedStyles||this.cssText!==this._lastParsedText){var T=this.cssText;this._parsedStyles=g(T),this._lastParsedText=T,delete this._names}return this._parsedStyles}},_serialize:{value:function(){var T=this._parsed,k="";for(var N in T.property)k&&(k+=" "),k+=N+": "+T.property[N],T.priority[N]&&(k+=" !"+T.priority[N]),k+=";";this.cssText=k,this._lastParsedText=k,delete this._names}},cssText:{get:function(){return this._element.getAttribute("style")},set:function(T){this._element.setAttribute("style",T)}},length:{get:function(){return this._names||(this._names=Object.getOwnPropertyNames(this._parsed.property)),this._names.length}},item:{value:function(T){return this._names||(this._names=Object.getOwnPropertyNames(this._parsed.property)),this._names[T]}},getPropertyValue:{value:function(T){return T=T.toLowerCase(),this._parsed.property[T]||""}},getPropertyPriority:{value:function(T){return T=T.toLowerCase(),this._parsed.priority[T]||""}},setProperty:{value:function(T,k,N){if(T=T.toLowerCase(),k==null&&(k=""),N==null&&(N=""),k!==w&&(k=""+k),k=k.trim(),k===""){this.removeProperty(T);return}if(!(N!==""&&N!==w&&!/^important$/i.test(N))){var V=this._parsed;if(k===w){if(!V.property[T])return;N!==""?V.priority[T]="important":delete V.priority[T]}else{if(k.includes(";")&&!k.includes("data:"))return;var q=g(T+":"+k);if(Object.getOwnPropertyNames(q.property).length===0||Object.getOwnPropertyNames(q.priority).length!==0)return;for(var Z in q.property)V.property[Z]=q.property[Z],N!==w&&(N!==""?V.priority[Z]="important":V.priority[Z]&&delete V.priority[Z])}this._serialize()}}},setPropertyValue:{value:function(T,k){return this.setProperty(T,k,w)}},setPropertyPriority:{value:function(T,k){return this.setProperty(T,w,k)}},removeProperty:{value:function(T){T=T.toLowerCase();var k=this._parsed;T in k.property&&(delete k.property[T],delete k.priority[T],this._serialize())}}})}}),iq=Bn({"external/npm/node_modules/domino/lib/URLUtils.js"(t,i){var e=PP();i.exports=n;function n(){}n.prototype=Object.create(Object.prototype,{_url:{get:function(){return new e(this.href)}},protocol:{get:function(){var o=this._url;return o&&o.scheme?o.scheme+":":":"},set:function(o){var r=this.href,g=new e(r);g.isAbsolute()&&(o=o.replace(/:+$/,""),o=o.replace(/[^-+\.a-zA-Z0-9]/g,e.percentEncode),o.length>0&&(g.scheme=o,r=g.toString())),this.href=r}},host:{get:function(){var o=this._url;return o.isAbsolute()&&o.isAuthorityBased()?o.host+(o.port?":"+o.port:""):""},set:function(o){var r=this.href,g=new e(r);g.isAbsolute()&&g.isAuthorityBased()&&(o=o.replace(/[^-+\._~!$&'()*,;:=a-zA-Z0-9]/g,e.percentEncode),o.length>0&&(g.host=o,delete g.port,r=g.toString())),this.href=r}},hostname:{get:function(){var o=this._url;return o.isAbsolute()&&o.isAuthorityBased()?o.host:""},set:function(o){var r=this.href,g=new e(r);g.isAbsolute()&&g.isAuthorityBased()&&(o=o.replace(/^\/+/,""),o=o.replace(/[^-+\._~!$&'()*,;:=a-zA-Z0-9]/g,e.percentEncode),o.length>0&&(g.host=o,r=g.toString())),this.href=r}},port:{get:function(){var o=this._url;return o.isAbsolute()&&o.isAuthorityBased()&&o.port!==void 0?o.port:""},set:function(o){var r=this.href,g=new e(r);g.isAbsolute()&&g.isAuthorityBased()&&(o=""+o,o=o.replace(/[^0-9].*$/,""),o=o.replace(/^0+/,""),o.length===0&&(o="0"),parseInt(o,10)<=65535&&(g.port=o,r=g.toString())),this.href=r}},pathname:{get:function(){var o=this._url;return o.isAbsolute()&&o.isHierarchical()?o.path:""},set:function(o){var r=this.href,g=new e(r);g.isAbsolute()&&g.isHierarchical()&&(o.charAt(0)!=="/"&&(o="/"+o),o=o.replace(/[^-+\._~!$&'()*,;:=@\/a-zA-Z0-9]/g,e.percentEncode),g.path=o,r=g.toString()),this.href=r}},search:{get:function(){var o=this._url;return o.isAbsolute()&&o.isHierarchical()&&o.query!==void 0?"?"+o.query:""},set:function(o){var r=this.href,g=new e(r);g.isAbsolute()&&g.isHierarchical()&&(o.charAt(0)==="?"&&(o=o.substring(1)),o=o.replace(/[^-+\._~!$&'()*,;:=@\/?a-zA-Z0-9]/g,e.percentEncode),g.query=o,r=g.toString()),this.href=r}},hash:{get:function(){var o=this._url;return o==null||o.fragment==null||o.fragment===""?"":"#"+o.fragment},set:function(o){var r=this.href,g=new e(r);o.charAt(0)==="#"&&(o=o.substring(1)),o=o.replace(/[^-+\._~!$&'()*,;:=@\/?a-zA-Z0-9]/g,e.percentEncode),g.fragment=o,r=g.toString(),this.href=r}},username:{get:function(){var o=this._url;return o.username||""},set:function(o){var r=this.href,g=new e(r);g.isAbsolute()&&(o=o.replace(/[\x00-\x1F\x7F-\uFFFF "#<>?`\/@\\:]/g,e.percentEncode),g.username=o,r=g.toString()),this.href=r}},password:{get:function(){var o=this._url;return o.password||""},set:function(o){var r=this.href,g=new e(r);g.isAbsolute()&&(o===""?g.password=null:(o=o.replace(/[\x00-\x1F\x7F-\uFFFF "#<>?`\/@\\]/g,e.percentEncode),g.password=o),r=g.toString()),this.href=r}},origin:{get:function(){var o=this._url;if(o==null)return"";var r=function(g){var w=[o.scheme,o.host,+o.port||g];return w[0]+"://"+w[1]+(w[2]===g?"":":"+w[2])};switch(o.scheme){case"ftp":return r(21);case"gopher":return r(70);case"http":case"ws":return r(80);case"https":case"wss":return r(443);default:return o.scheme+"://"}}}}),n._inherit=function(o){Object.getOwnPropertyNames(n.prototype).forEach(function(r){if(!(r==="constructor"||r==="href")){var g=Object.getOwnPropertyDescriptor(n.prototype,r);Object.defineProperty(o,r,g)}})}}}),nq=Bn({"external/npm/node_modules/domino/lib/defineElement.js"(t,i){var e=$H(),n=IP().isApiWritable;i.exports=function(w,T,k,N){var V=w.ctor;if(V){var q=w.props||{};if(w.attributes)for(var Z in w.attributes){var X=w.attributes[Z];(typeof X!="object"||Array.isArray(X))&&(X={type:X}),X.name||(X.name=Z.toLowerCase()),q[Z]=e.property(X)}q.constructor={value:V,writable:n},V.prototype=Object.create((w.superclass||T).prototype,q),w.events&&g(V,w.events),k[w.name]=V}else V=T;return(w.tags||w.tag&&[w.tag]||[]).forEach(function(te){N[te]=V}),V};function o(w,T,k,N){this.body=w,this.document=T,this.form=k,this.element=N}o.prototype.build=function(){return()=>{}};function r(w,T,k,N){var V=w.ownerDocument||Object.create(null),q=w.form||Object.create(null);w[T]=new o(N,V,q,w).build()}function g(w,T){var k=w.prototype;T.forEach(function(N){Object.defineProperty(k,"on"+N,{get:function(){return this._getEventHandler(N)},set:function(V){this._setEventHandler(N,V)}}),e.registerChangeHandler(w,"on"+N,r)})}}}),LP=Bn({"external/npm/node_modules/domino/lib/htmlelts.js"(t){var i=xl(),e=ew(),n=NP(),o=Ba(),r=iq(),g=nq(),w=t.elements={},T=Object.create(null);t.createElement=function(he,Ce,Pe){var ye=T[Ce]||De;return new ye(he,Ce,Pe)};function k(he){return g(he,te,w,T)}function N(he){return{get:function(){var Ce=this._getattr(he);if(Ce===null)return"";var Pe=this.doc._resolve(Ce);return Pe===null?Ce:Pe},set:function(Ce){this._setattr(he,Ce)}}}function V(he){return{get:function(){var Ce=this._getattr(he);return Ce===null?null:Ce.toLowerCase()==="use-credentials"?"use-credentials":"anonymous"},set:function(Ce){Ce==null?this.removeAttribute(he):this._setattr(he,Ce)}}}var q={type:["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"],missing:""},Z={A:!0,LINK:!0,BUTTON:!0,INPUT:!0,SELECT:!0,TEXTAREA:!0,COMMAND:!0},X=function(he,Ce,Pe){te.call(this,he,Ce,Pe),this._form=null},te=t.HTMLElement=k({superclass:e,name:"HTMLElement",ctor:function(Ce,Pe,ye){e.call(this,Ce,Pe,o.NAMESPACE.HTML,ye)},props:{dangerouslySetInnerHTML:{set:function(he){this._innerHTML=he}},innerHTML:{get:function(){return this.serialize()},set:function(he){var Ce=this.ownerDocument.implementation.mozHTMLParser(this.ownerDocument._address,this);Ce.parse(he===null?"":String(he),!0);for(var Pe=this instanceof T.template?this.content:this;Pe.hasChildNodes();)Pe.removeChild(Pe.firstChild);Pe.appendChild(Ce._asDocumentFragment())}},style:{get:function(){return this._style||(this._style=new n(this)),this._style},set:function(he){he==null&&(he=""),this._setattr("style",String(he))}},blur:{value:function(){}},focus:{value:function(){}},forceSpellCheck:{value:function(){}},click:{value:function(){if(!this._click_in_progress){this._click_in_progress=!0;try{this._pre_click_activation_steps&&this._pre_click_activation_steps();var he=this.ownerDocument.createEvent("MouseEvent");he.initMouseEvent("click",!0,!0,this.ownerDocument.defaultView,1,0,0,0,0,!1,!1,!1,!1,0,null);var Ce=this.dispatchEvent(he);Ce?this._post_click_activation_steps&&this._post_click_activation_steps(he):this._cancelled_activation_steps&&this._cancelled_activation_steps()}finally{this._click_in_progress=!1}}}},submit:{value:o.nyi}},attributes:{title:String,lang:String,dir:{type:["ltr","rtl","auto"],missing:""},draggable:{type:["true","false"],treatNullAsEmptyString:!0},spellcheck:{type:["true","false"],missing:""},enterKeyHint:{type:["enter","done","go","next","previous","search","send"],missing:""},autoCapitalize:{type:["off","on","none","sentences","words","characters"],missing:""},autoFocus:Boolean,accessKey:String,nonce:String,hidden:Boolean,translate:{type:["no","yes"],missing:""},tabIndex:{type:"long",default:function(){return this.tagName in Z||this.contentEditable?0:-1}}},events:["abort","canplay","canplaythrough","change","click","contextmenu","cuechange","dblclick","drag","dragend","dragenter","dragleave","dragover","dragstart","drop","durationchange","emptied","ended","input","invalid","keydown","keypress","keyup","loadeddata","loadedmetadata","loadstart","mousedown","mousemove","mouseout","mouseover","mouseup","mousewheel","pause","play","playing","progress","ratechange","readystatechange","reset","seeked","seeking","select","show","stalled","submit","suspend","timeupdate","volumechange","waiting","blur","error","focus","load","scroll"]}),De=k({name:"HTMLUnknownElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)}}),_e={form:{get:function(){return this._form}}};k({tag:"a",name:"HTMLAnchorElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},props:{_post_click_activation_steps:{value:function(he){this.href&&(this.ownerDocument.defaultView.location=this.href)}}},attributes:{href:N,ping:String,download:String,target:String,rel:String,media:String,hreflang:String,type:String,referrerPolicy:q,coords:String,charset:String,name:String,rev:String,shape:String}}),r._inherit(T.a.prototype),k({tag:"area",name:"HTMLAreaElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{alt:String,target:String,download:String,rel:String,media:String,href:N,hreflang:String,type:String,shape:String,coords:String,ping:String,referrerPolicy:q,noHref:Boolean}}),r._inherit(T.area.prototype),k({tag:"br",name:"HTMLBRElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{clear:String}}),k({tag:"base",name:"HTMLBaseElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{target:String}}),k({tag:"body",name:"HTMLBodyElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},events:["afterprint","beforeprint","beforeunload","blur","error","focus","hashchange","load","message","offline","online","pagehide","pageshow","popstate","resize","scroll","storage","unload"],attributes:{text:{type:String,treatNullAsEmptyString:!0},link:{type:String,treatNullAsEmptyString:!0},vLink:{type:String,treatNullAsEmptyString:!0},aLink:{type:String,treatNullAsEmptyString:!0},bgColor:{type:String,treatNullAsEmptyString:!0},background:String}}),k({tag:"button",name:"HTMLButtonElement",ctor:function(Ce,Pe,ye){X.call(this,Ce,Pe,ye)},props:_e,attributes:{name:String,value:String,disabled:Boolean,autofocus:Boolean,type:{type:["submit","reset","button","menu"],missing:"submit"},formTarget:String,formAction:N,formNoValidate:Boolean,formMethod:{type:["get","post","dialog"],invalid:"get",missing:""},formEnctype:{type:["application/x-www-form-urlencoded","multipart/form-data","text/plain"],invalid:"application/x-www-form-urlencoded",missing:""}}}),k({tag:"dl",name:"HTMLDListElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{compact:Boolean}}),k({tag:"data",name:"HTMLDataElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{value:String}}),k({tag:"datalist",name:"HTMLDataListElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)}}),k({tag:"details",name:"HTMLDetailsElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{open:Boolean}}),k({tag:"div",name:"HTMLDivElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{align:String}}),k({tag:"embed",name:"HTMLEmbedElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{src:N,type:String,width:String,height:String,align:String,name:String}}),k({tag:"fieldset",name:"HTMLFieldSetElement",ctor:function(Ce,Pe,ye){X.call(this,Ce,Pe,ye)},props:_e,attributes:{disabled:Boolean,name:String}}),k({tag:"form",name:"HTMLFormElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{action:String,autocomplete:{type:["on","off"],missing:"on"},name:String,acceptCharset:{name:"accept-charset"},target:String,noValidate:Boolean,method:{type:["get","post","dialog"],invalid:"get",missing:"get"},enctype:{type:["application/x-www-form-urlencoded","multipart/form-data","text/plain"],invalid:"application/x-www-form-urlencoded",missing:"application/x-www-form-urlencoded"},encoding:{name:"enctype",type:["application/x-www-form-urlencoded","multipart/form-data","text/plain"],invalid:"application/x-www-form-urlencoded",missing:"application/x-www-form-urlencoded"}}}),k({tag:"hr",name:"HTMLHRElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{align:String,color:String,noShade:Boolean,size:String,width:String}}),k({tag:"head",name:"HTMLHeadElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)}}),k({tags:["h1","h2","h3","h4","h5","h6"],name:"HTMLHeadingElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{align:String}}),k({tag:"html",name:"HTMLHtmlElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{xmlns:N,version:String}}),k({tag:"iframe",name:"HTMLIFrameElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{src:N,srcdoc:String,name:String,width:String,height:String,seamless:Boolean,allow:Boolean,allowFullscreen:Boolean,allowUserMedia:Boolean,allowPaymentRequest:Boolean,referrerPolicy:q,loading:{type:["eager","lazy"],treatNullAsEmptyString:!0},align:String,scrolling:String,frameBorder:String,longDesc:N,marginHeight:{type:String,treatNullAsEmptyString:!0},marginWidth:{type:String,treatNullAsEmptyString:!0}}}),k({tag:"img",name:"HTMLImageElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{alt:String,src:N,srcset:String,crossOrigin:V,useMap:String,isMap:Boolean,sizes:String,height:{type:"unsigned long",default:0},width:{type:"unsigned long",default:0},referrerPolicy:q,loading:{type:["eager","lazy"],missing:""},name:String,lowsrc:N,align:String,hspace:{type:"unsigned long",default:0},vspace:{type:"unsigned long",default:0},longDesc:N,border:{type:String,treatNullAsEmptyString:!0}}}),k({tag:"input",name:"HTMLInputElement",ctor:function(Ce,Pe,ye){X.call(this,Ce,Pe,ye)},props:{form:_e.form,_post_click_activation_steps:{value:function(he){if(this.type==="checkbox")this.checked=!this.checked;else if(this.type==="radio")for(var Ce=this.form.getElementsByName(this.name),Pe=Ce.length-1;Pe>=0;Pe--){var ye=Ce[Pe];ye.checked=ye===this}}}},attributes:{name:String,disabled:Boolean,autofocus:Boolean,accept:String,alt:String,max:String,min:String,pattern:String,placeholder:String,step:String,dirName:String,defaultValue:{name:"value"},multiple:Boolean,required:Boolean,readOnly:Boolean,checked:Boolean,value:String,src:N,defaultChecked:{name:"checked",type:Boolean},size:{type:"unsigned long",default:20,min:1,setmin:1},width:{type:"unsigned long",min:0,setmin:0,default:0},height:{type:"unsigned long",min:0,setmin:0,default:0},minLength:{type:"unsigned long",min:0,setmin:0,default:-1},maxLength:{type:"unsigned long",min:0,setmin:0,default:-1},autocomplete:String,type:{type:["text","hidden","search","tel","url","email","password","datetime","date","month","week","time","datetime-local","number","range","color","checkbox","radio","file","submit","image","reset","button"],missing:"text"},formTarget:String,formNoValidate:Boolean,formMethod:{type:["get","post"],invalid:"get",missing:""},formEnctype:{type:["application/x-www-form-urlencoded","multipart/form-data","text/plain"],invalid:"application/x-www-form-urlencoded",missing:""},inputMode:{type:["verbatim","latin","latin-name","latin-prose","full-width-latin","kana","kana-name","katakana","numeric","tel","email","url"],missing:""},align:String,useMap:String}}),k({tag:"keygen",name:"HTMLKeygenElement",ctor:function(Ce,Pe,ye){X.call(this,Ce,Pe,ye)},props:_e,attributes:{name:String,disabled:Boolean,autofocus:Boolean,challenge:String,keytype:{type:["rsa"],missing:""}}}),k({tag:"li",name:"HTMLLIElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{value:{type:"long",default:0},type:String}}),k({tag:"label",name:"HTMLLabelElement",ctor:function(Ce,Pe,ye){X.call(this,Ce,Pe,ye)},props:_e,attributes:{htmlFor:{name:"for",type:String}}}),k({tag:"legend",name:"HTMLLegendElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{align:String}}),k({tag:"link",name:"HTMLLinkElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{href:N,rel:String,media:String,hreflang:String,type:String,crossOrigin:V,nonce:String,integrity:String,referrerPolicy:q,imageSizes:String,imageSrcset:String,charset:String,rev:String,target:String}}),k({tag:"map",name:"HTMLMapElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{name:String}}),k({tag:"menu",name:"HTMLMenuElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{type:{type:["context","popup","toolbar"],missing:"toolbar"},label:String,compact:Boolean}}),k({tag:"meta",name:"HTMLMetaElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{name:String,content:String,httpEquiv:{name:"http-equiv",type:String},scheme:String}}),k({tag:"meter",name:"HTMLMeterElement",ctor:function(Ce,Pe,ye){X.call(this,Ce,Pe,ye)},props:_e}),k({tags:["ins","del"],name:"HTMLModElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{cite:N,dateTime:String}}),k({tag:"ol",name:"HTMLOListElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},props:{_numitems:{get:function(){var he=0;return this.childNodes.forEach(function(Ce){Ce.nodeType===i.ELEMENT_NODE&&Ce.tagName==="LI"&&he++}),he}}},attributes:{type:String,reversed:Boolean,start:{type:"long",default:function(){return this.reversed?this._numitems:1}},compact:Boolean}}),k({tag:"object",name:"HTMLObjectElement",ctor:function(Ce,Pe,ye){X.call(this,Ce,Pe,ye)},props:_e,attributes:{data:N,type:String,name:String,useMap:String,typeMustMatch:Boolean,width:String,height:String,align:String,archive:String,code:String,declare:Boolean,hspace:{type:"unsigned long",default:0},standby:String,vspace:{type:"unsigned long",default:0},codeBase:N,codeType:String,border:{type:String,treatNullAsEmptyString:!0}}}),k({tag:"optgroup",name:"HTMLOptGroupElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{disabled:Boolean,label:String}}),k({tag:"option",name:"HTMLOptionElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},props:{form:{get:function(){for(var he=this.parentNode;he&&he.nodeType===i.ELEMENT_NODE;){if(he.localName==="select")return he.form;he=he.parentNode}}},value:{get:function(){return this._getattr("value")||this.text},set:function(he){this._setattr("value",he)}},text:{get:function(){return this.textContent.replace(/[ \t\n\f\r]+/g," ").trim()},set:function(he){this.textContent=he}}},attributes:{disabled:Boolean,defaultSelected:{name:"selected",type:Boolean},label:String}}),k({tag:"output",name:"HTMLOutputElement",ctor:function(Ce,Pe,ye){X.call(this,Ce,Pe,ye)},props:_e,attributes:{name:String}}),k({tag:"p",name:"HTMLParagraphElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{align:String}}),k({tag:"param",name:"HTMLParamElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{name:String,value:String,type:String,valueType:String}}),k({tags:["pre","listing","xmp"],name:"HTMLPreElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{width:{type:"long",default:0}}}),k({tag:"progress",name:"HTMLProgressElement",ctor:function(Ce,Pe,ye){X.call(this,Ce,Pe,ye)},props:_e,attributes:{max:{type:Number,float:!0,default:1,min:0}}}),k({tags:["q","blockquote"],name:"HTMLQuoteElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{cite:N}}),k({tag:"script",name:"HTMLScriptElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},props:{text:{get:function(){for(var he="",Ce=0,Pe=this.childNodes.length;Ce<Pe;Ce++){var ye=this.childNodes[Ce];ye.nodeType===i.TEXT_NODE&&(he+=ye._data)}return he},set:function(he){this.removeChildren(),he!==null&&he!==""&&this.appendChild(this.ownerDocument.createTextNode(he))}}},attributes:{src:N,type:String,charset:String,referrerPolicy:q,defer:Boolean,async:Boolean,nomodule:Boolean,crossOrigin:V,nonce:String,integrity:String}}),k({tag:"select",name:"HTMLSelectElement",ctor:function(Ce,Pe,ye){X.call(this,Ce,Pe,ye)},props:{form:_e.form,options:{get:function(){return this.getElementsByTagName("option")}}},attributes:{autocomplete:String,name:String,disabled:Boolean,autofocus:Boolean,multiple:Boolean,required:Boolean,size:{type:"unsigned long",default:0}}}),k({tag:"span",name:"HTMLSpanElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)}}),k({tag:"style",name:"HTMLStyleElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{media:String,type:String,scoped:Boolean}}),k({tag:"caption",name:"HTMLTableCaptionElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{align:String}}),k({name:"HTMLTableCellElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{colSpan:{type:"unsigned long",default:1},rowSpan:{type:"unsigned long",default:1},scope:{type:["row","col","rowgroup","colgroup"],missing:""},abbr:String,align:String,axis:String,height:String,width:String,ch:{name:"char",type:String},chOff:{name:"charoff",type:String},noWrap:Boolean,vAlign:String,bgColor:{type:String,treatNullAsEmptyString:!0}}}),k({tags:["col","colgroup"],name:"HTMLTableColElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{span:{type:"limited unsigned long with fallback",default:1,min:1},align:String,ch:{name:"char",type:String},chOff:{name:"charoff",type:String},vAlign:String,width:String}}),k({tag:"table",name:"HTMLTableElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},props:{rows:{get:function(){return this.getElementsByTagName("tr")}}},attributes:{align:String,border:String,frame:String,rules:String,summary:String,width:String,bgColor:{type:String,treatNullAsEmptyString:!0},cellPadding:{type:String,treatNullAsEmptyString:!0},cellSpacing:{type:String,treatNullAsEmptyString:!0}}}),k({tag:"template",name:"HTMLTemplateElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye),this._contentFragment=Ce._templateDoc.createDocumentFragment()},props:{content:{get:function(){return this._contentFragment}},serialize:{value:function(){return this.content.serialize()}}}}),k({tag:"tr",name:"HTMLTableRowElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},props:{cells:{get:function(){return this.querySelectorAll("td,th")}}},attributes:{align:String,ch:{name:"char",type:String},chOff:{name:"charoff",type:String},vAlign:String,bgColor:{type:String,treatNullAsEmptyString:!0}}}),k({tags:["thead","tfoot","tbody"],name:"HTMLTableSectionElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},props:{rows:{get:function(){return this.getElementsByTagName("tr")}}},attributes:{align:String,ch:{name:"char",type:String},chOff:{name:"charoff",type:String},vAlign:String}}),k({tag:"textarea",name:"HTMLTextAreaElement",ctor:function(Ce,Pe,ye){X.call(this,Ce,Pe,ye)},props:{form:_e.form,type:{get:function(){return"textarea"}},defaultValue:{get:function(){return this.textContent},set:function(he){this.textContent=he}},value:{get:function(){return this.defaultValue},set:function(he){this.defaultValue=he}},textLength:{get:function(){return this.value.length}}},attributes:{autocomplete:String,name:String,disabled:Boolean,autofocus:Boolean,placeholder:String,wrap:String,dirName:String,required:Boolean,readOnly:Boolean,rows:{type:"limited unsigned long with fallback",default:2},cols:{type:"limited unsigned long with fallback",default:20},maxLength:{type:"unsigned long",min:0,setmin:0,default:-1},minLength:{type:"unsigned long",min:0,setmin:0,default:-1},inputMode:{type:["verbatim","latin","latin-name","latin-prose","full-width-latin","kana","kana-name","katakana","numeric","tel","email","url"],missing:""}}}),k({tag:"time",name:"HTMLTimeElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{dateTime:String,pubDate:Boolean}}),k({tag:"title",name:"HTMLTitleElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},props:{text:{get:function(){return this.textContent}}}}),k({tag:"ul",name:"HTMLUListElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{type:String,compact:Boolean}}),k({name:"HTMLMediaElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{src:N,crossOrigin:V,preload:{type:["metadata","none","auto",{value:"",alias:"auto"}],missing:"auto"},loop:Boolean,autoplay:Boolean,mediaGroup:String,controls:Boolean,defaultMuted:{name:"muted",type:Boolean}}}),k({name:"HTMLAudioElement",tag:"audio",superclass:w.HTMLMediaElement,ctor:function(Ce,Pe,ye){w.HTMLMediaElement.call(this,Ce,Pe,ye)}}),k({name:"HTMLVideoElement",tag:"video",superclass:w.HTMLMediaElement,ctor:function(Ce,Pe,ye){w.HTMLMediaElement.call(this,Ce,Pe,ye)},attributes:{poster:N,width:{type:"unsigned long",min:0,default:0},height:{type:"unsigned long",min:0,default:0}}}),k({tag:"td",name:"HTMLTableDataCellElement",superclass:w.HTMLTableCellElement,ctor:function(Ce,Pe,ye){w.HTMLTableCellElement.call(this,Ce,Pe,ye)}}),k({tag:"th",name:"HTMLTableHeaderCellElement",superclass:w.HTMLTableCellElement,ctor:function(Ce,Pe,ye){w.HTMLTableCellElement.call(this,Ce,Pe,ye)}}),k({tag:"frameset",name:"HTMLFrameSetElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)}}),k({tag:"frame",name:"HTMLFrameElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)}}),k({tag:"canvas",name:"HTMLCanvasElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},props:{getContext:{value:o.nyi},probablySupportsContext:{value:o.nyi},setContext:{value:o.nyi},transferControlToProxy:{value:o.nyi},toDataURL:{value:o.nyi},toBlob:{value:o.nyi}},attributes:{width:{type:"unsigned long",default:300},height:{type:"unsigned long",default:150}}}),k({tag:"dialog",name:"HTMLDialogElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},props:{show:{value:o.nyi},showModal:{value:o.nyi},close:{value:o.nyi}},attributes:{open:Boolean,returnValue:String}}),k({tag:"menuitem",name:"HTMLMenuItemElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},props:{_label:{get:function(){var he=this._getattr("label");return he!==null&&he!==""?he:(he=this.textContent,he.replace(/[ \t\n\f\r]+/g," ").trim())}},label:{get:function(){var he=this._getattr("label");return he!==null?he:this._label},set:function(he){this._setattr("label",he)}}},attributes:{type:{type:["command","checkbox","radio"],missing:"command"},icon:N,disabled:Boolean,checked:Boolean,radiogroup:String,default:Boolean}}),k({tag:"source",name:"HTMLSourceElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{srcset:String,sizes:String,media:String,src:N,type:String,width:String,height:String}}),k({tag:"track",name:"HTMLTrackElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{src:N,srclang:String,label:String,default:Boolean,kind:{type:["subtitles","captions","descriptions","chapters","metadata"],missing:"subtitles",invalid:"metadata"}},props:{NONE:{get:function(){return 0}},LOADING:{get:function(){return 1}},LOADED:{get:function(){return 2}},ERROR:{get:function(){return 3}},readyState:{get:o.nyi},track:{get:o.nyi}}}),k({tag:"font",name:"HTMLFontElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{color:{type:String,treatNullAsEmptyString:!0},face:{type:String},size:{type:String}}}),k({tag:"dir",name:"HTMLDirectoryElement",ctor:function(Ce,Pe,ye){te.call(this,Ce,Pe,ye)},attributes:{compact:Boolean}}),k({tags:["abbr","address","article","aside","b","bdi","bdo","cite","content","code","dd","dfn","dt","em","figcaption","figure","footer","header","hgroup","i","kbd","main","mark","nav","noscript","rb","rp","rt","rtc","ruby","s","samp","section","small","strong","sub","summary","sup","u","var","wbr","acronym","basefont","big","center","nobr","noembed","noframes","plaintext","strike","tt"]})}}),rq=Bn({"external/npm/node_modules/domino/lib/svg.js"(t){var i=ew(),e=nq(),n=Ba(),o=NP(),r=t.elements={},g=Object.create(null);t.createElement=function(k,N,V){var q=g[N]||T;return new q(k,N,V)};function w(k){return e(k,T,r,g)}var T=w({superclass:i,name:"SVGElement",ctor:function(N,V,q){i.call(this,N,V,n.NAMESPACE.SVG,q)},props:{style:{get:function(){return this._style||(this._style=new o(this)),this._style}}}});w({name:"SVGSVGElement",ctor:function(N,V,q){T.call(this,N,V,q)},tag:"svg",props:{createSVGRect:{value:function(){return t.createElement(this.ownerDocument,"rect",null)}}}}),w({tags:["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"]})}}),ide=Bn({"external/npm/node_modules/domino/lib/MutationConstants.js"(t,i){i.exports={VALUE:1,ATTR:2,REMOVE_ATTR:3,REMOVE:4,MOVE:5,INSERT:6}}}),FP=Bn({"external/npm/node_modules/domino/lib/Document.js"(t,i){i.exports=ct;var e=xl(),n=Xy(),o=AP(),r=ew(),g=KH(),w=XH(),T=Jx(),k=QH(),N=JH(),V=KT(),q=Que(),Z=Jue(),X=YT(),te=PP(),De=kP(),_e=tq(),he=RP(),Ce=LP(),Pe=rq(),ye=Ba(),vt=ide(),Rt=ye.NAMESPACE,ut=IP().isApiWritable;function ct(it,pt){o.call(this),this.nodeType=e.DOCUMENT_NODE,this.isHTML=it,this._address=pt||"about:blank",this.readyState="loading",this.implementation=new V(this),this.ownerDocument=null,this._contentType=it?"text/html":"application/xml",this.doctype=null,this.documentElement=null,this._templateDocCache=null,this._nodeIterators=null,this._nid=1,this._nextnid=2,this._nodes=[null,this],this.byId=Object.create(null),this.modclock=0}var We={event:"Event",customevent:"CustomEvent",uievent:"UIEvent",mouseevent:"MouseEvent"},Pt={events:"event",htmlevents:"event",mouseevents:"mouseevent",mutationevents:"mutationevent",uievents:"uievent"},ui=function(it,pt,di){return{get:function(){var Cn=it.call(this);return Cn?Cn[pt]:di},set:function(Cn){var Oo=it.call(this);Oo&&(Oo[pt]=Cn)}}};function we(it,pt){var di,Cn,Oo;return it===""&&(it=null),he.isValidQName(pt)||ye.InvalidCharacterError(),di=null,Cn=pt,Oo=pt.indexOf(":"),Oo>=0&&(di=pt.substring(0,Oo),Cn=pt.substring(Oo+1)),di!==null&&it===null&&ye.NamespaceError(),di==="xml"&&it!==Rt.XML&&ye.NamespaceError(),(di==="xmlns"||pt==="xmlns")&&it!==Rt.XMLNS&&ye.NamespaceError(),it===Rt.XMLNS&&!(di==="xmlns"||pt==="xmlns")&&ye.NamespaceError(),{namespace:it,prefix:di,localName:Cn}}ct.prototype=Object.create(o.prototype,{_setMutationHandler:{value:function(it){this.mutationHandler=it}},_dispatchRendererEvent:{value:function(it,pt,di){var Cn=this._nodes[it];Cn&&Cn._dispatchEvent(new T(pt,di),!0)}},nodeName:{value:"#document"},nodeValue:{get:function(){return null},set:function(){}},documentURI:{get:function(){return this._address},set:ye.nyi},compatMode:{get:function(){return this._quirks?"BackCompat":"CSS1Compat"}},createTextNode:{value:function(it){return new g(this,String(it))}},createComment:{value:function(it){return new w(this,it)}},createDocumentFragment:{value:function(){return new k(this)}},createProcessingInstruction:{value:function(it,pt){return(!he.isValidName(it)||pt.indexOf("?>")!==-1)&&ye.InvalidCharacterError(),new N(this,it,pt)}},createAttribute:{value:function(it){return it=String(it),he.isValidName(it)||ye.InvalidCharacterError(),this.isHTML&&(it=ye.toASCIILowerCase(it)),new r._Attr(null,it,null,null,"")}},createAttributeNS:{value:function(it,pt){it=it==null||it===""?null:String(it),pt=String(pt);var di=we(it,pt);return new r._Attr(null,di.localName,di.prefix,di.namespace,"")}},createElement:{value:function(it){return it=String(it),he.isValidName(it)||ye.InvalidCharacterError(),this.isHTML?(/[A-Z]/.test(it)&&(it=ye.toASCIILowerCase(it)),Ce.createElement(this,it,null)):this.contentType==="application/xhtml+xml"?Ce.createElement(this,it,null):new r(this,it,null,null)},writable:ut},createElementNS:{value:function(it,pt){it=it==null||it===""?null:String(it),pt=String(pt);var di=we(it,pt);return this._createElementNS(di.localName,di.namespace,di.prefix)},writable:ut},_createElementNS:{value:function(it,pt,di){return pt===Rt.HTML?Ce.createElement(this,it,di):pt===Rt.SVG?Pe.createElement(this,it,di):new r(this,it,pt,di)}},createEvent:{value:function(pt){pt=pt.toLowerCase();var di=Pt[pt]||pt,Cn=_e[We[di]];if(Cn){var Oo=new Cn;return Oo._initialized=!1,Oo}else ye.NotSupportedError()}},createTreeWalker:{value:function(it,pt,di){if(!it)throw new TypeError("root argument is required");if(!(it instanceof e))throw new TypeError("root not a node");return pt=pt===void 0?X.SHOW_ALL:+pt,di=di===void 0?null:di,new q(it,pt,di)}},createNodeIterator:{value:function(it,pt,di){if(!it)throw new TypeError("root argument is required");if(!(it instanceof e))throw new TypeError("root not a node");return pt=pt===void 0?X.SHOW_ALL:+pt,di=di===void 0?null:di,new Z(it,pt,di)}},_attachNodeIterator:{value:function(it){this._nodeIterators||(this._nodeIterators=[]),this._nodeIterators.push(it)}},_detachNodeIterator:{value:function(it){var pt=this._nodeIterators.indexOf(it);this._nodeIterators.splice(pt,1)}},_preremoveNodeIterators:{value:function(it){this._nodeIterators&&this._nodeIterators.forEach(function(pt){pt._preremove(it)})}},_updateDocTypeElement:{value:function(){this.doctype=this.documentElement=null;for(var pt=this.firstChild;pt!==null;pt=pt.nextSibling)pt.nodeType===e.DOCUMENT_TYPE_NODE?this.doctype=pt:pt.nodeType===e.ELEMENT_NODE&&(this.documentElement=pt)}},insertBefore:{value:function(pt,di){return e.prototype.insertBefore.call(this,pt,di),this._updateDocTypeElement(),pt}},replaceChild:{value:function(pt,di){return e.prototype.replaceChild.call(this,pt,di),this._updateDocTypeElement(),di}},removeChild:{value:function(pt){return e.prototype.removeChild.call(this,pt),this._updateDocTypeElement(),pt}},getElementById:{value:function(it){var pt=this.byId[it];return pt?pt instanceof hi?pt.getFirst():pt:null}},_hasMultipleElementsWithId:{value:function(it){return this.byId[it]instanceof hi}},getElementsByName:{value:r.prototype.getElementsByName},getElementsByTagName:{value:r.prototype.getElementsByTagName},getElementsByTagNameNS:{value:r.prototype.getElementsByTagNameNS},getElementsByClassName:{value:r.prototype.getElementsByClassName},adoptNode:{value:function(pt){return pt.nodeType===e.DOCUMENT_NODE&&ye.NotSupportedError(),pt.nodeType===e.ATTRIBUTE_NODE||(pt.parentNode&&pt.parentNode.removeChild(pt),pt.ownerDocument!==this&&Ai(pt,this)),pt}},importNode:{value:function(pt,di){return this.adoptNode(pt.cloneNode(di))},writable:ut},origin:{get:function(){return null}},characterSet:{get:function(){return"UTF-8"}},contentType:{get:function(){return this._contentType}},URL:{get:function(){return this._address}},domain:{get:ye.nyi,set:ye.nyi},referrer:{get:ye.nyi},cookie:{get:ye.nyi,set:ye.nyi},lastModified:{get:ye.nyi},location:{get:function(){return this.defaultView?this.defaultView.location:null},set:ye.nyi},_titleElement:{get:function(){return this.getElementsByTagName("title").item(0)||null}},title:{get:function(){var it=this._titleElement,pt=it?it.textContent:"";return pt.replace(/[ \t\n\r\f]+/g," ").replace(/(^ )|( $)/g,"")},set:function(it){var pt=this._titleElement,di=this.head;!pt&&!di||(pt||(pt=this.createElement("title"),di.appendChild(pt)),pt.textContent=it)}},dir:ui(function(){var it=this.documentElement;if(it&&it.tagName==="HTML")return it},"dir",""),fgColor:ui(function(){return this.body},"text",""),linkColor:ui(function(){return this.body},"link",""),vlinkColor:ui(function(){return this.body},"vLink",""),alinkColor:ui(function(){return this.body},"aLink",""),bgColor:ui(function(){return this.body},"bgColor",""),charset:{get:function(){return this.characterSet}},inputEncoding:{get:function(){return this.characterSet}},scrollingElement:{get:function(){return this._quirks?this.body:this.documentElement}},body:{get:function(){return le(this.documentElement,"body")},set:ye.nyi},head:{get:function(){return le(this.documentElement,"head")}},images:{get:ye.nyi},embeds:{get:ye.nyi},plugins:{get:ye.nyi},links:{get:ye.nyi},forms:{get:ye.nyi},scripts:{get:ye.nyi},applets:{get:function(){return[]}},activeElement:{get:function(){return null}},innerHTML:{get:function(){return this.serialize()},set:ye.nyi},outerHTML:{get:function(){return this.serialize()},set:ye.nyi},write:{value:function(it){if(this.isHTML||ye.InvalidStateError(),!!this._parser){var pt=arguments.join("");this._parser.parse(pt)}}},writeln:{value:function(pt){this.write(Array.prototype.join.call(arguments,"")+`
`)}},open:{value:function(){this.documentElement=null}},close:{value:function(){this.readyState="interactive",this._dispatchEvent(new T("readystatechange"),!0),this._dispatchEvent(new T("DOMContentLoaded"),!0),this.readyState="complete",this._dispatchEvent(new T("readystatechange"),!0),this.defaultView&&this.defaultView._dispatchEvent(new T("load"),!0)}},clone:{value:function(){var pt=new ct(this.isHTML,this._address);return pt._quirks=this._quirks,pt._contentType=this._contentType,pt}},cloneNode:{value:function(pt){var di=e.prototype.cloneNode.call(this,!1);if(pt)for(var Cn=this.firstChild;Cn!==null;Cn=Cn.nextSibling)di._appendChild(di.importNode(Cn,!0));return di._updateDocTypeElement(),di}},isEqual:{value:function(pt){return!0}},mutateValue:{value:function(it){this.mutationHandler&&this.mutationHandler({type:vt.VALUE,target:it,data:it.data})}},mutateAttr:{value:function(it,pt){this.mutationHandler&&this.mutationHandler({type:vt.ATTR,target:it.ownerElement,attr:it})}},mutateRemoveAttr:{value:function(it){this.mutationHandler&&this.mutationHandler({type:vt.REMOVE_ATTR,target:it.ownerElement,attr:it})}},mutateRemove:{value:function(it){this.mutationHandler&&this.mutationHandler({type:vt.REMOVE,target:it.parentNode,node:it}),li(it)}},mutateInsert:{value:function(it){yt(it),this.mutationHandler&&this.mutationHandler({type:vt.INSERT,target:it.parentNode,node:it})}},mutateMove:{value:function(it){this.mutationHandler&&this.mutationHandler({type:vt.MOVE,target:it})}},addId:{value:function(pt,di){var Cn=this.byId[pt];Cn?(Cn instanceof hi||(Cn=new hi(Cn),this.byId[pt]=Cn),Cn.add(di)):this.byId[pt]=di}},delId:{value:function(pt,di){var Cn=this.byId[pt];ye.assert(Cn),Cn instanceof hi?(Cn.del(di),Cn.length===1&&(this.byId[pt]=Cn.downgrade())):this.byId[pt]=void 0}},_resolve:{value:function(it){return new te(this._documentBaseURL).resolve(it)}},_documentBaseURL:{get:function(){var it=this._address;it==="about:blank"&&(it="/");var pt=this.querySelector("base[href]");return pt?new te(it).resolve(pt.getAttribute("href")):it}},_templateDoc:{get:function(){if(!this._templateDocCache){var it=new ct(this.isHTML,this._address);this._templateDocCache=it._templateDocCache=it}return this._templateDocCache}},querySelector:{value:function(it){return De(it,this)[0]}},querySelectorAll:{value:function(it){var pt=De(it,this);return pt.item?pt:new n(pt)}}});var xe=["abort","canplay","canplaythrough","change","click","contextmenu","cuechange","dblclick","drag","dragend","dragenter","dragleave","dragover","dragstart","drop","durationchange","emptied","ended","input","invalid","keydown","keypress","keyup","loadeddata","loadedmetadata","loadstart","mousedown","mousemove","mouseout","mouseover","mouseup","mousewheel","pause","play","playing","progress","ratechange","readystatechange","reset","seeked","seeking","select","show","stalled","submit","suspend","timeupdate","volumechange","waiting","blur","error","focus","load","scroll"];xe.forEach(function(it){Object.defineProperty(ct.prototype,"on"+it,{get:function(){return this._getEventHandler(it)},set:function(pt){this._setEventHandler(it,pt)}})});function le(it,pt){if(it&&it.isHTML){for(var di=it.firstChild;di!==null;di=di.nextSibling)if(di.nodeType===e.ELEMENT_NODE&&di.localName===pt&&di.namespaceURI===Rt.HTML)return di}return null}function ke(it){if(it._nid=it.ownerDocument._nextnid++,it.ownerDocument._nodes[it._nid]=it,it.nodeType===e.ELEMENT_NODE){var pt=it.getAttribute("id");pt&&it.ownerDocument.addId(pt,it),it._roothook&&it._roothook()}}function He(it){if(it.nodeType===e.ELEMENT_NODE){var pt=it.getAttribute("id");pt&&it.ownerDocument.delId(pt,it)}it.ownerDocument._nodes[it._nid]=void 0,it._nid=void 0}function yt(it){if(ke(it),it.nodeType===e.ELEMENT_NODE)for(var pt=it.firstChild;pt!==null;pt=pt.nextSibling)yt(pt)}function li(it){He(it);for(var pt=it.firstChild;pt!==null;pt=pt.nextSibling)li(pt)}function Ai(it,pt){it.ownerDocument=pt,it._lastModTime=void 0,Object.prototype.hasOwnProperty.call(it,"_tagName")&&(it._tagName=void 0);for(var di=it.firstChild;di!==null;di=di.nextSibling)Ai(di,pt)}function hi(it){this.nodes=Object.create(null),this.nodes[it._nid]=it,this.length=1,this.firstNode=void 0}hi.prototype.add=function(it){this.nodes[it._nid]||(this.nodes[it._nid]=it,this.length++,this.firstNode=void 0)},hi.prototype.del=function(it){this.nodes[it._nid]&&(delete this.nodes[it._nid],this.length--,this.firstNode=void 0)},hi.prototype.getFirst=function(){if(!this.firstNode){var it;for(it in this.nodes)(this.firstNode===void 0||this.firstNode.compareDocumentPosition(this.nodes[it])&e.DOCUMENT_POSITION_PRECEDING)&&(this.firstNode=this.nodes[it])}return this.firstNode},hi.prototype.downgrade=function(){if(this.length===1){var it;for(it in this.nodes)return this.nodes[it]}return this}}}),zP=Bn({"external/npm/node_modules/domino/lib/DocumentType.js"(t,i){i.exports=r;var e=xl(),n=YH(),o=OP();function r(g,w,T,k){n.call(this),this.nodeType=e.DOCUMENT_TYPE_NODE,this.ownerDocument=g||null,this.name=w,this.publicId=T||"",this.systemId=k||""}r.prototype=Object.create(n.prototype,{nodeName:{get:function(){return this.name}},nodeValue:{get:function(){return null},set:function(){}},clone:{value:function(){return new r(this.ownerDocument,this.name,this.publicId,this.systemId)}},isEqual:{value:function(w){return this.name===w.name&&this.publicId===w.publicId&&this.systemId===w.systemId}}}),Object.defineProperties(r.prototype,o)}}),BP=Bn({"external/npm/node_modules/domino/lib/HTMLParser.js"(t,i){i.exports=Zn;var e=FP(),n=zP(),o=xl(),r=Ba().NAMESPACE,g=LP(),w=g.elements,T=Function.prototype.apply.bind(Array.prototype.push),k=-1,N=1,V=2,q=3,Z=4,X=5,te=[],De=/^HTML$|^-\/\/W3O\/\/DTD W3 HTML Strict 3\.0\/\/EN\/\/$|^-\/W3C\/DTD HTML 4\.0 Transitional\/EN$|^\+\/\/Silmaril\/\/dtd html Pro v0r11 19970101\/\/|^-\/\/AdvaSoft Ltd\/\/DTD HTML 3\.0 asWedit \+ extensions\/\/|^-\/\/AS\/\/DTD HTML 3\.0 asWedit \+ extensions\/\/|^-\/\/IETF\/\/DTD HTML 2\.0 Level 1\/\/|^-\/\/IETF\/\/DTD HTML 2\.0 Level 2\/\/|^-\/\/IETF\/\/DTD HTML 2\.0 Strict Level 1\/\/|^-\/\/IETF\/\/DTD HTML 2\.0 Strict Level 2\/\/|^-\/\/IETF\/\/DTD HTML 2\.0 Strict\/\/|^-\/\/IETF\/\/DTD HTML 2\.0\/\/|^-\/\/IETF\/\/DTD HTML 2\.1E\/\/|^-\/\/IETF\/\/DTD HTML 3\.0\/\/|^-\/\/IETF\/\/DTD HTML 3\.2 Final\/\/|^-\/\/IETF\/\/DTD HTML 3\.2\/\/|^-\/\/IETF\/\/DTD HTML 3\/\/|^-\/\/IETF\/\/DTD HTML Level 0\/\/|^-\/\/IETF\/\/DTD HTML Level 1\/\/|^-\/\/IETF\/\/DTD HTML Level 2\/\/|^-\/\/IETF\/\/DTD HTML Level 3\/\/|^-\/\/IETF\/\/DTD HTML Strict Level 0\/\/|^-\/\/IETF\/\/DTD HTML Strict Level 1\/\/|^-\/\/IETF\/\/DTD HTML Strict Level 2\/\/|^-\/\/IETF\/\/DTD HTML Strict Level 3\/\/|^-\/\/IETF\/\/DTD HTML Strict\/\/|^-\/\/IETF\/\/DTD HTML\/\/|^-\/\/Metrius\/\/DTD Metrius Presentational\/\/|^-\/\/Microsoft\/\/DTD Internet Explorer 2\.0 HTML Strict\/\/|^-\/\/Microsoft\/\/DTD Internet Explorer 2\.0 HTML\/\/|^-\/\/Microsoft\/\/DTD Internet Explorer 2\.0 Tables\/\/|^-\/\/Microsoft\/\/DTD Internet Explorer 3\.0 HTML Strict\/\/|^-\/\/Microsoft\/\/DTD Internet Explorer 3\.0 HTML\/\/|^-\/\/Microsoft\/\/DTD Internet Explorer 3\.0 Tables\/\/|^-\/\/Netscape Comm\. Corp\.\/\/DTD HTML\/\/|^-\/\/Netscape Comm\. Corp\.\/\/DTD Strict HTML\/\/|^-\/\/O'Reilly and Associates\/\/DTD HTML 2\.0\/\/|^-\/\/O'Reilly and Associates\/\/DTD HTML Extended 1\.0\/\/|^-\/\/O'Reilly and Associates\/\/DTD HTML Extended Relaxed 1\.0\/\/|^-\/\/SoftQuad Software\/\/DTD HoTMetaL PRO 6\.0::19990601::extensions to HTML 4\.0\/\/|^-\/\/SoftQuad\/\/DTD HoTMetaL PRO 4\.0::19971010::extensions to HTML 4\.0\/\/|^-\/\/Spyglass\/\/DTD HTML 2\.0 Extended\/\/|^-\/\/SQ\/\/DTD HTML 2\.0 HoTMetaL \+ extensions\/\/|^-\/\/Sun Microsystems Corp\.\/\/DTD HotJava HTML\/\/|^-\/\/Sun Microsystems Corp\.\/\/DTD HotJava Strict HTML\/\/|^-\/\/W3C\/\/DTD HTML 3 1995-03-24\/\/|^-\/\/W3C\/\/DTD HTML 3\.2 Draft\/\/|^-\/\/W3C\/\/DTD HTML 3\.2 Final\/\/|^-\/\/W3C\/\/DTD HTML 3\.2\/\/|^-\/\/W3C\/\/DTD HTML 3\.2S Draft\/\/|^-\/\/W3C\/\/DTD HTML 4\.0 Frameset\/\/|^-\/\/W3C\/\/DTD HTML 4\.0 Transitional\/\/|^-\/\/W3C\/\/DTD HTML Experimental 19960712\/\/|^-\/\/W3C\/\/DTD HTML Experimental 970421\/\/|^-\/\/W3C\/\/DTD W3 HTML\/\/|^-\/\/W3O\/\/DTD W3 HTML 3\.0\/\/|^-\/\/WebTechs\/\/DTD Mozilla HTML 2\.0\/\/|^-\/\/WebTechs\/\/DTD Mozilla HTML\/\//i,_e="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",he=/^-\/\/W3C\/\/DTD HTML 4\.01 Frameset\/\/|^-\/\/W3C\/\/DTD HTML 4\.01 Transitional\/\//i,Ce=/^-\/\/W3C\/\/DTD XHTML 1\.0 Frameset\/\/|^-\/\/W3C\/\/DTD XHTML 1\.0 Transitional\/\//i,Pe=Object.create(null);Pe[r.HTML]={__proto__:null,address:!0,applet:!0,area:!0,article:!0,aside:!0,base:!0,basefont:!0,bgsound:!0,blockquote:!0,body:!0,br:!0,button:!0,caption:!0,center:!0,col:!0,colgroup:!0,dd:!0,details:!0,dir:!0,div:!0,dl:!0,dt:!0,embed:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,frame:!0,frameset:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,head:!0,header:!0,hgroup:!0,hr:!0,html:!0,iframe:!0,img:!0,input:!0,li:!0,link:!0,listing:!0,main:!0,marquee:!0,menu:!0,meta:!0,nav:!0,noembed:!0,noframes:!0,noscript:!0,object:!0,ol:!0,p:!0,param:!0,plaintext:!0,pre:!0,script:!0,section:!0,select:!0,source:!0,style:!0,summary:!0,table:!0,tbody:!0,td:!0,template:!0,textarea:!0,tfoot:!0,th:!0,thead:!0,title:!0,tr:!0,track:!0,ul:!0,wbr:!0,xmp:!0},Pe[r.SVG]={__proto__:null,foreignObject:!0,desc:!0,title:!0},Pe[r.MATHML]={__proto__:null,mi:!0,mo:!0,mn:!0,ms:!0,mtext:!0,"annotation-xml":!0};var ye=Object.create(null);ye[r.HTML]={__proto__:null,address:!0,div:!0,p:!0};var vt=Object.create(null);vt[r.HTML]={__proto__:null,dd:!0,dt:!0};var Rt=Object.create(null);Rt[r.HTML]={__proto__:null,table:!0,thead:!0,tbody:!0,tfoot:!0,tr:!0};var ut=Object.create(null);ut[r.HTML]={__proto__:null,dd:!0,dt:!0,li:!0,menuitem:!0,optgroup:!0,option:!0,p:!0,rb:!0,rp:!0,rt:!0,rtc:!0};var ct=Object.create(null);ct[r.HTML]={__proto__:null,caption:!0,colgroup:!0,dd:!0,dt:!0,li:!0,optgroup:!0,option:!0,p:!0,rb:!0,rp:!0,rt:!0,rtc:!0,tbody:!0,td:!0,tfoot:!0,th:!0,thead:!0,tr:!0};var We=Object.create(null);We[r.HTML]={__proto__:null,table:!0,template:!0,html:!0};var Pt=Object.create(null);Pt[r.HTML]={__proto__:null,tbody:!0,tfoot:!0,thead:!0,template:!0,html:!0};var ui=Object.create(null);ui[r.HTML]={__proto__:null,tr:!0,template:!0,html:!0};var we=Object.create(null);we[r.HTML]={__proto__:null,button:!0,fieldset:!0,input:!0,keygen:!0,object:!0,output:!0,select:!0,textarea:!0,img:!0};var xe=Object.create(null);xe[r.HTML]={__proto__:null,applet:!0,caption:!0,html:!0,table:!0,td:!0,th:!0,marquee:!0,object:!0,template:!0},xe[r.MATHML]={__proto__:null,mi:!0,mo:!0,mn:!0,ms:!0,mtext:!0,"annotation-xml":!0},xe[r.SVG]={__proto__:null,foreignObject:!0,desc:!0,title:!0};var le=Object.create(xe);le[r.HTML]=Object.create(xe[r.HTML]),le[r.HTML].ol=!0,le[r.HTML].ul=!0;var ke=Object.create(xe);ke[r.HTML]=Object.create(xe[r.HTML]),ke[r.HTML].button=!0;var He=Object.create(null);He[r.HTML]={__proto__:null,html:!0,table:!0,template:!0};var yt=Object.create(null);yt[r.HTML]={__proto__:null,optgroup:!0,option:!0};var li=Object.create(null);li[r.MATHML]={__proto__:null,mi:!0,mo:!0,mn:!0,ms:!0,mtext:!0};var Ai=Object.create(null);Ai[r.SVG]={__proto__:null,foreignObject:!0,desc:!0,title:!0};var hi={__proto__:null,"xlink:actuate":r.XLINK,"xlink:arcrole":r.XLINK,"xlink:href":r.XLINK,"xlink:role":r.XLINK,"xlink:show":r.XLINK,"xlink:title":r.XLINK,"xlink:type":r.XLINK,"xml:base":r.XML,"xml:lang":r.XML,"xml:space":r.XML,xmlns:r.XMLNS,"xmlns:xlink":r.XMLNS},it={__proto__:null,attributename:"attributeName",attributetype:"attributeType",basefrequency:"baseFrequency",baseprofile:"baseProfile",calcmode:"calcMode",clippathunits:"clipPathUnits",diffuseconstant:"diffuseConstant",edgemode:"edgeMode",filterunits:"filterUnits",glyphref:"glyphRef",gradienttransform:"gradientTransform",gradientunits:"gradientUnits",kernelmatrix:"kernelMatrix",kernelunitlength:"kernelUnitLength",keypoints:"keyPoints",keysplines:"keySplines",keytimes:"keyTimes",lengthadjust:"lengthAdjust",limitingconeangle:"limitingConeAngle",markerheight:"markerHeight",markerunits:"markerUnits",markerwidth:"markerWidth",maskcontentunits:"maskContentUnits",maskunits:"maskUnits",numoctaves:"numOctaves",pathlength:"pathLength",patterncontentunits:"patternContentUnits",patterntransform:"patternTransform",patternunits:"patternUnits",pointsatx:"pointsAtX",pointsaty:"pointsAtY",pointsatz:"pointsAtZ",preservealpha:"preserveAlpha",preserveaspectratio:"preserveAspectRatio",primitiveunits:"primitiveUnits",refx:"refX",refy:"refY",repeatcount:"repeatCount",repeatdur:"repeatDur",requiredextensions:"requiredExtensions",requiredfeatures:"requiredFeatures",specularconstant:"specularConstant",specularexponent:"specularExponent",spreadmethod:"spreadMethod",startoffset:"startOffset",stddeviation:"stdDeviation",stitchtiles:"stitchTiles",surfacescale:"surfaceScale",systemlanguage:"systemLanguage",tablevalues:"tableValues",targetx:"targetX",targety:"targetY",textlength:"textLength",viewbox:"viewBox",viewtarget:"viewTarget",xchannelselector:"xChannelSelector",ychannelselector:"yChannelSelector",zoomandpan:"zoomAndPan"},pt={__proto__:null,altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient",textpath:"textPath"},di={__proto__:null,0:65533,128:8364,130:8218,131:402,132:8222,133:8230,134:8224,135:8225,136:710,137:8240,138:352,139:8249,140:338,142:381,145:8216,146:8217,147:8220,148:8221,149:8226,150:8211,151:8212,152:732,153:8482,154:353,155:8250,156:339,158:382,159:376},Cn={__proto__:null,AElig:198,"AElig;":198,AMP:38,"AMP;":38,Aacute:193,"Aacute;":193,"Abreve;":258,Acirc:194,"Acirc;":194,"Acy;":1040,"Afr;":[55349,56580],Agrave:192,"Agrave;":192,"Alpha;":913,"Amacr;":256,"And;":10835,"Aogon;":260,"Aopf;":[55349,56632],"ApplyFunction;":8289,Aring:197,"Aring;":197,"Ascr;":[55349,56476],"Assign;":8788,Atilde:195,"Atilde;":195,Auml:196,"Auml;":196,"Backslash;":8726,"Barv;":10983,"Barwed;":8966,"Bcy;":1041,"Because;":8757,"Bernoullis;":8492,"Beta;":914,"Bfr;":[55349,56581],"Bopf;":[55349,56633],"Breve;":728,"Bscr;":8492,"Bumpeq;":8782,"CHcy;":1063,COPY:169,"COPY;":169,"Cacute;":262,"Cap;":8914,"CapitalDifferentialD;":8517,"Cayleys;":8493,"Ccaron;":268,Ccedil:199,"Ccedil;":199,"Ccirc;":264,"Cconint;":8752,"Cdot;":266,"Cedilla;":184,"CenterDot;":183,"Cfr;":8493,"Chi;":935,"CircleDot;":8857,"CircleMinus;":8854,"CirclePlus;":8853,"CircleTimes;":8855,"ClockwiseContourIntegral;":8754,"CloseCurlyDoubleQuote;":8221,"CloseCurlyQuote;":8217,"Colon;":8759,"Colone;":10868,"Congruent;":8801,"Conint;":8751,"ContourIntegral;":8750,"Copf;":8450,"Coproduct;":8720,"CounterClockwiseContourIntegral;":8755,"Cross;":10799,"Cscr;":[55349,56478],"Cup;":8915,"CupCap;":8781,"DD;":8517,"DDotrahd;":10513,"DJcy;":1026,"DScy;":1029,"DZcy;":1039,"Dagger;":8225,"Darr;":8609,"Dashv;":10980,"Dcaron;":270,"Dcy;":1044,"Del;":8711,"Delta;":916,"Dfr;":[55349,56583],"DiacriticalAcute;":180,"DiacriticalDot;":729,"DiacriticalDoubleAcute;":733,"DiacriticalGrave;":96,"DiacriticalTilde;":732,"Diamond;":8900,"DifferentialD;":8518,"Dopf;":[55349,56635],"Dot;":168,"DotDot;":8412,"DotEqual;":8784,"DoubleContourIntegral;":8751,"DoubleDot;":168,"DoubleDownArrow;":8659,"DoubleLeftArrow;":8656,"DoubleLeftRightArrow;":8660,"DoubleLeftTee;":10980,"DoubleLongLeftArrow;":10232,"DoubleLongLeftRightArrow;":10234,"DoubleLongRightArrow;":10233,"DoubleRightArrow;":8658,"DoubleRightTee;":8872,"DoubleUpArrow;":8657,"DoubleUpDownArrow;":8661,"DoubleVerticalBar;":8741,"DownArrow;":8595,"DownArrowBar;":10515,"DownArrowUpArrow;":8693,"DownBreve;":785,"DownLeftRightVector;":10576,"DownLeftTeeVector;":10590,"DownLeftVector;":8637,"DownLeftVectorBar;":10582,"DownRightTeeVector;":10591,"DownRightVector;":8641,"DownRightVectorBar;":10583,"DownTee;":8868,"DownTeeArrow;":8615,"Downarrow;":8659,"Dscr;":[55349,56479],"Dstrok;":272,"ENG;":330,ETH:208,"ETH;":208,Eacute:201,"Eacute;":201,"Ecaron;":282,Ecirc:202,"Ecirc;":202,"Ecy;":1069,"Edot;":278,"Efr;":[55349,56584],Egrave:200,"Egrave;":200,"Element;":8712,"Emacr;":274,"EmptySmallSquare;":9723,"EmptyVerySmallSquare;":9643,"Eogon;":280,"Eopf;":[55349,56636],"Epsilon;":917,"Equal;":10869,"EqualTilde;":8770,"Equilibrium;":8652,"Escr;":8496,"Esim;":10867,"Eta;":919,Euml:203,"Euml;":203,"Exists;":8707,"ExponentialE;":8519,"Fcy;":1060,"Ffr;":[55349,56585],"FilledSmallSquare;":9724,"FilledVerySmallSquare;":9642,"Fopf;":[55349,56637],"ForAll;":8704,"Fouriertrf;":8497,"Fscr;":8497,"GJcy;":1027,GT:62,"GT;":62,"Gamma;":915,"Gammad;":988,"Gbreve;":286,"Gcedil;":290,"Gcirc;":284,"Gcy;":1043,"Gdot;":288,"Gfr;":[55349,56586],"Gg;":8921,"Gopf;":[55349,56638],"GreaterEqual;":8805,"GreaterEqualLess;":8923,"GreaterFullEqual;":8807,"GreaterGreater;":10914,"GreaterLess;":8823,"GreaterSlantEqual;":10878,"GreaterTilde;":8819,"Gscr;":[55349,56482],"Gt;":8811,"HARDcy;":1066,"Hacek;":711,"Hat;":94,"Hcirc;":292,"Hfr;":8460,"HilbertSpace;":8459,"Hopf;":8461,"HorizontalLine;":9472,"Hscr;":8459,"Hstrok;":294,"HumpDownHump;":8782,"HumpEqual;":8783,"IEcy;":1045,"IJlig;":306,"IOcy;":1025,Iacute:205,"Iacute;":205,Icirc:206,"Icirc;":206,"Icy;":1048,"Idot;":304,"Ifr;":8465,Igrave:204,"Igrave;":204,"Im;":8465,"Imacr;":298,"ImaginaryI;":8520,"Implies;":8658,"Int;":8748,"Integral;":8747,"Intersection;":8898,"InvisibleComma;":8291,"InvisibleTimes;":8290,"Iogon;":302,"Iopf;":[55349,56640],"Iota;":921,"Iscr;":8464,"Itilde;":296,"Iukcy;":1030,Iuml:207,"Iuml;":207,"Jcirc;":308,"Jcy;":1049,"Jfr;":[55349,56589],"Jopf;":[55349,56641],"Jscr;":[55349,56485],"Jsercy;":1032,"Jukcy;":1028,"KHcy;":1061,"KJcy;":1036,"Kappa;":922,"Kcedil;":310,"Kcy;":1050,"Kfr;":[55349,56590],"Kopf;":[55349,56642],"Kscr;":[55349,56486],"LJcy;":1033,LT:60,"LT;":60,"Lacute;":313,"Lambda;":923,"Lang;":10218,"Laplacetrf;":8466,"Larr;":8606,"Lcaron;":317,"Lcedil;":315,"Lcy;":1051,"LeftAngleBracket;":10216,"LeftArrow;":8592,"LeftArrowBar;":8676,"LeftArrowRightArrow;":8646,"LeftCeiling;":8968,"LeftDoubleBracket;":10214,"LeftDownTeeVector;":10593,"LeftDownVector;":8643,"LeftDownVectorBar;":10585,"LeftFloor;":8970,"LeftRightArrow;":8596,"LeftRightVector;":10574,"LeftTee;":8867,"LeftTeeArrow;":8612,"LeftTeeVector;":10586,"LeftTriangle;":8882,"LeftTriangleBar;":10703,"LeftTriangleEqual;":8884,"LeftUpDownVector;":10577,"LeftUpTeeVector;":10592,"LeftUpVector;":8639,"LeftUpVectorBar;":10584,"LeftVector;":8636,"LeftVectorBar;":10578,"Leftarrow;":8656,"Leftrightarrow;":8660,"LessEqualGreater;":8922,"LessFullEqual;":8806,"LessGreater;":8822,"LessLess;":10913,"LessSlantEqual;":10877,"LessTilde;":8818,"Lfr;":[55349,56591],"Ll;":8920,"Lleftarrow;":8666,"Lmidot;":319,"LongLeftArrow;":10229,"LongLeftRightArrow;":10231,"LongRightArrow;":10230,"Longleftarrow;":10232,"Longleftrightarrow;":10234,"Longrightarrow;":10233,"Lopf;":[55349,56643],"LowerLeftArrow;":8601,"LowerRightArrow;":8600,"Lscr;":8466,"Lsh;":8624,"Lstrok;":321,"Lt;":8810,"Map;":10501,"Mcy;":1052,"MediumSpace;":8287,"Mellintrf;":8499,"Mfr;":[55349,56592],"MinusPlus;":8723,"Mopf;":[55349,56644],"Mscr;":8499,"Mu;":924,"NJcy;":1034,"Nacute;":323,"Ncaron;":327,"Ncedil;":325,"Ncy;":1053,"NegativeMediumSpace;":8203,"NegativeThickSpace;":8203,"NegativeThinSpace;":8203,"NegativeVeryThinSpace;":8203,"NestedGreaterGreater;":8811,"NestedLessLess;":8810,"NewLine;":10,"Nfr;":[55349,56593],"NoBreak;":8288,"NonBreakingSpace;":160,"Nopf;":8469,"Not;":10988,"NotCongruent;":8802,"NotCupCap;":8813,"NotDoubleVerticalBar;":8742,"NotElement;":8713,"NotEqual;":8800,"NotEqualTilde;":[8770,824],"NotExists;":8708,"NotGreater;":8815,"NotGreaterEqual;":8817,"NotGreaterFullEqual;":[8807,824],"NotGreaterGreater;":[8811,824],"NotGreaterLess;":8825,"NotGreaterSlantEqual;":[10878,824],"NotGreaterTilde;":8821,"NotHumpDownHump;":[8782,824],"NotHumpEqual;":[8783,824],"NotLeftTriangle;":8938,"NotLeftTriangleBar;":[10703,824],"NotLeftTriangleEqual;":8940,"NotLess;":8814,"NotLessEqual;":8816,"NotLessGreater;":8824,"NotLessLess;":[8810,824],"NotLessSlantEqual;":[10877,824],"NotLessTilde;":8820,"NotNestedGreaterGreater;":[10914,824],"NotNestedLessLess;":[10913,824],"NotPrecedes;":8832,"NotPrecedesEqual;":[10927,824],"NotPrecedesSlantEqual;":8928,"NotReverseElement;":8716,"NotRightTriangle;":8939,"NotRightTriangleBar;":[10704,824],"NotRightTriangleEqual;":8941,"NotSquareSubset;":[8847,824],"NotSquareSubsetEqual;":8930,"NotSquareSuperset;":[8848,824],"NotSquareSupersetEqual;":8931,"NotSubset;":[8834,8402],"NotSubsetEqual;":8840,"NotSucceeds;":8833,"NotSucceedsEqual;":[10928,824],"NotSucceedsSlantEqual;":8929,"NotSucceedsTilde;":[8831,824],"NotSuperset;":[8835,8402],"NotSupersetEqual;":8841,"NotTilde;":8769,"NotTildeEqual;":8772,"NotTildeFullEqual;":8775,"NotTildeTilde;":8777,"NotVerticalBar;":8740,"Nscr;":[55349,56489],Ntilde:209,"Ntilde;":209,"Nu;":925,"OElig;":338,Oacute:211,"Oacute;":211,Ocirc:212,"Ocirc;":212,"Ocy;":1054,"Odblac;":336,"Ofr;":[55349,56594],Ograve:210,"Ograve;":210,"Omacr;":332,"Omega;":937,"Omicron;":927,"Oopf;":[55349,56646],"OpenCurlyDoubleQuote;":8220,"OpenCurlyQuote;":8216,"Or;":10836,"Oscr;":[55349,56490],Oslash:216,"Oslash;":216,Otilde:213,"Otilde;":213,"Otimes;":10807,Ouml:214,"Ouml;":214,"OverBar;":8254,"OverBrace;":9182,"OverBracket;":9140,"OverParenthesis;":9180,"PartialD;":8706,"Pcy;":1055,"Pfr;":[55349,56595],"Phi;":934,"Pi;":928,"PlusMinus;":177,"Poincareplane;":8460,"Popf;":8473,"Pr;":10939,"Precedes;":8826,"PrecedesEqual;":10927,"PrecedesSlantEqual;":8828,"PrecedesTilde;":8830,"Prime;":8243,"Product;":8719,"Proportion;":8759,"Proportional;":8733,"Pscr;":[55349,56491],"Psi;":936,QUOT:34,"QUOT;":34,"Qfr;":[55349,56596],"Qopf;":8474,"Qscr;":[55349,56492],"RBarr;":10512,REG:174,"REG;":174,"Racute;":340,"Rang;":10219,"Rarr;":8608,"Rarrtl;":10518,"Rcaron;":344,"Rcedil;":342,"Rcy;":1056,"Re;":8476,"ReverseElement;":8715,"ReverseEquilibrium;":8651,"ReverseUpEquilibrium;":10607,"Rfr;":8476,"Rho;":929,"RightAngleBracket;":10217,"RightArrow;":8594,"RightArrowBar;":8677,"RightArrowLeftArrow;":8644,"RightCeiling;":8969,"RightDoubleBracket;":10215,"RightDownTeeVector;":10589,"RightDownVector;":8642,"RightDownVectorBar;":10581,"RightFloor;":8971,"RightTee;":8866,"RightTeeArrow;":8614,"RightTeeVector;":10587,"RightTriangle;":8883,"RightTriangleBar;":10704,"RightTriangleEqual;":8885,"RightUpDownVector;":10575,"RightUpTeeVector;":10588,"RightUpVector;":8638,"RightUpVectorBar;":10580,"RightVector;":8640,"RightVectorBar;":10579,"Rightarrow;":8658,"Ropf;":8477,"RoundImplies;":10608,"Rrightarrow;":8667,"Rscr;":8475,"Rsh;":8625,"RuleDelayed;":10740,"SHCHcy;":1065,"SHcy;":1064,"SOFTcy;":1068,"Sacute;":346,"Sc;":10940,"Scaron;":352,"Scedil;":350,"Scirc;":348,"Scy;":1057,"Sfr;":[55349,56598],"ShortDownArrow;":8595,"ShortLeftArrow;":8592,"ShortRightArrow;":8594,"ShortUpArrow;":8593,"Sigma;":931,"SmallCircle;":8728,"Sopf;":[55349,56650],"Sqrt;":8730,"Square;":9633,"SquareIntersection;":8851,"SquareSubset;":8847,"SquareSubsetEqual;":8849,"SquareSuperset;":8848,"SquareSupersetEqual;":8850,"SquareUnion;":8852,"Sscr;":[55349,56494],"Star;":8902,"Sub;":8912,"Subset;":8912,"SubsetEqual;":8838,"Succeeds;":8827,"SucceedsEqual;":10928,"SucceedsSlantEqual;":8829,"SucceedsTilde;":8831,"SuchThat;":8715,"Sum;":8721,"Sup;":8913,"Superset;":8835,"SupersetEqual;":8839,"Supset;":8913,THORN:222,"THORN;":222,"TRADE;":8482,"TSHcy;":1035,"TScy;":1062,"Tab;":9,"Tau;":932,"Tcaron;":356,"Tcedil;":354,"Tcy;":1058,"Tfr;":[55349,56599],"Therefore;":8756,"Theta;":920,"ThickSpace;":[8287,8202],"ThinSpace;":8201,"Tilde;":8764,"TildeEqual;":8771,"TildeFullEqual;":8773,"TildeTilde;":8776,"Topf;":[55349,56651],"TripleDot;":8411,"Tscr;":[55349,56495],"Tstrok;":358,Uacute:218,"Uacute;":218,"Uarr;":8607,"Uarrocir;":10569,"Ubrcy;":1038,"Ubreve;":364,Ucirc:219,"Ucirc;":219,"Ucy;":1059,"Udblac;":368,"Ufr;":[55349,56600],Ugrave:217,"Ugrave;":217,"Umacr;":362,"UnderBar;":95,"UnderBrace;":9183,"UnderBracket;":9141,"UnderParenthesis;":9181,"Union;":8899,"UnionPlus;":8846,"Uogon;":370,"Uopf;":[55349,56652],"UpArrow;":8593,"UpArrowBar;":10514,"UpArrowDownArrow;":8645,"UpDownArrow;":8597,"UpEquilibrium;":10606,"UpTee;":8869,"UpTeeArrow;":8613,"Uparrow;":8657,"Updownarrow;":8661,"UpperLeftArrow;":8598,"UpperRightArrow;":8599,"Upsi;":978,"Upsilon;":933,"Uring;":366,"Uscr;":[55349,56496],"Utilde;":360,Uuml:220,"Uuml;":220,"VDash;":8875,"Vbar;":10987,"Vcy;":1042,"Vdash;":8873,"Vdashl;":10982,"Vee;":8897,"Verbar;":8214,"Vert;":8214,"VerticalBar;":8739,"VerticalLine;":124,"VerticalSeparator;":10072,"VerticalTilde;":8768,"VeryThinSpace;":8202,"Vfr;":[55349,56601],"Vopf;":[55349,56653],"Vscr;":[55349,56497],"Vvdash;":8874,"Wcirc;":372,"Wedge;":8896,"Wfr;":[55349,56602],"Wopf;":[55349,56654],"Wscr;":[55349,56498],"Xfr;":[55349,56603],"Xi;":926,"Xopf;":[55349,56655],"Xscr;":[55349,56499],"YAcy;":1071,"YIcy;":1031,"YUcy;":1070,Yacute:221,"Yacute;":221,"Ycirc;":374,"Ycy;":1067,"Yfr;":[55349,56604],"Yopf;":[55349,56656],"Yscr;":[55349,56500],"Yuml;":376,"ZHcy;":1046,"Zacute;":377,"Zcaron;":381,"Zcy;":1047,"Zdot;":379,"ZeroWidthSpace;":8203,"Zeta;":918,"Zfr;":8488,"Zopf;":8484,"Zscr;":[55349,56501],aacute:225,"aacute;":225,"abreve;":259,"ac;":8766,"acE;":[8766,819],"acd;":8767,acirc:226,"acirc;":226,acute:180,"acute;":180,"acy;":1072,aelig:230,"aelig;":230,"af;":8289,"afr;":[55349,56606],agrave:224,"agrave;":224,"alefsym;":8501,"aleph;":8501,"alpha;":945,"amacr;":257,"amalg;":10815,amp:38,"amp;":38,"and;":8743,"andand;":10837,"andd;":10844,"andslope;":10840,"andv;":10842,"ang;":8736,"ange;":10660,"angle;":8736,"angmsd;":8737,"angmsdaa;":10664,"angmsdab;":10665,"angmsdac;":10666,"angmsdad;":10667,"angmsdae;":10668,"angmsdaf;":10669,"angmsdag;":10670,"angmsdah;":10671,"angrt;":8735,"angrtvb;":8894,"angrtvbd;":10653,"angsph;":8738,"angst;":197,"angzarr;":9084,"aogon;":261,"aopf;":[55349,56658],"ap;":8776,"apE;":10864,"apacir;":10863,"ape;":8778,"apid;":8779,"apos;":39,"approx;":8776,"approxeq;":8778,aring:229,"aring;":229,"ascr;":[55349,56502],"ast;":42,"asymp;":8776,"asympeq;":8781,atilde:227,"atilde;":227,auml:228,"auml;":228,"awconint;":8755,"awint;":10769,"bNot;":10989,"backcong;":8780,"backepsilon;":1014,"backprime;":8245,"backsim;":8765,"backsimeq;":8909,"barvee;":8893,"barwed;":8965,"barwedge;":8965,"bbrk;":9141,"bbrktbrk;":9142,"bcong;":8780,"bcy;":1073,"bdquo;":8222,"becaus;":8757,"because;":8757,"bemptyv;":10672,"bepsi;":1014,"bernou;":8492,"beta;":946,"beth;":8502,"between;":8812,"bfr;":[55349,56607],"bigcap;":8898,"bigcirc;":9711,"bigcup;":8899,"bigodot;":10752,"bigoplus;":10753,"bigotimes;":10754,"bigsqcup;":10758,"bigstar;":9733,"bigtriangledown;":9661,"bigtriangleup;":9651,"biguplus;":10756,"bigvee;":8897,"bigwedge;":8896,"bkarow;":10509,"blacklozenge;":10731,"blacksquare;":9642,"blacktriangle;":9652,"blacktriangledown;":9662,"blacktriangleleft;":9666,"blacktriangleright;":9656,"blank;":9251,"blk12;":9618,"blk14;":9617,"blk34;":9619,"block;":9608,"bne;":[61,8421],"bnequiv;":[8801,8421],"bnot;":8976,"bopf;":[55349,56659],"bot;":8869,"bottom;":8869,"bowtie;":8904,"boxDL;":9559,"boxDR;":9556,"boxDl;":9558,"boxDr;":9555,"boxH;":9552,"boxHD;":9574,"boxHU;":9577,"boxHd;":9572,"boxHu;":9575,"boxUL;":9565,"boxUR;":9562,"boxUl;":9564,"boxUr;":9561,"boxV;":9553,"boxVH;":9580,"boxVL;":9571,"boxVR;":9568,"boxVh;":9579,"boxVl;":9570,"boxVr;":9567,"boxbox;":10697,"boxdL;":9557,"boxdR;":9554,"boxdl;":9488,"boxdr;":9484,"boxh;":9472,"boxhD;":9573,"boxhU;":9576,"boxhd;":9516,"boxhu;":9524,"boxminus;":8863,"boxplus;":8862,"boxtimes;":8864,"boxuL;":9563,"boxuR;":9560,"boxul;":9496,"boxur;":9492,"boxv;":9474,"boxvH;":9578,"boxvL;":9569,"boxvR;":9566,"boxvh;":9532,"boxvl;":9508,"boxvr;":9500,"bprime;":8245,"breve;":728,brvbar:166,"brvbar;":166,"bscr;":[55349,56503],"bsemi;":8271,"bsim;":8765,"bsime;":8909,"bsol;":92,"bsolb;":10693,"bsolhsub;":10184,"bull;":8226,"bullet;":8226,"bump;":8782,"bumpE;":10926,"bumpe;":8783,"bumpeq;":8783,"cacute;":263,"cap;":8745,"capand;":10820,"capbrcup;":10825,"capcap;":10827,"capcup;":10823,"capdot;":10816,"caps;":[8745,65024],"caret;":8257,"caron;":711,"ccaps;":10829,"ccaron;":269,ccedil:231,"ccedil;":231,"ccirc;":265,"ccups;":10828,"ccupssm;":10832,"cdot;":267,cedil:184,"cedil;":184,"cemptyv;":10674,cent:162,"cent;":162,"centerdot;":183,"cfr;":[55349,56608],"chcy;":1095,"check;":10003,"checkmark;":10003,"chi;":967,"cir;":9675,"cirE;":10691,"circ;":710,"circeq;":8791,"circlearrowleft;":8634,"circlearrowright;":8635,"circledR;":174,"circledS;":9416,"circledast;":8859,"circledcirc;":8858,"circleddash;":8861,"cire;":8791,"cirfnint;":10768,"cirmid;":10991,"cirscir;":10690,"clubs;":9827,"clubsuit;":9827,"colon;":58,"colone;":8788,"coloneq;":8788,"comma;":44,"commat;":64,"comp;":8705,"compfn;":8728,"complement;":8705,"complexes;":8450,"cong;":8773,"congdot;":10861,"conint;":8750,"copf;":[55349,56660],"coprod;":8720,copy:169,"copy;":169,"copysr;":8471,"crarr;":8629,"cross;":10007,"cscr;":[55349,56504],"csub;":10959,"csube;":10961,"csup;":10960,"csupe;":10962,"ctdot;":8943,"cudarrl;":10552,"cudarrr;":10549,"cuepr;":8926,"cuesc;":8927,"cularr;":8630,"cularrp;":10557,"cup;":8746,"cupbrcap;":10824,"cupcap;":10822,"cupcup;":10826,"cupdot;":8845,"cupor;":10821,"cups;":[8746,65024],"curarr;":8631,"curarrm;":10556,"curlyeqprec;":8926,"curlyeqsucc;":8927,"curlyvee;":8910,"curlywedge;":8911,curren:164,"curren;":164,"curvearrowleft;":8630,"curvearrowright;":8631,"cuvee;":8910,"cuwed;":8911,"cwconint;":8754,"cwint;":8753,"cylcty;":9005,"dArr;":8659,"dHar;":10597,"dagger;":8224,"daleth;":8504,"darr;":8595,"dash;":8208,"dashv;":8867,"dbkarow;":10511,"dblac;":733,"dcaron;":271,"dcy;":1076,"dd;":8518,"ddagger;":8225,"ddarr;":8650,"ddotseq;":10871,deg:176,"deg;":176,"delta;":948,"demptyv;":10673,"dfisht;":10623,"dfr;":[55349,56609],"dharl;":8643,"dharr;":8642,"diam;":8900,"diamond;":8900,"diamondsuit;":9830,"diams;":9830,"die;":168,"digamma;":989,"disin;":8946,"div;":247,divide:247,"divide;":247,"divideontimes;":8903,"divonx;":8903,"djcy;":1106,"dlcorn;":8990,"dlcrop;":8973,"dollar;":36,"dopf;":[55349,56661],"dot;":729,"doteq;":8784,"doteqdot;":8785,"dotminus;":8760,"dotplus;":8724,"dotsquare;":8865,"doublebarwedge;":8966,"downarrow;":8595,"downdownarrows;":8650,"downharpoonleft;":8643,"downharpoonright;":8642,"drbkarow;":10512,"drcorn;":8991,"drcrop;":8972,"dscr;":[55349,56505],"dscy;":1109,"dsol;":10742,"dstrok;":273,"dtdot;":8945,"dtri;":9663,"dtrif;":9662,"duarr;":8693,"duhar;":10607,"dwangle;":10662,"dzcy;":1119,"dzigrarr;":10239,"eDDot;":10871,"eDot;":8785,eacute:233,"eacute;":233,"easter;":10862,"ecaron;":283,"ecir;":8790,ecirc:234,"ecirc;":234,"ecolon;":8789,"ecy;":1101,"edot;":279,"ee;":8519,"efDot;":8786,"efr;":[55349,56610],"eg;":10906,egrave:232,"egrave;":232,"egs;":10902,"egsdot;":10904,"el;":10905,"elinters;":9191,"ell;":8467,"els;":10901,"elsdot;":10903,"emacr;":275,"empty;":8709,"emptyset;":8709,"emptyv;":8709,"emsp13;":8196,"emsp14;":8197,"emsp;":8195,"eng;":331,"ensp;":8194,"eogon;":281,"eopf;":[55349,56662],"epar;":8917,"eparsl;":10723,"eplus;":10865,"epsi;":949,"epsilon;":949,"epsiv;":1013,"eqcirc;":8790,"eqcolon;":8789,"eqsim;":8770,"eqslantgtr;":10902,"eqslantless;":10901,"equals;":61,"equest;":8799,"equiv;":8801,"equivDD;":10872,"eqvparsl;":10725,"erDot;":8787,"erarr;":10609,"escr;":8495,"esdot;":8784,"esim;":8770,"eta;":951,eth:240,"eth;":240,euml:235,"euml;":235,"euro;":8364,"excl;":33,"exist;":8707,"expectation;":8496,"exponentiale;":8519,"fallingdotseq;":8786,"fcy;":1092,"female;":9792,"ffilig;":64259,"fflig;":64256,"ffllig;":64260,"ffr;":[55349,56611],"filig;":64257,"fjlig;":[102,106],"flat;":9837,"fllig;":64258,"fltns;":9649,"fnof;":402,"fopf;":[55349,56663],"forall;":8704,"fork;":8916,"forkv;":10969,"fpartint;":10765,frac12:189,"frac12;":189,"frac13;":8531,frac14:188,"frac14;":188,"frac15;":8533,"frac16;":8537,"frac18;":8539,"frac23;":8532,"frac25;":8534,frac34:190,"frac34;":190,"frac35;":8535,"frac38;":8540,"frac45;":8536,"frac56;":8538,"frac58;":8541,"frac78;":8542,"frasl;":8260,"frown;":8994,"fscr;":[55349,56507],"gE;":8807,"gEl;":10892,"gacute;":501,"gamma;":947,"gammad;":989,"gap;":10886,"gbreve;":287,"gcirc;":285,"gcy;":1075,"gdot;":289,"ge;":8805,"gel;":8923,"geq;":8805,"geqq;":8807,"geqslant;":10878,"ges;":10878,"gescc;":10921,"gesdot;":10880,"gesdoto;":10882,"gesdotol;":10884,"gesl;":[8923,65024],"gesles;":10900,"gfr;":[55349,56612],"gg;":8811,"ggg;":8921,"gimel;":8503,"gjcy;":1107,"gl;":8823,"glE;":10898,"gla;":10917,"glj;":10916,"gnE;":8809,"gnap;":10890,"gnapprox;":10890,"gne;":10888,"gneq;":10888,"gneqq;":8809,"gnsim;":8935,"gopf;":[55349,56664],"grave;":96,"gscr;":8458,"gsim;":8819,"gsime;":10894,"gsiml;":10896,gt:62,"gt;":62,"gtcc;":10919,"gtcir;":10874,"gtdot;":8919,"gtlPar;":10645,"gtquest;":10876,"gtrapprox;":10886,"gtrarr;":10616,"gtrdot;":8919,"gtreqless;":8923,"gtreqqless;":10892,"gtrless;":8823,"gtrsim;":8819,"gvertneqq;":[8809,65024],"gvnE;":[8809,65024],"hArr;":8660,"hairsp;":8202,"half;":189,"hamilt;":8459,"hardcy;":1098,"harr;":8596,"harrcir;":10568,"harrw;":8621,"hbar;":8463,"hcirc;":293,"hearts;":9829,"heartsuit;":9829,"hellip;":8230,"hercon;":8889,"hfr;":[55349,56613],"hksearow;":10533,"hkswarow;":10534,"hoarr;":8703,"homtht;":8763,"hookleftarrow;":8617,"hookrightarrow;":8618,"hopf;":[55349,56665],"horbar;":8213,"hscr;":[55349,56509],"hslash;":8463,"hstrok;":295,"hybull;":8259,"hyphen;":8208,iacute:237,"iacute;":237,"ic;":8291,icirc:238,"icirc;":238,"icy;":1080,"iecy;":1077,iexcl:161,"iexcl;":161,"iff;":8660,"ifr;":[55349,56614],igrave:236,"igrave;":236,"ii;":8520,"iiiint;":10764,"iiint;":8749,"iinfin;":10716,"iiota;":8489,"ijlig;":307,"imacr;":299,"image;":8465,"imagline;":8464,"imagpart;":8465,"imath;":305,"imof;":8887,"imped;":437,"in;":8712,"incare;":8453,"infin;":8734,"infintie;":10717,"inodot;":305,"int;":8747,"intcal;":8890,"integers;":8484,"intercal;":8890,"intlarhk;":10775,"intprod;":10812,"iocy;":1105,"iogon;":303,"iopf;":[55349,56666],"iota;":953,"iprod;":10812,iquest:191,"iquest;":191,"iscr;":[55349,56510],"isin;":8712,"isinE;":8953,"isindot;":8949,"isins;":8948,"isinsv;":8947,"isinv;":8712,"it;":8290,"itilde;":297,"iukcy;":1110,iuml:239,"iuml;":239,"jcirc;":309,"jcy;":1081,"jfr;":[55349,56615],"jmath;":567,"jopf;":[55349,56667],"jscr;":[55349,56511],"jsercy;":1112,"jukcy;":1108,"kappa;":954,"kappav;":1008,"kcedil;":311,"kcy;":1082,"kfr;":[55349,56616],"kgreen;":312,"khcy;":1093,"kjcy;":1116,"kopf;":[55349,56668],"kscr;":[55349,56512],"lAarr;":8666,"lArr;":8656,"lAtail;":10523,"lBarr;":10510,"lE;":8806,"lEg;":10891,"lHar;":10594,"lacute;":314,"laemptyv;":10676,"lagran;":8466,"lambda;":955,"lang;":10216,"langd;":10641,"langle;":10216,"lap;":10885,laquo:171,"laquo;":171,"larr;":8592,"larrb;":8676,"larrbfs;":10527,"larrfs;":10525,"larrhk;":8617,"larrlp;":8619,"larrpl;":10553,"larrsim;":10611,"larrtl;":8610,"lat;":10923,"latail;":10521,"late;":10925,"lates;":[10925,65024],"lbarr;":10508,"lbbrk;":10098,"lbrace;":123,"lbrack;":91,"lbrke;":10635,"lbrksld;":10639,"lbrkslu;":10637,"lcaron;":318,"lcedil;":316,"lceil;":8968,"lcub;":123,"lcy;":1083,"ldca;":10550,"ldquo;":8220,"ldquor;":8222,"ldrdhar;":10599,"ldrushar;":10571,"ldsh;":8626,"le;":8804,"leftarrow;":8592,"leftarrowtail;":8610,"leftharpoondown;":8637,"leftharpoonup;":8636,"leftleftarrows;":8647,"leftrightarrow;":8596,"leftrightarrows;":8646,"leftrightharpoons;":8651,"leftrightsquigarrow;":8621,"leftthreetimes;":8907,"leg;":8922,"leq;":8804,"leqq;":8806,"leqslant;":10877,"les;":10877,"lescc;":10920,"lesdot;":10879,"lesdoto;":10881,"lesdotor;":10883,"lesg;":[8922,65024],"lesges;":10899,"lessapprox;":10885,"lessdot;":8918,"lesseqgtr;":8922,"lesseqqgtr;":10891,"lessgtr;":8822,"lesssim;":8818,"lfisht;":10620,"lfloor;":8970,"lfr;":[55349,56617],"lg;":8822,"lgE;":10897,"lhard;":8637,"lharu;":8636,"lharul;":10602,"lhblk;":9604,"ljcy;":1113,"ll;":8810,"llarr;":8647,"llcorner;":8990,"llhard;":10603,"lltri;":9722,"lmidot;":320,"lmoust;":9136,"lmoustache;":9136,"lnE;":8808,"lnap;":10889,"lnapprox;":10889,"lne;":10887,"lneq;":10887,"lneqq;":8808,"lnsim;":8934,"loang;":10220,"loarr;":8701,"lobrk;":10214,"longleftarrow;":10229,"longleftrightarrow;":10231,"longmapsto;":10236,"longrightarrow;":10230,"looparrowleft;":8619,"looparrowright;":8620,"lopar;":10629,"lopf;":[55349,56669],"loplus;":10797,"lotimes;":10804,"lowast;":8727,"lowbar;":95,"loz;":9674,"lozenge;":9674,"lozf;":10731,"lpar;":40,"lparlt;":10643,"lrarr;":8646,"lrcorner;":8991,"lrhar;":8651,"lrhard;":10605,"lrm;":8206,"lrtri;":8895,"lsaquo;":8249,"lscr;":[55349,56513],"lsh;":8624,"lsim;":8818,"lsime;":10893,"lsimg;":10895,"lsqb;":91,"lsquo;":8216,"lsquor;":8218,"lstrok;":322,lt:60,"lt;":60,"ltcc;":10918,"ltcir;":10873,"ltdot;":8918,"lthree;":8907,"ltimes;":8905,"ltlarr;":10614,"ltquest;":10875,"ltrPar;":10646,"ltri;":9667,"ltrie;":8884,"ltrif;":9666,"lurdshar;":10570,"luruhar;":10598,"lvertneqq;":[8808,65024],"lvnE;":[8808,65024],"mDDot;":8762,macr:175,"macr;":175,"male;":9794,"malt;":10016,"maltese;":10016,"map;":8614,"mapsto;":8614,"mapstodown;":8615,"mapstoleft;":8612,"mapstoup;":8613,"marker;":9646,"mcomma;":10793,"mcy;":1084,"mdash;":8212,"measuredangle;":8737,"mfr;":[55349,56618],"mho;":8487,micro:181,"micro;":181,"mid;":8739,"midast;":42,"midcir;":10992,middot:183,"middot;":183,"minus;":8722,"minusb;":8863,"minusd;":8760,"minusdu;":10794,"mlcp;":10971,"mldr;":8230,"mnplus;":8723,"models;":8871,"mopf;":[55349,56670],"mp;":8723,"mscr;":[55349,56514],"mstpos;":8766,"mu;":956,"multimap;":8888,"mumap;":8888,"nGg;":[8921,824],"nGt;":[8811,8402],"nGtv;":[8811,824],"nLeftarrow;":8653,"nLeftrightarrow;":8654,"nLl;":[8920,824],"nLt;":[8810,8402],"nLtv;":[8810,824],"nRightarrow;":8655,"nVDash;":8879,"nVdash;":8878,"nabla;":8711,"nacute;":324,"nang;":[8736,8402],"nap;":8777,"napE;":[10864,824],"napid;":[8779,824],"napos;":329,"napprox;":8777,"natur;":9838,"natural;":9838,"naturals;":8469,nbsp:160,"nbsp;":160,"nbump;":[8782,824],"nbumpe;":[8783,824],"ncap;":10819,"ncaron;":328,"ncedil;":326,"ncong;":8775,"ncongdot;":[10861,824],"ncup;":10818,"ncy;":1085,"ndash;":8211,"ne;":8800,"neArr;":8663,"nearhk;":10532,"nearr;":8599,"nearrow;":8599,"nedot;":[8784,824],"nequiv;":8802,"nesear;":10536,"nesim;":[8770,824],"nexist;":8708,"nexists;":8708,"nfr;":[55349,56619],"ngE;":[8807,824],"nge;":8817,"ngeq;":8817,"ngeqq;":[8807,824],"ngeqslant;":[10878,824],"nges;":[10878,824],"ngsim;":8821,"ngt;":8815,"ngtr;":8815,"nhArr;":8654,"nharr;":8622,"nhpar;":10994,"ni;":8715,"nis;":8956,"nisd;":8954,"niv;":8715,"njcy;":1114,"nlArr;":8653,"nlE;":[8806,824],"nlarr;":8602,"nldr;":8229,"nle;":8816,"nleftarrow;":8602,"nleftrightarrow;":8622,"nleq;":8816,"nleqq;":[8806,824],"nleqslant;":[10877,824],"nles;":[10877,824],"nless;":8814,"nlsim;":8820,"nlt;":8814,"nltri;":8938,"nltrie;":8940,"nmid;":8740,"nopf;":[55349,56671],not:172,"not;":172,"notin;":8713,"notinE;":[8953,824],"notindot;":[8949,824],"notinva;":8713,"notinvb;":8951,"notinvc;":8950,"notni;":8716,"notniva;":8716,"notnivb;":8958,"notnivc;":8957,"npar;":8742,"nparallel;":8742,"nparsl;":[11005,8421],"npart;":[8706,824],"npolint;":10772,"npr;":8832,"nprcue;":8928,"npre;":[10927,824],"nprec;":8832,"npreceq;":[10927,824],"nrArr;":8655,"nrarr;":8603,"nrarrc;":[10547,824],"nrarrw;":[8605,824],"nrightarrow;":8603,"nrtri;":8939,"nrtrie;":8941,"nsc;":8833,"nsccue;":8929,"nsce;":[10928,824],"nscr;":[55349,56515],"nshortmid;":8740,"nshortparallel;":8742,"nsim;":8769,"nsime;":8772,"nsimeq;":8772,"nsmid;":8740,"nspar;":8742,"nsqsube;":8930,"nsqsupe;":8931,"nsub;":8836,"nsubE;":[10949,824],"nsube;":8840,"nsubset;":[8834,8402],"nsubseteq;":8840,"nsubseteqq;":[10949,824],"nsucc;":8833,"nsucceq;":[10928,824],"nsup;":8837,"nsupE;":[10950,824],"nsupe;":8841,"nsupset;":[8835,8402],"nsupseteq;":8841,"nsupseteqq;":[10950,824],"ntgl;":8825,ntilde:241,"ntilde;":241,"ntlg;":8824,"ntriangleleft;":8938,"ntrianglelefteq;":8940,"ntriangleright;":8939,"ntrianglerighteq;":8941,"nu;":957,"num;":35,"numero;":8470,"numsp;":8199,"nvDash;":8877,"nvHarr;":10500,"nvap;":[8781,8402],"nvdash;":8876,"nvge;":[8805,8402],"nvgt;":[62,8402],"nvinfin;":10718,"nvlArr;":10498,"nvle;":[8804,8402],"nvlt;":[60,8402],"nvltrie;":[8884,8402],"nvrArr;":10499,"nvrtrie;":[8885,8402],"nvsim;":[8764,8402],"nwArr;":8662,"nwarhk;":10531,"nwarr;":8598,"nwarrow;":8598,"nwnear;":10535,"oS;":9416,oacute:243,"oacute;":243,"oast;":8859,"ocir;":8858,ocirc:244,"ocirc;":244,"ocy;":1086,"odash;":8861,"odblac;":337,"odiv;":10808,"odot;":8857,"odsold;":10684,"oelig;":339,"ofcir;":10687,"ofr;":[55349,56620],"ogon;":731,ograve:242,"ograve;":242,"ogt;":10689,"ohbar;":10677,"ohm;":937,"oint;":8750,"olarr;":8634,"olcir;":10686,"olcross;":10683,"oline;":8254,"olt;":10688,"omacr;":333,"omega;":969,"omicron;":959,"omid;":10678,"ominus;":8854,"oopf;":[55349,56672],"opar;":10679,"operp;":10681,"oplus;":8853,"or;":8744,"orarr;":8635,"ord;":10845,"order;":8500,"orderof;":8500,ordf:170,"ordf;":170,ordm:186,"ordm;":186,"origof;":8886,"oror;":10838,"orslope;":10839,"orv;":10843,"oscr;":8500,oslash:248,"oslash;":248,"osol;":8856,otilde:245,"otilde;":245,"otimes;":8855,"otimesas;":10806,ouml:246,"ouml;":246,"ovbar;":9021,"par;":8741,para:182,"para;":182,"parallel;":8741,"parsim;":10995,"parsl;":11005,"part;":8706,"pcy;":1087,"percnt;":37,"period;":46,"permil;":8240,"perp;":8869,"pertenk;":8241,"pfr;":[55349,56621],"phi;":966,"phiv;":981,"phmmat;":8499,"phone;":9742,"pi;":960,"pitchfork;":8916,"piv;":982,"planck;":8463,"planckh;":8462,"plankv;":8463,"plus;":43,"plusacir;":10787,"plusb;":8862,"pluscir;":10786,"plusdo;":8724,"plusdu;":10789,"pluse;":10866,plusmn:177,"plusmn;":177,"plussim;":10790,"plustwo;":10791,"pm;":177,"pointint;":10773,"popf;":[55349,56673],pound:163,"pound;":163,"pr;":8826,"prE;":10931,"prap;":10935,"prcue;":8828,"pre;":10927,"prec;":8826,"precapprox;":10935,"preccurlyeq;":8828,"preceq;":10927,"precnapprox;":10937,"precneqq;":10933,"precnsim;":8936,"precsim;":8830,"prime;":8242,"primes;":8473,"prnE;":10933,"prnap;":10937,"prnsim;":8936,"prod;":8719,"profalar;":9006,"profline;":8978,"profsurf;":8979,"prop;":8733,"propto;":8733,"prsim;":8830,"prurel;":8880,"pscr;":[55349,56517],"psi;":968,"puncsp;":8200,"qfr;":[55349,56622],"qint;":10764,"qopf;":[55349,56674],"qprime;":8279,"qscr;":[55349,56518],"quaternions;":8461,"quatint;":10774,"quest;":63,"questeq;":8799,quot:34,"quot;":34,"rAarr;":8667,"rArr;":8658,"rAtail;":10524,"rBarr;":10511,"rHar;":10596,"race;":[8765,817],"racute;":341,"radic;":8730,"raemptyv;":10675,"rang;":10217,"rangd;":10642,"range;":10661,"rangle;":10217,raquo:187,"raquo;":187,"rarr;":8594,"rarrap;":10613,"rarrb;":8677,"rarrbfs;":10528,"rarrc;":10547,"rarrfs;":10526,"rarrhk;":8618,"rarrlp;":8620,"rarrpl;":10565,"rarrsim;":10612,"rarrtl;":8611,"rarrw;":8605,"ratail;":10522,"ratio;":8758,"rationals;":8474,"rbarr;":10509,"rbbrk;":10099,"rbrace;":125,"rbrack;":93,"rbrke;":10636,"rbrksld;":10638,"rbrkslu;":10640,"rcaron;":345,"rcedil;":343,"rceil;":8969,"rcub;":125,"rcy;":1088,"rdca;":10551,"rdldhar;":10601,"rdquo;":8221,"rdquor;":8221,"rdsh;":8627,"real;":8476,"realine;":8475,"realpart;":8476,"reals;":8477,"rect;":9645,reg:174,"reg;":174,"rfisht;":10621,"rfloor;":8971,"rfr;":[55349,56623],"rhard;":8641,"rharu;":8640,"rharul;":10604,"rho;":961,"rhov;":1009,"rightarrow;":8594,"rightarrowtail;":8611,"rightharpoondown;":8641,"rightharpoonup;":8640,"rightleftarrows;":8644,"rightleftharpoons;":8652,"rightrightarrows;":8649,"rightsquigarrow;":8605,"rightthreetimes;":8908,"ring;":730,"risingdotseq;":8787,"rlarr;":8644,"rlhar;":8652,"rlm;":8207,"rmoust;":9137,"rmoustache;":9137,"rnmid;":10990,"roang;":10221,"roarr;":8702,"robrk;":10215,"ropar;":10630,"ropf;":[55349,56675],"roplus;":10798,"rotimes;":10805,"rpar;":41,"rpargt;":10644,"rppolint;":10770,"rrarr;":8649,"rsaquo;":8250,"rscr;":[55349,56519],"rsh;":8625,"rsqb;":93,"rsquo;":8217,"rsquor;":8217,"rthree;":8908,"rtimes;":8906,"rtri;":9657,"rtrie;":8885,"rtrif;":9656,"rtriltri;":10702,"ruluhar;":10600,"rx;":8478,"sacute;":347,"sbquo;":8218,"sc;":8827,"scE;":10932,"scap;":10936,"scaron;":353,"sccue;":8829,"sce;":10928,"scedil;":351,"scirc;":349,"scnE;":10934,"scnap;":10938,"scnsim;":8937,"scpolint;":10771,"scsim;":8831,"scy;":1089,"sdot;":8901,"sdotb;":8865,"sdote;":10854,"seArr;":8664,"searhk;":10533,"searr;":8600,"searrow;":8600,sect:167,"sect;":167,"semi;":59,"seswar;":10537,"setminus;":8726,"setmn;":8726,"sext;":10038,"sfr;":[55349,56624],"sfrown;":8994,"sharp;":9839,"shchcy;":1097,"shcy;":1096,"shortmid;":8739,"shortparallel;":8741,shy:173,"shy;":173,"sigma;":963,"sigmaf;":962,"sigmav;":962,"sim;":8764,"simdot;":10858,"sime;":8771,"simeq;":8771,"simg;":10910,"simgE;":10912,"siml;":10909,"simlE;":10911,"simne;":8774,"simplus;":10788,"simrarr;":10610,"slarr;":8592,"smallsetminus;":8726,"smashp;":10803,"smeparsl;":10724,"smid;":8739,"smile;":8995,"smt;":10922,"smte;":10924,"smtes;":[10924,65024],"softcy;":1100,"sol;":47,"solb;":10692,"solbar;":9023,"sopf;":[55349,56676],"spades;":9824,"spadesuit;":9824,"spar;":8741,"sqcap;":8851,"sqcaps;":[8851,65024],"sqcup;":8852,"sqcups;":[8852,65024],"sqsub;":8847,"sqsube;":8849,"sqsubset;":8847,"sqsubseteq;":8849,"sqsup;":8848,"sqsupe;":8850,"sqsupset;":8848,"sqsupseteq;":8850,"squ;":9633,"square;":9633,"squarf;":9642,"squf;":9642,"srarr;":8594,"sscr;":[55349,56520],"ssetmn;":8726,"ssmile;":8995,"sstarf;":8902,"star;":9734,"starf;":9733,"straightepsilon;":1013,"straightphi;":981,"strns;":175,"sub;":8834,"subE;":10949,"subdot;":10941,"sube;":8838,"subedot;":10947,"submult;":10945,"subnE;":10955,"subne;":8842,"subplus;":10943,"subrarr;":10617,"subset;":8834,"subseteq;":8838,"subseteqq;":10949,"subsetneq;":8842,"subsetneqq;":10955,"subsim;":10951,"subsub;":10965,"subsup;":10963,"succ;":8827,"succapprox;":10936,"succcurlyeq;":8829,"succeq;":10928,"succnapprox;":10938,"succneqq;":10934,"succnsim;":8937,"succsim;":8831,"sum;":8721,"sung;":9834,sup1:185,"sup1;":185,sup2:178,"sup2;":178,sup3:179,"sup3;":179,"sup;":8835,"supE;":10950,"supdot;":10942,"supdsub;":10968,"supe;":8839,"supedot;":10948,"suphsol;":10185,"suphsub;":10967,"suplarr;":10619,"supmult;":10946,"supnE;":10956,"supne;":8843,"supplus;":10944,"supset;":8835,"supseteq;":8839,"supseteqq;":10950,"supsetneq;":8843,"supsetneqq;":10956,"supsim;":10952,"supsub;":10964,"supsup;":10966,"swArr;":8665,"swarhk;":10534,"swarr;":8601,"swarrow;":8601,"swnwar;":10538,szlig:223,"szlig;":223,"target;":8982,"tau;":964,"tbrk;":9140,"tcaron;":357,"tcedil;":355,"tcy;":1090,"tdot;":8411,"telrec;":8981,"tfr;":[55349,56625],"there4;":8756,"therefore;":8756,"theta;":952,"thetasym;":977,"thetav;":977,"thickapprox;":8776,"thicksim;":8764,"thinsp;":8201,"thkap;":8776,"thksim;":8764,thorn:254,"thorn;":254,"tilde;":732,times:215,"times;":215,"timesb;":8864,"timesbar;":10801,"timesd;":10800,"tint;":8749,"toea;":10536,"top;":8868,"topbot;":9014,"topcir;":10993,"topf;":[55349,56677],"topfork;":10970,"tosa;":10537,"tprime;":8244,"trade;":8482,"triangle;":9653,"triangledown;":9663,"triangleleft;":9667,"trianglelefteq;":8884,"triangleq;":8796,"triangleright;":9657,"trianglerighteq;":8885,"tridot;":9708,"trie;":8796,"triminus;":10810,"triplus;":10809,"trisb;":10701,"tritime;":10811,"trpezium;":9186,"tscr;":[55349,56521],"tscy;":1094,"tshcy;":1115,"tstrok;":359,"twixt;":8812,"twoheadleftarrow;":8606,"twoheadrightarrow;":8608,"uArr;":8657,"uHar;":10595,uacute:250,"uacute;":250,"uarr;":8593,"ubrcy;":1118,"ubreve;":365,ucirc:251,"ucirc;":251,"ucy;":1091,"udarr;":8645,"udblac;":369,"udhar;":10606,"ufisht;":10622,"ufr;":[55349,56626],ugrave:249,"ugrave;":249,"uharl;":8639,"uharr;":8638,"uhblk;":9600,"ulcorn;":8988,"ulcorner;":8988,"ulcrop;":8975,"ultri;":9720,"umacr;":363,uml:168,"uml;":168,"uogon;":371,"uopf;":[55349,56678],"uparrow;":8593,"updownarrow;":8597,"upharpoonleft;":8639,"upharpoonright;":8638,"uplus;":8846,"upsi;":965,"upsih;":978,"upsilon;":965,"upuparrows;":8648,"urcorn;":8989,"urcorner;":8989,"urcrop;":8974,"uring;":367,"urtri;":9721,"uscr;":[55349,56522],"utdot;":8944,"utilde;":361,"utri;":9653,"utrif;":9652,"uuarr;":8648,uuml:252,"uuml;":252,"uwangle;":10663,"vArr;":8661,"vBar;":10984,"vBarv;":10985,"vDash;":8872,"vangrt;":10652,"varepsilon;":1013,"varkappa;":1008,"varnothing;":8709,"varphi;":981,"varpi;":982,"varpropto;":8733,"varr;":8597,"varrho;":1009,"varsigma;":962,"varsubsetneq;":[8842,65024],"varsubsetneqq;":[10955,65024],"varsupsetneq;":[8843,65024],"varsupsetneqq;":[10956,65024],"vartheta;":977,"vartriangleleft;":8882,"vartriangleright;":8883,"vcy;":1074,"vdash;":8866,"vee;":8744,"veebar;":8891,"veeeq;":8794,"vellip;":8942,"verbar;":124,"vert;":124,"vfr;":[55349,56627],"vltri;":8882,"vnsub;":[8834,8402],"vnsup;":[8835,8402],"vopf;":[55349,56679],"vprop;":8733,"vrtri;":8883,"vscr;":[55349,56523],"vsubnE;":[10955,65024],"vsubne;":[8842,65024],"vsupnE;":[10956,65024],"vsupne;":[8843,65024],"vzigzag;":10650,"wcirc;":373,"wedbar;":10847,"wedge;":8743,"wedgeq;":8793,"weierp;":8472,"wfr;":[55349,56628],"wopf;":[55349,56680],"wp;":8472,"wr;":8768,"wreath;":8768,"wscr;":[55349,56524],"xcap;":8898,"xcirc;":9711,"xcup;":8899,"xdtri;":9661,"xfr;":[55349,56629],"xhArr;":10234,"xharr;":10231,"xi;":958,"xlArr;":10232,"xlarr;":10229,"xmap;":10236,"xnis;":8955,"xodot;":10752,"xopf;":[55349,56681],"xoplus;":10753,"xotime;":10754,"xrArr;":10233,"xrarr;":10230,"xscr;":[55349,56525],"xsqcup;":10758,"xuplus;":10756,"xutri;":9651,"xvee;":8897,"xwedge;":8896,yacute:253,"yacute;":253,"yacy;":1103,"ycirc;":375,"ycy;":1099,yen:165,"yen;":165,"yfr;":[55349,56630],"yicy;":1111,"yopf;":[55349,56682],"yscr;":[55349,56526],"yucy;":1102,yuml:255,"yuml;":255,"zacute;":378,"zcaron;":382,"zcy;":1079,"zdot;":380,"zeetrf;":8488,"zeta;":950,"zfr;":[55349,56631],"zhcy;":1078,"zigrarr;":8669,"zopf;":[55349,56683],"zscr;":[55349,56527],"zwj;":8205,"zwnj;":8204},Oo=/(A(?:Elig;?|MP;?|acute;?|breve;|c(?:irc;?|y;)|fr;|grave;?|lpha;|macr;|nd;|o(?:gon;|pf;)|pplyFunction;|ring;?|s(?:cr;|sign;)|tilde;?|uml;?)|B(?:a(?:ckslash;|r(?:v;|wed;))|cy;|e(?:cause;|rnoullis;|ta;)|fr;|opf;|reve;|scr;|umpeq;)|C(?:Hcy;|OPY;?|a(?:cute;|p(?:;|italDifferentialD;)|yleys;)|c(?:aron;|edil;?|irc;|onint;)|dot;|e(?:dilla;|nterDot;)|fr;|hi;|ircle(?:Dot;|Minus;|Plus;|Times;)|lo(?:ckwiseContourIntegral;|seCurly(?:DoubleQuote;|Quote;))|o(?:lon(?:;|e;)|n(?:gruent;|int;|tourIntegral;)|p(?:f;|roduct;)|unterClockwiseContourIntegral;)|ross;|scr;|up(?:;|Cap;))|D(?:D(?:;|otrahd;)|Jcy;|Scy;|Zcy;|a(?:gger;|rr;|shv;)|c(?:aron;|y;)|el(?:;|ta;)|fr;|i(?:a(?:critical(?:Acute;|Do(?:t;|ubleAcute;)|Grave;|Tilde;)|mond;)|fferentialD;)|o(?:pf;|t(?:;|Dot;|Equal;)|uble(?:ContourIntegral;|Do(?:t;|wnArrow;)|L(?:eft(?:Arrow;|RightArrow;|Tee;)|ong(?:Left(?:Arrow;|RightArrow;)|RightArrow;))|Right(?:Arrow;|Tee;)|Up(?:Arrow;|DownArrow;)|VerticalBar;)|wn(?:Arrow(?:;|Bar;|UpArrow;)|Breve;|Left(?:RightVector;|TeeVector;|Vector(?:;|Bar;))|Right(?:TeeVector;|Vector(?:;|Bar;))|Tee(?:;|Arrow;)|arrow;))|s(?:cr;|trok;))|E(?:NG;|TH;?|acute;?|c(?:aron;|irc;?|y;)|dot;|fr;|grave;?|lement;|m(?:acr;|pty(?:SmallSquare;|VerySmallSquare;))|o(?:gon;|pf;)|psilon;|qu(?:al(?:;|Tilde;)|ilibrium;)|s(?:cr;|im;)|ta;|uml;?|x(?:ists;|ponentialE;))|F(?:cy;|fr;|illed(?:SmallSquare;|VerySmallSquare;)|o(?:pf;|rAll;|uriertrf;)|scr;)|G(?:Jcy;|T;?|amma(?:;|d;)|breve;|c(?:edil;|irc;|y;)|dot;|fr;|g;|opf;|reater(?:Equal(?:;|Less;)|FullEqual;|Greater;|Less;|SlantEqual;|Tilde;)|scr;|t;)|H(?:ARDcy;|a(?:cek;|t;)|circ;|fr;|ilbertSpace;|o(?:pf;|rizontalLine;)|s(?:cr;|trok;)|ump(?:DownHump;|Equal;))|I(?:Ecy;|Jlig;|Ocy;|acute;?|c(?:irc;?|y;)|dot;|fr;|grave;?|m(?:;|a(?:cr;|ginaryI;)|plies;)|n(?:t(?:;|e(?:gral;|rsection;))|visible(?:Comma;|Times;))|o(?:gon;|pf;|ta;)|scr;|tilde;|u(?:kcy;|ml;?))|J(?:c(?:irc;|y;)|fr;|opf;|s(?:cr;|ercy;)|ukcy;)|K(?:Hcy;|Jcy;|appa;|c(?:edil;|y;)|fr;|opf;|scr;)|L(?:Jcy;|T;?|a(?:cute;|mbda;|ng;|placetrf;|rr;)|c(?:aron;|edil;|y;)|e(?:ft(?:A(?:ngleBracket;|rrow(?:;|Bar;|RightArrow;))|Ceiling;|Do(?:ubleBracket;|wn(?:TeeVector;|Vector(?:;|Bar;)))|Floor;|Right(?:Arrow;|Vector;)|T(?:ee(?:;|Arrow;|Vector;)|riangle(?:;|Bar;|Equal;))|Up(?:DownVector;|TeeVector;|Vector(?:;|Bar;))|Vector(?:;|Bar;)|arrow;|rightarrow;)|ss(?:EqualGreater;|FullEqual;|Greater;|Less;|SlantEqual;|Tilde;))|fr;|l(?:;|eftarrow;)|midot;|o(?:ng(?:Left(?:Arrow;|RightArrow;)|RightArrow;|left(?:arrow;|rightarrow;)|rightarrow;)|pf;|wer(?:LeftArrow;|RightArrow;))|s(?:cr;|h;|trok;)|t;)|M(?:ap;|cy;|e(?:diumSpace;|llintrf;)|fr;|inusPlus;|opf;|scr;|u;)|N(?:Jcy;|acute;|c(?:aron;|edil;|y;)|e(?:gative(?:MediumSpace;|Thi(?:ckSpace;|nSpace;)|VeryThinSpace;)|sted(?:GreaterGreater;|LessLess;)|wLine;)|fr;|o(?:Break;|nBreakingSpace;|pf;|t(?:;|C(?:ongruent;|upCap;)|DoubleVerticalBar;|E(?:lement;|qual(?:;|Tilde;)|xists;)|Greater(?:;|Equal;|FullEqual;|Greater;|Less;|SlantEqual;|Tilde;)|Hump(?:DownHump;|Equal;)|Le(?:ftTriangle(?:;|Bar;|Equal;)|ss(?:;|Equal;|Greater;|Less;|SlantEqual;|Tilde;))|Nested(?:GreaterGreater;|LessLess;)|Precedes(?:;|Equal;|SlantEqual;)|R(?:everseElement;|ightTriangle(?:;|Bar;|Equal;))|S(?:quareSu(?:bset(?:;|Equal;)|perset(?:;|Equal;))|u(?:bset(?:;|Equal;)|cceeds(?:;|Equal;|SlantEqual;|Tilde;)|perset(?:;|Equal;)))|Tilde(?:;|Equal;|FullEqual;|Tilde;)|VerticalBar;))|scr;|tilde;?|u;)|O(?:Elig;|acute;?|c(?:irc;?|y;)|dblac;|fr;|grave;?|m(?:acr;|ega;|icron;)|opf;|penCurly(?:DoubleQuote;|Quote;)|r;|s(?:cr;|lash;?)|ti(?:lde;?|mes;)|uml;?|ver(?:B(?:ar;|rac(?:e;|ket;))|Parenthesis;))|P(?:artialD;|cy;|fr;|hi;|i;|lusMinus;|o(?:incareplane;|pf;)|r(?:;|ecedes(?:;|Equal;|SlantEqual;|Tilde;)|ime;|o(?:duct;|portion(?:;|al;)))|s(?:cr;|i;))|Q(?:UOT;?|fr;|opf;|scr;)|R(?:Barr;|EG;?|a(?:cute;|ng;|rr(?:;|tl;))|c(?:aron;|edil;|y;)|e(?:;|verse(?:E(?:lement;|quilibrium;)|UpEquilibrium;))|fr;|ho;|ight(?:A(?:ngleBracket;|rrow(?:;|Bar;|LeftArrow;))|Ceiling;|Do(?:ubleBracket;|wn(?:TeeVector;|Vector(?:;|Bar;)))|Floor;|T(?:ee(?:;|Arrow;|Vector;)|riangle(?:;|Bar;|Equal;))|Up(?:DownVector;|TeeVector;|Vector(?:;|Bar;))|Vector(?:;|Bar;)|arrow;)|o(?:pf;|undImplies;)|rightarrow;|s(?:cr;|h;)|uleDelayed;)|S(?:H(?:CHcy;|cy;)|OFTcy;|acute;|c(?:;|aron;|edil;|irc;|y;)|fr;|hort(?:DownArrow;|LeftArrow;|RightArrow;|UpArrow;)|igma;|mallCircle;|opf;|q(?:rt;|uare(?:;|Intersection;|Su(?:bset(?:;|Equal;)|perset(?:;|Equal;))|Union;))|scr;|tar;|u(?:b(?:;|set(?:;|Equal;))|c(?:ceeds(?:;|Equal;|SlantEqual;|Tilde;)|hThat;)|m;|p(?:;|erset(?:;|Equal;)|set;)))|T(?:HORN;?|RADE;|S(?:Hcy;|cy;)|a(?:b;|u;)|c(?:aron;|edil;|y;)|fr;|h(?:e(?:refore;|ta;)|i(?:ckSpace;|nSpace;))|ilde(?:;|Equal;|FullEqual;|Tilde;)|opf;|ripleDot;|s(?:cr;|trok;))|U(?:a(?:cute;?|rr(?:;|ocir;))|br(?:cy;|eve;)|c(?:irc;?|y;)|dblac;|fr;|grave;?|macr;|n(?:der(?:B(?:ar;|rac(?:e;|ket;))|Parenthesis;)|ion(?:;|Plus;))|o(?:gon;|pf;)|p(?:Arrow(?:;|Bar;|DownArrow;)|DownArrow;|Equilibrium;|Tee(?:;|Arrow;)|arrow;|downarrow;|per(?:LeftArrow;|RightArrow;)|si(?:;|lon;))|ring;|scr;|tilde;|uml;?)|V(?:Dash;|bar;|cy;|dash(?:;|l;)|e(?:e;|r(?:bar;|t(?:;|ical(?:Bar;|Line;|Separator;|Tilde;))|yThinSpace;))|fr;|opf;|scr;|vdash;)|W(?:circ;|edge;|fr;|opf;|scr;)|X(?:fr;|i;|opf;|scr;)|Y(?:Acy;|Icy;|Ucy;|acute;?|c(?:irc;|y;)|fr;|opf;|scr;|uml;)|Z(?:Hcy;|acute;|c(?:aron;|y;)|dot;|e(?:roWidthSpace;|ta;)|fr;|opf;|scr;)|a(?:acute;?|breve;|c(?:;|E;|d;|irc;?|ute;?|y;)|elig;?|f(?:;|r;)|grave;?|l(?:e(?:fsym;|ph;)|pha;)|m(?:a(?:cr;|lg;)|p;?)|n(?:d(?:;|and;|d;|slope;|v;)|g(?:;|e;|le;|msd(?:;|a(?:a;|b;|c;|d;|e;|f;|g;|h;))|rt(?:;|vb(?:;|d;))|s(?:ph;|t;)|zarr;))|o(?:gon;|pf;)|p(?:;|E;|acir;|e;|id;|os;|prox(?:;|eq;))|ring;?|s(?:cr;|t;|ymp(?:;|eq;))|tilde;?|uml;?|w(?:conint;|int;))|b(?:Not;|a(?:ck(?:cong;|epsilon;|prime;|sim(?:;|eq;))|r(?:vee;|wed(?:;|ge;)))|brk(?:;|tbrk;)|c(?:ong;|y;)|dquo;|e(?:caus(?:;|e;)|mptyv;|psi;|rnou;|t(?:a;|h;|ween;))|fr;|ig(?:c(?:ap;|irc;|up;)|o(?:dot;|plus;|times;)|s(?:qcup;|tar;)|triangle(?:down;|up;)|uplus;|vee;|wedge;)|karow;|l(?:a(?:ck(?:lozenge;|square;|triangle(?:;|down;|left;|right;))|nk;)|k(?:1(?:2;|4;)|34;)|ock;)|n(?:e(?:;|quiv;)|ot;)|o(?:pf;|t(?:;|tom;)|wtie;|x(?:D(?:L;|R;|l;|r;)|H(?:;|D;|U;|d;|u;)|U(?:L;|R;|l;|r;)|V(?:;|H;|L;|R;|h;|l;|r;)|box;|d(?:L;|R;|l;|r;)|h(?:;|D;|U;|d;|u;)|minus;|plus;|times;|u(?:L;|R;|l;|r;)|v(?:;|H;|L;|R;|h;|l;|r;)))|prime;|r(?:eve;|vbar;?)|s(?:cr;|emi;|im(?:;|e;)|ol(?:;|b;|hsub;))|u(?:ll(?:;|et;)|mp(?:;|E;|e(?:;|q;))))|c(?:a(?:cute;|p(?:;|and;|brcup;|c(?:ap;|up;)|dot;|s;)|r(?:et;|on;))|c(?:a(?:ps;|ron;)|edil;?|irc;|ups(?:;|sm;))|dot;|e(?:dil;?|mptyv;|nt(?:;|erdot;|))|fr;|h(?:cy;|eck(?:;|mark;)|i;)|ir(?:;|E;|c(?:;|eq;|le(?:arrow(?:left;|right;)|d(?:R;|S;|ast;|circ;|dash;)))|e;|fnint;|mid;|scir;)|lubs(?:;|uit;)|o(?:lon(?:;|e(?:;|q;))|m(?:ma(?:;|t;)|p(?:;|fn;|le(?:ment;|xes;)))|n(?:g(?:;|dot;)|int;)|p(?:f;|rod;|y(?:;|sr;|)))|r(?:arr;|oss;)|s(?:cr;|u(?:b(?:;|e;)|p(?:;|e;)))|tdot;|u(?:darr(?:l;|r;)|e(?:pr;|sc;)|larr(?:;|p;)|p(?:;|brcap;|c(?:ap;|up;)|dot;|or;|s;)|r(?:arr(?:;|m;)|ly(?:eq(?:prec;|succ;)|vee;|wedge;)|ren;?|vearrow(?:left;|right;))|vee;|wed;)|w(?:conint;|int;)|ylcty;)|d(?:Arr;|Har;|a(?:gger;|leth;|rr;|sh(?:;|v;))|b(?:karow;|lac;)|c(?:aron;|y;)|d(?:;|a(?:gger;|rr;)|otseq;)|e(?:g;?|lta;|mptyv;)|f(?:isht;|r;)|har(?:l;|r;)|i(?:am(?:;|ond(?:;|suit;)|s;)|e;|gamma;|sin;|v(?:;|ide(?:;|ontimes;|)|onx;))|jcy;|lc(?:orn;|rop;)|o(?:llar;|pf;|t(?:;|eq(?:;|dot;)|minus;|plus;|square;)|ublebarwedge;|wn(?:arrow;|downarrows;|harpoon(?:left;|right;)))|r(?:bkarow;|c(?:orn;|rop;))|s(?:c(?:r;|y;)|ol;|trok;)|t(?:dot;|ri(?:;|f;))|u(?:arr;|har;)|wangle;|z(?:cy;|igrarr;))|e(?:D(?:Dot;|ot;)|a(?:cute;?|ster;)|c(?:aron;|ir(?:;|c;?)|olon;|y;)|dot;|e;|f(?:Dot;|r;)|g(?:;|rave;?|s(?:;|dot;))|l(?:;|inters;|l;|s(?:;|dot;))|m(?:acr;|pty(?:;|set;|v;)|sp(?:1(?:3;|4;)|;))|n(?:g;|sp;)|o(?:gon;|pf;)|p(?:ar(?:;|sl;)|lus;|si(?:;|lon;|v;))|q(?:c(?:irc;|olon;)|s(?:im;|lant(?:gtr;|less;))|u(?:als;|est;|iv(?:;|DD;))|vparsl;)|r(?:Dot;|arr;)|s(?:cr;|dot;|im;)|t(?:a;|h;?)|u(?:ml;?|ro;)|x(?:cl;|ist;|p(?:ectation;|onentiale;)))|f(?:allingdotseq;|cy;|emale;|f(?:ilig;|l(?:ig;|lig;)|r;)|ilig;|jlig;|l(?:at;|lig;|tns;)|nof;|o(?:pf;|r(?:all;|k(?:;|v;)))|partint;|r(?:a(?:c(?:1(?:2;?|3;|4;?|5;|6;|8;)|2(?:3;|5;)|3(?:4;?|5;|8;)|45;|5(?:6;|8;)|78;)|sl;)|own;)|scr;)|g(?:E(?:;|l;)|a(?:cute;|mma(?:;|d;)|p;)|breve;|c(?:irc;|y;)|dot;|e(?:;|l;|q(?:;|q;|slant;)|s(?:;|cc;|dot(?:;|o(?:;|l;))|l(?:;|es;)))|fr;|g(?:;|g;)|imel;|jcy;|l(?:;|E;|a;|j;)|n(?:E;|ap(?:;|prox;)|e(?:;|q(?:;|q;))|sim;)|opf;|rave;|s(?:cr;|im(?:;|e;|l;))|t(?:;|c(?:c;|ir;)|dot;|lPar;|quest;|r(?:a(?:pprox;|rr;)|dot;|eq(?:less;|qless;)|less;|sim;)|)|v(?:ertneqq;|nE;))|h(?:Arr;|a(?:irsp;|lf;|milt;|r(?:dcy;|r(?:;|cir;|w;)))|bar;|circ;|e(?:arts(?:;|uit;)|llip;|rcon;)|fr;|ks(?:earow;|warow;)|o(?:arr;|mtht;|ok(?:leftarrow;|rightarrow;)|pf;|rbar;)|s(?:cr;|lash;|trok;)|y(?:bull;|phen;))|i(?:acute;?|c(?:;|irc;?|y;)|e(?:cy;|xcl;?)|f(?:f;|r;)|grave;?|i(?:;|i(?:int;|nt;)|nfin;|ota;)|jlig;|m(?:a(?:cr;|g(?:e;|line;|part;)|th;)|of;|ped;)|n(?:;|care;|fin(?:;|tie;)|odot;|t(?:;|cal;|e(?:gers;|rcal;)|larhk;|prod;))|o(?:cy;|gon;|pf;|ta;)|prod;|quest;?|s(?:cr;|in(?:;|E;|dot;|s(?:;|v;)|v;))|t(?:;|ilde;)|u(?:kcy;|ml;?))|j(?:c(?:irc;|y;)|fr;|math;|opf;|s(?:cr;|ercy;)|ukcy;)|k(?:appa(?:;|v;)|c(?:edil;|y;)|fr;|green;|hcy;|jcy;|opf;|scr;)|l(?:A(?:arr;|rr;|tail;)|Barr;|E(?:;|g;)|Har;|a(?:cute;|emptyv;|gran;|mbda;|ng(?:;|d;|le;)|p;|quo;?|rr(?:;|b(?:;|fs;)|fs;|hk;|lp;|pl;|sim;|tl;)|t(?:;|ail;|e(?:;|s;)))|b(?:arr;|brk;|r(?:ac(?:e;|k;)|k(?:e;|sl(?:d;|u;))))|c(?:aron;|e(?:dil;|il;)|ub;|y;)|d(?:ca;|quo(?:;|r;)|r(?:dhar;|ushar;)|sh;)|e(?:;|ft(?:arrow(?:;|tail;)|harpoon(?:down;|up;)|leftarrows;|right(?:arrow(?:;|s;)|harpoons;|squigarrow;)|threetimes;)|g;|q(?:;|q;|slant;)|s(?:;|cc;|dot(?:;|o(?:;|r;))|g(?:;|es;)|s(?:approx;|dot;|eq(?:gtr;|qgtr;)|gtr;|sim;)))|f(?:isht;|loor;|r;)|g(?:;|E;)|h(?:ar(?:d;|u(?:;|l;))|blk;)|jcy;|l(?:;|arr;|corner;|hard;|tri;)|m(?:idot;|oust(?:;|ache;))|n(?:E;|ap(?:;|prox;)|e(?:;|q(?:;|q;))|sim;)|o(?:a(?:ng;|rr;)|brk;|ng(?:left(?:arrow;|rightarrow;)|mapsto;|rightarrow;)|oparrow(?:left;|right;)|p(?:ar;|f;|lus;)|times;|w(?:ast;|bar;)|z(?:;|enge;|f;))|par(?:;|lt;)|r(?:arr;|corner;|har(?:;|d;)|m;|tri;)|s(?:aquo;|cr;|h;|im(?:;|e;|g;)|q(?:b;|uo(?:;|r;))|trok;)|t(?:;|c(?:c;|ir;)|dot;|hree;|imes;|larr;|quest;|r(?:Par;|i(?:;|e;|f;))|)|ur(?:dshar;|uhar;)|v(?:ertneqq;|nE;))|m(?:DDot;|a(?:cr;?|l(?:e;|t(?:;|ese;))|p(?:;|sto(?:;|down;|left;|up;))|rker;)|c(?:omma;|y;)|dash;|easuredangle;|fr;|ho;|i(?:cro;?|d(?:;|ast;|cir;|dot;?)|nus(?:;|b;|d(?:;|u;)))|l(?:cp;|dr;)|nplus;|o(?:dels;|pf;)|p;|s(?:cr;|tpos;)|u(?:;|ltimap;|map;))|n(?:G(?:g;|t(?:;|v;))|L(?:eft(?:arrow;|rightarrow;)|l;|t(?:;|v;))|Rightarrow;|V(?:Dash;|dash;)|a(?:bla;|cute;|ng;|p(?:;|E;|id;|os;|prox;)|tur(?:;|al(?:;|s;)))|b(?:sp;?|ump(?:;|e;))|c(?:a(?:p;|ron;)|edil;|ong(?:;|dot;)|up;|y;)|dash;|e(?:;|Arr;|ar(?:hk;|r(?:;|ow;))|dot;|quiv;|s(?:ear;|im;)|xist(?:;|s;))|fr;|g(?:E;|e(?:;|q(?:;|q;|slant;)|s;)|sim;|t(?:;|r;))|h(?:Arr;|arr;|par;)|i(?:;|s(?:;|d;)|v;)|jcy;|l(?:Arr;|E;|arr;|dr;|e(?:;|ft(?:arrow;|rightarrow;)|q(?:;|q;|slant;)|s(?:;|s;))|sim;|t(?:;|ri(?:;|e;)))|mid;|o(?:pf;|t(?:;|in(?:;|E;|dot;|v(?:a;|b;|c;))|ni(?:;|v(?:a;|b;|c;))|))|p(?:ar(?:;|allel;|sl;|t;)|olint;|r(?:;|cue;|e(?:;|c(?:;|eq;))))|r(?:Arr;|arr(?:;|c;|w;)|ightarrow;|tri(?:;|e;))|s(?:c(?:;|cue;|e;|r;)|hort(?:mid;|parallel;)|im(?:;|e(?:;|q;))|mid;|par;|qsu(?:be;|pe;)|u(?:b(?:;|E;|e;|set(?:;|eq(?:;|q;)))|cc(?:;|eq;)|p(?:;|E;|e;|set(?:;|eq(?:;|q;)))))|t(?:gl;|ilde;?|lg;|riangle(?:left(?:;|eq;)|right(?:;|eq;)))|u(?:;|m(?:;|ero;|sp;))|v(?:Dash;|Harr;|ap;|dash;|g(?:e;|t;)|infin;|l(?:Arr;|e;|t(?:;|rie;))|r(?:Arr;|trie;)|sim;)|w(?:Arr;|ar(?:hk;|r(?:;|ow;))|near;))|o(?:S;|a(?:cute;?|st;)|c(?:ir(?:;|c;?)|y;)|d(?:ash;|blac;|iv;|ot;|sold;)|elig;|f(?:cir;|r;)|g(?:on;|rave;?|t;)|h(?:bar;|m;)|int;|l(?:arr;|c(?:ir;|ross;)|ine;|t;)|m(?:acr;|ega;|i(?:cron;|d;|nus;))|opf;|p(?:ar;|erp;|lus;)|r(?:;|arr;|d(?:;|er(?:;|of;)|f;?|m;?)|igof;|or;|slope;|v;)|s(?:cr;|lash;?|ol;)|ti(?:lde;?|mes(?:;|as;))|uml;?|vbar;)|p(?:ar(?:;|a(?:;|llel;|)|s(?:im;|l;)|t;)|cy;|er(?:cnt;|iod;|mil;|p;|tenk;)|fr;|h(?:i(?:;|v;)|mmat;|one;)|i(?:;|tchfork;|v;)|l(?:an(?:ck(?:;|h;)|kv;)|us(?:;|acir;|b;|cir;|d(?:o;|u;)|e;|mn;?|sim;|two;))|m;|o(?:intint;|pf;|und;?)|r(?:;|E;|ap;|cue;|e(?:;|c(?:;|approx;|curlyeq;|eq;|n(?:approx;|eqq;|sim;)|sim;))|ime(?:;|s;)|n(?:E;|ap;|sim;)|o(?:d;|f(?:alar;|line;|surf;)|p(?:;|to;))|sim;|urel;)|s(?:cr;|i;)|uncsp;)|q(?:fr;|int;|opf;|prime;|scr;|u(?:at(?:ernions;|int;)|est(?:;|eq;)|ot;?))|r(?:A(?:arr;|rr;|tail;)|Barr;|Har;|a(?:c(?:e;|ute;)|dic;|emptyv;|ng(?:;|d;|e;|le;)|quo;?|rr(?:;|ap;|b(?:;|fs;)|c;|fs;|hk;|lp;|pl;|sim;|tl;|w;)|t(?:ail;|io(?:;|nals;)))|b(?:arr;|brk;|r(?:ac(?:e;|k;)|k(?:e;|sl(?:d;|u;))))|c(?:aron;|e(?:dil;|il;)|ub;|y;)|d(?:ca;|ldhar;|quo(?:;|r;)|sh;)|e(?:al(?:;|ine;|part;|s;)|ct;|g;?)|f(?:isht;|loor;|r;)|h(?:ar(?:d;|u(?:;|l;))|o(?:;|v;))|i(?:ght(?:arrow(?:;|tail;)|harpoon(?:down;|up;)|left(?:arrows;|harpoons;)|rightarrows;|squigarrow;|threetimes;)|ng;|singdotseq;)|l(?:arr;|har;|m;)|moust(?:;|ache;)|nmid;|o(?:a(?:ng;|rr;)|brk;|p(?:ar;|f;|lus;)|times;)|p(?:ar(?:;|gt;)|polint;)|rarr;|s(?:aquo;|cr;|h;|q(?:b;|uo(?:;|r;)))|t(?:hree;|imes;|ri(?:;|e;|f;|ltri;))|uluhar;|x;)|s(?:acute;|bquo;|c(?:;|E;|a(?:p;|ron;)|cue;|e(?:;|dil;)|irc;|n(?:E;|ap;|sim;)|polint;|sim;|y;)|dot(?:;|b;|e;)|e(?:Arr;|ar(?:hk;|r(?:;|ow;))|ct;?|mi;|swar;|tm(?:inus;|n;)|xt;)|fr(?:;|own;)|h(?:arp;|c(?:hcy;|y;)|ort(?:mid;|parallel;)|y;?)|i(?:gma(?:;|f;|v;)|m(?:;|dot;|e(?:;|q;)|g(?:;|E;)|l(?:;|E;)|ne;|plus;|rarr;))|larr;|m(?:a(?:llsetminus;|shp;)|eparsl;|i(?:d;|le;)|t(?:;|e(?:;|s;)))|o(?:ftcy;|l(?:;|b(?:;|ar;))|pf;)|pa(?:des(?:;|uit;)|r;)|q(?:c(?:ap(?:;|s;)|up(?:;|s;))|su(?:b(?:;|e;|set(?:;|eq;))|p(?:;|e;|set(?:;|eq;)))|u(?:;|ar(?:e;|f;)|f;))|rarr;|s(?:cr;|etmn;|mile;|tarf;)|t(?:ar(?:;|f;)|r(?:aight(?:epsilon;|phi;)|ns;))|u(?:b(?:;|E;|dot;|e(?:;|dot;)|mult;|n(?:E;|e;)|plus;|rarr;|s(?:et(?:;|eq(?:;|q;)|neq(?:;|q;))|im;|u(?:b;|p;)))|cc(?:;|approx;|curlyeq;|eq;|n(?:approx;|eqq;|sim;)|sim;)|m;|ng;|p(?:1;?|2;?|3;?|;|E;|d(?:ot;|sub;)|e(?:;|dot;)|hs(?:ol;|ub;)|larr;|mult;|n(?:E;|e;)|plus;|s(?:et(?:;|eq(?:;|q;)|neq(?:;|q;))|im;|u(?:b;|p;))))|w(?:Arr;|ar(?:hk;|r(?:;|ow;))|nwar;)|zlig;?)|t(?:a(?:rget;|u;)|brk;|c(?:aron;|edil;|y;)|dot;|elrec;|fr;|h(?:e(?:re(?:4;|fore;)|ta(?:;|sym;|v;))|i(?:ck(?:approx;|sim;)|nsp;)|k(?:ap;|sim;)|orn;?)|i(?:lde;|mes(?:;|b(?:;|ar;)|d;|)|nt;)|o(?:ea;|p(?:;|bot;|cir;|f(?:;|ork;))|sa;)|prime;|r(?:ade;|i(?:angle(?:;|down;|left(?:;|eq;)|q;|right(?:;|eq;))|dot;|e;|minus;|plus;|sb;|time;)|pezium;)|s(?:c(?:r;|y;)|hcy;|trok;)|w(?:ixt;|ohead(?:leftarrow;|rightarrow;)))|u(?:Arr;|Har;|a(?:cute;?|rr;)|br(?:cy;|eve;)|c(?:irc;?|y;)|d(?:arr;|blac;|har;)|f(?:isht;|r;)|grave;?|h(?:ar(?:l;|r;)|blk;)|l(?:c(?:orn(?:;|er;)|rop;)|tri;)|m(?:acr;|l;?)|o(?:gon;|pf;)|p(?:arrow;|downarrow;|harpoon(?:left;|right;)|lus;|si(?:;|h;|lon;)|uparrows;)|r(?:c(?:orn(?:;|er;)|rop;)|ing;|tri;)|scr;|t(?:dot;|ilde;|ri(?:;|f;))|u(?:arr;|ml;?)|wangle;)|v(?:Arr;|Bar(?:;|v;)|Dash;|a(?:ngrt;|r(?:epsilon;|kappa;|nothing;|p(?:hi;|i;|ropto;)|r(?:;|ho;)|s(?:igma;|u(?:bsetneq(?:;|q;)|psetneq(?:;|q;)))|t(?:heta;|riangle(?:left;|right;))))|cy;|dash;|e(?:e(?:;|bar;|eq;)|llip;|r(?:bar;|t;))|fr;|ltri;|nsu(?:b;|p;)|opf;|prop;|rtri;|s(?:cr;|u(?:bn(?:E;|e;)|pn(?:E;|e;)))|zigzag;)|w(?:circ;|e(?:d(?:bar;|ge(?:;|q;))|ierp;)|fr;|opf;|p;|r(?:;|eath;)|scr;)|x(?:c(?:ap;|irc;|up;)|dtri;|fr;|h(?:Arr;|arr;)|i;|l(?:Arr;|arr;)|map;|nis;|o(?:dot;|p(?:f;|lus;)|time;)|r(?:Arr;|arr;)|s(?:cr;|qcup;)|u(?:plus;|tri;)|vee;|wedge;)|y(?:ac(?:ute;?|y;)|c(?:irc;|y;)|en;?|fr;|icy;|opf;|scr;|u(?:cy;|ml;?))|z(?:acute;|c(?:aron;|y;)|dot;|e(?:etrf;|ta;)|fr;|hcy;|igrarr;|opf;|scr;|w(?:j;|nj;)))|[\s\S]/g,io=/[^\r"&\u0000]+/g,ge=/[^\r'&\u0000]+/g,Po=/[^\r\t\n\f &>\u0000]+/g,os=/[^\r\t\n\f \/>A-Z\u0000]+/g,ca=/[^\r\t\n\f \/=>A-Z\u0000]+/g,Wt=/[^\]\r\u0000\uffff]*/g,Cs=/[^&<\r\u0000\uffff]*/g,Ha=/[^<\r\u0000\uffff]*/g,Yl=/[^\r\u0000\uffff]*/g,Mn=/(?:(\/)?([a-z]+)>)|[\s\S]/g,Ho=/(?:([-a-z]+)[ \t\n\f]*=[ \t\n\f]*('[^'&\r\u0000]*'|"[^"&\r\u0000]*"|[^\t\n\r\f "&'\u0000>][^&> \t\n\r\f\u0000]*[ \t\n\f]))|[\s\S]/g,zs=/[^\x09\x0A\x0C\x0D\x20]/,kc=/[^\x09\x0A\x0C\x0D\x20]/g,Oc=/[^\x00\x09\x0A\x0C\x0D\x20]/,il=/^[\x09\x0A\x0C\x0D\x20]+/,pn=/\x00/g;function Gr(ci){var Gt=16384;if(ci.length<Gt)return String.fromCharCode.apply(String,ci);for(var wi="",nn=0;nn<ci.length;nn+=Gt)wi+=String.fromCharCode.apply(String,ci.slice(nn,nn+Gt));return wi}function hu(ci){for(var Gt=[],wi=0;wi<ci.length;wi++)Gt[wi]=ci.charCodeAt(wi);return Gt}function Cr(ci,Gt){if(typeof Gt=="string")return ci.namespaceURI===r.HTML&&ci.localName===Gt;var wi=Gt[ci.namespaceURI];return wi&&wi[ci.localName]}function Da(ci){return Cr(ci,li)}function Kl(ci){if(Cr(ci,Ai))return!0;if(ci.namespaceURI===r.MATHML&&ci.localName==="annotation-xml"){var Gt=ci.getAttribute("encoding");if(Gt&&(Gt=Gt.toLowerCase()),Gt==="text/html"||Gt==="application/xhtml+xml")return!0}return!1}function Xl(ci){return ci in pt?pt[ci]:ci}function Jd(ci){for(var Gt=0,wi=ci.length;Gt<wi;Gt++)ci[Gt][0]in it&&(ci[Gt][0]=it[ci[Gt][0]])}function eh(ci){for(var Gt=0,wi=ci.length;Gt<wi;Gt++)if(ci[Gt][0]==="definitionurl"){ci[Gt][0]="definitionURL";break}}function Pc(ci){for(var Gt=0,wi=ci.length;Gt<wi;Gt++)ci[Gt][0]in hi&&ci[Gt].push(hi[ci[Gt][0]])}function pu(ci,Gt){for(var wi=0,nn=ci.length;wi<nn;wi++){var Wr=ci[wi][0],Pi=ci[wi][1];Gt.hasAttribute(Wr)||Gt._setAttribute(Wr,Pi)}}Zn.ElementStack=function(){this.elements=[],this.top=null},Zn.ElementStack.prototype.push=function(ci){this.elements.push(ci),this.top=ci},Zn.ElementStack.prototype.pop=function(ci){this.elements.pop(),this.top=this.elements[this.elements.length-1]},Zn.ElementStack.prototype.popTag=function(ci){for(var Gt=this.elements.length-1;Gt>0;Gt--){var wi=this.elements[Gt];if(Cr(wi,ci))break}this.elements.length=Gt,this.top=this.elements[Gt-1]},Zn.ElementStack.prototype.popElementType=function(ci){for(var Gt=this.elements.length-1;Gt>0&&!(this.elements[Gt]instanceof ci);Gt--);this.elements.length=Gt,this.top=this.elements[Gt-1]},Zn.ElementStack.prototype.popElement=function(ci){for(var Gt=this.elements.length-1;Gt>0&&this.elements[Gt]!==ci;Gt--);this.elements.length=Gt,this.top=this.elements[Gt-1]},Zn.ElementStack.prototype.removeElement=function(ci){if(this.top===ci)this.pop();else{var Gt=this.elements.lastIndexOf(ci);Gt!==-1&&this.elements.splice(Gt,1)}},Zn.ElementStack.prototype.clearToContext=function(ci){for(var Gt=this.elements.length-1;Gt>0&&!Cr(this.elements[Gt],ci);Gt--);this.elements.length=Gt+1,this.top=this.elements[Gt]},Zn.ElementStack.prototype.contains=function(ci){return this.inSpecificScope(ci,Object.create(null))},Zn.ElementStack.prototype.inSpecificScope=function(ci,Gt){for(var wi=this.elements.length-1;wi>=0;wi--){var nn=this.elements[wi];if(Cr(nn,ci))return!0;if(Cr(nn,Gt))return!1}return!1},Zn.ElementStack.prototype.elementInSpecificScope=function(ci,Gt){for(var wi=this.elements.length-1;wi>=0;wi--){var nn=this.elements[wi];if(nn===ci)return!0;if(Cr(nn,Gt))return!1}return!1},Zn.ElementStack.prototype.elementTypeInSpecificScope=function(ci,Gt){for(var wi=this.elements.length-1;wi>=0;wi--){var nn=this.elements[wi];if(nn instanceof ci)return!0;if(Cr(nn,Gt))return!1}return!1},Zn.ElementStack.prototype.inScope=function(ci){return this.inSpecificScope(ci,xe)},Zn.ElementStack.prototype.elementInScope=function(ci){return this.elementInSpecificScope(ci,xe)},Zn.ElementStack.prototype.elementTypeInScope=function(ci){return this.elementTypeInSpecificScope(ci,xe)},Zn.ElementStack.prototype.inButtonScope=function(ci){return this.inSpecificScope(ci,ke)},Zn.ElementStack.prototype.inListItemScope=function(ci){return this.inSpecificScope(ci,le)},Zn.ElementStack.prototype.inTableScope=function(ci){return this.inSpecificScope(ci,He)},Zn.ElementStack.prototype.inSelectScope=function(ci){for(var Gt=this.elements.length-1;Gt>=0;Gt--){var wi=this.elements[Gt];if(wi.namespaceURI!==r.HTML)return!1;var nn=wi.localName;if(nn===ci)return!0;if(nn!=="optgroup"&&nn!=="option")return!1}return!1},Zn.ElementStack.prototype.generateImpliedEndTags=function(ci,Gt){for(var wi=Gt?ct:ut,nn=this.elements.length-1;nn>=0;nn--){var Wr=this.elements[nn];if(ci&&Cr(Wr,ci)||!Cr(this.elements[nn],wi))break}this.elements.length=nn+1,this.top=this.elements[nn]},Zn.ActiveFormattingElements=function(){this.list=[],this.attrs=[]},Zn.ActiveFormattingElements.prototype.MARKER={localName:"|"},Zn.ActiveFormattingElements.prototype.insertMarker=function(){this.list.push(this.MARKER),this.attrs.push(this.MARKER)},Zn.ActiveFormattingElements.prototype.push=function(ci,Gt){for(var wi=0,nn=this.list.length-1;nn>=0&&this.list[nn]!==this.MARKER;nn--)if(Bs(ci,this.list[nn],this.attrs[nn])&&(wi++,wi===3)){this.list.splice(nn,1),this.attrs.splice(nn,1);break}this.list.push(ci);for(var Wr=[],Pi=0;Pi<Gt.length;Pi++)Wr[Pi]=Gt[Pi];this.attrs.push(Wr);function Bs(nl,rl,ol){if(nl.localName!==rl.localName||nl._numattrs!==ol.length)return!1;for(var Ma=0,fu=ol.length;Ma<fu;Ma++){var mt=ol[Ma][0],Y=ol[Ma][1];if(!nl.hasAttribute(mt)||nl.getAttribute(mt)!==Y)return!1}return!0}},Zn.ActiveFormattingElements.prototype.clearToMarker=function(){for(var ci=this.list.length-1;ci>=0&&this.list[ci]!==this.MARKER;ci--);ci<0&&(ci=0),this.list.length=ci,this.attrs.length=ci},Zn.ActiveFormattingElements.prototype.findElementByTag=function(ci){for(var Gt=this.list.length-1;Gt>=0;Gt--){var wi=this.list[Gt];if(wi===this.MARKER)break;if(wi.localName===ci)return wi}return null},Zn.ActiveFormattingElements.prototype.indexOf=function(ci){return this.list.lastIndexOf(ci)},Zn.ActiveFormattingElements.prototype.remove=function(ci){var Gt=this.list.lastIndexOf(ci);Gt!==-1&&(this.list.splice(Gt,1),this.attrs.splice(Gt,1))},Zn.ActiveFormattingElements.prototype.replace=function(ci,Gt,wi){var nn=this.list.lastIndexOf(ci);nn!==-1&&(this.list[nn]=Gt,this.attrs[nn]=wi)},Zn.ActiveFormattingElements.prototype.insertAfter=function(ci,Gt){var wi=this.list.lastIndexOf(ci);wi!==-1&&(this.list.splice(wi,0,Gt),this.attrs.splice(wi,0,Gt))};function Zn(ci,Gt,wi){var nn=null,Wr=0,Pi=0,Bs=!1,nl=!1,rl=0,ol=[],Ma="",fu=!0,mt=0,Y=cr,ue,Te,Ne="",ze="",je=[],st="",Ge="",at=[],gt=[],ft=[],Bt=[],Yt=[],ei=!1,Dt=X0,Zi=null,Yi=[],Ke=new Zn.ElementStack,Gi=new Zn.ActiveFormattingElements,Sr=Gt!==void 0,gn=null,Rn=null,Un=!0;Gt&&(Un=Gt.ownerDocument._scripting_enabled),wi&&wi.scripting_enabled===!1&&(Un=!1);var dn=!0,Jr=!1,Co,ua,Ei=[],So=!1,lo=!1,No={document:function(){return xr},_asDocumentFragment:function(){for(var ce=xr.createDocumentFragment(),de=xr.firstChild;de.hasChildNodes();)ce.appendChild(de.firstChild);return ce},pause:function(){mt++},resume:function(){mt--,this.parse("")},parse:function(ce,de,et){var wt;return mt>0?(Ma+=ce,!0):(rl===0?(Ma&&(ce=Ma+ce,Ma=""),de&&(ce+="\uFFFF",Bs=!0),nn=ce,Wr=ce.length,Pi=0,fu&&(fu=!1,nn.charCodeAt(0)===65279&&(Pi=1)),rl++,wt=Qp(et),Ma=nn.substring(Pi,Wr),rl--):(rl++,ol.push(nn,Wr,Pi),nn=ce,Wr=ce.length,Pi=0,Qp(),wt=!1,Ma=nn.substring(Pi,Wr),Pi=ol.pop(),Wr=ol.pop(),nn=ol.pop(),Ma&&(nn=Ma+nn.substring(Pi),Wr=nn.length,Pi=0,Ma=""),rl--),wt)}},xr=new e(!0,ci);if(xr._parser=No,xr._scripting_enabled=Un,Gt){if(Gt.ownerDocument._quirks&&(xr._quirks=!0),Gt.ownerDocument._limitedQuirks&&(xr._limitedQuirks=!0),Gt.namespaceURI===r.HTML)switch(Gt.localName){case"title":case"textarea":Y=ec;break;case"style":case"xmp":case"iframe":case"noembed":case"noframes":case"script":case"plaintext":Y=id;break}var Vs=xr.createElement("html");xr._appendChild(Vs),Ke.push(Vs),Gt instanceof w.HTMLTemplateElement&&Yi.push(ap),kn();for(var js=Gt;js!==null;js=js.parentElement)if(js instanceof w.HTMLFormElement){Rn=js;break}}function Qp(ce){for(var de,et,wt,Zt;Pi<Wr;){if(mt>0||ce&&ce())return!0;switch(typeof Y.lookahead){case"undefined":if(de=nn.charCodeAt(Pi++),nl&&(nl=!1,de===10)){Pi++;continue}switch(de){case 13:Pi<Wr?nn.charCodeAt(Pi)===10&&Pi++:nl=!0,Y(10);break;case 65535:if(Bs&&Pi===Wr){Y(k);break}default:Y(de);break}break;case"number":de=nn.charCodeAt(Pi);var Li=Y.lookahead,Tn=!0;if(Li<0&&(Tn=!1,Li=-Li),Li<Wr-Pi)et=Tn?nn.substring(Pi,Pi+Li):null,Zt=!1;else if(Bs)et=Tn?nn.substring(Pi,Wr):null,Zt=!0,de===65535&&Pi===Wr-1&&(de=k);else return!0;Y(de,et,Zt);break;case"string":de=nn.charCodeAt(Pi),wt=Y.lookahead;var mr=nn.indexOf(wt,Pi);if(mr!==-1)et=nn.substring(Pi,mr+wt.length),Zt=!1;else{if(!Bs)return!0;et=nn.substring(Pi,Wr),de===65535&&Pi===Wr-1&&(de=k),Zt=!0}Y(de,et,Zt);break}}return!1}function Sl(ce,de){for(var et=0;et<Yt.length;et++)if(Yt[et][0]===ce)return;de!==void 0?Yt.push([ce,de]):Yt.push([ce])}function Xh(){Ho.lastIndex=Pi-1;var ce=Ho.exec(nn);if(!ce)throw new Error("should never happen");var de=ce[1];if(!de)return!1;var et=ce[2],wt=et.length;switch(et[0]){case'"':case"'":et=et.substring(1,wt-1),Pi+=ce[0].length-1,Y=Wm;break;default:Y=Ds,Pi+=ce[0].length-1,et=et.substring(0,wt-1);break}for(var Zt=0;Zt<Yt.length;Zt++)if(Yt[Zt][0]===de)return!0;return Yt.push([de,et]),!0}function th(){ei=!1,Ne="",Yt.length=0}function Ju(){ei=!0,Ne="",Yt.length=0}function Ql(){je.length=0}function Jp(){st=""}function Qh(){Ge=""}function ed(){at.length=0}function _a(){gt.length=0,ft=null,Bt=null}function Ss(){ft=[]}function as(){Bt=[]}function rr(){Jr=!0}function Ts(){return Ke.top&&Ke.top.namespaceURI!=="http://www.w3.org/1999/xhtml"}function Ia(ce){return ze===ce}function mu(){if(Ei.length>0){var ce=Gr(Ei);if(Ei.length=0,lo&&(lo=!1,ce[0]===`
`&&(ce=ce.substring(1)),ce.length===0))return;pi(N,ce),So=!1}lo=!1}function gu(ce){ce.lastIndex=Pi-1;var de=ce.exec(nn);if(de&&de.index===Pi-1)return de=de[0],Pi+=de.length-1,Bs&&Pi===Wr&&(de=de.slice(0,-1),Pi--),de;throw new Error("should never happen")}function ss(ce){ce.lastIndex=Pi-1;var de=ce.exec(nn)[0];return de?(ls(de),Pi+=de.length-1,!0):!1}function ls(ce){Ei.length>0&&mu(),!(lo&&(lo=!1,ce[0]===`
`&&(ce=ce.substring(1)),ce.length===0))&&pi(N,ce)}function Jl(){if(ei)pi(q,Ne);else{var ce=Ne;Ne="",ze=ce,pi(V,ce,Yt)}}function Hm(){if(Pi===Wr)return!1;Mn.lastIndex=Pi;var ce=Mn.exec(nn);if(!ce)throw new Error("should never happen");var de=ce[2];if(!de)return!1;var et=ce[1];return et?(Pi+=de.length+2,pi(q,de)):(Pi+=de.length+1,ze=de,pi(V,de,te)),!0}function al(){ei?pi(q,Ne,null,!0):pi(V,Ne,Yt,!0)}function Ui(){pi(X,Gr(gt),ft?Gr(ft):void 0,Bt?Gr(Bt):void 0)}function or(){mu(),Dt(k),xr.modclock=1}var pi=No.insertToken=function(de,et,wt,Zt){mu();var Li=Ke.top;!Li||Li.namespaceURI===r.HTML?Dt(de,et,wt,Zt):de!==V&&de!==N?Qm(de,et,wt,Zt):Da(Li)&&(de===N||de===V&&et!=="mglyph"&&et!=="malignmark")||de===V&&et==="svg"&&Li.namespaceURI===r.MATHML&&Li.localName==="annotation-xml"||Kl(Li)?(ua=!0,Dt(de,et,wt,Zt),ua=!1):Qm(de,et,wt,Zt)};function Tl(ce){var de=Ke.top;Sn&&Cr(de,Rt)?jn(function(et){return et.createComment(ce)}):(de instanceof w.HTMLTemplateElement&&(de=de.content),de._appendChild(de.ownerDocument.createComment(ce)))}function Dl(ce){var de=Ke.top;if(Sn&&Cr(de,Rt))jn(function(wt){return wt.createTextNode(ce)});else{de instanceof w.HTMLTemplateElement&&(de=de.content);var et=de.lastChild;et&&et.nodeType===o.TEXT_NODE?et.appendData(ce):de._appendChild(de.ownerDocument.createTextNode(ce))}}function Nc(ce,de,et){var wt=g.createElement(ce,de,null);if(et)for(var Zt=0,Li=et.length;Zt<Li;Zt++)wt._setAttribute(et[Zt][0],et[Zt][1]);return wt}var Sn=!1;function yn(ce,de){var et=td(function(wt){return Nc(wt,ce,de)});return Cr(et,we)&&(et._form=Rn),et}function td(ce){var de;return Sn&&Cr(Ke.top,Rt)?de=jn(ce):Ke.top instanceof w.HTMLTemplateElement?(de=ce(Ke.top.content.ownerDocument),Ke.top.content._appendChild(de)):(de=ce(Ke.top.ownerDocument),Ke.top._appendChild(de)),Ke.push(de),de}function _u(ce,de,et){return td(function(wt){var Zt=wt._createElementNS(ce,et,null);if(de)for(var Li=0,Tn=de.length;Li<Tn;Li++){var mr=de[Li];mr.length===2?Zt._setAttribute(mr[0],mr[1]):Zt._setAttributeNS(mr[2],mr[0],mr[1])}return Zt})}function fi(ce){for(var de=Ke.elements.length-1;de>=0;de--)if(Ke.elements[de]instanceof ce)return de;return-1}function jn(ce){var de,et,wt=-1,Zt=-1,Li;if(wt=fi(w.HTMLTableElement),Zt=fi(w.HTMLTemplateElement),Zt>=0&&(wt<0||Zt>wt)?de=Ke.elements[Zt]:wt>=0&&(de=Ke.elements[wt].parentNode,de?et=Ke.elements[wt]:de=Ke.elements[wt-1]),de||(de=Ke.elements[0]),de instanceof w.HTMLTemplateElement&&(de=de.content),Li=ce(de.ownerDocument),Li.nodeType===o.TEXT_NODE){var Tn;if(et?Tn=et.previousSibling:Tn=de.lastChild,Tn&&Tn.nodeType===o.TEXT_NODE)return Tn.appendData(Li.data),Li}return et?de.insertBefore(Li,et):de._appendChild(Li),Li}function kn(){for(var ce=!1,de=Ke.elements.length-1;de>=0;de--){var et=Ke.elements[de];if(de===0&&(ce=!0,Sr&&(et=Gt)),et.namespaceURI===r.HTML){var wt=et.localName;switch(wt){case"select":for(var Zt=de;Zt>0;){var Li=Ke.elements[--Zt];if(Li instanceof w.HTMLTemplateElement)break;if(Li instanceof w.HTMLTableElement){Dt=Wc;return}}Dt=us;return;case"tr":Dt=Gc;return;case"tbody":case"tfoot":case"thead":Dt=Ol;return;case"caption":Dt=qc;return;case"colgroup":Dt=$c;return;case"table":Dt=cs;return;case"template":Dt=Yi[Yi.length-1];return;case"body":Dt=xn;return;case"frameset":Dt=ud;return;case"html":gn===null?Dt=Ms:Dt=cd;return;default:if(!ce){if(wt==="head"){Dt=yo;return}if(wt==="td"||wt==="th"){Dt=Is;return}}}}if(ce){Dt=xn;return}}}function Xo(ce,de){yn(ce,de),Y=tc,Zi=Dt,Dt=kl}function ih(ce,de){yn(ce,de),Y=ec,Zi=Dt,Dt=kl}function Vn(ce,de){return{elt:Nc(ce,Gi.list[de].localName,Gi.attrs[de]),attrs:Gi.attrs[de]}}function To(){if(Gi.list.length!==0){var ce=Gi.list[Gi.list.length-1];if(ce!==Gi.MARKER&&Ke.elements.lastIndexOf(ce)===-1){for(var de=Gi.list.length-2;de>=0&&(ce=Gi.list[de],!(ce===Gi.MARKER||Ke.elements.lastIndexOf(ce)!==-1));de--);for(de=de+1;de<Gi.list.length;de++){var et=td(function(wt){return Vn(wt,de).elt});Gi.list[de]=et}}}}var yu={localName:"BM"};function Lc(ce){if(Cr(Ke.top,ce)&&Gi.indexOf(Ke.top)===-1)return Ke.pop(),!0;for(var de=0;de<8;){de++;var et=Gi.findElementByTag(ce);if(!et)return!1;var wt=Ke.elements.lastIndexOf(et);if(wt===-1)return Gi.remove(et),!0;if(!Ke.elementInScope(et))return!0;for(var Zt=null,Li,Tn=wt+1;Tn<Ke.elements.length;Tn++)if(Cr(Ke.elements[Tn],Pe)){Zt=Ke.elements[Tn],Li=Tn;break}if(Zt){var mr=Ke.elements[wt-1];Gi.insertAfter(et,yu);for(var go=Zt,ba=Zt,qs=Li,Pl,Nl=0;Nl++,go=Ke.elements[--qs],go!==et;){if(Pl=Gi.indexOf(go),Nl>3&&Pl!==-1&&(Gi.remove(go),Pl=-1),Pl===-1){Ke.removeElement(go);continue}var sl=Vn(mr.ownerDocument,Pl);Gi.replace(go,sl.elt,sl.attrs),Ke.elements[qs]=sl.elt,go=sl.elt,ba===Zt&&(Gi.remove(yu),Gi.insertAfter(sl.elt,yu)),go._appendChild(ba),ba=go}Sn&&Cr(mr,Rt)?jn(function(){return ba}):mr instanceof w.HTMLTemplateElement?mr.content._appendChild(ba):mr._appendChild(ba);for(var dh=Vn(Zt.ownerDocument,Gi.indexOf(et));Zt.hasChildNodes();)dh.elt._appendChild(Zt.firstChild);Zt._appendChild(dh.elt),Gi.remove(et),Gi.replace(yu,dh.elt,dh.attrs),Ke.removeElement(et);var $s=Ke.elements.lastIndexOf(Zt);Ke.elements.splice($s+1,0,dh.elt)}else return Ke.popElement(et),Gi.remove(et),!0}return!0}function ya(){Ke.pop(),Dt=Zi}function jr(){delete xr._parser,Ke.elements.length=0,xr.defaultView&&xr.defaultView.dispatchEvent(new w.Event("load",{}))}function rn(ce,de){Y=de,Pi--}function cr(ce){switch(ce){case 38:ue=cr,Y=ch;break;case 60:if(Hm())break;Y=Aa;break;case 0:Ei.push(ce),So=!0;break;case-1:or();break;default:ss(Cs)||Ei.push(ce);break}}function ec(ce){switch(ce){case 38:ue=ec,Y=ch;break;case 60:Y=Jh;break;case 0:Ei.push(65533),So=!0;break;case-1:or();break;default:Ei.push(ce);break}}function tc(ce){switch(ce){case 60:Y=Qo;break;case 0:Ei.push(65533);break;case-1:or();break;default:ss(Ha)||Ei.push(ce);break}}function Ml(ce){switch(ce){case 60:Y=qm;break;case 0:Ei.push(65533);break;case-1:or();break;default:ss(Ha)||Ei.push(ce);break}}function id(ce){switch(ce){case 0:Ei.push(65533);break;case-1:or();break;default:ss(Yl)||Ei.push(ce);break}}function Aa(ce){switch(ce){case 33:Y=Z0;break;case 47:Y=ic;break;case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:th(),rn(ce,va);break;case 63:rn(ce,ip);break;default:Ei.push(60),rn(ce,cr);break}}function ic(ce){switch(ce){case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:Ju(),rn(ce,va);break;case 62:Y=cr;break;case-1:Ei.push(60),Ei.push(47),or();break;default:rn(ce,ip);break}}function va(ce){switch(ce){case 9:case 10:case 12:case 32:Y=Ds;break;case 47:Y=xu;break;case 62:Y=cr,Jl();break;case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:Ne+=String.fromCharCode(ce+32);break;case 0:Ne+="\uFFFD";break;case-1:or();break;default:Ne+=gu(os);break}}function Jh(ce){ce===47?(Ql(),Y=Il):(Ei.push(60),rn(ce,ec))}function Il(ce){switch(ce){case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:Ju(),rn(ce,Do);break;default:Ei.push(60),Ei.push(47),rn(ce,ec);break}}function Do(ce){switch(ce){case 9:case 10:case 12:case 32:if(Ia(Ne)){Y=Ds;return}break;case 47:if(Ia(Ne)){Y=xu;return}break;case 62:if(Ia(Ne)){Y=cr,Jl();return}break;case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:Ne+=String.fromCharCode(ce+32),je.push(ce);return;case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:Ne+=String.fromCharCode(ce),je.push(ce);return}Ei.push(60),Ei.push(47),T(Ei,je),rn(ce,ec)}function Qo(ce){ce===47?(Ql(),Y=Fc):(Ei.push(60),rn(ce,tc))}function Fc(ce){switch(ce){case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:Ju(),rn(ce,mo);break;default:Ei.push(60),Ei.push(47),rn(ce,tc);break}}function mo(ce){switch(ce){case 9:case 10:case 12:case 32:if(Ia(Ne)){Y=Ds;return}break;case 47:if(Ia(Ne)){Y=xu;return}break;case 62:if(Ia(Ne)){Y=cr,Jl();return}break;case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:Ne+=String.fromCharCode(ce+32),je.push(ce);return;case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:Ne+=String.fromCharCode(ce),je.push(ce);return}Ei.push(60),Ei.push(47),T(Ei,je),rn(ce,tc)}function qm(ce){switch(ce){case 47:Ql(),Y=Us;break;case 33:Y=vu,Ei.push(60),Ei.push(33);break;default:Ei.push(60),rn(ce,Ml);break}}function Us(ce){switch(ce){case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:Ju(),rn(ce,nh);break;default:Ei.push(60),Ei.push(47),rn(ce,Ml);break}}function nh(ce){switch(ce){case 9:case 10:case 12:case 32:if(Ia(Ne)){Y=Ds;return}break;case 47:if(Ia(Ne)){Y=xu;return}break;case 62:if(Ia(Ne)){Y=cr,Jl();return}break;case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:Ne+=String.fromCharCode(ce+32),je.push(ce);return;case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:Ne+=String.fromCharCode(ce),je.push(ce);return}Ei.push(60),Ei.push(47),T(Ei,je),rn(ce,Ml)}function vu(ce){ce===45?(Y=zc,Ei.push(45)):rn(ce,Ml)}function zc(ce){ce===45?(Y=W0,Ei.push(45)):rn(ce,Ml)}function nc(ce){switch(ce){case 45:Y=Bc,Ei.push(45);break;case 60:Y=rh;break;case 0:Ei.push(65533);break;case-1:or();break;default:Ei.push(ce);break}}function Bc(ce){switch(ce){case 45:Y=W0,Ei.push(45);break;case 60:Y=rh;break;case 0:Y=nc,Ei.push(65533);break;case-1:or();break;default:Y=nc,Ei.push(ce);break}}function W0(ce){switch(ce){case 45:Ei.push(45);break;case 60:Y=rh;break;case 62:Y=Ml,Ei.push(62);break;case 0:Y=nc,Ei.push(65533);break;case-1:or();break;default:Y=nc,Ei.push(ce);break}}function rh(ce){switch(ce){case 47:Ql(),Y=qa;break;case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:Ql(),Ei.push(60),rn(ce,nd);break;default:Ei.push(60),rn(ce,nc);break}}function qa(ce){switch(ce){case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:Ju(),rn(ce,Bv);break;default:Ei.push(60),Ei.push(47),rn(ce,nc);break}}function Bv(ce){switch(ce){case 9:case 10:case 12:case 32:if(Ia(Ne)){Y=Ds;return}break;case 47:if(Ia(Ne)){Y=xu;return}break;case 62:if(Ia(Ne)){Y=cr,Jl();return}break;case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:Ne+=String.fromCharCode(ce+32),je.push(ce);return;case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:Ne+=String.fromCharCode(ce),je.push(ce);return}Ei.push(60),Ei.push(47),T(Ei,je),rn(ce,nc)}function nd(ce){switch(ce){case 9:case 10:case 12:case 32:case 47:case 62:Gr(je)==="script"?Y=Vc:Y=nc,Ei.push(ce);break;case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:je.push(ce+32),Ei.push(ce);break;case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:je.push(ce),Ei.push(ce);break;default:rn(ce,nc);break}}function Vc(ce){switch(ce){case 45:Y=ep,Ei.push(45);break;case 60:Y=$m,Ei.push(60);break;case 0:Ei.push(65533);break;case-1:or();break;default:Ei.push(ce);break}}function ep(ce){switch(ce){case 45:Y=Vv,Ei.push(45);break;case 60:Y=$m,Ei.push(60);break;case 0:Y=Vc,Ei.push(65533);break;case-1:or();break;default:Y=Vc,Ei.push(ce);break}}function Vv(ce){switch(ce){case 45:Ei.push(45);break;case 60:Y=$m,Ei.push(60);break;case 62:Y=Ml,Ei.push(62);break;case 0:Y=Vc,Ei.push(65533);break;case-1:or();break;default:Y=Vc,Ei.push(ce);break}}function $m(ce){ce===47?(Ql(),Y=tp,Ei.push(47)):rn(ce,Vc)}function tp(ce){switch(ce){case 9:case 10:case 12:case 32:case 47:case 62:Gr(je)==="script"?Y=nc:Y=Vc,Ei.push(ce);break;case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:je.push(ce+32),Ei.push(ce);break;case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:je.push(ce),Ei.push(ce);break;default:rn(ce,Vc);break}}function Ds(ce){switch(ce){case 9:case 10:case 12:case 32:break;case 47:Y=xu;break;case 62:Y=cr,Jl();break;case-1:or();break;case 61:Jp(),st+=String.fromCharCode(ce),Y=Gm;break;default:if(Xh())break;Jp(),rn(ce,Gm);break}}function Gm(ce){switch(ce){case 9:case 10:case 12:case 32:case 47:case 62:case-1:rn(ce,rd);break;case 61:Y=bu;break;case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:st+=String.fromCharCode(ce+32);break;case 0:st+="\uFFFD";break;case 34:case 39:case 60:default:st+=gu(ca);break}}function rd(ce){switch(ce){case 9:case 10:case 12:case 32:break;case 47:Sl(st),Y=xu;break;case 61:Y=bu;break;case 62:Y=cr,Sl(st),Jl();break;case-1:Sl(st),or();break;default:Sl(st),Jp(),rn(ce,Gm);break}}function bu(ce){switch(ce){case 9:case 10:case 12:case 32:break;case 34:Qh(),Y=od;break;case 39:Qh(),Y=Al;break;case 62:default:Qh(),rn(ce,oh);break}}function od(ce){switch(ce){case 34:Sl(st,Ge),Y=Wm;break;case 38:ue=od,Y=ch;break;case 0:Ge+="\uFFFD";break;case-1:or();break;case 10:Ge+=String.fromCharCode(ce);break;default:Ge+=gu(io);break}}function Al(ce){switch(ce){case 39:Sl(st,Ge),Y=Wm;break;case 38:ue=Al,Y=ch;break;case 0:Ge+="\uFFFD";break;case-1:or();break;case 10:Ge+=String.fromCharCode(ce);break;default:Ge+=gu(ge);break}}function oh(ce){switch(ce){case 9:case 10:case 12:case 32:Sl(st,Ge),Y=Ds;break;case 38:ue=oh,Y=ch;break;case 62:Sl(st,Ge),Y=cr,Jl();break;case 0:Ge+="\uFFFD";break;case-1:Pi--,Y=cr;break;case 34:case 39:case 60:case 61:case 96:default:Ge+=gu(Po);break}}function Wm(ce){switch(ce){case 9:case 10:case 12:case 32:Y=Ds;break;case 47:Y=xu;break;case 62:Y=cr,Jl();break;case-1:or();break;default:rn(ce,Ds);break}}function xu(ce){switch(ce){case 62:Y=cr,al();break;case-1:or();break;default:rn(ce,Ds);break}}function ip(ce,de,et){var wt=de.length;et?Pi+=wt-1:Pi+=wt;var Zt=de.substring(0,wt-1);Zt=Zt.replace(/\u0000/g,"\uFFFD"),Zt=Zt.replace(/\u000D\u000A/g,`
`),Zt=Zt.replace(/\u000D/g,`
`),pi(Z,Zt),Y=cr}ip.lookahead=">";function Z0(ce,de,et){if(de[0]==="-"&&de[1]==="-"){Pi+=2,ed(),Y=wu;return}de.toUpperCase()==="DOCTYPE"?(Pi+=7,Y=lh):de==="[CDATA["&&Ts()?(Pi+=7,Y=Zm):Y=ip}Z0.lookahead=7;function wu(ce){switch(ed(),ce){case 45:Y=_n;break;case 62:Y=cr,pi(Z,Gr(at));break;default:rn(ce,xi);break}}function _n(ce){switch(ce){case 45:Y=sh;break;case 62:Y=cr,pi(Z,Gr(at));break;case-1:pi(Z,Gr(at)),or();break;default:at.push(45),rn(ce,xi);break}}function xi(ce){switch(ce){case 60:at.push(ce),Y=ef;break;case 45:Y=Vi;break;case 0:at.push(65533);break;case-1:pi(Z,Gr(at)),or();break;default:at.push(ce);break}}function ef(ce){switch(ce){case 33:at.push(ce),Y=en;break;case 60:at.push(ce);break;default:rn(ce,xi);break}}function en(ce){switch(ce){case 45:Y=jc;break;default:rn(ce,xi);break}}function jc(ce){switch(ce){case 45:Y=ah;break;default:rn(ce,Vi);break}}function ah(ce){switch(ce){case 62:case-1:rn(ce,sh);break;default:rn(ce,sh);break}}function Vi(ce){switch(ce){case 45:Y=sh;break;case-1:pi(Z,Gr(at)),or();break;default:at.push(45),rn(ce,xi);break}}function sh(ce){switch(ce){case 62:Y=cr,pi(Z,Gr(at));break;case 33:Y=ad;break;case 45:at.push(45);break;case-1:pi(Z,Gr(at)),or();break;default:at.push(45),at.push(45),rn(ce,xi);break}}function ad(ce){switch(ce){case 45:at.push(45),at.push(45),at.push(33),Y=Vi;break;case 62:Y=cr,pi(Z,Gr(at));break;case-1:pi(Z,Gr(at)),or();break;default:at.push(45),at.push(45),at.push(33),rn(ce,xi);break}}function lh(ce){switch(ce){case 9:case 10:case 12:case 32:Y=tf;break;case-1:_a(),rr(),Ui(),or();break;default:rn(ce,tf);break}}function tf(ce){switch(ce){case 9:case 10:case 12:case 32:break;case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:_a(),gt.push(ce+32),Y=Eu;break;case 0:_a(),gt.push(65533),Y=Eu;break;case 62:_a(),rr(),Y=cr,Ui();break;case-1:_a(),rr(),Ui(),or();break;default:_a(),gt.push(ce),Y=Eu;break}}function Eu(ce){switch(ce){case 9:case 10:case 12:case 32:Y=eo;break;case 62:Y=cr,Ui();break;case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:gt.push(ce+32);break;case 0:gt.push(65533);break;case-1:rr(),Ui(),or();break;default:gt.push(ce);break}}function eo(ce,de,et){switch(ce){case 9:case 10:case 12:case 32:Pi+=1;break;case 62:Y=cr,Pi+=1,Ui();break;case-1:rr(),Ui(),or();break;default:de=de.toUpperCase(),de==="PUBLIC"?(Pi+=6,Y=np):de==="SYSTEM"?(Pi+=6,Y=nf):(rr(),Y=Hs);break}}eo.lookahead=6;function np(ce){switch(ce){case 9:case 10:case 12:case 32:Y=$t;break;case 34:Ss(),Y=rp;break;case 39:Ss(),Y=rc;break;case 62:rr(),Y=cr,Ui();break;case-1:rr(),Ui(),or();break;default:rr(),Y=Hs;break}}function $t(ce){switch(ce){case 9:case 10:case 12:case 32:break;case 34:Ss(),Y=rp;break;case 39:Ss(),Y=rc;break;case 62:rr(),Y=cr,Ui();break;case-1:rr(),Ui(),or();break;default:rr(),Y=Hs;break}}function rp(ce){switch(ce){case 34:Y=da;break;case 0:ft.push(65533);break;case 62:rr(),Y=cr,Ui();break;case-1:rr(),Ui(),or();break;default:ft.push(ce);break}}function rc(ce){switch(ce){case 39:Y=da;break;case 0:ft.push(65533);break;case 62:rr(),Y=cr,Ui();break;case-1:rr(),Ui(),or();break;default:ft.push(ce);break}}function da(ce){switch(ce){case 9:case 10:case 12:case 32:Y=Y0;break;case 62:Y=cr,Ui();break;case 34:as(),Y=Hc;break;case 39:as(),Y=Rl;break;case-1:rr(),Ui(),or();break;default:rr(),Y=Hs;break}}function Y0(ce){switch(ce){case 9:case 10:case 12:case 32:break;case 62:Y=cr,Ui();break;case 34:as(),Y=Hc;break;case 39:as(),Y=Rl;break;case-1:rr(),Ui(),or();break;default:rr(),Y=Hs;break}}function nf(ce){switch(ce){case 9:case 10:case 12:case 32:Y=Uc;break;case 34:as(),Y=Hc;break;case 39:as(),Y=Rl;break;case 62:rr(),Y=cr,Ui();break;case-1:rr(),Ui(),or();break;default:rr(),Y=Hs;break}}function Uc(ce){switch(ce){case 9:case 10:case 12:case 32:break;case 34:as(),Y=Hc;break;case 39:as(),Y=Rl;break;case 62:rr(),Y=cr,Ui();break;case-1:rr(),Ui(),or();break;default:rr(),Y=Hs;break}}function Hc(ce){switch(ce){case 34:Y=sd;break;case 0:Bt.push(65533);break;case 62:rr(),Y=cr,Ui();break;case-1:rr(),Ui(),or();break;default:Bt.push(ce);break}}function Rl(ce){switch(ce){case 39:Y=sd;break;case 0:Bt.push(65533);break;case 62:rr(),Y=cr,Ui();break;case-1:rr(),Ui(),or();break;default:Bt.push(ce);break}}function sd(ce){switch(ce){case 9:case 10:case 12:case 32:break;case 62:Y=cr,Ui();break;case-1:rr(),Ui(),or();break;default:Y=Hs;break}}function Hs(ce){switch(ce){case 62:Y=cr,Ui();break;case-1:Ui(),or();break}}function Zm(ce){switch(ce){case 93:Y=jv;break;case-1:or();break;case 0:So=!0;default:ss(Wt)||Ei.push(ce);break}}function jv(ce){switch(ce){case 93:Y=Ym;break;default:Ei.push(93),rn(ce,Zm);break}}function Ym(ce){switch(ce){case 93:Ei.push(93);break;case 62:mu(),Y=cr;break;default:Ei.push(93),Ei.push(93),rn(ce,Zm);break}}function ch(ce){switch(Ql(),je.push(38),ce){case 9:case 10:case 12:case 32:case 60:case 38:case-1:rn(ce,oc);break;case 35:je.push(ce),Y=K0;break;default:rn(ce,Km);break}}function Km(ce){Oo.lastIndex=Pi;var de=Oo.exec(nn);if(!de)throw new Error("should never happen");var et=de[1];if(!et){Y=oc;return}switch(Pi+=et.length,T(je,hu(et)),ue){case od:case Al:case oh:if(et[et.length-1]!==";"&&/[=A-Za-z0-9]/.test(nn[Pi])){Y=oc;return}break}Ql();var wt=Cn[et];typeof wt=="number"?je.push(wt):T(je,wt),Y=oc}Km.lookahead=-32;function K0(ce){switch(Te=0,ce){case 120:case 88:je.push(ce),Y=rf;break;default:rn(ce,Uv);break}}function rf(ce){switch(ce){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 65:case 66:case 67:case 68:case 69:case 70:case 97:case 98:case 99:case 100:case 101:case 102:rn(ce,ld);break;default:rn(ce,oc);break}}function Uv(ce){switch(ce){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:rn(ce,Hv);break;default:rn(ce,oc);break}}function ld(ce){switch(ce){case 65:case 66:case 67:case 68:case 69:case 70:Te*=16,Te+=ce-55;break;case 97:case 98:case 99:case 100:case 101:case 102:Te*=16,Te+=ce-87;break;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:Te*=16,Te+=ce-48;break;case 59:Y=of;break;default:rn(ce,of);break}}function Hv(ce){switch(ce){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:Te*=10,Te+=ce-48;break;case 59:Y=of;break;default:rn(ce,of);break}}function of(ce){Te in di?Te=di[Te]:(Te>1114111||Te>=55296&&Te<57344)&&(Te=65533),Ql(),Te<=65535?je.push(Te):(Te=Te-65536,je.push(55296+(Te>>10)),je.push(56320+(Te&1023))),rn(ce,oc)}function oc(ce){switch(ue){case od:case Al:case oh:Ge+=Gr(je);break;default:T(Ei,je);break}rn(ce,ue)}function X0(ce,de,et,wt){switch(ce){case 1:if(de=de.replace(il,""),de.length===0)return;break;case 4:xr._appendChild(xr.createComment(de));return;case 5:var Zt=de,Li=et,Tn=wt;xr.appendChild(new n(xr,Zt,Li,Tn)),Jr||Zt.toLowerCase()!=="html"||De.test(Li)||Tn&&Tn.toLowerCase()===_e||Tn===void 0&&he.test(Li)?xr._quirks=!0:(Ce.test(Li)||Tn!==void 0&&he.test(Li))&&(xr._limitedQuirks=!0),Dt=uh;return}xr._quirks=!0,Dt=uh,Dt(ce,de,et,wt)}function uh(ce,de,et,wt){var Zt;switch(ce){case 1:if(de=de.replace(il,""),de.length===0)return;break;case 5:return;case 4:xr._appendChild(xr.createComment(de));return;case 2:if(de==="html"){Zt=Nc(xr,de,et),Ke.push(Zt),xr.appendChild(Zt),Dt=Ms;return}break;case 3:switch(de){case"html":case"head":case"body":case"br":break;default:return}}Zt=Nc(xr,"html",null),Ke.push(Zt),xr.appendChild(Zt),Dt=Ms,Dt(ce,de,et,wt)}function Ms(ce,de,et,wt){switch(ce){case 1:if(de=de.replace(il,""),de.length===0)return;break;case 5:return;case 4:Tl(de);return;case 2:switch(de){case"html":xn(ce,de,et,wt);return;case"head":var Zt=yn(de,et);gn=Zt,Dt=yo;return}break;case 3:switch(de){case"html":case"head":case"body":case"br":break;default:return}}Ms(V,"head",null),Dt(ce,de,et,wt)}function yo(ce,de,et,wt){switch(ce){case 1:var Zt=de.match(il);if(Zt&&(Dl(Zt[0]),de=de.substring(Zt[0].length)),de.length===0)return;break;case 4:Tl(de);return;case 5:return;case 2:switch(de){case"html":xn(ce,de,et,wt);return;case"meta":case"base":case"basefont":case"bgsound":case"link":yn(de,et),Ke.pop();return;case"title":ih(de,et);return;case"noscript":if(!Un){yn(de,et),Dt=op;return}case"noframes":case"style":Xo(de,et);return;case"script":td(function(Li){var Tn=Nc(Li,de,et);return Tn._parser_inserted=!0,Tn._force_async=!1,Sr&&(Tn._already_started=!0),mu(),Tn}),Y=Ml,Zi=Dt,Dt=kl;return;case"template":yn(de,et),Gi.insertMarker(),dn=!1,Dt=ap,Yi.push(Dt);return;case"head":return}break;case 3:switch(de){case"head":Ke.pop(),Dt=cd;return;case"body":case"html":case"br":break;case"template":if(!Ke.contains("template"))return;Ke.generateImpliedEndTags(null,"thorough"),Ke.popTag("template"),Gi.clearToMarker(),Yi.pop(),kn();return;default:return}break}yo(q,"head",null),Dt(ce,de,et,wt)}function op(ce,de,et,wt){switch(ce){case 5:return;case 4:yo(ce,de);return;case 1:var Zt=de.match(il);if(Zt&&(yo(ce,Zt[0]),de=de.substring(Zt[0].length)),de.length===0)return;break;case 2:switch(de){case"html":xn(ce,de,et,wt);return;case"basefont":case"bgsound":case"link":case"meta":case"noframes":case"style":yo(ce,de,et);return;case"head":case"noscript":return}break;case 3:switch(de){case"noscript":Ke.pop(),Dt=yo;return;case"br":break;default:return}break}op(q,"noscript",null),Dt(ce,de,et,wt)}function cd(ce,de,et,wt){switch(ce){case 1:var Zt=de.match(il);if(Zt&&(Dl(Zt[0]),de=de.substring(Zt[0].length)),de.length===0)return;break;case 4:Tl(de);return;case 5:return;case 2:switch(de){case"html":xn(ce,de,et,wt);return;case"body":yn(de,et),dn=!1,Dt=xn;return;case"frameset":yn(de,et),Dt=ud;return;case"base":case"basefont":case"bgsound":case"link":case"meta":case"noframes":case"script":case"style":case"template":case"title":Ke.push(gn),yo(V,de,et),Ke.removeElement(gn);return;case"head":return}break;case 3:switch(de){case"template":return yo(ce,de,et,wt);case"body":case"html":case"br":break;default:return}break}cd(V,"body",null),dn=!0,Dt(ce,de,et,wt)}function xn(ce,de,et,wt){var Zt,Li,Tn,mr;switch(ce){case 1:if(So&&(de=de.replace(pn,""),de.length===0))return;dn&&zs.test(de)&&(dn=!1),To(),Dl(de);return;case 5:return;case 4:Tl(de);return;case-1:if(Yi.length)return ap(ce);jr();return;case 2:switch(de){case"html":if(Ke.contains("template"))return;pu(et,Ke.elements[0]);return;case"base":case"basefont":case"bgsound":case"link":case"meta":case"noframes":case"script":case"style":case"template":case"title":yo(V,de,et);return;case"body":if(Zt=Ke.elements[1],!Zt||!(Zt instanceof w.HTMLBodyElement)||Ke.contains("template"))return;dn=!1,pu(et,Zt);return;case"frameset":if(!dn||(Zt=Ke.elements[1],!Zt||!(Zt instanceof w.HTMLBodyElement)))return;for(Zt.parentNode&&Zt.parentNode.removeChild(Zt);!(Ke.top instanceof w.HTMLHtmlElement);)Ke.pop();yn(de,et),Dt=ud;return;case"address":case"article":case"aside":case"blockquote":case"center":case"details":case"dialog":case"dir":case"div":case"dl":case"fieldset":case"figcaption":case"figure":case"footer":case"header":case"hgroup":case"main":case"nav":case"ol":case"p":case"section":case"summary":case"ul":Ke.inButtonScope("p")&&xn(q,"p"),yn(de,et);return;case"menu":Ke.inButtonScope("p")&&xn(q,"p"),Cr(Ke.top,"menuitem")&&Ke.pop(),yn(de,et);return;case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":Ke.inButtonScope("p")&&xn(q,"p"),Ke.top instanceof w.HTMLHeadingElement&&Ke.pop(),yn(de,et);return;case"pre":case"listing":Ke.inButtonScope("p")&&xn(q,"p"),yn(de,et),lo=!0,dn=!1;return;case"form":if(Rn&&!Ke.contains("template"))return;Ke.inButtonScope("p")&&xn(q,"p"),mr=yn(de,et),Ke.contains("template")||(Rn=mr);return;case"li":for(dn=!1,Li=Ke.elements.length-1;Li>=0;Li--){if(Tn=Ke.elements[Li],Tn instanceof w.HTMLLIElement){xn(q,"li");break}if(Cr(Tn,Pe)&&!Cr(Tn,ye))break}Ke.inButtonScope("p")&&xn(q,"p"),yn(de,et);return;case"dd":case"dt":for(dn=!1,Li=Ke.elements.length-1;Li>=0;Li--){if(Tn=Ke.elements[Li],Cr(Tn,vt)){xn(q,Tn.localName);break}if(Cr(Tn,Pe)&&!Cr(Tn,ye))break}Ke.inButtonScope("p")&&xn(q,"p"),yn(de,et);return;case"plaintext":Ke.inButtonScope("p")&&xn(q,"p"),yn(de,et),Y=id;return;case"button":Ke.inScope("button")?(xn(q,"button"),Dt(ce,de,et,wt)):(To(),yn(de,et),dn=!1);return;case"a":var go=Gi.findElementByTag("a");go&&(xn(q,de),Gi.remove(go),Ke.removeElement(go));case"b":case"big":case"code":case"em":case"font":case"i":case"s":case"small":case"strike":case"strong":case"tt":case"u":To(),Gi.push(yn(de,et),et);return;case"nobr":To(),Ke.inScope(de)&&(xn(q,de),To()),Gi.push(yn(de,et),et);return;case"applet":case"marquee":case"object":To(),yn(de,et),Gi.insertMarker(),dn=!1;return;case"table":!xr._quirks&&Ke.inButtonScope("p")&&xn(q,"p"),yn(de,et),dn=!1,Dt=cs;return;case"area":case"br":case"embed":case"img":case"keygen":case"wbr":To(),yn(de,et),Ke.pop(),dn=!1;return;case"input":To(),mr=yn(de,et),Ke.pop();var ba=mr.getAttribute("type");(!ba||ba.toLowerCase()!=="hidden")&&(dn=!1);return;case"param":case"source":case"track":yn(de,et),Ke.pop();return;case"hr":Ke.inButtonScope("p")&&xn(q,"p"),Cr(Ke.top,"menuitem")&&Ke.pop(),yn(de,et),Ke.pop(),dn=!1;return;case"image":xn(V,"img",et,wt);return;case"textarea":yn(de,et),lo=!0,dn=!1,Y=ec,Zi=Dt,Dt=kl;return;case"xmp":Ke.inButtonScope("p")&&xn(q,"p"),To(),dn=!1,Xo(de,et);return;case"iframe":dn=!1,Xo(de,et);return;case"noembed":Xo(de,et);return;case"select":To(),yn(de,et),dn=!1,Dt===cs||Dt===qc||Dt===Ol||Dt===Gc||Dt===Is?Dt=Wc:Dt=us;return;case"optgroup":case"option":Ke.top instanceof w.HTMLOptionElement&&xn(q,"option"),To(),yn(de,et);return;case"menuitem":Cr(Ke.top,"menuitem")&&Ke.pop(),To(),yn(de,et);return;case"rb":case"rtc":Ke.inScope("ruby")&&Ke.generateImpliedEndTags(),yn(de,et);return;case"rp":case"rt":Ke.inScope("ruby")&&Ke.generateImpliedEndTags("rtc"),yn(de,et);return;case"math":To(),eh(et),Pc(et),_u(de,et,r.MATHML),wt&&Ke.pop();return;case"svg":To(),Jd(et),Pc(et),_u(de,et,r.SVG),wt&&Ke.pop();return;case"caption":case"col":case"colgroup":case"frame":case"head":case"tbody":case"td":case"tfoot":case"th":case"thead":case"tr":return}To(),yn(de,et);return;case 3:switch(de){case"template":yo(q,de,et);return;case"body":if(!Ke.inScope("body"))return;Dt=sp;return;case"html":if(!Ke.inScope("body"))return;Dt=sp,Dt(ce,de,et);return;case"address":case"article":case"aside":case"blockquote":case"button":case"center":case"details":case"dialog":case"dir":case"div":case"dl":case"fieldset":case"figcaption":case"figure":case"footer":case"header":case"hgroup":case"listing":case"main":case"menu":case"nav":case"ol":case"pre":case"section":case"summary":case"ul":if(!Ke.inScope(de))return;Ke.generateImpliedEndTags(),Ke.popTag(de);return;case"form":if(Ke.contains("template")){if(!Ke.inScope("form"))return;Ke.generateImpliedEndTags(),Ke.popTag("form")}else{var qs=Rn;if(Rn=null,!qs||!Ke.elementInScope(qs))return;Ke.generateImpliedEndTags(),Ke.removeElement(qs)}return;case"p":Ke.inButtonScope(de)?(Ke.generateImpliedEndTags(de),Ke.popTag(de)):(xn(V,de,null),Dt(ce,de,et,wt));return;case"li":if(!Ke.inListItemScope(de))return;Ke.generateImpliedEndTags(de),Ke.popTag(de);return;case"dd":case"dt":if(!Ke.inScope(de))return;Ke.generateImpliedEndTags(de),Ke.popTag(de);return;case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":if(!Ke.elementTypeInScope(w.HTMLHeadingElement))return;Ke.generateImpliedEndTags(),Ke.popElementType(w.HTMLHeadingElement);return;case"sarcasm":break;case"a":case"b":case"big":case"code":case"em":case"font":case"i":case"nobr":case"s":case"small":case"strike":case"strong":case"tt":case"u":var Pl=Lc(de);if(Pl)return;break;case"applet":case"marquee":case"object":if(!Ke.inScope(de))return;Ke.generateImpliedEndTags(),Ke.popTag(de),Gi.clearToMarker();return;case"br":xn(V,de,null);return}for(Li=Ke.elements.length-1;Li>=0;Li--)if(Tn=Ke.elements[Li],Cr(Tn,de)){Ke.generateImpliedEndTags(de),Ke.popElement(Tn);break}else if(Cr(Tn,Pe))return;return}}function kl(ce,de,et,wt){switch(ce){case 1:Dl(de);return;case-1:Ke.top instanceof w.HTMLScriptElement&&(Ke.top._already_started=!0),Ke.pop(),Dt=Zi,Dt(ce);return;case 3:de==="script"?ya():(Ke.pop(),Dt=Zi);return;default:return}}function cs(ce,de,et,wt){function Zt(Tn){for(var mr=0,go=Tn.length;mr<go;mr++)if(Tn[mr][0]==="type")return Tn[mr][1].toLowerCase();return null}switch(ce){case 1:if(ua){xn(ce,de,et,wt);return}else if(Cr(Ke.top,Rt)){Co=[],Zi=Dt,Dt=Xm,Dt(ce,de,et,wt);return}break;case 4:Tl(de);return;case 5:return;case 2:switch(de){case"caption":Ke.clearToContext(We),Gi.insertMarker(),yn(de,et),Dt=qc;return;case"colgroup":Ke.clearToContext(We),yn(de,et),Dt=$c;return;case"col":cs(V,"colgroup",null),Dt(ce,de,et,wt);return;case"tbody":case"tfoot":case"thead":Ke.clearToContext(We),yn(de,et),Dt=Ol;return;case"td":case"th":case"tr":cs(V,"tbody",null),Dt(ce,de,et,wt);return;case"table":if(!Ke.inTableScope(de))return;cs(q,de),Dt(ce,de,et,wt);return;case"style":case"script":case"template":yo(ce,de,et,wt);return;case"input":var Li=Zt(et);if(Li!=="hidden")break;yn(de,et),Ke.pop();return;case"form":if(Rn||Ke.contains("template"))return;Rn=yn(de,et),Ke.popElement(Rn);return}break;case 3:switch(de){case"table":if(!Ke.inTableScope(de))return;Ke.popTag(de),kn();return;case"body":case"caption":case"col":case"colgroup":case"html":case"tbody":case"td":case"tfoot":case"th":case"thead":case"tr":return;case"template":yo(ce,de,et,wt);return}break;case-1:xn(ce,de,et,wt);return}Sn=!0,xn(ce,de,et,wt),Sn=!1}function Xm(ce,de,et,wt){if(ce===N){if(So&&(de=de.replace(pn,""),de.length===0))return;Co.push(de)}else{var Zt=Co.join("");Co.length=0,zs.test(Zt)?(Sn=!0,xn(N,Zt),Sn=!1):Dl(Zt),Dt=Zi,Dt(ce,de,et,wt)}}function qc(ce,de,et,wt){function Zt(){return Ke.inTableScope("caption")?(Ke.generateImpliedEndTags(),Ke.popTag("caption"),Gi.clearToMarker(),Dt=cs,!0):!1}switch(ce){case 2:switch(de){case"caption":case"col":case"colgroup":case"tbody":case"td":case"tfoot":case"th":case"thead":case"tr":Zt()&&Dt(ce,de,et,wt);return}break;case 3:switch(de){case"caption":Zt();return;case"table":Zt()&&Dt(ce,de,et,wt);return;case"body":case"col":case"colgroup":case"html":case"tbody":case"td":case"tfoot":case"th":case"thead":case"tr":return}break}xn(ce,de,et,wt)}function $c(ce,de,et,wt){switch(ce){case 1:var Zt=de.match(il);if(Zt&&(Dl(Zt[0]),de=de.substring(Zt[0].length)),de.length===0)return;break;case 4:Tl(de);return;case 5:return;case 2:switch(de){case"html":xn(ce,de,et,wt);return;case"col":yn(de,et),Ke.pop();return;case"template":yo(ce,de,et,wt);return}break;case 3:switch(de){case"colgroup":if(!Cr(Ke.top,"colgroup"))return;Ke.pop(),Dt=cs;return;case"col":return;case"template":yo(ce,de,et,wt);return}break;case-1:xn(ce,de,et,wt);return}Cr(Ke.top,"colgroup")&&($c(q,"colgroup"),Dt(ce,de,et,wt))}function Ol(ce,de,et,wt){function Zt(){!Ke.inTableScope("tbody")&&!Ke.inTableScope("thead")&&!Ke.inTableScope("tfoot")||(Ke.clearToContext(Pt),Ol(q,Ke.top.localName,null),Dt(ce,de,et,wt))}switch(ce){case 2:switch(de){case"tr":Ke.clearToContext(Pt),yn(de,et),Dt=Gc;return;case"th":case"td":Ol(V,"tr",null),Dt(ce,de,et,wt);return;case"caption":case"col":case"colgroup":case"tbody":case"tfoot":case"thead":Zt();return}break;case 3:switch(de){case"table":Zt();return;case"tbody":case"tfoot":case"thead":Ke.inTableScope(de)&&(Ke.clearToContext(Pt),Ke.pop(),Dt=cs);return;case"body":case"caption":case"col":case"colgroup":case"html":case"td":case"th":case"tr":return}break}cs(ce,de,et,wt)}function Gc(ce,de,et,wt){function Zt(){return Ke.inTableScope("tr")?(Ke.clearToContext(ui),Ke.pop(),Dt=Ol,!0):!1}switch(ce){case 2:switch(de){case"th":case"td":Ke.clearToContext(ui),yn(de,et),Dt=Is,Gi.insertMarker();return;case"caption":case"col":case"colgroup":case"tbody":case"tfoot":case"thead":case"tr":Zt()&&Dt(ce,de,et,wt);return}break;case 3:switch(de){case"tr":Zt();return;case"table":Zt()&&Dt(ce,de,et,wt);return;case"tbody":case"tfoot":case"thead":Ke.inTableScope(de)&&Zt()&&Dt(ce,de,et,wt);return;case"body":case"caption":case"col":case"colgroup":case"html":case"td":case"th":return}break}cs(ce,de,et,wt)}function Is(ce,de,et,wt){switch(ce){case 2:switch(de){case"caption":case"col":case"colgroup":case"tbody":case"td":case"tfoot":case"th":case"thead":case"tr":Ke.inTableScope("td")?(Is(q,"td"),Dt(ce,de,et,wt)):Ke.inTableScope("th")&&(Is(q,"th"),Dt(ce,de,et,wt));return}break;case 3:switch(de){case"td":case"th":if(!Ke.inTableScope(de))return;Ke.generateImpliedEndTags(),Ke.popTag(de),Gi.clearToMarker(),Dt=Gc;return;case"body":case"caption":case"col":case"colgroup":case"html":return;case"table":case"tbody":case"tfoot":case"thead":case"tr":if(!Ke.inTableScope(de))return;Is(q,Ke.inTableScope("td")?"td":"th"),Dt(ce,de,et,wt);return}break}xn(ce,de,et,wt)}function us(ce,de,et,wt){switch(ce){case 1:if(So&&(de=de.replace(pn,""),de.length===0))return;Dl(de);return;case 4:Tl(de);return;case 5:return;case-1:xn(ce,de,et,wt);return;case 2:switch(de){case"html":xn(ce,de,et,wt);return;case"option":Ke.top instanceof w.HTMLOptionElement&&us(q,de),yn(de,et);return;case"optgroup":Ke.top instanceof w.HTMLOptionElement&&us(q,"option"),Ke.top instanceof w.HTMLOptGroupElement&&us(q,de),yn(de,et);return;case"select":us(q,de);return;case"input":case"keygen":case"textarea":if(!Ke.inSelectScope("select"))return;us(q,"select"),Dt(ce,de,et,wt);return;case"script":case"template":yo(ce,de,et,wt);return}break;case 3:switch(de){case"optgroup":Ke.top instanceof w.HTMLOptionElement&&Ke.elements[Ke.elements.length-2]instanceof w.HTMLOptGroupElement&&us(q,"option"),Ke.top instanceof w.HTMLOptGroupElement&&Ke.pop();return;case"option":Ke.top instanceof w.HTMLOptionElement&&Ke.pop();return;case"select":if(!Ke.inSelectScope(de))return;Ke.popTag(de),kn();return;case"template":yo(ce,de,et,wt);return}break}}function Wc(ce,de,et,wt){switch(de){case"caption":case"table":case"tbody":case"tfoot":case"thead":case"tr":case"td":case"th":switch(ce){case 2:Wc(q,"select"),Dt(ce,de,et,wt);return;case 3:Ke.inTableScope(de)&&(Wc(q,"select"),Dt(ce,de,et,wt));return}}us(ce,de,et,wt)}function ap(ce,de,et,wt){function Zt(Li){Dt=Li,Yi[Yi.length-1]=Dt,Dt(ce,de,et,wt)}switch(ce){case 1:case 4:case 5:xn(ce,de,et,wt);return;case-1:Ke.contains("template")?(Ke.popTag("template"),Gi.clearToMarker(),Yi.pop(),kn(),Dt(ce,de,et,wt)):jr();return;case 2:switch(de){case"base":case"basefont":case"bgsound":case"link":case"meta":case"noframes":case"script":case"style":case"template":case"title":yo(ce,de,et,wt);return;case"caption":case"colgroup":case"tbody":case"tfoot":case"thead":Zt(cs);return;case"col":Zt($c);return;case"tr":Zt(Ol);return;case"td":case"th":Zt(Gc);return}Zt(xn);return;case 3:switch(de){case"template":yo(ce,de,et,wt);return;default:return}}}function sp(ce,de,et,wt){switch(ce){case 1:if(zs.test(de))break;xn(ce,de);return;case 4:Ke.elements[0]._appendChild(xr.createComment(de));return;case 5:return;case-1:jr();return;case 2:if(de==="html"){xn(ce,de,et,wt);return}break;case 3:if(de==="html"){if(Sr)return;Dt=In;return}break}Dt=xn,Dt(ce,de,et,wt)}function ud(ce,de,et,wt){switch(ce){case 1:de=de.replace(kc,""),de.length>0&&Dl(de);return;case 4:Tl(de);return;case 5:return;case-1:jr();return;case 2:switch(de){case"html":xn(ce,de,et,wt);return;case"frameset":yn(de,et);return;case"frame":yn(de,et),Ke.pop();return;case"noframes":yo(ce,de,et,wt);return}break;case 3:if(de==="frameset"){if(Sr&&Ke.top instanceof w.HTMLHtmlElement)return;Ke.pop(),!Sr&&!(Ke.top instanceof w.HTMLFrameSetElement)&&(Dt=ac);return}break}}function ac(ce,de,et,wt){switch(ce){case 1:de=de.replace(kc,""),de.length>0&&Dl(de);return;case 4:Tl(de);return;case 5:return;case-1:jr();return;case 2:switch(de){case"html":xn(ce,de,et,wt);return;case"noframes":yo(ce,de,et,wt);return}break;case 3:if(de==="html"){Dt=Q0;return}break}}function In(ce,de,et,wt){switch(ce){case 1:if(zs.test(de))break;xn(ce,de,et,wt);return;case 4:xr._appendChild(xr.createComment(de));return;case 5:xn(ce,de,et,wt);return;case-1:jr();return;case 2:if(de==="html"){xn(ce,de,et,wt);return}break}Dt=xn,Dt(ce,de,et,wt)}function Q0(ce,de,et,wt){switch(ce){case 1:de=de.replace(kc,""),de.length>0&&xn(ce,de,et,wt);return;case 4:xr._appendChild(xr.createComment(de));return;case 5:xn(ce,de,et,wt);return;case-1:jr();return;case 2:switch(de){case"html":xn(ce,de,et,wt);return;case"noframes":yo(ce,de,et,wt);return}break}}function Qm(ce,de,et,wt){function Zt(go){for(var ba=0,qs=go.length;ba<qs;ba++)switch(go[ba][0]){case"color":case"face":case"size":return!0}return!1}var Li;switch(ce){case 1:dn&&Oc.test(de)&&(dn=!1),So&&(de=de.replace(pn,"\uFFFD")),Dl(de);return;case 4:Tl(de);return;case 5:return;case 2:switch(de){case"font":if(!Zt(et))break;case"b":case"big":case"blockquote":case"body":case"br":case"center":case"code":case"dd":case"div":case"dl":case"dt":case"em":case"embed":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":case"head":case"hr":case"i":case"img":case"li":case"listing":case"menu":case"meta":case"nobr":case"ol":case"p":case"pre":case"ruby":case"s":case"small":case"span":case"strong":case"strike":case"sub":case"sup":case"table":case"tt":case"u":case"ul":case"var":if(Sr)break;do Ke.pop(),Li=Ke.top;while(Li.namespaceURI!==r.HTML&&!Da(Li)&&!Kl(Li));pi(ce,de,et,wt);return}Li=Ke.elements.length===1&&Sr?Gt:Ke.top,Li.namespaceURI===r.MATHML?eh(et):Li.namespaceURI===r.SVG&&(de=Xl(de),Jd(et)),Pc(et),_u(de,et,Li.namespaceURI),wt&&Ke.pop();return;case 3:if(Li=Ke.top,de==="script"&&Li.namespaceURI===r.SVG&&Li.localName==="script")Ke.pop();else for(var Tn=Ke.elements.length-1,mr=Ke.elements[Tn];;){if(mr.localName.toLowerCase()===de){Ke.popElement(mr);break}if(mr=Ke.elements[--Tn],mr.namespaceURI===r.HTML){Dt(ce,de,et,wt);break}}return}}return No.testTokenizer=function(ce,de,et,wt){var Zt=[];switch(de){case"PCDATA state":Y=cr;break;case"RCDATA state":Y=ec;break;case"RAWTEXT state":Y=tc;break;case"PLAINTEXT state":Y=id;break}if(et&&(ze=et),pi=function(Tn,mr,go,ba){switch(mu(),Tn){case 1:Zt.length>0&&Zt[Zt.length-1][0]==="Character"?Zt[Zt.length-1][1]+=mr:Zt.push(["Character",mr]);break;case 4:Zt.push(["Comment",mr]);break;case 5:Zt.push(["DOCTYPE",mr,go===void 0?null:go,ba===void 0?null:ba,!Jr]);break;case 2:for(var qs=Object.create(null),Pl=0;Pl<go.length;Pl++){var Nl=go[Pl];Nl.length===1?qs[Nl[0]]="":qs[Nl[0]]=Nl[1]}var sl=["StartTag",mr,qs];ba&&sl.push(!0),Zt.push(sl);break;case 3:Zt.push(["EndTag",mr]);break}},!wt)this.parse(ce,!0);else{for(var Li=0;Li<ce.length;Li++)this.parse(ce[Li]);this.parse("",!0)}return Zt},No}}}),KT=Bn({"external/npm/node_modules/domino/lib/DOMImplementation.js"(t,i){i.exports=w;var e=FP(),n=zP(),o=BP(),r=Ba(),g=RP();function w(k){this.contextObject=k}var T={xml:{"":!0,"1.0":!0,"2.0":!0},core:{"":!0,"2.0":!0},html:{"":!0,"1.0":!0,"2.0":!0},xhtml:{"":!0,"1.0":!0,"2.0":!0}};w.prototype={hasFeature:function(N,V){var q=T[(N||"").toLowerCase()];return q&&q[V||""]||!1},createDocumentType:function(N,V,q){return g.isValidQName(N)||r.InvalidCharacterError(),new n(this.contextObject,N,V,q)},createDocument:function(N,V,q){var Z=new e(!1,null),X;return V?X=Z.createElementNS(N,V):X=null,q&&Z.appendChild(q),X&&Z.appendChild(X),N===r.NAMESPACE.HTML?Z._contentType="application/xhtml+xml":N===r.NAMESPACE.SVG?Z._contentType="image/svg+xml":Z._contentType="application/xml",Z},createHTMLDocument:function(N){var V=new e(!0,null);V.appendChild(new n(V,"html"));var q=V.createElement("html");V.appendChild(q);var Z=V.createElement("head");if(q.appendChild(Z),N!==void 0){var X=V.createElement("title");Z.appendChild(X),X.appendChild(V.createTextNode(N))}return q.appendChild(V.createElement("body")),V.modclock=1,V},mozSetOutputMutationHandler:function(k,N){k.mutationHandler=N},mozGetInputMutationHandler:function(k){r.nyi()},mozHTMLParser:o}}}),nde=Bn({"external/npm/node_modules/domino/lib/Location.js"(t,i){var e=PP(),n=iq();i.exports=o;function o(r,g){this._window=r,this._href=g}o.prototype=Object.create(n.prototype,{constructor:{value:o},href:{get:function(){return this._href},set:function(r){this.assign(r)}},assign:{value:function(r){var g=new e(this._href),w=g.resolve(r);this._href=w}},replace:{value:function(r){this.assign(r)}},reload:{value:function(){this.assign(this.href)}},toString:{value:function(){return this.href}}})}}),rde=Bn({"external/npm/node_modules/domino/lib/NavigatorID.js"(t,i){var e=Object.create(null,{appCodeName:{value:"Mozilla"},appName:{value:"Netscape"},appVersion:{value:"4.0"},platform:{value:""},product:{value:"Gecko"},productSub:{value:"20100101"},userAgent:{value:""},vendor:{value:""},vendorSub:{value:""},taintEnabled:{value:function(){return!1}}});i.exports=e}}),ode=Bn({"external/npm/node_modules/domino/lib/WindowTimers.js"(t,i){var e={setTimeout,clearTimeout,setInterval,clearInterval};i.exports=e}}),oq=Bn({"external/npm/node_modules/domino/lib/impl.js"(t,i){var e=Ba();t=i.exports={CSSStyleDeclaration:NP(),CharacterData:ZT(),Comment:XH(),DOMException:MP(),DOMImplementation:KT(),DOMTokenList:GH(),Document:FP(),DocumentFragment:QH(),DocumentType:zP(),Element:ew(),HTMLParser:BP(),NamedNodeMap:ZH(),Node:xl(),NodeList:Xy(),NodeFilter:YT(),ProcessingInstruction:JH(),Text:KH(),Window:aq()},e.merge(t,tq()),e.merge(t,LP().elements),e.merge(t,rq().elements)}}),aq=Bn({"external/npm/node_modules/domino/lib/Window.js"(t,i){var e=KT(),n=UH(),o=nde(),r=Ba();i.exports=g;function g(w){this.document=w||new e(null).createHTMLDocument(""),this.document._scripting_enabled=!0,this.document.defaultView=this,this.location=new o(this,this.document._address||"about:blank")}g.prototype=Object.create(n.prototype,{console:{value:console},history:{value:{back:r.nyi,forward:r.nyi,go:r.nyi}},navigator:{value:rde()},window:{get:function(){return this}},self:{get:function(){return this}},frames:{get:function(){return this}},parent:{get:function(){return this}},top:{get:function(){return this}},length:{value:0},frameElement:{value:null},opener:{value:null},onload:{get:function(){return this._getEventHandler("load")},set:function(w){this._setEventHandler("load",w)}},getComputedStyle:{value:function(T){return T.style}}}),r.expose(ode(),g),r.expose(oq(),g)}}),ade=Bn({"external/npm/node_modules/domino/lib/index.js"(t){var i=KT(),e=BP();aq();var n=oq();t.createDOMImplementation=function(){return new i(null)},t.createDocument=function(o,r){if(o||r){var g=new e;return g.parse(o||"",!0),g.document()}return new i(null).createHTMLDocument("")},t.createIncrementalHTMLParser=function(){var o=new e;return{write:function(r){r.length>0&&o.parse(r,!1,function(){return!0})},end:function(r){o.parse(r||"",!0,function(){return!0})},process:function(r){return o.parse("",!1,r)},document:function(){return o.document()}}},t.createWindow=function(o,r){var g=t.createDocument(o);return r!==void 0&&(g._address=r),new n.Window(g)},t.impl=n}}),WT=ade();function sde(){Object.assign(globalThis,WT.impl),globalThis.KeyboardEvent=WT.impl.Event}function sq(t,i="/"){return WT.createWindow(t,i).document}function lde(t){return t.serialize()}var cde=(()=>{class t extends a0{static makeCurrent(){sde(),_x(new t)}supportsDOMEvents=!1;static defaultDoc;createHtmlDocument(){return sq("<html><head><title>fakeTitle</title></head><body></body></html>")}getDefaultDocument(){return t.defaultDoc||(t.defaultDoc=WT.createDocument()),t.defaultDoc}isElementNode(e){return e?e.nodeType===t.defaultDoc.ELEMENT_NODE:!1}isShadowRoot(e){return e.shadowRoot==e}getGlobalEventTarget(e,n){return n==="window"?e.defaultView:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){return e.documentElement.querySelector("base")?.getAttribute("href")||""}dispatchEvent(e,n){e.dispatchEvent(n);let r=(e.ownerDocument||e).defaultView;r&&r.dispatchEvent(n)}getUserAgent(){return"Fake user agent"}getCookie(e){throw new Error("getCookie has not been implemented")}}return t})(),m0=new Ot("Server.INITIAL_CONFIG"),VP=new Ot("Server.RENDER_MODULE_HOOK"),ude=new Ot("ENABLE_DOM_EMULATION"),jP=(()=>{class t{_doc;_enableDomEmulation=UP(J(wn));constructor(e){this._doc=e}renderToString(){let e="renderToString";Lu(e);let n=this._enableDomEmulation?lde(this._doc):this._doc.documentElement.outerHTML;return Fu(e),n}getDocument(){return this._doc}static \u0275fac=function(n){return new(n||t)(bi(cn))};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})();function UP(t){return t.get(ude,!0)}var dde=(()=>{class t{xhrImpl;\u0275loadImpl(){return Go(this,null,function*(){if(!this.xhrImpl){let{default:e}=yield import("./chunk-FE3ZEMPP.mjs");this.xhrImpl=e}})}build(){let e=this.xhrImpl;if(!e)throw new Error("Unexpected state in ServerXhr: XHR implementation is not loaded.");return new e.XMLHttpRequest}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})();function hde(t,i){let e=J(Nh),{href:n,protocol:o,hostname:r,port:g}=e;if(!o.startsWith("http"))return i(t);let w=`${o}//${r}`;g&&(w+=`:${g}`);let T=e.getBaseHrefFromDOM()||n,k=new URL(T,w),N=new URL(t.url,k).toString();return i(t.clone({url:N}))}var pde=[{provide:Np,useClass:dde},{provide:Ox,useValue:hde,multi:!0}],zH="resolve:";function BH(t){let{hostname:i,protocol:e,port:n,pathname:o,search:r,hash:g}=new URL(t,zH+"//");return{hostname:i,protocol:e===zH?"":e,port:n,pathname:o,search:r,hash:g}}var fde=(()=>{class t{_doc;href="/";hostname="/";protocol="/";port="/";pathname="/";search="";hash="";_hashUpdate=new gi;constructor(e,n){this._doc=e;let o=n;if(o&&o.url){let r=BH(o.url);this.protocol=r.protocol,this.hostname=r.hostname,this.port=r.port,this.pathname=r.pathname,this.search=r.search,this.hash=r.hash,this.href=e.location.href}}getBaseHrefFromDOM(){return Qs().getBaseHref(this._doc)}onPopState(e){return()=>{}}onHashChange(e){let n=this._hashUpdate.subscribe(e);return()=>n.unsubscribe()}get url(){return`${this.pathname}${this.search}${this.hash}`}setHash(e,n){if(this.hash===e)return;this.hash=e;let o=this.url;queueMicrotask(()=>this._hashUpdate.next({type:"hashchange",state:null,oldUrl:n,newUrl:o}))}replaceState(e,n,o){let r=this.url,g=BH(o);this.pathname=g.pathname,this.search=g.search,this.setHash(g.hash,r)}pushState(e,n,o){this.replaceState(e,n,o)}forward(){throw new Error("Not implemented")}back(){throw new Error("Not implemented")}getState(){}static \u0275fac=function(n){return new(n||t)(bi(cn),bi(m0,8))};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})(),mde=(()=>{class t extends am{doc;constructor(e){super(e),this.doc=e}supports(e){return!0}addEventListener(e,n,o,r){return Qs().onAndCancel(e,n,o,r)}static \u0275fac=function(n){return new(n||t)(bi(cn))};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})();var gde=[{provide:VP,useFactory:_de,multi:!0}];function HP(t,i,e){let n=t.createElement("script");return n.textContent=i,e&&n.setAttribute("nonce",e),n}function _de(){let t=J(cn),i=J(Ou),e=J(t0),n=J(wn);return()=>{let o="serializeTransferStateFactory";Lu(o);let r=e.toJson();if(e.isEmpty)return;let g=HP(t,r,null);g.id=i+"-state",g.setAttribute("type","application/json"),t.body.appendChild(g),Fu(o)}}var yde=[{provide:cn,useFactory:xde,deps:[wn]},{provide:Ns,useValue:nT},{provide:ox,useFactory:vde,multi:!0,deps:[wn]},{provide:Nh,useClass:fde,deps:[cn,[Rh,m0]]},{provide:jP,deps:[cn]},{provide:HS,useValue:!0}];function vde(t){let i=UP(t);return()=>{i?cde.makeCurrent():a0.makeCurrent()}}var bde=[{provide:o0,multi:!0,useClass:mde}],lq=[gde,bde,pde,{provide:Ay,useValue:null},{provide:hx,useValue:null},{provide:oT,useClass:Sx}];function xde(t){let i=t.get(m0,null),e=UP(t),n;return i&&i.document?n=typeof i.document=="string"?e?sq(i.document,i.url):window.document:i.document:n=Qs().createHtmlDocument(),SS(n),n}function XT(t){let i=qS(MO,"server",yde)(t);return i.onDestroy(()=>{globalThis.ngServerMode=void 0}),i}function uq(){return eu([...lq])}var wde="ng-event-dispatch-contract";function dq(t){let i=t.platformProviders??[],e="createServerPlatform";Lu(e);let n=XT([{provide:m0,useValue:{document:t.document,url:t.url}},i]);return Fu(e),n}function hq(t){return t.getElementById(wde)}function cq(t){hq(t)?.remove()}function Ede(t,i){let e="prepareForHydration";Lu(e);let n=i.injector,o=t.getDocument();if(!n.get(W2,!1)){cq(o);return}Cde(o);let r=Mj(i,o);r.regular.size||r.capture.size?Tde(n.get(Ou),o,r,n.get(e0,null)):cq(o),Fu(e)}function Cde(t){let i=t.createComment(Gk);t.body.firstChild?t.body.insertBefore(i,t.body.firstChild):t.body.append(i)}function Sde(t){let i=t.injector,e=Dde(i.get(qP,mq));t.components.forEach(n=>{let o=n.injector.get(Ko),r=n.location.nativeElement;r&&o.setAttribute(r,"ng-server-context",e)})}function Tde(t,i,e,n){let o="insertEventRecordScript";Lu(o);let{regular:r,capture:g}=e,w=hq(i);if(w){let T=`window.__jsaction_bootstrap(document.body,"${t}",${JSON.stringify(Array.from(r))},${JSON.stringify(Array.from(g))});`,k=HP(i,T,n);w.after(k)}Fu(o)}function pq(t,i){return Go(this,null,function*(){let e=t.injector.get(jP);Ede(e,i),Sde(i);let o=i.injector.get(VP,null);if(o){let r=[];for(let g of o)try{let w=g();w&&r.push(w)}catch(w){console.warn("Ignoring BEFORE_APP_SERIALIZED Exception: ",w)}if(r.length)for(let g of yield Promise.allSettled(r))g.status==="rejected"&&console.warn("Ignoring BEFORE_APP_SERIALIZED Exception: ",g.reason)}return e.renderToString()})}function fq(t){return new Promise(i=>{setTimeout(()=>{t.destroy(),i()},0)})}var mq="other",qP=new Ot("SERVER_CONTEXT");function Dde(t){let i=t.replace(/[^a-zA-Z0-9\-]/g,"");return i.length>0?i:mq}function gq(t,i){return Go(this,null,function*(){let{document:e,url:n,extraProviders:o}=i,r=dq({document:e,url:n,platformProviders:o});try{let w=(yield r.bootstrapModule(t)).injector.get(ms),T="whenStable";return Lu(T),yield w.whenStable(),Fu(T),yield pq(r,w)}finally{yield fq(r)}})}function _q(t,i){return Go(this,null,function*(){let e="renderApplication",n="bootstrap",o="_render";Lu(e);let r=dq(i);try{Lu(n);let g=yield t();Fu(n),Lu(o);let w="whenStable";Lu(w),yield g.whenStable(),Fu(w);let T=yield pq(r,g);return Fu(o),T}finally{yield fq(r),Fu(e)}})}function Mde(t){throw new Error(`[unenv] ${t} is not implemented yet!`)}function Ide(t){return Object.assign(()=>{throw Mde(t)},{__unenv__:!0})}var Ade=Ide("fs.readFile");function Rde(t){let i=function(...e){let n=e.pop();t().catch(o=>n(o)).then(o=>n(void 0,o))};return i.__promisify__=t,i.native=i,i}var kde=Rde(Ade),Ode=/^[A-Za-z]:\//;function mm(t=""){return t&&t.replace(/\\/g,"/").replace(Ode,i=>i.toUpperCase())}var Pde=/^[/\\]{2}/,Nde=/^[/\\](?![/\\])|^[/\\]{2}(?!\.)|^[A-Za-z]:[/\\]/,b$=/^[A-Za-z]:$/,yq=/^\/([A-Za-z]:)?$/,x$="/",w$=":",VN=function(t){if(t.length===0)return".";t=mm(t);let i=t.match(Pde),e=y0(t),n=t[t.length-1]==="/";return t=fD(t,!e),t.length===0?e?"/":n?"./":".":(n&&(t+="/"),b$.test(t)&&(t+="/"),i?e?`//${t}`:`//./${t}`:e&&!y0(t)?`/${t}`:t)},E$=function(...t){if(t.length===0)return".";let i;for(let e of t)e&&e.length>0&&(i===void 0?i=e:i+=`/${e}`);return i===void 0?".":VN(i.replace(/\/\/+/g,"/"))};function Lde(){return typeof process<"u"&&typeof process.cwd=="function"?process.cwd().replace(/\\/g,"/"):"/"}var rw=function(...t){t=t.map(n=>mm(n));let i="",e=!1;for(let n=t.length-1;n>=-1&&!e;n--){let o=n>=0?t[n]:Lde();!o||o.length===0||(i=`${o}/${i}`,e=y0(o))}return i=fD(i,!e),e&&!y0(i)?`/${i}`:i.length>0?i:"."};function fD(t,i){let e="",n=0,o=-1,r=0,g=null;for(let w=0;w<=t.length;++w){if(w<t.length)g=t[w];else{if(g==="/")break;g="/"}if(g==="/"){if(!(o===w-1||r===1))if(r===2){if(e.length<2||n!==2||e[e.length-1]!=="."||e[e.length-2]!=="."){if(e.length>2){let T=e.lastIndexOf("/");T===-1?(e="",n=0):(e=e.slice(0,T),n=e.length-1-e.lastIndexOf("/")),o=w,r=0;continue}else if(e.length>0){e="",n=0,o=w,r=0;continue}}i&&(e+=e.length>0?"/..":"..",n=2)}else e.length>0?e+=`/${t.slice(o+1,w)}`:e=t.slice(o+1,w),n=w-o-1;o=w,r=0}else g==="."&&r!==-1?++r:r=-1}return e}var y0=function(t){return Nde.test(t)},C$=function(t){return mm(t)},Fde=/.(\.[^./]+)$/,jN=function(t){let i=Fde.exec(mm(t));return i&&i[1]||""},S$=function(t,i){let e=rw(t).replace(yq,"$1").split("/"),n=rw(i).replace(yq,"$1").split("/");if(n[0][1]===":"&&e[0][1]===":"&&e[0]!==n[0])return n.join("/");let o=[...e];for(let r of o){if(n[0]!==r)break;e.shift(),n.shift()}return[...e.map(()=>".."),...n].join("/")},UN=function(t){let i=mm(t).replace(/\/$/,"").split("/").slice(0,-1);return i.length===1&&b$.test(i[0])&&(i[0]+="/"),i.join("/")||(y0(t)?"/":".")},T$=function(t){let i=[t.root,t.dir,t.base??t.name+t.ext].filter(Boolean);return mm(t.root?rw(...i):i.join("/"))},HN=function(t,i){let e=mm(t).split("/").pop();return i&&e.endsWith(i)?e.slice(0,-i.length):e},D$=function(t){let i=mm(t).split("/").shift()||"/",e=HN(t),n=jN(e);return{root:i,dir:UN(t),base:e,ext:n,name:e.slice(0,e.length-n.length)}},zde={__proto__:null,basename:HN,delimiter:w$,dirname:UN,extname:jN,format:T$,isAbsolute:y0,join:E$,normalize:VN,normalizeString:fD,parse:D$,relative:S$,resolve:rw,sep:x$,toNamespacedPath:C$},Bde=Object.freeze({__proto__:null,basename:HN,default:zde,delimiter:w$,dirname:UN,extname:jN,format:T$,isAbsolute:y0,join:E$,normalize:VN,normalizeString:fD,parse:D$,relative:S$,resolve:rw,sep:x$,toNamespacedPath:C$}),ev=ji(It({},Bde),{platform:"posix",posix:void 0,win32:void 0});ev.posix=ev;ev.win32=ev;function mD(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Vde(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var i=t.default;if(typeof i=="function"){var e=function n(){return this instanceof n?Reflect.construct(i,arguments,this.constructor):i.apply(this,arguments)};e.prototype=i.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var o=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,o.get?o:{enumerable:!0,get:function(){return t[n]}})}),e}var QT={exports:{}},vq;function M$(){if(vq)return QT.exports;vq=1;var t=String,i=function(){return{isColorSupported:!1,reset:t,bold:t,dim:t,italic:t,underline:t,inverse:t,hidden:t,strikethrough:t,black:t,red:t,green:t,yellow:t,blue:t,magenta:t,cyan:t,white:t,gray:t,bgBlack:t,bgRed:t,bgGreen:t,bgYellow:t,bgBlue:t,bgMagenta:t,bgCyan:t,bgWhite:t,blackBright:t,redBright:t,greenBright:t,yellowBright:t,blueBright:t,magentaBright:t,cyanBright:t,whiteBright:t,bgBlackBright:t,bgRedBright:t,bgGreenBright:t,bgYellowBright:t,bgBlueBright:t,bgMagentaBright:t,bgCyanBright:t,bgWhiteBright:t}};return QT.exports=i(),QT.exports.createColors=i,QT.exports}var jde={},Ude=Object.freeze({__proto__:null,default:jde}),Bd=Vde(Ude),$P,bq;function qN(){if(bq)return $P;bq=1;let t=M$(),i=Bd;class e extends Error{constructor(o,r,g,w,T,k){super(o),this.name="CssSyntaxError",this.reason=o,T&&(this.file=T),w&&(this.source=w),k&&(this.plugin=k),typeof r<"u"&&typeof g<"u"&&(typeof r=="number"?(this.line=r,this.column=g):(this.line=r.line,this.column=r.column,this.endLine=g.line,this.endColumn=g.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,e)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>",typeof this.line<"u"&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(o){if(!this.source)return"";let r=this.source;o==null&&(o=t.isColorSupported);let g=Z=>Z,w=Z=>Z,T=Z=>Z;if(o){let{bold:Z,gray:X,red:te}=t.createColors(!0);w=De=>Z(te(De)),g=De=>X(De),i&&(T=De=>i(De))}let k=r.split(/\r?\n/),N=Math.max(this.line-3,0),V=Math.min(this.line+2,k.length),q=String(V).length;return k.slice(N,V).map((Z,X)=>{let te=N+1+X,De=" "+(" "+te).slice(-q)+" | ";if(te===this.line){if(Z.length>160){let he=20,Ce=Math.max(0,this.column-he),Pe=Math.max(this.column+he,this.endColumn+he),ye=Z.slice(Ce,Pe),vt=g(De.replace(/\d/g," "))+Z.slice(0,Math.min(this.column-1,he-1)).replace(/[^\t]/g," ");return w(">")+g(De)+T(ye)+`
 `+vt+w("^")}let _e=g(De.replace(/\d/g," "))+Z.slice(0,this.column-1).replace(/[^\t]/g," ");return w(">")+g(De)+T(Z)+`
 `+_e+w("^")}return" "+g(De)+T(Z)}).join(`
`)}toString(){let o=this.showSourceCode();return o&&(o=`

`+o+`
`),this.name+": "+this.message+o}}return $P=e,e.default=e,$P}var GP,xq;function I$(){if(xq)return GP;xq=1;let t={after:`
`,beforeClose:`
`,beforeComment:`
`,beforeDecl:`
`,beforeOpen:" ",beforeRule:`
`,colon:": ",commentLeft:" ",commentRight:" ",emptyBody:"",indent:"    ",semicolon:!1};function i(n){return n[0].toUpperCase()+n.slice(1)}class e{constructor(o){this.builder=o}atrule(o,r){let g="@"+o.name,w=o.params?this.rawValue(o,"params"):"";if(typeof o.raws.afterName<"u"?g+=o.raws.afterName:w&&(g+=" "),o.nodes)this.block(o,g+w);else{let T=(o.raws.between||"")+(r?";":"");this.builder(g+w+T,o)}}beforeAfter(o,r){let g;o.type==="decl"?g=this.raw(o,null,"beforeDecl"):o.type==="comment"?g=this.raw(o,null,"beforeComment"):r==="before"?g=this.raw(o,null,"beforeRule"):g=this.raw(o,null,"beforeClose");let w=o.parent,T=0;for(;w&&w.type!=="root";)T+=1,w=w.parent;if(g.includes(`
`)){let k=this.raw(o,null,"indent");if(k.length)for(let N=0;N<T;N++)g+=k}return g}block(o,r){let g=this.raw(o,"between","beforeOpen");this.builder(r+g+"{",o,"start");let w;o.nodes&&o.nodes.length?(this.body(o),w=this.raw(o,"after")):w=this.raw(o,"after","emptyBody"),w&&this.builder(w),this.builder("}",o,"end")}body(o){let r=o.nodes.length-1;for(;r>0&&o.nodes[r].type==="comment";)r-=1;let g=this.raw(o,"semicolon");for(let w=0;w<o.nodes.length;w++){let T=o.nodes[w],k=this.raw(T,"before");k&&this.builder(k),this.stringify(T,r!==w||g)}}comment(o){let r=this.raw(o,"left","commentLeft"),g=this.raw(o,"right","commentRight");this.builder("/*"+r+o.text+g+"*/",o)}decl(o,r){let g=this.raw(o,"between","colon"),w=o.prop+g+this.rawValue(o,"value");o.important&&(w+=o.raws.important||" !important"),r&&(w+=";"),this.builder(w,o)}document(o){this.body(o)}raw(o,r,g){let w;if(g||(g=r),r&&(w=o.raws[r],typeof w<"u"))return w;let T=o.parent;if(g==="before"&&(!T||T.type==="root"&&T.first===o||T&&T.type==="document"))return"";if(!T)return t[g];let k=o.root();if(k.rawCache||(k.rawCache={}),typeof k.rawCache[g]<"u")return k.rawCache[g];if(g==="before"||g==="after")return this.beforeAfter(o,g);{let N="raw"+i(g);this[N]?w=this[N](k,o):k.walk(V=>{if(w=V.raws[r],typeof w<"u")return!1})}return typeof w>"u"&&(w=t[g]),k.rawCache[g]=w,w}rawBeforeClose(o){let r;return o.walk(g=>{if(g.nodes&&g.nodes.length>0&&typeof g.raws.after<"u")return r=g.raws.after,r.includes(`
`)&&(r=r.replace(/[^\n]+$/,"")),!1}),r&&(r=r.replace(/\S/g,"")),r}rawBeforeComment(o,r){let g;return o.walkComments(w=>{if(typeof w.raws.before<"u")return g=w.raws.before,g.includes(`
`)&&(g=g.replace(/[^\n]+$/,"")),!1}),typeof g>"u"?g=this.raw(r,null,"beforeDecl"):g&&(g=g.replace(/\S/g,"")),g}rawBeforeDecl(o,r){let g;return o.walkDecls(w=>{if(typeof w.raws.before<"u")return g=w.raws.before,g.includes(`
`)&&(g=g.replace(/[^\n]+$/,"")),!1}),typeof g>"u"?g=this.raw(r,null,"beforeRule"):g&&(g=g.replace(/\S/g,"")),g}rawBeforeOpen(o){let r;return o.walk(g=>{if(g.type!=="decl"&&(r=g.raws.between,typeof r<"u"))return!1}),r}rawBeforeRule(o){let r;return o.walk(g=>{if(g.nodes&&(g.parent!==o||o.first!==g)&&typeof g.raws.before<"u")return r=g.raws.before,r.includes(`
`)&&(r=r.replace(/[^\n]+$/,"")),!1}),r&&(r=r.replace(/\S/g,"")),r}rawColon(o){let r;return o.walkDecls(g=>{if(typeof g.raws.between<"u")return r=g.raws.between.replace(/[^\s:]/g,""),!1}),r}rawEmptyBody(o){let r;return o.walk(g=>{if(g.nodes&&g.nodes.length===0&&(r=g.raws.after,typeof r<"u"))return!1}),r}rawIndent(o){if(o.raws.indent)return o.raws.indent;let r;return o.walk(g=>{let w=g.parent;if(w&&w!==o&&w.parent&&w.parent===o&&typeof g.raws.before<"u"){let T=g.raws.before.split(`
`);return r=T[T.length-1],r=r.replace(/\S/g,""),!1}}),r}rawSemicolon(o){let r;return o.walk(g=>{if(g.nodes&&g.nodes.length&&g.last.type==="decl"&&(r=g.raws.semicolon,typeof r<"u"))return!1}),r}rawValue(o,r){let g=o[r],w=o.raws[r];return w&&w.value===g?w.raw:g}root(o){this.body(o),o.raws.after&&this.builder(o.raws.after)}rule(o){this.block(o,this.rawValue(o,"selector")),o.raws.ownSemicolon&&this.builder(o.raws.ownSemicolon,o,"end")}stringify(o,r){if(!this[o.type])throw new Error("Unknown AST node type "+o.type+". Maybe you need to change PostCSS stringifier.");this[o.type](o,r)}}return GP=e,e.default=e,GP}var WP,wq;function gD(){if(wq)return WP;wq=1;let t=I$();function i(e,n){new t(n).stringify(e)}return WP=i,i.default=i,WP}var JT={},Eq;function $N(){return Eq||(Eq=1,JT.isClean=Symbol("isClean"),JT.my=Symbol("my")),JT}var ZP,Cq;function _D(){if(Cq)return ZP;Cq=1;let t=qN(),i=I$(),e=gD(),{isClean:n,my:o}=$N();function r(T,k){let N=new T.constructor;for(let V in T){if(!Object.prototype.hasOwnProperty.call(T,V)||V==="proxyCache")continue;let q=T[V],Z=typeof q;V==="parent"&&Z==="object"?k&&(N[V]=k):V==="source"?N[V]=q:Array.isArray(q)?N[V]=q.map(X=>r(X,N)):(Z==="object"&&q!==null&&(q=r(q)),N[V]=q)}return N}function g(T,k){if(k&&typeof k.offset<"u")return k.offset;let N=1,V=1,q=0;for(let Z=0;Z<T.length;Z++){if(V===k.line&&N===k.column){q=Z;break}T[Z]===`
`?(N=1,V+=1):N+=1}return q}class w{constructor(k={}){this.raws={},this[n]=!1,this[o]=!0;for(let N in k)if(N==="nodes"){this.nodes=[];for(let V of k[N])typeof V.clone=="function"?this.append(V.clone()):this.append(V)}else this[N]=k[N]}addToError(k){if(k.postcssNode=this,k.stack&&this.source&&/\n\s{4}at /.test(k.stack)){let N=this.source;k.stack=k.stack.replace(/\n\s{4}at /,`$&${N.input.from}:${N.start.line}:${N.start.column}$&`)}return k}after(k){return this.parent.insertAfter(this,k),this}assign(k={}){for(let N in k)this[N]=k[N];return this}before(k){return this.parent.insertBefore(this,k),this}cleanRaws(k){delete this.raws.before,delete this.raws.after,k||delete this.raws.between}clone(k={}){let N=r(this);for(let V in k)N[V]=k[V];return N}cloneAfter(k={}){let N=this.clone(k);return this.parent.insertAfter(this,N),N}cloneBefore(k={}){let N=this.clone(k);return this.parent.insertBefore(this,N),N}error(k,N={}){if(this.source){let{end:V,start:q}=this.rangeBy(N);return this.source.input.error(k,{column:q.column,line:q.line},{column:V.column,line:V.line},N)}return new t(k)}getProxyProcessor(){return{get(k,N){return N==="proxyOf"?k:N==="root"?()=>k.root().toProxy():k[N]},set(k,N,V){return k[N]===V||(k[N]=V,(N==="prop"||N==="value"||N==="name"||N==="params"||N==="important"||N==="text")&&k.markDirty()),!0}}}markClean(){this[n]=!0}markDirty(){if(this[n]){this[n]=!1;let k=this;for(;k=k.parent;)k[n]=!1}}next(){if(!this.parent)return;let k=this.parent.index(this);return this.parent.nodes[k+1]}positionBy(k){let N=this.source.start;if(k.index)N=this.positionInside(k.index);else if(k.word){let V="document"in this.source.input?this.source.input.document:this.source.input.css,Z=V.slice(g(V,this.source.start),g(V,this.source.end)).indexOf(k.word);Z!==-1&&(N=this.positionInside(Z))}return N}positionInside(k){let N=this.source.start.column,V=this.source.start.line,q="document"in this.source.input?this.source.input.document:this.source.input.css,Z=g(q,this.source.start),X=Z+k;for(let te=Z;te<X;te++)q[te]===`
`?(N=1,V+=1):N+=1;return{column:N,line:V}}prev(){if(!this.parent)return;let k=this.parent.index(this);return this.parent.nodes[k-1]}rangeBy(k){let N={column:this.source.start.column,line:this.source.start.line},V=this.source.end?{column:this.source.end.column+1,line:this.source.end.line}:{column:N.column+1,line:N.line};if(k.word){let q="document"in this.source.input?this.source.input.document:this.source.input.css,X=q.slice(g(q,this.source.start),g(q,this.source.end)).indexOf(k.word);X!==-1&&(N=this.positionInside(X),V=this.positionInside(X+k.word.length))}else k.start?N={column:k.start.column,line:k.start.line}:k.index&&(N=this.positionInside(k.index)),k.end?V={column:k.end.column,line:k.end.line}:typeof k.endIndex=="number"?V=this.positionInside(k.endIndex):k.index&&(V=this.positionInside(k.index+1));return(V.line<N.line||V.line===N.line&&V.column<=N.column)&&(V={column:N.column+1,line:N.line}),{end:V,start:N}}raw(k,N){return new i().raw(this,k,N)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}replaceWith(...k){if(this.parent){let N=this,V=!1;for(let q of k)q===this?V=!0:V?(this.parent.insertAfter(N,q),N=q):this.parent.insertBefore(N,q);V||this.remove()}return this}root(){let k=this;for(;k.parent&&k.parent.type!=="document";)k=k.parent;return k}toJSON(k,N){let V={},q=N==null;N=N||new Map;let Z=0;for(let X in this){if(!Object.prototype.hasOwnProperty.call(this,X)||X==="parent"||X==="proxyCache")continue;let te=this[X];if(Array.isArray(te))V[X]=te.map(De=>typeof De=="object"&&De.toJSON?De.toJSON(null,N):De);else if(typeof te=="object"&&te.toJSON)V[X]=te.toJSON(null,N);else if(X==="source"){let De=N.get(te.input);De==null&&(De=Z,N.set(te.input,Z),Z++),V[X]={end:te.end,inputId:De,start:te.start}}else V[X]=te}return q&&(V.inputs=[...N.keys()].map(X=>X.toJSON())),V}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}toString(k=e){k.stringify&&(k=k.stringify);let N="";return k(this,V=>{N+=V}),N}warn(k,N,V){let q={node:this};for(let Z in V)q[Z]=V[Z];return k.warn(N,q)}get proxyOf(){return this}}return ZP=w,w.default=w,ZP}var YP,Sq;function yD(){if(Sq)return YP;Sq=1;let t=_D();class i extends t{constructor(n){super(n),this.type="comment"}}return YP=i,i.default=i,YP}var KP,Tq;function vD(){if(Tq)return KP;Tq=1;let t=_D();class i extends t{constructor(n){n&&typeof n.value<"u"&&typeof n.value!="string"&&(n=ji(It({},n),{value:String(n.value)})),super(n),this.type="decl"}get variable(){return this.prop.startsWith("--")||this.prop[0]==="$"}}return KP=i,i.default=i,KP}var XP,Dq;function w0(){if(Dq)return XP;Dq=1;let t=yD(),i=vD(),e=_D(),{isClean:n,my:o}=$N(),r,g,w,T;function k(q){return q.map(Z=>(Z.nodes&&(Z.nodes=k(Z.nodes)),delete Z.source,Z))}function N(q){if(q[n]=!1,q.proxyOf.nodes)for(let Z of q.proxyOf.nodes)N(Z)}let V=(()=>{class q extends e{append(...X){for(let te of X){let De=this.normalize(te,this.last);for(let _e of De)this.proxyOf.nodes.push(_e)}return this.markDirty(),this}cleanRaws(X){if(super.cleanRaws(X),this.nodes)for(let te of this.nodes)te.cleanRaws(X)}each(X){if(!this.proxyOf.nodes)return;let te=this.getIterator(),De,_e;for(;this.indexes[te]<this.proxyOf.nodes.length&&(De=this.indexes[te],_e=X(this.proxyOf.nodes[De],De),_e!==!1);)this.indexes[te]+=1;return delete this.indexes[te],_e}every(X){return this.nodes.every(X)}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;let X=this.lastEach;return this.indexes[X]=0,X}getProxyProcessor(){return{get(X,te){return te==="proxyOf"?X:X[te]?te==="each"||typeof te=="string"&&te.startsWith("walk")?(...De)=>X[te](...De.map(_e=>typeof _e=="function"?(he,Ce)=>_e(he.toProxy(),Ce):_e)):te==="every"||te==="some"?De=>X[te]((_e,...he)=>De(_e.toProxy(),...he)):te==="root"?()=>X.root().toProxy():te==="nodes"?X.nodes.map(De=>De.toProxy()):te==="first"||te==="last"?X[te].toProxy():X[te]:X[te]},set(X,te,De){return X[te]===De||(X[te]=De,(te==="name"||te==="params"||te==="selector")&&X.markDirty()),!0}}}index(X){return typeof X=="number"?X:(X.proxyOf&&(X=X.proxyOf),this.proxyOf.nodes.indexOf(X))}insertAfter(X,te){let De=this.index(X),_e=this.normalize(te,this.proxyOf.nodes[De]).reverse();De=this.index(X);for(let Ce of _e)this.proxyOf.nodes.splice(De+1,0,Ce);let he;for(let Ce in this.indexes)he=this.indexes[Ce],De<he&&(this.indexes[Ce]=he+_e.length);return this.markDirty(),this}insertBefore(X,te){let De=this.index(X),_e=De===0?"prepend":!1,he=this.normalize(te,this.proxyOf.nodes[De],_e).reverse();De=this.index(X);for(let Pe of he)this.proxyOf.nodes.splice(De,0,Pe);let Ce;for(let Pe in this.indexes)Ce=this.indexes[Pe],De<=Ce&&(this.indexes[Pe]=Ce+he.length);return this.markDirty(),this}normalize(X,te){if(typeof X=="string")X=k(g(X).nodes);else if(typeof X>"u")X=[];else if(Array.isArray(X)){X=X.slice(0);for(let _e of X)_e.parent&&_e.parent.removeChild(_e,"ignore")}else if(X.type==="root"&&this.type!=="document"){X=X.nodes.slice(0);for(let _e of X)_e.parent&&_e.parent.removeChild(_e,"ignore")}else if(X.type)X=[X];else if(X.prop){if(typeof X.value>"u")throw new Error("Value field is missed in node creation");typeof X.value!="string"&&(X.value=String(X.value)),X=[new i(X)]}else if(X.selector||X.selectors)X=[new T(X)];else if(X.name)X=[new r(X)];else if(X.text)X=[new t(X)];else throw new Error("Unknown node type in node creation");return X.map(_e=>(_e[o]||q.rebuild(_e),_e=_e.proxyOf,_e.parent&&_e.parent.removeChild(_e),_e[n]&&N(_e),_e.raws||(_e.raws={}),typeof _e.raws.before>"u"&&te&&typeof te.raws.before<"u"&&(_e.raws.before=te.raws.before.replace(/\S/g,"")),_e.parent=this.proxyOf,_e))}prepend(...X){X=X.reverse();for(let te of X){let De=this.normalize(te,this.first,"prepend").reverse();for(let _e of De)this.proxyOf.nodes.unshift(_e);for(let _e in this.indexes)this.indexes[_e]=this.indexes[_e]+De.length}return this.markDirty(),this}push(X){return X.parent=this,this.proxyOf.nodes.push(X),this}removeAll(){for(let X of this.proxyOf.nodes)X.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}removeChild(X){X=this.index(X),this.proxyOf.nodes[X].parent=void 0,this.proxyOf.nodes.splice(X,1);let te;for(let De in this.indexes)te=this.indexes[De],te>=X&&(this.indexes[De]=te-1);return this.markDirty(),this}replaceValues(X,te,De){return De||(De=te,te={}),this.walkDecls(_e=>{te.props&&!te.props.includes(_e.prop)||te.fast&&!_e.value.includes(te.fast)||(_e.value=_e.value.replace(X,De))}),this.markDirty(),this}some(X){return this.nodes.some(X)}walk(X){return this.each((te,De)=>{let _e;try{_e=X(te,De)}catch(he){throw te.addToError(he)}return _e!==!1&&te.walk&&(_e=te.walk(X)),_e})}walkAtRules(X,te){return te?X instanceof RegExp?this.walk((De,_e)=>{if(De.type==="atrule"&&X.test(De.name))return te(De,_e)}):this.walk((De,_e)=>{if(De.type==="atrule"&&De.name===X)return te(De,_e)}):(te=X,this.walk((De,_e)=>{if(De.type==="atrule")return te(De,_e)}))}walkComments(X){return this.walk((te,De)=>{if(te.type==="comment")return X(te,De)})}walkDecls(X,te){return te?X instanceof RegExp?this.walk((De,_e)=>{if(De.type==="decl"&&X.test(De.prop))return te(De,_e)}):this.walk((De,_e)=>{if(De.type==="decl"&&De.prop===X)return te(De,_e)}):(te=X,this.walk((De,_e)=>{if(De.type==="decl")return te(De,_e)}))}walkRules(X,te){return te?X instanceof RegExp?this.walk((De,_e)=>{if(De.type==="rule"&&X.test(De.selector))return te(De,_e)}):this.walk((De,_e)=>{if(De.type==="rule"&&De.selector===X)return te(De,_e)}):(te=X,this.walk((De,_e)=>{if(De.type==="rule")return te(De,_e)}))}get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}}return q.registerParse=Z=>{g=Z},q.registerRule=Z=>{T=Z},q.registerAtRule=Z=>{r=Z},q.registerRoot=Z=>{w=Z},q})();return XP=V,V.default=V,V.rebuild=q=>{q.type==="atrule"?Object.setPrototypeOf(q,r.prototype):q.type==="rule"?Object.setPrototypeOf(q,T.prototype):q.type==="decl"?Object.setPrototypeOf(q,i.prototype):q.type==="comment"?Object.setPrototypeOf(q,t.prototype):q.type==="root"&&Object.setPrototypeOf(q,w.prototype),q[o]=!0,q.nodes&&q.nodes.forEach(Z=>{V.rebuild(Z)})},XP}var QP,Mq;function GN(){if(Mq)return QP;Mq=1;let t=w0();class i extends t{constructor(n){super(n),this.type="atrule"}append(...n){return this.proxyOf.nodes||(this.nodes=[]),super.append(...n)}prepend(...n){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...n)}}return QP=i,i.default=i,t.registerAtRule(i),QP}var JP,Iq;function WN(){if(Iq)return JP;Iq=1;let t=w0(),i,e,n=(()=>{class o extends t{constructor(g){super(It({type:"document"},g)),this.nodes||(this.nodes=[])}toResult(g={}){return new i(new e,this,g).stringify()}}return o.registerLazyResult=r=>{i=r},o.registerProcessor=r=>{e=r},o})();return JP=n,n.default=n,JP}var eN,Aq;function Hde(){if(Aq)return eN;Aq=1;let t="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";return eN={nanoid:(n=21)=>{let o="",r=n|0;for(;r--;)o+=t[Math.random()*64|0];return o},customAlphabet:(n,o=21)=>(r=o)=>{let g="",w=r|0;for(;w--;)g+=n[Math.random()*n.length|0];return g}},eN}var tN,Rq;function A$(){if(Rq)return tN;Rq=1;let{existsSync:t,readFileSync:i}=Bd,{dirname:e,join:n}=Bd,{SourceMapConsumer:o,SourceMapGenerator:r}=Bd;function g(T){return Buffer?Buffer.from(T,"base64").toString():window.atob(T)}class w{constructor(k,N){if(N.map===!1)return;this.loadAnnotation(k),this.inline=this.startWith(this.annotation,"data:");let V=N.map?N.map.prev:void 0,q=this.loadMap(N.from,V);!this.mapFile&&N.from&&(this.mapFile=N.from),this.mapFile&&(this.root=e(this.mapFile)),q&&(this.text=q)}consumer(){return this.consumerCache||(this.consumerCache=new o(this.text)),this.consumerCache}decodeInline(k){let N=/^data:application\/json;charset=utf-?8;base64,/,V=/^data:application\/json;base64,/,q=/^data:application\/json;charset=utf-?8,/,Z=/^data:application\/json,/,X=k.match(q)||k.match(Z);if(X)return decodeURIComponent(k.substr(X[0].length));let te=k.match(N)||k.match(V);if(te)return g(k.substr(te[0].length));let De=k.match(/data:application\/json;([^,]+),/)[1];throw new Error("Unsupported source map encoding "+De)}getAnnotationURL(k){return k.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}isMap(k){return typeof k!="object"?!1:typeof k.mappings=="string"||typeof k._mappings=="string"||Array.isArray(k.sections)}loadAnnotation(k){let N=k.match(/\/\*\s*# sourceMappingURL=/g);if(!N)return;let V=k.lastIndexOf(N.pop()),q=k.indexOf("*/",V);V>-1&&q>-1&&(this.annotation=this.getAnnotationURL(k.substring(V,q)))}loadFile(k){if(this.root=e(k),t(k))return this.mapFile=k,i(k,"utf-8").toString().trim()}loadMap(k,N){if(N===!1)return!1;if(N){if(typeof N=="string")return N;if(typeof N=="function"){let V=N(k);if(V){let q=this.loadFile(V);if(!q)throw new Error("Unable to load previous source map: "+V.toString());return q}}else{if(N instanceof o)return r.fromSourceMap(N).toString();if(N instanceof r)return N.toString();if(this.isMap(N))return JSON.stringify(N);throw new Error("Unsupported previous source map format: "+N.toString())}}else{if(this.inline)return this.decodeInline(this.annotation);if(this.annotation){let V=this.annotation;return k&&(V=n(e(k),V)),this.loadFile(V)}}}startWith(k,N){return k?k.substr(0,N.length)===N:!1}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}}return tN=w,w.default=w,tN}var iN,kq;function bD(){if(kq)return iN;kq=1;let{nanoid:t}=Hde(),{isAbsolute:i,resolve:e}=Bd,{SourceMapConsumer:n,SourceMapGenerator:o}=Bd,{fileURLToPath:r,pathToFileURL:g}=Bd,w=qN(),T=A$(),k=Bd,N=Symbol("fromOffsetCache"),V=!!(n&&o),q=!!(e&&i);class Z{constructor(te,De={}){if(te===null||typeof te>"u"||typeof te=="object"&&!te.toString)throw new Error(`PostCSS received ${te} instead of CSS string`);if(this.css=te.toString(),this.css[0]==="\uFEFF"||this.css[0]==="\uFFFE"?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,this.document=this.css,De.document&&(this.document=De.document.toString()),De.from&&(!q||/^\w+:\/\//.test(De.from)||i(De.from)?this.file=De.from:this.file=e(De.from)),q&&V){let _e=new T(this.css,De);if(_e.text){this.map=_e;let he=_e.consumer().file;!this.file&&he&&(this.file=this.mapResolve(he))}}this.file||(this.id="<input css "+t(6)+">"),this.map&&(this.map.file=this.from)}error(te,De,_e,he={}){let Ce,Pe,ye;if(De&&typeof De=="object"){let Rt=De,ut=_e;if(typeof Rt.offset=="number"){let ct=this.fromOffset(Rt.offset);De=ct.line,_e=ct.col}else De=Rt.line,_e=Rt.column;if(typeof ut.offset=="number"){let ct=this.fromOffset(ut.offset);Pe=ct.line,Ce=ct.col}else Pe=ut.line,Ce=ut.column}else if(!_e){let Rt=this.fromOffset(De);De=Rt.line,_e=Rt.col}let vt=this.origin(De,_e,Pe,Ce);return vt?ye=new w(te,vt.endLine===void 0?vt.line:{column:vt.column,line:vt.line},vt.endLine===void 0?vt.column:{column:vt.endColumn,line:vt.endLine},vt.source,vt.file,he.plugin):ye=new w(te,Pe===void 0?De:{column:_e,line:De},Pe===void 0?_e:{column:Ce,line:Pe},this.css,this.file,he.plugin),ye.input={column:_e,endColumn:Ce,endLine:Pe,line:De,source:this.css},this.file&&(g&&(ye.input.url=g(this.file).toString()),ye.input.file=this.file),ye}fromOffset(te){let De,_e;if(this[N])_e=this[N];else{let Ce=this.css.split(`
`);_e=new Array(Ce.length);let Pe=0;for(let ye=0,vt=Ce.length;ye<vt;ye++)_e[ye]=Pe,Pe+=Ce[ye].length+1;this[N]=_e}De=_e[_e.length-1];let he=0;if(te>=De)he=_e.length-1;else{let Ce=_e.length-2,Pe;for(;he<Ce;)if(Pe=he+(Ce-he>>1),te<_e[Pe])Ce=Pe-1;else if(te>=_e[Pe+1])he=Pe+1;else{he=Pe;break}}return{col:te-_e[he]+1,line:he+1}}mapResolve(te){return/^\w+:\/\//.test(te)?te:e(this.map.consumer().sourceRoot||this.map.root||".",te)}origin(te,De,_e,he){if(!this.map)return!1;let Ce=this.map.consumer(),Pe=Ce.originalPositionFor({column:De,line:te});if(!Pe.source)return!1;let ye;typeof _e=="number"&&(ye=Ce.originalPositionFor({column:he,line:_e}));let vt;i(Pe.source)?vt=g(Pe.source):vt=new URL(Pe.source,this.map.consumer().sourceRoot||g(this.map.mapFile));let Rt={column:Pe.column,endColumn:ye&&ye.column,endLine:ye&&ye.line,line:Pe.line,url:vt.toString()};if(vt.protocol==="file:")if(r)Rt.file=r(vt);else throw new Error("file: protocol is not available in this PostCSS build");let ut=Ce.sourceContentFor(Pe.source);return ut&&(Rt.source=ut),Rt}toJSON(){let te={};for(let De of["hasBOM","css","file","id"])this[De]!=null&&(te[De]=this[De]);return this.map&&(te.map=It({},this.map),te.map.consumerCache&&(te.map.consumerCache=void 0)),te}get from(){return this.file||this.id}}return iN=Z,Z.default=Z,k&&k.registerInput&&k.registerInput(Z),iN}var nN,Oq;function lw(){if(Oq)return nN;Oq=1;let t=w0(),i,e,n=(()=>{class o extends t{constructor(g){super(g),this.type="root",this.nodes||(this.nodes=[])}normalize(g,w,T){let k=super.normalize(g);if(w){if(T==="prepend")this.nodes.length>1?w.raws.before=this.nodes[1].raws.before:delete w.raws.before;else if(this.first!==w)for(let N of k)N.raws.before=w.raws.before}return k}removeChild(g,w){let T=this.index(g);return!w&&T===0&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[T].raws.before),super.removeChild(g)}toResult(g={}){return new i(new e,this,g).stringify()}}return o.registerLazyResult=r=>{i=r},o.registerProcessor=r=>{e=r},o})();return nN=n,n.default=n,t.registerRoot(n),nN}var rN,Pq;function R$(){if(Pq)return rN;Pq=1;let t={comma(i){return t.split(i,[","],!0)},space(i){let e=[" ",`
`,"	"];return t.split(i,e)},split(i,e,n){let o=[],r="",g=!1,w=0,T=!1,k="",N=!1;for(let V of i)N?N=!1:V==="\\"?N=!0:T?V===k&&(T=!1):V==='"'||V==="'"?(T=!0,k=V):V==="("?w+=1:V===")"?w>0&&(w-=1):w===0&&e.includes(V)&&(g=!0),g?(r!==""&&o.push(r.trim()),r="",g=!1):r+=V;return(n||r!=="")&&o.push(r.trim()),o}};return rN=t,t.default=t,rN}var oN,Nq;function ZN(){if(Nq)return oN;Nq=1;let t=w0(),i=R$();class e extends t{constructor(o){super(o),this.type="rule",this.nodes||(this.nodes=[])}get selectors(){return i.comma(this.selector)}set selectors(o){let r=this.selector?this.selector.match(/,\s*/):null,g=r?r[0]:","+this.raw("between","beforeOpen");this.selector=o.join(g)}}return oN=e,e.default=e,t.registerRule(e),oN}var aN,Lq;function qde(){if(Lq)return aN;Lq=1;let t=GN(),i=yD(),e=vD(),n=bD(),o=A$(),r=lw(),g=ZN();function w(T,k){if(Array.isArray(T))return T.map(X=>w(X));let q=T,{inputs:N}=q,V=Ys(q,["inputs"]);if(N){k=[];for(let X of N){let te=ji(It({},X),{__proto__:n.prototype});te.map&&(te.map=ji(It({},te.map),{__proto__:o.prototype})),k.push(te)}}if(V.nodes&&(V.nodes=T.nodes.map(X=>w(X,k))),V.source){let Z=V.source,{inputId:X}=Z,te=Ys(Z,["inputId"]);V.source=te,X!=null&&(V.source.input=k[X])}if(V.type==="root")return new r(V);if(V.type==="decl")return new e(V);if(V.type==="rule")return new g(V);if(V.type==="comment")return new i(V);if(V.type==="atrule")return new t(V);throw new Error("Unknown node type: "+T.type)}return aN=w,w.default=w,aN}var sN,Fq;function k$(){if(Fq)return sN;Fq=1;let{dirname:t,relative:i,resolve:e,sep:n}=Bd,{SourceMapConsumer:o,SourceMapGenerator:r}=Bd,{pathToFileURL:g}=Bd,w=bD(),T=!!(o&&r),k=!!(t&&e&&i&&n);class N{constructor(q,Z,X,te){this.stringify=q,this.mapOpts=X.map||{},this.root=Z,this.opts=X,this.css=te,this.originalCSS=te,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute,this.memoizedFileURLs=new Map,this.memoizedPaths=new Map,this.memoizedURLs=new Map}addAnnotation(){let q;this.isInline()?q="data:application/json;base64,"+this.toBase64(this.map.toString()):typeof this.mapOpts.annotation=="string"?q=this.mapOpts.annotation:typeof this.mapOpts.annotation=="function"?q=this.mapOpts.annotation(this.opts.to,this.root):q=this.outputFile()+".map";let Z=`
`;this.css.includes(`\r
`)&&(Z=`\r
`),this.css+=Z+"/*# sourceMappingURL="+q+" */"}applyPrevMaps(){for(let q of this.previous()){let Z=this.toUrl(this.path(q.file)),X=q.root||t(q.file),te;this.mapOpts.sourcesContent===!1?(te=new o(q.text),te.sourcesContent&&(te.sourcesContent=null)):te=q.consumer(),this.map.applySourceMap(te,Z,this.toUrl(this.path(X)))}}clearAnnotation(){if(this.mapOpts.annotation!==!1)if(this.root){let q;for(let Z=this.root.nodes.length-1;Z>=0;Z--)q=this.root.nodes[Z],q.type==="comment"&&q.text.startsWith("# sourceMappingURL=")&&this.root.removeChild(Z)}else this.css&&(this.css=this.css.replace(/\n*\/\*#[\S\s]*?\*\/$/gm,""))}generate(){if(this.clearAnnotation(),k&&T&&this.isMap())return this.generateMap();{let q="";return this.stringify(this.root,Z=>{q+=Z}),[q]}}generateMap(){if(this.root)this.generateString();else if(this.previous().length===1){let q=this.previous()[0].consumer();q.file=this.outputFile(),this.map=r.fromSourceMap(q,{ignoreInvalidMapping:!0})}else this.map=new r({file:this.outputFile(),ignoreInvalidMapping:!0}),this.map.addMapping({generated:{column:0,line:1},original:{column:0,line:1},source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>"});return this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline()?[this.css]:[this.css,this.map]}generateString(){this.css="",this.map=new r({file:this.outputFile(),ignoreInvalidMapping:!0});let q=1,Z=1,X="<no source>",te={generated:{column:0,line:0},original:{column:0,line:0},source:""},De,_e;this.stringify(this.root,(he,Ce,Pe)=>{if(this.css+=he,Ce&&Pe!=="end"&&(te.generated.line=q,te.generated.column=Z-1,Ce.source&&Ce.source.start?(te.source=this.sourcePath(Ce),te.original.line=Ce.source.start.line,te.original.column=Ce.source.start.column-1,this.map.addMapping(te)):(te.source=X,te.original.line=1,te.original.column=0,this.map.addMapping(te))),_e=he.match(/\n/g),_e?(q+=_e.length,De=he.lastIndexOf(`
`),Z=he.length-De):Z+=he.length,Ce&&Pe!=="start"){let ye=Ce.parent||{raws:{}};(!(Ce.type==="decl"||Ce.type==="atrule"&&!Ce.nodes)||Ce!==ye.last||ye.raws.semicolon)&&(Ce.source&&Ce.source.end?(te.source=this.sourcePath(Ce),te.original.line=Ce.source.end.line,te.original.column=Ce.source.end.column-1,te.generated.line=q,te.generated.column=Z-2,this.map.addMapping(te)):(te.source=X,te.original.line=1,te.original.column=0,te.generated.line=q,te.generated.column=Z-1,this.map.addMapping(te)))}})}isAnnotation(){return this.isInline()?!0:typeof this.mapOpts.annotation<"u"?this.mapOpts.annotation:this.previous().length?this.previous().some(q=>q.annotation):!0}isInline(){if(typeof this.mapOpts.inline<"u")return this.mapOpts.inline;let q=this.mapOpts.annotation;return typeof q<"u"&&q!==!0?!1:this.previous().length?this.previous().some(Z=>Z.inline):!0}isMap(){return typeof this.opts.map<"u"?!!this.opts.map:this.previous().length>0}isSourcesContent(){return typeof this.mapOpts.sourcesContent<"u"?this.mapOpts.sourcesContent:this.previous().length?this.previous().some(q=>q.withContent()):!0}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}path(q){if(this.mapOpts.absolute||q.charCodeAt(0)===60||/^\w+:\/\//.test(q))return q;let Z=this.memoizedPaths.get(q);if(Z)return Z;let X=this.opts.to?t(this.opts.to):".";typeof this.mapOpts.annotation=="string"&&(X=t(e(X,this.mapOpts.annotation)));let te=i(X,q);return this.memoizedPaths.set(q,te),te}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk(q=>{if(q.source&&q.source.input.map){let Z=q.source.input.map;this.previousMaps.includes(Z)||this.previousMaps.push(Z)}});else{let q=new w(this.originalCSS,this.opts);q.map&&this.previousMaps.push(q.map)}return this.previousMaps}setSourcesContent(){let q={};if(this.root)this.root.walk(Z=>{if(Z.source){let X=Z.source.input.from;if(X&&!q[X]){q[X]=!0;let te=this.usesFileUrls?this.toFileUrl(X):this.toUrl(this.path(X));this.map.setSourceContent(te,Z.source.input.css)}}});else if(this.css){let Z=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(Z,this.css)}}sourcePath(q){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(q.source.input.from):this.toUrl(this.path(q.source.input.from))}toBase64(q){return Buffer?Buffer.from(q).toString("base64"):window.btoa(unescape(encodeURIComponent(q)))}toFileUrl(q){let Z=this.memoizedFileURLs.get(q);if(Z)return Z;if(g){let X=g(q).toString();return this.memoizedFileURLs.set(q,X),X}else throw new Error("`map.absolute` option is not available in this PostCSS build")}toUrl(q){let Z=this.memoizedURLs.get(q);if(Z)return Z;n==="\\"&&(q=q.replace(/\\/g,"/"));let X=encodeURI(q).replace(/[#?]/g,encodeURIComponent);return this.memoizedURLs.set(q,X),X}}return sN=N,sN}var lN,zq;function $de(){if(zq)return lN;zq=1;let t=39,i=34,e=92,n=47,o=10,r=32,g=12,w=9,T=13,k=91,N=93,V=40,q=41,Z=123,X=125,te=59,De=42,_e=58,he=64,Ce=/[\t\n\f\r "#'()/;[\\\]{}]/g,Pe=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,ye=/.[\r\n"'(/\\]/,vt=/[\da-f]/i;return lN=function(ut,ct={}){let We=ut.css.valueOf(),Pt=ct.ignoreErrors,ui,we,xe,le,ke,He,yt,li,Ai,hi,it=We.length,pt=0,di=[],Cn=[];function Oo(){return pt}function io(ca){throw ut.error("Unclosed "+ca,pt)}function ge(){return Cn.length===0&&pt>=it}function Po(ca){if(Cn.length)return Cn.pop();if(pt>=it)return;let Wt=ca?ca.ignoreUnclosed:!1;switch(ui=We.charCodeAt(pt),ui){case o:case r:case w:case T:case g:{le=pt;do le+=1,ui=We.charCodeAt(le);while(ui===r||ui===o||ui===w||ui===T||ui===g);He=["space",We.slice(pt,le)],pt=le-1;break}case k:case N:case Z:case X:case _e:case te:case q:{let Cs=String.fromCharCode(ui);He=[Cs,Cs,pt];break}case V:{if(hi=di.length?di.pop()[1]:"",Ai=We.charCodeAt(pt+1),hi==="url"&&Ai!==t&&Ai!==i&&Ai!==r&&Ai!==o&&Ai!==w&&Ai!==g&&Ai!==T){le=pt;do{if(yt=!1,le=We.indexOf(")",le+1),le===-1)if(Pt||Wt){le=pt;break}else io("bracket");for(li=le;We.charCodeAt(li-1)===e;)li-=1,yt=!yt}while(yt);He=["brackets",We.slice(pt,le+1),pt,le],pt=le}else le=We.indexOf(")",pt+1),we=We.slice(pt,le+1),le===-1||ye.test(we)?He=["(","(",pt]:(He=["brackets",we,pt,le],pt=le);break}case t:case i:{ke=ui===t?"'":'"',le=pt;do{if(yt=!1,le=We.indexOf(ke,le+1),le===-1)if(Pt||Wt){le=pt+1;break}else io("string");for(li=le;We.charCodeAt(li-1)===e;)li-=1,yt=!yt}while(yt);He=["string",We.slice(pt,le+1),pt,le],pt=le;break}case he:{Ce.lastIndex=pt+1,Ce.test(We),Ce.lastIndex===0?le=We.length-1:le=Ce.lastIndex-2,He=["at-word",We.slice(pt,le+1),pt,le],pt=le;break}case e:{for(le=pt,xe=!0;We.charCodeAt(le+1)===e;)le+=1,xe=!xe;if(ui=We.charCodeAt(le+1),xe&&ui!==n&&ui!==r&&ui!==o&&ui!==w&&ui!==T&&ui!==g&&(le+=1,vt.test(We.charAt(le)))){for(;vt.test(We.charAt(le+1));)le+=1;We.charCodeAt(le+1)===r&&(le+=1)}He=["word",We.slice(pt,le+1),pt,le],pt=le;break}default:{ui===n&&We.charCodeAt(pt+1)===De?(le=We.indexOf("*/",pt+2)+1,le===0&&(Pt||Wt?le=We.length:io("comment")),He=["comment",We.slice(pt,le+1),pt,le],pt=le):(Pe.lastIndex=pt+1,Pe.test(We),Pe.lastIndex===0?le=We.length-1:le=Pe.lastIndex-2,He=["word",We.slice(pt,le+1),pt,le],di.push(He),pt=le);break}}return pt++,He}function os(ca){Cn.push(ca)}return{back:os,endOfFile:ge,nextToken:Po,position:Oo}},lN}var cN,Bq;function Gde(){if(Bq)return cN;Bq=1;let t=GN(),i=yD(),e=vD(),n=lw(),o=ZN(),r=$de(),g={empty:!0,space:!0};function w(k){for(let N=k.length-1;N>=0;N--){let V=k[N],q=V[3]||V[2];if(q)return q}}class T{constructor(N){this.input=N,this.root=new n,this.current=this.root,this.spaces="",this.semicolon=!1,this.createTokenizer(),this.root.source={input:N,start:{column:1,line:1,offset:0}}}atrule(N){let V=new t;V.name=N[1].slice(1),V.name===""&&this.unnamedAtrule(V,N),this.init(V,N[2]);let q,Z,X,te=!1,De=!1,_e=[],he=[];for(;!this.tokenizer.endOfFile();){if(N=this.tokenizer.nextToken(),q=N[0],q==="("||q==="["?he.push(q==="("?")":"]"):q==="{"&&he.length>0?he.push("}"):q===he[he.length-1]&&he.pop(),he.length===0)if(q===";"){V.source.end=this.getPosition(N[2]),V.source.end.offset++,this.semicolon=!0;break}else if(q==="{"){De=!0;break}else if(q==="}"){if(_e.length>0){for(X=_e.length-1,Z=_e[X];Z&&Z[0]==="space";)Z=_e[--X];Z&&(V.source.end=this.getPosition(Z[3]||Z[2]),V.source.end.offset++)}this.end(N);break}else _e.push(N);else _e.push(N);if(this.tokenizer.endOfFile()){te=!0;break}}V.raws.between=this.spacesAndCommentsFromEnd(_e),_e.length?(V.raws.afterName=this.spacesAndCommentsFromStart(_e),this.raw(V,"params",_e),te&&(N=_e[_e.length-1],V.source.end=this.getPosition(N[3]||N[2]),V.source.end.offset++,this.spaces=V.raws.between,V.raws.between="")):(V.raws.afterName="",V.params=""),De&&(V.nodes=[],this.current=V)}checkMissedSemicolon(N){let V=this.colon(N);if(V===!1)return;let q=0,Z;for(let X=V-1;X>=0&&(Z=N[X],!(Z[0]!=="space"&&(q+=1,q===2)));X--);throw this.input.error("Missed semicolon",Z[0]==="word"?Z[3]+1:Z[2])}colon(N){let V=0,q,Z,X;for(let[te,De]of N.entries()){if(Z=De,X=Z[0],X==="("&&(V+=1),X===")"&&(V-=1),V===0&&X===":")if(!q)this.doubleColon(Z);else{if(q[0]==="word"&&q[1]==="progid")continue;return te}q=Z}return!1}comment(N){let V=new i;this.init(V,N[2]),V.source.end=this.getPosition(N[3]||N[2]),V.source.end.offset++;let q=N[1].slice(2,-2);if(/^\s*$/.test(q))V.text="",V.raws.left=q,V.raws.right="";else{let Z=q.match(/^(\s*)([^]*\S)(\s*)$/);V.text=Z[2],V.raws.left=Z[1],V.raws.right=Z[3]}}createTokenizer(){this.tokenizer=r(this.input)}decl(N,V){let q=new e;this.init(q,N[0][2]);let Z=N[N.length-1];for(Z[0]===";"&&(this.semicolon=!0,N.pop()),q.source.end=this.getPosition(Z[3]||Z[2]||w(N)),q.source.end.offset++;N[0][0]!=="word";)N.length===1&&this.unknownWord(N),q.raws.before+=N.shift()[1];for(q.source.start=this.getPosition(N[0][2]),q.prop="";N.length;){let he=N[0][0];if(he===":"||he==="space"||he==="comment")break;q.prop+=N.shift()[1]}q.raws.between="";let X;for(;N.length;)if(X=N.shift(),X[0]===":"){q.raws.between+=X[1];break}else X[0]==="word"&&/\w/.test(X[1])&&this.unknownWord([X]),q.raws.between+=X[1];(q.prop[0]==="_"||q.prop[0]==="*")&&(q.raws.before+=q.prop[0],q.prop=q.prop.slice(1));let te=[],De;for(;N.length&&(De=N[0][0],!(De!=="space"&&De!=="comment"));)te.push(N.shift());this.precheckMissedSemicolon(N);for(let he=N.length-1;he>=0;he--){if(X=N[he],X[1].toLowerCase()==="!important"){q.important=!0;let Ce=this.stringFrom(N,he);Ce=this.spacesFromEnd(N)+Ce,Ce!==" !important"&&(q.raws.important=Ce);break}else if(X[1].toLowerCase()==="important"){let Ce=N.slice(0),Pe="";for(let ye=he;ye>0;ye--){let vt=Ce[ye][0];if(Pe.trim().startsWith("!")&&vt!=="space")break;Pe=Ce.pop()[1]+Pe}Pe.trim().startsWith("!")&&(q.important=!0,q.raws.important=Pe,N=Ce)}if(X[0]!=="space"&&X[0]!=="comment")break}N.some(he=>he[0]!=="space"&&he[0]!=="comment")&&(q.raws.between+=te.map(he=>he[1]).join(""),te=[]),this.raw(q,"value",te.concat(N),V),q.value.includes(":")&&!V&&this.checkMissedSemicolon(N)}doubleColon(N){throw this.input.error("Double colon",{offset:N[2]},{offset:N[2]+N[1].length})}emptyRule(N){let V=new o;this.init(V,N[2]),V.selector="",V.raws.between="",this.current=V}end(N){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(N[2]),this.current.source.end.offset++,this.current=this.current.parent):this.unexpectedClose(N)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.root.source.end=this.getPosition(this.tokenizer.position())}freeSemicolon(N){if(this.spaces+=N[1],this.current.nodes){let V=this.current.nodes[this.current.nodes.length-1];V&&V.type==="rule"&&!V.raws.ownSemicolon&&(V.raws.ownSemicolon=this.spaces,this.spaces="",V.source.end=this.getPosition(N[2]),V.source.end.offset+=V.raws.ownSemicolon.length)}}getPosition(N){let V=this.input.fromOffset(N);return{column:V.col,line:V.line,offset:N}}init(N,V){this.current.push(N),N.source={input:this.input,start:this.getPosition(V)},N.raws.before=this.spaces,this.spaces="",N.type!=="comment"&&(this.semicolon=!1)}other(N){let V=!1,q=null,Z=!1,X=null,te=[],De=N[1].startsWith("--"),_e=[],he=N;for(;he;){if(q=he[0],_e.push(he),q==="("||q==="[")X||(X=he),te.push(q==="("?")":"]");else if(De&&Z&&q==="{")X||(X=he),te.push("}");else if(te.length===0)if(q===";")if(Z){this.decl(_e,De);return}else break;else if(q==="{"){this.rule(_e);return}else if(q==="}"){this.tokenizer.back(_e.pop()),V=!0;break}else q===":"&&(Z=!0);else q===te[te.length-1]&&(te.pop(),te.length===0&&(X=null));he=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(V=!0),te.length>0&&this.unclosedBracket(X),V&&Z){if(!De)for(;_e.length&&(he=_e[_e.length-1][0],!(he!=="space"&&he!=="comment"));)this.tokenizer.back(_e.pop());this.decl(_e,De)}else this.unknownWord(_e)}parse(){let N;for(;!this.tokenizer.endOfFile();)switch(N=this.tokenizer.nextToken(),N[0]){case"space":this.spaces+=N[1];break;case";":this.freeSemicolon(N);break;case"}":this.end(N);break;case"comment":this.comment(N);break;case"at-word":this.atrule(N);break;case"{":this.emptyRule(N);break;default:this.other(N);break}this.endFile()}precheckMissedSemicolon(){}raw(N,V,q,Z){let X,te,De=q.length,_e="",he=!0,Ce,Pe;for(let ye=0;ye<De;ye+=1)X=q[ye],te=X[0],te==="space"&&ye===De-1&&!Z?he=!1:te==="comment"?(Pe=q[ye-1]?q[ye-1][0]:"empty",Ce=q[ye+1]?q[ye+1][0]:"empty",!g[Pe]&&!g[Ce]?_e.slice(-1)===","?he=!1:_e+=X[1]:he=!1):_e+=X[1];if(!he){let ye=q.reduce((vt,Rt)=>vt+Rt[1],"");N.raws[V]={raw:ye,value:_e}}N[V]=_e}rule(N){N.pop();let V=new o;this.init(V,N[0][2]),V.raws.between=this.spacesAndCommentsFromEnd(N),this.raw(V,"selector",N),this.current=V}spacesAndCommentsFromEnd(N){let V,q="";for(;N.length&&(V=N[N.length-1][0],!(V!=="space"&&V!=="comment"));)q=N.pop()[1]+q;return q}spacesAndCommentsFromStart(N){let V,q="";for(;N.length&&(V=N[0][0],!(V!=="space"&&V!=="comment"));)q+=N.shift()[1];return q}spacesFromEnd(N){let V,q="";for(;N.length&&(V=N[N.length-1][0],V==="space");)q=N.pop()[1]+q;return q}stringFrom(N,V){let q="";for(let Z=V;Z<N.length;Z++)q+=N[Z][1];return N.splice(V,N.length-V),q}unclosedBlock(){let N=this.current.source.start;throw this.input.error("Unclosed block",N.line,N.column)}unclosedBracket(N){throw this.input.error("Unclosed bracket",{offset:N[2]},{offset:N[2]+1})}unexpectedClose(N){throw this.input.error("Unexpected }",{offset:N[2]},{offset:N[2]+1})}unknownWord(N){throw this.input.error("Unknown word",{offset:N[0][2]},{offset:N[0][2]+N[0][1].length})}unnamedAtrule(N,V){throw this.input.error("At-rule without name",{offset:V[2]},{offset:V[2]+V[1].length})}}return cN=T,cN}var uN,Vq;function YN(){if(Vq)return uN;Vq=1;let t=w0(),i=bD(),e=Gde();function n(o,r){let g=new i(o,r),w=new e(g);try{w.parse()}catch(T){throw process.env.NODE_ENV!=="production"&&T.name==="CssSyntaxError"&&r&&r.from&&(/\.scss$/i.test(r.from)?T.message+=`
You tried to parse SCSS with the standard CSS parser; try again with the postcss-scss parser`:/\.sass/i.test(r.from)?T.message+=`
You tried to parse Sass with the standard CSS parser; try again with the postcss-sass parser`:/\.less$/i.test(r.from)&&(T.message+=`
You tried to parse Less with the standard CSS parser; try again with the postcss-less parser`)),T}return w.root}return uN=n,n.default=n,t.registerParse(n),uN}var dN,jq;function O$(){if(jq)return dN;jq=1;class t{constructor(e,n={}){if(this.type="warning",this.text=e,n.node&&n.node.source){let o=n.node.rangeBy(n);this.line=o.start.line,this.column=o.start.column,this.endLine=o.end.line,this.endColumn=o.end.column}for(let o in n)this[o]=n[o]}toString(){return this.node?this.node.error(this.text,{index:this.index,plugin:this.plugin,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}}return dN=t,t.default=t,dN}var hN,Uq;function KN(){if(Uq)return hN;Uq=1;let t=O$();class i{constructor(n,o,r){this.processor=n,this.messages=[],this.root=o,this.opts=r,this.css=void 0,this.map=void 0}toString(){return this.css}warn(n,o={}){o.plugin||this.lastPlugin&&this.lastPlugin.postcssPlugin&&(o.plugin=this.lastPlugin.postcssPlugin);let r=new t(n,o);return this.messages.push(r),r}warnings(){return this.messages.filter(n=>n.type==="warning")}get content(){return this.css}}return hN=i,i.default=i,hN}var pN,Hq;function P$(){if(Hq)return pN;Hq=1;let t={};return pN=function(e){t[e]||(t[e]=!0,typeof console<"u"&&console.warn&&console.warn(e))},pN}var fN,qq;function N$(){if(qq)return fN;qq=1;let t=w0(),i=WN(),e=k$(),n=YN(),o=KN(),r=lw(),g=gD(),{isClean:w,my:T}=$N(),k=P$(),N={atrule:"AtRule",comment:"Comment",decl:"Declaration",document:"Document",root:"Root",rule:"Rule"},V={AtRule:!0,AtRuleExit:!0,Comment:!0,CommentExit:!0,Declaration:!0,DeclarationExit:!0,Document:!0,DocumentExit:!0,Once:!0,OnceExit:!0,postcssPlugin:!0,prepare:!0,Root:!0,RootExit:!0,Rule:!0,RuleExit:!0},q={Once:!0,postcssPlugin:!0,prepare:!0},Z=0;function X(Pe){return typeof Pe=="object"&&typeof Pe.then=="function"}function te(Pe){let ye=!1,vt=N[Pe.type];return Pe.type==="decl"?ye=Pe.prop.toLowerCase():Pe.type==="atrule"&&(ye=Pe.name.toLowerCase()),ye&&Pe.append?[vt,vt+"-"+ye,Z,vt+"Exit",vt+"Exit-"+ye]:ye?[vt,vt+"-"+ye,vt+"Exit",vt+"Exit-"+ye]:Pe.append?[vt,Z,vt+"Exit"]:[vt,vt+"Exit"]}function De(Pe){let ye;return Pe.type==="document"?ye=["Document",Z,"DocumentExit"]:Pe.type==="root"?ye=["Root",Z,"RootExit"]:ye=te(Pe),{eventIndex:0,events:ye,iterator:0,node:Pe,visitorIndex:0,visitors:[]}}function _e(Pe){return Pe[w]=!1,Pe.nodes&&Pe.nodes.forEach(ye=>_e(ye)),Pe}let he={},Ce=(()=>{class Pe{constructor(vt,Rt,ut){this.stringified=!1,this.processed=!1;let ct;if(typeof Rt=="object"&&Rt!==null&&(Rt.type==="root"||Rt.type==="document"))ct=_e(Rt);else if(Rt instanceof Pe||Rt instanceof o)ct=_e(Rt.root),Rt.map&&(typeof ut.map>"u"&&(ut.map={}),ut.map.inline||(ut.map.inline=!1),ut.map.prev=Rt.map);else{let We=n;ut.syntax&&(We=ut.syntax.parse),ut.parser&&(We=ut.parser),We.parse&&(We=We.parse);try{ct=We(Rt,ut)}catch(Pt){this.processed=!0,this.error=Pt}ct&&!ct[T]&&t.rebuild(ct)}this.result=new o(vt,ct,ut),this.helpers=ji(It({},he),{postcss:he,result:this.result}),this.plugins=this.processor.plugins.map(We=>typeof We=="object"&&We.prepare?It(It({},We),We.prepare(this.result)):We)}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}catch(vt){return this.async().catch(vt)}finally(vt){return this.async().then(vt,vt)}getAsyncError(){throw new Error("Use process(css).then(cb) to work with async plugins")}handleError(vt,Rt){let ut=this.result.lastPlugin;try{if(Rt&&Rt.addToError(vt),this.error=vt,vt.name==="CssSyntaxError"&&!vt.plugin)vt.plugin=ut.postcssPlugin,vt.setMessage();else if(ut.postcssVersion&&process.env.NODE_ENV!=="production"){let ct=ut.postcssPlugin,We=ut.postcssVersion,Pt=this.result.processor.version,ui=We.split("."),we=Pt.split(".");(ui[0]!==we[0]||parseInt(ui[1])>parseInt(we[1]))&&console.error("Unknown error from PostCSS plugin. Your current PostCSS version is "+Pt+", but "+ct+" uses "+We+". Perhaps this is the source of the error below.")}}catch(ct){console&&console.error&&console.error(ct)}return vt}prepareVisitors(){this.listeners={};let vt=(Rt,ut,ct)=>{this.listeners[ut]||(this.listeners[ut]=[]),this.listeners[ut].push([Rt,ct])};for(let Rt of this.plugins)if(typeof Rt=="object")for(let ut in Rt){if(!V[ut]&&/^[A-Z]/.test(ut))throw new Error(`Unknown event ${ut} in ${Rt.postcssPlugin}. Try to update PostCSS (${this.processor.version} now).`);if(!q[ut])if(typeof Rt[ut]=="object")for(let ct in Rt[ut])ct==="*"?vt(Rt,ut,Rt[ut][ct]):vt(Rt,ut+"-"+ct.toLowerCase(),Rt[ut][ct]);else typeof Rt[ut]=="function"&&vt(Rt,ut,Rt[ut])}this.hasListener=Object.keys(this.listeners).length>0}runAsync(){return Go(this,null,function*(){this.plugin=0;for(let vt=0;vt<this.plugins.length;vt++){let Rt=this.plugins[vt],ut=this.runOnRoot(Rt);if(X(ut))try{yield ut}catch(ct){throw this.handleError(ct)}}if(this.prepareVisitors(),this.hasListener){let vt=this.result.root;for(;!vt[w];){vt[w]=!0;let Rt=[De(vt)];for(;Rt.length>0;){let ut=this.visitTick(Rt);if(X(ut))try{yield ut}catch(ct){let We=Rt[Rt.length-1].node;throw this.handleError(ct,We)}}}if(this.listeners.OnceExit)for(let[Rt,ut]of this.listeners.OnceExit){this.result.lastPlugin=Rt;try{if(vt.type==="document"){let ct=vt.nodes.map(We=>ut(We,this.helpers));yield Promise.all(ct)}else yield ut(vt,this.helpers)}catch(ct){throw this.handleError(ct)}}}return this.processed=!0,this.stringify()})}runOnRoot(vt){this.result.lastPlugin=vt;try{if(typeof vt=="object"&&vt.Once){if(this.result.root.type==="document"){let Rt=this.result.root.nodes.map(ut=>vt.Once(ut,this.helpers));return X(Rt[0])?Promise.all(Rt):Rt}return vt.Once(this.result.root,this.helpers)}else if(typeof vt=="function")return vt(this.result.root,this.result)}catch(Rt){throw this.handleError(Rt)}}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();let vt=this.result.opts,Rt=g;vt.syntax&&(Rt=vt.syntax.stringify),vt.stringifier&&(Rt=vt.stringifier),Rt.stringify&&(Rt=Rt.stringify);let ct=new e(Rt,this.result.root,this.result.opts).generate();return this.result.css=ct[0],this.result.map=ct[1],this.result}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(let vt of this.plugins){let Rt=this.runOnRoot(vt);if(X(Rt))throw this.getAsyncError()}if(this.prepareVisitors(),this.hasListener){let vt=this.result.root;for(;!vt[w];)vt[w]=!0,this.walkSync(vt);if(this.listeners.OnceExit)if(vt.type==="document")for(let Rt of vt.nodes)this.visitSync(this.listeners.OnceExit,Rt);else this.visitSync(this.listeners.OnceExit,vt)}return this.result}then(vt,Rt){return process.env.NODE_ENV!=="production"&&("from"in this.opts||k("Without `from` option PostCSS could generate wrong source map and will not find Browserslist config. Set it to CSS file path or to `undefined` to prevent this warning.")),this.async().then(vt,Rt)}toString(){return this.css}visitSync(vt,Rt){for(let[ut,ct]of vt){this.result.lastPlugin=ut;let We;try{We=ct(Rt,this.helpers)}catch(Pt){throw this.handleError(Pt,Rt.proxyOf)}if(Rt.type!=="root"&&Rt.type!=="document"&&!Rt.parent)return!0;if(X(We))throw this.getAsyncError()}}visitTick(vt){let Rt=vt[vt.length-1],{node:ut,visitors:ct}=Rt;if(ut.type!=="root"&&ut.type!=="document"&&!ut.parent){vt.pop();return}if(ct.length>0&&Rt.visitorIndex<ct.length){let[Pt,ui]=ct[Rt.visitorIndex];Rt.visitorIndex+=1,Rt.visitorIndex===ct.length&&(Rt.visitors=[],Rt.visitorIndex=0),this.result.lastPlugin=Pt;try{return ui(ut.toProxy(),this.helpers)}catch(we){throw this.handleError(we,ut)}}if(Rt.iterator!==0){let Pt=Rt.iterator,ui;for(;ui=ut.nodes[ut.indexes[Pt]];)if(ut.indexes[Pt]+=1,!ui[w]){ui[w]=!0,vt.push(De(ui));return}Rt.iterator=0,delete ut.indexes[Pt]}let We=Rt.events;for(;Rt.eventIndex<We.length;){let Pt=We[Rt.eventIndex];if(Rt.eventIndex+=1,Pt===Z){ut.nodes&&ut.nodes.length&&(ut[w]=!0,Rt.iterator=ut.getIterator());return}else if(this.listeners[Pt]){Rt.visitors=this.listeners[Pt];return}}vt.pop()}walkSync(vt){vt[w]=!0;let Rt=te(vt);for(let ut of Rt)if(ut===Z)vt.nodes&&vt.each(ct=>{ct[w]||this.walkSync(ct)});else{let ct=this.listeners[ut];if(ct&&this.visitSync(ct,vt.toProxy()))return}}warnings(){return this.sync().warnings()}get content(){return this.stringify().content}get css(){return this.stringify().css}get map(){return this.stringify().map}get messages(){return this.sync().messages}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){return this.sync().root}get[Symbol.toStringTag](){return"LazyResult"}}return Pe.registerPostcss=ye=>{he=ye},Pe})();return fN=Ce,Ce.default=Ce,r.registerLazyResult(Ce),i.registerLazyResult(Ce),fN}var mN,$q;function Wde(){if($q)return mN;$q=1;let t=k$(),i=YN(),e=KN(),n=gD(),o=P$();class r{constructor(w,T,k){T=T.toString(),this.stringified=!1,this._processor=w,this._css=T,this._opts=k,this._map=void 0;let N,V=n;this.result=new e(this._processor,N,this._opts),this.result.css=T;let q=this;Object.defineProperty(this.result,"root",{get(){return q.root}});let Z=new t(V,N,this._opts,T);if(Z.isMap()){let[X,te]=Z.generate();X&&(this.result.css=X),te&&(this.result.map=te)}else Z.clearAnnotation(),this.result.css=Z.css}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}catch(w){return this.async().catch(w)}finally(w){return this.async().then(w,w)}sync(){if(this.error)throw this.error;return this.result}then(w,T){return process.env.NODE_ENV!=="production"&&("from"in this._opts||o("Without `from` option PostCSS could generate wrong source map and will not find Browserslist config. Set it to CSS file path or to `undefined` to prevent this warning.")),this.async().then(w,T)}toString(){return this._css}warnings(){return[]}get content(){return this.result.css}get css(){return this.result.css}get map(){return this.result.map}get messages(){return[]}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){if(this._root)return this._root;let w,T=i;try{w=T(this._css,this._opts)}catch(k){this.error=k}if(this.error)throw this.error;return this._root=w,w}get[Symbol.toStringTag](){return"NoWorkResult"}}return mN=r,r.default=r,mN}var gN,Gq;function Zde(){if(Gq)return gN;Gq=1;let t=WN(),i=N$(),e=Wde(),n=lw();class o{constructor(g=[]){this.version="8.5.2",this.plugins=this.normalize(g)}normalize(g){let w=[];for(let T of g)if(T.postcss===!0?T=T():T.postcss&&(T=T.postcss),typeof T=="object"&&Array.isArray(T.plugins))w=w.concat(T.plugins);else if(typeof T=="object"&&T.postcssPlugin)w.push(T);else if(typeof T=="function")w.push(T);else if(typeof T=="object"&&(T.parse||T.stringify)){if(process.env.NODE_ENV!=="production")throw new Error("PostCSS syntaxes cannot be used as plugins. Instead, please use one of the syntax/parser/stringifier options as outlined in your PostCSS runner documentation.")}else throw new Error(T+" is not a PostCSS plugin");return w}process(g,w={}){return!this.plugins.length&&!w.parser&&!w.stringifier&&!w.syntax?new e(this,g,w):new i(this,g,w)}use(g){return this.plugins=this.plugins.concat(this.normalize([g])),this}}return gN=o,o.default=o,n.registerProcessor(o),t.registerProcessor(o),gN}var _N,Wq;function Yde(){if(Wq)return _N;Wq=1;let t=GN(),i=yD(),e=w0(),n=qN(),o=vD(),r=WN(),g=qde(),w=bD(),T=N$(),k=R$(),N=_D(),V=YN(),q=Zde(),Z=KN(),X=lw(),te=ZN(),De=gD(),_e=O$();function he(...Ce){return Ce.length===1&&Array.isArray(Ce[0])&&(Ce=Ce[0]),new q(Ce)}return he.plugin=function(Pe,ye){let vt=!1;function Rt(...ct){console&&console.warn&&!vt&&(vt=!0,console.warn(Pe+`: postcss.plugin was deprecated. Migration guide:
https://evilmartians.com/chronicles/postcss-8-plugin-migration`),process.env.LANG&&process.env.LANG.startsWith("cn")&&console.warn(Pe+`: \u91CC\u9762 postcss.plugin \u88AB\u5F03\u7528. \u8FC1\u79FB\u6307\u5357:
https://www.w3ctech.com/topic/2226`));let We=ye(...ct);return We.postcssPlugin=Pe,We.postcssVersion=new q().version,We}let ut;return Object.defineProperty(Rt,"postcss",{get(){return ut||(ut=Rt()),ut}}),Rt.process=function(ct,We,Pt){return he([Rt(Pt)]).process(ct,We)},Rt},he.stringify=De,he.parse=V,he.fromJSON=g,he.list=k,he.comment=Ce=>new i(Ce),he.atRule=Ce=>new t(Ce),he.decl=Ce=>new o(Ce),he.rule=Ce=>new te(Ce),he.root=Ce=>new X(Ce),he.document=Ce=>new r(Ce),he.CssSyntaxError=n,he.Declaration=o,he.Container=e,he.Processor=q,he.Document=r,he.Comment=i,he.Warning=_e,he.AtRule=t,he.Result=Z,he.Input=w,he.Rule=te,he.Root=X,he.Node=N,T.registerPostcss(he),_N=he,he.default=he,_N}var Kde=Yde(),ra=mD(Kde),Xde=ra.stringify;ra.fromJSON;ra.plugin;var Qde=ra.parse;ra.list;ra.document;ra.comment;ra.atRule;ra.rule;ra.decl;ra.root;ra.CssSyntaxError;ra.Declaration;ra.Container;ra.Processor;ra.Document;ra.Comment;ra.Warning;ra.AtRule;ra.Result;ra.Input;ra.Rule;ra.Root;ra.Node;var eD={},tD={},iD={},Zq;function L$(){if(Zq)return iD;Zq=1,Object.defineProperty(iD,"__esModule",{value:!0});function t(i){this.after=i.after,this.before=i.before,this.type=i.type,this.value=i.value,this.sourceIndex=i.sourceIndex}return iD.default=t,iD}var Yq;function F$(){if(Yq)return tD;Yq=1,Object.defineProperty(tD,"__esModule",{value:!0});var t=L$(),i=e(t);function e(o){return o&&o.__esModule?o:{default:o}}function n(o){var r=this;this.constructor(o),this.nodes=o.nodes,this.after===void 0&&(this.after=this.nodes.length>0?this.nodes[this.nodes.length-1].after:""),this.before===void 0&&(this.before=this.nodes.length>0?this.nodes[0].before:""),this.sourceIndex===void 0&&(this.sourceIndex=this.before.length),this.nodes.forEach(function(g){g.parent=r})}return n.prototype=Object.create(i.default.prototype),n.constructor=i.default,n.prototype.walk=function(r,g){for(var w=typeof r=="string"||r instanceof RegExp,T=w?g:r,k=typeof r=="string"?new RegExp(r):r,N=0;N<this.nodes.length;N++){var V=this.nodes[N],q=w?k.test(V.type):!0;if(q&&T&&T(V,N,this.nodes)===!1||V.nodes&&V.walk(r,g)===!1)return!1}return!0},n.prototype.each=function(){for(var r=arguments.length<=0||arguments[0]===void 0?function(){}:arguments[0],g=0;g<this.nodes.length;g++){var w=this.nodes[g];if(r(w,g,this.nodes)===!1)return!1}return!0},tD.default=n,tD}var Qy={},Kq;function Jde(){if(Kq)return Qy;Kq=1,Object.defineProperty(Qy,"__esModule",{value:!0}),Qy.parseMediaFeature=r,Qy.parseMediaQuery=g,Qy.parseMediaList=w;var t=L$(),i=o(t),e=F$(),n=o(e);function o(T){return T&&T.__esModule?T:{default:T}}function r(T){var k=arguments.length<=1||arguments[1]===void 0?0:arguments[1],N=[{mode:"normal",character:null}],V=[],q=0,Z="",X=null,te=null,De=k,_e=T;T[0]==="("&&T[T.length-1]===")"&&(_e=T.substring(1,T.length-1),De++);for(var he=0;he<_e.length;he++){var Ce=_e[he];if((Ce==="'"||Ce==='"')&&(N[q].isCalculationEnabled===!0?(N.push({mode:"string",isCalculationEnabled:!1,character:Ce}),q++):N[q].mode==="string"&&N[q].character===Ce&&_e[he-1]!=="\\"&&(N.pop(),q--)),Ce==="{"?(N.push({mode:"interpolation",isCalculationEnabled:!0}),q++):Ce==="}"&&(N.pop(),q--),N[q].mode==="normal"&&Ce===":"){var Pe=_e.substring(he+1);te={type:"value",before:/^(\s*)/.exec(Pe)[1],after:/(\s*)$/.exec(Pe)[1],value:Pe.trim()},te.sourceIndex=te.before.length+he+1+De,X={type:"colon",sourceIndex:he+De,after:te.before,value:":"};break}Z+=Ce}return Z={type:"media-feature",before:/^(\s*)/.exec(Z)[1],after:/(\s*)$/.exec(Z)[1],value:Z.trim()},Z.sourceIndex=Z.before.length+De,V.push(Z),X!==null&&(X.before=Z.after,V.push(X)),te!==null&&V.push(te),V}function g(T){var k=arguments.length<=1||arguments[1]===void 0?0:arguments[1],N=[],V=0,q=!1,Z=void 0;function X(){return{before:"",after:"",value:""}}Z=X();for(var te=0;te<T.length;te++){var De=T[te];q?(Z.value+=De,(De==="{"||De==="(")&&V++,(De===")"||De==="}")&&V--):De.search(/\s/)!==-1?Z.before+=De:(De==="("&&(Z.type="media-feature-expression",V++),Z.value=De,Z.sourceIndex=k+te,q=!0),q&&V===0&&(De===")"||te===T.length-1||T[te+1].search(/\s/)!==-1)&&(["not","only","and"].indexOf(Z.value)!==-1&&(Z.type="keyword"),Z.type==="media-feature-expression"&&(Z.nodes=r(Z.value,Z.sourceIndex)),N.push(Array.isArray(Z.nodes)?new n.default(Z):new i.default(Z)),Z=X(),q=!1)}for(var _e=0;_e<N.length;_e++)if(Z=N[_e],_e>0&&(N[_e-1].after=Z.before),Z.type===void 0){if(_e>0){if(N[_e-1].type==="media-feature-expression"){Z.type="keyword";continue}if(N[_e-1].value==="not"||N[_e-1].value==="only"){Z.type="media-type";continue}if(N[_e-1].value==="and"){Z.type="media-feature-expression";continue}N[_e-1].type==="media-type"&&(N[_e+1]?Z.type=N[_e+1].type==="media-feature-expression"?"keyword":"media-feature-expression":Z.type="media-feature-expression")}if(_e===0){if(!N[_e+1]){Z.type="media-type";continue}if(N[_e+1]&&(N[_e+1].type==="media-feature-expression"||N[_e+1].type==="keyword")){Z.type="media-type";continue}if(N[_e+2]){if(N[_e+2].type==="media-feature-expression"){Z.type="media-type",N[_e+1].type="keyword";continue}if(N[_e+2].type==="keyword"){Z.type="keyword",N[_e+1].type="media-type";continue}}if(N[_e+3]&&N[_e+3].type==="media-feature-expression"){Z.type="keyword",N[_e+1].type="media-type",N[_e+2].type="keyword";continue}}}return N}function w(T){var k=[],N=0,V=0,q=/^(\s*)url\s*\(/.exec(T);if(q!==null){for(var Z=q[0].length,X=1;X>0;){var te=T[Z];te==="("&&X++,te===")"&&X--,Z++}k.unshift(new i.default({type:"url",value:T.substring(0,Z).trim(),sourceIndex:q[1].length,before:q[1],after:/^(\s*)/.exec(T.substring(Z))[1]})),N=Z}for(var De=N;De<T.length;De++){var _e=T[De];if(_e==="("&&V++,_e===")"&&V--,V===0&&_e===","){var he=T.substring(N,De),Ce=/^(\s*)/.exec(he)[1];k.push(new n.default({type:"media-query",value:he.trim(),sourceIndex:N+Ce.length,nodes:g(he,N),before:Ce,after:/(\s*)$/.exec(he)[1]})),N=De+1}}var Pe=T.substring(N),ye=/^(\s*)/.exec(Pe)[1];return k.push(new n.default({type:"media-query",value:Pe.trim(),sourceIndex:N+ye.length,nodes:g(Pe,N),before:ye,after:/(\s*)$/.exec(Pe)[1]})),k}return Qy}var Xq;function ehe(){if(Xq)return eD;Xq=1,Object.defineProperty(eD,"__esModule",{value:!0}),eD.default=o;var t=F$(),i=n(t),e=Jde();function n(r){return r&&r.__esModule?r:{default:r}}function o(r){return new i.default({nodes:(0,e.parseMediaList)(r),type:"media-query-list",value:r.trim()})}return eD}var the=ehe(),yN=mD(the),ho=function(t){return t.Root="root",t.Text="text",t.Directive="directive",t.Comment="comment",t.Script="script",t.Style="style",t.Tag="tag",t.CDATA="cdata",t.Doctype="doctype",t}(ho||{});function ihe(t){return t.type===ho.Tag||t.type===ho.Script||t.type===ho.Style}var nhe=ho.Root,rhe=ho.Text,ohe=ho.Directive,ahe=ho.Comment,she=ho.Script,lhe=ho.Style,che=ho.Tag,uhe=ho.CDATA,dhe=ho.Doctype,aD=class{constructor(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}get parentNode(){return this.parent}set parentNode(i){this.parent=i}get previousSibling(){return this.prev}set previousSibling(i){this.prev=i}get nextSibling(){return this.next}set nextSibling(i){this.next=i}cloneNode(i=!1){return B$(this,i)}},ow=class extends aD{constructor(i){super(),this.data=i}get nodeValue(){return this.data}set nodeValue(i){this.data=i}},v0=class extends ow{constructor(){super(...arguments),this.type=ho.Text}get nodeType(){return 3}},sD=class extends ow{constructor(){super(...arguments),this.type=ho.Comment}get nodeType(){return 8}},lD=class extends ow{constructor(i,e){super(e),this.name=i,this.type=ho.Directive}get nodeType(){return 1}},aw=class extends aD{constructor(i){super(),this.children=i}get firstChild(){var i;return(i=this.children[0])!==null&&i!==void 0?i:null}get lastChild(){return this.children.length>0?this.children[this.children.length-1]:null}get childNodes(){return this.children}set childNodes(i){this.children=i}},cD=class extends aw{constructor(){super(...arguments),this.type=ho.CDATA}get nodeType(){return 4}},sw=class extends aw{constructor(){super(...arguments),this.type=ho.Root}get nodeType(){return 9}},tv=class extends aw{constructor(i,e,n=[],o=i==="script"?ho.Script:i==="style"?ho.Style:ho.Tag){super(n),this.name=i,this.attribs=e,this.type=o}get nodeType(){return 1}get tagName(){return this.name}set tagName(i){this.name=i}get attributes(){return Object.keys(this.attribs).map(i=>{var e,n;return{name:i,value:this.attribs[i],namespace:(e=this["x-attribsNamespace"])===null||e===void 0?void 0:e[i],prefix:(n=this["x-attribsPrefix"])===null||n===void 0?void 0:n[i]}})}};function ru(t){return ihe(t)}function xD(t){return t.type===ho.CDATA}function b0(t){return t.type===ho.Text}function XN(t){return t.type===ho.Comment}function hhe(t){return t.type===ho.Directive}function z$(t){return t.type===ho.Root}function Vd(t){return Object.prototype.hasOwnProperty.call(t,"children")}function B$(t,i=!1){let e;if(b0(t))e=new v0(t.data);else if(XN(t))e=new sD(t.data);else if(ru(t)){let n=i?vN(t.children):[],o=new tv(t.name,It({},t.attribs),n);n.forEach(r=>r.parent=o),t.namespace!=null&&(o.namespace=t.namespace),t["x-attribsNamespace"]&&(o["x-attribsNamespace"]=It({},t["x-attribsNamespace"])),t["x-attribsPrefix"]&&(o["x-attribsPrefix"]=It({},t["x-attribsPrefix"])),e=o}else if(xD(t)){let n=i?vN(t.children):[],o=new cD(n);n.forEach(r=>r.parent=o),e=o}else if(z$(t)){let n=i?vN(t.children):[],o=new sw(n);n.forEach(r=>r.parent=o),t["x-mode"]&&(o["x-mode"]=t["x-mode"]),e=o}else if(hhe(t)){let n=new lD(t.name,t.data);t["x-name"]!=null&&(n["x-name"]=t["x-name"],n["x-publicId"]=t["x-publicId"],n["x-systemId"]=t["x-systemId"]),e=n}else throw new Error(`Not implemented yet: ${t.type}`);return e.startIndex=t.startIndex,e.endIndex=t.endIndex,t.sourceCodeLocation!=null&&(e.sourceCodeLocation=t.sourceCodeLocation),e}function vN(t){let i=t.map(e=>B$(e,!0));for(let e=1;e<i.length;e++)i[e].prev=i[e-1],i[e-1].next=i[e];return i}var Qq={withStartIndices:!1,withEndIndices:!1,xmlMode:!1},IN=class{constructor(i,e,n){this.dom=[],this.root=new sw(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,typeof e=="function"&&(n=e,e=Qq),typeof i=="object"&&(e=i,i=void 0),this.callback=i??null,this.options=e??Qq,this.elementCB=n??null}onparserinit(i){this.parser=i}onreset(){this.dom=[],this.root=new sw(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null}onend(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))}onerror(i){this.handleCallback(i)}onclosetag(){this.lastNode=null;let i=this.tagStack.pop();this.options.withEndIndices&&(i.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(i)}onopentag(i,e){let n=this.options.xmlMode?ho.Tag:void 0,o=new tv(i,e,void 0,n);this.addNode(o),this.tagStack.push(o)}ontext(i){let{lastNode:e}=this;if(e&&e.type===ho.Text)e.data+=i,this.options.withEndIndices&&(e.endIndex=this.parser.endIndex);else{let n=new v0(i);this.addNode(n),this.lastNode=n}}oncomment(i){if(this.lastNode&&this.lastNode.type===ho.Comment){this.lastNode.data+=i;return}let e=new sD(i);this.addNode(e),this.lastNode=e}oncommentend(){this.lastNode=null}oncdatastart(){let i=new v0(""),e=new cD([i]);this.addNode(e),i.parent=e,this.lastNode=i}oncdataend(){this.lastNode=null}onprocessinginstruction(i,e){let n=new lD(i,e);this.addNode(n)}handleCallback(i){if(typeof this.callback=="function")this.callback(i,this.dom);else if(i)throw i}addNode(i){let e=this.tagStack[this.tagStack.length-1],n=e.children[e.children.length-1];this.options.withStartIndices&&(i.startIndex=this.parser.startIndex),this.options.withEndIndices&&(i.endIndex=this.parser.endIndex),e.children.push(i),n&&(i.prev=n,n.next=i),i.parent=e,this.lastNode=null}};var bN;var x3e=(bN=String.fromCodePoint)!==null&&bN!==void 0?bN:function(t){let i="";return t>65535&&(t-=65536,i+=String.fromCharCode(t>>>10&1023|55296),t=56320|t&1023),i+=String.fromCharCode(t),i};var Jq=/["&'<>$\x80-\uFFFF]/g,phe=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]),fhe=String.prototype.codePointAt!=null?(t,i)=>t.codePointAt(i):(t,i)=>(t.charCodeAt(i)&64512)===55296?(t.charCodeAt(i)-55296)*1024+t.charCodeAt(i+1)-56320+65536:t.charCodeAt(i);function V$(t){let i="",e=0,n;for(;(n=Jq.exec(t))!==null;){let o=n.index,r=t.charCodeAt(o),g=phe.get(r);g!==void 0?(i+=t.substring(e,o)+g,e=o+1):(i+=`${t.substring(e,o)}&#x${fhe(t,o).toString(16)};`,e=Jq.lastIndex+=+((r&64512)===55296))}return i+t.substr(e)}function j$(t,i){return function(n){let o,r=0,g="";for(;o=t.exec(n);)r!==o.index&&(g+=n.substring(r,o.index)),g+=i.get(o[0].charCodeAt(0)),r=o.index+1;return g+n.substring(r)}}var mhe=j$(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),ghe=j$(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]]));var _he=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(t=>[t.toLowerCase(),t])),yhe=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(t=>[t.toLowerCase(),t])),vhe=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function bhe(t){return t.replace(/"/g,"&quot;")}function xhe(t,i){var e;if(!t)return;let n=((e=i.encodeEntities)!==null&&e!==void 0?e:i.decodeEntities)===!1?bhe:i.xmlMode||i.encodeEntities!=="utf8"?V$:mhe;return Object.keys(t).map(o=>{var r,g;let w=(r=t[o])!==null&&r!==void 0?r:"";return i.xmlMode==="foreign"&&(o=(g=yhe.get(o))!==null&&g!==void 0?g:o),!i.emptyAttrs&&!i.xmlMode&&w===""?o:`${o}="${n(w)}"`}).join(" ")}var e$=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function wD(t,i={}){let e="length"in t?t:[t],n="";for(let o=0;o<e.length;o++)n+=whe(e[o],i);return n}function whe(t,i){switch(t.type){case nhe:return wD(t.children,i);case dhe:case ohe:return The(t);case ahe:return Ihe(t);case uhe:return Mhe(t);case she:case lhe:case che:return She(t,i);case rhe:return Dhe(t,i)}}var Ehe=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),Che=new Set(["svg","math"]);function She(t,i){var e;i.xmlMode==="foreign"&&(t.name=(e=_he.get(t.name))!==null&&e!==void 0?e:t.name,t.parent&&Ehe.has(t.parent.name)&&(i=ji(It({},i),{xmlMode:!1}))),!i.xmlMode&&Che.has(t.name)&&(i=ji(It({},i),{xmlMode:"foreign"}));let n=`<${t.name}`,o=xhe(t.attribs,i);return o&&(n+=` ${o}`),t.children.length===0&&(i.xmlMode?i.selfClosingTags!==!1:i.selfClosingTags&&e$.has(t.name))?(i.xmlMode||(n+=" "),n+="/>"):(n+=">",t.children.length>0&&(n+=wD(t.children,i)),(i.xmlMode||!e$.has(t.name))&&(n+=`</${t.name}>`)),n}function The(t){return`<${t.data}>`}function Dhe(t,i){var e;let n=t.data||"";return((e=i.encodeEntities)!==null&&e!==void 0?e:i.decodeEntities)!==!1&&!(!i.xmlMode&&t.parent&&vhe.has(t.parent.name))&&(n=i.xmlMode||i.encodeEntities!=="utf8"?V$(n):ghe(n)),n}function Mhe(t){return`<![CDATA[${t.children[0].data}]]>`}function Ihe(t){return`<!--${t.data}-->`}function U$(t,i){return wD(t,i)}function Ahe(t,i){return Vd(t)?t.children.map(e=>U$(e,i)).join(""):""}function nw(t){return Array.isArray(t)?t.map(nw).join(""):ru(t)?t.name==="br"?`
`:nw(t.children):xD(t)?nw(t.children):b0(t)?t.data:""}function uD(t){return Array.isArray(t)?t.map(uD).join(""):Vd(t)&&!XN(t)?uD(t.children):b0(t)?t.data:""}function AN(t){return Array.isArray(t)?t.map(AN).join(""):Vd(t)&&(t.type===ho.Tag||xD(t))?AN(t.children):b0(t)?t.data:""}function H$(t){return Vd(t)?t.children:[]}function q$(t){return t.parent||null}function Rhe(t){let i=q$(t);if(i!=null)return H$(i);let e=[t],{prev:n,next:o}=t;for(;n!=null;)e.unshift(n),{prev:n}=n;for(;o!=null;)e.push(o),{next:o}=o;return e}function khe(t,i){var e;return(e=t.attribs)===null||e===void 0?void 0:e[i]}function Ohe(t,i){return t.attribs!=null&&Object.prototype.hasOwnProperty.call(t.attribs,i)&&t.attribs[i]!=null}function Phe(t){return t.name}function Nhe(t){let{next:i}=t;for(;i!==null&&!ru(i);)({next:i}=i);return i}function Lhe(t){let{prev:i}=t;for(;i!==null&&!ru(i);)({prev:i}=i);return i}function x0(t){if(t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t.parent){let i=t.parent.children,e=i.lastIndexOf(t);e>=0&&i.splice(e,1)}t.next=null,t.prev=null,t.parent=null}function Fhe(t,i){let e=i.prev=t.prev;e&&(e.next=i);let n=i.next=t.next;n&&(n.prev=i);let o=i.parent=t.parent;if(o){let r=o.children;r[r.lastIndexOf(t)]=i,t.parent=null}}function RN(t,i){if(x0(i),i.next=null,i.parent=t,t.children.push(i)>1){let e=t.children[t.children.length-2];e.next=i,i.prev=e}else i.prev=null}function zhe(t,i){x0(i);let{parent:e}=t,n=t.next;if(i.next=n,i.prev=t,t.next=i,i.parent=e,n){if(n.prev=i,e){let o=e.children;o.splice(o.lastIndexOf(n),0,i)}}else e&&e.children.push(i)}function Bhe(t,i){if(x0(i),i.parent=t,i.prev=null,t.children.unshift(i)!==1){let e=t.children[1];e.prev=i,i.next=e}else i.next=null}function $$(t,i){x0(i);let{parent:e}=t;if(e){let n=e.children;n.splice(n.indexOf(t),0,i)}t.prev&&(t.prev.next=i),i.parent=e,i.prev=t.prev,i.next=t,t.prev=i}function cw(t,i,e=!0,n=1/0){return G$(t,Array.isArray(i)?i:[i],e,n)}function G$(t,i,e,n){let o=[],r=[Array.isArray(i)?i:[i]],g=[0];for(;;){if(g[0]>=r[0].length){if(g.length===1)return o;r.shift(),g.shift();continue}let w=r[0][g[0]++];if(t(w)&&(o.push(w),--n<=0))return o;e&&Vd(w)&&w.children.length>0&&(g.unshift(0),r.unshift(w.children))}}function Vhe(t,i){return i.find(t)}function QN(t,i,e=!0){let n=Array.isArray(i)?i:[i];for(let o=0;o<n.length;o++){let r=n[o];if(ru(r)&&t(r))return r;if(e&&Vd(r)&&r.children.length>0){let g=QN(t,r.children,!0);if(g)return g}}return null}function W$(t,i){return(Array.isArray(i)?i:[i]).some(e=>ru(e)&&t(e)||Vd(e)&&W$(t,e.children))}function jhe(t,i){let e=[],n=[Array.isArray(i)?i:[i]],o=[0];for(;;){if(o[0]>=n[0].length){if(n.length===1)return e;n.shift(),o.shift();continue}let r=n[0][o[0]++];ru(r)&&t(r)&&e.push(r),Vd(r)&&r.children.length>0&&(o.unshift(0),n.unshift(r.children))}}var dD={tag_name(t){return typeof t=="function"?i=>ru(i)&&t(i.name):t==="*"?ru:i=>ru(i)&&i.name===t},tag_type(t){return typeof t=="function"?i=>t(i.type):i=>i.type===t},tag_contains(t){return typeof t=="function"?i=>b0(i)&&t(i.data):i=>b0(i)&&i.data===t}};function JN(t,i){return typeof i=="function"?e=>ru(e)&&i(e.attribs[t]):e=>ru(e)&&e.attribs[t]===i}function Uhe(t,i){return e=>t(e)||i(e)}function Z$(t){let i=Object.keys(t).map(e=>{let n=t[e];return Object.prototype.hasOwnProperty.call(dD,e)?dD[e](n):JN(e,n)});return i.length===0?null:i.reduce(Uhe)}function Hhe(t,i){let e=Z$(t);return e?e(i):!0}function qhe(t,i,e,n=1/0){let o=Z$(t);return o?cw(o,i,e,n):[]}function $he(t,i,e=!0){return Array.isArray(i)||(i=[i]),QN(JN("id",t),i,e)}function iv(t,i,e=!0,n=1/0){return cw(dD.tag_name(t),i,e,n)}function Ghe(t,i,e=!0,n=1/0){return cw(JN("class",t),i,e,n)}function Whe(t,i,e=!0,n=1/0){return cw(dD.tag_type(t),i,e,n)}function Zhe(t){let i=t.length;for(;--i>=0;){let e=t[i];if(i>0&&t.lastIndexOf(e,i-1)>=0){t.splice(i,1);continue}for(let n=e.parent;n;n=n.parent)if(t.includes(n)){t.splice(i,1);break}}return t}var zd=function(t){return t[t.DISCONNECTED=1]="DISCONNECTED",t[t.PRECEDING=2]="PRECEDING",t[t.FOLLOWING=4]="FOLLOWING",t[t.CONTAINS=8]="CONTAINS",t[t.CONTAINED_BY=16]="CONTAINED_BY",t}(zd||{});function Y$(t,i){let e=[],n=[];if(t===i)return 0;let o=Vd(t)?t:t.parent;for(;o;)e.unshift(o),o=o.parent;for(o=Vd(i)?i:i.parent;o;)n.unshift(o),o=o.parent;let r=Math.min(e.length,n.length),g=0;for(;g<r&&e[g]===n[g];)g++;if(g===0)return zd.DISCONNECTED;let w=e[g-1],T=w.children,k=e[g],N=n[g];return T.indexOf(k)>T.indexOf(N)?w===i?zd.FOLLOWING|zd.CONTAINED_BY:zd.FOLLOWING:w===t?zd.PRECEDING|zd.CONTAINS:zd.PRECEDING}function Yhe(t){return t=t.filter((i,e,n)=>!n.includes(i,e+1)),t.sort((i,e)=>{let n=Y$(i,e);return n&zd.PRECEDING?-1:n&zd.FOLLOWING?1:0}),t}function Khe(t){let i=hD(tpe,t);return i?i.name==="feed"?Xhe(i):Qhe(i):null}function Xhe(t){var i;let e=t.children,n={type:"atom",items:iv("entry",e).map(g=>{var w;let{children:T}=g,k={media:K$(T)};Dc(k,"id","id",T),Dc(k,"title","title",T);let N=(w=hD("link",T))===null||w===void 0?void 0:w.attribs.href;N&&(k.link=N);let V=fm("summary",T)||fm("content",T);V&&(k.description=V);let q=fm("updated",T);return q&&(k.pubDate=new Date(q)),k})};Dc(n,"id","id",e),Dc(n,"title","title",e);let o=(i=hD("link",e))===null||i===void 0?void 0:i.attribs.href;o&&(n.link=o),Dc(n,"description","subtitle",e);let r=fm("updated",e);return r&&(n.updated=new Date(r)),Dc(n,"author","email",e,!0),n}function Qhe(t){var i,e;let n=(e=(i=hD("channel",t.children))===null||i===void 0?void 0:i.children)!==null&&e!==void 0?e:[],o={type:t.name.substr(0,3),id:"",items:iv("item",t.children).map(g=>{let{children:w}=g,T={media:K$(w)};Dc(T,"id","guid",w),Dc(T,"title","title",w),Dc(T,"link","link",w),Dc(T,"description","description",w);let k=fm("pubDate",w)||fm("dc:date",w);return k&&(T.pubDate=new Date(k)),T})};Dc(o,"title","title",n),Dc(o,"link","link",n),Dc(o,"description","description",n);let r=fm("lastBuildDate",n);return r&&(o.updated=new Date(r)),Dc(o,"author","managingEditor",n,!0),o}var Jhe=["url","type","lang"],epe=["fileSize","bitrate","framerate","samplingrate","channels","duration","height","width"];function K$(t){return iv("media:content",t).map(i=>{let{attribs:e}=i,n={medium:e.medium,isDefault:!!e.isDefault};for(let o of Jhe)e[o]&&(n[o]=e[o]);for(let o of epe)e[o]&&(n[o]=parseInt(e[o],10));return e.expression&&(n.expression=e.expression),n})}function hD(t,i){return iv(t,i,!0,1)[0]}function fm(t,i,e=!1){return uD(iv(t,i,e,1)).trim()}function Dc(t,i,e,n,o=!1){let r=fm(e,n,o);r&&(t[i]=r)}function tpe(t){return t==="rss"||t==="feed"||t==="rdf:RDF"}var X$=Object.freeze({__proto__:null,get DocumentPosition(){return zd},append:zhe,appendChild:RN,compareDocumentPosition:Y$,existsOne:W$,filter:cw,find:G$,findAll:jhe,findOne:QN,findOneChild:Vhe,getAttributeValue:khe,getChildren:H$,getElementById:$he,getElements:qhe,getElementsByClassName:Ghe,getElementsByTagName:iv,getElementsByTagType:Whe,getFeed:Khe,getInnerHTML:Ahe,getName:Phe,getOuterHTML:U$,getParent:q$,getSiblings:Rhe,getText:nw,hasAttrib:Ohe,hasChildren:Vd,innerText:AN,isCDATA:xD,isComment:XN,isDocument:z$,isTag:ru,isText:b0,nextElementSibling:Nhe,prepend:$$,prependChild:Bhe,prevElementSibling:Lhe,removeElement:x0,removeSubsets:Zhe,replaceElement:Fhe,testElement:Hhe,textContent:uD,uniqueSort:Yhe}),xN,t$;function ipe(){return t$||(t$=1,xN={trueFunc:function(){return!0},falseFunc:function(){return!1}}),xN}var npe=ipe(),Ir=mD(npe),lr=function(t){return t.Attribute="attribute",t.Pseudo="pseudo",t.PseudoElement="pseudo-element",t.Tag="tag",t.Universal="universal",t.Adjacent="adjacent",t.Child="child",t.Descendant="descendant",t.Parent="parent",t.Sibling="sibling",t.ColumnCombinator="column-combinator",t}(lr||{}),Ls=function(t){return t.Any="any",t.Element="element",t.End="end",t.Equals="equals",t.Exists="exists",t.Hyphen="hyphen",t.Not="not",t.Start="start",t}(Ls||{}),i$=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,rpe=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,ope=new Map([[126,Ls.Element],[94,Ls.Start],[36,Ls.End],[42,Ls.Any],[33,Ls.Not],[124,Ls.Hyphen]]),ape=new Set(["has","not","matches","is","where","host","host-context"]);function spe(t){switch(t.type){case lr.Adjacent:case lr.Child:case lr.Descendant:case lr.Parent:case lr.Sibling:case lr.ColumnCombinator:return!0;default:return!1}}var lpe=new Set(["contains","icontains"]);function cpe(t,i,e){let n=parseInt(i,16)-65536;return n!==n||e?i:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,n&1023|56320)}function tw(t){return t.replace(rpe,cpe)}function wN(t){return t===39||t===34}function n$(t){return t===32||t===9||t===10||t===12||t===13}function eL(t){let i=[],e=Q$(i,`${t}`,0);if(e<t.length)throw new Error(`Unmatched selector: ${t.slice(e)}`);return i}function Q$(t,i,e){let n=[];function o(q){let Z=i.slice(e+q).match(i$);if(!Z)throw new Error(`Expected name, found ${i.slice(e)}`);let[X]=Z;return e+=q+X.length,tw(X)}function r(q){for(e+=q;e<i.length&&n$(i.charCodeAt(e));)e++}function g(){e+=1;let q=e,Z=1;for(;Z>0&&e<i.length;e++)i.charCodeAt(e)===40&&!w(e)?Z++:i.charCodeAt(e)===41&&!w(e)&&Z--;if(Z)throw new Error("Parenthesis not matched");return tw(i.slice(q,e-1))}function w(q){let Z=0;for(;i.charCodeAt(--q)===92;)Z++;return(Z&1)===1}function T(){if(n.length>0&&spe(n[n.length-1]))throw new Error("Did not expect successive traversals.")}function k(q){if(n.length>0&&n[n.length-1].type===lr.Descendant){n[n.length-1].type=q;return}T(),n.push({type:q})}function N(q,Z){n.push({type:lr.Attribute,name:q,action:Z,value:o(1),namespace:null,ignoreCase:"quirks"})}function V(){if(n.length&&n[n.length-1].type===lr.Descendant&&n.pop(),n.length===0)throw new Error("Empty sub-selector");t.push(n)}if(r(0),i.length===e)return e;e:for(;e<i.length;){let q=i.charCodeAt(e);switch(q){case 32:case 9:case 10:case 12:case 13:{(n.length===0||n[0].type!==lr.Descendant)&&(T(),n.push({type:lr.Descendant})),r(1);break}case 62:{k(lr.Child),r(1);break}case 60:{k(lr.Parent),r(1);break}case 126:{k(lr.Sibling),r(1);break}case 43:{k(lr.Adjacent),r(1);break}case 46:{N("class",Ls.Element);break}case 35:{N("id",Ls.Equals);break}case 91:{r(1);let Z,X=null;i.charCodeAt(e)===124?Z=o(1):i.startsWith("*|",e)?(X="*",Z=o(2)):(Z=o(0),i.charCodeAt(e)===124&&i.charCodeAt(e+1)!==61&&(X=Z,Z=o(1))),r(0);let te=Ls.Exists,De=ope.get(i.charCodeAt(e));if(De){if(te=De,i.charCodeAt(e+1)!==61)throw new Error("Expected `=`");r(2)}else i.charCodeAt(e)===61&&(te=Ls.Equals,r(1));let _e="",he=null;if(te!=="exists"){if(wN(i.charCodeAt(e))){let ye=i.charCodeAt(e),vt=e+1;for(;vt<i.length&&(i.charCodeAt(vt)!==ye||w(vt));)vt+=1;if(i.charCodeAt(vt)!==ye)throw new Error("Attribute value didn't end");_e=tw(i.slice(e+1,vt)),e=vt+1}else{let ye=e;for(;e<i.length&&(!n$(i.charCodeAt(e))&&i.charCodeAt(e)!==93||w(e));)e+=1;_e=tw(i.slice(ye,e))}r(0);let Pe=i.charCodeAt(e)|32;Pe===115?(he=!1,r(1)):Pe===105&&(he=!0,r(1))}if(i.charCodeAt(e)!==93)throw new Error("Attribute selector didn't terminate");e+=1;let Ce={type:lr.Attribute,name:Z,action:te,value:_e,namespace:X,ignoreCase:he};n.push(Ce);break}case 58:{if(i.charCodeAt(e+1)===58){n.push({type:lr.PseudoElement,name:o(2).toLowerCase(),data:i.charCodeAt(e)===40?g():null});continue}let Z=o(1).toLowerCase(),X=null;if(i.charCodeAt(e)===40)if(ape.has(Z)){if(wN(i.charCodeAt(e+1)))throw new Error(`Pseudo-selector ${Z} cannot be quoted`);if(X=[],e=Q$(X,i,e+1),i.charCodeAt(e)!==41)throw new Error(`Missing closing parenthesis in :${Z} (${i})`);e+=1}else{if(X=g(),lpe.has(Z)){let te=X.charCodeAt(0);te===X.charCodeAt(X.length-1)&&wN(te)&&(X=X.slice(1,-1))}X=tw(X)}n.push({type:lr.Pseudo,name:Z,data:X});break}case 44:{V(),n=[],r(1);break}default:{if(i.startsWith("/*",e)){let te=i.indexOf("*/",e+2);if(te<0)throw new Error("Comment was not terminated");e=te+2,n.length===0&&r(0);break}let Z=null,X;if(q===42)e+=1,X="*";else if(q===124){if(X="",i.charCodeAt(e+1)===124){k(lr.ColumnCombinator),r(2);break}}else if(i$.test(i.slice(e)))X=o(0);else break e;i.charCodeAt(e)===124&&i.charCodeAt(e+1)!==124&&(Z=X,i.charCodeAt(e+1)===42?(X="*",e+=2):X=o(1)),n.push(X==="*"?{type:lr.Universal,namespace:Z}:{type:lr.Tag,name:X,namespace:Z})}}}return V(),e}var upe=["\\",'"'],w3e=[...upe,"(",")"],J$=new Map([[lr.Universal,50],[lr.Tag,30],[lr.Attribute,1],[lr.Pseudo,0]]);function tL(t){return!J$.has(t.type)}var dpe=new Map([[Ls.Exists,10],[Ls.Equals,8],[Ls.Not,7],[Ls.Start,6],[Ls.End,6],[Ls.Any,5]]);function hpe(t){let i=t.map(eG);for(let e=1;e<t.length;e++){let n=i[e];if(!(n<0))for(let o=e-1;o>=0&&n<i[o];o--){let r=t[o+1];t[o+1]=t[o],t[o]=r,i[o+1]=i[o],i[o]=n}}}function eG(t){var i,e;let n=(i=J$.get(t.type))!==null&&i!==void 0?i:-1;return t.type===lr.Attribute?(n=(e=dpe.get(t.action))!==null&&e!==void 0?e:4,t.action===Ls.Equals&&t.name==="id"&&(n=9),t.ignoreCase&&(n>>=1)):t.type===lr.Pseudo&&(t.data?t.name==="has"||t.name==="contains"?n=0:Array.isArray(t.data)?(n=Math.min(...t.data.map(o=>Math.min(...o.map(eG)))),n<0&&(n=0)):n=2:n=3),n}var ppe=/[-[\]{}()*+?.,\\^$|#\s]/g;function r$(t){return t.replace(ppe,"\\$&")}var fpe=new Set(["accept","accept-charset","align","alink","axis","bgcolor","charset","checked","clear","codetype","color","compact","declare","defer","dir","direction","disabled","enctype","face","frame","hreflang","http-equiv","lang","language","link","media","method","multiple","nohref","noresize","noshade","nowrap","readonly","rel","rev","rules","scope","scrolling","selected","shape","target","text","type","valign","valuetype","vlink"]);function g0(t,i){return typeof t.ignoreCase=="boolean"?t.ignoreCase:t.ignoreCase==="quirks"?!!i.quirksMode:!i.xmlMode&&fpe.has(t.name)}var mpe={equals(t,i,e){let{adapter:n}=e,{name:o}=i,{value:r}=i;return g0(i,e)?(r=r.toLowerCase(),g=>{let w=n.getAttributeValue(g,o);return w!=null&&w.length===r.length&&w.toLowerCase()===r&&t(g)}):g=>n.getAttributeValue(g,o)===r&&t(g)},hyphen(t,i,e){let{adapter:n}=e,{name:o}=i,{value:r}=i,g=r.length;return g0(i,e)?(r=r.toLowerCase(),function(T){let k=n.getAttributeValue(T,o);return k!=null&&(k.length===g||k.charAt(g)==="-")&&k.substr(0,g).toLowerCase()===r&&t(T)}):function(T){let k=n.getAttributeValue(T,o);return k!=null&&(k.length===g||k.charAt(g)==="-")&&k.substr(0,g)===r&&t(T)}},element(t,i,e){let{adapter:n}=e,{name:o,value:r}=i;if(/\s/.test(r))return Ir.falseFunc;let g=new RegExp(`(?:^|\\s)${r$(r)}(?:$|\\s)`,g0(i,e)?"i":"");return function(T){let k=n.getAttributeValue(T,o);return k!=null&&k.length>=r.length&&g.test(k)&&t(T)}},exists(t,{name:i},{adapter:e}){return n=>e.hasAttrib(n,i)&&t(n)},start(t,i,e){let{adapter:n}=e,{name:o}=i,{value:r}=i,g=r.length;return g===0?Ir.falseFunc:g0(i,e)?(r=r.toLowerCase(),w=>{let T=n.getAttributeValue(w,o);return T!=null&&T.length>=g&&T.substr(0,g).toLowerCase()===r&&t(w)}):w=>{var T;return!!(!((T=n.getAttributeValue(w,o))===null||T===void 0)&&T.startsWith(r))&&t(w)}},end(t,i,e){let{adapter:n}=e,{name:o}=i,{value:r}=i,g=-r.length;return g===0?Ir.falseFunc:g0(i,e)?(r=r.toLowerCase(),w=>{var T;return((T=n.getAttributeValue(w,o))===null||T===void 0?void 0:T.substr(g).toLowerCase())===r&&t(w)}):w=>{var T;return!!(!((T=n.getAttributeValue(w,o))===null||T===void 0)&&T.endsWith(r))&&t(w)}},any(t,i,e){let{adapter:n}=e,{name:o,value:r}=i;if(r==="")return Ir.falseFunc;if(g0(i,e)){let g=new RegExp(r$(r),"i");return function(T){let k=n.getAttributeValue(T,o);return k!=null&&k.length>=r.length&&g.test(k)&&t(T)}}return g=>{var w;return!!(!((w=n.getAttributeValue(g,o))===null||w===void 0)&&w.includes(r))&&t(g)}},not(t,i,e){let{adapter:n}=e,{name:o}=i,{value:r}=i;return r===""?g=>!!n.getAttributeValue(g,o)&&t(g):g0(i,e)?(r=r.toLowerCase(),g=>{let w=n.getAttributeValue(g,o);return(w==null||w.length!==r.length||w.toLowerCase()!==r)&&t(g)}):g=>n.getAttributeValue(g,o)!==r&&t(g)}},gpe=new Set([9,10,12,13,32]),o$=48,_pe=57;function ype(t){if(t=t.trim().toLowerCase(),t==="even")return[2,0];if(t==="odd")return[2,1];let i=0,e=0,n=r(),o=g();if(i<t.length&&t.charAt(i)==="n"&&(i++,e=n*(o??1),w(),i<t.length?(n=r(),w(),o=g()):n=o=0),o===null||i<t.length)throw new Error(`n-th rule couldn't be parsed ('${t}')`);return[e,n*o];function r(){return t.charAt(i)==="-"?(i++,-1):(t.charAt(i)==="+"&&i++,1)}function g(){let T=i,k=0;for(;i<t.length&&t.charCodeAt(i)>=o$&&t.charCodeAt(i)<=_pe;)k=k*10+(t.charCodeAt(i)-o$),i++;return i===T?null:k}function w(){for(;i<t.length&&gpe.has(t.charCodeAt(i));)i++}}function vpe(t){let i=t[0],e=t[1]-1;if(e<0&&i<=0)return Ir.falseFunc;if(i===-1)return r=>r<=e;if(i===0)return r=>r===e;if(i===1)return e<0?Ir.trueFunc:r=>r>=e;let n=Math.abs(i),o=(e%n+n)%n;return i>1?r=>r>=e&&r%n===o:r=>r<=e&&r%n===o}function nD(t){return vpe(ype(t))}function rD(t,i){return e=>{let n=i.getParent(e);return n!=null&&i.isTag(n)&&t(e)}}var kN={contains(t,i,{adapter:e}){return function(o){return t(o)&&e.getText(o).includes(i)}},icontains(t,i,{adapter:e}){let n=i.toLowerCase();return function(r){return t(r)&&e.getText(r).toLowerCase().includes(n)}},"nth-child"(t,i,{adapter:e,equals:n}){let o=nD(i);return o===Ir.falseFunc?Ir.falseFunc:o===Ir.trueFunc?rD(t,e):function(g){let w=e.getSiblings(g),T=0;for(let k=0;k<w.length&&!n(g,w[k]);k++)e.isTag(w[k])&&T++;return o(T)&&t(g)}},"nth-last-child"(t,i,{adapter:e,equals:n}){let o=nD(i);return o===Ir.falseFunc?Ir.falseFunc:o===Ir.trueFunc?rD(t,e):function(g){let w=e.getSiblings(g),T=0;for(let k=w.length-1;k>=0&&!n(g,w[k]);k--)e.isTag(w[k])&&T++;return o(T)&&t(g)}},"nth-of-type"(t,i,{adapter:e,equals:n}){let o=nD(i);return o===Ir.falseFunc?Ir.falseFunc:o===Ir.trueFunc?rD(t,e):function(g){let w=e.getSiblings(g),T=0;for(let k=0;k<w.length;k++){let N=w[k];if(n(g,N))break;e.isTag(N)&&e.getName(N)===e.getName(g)&&T++}return o(T)&&t(g)}},"nth-last-of-type"(t,i,{adapter:e,equals:n}){let o=nD(i);return o===Ir.falseFunc?Ir.falseFunc:o===Ir.trueFunc?rD(t,e):function(g){let w=e.getSiblings(g),T=0;for(let k=w.length-1;k>=0;k--){let N=w[k];if(n(g,N))break;e.isTag(N)&&e.getName(N)===e.getName(g)&&T++}return o(T)&&t(g)}},root(t,i,{adapter:e}){return n=>{let o=e.getParent(n);return(o==null||!e.isTag(o))&&t(n)}},scope(t,i,e,n){let{equals:o}=e;return!n||n.length===0?kN.root(t,i,e):n.length===1?r=>o(n[0],r)&&t(r):r=>n.includes(r)&&t(r)},hover:EN("isHovered"),visited:EN("isVisited"),active:EN("isActive")};function EN(t){return function(e,n,{adapter:o}){let r=o[t];return typeof r!="function"?Ir.falseFunc:function(w){return r(w)&&e(w)}}}var a$={empty(t,{adapter:i}){return!i.getChildren(t).some(e=>i.isTag(e)||i.getText(e)!=="")},"first-child"(t,{adapter:i,equals:e}){if(i.prevElementSibling)return i.prevElementSibling(t)==null;let n=i.getSiblings(t).find(o=>i.isTag(o));return n!=null&&e(t,n)},"last-child"(t,{adapter:i,equals:e}){let n=i.getSiblings(t);for(let o=n.length-1;o>=0;o--){if(e(t,n[o]))return!0;if(i.isTag(n[o]))break}return!1},"first-of-type"(t,{adapter:i,equals:e}){let n=i.getSiblings(t),o=i.getName(t);for(let r=0;r<n.length;r++){let g=n[r];if(e(t,g))return!0;if(i.isTag(g)&&i.getName(g)===o)break}return!1},"last-of-type"(t,{adapter:i,equals:e}){let n=i.getSiblings(t),o=i.getName(t);for(let r=n.length-1;r>=0;r--){let g=n[r];if(e(t,g))return!0;if(i.isTag(g)&&i.getName(g)===o)break}return!1},"only-of-type"(t,{adapter:i,equals:e}){let n=i.getName(t);return i.getSiblings(t).every(o=>e(t,o)||!i.isTag(o)||i.getName(o)!==n)},"only-child"(t,{adapter:i,equals:e}){return i.getSiblings(t).every(n=>e(t,n)||!i.isTag(n))}};function s$(t,i,e,n){if(e===null){if(t.length>n)throw new Error(`Pseudo-class :${i} requires an argument`)}else if(t.length===n)throw new Error(`Pseudo-class :${i} doesn't have any arguments`)}var bpe={"any-link":":is(a, area, link)[href]",link:":any-link:not(:visited)",disabled:`:is(
        :is(button, input, select, textarea, optgroup, option)[disabled],
        optgroup[disabled] > option,
        fieldset[disabled]:not(fieldset[disabled] legend:first-of-type *)
    )`,enabled:":not(:disabled)",checked:":is(:is(input[type=radio], input[type=checkbox])[checked], option:selected)",required:":is(input, select, textarea)[required]",optional:":is(input, select, textarea):not([required])",selected:"option:is([selected], select:not([multiple]):not(:has(> option[selected])) > :first-of-type)",checkbox:"[type=checkbox]",file:"[type=file]",password:"[type=password]",radio:"[type=radio]",reset:"[type=reset]",image:"[type=image]",submit:"[type=submit]",parent:":not(:empty)",header:":is(h1, h2, h3, h4, h5, h6)",button:":is(button, input[type=button])",input:":is(input, textarea, select, button)",text:"input:is(:not([type!='']), [type=text])"},tG={};function xpe(t,i){return t===Ir.falseFunc?Ir.falseFunc:e=>i.isTag(e)&&t(e)}function iG(t,i){let e=i.getSiblings(t);if(e.length<=1)return[];let n=e.indexOf(t);return n<0||n===e.length-1?[]:e.slice(n+1).filter(i.isTag)}function ON(t){return{xmlMode:!!t.xmlMode,lowerCaseAttributeNames:!!t.lowerCaseAttributeNames,lowerCaseTags:!!t.lowerCaseTags,quirksMode:!!t.quirksMode,cacheResults:!!t.cacheResults,pseudos:t.pseudos,adapter:t.adapter,equals:t.equals}}var CN=(t,i,e,n,o)=>{let r=o(i,ON(e),n);return r===Ir.trueFunc?t:r===Ir.falseFunc?Ir.falseFunc:g=>r(g)&&t(g)},SN={is:CN,matches:CN,where:CN,not(t,i,e,n,o){let r=o(i,ON(e),n);return r===Ir.falseFunc?t:r===Ir.trueFunc?Ir.falseFunc:g=>!r(g)&&t(g)},has(t,i,e,n,o){let{adapter:r}=e,g=ON(e);g.relativeSelector=!0;let w=i.some(N=>N.some(tL))?[tG]:void 0,T=o(i,g,w);if(T===Ir.falseFunc)return Ir.falseFunc;let k=xpe(T,r);if(w&&T!==Ir.trueFunc){let{shouldTestNextSiblings:N=!1}=T;return V=>{if(!t(V))return!1;w[0]=V;let q=r.getChildren(V),Z=N?[...q,...iG(V,r)]:q;return r.existsOne(k,Z)}}return N=>t(N)&&r.existsOne(k,r.getChildren(N))}};function wpe(t,i,e,n,o){var r;let{name:g,data:w}=i;if(Array.isArray(w)){if(!(g in SN))throw new Error(`Unknown pseudo-class :${g}(${w})`);return SN[g](t,w,e,n,o)}let T=(r=e.pseudos)===null||r===void 0?void 0:r[g],k=typeof T=="string"?T:bpe[g];if(typeof k=="string"){if(w!=null)throw new Error(`Pseudo ${g} doesn't have any arguments`);let N=eL(k);return SN.is(t,N,e,n,o)}if(typeof T=="function")return s$(T,g,w,1),N=>T(N,w)&&t(N);if(g in kN)return kN[g](t,w,e,n);if(g in a$){let N=a$[g];return s$(N,g,w,2),V=>N(V,e,w)&&t(V)}throw new Error(`Unknown pseudo-class :${g}`)}function TN(t,i){let e=i.getParent(t);return e&&i.isTag(e)?e:null}function Epe(t,i,e,n,o){let{adapter:r,equals:g}=e;switch(i.type){case lr.PseudoElement:throw new Error("Pseudo-elements are not supported by css-select");case lr.ColumnCombinator:throw new Error("Column combinators are not yet supported by css-select");case lr.Attribute:{if(i.namespace!=null)throw new Error("Namespaced attributes are not yet supported by css-select");return(!e.xmlMode||e.lowerCaseAttributeNames)&&(i.name=i.name.toLowerCase()),mpe[i.action](t,i,e)}case lr.Pseudo:return wpe(t,i,e,n,o);case lr.Tag:{if(i.namespace!=null)throw new Error("Namespaced tag names are not yet supported by css-select");let{name:w}=i;return(!e.xmlMode||e.lowerCaseTags)&&(w=w.toLowerCase()),function(k){return r.getName(k)===w&&t(k)}}case lr.Descendant:{if(e.cacheResults===!1||typeof WeakSet>"u")return function(k){let N=k;for(;N=TN(N,r);)if(t(N))return!0;return!1};let w=new WeakSet;return function(k){let N=k;for(;N=TN(N,r);)if(!w.has(N)){if(r.isTag(N)&&t(N))return!0;w.add(N)}return!1}}case"_flexibleDescendant":return function(T){let k=T;do if(t(k))return!0;while(k=TN(k,r));return!1};case lr.Parent:return function(T){return r.getChildren(T).some(k=>r.isTag(k)&&t(k))};case lr.Child:return function(T){let k=r.getParent(T);return k!=null&&r.isTag(k)&&t(k)};case lr.Sibling:return function(T){let k=r.getSiblings(T);for(let N=0;N<k.length;N++){let V=k[N];if(g(T,V))break;if(r.isTag(V)&&t(V))return!0}return!1};case lr.Adjacent:return r.prevElementSibling?function(T){let k=r.prevElementSibling(T);return k!=null&&t(k)}:function(T){let k=r.getSiblings(T),N;for(let V=0;V<k.length;V++){let q=k[V];if(g(T,q))break;r.isTag(q)&&(N=q)}return!!N&&t(N)};case lr.Universal:{if(i.namespace!=null&&i.namespace!=="*")throw new Error("Namespaced universal selectors are not yet supported by css-select");return t}}}function Cpe(t,i,e){let n=typeof t=="string"?eL(t):t;return rG(n,i,e)}function nG(t){return t.type===lr.Pseudo&&(t.name==="scope"||Array.isArray(t.data)&&t.data.some(i=>i.some(nG)))}var Spe={type:lr.Descendant},Tpe={type:"_flexibleDescendant"},Dpe={type:lr.Pseudo,name:"scope",data:null};function Mpe(t,{adapter:i},e){let n=!!e?.every(o=>{let r=i.isTag(o)&&i.getParent(o);return o===tG||r&&i.isTag(r)});for(let o of t){if(!(o.length>0&&tL(o[0])&&o[0].type!==lr.Descendant))if(n&&!o.some(nG))o.unshift(Spe);else continue;o.unshift(Dpe)}}function rG(t,i,e){var n;t.forEach(hpe),e=(n=i.context)!==null&&n!==void 0?n:e;let o=Array.isArray(e),r=e&&(Array.isArray(e)?e:[e]);if(i.relativeSelector!==!1)Mpe(t,i,r);else if(t.some(T=>T.length>0&&tL(T[0])))throw new Error("Relative selectors are not allowed when the `relativeSelector` option is disabled");let g=!1,w=t.map(T=>{if(T.length>=2){let[k,N]=T;k.type!==lr.Pseudo||k.name!=="scope"||(o&&N.type===lr.Descendant?T[1]=Tpe:(N.type===lr.Adjacent||N.type===lr.Sibling)&&(g=!0))}return Ipe(T,i,r)}).reduce(Ape,Ir.falseFunc);return w.shouldTestNextSiblings=g,w}function Ipe(t,i,e){var n;return t.reduce((o,r)=>o===Ir.falseFunc?Ir.falseFunc:Epe(o,r,i,e,rG),(n=i.rootFunc)!==null&&n!==void 0?n:Ir.trueFunc)}function Ape(t,i){return i===Ir.falseFunc||t===Ir.trueFunc?t:t===Ir.falseFunc||i===Ir.trueFunc?i:function(n){return t(n)||i(n)}}var oG=(t,i)=>t===i,Rpe={adapter:X$,equals:oG};function kpe(t){var i,e,n,o;let r=t??Rpe;return(i=r.adapter)!==null&&i!==void 0||(r.adapter=X$),(e=r.equals)!==null&&e!==void 0||(r.equals=(o=(n=r.adapter)===null||n===void 0?void 0:n.equals)!==null&&o!==void 0?o:oG),r}function aG(t){return function(e,n,o){let r=kpe(o);typeof e!="function"&&(e=Cpe(e,r,n));let g=Ope(n,r.adapter,e.shouldTestNextSiblings);return t(e,g,r)}}function Ope(t,i,e=!1){return e&&(t=Ppe(t,i)),Array.isArray(t)?i.removeSubsets(t):i.getChildren(t)}function Ppe(t,i){let e=Array.isArray(t)?t.slice(0):[t],n=e.length;for(let o=0;o<n;o++){let r=iG(e[o],i);e.push(...r)}return e}var sG=aG((t,i,e)=>t===Ir.falseFunc||!i||i.length===0?[]:e.adapter.findAll(t,i)),iL=aG((t,i,e)=>t===Ir.falseFunc||!i||i.length===0?null:e.adapter.findOne(t,i)),Npe=new Uint16Array('\u1D41<\xD5\u0131\u028A\u049D\u057B\u05D0\u0675\u06DE\u07A2\u07D6\u080F\u0A4A\u0A91\u0DA1\u0E6D\u0F09\u0F26\u10CA\u1228\u12E1\u1415\u149D\u14C3\u14DF\u1525\0\0\0\0\0\0\u156B\u16CD\u198D\u1C12\u1DDD\u1F7E\u2060\u21B0\u228D\u23C0\u23FB\u2442\u2824\u2912\u2D08\u2E48\u2FCE\u3016\u32BA\u3639\u37AC\u38FE\u3A28\u3A71\u3AE0\u3B2E\u0800EMabcfglmnoprstu\\bfms\x7F\x84\x8B\x90\x95\x98\xA6\xB3\xB9\xC8\xCFlig\u803B\xC6\u40C6P\u803B&\u4026cute\u803B\xC1\u40C1reve;\u4102\u0100iyx}rc\u803B\xC2\u40C2;\u4410r;\uC000\u{1D504}rave\u803B\xC0\u40C0pha;\u4391acr;\u4100d;\u6A53\u0100gp\x9D\xA1on;\u4104f;\uC000\u{1D538}plyFunction;\u6061ing\u803B\xC5\u40C5\u0100cs\xBE\xC3r;\uC000\u{1D49C}ign;\u6254ilde\u803B\xC3\u40C3ml\u803B\xC4\u40C4\u0400aceforsu\xE5\xFB\xFE\u0117\u011C\u0122\u0127\u012A\u0100cr\xEA\xF2kslash;\u6216\u0176\xF6\xF8;\u6AE7ed;\u6306y;\u4411\u0180crt\u0105\u010B\u0114ause;\u6235noullis;\u612Ca;\u4392r;\uC000\u{1D505}pf;\uC000\u{1D539}eve;\u42D8c\xF2\u0113mpeq;\u624E\u0700HOacdefhilorsu\u014D\u0151\u0156\u0180\u019E\u01A2\u01B5\u01B7\u01BA\u01DC\u0215\u0273\u0278\u027Ecy;\u4427PY\u803B\xA9\u40A9\u0180cpy\u015D\u0162\u017Aute;\u4106\u0100;i\u0167\u0168\u62D2talDifferentialD;\u6145leys;\u612D\u0200aeio\u0189\u018E\u0194\u0198ron;\u410Cdil\u803B\xC7\u40C7rc;\u4108nint;\u6230ot;\u410A\u0100dn\u01A7\u01ADilla;\u40B8terDot;\u40B7\xF2\u017Fi;\u43A7rcle\u0200DMPT\u01C7\u01CB\u01D1\u01D6ot;\u6299inus;\u6296lus;\u6295imes;\u6297o\u0100cs\u01E2\u01F8kwiseContourIntegral;\u6232eCurly\u0100DQ\u0203\u020FoubleQuote;\u601Duote;\u6019\u0200lnpu\u021E\u0228\u0247\u0255on\u0100;e\u0225\u0226\u6237;\u6A74\u0180git\u022F\u0236\u023Aruent;\u6261nt;\u622FourIntegral;\u622E\u0100fr\u024C\u024E;\u6102oduct;\u6210nterClockwiseContourIntegral;\u6233oss;\u6A2Fcr;\uC000\u{1D49E}p\u0100;C\u0284\u0285\u62D3ap;\u624D\u0580DJSZacefios\u02A0\u02AC\u02B0\u02B4\u02B8\u02CB\u02D7\u02E1\u02E6\u0333\u048D\u0100;o\u0179\u02A5trahd;\u6911cy;\u4402cy;\u4405cy;\u440F\u0180grs\u02BF\u02C4\u02C7ger;\u6021r;\u61A1hv;\u6AE4\u0100ay\u02D0\u02D5ron;\u410E;\u4414l\u0100;t\u02DD\u02DE\u6207a;\u4394r;\uC000\u{1D507}\u0100af\u02EB\u0327\u0100cm\u02F0\u0322ritical\u0200ADGT\u0300\u0306\u0316\u031Ccute;\u40B4o\u0174\u030B\u030D;\u42D9bleAcute;\u42DDrave;\u4060ilde;\u42DCond;\u62C4ferentialD;\u6146\u0470\u033D\0\0\0\u0342\u0354\0\u0405f;\uC000\u{1D53B}\u0180;DE\u0348\u0349\u034D\u40A8ot;\u60DCqual;\u6250ble\u0300CDLRUV\u0363\u0372\u0382\u03CF\u03E2\u03F8ontourIntegra\xEC\u0239o\u0274\u0379\0\0\u037B\xBB\u0349nArrow;\u61D3\u0100eo\u0387\u03A4ft\u0180ART\u0390\u0396\u03A1rrow;\u61D0ightArrow;\u61D4e\xE5\u02CAng\u0100LR\u03AB\u03C4eft\u0100AR\u03B3\u03B9rrow;\u67F8ightArrow;\u67FAightArrow;\u67F9ight\u0100AT\u03D8\u03DErrow;\u61D2ee;\u62A8p\u0241\u03E9\0\0\u03EFrrow;\u61D1ownArrow;\u61D5erticalBar;\u6225n\u0300ABLRTa\u0412\u042A\u0430\u045E\u047F\u037Crrow\u0180;BU\u041D\u041E\u0422\u6193ar;\u6913pArrow;\u61F5reve;\u4311eft\u02D2\u043A\0\u0446\0\u0450ightVector;\u6950eeVector;\u695Eector\u0100;B\u0459\u045A\u61BDar;\u6956ight\u01D4\u0467\0\u0471eeVector;\u695Fector\u0100;B\u047A\u047B\u61C1ar;\u6957ee\u0100;A\u0486\u0487\u62A4rrow;\u61A7\u0100ct\u0492\u0497r;\uC000\u{1D49F}rok;\u4110\u0800NTacdfglmopqstux\u04BD\u04C0\u04C4\u04CB\u04DE\u04E2\u04E7\u04EE\u04F5\u0521\u052F\u0536\u0552\u055D\u0560\u0565G;\u414AH\u803B\xD0\u40D0cute\u803B\xC9\u40C9\u0180aiy\u04D2\u04D7\u04DCron;\u411Arc\u803B\xCA\u40CA;\u442Dot;\u4116r;\uC000\u{1D508}rave\u803B\xC8\u40C8ement;\u6208\u0100ap\u04FA\u04FEcr;\u4112ty\u0253\u0506\0\0\u0512mallSquare;\u65FBerySmallSquare;\u65AB\u0100gp\u0526\u052Aon;\u4118f;\uC000\u{1D53C}silon;\u4395u\u0100ai\u053C\u0549l\u0100;T\u0542\u0543\u6A75ilde;\u6242librium;\u61CC\u0100ci\u0557\u055Ar;\u6130m;\u6A73a;\u4397ml\u803B\xCB\u40CB\u0100ip\u056A\u056Fsts;\u6203onentialE;\u6147\u0280cfios\u0585\u0588\u058D\u05B2\u05CCy;\u4424r;\uC000\u{1D509}lled\u0253\u0597\0\0\u05A3mallSquare;\u65FCerySmallSquare;\u65AA\u0370\u05BA\0\u05BF\0\0\u05C4f;\uC000\u{1D53D}All;\u6200riertrf;\u6131c\xF2\u05CB\u0600JTabcdfgorst\u05E8\u05EC\u05EF\u05FA\u0600\u0612\u0616\u061B\u061D\u0623\u066C\u0672cy;\u4403\u803B>\u403Emma\u0100;d\u05F7\u05F8\u4393;\u43DCreve;\u411E\u0180eiy\u0607\u060C\u0610dil;\u4122rc;\u411C;\u4413ot;\u4120r;\uC000\u{1D50A};\u62D9pf;\uC000\u{1D53E}eater\u0300EFGLST\u0635\u0644\u064E\u0656\u065B\u0666qual\u0100;L\u063E\u063F\u6265ess;\u62DBullEqual;\u6267reater;\u6AA2ess;\u6277lantEqual;\u6A7Eilde;\u6273cr;\uC000\u{1D4A2};\u626B\u0400Aacfiosu\u0685\u068B\u0696\u069B\u069E\u06AA\u06BE\u06CARDcy;\u442A\u0100ct\u0690\u0694ek;\u42C7;\u405Eirc;\u4124r;\u610ClbertSpace;\u610B\u01F0\u06AF\0\u06B2f;\u610DizontalLine;\u6500\u0100ct\u06C3\u06C5\xF2\u06A9rok;\u4126mp\u0144\u06D0\u06D8ownHum\xF0\u012Fqual;\u624F\u0700EJOacdfgmnostu\u06FA\u06FE\u0703\u0707\u070E\u071A\u071E\u0721\u0728\u0744\u0778\u078B\u078F\u0795cy;\u4415lig;\u4132cy;\u4401cute\u803B\xCD\u40CD\u0100iy\u0713\u0718rc\u803B\xCE\u40CE;\u4418ot;\u4130r;\u6111rave\u803B\xCC\u40CC\u0180;ap\u0720\u072F\u073F\u0100cg\u0734\u0737r;\u412AinaryI;\u6148lie\xF3\u03DD\u01F4\u0749\0\u0762\u0100;e\u074D\u074E\u622C\u0100gr\u0753\u0758ral;\u622Bsection;\u62C2isible\u0100CT\u076C\u0772omma;\u6063imes;\u6062\u0180gpt\u077F\u0783\u0788on;\u412Ef;\uC000\u{1D540}a;\u4399cr;\u6110ilde;\u4128\u01EB\u079A\0\u079Ecy;\u4406l\u803B\xCF\u40CF\u0280cfosu\u07AC\u07B7\u07BC\u07C2\u07D0\u0100iy\u07B1\u07B5rc;\u4134;\u4419r;\uC000\u{1D50D}pf;\uC000\u{1D541}\u01E3\u07C7\0\u07CCr;\uC000\u{1D4A5}rcy;\u4408kcy;\u4404\u0380HJacfos\u07E4\u07E8\u07EC\u07F1\u07FD\u0802\u0808cy;\u4425cy;\u440Cppa;\u439A\u0100ey\u07F6\u07FBdil;\u4136;\u441Ar;\uC000\u{1D50E}pf;\uC000\u{1D542}cr;\uC000\u{1D4A6}\u0580JTaceflmost\u0825\u0829\u082C\u0850\u0863\u09B3\u09B8\u09C7\u09CD\u0A37\u0A47cy;\u4409\u803B<\u403C\u0280cmnpr\u0837\u083C\u0841\u0844\u084Dute;\u4139bda;\u439Bg;\u67EAlacetrf;\u6112r;\u619E\u0180aey\u0857\u085C\u0861ron;\u413Ddil;\u413B;\u441B\u0100fs\u0868\u0970t\u0500ACDFRTUVar\u087E\u08A9\u08B1\u08E0\u08E6\u08FC\u092F\u095B\u0390\u096A\u0100nr\u0883\u088FgleBracket;\u67E8row\u0180;BR\u0899\u089A\u089E\u6190ar;\u61E4ightArrow;\u61C6eiling;\u6308o\u01F5\u08B7\0\u08C3bleBracket;\u67E6n\u01D4\u08C8\0\u08D2eeVector;\u6961ector\u0100;B\u08DB\u08DC\u61C3ar;\u6959loor;\u630Aight\u0100AV\u08EF\u08F5rrow;\u6194ector;\u694E\u0100er\u0901\u0917e\u0180;AV\u0909\u090A\u0910\u62A3rrow;\u61A4ector;\u695Aiangle\u0180;BE\u0924\u0925\u0929\u62B2ar;\u69CFqual;\u62B4p\u0180DTV\u0937\u0942\u094CownVector;\u6951eeVector;\u6960ector\u0100;B\u0956\u0957\u61BFar;\u6958ector\u0100;B\u0965\u0966\u61BCar;\u6952ight\xE1\u039Cs\u0300EFGLST\u097E\u098B\u0995\u099D\u09A2\u09ADqualGreater;\u62DAullEqual;\u6266reater;\u6276ess;\u6AA1lantEqual;\u6A7Dilde;\u6272r;\uC000\u{1D50F}\u0100;e\u09BD\u09BE\u62D8ftarrow;\u61DAidot;\u413F\u0180npw\u09D4\u0A16\u0A1Bg\u0200LRlr\u09DE\u09F7\u0A02\u0A10eft\u0100AR\u09E6\u09ECrrow;\u67F5ightArrow;\u67F7ightArrow;\u67F6eft\u0100ar\u03B3\u0A0Aight\xE1\u03BFight\xE1\u03CAf;\uC000\u{1D543}er\u0100LR\u0A22\u0A2CeftArrow;\u6199ightArrow;\u6198\u0180cht\u0A3E\u0A40\u0A42\xF2\u084C;\u61B0rok;\u4141;\u626A\u0400acefiosu\u0A5A\u0A5D\u0A60\u0A77\u0A7C\u0A85\u0A8B\u0A8Ep;\u6905y;\u441C\u0100dl\u0A65\u0A6FiumSpace;\u605Flintrf;\u6133r;\uC000\u{1D510}nusPlus;\u6213pf;\uC000\u{1D544}c\xF2\u0A76;\u439C\u0480Jacefostu\u0AA3\u0AA7\u0AAD\u0AC0\u0B14\u0B19\u0D91\u0D97\u0D9Ecy;\u440Acute;\u4143\u0180aey\u0AB4\u0AB9\u0ABEron;\u4147dil;\u4145;\u441D\u0180gsw\u0AC7\u0AF0\u0B0Eative\u0180MTV\u0AD3\u0ADF\u0AE8ediumSpace;\u600Bhi\u0100cn\u0AE6\u0AD8\xEB\u0AD9eryThi\xEE\u0AD9ted\u0100GL\u0AF8\u0B06reaterGreate\xF2\u0673essLes\xF3\u0A48Line;\u400Ar;\uC000\u{1D511}\u0200Bnpt\u0B22\u0B28\u0B37\u0B3Areak;\u6060BreakingSpace;\u40A0f;\u6115\u0680;CDEGHLNPRSTV\u0B55\u0B56\u0B6A\u0B7C\u0BA1\u0BEB\u0C04\u0C5E\u0C84\u0CA6\u0CD8\u0D61\u0D85\u6AEC\u0100ou\u0B5B\u0B64ngruent;\u6262pCap;\u626DoubleVerticalBar;\u6226\u0180lqx\u0B83\u0B8A\u0B9Bement;\u6209ual\u0100;T\u0B92\u0B93\u6260ilde;\uC000\u2242\u0338ists;\u6204reater\u0380;EFGLST\u0BB6\u0BB7\u0BBD\u0BC9\u0BD3\u0BD8\u0BE5\u626Fqual;\u6271ullEqual;\uC000\u2267\u0338reater;\uC000\u226B\u0338ess;\u6279lantEqual;\uC000\u2A7E\u0338ilde;\u6275ump\u0144\u0BF2\u0BFDownHump;\uC000\u224E\u0338qual;\uC000\u224F\u0338e\u0100fs\u0C0A\u0C27tTriangle\u0180;BE\u0C1A\u0C1B\u0C21\u62EAar;\uC000\u29CF\u0338qual;\u62ECs\u0300;EGLST\u0C35\u0C36\u0C3C\u0C44\u0C4B\u0C58\u626Equal;\u6270reater;\u6278ess;\uC000\u226A\u0338lantEqual;\uC000\u2A7D\u0338ilde;\u6274ested\u0100GL\u0C68\u0C79reaterGreater;\uC000\u2AA2\u0338essLess;\uC000\u2AA1\u0338recedes\u0180;ES\u0C92\u0C93\u0C9B\u6280qual;\uC000\u2AAF\u0338lantEqual;\u62E0\u0100ei\u0CAB\u0CB9verseElement;\u620CghtTriangle\u0180;BE\u0CCB\u0CCC\u0CD2\u62EBar;\uC000\u29D0\u0338qual;\u62ED\u0100qu\u0CDD\u0D0CuareSu\u0100bp\u0CE8\u0CF9set\u0100;E\u0CF0\u0CF3\uC000\u228F\u0338qual;\u62E2erset\u0100;E\u0D03\u0D06\uC000\u2290\u0338qual;\u62E3\u0180bcp\u0D13\u0D24\u0D4Eset\u0100;E\u0D1B\u0D1E\uC000\u2282\u20D2qual;\u6288ceeds\u0200;EST\u0D32\u0D33\u0D3B\u0D46\u6281qual;\uC000\u2AB0\u0338lantEqual;\u62E1ilde;\uC000\u227F\u0338erset\u0100;E\u0D58\u0D5B\uC000\u2283\u20D2qual;\u6289ilde\u0200;EFT\u0D6E\u0D6F\u0D75\u0D7F\u6241qual;\u6244ullEqual;\u6247ilde;\u6249erticalBar;\u6224cr;\uC000\u{1D4A9}ilde\u803B\xD1\u40D1;\u439D\u0700Eacdfgmoprstuv\u0DBD\u0DC2\u0DC9\u0DD5\u0DDB\u0DE0\u0DE7\u0DFC\u0E02\u0E20\u0E22\u0E32\u0E3F\u0E44lig;\u4152cute\u803B\xD3\u40D3\u0100iy\u0DCE\u0DD3rc\u803B\xD4\u40D4;\u441Eblac;\u4150r;\uC000\u{1D512}rave\u803B\xD2\u40D2\u0180aei\u0DEE\u0DF2\u0DF6cr;\u414Cga;\u43A9cron;\u439Fpf;\uC000\u{1D546}enCurly\u0100DQ\u0E0E\u0E1AoubleQuote;\u601Cuote;\u6018;\u6A54\u0100cl\u0E27\u0E2Cr;\uC000\u{1D4AA}ash\u803B\xD8\u40D8i\u016C\u0E37\u0E3Cde\u803B\xD5\u40D5es;\u6A37ml\u803B\xD6\u40D6er\u0100BP\u0E4B\u0E60\u0100ar\u0E50\u0E53r;\u603Eac\u0100ek\u0E5A\u0E5C;\u63DEet;\u63B4arenthesis;\u63DC\u0480acfhilors\u0E7F\u0E87\u0E8A\u0E8F\u0E92\u0E94\u0E9D\u0EB0\u0EFCrtialD;\u6202y;\u441Fr;\uC000\u{1D513}i;\u43A6;\u43A0usMinus;\u40B1\u0100ip\u0EA2\u0EADncareplan\xE5\u069Df;\u6119\u0200;eio\u0EB9\u0EBA\u0EE0\u0EE4\u6ABBcedes\u0200;EST\u0EC8\u0EC9\u0ECF\u0EDA\u627Aqual;\u6AAFlantEqual;\u627Cilde;\u627Eme;\u6033\u0100dp\u0EE9\u0EEEuct;\u620Fortion\u0100;a\u0225\u0EF9l;\u621D\u0100ci\u0F01\u0F06r;\uC000\u{1D4AB};\u43A8\u0200Ufos\u0F11\u0F16\u0F1B\u0F1FOT\u803B"\u4022r;\uC000\u{1D514}pf;\u611Acr;\uC000\u{1D4AC}\u0600BEacefhiorsu\u0F3E\u0F43\u0F47\u0F60\u0F73\u0FA7\u0FAA\u0FAD\u1096\u10A9\u10B4\u10BEarr;\u6910G\u803B\xAE\u40AE\u0180cnr\u0F4E\u0F53\u0F56ute;\u4154g;\u67EBr\u0100;t\u0F5C\u0F5D\u61A0l;\u6916\u0180aey\u0F67\u0F6C\u0F71ron;\u4158dil;\u4156;\u4420\u0100;v\u0F78\u0F79\u611Cerse\u0100EU\u0F82\u0F99\u0100lq\u0F87\u0F8Eement;\u620Builibrium;\u61CBpEquilibrium;\u696Fr\xBB\u0F79o;\u43A1ght\u0400ACDFTUVa\u0FC1\u0FEB\u0FF3\u1022\u1028\u105B\u1087\u03D8\u0100nr\u0FC6\u0FD2gleBracket;\u67E9row\u0180;BL\u0FDC\u0FDD\u0FE1\u6192ar;\u61E5eftArrow;\u61C4eiling;\u6309o\u01F5\u0FF9\0\u1005bleBracket;\u67E7n\u01D4\u100A\0\u1014eeVector;\u695Dector\u0100;B\u101D\u101E\u61C2ar;\u6955loor;\u630B\u0100er\u102D\u1043e\u0180;AV\u1035\u1036\u103C\u62A2rrow;\u61A6ector;\u695Biangle\u0180;BE\u1050\u1051\u1055\u62B3ar;\u69D0qual;\u62B5p\u0180DTV\u1063\u106E\u1078ownVector;\u694FeeVector;\u695Cector\u0100;B\u1082\u1083\u61BEar;\u6954ector\u0100;B\u1091\u1092\u61C0ar;\u6953\u0100pu\u109B\u109Ef;\u611DndImplies;\u6970ightarrow;\u61DB\u0100ch\u10B9\u10BCr;\u611B;\u61B1leDelayed;\u69F4\u0680HOacfhimoqstu\u10E4\u10F1\u10F7\u10FD\u1119\u111E\u1151\u1156\u1161\u1167\u11B5\u11BB\u11BF\u0100Cc\u10E9\u10EEHcy;\u4429y;\u4428FTcy;\u442Ccute;\u415A\u0280;aeiy\u1108\u1109\u110E\u1113\u1117\u6ABCron;\u4160dil;\u415Erc;\u415C;\u4421r;\uC000\u{1D516}ort\u0200DLRU\u112A\u1134\u113E\u1149ownArrow\xBB\u041EeftArrow\xBB\u089AightArrow\xBB\u0FDDpArrow;\u6191gma;\u43A3allCircle;\u6218pf;\uC000\u{1D54A}\u0272\u116D\0\0\u1170t;\u621Aare\u0200;ISU\u117B\u117C\u1189\u11AF\u65A1ntersection;\u6293u\u0100bp\u118F\u119Eset\u0100;E\u1197\u1198\u628Fqual;\u6291erset\u0100;E\u11A8\u11A9\u6290qual;\u6292nion;\u6294cr;\uC000\u{1D4AE}ar;\u62C6\u0200bcmp\u11C8\u11DB\u1209\u120B\u0100;s\u11CD\u11CE\u62D0et\u0100;E\u11CD\u11D5qual;\u6286\u0100ch\u11E0\u1205eeds\u0200;EST\u11ED\u11EE\u11F4\u11FF\u627Bqual;\u6AB0lantEqual;\u627Dilde;\u627FTh\xE1\u0F8C;\u6211\u0180;es\u1212\u1213\u1223\u62D1rset\u0100;E\u121C\u121D\u6283qual;\u6287et\xBB\u1213\u0580HRSacfhiors\u123E\u1244\u1249\u1255\u125E\u1271\u1276\u129F\u12C2\u12C8\u12D1ORN\u803B\xDE\u40DEADE;\u6122\u0100Hc\u124E\u1252cy;\u440By;\u4426\u0100bu\u125A\u125C;\u4009;\u43A4\u0180aey\u1265\u126A\u126Fron;\u4164dil;\u4162;\u4422r;\uC000\u{1D517}\u0100ei\u127B\u1289\u01F2\u1280\0\u1287efore;\u6234a;\u4398\u0100cn\u128E\u1298kSpace;\uC000\u205F\u200ASpace;\u6009lde\u0200;EFT\u12AB\u12AC\u12B2\u12BC\u623Cqual;\u6243ullEqual;\u6245ilde;\u6248pf;\uC000\u{1D54B}ipleDot;\u60DB\u0100ct\u12D6\u12DBr;\uC000\u{1D4AF}rok;\u4166\u0AE1\u12F7\u130E\u131A\u1326\0\u132C\u1331\0\0\0\0\0\u1338\u133D\u1377\u1385\0\u13FF\u1404\u140A\u1410\u0100cr\u12FB\u1301ute\u803B\xDA\u40DAr\u0100;o\u1307\u1308\u619Fcir;\u6949r\u01E3\u1313\0\u1316y;\u440Eve;\u416C\u0100iy\u131E\u1323rc\u803B\xDB\u40DB;\u4423blac;\u4170r;\uC000\u{1D518}rave\u803B\xD9\u40D9acr;\u416A\u0100di\u1341\u1369er\u0100BP\u1348\u135D\u0100ar\u134D\u1350r;\u405Fac\u0100ek\u1357\u1359;\u63DFet;\u63B5arenthesis;\u63DDon\u0100;P\u1370\u1371\u62C3lus;\u628E\u0100gp\u137B\u137Fon;\u4172f;\uC000\u{1D54C}\u0400ADETadps\u1395\u13AE\u13B8\u13C4\u03E8\u13D2\u13D7\u13F3rrow\u0180;BD\u1150\u13A0\u13A4ar;\u6912ownArrow;\u61C5ownArrow;\u6195quilibrium;\u696Eee\u0100;A\u13CB\u13CC\u62A5rrow;\u61A5own\xE1\u03F3er\u0100LR\u13DE\u13E8eftArrow;\u6196ightArrow;\u6197i\u0100;l\u13F9\u13FA\u43D2on;\u43A5ing;\u416Ecr;\uC000\u{1D4B0}ilde;\u4168ml\u803B\xDC\u40DC\u0480Dbcdefosv\u1427\u142C\u1430\u1433\u143E\u1485\u148A\u1490\u1496ash;\u62ABar;\u6AEBy;\u4412ash\u0100;l\u143B\u143C\u62A9;\u6AE6\u0100er\u1443\u1445;\u62C1\u0180bty\u144C\u1450\u147Aar;\u6016\u0100;i\u144F\u1455cal\u0200BLST\u1461\u1465\u146A\u1474ar;\u6223ine;\u407Ceparator;\u6758ilde;\u6240ThinSpace;\u600Ar;\uC000\u{1D519}pf;\uC000\u{1D54D}cr;\uC000\u{1D4B1}dash;\u62AA\u0280cefos\u14A7\u14AC\u14B1\u14B6\u14BCirc;\u4174dge;\u62C0r;\uC000\u{1D51A}pf;\uC000\u{1D54E}cr;\uC000\u{1D4B2}\u0200fios\u14CB\u14D0\u14D2\u14D8r;\uC000\u{1D51B};\u439Epf;\uC000\u{1D54F}cr;\uC000\u{1D4B3}\u0480AIUacfosu\u14F1\u14F5\u14F9\u14FD\u1504\u150F\u1514\u151A\u1520cy;\u442Fcy;\u4407cy;\u442Ecute\u803B\xDD\u40DD\u0100iy\u1509\u150Drc;\u4176;\u442Br;\uC000\u{1D51C}pf;\uC000\u{1D550}cr;\uC000\u{1D4B4}ml;\u4178\u0400Hacdefos\u1535\u1539\u153F\u154B\u154F\u155D\u1560\u1564cy;\u4416cute;\u4179\u0100ay\u1544\u1549ron;\u417D;\u4417ot;\u417B\u01F2\u1554\0\u155BoWidt\xE8\u0AD9a;\u4396r;\u6128pf;\u6124cr;\uC000\u{1D4B5}\u0BE1\u1583\u158A\u1590\0\u15B0\u15B6\u15BF\0\0\0\0\u15C6\u15DB\u15EB\u165F\u166D\0\u1695\u169B\u16B2\u16B9\0\u16BEcute\u803B\xE1\u40E1reve;\u4103\u0300;Ediuy\u159C\u159D\u15A1\u15A3\u15A8\u15AD\u623E;\uC000\u223E\u0333;\u623Frc\u803B\xE2\u40E2te\u80BB\xB4\u0306;\u4430lig\u803B\xE6\u40E6\u0100;r\xB2\u15BA;\uC000\u{1D51E}rave\u803B\xE0\u40E0\u0100ep\u15CA\u15D6\u0100fp\u15CF\u15D4sym;\u6135\xE8\u15D3ha;\u43B1\u0100ap\u15DFc\u0100cl\u15E4\u15E7r;\u4101g;\u6A3F\u0264\u15F0\0\0\u160A\u0280;adsv\u15FA\u15FB\u15FF\u1601\u1607\u6227nd;\u6A55;\u6A5Clope;\u6A58;\u6A5A\u0380;elmrsz\u1618\u1619\u161B\u161E\u163F\u164F\u1659\u6220;\u69A4e\xBB\u1619sd\u0100;a\u1625\u1626\u6221\u0461\u1630\u1632\u1634\u1636\u1638\u163A\u163C\u163E;\u69A8;\u69A9;\u69AA;\u69AB;\u69AC;\u69AD;\u69AE;\u69AFt\u0100;v\u1645\u1646\u621Fb\u0100;d\u164C\u164D\u62BE;\u699D\u0100pt\u1654\u1657h;\u6222\xBB\xB9arr;\u637C\u0100gp\u1663\u1667on;\u4105f;\uC000\u{1D552}\u0380;Eaeiop\u12C1\u167B\u167D\u1682\u1684\u1687\u168A;\u6A70cir;\u6A6F;\u624Ad;\u624Bs;\u4027rox\u0100;e\u12C1\u1692\xF1\u1683ing\u803B\xE5\u40E5\u0180cty\u16A1\u16A6\u16A8r;\uC000\u{1D4B6};\u402Amp\u0100;e\u12C1\u16AF\xF1\u0288ilde\u803B\xE3\u40E3ml\u803B\xE4\u40E4\u0100ci\u16C2\u16C8onin\xF4\u0272nt;\u6A11\u0800Nabcdefiklnoprsu\u16ED\u16F1\u1730\u173C\u1743\u1748\u1778\u177D\u17E0\u17E6\u1839\u1850\u170D\u193D\u1948\u1970ot;\u6AED\u0100cr\u16F6\u171Ek\u0200ceps\u1700\u1705\u170D\u1713ong;\u624Cpsilon;\u43F6rime;\u6035im\u0100;e\u171A\u171B\u623Dq;\u62CD\u0176\u1722\u1726ee;\u62BDed\u0100;g\u172C\u172D\u6305e\xBB\u172Drk\u0100;t\u135C\u1737brk;\u63B6\u0100oy\u1701\u1741;\u4431quo;\u601E\u0280cmprt\u1753\u175B\u1761\u1764\u1768aus\u0100;e\u010A\u0109ptyv;\u69B0s\xE9\u170Cno\xF5\u0113\u0180ahw\u176F\u1771\u1773;\u43B2;\u6136een;\u626Cr;\uC000\u{1D51F}g\u0380costuvw\u178D\u179D\u17B3\u17C1\u17D5\u17DB\u17DE\u0180aiu\u1794\u1796\u179A\xF0\u0760rc;\u65EFp\xBB\u1371\u0180dpt\u17A4\u17A8\u17ADot;\u6A00lus;\u6A01imes;\u6A02\u0271\u17B9\0\0\u17BEcup;\u6A06ar;\u6605riangle\u0100du\u17CD\u17D2own;\u65BDp;\u65B3plus;\u6A04e\xE5\u1444\xE5\u14ADarow;\u690D\u0180ako\u17ED\u1826\u1835\u0100cn\u17F2\u1823k\u0180lst\u17FA\u05AB\u1802ozenge;\u69EBriangle\u0200;dlr\u1812\u1813\u1818\u181D\u65B4own;\u65BEeft;\u65C2ight;\u65B8k;\u6423\u01B1\u182B\0\u1833\u01B2\u182F\0\u1831;\u6592;\u65914;\u6593ck;\u6588\u0100eo\u183E\u184D\u0100;q\u1843\u1846\uC000=\u20E5uiv;\uC000\u2261\u20E5t;\u6310\u0200ptwx\u1859\u185E\u1867\u186Cf;\uC000\u{1D553}\u0100;t\u13CB\u1863om\xBB\u13CCtie;\u62C8\u0600DHUVbdhmptuv\u1885\u1896\u18AA\u18BB\u18D7\u18DB\u18EC\u18FF\u1905\u190A\u1910\u1921\u0200LRlr\u188E\u1890\u1892\u1894;\u6557;\u6554;\u6556;\u6553\u0280;DUdu\u18A1\u18A2\u18A4\u18A6\u18A8\u6550;\u6566;\u6569;\u6564;\u6567\u0200LRlr\u18B3\u18B5\u18B7\u18B9;\u655D;\u655A;\u655C;\u6559\u0380;HLRhlr\u18CA\u18CB\u18CD\u18CF\u18D1\u18D3\u18D5\u6551;\u656C;\u6563;\u6560;\u656B;\u6562;\u655Fox;\u69C9\u0200LRlr\u18E4\u18E6\u18E8\u18EA;\u6555;\u6552;\u6510;\u650C\u0280;DUdu\u06BD\u18F7\u18F9\u18FB\u18FD;\u6565;\u6568;\u652C;\u6534inus;\u629Flus;\u629Eimes;\u62A0\u0200LRlr\u1919\u191B\u191D\u191F;\u655B;\u6558;\u6518;\u6514\u0380;HLRhlr\u1930\u1931\u1933\u1935\u1937\u1939\u193B\u6502;\u656A;\u6561;\u655E;\u653C;\u6524;\u651C\u0100ev\u0123\u1942bar\u803B\xA6\u40A6\u0200ceio\u1951\u1956\u195A\u1960r;\uC000\u{1D4B7}mi;\u604Fm\u0100;e\u171A\u171Cl\u0180;bh\u1968\u1969\u196B\u405C;\u69C5sub;\u67C8\u016C\u1974\u197El\u0100;e\u1979\u197A\u6022t\xBB\u197Ap\u0180;Ee\u012F\u1985\u1987;\u6AAE\u0100;q\u06DC\u06DB\u0CE1\u19A7\0\u19E8\u1A11\u1A15\u1A32\0\u1A37\u1A50\0\0\u1AB4\0\0\u1AC1\0\0\u1B21\u1B2E\u1B4D\u1B52\0\u1BFD\0\u1C0C\u0180cpr\u19AD\u19B2\u19DDute;\u4107\u0300;abcds\u19BF\u19C0\u19C4\u19CA\u19D5\u19D9\u6229nd;\u6A44rcup;\u6A49\u0100au\u19CF\u19D2p;\u6A4Bp;\u6A47ot;\u6A40;\uC000\u2229\uFE00\u0100eo\u19E2\u19E5t;\u6041\xEE\u0693\u0200aeiu\u19F0\u19FB\u1A01\u1A05\u01F0\u19F5\0\u19F8s;\u6A4Don;\u410Ddil\u803B\xE7\u40E7rc;\u4109ps\u0100;s\u1A0C\u1A0D\u6A4Cm;\u6A50ot;\u410B\u0180dmn\u1A1B\u1A20\u1A26il\u80BB\xB8\u01ADptyv;\u69B2t\u8100\xA2;e\u1A2D\u1A2E\u40A2r\xE4\u01B2r;\uC000\u{1D520}\u0180cei\u1A3D\u1A40\u1A4Dy;\u4447ck\u0100;m\u1A47\u1A48\u6713ark\xBB\u1A48;\u43C7r\u0380;Ecefms\u1A5F\u1A60\u1A62\u1A6B\u1AA4\u1AAA\u1AAE\u65CB;\u69C3\u0180;el\u1A69\u1A6A\u1A6D\u42C6q;\u6257e\u0261\u1A74\0\0\u1A88rrow\u0100lr\u1A7C\u1A81eft;\u61BAight;\u61BB\u0280RSacd\u1A92\u1A94\u1A96\u1A9A\u1A9F\xBB\u0F47;\u64C8st;\u629Birc;\u629Aash;\u629Dnint;\u6A10id;\u6AEFcir;\u69C2ubs\u0100;u\u1ABB\u1ABC\u6663it\xBB\u1ABC\u02EC\u1AC7\u1AD4\u1AFA\0\u1B0Aon\u0100;e\u1ACD\u1ACE\u403A\u0100;q\xC7\xC6\u026D\u1AD9\0\0\u1AE2a\u0100;t\u1ADE\u1ADF\u402C;\u4040\u0180;fl\u1AE8\u1AE9\u1AEB\u6201\xEE\u1160e\u0100mx\u1AF1\u1AF6ent\xBB\u1AE9e\xF3\u024D\u01E7\u1AFE\0\u1B07\u0100;d\u12BB\u1B02ot;\u6A6Dn\xF4\u0246\u0180fry\u1B10\u1B14\u1B17;\uC000\u{1D554}o\xE4\u0254\u8100\xA9;s\u0155\u1B1Dr;\u6117\u0100ao\u1B25\u1B29rr;\u61B5ss;\u6717\u0100cu\u1B32\u1B37r;\uC000\u{1D4B8}\u0100bp\u1B3C\u1B44\u0100;e\u1B41\u1B42\u6ACF;\u6AD1\u0100;e\u1B49\u1B4A\u6AD0;\u6AD2dot;\u62EF\u0380delprvw\u1B60\u1B6C\u1B77\u1B82\u1BAC\u1BD4\u1BF9arr\u0100lr\u1B68\u1B6A;\u6938;\u6935\u0270\u1B72\0\0\u1B75r;\u62DEc;\u62DFarr\u0100;p\u1B7F\u1B80\u61B6;\u693D\u0300;bcdos\u1B8F\u1B90\u1B96\u1BA1\u1BA5\u1BA8\u622Arcap;\u6A48\u0100au\u1B9B\u1B9Ep;\u6A46p;\u6A4Aot;\u628Dr;\u6A45;\uC000\u222A\uFE00\u0200alrv\u1BB5\u1BBF\u1BDE\u1BE3rr\u0100;m\u1BBC\u1BBD\u61B7;\u693Cy\u0180evw\u1BC7\u1BD4\u1BD8q\u0270\u1BCE\0\0\u1BD2re\xE3\u1B73u\xE3\u1B75ee;\u62CEedge;\u62CFen\u803B\xA4\u40A4earrow\u0100lr\u1BEE\u1BF3eft\xBB\u1B80ight\xBB\u1BBDe\xE4\u1BDD\u0100ci\u1C01\u1C07onin\xF4\u01F7nt;\u6231lcty;\u632D\u0980AHabcdefhijlorstuwz\u1C38\u1C3B\u1C3F\u1C5D\u1C69\u1C75\u1C8A\u1C9E\u1CAC\u1CB7\u1CFB\u1CFF\u1D0D\u1D7B\u1D91\u1DAB\u1DBB\u1DC6\u1DCDr\xF2\u0381ar;\u6965\u0200glrs\u1C48\u1C4D\u1C52\u1C54ger;\u6020eth;\u6138\xF2\u1133h\u0100;v\u1C5A\u1C5B\u6010\xBB\u090A\u016B\u1C61\u1C67arow;\u690Fa\xE3\u0315\u0100ay\u1C6E\u1C73ron;\u410F;\u4434\u0180;ao\u0332\u1C7C\u1C84\u0100gr\u02BF\u1C81r;\u61CAtseq;\u6A77\u0180glm\u1C91\u1C94\u1C98\u803B\xB0\u40B0ta;\u43B4ptyv;\u69B1\u0100ir\u1CA3\u1CA8sht;\u697F;\uC000\u{1D521}ar\u0100lr\u1CB3\u1CB5\xBB\u08DC\xBB\u101E\u0280aegsv\u1CC2\u0378\u1CD6\u1CDC\u1CE0m\u0180;os\u0326\u1CCA\u1CD4nd\u0100;s\u0326\u1CD1uit;\u6666amma;\u43DDin;\u62F2\u0180;io\u1CE7\u1CE8\u1CF8\u40F7de\u8100\xF7;o\u1CE7\u1CF0ntimes;\u62C7n\xF8\u1CF7cy;\u4452c\u026F\u1D06\0\0\u1D0Arn;\u631Eop;\u630D\u0280lptuw\u1D18\u1D1D\u1D22\u1D49\u1D55lar;\u4024f;\uC000\u{1D555}\u0280;emps\u030B\u1D2D\u1D37\u1D3D\u1D42q\u0100;d\u0352\u1D33ot;\u6251inus;\u6238lus;\u6214quare;\u62A1blebarwedg\xE5\xFAn\u0180adh\u112E\u1D5D\u1D67ownarrow\xF3\u1C83arpoon\u0100lr\u1D72\u1D76ef\xF4\u1CB4igh\xF4\u1CB6\u0162\u1D7F\u1D85karo\xF7\u0F42\u026F\u1D8A\0\0\u1D8Ern;\u631Fop;\u630C\u0180cot\u1D98\u1DA3\u1DA6\u0100ry\u1D9D\u1DA1;\uC000\u{1D4B9};\u4455l;\u69F6rok;\u4111\u0100dr\u1DB0\u1DB4ot;\u62F1i\u0100;f\u1DBA\u1816\u65BF\u0100ah\u1DC0\u1DC3r\xF2\u0429a\xF2\u0FA6angle;\u69A6\u0100ci\u1DD2\u1DD5y;\u445Fgrarr;\u67FF\u0900Dacdefglmnopqrstux\u1E01\u1E09\u1E19\u1E38\u0578\u1E3C\u1E49\u1E61\u1E7E\u1EA5\u1EAF\u1EBD\u1EE1\u1F2A\u1F37\u1F44\u1F4E\u1F5A\u0100Do\u1E06\u1D34o\xF4\u1C89\u0100cs\u1E0E\u1E14ute\u803B\xE9\u40E9ter;\u6A6E\u0200aioy\u1E22\u1E27\u1E31\u1E36ron;\u411Br\u0100;c\u1E2D\u1E2E\u6256\u803B\xEA\u40EAlon;\u6255;\u444Dot;\u4117\u0100Dr\u1E41\u1E45ot;\u6252;\uC000\u{1D522}\u0180;rs\u1E50\u1E51\u1E57\u6A9Aave\u803B\xE8\u40E8\u0100;d\u1E5C\u1E5D\u6A96ot;\u6A98\u0200;ils\u1E6A\u1E6B\u1E72\u1E74\u6A99nters;\u63E7;\u6113\u0100;d\u1E79\u1E7A\u6A95ot;\u6A97\u0180aps\u1E85\u1E89\u1E97cr;\u4113ty\u0180;sv\u1E92\u1E93\u1E95\u6205et\xBB\u1E93p\u01001;\u1E9D\u1EA4\u0133\u1EA1\u1EA3;\u6004;\u6005\u6003\u0100gs\u1EAA\u1EAC;\u414Bp;\u6002\u0100gp\u1EB4\u1EB8on;\u4119f;\uC000\u{1D556}\u0180als\u1EC4\u1ECE\u1ED2r\u0100;s\u1ECA\u1ECB\u62D5l;\u69E3us;\u6A71i\u0180;lv\u1EDA\u1EDB\u1EDF\u43B5on\xBB\u1EDB;\u43F5\u0200csuv\u1EEA\u1EF3\u1F0B\u1F23\u0100io\u1EEF\u1E31rc\xBB\u1E2E\u0269\u1EF9\0\0\u1EFB\xED\u0548ant\u0100gl\u1F02\u1F06tr\xBB\u1E5Dess\xBB\u1E7A\u0180aei\u1F12\u1F16\u1F1Als;\u403Dst;\u625Fv\u0100;D\u0235\u1F20D;\u6A78parsl;\u69E5\u0100Da\u1F2F\u1F33ot;\u6253rr;\u6971\u0180cdi\u1F3E\u1F41\u1EF8r;\u612Fo\xF4\u0352\u0100ah\u1F49\u1F4B;\u43B7\u803B\xF0\u40F0\u0100mr\u1F53\u1F57l\u803B\xEB\u40EBo;\u60AC\u0180cip\u1F61\u1F64\u1F67l;\u4021s\xF4\u056E\u0100eo\u1F6C\u1F74ctatio\xEE\u0559nential\xE5\u0579\u09E1\u1F92\0\u1F9E\0\u1FA1\u1FA7\0\0\u1FC6\u1FCC\0\u1FD3\0\u1FE6\u1FEA\u2000\0\u2008\u205Allingdotse\xF1\u1E44y;\u4444male;\u6640\u0180ilr\u1FAD\u1FB3\u1FC1lig;\u8000\uFB03\u0269\u1FB9\0\0\u1FBDg;\u8000\uFB00ig;\u8000\uFB04;\uC000\u{1D523}lig;\u8000\uFB01lig;\uC000fj\u0180alt\u1FD9\u1FDC\u1FE1t;\u666Dig;\u8000\uFB02ns;\u65B1of;\u4192\u01F0\u1FEE\0\u1FF3f;\uC000\u{1D557}\u0100ak\u05BF\u1FF7\u0100;v\u1FFC\u1FFD\u62D4;\u6AD9artint;\u6A0D\u0100ao\u200C\u2055\u0100cs\u2011\u2052\u03B1\u201A\u2030\u2038\u2045\u2048\0\u2050\u03B2\u2022\u2025\u2027\u202A\u202C\0\u202E\u803B\xBD\u40BD;\u6153\u803B\xBC\u40BC;\u6155;\u6159;\u615B\u01B3\u2034\0\u2036;\u6154;\u6156\u02B4\u203E\u2041\0\0\u2043\u803B\xBE\u40BE;\u6157;\u615C5;\u6158\u01B6\u204C\0\u204E;\u615A;\u615D8;\u615El;\u6044wn;\u6322cr;\uC000\u{1D4BB}\u0880Eabcdefgijlnorstv\u2082\u2089\u209F\u20A5\u20B0\u20B4\u20F0\u20F5\u20FA\u20FF\u2103\u2112\u2138\u0317\u213E\u2152\u219E\u0100;l\u064D\u2087;\u6A8C\u0180cmp\u2090\u2095\u209Dute;\u41F5ma\u0100;d\u209C\u1CDA\u43B3;\u6A86reve;\u411F\u0100iy\u20AA\u20AErc;\u411D;\u4433ot;\u4121\u0200;lqs\u063E\u0642\u20BD\u20C9\u0180;qs\u063E\u064C\u20C4lan\xF4\u0665\u0200;cdl\u0665\u20D2\u20D5\u20E5c;\u6AA9ot\u0100;o\u20DC\u20DD\u6A80\u0100;l\u20E2\u20E3\u6A82;\u6A84\u0100;e\u20EA\u20ED\uC000\u22DB\uFE00s;\u6A94r;\uC000\u{1D524}\u0100;g\u0673\u061Bmel;\u6137cy;\u4453\u0200;Eaj\u065A\u210C\u210E\u2110;\u6A92;\u6AA5;\u6AA4\u0200Eaes\u211B\u211D\u2129\u2134;\u6269p\u0100;p\u2123\u2124\u6A8Arox\xBB\u2124\u0100;q\u212E\u212F\u6A88\u0100;q\u212E\u211Bim;\u62E7pf;\uC000\u{1D558}\u0100ci\u2143\u2146r;\u610Am\u0180;el\u066B\u214E\u2150;\u6A8E;\u6A90\u8300>;cdlqr\u05EE\u2160\u216A\u216E\u2173\u2179\u0100ci\u2165\u2167;\u6AA7r;\u6A7Aot;\u62D7Par;\u6995uest;\u6A7C\u0280adels\u2184\u216A\u2190\u0656\u219B\u01F0\u2189\0\u218Epro\xF8\u209Er;\u6978q\u0100lq\u063F\u2196les\xF3\u2088i\xED\u066B\u0100en\u21A3\u21ADrtneqq;\uC000\u2269\uFE00\xC5\u21AA\u0500Aabcefkosy\u21C4\u21C7\u21F1\u21F5\u21FA\u2218\u221D\u222F\u2268\u227Dr\xF2\u03A0\u0200ilmr\u21D0\u21D4\u21D7\u21DBrs\xF0\u1484f\xBB\u2024il\xF4\u06A9\u0100dr\u21E0\u21E4cy;\u444A\u0180;cw\u08F4\u21EB\u21EFir;\u6948;\u61ADar;\u610Firc;\u4125\u0180alr\u2201\u220E\u2213rts\u0100;u\u2209\u220A\u6665it\xBB\u220Alip;\u6026con;\u62B9r;\uC000\u{1D525}s\u0100ew\u2223\u2229arow;\u6925arow;\u6926\u0280amopr\u223A\u223E\u2243\u225E\u2263rr;\u61FFtht;\u623Bk\u0100lr\u2249\u2253eftarrow;\u61A9ightarrow;\u61AAf;\uC000\u{1D559}bar;\u6015\u0180clt\u226F\u2274\u2278r;\uC000\u{1D4BD}as\xE8\u21F4rok;\u4127\u0100bp\u2282\u2287ull;\u6043hen\xBB\u1C5B\u0AE1\u22A3\0\u22AA\0\u22B8\u22C5\u22CE\0\u22D5\u22F3\0\0\u22F8\u2322\u2367\u2362\u237F\0\u2386\u23AA\u23B4cute\u803B\xED\u40ED\u0180;iy\u0771\u22B0\u22B5rc\u803B\xEE\u40EE;\u4438\u0100cx\u22BC\u22BFy;\u4435cl\u803B\xA1\u40A1\u0100fr\u039F\u22C9;\uC000\u{1D526}rave\u803B\xEC\u40EC\u0200;ino\u073E\u22DD\u22E9\u22EE\u0100in\u22E2\u22E6nt;\u6A0Ct;\u622Dfin;\u69DCta;\u6129lig;\u4133\u0180aop\u22FE\u231A\u231D\u0180cgt\u2305\u2308\u2317r;\u412B\u0180elp\u071F\u230F\u2313in\xE5\u078Ear\xF4\u0720h;\u4131f;\u62B7ed;\u41B5\u0280;cfot\u04F4\u232C\u2331\u233D\u2341are;\u6105in\u0100;t\u2338\u2339\u621Eie;\u69DDdo\xF4\u2319\u0280;celp\u0757\u234C\u2350\u235B\u2361al;\u62BA\u0100gr\u2355\u2359er\xF3\u1563\xE3\u234Darhk;\u6A17rod;\u6A3C\u0200cgpt\u236F\u2372\u2376\u237By;\u4451on;\u412Ff;\uC000\u{1D55A}a;\u43B9uest\u803B\xBF\u40BF\u0100ci\u238A\u238Fr;\uC000\u{1D4BE}n\u0280;Edsv\u04F4\u239B\u239D\u23A1\u04F3;\u62F9ot;\u62F5\u0100;v\u23A6\u23A7\u62F4;\u62F3\u0100;i\u0777\u23AElde;\u4129\u01EB\u23B8\0\u23BCcy;\u4456l\u803B\xEF\u40EF\u0300cfmosu\u23CC\u23D7\u23DC\u23E1\u23E7\u23F5\u0100iy\u23D1\u23D5rc;\u4135;\u4439r;\uC000\u{1D527}ath;\u4237pf;\uC000\u{1D55B}\u01E3\u23EC\0\u23F1r;\uC000\u{1D4BF}rcy;\u4458kcy;\u4454\u0400acfghjos\u240B\u2416\u2422\u2427\u242D\u2431\u2435\u243Bppa\u0100;v\u2413\u2414\u43BA;\u43F0\u0100ey\u241B\u2420dil;\u4137;\u443Ar;\uC000\u{1D528}reen;\u4138cy;\u4445cy;\u445Cpf;\uC000\u{1D55C}cr;\uC000\u{1D4C0}\u0B80ABEHabcdefghjlmnoprstuv\u2470\u2481\u2486\u248D\u2491\u250E\u253D\u255A\u2580\u264E\u265E\u2665\u2679\u267D\u269A\u26B2\u26D8\u275D\u2768\u278B\u27C0\u2801\u2812\u0180art\u2477\u247A\u247Cr\xF2\u09C6\xF2\u0395ail;\u691Barr;\u690E\u0100;g\u0994\u248B;\u6A8Bar;\u6962\u0963\u24A5\0\u24AA\0\u24B1\0\0\0\0\0\u24B5\u24BA\0\u24C6\u24C8\u24CD\0\u24F9ute;\u413Amptyv;\u69B4ra\xEE\u084Cbda;\u43BBg\u0180;dl\u088E\u24C1\u24C3;\u6991\xE5\u088E;\u6A85uo\u803B\xAB\u40ABr\u0400;bfhlpst\u0899\u24DE\u24E6\u24E9\u24EB\u24EE\u24F1\u24F5\u0100;f\u089D\u24E3s;\u691Fs;\u691D\xEB\u2252p;\u61ABl;\u6939im;\u6973l;\u61A2\u0180;ae\u24FF\u2500\u2504\u6AABil;\u6919\u0100;s\u2509\u250A\u6AAD;\uC000\u2AAD\uFE00\u0180abr\u2515\u2519\u251Drr;\u690Crk;\u6772\u0100ak\u2522\u252Cc\u0100ek\u2528\u252A;\u407B;\u405B\u0100es\u2531\u2533;\u698Bl\u0100du\u2539\u253B;\u698F;\u698D\u0200aeuy\u2546\u254B\u2556\u2558ron;\u413E\u0100di\u2550\u2554il;\u413C\xEC\u08B0\xE2\u2529;\u443B\u0200cqrs\u2563\u2566\u256D\u257Da;\u6936uo\u0100;r\u0E19\u1746\u0100du\u2572\u2577har;\u6967shar;\u694Bh;\u61B2\u0280;fgqs\u258B\u258C\u0989\u25F3\u25FF\u6264t\u0280ahlrt\u2598\u25A4\u25B7\u25C2\u25E8rrow\u0100;t\u0899\u25A1a\xE9\u24F6arpoon\u0100du\u25AF\u25B4own\xBB\u045Ap\xBB\u0966eftarrows;\u61C7ight\u0180ahs\u25CD\u25D6\u25DErrow\u0100;s\u08F4\u08A7arpoon\xF3\u0F98quigarro\xF7\u21F0hreetimes;\u62CB\u0180;qs\u258B\u0993\u25FAlan\xF4\u09AC\u0280;cdgs\u09AC\u260A\u260D\u261D\u2628c;\u6AA8ot\u0100;o\u2614\u2615\u6A7F\u0100;r\u261A\u261B\u6A81;\u6A83\u0100;e\u2622\u2625\uC000\u22DA\uFE00s;\u6A93\u0280adegs\u2633\u2639\u263D\u2649\u264Bppro\xF8\u24C6ot;\u62D6q\u0100gq\u2643\u2645\xF4\u0989gt\xF2\u248C\xF4\u099Bi\xED\u09B2\u0180ilr\u2655\u08E1\u265Asht;\u697C;\uC000\u{1D529}\u0100;E\u099C\u2663;\u6A91\u0161\u2669\u2676r\u0100du\u25B2\u266E\u0100;l\u0965\u2673;\u696Alk;\u6584cy;\u4459\u0280;acht\u0A48\u2688\u268B\u2691\u2696r\xF2\u25C1orne\xF2\u1D08ard;\u696Bri;\u65FA\u0100io\u269F\u26A4dot;\u4140ust\u0100;a\u26AC\u26AD\u63B0che\xBB\u26AD\u0200Eaes\u26BB\u26BD\u26C9\u26D4;\u6268p\u0100;p\u26C3\u26C4\u6A89rox\xBB\u26C4\u0100;q\u26CE\u26CF\u6A87\u0100;q\u26CE\u26BBim;\u62E6\u0400abnoptwz\u26E9\u26F4\u26F7\u271A\u272F\u2741\u2747\u2750\u0100nr\u26EE\u26F1g;\u67ECr;\u61FDr\xEB\u08C1g\u0180lmr\u26FF\u270D\u2714eft\u0100ar\u09E6\u2707ight\xE1\u09F2apsto;\u67FCight\xE1\u09FDparrow\u0100lr\u2725\u2729ef\xF4\u24EDight;\u61AC\u0180afl\u2736\u2739\u273Dr;\u6985;\uC000\u{1D55D}us;\u6A2Dimes;\u6A34\u0161\u274B\u274Fst;\u6217\xE1\u134E\u0180;ef\u2757\u2758\u1800\u65CAnge\xBB\u2758ar\u0100;l\u2764\u2765\u4028t;\u6993\u0280achmt\u2773\u2776\u277C\u2785\u2787r\xF2\u08A8orne\xF2\u1D8Car\u0100;d\u0F98\u2783;\u696D;\u600Eri;\u62BF\u0300achiqt\u2798\u279D\u0A40\u27A2\u27AE\u27BBquo;\u6039r;\uC000\u{1D4C1}m\u0180;eg\u09B2\u27AA\u27AC;\u6A8D;\u6A8F\u0100bu\u252A\u27B3o\u0100;r\u0E1F\u27B9;\u601Arok;\u4142\u8400<;cdhilqr\u082B\u27D2\u2639\u27DC\u27E0\u27E5\u27EA\u27F0\u0100ci\u27D7\u27D9;\u6AA6r;\u6A79re\xE5\u25F2mes;\u62C9arr;\u6976uest;\u6A7B\u0100Pi\u27F5\u27F9ar;\u6996\u0180;ef\u2800\u092D\u181B\u65C3r\u0100du\u2807\u280Dshar;\u694Ahar;\u6966\u0100en\u2817\u2821rtneqq;\uC000\u2268\uFE00\xC5\u281E\u0700Dacdefhilnopsu\u2840\u2845\u2882\u288E\u2893\u28A0\u28A5\u28A8\u28DA\u28E2\u28E4\u0A83\u28F3\u2902Dot;\u623A\u0200clpr\u284E\u2852\u2863\u287Dr\u803B\xAF\u40AF\u0100et\u2857\u2859;\u6642\u0100;e\u285E\u285F\u6720se\xBB\u285F\u0100;s\u103B\u2868to\u0200;dlu\u103B\u2873\u2877\u287Bow\xEE\u048Cef\xF4\u090F\xF0\u13D1ker;\u65AE\u0100oy\u2887\u288Cmma;\u6A29;\u443Cash;\u6014asuredangle\xBB\u1626r;\uC000\u{1D52A}o;\u6127\u0180cdn\u28AF\u28B4\u28C9ro\u803B\xB5\u40B5\u0200;acd\u1464\u28BD\u28C0\u28C4s\xF4\u16A7ir;\u6AF0ot\u80BB\xB7\u01B5us\u0180;bd\u28D2\u1903\u28D3\u6212\u0100;u\u1D3C\u28D8;\u6A2A\u0163\u28DE\u28E1p;\u6ADB\xF2\u2212\xF0\u0A81\u0100dp\u28E9\u28EEels;\u62A7f;\uC000\u{1D55E}\u0100ct\u28F8\u28FDr;\uC000\u{1D4C2}pos\xBB\u159D\u0180;lm\u2909\u290A\u290D\u43BCtimap;\u62B8\u0C00GLRVabcdefghijlmoprstuvw\u2942\u2953\u297E\u2989\u2998\u29DA\u29E9\u2A15\u2A1A\u2A58\u2A5D\u2A83\u2A95\u2AA4\u2AA8\u2B04\u2B07\u2B44\u2B7F\u2BAE\u2C34\u2C67\u2C7C\u2CE9\u0100gt\u2947\u294B;\uC000\u22D9\u0338\u0100;v\u2950\u0BCF\uC000\u226B\u20D2\u0180elt\u295A\u2972\u2976ft\u0100ar\u2961\u2967rrow;\u61CDightarrow;\u61CE;\uC000\u22D8\u0338\u0100;v\u297B\u0C47\uC000\u226A\u20D2ightarrow;\u61CF\u0100Dd\u298E\u2993ash;\u62AFash;\u62AE\u0280bcnpt\u29A3\u29A7\u29AC\u29B1\u29CCla\xBB\u02DEute;\u4144g;\uC000\u2220\u20D2\u0280;Eiop\u0D84\u29BC\u29C0\u29C5\u29C8;\uC000\u2A70\u0338d;\uC000\u224B\u0338s;\u4149ro\xF8\u0D84ur\u0100;a\u29D3\u29D4\u666El\u0100;s\u29D3\u0B38\u01F3\u29DF\0\u29E3p\u80BB\xA0\u0B37mp\u0100;e\u0BF9\u0C00\u0280aeouy\u29F4\u29FE\u2A03\u2A10\u2A13\u01F0\u29F9\0\u29FB;\u6A43on;\u4148dil;\u4146ng\u0100;d\u0D7E\u2A0Aot;\uC000\u2A6D\u0338p;\u6A42;\u443Dash;\u6013\u0380;Aadqsx\u0B92\u2A29\u2A2D\u2A3B\u2A41\u2A45\u2A50rr;\u61D7r\u0100hr\u2A33\u2A36k;\u6924\u0100;o\u13F2\u13F0ot;\uC000\u2250\u0338ui\xF6\u0B63\u0100ei\u2A4A\u2A4Ear;\u6928\xED\u0B98ist\u0100;s\u0BA0\u0B9Fr;\uC000\u{1D52B}\u0200Eest\u0BC5\u2A66\u2A79\u2A7C\u0180;qs\u0BBC\u2A6D\u0BE1\u0180;qs\u0BBC\u0BC5\u2A74lan\xF4\u0BE2i\xED\u0BEA\u0100;r\u0BB6\u2A81\xBB\u0BB7\u0180Aap\u2A8A\u2A8D\u2A91r\xF2\u2971rr;\u61AEar;\u6AF2\u0180;sv\u0F8D\u2A9C\u0F8C\u0100;d\u2AA1\u2AA2\u62FC;\u62FAcy;\u445A\u0380AEadest\u2AB7\u2ABA\u2ABE\u2AC2\u2AC5\u2AF6\u2AF9r\xF2\u2966;\uC000\u2266\u0338rr;\u619Ar;\u6025\u0200;fqs\u0C3B\u2ACE\u2AE3\u2AEFt\u0100ar\u2AD4\u2AD9rro\xF7\u2AC1ightarro\xF7\u2A90\u0180;qs\u0C3B\u2ABA\u2AEAlan\xF4\u0C55\u0100;s\u0C55\u2AF4\xBB\u0C36i\xED\u0C5D\u0100;r\u0C35\u2AFEi\u0100;e\u0C1A\u0C25i\xE4\u0D90\u0100pt\u2B0C\u2B11f;\uC000\u{1D55F}\u8180\xAC;in\u2B19\u2B1A\u2B36\u40ACn\u0200;Edv\u0B89\u2B24\u2B28\u2B2E;\uC000\u22F9\u0338ot;\uC000\u22F5\u0338\u01E1\u0B89\u2B33\u2B35;\u62F7;\u62F6i\u0100;v\u0CB8\u2B3C\u01E1\u0CB8\u2B41\u2B43;\u62FE;\u62FD\u0180aor\u2B4B\u2B63\u2B69r\u0200;ast\u0B7B\u2B55\u2B5A\u2B5Flle\xEC\u0B7Bl;\uC000\u2AFD\u20E5;\uC000\u2202\u0338lint;\u6A14\u0180;ce\u0C92\u2B70\u2B73u\xE5\u0CA5\u0100;c\u0C98\u2B78\u0100;e\u0C92\u2B7D\xF1\u0C98\u0200Aait\u2B88\u2B8B\u2B9D\u2BA7r\xF2\u2988rr\u0180;cw\u2B94\u2B95\u2B99\u619B;\uC000\u2933\u0338;\uC000\u219D\u0338ghtarrow\xBB\u2B95ri\u0100;e\u0CCB\u0CD6\u0380chimpqu\u2BBD\u2BCD\u2BD9\u2B04\u0B78\u2BE4\u2BEF\u0200;cer\u0D32\u2BC6\u0D37\u2BC9u\xE5\u0D45;\uC000\u{1D4C3}ort\u026D\u2B05\0\0\u2BD6ar\xE1\u2B56m\u0100;e\u0D6E\u2BDF\u0100;q\u0D74\u0D73su\u0100bp\u2BEB\u2BED\xE5\u0CF8\xE5\u0D0B\u0180bcp\u2BF6\u2C11\u2C19\u0200;Ees\u2BFF\u2C00\u0D22\u2C04\u6284;\uC000\u2AC5\u0338et\u0100;e\u0D1B\u2C0Bq\u0100;q\u0D23\u2C00c\u0100;e\u0D32\u2C17\xF1\u0D38\u0200;Ees\u2C22\u2C23\u0D5F\u2C27\u6285;\uC000\u2AC6\u0338et\u0100;e\u0D58\u2C2Eq\u0100;q\u0D60\u2C23\u0200gilr\u2C3D\u2C3F\u2C45\u2C47\xEC\u0BD7lde\u803B\xF1\u40F1\xE7\u0C43iangle\u0100lr\u2C52\u2C5Ceft\u0100;e\u0C1A\u2C5A\xF1\u0C26ight\u0100;e\u0CCB\u2C65\xF1\u0CD7\u0100;m\u2C6C\u2C6D\u43BD\u0180;es\u2C74\u2C75\u2C79\u4023ro;\u6116p;\u6007\u0480DHadgilrs\u2C8F\u2C94\u2C99\u2C9E\u2CA3\u2CB0\u2CB6\u2CD3\u2CE3ash;\u62ADarr;\u6904p;\uC000\u224D\u20D2ash;\u62AC\u0100et\u2CA8\u2CAC;\uC000\u2265\u20D2;\uC000>\u20D2nfin;\u69DE\u0180Aet\u2CBD\u2CC1\u2CC5rr;\u6902;\uC000\u2264\u20D2\u0100;r\u2CCA\u2CCD\uC000<\u20D2ie;\uC000\u22B4\u20D2\u0100At\u2CD8\u2CDCrr;\u6903rie;\uC000\u22B5\u20D2im;\uC000\u223C\u20D2\u0180Aan\u2CF0\u2CF4\u2D02rr;\u61D6r\u0100hr\u2CFA\u2CFDk;\u6923\u0100;o\u13E7\u13E5ear;\u6927\u1253\u1A95\0\0\0\0\0\0\0\0\0\0\0\0\0\u2D2D\0\u2D38\u2D48\u2D60\u2D65\u2D72\u2D84\u1B07\0\0\u2D8D\u2DAB\0\u2DC8\u2DCE\0\u2DDC\u2E19\u2E2B\u2E3E\u2E43\u0100cs\u2D31\u1A97ute\u803B\xF3\u40F3\u0100iy\u2D3C\u2D45r\u0100;c\u1A9E\u2D42\u803B\xF4\u40F4;\u443E\u0280abios\u1AA0\u2D52\u2D57\u01C8\u2D5Alac;\u4151v;\u6A38old;\u69BClig;\u4153\u0100cr\u2D69\u2D6Dir;\u69BF;\uC000\u{1D52C}\u036F\u2D79\0\0\u2D7C\0\u2D82n;\u42DBave\u803B\xF2\u40F2;\u69C1\u0100bm\u2D88\u0DF4ar;\u69B5\u0200acit\u2D95\u2D98\u2DA5\u2DA8r\xF2\u1A80\u0100ir\u2D9D\u2DA0r;\u69BEoss;\u69BBn\xE5\u0E52;\u69C0\u0180aei\u2DB1\u2DB5\u2DB9cr;\u414Dga;\u43C9\u0180cdn\u2DC0\u2DC5\u01CDron;\u43BF;\u69B6pf;\uC000\u{1D560}\u0180ael\u2DD4\u2DD7\u01D2r;\u69B7rp;\u69B9\u0380;adiosv\u2DEA\u2DEB\u2DEE\u2E08\u2E0D\u2E10\u2E16\u6228r\xF2\u1A86\u0200;efm\u2DF7\u2DF8\u2E02\u2E05\u6A5Dr\u0100;o\u2DFE\u2DFF\u6134f\xBB\u2DFF\u803B\xAA\u40AA\u803B\xBA\u40BAgof;\u62B6r;\u6A56lope;\u6A57;\u6A5B\u0180clo\u2E1F\u2E21\u2E27\xF2\u2E01ash\u803B\xF8\u40F8l;\u6298i\u016C\u2E2F\u2E34de\u803B\xF5\u40F5es\u0100;a\u01DB\u2E3As;\u6A36ml\u803B\xF6\u40F6bar;\u633D\u0AE1\u2E5E\0\u2E7D\0\u2E80\u2E9D\0\u2EA2\u2EB9\0\0\u2ECB\u0E9C\0\u2F13\0\0\u2F2B\u2FBC\0\u2FC8r\u0200;ast\u0403\u2E67\u2E72\u0E85\u8100\xB6;l\u2E6D\u2E6E\u40B6le\xEC\u0403\u0269\u2E78\0\0\u2E7Bm;\u6AF3;\u6AFDy;\u443Fr\u0280cimpt\u2E8B\u2E8F\u2E93\u1865\u2E97nt;\u4025od;\u402Eil;\u6030enk;\u6031r;\uC000\u{1D52D}\u0180imo\u2EA8\u2EB0\u2EB4\u0100;v\u2EAD\u2EAE\u43C6;\u43D5ma\xF4\u0A76ne;\u660E\u0180;tv\u2EBF\u2EC0\u2EC8\u43C0chfork\xBB\u1FFD;\u43D6\u0100au\u2ECF\u2EDFn\u0100ck\u2ED5\u2EDDk\u0100;h\u21F4\u2EDB;\u610E\xF6\u21F4s\u0480;abcdemst\u2EF3\u2EF4\u1908\u2EF9\u2EFD\u2F04\u2F06\u2F0A\u2F0E\u402Bcir;\u6A23ir;\u6A22\u0100ou\u1D40\u2F02;\u6A25;\u6A72n\u80BB\xB1\u0E9Dim;\u6A26wo;\u6A27\u0180ipu\u2F19\u2F20\u2F25ntint;\u6A15f;\uC000\u{1D561}nd\u803B\xA3\u40A3\u0500;Eaceinosu\u0EC8\u2F3F\u2F41\u2F44\u2F47\u2F81\u2F89\u2F92\u2F7E\u2FB6;\u6AB3p;\u6AB7u\xE5\u0ED9\u0100;c\u0ECE\u2F4C\u0300;acens\u0EC8\u2F59\u2F5F\u2F66\u2F68\u2F7Eppro\xF8\u2F43urlye\xF1\u0ED9\xF1\u0ECE\u0180aes\u2F6F\u2F76\u2F7Approx;\u6AB9qq;\u6AB5im;\u62E8i\xED\u0EDFme\u0100;s\u2F88\u0EAE\u6032\u0180Eas\u2F78\u2F90\u2F7A\xF0\u2F75\u0180dfp\u0EEC\u2F99\u2FAF\u0180als\u2FA0\u2FA5\u2FAAlar;\u632Eine;\u6312urf;\u6313\u0100;t\u0EFB\u2FB4\xEF\u0EFBrel;\u62B0\u0100ci\u2FC0\u2FC5r;\uC000\u{1D4C5};\u43C8ncsp;\u6008\u0300fiopsu\u2FDA\u22E2\u2FDF\u2FE5\u2FEB\u2FF1r;\uC000\u{1D52E}pf;\uC000\u{1D562}rime;\u6057cr;\uC000\u{1D4C6}\u0180aeo\u2FF8\u3009\u3013t\u0100ei\u2FFE\u3005rnion\xF3\u06B0nt;\u6A16st\u0100;e\u3010\u3011\u403F\xF1\u1F19\xF4\u0F14\u0A80ABHabcdefhilmnoprstux\u3040\u3051\u3055\u3059\u30E0\u310E\u312B\u3147\u3162\u3172\u318E\u3206\u3215\u3224\u3229\u3258\u326E\u3272\u3290\u32B0\u32B7\u0180art\u3047\u304A\u304Cr\xF2\u10B3\xF2\u03DDail;\u691Car\xF2\u1C65ar;\u6964\u0380cdenqrt\u3068\u3075\u3078\u307F\u308F\u3094\u30CC\u0100eu\u306D\u3071;\uC000\u223D\u0331te;\u4155i\xE3\u116Emptyv;\u69B3g\u0200;del\u0FD1\u3089\u308B\u308D;\u6992;\u69A5\xE5\u0FD1uo\u803B\xBB\u40BBr\u0580;abcfhlpstw\u0FDC\u30AC\u30AF\u30B7\u30B9\u30BC\u30BE\u30C0\u30C3\u30C7\u30CAp;\u6975\u0100;f\u0FE0\u30B4s;\u6920;\u6933s;\u691E\xEB\u225D\xF0\u272El;\u6945im;\u6974l;\u61A3;\u619D\u0100ai\u30D1\u30D5il;\u691Ao\u0100;n\u30DB\u30DC\u6236al\xF3\u0F1E\u0180abr\u30E7\u30EA\u30EEr\xF2\u17E5rk;\u6773\u0100ak\u30F3\u30FDc\u0100ek\u30F9\u30FB;\u407D;\u405D\u0100es\u3102\u3104;\u698Cl\u0100du\u310A\u310C;\u698E;\u6990\u0200aeuy\u3117\u311C\u3127\u3129ron;\u4159\u0100di\u3121\u3125il;\u4157\xEC\u0FF2\xE2\u30FA;\u4440\u0200clqs\u3134\u3137\u313D\u3144a;\u6937dhar;\u6969uo\u0100;r\u020E\u020Dh;\u61B3\u0180acg\u314E\u315F\u0F44l\u0200;ips\u0F78\u3158\u315B\u109Cn\xE5\u10BBar\xF4\u0FA9t;\u65AD\u0180ilr\u3169\u1023\u316Esht;\u697D;\uC000\u{1D52F}\u0100ao\u3177\u3186r\u0100du\u317D\u317F\xBB\u047B\u0100;l\u1091\u3184;\u696C\u0100;v\u318B\u318C\u43C1;\u43F1\u0180gns\u3195\u31F9\u31FCht\u0300ahlrst\u31A4\u31B0\u31C2\u31D8\u31E4\u31EErrow\u0100;t\u0FDC\u31ADa\xE9\u30C8arpoon\u0100du\u31BB\u31BFow\xEE\u317Ep\xBB\u1092eft\u0100ah\u31CA\u31D0rrow\xF3\u0FEAarpoon\xF3\u0551ightarrows;\u61C9quigarro\xF7\u30CBhreetimes;\u62CCg;\u42DAingdotse\xF1\u1F32\u0180ahm\u320D\u3210\u3213r\xF2\u0FEAa\xF2\u0551;\u600Foust\u0100;a\u321E\u321F\u63B1che\xBB\u321Fmid;\u6AEE\u0200abpt\u3232\u323D\u3240\u3252\u0100nr\u3237\u323Ag;\u67EDr;\u61FEr\xEB\u1003\u0180afl\u3247\u324A\u324Er;\u6986;\uC000\u{1D563}us;\u6A2Eimes;\u6A35\u0100ap\u325D\u3267r\u0100;g\u3263\u3264\u4029t;\u6994olint;\u6A12ar\xF2\u31E3\u0200achq\u327B\u3280\u10BC\u3285quo;\u603Ar;\uC000\u{1D4C7}\u0100bu\u30FB\u328Ao\u0100;r\u0214\u0213\u0180hir\u3297\u329B\u32A0re\xE5\u31F8mes;\u62CAi\u0200;efl\u32AA\u1059\u1821\u32AB\u65B9tri;\u69CEluhar;\u6968;\u611E\u0D61\u32D5\u32DB\u32DF\u332C\u3338\u3371\0\u337A\u33A4\0\0\u33EC\u33F0\0\u3428\u3448\u345A\u34AD\u34B1\u34CA\u34F1\0\u3616\0\0\u3633cute;\u415Bqu\xEF\u27BA\u0500;Eaceinpsy\u11ED\u32F3\u32F5\u32FF\u3302\u330B\u330F\u331F\u3326\u3329;\u6AB4\u01F0\u32FA\0\u32FC;\u6AB8on;\u4161u\xE5\u11FE\u0100;d\u11F3\u3307il;\u415Frc;\u415D\u0180Eas\u3316\u3318\u331B;\u6AB6p;\u6ABAim;\u62E9olint;\u6A13i\xED\u1204;\u4441ot\u0180;be\u3334\u1D47\u3335\u62C5;\u6A66\u0380Aacmstx\u3346\u334A\u3357\u335B\u335E\u3363\u336Drr;\u61D8r\u0100hr\u3350\u3352\xEB\u2228\u0100;o\u0A36\u0A34t\u803B\xA7\u40A7i;\u403Bwar;\u6929m\u0100in\u3369\xF0nu\xF3\xF1t;\u6736r\u0100;o\u3376\u2055\uC000\u{1D530}\u0200acoy\u3382\u3386\u3391\u33A0rp;\u666F\u0100hy\u338B\u338Fcy;\u4449;\u4448rt\u026D\u3399\0\0\u339Ci\xE4\u1464ara\xEC\u2E6F\u803B\xAD\u40AD\u0100gm\u33A8\u33B4ma\u0180;fv\u33B1\u33B2\u33B2\u43C3;\u43C2\u0400;deglnpr\u12AB\u33C5\u33C9\u33CE\u33D6\u33DE\u33E1\u33E6ot;\u6A6A\u0100;q\u12B1\u12B0\u0100;E\u33D3\u33D4\u6A9E;\u6AA0\u0100;E\u33DB\u33DC\u6A9D;\u6A9Fe;\u6246lus;\u6A24arr;\u6972ar\xF2\u113D\u0200aeit\u33F8\u3408\u340F\u3417\u0100ls\u33FD\u3404lsetm\xE9\u336Ahp;\u6A33parsl;\u69E4\u0100dl\u1463\u3414e;\u6323\u0100;e\u341C\u341D\u6AAA\u0100;s\u3422\u3423\u6AAC;\uC000\u2AAC\uFE00\u0180flp\u342E\u3433\u3442tcy;\u444C\u0100;b\u3438\u3439\u402F\u0100;a\u343E\u343F\u69C4r;\u633Ff;\uC000\u{1D564}a\u0100dr\u344D\u0402es\u0100;u\u3454\u3455\u6660it\xBB\u3455\u0180csu\u3460\u3479\u349F\u0100au\u3465\u346Fp\u0100;s\u1188\u346B;\uC000\u2293\uFE00p\u0100;s\u11B4\u3475;\uC000\u2294\uFE00u\u0100bp\u347F\u348F\u0180;es\u1197\u119C\u3486et\u0100;e\u1197\u348D\xF1\u119D\u0180;es\u11A8\u11AD\u3496et\u0100;e\u11A8\u349D\xF1\u11AE\u0180;af\u117B\u34A6\u05B0r\u0165\u34AB\u05B1\xBB\u117Car\xF2\u1148\u0200cemt\u34B9\u34BE\u34C2\u34C5r;\uC000\u{1D4C8}tm\xEE\xF1i\xEC\u3415ar\xE6\u11BE\u0100ar\u34CE\u34D5r\u0100;f\u34D4\u17BF\u6606\u0100an\u34DA\u34EDight\u0100ep\u34E3\u34EApsilo\xEE\u1EE0h\xE9\u2EAFs\xBB\u2852\u0280bcmnp\u34FB\u355E\u1209\u358B\u358E\u0480;Edemnprs\u350E\u350F\u3511\u3515\u351E\u3523\u352C\u3531\u3536\u6282;\u6AC5ot;\u6ABD\u0100;d\u11DA\u351Aot;\u6AC3ult;\u6AC1\u0100Ee\u3528\u352A;\u6ACB;\u628Alus;\u6ABFarr;\u6979\u0180eiu\u353D\u3552\u3555t\u0180;en\u350E\u3545\u354Bq\u0100;q\u11DA\u350Feq\u0100;q\u352B\u3528m;\u6AC7\u0100bp\u355A\u355C;\u6AD5;\u6AD3c\u0300;acens\u11ED\u356C\u3572\u3579\u357B\u3326ppro\xF8\u32FAurlye\xF1\u11FE\xF1\u11F3\u0180aes\u3582\u3588\u331Bppro\xF8\u331Aq\xF1\u3317g;\u666A\u0680123;Edehlmnps\u35A9\u35AC\u35AF\u121C\u35B2\u35B4\u35C0\u35C9\u35D5\u35DA\u35DF\u35E8\u35ED\u803B\xB9\u40B9\u803B\xB2\u40B2\u803B\xB3\u40B3;\u6AC6\u0100os\u35B9\u35BCt;\u6ABEub;\u6AD8\u0100;d\u1222\u35C5ot;\u6AC4s\u0100ou\u35CF\u35D2l;\u67C9b;\u6AD7arr;\u697Bult;\u6AC2\u0100Ee\u35E4\u35E6;\u6ACC;\u628Blus;\u6AC0\u0180eiu\u35F4\u3609\u360Ct\u0180;en\u121C\u35FC\u3602q\u0100;q\u1222\u35B2eq\u0100;q\u35E7\u35E4m;\u6AC8\u0100bp\u3611\u3613;\u6AD4;\u6AD6\u0180Aan\u361C\u3620\u362Drr;\u61D9r\u0100hr\u3626\u3628\xEB\u222E\u0100;o\u0A2B\u0A29war;\u692Alig\u803B\xDF\u40DF\u0BE1\u3651\u365D\u3660\u12CE\u3673\u3679\0\u367E\u36C2\0\0\0\0\0\u36DB\u3703\0\u3709\u376C\0\0\0\u3787\u0272\u3656\0\0\u365Bget;\u6316;\u43C4r\xEB\u0E5F\u0180aey\u3666\u366B\u3670ron;\u4165dil;\u4163;\u4442lrec;\u6315r;\uC000\u{1D531}\u0200eiko\u3686\u369D\u36B5\u36BC\u01F2\u368B\0\u3691e\u01004f\u1284\u1281a\u0180;sv\u3698\u3699\u369B\u43B8ym;\u43D1\u0100cn\u36A2\u36B2k\u0100as\u36A8\u36AEppro\xF8\u12C1im\xBB\u12ACs\xF0\u129E\u0100as\u36BA\u36AE\xF0\u12C1rn\u803B\xFE\u40FE\u01EC\u031F\u36C6\u22E7es\u8180\xD7;bd\u36CF\u36D0\u36D8\u40D7\u0100;a\u190F\u36D5r;\u6A31;\u6A30\u0180eps\u36E1\u36E3\u3700\xE1\u2A4D\u0200;bcf\u0486\u36EC\u36F0\u36F4ot;\u6336ir;\u6AF1\u0100;o\u36F9\u36FC\uC000\u{1D565}rk;\u6ADA\xE1\u3362rime;\u6034\u0180aip\u370F\u3712\u3764d\xE5\u1248\u0380adempst\u3721\u374D\u3740\u3751\u3757\u375C\u375Fngle\u0280;dlqr\u3730\u3731\u3736\u3740\u3742\u65B5own\xBB\u1DBBeft\u0100;e\u2800\u373E\xF1\u092E;\u625Cight\u0100;e\u32AA\u374B\xF1\u105Aot;\u65ECinus;\u6A3Alus;\u6A39b;\u69CDime;\u6A3Bezium;\u63E2\u0180cht\u3772\u377D\u3781\u0100ry\u3777\u377B;\uC000\u{1D4C9};\u4446cy;\u445Brok;\u4167\u0100io\u378B\u378Ex\xF4\u1777head\u0100lr\u3797\u37A0eftarro\xF7\u084Fightarrow\xBB\u0F5D\u0900AHabcdfghlmoprstuw\u37D0\u37D3\u37D7\u37E4\u37F0\u37FC\u380E\u381C\u3823\u3834\u3851\u385D\u386B\u38A9\u38CC\u38D2\u38EA\u38F6r\xF2\u03EDar;\u6963\u0100cr\u37DC\u37E2ute\u803B\xFA\u40FA\xF2\u1150r\u01E3\u37EA\0\u37EDy;\u445Eve;\u416D\u0100iy\u37F5\u37FArc\u803B\xFB\u40FB;\u4443\u0180abh\u3803\u3806\u380Br\xF2\u13ADlac;\u4171a\xF2\u13C3\u0100ir\u3813\u3818sht;\u697E;\uC000\u{1D532}rave\u803B\xF9\u40F9\u0161\u3827\u3831r\u0100lr\u382C\u382E\xBB\u0957\xBB\u1083lk;\u6580\u0100ct\u3839\u384D\u026F\u383F\0\0\u384Arn\u0100;e\u3845\u3846\u631Cr\xBB\u3846op;\u630Fri;\u65F8\u0100al\u3856\u385Acr;\u416B\u80BB\xA8\u0349\u0100gp\u3862\u3866on;\u4173f;\uC000\u{1D566}\u0300adhlsu\u114B\u3878\u387D\u1372\u3891\u38A0own\xE1\u13B3arpoon\u0100lr\u3888\u388Cef\xF4\u382Digh\xF4\u382Fi\u0180;hl\u3899\u389A\u389C\u43C5\xBB\u13FAon\xBB\u389Aparrows;\u61C8\u0180cit\u38B0\u38C4\u38C8\u026F\u38B6\0\0\u38C1rn\u0100;e\u38BC\u38BD\u631Dr\xBB\u38BDop;\u630Eng;\u416Fri;\u65F9cr;\uC000\u{1D4CA}\u0180dir\u38D9\u38DD\u38E2ot;\u62F0lde;\u4169i\u0100;f\u3730\u38E8\xBB\u1813\u0100am\u38EF\u38F2r\xF2\u38A8l\u803B\xFC\u40FCangle;\u69A7\u0780ABDacdeflnoprsz\u391C\u391F\u3929\u392D\u39B5\u39B8\u39BD\u39DF\u39E4\u39E8\u39F3\u39F9\u39FD\u3A01\u3A20r\xF2\u03F7ar\u0100;v\u3926\u3927\u6AE8;\u6AE9as\xE8\u03E1\u0100nr\u3932\u3937grt;\u699C\u0380eknprst\u34E3\u3946\u394B\u3952\u395D\u3964\u3996app\xE1\u2415othin\xE7\u1E96\u0180hir\u34EB\u2EC8\u3959op\xF4\u2FB5\u0100;h\u13B7\u3962\xEF\u318D\u0100iu\u3969\u396Dgm\xE1\u33B3\u0100bp\u3972\u3984setneq\u0100;q\u397D\u3980\uC000\u228A\uFE00;\uC000\u2ACB\uFE00setneq\u0100;q\u398F\u3992\uC000\u228B\uFE00;\uC000\u2ACC\uFE00\u0100hr\u399B\u399Fet\xE1\u369Ciangle\u0100lr\u39AA\u39AFeft\xBB\u0925ight\xBB\u1051y;\u4432ash\xBB\u1036\u0180elr\u39C4\u39D2\u39D7\u0180;be\u2DEA\u39CB\u39CFar;\u62BBq;\u625Alip;\u62EE\u0100bt\u39DC\u1468a\xF2\u1469r;\uC000\u{1D533}tr\xE9\u39AEsu\u0100bp\u39EF\u39F1\xBB\u0D1C\xBB\u0D59pf;\uC000\u{1D567}ro\xF0\u0EFBtr\xE9\u39B4\u0100cu\u3A06\u3A0Br;\uC000\u{1D4CB}\u0100bp\u3A10\u3A18n\u0100Ee\u3980\u3A16\xBB\u397En\u0100Ee\u3992\u3A1E\xBB\u3990igzag;\u699A\u0380cefoprs\u3A36\u3A3B\u3A56\u3A5B\u3A54\u3A61\u3A6Airc;\u4175\u0100di\u3A40\u3A51\u0100bg\u3A45\u3A49ar;\u6A5Fe\u0100;q\u15FA\u3A4F;\u6259erp;\u6118r;\uC000\u{1D534}pf;\uC000\u{1D568}\u0100;e\u1479\u3A66at\xE8\u1479cr;\uC000\u{1D4CC}\u0AE3\u178E\u3A87\0\u3A8B\0\u3A90\u3A9B\0\0\u3A9D\u3AA8\u3AAB\u3AAF\0\0\u3AC3\u3ACE\0\u3AD8\u17DC\u17DFtr\xE9\u17D1r;\uC000\u{1D535}\u0100Aa\u3A94\u3A97r\xF2\u03C3r\xF2\u09F6;\u43BE\u0100Aa\u3AA1\u3AA4r\xF2\u03B8r\xF2\u09EBa\xF0\u2713is;\u62FB\u0180dpt\u17A4\u3AB5\u3ABE\u0100fl\u3ABA\u17A9;\uC000\u{1D569}im\xE5\u17B2\u0100Aa\u3AC7\u3ACAr\xF2\u03CEr\xF2\u0A01\u0100cq\u3AD2\u17B8r;\uC000\u{1D4CD}\u0100pt\u17D6\u3ADCr\xE9\u17D4\u0400acefiosu\u3AF0\u3AFD\u3B08\u3B0C\u3B11\u3B15\u3B1B\u3B21c\u0100uy\u3AF6\u3AFBte\u803B\xFD\u40FD;\u444F\u0100iy\u3B02\u3B06rc;\u4177;\u444Bn\u803B\xA5\u40A5r;\uC000\u{1D536}cy;\u4457pf;\uC000\u{1D56A}cr;\uC000\u{1D4CE}\u0100cm\u3B26\u3B29y;\u444El\u803B\xFF\u40FF\u0500acdefhiosw\u3B42\u3B48\u3B54\u3B58\u3B64\u3B69\u3B6D\u3B74\u3B7A\u3B80cute;\u417A\u0100ay\u3B4D\u3B52ron;\u417E;\u4437ot;\u417C\u0100et\u3B5D\u3B61tr\xE6\u155Fa;\u43B6r;\uC000\u{1D537}cy;\u4436grarr;\u61DDpf;\uC000\u{1D56B}cr;\uC000\u{1D4CF}\u0100jn\u3B85\u3B87;\u600Dj;\u600C'.split("").map(t=>t.charCodeAt(0))),Lpe=new Uint16Array("\u0200aglq	\x1B\u026D\0\0p;\u4026os;\u4027t;\u403Et;\u403Cuot;\u4022".split("").map(t=>t.charCodeAt(0))),DN,Fpe=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),l$=(DN=String.fromCodePoint)!==null&&DN!==void 0?DN:function(t){let i="";return t>65535&&(t-=65536,i+=String.fromCharCode(t>>>10&1023|55296),t=56320|t&1023),i+=String.fromCharCode(t),i};function zpe(t){var i;return t>=55296&&t<=57343||t>1114111?65533:(i=Fpe.get(t))!==null&&i!==void 0?i:t}var tl=function(t){return t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z",t}(tl||{}),Bpe=32,_0=function(t){return t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE",t}(_0||{});function PN(t){return t>=tl.ZERO&&t<=tl.NINE}function Vpe(t){return t>=tl.UPPER_A&&t<=tl.UPPER_F||t>=tl.LOWER_A&&t<=tl.LOWER_F}function jpe(t){return t>=tl.UPPER_A&&t<=tl.UPPER_Z||t>=tl.LOWER_A&&t<=tl.LOWER_Z||PN(t)}function Upe(t){return t===tl.EQUALS||jpe(t)}var el=function(t){return t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity",t}(el||{}),zp=function(t){return t[t.Legacy=0]="Legacy",t[t.Strict=1]="Strict",t[t.Attribute=2]="Attribute",t}(zp||{}),NN=class{constructor(i,e,n){this.decodeTree=i,this.emitCodePoint=e,this.errors=n,this.state=el.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=zp.Strict}startEntity(i){this.decodeMode=i,this.state=el.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(i,e){switch(this.state){case el.EntityStart:return i.charCodeAt(e)===tl.NUM?(this.state=el.NumericStart,this.consumed+=1,this.stateNumericStart(i,e+1)):(this.state=el.NamedEntity,this.stateNamedEntity(i,e));case el.NumericStart:return this.stateNumericStart(i,e);case el.NumericDecimal:return this.stateNumericDecimal(i,e);case el.NumericHex:return this.stateNumericHex(i,e);case el.NamedEntity:return this.stateNamedEntity(i,e)}}stateNumericStart(i,e){return e>=i.length?-1:(i.charCodeAt(e)|Bpe)===tl.LOWER_X?(this.state=el.NumericHex,this.consumed+=1,this.stateNumericHex(i,e+1)):(this.state=el.NumericDecimal,this.stateNumericDecimal(i,e))}addToNumericResult(i,e,n,o){if(e!==n){let r=n-e;this.result=this.result*Math.pow(o,r)+Number.parseInt(i.substr(e,r),o),this.consumed+=r}}stateNumericHex(i,e){let n=e;for(;e<i.length;){let o=i.charCodeAt(e);if(PN(o)||Vpe(o))e+=1;else return this.addToNumericResult(i,n,e,16),this.emitNumericEntity(o,3)}return this.addToNumericResult(i,n,e,16),-1}stateNumericDecimal(i,e){let n=e;for(;e<i.length;){let o=i.charCodeAt(e);if(PN(o))e+=1;else return this.addToNumericResult(i,n,e,10),this.emitNumericEntity(o,2)}return this.addToNumericResult(i,n,e,10),-1}emitNumericEntity(i,e){var n;if(this.consumed<=e)return(n=this.errors)===null||n===void 0||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(i===tl.SEMI)this.consumed+=1;else if(this.decodeMode===zp.Strict)return 0;return this.emitCodePoint(zpe(this.result),this.consumed),this.errors&&(i!==tl.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(i,e){let{decodeTree:n}=this,o=n[this.treeIndex],r=(o&_0.VALUE_LENGTH)>>14;for(;e<i.length;e++,this.excess++){let g=i.charCodeAt(e);if(this.treeIndex=Hpe(n,o,this.treeIndex+Math.max(1,r),g),this.treeIndex<0)return this.result===0||this.decodeMode===zp.Attribute&&(r===0||Upe(g))?0:this.emitNotTerminatedNamedEntity();if(o=n[this.treeIndex],r=(o&_0.VALUE_LENGTH)>>14,r!==0){if(g===tl.SEMI)return this.emitNamedEntityData(this.treeIndex,r,this.consumed+this.excess);this.decodeMode!==zp.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var i;let{result:e,decodeTree:n}=this,o=(n[e]&_0.VALUE_LENGTH)>>14;return this.emitNamedEntityData(e,o,this.consumed),(i=this.errors)===null||i===void 0||i.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(i,e,n){let{decodeTree:o}=this;return this.emitCodePoint(e===1?o[i]&~_0.VALUE_LENGTH:o[i+1],n),e===3&&this.emitCodePoint(o[i+2],n),n}end(){var i;switch(this.state){case el.NamedEntity:return this.result!==0&&(this.decodeMode!==zp.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case el.NumericDecimal:return this.emitNumericEntity(0,2);case el.NumericHex:return this.emitNumericEntity(0,3);case el.NumericStart:return(i=this.errors)===null||i===void 0||i.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case el.EntityStart:return 0}}};function Hpe(t,i,e,n){let o=(i&_0.BRANCH_LENGTH)>>7,r=i&_0.JUMP_TABLE;if(o===0)return r!==0&&n===r?e:-1;if(r){let T=n-r;return T<0||T>=o?-1:t[e+T]-1}let g=e,w=g+o-1;for(;g<=w;){let T=g+w>>>1,k=t[T];if(k<n)g=T+1;else if(k>n)w=T-1;else return t[T+o]}return-1}var Gn=function(t){return t[t.Tab=9]="Tab",t[t.NewLine=10]="NewLine",t[t.FormFeed=12]="FormFeed",t[t.CarriageReturn=13]="CarriageReturn",t[t.Space=32]="Space",t[t.ExclamationMark=33]="ExclamationMark",t[t.Number=35]="Number",t[t.Amp=38]="Amp",t[t.SingleQuote=39]="SingleQuote",t[t.DoubleQuote=34]="DoubleQuote",t[t.Dash=45]="Dash",t[t.Slash=47]="Slash",t[t.Zero=48]="Zero",t[t.Nine=57]="Nine",t[t.Semi=59]="Semi",t[t.Lt=60]="Lt",t[t.Eq=61]="Eq",t[t.Gt=62]="Gt",t[t.Questionmark=63]="Questionmark",t[t.UpperA=65]="UpperA",t[t.LowerA=97]="LowerA",t[t.UpperF=70]="UpperF",t[t.LowerF=102]="LowerF",t[t.UpperZ=90]="UpperZ",t[t.LowerZ=122]="LowerZ",t[t.LowerX=120]="LowerX",t[t.OpeningSquareBracket=91]="OpeningSquareBracket",t}(Gn||{}),Si=function(t){return t[t.Text=1]="Text",t[t.BeforeTagName=2]="BeforeTagName",t[t.InTagName=3]="InTagName",t[t.InSelfClosingTag=4]="InSelfClosingTag",t[t.BeforeClosingTagName=5]="BeforeClosingTagName",t[t.InClosingTagName=6]="InClosingTagName",t[t.AfterClosingTagName=7]="AfterClosingTagName",t[t.BeforeAttributeName=8]="BeforeAttributeName",t[t.InAttributeName=9]="InAttributeName",t[t.AfterAttributeName=10]="AfterAttributeName",t[t.BeforeAttributeValue=11]="BeforeAttributeValue",t[t.InAttributeValueDq=12]="InAttributeValueDq",t[t.InAttributeValueSq=13]="InAttributeValueSq",t[t.InAttributeValueNq=14]="InAttributeValueNq",t[t.BeforeDeclaration=15]="BeforeDeclaration",t[t.InDeclaration=16]="InDeclaration",t[t.InProcessingInstruction=17]="InProcessingInstruction",t[t.BeforeComment=18]="BeforeComment",t[t.CDATASequence=19]="CDATASequence",t[t.InSpecialComment=20]="InSpecialComment",t[t.InCommentLike=21]="InCommentLike",t[t.BeforeSpecialS=22]="BeforeSpecialS",t[t.BeforeSpecialT=23]="BeforeSpecialT",t[t.SpecialStartSequence=24]="SpecialStartSequence",t[t.InSpecialTag=25]="InSpecialTag",t[t.InEntity=26]="InEntity",t}(Si||{});function Fp(t){return t===Gn.Space||t===Gn.NewLine||t===Gn.Tab||t===Gn.FormFeed||t===Gn.CarriageReturn}function oD(t){return t===Gn.Slash||t===Gn.Gt||Fp(t)}function qpe(t){return t>=Gn.LowerA&&t<=Gn.LowerZ||t>=Gn.UpperA&&t<=Gn.UpperZ}var Bp=function(t){return t[t.NoValue=0]="NoValue",t[t.Unquoted=1]="Unquoted",t[t.Single=2]="Single",t[t.Double=3]="Double",t}(Bp||{}),Ja={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101]),TextareaEnd:new Uint8Array([60,47,116,101,120,116,97,114,101,97]),XmpEnd:new Uint8Array([60,47,120,109,112])},LN=class{constructor({xmlMode:i=!1,decodeEntities:e=!0},n){this.cbs=n,this.state=Si.Text,this.buffer="",this.sectionStart=0,this.index=0,this.entityStart=0,this.baseState=Si.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.currentSequence=void 0,this.sequenceIndex=0,this.xmlMode=i,this.decodeEntities=e,this.entityDecoder=new NN(i?Lpe:Npe,(o,r)=>this.emitCodePoint(o,r))}reset(){this.state=Si.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=Si.Text,this.currentSequence=void 0,this.running=!0,this.offset=0}write(i){this.offset+=this.buffer.length,this.buffer=i,this.parse()}end(){this.running&&this.finish()}pause(){this.running=!1}resume(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()}stateText(i){i===Gn.Lt||!this.decodeEntities&&this.fastForwardTo(Gn.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=Si.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&i===Gn.Amp&&this.startEntity()}stateSpecialStartSequence(i){let e=this.sequenceIndex===this.currentSequence.length;if(!(e?oD(i):(i|32)===this.currentSequence[this.sequenceIndex]))this.isSpecial=!1;else if(!e){this.sequenceIndex++;return}this.sequenceIndex=0,this.state=Si.InTagName,this.stateInTagName(i)}stateInSpecialTag(i){if(this.sequenceIndex===this.currentSequence.length){if(i===Gn.Gt||Fp(i)){let e=this.index-this.currentSequence.length;if(this.sectionStart<e){let n=this.index;this.index=e,this.cbs.ontext(this.sectionStart,e),this.index=n}this.isSpecial=!1,this.sectionStart=e+2,this.stateInClosingTagName(i);return}this.sequenceIndex=0}(i|32)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:this.sequenceIndex===0?this.currentSequence===Ja.TitleEnd?this.decodeEntities&&i===Gn.Amp&&this.startEntity():this.fastForwardTo(Gn.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=+(i===Gn.Lt)}stateCDATASequence(i){i===Ja.Cdata[this.sequenceIndex]?++this.sequenceIndex===Ja.Cdata.length&&(this.state=Si.InCommentLike,this.currentSequence=Ja.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=Si.InDeclaration,this.stateInDeclaration(i))}fastForwardTo(i){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===i)return!0;return this.index=this.buffer.length+this.offset-1,!1}stateInCommentLike(i){i===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===Ja.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=Si.Text):this.sequenceIndex===0?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):i!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)}isTagStartChar(i){return this.xmlMode?!oD(i):qpe(i)}startSpecial(i,e){this.isSpecial=!0,this.currentSequence=i,this.sequenceIndex=e,this.state=Si.SpecialStartSequence}stateBeforeTagName(i){if(i===Gn.ExclamationMark)this.state=Si.BeforeDeclaration,this.sectionStart=this.index+1;else if(i===Gn.Questionmark)this.state=Si.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(i)){let e=i|32;this.sectionStart=this.index,this.xmlMode?this.state=Si.InTagName:e===Ja.ScriptEnd[2]?this.state=Si.BeforeSpecialS:e===Ja.TitleEnd[2]||e===Ja.XmpEnd[2]?this.state=Si.BeforeSpecialT:this.state=Si.InTagName}else i===Gn.Slash?this.state=Si.BeforeClosingTagName:(this.state=Si.Text,this.stateText(i))}stateInTagName(i){oD(i)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=Si.BeforeAttributeName,this.stateBeforeAttributeName(i))}stateBeforeClosingTagName(i){Fp(i)||(i===Gn.Gt?this.state=Si.Text:(this.state=this.isTagStartChar(i)?Si.InClosingTagName:Si.InSpecialComment,this.sectionStart=this.index))}stateInClosingTagName(i){(i===Gn.Gt||Fp(i))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=Si.AfterClosingTagName,this.stateAfterClosingTagName(i))}stateAfterClosingTagName(i){(i===Gn.Gt||this.fastForwardTo(Gn.Gt))&&(this.state=Si.Text,this.sectionStart=this.index+1)}stateBeforeAttributeName(i){i===Gn.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=Si.InSpecialTag,this.sequenceIndex=0):this.state=Si.Text,this.sectionStart=this.index+1):i===Gn.Slash?this.state=Si.InSelfClosingTag:Fp(i)||(this.state=Si.InAttributeName,this.sectionStart=this.index)}stateInSelfClosingTag(i){i===Gn.Gt?(this.cbs.onselfclosingtag(this.index),this.state=Si.Text,this.sectionStart=this.index+1,this.isSpecial=!1):Fp(i)||(this.state=Si.BeforeAttributeName,this.stateBeforeAttributeName(i))}stateInAttributeName(i){(i===Gn.Eq||oD(i))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=this.index,this.state=Si.AfterAttributeName,this.stateAfterAttributeName(i))}stateAfterAttributeName(i){i===Gn.Eq?this.state=Si.BeforeAttributeValue:i===Gn.Slash||i===Gn.Gt?(this.cbs.onattribend(Bp.NoValue,this.sectionStart),this.sectionStart=-1,this.state=Si.BeforeAttributeName,this.stateBeforeAttributeName(i)):Fp(i)||(this.cbs.onattribend(Bp.NoValue,this.sectionStart),this.state=Si.InAttributeName,this.sectionStart=this.index)}stateBeforeAttributeValue(i){i===Gn.DoubleQuote?(this.state=Si.InAttributeValueDq,this.sectionStart=this.index+1):i===Gn.SingleQuote?(this.state=Si.InAttributeValueSq,this.sectionStart=this.index+1):Fp(i)||(this.sectionStart=this.index,this.state=Si.InAttributeValueNq,this.stateInAttributeValueNoQuotes(i))}handleInAttributeValue(i,e){i===e||!this.decodeEntities&&this.fastForwardTo(e)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(e===Gn.DoubleQuote?Bp.Double:Bp.Single,this.index+1),this.state=Si.BeforeAttributeName):this.decodeEntities&&i===Gn.Amp&&this.startEntity()}stateInAttributeValueDoubleQuotes(i){this.handleInAttributeValue(i,Gn.DoubleQuote)}stateInAttributeValueSingleQuotes(i){this.handleInAttributeValue(i,Gn.SingleQuote)}stateInAttributeValueNoQuotes(i){Fp(i)||i===Gn.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(Bp.Unquoted,this.index),this.state=Si.BeforeAttributeName,this.stateBeforeAttributeName(i)):this.decodeEntities&&i===Gn.Amp&&this.startEntity()}stateBeforeDeclaration(i){i===Gn.OpeningSquareBracket?(this.state=Si.CDATASequence,this.sequenceIndex=0):this.state=i===Gn.Dash?Si.BeforeComment:Si.InDeclaration}stateInDeclaration(i){(i===Gn.Gt||this.fastForwardTo(Gn.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=Si.Text,this.sectionStart=this.index+1)}stateInProcessingInstruction(i){(i===Gn.Gt||this.fastForwardTo(Gn.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=Si.Text,this.sectionStart=this.index+1)}stateBeforeComment(i){i===Gn.Dash?(this.state=Si.InCommentLike,this.currentSequence=Ja.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=Si.InDeclaration}stateInSpecialComment(i){(i===Gn.Gt||this.fastForwardTo(Gn.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=Si.Text,this.sectionStart=this.index+1)}stateBeforeSpecialS(i){let e=i|32;e===Ja.ScriptEnd[3]?this.startSpecial(Ja.ScriptEnd,4):e===Ja.StyleEnd[3]?this.startSpecial(Ja.StyleEnd,4):(this.state=Si.InTagName,this.stateInTagName(i))}stateBeforeSpecialT(i){switch(i|32){case Ja.TitleEnd[3]:{this.startSpecial(Ja.TitleEnd,4);break}case Ja.TextareaEnd[3]:{this.startSpecial(Ja.TextareaEnd,4);break}case Ja.XmpEnd[3]:{this.startSpecial(Ja.XmpEnd,4);break}default:this.state=Si.InTagName,this.stateInTagName(i)}}startEntity(){this.baseState=this.state,this.state=Si.InEntity,this.entityStart=this.index,this.entityDecoder.startEntity(this.xmlMode?zp.Strict:this.baseState===Si.Text||this.baseState===Si.InSpecialTag?zp.Legacy:zp.Attribute)}stateInEntity(){let i=this.entityDecoder.write(this.buffer,this.index-this.offset);i>=0?(this.state=this.baseState,i===0&&(this.index=this.entityStart)):this.index=this.offset+this.buffer.length-1}cleanup(){this.running&&this.sectionStart!==this.index&&(this.state===Si.Text||this.state===Si.InSpecialTag&&this.sequenceIndex===0?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):(this.state===Si.InAttributeValueDq||this.state===Si.InAttributeValueSq||this.state===Si.InAttributeValueNq)&&(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))}shouldContinue(){return this.index<this.buffer.length+this.offset&&this.running}parse(){for(;this.shouldContinue();){let i=this.buffer.charCodeAt(this.index-this.offset);switch(this.state){case Si.Text:{this.stateText(i);break}case Si.SpecialStartSequence:{this.stateSpecialStartSequence(i);break}case Si.InSpecialTag:{this.stateInSpecialTag(i);break}case Si.CDATASequence:{this.stateCDATASequence(i);break}case Si.InAttributeValueDq:{this.stateInAttributeValueDoubleQuotes(i);break}case Si.InAttributeName:{this.stateInAttributeName(i);break}case Si.InCommentLike:{this.stateInCommentLike(i);break}case Si.InSpecialComment:{this.stateInSpecialComment(i);break}case Si.BeforeAttributeName:{this.stateBeforeAttributeName(i);break}case Si.InTagName:{this.stateInTagName(i);break}case Si.InClosingTagName:{this.stateInClosingTagName(i);break}case Si.BeforeTagName:{this.stateBeforeTagName(i);break}case Si.AfterAttributeName:{this.stateAfterAttributeName(i);break}case Si.InAttributeValueSq:{this.stateInAttributeValueSingleQuotes(i);break}case Si.BeforeAttributeValue:{this.stateBeforeAttributeValue(i);break}case Si.BeforeClosingTagName:{this.stateBeforeClosingTagName(i);break}case Si.AfterClosingTagName:{this.stateAfterClosingTagName(i);break}case Si.BeforeSpecialS:{this.stateBeforeSpecialS(i);break}case Si.BeforeSpecialT:{this.stateBeforeSpecialT(i);break}case Si.InAttributeValueNq:{this.stateInAttributeValueNoQuotes(i);break}case Si.InSelfClosingTag:{this.stateInSelfClosingTag(i);break}case Si.InDeclaration:{this.stateInDeclaration(i);break}case Si.BeforeDeclaration:{this.stateBeforeDeclaration(i);break}case Si.BeforeComment:{this.stateBeforeComment(i);break}case Si.InProcessingInstruction:{this.stateInProcessingInstruction(i);break}case Si.InEntity:{this.stateInEntity();break}}this.index++}this.cleanup()}finish(){this.state===Si.InEntity&&(this.entityDecoder.end(),this.state=this.baseState),this.handleTrailingData(),this.cbs.onend()}handleTrailingData(){let i=this.buffer.length+this.offset;this.sectionStart>=i||(this.state===Si.InCommentLike?this.currentSequence===Ja.CdataEnd?this.cbs.oncdata(this.sectionStart,i,0):this.cbs.oncomment(this.sectionStart,i,0):this.state===Si.InTagName||this.state===Si.BeforeAttributeName||this.state===Si.BeforeAttributeValue||this.state===Si.AfterAttributeName||this.state===Si.InAttributeName||this.state===Si.InAttributeValueSq||this.state===Si.InAttributeValueDq||this.state===Si.InAttributeValueNq||this.state===Si.InClosingTagName||this.cbs.ontext(this.sectionStart,i))}emitCodePoint(i,e){this.baseState!==Si.Text&&this.baseState!==Si.InSpecialTag?(this.sectionStart<this.entityStart&&this.cbs.onattribdata(this.sectionStart,this.entityStart),this.sectionStart=this.entityStart+e,this.index=this.sectionStart-1,this.cbs.onattribentity(i)):(this.sectionStart<this.entityStart&&this.cbs.ontext(this.sectionStart,this.entityStart),this.sectionStart=this.entityStart+e,this.index=this.sectionStart-1,this.cbs.ontextentity(i,this.sectionStart))}},Jy=new Set(["input","option","optgroup","select","button","datalist","textarea"]),Eo=new Set(["p"]),c$=new Set(["thead","tbody"]),u$=new Set(["dd","dt"]),d$=new Set(["rt","rp"]),$pe=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",Eo],["h1",Eo],["h2",Eo],["h3",Eo],["h4",Eo],["h5",Eo],["h6",Eo],["select",Jy],["input",Jy],["output",Jy],["button",Jy],["datalist",Jy],["textarea",Jy],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",u$],["dt",u$],["address",Eo],["article",Eo],["aside",Eo],["blockquote",Eo],["details",Eo],["div",Eo],["dl",Eo],["fieldset",Eo],["figcaption",Eo],["figure",Eo],["footer",Eo],["form",Eo],["header",Eo],["hr",Eo],["main",Eo],["nav",Eo],["ol",Eo],["pre",Eo],["section",Eo],["table",Eo],["ul",Eo],["rt",d$],["rp",d$],["tbody",c$],["tfoot",c$]]),Gpe=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),h$=new Set(["math","svg"]),p$=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),Wpe=/\s|\//,FN=class{constructor(i,e={}){var n,o,r,g,w,T;this.options=e,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=i??{},this.htmlMode=!this.options.xmlMode,this.lowerCaseTagNames=(n=e.lowerCaseTags)!==null&&n!==void 0?n:this.htmlMode,this.lowerCaseAttributeNames=(o=e.lowerCaseAttributeNames)!==null&&o!==void 0?o:this.htmlMode,this.recognizeSelfClosing=(r=e.recognizeSelfClosing)!==null&&r!==void 0?r:!this.htmlMode,this.tokenizer=new((g=e.Tokenizer)!==null&&g!==void 0?g:LN)(this.options,this),this.foreignContext=[!this.htmlMode],(T=(w=this.cbs).onparserinit)===null||T===void 0||T.call(w,this)}ontext(i,e){var n,o;let r=this.getSlice(i,e);this.endIndex=e-1,(o=(n=this.cbs).ontext)===null||o===void 0||o.call(n,r),this.startIndex=e}ontextentity(i,e){var n,o;this.endIndex=e-1,(o=(n=this.cbs).ontext)===null||o===void 0||o.call(n,l$(i)),this.startIndex=e}isVoidElement(i){return this.htmlMode&&Gpe.has(i)}onopentagname(i,e){this.endIndex=e;let n=this.getSlice(i,e);this.lowerCaseTagNames&&(n=n.toLowerCase()),this.emitOpenTag(n)}emitOpenTag(i){var e,n,o,r;this.openTagStart=this.startIndex,this.tagname=i;let g=this.htmlMode&&$pe.get(i);if(g)for(;this.stack.length>0&&g.has(this.stack[0]);){let w=this.stack.shift();(n=(e=this.cbs).onclosetag)===null||n===void 0||n.call(e,w,!0)}this.isVoidElement(i)||(this.stack.unshift(i),this.htmlMode&&(h$.has(i)?this.foreignContext.unshift(!0):p$.has(i)&&this.foreignContext.unshift(!1))),(r=(o=this.cbs).onopentagname)===null||r===void 0||r.call(o,i),this.cbs.onopentag&&(this.attribs={})}endOpenTag(i){var e,n;this.startIndex=this.openTagStart,this.attribs&&((n=(e=this.cbs).onopentag)===null||n===void 0||n.call(e,this.tagname,this.attribs,i),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""}onopentagend(i){this.endIndex=i,this.endOpenTag(!1),this.startIndex=i+1}onclosetag(i,e){var n,o,r,g,w,T,k,N;this.endIndex=e;let V=this.getSlice(i,e);if(this.lowerCaseTagNames&&(V=V.toLowerCase()),this.htmlMode&&(h$.has(V)||p$.has(V))&&this.foreignContext.shift(),this.isVoidElement(V))this.htmlMode&&V==="br"&&((g=(r=this.cbs).onopentagname)===null||g===void 0||g.call(r,"br"),(T=(w=this.cbs).onopentag)===null||T===void 0||T.call(w,"br",{},!0),(N=(k=this.cbs).onclosetag)===null||N===void 0||N.call(k,"br",!1));else{let q=this.stack.indexOf(V);if(q!==-1)for(let Z=0;Z<=q;Z++){let X=this.stack.shift();(o=(n=this.cbs).onclosetag)===null||o===void 0||o.call(n,X,Z!==q)}else this.htmlMode&&V==="p"&&(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=e+1}onselfclosingtag(i){this.endIndex=i,this.recognizeSelfClosing||this.foreignContext[0]?(this.closeCurrentTag(!1),this.startIndex=i+1):this.onopentagend(i)}closeCurrentTag(i){var e,n;let o=this.tagname;this.endOpenTag(i),this.stack[0]===o&&((n=(e=this.cbs).onclosetag)===null||n===void 0||n.call(e,o,!i),this.stack.shift())}onattribname(i,e){this.startIndex=i;let n=this.getSlice(i,e);this.attribname=this.lowerCaseAttributeNames?n.toLowerCase():n}onattribdata(i,e){this.attribvalue+=this.getSlice(i,e)}onattribentity(i){this.attribvalue+=l$(i)}onattribend(i,e){var n,o;this.endIndex=e,(o=(n=this.cbs).onattribute)===null||o===void 0||o.call(n,this.attribname,this.attribvalue,i===Bp.Double?'"':i===Bp.Single?"'":i===Bp.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""}getInstructionName(i){let e=i.search(Wpe),n=e<0?i:i.substr(0,e);return this.lowerCaseTagNames&&(n=n.toLowerCase()),n}ondeclaration(i,e){this.endIndex=e;let n=this.getSlice(i,e);if(this.cbs.onprocessinginstruction){let o=this.getInstructionName(n);this.cbs.onprocessinginstruction(`!${o}`,`!${n}`)}this.startIndex=e+1}onprocessinginstruction(i,e){this.endIndex=e;let n=this.getSlice(i,e);if(this.cbs.onprocessinginstruction){let o=this.getInstructionName(n);this.cbs.onprocessinginstruction(`?${o}`,`?${n}`)}this.startIndex=e+1}oncomment(i,e,n){var o,r,g,w;this.endIndex=e,(r=(o=this.cbs).oncomment)===null||r===void 0||r.call(o,this.getSlice(i,e-n)),(w=(g=this.cbs).oncommentend)===null||w===void 0||w.call(g),this.startIndex=e+1}oncdata(i,e,n){var o,r,g,w,T,k,N,V,q,Z;this.endIndex=e;let X=this.getSlice(i,e-n);!this.htmlMode||this.options.recognizeCDATA?((r=(o=this.cbs).oncdatastart)===null||r===void 0||r.call(o),(w=(g=this.cbs).ontext)===null||w===void 0||w.call(g,X),(k=(T=this.cbs).oncdataend)===null||k===void 0||k.call(T)):((V=(N=this.cbs).oncomment)===null||V===void 0||V.call(N,`[CDATA[${X}]]`),(Z=(q=this.cbs).oncommentend)===null||Z===void 0||Z.call(q)),this.startIndex=e+1}onend(){var i,e;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(let n=0;n<this.stack.length;n++)this.cbs.onclosetag(this.stack[n],!0)}(e=(i=this.cbs).onend)===null||e===void 0||e.call(i)}reset(){var i,e,n,o;(e=(i=this.cbs).onreset)===null||e===void 0||e.call(i),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,(o=(n=this.cbs).onparserinit)===null||o===void 0||o.call(n,this),this.buffers.length=0,this.foreignContext.length=0,this.foreignContext.unshift(!this.htmlMode),this.bufferOffset=0,this.writeIndex=0,this.ended=!1}parseComplete(i){this.reset(),this.end(i)}getSlice(i,e){for(;i-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();let n=this.buffers[0].slice(i-this.bufferOffset,e-this.bufferOffset);for(;e-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),n+=this.buffers[0].slice(0,e-this.bufferOffset);return n}shiftBuffer(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()}write(i){var e,n;if(this.ended){(n=(e=this.cbs).onerror)===null||n===void 0||n.call(e,new Error(".write() after done!"));return}this.buffers.push(i),this.tokenizer.running&&(this.tokenizer.write(i),this.writeIndex++)}end(i){var e,n;if(this.ended){(n=(e=this.cbs).onerror)===null||n===void 0||n.call(e,new Error(".end() after done!"));return}i&&this.write(i),this.ended=!0,this.tokenizer.end()}pause(){this.tokenizer.pause()}resume(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()}parseChunk(i){this.write(i)}done(i){this.end(i)}};function Zpe(t,i){let e=new IN(void 0,i);return new FN(e,i).end(t),e.root}var Ype=M$(),iw=mD(Ype);function f$(t){return Qde(t)}function m$(t,i){let e=[];return Xde(t,(n,o,r)=>{if(!(o?.type==="decl"&&o.value.includes("</style>"))){if(!i.compress){e.push(n);return}if(o?.type!=="comment"){if(o?.type==="decl"){let g=o.prop+o.raws.between;e.push(n.replace(g,g.trim()));return}if(r==="start"){o?.type==="rule"&&o.selectors?o.selectors.length===1?e.push(o.selectors[0]??"","{"):e.push(o.selectors.join(","),"{"):e.push(n.trim());return}if(r==="end"&&n==="}"&&o?.raws?.semicolon){let g=e.length-2;g>=0&&e[g]&&(e[g]=e[g].slice(0,-1))}e.push(n.trim())}}}),e.join("")}function Kpe(t){return i=>{let e="selectors"in i?i.selectors:void 0;t(i)===!1&&(i.$$remove=!0),"selectors"in i&&(i.$$markedSelectors=i.selectors,i.selectors=e),i._other&&(i._other.$$markedSelectors=i._other.selectors)}}function lG(t){t.$$markedSelectors&&(t.selectors=t.$$markedSelectors),t._other&&lG(t._other)}function nL(t,i){"nodes"in t&&(t.nodes=t.nodes?.filter(e=>(uG(e)&&nL(e,i),e._other=void 0,e.filterSelectors=hG,i(e)!==!1)))}function cG(t,i,e){if(!i)return nL(t,e);[t.nodes,i.nodes]=dG(t.nodes,i.nodes,(n,o,r,g)=>{let w=g?.[o];return uG(n)&&cG(n,w,e),n._other=w,n.filterSelectors=hG,e(n)!==!1})}function uG(t){return"nodes"in t&&!!t.nodes?.length&&(!("name"in t)||t.name!=="keyframes"&&t.name!=="-webkit-keyframes")&&t.nodes.some(i=>i.type==="rule"||i.type==="atrule")}function dG(t,i,e){let n=[],o=[];for(let r=0;r<t.length;r++){let g=t[r];e(g,r,t,i)?n.push(g):o.push(g)}return[n,o]}function hG(t){if(this._other){let[i,e]=dG(this.selectors,this._other.selectors,t);this.selectors=i,this._other.selectors=e}else this.selectors=this.selectors.filter(t)}var Xpe=new Set(["all","print","screen","speech"]),Qpe=new Set(["and","not",","]),Jpe=new Set(["width","aspect-ratio","color","color-index","grid","height","monochrome","orientation","resolution","scan"].flatMap(t=>[t,`min-${t}`,`max-${t}`]));function efe(t){let{type:i,value:e}=t;if(i==="media-type")return Xpe.has(e);if(i==="keyword")return Qpe.has(e);if(i==="media-feature")return Jpe.has(e)}function tfe(t){let e=("default"in yN?yN.default:yN)(t),n=new Set(["media-type","keyword","media-feature"]),o=[e];for(;o.length>0;){let r=o.pop();if(n.has(r.type)&&!efe(r))return!1;r.nodes&&o.push(...r.nodes)}return!0}var zN=null,BN=null;function ife(t){zN=new Set,BN=new Set;let i=[t];for(;i.length;){let e=i.shift();if(e.hasAttribute?.("class")&&e.getAttribute("class").trim().split(" ").forEach(o=>{zN.add(o)}),e.hasAttribute?.("id")){let n=e.getAttribute("id").trim();BN.add(n)}"children"in e&&i.push(...e.children.filter(n=>n.type==="tag"))}}function nfe(t){let i=Zpe(t,{decodeEntities:!1});afe(i),ofe(tv.prototype);let e=i.querySelector("[data-beasties-container]");return e||(i.documentElement?.setAttribute("data-beasties-container",""),e=i.documentElement||i),i.beastiesContainer=e,ife(e),i}function rfe(t){return wD(t,{decodeEntities:!1})}var g$=!1;function ofe(t){g$||(g$=!0,Object.defineProperties(t,{nodeName:{get(){return this.tagName.toUpperCase()}},id:{get(){return this.getAttribute("id")},set(i){this.setAttribute("id",i)}},className:{get(){return this.getAttribute("class")},set(i){this.setAttribute("class",i)}},insertBefore:{value(i,e){return e?($$(e,i),i):this.appendChild(i)}},appendChild:{value(i){return RN(this,i),i}},removeChild:{value(i){x0(i)}},remove:{value(){x0(this)}},textContent:{get(){return nw(this)},set(i){this.children=[],RN(this,new v0(i))}},setAttribute:{value(i,e){this.attribs==null&&(this.attribs={}),e==null&&(e=""),this.attribs[i]=e}},removeAttribute:{value(i){this.attribs!=null&&delete this.attribs[i]}},getAttribute:{value(i){return this.attribs!=null&&this.attribs[i]}},hasAttribute:{value(i){return this.attribs!=null&&this.attribs[i]!=null}},getAttributeNode:{value(i){let e=this.getAttribute(i);if(e!=null)return{specified:!0,value:e}}},exists:{value(i){return pG(i,this)}},querySelector:{value(i){return iL(i,this)}},querySelectorAll:{value(i){return sG(i,this)}}}))}function afe(t){Object.defineProperties(t,{nodeType:{get(){return 9}},contentType:{get(){return"text/html"}},nodeName:{get(){return"#document"}},documentElement:{get(){return this.children.find(i=>"tagName"in i&&String(i.tagName).toLowerCase()==="html")}},head:{get(){return this.querySelector("head")}},body:{get(){return this.querySelector("body")}},createElement:{value(i){return new tv(i,{})}},createTextNode:{value(i){return new v0(i)}},exists:{value(i){return pG(i,this)}},querySelector:{value(i){return iL(i,this)}},querySelectorAll:{value(i){return i===":root"?this:sG(i,this)}}})}var _$=new Map;function pG(t,i){let e=_$.get(t);if(e===void 0&&(e=sfe(t),_$.set(t,e)),e)for(let n of e){if(n.name==="class")return zN.has(n.value);if(n.name==="id")return BN.has(n.value)}return!!iL(t,i)}function sfe(t){let i=eL(t),e=[];for(let n=0;n<i.length;n++){let o=i[n];if(o?.length!==1)continue;let r=o[0];r?.type==="attribute"&&(r.name==="class"||r.name==="id")&&e.push(r)}return e.length>0?e:null}var y$=["trace","debug","info","warn","error","silent"],v$={trace(t){console.trace(t)},debug(t){console.debug(t)},warn(t){console.warn(iw.yellow(t))},error(t){console.error(iw.bold(iw.red(t)))},info(t){console.info(iw.bold(iw.blue(t)))},silent(){}};function lfe(t){let i=y$.indexOf(t);return y$.reduce((e,n,o)=>(o>=i?e[n]=v$[n]:e[n]=v$.silent,e),{})}function cfe(t,i){return!ev.relative(t,i).startsWith("..")}var ufe=/(?<!\\)::?[a-z-]+(?:\(.+\))?/gi,dfe=/>\s*(?=>|$)/g,hfe=/\(\s*,|,\s*\)/g,pD=class{#e=new Map;options;logger;fs;constructor(i={}){this.options=Object.assign({logLevel:"info",path:"",publicPath:"",reduceInlineStyles:!0,pruneSource:!1,additionalStylesheets:[],allowRules:[]},i),this.logger=this.options.logger||lfe(this.options.logLevel)}readFile(i){let e=this.fs;return new Promise((n,o)=>{let r=(g,w)=>{g?o(g):n(w.toString())};e&&e.readFile?e.readFile(i,r):kde(i,"utf-8",r)})}process(i){return Go(this,null,function*(){let e=Date.now(),n=nfe(i);if(this.options.additionalStylesheets.length>0&&(yield this.embedAdditionalStylesheet(n)),this.options.external!==!1){let w=[...n.querySelectorAll('link[rel="stylesheet"]')];yield Promise.all(w.map(T=>this.embedLinkedStylesheet(T,n)))}let o=this.getAffectedStyleTags(n);for(let w of o)this.processStyle(w,n);this.options.mergeStylesheets!==!1&&o.length!==0&&this.mergeStylesheets(n);let r=rfe(n),g=Date.now();return this.logger.info?.(`Time ${g-e}ms`),r})}getAffectedStyleTags(i){let e=[...i.querySelectorAll("style")];return this.options.reduceInlineStyles===!1?e.filter(n=>n.$$external):e}mergeStylesheets(i){let e=this.getAffectedStyleTags(i);if(e.length===0){this.logger.warn?.("Merging inline stylesheets into a single <style> tag skipped, no inline stylesheets to merge");return}let n=e[0],o=n.textContent;for(let r=1;r<e.length;r++){let g=e[r];o+=g.textContent,g.remove()}n.textContent=o}getCssAsset(i,e){return Go(this,null,function*(){let n=this.options.path,o=this.options.publicPath,r=i.replace(/^\//,""),g=`${(o||"").replace(/(^\/|\/$)/g,"")}/`;if(r.startsWith(g)&&(r=r.substring(g.length).replace(/^\//,"")),/^https?:\/\//.test(r)||i.startsWith("//"))return;let w=ev.resolve(n,r);if(!cfe(n,w))return;let T;try{T=yield this.readFile(w)}catch{this.logger.warn?.(`Unable to locate stylesheet: ${w}`)}return T})}checkInlineThreshold(i,e,n){if(this.options.inlineThreshold&&n.length<this.options.inlineThreshold){let o=e.$$name;return e.$$reduce=!1,this.logger.info?.(`\x1B[32mInlined all of ${o} (${n.length} was below the threshold of ${this.options.inlineThreshold})\x1B[39m`),i.remove(),!0}return!1}embedAdditionalStylesheet(i){return Go(this,null,function*(){let e=[],n=yield Promise.all(this.options.additionalStylesheets.map(o=>{if(e.includes(o))return[];e.push(o);let r=i.createElement("style");return r.$$external=!0,this.getCssAsset(o,r).then(g=>[g,r])}));for(let[o,r]of n)o&&(r.textContent=o,i.head.appendChild(r))})}embedLinkedStylesheet(i,e){return Go(this,null,function*(){let n=i.getAttribute("href");if(!n?.endsWith(".css"))return;let o=e.createElement("style");o.$$external=!0;let r=yield this.getCssAsset(n,o);if(!r||(o.textContent=r,o.$$name=n,o.$$links=[i],i.parentNode?.insertBefore(o,i),this.checkInlineThreshold(i,o,r)))return;let g=i.getAttribute("media");g&&!tfe(g)&&(g=void 0);let w=this.options.preload,T="function $loadcss(u,m,l){(l=document.createElement('link')).rel='stylesheet';l.href=u;document.head.appendChild(l)}";if(w==="js-lazy"&&(T=T.replace("l.href","l.media='print';l.onload=function(){l.media=m};l.href")),w===!1)return;let N=!1,V=!1,q=i.cloneNode(!1);if(w==="body")e.body.appendChild(i);else if(w==="js"||w==="js-lazy"){let Z=e.createElement("script");Z.setAttribute("data-href",n),Z.setAttribute("data-media",g||"all");let X=`${T}$loadcss(document.currentScript.dataset.href,document.currentScript.dataset.media)`;Z.textContent=X,i.parentNode.insertBefore(Z,i.nextSibling),o.$$links.push(Z),T="",N=!0,V=!0}else if(w==="media")i.setAttribute("media","print"),i.setAttribute("onload",`this.media='${g||"all"}'`),N=!0;else if(w==="swap-high")i.setAttribute("rel","alternate stylesheet preload"),i.setAttribute("title","styles"),i.setAttribute("onload","this.title='';this.rel='stylesheet'"),N=!0;else if(w==="swap-low")i.setAttribute("rel","alternate stylesheet"),i.setAttribute("title","styles"),i.setAttribute("onload","this.title='';this.rel='stylesheet'"),N=!0;else if(w==="swap")i.setAttribute("onload","this.rel='stylesheet'"),V=!0,N=!0;else{let Z=i.cloneNode(!1);Z.removeAttribute("id"),e.body.appendChild(Z),o.$$links.push(Z),V=!0}if(this.options.noscriptFallback!==!1&&N&&!n.includes("</noscript>")){let Z=e.createElement("noscript");q.removeAttribute("id"),Z.appendChild(q),i.parentNode.insertBefore(Z,i.nextSibling),o.$$links.push(Z)}V&&(i.setAttribute("rel","preload"),i.setAttribute("as","style"))})}pruneSource(i,e,n){let o=this.options.minimumExternalSize,r=i.$$name,g=o&&n.length<o;if(g&&this.logger.info?.(`\x1B[32mInlined all of ${r} (non-critical external stylesheet would have been ${n.length}b, which was below the threshold of ${o})\x1B[39m`),(g||!n)&&(i.textContent=e,i.$$links))for(let w of i.$$links)w.parentNode?.removeChild(w);return!!g}processStyle(i,e){if(i.$$reduce===!1)return;let n=i.$$name?i.$$name.replace(/^\//,""):"inline CSS",o=this.options,r=e.beastiesContainer,g=o.keyframes??"critical";g===!0&&(g="all"),g===!1&&(g="none");let w=i.textContent,T=w;if(!w)return;let k=f$(w),N=o.pruneSource?f$(w):null,V="",q=[],Z=new Set,X=!1,te=!1,De=!1,_e=!1,he=o.fonts===!0||o.preloadFonts===!0,Ce=o.fonts!==!1&&o.inlineFonts===!0;nL(k,Kpe(ut=>{if(ut.type==="comment"){let We=ut.text.match(/^(?<!! )beasties:(.*)/),Pt=We&&We[1];if(Pt)switch(Pt){case"include":X=!0;break;case"exclude":De=!0;break;case"include start":te=!0;break;case"include end":te=!1;break;case"exclude start":_e=!0;break;case"exclude end":_e=!1;break}}if(ut.type==="rule"){if(X)return X=!1,!0;if(De)return De=!1,!1;if(te)return!0;if(_e||(ut.filterSelectors?.(We=>{if(o.allowRules.some(ui=>ui instanceof RegExp?ui.test(We):ui===We)||We===":root"||We==="html"||We==="body"||We[0]===":"&&/^::?(?:before|after)$/.test(We))return!0;if(We=this.normalizeCssSelector(We),!We)return!1;try{return r.exists(We)}catch(ui){return q.push(`${We} -> ${ui.message||ui.toString()}`),!1}}),!ut.selector))return!1;if(ut.nodes){for(let We of ut.nodes)if("prop"in We&&(Ce&&/\bfont(?:-family)?\b/i.test(We.prop)&&(V+=` ${We.value}`),We.prop==="animation"||We.prop==="animation-name"))for(let Pt of We.value.split(/\s+/)){let ui=Pt.trim();ui&&Z.add(ui)}}}return ut.type==="atrule"&&(ut.name==="font-face"||ut.name==="layer")?void 0:("nodes"in ut&&ut.nodes?.some(We=>!We.$$remove))??!0})),q.length!==0&&this.logger.warn?.(`${q.length} rules skipped due to selector errors:
  ${q.join(`
  `)}`);let Pe=new Set;if(cG(k,N,ut=>{if(ut.$$remove===!0)return!1;if("selectors"in ut&&lG(ut),ut.type==="atrule"&&ut.name==="keyframes")return g==="none"?!1:g==="all"?!0:Z.has(ut.params);if(ut.type==="atrule"&&ut.name==="font-face"){let ct,We;if(ut.nodes){for(let Pt of ut.nodes)"prop"in Pt&&(Pt.prop==="src"?We=(Pt.value.match(/url\s*\(\s*(['"]?)(.+?)\1\s*\)/)||[])[2]:Pt.prop==="font-family"&&(ct=Pt.value));if(We&&he&&!Pe.has(We)){Pe.add(We);let Pt=e.createElement("link");Pt.setAttribute("rel","preload"),Pt.setAttribute("as","font"),Pt.setAttribute("crossorigin","anonymous"),Pt.setAttribute("href",We.trim()),e.head.appendChild(Pt)}}if(!Ce||!ct||!We||!V.includes(ct))return!1}}),w=m$(k,{compress:this.options.compress!==!1}),w.trim().length===0){i.parentNode&&i.remove();return}let ye="",vt=!1;if(o.pruneSource){let ut=m$(N,{compress:this.options.compress!==!1});vt=this.pruneSource(i,T,ut),vt&&(ye=`, reducing non-inlined size ${ut.length/T.length*100|0}% to ${MN(ut.length)}`)}vt||(i.textContent=w);let Rt=w.length/T.length*100|0;this.logger.info?.(`\x1B[32mInlined ${MN(w.length)} (${Rt}% of original ${MN(T.length)}) of ${n}${ye}.\x1B[39m`)}normalizeCssSelector(i){let e=this.#e.get(i);return e!==void 0||(e=i.replace(ufe,"").replace(hfe,n=>n.includes("(")?"(":")").replace(dfe,"> *").trim(),this.#e.set(i,e)),e}};function MN(t){if(t<=0)return"0 bytes";let i=["bytes","kB","MB","GB"],e=Math.floor(Math.log(t)/Math.log(1024)),n=t/1024**e,o=e===0?0:2;return`${n.toFixed(o)} ${i[e]}`}var ED=class{manifest;constructor(i){this.manifest=i}getServerAsset(i){let e=this.manifest.assets[i];if(!e)throw new Error(`Server asset '${i}' does not exist.`);return e}hasServerAsset(i){return!!this.manifest.assets[i]}getIndexServerHtml(){return this.getServerAsset("index.server.html")}},pfe=new Set(["Angular is running in development mode."]),CD=class extends r0{log(i){pfe.has(i)||super.log(i)}},rL;function xG(t){rL=t}function wG(){if(!rL)throw new Error("Angular app manifest is not set. Please ensure you are using the '@angular/build:application' builder to build your server application.");return rL}function E0(t){return t.length>1&&t[0]==="/"?t.slice(1):t}function EG(t){return t[0]==="/"?t:`/${t}`}function ffe(t){return t[t.length-1]==="/"?t:`${t}/`}function C0(...t){let i=[];for(let e of t){if(e==="")continue;let n=e;e[0]==="/"&&(n=n.slice(1)),e[e.length-1]==="/"&&(n=n.slice(0,-1)),n!==""&&i.push(n)}return EG(i.join("/"))}function CG(t){if(t.pathname.endsWith("/index.html")){let i=new URL(t);return i.pathname=i.pathname.slice(0,-11),i}return t}function mfe(t,i){if(t[0]!=="/")throw new Error(`Invalid toPath: The string must start with a '/'. Received: '${t}'`);if(i[0]!=="/")throw new Error(`Invalid fromPath: The string must start with a '/'. Received: '${i}'`);if(!t.includes("/*"))return t;let e=i.split("/"),n=t.split("/"),o=n.map((r,g)=>n[g]==="*"?e[g]:r);return C0(...o)}function gfe(t,i,e,n,o){let r=[{provide:qP,useValue:o},{provide:r0,useFactory:()=>new CD},...n],g=CG(e).toString();return SG(i)?gq(i,{url:g,document:t,extraProviders:r}):_q(i,{url:g,document:t,platformProviders:r})}function SG(t){return"\u0275mod"in t}function TG(t,i,e){return new Promise((n,o)=>{let r=()=>{o(new DOMException(`${e} was aborted.
${i.reason}`,"AbortError"))};if(i.aborted){r();return}i.addEventListener("abort",r,{once:!0}),t.then(n).catch(o).finally(()=>{i.removeEventListener("abort",r)})})}var _fe="ng-app-shell",DG=function(t){return t[t.AppShell=0]="AppShell",t}(DG||{}),oa=function(t){return t[t.Server=0]="Server",t[t.Client=1]="Client",t[t.Prerender=2]="Prerender",t}(oa||{}),oL=function(t){return t[t.Server=0]="Server",t[t.Client=1]="Client",t[t.None=2]="None",t}(oL||{}),MG=new Ot("SERVER_ROUTES_CONFIG");function IG(t,...i){let e={routes:t};i.some(r=>r.\u0275kind===DG.AppShell)&&(e.appShellRoute=_fe);let o=[{provide:MG,useValue:e}];for(let r of i)o.push(...r.\u0275providers);return eu(o)}var uw=class t{root=this.createEmptyRouteTreeNode();insert(i,e){let n=this.root,o=this.getPathSegments(i),r=[];for(let g of o){let w=g[0]===":"?"*":g,T=n.children.get(w);T||(T=this.createEmptyRouteTreeNode(),n.children.set(w,T)),n=T,r.push(w)}n.metadata=ji(It({},e),{route:EG(r.join("/"))})}match(i){let e=this.getPathSegments(i);return this.traverseBySegments(e)?.metadata}toObject(){return Array.from(this.traverse())}static fromObject(i){let e=new t;for(let n of i){let o=n,{route:r}=o,g=Ys(o,["route"]);e.insert(r,g)}return e}*traverse(i=this.root){i.metadata&&(yield i.metadata);for(let e of i.children.values())yield*Mg(this.traverse(e))}getPathSegments(i){return i.split("/").filter(Boolean)}traverseBySegments(i,e=this.root,n=0){if(n>=i.length)return e.metadata?e:e.children.get("**");if(!e.children.size)return;let o=i[n],r=e.children.get(o);if(r){let w=this.traverseBySegments(i,r,n+1);if(w)return w}let g=e.children.get("*");if(g){let w=this.traverseBySegments(i,g,n+1);if(w)return w}return e.children.get("**")}createEmptyRouteTreeNode(){return{children:new Map}}},fG=10,mG=/\/(\*\*)$/,aL=/(?<!\\):([^/]+)/g,gG=new Set([301,302,303,307,308]);function _G(t){return OC(this,null,function*(){try{let{metadata:i,currentRoutePath:e,route:n,compiler:o,parentInjector:r,serverConfigRouteTree:g,entryPointToBrowserMapping:w,invokeGetPrerenderParams:T,includePrerenderFallbackRoutes:k}=t,{redirectTo:N,loadChildren:V,loadComponent:q,children:Z,\u0275entryName:X}=n;if(X&&q&&yG(X,w,i,!0),i.renderMode===oa.Prerender?yield*Mg(yfe(g,typeof N=="string"?N:void 0,i,r,T,k)):typeof N=="string"?i.status&&!gG.has(i.status)?yield{error:`The '${i.status}' status code is not a valid redirect response code. Please use one of the following redirect response codes: ${[...gG.values()].join(", ")}.`}:yield ji(It({},i),{redirectTo:lL(i.route,N)}):yield i,Z?.length&&(yield*Mg(sL(ji(It({},t),{routes:Z,parentRoute:e,parentPreloads:i.preload})))),V){X&&yG(X,w,i,!1);let te=yield new oR(UT(n,o,r).toPromise());if(te){let{routes:De,injector:_e=r}=te;yield*Mg(sL(ji(It({},t),{routes:De,parentInjector:_e,parentRoute:e,parentPreloads:i.preload})))}}}catch(i){yield{error:`Error in handleRoute for '${t.currentRoutePath}': ${i.message}`}}})}function sL(t){return OC(this,null,function*(){let{routes:i,parentPreloads:e,parentRoute:n,serverConfigRouteTree:o}=t;for(let r of i){let{matcher:g,path:w=g?"**":""}=r,T=C0(n,w);if(g&&o){let N=!1;for(let V of o.traverse())if(V.route.startsWith(T)){if(N=!0,V.presentInClientRouter=!0,V.renderMode===oa.Prerender){yield{error:`The route '${E0(T)}' is set for prerendering but has a defined matcher. Routes with matchers cannot use prerendering. Please specify a different 'renderMode'.`};continue}yield*Mg(_G(ji(It({},t),{currentRoutePath:T,route:r,metadata:ji(It({},V),{preload:e,route:V.route,presentInClientRouter:void 0})})))}N||(yield{error:`The route '${E0(T)}' has a defined matcher but does not match any route in the server routing configuration. Please ensure this route is added to the server routing configuration.`});continue}let k;if(o){if(k=o.match(T),!k){yield{error:`The '${E0(T)}' route does not match any route defined in the server routing configuration. Please ensure this route is added to the server routing configuration.`};continue}k.presentInClientRouter=!0}yield*Mg(_G(ji(It({},t),{metadata:ji(It({renderMode:oa.Prerender},k),{preload:e,route:w===""?ffe(T):T,presentInClientRouter:void 0}),currentRoutePath:T,route:r})))}})}function yG(t,i,e,n){let o=e.preload??[];if(!i||o.length>=fG)return;let r=i[t];if(!r?.length)return;let g=new Set(o);for(let{dynamicImport:w,path:T}of r)if(!(w&&!n)&&(g.add(T),g.size===fG))break;e.preload=Array.from(g)}function yfe(t,i,e,n,o,r){return OC(this,null,function*(){if(e.renderMode!==oa.Prerender)throw new Error("'handleSSGRoute' was called for a route which rendering mode is not prerender.");let V=e,{route:g,fallback:w}=V,T=Ys(V,["route","fallback"]),k="getPrerenderParams"in T?T.getPrerenderParams:void 0;"getPrerenderParams"in T&&delete T.getPrerenderParams,i!==void 0&&(T.redirectTo=lL(g,i));let N=mG.test(g);if(N&&!k||!N&&!aL.test(g)){yield ji(It({},T),{route:g});return}if(o){if(!k){yield{error:`The '${E0(g)}' route uses prerendering and includes parameters, but 'getPrerenderParams' is missing. Please define 'getPrerenderParams' function for this route in your server routing configuration or specify a different 'renderMode'.`};return}if(t){let Z=N?g:C0(g,"**"),X=t.match(Z);X&&X.renderMode===oa.Prerender&&!("getPrerenderParams"in X)&&t.insert(Z,ji(It({},X),{presentInClientRouter:!0,getPrerenderParams:k}))}let q=yield new oR(gl(n,()=>k()));try{for(let Z of q){let X=vfe(Z,g),te=g.replace(aL,X).replace(mG,X);yield ji(It({},T),{route:te,redirectTo:i===void 0?void 0:lL(te,i)})}}catch(Z){yield{error:`${Z.message}`};return}}r&&(w!==oL.None||!o)&&(yield ji(It({},T),{route:g,renderMode:w===oL.Client?oa.Client:oa.Server}))})}function vfe(t,i){return e=>{let n=e.slice(1),o=t[n];if(typeof o!="string")throw new Error(`The 'getPrerenderParams' function defined for the '${E0(i)}' route returned a non-string value for parameter '${n}'. Please make sure the 'getPrerenderParams' function returns values for all parameters specified in this route.`);return n==="**"?`/${o}`:o}}function lL(t,i){if(i[0]==="/")return i;let e=t.replace(aL,"*").split("/");return e.pop(),C0(...e,i)}function bfe({routes:t,appShellRoute:i}){let e=[...t];i!==void 0&&e.unshift({path:i,renderMode:oa.Prerender});let n=new uw,o=[];for(let r of e){let g=r,{path:w}=g,T=Ys(g,["path"]);if(w[0]==="/"){o.push(`Invalid '${w}' route configuration: the path cannot start with a slash.`);continue}if("getPrerenderParams"in T&&(w.includes("/*/")||w.endsWith("/*"))){o.push(`Invalid '${w}' route configuration: 'getPrerenderParams' cannot be used with a '*' route.`);continue}n.insert(w,T)}return{serverConfigRouteTree:n,errors:o}}function xfe(t,i,e,n=!1,o=!0,r=void 0){return Go(this,null,function*(){let{protocol:g,host:w}=e,T=XT([{provide:m0,useValue:{document:i,url:`${g}//${w}/`}},{provide:r0,useFactory:()=>new CD},{provide:DO,useValue:!1}]);try{let Z;SG(t)?Z=(yield T.bootstrapModule(t)).injector.get(ms):Z=yield t();let X=Z.injector,te=X.get($n);te.navigationTransitions.afterPreactivation()?.next?.(),yield Z.whenStable();let De=[],_e=X.get(Ny,null,{optional:!0})??X.get(Nh).getBaseHrefFromDOM(),{pathname:he}=new URL(_e,"http://localhost"),Ce=X.get(US),Pe=X.get(MG,null,{optional:!0}),ye;if(Pe){let Rt=bfe(Pe);ye=Rt.serverConfigRouteTree,De.push(...Rt.errors)}if(De.length)return{baseHref:he,routes:[],errors:De};let vt=[];if(te.config.length){let Rt=sL({routes:te.config,compiler:Ce,parentInjector:X,parentRoute:"",serverConfigRouteTree:ye,invokeGetPrerenderParams:n,includePrerenderFallbackRoutes:o,entryPointToBrowserMapping:r}),ut=new Set;try{for(var k=uz(Rt),N,V,q;N=!(V=yield k.next()).done;N=!1){let ct=V.value;if("error"in ct){De.push(ct.error);continue}let We=ct.route;ut.has(We)||(vt.push(ct),ut.add(We))}}catch{q=[V]}finally{try{N&&(V=k.return)&&(yield V.call(k))}finally{if(q)throw q[0]}}if(yield new Promise(ct=>setTimeout(ct,0)),ye)for(let{route:ct,presentInClientRouter:We}of ye.traverse())We||ct.endsWith("/**")||De.push(`The '${E0(ct)}' server route does not match any routes defined in the Angular routing configuration (typically provided as a part of the 'provideRouter' call). Please make sure that the mentioned server route is present in the Angular routing configuration.`)}else{let Rt=ye?.match("")??{route:"",renderMode:oa.Prerender};vt.push(ji(It({},Rt),{route:""}))}return{baseHref:he,routes:vt,errors:De,appShellRoute:Pe?.appShellRoute}}finally{T.destroy()}})}function AG(t){let{url:i,manifest:e=wG(),invokeGetPrerenderParams:n=!1,includePrerenderFallbackRoutes:o=!0,signal:r}=t;function g(){return Go(this,null,function*(){let w=new uw,T=yield new ED(e).getIndexServerHtml().text(),k=yield e.bootstrap(),{baseHref:N,appShellRoute:V,routes:q,errors:Z}=yield xfe(k,T,i,n,o,e.entryPointToBrowserMapping);for(let X of q){let te=X,{route:De}=te,_e=Ys(te,["route"]);_e.redirectTo!==void 0&&(_e.redirectTo=C0(N,_e.redirectTo));for(let[Ce,Pe]of Object.entries(_e))Pe===void 0&&delete _e[Ce];let he=C0(N,De);w.insert(he,_e)}return{appShellRoute:V,routeTree:w,errors:Z}})}return r?TG(g(),r,"Routes extraction"):g()}var cL=class{store=new Map;run(i,e){return Go(this,null,function*(){let n=this.store.get(i);switch(i){case"html:transform:pre":{if(!n)return e.html;let o=It({},e);for(let r of n)o.html=yield r(o);return o.html}default:throw new Error(`Running hook "${i}" is not supported.`)}})}on(i,e){let n=this.store.get(i);n?n.push(e):this.store.set(i,[e])}has(i){return!!this.store.get(i)?.length}},uL=class t{routeTree;constructor(i){this.routeTree=i}static#e;static from(i,e){if(i.routes){let n=uw.fromObject(i.routes);return Promise.resolve(new t(n))}return t.#e??=AG({url:e,manifest:i}).then(({routeTree:n,errors:o})=>{if(o.length>0)throw new Error(`Error(s) occurred while extracting routes:
`+o.map(r=>`- ${r}`).join(`
`));return new t(n)}).finally(()=>{t.#e=void 0}),t.#e}match(i){let{pathname:e}=CG(i);return this.routeTree.match(decodeURIComponent(e))}};function wfe(t){return Go(this,null,function*(){let i=new TextEncoder().encode(t),e=yield crypto.subtle.digest("SHA-256",i),n=[];for(let o of new Uint8Array(e))n.push(o.toString(16).padStart(2,"0"));return n.join("")})}var vG=/^this\.media=["'](.*)["'];?$/,RG="ngCspMedia",bG=`(() => {
  const CSP_MEDIA_ATTR = '${RG}';
  const documentElement = document.documentElement;

  // Listener for load events on link tags.
  const listener = (e) => {
    const target = e.target;
    if (
      !target ||
      target.tagName !== 'LINK' ||
      !target.hasAttribute(CSP_MEDIA_ATTR)
    ) {
      return;
    }

    target.media = target.getAttribute(CSP_MEDIA_ATTR);
    target.removeAttribute(CSP_MEDIA_ATTR);

    if (!document.head.querySelector(\`link[\${CSP_MEDIA_ATTR}]\`)) {
      documentElement.removeEventListener('load', listener);
    }
  };

  documentElement.addEventListener('load', listener, true);
})();`,dL=class extends pD{},hL=class t extends dL{readFile;outputPath;addedCspScriptsDocuments=new WeakSet;documentNonces=new WeakMap;constructor(i,e){super({logger:{warn:n=>console.warn(n),error:n=>console.error(n),info:()=>{}},logLevel:"warn",path:e,publicPath:void 0,compress:!1,pruneSource:!1,reduceInlineStyles:!1,mergeStylesheets:!1,preload:"media",noscriptFallback:!0,inlineFonts:!0}),this.readFile=i,this.outputPath=e}embedLinkedStylesheet(i,e){return Go(this,null,function*(){if(i.getAttribute("media")==="print"&&i.next?.name==="noscript"){let r=i.getAttribute("onload")?.match(vG);r&&(i.removeAttribute("onload"),i.setAttribute("media",r[1]),i?.next?.remove())}let n=yield cz(t.prototype,this,"embedLinkedStylesheet").call(this,i,e),o=this.findCspNonce(e);if(o){let r=i.getAttribute("onload")?.match(vG);r&&(i.removeAttribute("onload"),i.setAttribute(RG,r[1]),this.conditionallyInsertCspLoadingScript(e,o,i)),e.head.children.forEach(g=>{g.tagName==="style"&&!g.hasAttribute("nonce")&&g.setAttribute("nonce",o)})}return n})}findCspNonce(i){if(this.documentNonces.has(i))return this.documentNonces.get(i);let e=i.querySelector("[ngCspNonce], [ngcspnonce]"),n=e?.getAttribute("ngCspNonce")||e?.getAttribute("ngcspnonce")||null;return this.documentNonces.set(i,n),n}conditionallyInsertCspLoadingScript(i,e,n){if(this.addedCspScriptsDocuments.has(i))return;if(i.head.textContent.includes(bG)){this.addedCspScriptsDocuments.add(i);return}let o=i.createElement("script");o.setAttribute("nonce",e),o.textContent=bG,i.head.insertBefore(o,n),this.addedCspScriptsDocuments.add(i)}},pL=class{capacity;cache=new Map;head;tail;constructor(i){this.capacity=i}get(i){let e=this.cache.get(i);if(e)return this.moveToHead(e),e.value}put(i,e){let n=this.cache.get(i);if(n){n.value=e,this.moveToHead(n);return}let o={key:i,value:e,prev:void 0,next:void 0};if(this.cache.set(i,o),this.addToHead(o),this.cache.size>this.capacity){let r=this.removeTail();r&&this.cache.delete(r.key)}}addToHead(i){i.next=this.head,i.prev=void 0,this.head&&(this.head.prev=i),this.head=i,this.tail||(this.tail=i)}removeNode(i){i.prev?i.prev.next=i.next:this.head=i.next,i.next?i.next.prev=i.prev:this.tail=i.prev}moveToHead(i){this.removeNode(i),this.addToHead(i)}removeTail(){let i=this.tail;return i&&this.removeNode(i),i}},Efe=50,Cfe={[oa.Prerender]:"ssg",[oa.Server]:"ssr",[oa.Client]:""},fL=class{options;allowStaticRouteRender;hooks;constructor(i={}){this.options=i,this.allowStaticRouteRender=this.options.allowStaticRouteRender??!1,this.hooks=i.hooks??new cL}manifest=wG();assets=new ED(this.manifest);router;inlineCriticalCssProcessor;boostrap;criticalCssLRUCache=new pL(Efe);handle(i,e){return Go(this,null,function*(){let n=new URL(i.url);this.router??=yield uL.from(this.manifest,n);let o=this.router.match(n);if(!o)return null;let{redirectTo:r,status:g,renderMode:w}=o;if(r!==void 0)return new Response(null,{status:g??302,headers:{Location:mfe(r,n.pathname)}});if(w===oa.Prerender){let T=yield this.handleServe(i,o);if(T)return T}return TG(this.handleRendering(i,o,e),i.signal,`Request for: ${i.url}`)})}handleServe(i,e){return Go(this,null,function*(){let{headers:n,renderMode:o}=e;if(o!==oa.Prerender)return null;let{method:r}=i;if(r!=="GET"&&r!=="HEAD")return null;let g=this.buildServerAssetPathFromRequest(i),{manifest:{locale:w},assets:T}=this;if(!T.hasServerAsset(g))return null;let{text:k,hash:N,size:V}=T.getServerAsset(g),q=`"${N}"`;return i.headers.get("if-none-match")===q?new Response(void 0,{status:304,statusText:"Not Modified"}):new Response(yield k(),{headers:It(It({"Content-Length":V.toString(),ETag:q,"Content-Type":"text/html;charset=UTF-8"},w!==void 0?{"Content-Language":w}:{}),n)})})}handleRendering(i,e,n){return Go(this,null,function*(){let{renderMode:o,headers:r,status:g,preload:w}=e;if(!this.allowStaticRouteRender&&o===oa.Prerender)return null;let T=new URL(i.url),k=[],{manifest:{bootstrap:N,inlineCriticalCss:V,locale:q},assets:Z}=this,X={status:g,headers:new Headers(It(It({"Content-Type":"text/html;charset=UTF-8"},q!==void 0?{"Content-Language":q}:{}),r))};if(o===oa.Server)k.push({provide:Lj,useValue:i},{provide:zj,useValue:n},{provide:Fj,useValue:X});else if(o===oa.Client){let De=yield this.assets.getServerAsset("index.csr.html").text();return De=yield this.runTransformsOnHtml(De,T,w),new Response(De,X)}q!==void 0&&k.push({provide:om,useValue:q}),this.boostrap??=yield N();let te=yield Z.getIndexServerHtml().text();if(te=yield this.runTransformsOnHtml(te,T,w),te=yield gfe(te,this.boostrap,T,k,Cfe[o]),V)if(this.inlineCriticalCssProcessor??=new hL(De=>{let _e=De.split("/").pop()??De;return this.assets.getServerAsset(_e).text()}),o===oa.Server&&typeof crypto>"u"&&console.error("The global 'crypto' module is unavailable. If you are running on Node.js, please ensure you are using version 20 or later, which includes built-in support for the Web Crypto module."),o===oa.Server&&typeof crypto<"u"){let De=yield wfe(te),_e=this.criticalCssLRUCache.get(De);_e===void 0&&(_e=yield this.inlineCriticalCssProcessor.process(te),this.criticalCssLRUCache.put(De,_e)),te=_e}else te=yield this.inlineCriticalCssProcessor.process(te);return new Response(te,X)})}buildServerAssetPathFromRequest(i){let{pathname:e}=new URL(i.url);e.endsWith("/index.html")||(e=C0(e,"index.html"));let{baseHref:n}=this.manifest;return n.length>1&&e.startsWith(n)&&(e=e.slice(n.length)),E0(e)}runTransformsOnHtml(i,e,n){return Go(this,null,function*(){return this.hooks.has("html:transform:pre")&&(i=yield this.hooks.run("html:transform:pre",{html:i,url:e})),n?.length&&(i=Dfe(i,n)),i})}},kG;function Sfe(t){return kG??=new fL(t)}function Tfe(){kG=void 0}function Dfe(t,i){let e=t.lastIndexOf("</body>");return e===-1?t:[t.slice(0,e),...i.map(n=>`<link rel="modulepreload" href="${n}">`),t.slice(e)].join(`
`)}xG(Mfe);var es={mapboxToken:"pk.eyJ1IjoibWFya2F0IiwiYSI6ImNtN2o2eGcwZDAwcGsycG9pZzZ6cjhncTgifQ.f9qApUfu6cdG-w-gpjPOlQ",cloud_name:"dxospqsu0",api_key:"173283854338116",api_secret:"kTTNZ1yXBfEjGr1jm39FithfSwU",urlBack:"http://localhost:8080/api/v1"};var Bo=class t{constructor(i){this.http=i}apiUrl=es.urlBack;userNotificationService=_k(_m);currentUser=new to(null);currentUser$=this.currentUser.asObservable();authStatus=new to(!1);adminStatus=new to(!1);getAuthStatus(){return this.authStatus.asObservable()}getAdminStatus(){return this.adminStatus.asObservable()}updatePassword(i,e){return this.http.patch(`${this.apiUrl}/users/${i}/password`,e,{withCredentials:!0})}deleteUser(i){return this.http.delete(`${this.apiUrl}/users/${i}`,{withCredentials:!0})}login(i){return this.http.post(`${this.apiUrl}/auth/sessions`,{userName:i.email,password:i.password},{withCredentials:!0}).pipe(hr(()=>{this.authStatus.next(!0),this.checkIsAdmin().subscribe()}),hn(()=>!0),Br(e=>(this.authStatus.next(!1),this.adminStatus.next(!1),wa(()=>e))))}getCurrentUser(){return this.http.get(`${this.apiUrl}/users/me`,{withCredentials:!0}).pipe(hr(i=>{sessionStorage.setItem("lat",i.latitude.toString()),sessionStorage.setItem("lng",i.longitude.toString()),sessionStorage.setItem("radiusKm",i.notificationRadiusKm.toString()),this.authStatus.next(!0),this.currentUser.next(i)}),Br(i=>(this.authStatus.next(!1),wa(()=>i))))}isLoggedIn(){return this.getCurrentUser().pipe(hn(()=>!0),Br(()=>Ni(!1)))}logout(){return this.http.get(`${this.apiUrl}/auth/logout`,{withCredentials:!0}).pipe(hr(()=>{this.authStatus.next(!1),sessionStorage.removeItem("lat"),sessionStorage.removeItem("lng"),sessionStorage.removeItem("radiusKm")}),Br(i=>wa(()=>i)))}register(i){return this.http.post(`${this.apiUrl}/users`,i).pipe(hr(()=>console.log("Registro exitoso")),Br(e=>wa(()=>e)))}getMe(){return this.http.get(`${this.apiUrl}/users/me`,{withCredentials:!0})}updateUser(i,e){return this.http.put(`${this.apiUrl}/users/${i}`,e,{withCredentials:!0})}validateAccount(i){return this.http.patch(`${this.apiUrl}/auth/activations?code=${i}`,{},{responseType:"text"}).pipe(hr(()=>console.log("Validaci\xF3n de cuenta exitosa")),Br(e=>(console.error("Error al validar la cuenta",e),wa(()=>e))))}sendCodeAgain(i){return this.http.post(`${this.apiUrl}/auth/activations/${i}`,{}).pipe(hr(()=>console.log("C\xF3digo reenviado exitosamente")),Br(e=>(console.error("Error al reenviar el c\xF3digo",e),wa(()=>e))))}resendResetPasswordCode(i){return this.http.post(`${this.apiUrl}/auth/users/password-codes/${i}`,{}).pipe(hr(()=>console.log("C\xF3digo reenviado exitosamente")),Br(e=>(console.error("Error al reenviar el c\xF3digo",e),wa(()=>e))))}requestPasswordResetCode(i){return this.http.post(`${this.apiUrl}/auth/passwordCodes?email=${encodeURIComponent(i)}`,{}).pipe(hr(()=>console.log(`\u{1F501} C\xF3digo de recuperaci\xF3n enviado a ${i}`)),Br(e=>(console.error("\u274C Error al solicitar c\xF3digo de recuperaci\xF3n",e),wa(()=>e))))}resetPasswordWithCode(i){return this.http.patch(`${this.apiUrl}/auth/users/password`,i).pipe(hr(()=>console.log("\u{1F504} Contrase\xF1a restablecida con c\xF3digo")),Br(e=>(console.error("\u274C Error en resetPasswordWithCode",e),wa(()=>e))))}checkIsAdmin(){return this.http.get(`${this.apiUrl}/users/admin`,{withCredentials:!0,observe:"response"}).pipe(hn(i=>i.status===204),hr(i=>this.adminStatus.next(i)),Br(()=>(this.adminStatus.next(!1),Ni(!1))))}static \u0275fac=function(e){return new(e||t)(bi(Qa))};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})};var _m=class t{storageKey="app_notifications";zone=J(Oi);authService=J(Bo);eventSource=null;platformId=J(Ns);notificationsSubject=new to(this.loadFromStorage());notifications$=this.notificationsSubject.asObservable();constructor(){this.authService.getAuthStatus().subscribe(i=>{i?this.safeStart():(this.disconnect(),this.clearNotifications())})}safeStart(){if(Cc(this.platformId))try{this.disconnect(),this.requestNotificationPermission(),this.connectToSse()}catch(i){console.warn("No se pudo iniciar SSE de notificaciones:",i)}}connectToSse(){this.eventSource||!Cc(this.platformId)||(this.eventSource=new EventSource(`${es.urlBack}/notifications/subscribe`,{withCredentials:!0}),this.eventSource.addEventListener("new-notification",i=>{this.zone.run(()=>{let e=this.parseNotification(i.data);e&&(this.addNotification(e),this.showBrowserNotification(e))})}),this.eventSource.onerror=i=>{console.error("Error en conexi\xF3n SSE:",i),this.reconnect()})}reconnect(){this.disconnect(),Cc(this.platformId)&&setTimeout(()=>this.safeStart(),5e3)}disconnect(){this.eventSource&&(this.eventSource.close(),this.eventSource=null)}parseNotification(i){try{let e=JSON.parse(i);if(e?.title&&e?.message&&e?.reportId&&e?.type&&e?.createdAt)return{id:e.id||Date.now().toString(),title:e.title,message:e.message,reportId:e.reportId,type:e.type,createdAt:e.createdAt,read:!1}}catch(e){console.error("Error parsing notification:",e)}return null}addNotification(i){let e=[i,...this.notificationsSubject.value];this.notificationsSubject.next(e),this.saveToStorage(e)}loadFromStorage(){try{return Cc(this.platformId)?JSON.parse(localStorage.getItem(this.storageKey)||"[]"):(console.warn("localStorage no est\xE1 disponible"),[])}catch(i){return console.error("Error loading notifications from storage:",i),[]}}saveToStorage(i){try{Cc(this.platformId)&&localStorage.setItem(this.storageKey,JSON.stringify(i))}catch(e){console.error("Error saving notifications to storage:",e)}}requestNotificationPermission(){Cc(this.platformId)&&"Notification"in window&&Notification.permission!=="denied"&&Notification.requestPermission().then(i=>{i==="granted"&&console.log("Notification permission granted")})}showBrowserNotification(i){Notification.permission==="granted"&&new Notification(i.title,{body:i.message,icon:this.getNotificationIcon(i.type),data:{reportId:i.reportId}})}getNotificationIcon(i){return{NEW_REPORT:"map_marker.png",COMMENT:"comment.png",STATUS_CHANGE:"status-change.png"}[i]||"assets/icons/notification.png"}markAsRead(i){let e=this.notificationsSubject.value.map(n=>n.id===i?ji(It({},n),{read:!0}):n);this.notificationsSubject.next(e),this.saveToStorage(e)}clearNotifications(){this.notificationsSubject.next([]),Cc(this.platformId)&&localStorage.removeItem(this.storageKey)}ngOnDestroy(){this.disconnect()}static \u0275fac=function(e){return new(e||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})};function Afe(t,i){t&1&&(ae(0,"div",3),Oe(1," No tienes notificaciones "),se())}function Rfe(t,i){if(t&1){let e=zi();ae(0,"div",4),Nt("click",function(){let o=ri(e).$implicit,r=zt();return oi(r.markAsRead(o.id))}),ae(1,"div",5),jt(2,"img",6),se(),ae(3,"div",7)(4,"strong"),Oe(5),se(),ae(6,"small"),Oe(7),bc(8,"date"),se(),ae(9,"p"),Oe(10),se()()()}if(t&2){let e=i.$implicit,n=zt();Ji("unread",!e.read),Se(2),Xe("src",n.getIcon(e.type),n0),Se(3),En(e.title),Se(2),En(Oh(8,6,e.createdAt,"medium")),Se(3),En(e.message)}}var SD=class t{notificationService=J(_m);notifications$=this.notificationService.notifications$;markAsRead(i){this.notificationService.markAsRead(i)}getIcon(i){return this.notificationService.getNotificationIcon(i)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ai({type:t,selectors:[["app-notification-list"]],decls:5,vars:6,consts:[[1,"list"],["class","empty",4,"ngIf"],["class","item",3,"unread","click",4,"ngFor","ngForOf"],[1,"empty"],[1,"item",3,"click"],[1,"icon-container"],[1,"icon",3,"src"],[1,"content"]],template:function(e,n){if(e&1&&(ae(0,"div",0),Tt(1,Afe,2,0,"div",1),bc(2,"async"),Tt(3,Rfe,11,9,"div",2),bc(4,"async"),se()),e&2){let o;Se(),Xe("ngIf",((o=fx(2,2,n.notifications$))==null?null:o.length)===0),Se(2),Xe("ngForOf",fx(4,4,n.notifications$))}},dependencies:[Or,bl,Er,Ex,Ld],styles:[".list[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto;padding:8px}.item[_ngcontent-%COMP%]{display:flex;padding:12px;border-bottom:1px solid #eee;cursor:pointer;gap:12px}.item[_ngcontent-%COMP%]:last-child{border:none}.item.unread[_ngcontent-%COMP%]{background-color:#f8f9fe}.empty[_ngcontent-%COMP%]{padding:16px;color:#666;text-align:center}.icon-container[_ngcontent-%COMP%]{width:24px;height:24px}.icon[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain}.content[_ngcontent-%COMP%]{flex:1}small[_ngcontent-%COMP%]{display:block;color:#999;margin:4px 0;font-size:.8em}strong[_ngcontent-%COMP%]{font-size:.9em}p[_ngcontent-%COMP%]{margin:0;font-size:.85em;color:#555}"]})};var nv=class{_attachedHost;attach(i){return this._attachedHost=i,i.attach(this)}detach(){let i=this._attachedHost;i!=null&&(this._attachedHost=null,i.detach())}get isAttached(){return this._attachedHost!=null}setAttachedHost(i){this._attachedHost=i}},$l=class extends nv{component;viewContainerRef;injector;componentFactoryResolver;projectableNodes;constructor(i,e,n,o,r){super(),this.component=i,this.viewContainerRef=e,this.injector=n,this.projectableNodes=r}},jd=class extends nv{templateRef;viewContainerRef;context;injector;constructor(i,e,n,o){super(),this.templateRef=i,this.viewContainerRef=e,this.context=n,this.injector=o}get origin(){return this.templateRef.elementRef}attach(i,e=this.context){return this.context=e,super.attach(i)}detach(){return this.context=void 0,super.detach()}},TD=class extends nv{element;constructor(i){super(),this.element=i instanceof Qi?i.nativeElement:i}},Vp=class{_attachedPortal;_disposeFn;_isDisposed=!1;hasAttached(){return!!this._attachedPortal}attach(i){if(i instanceof $l)return this._attachedPortal=i,this.attachComponentPortal(i);if(i instanceof jd)return this._attachedPortal=i,this.attachTemplatePortal(i);if(this.attachDomPortal&&i instanceof TD)return this._attachedPortal=i,this.attachDomPortal(i)}attachDomPortal=null;detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(i){this._disposeFn=i}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}};var dw=class extends Vp{outletElement;_appRef;_defaultInjector;_document;constructor(i,e,n,o,r){super(),this.outletElement=i,this._appRef=n,this._defaultInjector=o,this._document=r}attachComponentPortal(i){let e;if(i.viewContainerRef){let n=i.injector||i.viewContainerRef.injector,o=n.get(Dp,null,{optional:!0})||void 0;e=i.viewContainerRef.createComponent(i.component,{index:i.viewContainerRef.length,injector:n,ngModuleRef:o,projectableNodes:i.projectableNodes||void 0}),this.setDisposeFn(()=>e.destroy())}else{let n=this._appRef,o=i.injector||this._defaultInjector||wn.NULL,r=o.get(Ea,n.injector);e=$S(i.component,{elementInjector:o,environmentInjector:r,projectableNodes:i.projectableNodes||void 0}),n.attachView(e.hostView),this.setDisposeFn(()=>{n.viewCount>0&&n.detachView(e.hostView),e.destroy()})}return this.outletElement.appendChild(this._getComponentRootNode(e)),this._attachedPortal=i,e}attachTemplatePortal(i){let e=i.viewContainerRef,n=e.createEmbeddedView(i.templateRef,i.context,{injector:i.injector});return n.rootNodes.forEach(o=>this.outletElement.appendChild(o)),n.detectChanges(),this.setDisposeFn(()=>{let o=e.indexOf(n);o!==-1&&e.remove(o)}),this._attachedPortal=i,n}attachDomPortal=i=>{let e=i.element;e.parentNode;let n=this._document.createComment("dom-portal");e.parentNode.insertBefore(n,e),this.outletElement.appendChild(e),this._attachedPortal=i,super.setDisposeFn(()=>{n.parentNode&&n.parentNode.replaceChild(e,n)})};dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(i){return i.hostView.rootNodes[0]}};var Vu=(()=>{class t extends Vp{_moduleRef=J(Dp,{optional:!0});_document=J(cn);_viewContainerRef=J(na);_isInitialized=!1;_attachedRef;constructor(){super()}get portal(){return this._attachedPortal}set portal(e){this.hasAttached()&&!e&&!this._isInitialized||(this.hasAttached()&&super.detach(),e&&super.attach(e),this._attachedPortal=e||null)}attached=new Mi;get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(e){e.setAttachedHost(this);let n=e.viewContainerRef!=null?e.viewContainerRef:this._viewContainerRef,o=n.createComponent(e.component,{index:n.length,injector:e.injector||n.injector,projectableNodes:e.projectableNodes||void 0,ngModuleRef:this._moduleRef||void 0});return n!==this._viewContainerRef&&this._getRootNode().appendChild(o.hostView.rootNodes[0]),super.setDisposeFn(()=>o.destroy()),this._attachedPortal=e,this._attachedRef=o,this.attached.emit(o),o}attachTemplatePortal(e){e.setAttachedHost(this);let n=this._viewContainerRef.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=e,this._attachedRef=n,this.attached.emit(n),n}attachDomPortal=e=>{let n=e.element;n.parentNode;let o=this._document.createComment("dom-portal");e.setAttachedHost(this),n.parentNode.insertBefore(o,n),this._getRootNode().appendChild(n),this._attachedPortal=e,super.setDisposeFn(()=>{o.parentNode&&o.parentNode.replaceChild(n,o)})};_getRootNode(){let e=this._viewContainerRef.element.nativeElement;return e.nodeType===e.ELEMENT_NODE?e:e.parentNode}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[0,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[Fn]})}return t})();var ju=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({})}return t})();function hw(t){return t.buttons===0||t.detail===0}function pw(t){let i=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0];return!!i&&i.identifier===-1&&(i.radiusX==null||i.radiusX===1)&&(i.radiusY==null||i.radiusY===1)}var mL;function OG(){if(mL==null){let t=typeof document<"u"?document.head:null;mL=!!(t&&(t.createShadowRoot||t.attachShadow))}return mL}function gL(t){if(OG()){let i=t.getRootNode?t.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&i instanceof ShadowRoot)return i}return null}function jp(){let t=typeof document<"u"&&document?document.activeElement:null;for(;t&&t.shadowRoot;){let i=t.shadowRoot.activeElement;if(i===t)break;t=i}return t}function Gl(t){return t.composedPath?t.composedPath()[0]:t.target}function Sa(t,i,e,n,o){let r=parseInt(CO.major),g=parseInt(CO.minor);return r>19||r===19&&g>0||r===0&&g===0?t.listen(i,e,n,o):(i.addEventListener(e,n,o),()=>{i.removeEventListener(e,n,o)})}var _L;try{_L=typeof Intl<"u"&&Intl.v8BreakIterator}catch{_L=!1}var Pr=(()=>{class t{_platformId=J(Ns);isBrowser=this._platformId?Cc(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||_L)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var fw;function PG(){if(fw==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>fw=!0}))}finally{fw=fw||!1}return fw}function ym(t){return PG()?t:!!t.capture}function Up(t,i=0){return NG(t)?Number(t):arguments.length===2?i:0}function NG(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}function ou(t){return t instanceof Qi?t.nativeElement:t}var LG=new Ot("cdk-input-modality-detector-options"),FG={ignoreKeys:[18,17,224,91,16]},zG=650,yL={passive:!0,capture:!0},BG=(()=>{class t{_platform=J(Pr);_listenerCleanups;modalityDetected;modalityChanged;get mostRecentModality(){return this._modality.value}_mostRecentTarget=null;_modality=new to(null);_options;_lastTouchMs=0;_onKeydown=e=>{this._options?.ignoreKeys?.some(n=>n===e.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Gl(e))};_onMousedown=e=>{Date.now()-this._lastTouchMs<zG||(this._modality.next(hw(e)?"keyboard":"mouse"),this._mostRecentTarget=Gl(e))};_onTouchstart=e=>{if(pw(e)){this._modality.next("keyboard");return}this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Gl(e)};constructor(){let e=J(Oi),n=J(cn),o=J(LG,{optional:!0});if(this._options=It(It({},FG),o),this.modalityDetected=this._modality.pipe(O1(1)),this.modalityChanged=this.modalityDetected.pipe(g2()),this._platform.isBrowser){let r=J(Fa).createRenderer(null,null);this._listenerCleanups=e.runOutsideAngular(()=>[Sa(r,n,"keydown",this._onKeydown,yL),Sa(r,n,"mousedown",this._onMousedown,yL),Sa(r,n,"touchstart",this._onTouchstart,yL)])}}ngOnDestroy(){this._modality.complete(),this._listenerCleanups?.forEach(e=>e())}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),mw=function(t){return t[t.IMMEDIATE=0]="IMMEDIATE",t[t.EVENTUAL=1]="EVENTUAL",t}(mw||{}),VG=new Ot("cdk-focus-monitor-default-options"),DD=ym({passive:!0,capture:!0}),Uu=(()=>{class t{_ngZone=J(Oi);_platform=J(Pr);_inputModalityDetector=J(BG);_origin=null;_lastFocusOrigin;_windowFocused=!1;_windowFocusTimeoutId;_originTimeoutId;_originFromTouchInteraction=!1;_elementInfo=new Map;_monitoredElementCount=0;_rootNodeFocusListenerCount=new Map;_detectionMode;_windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)};_document=J(cn,{optional:!0});_stopInputModalityDetector=new gi;constructor(){let e=J(VG,{optional:!0});this._detectionMode=e?.detectionMode||mw.IMMEDIATE}_rootNodeFocusAndBlurListener=e=>{let n=Gl(e);for(let o=n;o;o=o.parentElement)e.type==="focus"?this._onFocus(e,o):this._onBlur(e,o)};monitor(e,n=!1){let o=ou(e);if(!this._platform.isBrowser||o.nodeType!==1)return Ni();let r=gL(o)||this._getDocument(),g=this._elementInfo.get(o);if(g)return n&&(g.checkChildren=!0),g.subject;let w={checkChildren:n,subject:new gi,rootNode:r};return this._elementInfo.set(o,w),this._registerGlobalListeners(w),w.subject}stopMonitoring(e){let n=ou(e),o=this._elementInfo.get(n);o&&(o.subject.complete(),this._setClasses(n),this._elementInfo.delete(n),this._removeGlobalListeners(o))}focusVia(e,n,o){let r=ou(e),g=this._getDocument().activeElement;r===g?this._getClosestElementsInfo(r).forEach(([w,T])=>this._originChanged(w,n,T)):(this._setOrigin(n),typeof r.focus=="function"&&r.focus(o))}ngOnDestroy(){this._elementInfo.forEach((e,n)=>this.stopMonitoring(n))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:e&&this._isLastInteractionFromInputLabel(e)?"mouse":"program"}_shouldBeAttributedToTouch(e){return this._detectionMode===mw.EVENTUAL||!!e?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(e,n){e.classList.toggle("cdk-focused",!!n),e.classList.toggle("cdk-touch-focused",n==="touch"),e.classList.toggle("cdk-keyboard-focused",n==="keyboard"),e.classList.toggle("cdk-mouse-focused",n==="mouse"),e.classList.toggle("cdk-program-focused",n==="program")}_setOrigin(e,n=!1){this._ngZone.runOutsideAngular(()=>{if(this._origin=e,this._originFromTouchInteraction=e==="touch"&&n,this._detectionMode===mw.IMMEDIATE){clearTimeout(this._originTimeoutId);let o=this._originFromTouchInteraction?zG:1;this._originTimeoutId=setTimeout(()=>this._origin=null,o)}})}_onFocus(e,n){let o=this._elementInfo.get(n),r=Gl(e);!o||!o.checkChildren&&n!==r||this._originChanged(n,this._getFocusOrigin(r),o)}_onBlur(e,n){let o=this._elementInfo.get(n);!o||o.checkChildren&&e.relatedTarget instanceof Node&&n.contains(e.relatedTarget)||(this._setClasses(n),this._emitOrigin(o,null))}_emitOrigin(e,n){e.subject.observers.length&&this._ngZone.run(()=>e.subject.next(n))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;let n=e.rootNode,o=this._rootNodeFocusListenerCount.get(n)||0;o||this._ngZone.runOutsideAngular(()=>{n.addEventListener("focus",this._rootNodeFocusAndBlurListener,DD),n.addEventListener("blur",this._rootNodeFocusAndBlurListener,DD)}),this._rootNodeFocusListenerCount.set(n,o+1),++this._monitoredElementCount===1&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(_r(this._stopInputModalityDetector)).subscribe(r=>{this._setOrigin(r,!0)}))}_removeGlobalListeners(e){let n=e.rootNode;if(this._rootNodeFocusListenerCount.has(n)){let o=this._rootNodeFocusListenerCount.get(n);o>1?this._rootNodeFocusListenerCount.set(n,o-1):(n.removeEventListener("focus",this._rootNodeFocusAndBlurListener,DD),n.removeEventListener("blur",this._rootNodeFocusAndBlurListener,DD),this._rootNodeFocusListenerCount.delete(n))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,n,o){this._setClasses(e,n),this._emitOrigin(o,n),this._lastFocusOrigin=n}_getClosestElementsInfo(e){let n=[];return this._elementInfo.forEach((o,r)=>{(r===e||o.checkChildren&&r.contains(e))&&n.push([r,o])}),n}_isLastInteractionFromInputLabel(e){let{_mostRecentTarget:n,mostRecentModality:o}=this._inputModalityDetector;if(o!=="mouse"||!n||n===e||e.nodeName!=="INPUT"&&e.nodeName!=="TEXTAREA"||e.disabled)return!1;let r=e.labels;if(r){for(let g=0;g<r.length;g++)if(r[g].contains(n))return!0}return!1}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),vL=(()=>{class t{_elementRef=J(Qi);_focusMonitor=J(Uu);_monitorSubscription;_focusOrigin=null;cdkFocusChange=new Mi;constructor(){}get focusOrigin(){return this._focusOrigin}ngAfterViewInit(){let e=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(e,e.nodeType===1&&e.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(n=>{this._focusOrigin=n,this.cdkFocusChange.emit(n)})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"},exportAs:["cdkMonitorFocus"]})}return t})();var MD=new WeakMap,Vo=(()=>{class t{_appRef;_injector=J(wn);_environmentInjector=J(Ea);load(e){let n=this._appRef=this._appRef||this._injector.get(ms),o=MD.get(n);o||(o={loaders:new Set,refs:[]},MD.set(n,o),n.onDestroy(()=>{MD.get(n)?.refs.forEach(r=>r.destroy()),MD.delete(n)})),o.loaders.has(e)||(o.loaders.add(e),o.refs.push($S(e,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Hu=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["ng-component"]],exportAs:["cdkVisuallyHidden"],decls:0,vars:0,template:function(n,o){},styles:[`.cdk-visually-hidden{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap;outline:0;-webkit-appearance:none;-moz-appearance:none;left:0}[dir=rtl] .cdk-visually-hidden{left:auto;right:0}
`],encapsulation:2,changeDetection:0})}return t})();function rv(t){return Array.isArray(t)?t:[t]}var jG=new Set,S0,HG=(()=>{class t{_platform=J(Pr);_nonce=J(e0,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Ofe}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&kfe(e,this._nonce),this._matchMedia(e)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function kfe(t,i){if(!jG.has(t))try{S0||(S0=document.createElement("style"),i&&S0.setAttribute("nonce",i),S0.setAttribute("type","text/css"),document.head.appendChild(S0)),S0.sheet&&(S0.sheet.insertRule(`@media ${t} {body{ }}`,0),jG.add(t))}catch(e){console.error(e)}}function Ofe(t){return{matches:t==="all"||t==="",media:t,addListener:()=>{},removeListener:()=>{}}}var gw=(()=>{class t{_mediaMatcher=J(HG);_zone=J(Oi);_queries=new Map;_destroySubject=new gi;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return UG(rv(e)).some(o=>this._registerQuery(o).mql.matches)}observe(e){let o=UG(rv(e)).map(g=>this._registerQuery(g).observable),r=Ng(o);return r=jf(r.pipe(ta(1)),r.pipe(O1(1),R1(0))),r.pipe(hn(g=>{let w={matches:!1,breakpoints:{}};return g.forEach(({matches:T,query:k})=>{w.matches=w.matches||T,w.breakpoints[k]=T}),w}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);let n=this._mediaMatcher.matchMedia(e),r={observable:new wr(g=>{let w=T=>this._zone.run(()=>g.next(T));return n.addListener(w),()=>{n.removeListener(w)}}).pipe(ia(n),hn(({matches:g})=>({query:e,matches:g})),_r(this._destroySubject)),mql:n};return this._queries.set(e,r),r}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function UG(t){return t.map(i=>i.split(",")).reduce((i,e)=>i.concat(e)).map(i=>i.trim())}var Pfe=(()=>{class t{create(e){return typeof MutationObserver>"u"?null:new MutationObserver(e)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var ID=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({providers:[Pfe]})}return t})();var wL=(()=>{class t{_platform=J(Pr);constructor(){}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return Lfe(e)&&getComputedStyle(e).visibility==="visible"}isTabbable(e){if(!this._platform.isBrowser)return!1;let n=Nfe(qfe(e));if(n&&(qG(n)===-1||!this.isVisible(n)))return!1;let o=e.nodeName.toLowerCase(),r=qG(e);return e.hasAttribute("contenteditable")?r!==-1:o==="iframe"||o==="object"||this._platform.WEBKIT&&this._platform.IOS&&!Ufe(e)?!1:o==="audio"?e.hasAttribute("controls")?r!==-1:!1:o==="video"?r===-1?!1:r!==null?!0:this._platform.FIREFOX||e.hasAttribute("controls"):e.tabIndex>=0}isFocusable(e,n){return Hfe(e)&&!this.isDisabled(e)&&(n?.ignoreVisibility||this.isVisible(e))}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Nfe(t){try{return t.frameElement}catch{return null}}function Lfe(t){return!!(t.offsetWidth||t.offsetHeight||typeof t.getClientRects=="function"&&t.getClientRects().length)}function Ffe(t){let i=t.nodeName.toLowerCase();return i==="input"||i==="select"||i==="button"||i==="textarea"}function zfe(t){return Vfe(t)&&t.type=="hidden"}function Bfe(t){return jfe(t)&&t.hasAttribute("href")}function Vfe(t){return t.nodeName.toLowerCase()=="input"}function jfe(t){return t.nodeName.toLowerCase()=="a"}function WG(t){if(!t.hasAttribute("tabindex")||t.tabIndex===void 0)return!1;let i=t.getAttribute("tabindex");return!!(i&&!isNaN(parseInt(i,10)))}function qG(t){if(!WG(t))return null;let i=parseInt(t.getAttribute("tabindex")||"",10);return isNaN(i)?-1:i}function Ufe(t){let i=t.nodeName.toLowerCase(),e=i==="input"&&t.type;return e==="text"||e==="password"||i==="select"||i==="textarea"}function Hfe(t){return zfe(t)?!1:Ffe(t)||Bfe(t)||t.hasAttribute("contenteditable")||WG(t)}function qfe(t){return t.ownerDocument&&t.ownerDocument.defaultView||window}var xL=class{_element;_checker;_ngZone;_document;_injector;_startAnchor;_endAnchor;_hasAttached=!1;startAnchorListener=()=>this.focusLastTabbableElement();endAnchorListener=()=>this.focusFirstTabbableElement();get enabled(){return this._enabled}set enabled(i){this._enabled=i,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(i,this._startAnchor),this._toggleAnchorTabIndex(i,this._endAnchor))}_enabled=!0;constructor(i,e,n,o,r=!1,g){this._element=i,this._checker=e,this._ngZone=n,this._document=o,this._injector=g,r||this.attachAnchors()}destroy(){let i=this._startAnchor,e=this._endAnchor;i&&(i.removeEventListener("focus",this.startAnchorListener),i.remove()),e&&(e.removeEventListener("focus",this.endAnchorListener),e.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return this._hasAttached?!0:(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(i){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement(i)))})}focusFirstTabbableElementWhenReady(i){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement(i)))})}focusLastTabbableElementWhenReady(i){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement(i)))})}_getRegionBoundary(i){let e=this._element.querySelectorAll(`[cdk-focus-region-${i}], [cdkFocusRegion${i}], [cdk-focus-${i}]`);return i=="start"?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(i){let e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(e){if(!this._checker.isFocusable(e)){let n=this._getFirstTabbableElement(e);return n?.focus(i),!!n}return e.focus(i),!0}return this.focusFirstTabbableElement(i)}focusFirstTabbableElement(i){let e=this._getRegionBoundary("start");return e&&e.focus(i),!!e}focusLastTabbableElement(i){let e=this._getRegionBoundary("end");return e&&e.focus(i),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(i){if(this._checker.isFocusable(i)&&this._checker.isTabbable(i))return i;let e=i.children;for(let n=0;n<e.length;n++){let o=e[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[n]):null;if(o)return o}return null}_getLastTabbableElement(i){if(this._checker.isFocusable(i)&&this._checker.isTabbable(i))return i;let e=i.children;for(let n=e.length-1;n>=0;n--){let o=e[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[n]):null;if(o)return o}return null}_createAnchor(){let i=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,i),i.classList.add("cdk-visually-hidden"),i.classList.add("cdk-focus-trap-anchor"),i.setAttribute("aria-hidden","true"),i}_toggleAnchorTabIndex(i,e){i?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(i){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(i,this._startAnchor),this._toggleAnchorTabIndex(i,this._endAnchor))}_executeOnStable(i){this._injector?_s(i,{injector:this._injector}):setTimeout(i)}},AD=(()=>{class t{_checker=J(wL);_ngZone=J(Oi);_document=J(cn);_injector=J(wn);constructor(){J(Vo).load(Hu)}create(e,n=!1){return new xL(e,this._checker,this._ngZone,this._document,n,this._injector)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),EL=(()=>{class t{_elementRef=J(Qi);_focusTrapFactory=J(AD);focusTrap;_previouslyFocusedElement=null;get enabled(){return this.focusTrap?.enabled||!1}set enabled(e){this.focusTrap&&(this.focusTrap.enabled=e)}autoCapture;constructor(){J(Pr).isBrowser&&(this.focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement,!0))}ngOnDestroy(){this.focusTrap?.destroy(),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null)}ngAfterContentInit(){this.focusTrap?.attachAnchors(),this.autoCapture&&this._captureFocus()}ngDoCheck(){this.focusTrap&&!this.focusTrap.hasAttached()&&this.focusTrap.attachAnchors()}ngOnChanges(e){let n=e.autoCapture;n&&!n.firstChange&&this.autoCapture&&this.focusTrap?.hasAttached()&&this._captureFocus()}_captureFocus(){this._previouslyFocusedElement=jp(),this.focusTrap?.focusInitialElementWhenReady()}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","cdkTrapFocus",""]],inputs:{enabled:[2,"cdkTrapFocus","enabled",Bi],autoCapture:[2,"cdkTrapFocusAutoCapture","autoCapture",Bi]},exportAs:["cdkTrapFocus"],features:[$r]})}return t})(),ZG=new Ot("liveAnnouncerElement",{providedIn:"root",factory:YG});function YG(){return null}var KG=new Ot("LIVE_ANNOUNCER_DEFAULT_OPTIONS"),$fe=0,_w=(()=>{class t{_ngZone=J(Oi);_defaultOptions=J(KG,{optional:!0});_liveElement;_document=J(cn);_previousTimeout;_currentPromise;_currentResolve;constructor(){let e=J(ZG,{optional:!0});this._liveElement=e||this._createLiveElement()}announce(e,...n){let o=this._defaultOptions,r,g;return n.length===1&&typeof n[0]=="number"?g=n[0]:[r,g]=n,this.clear(),clearTimeout(this._previousTimeout),r||(r=o&&o.politeness?o.politeness:"polite"),g==null&&o&&(g=o.duration),this._liveElement.setAttribute("aria-live",r),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(w=>this._currentResolve=w)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=e,typeof g=="number"&&(this._previousTimeout=setTimeout(()=>this.clear(),g)),this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){let e="cdk-live-announcer-element",n=this._document.getElementsByClassName(e),o=this._document.createElement("div");for(let r=0;r<n.length;r++)n[r].remove();return o.classList.add(e),o.classList.add("cdk-visually-hidden"),o.setAttribute("aria-atomic","true"),o.setAttribute("aria-live","polite"),o.id=`cdk-live-announcer-${$fe++}`,this._document.body.appendChild(o),o}_exposeAnnouncerToModals(e){let n=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let o=0;o<n.length;o++){let r=n[o],g=r.getAttribute("aria-owns");g?g.indexOf(e)===-1&&r.setAttribute("aria-owns",g+" "+e):r.setAttribute("aria-owns",e)}}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var vm=function(t){return t[t.NONE=0]="NONE",t[t.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",t[t.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",t}(vm||{}),$G="cdk-high-contrast-black-on-white",GG="cdk-high-contrast-white-on-black",bL="cdk-high-contrast-active",RD=(()=>{class t{_platform=J(Pr);_hasCheckedHighContrastMode;_document=J(cn);_breakpointSubscription;constructor(){this._breakpointSubscription=J(gw).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return vm.NONE;let e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);let n=this._document.defaultView||window,o=n&&n.getComputedStyle?n.getComputedStyle(e):null,r=(o&&o.backgroundColor||"").replace(/ /g,"");switch(e.remove(),r){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return vm.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return vm.BLACK_ON_WHITE}return vm.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let e=this._document.body.classList;e.remove(bL,$G,GG),this._hasCheckedHighContrastMode=!0;let n=this.getHighContrastMode();n===vm.BLACK_ON_WHITE?e.add(bL,$G):n===vm.WHITE_ON_BLACK&&e.add(bL,GG)}}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),T0=(()=>{class t{constructor(){J(RD)._applyBodyHighContrastModeCssClasses()}static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({imports:[ID]})}return t})();function CL(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function ja(t){return t==null?"":typeof t=="string"?t:`${t}px`}var Gfe=new Ot("cdk-dir-doc",{providedIn:"root",factory:Wfe});function Wfe(){return J(cn)}var Zfe=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function XG(t){let i=t?.toLowerCase()||"";return i==="auto"&&typeof navigator<"u"&&navigator?.language?Zfe.test(navigator.language)?"rtl":"ltr":i==="rtl"?"rtl":"ltr"}var aa=(()=>{class t{value="ltr";change=new Mi;constructor(){let e=J(Gfe,{optional:!0});if(e){let n=e.body?e.body.dir:null,o=e.documentElement?e.documentElement.dir:null;this.value=XG(n||o||"ltr")}}ngOnDestroy(){this.change.complete()}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Ud=function(t){return t[t.NORMAL=0]="NORMAL",t[t.NEGATED=1]="NEGATED",t[t.INVERTED=2]="INVERTED",t}(Ud||{}),kD,D0;function OD(){if(D0==null){if(typeof document!="object"||!document||typeof Element!="function"||!Element)return D0=!1,D0;if("scrollBehavior"in document.documentElement.style)D0=!0;else{let t=Element.prototype.scrollTo;t?D0=!/\{\s*\[native code\]\s*\}/.test(t.toString()):D0=!1}}return D0}function ov(){if(typeof document!="object"||!document)return Ud.NORMAL;if(kD==null){let t=document.createElement("div"),i=t.style;t.dir="rtl",i.width="1px",i.overflow="auto",i.visibility="hidden",i.pointerEvents="none",i.position="absolute";let e=document.createElement("div"),n=e.style;n.width="2px",n.height="1px",t.appendChild(e),document.body.appendChild(t),kD=Ud.NORMAL,t.scrollLeft===0&&(t.scrollLeft=1,kD=t.scrollLeft===0?Ud.NEGATED:Ud.INVERTED),t.remove()}return kD}var bm=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({})}return t})();function PD(t){return t&&typeof t.connect=="function"&&!(t instanceof Bf)}var xm=function(t){return t[t.REPLACED=0]="REPLACED",t[t.INSERTED=1]="INSERTED",t[t.MOVED=2]="MOVED",t[t.REMOVED=3]="REMOVED",t}(xm||{}),av=new Ot("_ViewRepeater");var Yfe=20,sv=(()=>{class t{_ngZone=J(Oi);_platform=J(Pr);_renderer=J(Fa).createRenderer(null,null);_cleanupGlobalListener;constructor(){}_scrolled=new gi;_scrolledCount=0;scrollContainers=new Map;register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){let n=this.scrollContainers.get(e);n&&(n.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=Yfe){return this._platform.isBrowser?new wr(n=>{this._cleanupGlobalListener||(this._cleanupGlobalListener=this._ngZone.runOutsideAngular(()=>this._renderer.listen("document","scroll",()=>this._scrolled.next())));let o=e>0?this._scrolled.pipe(m2(e)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{o.unsubscribe(),this._scrolledCount--,this._scrolledCount||(this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0)}}):Ni()}ngOnDestroy(){this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0,this.scrollContainers.forEach((e,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(e,n){let o=this.getAncestorScrollContainers(e);return this.scrolled(n).pipe(zr(r=>!r||o.indexOf(r)>-1))}getAncestorScrollContainers(e){let n=[];return this.scrollContainers.forEach((o,r)=>{this._scrollableContainsElement(r,e)&&n.push(r)}),n}_scrollableContainsElement(e,n){let o=ou(n),r=e.getElementRef().nativeElement;do if(o==r)return!0;while(o=o.parentElement);return!1}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),SL=(()=>{class t{elementRef=J(Qi);scrollDispatcher=J(sv);ngZone=J(Oi);dir=J(aa,{optional:!0});_scrollElement=this.elementRef.nativeElement;_destroyed=new gi;_renderer=J(Ko);_cleanupScroll;_elementScrolled=new gi;constructor(){}ngOnInit(){this._cleanupScroll=this.ngZone.runOutsideAngular(()=>this._renderer.listen(this._scrollElement,"scroll",e=>this._elementScrolled.next(e))),this.scrollDispatcher.register(this)}ngOnDestroy(){this._cleanupScroll?.(),this._elementScrolled.complete(),this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(e){let n=this.elementRef.nativeElement,o=this.dir&&this.dir.value=="rtl";e.left==null&&(e.left=o?e.end:e.start),e.right==null&&(e.right=o?e.start:e.end),e.bottom!=null&&(e.top=n.scrollHeight-n.clientHeight-e.bottom),o&&ov()!=Ud.NORMAL?(e.left!=null&&(e.right=n.scrollWidth-n.clientWidth-e.left),ov()==Ud.INVERTED?e.left=e.right:ov()==Ud.NEGATED&&(e.left=e.right?-e.right:e.right)):e.right!=null&&(e.left=n.scrollWidth-n.clientWidth-e.right),this._applyScrollToOptions(e)}_applyScrollToOptions(e){let n=this.elementRef.nativeElement;OD()?n.scrollTo(e):(e.top!=null&&(n.scrollTop=e.top),e.left!=null&&(n.scrollLeft=e.left))}measureScrollOffset(e){let n="left",o="right",r=this.elementRef.nativeElement;if(e=="top")return r.scrollTop;if(e=="bottom")return r.scrollHeight-r.clientHeight-r.scrollTop;let g=this.dir&&this.dir.value=="rtl";return e=="start"?e=g?o:n:e=="end"&&(e=g?n:o),g&&ov()==Ud.INVERTED?e==n?r.scrollWidth-r.clientWidth-r.scrollLeft:r.scrollLeft:g&&ov()==Ud.NEGATED?e==n?r.scrollLeft+r.scrollWidth-r.clientWidth:-r.scrollLeft:e==n?r.scrollLeft:r.scrollWidth-r.clientWidth-r.scrollLeft}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]})}return t})(),Kfe=20,wm=(()=>{class t{_platform=J(Pr);_listeners;_viewportSize;_change=new gi;_document=J(cn,{optional:!0});constructor(){let e=J(Oi),n=J(Fa).createRenderer(null,null);e.runOutsideAngular(()=>{if(this._platform.isBrowser){let o=r=>this._change.next(r);this._listeners=[n.listen("window","resize",o),n.listen("window","orientationchange",o)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(e=>e()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){let e=this.getViewportScrollPosition(),{width:n,height:o}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+o,right:e.left+n,height:o,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let e=this._document,n=this._getWindow(),o=e.documentElement,r=o.getBoundingClientRect(),g=-r.top||e.body.scrollTop||n.scrollY||o.scrollTop||0,w=-r.left||e.body.scrollLeft||n.scrollX||o.scrollLeft||0;return{top:g,left:w}}change(e=Kfe){return e>0?this._change.pipe(m2(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Hp=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({})}return t})(),yw=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({imports:[bm,Hp,bm,Hp]})}return t})();var TL={},po=(()=>{class t{_appId=J(Ou);getId(e){return this._appId!=="ng"&&(e+=this._appId),TL.hasOwnProperty(e)||(TL[e]=0),`${e}${TL[e]++}`}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function ga(t,...i){return i.length?i.some(e=>t[e]):t.altKey||t.shiftKey||t.ctrlKey||t.metaKey}var QG=OD(),ND=class{_viewportRuler;_previousHTMLStyles={top:"",left:""};_previousScrollPosition;_isEnabled=!1;_document;constructor(i,e){this._viewportRuler=i,this._document=e}attach(){}enable(){if(this._canBeEnabled()){let i=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=i.style.left||"",this._previousHTMLStyles.top=i.style.top||"",i.style.left=ja(-this._previousScrollPosition.left),i.style.top=ja(-this._previousScrollPosition.top),i.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){let i=this._document.documentElement,e=this._document.body,n=i.style,o=e.style,r=n.scrollBehavior||"",g=o.scrollBehavior||"";this._isEnabled=!1,n.left=this._previousHTMLStyles.left,n.top=this._previousHTMLStyles.top,i.classList.remove("cdk-global-scrollblock"),QG&&(n.scrollBehavior=o.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),QG&&(n.scrollBehavior=r,o.scrollBehavior=g)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;let e=this._document.documentElement,n=this._viewportRuler.getViewportSize();return e.scrollHeight>n.height||e.scrollWidth>n.width}};var LD=class{_scrollDispatcher;_ngZone;_viewportRuler;_config;_scrollSubscription=null;_overlayRef;_initialScrollPosition;constructor(i,e,n,o){this._scrollDispatcher=i,this._ngZone=e,this._viewportRuler=n,this._config=o}attach(i){this._overlayRef,this._overlayRef=i}enable(){if(this._scrollSubscription)return;let i=this._scrollDispatcher.scrolled(0).pipe(zr(e=>!e||!this._overlayRef.overlayElement.contains(e.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=i.subscribe(()=>{let e=this._viewportRuler.getViewportScrollPosition().top;Math.abs(e-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=i.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}_detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}},vw=class{enable(){}disable(){}attach(){}};function DL(t,i){return i.some(e=>{let n=t.bottom<e.top,o=t.top>e.bottom,r=t.right<e.left,g=t.left>e.right;return n||o||r||g})}function JG(t,i){return i.some(e=>{let n=t.top<e.top,o=t.bottom>e.bottom,r=t.left<e.left,g=t.right>e.right;return n||o||r||g})}var FD=class{_scrollDispatcher;_viewportRuler;_ngZone;_config;_scrollSubscription=null;_overlayRef;constructor(i,e,n,o){this._scrollDispatcher=i,this._viewportRuler=e,this._ngZone=n,this._config=o}attach(i){this._overlayRef,this._overlayRef=i}enable(){if(!this._scrollSubscription){let i=this._config?this._config.scrollThrottle:0;this._scrollSubscription=this._scrollDispatcher.scrolled(i).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){let e=this._overlayRef.overlayElement.getBoundingClientRect(),{width:n,height:o}=this._viewportRuler.getViewportSize();DL(e,[{width:n,height:o,bottom:o,right:n,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}})}}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},oW=(()=>{class t{_scrollDispatcher=J(sv);_viewportRuler=J(wm);_ngZone=J(Oi);_document=J(cn);constructor(){}noop=()=>new vw;close=e=>new LD(this._scrollDispatcher,this._ngZone,this._viewportRuler,e);block=()=>new ND(this._viewportRuler,this._document);reposition=e=>new FD(this._scrollDispatcher,this._viewportRuler,this._ngZone,e);static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Hd=class{positionStrategy;scrollStrategy=new vw;panelClass="";hasBackdrop=!1;backdropClass="cdk-overlay-dark-backdrop";width;height;minWidth;minHeight;maxWidth;maxHeight;direction;disposeOnNavigation=!1;constructor(i){if(i){let e=Object.keys(i);for(let n of e)i[n]!==void 0&&(this[n]=i[n])}}};var zD=class{connectionPair;scrollableViewProperties;constructor(i,e){this.connectionPair=i,this.scrollableViewProperties=e}};var aW=(()=>{class t{_attachedOverlays=[];_document=J(cn);_isAttached;constructor(){}ngOnDestroy(){this.detach()}add(e){this.remove(e),this._attachedOverlays.push(e)}remove(e){let n=this._attachedOverlays.indexOf(e);n>-1&&this._attachedOverlays.splice(n,1),this._attachedOverlays.length===0&&this.detach()}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),sW=(()=>{class t extends aW{_ngZone=J(Oi);_renderer=J(Fa).createRenderer(null,null);_cleanupKeydown;add(e){super.add(e),this._isAttached||(this._ngZone.runOutsideAngular(()=>{this._cleanupKeydown=this._renderer.listen("body","keydown",this._keydownListener)}),this._isAttached=!0)}detach(){this._isAttached&&(this._cleanupKeydown?.(),this._isAttached=!1)}_keydownListener=e=>{let n=this._attachedOverlays;for(let o=n.length-1;o>-1;o--)if(n[o]._keydownEvents.observers.length>0){this._ngZone.run(()=>n[o]._keydownEvents.next(e));break}};static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),lW=(()=>{class t extends aW{_platform=J(Pr);_ngZone=J(Oi);_renderer=J(Fa).createRenderer(null,null);_cursorOriginalValue;_cursorStyleIsSet=!1;_pointerDownEventTarget;_cleanups;add(e){if(super.add(e),!this._isAttached){let n=this._document.body,o={capture:!0};this._cleanups=this._ngZone.runOutsideAngular(()=>[Sa(this._renderer,n,"pointerdown",this._pointerDownListener,o),Sa(this._renderer,n,"click",this._clickListener,o),Sa(this._renderer,n,"auxclick",this._clickListener,o),Sa(this._renderer,n,"contextmenu",this._clickListener,o)]),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=n.style.cursor,n.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){this._isAttached&&(this._cleanups?.forEach(e=>e()),this._cleanups=void 0,this._platform.IOS&&this._cursorStyleIsSet&&(this._document.body.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1)}_pointerDownListener=e=>{this._pointerDownEventTarget=Gl(e)};_clickListener=e=>{let n=Gl(e),o=e.type==="click"&&this._pointerDownEventTarget?this._pointerDownEventTarget:n;this._pointerDownEventTarget=null;let r=this._attachedOverlays.slice();for(let g=r.length-1;g>-1;g--){let w=r[g];if(w._outsidePointerEvents.observers.length<1||!w.hasAttached())continue;if(eW(w.overlayElement,n)||eW(w.overlayElement,o))break;let T=w._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>T.next(e)):T.next(e)}};static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function eW(t,i){let e=typeof ShadowRoot<"u"&&ShadowRoot,n=i;for(;n;){if(n===t)return!0;n=e&&n instanceof ShadowRoot?n.host:n.parentNode}return!1}var cW=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["ng-component"]],hostAttrs:["cdk-overlay-style-loader",""],decls:0,vars:0,template:function(n,o){},styles:[`.cdk-overlay-container,.cdk-global-overlay-wrapper{pointer-events:none;top:0;left:0;height:100%;width:100%}.cdk-overlay-container{position:fixed}@layer cdk-overlay{.cdk-overlay-container{z-index:1000}}.cdk-overlay-container:empty{display:none}.cdk-global-overlay-wrapper{display:flex;position:absolute}@layer cdk-overlay{.cdk-global-overlay-wrapper{z-index:1000}}.cdk-overlay-pane{position:absolute;pointer-events:auto;box-sizing:border-box;display:flex;max-width:100%;max-height:100%}@layer cdk-overlay{.cdk-overlay-pane{z-index:1000}}.cdk-overlay-backdrop{position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:auto;-webkit-tap-highlight-color:rgba(0,0,0,0);opacity:0}@layer cdk-overlay{.cdk-overlay-backdrop{z-index:1000;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}}@media(prefers-reduced-motion){.cdk-overlay-backdrop{transition-duration:1ms}}.cdk-overlay-backdrop-showing{opacity:1}@media(forced-colors: active){.cdk-overlay-backdrop-showing{opacity:.6}}@layer cdk-overlay{.cdk-overlay-dark-backdrop{background:rgba(0,0,0,.32)}}.cdk-overlay-transparent-backdrop{transition:visibility 1ms linear,opacity 1ms linear;visibility:hidden;opacity:1}.cdk-overlay-transparent-backdrop.cdk-overlay-backdrop-showing,.cdk-high-contrast-active .cdk-overlay-transparent-backdrop{opacity:0;visibility:visible}.cdk-overlay-backdrop-noop-animation{transition:none}.cdk-overlay-connected-position-bounding-box{position:absolute;display:flex;flex-direction:column;min-width:1px;min-height:1px}@layer cdk-overlay{.cdk-overlay-connected-position-bounding-box{z-index:1000}}.cdk-global-scrollblock{position:fixed;width:100%;overflow-y:scroll}
`],encapsulation:2,changeDetection:0})}return t})(),VD=(()=>{class t{_platform=J(Pr);_containerElement;_document=J(cn);_styleLoader=J(Vo);constructor(){}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._loadStyles(),this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let e="cdk-overlay-container";if(this._platform.isBrowser||CL()){let o=this._document.querySelectorAll(`.${e}[platform="server"], .${e}[platform="test"]`);for(let r=0;r<o.length;r++)o[r].remove()}let n=this._document.createElement("div");n.classList.add(e),CL()?n.setAttribute("platform","test"):this._platform.isBrowser||n.setAttribute("platform","server"),this._document.body.appendChild(n),this._containerElement=n}_loadStyles(){this._styleLoader.load(cW)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),ML=class{_renderer;_ngZone;element;_cleanupClick;_cleanupTransitionEnd;_fallbackTimeout;constructor(i,e,n,o){this._renderer=e,this._ngZone=n,this.element=i.createElement("div"),this.element.classList.add("cdk-overlay-backdrop"),this._cleanupClick=e.listen(this.element,"click",o)}detach(){this._ngZone.runOutsideAngular(()=>{let i=this.element;clearTimeout(this._fallbackTimeout),this._cleanupTransitionEnd?.(),this._cleanupTransitionEnd=this._renderer.listen(i,"transitionend",this.dispose),this._fallbackTimeout=setTimeout(this.dispose,500),i.style.pointerEvents="none",i.classList.remove("cdk-overlay-backdrop-showing")})}dispose=()=>{clearTimeout(this._fallbackTimeout),this._cleanupClick?.(),this._cleanupTransitionEnd?.(),this._cleanupClick=this._cleanupTransitionEnd=this._fallbackTimeout=void 0,this.element.remove()}},I0=class{_portalOutlet;_host;_pane;_config;_ngZone;_keyboardDispatcher;_document;_location;_outsideClickDispatcher;_animationsDisabled;_injector;_renderer;_backdropClick=new gi;_attachments=new gi;_detachments=new gi;_positionStrategy;_scrollStrategy;_locationChanges=nr.EMPTY;_backdropRef=null;_previousHostParent;_keydownEvents=new gi;_outsidePointerEvents=new gi;_renders=new gi;_afterRenderRef;_afterNextRenderRef;constructor(i,e,n,o,r,g,w,T,k,N=!1,V,q){this._portalOutlet=i,this._host=e,this._pane=n,this._config=o,this._ngZone=r,this._keyboardDispatcher=g,this._document=w,this._location=T,this._outsideClickDispatcher=k,this._animationsDisabled=N,this._injector=V,this._renderer=q,o.scrollStrategy&&(this._scrollStrategy=o.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=o.positionStrategy,this._afterRenderRef=xc(()=>i0(()=>{this._renders.next()},{injector:this._injector}))}get overlayElement(){return this._pane}get backdropElement(){return this._backdropRef?.element||null}get hostElement(){return this._host}attach(i){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);let e=this._portalOutlet.attach(i);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._afterNextRenderRef?.destroy(),this._afterNextRenderRef=_s(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),typeof e?.onDestroy=="function"&&e.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();let i=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),i}dispose(){let i=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._backdropRef?.dispose(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._afterNextRenderRef?.destroy(),this._previousHostParent=this._pane=this._host=this._backdropRef=null,i&&this._detachments.next(),this._detachments.complete(),this._afterRenderRef.destroy(),this._renders.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(i){i!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=i,this.hasAttached()&&(i.attach(this),this.updatePosition()))}updateSize(i){this._config=It(It({},this._config),i),this._updateElementSize()}setDirection(i){this._config=ji(It({},this._config),{direction:i}),this._updateElementDirection()}addPanelClass(i){this._pane&&this._toggleClasses(this._pane,i,!0)}removePanelClass(i){this._pane&&this._toggleClasses(this._pane,i,!1)}getDirection(){let i=this._config.direction;return i?typeof i=="string"?i:i.value:"ltr"}updateScrollStrategy(i){i!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=i,this.hasAttached()&&(i.attach(this),i.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;let i=this._pane.style;i.width=ja(this._config.width),i.height=ja(this._config.height),i.minWidth=ja(this._config.minWidth),i.minHeight=ja(this._config.minHeight),i.maxWidth=ja(this._config.maxWidth),i.maxHeight=ja(this._config.maxHeight)}_togglePointerEvents(i){this._pane.style.pointerEvents=i?"":"none"}_attachBackdrop(){let i="cdk-overlay-backdrop-showing";this._backdropRef?.dispose(),this._backdropRef=new ML(this._document,this._renderer,this._ngZone,e=>{this._backdropClick.next(e)}),this._animationsDisabled&&this._backdropRef.element.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropRef.element,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropRef.element,this._host),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this._backdropRef?.element.classList.add(i))}):this._backdropRef.element.classList.add(i)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){this._animationsDisabled?(this._backdropRef?.dispose(),this._backdropRef=null):this._backdropRef?.detach()}_toggleClasses(i,e,n){let o=rv(e||[]).filter(r=>!!r);o.length&&(n?i.classList.add(...o):i.classList.remove(...o))}_detachContentWhenEmpty(){this._ngZone.runOutsideAngular(()=>{let i=this._renders.pipe(_r(ks(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||this._pane.children.length===0)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),i.unsubscribe())})})}_disposeScrollStrategy(){let i=this._scrollStrategy;i?.disable(),i?.detach?.()}},tW="cdk-overlay-connected-position-bounding-box",Qfe=/([A-Za-z%]+)$/,lv=class{_viewportRuler;_document;_platform;_overlayContainer;_overlayRef;_isInitialRender;_lastBoundingBoxSize={width:0,height:0};_isPushed=!1;_canPush=!0;_growAfterOpen=!1;_hasFlexibleDimensions=!0;_positionLocked=!1;_originRect;_overlayRect;_viewportRect;_containerRect;_viewportMargin=0;_scrollables=[];_preferredPositions=[];_origin;_pane;_isDisposed;_boundingBox;_lastPosition;_lastScrollVisibility;_positionChanges=new gi;_resizeSubscription=nr.EMPTY;_offsetX=0;_offsetY=0;_transformOriginSelector;_appliedPanelClasses=[];_previousPushAmount;positionChanges=this._positionChanges;get positions(){return this._preferredPositions}constructor(i,e,n,o,r){this._viewportRuler=e,this._document=n,this._platform=o,this._overlayContainer=r,this.setOrigin(i)}attach(i){this._overlayRef&&this._overlayRef,this._validatePositions(),i.hostElement.classList.add(tW),this._overlayRef=i,this._boundingBox=i.hostElement,this._pane=i.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition){this.reapplyLastPosition();return}this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let i=this._originRect,e=this._overlayRect,n=this._viewportRect,o=this._containerRect,r=[],g;for(let w of this._preferredPositions){let T=this._getOriginPoint(i,o,w),k=this._getOverlayPoint(T,e,w),N=this._getOverlayFit(k,e,n,w);if(N.isCompletelyWithinViewport){this._isPushed=!1,this._applyPosition(w,T);return}if(this._canFitWithFlexibleDimensions(N,k,n)){r.push({position:w,origin:T,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(T,w)});continue}(!g||g.overlayFit.visibleArea<N.visibleArea)&&(g={overlayFit:N,overlayPoint:k,originPoint:T,position:w,overlayRect:e})}if(r.length){let w=null,T=-1;for(let k of r){let N=k.boundingBoxRect.width*k.boundingBoxRect.height*(k.position.weight||1);N>T&&(T=N,w=k)}this._isPushed=!1,this._applyPosition(w.position,w.origin);return}if(this._canPush){this._isPushed=!0,this._applyPosition(g.position,g.originPoint);return}this._applyPosition(g.position,g.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&M0(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(tW),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;let i=this._lastPosition;if(i){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let e=this._getOriginPoint(this._originRect,this._containerRect,i);this._applyPosition(i,e)}else this.apply()}withScrollableContainers(i){return this._scrollables=i,this}withPositions(i){return this._preferredPositions=i,i.indexOf(this._lastPosition)===-1&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(i){return this._viewportMargin=i,this}withFlexibleDimensions(i=!0){return this._hasFlexibleDimensions=i,this}withGrowAfterOpen(i=!0){return this._growAfterOpen=i,this}withPush(i=!0){return this._canPush=i,this}withLockedPosition(i=!0){return this._positionLocked=i,this}setOrigin(i){return this._origin=i,this}withDefaultOffsetX(i){return this._offsetX=i,this}withDefaultOffsetY(i){return this._offsetY=i,this}withTransformOriginOn(i){return this._transformOriginSelector=i,this}_getOriginPoint(i,e,n){let o;if(n.originX=="center")o=i.left+i.width/2;else{let g=this._isRtl()?i.right:i.left,w=this._isRtl()?i.left:i.right;o=n.originX=="start"?g:w}e.left<0&&(o-=e.left);let r;return n.originY=="center"?r=i.top+i.height/2:r=n.originY=="top"?i.top:i.bottom,e.top<0&&(r-=e.top),{x:o,y:r}}_getOverlayPoint(i,e,n){let o;n.overlayX=="center"?o=-e.width/2:n.overlayX==="start"?o=this._isRtl()?-e.width:0:o=this._isRtl()?0:-e.width;let r;return n.overlayY=="center"?r=-e.height/2:r=n.overlayY=="top"?0:-e.height,{x:i.x+o,y:i.y+r}}_getOverlayFit(i,e,n,o){let r=nW(e),{x:g,y:w}=i,T=this._getOffset(o,"x"),k=this._getOffset(o,"y");T&&(g+=T),k&&(w+=k);let N=0-g,V=g+r.width-n.width,q=0-w,Z=w+r.height-n.height,X=this._subtractOverflows(r.width,N,V),te=this._subtractOverflows(r.height,q,Z),De=X*te;return{visibleArea:De,isCompletelyWithinViewport:r.width*r.height===De,fitsInViewportVertically:te===r.height,fitsInViewportHorizontally:X==r.width}}_canFitWithFlexibleDimensions(i,e,n){if(this._hasFlexibleDimensions){let o=n.bottom-e.y,r=n.right-e.x,g=iW(this._overlayRef.getConfig().minHeight),w=iW(this._overlayRef.getConfig().minWidth),T=i.fitsInViewportVertically||g!=null&&g<=o,k=i.fitsInViewportHorizontally||w!=null&&w<=r;return T&&k}return!1}_pushOverlayOnScreen(i,e,n){if(this._previousPushAmount&&this._positionLocked)return{x:i.x+this._previousPushAmount.x,y:i.y+this._previousPushAmount.y};let o=nW(e),r=this._viewportRect,g=Math.max(i.x+o.width-r.width,0),w=Math.max(i.y+o.height-r.height,0),T=Math.max(r.top-n.top-i.y,0),k=Math.max(r.left-n.left-i.x,0),N=0,V=0;return o.width<=r.width?N=k||-g:N=i.x<this._viewportMargin?r.left-n.left-i.x:0,o.height<=r.height?V=T||-w:V=i.y<this._viewportMargin?r.top-n.top-i.y:0,this._previousPushAmount={x:N,y:V},{x:i.x+N,y:i.y+V}}_applyPosition(i,e){if(this._setTransformOrigin(i),this._setOverlayElementStyles(e,i),this._setBoundingBoxStyles(e,i),i.panelClass&&this._addPanelClasses(i.panelClass),this._positionChanges.observers.length){let n=this._getScrollVisibility();if(i!==this._lastPosition||!this._lastScrollVisibility||!Jfe(this._lastScrollVisibility,n)){let o=new zD(i,n);this._positionChanges.next(o)}this._lastScrollVisibility=n}this._lastPosition=i,this._isInitialRender=!1}_setTransformOrigin(i){if(!this._transformOriginSelector)return;let e=this._boundingBox.querySelectorAll(this._transformOriginSelector),n,o=i.overlayY;i.overlayX==="center"?n="center":this._isRtl()?n=i.overlayX==="start"?"right":"left":n=i.overlayX==="start"?"left":"right";for(let r=0;r<e.length;r++)e[r].style.transformOrigin=`${n} ${o}`}_calculateBoundingBoxRect(i,e){let n=this._viewportRect,o=this._isRtl(),r,g,w;if(e.overlayY==="top")g=i.y,r=n.height-g+this._viewportMargin;else if(e.overlayY==="bottom")w=n.height-i.y+this._viewportMargin*2,r=n.height-w+this._viewportMargin;else{let Z=Math.min(n.bottom-i.y+n.top,i.y),X=this._lastBoundingBoxSize.height;r=Z*2,g=i.y-Z,r>X&&!this._isInitialRender&&!this._growAfterOpen&&(g=i.y-X/2)}let T=e.overlayX==="start"&&!o||e.overlayX==="end"&&o,k=e.overlayX==="end"&&!o||e.overlayX==="start"&&o,N,V,q;if(k)q=n.width-i.x+this._viewportMargin*2,N=i.x-this._viewportMargin;else if(T)V=i.x,N=n.right-i.x;else{let Z=Math.min(n.right-i.x+n.left,i.x),X=this._lastBoundingBoxSize.width;N=Z*2,V=i.x-Z,N>X&&!this._isInitialRender&&!this._growAfterOpen&&(V=i.x-X/2)}return{top:g,left:V,bottom:w,right:q,width:N,height:r}}_setBoundingBoxStyles(i,e){let n=this._calculateBoundingBoxRect(i,e);!this._isInitialRender&&!this._growAfterOpen&&(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));let o={};if(this._hasExactPosition())o.top=o.left="0",o.bottom=o.right=o.maxHeight=o.maxWidth="",o.width=o.height="100%";else{let r=this._overlayRef.getConfig().maxHeight,g=this._overlayRef.getConfig().maxWidth;o.height=ja(n.height),o.top=ja(n.top),o.bottom=ja(n.bottom),o.width=ja(n.width),o.left=ja(n.left),o.right=ja(n.right),e.overlayX==="center"?o.alignItems="center":o.alignItems=e.overlayX==="end"?"flex-end":"flex-start",e.overlayY==="center"?o.justifyContent="center":o.justifyContent=e.overlayY==="bottom"?"flex-end":"flex-start",r&&(o.maxHeight=ja(r)),g&&(o.maxWidth=ja(g))}this._lastBoundingBoxSize=n,M0(this._boundingBox.style,o)}_resetBoundingBoxStyles(){M0(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){M0(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(i,e){let n={},o=this._hasExactPosition(),r=this._hasFlexibleDimensions,g=this._overlayRef.getConfig();if(o){let N=this._viewportRuler.getViewportScrollPosition();M0(n,this._getExactOverlayY(e,i,N)),M0(n,this._getExactOverlayX(e,i,N))}else n.position="static";let w="",T=this._getOffset(e,"x"),k=this._getOffset(e,"y");T&&(w+=`translateX(${T}px) `),k&&(w+=`translateY(${k}px)`),n.transform=w.trim(),g.maxHeight&&(o?n.maxHeight=ja(g.maxHeight):r&&(n.maxHeight="")),g.maxWidth&&(o?n.maxWidth=ja(g.maxWidth):r&&(n.maxWidth="")),M0(this._pane.style,n)}_getExactOverlayY(i,e,n){let o={top:"",bottom:""},r=this._getOverlayPoint(e,this._overlayRect,i);if(this._isPushed&&(r=this._pushOverlayOnScreen(r,this._overlayRect,n)),i.overlayY==="bottom"){let g=this._document.documentElement.clientHeight;o.bottom=`${g-(r.y+this._overlayRect.height)}px`}else o.top=ja(r.y);return o}_getExactOverlayX(i,e,n){let o={left:"",right:""},r=this._getOverlayPoint(e,this._overlayRect,i);this._isPushed&&(r=this._pushOverlayOnScreen(r,this._overlayRect,n));let g;if(this._isRtl()?g=i.overlayX==="end"?"left":"right":g=i.overlayX==="end"?"right":"left",g==="right"){let w=this._document.documentElement.clientWidth;o.right=`${w-(r.x+this._overlayRect.width)}px`}else o.left=ja(r.x);return o}_getScrollVisibility(){let i=this._getOriginRect(),e=this._pane.getBoundingClientRect(),n=this._scrollables.map(o=>o.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:JG(i,n),isOriginOutsideView:DL(i,n),isOverlayClipped:JG(e,n),isOverlayOutsideView:DL(e,n)}}_subtractOverflows(i,...e){return e.reduce((n,o)=>n-Math.max(o,0),i)}_getNarrowedViewportRect(){let i=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+i-this._viewportMargin,bottom:n.top+e-this._viewportMargin,width:i-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return this._overlayRef.getDirection()==="rtl"}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(i,e){return e==="x"?i.offsetX==null?this._offsetX:i.offsetX:i.offsetY==null?this._offsetY:i.offsetY}_validatePositions(){}_addPanelClasses(i){this._pane&&rv(i).forEach(e=>{e!==""&&this._appliedPanelClasses.indexOf(e)===-1&&(this._appliedPanelClasses.push(e),this._pane.classList.add(e))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(i=>{this._pane.classList.remove(i)}),this._appliedPanelClasses=[])}_getOriginRect(){let i=this._origin;if(i instanceof Qi)return i.nativeElement.getBoundingClientRect();if(i instanceof Element)return i.getBoundingClientRect();let e=i.width||0,n=i.height||0;return{top:i.y,bottom:i.y+n,left:i.x,right:i.x+e,height:n,width:e}}};function M0(t,i){for(let e in i)i.hasOwnProperty(e)&&(t[e]=i[e]);return t}function iW(t){if(typeof t!="number"&&t!=null){let[i,e]=t.split(Qfe);return!e||e==="px"?parseFloat(i):null}return t||null}function nW(t){return{top:Math.floor(t.top),right:Math.floor(t.right),bottom:Math.floor(t.bottom),left:Math.floor(t.left),width:Math.floor(t.width),height:Math.floor(t.height)}}function Jfe(t,i){return t===i?!0:t.isOriginClipped===i.isOriginClipped&&t.isOriginOutsideView===i.isOriginOutsideView&&t.isOverlayClipped===i.isOverlayClipped&&t.isOverlayOutsideView===i.isOverlayOutsideView}var rW="cdk-global-overlay-wrapper",BD=class{_overlayRef;_cssPosition="static";_topOffset="";_bottomOffset="";_alignItems="";_xPosition="";_xOffset="";_width="";_height="";_isDisposed=!1;attach(i){let e=i.getConfig();this._overlayRef=i,this._width&&!e.width&&i.updateSize({width:this._width}),this._height&&!e.height&&i.updateSize({height:this._height}),i.hostElement.classList.add(rW),this._isDisposed=!1}top(i=""){return this._bottomOffset="",this._topOffset=i,this._alignItems="flex-start",this}left(i=""){return this._xOffset=i,this._xPosition="left",this}bottom(i=""){return this._topOffset="",this._bottomOffset=i,this._alignItems="flex-end",this}right(i=""){return this._xOffset=i,this._xPosition="right",this}start(i=""){return this._xOffset=i,this._xPosition="start",this}end(i=""){return this._xOffset=i,this._xPosition="end",this}width(i=""){return this._overlayRef?this._overlayRef.updateSize({width:i}):this._width=i,this}height(i=""){return this._overlayRef?this._overlayRef.updateSize({height:i}):this._height=i,this}centerHorizontally(i=""){return this.left(i),this._xPosition="center",this}centerVertically(i=""){return this.top(i),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;let i=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:o,height:r,maxWidth:g,maxHeight:w}=n,T=(o==="100%"||o==="100vw")&&(!g||g==="100%"||g==="100vw"),k=(r==="100%"||r==="100vh")&&(!w||w==="100%"||w==="100vh"),N=this._xPosition,V=this._xOffset,q=this._overlayRef.getConfig().direction==="rtl",Z="",X="",te="";T?te="flex-start":N==="center"?(te="center",q?X=V:Z=V):q?N==="left"||N==="end"?(te="flex-end",Z=V):(N==="right"||N==="start")&&(te="flex-start",X=V):N==="left"||N==="start"?(te="flex-start",Z=V):(N==="right"||N==="end")&&(te="flex-end",X=V),i.position=this._cssPosition,i.marginLeft=T?"0":Z,i.marginTop=k?"0":this._topOffset,i.marginBottom=this._bottomOffset,i.marginRight=T?"0":X,e.justifyContent=te,e.alignItems=k?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;let i=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,n=e.style;e.classList.remove(rW),n.justifyContent=n.alignItems=i.marginTop=i.marginBottom=i.marginLeft=i.marginRight=i.position="",this._overlayRef=null,this._isDisposed=!0}},uW=(()=>{class t{_viewportRuler=J(wm);_document=J(cn);_platform=J(Pr);_overlayContainer=J(VD);constructor(){}global(){return new BD}flexibleConnectedTo(e){return new lv(e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),sa=(()=>{class t{scrollStrategies=J(oW);_overlayContainer=J(VD);_positionBuilder=J(uW);_keyboardDispatcher=J(sW);_injector=J(wn);_ngZone=J(Oi);_document=J(cn);_directionality=J(aa);_location=J(Lh);_outsideClickDispatcher=J(lW);_animationsModuleType=J(oo,{optional:!0});_idGenerator=J(po);_renderer=J(Fa).createRenderer(null,null);_appRef;_styleLoader=J(Vo);constructor(){}create(e){this._styleLoader.load(cW);let n=this._createHostElement(),o=this._createPaneElement(n),r=this._createPortalOutlet(o),g=new Hd(e);return g.direction=g.direction||this._directionality.value,new I0(r,n,o,g,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,this._animationsModuleType==="NoopAnimations",this._injector.get(Ea),this._renderer)}position(){return this._positionBuilder}_createPaneElement(e){let n=this._document.createElement("div");return n.id=this._idGenerator.getId("cdk-overlay-"),n.classList.add("cdk-overlay-pane"),e.appendChild(n),n}_createHostElement(){let e=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(e),e}_createPortalOutlet(e){return this._appRef||(this._appRef=this._injector.get(ms)),new dw(e,null,this._appRef,this._injector,this._document)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),eme=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],dW=new Ot("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{let t=J(sa);return()=>t.scrollStrategies.reposition()}}),cv=(()=>{class t{elementRef=J(Qi);constructor(){}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"]})}return t})(),jD=(()=>{class t{_overlay=J(sa);_dir=J(aa,{optional:!0});_overlayRef;_templatePortal;_backdropSubscription=nr.EMPTY;_attachSubscription=nr.EMPTY;_detachSubscription=nr.EMPTY;_positionSubscription=nr.EMPTY;_offsetX;_offsetY;_position;_scrollStrategyFactory=J(dW);_disposeOnNavigation=!1;_ngZone=J(Oi);origin;positions;positionStrategy;get offsetX(){return this._offsetX}set offsetX(e){this._offsetX=e,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(e){this._offsetY=e,this._position&&this._updatePositionStrategy(this._position)}width;height;minWidth;minHeight;backdropClass;panelClass;viewportMargin=0;scrollStrategy;open=!1;disableClose=!1;transformOriginSelector;hasBackdrop=!1;lockPosition=!1;flexibleDimensions=!1;growAfterOpen=!1;push=!1;get disposeOnNavigation(){return this._disposeOnNavigation}set disposeOnNavigation(e){this._disposeOnNavigation=e}backdropClick=new Mi;positionChange=new Mi;attach=new Mi;detach=new Mi;overlayKeydown=new Mi;overlayOutsideClick=new Mi;constructor(){let e=J(Zo),n=J(na);this._templatePortal=new jd(e,n),this.scrollStrategy=this._scrollStrategyFactory()}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef?.dispose()}ngOnChanges(e){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef?.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),e.origin&&this.open&&this._position.apply()),e.open&&(this.open?this.attachOverlay():this.detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=eme);let e=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=e.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=e.detachments().subscribe(()=>this.detach.emit()),e.keydownEvents().subscribe(n=>{this.overlayKeydown.next(n),n.keyCode===27&&!this.disableClose&&!ga(n)&&(n.preventDefault(),this.detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(n=>{let o=this._getOriginElement(),r=Gl(n);(!o||o!==r&&!o.contains(r))&&this.overlayOutsideClick.next(n)})}_buildConfig(){let e=this._position=this.positionStrategy||this._createPositionStrategy(),n=new Hd({direction:this._dir||"ltr",positionStrategy:e,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop,disposeOnNavigation:this.disposeOnNavigation});return(this.width||this.width===0)&&(n.width=this.width),(this.height||this.height===0)&&(n.height=this.height),(this.minWidth||this.minWidth===0)&&(n.minWidth=this.minWidth),(this.minHeight||this.minHeight===0)&&(n.minHeight=this.minHeight),this.backdropClass&&(n.backdropClass=this.backdropClass),this.panelClass&&(n.panelClass=this.panelClass),n}_updatePositionStrategy(e){let n=this.positions.map(o=>({originX:o.originX,originY:o.originY,overlayX:o.overlayX,overlayY:o.overlayY,offsetX:o.offsetX||this.offsetX,offsetY:o.offsetY||this.offsetY,panelClass:o.panelClass||void 0}));return e.setOrigin(this._getOrigin()).withPositions(n).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){let e=this._overlay.position().flexibleConnectedTo(this._getOrigin());return this._updatePositionStrategy(e),e}_getOrigin(){return this.origin instanceof cv?this.origin.elementRef:this.origin}_getOriginElement(){return this.origin instanceof cv?this.origin.elementRef.nativeElement:this.origin instanceof Qi?this.origin.nativeElement:typeof Element<"u"&&this.origin instanceof Element?this.origin:null}attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(e=>{this.backdropClick.emit(e)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(Lg(()=>this.positionChange.observers.length>0)).subscribe(e=>{this._ngZone.run(()=>this.positionChange.emit(e)),this.positionChange.observers.length===0&&this._positionSubscription.unsubscribe()})),this.open=!0}detachOverlay(){this._overlayRef?.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.open=!1}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:[0,"cdkConnectedOverlayOrigin","origin"],positions:[0,"cdkConnectedOverlayPositions","positions"],positionStrategy:[0,"cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:[0,"cdkConnectedOverlayOffsetX","offsetX"],offsetY:[0,"cdkConnectedOverlayOffsetY","offsetY"],width:[0,"cdkConnectedOverlayWidth","width"],height:[0,"cdkConnectedOverlayHeight","height"],minWidth:[0,"cdkConnectedOverlayMinWidth","minWidth"],minHeight:[0,"cdkConnectedOverlayMinHeight","minHeight"],backdropClass:[0,"cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:[0,"cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:[0,"cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:[0,"cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:[0,"cdkConnectedOverlayOpen","open"],disableClose:[0,"cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:[0,"cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:[2,"cdkConnectedOverlayHasBackdrop","hasBackdrop",Bi],lockPosition:[2,"cdkConnectedOverlayLockPosition","lockPosition",Bi],flexibleDimensions:[2,"cdkConnectedOverlayFlexibleDimensions","flexibleDimensions",Bi],growAfterOpen:[2,"cdkConnectedOverlayGrowAfterOpen","growAfterOpen",Bi],push:[2,"cdkConnectedOverlayPush","push",Bi],disposeOnNavigation:[2,"cdkConnectedOverlayDisposeOnNavigation","disposeOnNavigation",Bi]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],features:[$r]})}return t})();function tme(t){return()=>t.scrollStrategies.reposition()}var ime={provide:dW,deps:[sa],useFactory:tme},au=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({providers:[sa,ime],imports:[bm,ju,yw,yw]})}return t})();function nme(t,i){}var Em=class{viewContainerRef;injector;id;role="dialog";panelClass="";hasBackdrop=!0;backdropClass="";disableClose=!1;width="";height="";minWidth;minHeight;maxWidth;maxHeight;positionStrategy;data=null;direction;ariaDescribedBy=null;ariaLabelledBy=null;ariaLabel=null;ariaModal=!1;autoFocus="first-tabbable";restoreFocus=!0;scrollStrategy;closeOnNavigation=!0;closeOnDestroy=!0;closeOnOverlayDetachments=!0;componentFactoryResolver;providers;container;templateContext};var AL=(()=>{class t extends Vp{_elementRef=J(Qi);_focusTrapFactory=J(AD);_config;_interactivityChecker=J(wL);_ngZone=J(Oi);_overlayRef=J(I0);_focusMonitor=J(Uu);_renderer=J(Ko);_platform=J(Pr);_document=J(cn,{optional:!0});_portalOutlet;_focusTrap=null;_elementFocusedBeforeDialogWasOpened=null;_closeInteractionType=null;_ariaLabelledByQueue=[];_changeDetectorRef=J(vr);_injector=J(wn);_isDestroyed=!1;constructor(){super(),this._config=J(Em,{optional:!0})||new Em,this._config.ariaLabelledBy&&this._ariaLabelledByQueue.push(this._config.ariaLabelledBy)}_addAriaLabelledBy(e){this._ariaLabelledByQueue.push(e),this._changeDetectorRef.markForCheck()}_removeAriaLabelledBy(e){let n=this._ariaLabelledByQueue.indexOf(e);n>-1&&(this._ariaLabelledByQueue.splice(n,1),this._changeDetectorRef.markForCheck())}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._isDestroyed=!0,this._restoreFocus()}attachComponentPortal(e){this._portalOutlet.hasAttached();let n=this._portalOutlet.attachComponentPortal(e);return this._contentAttached(),n}attachTemplatePortal(e){this._portalOutlet.hasAttached();let n=this._portalOutlet.attachTemplatePortal(e);return this._contentAttached(),n}attachDomPortal=e=>{this._portalOutlet.hasAttached();let n=this._portalOutlet.attachDomPortal(e);return this._contentAttached(),n};_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(e,n){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{let o=()=>{r(),g(),e.removeAttribute("tabindex")},r=this._renderer.listen(e,"blur",o),g=this._renderer.listen(e,"mousedown",o)})),e.focus(n)}_focusByCssSelector(e,n){let o=this._elementRef.nativeElement.querySelector(e);o&&this._forceFocus(o,n)}_trapFocus(e){this._isDestroyed||_s(()=>{let n=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||n.focus(e);break;case!0:case"first-tabbable":this._focusTrap?.focusInitialElement(e)||this._focusDialogContainer(e);break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]',e);break;default:this._focusByCssSelector(this._config.autoFocus,e);break}},{injector:this._injector})}_restoreFocus(){let e=this._config.restoreFocus,n=null;if(typeof e=="string"?n=this._document.querySelector(e):typeof e=="boolean"?n=e?this._elementFocusedBeforeDialogWasOpened:null:e&&(n=e),this._config.restoreFocus&&n&&typeof n.focus=="function"){let o=jp(),r=this._elementRef.nativeElement;(!o||o===this._document.body||o===r||r.contains(o))&&(this._focusMonitor?(this._focusMonitor.focusVia(n,this._closeInteractionType),this._closeInteractionType=null):n.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(e){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus(e)}_containsFocus(){let e=this._elementRef.nativeElement,n=jp();return e===n||e.contains(n)}_initializeFocusTrap(){this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=jp()))}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["cdk-dialog-container"]],viewQuery:function(n,o){if(n&1&&pr(Vu,7),n&2){let r;sn(r=ln())&&(o._portalOutlet=r.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(n,o){n&2&&un("id",o._config.id||null)("role",o._config.role)("aria-modal",o._config.ariaModal)("aria-labelledby",o._config.ariaLabel?null:o._ariaLabelledByQueue[0])("aria-label",o._config.ariaLabel)("aria-describedby",o._config.ariaDescribedBy||null)},features:[Fn],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(n,o){n&1&&Tt(0,nme,0,0,"ng-template",0)},dependencies:[Vu],styles:[`.cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}
`],encapsulation:2})}return t})(),bw=class{overlayRef;config;componentInstance;componentRef;containerInstance;disableClose;closed=new gi;backdropClick;keydownEvents;outsidePointerEvents;id;_detachSubscription;constructor(i,e){this.overlayRef=i,this.config=e,this.disableClose=e.disableClose,this.backdropClick=i.backdropClick(),this.keydownEvents=i.keydownEvents(),this.outsidePointerEvents=i.outsidePointerEvents(),this.id=e.id,this.keydownEvents.subscribe(n=>{n.keyCode===27&&!this.disableClose&&!ga(n)&&(n.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=i.detachments().subscribe(()=>{e.closeOnOverlayDetachments!==!1&&this.close()})}close(i,e){if(this.containerInstance){let n=this.closed;this.containerInstance._closeInteractionType=e?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),n.next(i),n.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(i="",e=""){return this.overlayRef.updateSize({width:i,height:e}),this}addPanelClass(i){return this.overlayRef.addPanelClass(i),this}removePanelClass(i){return this.overlayRef.removePanelClass(i),this}},rme=new Ot("DialogScrollStrategy",{providedIn:"root",factory:()=>{let t=J(sa);return()=>t.scrollStrategies.block()}}),ome=new Ot("DialogData"),ame=new Ot("DefaultDialogConfig");var RL=(()=>{class t{_overlay=J(sa);_injector=J(wn);_defaultOptions=J(ame,{optional:!0});_parentDialog=J(t,{optional:!0,skipSelf:!0});_overlayContainer=J(VD);_idGenerator=J(po);_openDialogsAtThisLevel=[];_afterAllClosedAtThisLevel=new gi;_afterOpenedAtThisLevel=new gi;_ariaHiddenElements=new Map;_scrollStrategy=J(rme);get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}afterAllClosed=Ch(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(ia(void 0)));constructor(){}open(e,n){let o=this._defaultOptions||new Em;n=It(It({},o),n),n.id=n.id||this._idGenerator.getId("cdk-dialog-"),n.id&&this.getDialogById(n.id);let r=this._getOverlayConfig(n),g=this._overlay.create(r),w=new bw(g,n),T=this._attachContainer(g,w,n);return w.containerInstance=T,this._attachDialogContent(e,w,T,n),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(w),w.closed.subscribe(()=>this._removeOpenDialog(w,!0)),this.afterOpened.next(w),w}closeAll(){IL(this.openDialogs,e=>e.close())}getDialogById(e){return this.openDialogs.find(n=>n.id===e)}ngOnDestroy(){IL(this._openDialogsAtThisLevel,e=>{e.config.closeOnDestroy===!1&&this._removeOpenDialog(e,!1)}),IL(this._openDialogsAtThisLevel,e=>e.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(e){let n=new Hd({positionStrategy:e.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:e.scrollStrategy||this._scrollStrategy(),panelClass:e.panelClass,hasBackdrop:e.hasBackdrop,direction:e.direction,minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight,width:e.width,height:e.height,disposeOnNavigation:e.closeOnNavigation});return e.backdropClass&&(n.backdropClass=e.backdropClass),n}_attachContainer(e,n,o){let r=o.injector||o.viewContainerRef?.injector,g=[{provide:Em,useValue:o},{provide:bw,useValue:n},{provide:I0,useValue:e}],w;o.container?typeof o.container=="function"?w=o.container:(w=o.container.type,g.push(...o.container.providers(o))):w=AL;let T=new $l(w,o.viewContainerRef,wn.create({parent:r||this._injector,providers:g}));return e.attach(T).instance}_attachDialogContent(e,n,o,r){if(e instanceof Zo){let g=this._createInjector(r,n,o,void 0),w={$implicit:r.data,dialogRef:n};r.templateContext&&(w=It(It({},w),typeof r.templateContext=="function"?r.templateContext():r.templateContext)),o.attachTemplatePortal(new jd(e,null,w,g))}else{let g=this._createInjector(r,n,o,this._injector),w=o.attachComponentPortal(new $l(e,r.viewContainerRef,g));n.componentRef=w,n.componentInstance=w.instance}}_createInjector(e,n,o,r){let g=e.injector||e.viewContainerRef?.injector,w=[{provide:ome,useValue:e.data},{provide:bw,useValue:n}];return e.providers&&(typeof e.providers=="function"?w.push(...e.providers(n,e,o)):w.push(...e.providers)),e.direction&&(!g||!g.get(aa,null,{optional:!0}))&&w.push({provide:aa,useValue:{value:e.direction,change:Ni()}}),wn.create({parent:g||r,providers:w})}_removeOpenDialog(e,n){let o=this.openDialogs.indexOf(e);o>-1&&(this.openDialogs.splice(o,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((r,g)=>{r?g.setAttribute("aria-hidden",r):g.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),n&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){let e=this._overlayContainer.getContainerElement();if(e.parentElement){let n=e.parentElement.children;for(let o=n.length-1;o>-1;o--){let r=n[o];r!==e&&r.nodeName!=="SCRIPT"&&r.nodeName!=="STYLE"&&!r.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(r,r.getAttribute("aria-hidden")),r.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){let e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function IL(t,i){let e=t.length;for(;e--;)i(t[e])}var hW=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({providers:[RL],imports:[au,ju,T0,ju]})}return t})();function su(t){return t!=null&&`${t}`!="false"}function pW(t,i=/\s+/){let e=[];if(t!=null){let n=Array.isArray(t)?t:`${t}`.split(i);for(let o of n){let r=`${o}`.trim();r&&e.push(r)}}return e}var sme=200,UD=class{_letterKeyStream=new gi;_items=[];_selectedItemIndex=-1;_pressedLetters=[];_skipPredicateFn;_selectedItem=new gi;selectedItem=this._selectedItem;constructor(i,e){let n=typeof e?.debounceInterval=="number"?e.debounceInterval:sme;e?.skipPredicate&&(this._skipPredicateFn=e.skipPredicate),this.setItems(i),this._setupKeyHandler(n)}destroy(){this._pressedLetters=[],this._letterKeyStream.complete(),this._selectedItem.complete()}setCurrentSelectedItemIndex(i){this._selectedItemIndex=i}setItems(i){this._items=i}handleKey(i){let e=i.keyCode;i.key&&i.key.length===1?this._letterKeyStream.next(i.key.toLocaleUpperCase()):(e>=65&&e<=90||e>=48&&e<=57)&&this._letterKeyStream.next(String.fromCharCode(e))}isTyping(){return this._pressedLetters.length>0}reset(){this._pressedLetters=[]}_setupKeyHandler(i){this._letterKeyStream.pipe(hr(e=>this._pressedLetters.push(e)),R1(i),zr(()=>this._pressedLetters.length>0),hn(()=>this._pressedLetters.join("").toLocaleUpperCase())).subscribe(e=>{for(let n=1;n<this._items.length+1;n++){let o=(this._selectedItemIndex+n)%this._items.length,r=this._items[o];if(!this._skipPredicateFn?.(r)&&r.getLabel?.().toLocaleUpperCase().trim().indexOf(e)===0){this._selectedItem.next(r);break}}this._pressedLetters=[]})}};var uv=class{_items;_activeItemIndex=-1;_activeItem=ma(null);_wrap=!1;_typeaheadSubscription=nr.EMPTY;_itemChangesSubscription;_vertical=!0;_horizontal;_allowedModifierKeys=[];_homeAndEnd=!1;_pageUpAndDown={enabled:!1,delta:10};_effectRef;_typeahead;_skipPredicateFn=i=>i.disabled;constructor(i,e){this._items=i,i instanceof Zf?this._itemChangesSubscription=i.changes.subscribe(n=>this._itemsChanged(n.toArray())):Jf(i)&&(this._effectRef=mx(()=>this._itemsChanged(i()),{injector:e}))}tabOut=new gi;change=new gi;skipPredicate(i){return this._skipPredicateFn=i,this}withWrap(i=!0){return this._wrap=i,this}withVerticalOrientation(i=!0){return this._vertical=i,this}withHorizontalOrientation(i){return this._horizontal=i,this}withAllowedModifierKeys(i){return this._allowedModifierKeys=i,this}withTypeAhead(i=200){this._typeaheadSubscription.unsubscribe();let e=this._getItemsArray();return this._typeahead=new UD(e,{debounceInterval:typeof i=="number"?i:void 0,skipPredicate:n=>this._skipPredicateFn(n)}),this._typeaheadSubscription=this._typeahead.selectedItem.subscribe(n=>{this.setActiveItem(n)}),this}cancelTypeahead(){return this._typeahead?.reset(),this}withHomeAndEnd(i=!0){return this._homeAndEnd=i,this}withPageUpDown(i=!0,e=10){return this._pageUpAndDown={enabled:i,delta:e},this}setActiveItem(i){let e=this._activeItem();this.updateActiveItem(i),this._activeItem()!==e&&this.change.next(this._activeItemIndex)}onKeydown(i){let e=i.keyCode,o=["altKey","ctrlKey","metaKey","shiftKey"].every(r=>!i[r]||this._allowedModifierKeys.indexOf(r)>-1);switch(e){case 9:this.tabOut.next();return;case 40:if(this._vertical&&o){this.setNextItemActive();break}else return;case 38:if(this._vertical&&o){this.setPreviousItemActive();break}else return;case 39:if(this._horizontal&&o){this._horizontal==="rtl"?this.setPreviousItemActive():this.setNextItemActive();break}else return;case 37:if(this._horizontal&&o){this._horizontal==="rtl"?this.setNextItemActive():this.setPreviousItemActive();break}else return;case 36:if(this._homeAndEnd&&o){this.setFirstItemActive();break}else return;case 35:if(this._homeAndEnd&&o){this.setLastItemActive();break}else return;case 33:if(this._pageUpAndDown.enabled&&o){let r=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(r>0?r:0,1);break}else return;case 34:if(this._pageUpAndDown.enabled&&o){let r=this._activeItemIndex+this._pageUpAndDown.delta,g=this._getItemsArray().length;this._setActiveItemByIndex(r<g?r:g-1,-1);break}else return;default:(o||ga(i,"shiftKey"))&&this._typeahead?.handleKey(i);return}this._typeahead?.reset(),i.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem()}isTyping(){return!!this._typeahead&&this._typeahead.isTyping()}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._getItemsArray().length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(i){let e=this._getItemsArray(),n=typeof i=="number"?i:e.indexOf(i),o=e[n];this._activeItem.set(o??null),this._activeItemIndex=n,this._typeahead?.setCurrentSelectedItemIndex(n)}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._effectRef?.destroy(),this._typeahead?.destroy(),this.tabOut.complete(),this.change.complete()}_setActiveItemByDelta(i){this._wrap?this._setActiveInWrapMode(i):this._setActiveInDefaultMode(i)}_setActiveInWrapMode(i){let e=this._getItemsArray();for(let n=1;n<=e.length;n++){let o=(this._activeItemIndex+i*n+e.length)%e.length,r=e[o];if(!this._skipPredicateFn(r)){this.setActiveItem(o);return}}}_setActiveInDefaultMode(i){this._setActiveItemByIndex(this._activeItemIndex+i,i)}_setActiveItemByIndex(i,e){let n=this._getItemsArray();if(n[i]){for(;this._skipPredicateFn(n[i]);)if(i+=e,!n[i])return;this.setActiveItem(i)}}_getItemsArray(){return Jf(this._items)?this._items():this._items instanceof Zf?this._items.toArray():this._items}_itemsChanged(i){this._typeahead?.setItems(i);let e=this._activeItem();if(e){let n=i.indexOf(e);n>-1&&n!==this._activeItemIndex&&(this._activeItemIndex=n,this._typeahead?.setCurrentSelectedItemIndex(n))}}};var Ew=class extends uv{setActiveItem(i){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(i),this.activeItem&&this.activeItem.setActiveStyles()}};var Cw=class extends uv{_origin="program";setFocusOrigin(i){return this._origin=i,this}setActiveItem(i){super.setActiveItem(i),this.activeItem&&this.activeItem.focus(this._origin)}};var gW=" ";function PL(t,i,e){let n=GD(t,i);e=e.trim(),!n.some(o=>o.trim()===e)&&(n.push(e),t.setAttribute(i,n.join(gW)))}function WD(t,i,e){let n=GD(t,i);e=e.trim();let o=n.filter(r=>r!==e);o.length?t.setAttribute(i,o.join(gW)):t.removeAttribute(i)}function GD(t,i){return t.getAttribute(i)?.match(/\S+/g)??[]}var _W="cdk-describedby-message",$D="cdk-describedby-host",OL=0,yW=(()=>{class t{_platform=J(Pr);_document=J(cn);_messageRegistry=new Map;_messagesContainer=null;_id=`${OL++}`;constructor(){J(Vo).load(Hu),this._id=J(Ou)+"-"+OL++}describe(e,n,o){if(!this._canBeDescribed(e,n))return;let r=kL(n,o);typeof n!="string"?(mW(n,this._id),this._messageRegistry.set(r,{messageElement:n,referenceCount:0})):this._messageRegistry.has(r)||this._createMessageElement(n,o),this._isElementDescribedByMessage(e,r)||this._addMessageReference(e,r)}removeDescription(e,n,o){if(!n||!this._isElementNode(e))return;let r=kL(n,o);if(this._isElementDescribedByMessage(e,r)&&this._removeMessageReference(e,r),typeof n=="string"){let g=this._messageRegistry.get(r);g&&g.referenceCount===0&&this._deleteMessageElement(r)}this._messagesContainer?.childNodes.length===0&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){let e=this._document.querySelectorAll(`[${$D}="${this._id}"]`);for(let n=0;n<e.length;n++)this._removeCdkDescribedByReferenceIds(e[n]),e[n].removeAttribute($D);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(e,n){let o=this._document.createElement("div");mW(o,this._id),o.textContent=e,n&&o.setAttribute("role",n),this._createMessagesContainer(),this._messagesContainer.appendChild(o),this._messageRegistry.set(kL(e,n),{messageElement:o,referenceCount:0})}_deleteMessageElement(e){this._messageRegistry.get(e)?.messageElement?.remove(),this._messageRegistry.delete(e)}_createMessagesContainer(){if(this._messagesContainer)return;let e="cdk-describedby-message-container",n=this._document.querySelectorAll(`.${e}[platform="server"]`);for(let r=0;r<n.length;r++)n[r].remove();let o=this._document.createElement("div");o.style.visibility="hidden",o.classList.add(e),o.classList.add("cdk-visually-hidden"),this._platform.isBrowser||o.setAttribute("platform","server"),this._document.body.appendChild(o),this._messagesContainer=o}_removeCdkDescribedByReferenceIds(e){let n=GD(e,"aria-describedby").filter(o=>o.indexOf(_W)!=0);e.setAttribute("aria-describedby",n.join(" "))}_addMessageReference(e,n){let o=this._messageRegistry.get(n);PL(e,"aria-describedby",o.messageElement.id),e.setAttribute($D,this._id),o.referenceCount++}_removeMessageReference(e,n){let o=this._messageRegistry.get(n);o.referenceCount--,WD(e,"aria-describedby",o.messageElement.id),e.removeAttribute($D)}_isElementDescribedByMessage(e,n){let o=GD(e,"aria-describedby"),r=this._messageRegistry.get(n),g=r&&r.messageElement.id;return!!g&&o.indexOf(g)!=-1}_canBeDescribed(e,n){if(!this._isElementNode(e))return!1;if(n&&typeof n=="object")return!0;let o=n==null?"":`${n}`.trim(),r=e.getAttribute("aria-label");return o?!r||r.trim()!==o:!1}_isElementNode(e){return e.nodeType===this._document.ELEMENT_NODE}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function kL(t,i){return typeof t=="string"?`${i||""}/${t}`:t}function mW(t,i){t.id||(t.id=`${_W}-${i}-${OL++}`)}var Wn=(()=>{class t{constructor(){J(RD)._applyBodyHighContrastModeCssClasses()}static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({imports:[bm,bm]})}return t})();function cme(t,i){}var Tw=class{viewContainerRef;injector;id;role="dialog";panelClass="";hasBackdrop=!0;backdropClass="";disableClose=!1;width="";height="";minWidth;minHeight;maxWidth;maxHeight;position;data=null;direction;ariaDescribedBy=null;ariaLabelledBy=null;ariaLabel=null;ariaModal=!1;autoFocus="first-tabbable";restoreFocus=!0;delayFocusTrap=!0;scrollStrategy;closeOnNavigation=!0;componentFactoryResolver;enterAnimationDuration;exitAnimationDuration},NL="mdc-dialog--open",vW="mdc-dialog--opening",bW="mdc-dialog--closing",ume=150,dme=75,EW=(()=>{class t extends AL{_animationMode=J(oo,{optional:!0});_animationStateChanged=new Mi;_animationsEnabled=this._animationMode!=="NoopAnimations";_actionSectionCount=0;_hostElement=this._elementRef.nativeElement;_enterAnimationDuration=this._animationsEnabled?wW(this._config.enterAnimationDuration)??ume:0;_exitAnimationDuration=this._animationsEnabled?wW(this._config.exitAnimationDuration)??dme:0;_animationTimer=null;_contentAttached(){super._contentAttached(),this._startOpenAnimation()}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(xW,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(vW,NL)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(NL),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(NL),this._animationsEnabled?(this._hostElement.style.setProperty(xW,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(bW)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_updateActionSectionCount(e){this._actionSectionCount+=e,this._changeDetectorRef.markForCheck()}_finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)};_finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})};_clearAnimationClasses(){this._hostElement.classList.remove(vW,bW)}_waitForAnimationToComplete(e,n){this._animationTimer!==null&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(n,e)}_requestAnimationFrame(e){this._ngZone.runOutsideAngular(()=>{typeof requestAnimationFrame=="function"?requestAnimationFrame(e):e()})}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(e){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:e})}ngOnDestroy(){super.ngOnDestroy(),this._animationTimer!==null&&clearTimeout(this._animationTimer)}attachComponentPortal(e){let n=super.attachComponentPortal(e);return n.location.nativeElement.classList.add("mat-mdc-dialog-component-host"),n}static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275cmp=ai({type:t,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:10,hostBindings:function(n,o){n&2&&(vs("id",o._config.id),un("aria-modal",o._config.ariaModal)("role",o._config.role)("aria-labelledby",o._config.ariaLabel?null:o._ariaLabelledByQueue[0])("aria-label",o._config.ariaLabel)("aria-describedby",o._config.ariaDescribedBy||null),Ji("_mat-animation-noopable",!o._animationsEnabled)("mat-mdc-dialog-container-with-actions",o._actionSectionCount>0))},features:[Fn],decls:3,vars:0,consts:[[1,"mat-mdc-dialog-inner-container","mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(n,o){n&1&&(ae(0,"div",0)(1,"div",1),Tt(2,cme,0,0,"ng-template",2),se()())},dependencies:[Vu],styles:[`.mat-mdc-dialog-container{width:100%;height:100%;display:block;box-sizing:border-box;max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;outline:0}.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-max-width, 560px);min-width:var(--mat-dialog-container-min-width, 280px)}@media(max-width: 599px){.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-small-max-width, calc(100vw - 32px))}}.mat-mdc-dialog-inner-container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;opacity:0;transition:opacity linear var(--mat-dialog-transition-duration, 0ms);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mdc-dialog--closing .mat-mdc-dialog-inner-container{transition:opacity 75ms linear;transform:none}.mdc-dialog--open .mat-mdc-dialog-inner-container{opacity:1}._mat-animation-noopable .mat-mdc-dialog-inner-container{transition:none}.mat-mdc-dialog-surface{display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;width:100%;height:100%;position:relative;overflow-y:auto;outline:0;transform:scale(0.8);transition:transform var(--mat-dialog-transition-duration, 0ms) cubic-bezier(0, 0, 0.2, 1);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;box-shadow:var(--mat-dialog-container-elevation-shadow, none);border-radius:var(--mdc-dialog-container-shape, var(--mat-sys-corner-extra-large, 4px));background-color:var(--mdc-dialog-container-color, var(--mat-sys-surface, white))}[dir=rtl] .mat-mdc-dialog-surface{text-align:right}.mdc-dialog--open .mat-mdc-dialog-surface,.mdc-dialog--closing .mat-mdc-dialog-surface{transform:none}._mat-animation-noopable .mat-mdc-dialog-surface{transition:none}.mat-mdc-dialog-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mat-mdc-dialog-title{display:block;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:var(--mat-dialog-headline-padding, 6px 24px 13px)}.mat-mdc-dialog-title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mat-mdc-dialog-title{text-align:right}.mat-mdc-dialog-container .mat-mdc-dialog-title{color:var(--mdc-dialog-subhead-color, var(--mat-sys-on-surface, rgba(0, 0, 0, 0.87)));font-family:var(--mdc-dialog-subhead-font, var(--mat-sys-headline-small-font, inherit));line-height:var(--mdc-dialog-subhead-line-height, var(--mat-sys-headline-small-line-height, 1.5rem));font-size:var(--mdc-dialog-subhead-size, var(--mat-sys-headline-small-size, 1rem));font-weight:var(--mdc-dialog-subhead-weight, var(--mat-sys-headline-small-weight, 400));letter-spacing:var(--mdc-dialog-subhead-tracking, var(--mat-sys-headline-small-tracking, 0.03125em))}.mat-mdc-dialog-content{display:block;flex-grow:1;box-sizing:border-box;margin:0;overflow:auto;max-height:65vh}.mat-mdc-dialog-content>:first-child{margin-top:0}.mat-mdc-dialog-content>:last-child{margin-bottom:0}.mat-mdc-dialog-container .mat-mdc-dialog-content{color:var(--mdc-dialog-supporting-text-color, var(--mat-sys-on-surface-variant, rgba(0, 0, 0, 0.6)));font-family:var(--mdc-dialog-supporting-text-font, var(--mat-sys-body-medium-font, inherit));line-height:var(--mdc-dialog-supporting-text-line-height, var(--mat-sys-body-medium-line-height, 1.5rem));font-size:var(--mdc-dialog-supporting-text-size, var(--mat-sys-body-medium-size, 1rem));font-weight:var(--mdc-dialog-supporting-text-weight, var(--mat-sys-body-medium-weight, 400));letter-spacing:var(--mdc-dialog-supporting-text-tracking, var(--mat-sys-body-medium-tracking, 0.03125em))}.mat-mdc-dialog-container .mat-mdc-dialog-content{padding:var(--mat-dialog-content-padding, 20px 24px)}.mat-mdc-dialog-container-with-actions .mat-mdc-dialog-content{padding:var(--mat-dialog-with-actions-content-padding, 20px 24px 0)}.mat-mdc-dialog-container .mat-mdc-dialog-title+.mat-mdc-dialog-content{padding-top:0}.mat-mdc-dialog-actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0);padding:var(--mat-dialog-actions-padding, 16px 24px);justify-content:var(--mat-dialog-actions-alignment, flex-end)}@media(forced-colors: active){.mat-mdc-dialog-actions{border-top-color:CanvasText}}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-start,.mat-mdc-dialog-actions[align=start]{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}.mat-mdc-dialog-component-host{display:contents}
`],encapsulation:2})}return t})(),xW="--mat-dialog-transition-duration";function wW(t){return t==null?null:typeof t=="number"?t:t.endsWith("ms")?Up(t.substring(0,t.length-2)):t.endsWith("s")?Up(t.substring(0,t.length-1))*1e3:t==="0"?0:null}var Sw=function(t){return t[t.OPEN=0]="OPEN",t[t.CLOSING=1]="CLOSING",t[t.CLOSED=2]="CLOSED",t}(Sw||{}),k0=class{_ref;_containerInstance;componentInstance;componentRef;disableClose;id;_afterOpened=new gi;_beforeClosed=new gi;_result;_closeFallbackTimeout;_state=Sw.OPEN;_closeInteractionType;constructor(i,e,n){this._ref=i,this._containerInstance=n,this.disableClose=e.disableClose,this.id=i.id,i.addPanelClass("mat-mdc-dialog-panel"),n._animationStateChanged.pipe(zr(o=>o.state==="opened"),ta(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),n._animationStateChanged.pipe(zr(o=>o.state==="closed"),ta(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),i.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),ks(this.backdropClick(),this.keydownEvents().pipe(zr(o=>o.keyCode===27&&!this.disableClose&&!ga(o)))).subscribe(o=>{this.disableClose||(o.preventDefault(),CW(this,o.type==="keydown"?"keyboard":"mouse"))})}close(i){this._result=i,this._containerInstance._animationStateChanged.pipe(zr(e=>e.state==="closing"),ta(1)).subscribe(e=>{this._beforeClosed.next(i),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),e.totalTime+100)}),this._state=Sw.CLOSING,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(i){let e=this._ref.config.positionStrategy;return i&&(i.left||i.right)?i.left?e.left(i.left):e.right(i.right):e.centerHorizontally(),i&&(i.top||i.bottom)?i.top?e.top(i.top):e.bottom(i.bottom):e.centerVertically(),this._ref.updatePosition(),this}updateSize(i="",e=""){return this._ref.updateSize(i,e),this}addPanelClass(i){return this._ref.addPanelClass(i),this}removePanelClass(i){return this._ref.removePanelClass(i),this}getState(){return this._state}_finishDialogClose(){this._state=Sw.CLOSED,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}};function CW(t,i,e){return t._closeInteractionType=i,t.close(e)}var ZD=new Ot("MatMdcDialogData"),SW=new Ot("mat-mdc-dialog-default-options"),TW=new Ot("mat-mdc-dialog-scroll-strategy",{providedIn:"root",factory:()=>{let t=J(sa);return()=>t.scrollStrategies.block()}});var lu=(()=>{class t{_overlay=J(sa);_defaultOptions=J(SW,{optional:!0});_scrollStrategy=J(TW);_parentDialog=J(t,{optional:!0,skipSelf:!0});_idGenerator=J(po);_dialog=J(RL);_openDialogsAtThisLevel=[];_afterAllClosedAtThisLevel=new gi;_afterOpenedAtThisLevel=new gi;dialogConfigClass=Tw;_dialogRefConstructor;_dialogContainerType;_dialogDataToken;get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){let e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}afterAllClosed=Ch(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(ia(void 0)));constructor(){this._dialogRefConstructor=k0,this._dialogContainerType=EW,this._dialogDataToken=ZD}open(e,n){let o;n=It(It({},this._defaultOptions||new Tw),n),n.id=n.id||this._idGenerator.getId("mat-mdc-dialog-"),n.scrollStrategy=n.scrollStrategy||this._scrollStrategy();let r=this._dialog.open(e,ji(It({},n),{positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:n},{provide:Em,useValue:n}]},templateContext:()=>({dialogRef:o}),providers:(g,w,T)=>(o=new this._dialogRefConstructor(g,n,T),o.updatePosition(n?.position),[{provide:this._dialogContainerType,useValue:T},{provide:this._dialogDataToken,useValue:w.data},{provide:this._dialogRefConstructor,useValue:o}])}));return o.componentRef=r.componentRef,o.componentInstance=r.componentInstance,this.openDialogs.push(o),this.afterOpened.next(o),o.afterClosed().subscribe(()=>{let g=this.openDialogs.indexOf(o);g>-1&&(this.openDialogs.splice(g,1),this.openDialogs.length||this._getAfterAllClosed().next())}),o}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(e){return this.openDialogs.find(n=>n.id===e)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(e){let n=e.length;for(;n--;)e[n].close()}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var DW=(()=>{class t{_dialogRef=J(k0,{optional:!0});_elementRef=J(Qi);_dialog=J(lu);constructor(){}ngOnInit(){this._dialogRef||(this._dialogRef=hme(this._elementRef,this._dialog.openDialogs)),this._dialogRef&&Promise.resolve().then(()=>{this._onAdd()})}ngOnDestroy(){this._dialogRef?._containerInstance&&Promise.resolve().then(()=>{this._onRemove()})}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t})}return t})(),LL=(()=>{class t extends DW{id=J(po).getId("mat-mdc-dialog-title-");_onAdd(){this._dialogRef._containerInstance?._addAriaLabelledBy?.(this.id)}_onRemove(){this._dialogRef?._containerInstance?._removeAriaLabelledBy?.(this.id)}static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275dir=vi({type:t,selectors:[["","mat-dialog-title",""],["","matDialogTitle",""]],hostAttrs:[1,"mat-mdc-dialog-title","mdc-dialog__title"],hostVars:1,hostBindings:function(n,o){n&2&&vs("id",o.id)},inputs:{id:"id"},exportAs:["matDialogTitle"],features:[Fn]})}return t})(),FL=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-mdc-dialog-content","mdc-dialog__content"],features:[k7([SL])]})}return t})(),zL=(()=>{class t extends DW{align;_onAdd(){this._dialogRef._containerInstance?._updateActionSectionCount?.(1)}_onRemove(){this._dialogRef._containerInstance?._updateActionSectionCount?.(-1)}static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275dir=vi({type:t,selectors:[["","mat-dialog-actions",""],["mat-dialog-actions"],["","matDialogActions",""]],hostAttrs:[1,"mat-mdc-dialog-actions","mdc-dialog__actions"],hostVars:6,hostBindings:function(n,o){n&2&&Ji("mat-mdc-dialog-actions-align-start",o.align==="start")("mat-mdc-dialog-actions-align-center",o.align==="center")("mat-mdc-dialog-actions-align-end",o.align==="end")},inputs:{align:"align"},features:[Fn]})}return t})();function hme(t,i){let e=t.nativeElement.parentElement;for(;e&&!e.classList.contains("mat-mdc-dialog-container");)e=e.parentElement;return e?i.find(n=>n.id===e.id):null}var O0=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({providers:[lu],imports:[hW,au,ju,Wn,Wn]})}return t})();var dv,IW=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function BL(){if(dv)return dv;if(typeof document!="object"||!document)return dv=new Set(IW),dv;let t=document.createElement("input");return dv=new Set(IW.filter(i=>(t.setAttribute("type",i),t.type===i))),dv}var qu=function(t){return t[t.FADING_IN=0]="FADING_IN",t[t.VISIBLE=1]="VISIBLE",t[t.FADING_OUT=2]="FADING_OUT",t[t.HIDDEN=3]="HIDDEN",t}(qu||{}),VL=class{_renderer;element;config;_animationForciblyDisabledThroughCss;state=qu.HIDDEN;constructor(i,e,n,o=!1){this._renderer=i,this.element=e,this.config=n,this._animationForciblyDisabledThroughCss=o}fadeOut(){this._renderer.fadeOutRipple(this)}},AW=ym({passive:!0,capture:!0}),jL=class{_events=new Map;addHandler(i,e,n,o){let r=this._events.get(e);if(r){let g=r.get(n);g?g.add(o):r.set(n,new Set([o]))}else this._events.set(e,new Map([[n,new Set([o])]])),i.runOutsideAngular(()=>{document.addEventListener(e,this._delegateEventHandler,AW)})}removeHandler(i,e,n){let o=this._events.get(i);if(!o)return;let r=o.get(e);r&&(r.delete(n),r.size===0&&o.delete(e),o.size===0&&(this._events.delete(i),document.removeEventListener(i,this._delegateEventHandler,AW)))}_delegateEventHandler=i=>{let e=Gl(i);e&&this._events.get(i.type)?.forEach((n,o)=>{(o===e||o.contains(e))&&n.forEach(r=>r.handleEvent(i))})}},Dw={enterDuration:225,exitDuration:150},pme=800,RW=ym({passive:!0,capture:!0}),kW=["mousedown","touchstart"],OW=["mouseup","mouseleave","touchend","touchcancel"],fme=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["ng-component"]],hostAttrs:["mat-ripple-style-loader",""],decls:0,vars:0,template:function(n,o){},styles:[`.mat-ripple{overflow:hidden;position:relative}.mat-ripple:not(:empty){transform:translateZ(0)}.mat-ripple.mat-ripple-unbounded{overflow:visible}.mat-ripple-element{position:absolute;border-radius:50%;pointer-events:none;transition:opacity,transform 0ms cubic-bezier(0, 0, 0.2, 1);transform:scale3d(0, 0, 0);background-color:var(--mat-ripple-color, color-mix(in srgb, var(--mat-sys-on-surface) 10%, transparent))}@media(forced-colors: active){.mat-ripple-element{display:none}}.cdk-drag-preview .mat-ripple-element,.cdk-drag-placeholder .mat-ripple-element{display:none}
`],encapsulation:2,changeDetection:0})}return t})(),Mw=class t{_target;_ngZone;_platform;_containerElement;_triggerElement;_isPointerDown=!1;_activeRipples=new Map;_mostRecentTransientRipple;_lastTouchStartEvent;_pointerUpEventsRegistered=!1;_containerRect;static _eventManager=new jL;constructor(i,e,n,o,r){this._target=i,this._ngZone=e,this._platform=o,o.isBrowser&&(this._containerElement=ou(n)),r&&r.get(Vo).load(fme)}fadeInRipple(i,e,n={}){let o=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),r=It(It({},Dw),n.animation);n.centered&&(i=o.left+o.width/2,e=o.top+o.height/2);let g=n.radius||mme(i,e,o),w=i-o.left,T=e-o.top,k=r.enterDuration,N=document.createElement("div");N.classList.add("mat-ripple-element"),N.style.left=`${w-g}px`,N.style.top=`${T-g}px`,N.style.height=`${g*2}px`,N.style.width=`${g*2}px`,n.color!=null&&(N.style.backgroundColor=n.color),N.style.transitionDuration=`${k}ms`,this._containerElement.appendChild(N);let V=window.getComputedStyle(N),q=V.transitionProperty,Z=V.transitionDuration,X=q==="none"||Z==="0s"||Z==="0s, 0s"||o.width===0&&o.height===0,te=new VL(this,N,n,X);N.style.transform="scale3d(1, 1, 1)",te.state=qu.FADING_IN,n.persistent||(this._mostRecentTransientRipple=te);let De=null;return!X&&(k||r.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let _e=()=>{De&&(De.fallbackTimer=null),clearTimeout(Ce),this._finishRippleTransition(te)},he=()=>this._destroyRipple(te),Ce=setTimeout(he,k+100);N.addEventListener("transitionend",_e),N.addEventListener("transitioncancel",he),De={onTransitionEnd:_e,onTransitionCancel:he,fallbackTimer:Ce}}),this._activeRipples.set(te,De),(X||!k)&&this._finishRippleTransition(te),te}fadeOutRipple(i){if(i.state===qu.FADING_OUT||i.state===qu.HIDDEN)return;let e=i.element,n=It(It({},Dw),i.config.animation);e.style.transitionDuration=`${n.exitDuration}ms`,e.style.opacity="0",i.state=qu.FADING_OUT,(i._animationForciblyDisabledThroughCss||!n.exitDuration)&&this._finishRippleTransition(i)}fadeOutAll(){this._getActiveRipples().forEach(i=>i.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(i=>{i.config.persistent||i.fadeOut()})}setupTriggerEvents(i){let e=ou(i);!this._platform.isBrowser||!e||e===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=e,kW.forEach(n=>{t._eventManager.addHandler(this._ngZone,n,e,this)}))}handleEvent(i){i.type==="mousedown"?this._onMousedown(i):i.type==="touchstart"?this._onTouchStart(i):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{OW.forEach(e=>{this._triggerElement.addEventListener(e,this,RW)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(i){i.state===qu.FADING_IN?this._startFadeOutTransition(i):i.state===qu.FADING_OUT&&this._destroyRipple(i)}_startFadeOutTransition(i){let e=i===this._mostRecentTransientRipple,{persistent:n}=i.config;i.state=qu.VISIBLE,!n&&(!e||!this._isPointerDown)&&i.fadeOut()}_destroyRipple(i){let e=this._activeRipples.get(i)??null;this._activeRipples.delete(i),this._activeRipples.size||(this._containerRect=null),i===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),i.state=qu.HIDDEN,e!==null&&(i.element.removeEventListener("transitionend",e.onTransitionEnd),i.element.removeEventListener("transitioncancel",e.onTransitionCancel),e.fallbackTimer!==null&&clearTimeout(e.fallbackTimer)),i.element.remove()}_onMousedown(i){let e=hw(i),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+pme;!this._target.rippleDisabled&&!e&&!n&&(this._isPointerDown=!0,this.fadeInRipple(i.clientX,i.clientY,this._target.rippleConfig))}_onTouchStart(i){if(!this._target.rippleDisabled&&!pw(i)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let e=i.changedTouches;if(e)for(let n=0;n<e.length;n++)this.fadeInRipple(e[n].clientX,e[n].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(i=>{let e=i.state===qu.VISIBLE||i.config.terminateOnPointerUp&&i.state===qu.FADING_IN;!i.config.persistent&&e&&i.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let i=this._triggerElement;i&&(kW.forEach(e=>t._eventManager.removeHandler(e,i,this)),this._pointerUpEventsRegistered&&(OW.forEach(e=>i.removeEventListener(e,this,RW)),this._pointerUpEventsRegistered=!1))}};function mme(t,i,e){let n=Math.max(Math.abs(t-e.left),Math.abs(t-e.right)),o=Math.max(Math.abs(i-e.top),Math.abs(i-e.bottom));return Math.sqrt(n*n+o*o)}var Iw=new Ot("mat-ripple-global-options"),YD=(()=>{class t{_elementRef=J(Qi);_animationMode=J(oo,{optional:!0});color;unbounded;centered;radius=0;animation;get disabled(){return this._disabled}set disabled(e){e&&this.fadeOutAllNonPersistent(),this._disabled=e,this._setupTriggerEventsIfEnabled()}_disabled=!1;get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}_trigger;_rippleRenderer;_globalOptions;_isInitialized=!1;constructor(){let e=J(Oi),n=J(Pr),o=J(Iw,{optional:!0}),r=J(wn);this._globalOptions=o||{},this._rippleRenderer=new Mw(this,e,this._elementRef,n,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:It(It(It({},this._globalOptions.animation),this._animationMode==="NoopAnimations"?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(e,n=0,o){return typeof e=="number"?this._rippleRenderer.fadeInRipple(e,n,It(It({},this.rippleConfig),o)):this._rippleRenderer.fadeInRipple(0,0,It(It({},this.rippleConfig),e))}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(n,o){n&2&&Ji("mat-ripple-unbounded",o.unbounded)},inputs:{color:[0,"matRippleColor","color"],unbounded:[0,"matRippleUnbounded","unbounded"],centered:[0,"matRippleCentered","centered"],radius:[0,"matRippleRadius","radius"],animation:[0,"matRippleAnimation","animation"],disabled:[0,"matRippleDisabled","disabled"],trigger:[0,"matRippleTrigger","trigger"]},exportAs:["matRipple"]})}return t})();var gme={capture:!0},_me=["focus","mousedown","mouseenter","touchstart"],UL="mat-ripple-loader-uninitialized",HL="mat-ripple-loader-class-name",PW="mat-ripple-loader-centered",KD="mat-ripple-loader-disabled",XD=(()=>{class t{_document=J(cn);_animationMode=J(oo,{optional:!0});_globalRippleOptions=J(Iw,{optional:!0});_platform=J(Pr);_ngZone=J(Oi);_injector=J(wn);_eventCleanups;_hosts=new Map;constructor(){let e=J(Fa).createRenderer(null,null);this._eventCleanups=this._ngZone.runOutsideAngular(()=>_me.map(n=>Sa(e,this._document,n,this._onInteraction,gme)))}ngOnDestroy(){let e=this._hosts.keys();for(let n of e)this.destroyRipple(n);this._eventCleanups.forEach(n=>n())}configureRipple(e,n){e.setAttribute(UL,this._globalRippleOptions?.namespace??""),(n.className||!e.hasAttribute(HL))&&e.setAttribute(HL,n.className||""),n.centered&&e.setAttribute(PW,""),n.disabled&&e.setAttribute(KD,"")}setDisabled(e,n){let o=this._hosts.get(e);o?(o.target.rippleDisabled=n,!n&&!o.hasSetUpEvents&&(o.hasSetUpEvents=!0,o.renderer.setupTriggerEvents(e))):n?e.setAttribute(KD,""):e.removeAttribute(KD)}_onInteraction=e=>{let n=Gl(e);if(n instanceof HTMLElement){let o=n.closest(`[${UL}="${this._globalRippleOptions?.namespace??""}"]`);o&&this._createRipple(o)}};_createRipple(e){if(!this._document||this._hosts.has(e))return;e.querySelector(".mat-ripple")?.remove();let n=this._document.createElement("span");n.classList.add("mat-ripple",e.getAttribute(HL)),e.append(n);let o=this._animationMode==="NoopAnimations",r=this._globalRippleOptions,g=o?0:r?.animation?.enterDuration??Dw.enterDuration,w=o?0:r?.animation?.exitDuration??Dw.exitDuration,T={rippleDisabled:o||r?.disabled||e.hasAttribute(KD),rippleConfig:{centered:e.hasAttribute(PW),terminateOnPointerUp:r?.terminateOnPointerUp,animation:{enterDuration:g,exitDuration:w}}},k=new Mw(T,this._ngZone,n,this._platform,this._injector),N=!T.rippleDisabled;N&&k.setupTriggerEvents(e),this._hosts.set(e,{target:T,renderer:k,hasSetUpEvents:N}),e.removeAttribute(UL)}destroyRipple(e){let n=this._hosts.get(e);n&&(n.renderer._removeTriggerEvents(),this._hosts.delete(e))}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var qd=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["structural-styles"]],decls:0,vars:0,template:function(n,o){},styles:[`.mat-focus-indicator{position:relative}.mat-focus-indicator::before{top:0;left:0;right:0;bottom:0;position:absolute;box-sizing:border-box;pointer-events:none;display:var(--mat-focus-indicator-display, none);border-width:var(--mat-focus-indicator-border-width, 3px);border-style:var(--mat-focus-indicator-border-style, solid);border-color:var(--mat-focus-indicator-border-color, transparent);border-radius:var(--mat-focus-indicator-border-radius, 4px)}.mat-focus-indicator:focus::before{content:""}@media(forced-colors: active){html{--mat-focus-indicator-display: block}}
`],encapsulation:2,changeDetection:0})}return t})();var yme=["mat-icon-button",""],vme=["*"];var bme=new Ot("MAT_BUTTON_CONFIG");var xme=[{attribute:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{attribute:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{attribute:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{attribute:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{attribute:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab-base","mat-mdc-fab"]},{attribute:"mat-mini-fab",mdcClasses:["mdc-fab","mat-mdc-fab-base","mdc-fab--mini","mat-mdc-mini-fab"]},{attribute:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],qL=(()=>{class t{_elementRef=J(Qi);_ngZone=J(Oi);_animationMode=J(oo,{optional:!0});_focusMonitor=J(Uu);_rippleLoader=J(XD);_isFab=!1;color;get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=e,this._updateRippleDisabled()}_disableRipple=!1;get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._updateRippleDisabled()}_disabled=!1;ariaDisabled;disabledInteractive;constructor(){J(Vo).load(qd);let e=J(bme,{optional:!0}),n=this._elementRef.nativeElement,o=n.classList;this.disabledInteractive=e?.disabledInteractive??!1,this.color=e?.color??null,this._rippleLoader?.configureRipple(n,{className:"mat-mdc-button-ripple"});for(let{attribute:r,mdcClasses:g}of xme)n.hasAttribute(r)&&o.add(...g)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(e="program",n){e?this._focusMonitor.focusVia(this._elementRef.nativeElement,e,n):this._elementRef.nativeElement.focus(n)}_getAriaDisabled(){return this.ariaDisabled!=null?this.ariaDisabled:this.disabled&&this.disabledInteractive?!0:null}_getDisabledAttribute(){return this.disabledInteractive||!this.disabled?null:!0}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,inputs:{color:"color",disableRipple:[2,"disableRipple","disableRipple",Bi],disabled:[2,"disabled","disabled",Bi],ariaDisabled:[2,"aria-disabled","ariaDisabled",Bi],disabledInteractive:[2,"disabledInteractive","disabledInteractive",Bi]}})}return t})();var wl=(()=>{class t extends qL{constructor(){super(),this._rippleLoader.configureRipple(this._elementRef.nativeElement,{centered:!0})}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["button","mat-icon-button",""]],hostVars:14,hostBindings:function(n,o){n&2&&(un("disabled",o._getDisabledAttribute())("aria-disabled",o._getAriaDisabled()),ql(o.color?"mat-"+o.color:""),Ji("mat-mdc-button-disabled",o.disabled)("mat-mdc-button-disabled-interactive",o.disabledInteractive)("_mat-animation-noopable",o._animationMode==="NoopAnimations")("mat-unthemed",!o.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],features:[Fn],attrs:yme,ngContentSelectors:vme,decls:4,vars:0,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(n,o){n&1&&(Qr(),jt(0,"span",0),On(1),jt(2,"span",1)(3,"span",2))},styles:[`.mat-mdc-icon-button{-webkit-user-select:none;user-select:none;display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;z-index:0;overflow:visible;border-radius:50%;flex-shrink:0;text-align:center;width:var(--mdc-icon-button-state-layer-size, 40px);height:var(--mdc-icon-button-state-layer-size, 40px);padding:calc(calc(var(--mdc-icon-button-state-layer-size, 40px) - var(--mdc-icon-button-icon-size, 24px)) / 2);font-size:var(--mdc-icon-button-icon-size, 24px);color:var(--mdc-icon-button-icon-color, var(--mat-sys-on-surface-variant));-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-icon-button .mdc-button__label,.mat-mdc-icon-button .mat-icon{z-index:1;position:relative}.mat-mdc-icon-button .mat-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus>.mat-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-icon-button-ripple-color, color-mix(in srgb, var(--mat-sys-on-surface-variant) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-icon-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-icon-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-icon-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-icon-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-icon-button-touch-target-display, block)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button[disabled],.mat-mdc-icon-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-icon-button-disabled-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-icon-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-icon-button img,.mat-mdc-icon-button svg{width:var(--mdc-icon-button-icon-size, 24px);height:var(--mdc-icon-button-icon-size, 24px);vertical-align:baseline}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button[hidden]{display:none}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}
`,`@media(forced-colors: active){.mat-mdc-button:not(.mdc-button--outlined),.mat-mdc-unelevated-button:not(.mdc-button--outlined),.mat-mdc-raised-button:not(.mdc-button--outlined),.mat-mdc-outlined-button:not(.mdc-button--outlined),.mat-mdc-icon-button.mat-mdc-icon-button,.mat-mdc-outlined-button .mdc-button__ripple{outline:solid 1px}}
`],encapsulation:2,changeDetection:0})}return t})();var hv=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({imports:[Wn,Wn]})}return t})();var wme=["mat-button",""],Eme=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],Cme=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"];var Wl=(()=>{class t extends qL{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275cmp=ai({type:t,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:14,hostBindings:function(n,o){n&2&&(un("disabled",o._getDisabledAttribute())("aria-disabled",o._getAriaDisabled()),ql(o.color?"mat-"+o.color:""),Ji("mat-mdc-button-disabled",o.disabled)("mat-mdc-button-disabled-interactive",o.disabledInteractive)("_mat-animation-noopable",o._animationMode==="NoopAnimations")("mat-unthemed",!o.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],features:[Fn],attrs:wme,ngContentSelectors:Cme,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(n,o){n&1&&(Qr(Eme),jt(0,"span",0),On(1),ae(2,"span",1),On(3,1),se(),On(4,2),jt(5,"span",2)(6,"span",3)),n&2&&Ji("mdc-button__ripple",!o._isFab)("mdc-fab__ripple",o._isFab)},styles:[`.mat-mdc-button-base{text-decoration:none}.mdc-button{-webkit-user-select:none;user-select:none;position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0);padding:0 8px}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__label{position:relative}.mat-mdc-button{padding:0 var(--mat-text-button-horizontal-padding, 12px);height:var(--mdc-text-button-container-height, 40px);font-family:var(--mdc-text-button-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mdc-text-button-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mdc-text-button-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mdc-text-button-label-text-transform);font-weight:var(--mdc-text-button-label-text-weight, var(--mat-sys-label-large-weight))}.mat-mdc-button,.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mat-sys-corner-full))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, var(--mat-sys-primary))}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-text-button-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-text-button-with-icon-horizontal-padding, 16px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-offset, -4px);margin-left:var(--mat-text-button-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-offset, -4px);margin-left:var(--mat-text-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, -4px)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-text-button-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-state-layer-color, var(--mat-sys-primary))}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-text-button-touch-target-display, block)}.mat-mdc-unelevated-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mdc-filled-button-container-height, 40px);font-family:var(--mdc-filled-button-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mdc-filled-button-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mdc-filled-button-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mdc-filled-button-label-text-transform);font-weight:var(--mdc-filled-button-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-filled-button-horizontal-padding, 24px)}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -8px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -8px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -8px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -8px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-filled-button-ripple-color, color-mix(in srgb, var(--mat-sys-on-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-state-layer-color, var(--mat-sys-on-primary))}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-unelevated-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-unelevated-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-unelevated-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-filled-button-touch-target-display, block)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, var(--mat-sys-on-primary));background-color:var(--mdc-filled-button-container-color, var(--mat-sys-primary))}.mat-mdc-unelevated-button,.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mat-sys-corner-full))}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-filled-button-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mdc-filled-button-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);box-shadow:var(--mdc-protected-button-container-elevation-shadow, var(--mat-sys-level1));height:var(--mdc-protected-button-container-height, 40px);font-family:var(--mdc-protected-button-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mdc-protected-button-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mdc-protected-button-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mdc-protected-button-label-text-transform);font-weight:var(--mdc-protected-button-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-protected-button-horizontal-padding, 24px)}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -8px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -8px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -8px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -8px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-protected-button-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-state-layer-color, var(--mat-sys-primary))}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-raised-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-raised-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-raised-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-protected-button-touch-target-display, block)}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, var(--mat-sys-primary));background-color:var(--mdc-protected-button-container-color, var(--mat-sys-surface))}.mat-mdc-raised-button,.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mat-sys-corner-full))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation-shadow, var(--mat-sys-level2))}.mat-mdc-raised-button:focus{box-shadow:var(--mdc-protected-button-focus-container-elevation-shadow, var(--mat-sys-level1))}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mdc-protected-button-pressed-container-elevation-shadow, var(--mat-sys-level1))}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-protected-button-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mdc-protected-button-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation-shadow, var(--mat-sys-level0))}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mdc-outlined-button-container-height, 40px);font-family:var(--mdc-outlined-button-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mdc-outlined-button-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mdc-outlined-button-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mdc-outlined-button-label-text-transform);font-weight:var(--mdc-outlined-button-label-text-weight, var(--mat-sys-label-large-weight));border-radius:var(--mdc-outlined-button-container-shape, var(--mat-sys-corner-full));border-width:var(--mdc-outlined-button-outline-width, 1px);padding:0 var(--mat-outlined-button-horizontal-padding, 24px)}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -8px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -8px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -8px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -8px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-outlined-button-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-state-layer-color, var(--mat-sys-primary))}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-outlined-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-outlined-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-outlined-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-outlined-button-touch-target-display, block)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, var(--mat-sys-primary));border-color:var(--mdc-outlined-button-outline-color, var(--mat-sys-outline))}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-outlined-button-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));border-color:var(--mdc-outlined-button-disabled-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-button .mat-icon,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-unelevated-button .mat-icon,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-raised-button .mat-icon,.mat-mdc-outlined-button .mdc-button__label,.mat-mdc-outlined-button .mat-icon{z-index:1;position:relative}.mat-mdc-button .mat-focus-indicator,.mat-mdc-unelevated-button .mat-focus-indicator,.mat-mdc-raised-button .mat-focus-indicator,.mat-mdc-outlined-button .mat-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus>.mat-focus-indicator::before,.mat-mdc-unelevated-button:focus>.mat-focus-indicator::before,.mat-mdc-raised-button:focus>.mat-focus-indicator::before,.mat-mdc-outlined-button:focus>.mat-focus-indicator::before{content:""}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px}.mat-mdc-unelevated-button .mat-focus-indicator::before,.mat-mdc-raised-button .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px)*-1)}
`,`@media(forced-colors: active){.mat-mdc-button:not(.mdc-button--outlined),.mat-mdc-unelevated-button:not(.mdc-button--outlined),.mat-mdc-raised-button:not(.mdc-button--outlined),.mat-mdc-outlined-button:not(.mdc-button--outlined),.mat-mdc-icon-button.mat-mdc-icon-button,.mat-mdc-outlined-button .mdc-button__ripple{outline:solid 1px}}
`],encapsulation:2,changeDetection:0})}return t})();var Fs=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({imports:[Wn,hv,Wn]})}return t})();var HW=(()=>{class t{_renderer;_elementRef;onChange=e=>{};onTouched=()=>{};constructor(e,n){this._renderer=e,this._elementRef=n}setProperty(e,n){this._renderer.setProperty(this._elementRef.nativeElement,e,n)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static \u0275fac=function(n){return new(n||t)(Ci(Ko),Ci(Qi))};static \u0275dir=vi({type:t})}return t})(),qW=(()=>{class t extends HW{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275dir=vi({type:t,features:[Fn]})}return t})(),qh=new Ot("");var Sme={provide:qh,useExisting:Ka(()=>jo),multi:!0};function Tme(){let t=Qs()?Qs().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var Dme=new Ot(""),jo=(()=>{class t extends HW{_compositionMode;_composing=!1;constructor(e,n,o){super(e,n),this._compositionMode=o,this._compositionMode==null&&(this._compositionMode=!Tme())}writeValue(e){let n=e??"";this.setProperty("value",n)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static \u0275fac=function(n){return new(n||t)(Ci(Ko),Ci(Qi),Ci(Dme,8))};static \u0275dir=vi({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,o){n&1&&Nt("input",function(g){return o._handleInput(g.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(g){return o._compositionEnd(g.target.value)})},standalone:!1,features:[fr([Sme]),Fn]})}return t})();function ZL(t){return t==null||YL(t)===0}function YL(t){return t==null?null:Array.isArray(t)||typeof t=="string"?t.length:t instanceof Set?t.size:null}var $d=new Ot(""),cM=new Ot(""),Mme=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Ti=class{static min(i){return $W(i)}static max(i){return Ime(i)}static required(i){return GW(i)}static requiredTrue(i){return Ame(i)}static email(i){return Rme(i)}static minLength(i){return kme(i)}static maxLength(i){return WW(i)}static pattern(i){return Ome(i)}static nullValidator(i){return JD()}static compose(i){return JW(i)}static composeAsync(i){return eZ(i)}};function $W(t){return i=>{if(i.value==null||t==null)return null;let e=parseFloat(i.value);return!isNaN(e)&&e<t?{min:{min:t,actual:i.value}}:null}}function Ime(t){return i=>{if(i.value==null||t==null)return null;let e=parseFloat(i.value);return!isNaN(e)&&e>t?{max:{max:t,actual:i.value}}:null}}function GW(t){return ZL(t.value)?{required:!0}:null}function Ame(t){return t.value===!0?null:{required:!0}}function Rme(t){return ZL(t.value)||Mme.test(t.value)?null:{email:!0}}function kme(t){return i=>{let e=i.value?.length??YL(i.value);return e===null||e===0?null:e<t?{minlength:{requiredLength:t,actualLength:e}}:null}}function WW(t){return i=>{let e=i.value?.length??YL(i.value);return e!==null&&e>t?{maxlength:{requiredLength:t,actualLength:e}}:null}}function Ome(t){if(!t)return JD;let i,e;return typeof t=="string"?(e="",t.charAt(0)!=="^"&&(e+="^"),e+=t,t.charAt(t.length-1)!=="$"&&(e+="$"),i=new RegExp(e)):(e=t.toString(),i=t),n=>{if(ZL(n.value))return null;let o=n.value;return i.test(o)?null:{pattern:{requiredPattern:e,actualValue:o}}}}function JD(t){return null}function ZW(t){return t!=null}function YW(t){return im(t)?bo(t):t}function KW(t){let i={};return t.forEach(e=>{i=e!=null?It(It({},i),e):i}),Object.keys(i).length===0?null:i}function XW(t,i){return i.map(e=>e(t))}function Pme(t){return!t.validate}function QW(t){return t.map(i=>Pme(i)?i:e=>i.validate(e))}function JW(t){if(!t)return null;let i=t.filter(ZW);return i.length==0?null:function(e){return KW(XW(e,i))}}function KL(t){return t!=null?JW(QW(t)):null}function eZ(t){if(!t)return null;let i=t.filter(ZW);return i.length==0?null:function(e){let n=XW(e,i).map(YW);return I1(n).pipe(hn(KW))}}function XL(t){return t!=null?eZ(QW(t)):null}function NW(t,i){return t===null?[i]:Array.isArray(t)?[...t,i]:[t,i]}function tZ(t){return t._rawValidators}function iZ(t){return t._rawAsyncValidators}function $L(t){return t?Array.isArray(t)?t:[t]:[]}function eM(t,i){return Array.isArray(t)?t.includes(i):t===i}function LW(t,i){let e=$L(i);return $L(t).forEach(o=>{eM(e,o)||e.push(o)}),e}function FW(t,i){return $L(i).filter(e=>!eM(t,e))}var tM=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(i){this._rawValidators=i||[],this._composedValidatorFn=KL(this._rawValidators)}_setAsyncValidators(i){this._rawAsyncValidators=i||[],this._composedAsyncValidatorFn=XL(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(i){this._onDestroyCallbacks.push(i)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(i=>i()),this._onDestroyCallbacks=[]}reset(i=void 0){this.control&&this.control.reset(i)}hasError(i,e){return this.control?this.control.hasError(i,e):!1}getError(i,e){return this.control?this.control.getError(i,e):null}},Hh=class extends tM{name;get formDirective(){return null}get path(){return null}},cu=class extends tM{_parent=null;name=null;valueAccessor=null},iM=class{_cd;constructor(i){this._cd=i}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},Nme={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},T4e=ji(It({},Nme),{"[class.ng-submitted]":"isSubmitted"}),la=(()=>{class t extends iM{constructor(e){super(e)}static \u0275fac=function(n){return new(n||t)(Ci(cu,2))};static \u0275dir=vi({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,o){n&2&&Ji("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},standalone:!1,features:[Fn]})}return t})(),ts=(()=>{class t extends iM{constructor(e){super(e)}static \u0275fac=function(n){return new(n||t)(Ci(Hh,10))};static \u0275dir=vi({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,o){n&2&&Ji("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)("ng-submitted",o.isSubmitted)},standalone:!1,features:[Fn]})}return t})();var Aw="VALID",QD="INVALID",fv="PENDING",Rw="DISABLED",Cm=class{},nM=class extends Cm{value;source;constructor(i,e){super(),this.value=i,this.source=e}},Ow=class extends Cm{pristine;source;constructor(i,e){super(),this.pristine=i,this.source=e}},Pw=class extends Cm{touched;source;constructor(i,e){super(),this.touched=i,this.source=e}},mv=class extends Cm{status;source;constructor(i,e){super(),this.status=i,this.source=e}},rM=class extends Cm{source;constructor(i){super(),this.source=i}},oM=class extends Cm{source;constructor(i){super(),this.source=i}};function QL(t){return(uM(t)?t.validators:t)||null}function Lme(t){return Array.isArray(t)?KL(t):t||null}function JL(t,i){return(uM(i)?i.asyncValidators:t)||null}function Fme(t){return Array.isArray(t)?XL(t):t||null}function uM(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function nZ(t,i,e){let n=t.controls;if(!(i?Object.keys(n):n).length)throw new si(1e3,"");if(!n[e])throw new si(1001,"")}function rZ(t,i,e){t._forEachChild((n,o)=>{if(e[o]===void 0)throw new si(1002,"")})}var gv=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(i,e){this._assignValidators(i),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(i){this._rawValidators=this._composedValidatorFn=i}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(i){this._rawAsyncValidators=this._composedAsyncValidatorFn=i}get parent(){return this._parent}get status(){return xc(this.statusReactive)}set status(i){xc(()=>this.statusReactive.set(i))}_status=wc(()=>this.statusReactive());statusReactive=ma(void 0);get valid(){return this.status===Aw}get invalid(){return this.status===QD}get pending(){return this.status==fv}get disabled(){return this.status===Rw}get enabled(){return this.status!==Rw}errors;get pristine(){return xc(this.pristineReactive)}set pristine(i){xc(()=>this.pristineReactive.set(i))}_pristine=wc(()=>this.pristineReactive());pristineReactive=ma(!0);get dirty(){return!this.pristine}get touched(){return xc(this.touchedReactive)}set touched(i){xc(()=>this.touchedReactive.set(i))}_touched=wc(()=>this.touchedReactive());touchedReactive=ma(!1);get untouched(){return!this.touched}_events=new gi;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(i){this._assignValidators(i)}setAsyncValidators(i){this._assignAsyncValidators(i)}addValidators(i){this.setValidators(LW(i,this._rawValidators))}addAsyncValidators(i){this.setAsyncValidators(LW(i,this._rawAsyncValidators))}removeValidators(i){this.setValidators(FW(i,this._rawValidators))}removeAsyncValidators(i){this.setAsyncValidators(FW(i,this._rawAsyncValidators))}hasValidator(i){return eM(this._rawValidators,i)}hasAsyncValidator(i){return eM(this._rawAsyncValidators,i)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(i={}){let e=this.touched===!1;this.touched=!0;let n=i.sourceControl??this;this._parent&&!i.onlySelf&&this._parent.markAsTouched(ji(It({},i),{sourceControl:n})),e&&i.emitEvent!==!1&&this._events.next(new Pw(!0,n))}markAllAsTouched(i={}){this.markAsTouched({onlySelf:!0,emitEvent:i.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsTouched(i))}markAsUntouched(i={}){let e=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let n=i.sourceControl??this;this._forEachChild(o=>{o.markAsUntouched({onlySelf:!0,emitEvent:i.emitEvent,sourceControl:n})}),this._parent&&!i.onlySelf&&this._parent._updateTouched(i,n),e&&i.emitEvent!==!1&&this._events.next(new Pw(!1,n))}markAsDirty(i={}){let e=this.pristine===!0;this.pristine=!1;let n=i.sourceControl??this;this._parent&&!i.onlySelf&&this._parent.markAsDirty(ji(It({},i),{sourceControl:n})),e&&i.emitEvent!==!1&&this._events.next(new Ow(!1,n))}markAsPristine(i={}){let e=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let n=i.sourceControl??this;this._forEachChild(o=>{o.markAsPristine({onlySelf:!0,emitEvent:i.emitEvent})}),this._parent&&!i.onlySelf&&this._parent._updatePristine(i,n),e&&i.emitEvent!==!1&&this._events.next(new Ow(!0,n))}markAsPending(i={}){this.status=fv;let e=i.sourceControl??this;i.emitEvent!==!1&&(this._events.next(new mv(this.status,e)),this.statusChanges.emit(this.status)),this._parent&&!i.onlySelf&&this._parent.markAsPending(ji(It({},i),{sourceControl:e}))}disable(i={}){let e=this._parentMarkedDirty(i.onlySelf);this.status=Rw,this.errors=null,this._forEachChild(o=>{o.disable(ji(It({},i),{onlySelf:!0}))}),this._updateValue();let n=i.sourceControl??this;i.emitEvent!==!1&&(this._events.next(new nM(this.value,n)),this._events.next(new mv(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ji(It({},i),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(o=>o(!0))}enable(i={}){let e=this._parentMarkedDirty(i.onlySelf);this.status=Aw,this._forEachChild(n=>{n.enable(ji(It({},i),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:i.emitEvent}),this._updateAncestors(ji(It({},i),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(i,e){this._parent&&!i.onlySelf&&(this._parent.updateValueAndValidity(i),i.skipPristineCheck||this._parent._updatePristine({},e),this._parent._updateTouched({},e))}setParent(i){this._parent=i}getRawValue(){return this.value}updateValueAndValidity(i={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let n=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Aw||this.status===fv)&&this._runAsyncValidator(n,i.emitEvent)}let e=i.sourceControl??this;i.emitEvent!==!1&&(this._events.next(new nM(this.value,e)),this._events.next(new mv(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!i.onlySelf&&this._parent.updateValueAndValidity(ji(It({},i),{sourceControl:e}))}_updateTreeValidity(i={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(i)),this.updateValueAndValidity({onlySelf:!0,emitEvent:i.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Rw:Aw}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(i,e){if(this.asyncValidator){this.status=fv,this._hasOwnPendingAsyncValidator={emitEvent:e!==!1};let n=YW(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(o=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(o,{emitEvent:e,shouldHaveEmitted:i})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let i=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,i}return!1}setErrors(i,e={}){this.errors=i,this._updateControlsErrors(e.emitEvent!==!1,this,e.shouldHaveEmitted)}get(i){let e=i;return e==null||(Array.isArray(e)||(e=e.split(".")),e.length===0)?null:e.reduce((n,o)=>n&&n._find(o),this)}getError(i,e){let n=e?this.get(e):this;return n&&n.errors?n.errors[i]:null}hasError(i,e){return!!this.getError(i,e)}get root(){let i=this;for(;i._parent;)i=i._parent;return i}_updateControlsErrors(i,e,n){this.status=this._calculateStatus(),i&&this.statusChanges.emit(this.status),(i||n)&&this._events.next(new mv(this.status,e)),this._parent&&this._parent._updateControlsErrors(i,e,n)}_initObservables(){this.valueChanges=new Mi,this.statusChanges=new Mi}_calculateStatus(){return this._allControlsDisabled()?Rw:this.errors?QD:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(fv)?fv:this._anyControlsHaveStatus(QD)?QD:Aw}_anyControlsHaveStatus(i){return this._anyControls(e=>e.status===i)}_anyControlsDirty(){return this._anyControls(i=>i.dirty)}_anyControlsTouched(){return this._anyControls(i=>i.touched)}_updatePristine(i,e){let n=!this._anyControlsDirty(),o=this.pristine!==n;this.pristine=n,this._parent&&!i.onlySelf&&this._parent._updatePristine(i,e),o&&this._events.next(new Ow(this.pristine,e))}_updateTouched(i={},e){this.touched=this._anyControlsTouched(),this._events.next(new Pw(this.touched,e)),this._parent&&!i.onlySelf&&this._parent._updateTouched(i,e)}_onDisabledChange=[];_registerOnCollectionChange(i){this._onCollectionChange=i}_setUpdateStrategy(i){uM(i)&&i.updateOn!=null&&(this._updateOn=i.updateOn)}_parentMarkedDirty(i){let e=this._parent&&this._parent.dirty;return!i&&!!e&&!this._parent._anyControlsDirty()}_find(i){return null}_assignValidators(i){this._rawValidators=Array.isArray(i)?i.slice():i,this._composedValidatorFn=Lme(this._rawValidators)}_assignAsyncValidators(i){this._rawAsyncValidators=Array.isArray(i)?i.slice():i,this._composedAsyncValidatorFn=Fme(this._rawAsyncValidators)}},_v=class extends gv{constructor(i,e,n){super(QL(e),JL(n,e)),this.controls=i,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(i,e){return this.controls[i]?this.controls[i]:(this.controls[i]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(i,e,n={}){this.registerControl(i,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(i,e={}){this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),delete this.controls[i],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(i,e,n={}){this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),delete this.controls[i],e&&this.registerControl(i,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(i){return this.controls.hasOwnProperty(i)&&this.controls[i].enabled}setValue(i,e={}){rZ(this,!0,i),Object.keys(i).forEach(n=>{nZ(this,!0,n),this.controls[n].setValue(i[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(i,e={}){i!=null&&(Object.keys(i).forEach(n=>{let o=this.controls[n];o&&o.patchValue(i[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(i={},e={}){this._forEachChild((n,o)=>{n.reset(i?i[o]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(i,e,n)=>(i[n]=e.getRawValue(),i))}_syncPendingControls(){let i=this._reduceChildren(!1,(e,n)=>n._syncPendingControls()?!0:e);return i&&this.updateValueAndValidity({onlySelf:!0}),i}_forEachChild(i){Object.keys(this.controls).forEach(e=>{let n=this.controls[e];n&&i(n,e)})}_setUpControls(){this._forEachChild(i=>{i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(i){for(let[e,n]of Object.entries(this.controls))if(this.contains(e)&&i(n))return!0;return!1}_reduceValue(){let i={};return this._reduceChildren(i,(e,n,o)=>((n.enabled||this.disabled)&&(e[o]=n.value),e))}_reduceChildren(i,e){let n=i;return this._forEachChild((o,r)=>{n=e(n,o,r)}),n}_allControlsDisabled(){for(let i of Object.keys(this.controls))if(this.controls[i].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(i){return this.controls.hasOwnProperty(i)?this.controls[i]:null}};var GL=class extends _v{};var Nw=new Ot("",{providedIn:"root",factory:()=>dM}),dM="always";function oZ(t,i){return[...i.path,t]}function aM(t,i,e=dM){e4(t,i),i.valueAccessor.writeValue(t.value),(t.disabled||e==="always")&&i.valueAccessor.setDisabledState?.(t.disabled),Bme(t,i),jme(t,i),Vme(t,i),zme(t,i)}function zW(t,i,e=!0){let n=()=>{};i.valueAccessor&&(i.valueAccessor.registerOnChange(n),i.valueAccessor.registerOnTouched(n)),lM(t,i),t&&(i._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function sM(t,i){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(i)})}function zme(t,i){if(i.valueAccessor.setDisabledState){let e=n=>{i.valueAccessor.setDisabledState(n)};t.registerOnDisabledChange(e),i._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}function e4(t,i){let e=tZ(t);i.validator!==null?t.setValidators(NW(e,i.validator)):typeof e=="function"&&t.setValidators([e]);let n=iZ(t);i.asyncValidator!==null?t.setAsyncValidators(NW(n,i.asyncValidator)):typeof n=="function"&&t.setAsyncValidators([n]);let o=()=>t.updateValueAndValidity();sM(i._rawValidators,o),sM(i._rawAsyncValidators,o)}function lM(t,i){let e=!1;if(t!==null){if(i.validator!==null){let o=tZ(t);if(Array.isArray(o)&&o.length>0){let r=o.filter(g=>g!==i.validator);r.length!==o.length&&(e=!0,t.setValidators(r))}}if(i.asyncValidator!==null){let o=iZ(t);if(Array.isArray(o)&&o.length>0){let r=o.filter(g=>g!==i.asyncValidator);r.length!==o.length&&(e=!0,t.setAsyncValidators(r))}}}let n=()=>{};return sM(i._rawValidators,n),sM(i._rawAsyncValidators,n),e}function Bme(t,i){i.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&aZ(t,i)})}function Vme(t,i){i.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&aZ(t,i),t.updateOn!=="submit"&&t.markAsTouched()})}function aZ(t,i){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),i.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function jme(t,i){let e=(n,o)=>{i.valueAccessor.writeValue(n),o&&i.viewToModelUpdate(n)};t.registerOnChange(e),i._registerOnDestroy(()=>{t._unregisterOnChange(e)})}function sZ(t,i){t==null,e4(t,i)}function Ume(t,i){return lM(t,i)}function lZ(t,i){if(!t.hasOwnProperty("model"))return!1;let e=t.model;return e.isFirstChange()?!0:!Object.is(i,e.currentValue)}function Hme(t){return Object.getPrototypeOf(t.constructor)===qW}function cZ(t,i){t._syncPendingControls(),i.forEach(e=>{let n=e.control;n.updateOn==="submit"&&n._pendingChange&&(e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function uZ(t,i){if(!i)return null;Array.isArray(i);let e,n,o;return i.forEach(r=>{r.constructor===jo?e=r:Hme(r)?n=r:o=r}),o||n||e||null}function qme(t,i){let e=t.indexOf(i);e>-1&&t.splice(e,1)}var $me={provide:Hh,useExisting:Ka(()=>P0)},kw=Promise.resolve(),P0=(()=>{class t extends Hh{callSetDisabledState;get submitted(){return xc(this.submittedReactive)}_submitted=wc(()=>this.submittedReactive());submittedReactive=ma(!1);_directives=new Set;form;ngSubmit=new Mi;options;constructor(e,n,o){super(),this.callSetDisabledState=o,this.form=new _v({},KL(e),XL(n))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){kw.then(()=>{let n=this._findContainer(e.path);e.control=n.registerControl(e.name,e.control),aM(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){kw.then(()=>{let n=this._findContainer(e.path);n&&n.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){kw.then(()=>{let n=this._findContainer(e.path),o=new _v({});sZ(o,e),n.registerControl(e.name,o),o.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){kw.then(()=>{let n=this._findContainer(e.path);n&&n.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,n){kw.then(()=>{this.form.get(e.path).setValue(n)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submittedReactive.set(!0),cZ(this.form,this._directives),this.ngSubmit.emit(e),this.form._events.next(new rM(this.control)),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submittedReactive.set(!1),this.form._events.next(new oM(this.form))}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}static \u0275fac=function(n){return new(n||t)(Ci($d,10),Ci(cM,10),Ci(Nw,8))};static \u0275dir=vi({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(n,o){n&1&&Nt("submit",function(g){return o.onSubmit(g)})("reset",function(){return o.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[fr([$me]),Fn]})}return t})();function BW(t,i){let e=t.indexOf(i);e>-1&&t.splice(e,1)}function VW(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var Ro=class extends gv{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(i=null,e,n){super(QL(e),JL(n,e)),this._applyFormState(i),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),uM(e)&&(e.nonNullable||e.initialValueIsDefault)&&(VW(i)?this.defaultValue=i.value:this.defaultValue=i)}setValue(i,e={}){this.value=this._pendingValue=i,this._onChange.length&&e.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,e.emitViewToModelChange!==!1)),this.updateValueAndValidity(e)}patchValue(i,e={}){this.setValue(i,e)}reset(i=this.defaultValue,e={}){this._applyFormState(i),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(i){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(i){this._onChange.push(i)}_unregisterOnChange(i){BW(this._onChange,i)}registerOnDisabledChange(i){this._onDisabledChange.push(i)}_unregisterOnDisabledChange(i){BW(this._onDisabledChange,i)}_forEachChild(i){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(i){VW(i)?(this.value=this._pendingValue=i.value,i.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=i}};var Gme=t=>t instanceof Ro;var Wme={provide:cu,useExisting:Ka(()=>Lw)},jW=Promise.resolve(),Lw=(()=>{class t extends cu{_changeDetectorRef;callSetDisabledState;control=new Ro;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new Mi;constructor(e,n,o,r,g,w){super(),this._changeDetectorRef=g,this.callSetDisabledState=w,this._parent=e,this._setValidators(n),this._setAsyncValidators(o),this.valueAccessor=uZ(this,r)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){let n=e.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),lZ(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){aM(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(e){jW.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){let n=e.isDisabled.currentValue,o=n!==0&&Bi(n);jW.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?oZ(e,this._parent):[e]}static \u0275fac=function(n){return new(n||t)(Ci(Hh,9),Ci($d,10),Ci(cM,10),Ci(qh,10),Ci(vr,8),Ci(Nw,8))};static \u0275dir=vi({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[fr([Wme]),Fn,$r]})}return t})();var is=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return t})(),Zme={provide:qh,useExisting:Ka(()=>N0),multi:!0},N0=(()=>{class t extends qW{writeValue(e){let n=e??"";this.setProperty("value",n)}registerOnChange(e){this.onChange=n=>{e(n==""?null:parseFloat(n))}}static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275dir=vi({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(n,o){n&1&&Nt("input",function(g){return o.onChange(g.target.value)})("blur",function(){return o.onTouched()})},standalone:!1,features:[fr([Zme]),Fn]})}return t})();var dZ=new Ot("");var Yme={provide:Hh,useExisting:Ka(()=>ko)},ko=(()=>{class t extends Hh{callSetDisabledState;get submitted(){return xc(this._submittedReactive)}set submitted(e){this._submittedReactive.set(e)}_submitted=wc(()=>this._submittedReactive());_submittedReactive=ma(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new Mi;constructor(e,n,o){super(),this.callSetDisabledState=o,this._setValidators(e),this._setAsyncValidators(n)}ngOnChanges(e){e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(lM(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){let n=this.form.get(e.path);return aM(n,e,this.callSetDisabledState),n.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),n}getControl(e){return this.form.get(e.path)}removeControl(e){zW(e.control||null,e,!1),qme(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,n){this.form.get(e.path).setValue(n)}onSubmit(e){return this._submittedReactive.set(!0),cZ(this.form,this.directives),this.ngSubmit.emit(e),this.form._events.next(new rM(this.control)),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this._submittedReactive.set(!1),this.form._events.next(new oM(this.form))}_updateDomValue(){this.directives.forEach(e=>{let n=e.control,o=this.form.get(e.path);n!==o&&(zW(n||null,e),Gme(o)&&(aM(o,e,this.callSetDisabledState),e.control=o))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){let n=this.form.get(e.path);sZ(n,e),n.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){let n=this.form.get(e.path);n&&Ume(n,e)&&n.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){e4(this.form,this),this._oldForm&&lM(this._oldForm,this)}static \u0275fac=function(n){return new(n||t)(Ci($d,10),Ci(cM,10),Ci(Nw,8))};static \u0275dir=vi({type:t,selectors:[["","formGroup",""]],hostBindings:function(n,o){n&1&&Nt("submit",function(g){return o.onSubmit(g)})("reset",function(){return o.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[fr([Yme]),Fn,$r]})}return t})();var Kme={provide:cu,useExisting:Ka(()=>Ua)},Ua=(()=>{class t extends cu{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(e){}model;update=new Mi;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(e,n,o,r,g){super(),this._ngModelWarningConfig=g,this._parent=e,this._setValidators(n),this._setAsyncValidators(o),this.valueAccessor=uZ(this,r)}ngOnChanges(e){this._added||this._setUpControl(),lZ(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return oZ(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(n){return new(n||t)(Ci(Hh,13),Ci($d,10),Ci(cM,10),Ci(qh,10),Ci(dZ,8))};static \u0275dir=vi({type:t,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[fr([Kme]),Fn,$r]})}return t})();function Xme(t){return typeof t=="number"?t:parseInt(t,10)}function Qme(t){return typeof t=="number"?t:parseFloat(t)}var t4=(()=>{class t{_validator=JD;_onChange;_enabled;ngOnChanges(e){if(this.inputName in e){let n=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(n),this._validator=this._enabled?this.createValidator(n):JD,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return e!=null}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,features:[$r]})}return t})();var Jme={provide:$d,useExisting:Ka(()=>i4),multi:!0},i4=(()=>{class t extends t4{min;inputName="min";normalizeInput=e=>Qme(e);createValidator=e=>$W(e);static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275dir=vi({type:t,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(n,o){n&2&&un("min",o._enabled?o.min:null)},inputs:{min:"min"},standalone:!1,features:[fr([Jme]),Fn]})}return t})(),ege={provide:$d,useExisting:Ka(()=>n4),multi:!0};var n4=(()=>{class t extends t4{required;inputName="required";normalizeInput=Bi;createValidator=e=>GW;enabled(e){return e}static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275dir=vi({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(n,o){n&2&&un("required",o._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[fr([ege]),Fn]})}return t})();var tge={provide:$d,useExisting:Ka(()=>Fw),multi:!0},Fw=(()=>{class t extends t4{maxlength;inputName="maxlength";normalizeInput=e=>Xme(e);createValidator=e=>WW(e);static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275dir=vi({type:t,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(n,o){n&2&&un("maxlength",o._enabled?o.maxlength:null)},inputs:{maxlength:"maxlength"},standalone:!1,features:[fr([tge]),Fn]})}return t})();var hZ=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({})}return t})(),WL=class extends gv{constructor(i,e,n){super(QL(e),JL(n,e)),this.controls=i,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(i){return this.controls[this._adjustIndex(i)]}push(i,e={}){this.controls.push(i),this._registerControl(i),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(i,e,n={}){this.controls.splice(i,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(i,e={}){let n=this._adjustIndex(i);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(i,e,n={}){let o=this._adjustIndex(i);o<0&&(o=0),this.controls[o]&&this.controls[o]._registerOnCollectionChange(()=>{}),this.controls.splice(o,1),e&&(this.controls.splice(o,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(i,e={}){rZ(this,!1,i),i.forEach((n,o)=>{nZ(this,!1,o),this.at(o).setValue(n,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(i,e={}){i!=null&&(i.forEach((n,o)=>{this.at(o)&&this.at(o).patchValue(n,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(i=[],e={}){this._forEachChild((n,o)=>{n.reset(i[o],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(i=>i.getRawValue())}clear(i={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:i.emitEvent}))}_adjustIndex(i){return i<0?i+this.length:i}_syncPendingControls(){let i=this.controls.reduce((e,n)=>n._syncPendingControls()?!0:e,!1);return i&&this.updateValueAndValidity({onlySelf:!0}),i}_forEachChild(i){this.controls.forEach((e,n)=>{i(e,n)})}_updateValue(){this.value=this.controls.filter(i=>i.enabled||this.disabled).map(i=>i.value)}_anyControls(i){return this.controls.some(e=>e.enabled&&i(e))}_setUpControls(){this._forEachChild(i=>this._registerControl(i))}_allControlsDisabled(){for(let i of this.controls)if(i.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(i){i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange)}_find(i){return this.at(i)??null}};function UW(t){return!!t&&(t.asyncValidators!==void 0||t.validators!==void 0||t.updateOn!==void 0)}var ns=(()=>{class t{useNonNullable=!1;get nonNullable(){let e=new t;return e.useNonNullable=!0,e}group(e,n=null){let o=this._reduceControls(e),r={};return UW(n)?r=n:n!==null&&(r.validators=n.validator,r.asyncValidators=n.asyncValidator),new _v(o,r)}record(e,n=null){let o=this._reduceControls(e);return new GL(o,n)}control(e,n,o){let r={};return this.useNonNullable?(UW(n)?r=n:(r.validators=n,r.asyncValidators=o),new Ro(e,ji(It({},r),{nonNullable:!0}))):new Ro(e,n,o)}array(e,n,o){let r=e.map(g=>this._createControl(g));return new WL(r,n,o)}_reduceControls(e){let n={};return Object.keys(e).forEach(o=>{n[o]=this._createControl(e[o])}),n}_createControl(e){if(e instanceof Ro)return e;if(e instanceof gv)return e;if(Array.isArray(e)){let n=e[0],o=e.length>1?e[1]:null,r=e.length>2?e[2]:null;return this.control(n,o,r)}else return this.control(e)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Sm=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:Nw,useValue:e.callSetDisabledState??dM}]}}static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({imports:[hZ]})}return t})(),Ta=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:dZ,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:Nw,useValue:e.callSetDisabledState??dM}]}}static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({imports:[hZ]})}return t})();function ige(t,i){if(t&1){let e=zi();Xn(0),ae(1,"textarea",6),kp("ngModelChange",function(o){ri(e);let r=zt();return nm(r.inputValue,o)||(r.inputValue=o),oi(o)}),se(),Qn()}if(t&2){let e=zt();Se(),bO("placeholder",e.data.inputPlaceholder||""),Rp("ngModel",e.inputValue)}}var Zl=class t{constructor(i,e){this.dialogRef=i;this.data=e;e.input&&e.inputPlaceholder&&(this.inputValue="")}inputValue="";onConfirm(){this.dialogRef.close(this.data.input?this.inputValue.trim():!0)}onCancel(){this.dialogRef.close(!1)}static \u0275fac=function(e){return new(e||t)(Ci(k0),Ci(ZD))};static \u0275cmp=ai({type:t,selectors:[["app-confirm-dialog"]],decls:11,vars:7,consts:[["mat-dialog-title",""],[1,"dialog-content"],[4,"ngIf"],["align","end"],["mat-button","",3,"click"],["mat-flat-button","",3,"click","color","disabled"],["rows","4",1,"full-width","textarea",3,"ngModelChange","ngModel","placeholder"]],template:function(e,n){e&1&&(ae(0,"h2",0),Oe(1),se(),ae(2,"mat-dialog-content",1)(3,"p"),Oe(4),se(),Tt(5,ige,2,2,"ng-container",2),se(),ae(6,"mat-dialog-actions",3)(7,"button",4),Nt("click",function(){return n.onCancel()}),Oe(8),se(),ae(9,"button",5),Nt("click",function(){return n.onConfirm()}),Oe(10),se()()),e&2&&(Se(),En(n.data.title||"Confirmar"),Se(3),En(n.data.message),Se(),Xe("ngIf",n.data.input),Se(3),an(" ",n.data.cancelText||"Cancelar"," "),Se(),Xe("color",n.data.input?"warn":"primary")("disabled",n.data.input&&!n.inputValue.trim()),Se(),an(" ",n.data.confirmText||(n.data.input?"Enviar":"Aceptar")," "))},dependencies:[Or,Er,Sm,jo,la,Lw,O0,LL,zL,FL,Fs,Wl],styles:[".dialog-content[_ngcontent-%COMP%]{padding-right:16px}.textarea[_ngcontent-%COMP%]{width:90%;margin-top:1rem;font-size:14px;padding:.5rem}"]})};var pZ={XSmall:"(max-width: 599.98px)",Small:"(min-width: 600px) and (max-width: 959.98px)",Medium:"(min-width: 960px) and (max-width: 1279.98px)",Large:"(min-width: 1280px) and (max-width: 1919.98px)",XLarge:"(min-width: 1920px)",Handset:"(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)",Tablet:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait), (min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",Web:"(min-width: 840px) and (orientation: portrait), (min-width: 1280px) and (orientation: landscape)",HandsetPortrait:"(max-width: 599.98px) and (orientation: portrait)",TabletPortrait:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait)",WebPortrait:"(min-width: 840px) and (orientation: portrait)",HandsetLandscape:"(max-width: 959.98px) and (orientation: landscape)",TabletLandscape:"(min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",WebLandscape:"(min-width: 1280px) and (orientation: landscape)"};function nge(t,i){if(t&1){let e=zi();ae(0,"div",1)(1,"button",2),Nt("click",function(){ri(e);let o=zt();return oi(o.action())}),Oe(2),se()()}if(t&2){let e=zt();Se(2),an(" ",e.data.action," ")}}var rge=["label"];function oge(t,i){}var age=Math.pow(2,31)-1,zw=class{_overlayRef;instance;containerInstance;_afterDismissed=new gi;_afterOpened=new gi;_onAction=new gi;_durationTimeoutId;_dismissedByAction=!1;constructor(i,e){this._overlayRef=e,this.containerInstance=i,i._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(i){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(i,age))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}},fZ=new Ot("MatSnackBarData"),yv=class{politeness="assertive";announcementMessage="";viewContainerRef;duration=0;panelClass;direction;data=null;horizontalPosition="center";verticalPosition="bottom"},sge=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"]})}return t})(),lge=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"]})}return t})(),cge=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"]})}return t})(),mZ=(()=>{class t{snackBarRef=J(zw);data=J(fZ);constructor(){}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions",""],["mat-button","","matSnackBarAction","",3,"click"]],template:function(n,o){n&1&&(ae(0,"div",0),Oe(1),se(),Tt(2,nge,3,1,"div",1)),n&2&&(Se(),an(" ",o.data.message,`
`),Se(),zn(o.hasAction?2:-1))},dependencies:[Wl,sge,lge,cge],styles:[`.mat-mdc-simple-snack-bar{display:flex}
`],encapsulation:2,changeDetection:0})}return t})(),r4="_mat-snack-bar-enter",o4="_mat-snack-bar-exit",uge=(()=>{class t extends Vp{_ngZone=J(Oi);_elementRef=J(Qi);_changeDetectorRef=J(vr);_platform=J(Pr);_rendersRef;_animationsDisabled=J(oo,{optional:!0})==="NoopAnimations";snackBarConfig=J(yv);_document=J(cn);_trackedModals=new Set;_enterFallback;_exitFallback;_renders=new gi;_announceDelay=150;_announceTimeoutId;_destroyed=!1;_portalOutlet;_onAnnounce=new gi;_onExit=new gi;_onEnter=new gi;_animationState="void";_live;_label;_role;_liveElementId=J(po).getId("mat-snack-bar-container-live-");constructor(){super();let e=this.snackBarConfig;e.politeness==="assertive"&&!e.announcementMessage?this._live="assertive":e.politeness==="off"?this._live="off":this._live="polite",this._platform.FIREFOX&&(this._live==="polite"&&(this._role="status"),this._live==="assertive"&&(this._role="alert")),this._rendersRef=i0(()=>this._renders.next(),{manualCleanup:!0})}attachComponentPortal(e){this._assertNotAttached();let n=this._portalOutlet.attachComponentPortal(e);return this._afterPortalAttached(),n}attachTemplatePortal(e){this._assertNotAttached();let n=this._portalOutlet.attachTemplatePortal(e);return this._afterPortalAttached(),n}attachDomPortal=e=>{this._assertNotAttached();let n=this._portalOutlet.attachDomPortal(e);return this._afterPortalAttached(),n};onAnimationEnd(e){e===o4?this._completeExit():e===r4&&(clearTimeout(this._enterFallback),this._ngZone.run(()=>{this._onEnter.next(),this._onEnter.complete()}))}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.markForCheck(),this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce(),this._animationsDisabled?this._renders.pipe(ta(1)).subscribe(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(r4)))}):(clearTimeout(this._enterFallback),this._enterFallback=setTimeout(()=>{this._elementRef.nativeElement.classList.add("mat-snack-bar-fallback-visible"),this.onAnimationEnd(r4)},200)))}exit(){return this._destroyed?Ni(void 0):(this._ngZone.run(()=>{this._animationState="hidden",this._changeDetectorRef.markForCheck(),this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId),this._animationsDisabled?this._renders.pipe(ta(1)).subscribe(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(o4)))}):(clearTimeout(this._exitFallback),this._exitFallback=setTimeout(()=>this.onAnimationEnd(o4),200))}),this._onExit)}ngOnDestroy(){this._destroyed=!0,this._clearFromModals(),this._completeExit(),this._renders.complete(),this._rendersRef.destroy()}_completeExit(){clearTimeout(this._exitFallback),queueMicrotask(()=>{this._onExit.next(),this._onExit.complete()})}_afterPortalAttached(){let e=this._elementRef.nativeElement,n=this.snackBarConfig.panelClass;n&&(Array.isArray(n)?n.forEach(g=>e.classList.add(g)):e.classList.add(n)),this._exposeToModals();let o=this._label.nativeElement,r="mdc-snackbar__label";o.classList.toggle(r,!o.querySelector(`.${r}`))}_exposeToModals(){let e=this._liveElementId,n=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let o=0;o<n.length;o++){let r=n[o],g=r.getAttribute("aria-owns");this._trackedModals.add(r),g?g.indexOf(e)===-1&&r.setAttribute("aria-owns",g+" "+e):r.setAttribute("aria-owns",e)}}_clearFromModals(){this._trackedModals.forEach(e=>{let n=e.getAttribute("aria-owns");if(n){let o=n.replace(this._liveElementId,"").trim();o.length>0?e.setAttribute("aria-owns",o):e.removeAttribute("aria-owns")}}),this._trackedModals.clear()}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{if(this._destroyed)return;let e=this._elementRef.nativeElement,n=e.querySelector("[aria-hidden]"),o=e.querySelector("[aria-live]");if(n&&o){let r=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&n.contains(document.activeElement)&&(r=document.activeElement),n.removeAttribute("aria-hidden"),o.appendChild(n),r?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-snack-bar-container"]],viewQuery:function(n,o){if(n&1&&(pr(Vu,7),pr(rge,7)),n&2){let r;sn(r=ln())&&(o._portalOutlet=r.first),sn(r=ln())&&(o._label=r.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container"],hostVars:6,hostBindings:function(n,o){n&1&&Nt("animationend",function(g){return o.onAnimationEnd(g.animationName)})("animationcancel",function(g){return o.onAnimationEnd(g.animationName)}),n&2&&Ji("mat-snack-bar-container-enter",o._animationState==="visible")("mat-snack-bar-container-exit",o._animationState==="hidden")("mat-snack-bar-container-animations-enabled",!o._animationsDisabled)},features:[Fn],decls:6,vars:3,consts:[["label",""],[1,"mdc-snackbar__surface","mat-mdc-snackbar-surface"],[1,"mat-mdc-snack-bar-label"],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(n,o){n&1&&(ae(0,"div",1)(1,"div",2,0)(3,"div",3),Tt(4,oge,0,0,"ng-template",4),se(),jt(5,"div"),se()()),n&2&&(Se(5),un("aria-live",o._live)("role",o._role)("id",o._liveElementId))},dependencies:[Vu],styles:[`@keyframes _mat-snack-bar-enter{from{transform:scale(0.8);opacity:0}to{transform:scale(1);opacity:1}}@keyframes _mat-snack-bar-exit{from{opacity:1}to{opacity:0}}.mat-mdc-snack-bar-container{display:flex;align-items:center;justify-content:center;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);margin:8px}.mat-mdc-snack-bar-handset .mat-mdc-snack-bar-container{width:100vw}.mat-snack-bar-container-animations-enabled{opacity:0}.mat-snack-bar-container-animations-enabled.mat-snack-bar-fallback-visible{opacity:1}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-enter{animation:_mat-snack-bar-enter 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-exit{animation:_mat-snack-bar-exit 75ms cubic-bezier(0.4, 0, 1, 1) forwards}.mat-mdc-snackbar-surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12);display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;padding-left:0;padding-right:8px}[dir=rtl] .mat-mdc-snackbar-surface{padding-right:0;padding-left:8px}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{min-width:344px;max-width:672px}.mat-mdc-snack-bar-handset .mat-mdc-snackbar-surface{width:100%;min-width:0}@media(forced-colors: active){.mat-mdc-snackbar-surface{outline:solid 1px}}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{color:var(--mdc-snackbar-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mdc-snackbar-container-shape, var(--mat-sys-corner-extra-small));background-color:var(--mdc-snackbar-container-color, var(--mat-sys-inverse-surface))}.mdc-snackbar__label{width:100%;flex-grow:1;box-sizing:border-box;margin:0;padding:14px 8px 14px 16px}[dir=rtl] .mdc-snackbar__label{padding-left:8px;padding-right:16px}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-family:var(--mdc-snackbar-supporting-text-font, var(--mat-sys-body-medium-font));font-size:var(--mdc-snackbar-supporting-text-size, var(--mat-sys-body-medium-size));font-weight:var(--mdc-snackbar-supporting-text-weight, var(--mat-sys-body-medium-weight));line-height:var(--mdc-snackbar-supporting-text-line-height, var(--mat-sys-body-medium-line-height))}.mat-mdc-snack-bar-actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled).mat-unthemed{color:var(--mat-snack-bar-button-color, var(--mat-sys-inverse-primary))}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){--mat-text-button-state-layer-color:currentColor;--mat-text-button-ripple-color:currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{opacity:.1}
`],encapsulation:2})}return t})();function dge(){return new yv}var hge=new Ot("mat-snack-bar-default-options",{providedIn:"root",factory:dge}),L0=(()=>{class t{_overlay=J(sa);_live=J(_w);_injector=J(wn);_breakpointObserver=J(gw);_parentSnackBar=J(t,{optional:!0,skipSelf:!0});_defaultConfig=J(hge);_snackBarRefAtThisLevel=null;simpleSnackBarComponent=mZ;snackBarContainerComponent=uge;handsetCssClass="mat-mdc-snack-bar-handset";get _openedSnackBarRef(){let e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}constructor(){}openFromComponent(e,n){return this._attach(e,n)}openFromTemplate(e,n){return this._attach(e,n)}open(e,n="",o){let r=It(It({},this._defaultConfig),o);return r.data={message:e,action:n},r.announcementMessage===e&&(r.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,r)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(e,n){let o=n&&n.viewContainerRef&&n.viewContainerRef.injector,r=wn.create({parent:o||this._injector,providers:[{provide:yv,useValue:n}]}),g=new $l(this.snackBarContainerComponent,n.viewContainerRef,r),w=e.attach(g);return w.instance.snackBarConfig=n,w.instance}_attach(e,n){let o=It(It(It({},new yv),this._defaultConfig),n),r=this._createOverlay(o),g=this._attachSnackBarContainer(r,o),w=new zw(g,r);if(e instanceof Zo){let T=new jd(e,null,{$implicit:o.data,snackBarRef:w});w.instance=g.attachTemplatePortal(T)}else{let T=this._createInjector(o,w),k=new $l(e,void 0,T),N=g.attachComponentPortal(k);w.instance=N.instance}return this._breakpointObserver.observe(pZ.HandsetPortrait).pipe(_r(r.detachments())).subscribe(T=>{r.overlayElement.classList.toggle(this.handsetCssClass,T.matches)}),o.announcementMessage&&g._onAnnounce.subscribe(()=>{this._live.announce(o.announcementMessage,o.politeness)}),this._animateSnackBar(w,o),this._openedSnackBarRef=w,this._openedSnackBarRef}_animateSnackBar(e,n){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef==e&&(this._openedSnackBarRef=null),n.announcementMessage&&this._live.clear()}),n.duration&&n.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(n.duration)),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter()}_createOverlay(e){let n=new Hd;n.direction=e.direction;let o=this._overlay.position().global(),r=e.direction==="rtl",g=e.horizontalPosition==="left"||e.horizontalPosition==="start"&&!r||e.horizontalPosition==="end"&&r,w=!g&&e.horizontalPosition!=="center";return g?o.left("0"):w?o.right("0"):o.centerHorizontally(),e.verticalPosition==="top"?o.top("0"):o.bottom("0"),n.positionStrategy=o,this._overlay.create(n)}_createInjector(e,n){let o=e&&e.viewContainerRef&&e.viewContainerRef.injector;return wn.create({parent:o||this._injector,providers:[{provide:zw,useValue:n},{provide:fZ,useValue:e.data}]})}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var gZ=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({providers:[L0],imports:[au,ju,Fs,Wn,mZ,Wn]})}return t})();var fo=class t{constructor(i,e){this.snackBar=i;this.dialog=e}success(i){this.snackBar.open(`\u2714\uFE0F ${i}`,"Cerrar",{duration:4e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-success"]})}error(i){this.snackBar.open(`\u274C ${i}`,"Cerrar",{duration:5e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-error"]})}confirm(i,e={}){return this.dialog.open(Zl,{width:"320px",data:It({message:i},e)}).afterClosed()}static \u0275fac=function(e){return new(e||t)(bi(L0),bi(lu))};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})};function pge(t,i){if(t&1){let e=zi();ae(0,"li")(1,"a",4),Nt("click",function(){ri(e);let o=zt();return oi(o.toggleMenu())}),Oe(2,"Crear cuenta"),se()()}}function fge(t,i){if(t&1&&(ae(0,"span",7),Oe(1),se()),t&2){let e=zt().ngIf;Se(),an(" ",e.length," ")}}function mge(t,i){if(t&1&&(Xn(0),Tt(1,fge,2,1,"span",6),Qn()),t&2){let e=i.ngIf;Se(),Xe("ngIf",e.length>0)}}function gge(t,i){if(t&1){let e=zi();ae(0,"li")(1,"a",5),Nt("click",function(){ri(e);let o=zt();return oi(o.toggleNotifications())}),Oe(2," \u{1F514} Notificaciones "),Tt(3,mge,2,1,"ng-container",1),bc(4,"async"),se()()}if(t&2){let e=zt();Se(3),Xe("ngIf",fx(4,1,e.userNotificationService.notifications$))}}function _ge(t,i){t&1&&(ae(0,"li",8),jt(1,"app-notification-list"),se())}function yge(t,i){if(t&1){let e=zi();ae(0,"li")(1,"a",9),Nt("click",function(){ri(e);let o=zt();return oi(o.toggleMenu())}),Oe(2,"Inicio"),se()()}}function vge(t,i){if(t&1){let e=zi();ae(0,"li")(1,"a",10),Nt("click",function(){ri(e);let o=zt();return oi(o.toggleMenu())}),Oe(2,"Mi Cuenta"),se()()}}function bge(t,i){if(t&1){let e=zi();ae(0,"li")(1,"a",11),Nt("click",function(){ri(e);let o=zt();return oi(o.toggleMenu())}),Oe(2,"Mis Reportes"),se()()}}function xge(t,i){if(t&1){let e=zi();ae(0,"li")(1,"a",12),Nt("click",function(){ri(e);let o=zt();return oi(o.toggleMenu())}),Oe(2,"Crear reporte"),se()()}}function wge(t,i){if(t&1){let e=zi();ae(0,"li")(1,"a",13),Nt("click",function(){ri(e);let o=zt();return oi(o.toggleMenu())}),Oe(2,"Administrar Reportes"),se()()}}function Ege(t,i){if(t&1){let e=zi();ae(0,"li")(1,"a",14),Nt("click",function(){ri(e);let o=zt();return oi(o.toggleMenu())}),Oe(2,"Historias de Reportes"),se()()}}function Cge(t,i){if(t&1){let e=zi();ae(0,"li")(1,"a",15),Nt("click",function(){ri(e);let o=zt();return oi(o.toggleMenu())}),Oe(2,"Generar informe"),se()()}}function Sge(t,i){if(t&1){let e=zi();ae(0,"li")(1,"a",16),Nt("click",function(){ri(e);let o=zt();return oi(o.toggleMenu())}),Oe(2,"Administrar Categor\xEDas"),se()()}}function Tge(t,i){if(t&1){let e=zi();ae(0,"li")(1,"a",5),Nt("click",function(){ri(e);let o=zt();return o.logout(),oi(o.toggleMenu())}),Oe(2,"Cerrar Sesi\xF3n"),se()()}}var hM=class t{constructor(i,e,n,o){this.authService=i;this.router=e;this.notificationService=n;this.userNotificationService=o}isOpen=!1;isLoggedIn=!1;notificationsOpen=!1;isAdmin=!1;authSubscription=new nr;ngOnInit(){this.authSubscription.add(this.authService.getAuthStatus().subscribe(i=>{this.isLoggedIn=i})),this.authSubscription.add(this.authService.getAdminStatus().subscribe(i=>{this.isAdmin=i}))}ngOnDestroy(){this.authSubscription&&this.authSubscription.unsubscribe()}toggleMenu(){this.isOpen=!this.isOpen}toggleNotifications(){this.notificationsOpen=!this.notificationsOpen}logout(){this.notificationService.confirm("\xBFEst\xE1s seguro de que quieres cerrar sesi\xF3n?",{title:"Cerrar sesi\xF3n",confirmText:"S\xED, salir",cancelText:"No"}).subscribe(i=>{i&&(this.notificationService.success("Cerrando sesi\xF3n..."),this.authService.logout().subscribe({next:()=>this.router.navigate(["/login"]),error:e=>{console.error(e),this.notificationService.error("No se pudo cerrar sesi\xF3n")}}))})}register(){this.router.navigate(["/report/new"])}navigate(i){this.router.navigate([i]),this.isOpen=!1}static \u0275fac=function(e){return new(e||t)(Ci(Bo),Ci($n),Ci(fo),Ci(_m))};static \u0275cmp=ai({type:t,selectors:[["app-header"]],decls:16,vars:14,consts:[[1,"sidebar"],[4,"ngIf"],["class","notification-panel",4,"ngIf"],[1,"menu-button",3,"click"],["routerLink","/register",3,"click"],[3,"click"],["class","badge",4,"ngIf"],[1,"badge"],[1,"notification-panel"],["routerLink","/map",3,"click"],["routerLink","/profile",3,"click"],["routerLink","/my-reports",3,"click"],["routerLink","/report/new",3,"click"],["routerLink","/report-list-admin",3,"click"],["routerLink","/report-histories",3,"click"],["routerLink","/report-summary",3,"click"],["routerLink","/category-list",3,"click"]],template:function(e,n){e&1&&(ae(0,"div",0)(1,"ul"),Tt(2,pge,3,0,"li",1)(3,gge,5,3,"li",1)(4,_ge,2,0,"li",2)(5,yge,3,0,"li",1)(6,vge,3,0,"li",1)(7,bge,3,0,"li",1)(8,xge,3,0,"li",1)(9,wge,3,0,"li",1)(10,Ege,3,0,"li",1)(11,Cge,3,0,"li",1)(12,Sge,3,0,"li",1)(13,Tge,3,0,"li",1),se()(),ae(14,"button",3),Nt("click",function(){return n.toggleMenu()}),Oe(15,"\u2630"),se()),e&2&&(Ji("active",n.isOpen),Se(2),Xe("ngIf",!n.isLoggedIn),Se(),Xe("ngIf",n.isLoggedIn),Se(),Xe("ngIf",n.notificationsOpen),Se(),Xe("ngIf",n.isLoggedIn),Se(),Xe("ngIf",n.isLoggedIn),Se(),Xe("ngIf",n.isLoggedIn),Se(),Xe("ngIf",n.isLoggedIn),Se(),Xe("ngIf",n.isAdmin),Se(),Xe("ngIf",n.isAdmin),Se(),Xe("ngIf",n.isAdmin),Se(),Xe("ngIf",n.isAdmin),Se(),Xe("ngIf",n.isLoggedIn))},dependencies:[Er,nu,Ky,Ex,SD],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c;--hover-bg: #c0c8d4}.sidebar[_ngcontent-%COMP%]{position:fixed;right:-270px;top:0;width:250px;height:100%;background:#fff;color:var(--primary-dark);transition:right .4s ease;padding-top:80px;box-shadow:-4px 0 8px #0003;border-top-left-radius:10px;border-bottom-left-radius:10px;z-index:999}.sidebar.active[_ngcontent-%COMP%]{right:0}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:15px 20px;text-align:left;transition:background .3s ease;font-weight:500;font-size:16px;background:var(--input-bg)}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background:#aaa;cursor:pointer;border-radius:8px}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--primary-dark);text-decoration:none;display:block}.menu-button[_ngcontent-%COMP%]{position:fixed;top:20px;right:20px;background:var(--primary-bg);border:none;color:var(--primary-dark);padding:10px 15px;font-size:24px;cursor:pointer;border-radius:8px;box-shadow:2px 2px 6px #0003;transition:background .3s,transform .2s;z-index:1000}.menu-button[_ngcontent-%COMP%]:hover{background:var(--primary-accent);transform:scale(1.05)}.menu-button[_ngcontent-%COMP%]:active{background:#7a99c3;transform:scale(.95)}.link-button[_ngcontent-%COMP%]{background:none;border:none;color:var(--primary-dark);font-weight:500;font-size:16px;width:100%;text-align:left;padding:15px 20px;cursor:pointer;display:block}.link-button[_ngcontent-%COMP%]:hover{background:#aaa;border-radius:8px}"]})};var pM=class t{static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ai({type:t,selectors:[["app-root"]],decls:2,vars:0,template:function(e,n){e&1&&jt(0,"app-header")(1,"router-outlet")},dependencies:[hM,Zx],styles:[".close-btn[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;background:none;border:none;color:#fff;font-size:20px;cursor:pointer}"]})};var gM=K_(vv());var Gd={production:!1,mapboxToken:"pk.eyJ1IjoibWFya2F0IiwiYSI6ImNtN2o2eGcwZDAwcGsycG9pZzZ6cjhncTgifQ.f9qApUfu6cdG-w-gpjPOlQ",cloud_name:"dxospqsu0",api_key:"173283854338116",api_secret:"kTTNZ1yXBfEjGr1jm39FithfSwU",urlBack:"http://localhost:8080/api/v1"};var fM;function Dge(){if(fM===void 0&&(fM=null,typeof window<"u")){let t=window;t.trustedTypes!==void 0&&(fM=t.trustedTypes.createPolicy("angular#components",{createHTML:i=>i}))}return fM}function Vw(t){return Dge()?.createHTML(t)||t}function vZ(t){return Error(`Unable to find icon with the name "${t}"`)}function Mge(){return Error("Could not find HttpClient for use with Angular Material icons. Please add provideHttpClient() to your providers.")}function bZ(t){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${t}".`)}function xZ(t){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${t}".`)}var Gp=class{url;svgText;options;svgElement;constructor(i,e,n){this.url=i,this.svgText=e,this.options=n}},EZ=(()=>{class t{_httpClient;_sanitizer;_errorHandler;_document;_svgIconConfigs=new Map;_iconSetConfigs=new Map;_cachedIconsByUrl=new Map;_inProgressUrlFetches=new Map;_fontCssClassesByAlias=new Map;_resolvers=[];_defaultFontSetClass=["material-icons","mat-ligature-font"];constructor(e,n,o,r){this._httpClient=e,this._sanitizer=n,this._errorHandler=r,this._document=o}addSvgIcon(e,n,o){return this.addSvgIconInNamespace("",e,n,o)}addSvgIconLiteral(e,n,o){return this.addSvgIconLiteralInNamespace("",e,n,o)}addSvgIconInNamespace(e,n,o,r){return this._addSvgIconConfig(e,n,new Gp(o,null,r))}addSvgIconResolver(e){return this._resolvers.push(e),this}addSvgIconLiteralInNamespace(e,n,o,r){let g=this._sanitizer.sanitize(yl.HTML,o);if(!g)throw xZ(o);let w=Vw(g);return this._addSvgIconConfig(e,n,new Gp("",w,r))}addSvgIconSet(e,n){return this.addSvgIconSetInNamespace("",e,n)}addSvgIconSetLiteral(e,n){return this.addSvgIconSetLiteralInNamespace("",e,n)}addSvgIconSetInNamespace(e,n,o){return this._addSvgIconSetConfig(e,new Gp(n,null,o))}addSvgIconSetLiteralInNamespace(e,n,o){let r=this._sanitizer.sanitize(yl.HTML,n);if(!r)throw xZ(n);let g=Vw(r);return this._addSvgIconSetConfig(e,new Gp("",g,o))}registerFontClassAlias(e,n=e){return this._fontCssClassesByAlias.set(e,n),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(...e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){let n=this._sanitizer.sanitize(yl.RESOURCE_URL,e);if(!n)throw bZ(e);let o=this._cachedIconsByUrl.get(n);return o?Ni(mM(o)):this._loadSvgIconFromConfig(new Gp(e,null)).pipe(hr(r=>this._cachedIconsByUrl.set(n,r)),hn(r=>mM(r)))}getNamedSvgIcon(e,n=""){let o=wZ(n,e),r=this._svgIconConfigs.get(o);if(r)return this._getSvgFromConfig(r);if(r=this._getIconConfigFromResolvers(n,e),r)return this._svgIconConfigs.set(o,r),this._getSvgFromConfig(r);let g=this._iconSetConfigs.get(n);return g?this._getSvgFromIconSetConfigs(e,g):wa(vZ(o))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgText?Ni(mM(this._svgElementFromConfig(e))):this._loadSvgIconFromConfig(e).pipe(hn(n=>mM(n)))}_getSvgFromIconSetConfigs(e,n){let o=this._extractIconWithNameFromAnySet(e,n);if(o)return Ni(o);let r=n.filter(g=>!g.svgText).map(g=>this._loadSvgIconSetFromConfig(g).pipe(Br(w=>{let k=`Loading icon set URL: ${this._sanitizer.sanitize(yl.RESOURCE_URL,g.url)} failed: ${w.message}`;return this._errorHandler.handleError(new Error(k)),Ni(null)})));return I1(r).pipe(hn(()=>{let g=this._extractIconWithNameFromAnySet(e,n);if(!g)throw vZ(e);return g}))}_extractIconWithNameFromAnySet(e,n){for(let o=n.length-1;o>=0;o--){let r=n[o];if(r.svgText&&r.svgText.toString().indexOf(e)>-1){let g=this._svgElementFromConfig(r),w=this._extractSvgIconFromSet(g,e,r.options);if(w)return w}}return null}_loadSvgIconFromConfig(e){return this._fetchIcon(e).pipe(hr(n=>e.svgText=n),hn(()=>this._svgElementFromConfig(e)))}_loadSvgIconSetFromConfig(e){return e.svgText?Ni(null):this._fetchIcon(e).pipe(hr(n=>e.svgText=n))}_extractSvgIconFromSet(e,n,o){let r=e.querySelector(`[id="${n}"]`);if(!r)return null;let g=r.cloneNode(!0);if(g.removeAttribute("id"),g.nodeName.toLowerCase()==="svg")return this._setSvgAttributes(g,o);if(g.nodeName.toLowerCase()==="symbol")return this._setSvgAttributes(this._toSvgElement(g),o);let w=this._svgElementFromString(Vw("<svg></svg>"));return w.appendChild(g),this._setSvgAttributes(w,o)}_svgElementFromString(e){let n=this._document.createElement("DIV");n.innerHTML=e;let o=n.querySelector("svg");if(!o)throw Error("<svg> tag not found");return o}_toSvgElement(e){let n=this._svgElementFromString(Vw("<svg></svg>")),o=e.attributes;for(let r=0;r<o.length;r++){let{name:g,value:w}=o[r];g!=="id"&&n.setAttribute(g,w)}for(let r=0;r<e.childNodes.length;r++)e.childNodes[r].nodeType===this._document.ELEMENT_NODE&&n.appendChild(e.childNodes[r].cloneNode(!0));return n}_setSvgAttributes(e,n){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),n&&n.viewBox&&e.setAttribute("viewBox",n.viewBox),e}_fetchIcon(e){let{url:n,options:o}=e,r=o?.withCredentials??!1;if(!this._httpClient)throw Mge();if(n==null)throw Error(`Cannot fetch icon from URL "${n}".`);let g=this._sanitizer.sanitize(yl.RESOURCE_URL,n);if(!g)throw bZ(n);let w=this._inProgressUrlFetches.get(g);if(w)return w;let T=this._httpClient.get(g,{responseType:"text",withCredentials:r}).pipe(hn(k=>Vw(k)),Th(()=>this._inProgressUrlFetches.delete(g)),k1());return this._inProgressUrlFetches.set(g,T),T}_addSvgIconConfig(e,n,o){return this._svgIconConfigs.set(wZ(e,n),o),this}_addSvgIconSetConfig(e,n){let o=this._iconSetConfigs.get(e);return o?o.push(n):this._iconSetConfigs.set(e,[n]),this}_svgElementFromConfig(e){if(!e.svgElement){let n=this._svgElementFromString(e.svgText);this._setSvgAttributes(n,e.options),e.svgElement=n}return e.svgElement}_getIconConfigFromResolvers(e,n){for(let o=0;o<this._resolvers.length;o++){let r=this._resolvers[o](n,e);if(r)return Ige(r)?new Gp(r.url,null,r.options):new Gp(r,null)}}static \u0275fac=function(n){return new(n||t)(bi(Qa,8),bi(QO),bi(cn,8),bi(Hl))};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function mM(t){return t.cloneNode(!0)}function wZ(t,i){return t+":"+i}function Ige(t){return!!(t.url&&t.options)}var Age=["*"],Rge=new Ot("MAT_ICON_DEFAULT_OPTIONS"),kge=new Ot("mat-icon-location",{providedIn:"root",factory:Oge});function Oge(){let t=J(cn),i=t?t.location:null;return{getPathname:()=>i?i.pathname+i.search:""}}var CZ=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],Pge=CZ.map(t=>`[${t}]`).join(", "),Nge=/^url\(['"]?#(.*?)['"]?\)$/,Uo=(()=>{class t{_elementRef=J(Qi);_iconRegistry=J(EZ);_location=J(kge);_errorHandler=J(Hl);_defaultColor;get color(){return this._color||this._defaultColor}set color(e){this._color=e}_color;inline=!1;get svgIcon(){return this._svgIcon}set svgIcon(e){e!==this._svgIcon&&(e?this._updateSvgIcon(e):this._svgIcon&&this._clearSvgElement(),this._svgIcon=e)}_svgIcon;get fontSet(){return this._fontSet}set fontSet(e){let n=this._cleanupFontValue(e);n!==this._fontSet&&(this._fontSet=n,this._updateFontIconClasses())}_fontSet;get fontIcon(){return this._fontIcon}set fontIcon(e){let n=this._cleanupFontValue(e);n!==this._fontIcon&&(this._fontIcon=n,this._updateFontIconClasses())}_fontIcon;_previousFontSetClass=[];_previousFontIconClass;_svgName;_svgNamespace;_previousPath;_elementsWithExternalReferences;_currentIconFetch=nr.EMPTY;constructor(){let e=J(new Ru("aria-hidden"),{optional:!0}),n=J(Rge,{optional:!0});n&&(n.color&&(this.color=this._defaultColor=n.color),n.fontSet&&(this.fontSet=n.fontSet)),e||this._elementRef.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(e){if(!e)return["",""];let n=e.split(":");switch(n.length){case 1:return["",n[0]];case 2:return n;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){let e=this._elementsWithExternalReferences;if(e&&e.size){let n=this._location.getPathname();n!==this._previousPath&&(this._previousPath=n,this._prependPathToReferences(n))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();let n=this._location.getPathname();this._previousPath=n,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(n),this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){let e=this._elementRef.nativeElement,n=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();n--;){let o=e.childNodes[n];(o.nodeType!==1||o.nodeName.toLowerCase()==="svg")&&o.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;let e=this._elementRef.nativeElement,n=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(o=>o.length>0);this._previousFontSetClass.forEach(o=>e.classList.remove(o)),n.forEach(o=>e.classList.add(o)),this._previousFontSetClass=n,this.fontIcon!==this._previousFontIconClass&&!n.includes("mat-ligature-font")&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return typeof e=="string"?e.trim().split(" ")[0]:e}_prependPathToReferences(e){let n=this._elementsWithExternalReferences;n&&n.forEach((o,r)=>{o.forEach(g=>{r.setAttribute(g.name,`url('${e}#${g.value}')`)})})}_cacheChildrenWithExternalReferences(e){let n=e.querySelectorAll(Pge),o=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let r=0;r<n.length;r++)CZ.forEach(g=>{let w=n[r],T=w.getAttribute(g),k=T?T.match(Nge):null;if(k){let N=o.get(w);N||(N=[],o.set(w,N)),N.push({name:g,value:k[1]})}})}_updateSvgIcon(e){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),e){let[n,o]=this._splitIconName(e);n&&(this._svgNamespace=n),o&&(this._svgName=o),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(o,n).pipe(ta(1)).subscribe(r=>this._setSvgElement(r),r=>{let g=`Error retrieving icon ${n}:${o}! ${r.message}`;this._errorHandler.handleError(new Error(g))})}}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(n,o){n&2&&(un("data-mat-icon-type",o._usingFontIcon()?"font":"svg")("data-mat-icon-name",o._svgName||o.fontIcon)("data-mat-icon-namespace",o._svgNamespace||o.fontSet)("fontIcon",o._usingFontIcon()?o.fontIcon:null),ql(o.color?"mat-"+o.color:""),Ji("mat-icon-inline",o.inline)("mat-icon-no-color",o.color!=="primary"&&o.color!=="accent"&&o.color!=="warn"))},inputs:{color:"color",inline:[2,"inline","inline",Bi],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],ngContentSelectors:Age,decls:1,vars:0,template:function(n,o){n&1&&(Qr(),On(0))},styles:[`mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color, inherit)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}
`],encapsulation:2,changeDetection:0})}return t})(),rs=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({imports:[Wn,Wn]})}return t})();function Lge(t,i){t&1&&(ae(0,"h2"),Oe(1,"CREA UNA CUENTA"),se())}function Fge(t,i){t&1&&(ae(0,"div",20),Oe(1," \u26A0 El nombre completo es obligatorio. "),se())}function zge(t,i){t&1&&(ae(0,"div",20),Oe(1," \u26A0 El nombre debe tener al menos 8 caracteres. "),se())}function Bge(t,i){t&1&&(ae(0,"div",20),Oe(1," \u26A0 El nombre no puede exceder 50 caracteres. "),se())}function Vge(t,i){t&1&&(ae(0,"div",20),Oe(1," \u26A0 El correo electr\xF3nico es obligatorio. "),se())}function jge(t,i){t&1&&(ae(0,"div",20),Oe(1," \u26A0 El formato de correo no es v\xE1lido. "),se())}function Uge(t,i){t&1&&(ae(0,"div",20),Oe(1," \u26A0 El correo debe tener al menos 8 caracteres. "),se())}function Hge(t,i){t&1&&(ae(0,"div",20),Oe(1," \u26A0 El correo no puede exceder 50 caracteres. "),se())}function qge(t,i){t&1&&(ae(0,"div",20),Oe(1," \u26A0 La contrase\xF1a es obligatoria. "),se())}function $ge(t,i){t&1&&(ae(0,"div",20),Oe(1," \u26A0 Debe incluir al menos un d\xEDgito, una may\xFAscula y una min\xFAscula. "),se())}function Gge(t,i){t&1&&(ae(0,"div",20),Oe(1," \u26A0 La contrase\xF1a debe tener al menos 8 caracteres. "),se())}function Wge(t,i){t&1&&(ae(0,"div",20),Oe(1," \u26A0 La contrase\xF1a no puede exceder 50 caracteres. "),se())}function Zge(t,i){t&1&&(ae(0,"div",20),Oe(1," \u26A0 La fecha de nacimiento es obligatoria. "),se())}function Yge(t,i){t&1&&(ae(0,"div",20),Oe(1," \u26A0 La fecha de nacimiento no puede ser posterior a hoy. "),se())}function Kge(t,i){t&1&&(ae(0,"div",20),Oe(1," \u26A0 La ciudad de residencia es obligatoria. "),se())}function Xge(t,i){t&1&&(ae(0,"div",20),Oe(1," \u26A0 El radio de notificaciones es obligatorio. "),se())}function Qge(t,i){t&1&&(ae(0,"div",20),Oe(1," \u26A0 El radio de notificaciones debe ser mayor que 0. "),se())}function Jge(t,i){if(t&1){let e=zi();ae(0,"div")(1,"div",5),jt(2,"i",6)(3,"input",7),se(),Tt(4,Fge,2,0,"div",8)(5,zge,2,0,"div",8)(6,Bge,2,0,"div",8),ae(7,"div",5),jt(8,"i",9)(9,"input",10),se(),Tt(10,Vge,2,0,"div",8)(11,jge,2,0,"div",8)(12,Uge,2,0,"div",8)(13,Hge,2,0,"div",8),ae(14,"div",5),jt(15,"i",11)(16,"input",12),se(),Tt(17,qge,2,0,"div",8)(18,$ge,2,0,"div",8)(19,Gge,2,0,"div",8)(20,Wge,2,0,"div",8),ae(21,"div",5),jt(22,"i",13)(23,"input",14),se(),Tt(24,Zge,2,0,"div",8)(25,Yge,2,0,"div",8),ae(26,"div",5),jt(27,"i",15)(28,"input",16),se(),Tt(29,Kge,2,0,"div",8),ae(30,"div",5),jt(31,"i",17)(32,"input",18),se(),Tt(33,Xge,2,0,"div",8)(34,Qge,2,0,"div",8),ae(35,"button",19),Nt("click",function(){ri(e);let o=zt();return oi(o.continueToMap())}),Oe(36," Continuar "),se()()}if(t&2){let e=zt();Se(4),Xe("ngIf",e.hasError("fullName","required")),Se(),Xe("ngIf",e.hasError("fullName","minlength")),Se(),Xe("ngIf",e.hasError("fullName","maxlength")),Se(4),Xe("ngIf",e.hasError("email","required")),Se(),Xe("ngIf",e.hasError("email","email")),Se(),Xe("ngIf",e.hasError("email","minlength")),Se(),Xe("ngIf",e.hasError("email","maxlength")),Se(4),Xe("ngIf",e.hasError("password","required")),Se(),Xe("ngIf",e.hasError("password","pattern")),Se(),Xe("ngIf",e.hasError("password","minlength")),Se(),Xe("ngIf",e.hasError("password","maxlength")),Se(4),Xe("ngIf",e.hasError("dateBirth","required")),Se(),Xe("ngIf",e.hasError("dateBirth","futureDate")),Se(4),Xe("ngIf",e.hasError("cityOfResidence","required")),Se(4),Xe("ngIf",e.hasError("notificationRadiusKm","required")),Se(),Xe("ngIf",e.hasError("notificationRadiusKm","min")),Se(),Xe("disabled",e.registerForm.invalid)}}function e0e(t,i){t&1&&(ae(0,"div",21),Oe(1," Cargando mapa... "),se())}function t0e(t,i){t&1&&jt(0,"i",25)}function i0e(t,i){if(t&1){let e=zi();ae(0,"div"),jt(1,"div",22),ae(2,"p"),Oe(3,"Haz clic en el mapa para seleccionar tu ubicaci\xF3n."),se(),ae(4,"button",23),Tt(5,t0e,1,0,"i",24),Oe(6),se(),ae(7,"button",19),Nt("click",function(){ri(e);let o=zt();return oi(o.backToForm())}),Oe(8," \u2190 Volver "),se()()}if(t&2){let e=zt();Se(4),Xe("disabled",e.registerForm.invalid||e.isSubmitting),Se(),Xe("ngIf",e.isSubmitting),Se(),an(" ",e.isSubmitting?"Registrando...":"Registrar"," "),Se(),Xe("disabled",e.isSubmitting)}}var _M=class t{constructor(i,e,n,o){this.fb=i;this.authService=e;this.notificationService=n;this.router=o;this.registerForm=this.fb.group({fullName:["",[Ti.required,Ti.minLength(8),Ti.maxLength(50)]],email:["",[Ti.required,Ti.email,Ti.minLength(8),Ti.maxLength(50)]],password:["",[Ti.required,Ti.pattern("^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).*$"),Ti.minLength(8),Ti.maxLength(50)]],dateBirth:["",[Ti.required,this.pastDateValidator()]],cityOfResidence:["",Ti.required],notificationRadiusKm:[null,Ti.required],latitude:[null],longitude:[null]})}registerForm;showMap=!1;isLoadingMap=!1;map;marker;isSubmitting=!1;hasError(i,e){let n=this.registerForm.get(i);return!!(n&&n.touched&&n.hasError(e))}ngOnInit(){}ngAfterViewInit(){}continueToMap(){if(this.registerForm.valid){this.isLoadingMap=!0,this.showMap=!0;let i=this.registerForm.get("cityOfResidence").value;this.getCityCoordinates(i).then(e=>{this.initializeMap(e)}).catch(e=>{this.notificationService.error("No pudimos encontrar tu ciudad. Por favor revisa el nombre."),this.showMap=!1}).finally(()=>{this.isLoadingMap=!1})}}initializeMap(i={lng:-75.681,lat:4.533}){this.map=new gM.default.Map({container:"map_user",style:"mapbox://styles/mapbox/streets-v11",center:[i.lng,i.lat],zoom:12,attributionControl:!1,accessToken:Gd.mapboxToken}),this.map.on("load",()=>{this.map.resize(),this.isLoadingMap=!1}),this.map.addControl(new gM.default.NavigationControl,"bottom-right"),this.map.on("click",({lngLat:e})=>{this.registerForm.patchValue({latitude:e.lat,longitude:e.lng}),this.marker?this.marker.setLngLat(e):this.marker=new gM.default.Marker({draggable:!0,anchor:"center"}).setLngLat(e).addTo(this.map)})}getCityCoordinates(i){let n=`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(i+", Colombia")}.json?access_token=${Gd.mapboxToken}&limit=1`;return fetch(n).then(o=>o.json()).then(o=>{if(!o.features||o.features.length===0)throw new Error("No se encontr\xF3 la ciudad");let[r,g]=o.features[0].center;return{lng:r,lat:g}})}onRegister(){if(this.registerForm.invalid){this.registerForm.markAllAsTouched();return}if(this.isSubmitting)return;this.isSubmitting=!0;let i=this.registerForm.value;if(i.latitude==null||i.longitude==null){this.notificationService.error("Por favor selecciona una ubicaci\xF3n."),this.isSubmitting=!1;return}this.authService.register(i).subscribe({next:e=>{sessionStorage.setItem("Email",e.email),sessionStorage.setItem("UserId",e.id),this.notificationService.success("\xA1Registro exitoso!"),this.router.navigate(["/validate-account"])},error:e=>{let n=e.status,o="Ocurri\xF3 un error. Intenta de nuevo.";n===400?o=e.error?.message||"Datos inv\xE1lidos.":n===409?o="El correo ya est\xE1 registrado.":n===500&&(o="Error interno del servidor."),this.notificationService.error(o),this.showMap=!1,this.isSubmitting=!1}})}backToForm(){this.showMap=!1}get fullNameInvalid(){let i=this.registerForm.get("fullName");return!!(i&&i.touched&&i.invalid)}get emailInvalid(){let i=this.registerForm.get("email");return!!(i&&i.touched&&i.invalid)}get passwordInvalid(){let i=this.registerForm.get("password");return!!(i&&i.touched&&i.invalid)}get dateBirthInvalid(){let i=this.registerForm.get("dateBirth");return!!(i&&i.touched&&i.invalid)}get cityOfResidenceInvalid(){let i=this.registerForm.get("cityOfResidence");return!!(i&&i.touched&&i.invalid)}get notificationRadiusInvalid(){let i=this.registerForm.get("notificationRadiusKm");return!!(i&&i.touched&&(i.invalid||i.value<=0))}pastDateValidator(){return i=>{let e=i.value;if(!e)return null;let n=new Date(e),o=new Date;return o.setHours(0,0,0,0),n>o?{futureDate:!0}:null}}goBack(){history.back()}static \u0275fac=function(e){return new(e||t)(Ci(ns),Ci(Bo),Ci(fo),Ci($n))};static \u0275cmp=ai({type:t,selectors:[["app-register"]],decls:9,vars:5,consts:[["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],[1,"register-container"],[4,"ngIf"],[3,"ngSubmit","formGroup"],["class","loading-spinner",4,"ngIf"],[1,"field-group"],[1,"icon","fa","fa-user"],["type","text","placeholder","Nombre completo","formControlName","fullName"],["class","error-message",4,"ngIf"],[1,"icon","fa","fa-envelope"],["type","email","placeholder","Correo electr\xF3nico","formControlName","email"],[1,"icon","fa","fa-lock"],["type","password","placeholder","Contrase\xF1a","formControlName","password"],[1,"icon","fa","fa-calendar"],["type","date","formControlName","dateBirth"],[1,"icon","fa","fa-city"],["type","text","placeholder","Ciudad de residencia","formControlName","cityOfResidence"],[1,"icon","fa","fa-bullhorn"],["type","number","placeholder","Radio de notificaciones (Km)","formControlName","notificationRadiusKm"],["type","button",1,"submit-button",3,"click","disabled"],[1,"error-message"],[1,"loading-spinner"],["id","map_user"],["type","submit",1,"submit-button",3,"disabled"],["class","fas fa-spinner fa-spin me-2",4,"ngIf"],[1,"fas","fa-spinner","fa-spin","me-2"]],template:function(e,n){e&1&&(ae(0,"button",0),Nt("click",function(){return n.goBack()}),ae(1,"mat-icon"),Oe(2,"arrow_back"),se()(),ae(3,"div",1),Tt(4,Lge,2,0,"h2",2),ae(5,"form",3),Nt("ngSubmit",function(){return n.onRegister()}),Tt(6,Jge,37,17,"div",2)(7,e0e,2,0,"div",4)(8,i0e,9,4,"div",2),se()()),e&2&&(Se(4),Xe("ngIf",!n.showMap),Se(),Xe("formGroup",n.registerForm),Se(),Xe("ngIf",!n.showMap),Se(),Xe("ngIf",n.isLoadingMap),Se(),Xe("ngIf",n.showMap))},dependencies:[Or,Er,Ta,is,jo,N0,la,ts,ko,Ua,nu,rs,Uo],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c}.register-container[_ngcontent-%COMP%]{width:360px;background:var(--input-bg);margin:60px auto;padding:30px;border-radius:12px;text-align:center;box-shadow:0 4px 15px #0000001a;position:relative}.register-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;margin:0 0 25px;color:var(--primary-dark)}.field-group[_ngcontent-%COMP%]{position:relative;margin-bottom:15px}.field-group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:12px;transform:translateY(-50%);color:var(--primary-accent);font-size:18px}.field-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px 12px 12px 40px;border:2px solid #ccc;border-radius:6px;font-size:14px;background:var(--input-bg);transition:border-color .2s ease;box-sizing:border-box}.field-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-accent)}.error-message[_ngcontent-%COMP%]{text-align:left;color:var(--error-color);font-size:13px;margin:-10px 0 10px;padding-left:40px}.submit-button[_ngcontent-%COMP%]{width:100%;padding:12px;margin-top:3px;background:var(--primary-accent);color:#000;border:none;border-radius:6px;cursor:pointer;font-size:16px;font-weight:600;transition:background .3s ease,transform .2s ease;box-shadow:0 2px 8px #00000026}.submit-button[_ngcontent-%COMP%]:disabled{background:#aaa;color:#ccc;cursor:not-allowed}.submit-button[_ngcontent-%COMP%]:not(:disabled):hover{background:var(--primary-dark);transform:translateY(-2px)}.loading-spinner[_ngcontent-%COMP%]{font-size:16px;color:var(--primary-dark);margin:20px 0}#map_user[_ngcontent-%COMP%]{width:100%;height:400px;border:1px solid #ccc;border-radius:4px}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;background-color:#fff;border-radius:50%;box-shadow:0 2px 6px #0003}"]})};function n0e(t,i){t&1&&(ae(0,"div",14),Oe(1," \u26A0 Email inv\xE1lido o vac\xEDo "),se())}function r0e(t,i){t&1&&(ae(0,"div",14),Oe(1," \u26A0 La contrase\xF1a es obligatoria. "),se())}function o0e(t,i){t&1&&jt(0,"i",15)}function a0e(t,i){if(t&1){let e=zi();ae(0,"div",16)(1,"button",17),Nt("click",function(){ri(e);let o=zt();return oi(o.sendCodePassword())}),Oe(2," \xBFOlvidaste tu contrase\xF1a? "),se()()}if(t&2){let e=zt();Se(),Xe("disabled",e.isSubmitting||e.isSendPassword)}}var yM=class t{constructor(i,e,n,o){this.fb=i;this.authService=e;this.router=n;this.notificationService=o;this.registerForm=this.fb.group({email:["",[Ti.required,Ti.email]],password:["",[Ti.required]]})}registerForm;loginErrorMessage="";showReetPassword=!1;isSubmitting=!1;isSendPassword=!1;onLogin(){if(this.registerForm.invalid){this.registerForm.markAllAsTouched();return}if(this.isSubmitting)return;this.isSubmitting=!0;let{email:i,password:e}=this.registerForm.value;this.authService.login({email:i,password:e}).subscribe({next:()=>{this.notificationService.success("\xA1Bienvenido!"),this.router.navigate(["/map"])},error:n=>{let o=this.getErrorMessage(n.status,n.error?.message);this.notificationService.error(o),o.includes("La cuenta no est\xE1 activada")&&(this.notificationService.error("La cuenta no est\xE1 activada, reenviando c\xF3digo de activaci\xF3n..."),this.resendCode()),this.isSubmitting=!1}})}getErrorMessage(i,e){switch(i){case 400:return this.showReetPassword=!0,e||"Campos inv\xE1lidos.";case 403:return"La cuenta no est\xE1 activada";case 404:return"Usuario no encontrado.";case 500:return"Error interno del servidor.";default:return"Ocurri\xF3 un error. Intenta de nuevo."}}sendCodePassword(){if(this.isSendPassword)return;let i=this.registerForm.value.email;if(!i||this.registerForm.get("email")?.invalid){this.notificationService.error("Por favor ingresa un correo v\xE1lido.");return}this.isSendPassword=!0,this.authService.requestPasswordResetCode(i).subscribe({next:()=>{sessionStorage.setItem("email",i),this.notificationService.success("\u{1F4E9} C\xF3digo enviado al correo."),this.router.navigate(["/reset-password"])},error:e=>{switch(e.status){case 404:this.notificationService.error("\u274C Usuario no encontrado.");break;case 500:this.notificationService.error("\u26A0\uFE0F Error del servidor. Int\xE9ntalo m\xE1s tarde.");break;default:this.notificationService.error("Ocurri\xF3 un error. Int\xE9ntalo de nuevo.")}this.isSendPassword=!1}})}resendCode(){let i=this.registerForm.value.email;if(!i){this.notificationService.error("No se encontr\xF3 el email del usuario.");return}this.authService.sendCodeAgain(i).subscribe({next:()=>{this.router.navigate(["/validate-account"]),this.notificationService.success("\xA1C\xF3digo reenviado exitosamente!")},error:e=>{let n=e.status,o="Ocurri\xF3 un error al reenviar el c\xF3digo.";n===404?o="Usuario no encontrado.":n===500&&(o="Error interno del servidor."),this.notificationService.error(o)}})}get emailInvalid(){let i=this.registerForm.get("email");return!!(i&&i.touched&&i.invalid)}get passwordInvalid(){let i=this.registerForm.get("password");return!!(i&&i.touched&&i.invalid)}static \u0275fac=function(e){return new(e||t)(Ci(ns),Ci(Bo),Ci($n),Ci(fo))};static \u0275cmp=ai({type:t,selectors:[["app-login"]],decls:21,vars:7,consts:[[1,"login-container"],["alt","MapHopper","src","logo.png",1,"logo"],["novalidate","",3,"formGroup"],[1,"field-group"],[1,"fa","fa-envelope","icon"],["type","email","id","email","placeholder","Correo","formControlName","email","name","email"],["class","error-message",4,"ngIf"],[1,"fa","fa-lock","icon"],["type","password","id","password","placeholder","Contrase\xF1a","formControlName","password","name","password"],["type","button",1,"submit-button",3,"click","disabled"],["class","fas fa-spinner fa-spin me-2",4,"ngIf"],[1,"register-link"],["routerLink","/register"],["class","resend-container",4,"ngIf"],[1,"error-message"],[1,"fas","fa-spinner","fa-spin","me-2"],[1,"resend-container"],["type","button",1,"resend-button",3,"click","disabled"]],template:function(e,n){e&1&&(ae(0,"div",0),jt(1,"img",1),ae(2,"h2"),Oe(3,"INICIAR SESI\xD3N"),se(),ae(4,"form",2)(5,"div",3),jt(6,"i",4)(7,"input",5),se(),Tt(8,n0e,2,0,"div",6),ae(9,"div",3),jt(10,"i",7)(11,"input",8),se(),Tt(12,r0e,2,0,"div",6),ae(13,"button",9),Nt("click",function(){return n.onLogin()}),Tt(14,o0e,1,0,"i",10),Oe(15),se(),ae(16,"p",11),Oe(17," \xBFNo tienes una cuenta? "),ae(18,"a",12),Oe(19,"Reg\xEDstrate aqu\xED"),se()()(),Tt(20,a0e,3,1,"div",13),se()),e&2&&(Se(4),Xe("formGroup",n.registerForm),Se(4),Xe("ngIf",n.emailInvalid),Se(4),Xe("ngIf",n.passwordInvalid),Se(),Xe("disabled",n.registerForm.invalid||n.isSubmitting),Se(),Xe("ngIf",n.isSubmitting),Se(),an(" ",n.isSubmitting?"Ingresando...":"Ingresar"," "),Se(5),Xe("ngIf",n.showReetPassword))},dependencies:[Ta,is,jo,la,ts,ko,Ua,Er,nu,Ky],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c}body[_ngcontent-%COMP%]{background-color:var(--primary-bg);font-family:Segoe UI,sans-serif;color:var(--primary-dark)}.login-container[_ngcontent-%COMP%]{width:360px;background:var(--input-bg);margin:60px auto;padding:30px;border-radius:12px;text-align:center;box-shadow:0 4px 15px #0000001a;position:relative}.logo[_ngcontent-%COMP%]{width:80px;margin:0 auto 20px;display:block}h2[_ngcontent-%COMP%]{font-size:24px;margin:0 0 25px;color:var(--primary-dark)}.field-group[_ngcontent-%COMP%]{position:relative;margin-bottom:15px}.field-group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:12px;transform:translateY(-50%);color:var(--primary-accent);font-size:18px}.field-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px 12px 12px 40px;border:2px solid #ccc;border-radius:6px;font-size:14px;background:var(--input-bg);transition:border-color .2s ease;box-sizing:border-box}.field-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-accent)}.error-message[_ngcontent-%COMP%]{text-align:left;color:var(--error-color);font-size:13px;margin:-10px 0 10px;padding-left:40px}.submit-button[_ngcontent-%COMP%]{width:100%;padding:12px;background:var(--primary-accent);color:#000;border:none;border-radius:6px;cursor:pointer;font-size:16px;font-weight:600;transition:background .3s ease,transform .2s ease;box-shadow:0 2px 8px #00000026}.submit-button[_ngcontent-%COMP%]:disabled{background:#aaa;cursor:not-allowed;color:#ccc}.submit-button[_ngcontent-%COMP%]:not(:disabled):hover{background:var(--primary-dark);transform:translateY(-2px);color:#000}.register-link[_ngcontent-%COMP%]{margin-top:18px;font-size:14px}.register-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--primary-accent);text-decoration:none;font-weight:600}.register-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.resend-container[_ngcontent-%COMP%]{margin-top:20px}.resend-button[_ngcontent-%COMP%]{padding:10px 16px;background:var(--primary-bg);color:var(--primary-dark);border:2px solid var(--primary-accent);border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;transition:background .3s ease,transform .2s ease;display:inline-flex;align-items:center;gap:8px}.resend-button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.resend-button[_ngcontent-%COMP%]:not(:disabled):hover{background:var(--primary-accent);color:var(--input-bg);transform:translateY(-1px)}"]})};var Tm=K_(vv());var uu=63710088e-1,TZ={centimeters:uu*100,centimetres:uu*100,degrees:360/(2*Math.PI),feet:uu*3.28084,inches:uu*39.37,kilometers:uu/1e3,kilometres:uu/1e3,meters:uu,metres:uu,miles:uu/1609.344,millimeters:uu*1e3,millimetres:uu*1e3,nauticalmiles:uu/1852,radians:1,yards:uu*1.0936};function DZ(t,i,e={}){let n={type:"Feature"};return(e.id===0||e.id)&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.properties=i||{},n.geometry=t,n}function MZ(t,i,e={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!SZ(t[0])||!SZ(t[1]))throw new Error("coordinates must contain numbers");return DZ({type:"Point",coordinates:t},i,e)}function IZ(t,i,e={}){for(let o of t){if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(o[o.length-1].length!==o[0].length)throw new Error("First and last Position are not equivalent.");for(let r=0;r<o[o.length-1].length;r++)if(o[o.length-1][r]!==o[0][r])throw new Error("First and last Position are not equivalent.")}return DZ({type:"Polygon",coordinates:t},i,e)}function AZ(t,i="kilometers"){let e=TZ[i];if(!e)throw new Error(i+" units is invalid");return t*e}function RZ(t,i="kilometers"){let e=TZ[i];if(!e)throw new Error(i+" units is invalid");return t/e}function l4(t){return t%(2*Math.PI)*180/Math.PI}function Wp(t){return t%360*Math.PI/180}function SZ(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function jw(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function kZ(t,i,e,n={}){let o=jw(t),r=Wp(o[0]),g=Wp(o[1]),w=Wp(e),T=RZ(i,n.units),k=Math.asin(Math.sin(g)*Math.cos(T)+Math.cos(g)*Math.sin(T)*Math.cos(w)),N=r+Math.atan2(Math.sin(w)*Math.sin(T)*Math.cos(g),Math.cos(T)-Math.sin(g)*Math.sin(k)),V=l4(N),q=l4(k);return MZ([V,q],n.properties)}function c4(t,i,e={}){var n=jw(t),o=jw(i),r=Wp(o[1]-n[1]),g=Wp(o[0]-n[0]),w=Wp(n[1]),T=Wp(o[1]),k=Math.pow(Math.sin(r/2),2)+Math.pow(Math.sin(g/2),2)*Math.cos(w)*Math.cos(T);return AZ(2*Math.atan2(Math.sqrt(k),Math.sqrt(1-k)),e.units)}function Uw(t,i,e={}){let n=e.steps||64,o=e.properties?e.properties:!Array.isArray(t)&&t.type==="Feature"&&t.properties?t.properties:{},r=[];for(let g=0;g<n;g++)r.push(kZ(t,i,g*-360/n,e).geometry.coordinates);return r.push(r[0]),IZ([r],o)}var Gu=class t{constructor(i){this.http=i}apiUrl=`${es.urlBack}/categories`;cetegorySubject=new to([]);categories$=this.cetegorySubject.asObservable();getAllActiveCategories(){return this.http.get(this.apiUrl,{withCredentials:!0}).pipe(hr(i=>{this.cetegorySubject.next(i)}))}getAllCategories(){return this.http.get(`${this.apiUrl}/all`,{withCredentials:!0}).pipe(hr(i=>{this.cetegorySubject.next(i)}))}addCategory(i){return this.http.post(this.apiUrl,i,{withCredentials:!0})}toggleCategoryActivation(i){let e=`${this.apiUrl}/${i}/toggle-activated`;return this.http.patch(e,{},{withCredentials:!0})}getCategoryById(i){return this.http.get(`${this.apiUrl}/${i}`,{withCredentials:!0})}updateCategory(i,e){return this.http.put(`${this.apiUrl}/${i}`,e,{withCredentials:!0})}static \u0275fac=function(e){return new(e||t)(bi(Qa))};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})};var vM=class t{constructor(i){this.http=i}uploadPreset="default";uploadImage(i){let e=`https://api.cloudinary.com/v1_1/${es.cloud_name}/image/upload`,n=new FormData;return n.append("file",i),n.append("upload_preset",this.uploadPreset),n.append("api_key",es.api_key),this.http.post(e,n)}static \u0275fac=function(e){return new(e||t)(bi(Qa))};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})};var bM=class t{constructor(i,e){this.http=i;this.cloudinaryService=e}apiUrl=`${es.urlBack}/images`;registerImage(i,e){this.cloudinaryService.uploadImage(i).subscribe({next:n=>{if(console.log("Imagen subida:",n),e.id){let o={imageUrl:n.url,reportId:e.id};this.http.post(`${this.apiUrl}`,o,{withCredentials:!0}).subscribe({next:r=>{console.log("Imagen registrada en el reporte:",r)},error:r=>{console.error("Error registrando la imagen en el reporte:",r)}})}},error:n=>{console.error("Error subiendo la imagen  cloudinary:",n)}})}deleteImage(i){this.http.delete(`${this.apiUrl}/${i}`).subscribe({next:e=>{console.log("Imagen eliminada:",e)},error:e=>{console.error("Error eliminando la imagen:",e)}})}static \u0275fac=function(e){return new(e||t)(bi(Qa),bi(vM))};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})};var Mc=class t{constructor(i,e){this.http=i;this.imageService=e}apiUrl=`${es.urlBack}/reports`;selectedReportSource=new to(null);selectedReport$=this.selectedReportSource.asObservable();reportsSubject=new to([]);reports$=this.reportsSubject.asObservable();toggleVote(i){return this.http.patch(`${this.apiUrl}/${i}/votes`,{},{withCredentials:!0})}selectReport(i){this.selectedReportSource.next(i)}createReport(i,e){return this.http.post(this.apiUrl,i,{withCredentials:!0}).pipe(hr(n=>{console.log("Reporte creado:",n),this.imageService.registerImage(e,n)}))}getReports(){let i=new ws;return i=i.set("latitud",sessionStorage.getItem("lat")||""),i=i.set("longitud",sessionStorage.getItem("lng")||""),i=i.set("radio",sessionStorage.getItem("radiusKm")||""),this.http.get(`${this.apiUrl}`,{params:i,withCredentials:!0}).pipe(hr(e=>{this.reportsSubject.next(e.content)}))}refreshReports(){this.getReports().subscribe()}getReportById(i){return this.http.get(`${this.apiUrl}/${i}`,{withCredentials:!0}).pipe(Br(this.handleError))}getAllImagesReportById(i){return this.http.get(`${this.apiUrl}/${i}/images`,{withCredentials:!0}).pipe(Br(this.handleError))}getAllCommentsReportById(i){return this.http.get(`${this.apiUrl}/${i}/comments`,{withCredentials:!0}).pipe(Br(this.handleError))}updateReport(i,e,n){return console.log(e),n&&this.getAllImagesReportById(i).subscribe(o=>{o.forEach(r=>{this.imageService.deleteImage(r.id)}),this.imageService.registerImage(n,{id:i})}),this.http.put(`${this.apiUrl}/${i}`,e,{withCredentials:!0}).pipe(Br(this.handleError))}deleteReport(i){return this.http.delete(`${this.apiUrl}/${i}`,{withCredentials:!0}).pipe(Br(this.handleError))}resolveReport(i){return this.http.patch(`${this.apiUrl}/${i}/resolve`,{withCredentials:!0}).pipe(Br(this.handleError))}updateReportStatus(i,e,n){let o={status:e,rejectionMessage:n??null};return this.http.patch(`${this.apiUrl}/${i}/status`,o,{withCredentials:!0})}getMyReportsPaginated(i=1,e=10,n){let o=new ws().set("page",i).set("size",e);return this.http.get(`${this.apiUrl}/my`,{params:o,withCredentials:!0}).pipe(hn(r=>{let g=r.content.map(w=>ji(It({},w),{createdAt:new Date(w.createdAt),updatedAt:w.updatedAt?new Date(w.updatedAt):void 0,resolvedAt:w.resolvedAt?new Date(w.resolvedAt):void 0}));return ji(It({},r),{content:g})}),hr(r=>{console.log(`Reportes cargados: p\xE1gina ${r.page} de ${r.totalPages}, elementos totales: ${r.totalElements}`)}),Br(r=>(console.error("Error al obtener reportes paginados",r),wa(()=>r))))}getAllReportsPaginated(i=1,e=10,n){let o=new ws().set("page",i).set("size",e);return n&&(o=o.set("status",n)),this.http.get(`${this.apiUrl}/admin`,{params:o,withCredentials:!0}).pipe(hn(r=>{let g=r.content.map(w=>ji(It({},w),{createdAt:new Date(w.createdAt),updatedAt:w.updatedAt?new Date(w.updatedAt):void 0,resolvedAt:w.resolvedAt?new Date(w.resolvedAt):void 0}));return ji(It({},r),{content:g})}),hr(r=>{console.log(`Reportes cargados: p\xE1gina ${r.page} de ${r.totalPages}, elementos totales: ${r.totalElements}`)}),Br(r=>(console.error("Error al obtener reportes paginados",r),wa(()=>r))))}handleError(i){return console.error("Ocurri\xF3 un error en ReportService:",i),wa(()=>new Error("Error en la operaci\xF3n del reporte. Intenta de nuevo."))}static \u0275fac=function(e){return new(e||t)(bi(Qa),bi(bM))};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})};var c0e=(t,i)=>({"star-gray":t,"star-yellow":i});function u0e(t,i){if(t&1&&(ae(0,"option",10),Oe(1),se()),t&2){let e=i.$implicit;Xe("value",e.name),Se(),En(e.name)}}function d0e(t,i){if(t&1){let e=zi();ae(0,"li")(1,"div",11),Nt("click",function(){let o=ri(e).$implicit,r=zt();return oi(r.flyToReport(o))}),ae(2,"strong"),Oe(3),se(),Oe(4),ae(5,"p",12)(6,"mat-icon",13),Oe(7,"star "),se(),Oe(8),se(),ae(9,"p"),Oe(10),se()()()}if(t&2){let e=i.$implicit,n=zt();Se(3),En(e.title),Se(),an(" (",n.getCategoryNames(e),") "),Se(2),Xe("ngClass",dj(6,c0e,e.importantVotes===0,e.importantVotes>0)),Se(2),kh(" ",e.importantVotes||0," voto",e.importantVotes===1?"":"s"," importantes "),Se(2),an("descripci\xF3n: ",e.description,"")}}function h0e(t,i){t&1&&(ae(0,"li"),Oe(1," No hay reportes para mostrar con el filtro actual. "),se())}var wM=class t{constructor(i,e,n){this.categoryService=i;this.reportService=e;this.router=n}actionFilterReport=new Mi;categories=[];allReports=[];filteredReports=[];selectedCategory="";ngOnInit(){this.reportService.reports$.subscribe(i=>{this.allReports=i,this.filteredReports=this.sortByVotesDesc(this.allReports)}),this.loadCategories(),this.categoryService.categories$.subscribe(i=>{this.categories=i})}loadCategories(){this.categoryService.getAllActiveCategories().subscribe()}sortByVotesDesc(i){return[...i].sort((e,n)=>(n.importantVotes||0)-(e.importantVotes||0))}filterReports(i){this.selectedCategory=i;let e=i?this.allReports.filter(n=>n.categoryList?.some(o=>o.name===i)):[...this.allReports];this.filteredReports=this.sortByVotesDesc(e),this.actionFilterReport.emit(this.filteredReports)}flyToReport(i){this.reportService.selectReport(i)}editReport(i){i&&this.router.navigate(["/report/edit",i])}searchAddress(i){console.log("Buscar direcci\xF3n:",i)}getCategoryNames(i){return!i.categoryList||i.categoryList.length===0?"Sin categor\xEDa":i.categoryList.map(e=>e.name).join(", ")}static \u0275fac=function(e){return new(e||t)(Ci(Gu),Ci(Mc),Ci($n))};static \u0275cmp=ai({type:t,selectors:[["report-categories-filter"]],outputs:{actionFilterReport:"actionFilterReport"},decls:14,vars:3,consts:[["categorySelect",""],[1,"report-panel"],[1,"filter-section"],["for","category-filter"],["id","category-filter",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"report-list"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],[2,"cursor","pointer",3,"click"],[1,"important-votes"],[1,"star-icon",3,"ngClass"]],template:function(e,n){if(e&1){let o=zi();ae(0,"div",1)(1,"h3"),Oe(2,"Reportes"),se(),ae(3,"div",2)(4,"label",3),Oe(5,"Filtrar por categor\xEDa:"),se(),ae(6,"select",4,0),Nt("change",function(){ri(o);let g=Ca(7);return oi(n.filterReports(g.value))}),ae(8,"option",5),Oe(9,"Todos"),se(),Tt(10,u0e,2,2,"option",6),se()(),ae(11,"ul",7),Tt(12,d0e,11,9,"li",8)(13,h0e,2,0,"li",9),se()()}e&2&&(Se(10),Xe("ngForOf",n.categories),Se(2),Xe("ngForOf",n.filteredReports),Se(),Xe("ngIf",n.filteredReports.length===0))},dependencies:[Or,Js,bl,Er,Uo],styles:[".report-panel[_ngcontent-%COMP%]{width:300px;min-width:300px;max-width:300px;height:100vh;background-color:#f8f9fa;padding:15px;border-right:1px solid #dee2e6;display:flex;flex-direction:column;overflow:hidden;box-sizing:border-box}.filter-section[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:8px;border:1px solid #ced4da;border-radius:4px;box-sizing:border-box}.report-panel[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{max-width:100%;word-wrap:break-word;overflow-wrap:break-word}.report-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;overflow-y:auto;flex:1;min-height:0}.report-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:10px;border-bottom:1px solid #eee;cursor:pointer;transition:background-color .2s ease}.report-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:#e9ecef}.report-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;font-size:1em;margin-bottom:3px}.report-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85em;color:#6c757d;margin:0;word-wrap:break-word;overflow-wrap:break-word}.report-list[_ngcontent-%COMP%]   .star-icon.star-gray[_ngcontent-%COMP%]{color:gray!important}.report-list[_ngcontent-%COMP%]   .star-icon.star-yellow[_ngcontent-%COMP%]{color:gold!important}"]})};var EM=class t{constructor(i){this.http=i}apiUrl=`${es.urlBack}/comments`;registerComments(i){return this.http.post(`${this.apiUrl}`,i,{withCredentials:!0})}static \u0275fac=function(e){return new(e||t)(bi(Qa))};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})};function f0e(t,i){if(t&1&&(ae(0,"swiper-slide"),jt(1,"img",23),se()),t&2){let e=i.$implicit,n=zt(3);Se(),Xe("src",e.imageUrl,n0)("alt",n.report.title)}}function m0e(t,i){if(t&1&&(ae(0,"div",20)(1,"swiper-container",21),Tt(2,f0e,2,2,"swiper-slide",22),se()()),t&2){let e=zt(2);Se(2),Xe("ngForOf",e.report.images)}}function g0e(t,i){t&1&&(ae(0,"div",24),Oe(1,"No hay im\xE1genes disponibles"),se())}function _0e(t,i){if(t&1&&(ae(0,"div",25)(1,"div",26)(2,"mat-icon"),Oe(3,"person"),se(),ae(4,"strong"),Oe(5),se()(),ae(6,"p"),Oe(7),se()()),t&2){let e=i.$implicit;Se(5),En(e.userName),Se(2),En(e.comment)}}function y0e(t,i){if(t&1){let e=zi();ae(0,"div",2)(1,"div",3)(2,"button",4),Nt("click",function(){ri(e);let o=zt();return oi(o.close.emit())}),ae(3,"mat-icon"),Oe(4,"close"),se()(),ae(5,"div",5)(6,"h2",6),Oe(7),se(),Tt(8,m0e,3,1,"div",7)(9,g0e,2,0,"ng-template",null,0,rm),se(),ae(11,"div",8)(12,"p",9)(13,"strong"),Oe(14,"Categor\xEDas:"),se(),Oe(15),se(),ae(16,"p",10),Oe(17),se(),ae(18,"div",11)(19,"button",12),Nt("click",function(){ri(e);let o=zt();return oi(o.toggleVote(o.report))}),ae(20,"mat-icon",13),Oe(21,"star"),se(),Oe(22," Es importante "),se(),ae(23,"div",14),Oe(24),se()(),ae(25,"div",15)(26,"h3"),Oe(27,"Comentarios"),se(),Tt(28,_0e,8,2,"div",16),ae(29,"div",17)(30,"textarea",18),kp("ngModelChange",function(o){ri(e);let r=zt();return nm(r.newComment,o)||(r.newComment=o),oi(o)}),se(),ae(31,"button",19),Nt("click",function(){ri(e);let o=zt();return oi(o.addComment())}),Oe(32,"Comentar"),se()()()()()()}if(t&2){let e=Ca(10),n=zt();Se(7),En(n.report.title),Se(),Xe("ngIf",n.report.images==null?null:n.report.images.length)("ngIfElse",e),Se(7),an(" ",n.getCategoryNames(),""),Se(2),En(n.report.description),Se(3),Xe("ngClass",n.hasVoted?"star-yellow":"star-gray"),Se(4),an(" ",n.report.importantVotes," Votos "),Se(4),Xe("ngForOf",n.report.comments),Se(2),Rp("ngModel",n.newComment)}}var CM=class t{constructor(i,e){this.reportService=i;this.commentService=e}report=null;close=new Mi;newComment="";hasVoted=!1;ngOnInit(){this.report?.id&&this.loadComments(this.report.id)}loadComments(i){this.reportService.getAllCommentsReportById(i).subscribe({next:e=>{e.size>0&&this.report&&(this.report.comments=e.content)}})}addComment(){if(this.report?.id&&this.newComment.trim()){let i={reportId:this.report.id,comment:this.newComment.trim()};this.commentService.registerComments(i).subscribe({next:e=>{this.report?.comments?.push(e),this.newComment=""},error:e=>console.error(e)})}}toggleVote(i){if(!i.id){console.error("El reporte no tiene ID definido, no se puede alternar el voto.");return}this.reportService.toggleVote(i.id).subscribe({next:e=>{let n=e?1:-1;i.importantVotes=(i.importantVotes||0)+n,this.hasVoted=e},error:e=>{console.error("Error al alternar voto:",e)}})}getCategoryNames(){return this.report?.categoryList?.map(i=>i.name).join(", ")||"Sin categor\xEDa"}static \u0275fac=function(e){return new(e||t)(Ci(Mc),Ci(EM))};static \u0275cmp=ai({type:t,selectors:[["report-details-overlay"]],inputs:{report:"report"},outputs:{close:"close"},decls:1,vars:1,consts:[["noImages",""],["class","report-overlay",4,"ngIf"],[1,"report-overlay"],[1,"report-details"],[1,"close-btn",3,"click"],[1,"fixed-section"],[1,"title"],["class","image-carousel",4,"ngIf","ngIfElse"],[1,"scroll-section"],[1,"category"],[1,"description"],[1,"actions"],[1,"toggle-vote-btn",3,"click"],[3,"ngClass"],[1,"votes"],[1,"comments-section"],["class","comment",4,"ngFor","ngForOf"],[1,"add-comment"],["placeholder","Agregar un comentario",3,"ngModelChange","ngModel"],[1,"btn-primary",3,"click"],[1,"image-carousel"],["navigation","true","pagination","true","loop","true"],[4,"ngFor","ngForOf"],[3,"src","alt"],[1,"no-images"],[1,"comment"],[1,"comment-header"]],template:function(e,n){e&1&&Tt(0,y0e,33,9,"div",1),e&2&&Xe("ngIf",n.report)},dependencies:[Or,Js,bl,Er,Sm,jo,la,Lw,rs,Uo],styles:[".report-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0009;display:flex;justify-content:center;align-items:center;z-index:1000;padding:1rem;overflow-y:auto}.report-details[_ngcontent-%COMP%]{background:#fff;border-radius:12px;width:90%;max-width:800px;height:90vh;display:flex;flex-direction:column;box-shadow:0 8px 24px #0003;position:relative;overflow:hidden;box-sizing:border-box;padding:1rem}.close-btn[_ngcontent-%COMP%]{position:absolute;top:.75rem;right:.75rem;background:none;border:none;font-size:1.25rem;cursor:pointer;color:#555;transition:color .2s}.close-btn[_ngcontent-%COMP%]:hover{color:#000}.fixed-section[_ngcontent-%COMP%]{flex:0 0 auto}.title[_ngcontent-%COMP%]{margin:0 0 .75rem;font-size:1.75rem;text-align:center;color:#333}.image-carousel[_ngcontent-%COMP%]{width:100%;height:180px;border-radius:8px;overflow:hidden;margin-bottom:1rem}.image-carousel[_ngcontent-%COMP%]   swiper-container[_ngcontent-%COMP%]{width:100%;height:100%}.image-carousel[_ngcontent-%COMP%]   swiper-slide[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.image-carousel[_ngcontent-%COMP%]   swiper-slide[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.scroll-section[_ngcontent-%COMP%]{flex:1 1 auto;overflow-y:auto;padding-right:.5rem;display:flex;flex-direction:column;gap:1rem}.no-images[_ngcontent-%COMP%]{font-style:italic;color:#888;text-align:center}.category[_ngcontent-%COMP%], .description[_ngcontent-%COMP%]{font-size:1rem;color:#555}.category[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#333}.actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.toggle-vote-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.3rem;background:linear-gradient(135deg,#f9a825,#ffd54f);border:none;padding:.5rem 1rem;border-radius:24px;font-weight:700;color:#333;cursor:pointer;box-shadow:0 2px 6px #00000026;transition:transform .1s,box-shadow .1s}.toggle-vote-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0003}.toggle-vote-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.2rem}.votes[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.3rem;color:#666}.votes[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1976d2}.comments-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;color:#333}.comment[_ngcontent-%COMP%]{padding:.75rem 0;border-bottom:1px solid #eee}.comment-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:.9rem;color:#444}.comment-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1rem;color:#888}.comment[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0 0;font-size:.95rem;color:#555}.add-comment[_ngcontent-%COMP%]{margin-top:auto}.add-comment[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:97%;min-height:80px;padding:.75rem;border:1px solid #ccc;border-radius:6px;resize:vertical;font-size:1rem;margin-bottom:.5rem}.add-comment[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background-color:#1976d2;color:#fff;border:none;padding:.5rem 1rem;border-radius:6px;cursor:pointer;transition:background-color .2s}.add-comment[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover{background-color:#155fa0}.star-yellow[_ngcontent-%COMP%]{color:gold}.star-gray[_ngcontent-%COMP%]{color:gray}"]})};function v0e(t,i){if(t&1){let e=zi();ae(0,"report-details-overlay",9),Nt("close",function(){ri(e);let o=zt();return oi(o.selectedReport=null)}),se()}if(t&2){let e=zt();Xe("report",e.selectedReport)}}var SM=class t{constructor(i,e){this.reportService=i;this.authService=e}mapa;markers=[];platformId=J(Ns);allReports=[];selectedReport=null;reportClicked=new Mi;ngOnInit(){this.reportService.reports$.subscribe(i=>{this.allReports=i,this.loadImage()}),this.authService.getCurrentUser().subscribe({next:i=>{this.loadReports(),Cc(this.platformId)&&this.initializeMap([i.longitude,i.latitude])},error:()=>{let i=[-75.681,4.533];this.loadReports(),Cc(this.platformId)&&this.initializeMap(i)}}),this.reportService.selectedReport$.subscribe(i=>{this.selectedReport=i,i&&this.flyToReport(i)})}ngOnDestroy(){this.mapa?.remove()}loadReports(){this.reportService.getReports().subscribe({error:i=>console.error("Error reportes",i)})}initializeMap(i){this.mapa||(this.mapa=new Tm.default.Map({accessToken:Gd.mapboxToken,container:"map",style:"mapbox://styles/mapbox/streets-v11",center:i,zoom:12}),this.addUserMarker(i),this.mapa.addControl(new Tm.default.NavigationControl,"bottom-right"),this.mapa.addControl(new Tm.default.ScaleControl({maxWidth:100,unit:"metric"})),this.mapa.on("load",()=>{this.mapa.resize(),this.updateMarkers(this.allReports),this.drawUserRadius(i)}),this.mapa.on("error",e=>console.error("Mapbox error",e)))}drawUserRadius(i){let e=parseFloat(sessionStorage.getItem("radiusKm")||"1"),n=Uw(i,e,{steps:64,units:"kilometers"});this.mapa.getSource("user-radius")?this.mapa.getSource("user-radius").setData(n):(this.mapa.addSource("user-radius",{type:"geojson",data:n}),this.mapa.addLayer({id:"user-radius-fill",type:"fill",source:"user-radius",paint:{"fill-color":"#007BFF","fill-opacity":.15}}),this.mapa.addLayer({id:"user-radius-outline",type:"line",source:"user-radius",paint:{"line-color":"#007BFF","line-width":2}}))}addUserMarker(i){let e=document.createElement("div");e.className="user-marker",e.style.backgroundImage="url(user.ico)",e.style.width="40px",e.style.height="40px",e.style.backgroundSize="contain",new Tm.default.Marker(e).setLngLat(i).setPopup(new Tm.default.Popup().setText("Tu ubicaci\xF3n")).addTo(this.mapa)}clearMarkers(){this.markers.forEach(i=>i.remove()),this.markers=[]}updateMarkers(i){if(this.mapa){if(this.clearMarkers(),!this.mapa||!this.mapa.isStyleLoaded()){console.warn("Map is not ready yet. Skipping marker update.");return}i.forEach(e=>{let n=new Tm.default.Popup({closeButton:!1,closeOnMove:!0,anchor:"bottom",offset:[0,-20]}).setHTML(`
                <div class="report-popup">
                  <div class="popup-content">
                    <div class="popup-image">
                      <img src="${e.images&&e.images.length>0?e.images[0].imageUrl:"placeholder.png"}" alt="${e.title}" />
                    </div>
                    <div class="popup-info">
                      <h6 class="popup-title">${e.title}</h6>
                      <p class="popup-votes">${e.importantVotes} votos</p>
                    </div>
                  </div>
                </div>
              `),o=new Tm.default.Marker().setLngLat([e.longitude,e.latitude]).setDraggable(!1).setPopup(n).addTo(this.mapa);o.getElement().addEventListener("mouseenter",()=>{n.addTo(this.mapa)}),o.getElement().addEventListener("mouseleave",()=>{n.remove()}),o.getElement().addEventListener("click",()=>{this.selectedReport=e}),this.markers.push(o)})}}flyToReport(i){i&&this.mapa.flyTo({center:[i.longitude,i.latitude],zoom:15,essential:!0})}searchAddress(i){console.log("Buscar direcci\xF3n:",i)}loadImage(){for(let i of this.allReports)i.id&&this.reportService.getAllImagesReportById(i.id).subscribe({next:e=>{e.length>0&&i&&(i.images=e)}})}static \u0275fac=function(e){return new(e||t)(Ci(Mc),Ci(Bo))};static \u0275cmp=ai({type:t,selectors:[["app-map-view"]],outputs:{reportClicked:"reportClicked"},decls:10,vars:1,consts:[["searchInput",""],[1,"map-view-container"],[3,"actionFilterReport"],[3,"report","close",4,"ngIf"],[1,"map-panel"],[1,"search-bar"],["type","text","placeholder","Buscar direcci\xF3n..."],[3,"click"],["id","map",1,"map"],[3,"close","report"]],template:function(e,n){if(e&1){let o=zi();ae(0,"div",1)(1,"report-categories-filter",2),Nt("actionFilterReport",function(g){return ri(o),oi(n.updateMarkers(g))}),se(),Tt(2,v0e,1,1,"report-details-overlay",3),ae(3,"div",4)(4,"div",5),jt(5,"input",6,0),ae(7,"button",7),Nt("click",function(){ri(o);let g=Ca(6);return oi(n.searchAddress(g.value))}),Oe(8,"\u{1F50D}"),se()(),jt(9,"div",8),se()()}e&2&&(Se(2),Xe("ngIf",n.selectedReport))},dependencies:[Or,Er,wM,CM],styles:[".map-view-container[_ngcontent-%COMP%]{display:flex;width:100%;height:100vh;overflow:hidden}.map-panel[_ngcontent-%COMP%]{flex-grow:1;position:relative;display:flex;flex-direction:column}.map[_ngcontent-%COMP%]{width:100%;flex-grow:1;height:100%}.search-bar[_ngcontent-%COMP%]{position:absolute;top:10px;left:10px;transform:none;z-index:10;display:flex;background:#fff;padding:5px;border-radius:5px;box-shadow:0 2px 4px #0003}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;padding:5px}.search-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;background:none;cursor:pointer;padding:5px}.star-icon[_ngcontent-%COMP%]{vertical-align:middle;font-size:20px;margin-right:4px}.star-gray[_ngcontent-%COMP%]{color:gray}.star-yellow[_ngcontent-%COMP%]{color:gold}.important-votes[_ngcontent-%COMP%]{display:flex;align-items:center;margin:4px 0}"]})};var Gh=class t{constructor(i,e){this.authService=i;this.router=e}canActivate(){return console.log("call canActivate"),this.authService.isLoggedIn().pipe(hn(i=>i?!0:this.router.createUrlTree(["/login"])),Br(()=>Ni(this.router.createUrlTree(["/login"]))))}static \u0275fac=function(e){return new(e||t)(bi(Bo),bi($n))};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})};var b0e=["digitInput"];function x0e(t,i){t&1&&jt(0,"i",20)}function w0e(t,i){t&1&&jt(0,"i",21)}function E0e(t,i){if(t&1&&(ae(0,"span"),Oe(1),se()),t&2){let e=zt();Se(),an("Reenviar en ",e.formattedTime,"")}}function C0e(t,i){t&1&&(ae(0,"span"),Oe(1,"Reenviar C\xF3digo"),se())}var Hw=class t{fb=J(ns);router=J($n);notificationService=J(fo);authService=J(Bo);isSubmitting=!1;isResend=!1;digitInputs;verificationForm=this.fb.group({digit0:new Ro(null,[Ti.required,Ti.pattern(/^\d$/)]),digit1:new Ro(null,[Ti.required,Ti.pattern(/^\d$/)]),digit2:new Ro(null,[Ti.required,Ti.pattern(/^\d$/)]),digit3:new Ro(null,[Ti.required,Ti.pattern(/^\d$/)]),digit4:new Ro(null,[Ti.required,Ti.pattern(/^\d$/)]),digit5:new Ro(null,[Ti.required,Ti.pattern(/^\d$/)])});resendDisabled=!1;secondsLeft=0;countdownSub;ngOnInit(){}ngOnDestroy(){this.countdownSub?.unsubscribe()}submitCode(){if(this.verificationForm.invalid){this.notificationService.error("Por favor completa todos los campos del c\xF3digo."),this.verificationForm.markAllAsTouched();return}if(this.isSubmitting)return;this.isSubmitting=!0;let i=Object.values(this.verificationForm.value).join("");this.authService.validateAccount(i).subscribe({next:()=>{this.notificationService.success("\u2705 Cuenta validada exitosamente"),sessionStorage.removeItem("Email"),this.router.navigate(["/login"])},error:e=>{console.error("Error completo al validar cuenta:",e);let n=e.status,o="Ocurri\xF3 un error al validar la cuenta.";if(n===400){let r;try{r=typeof e.error=="string"?JSON.parse(e.error):e.error}catch{r={message:e.error}}let g=r.message?.toLowerCase()??"";g.includes("c\xF3digo inv\xE1lido")?o="El c\xF3digo es inv\xE1lido.":g.includes("expirado")?o="El c\xF3digo ha expirado.":o=g||"Solicitud incorrecta."}else n===500&&(o="Error interno del servidor.");this.notificationService.error(o),this.isSubmitting=!1}})}resendCode(){if(this.resendDisabled||this.isSubmitting||this.isResend)return;this.isResend=!0;let i=sessionStorage.getItem("email");if(!i){this.notificationService.error("No se encontr\xF3 el email del usuario.");return}this.authService.sendCodeAgain(i).subscribe({next:()=>{this.startCountdown(),this.notificationService.success("\xA1C\xF3digo reenviado exitosamente!"),this.isResend=!1},error:e=>{let n=e.status,o="Ocurri\xF3 un error al reenviar el c\xF3digo.";n===404?o="Usuario no encontrado.":n===500&&(o="Error interno del servidor."),this.notificationService.error(o),this.isResend=!1}})}startCountdown(){this.countdownSub?.unsubscribe(),this.resendDisabled=!0,this.secondsLeft=120,this.countdownSub=A1(1e3).pipe(Lg(()=>this.secondsLeft>0)).subscribe(()=>{this.secondsLeft--,this.secondsLeft===0&&(this.resendDisabled=!1)})}get formattedTime(){let i=Math.floor(this.secondsLeft/60).toString().padStart(2,"0"),e=(this.secondsLeft%60).toString().padStart(2,"0");return`${i}:${e}`}onCodeInput(i,e){let o=i.target.value.replace(/\D/g,"").slice(0,1),r=`digit${e}`;this.verificationForm.controls[r].setValue(o,{emitEvent:!1}),o&&e<this.digitInputs.length-1&&this.digitInputs.toArray()[e+1].nativeElement.focus()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ai({type:t,selectors:[["app-verification"]],viewQuery:function(e,n){if(e&1&&pr(b0e,5),e&2){let o;sn(o=ln())&&(n.digitInputs=o)}},decls:30,vars:8,consts:[["digitInput",""],[1,"verification-container"],[1,"logo"],[1,"fas","fa-shield-alt"],[1,"subtitle"],[3,"ngSubmit","formGroup"],[1,"code-inputs"],["type","text","maxlength","1","formControlName","digit0","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit1","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit2","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit3","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit4","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit5","placeholder","-",1,"digit-input",3,"input"],["type","submit",1,"submit-button",3,"disabled"],["class","fas fa-check-circle",4,"ngIf"],["class","fas fa-spinner fa-spin me-2",4,"ngIf"],[1,"resend-container"],["type","button",1,"resend-button",3,"click","disabled"],[1,"fas","fa-clock"],[4,"ngIf"],[1,"fas","fa-check-circle"],[1,"fas","fa-spinner","fa-spin","me-2"]],template:function(e,n){if(e&1){let o=zi();ae(0,"div",1)(1,"div",2),jt(2,"i",3),se(),ae(3,"h2"),Oe(4,"Verificaci\xF3n de Cuenta"),se(),ae(5,"p",4),Oe(6,"Ingresa el c\xF3digo de 6 d\xEDgitos enviado a tu correo"),se(),ae(7,"form",5),Nt("ngSubmit",function(){return ri(o),oi(n.submitCode())}),ae(8,"div",6)(9,"input",7,0),Nt("input",function(g){return ri(o),oi(n.onCodeInput(g,0))}),se(),ae(11,"input",8,0),Nt("input",function(g){return ri(o),oi(n.onCodeInput(g,1))}),se(),ae(13,"input",9,0),Nt("input",function(g){return ri(o),oi(n.onCodeInput(g,2))}),se(),ae(15,"input",10,0),Nt("input",function(g){return ri(o),oi(n.onCodeInput(g,3))}),se(),ae(17,"input",11,0),Nt("input",function(g){return ri(o),oi(n.onCodeInput(g,4))}),se(),ae(19,"input",12,0),Nt("input",function(g){return ri(o),oi(n.onCodeInput(g,5))}),se()(),ae(21,"button",13),Tt(22,x0e,1,0,"i",14)(23,w0e,1,0,"i",15),Oe(24),se()(),ae(25,"div",16)(26,"button",17),Nt("click",function(){return ri(o),oi(n.resendCode())}),jt(27,"i",18),Tt(28,E0e,2,1,"span",19)(29,C0e,2,0,"span",19),se()()()}e&2&&(Se(7),Xe("formGroup",n.verificationForm),Se(14),Xe("disabled",n.verificationForm.invalid||n.isSubmitting),Se(),Xe("ngIf",!n.isSubmitting),Se(),Xe("ngIf",n.isSubmitting),Se(),an(" ",n.isSubmitting?"Validando...":"Validar C\xF3digo"," "),Se(2),Xe("disabled",n.resendDisabled||n.isSubmitting||n.isResend),Se(2),Xe("ngIf",n.resendDisabled),Se(),Xe("ngIf",!n.resendDisabled))},dependencies:[Or,Er,Ta,is,jo,la,ts,Fw,ko,Ua],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c}.verification-container[_ngcontent-%COMP%]{width:380px;background:var(--input-bg);margin:80px auto;padding:30px 25px;border-radius:12px;text-align:center;box-shadow:0 4px 15px #0000001a}.logo[_ngcontent-%COMP%]{font-size:3rem;color:var(--primary-accent);margin-bottom:15px}h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:8px;color:var(--primary-dark)}.subtitle[_ngcontent-%COMP%]{font-size:14px;margin-bottom:25px;color:var(--primary-accent)}.code-inputs[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:20px}.digit-input[_ngcontent-%COMP%]{width:48px;height:60px;font-size:2rem;text-align:center;border:2px dashed var(--primary-dark);border-radius:6px;background:var(--input-bg);background-image:linear-gradient(to bottom right,var(--primary-accent) 2px,transparent 2px);background-size:100% 100%;transition:background .2s ease,border-color .2s ease;box-sizing:border-box}.digit-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-accent)}.digit-input.ng-valid[_ngcontent-%COMP%]{background-image:none}.submit-button[_ngcontent-%COMP%]{width:100%;padding:12px;background:var(--primary-accent);color:var(--primary-dark);border:none;border-radius:6px;cursor:pointer;font-size:16px;font-weight:600;transition:background .3s ease,transform .2s ease;box-shadow:0 2px 8px #00000026}.submit-button[_ngcontent-%COMP%]:disabled{background:#aaa;cursor:not-allowed;color:#ccc}.submit-button[_ngcontent-%COMP%]:not(:disabled):hover{background:var(--primary-dark);transform:translateY(-2px);color:var(--input-bg)}.resend-container[_ngcontent-%COMP%]{margin-top:20px}.resend-button[_ngcontent-%COMP%]{padding:10px 16px;background:var(--primary-bg);color:var(--primary-dark);border:2px solid var(--primary-accent);border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;transition:background .3s ease,transform .2s ease;display:inline-flex;align-items:center;gap:8px}.resend-button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.resend-button[_ngcontent-%COMP%]:not(:disabled):hover{background:var(--primary-accent);color:var(--input-bg);transform:translateY(-1px)}"]})};var Wh=K_(vv());function S0e(t,i){t&1&&(ae(0,"span"),Oe(1,"El t\xEDtulo es obligatorio."),se())}function T0e(t,i){t&1&&(ae(0,"span"),Oe(1,"M\xEDnimo 5 caracteres."),se())}function D0e(t,i){t&1&&(ae(0,"span"),Oe(1,"M\xE1ximo 100 caracteres."),se())}function M0e(t,i){if(t&1&&(ae(0,"div",22),Tt(1,S0e,2,0,"span",14)(2,T0e,2,0,"span",14)(3,D0e,2,0,"span",14),se()),t&2){let e=zt();Se(),Xe("ngIf",e.title==null||e.title.errors==null?null:e.title.errors.required),Se(),Xe("ngIf",e.title==null||e.title.errors==null?null:e.title.errors.minlength),Se(),Xe("ngIf",e.title==null||e.title.errors==null?null:e.title.errors.maxlength)}}function I0e(t,i){t&1&&(ae(0,"span"),Oe(1,"La descripci\xF3n es obligatoria."),se())}function A0e(t,i){t&1&&(ae(0,"span"),Oe(1,"M\xEDnimo 10 caracteres."),se())}function R0e(t,i){if(t&1&&(ae(0,"div",22),Tt(1,I0e,2,0,"span",14)(2,A0e,2,0,"span",14),se()),t&2){let e=zt();Se(),Xe("ngIf",e.description==null||e.description.errors==null?null:e.description.errors.required),Se(),Xe("ngIf",e.description==null||e.description.errors==null?null:e.description.errors.minlength)}}function k0e(t,i){if(t&1){let e=zi();ae(0,"button",23),Nt("click",function(){let o=ri(e).$implicit,r=zt();return oi(r.toggleCategory(o.id))}),Oe(1),se()}if(t&2){let e=i.$implicit,n=zt();Ji("selected",n.isSelected(e.id)),Se(),an(" ",e.name," ")}}function O0e(t,i){t&1&&(ae(0,"span"),Oe(1," Debes seleccionar al menos una categor\xEDa. "),se())}function P0e(t,i){if(t&1&&(ae(0,"div",22),Tt(1,O0e,2,0,"span",14),se()),t&2){let e=zt();Se(),Xe("ngIf",(e.categoryIds==null||e.categoryIds.errors==null?null:e.categoryIds.errors.required)||(e.categoryIds==null||e.categoryIds.errors==null?null:e.categoryIds.errors.minlength))}}function N0e(t,i){if(t&1&&(ae(0,"li"),Oe(1),se()),t&2){let e=i.$implicit,n=zt(2);Se(),an(" ",n.getCategoryName(e)," ")}}function L0e(t,i){if(t&1&&(ae(0,"div")(1,"p"),Oe(2,"Categor\xEDas seleccionadas:"),se(),ae(3,"ul"),Tt(4,N0e,2,1,"li",24),se()()),t&2){let e=zt();Se(4),Xe("ngForOf",e.categoryIds==null?null:e.categoryIds.value)}}function F0e(t,i){t&1&&(ae(0,"div",22),Oe(1," Debes seleccionar una ubicaci\xF3n en el mapa. "),se())}function z0e(t,i){if(t&1){let e=zi();ae(0,"div",25)(1,"div",26),jt(2,"img",27),ae(3,"button",28),Nt("click",function(){ri(e);let o=zt();return oi(o.removePreview(0))}),Oe(4," \u2716 "),se()()()}if(t&2){let e=zt();Se(2),Xe("src",e.imagePreview,n0)}}function B0e(t,i){t&1&&(ae(0,"div",22),Oe(1," Debes subir al menos una imagen. "),se())}function V0e(t,i){if(t&1&&(ae(0,"span"),Oe(1),se()),t&2){let e=zt();Se(),an(" ",e.isEditMode?"Actualizar Reporte":"Crear Reporte"," ")}}function j0e(t,i){if(t&1&&(ae(0,"span"),Oe(1),se()),t&2){let e=zt();Se(),an(" ",e.isEditMode?"Actualizando...":"Creando..."," ")}}var qw=class t{constructor(i,e,n,o,r,g,w){this.fb=i;this.reportService=e;this.categoryService=n;this.snackBar=o;this.router=r;this.route=g;this.cdRef=w;this.reportForm=this.fb.group({title:["",[Ti.required,Ti.minLength(5),Ti.maxLength(100)]],description:["",[Ti.required,Ti.minLength(10)]],categoryIds:[[],[Ti.required,Ti.minLength(1)]],latitude:[null,Ti.required],longitude:[null,Ti.required],selectedFile:[null,Ti.required]})}reportForm;categories=[];file=null;imagePreview=null;map;marker;isLoading=!1;isEditMode=!1;reportId=null;routeSub=null;initialReportData=null;platformId=J(Ns);notificationService=J(fo);ngOnInit(){this.loadCategories(),this.routeSub=this.route.paramMap.subscribe(i=>{this.reportId=i.get("id"),this.reportId?(this.isEditMode=!0,this.loadReportForEdit(this.reportId)):(this.isEditMode=!1,console.log("No hay ID de reporte, modo creaci\xF3n."),setTimeout(()=>this.initializeMap(),100))})}ngAfterViewInit(){}ngOnDestroy(){this.routeSub?.unsubscribe(),this.map?.remove()}loadCategories(){this.categoryService.getAllActiveCategories().subscribe({next:i=>this.categories=i,error:i=>this.notificationService.error("Error al cargar las categor\xEDas")})}loadReportForEdit(i){this.isLoading=!0,this.reportService.getReportById(i).subscribe({next:e=>{this.initialReportData=e,this.reportForm.patchValue({title:e.title,description:e.description,categoryIds:e.categoryList.map(n=>n.id),latitude:e.latitude,longitude:e.longitude}),this.reportForm.get("selectedFile")?.clearValidators(),this.reportForm.get("selectedFile")?.updateValueAndValidity(),this.loadImages(e.id),this.isLoading=!1,this.initializeMapWithReportCoords(e.longitude,e.latitude)},error:e=>{this.isLoading=!1,this.notificationService.error("Error al cargar el reporte para editar."),this.router.navigate(["/map"])}})}initializeMapWithReportCoords(i,e){this.map&&this.map.remove(),this.map=new Wh.default.Map({accessToken:Gd.mapboxToken,container:"map_user",style:"mapbox://styles/mapbox/streets-v11",center:[i,e],zoom:15,attributionControl:!1}),this.addMapControls(),this.addMarkerWithDragging(i,e)}addMapControls(){this.map.addControl(new Wh.default.NavigationControl,"bottom-right"),this.map.addControl(new Wh.default.FullscreenControl,"top-right")}addMarkerWithDragging(i,e){this.marker&&this.marker.remove(),this.marker=new Wh.default.Marker({draggable:!0}).setLngLat([i,e]).addTo(this.map),this.marker.on("dragend",()=>{let n=this.marker.getLngLat();this.reportForm.patchValue({latitude:n.lat,longitude:n.lng})}),this.map.flyTo({center:[i,e],essential:!0})}initializeMap(i){let e=sessionStorage.getItem("lat"),n=sessionStorage.getItem("lng"),o,r;e&&n?(o={lng:parseFloat(n),lat:parseFloat(e)},r=13):i?(o={lng:i[0],lat:i[1]},r=13):(o={lng:-75.681,lat:4.533},r=13);try{this.map=new Wh.default.Map({accessToken:Gd.mapboxToken,container:"map_user",style:"mapbox://styles/mapbox/streets-v11",center:o,zoom:r,attributionControl:!1}),this.map.addControl(new Wh.default.NavigationControl,"bottom-right"),this.map.on("load",()=>{if(this.map.resize(),console.log("Mapa cargado (report form)."),this.reportForm.get("latitude")?.value&&this.reportForm.get("longitude")?.value){let g=new Wh.LngLat(this.reportForm.get("longitude")?.value,this.reportForm.get("latitude")?.value);this.updateMarkerAndForm(g)}}),this.map.on("click",({lngLat:g})=>{this.isEditMode||this.updateMarkerAndForm(g)}),this.map.on("error",g=>{console.error("Error en Mapbox (report form):",g),this.notificationService.error("Error al cargar el mapa.")})}catch(g){console.error("Error inicializando Mapbox (report form):",g)}}updateMarkerAndForm(i){this.reportForm.patchValue({latitude:i.lat,longitude:i.lng}),this.marker?this.marker.setLngLat(i):(this.marker=new Wh.default.Marker({draggable:!this.isEditMode}).setLngLat(i).addTo(this.map),this.isEditMode||this.marker.on("dragend",()=>{let e=this.marker.getLngLat();this.reportForm.patchValue({latitude:e.lat,longitude:e.lng})}))}onFileSelected(i){let e=i.currentTarget,n=e.files;if(this.imagePreview=null,n&&n.length>0){let o=n[0];this.file=n[0],o.type.startsWith("image/")||this.notificationService.error(`El archivo '${o.name}' no es una imagen v\xE1lida.`);let r=new FileReader;r.onload=g=>{this.imagePreview=g.target.result,this.cdRef.detectChanges()},r.readAsDataURL(o)}e.value=""}removePreview(i){this.imagePreview=null}onSubmit(){if(this.reportForm.invalid){this.reportForm.markAllAsTouched(),this.snackBar.open("Por favor, completa todos los campos requeridos.","Cerrar",{duration:3e3});return}if(!this.isEditMode&&!this.file){this.snackBar.open("Debes subir al menos una imagen para el reporte.","Cerrar",{duration:3e3});return}this.isLoading=!0;let i=this.reportForm.value,e={title:i.title,description:i.description,latitude:i.latitude,longitude:i.longitude,categoryList:this.categories.filter(n=>i.categoryIds.includes(n.id))};this.isEditMode&&this.reportId?(console.log(this.file),this.reportService.updateReport(this.reportId,e,this.file).subscribe({next:()=>{this.isLoading=!1,this.notificationService.success("Reporte actualizado con \xE9xito."),this.router.navigate(["/map"])},error:n=>{this.isLoading=!1,this.notificationService.error("Error al actualizar el reporte.")}})):this.file&&this.reportService.createReport(e,this.file).subscribe({next:n=>{this.isLoading=!1,this.notificationService.success("Reporte creado con \xE9xito. Pendiente de verificaci\xF3n."),this.router.navigate(["/map"])},error:n=>{this.isLoading=!1,this.notificationService.error(n.message||"Error al crear el reporte.")}})}getCategoryName(i){return this.categories.find(e=>e.id===i)?.name||"Desconocido"}toggleCategory(i){let e=this.reportForm.get("categoryIds"),n=e?.value||[],o=n.indexOf(i);o>-1?n.splice(o,1):n.push(i),e?.setValue([...n])}isSelected(i){return this.reportForm.get("categoryIds")?.value?.includes(i)}get title(){return this.reportForm.get("title")}get description(){return this.reportForm.get("description")}get categoryIds(){return this.reportForm.get("categoryIds")}get latitude(){return this.reportForm.get("latitude")}get longitude(){return this.reportForm.get("longitude")}get selectedFile(){return this.reportForm.get("selectedFile")}loadImages(i){i&&this.reportService.getAllImagesReportById(i).subscribe({next:e=>{this.imagePreview=e[0].imageUrl,console.log("Imagenes cargadas",this.imagePreview)},error:e=>{this.snackBar.open("Error al cargar las im\xE1genes del reporte.","Cerrar",{duration:3e3})}})}goBack(){this.router.navigate(["/map"])}static \u0275fac=function(e){return new(e||t)(Ci(ns),Ci(Mc),Ci(Gu),Ci(L0),Ci($n),Ci(Tc),Ci(vr))};static \u0275cmp=ai({type:t,selectors:[["app-report"]],decls:43,vars:13,consts:[["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],[1,"report-container"],["novalidate","",3,"ngSubmit","formGroup"],[1,"field-group"],["for","title"],[1,"fa","fa-heading","icon"],["type","text","id","title","formControlName","title","placeholder","Ej: Perro perdido cerca del parque"],["class","error-message",4,"ngIf"],["for","description"],[1,"fa","fa-align-left","icon"],["id","description","formControlName","description","rows","4","placeholder","Describe detalladamente lo que sucede..."],[1,"fa","fa-tags","icon"],[1,"category-chip-container"],["type","button",3,"selected","click",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"fa","fa-map-marker-alt","icon"],["id","map_user",2,"width","100%","height","300px","border","1px solid #ccc","border-radius","6px"],["for","selectedFile"],[1,"fa","fa-image","icon"],["type","file","id","selectedFile","formControlName","selectedFile","accept","image/*",3,"change"],["class","image-previews",4,"ngIf"],["type","submit",1,"submit-button",3,"disabled"],[1,"error-message"],["type","button",3,"click"],[4,"ngFor","ngForOf"],[1,"image-previews"],[1,"preview-item"],["alt","Previsualizaci\xF3n",3,"src"],["type","button","title","Quitar imagen",1,"remove-preview-btn",3,"click"]],template:function(e,n){e&1&&(ae(0,"button",0),Nt("click",function(){return n.goBack()}),ae(1,"mat-icon"),Oe(2,"arrow_back"),se()(),ae(3,"div",1)(4,"h2"),Oe(5),se(),ae(6,"form",2),Nt("ngSubmit",function(){return n.onSubmit()}),ae(7,"div",3)(8,"label",4),jt(9,"i",5),Oe(10," T\xEDtulo "),se(),jt(11,"input",6),Tt(12,M0e,4,3,"div",7),se(),ae(13,"div",3)(14,"label",8),jt(15,"i",9),Oe(16," Descripci\xF3n "),se(),jt(17,"textarea",10),Tt(18,R0e,3,2,"div",7),se(),ae(19,"div",3)(20,"label"),jt(21,"i",11),Oe(22," Categor\xEDas "),se(),ae(23,"div",12),Tt(24,k0e,2,3,"button",13),se(),Tt(25,P0e,2,1,"div",7)(26,L0e,5,1,"div",14),se(),ae(27,"div",3)(28,"label"),jt(29,"i",15),Oe(30," Ubicaci\xF3n "),se(),jt(31,"div",16),Tt(32,F0e,2,0,"div",7),se(),ae(33,"div",3)(34,"label",17),jt(35,"i",18),Oe(36," Im\xE1genes (al menos 1) "),se(),ae(37,"input",19),Nt("change",function(r){return n.onFileSelected(r)}),se(),Tt(38,z0e,5,1,"div",20)(39,B0e,2,0,"div",7),se(),ae(40,"button",21),Tt(41,V0e,2,1,"span",14)(42,j0e,2,1,"span",14),se()()()),e&2&&(Se(5),En(n.isEditMode?"Editar Reporte":"Crear Nuevo Reporte"),Se(),Xe("formGroup",n.reportForm),Se(6),Xe("ngIf",(n.title==null?null:n.title.invalid)&&((n.title==null?null:n.title.dirty)||(n.title==null?null:n.title.touched))),Se(6),Xe("ngIf",(n.description==null?null:n.description.invalid)&&((n.description==null?null:n.description.dirty)||(n.description==null?null:n.description.touched))),Se(6),Xe("ngForOf",n.categories),Se(),Xe("ngIf",(n.categoryIds==null?null:n.categoryIds.invalid)&&((n.categoryIds==null?null:n.categoryIds.touched)||(n.categoryIds==null?null:n.categoryIds.dirty))),Se(),Xe("ngIf",n.categoryIds==null||n.categoryIds.value==null?null:n.categoryIds.value.length),Se(6),Xe("ngIf",((n.latitude==null?null:n.latitude.invalid)||(n.longitude==null?null:n.longitude.invalid))&&((n.latitude==null?null:n.latitude.touched)||(n.longitude==null?null:n.longitude.touched))),Se(6),Xe("ngIf",n.imagePreview),Se(),Xe("ngIf",!n.isEditMode&&!n.selectedFile&&n.reportForm.touched),Se(),Xe("disabled",n.reportForm.invalid||n.isLoading||!n.isEditMode&&!n.selectedFile),Se(),Xe("ngIf",!n.isLoading),Se(),Xe("ngIf",n.isLoading))},dependencies:[Or,bl,Er,Ta,is,jo,la,ts,ko,Ua,nu,rs,Uo],styles:["body[_ngcontent-%COMP%]{font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;background-color:#f4f6f8;margin:0;padding:0}.report-container[_ngcontent-%COMP%]{max-width:700px;margin:50px auto;padding:30px 40px;border:1px solid #ccc;border-radius:8px;background-color:#fff;box-shadow:0 4px 12px #0000000d}.report-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;font-size:28px;color:#333;margin-bottom:40px}.field-group[_ngcontent-%COMP%]{margin-bottom:40px}.field-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:12px;font-weight:700;color:#555}.field-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .field-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .field-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{display:block;width:100%;padding:14px 16px;border:1px solid #ccc;border-radius:4px;box-sizing:border-box;font-size:15px;background-color:#fff;transition:border-color .2s ease}.field-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .field-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, .field-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:#79b4d8;outline:none}.field-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:vertical;min-height:120px}.field-group[_ngcontent-%COMP%]   select[multiple][_ngcontent-%COMP%]{min-height:120px}.error-message[_ngcontent-%COMP%]{color:#e74c3c;font-size:.9em;margin-top:8px}.category-chip-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:10px}.category-chip-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#ecf0f1;border:1px solid #bdc3c7;color:#2c3e50;padding:8px 14px;border-radius:20px;cursor:pointer;transition:background .2s ease,border-color .2s ease}.category-chip-container[_ngcontent-%COMP%]   button.selected[_ngcontent-%COMP%]{background-color:#79b4d8;color:#fff;border-color:#1e3a5f}.image-previews[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:12px;margin-top:12px}.preview-item[_ngcontent-%COMP%]{position:relative;border-radius:4px;overflow:visible;box-shadow:0 2px 6px #0000001a}.remove-preview-btn[_ngcontent-%COMP%]{position:absolute;top:-8px;right:-8px;background:#e74c3c;color:#fff;border:none;border-radius:50%;width:24px;height:24px;font-size:14px;line-height:24px;text-align:center;cursor:pointer;z-index:1}.remove-preview-btn[_ngcontent-%COMP%]:hover{background:#c0392b}.preview-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100px;max-height:100px;object-fit:cover}#map_user[_ngcontent-%COMP%], #map_report[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:4px;height:300px;margin-top:12px}.submit-button[_ngcontent-%COMP%]{display:block;width:100%;padding:14px;background-color:#f9f9f9;color:#333;border:1px solid #ccc;border-radius:4px;font-size:16px;cursor:pointer;transition:background-color .2s ease;margin-top:30px}.submit-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#e0e0e0}.submit-button[_ngcontent-%COMP%]:disabled{background-color:#ddd;cursor:not-allowed}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;width:40px;height:40px;padding:0;background-color:#fff;border:1px solid #ccc;border-radius:8px;box-shadow:0 4px 12px #0000000d;display:flex;align-items:center;justify-content:center;transition:background-color .2s ease,transform .1s ease}.back-button[_ngcontent-%COMP%]:hover{background-color:#f9f9f9;transform:translate(-2px)}.back-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;color:#0009}"]})};var U0e=["digitInput"];function H0e(t,i){t&1&&(ae(0,"div",23),Oe(1," La contrase\xF1a debe tener al menos una may\xFAscula, una min\xFAscula y un d\xEDgito. "),se())}function q0e(t,i){t&1&&jt(0,"i",24)}function $0e(t,i){t&1&&jt(0,"i",25)}function G0e(t,i){if(t&1&&(ae(0,"span"),Oe(1),se()),t&2){let e=zt();Se(),an("Reenviar en ",e.formattedTime,"")}}function W0e(t,i){t&1&&(ae(0,"span"),Oe(1,"Reenviar C\xF3digo"),se())}var TM=class t{fb=J(ns);router=J($n);notificationService=J(fo);authService=J(Bo);digitInputs;verificationForm=this.fb.group({digit0:new Ro(null,[Ti.required,Ti.pattern(/^\d$/)]),digit1:new Ro(null,[Ti.required,Ti.pattern(/^\d$/)]),digit2:new Ro(null,[Ti.required,Ti.pattern(/^\d$/)]),digit3:new Ro(null,[Ti.required,Ti.pattern(/^\d$/)]),digit4:new Ro(null,[Ti.required,Ti.pattern(/^\d$/)]),digit5:new Ro(null,[Ti.required,Ti.pattern(/^\d$/)]),password:new Ro(null,[Ti.required,Ti.pattern(/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/)])});isSubmitting=!1;isResend=!1;resendDisabled=!1;secondsLeft=0;countdownSub;ngOnInit(){}ngOnDestroy(){this.countdownSub?.unsubscribe()}submitCode(){if(this.verificationForm.invalid){this.notificationService.error("Por favor completa todos los campos del c\xF3digo y la contrase\xF1a."),this.verificationForm.markAllAsTouched();return}if(this.isSubmitting)return;this.isSubmitting=!0;let i=[this.verificationForm.value.digit0,this.verificationForm.value.digit1,this.verificationForm.value.digit2,this.verificationForm.value.digit3,this.verificationForm.value.digit4,this.verificationForm.value.digit5].join(""),e=this.verificationForm.value.password;this.authService.resetPasswordWithCode({code:i,newPassword:e}).subscribe({next:()=>{this.notificationService.success("\u2705 Contrase\xF1a restablecida exitosamente"),this.router.navigate(["/login"])},error:n=>{console.error("Error completo al restablecer contrase\xF1a:",n);let o=n.status,r="Ocurri\xF3 un error al restablecer la contrase\xF1a.";if(o===400){let g;try{g=typeof n.error=="string"?JSON.parse(n.error):n.error}catch{g={message:n.error}}let w=g.message?.toLowerCase()??"";w.includes("no es v\xE1lido para recuperar contrase\xF1a")?r="El c\xF3digo no es v\xE1lido para recuperar contrase\xF1a.":w.includes("c\xF3digo inv\xE1lido")?r="El c\xF3digo es inv\xE1lido.":w.includes("ha expirado")?r="El c\xF3digo ha expirado.":r=g.message||"Solicitud incorrecta."}else o===404?r="Usuario no encontrado.":o===500&&(r="Error interno del servidor.");this.notificationService.error(r),this.isSubmitting=!1}})}resendCode(){if(this.resendDisabled||this.isSubmitting||this.isResend)return;this.isResend=!0;let i=sessionStorage.getItem("email");if(!i){this.notificationService.error("No se encontr\xF3 el email del usuario.");return}this.authService.resendResetPasswordCode(i).subscribe({next:()=>{this.startCountdown(),this.notificationService.success("\xA1C\xF3digo reenviado exitosamente!"),this.isResend=!1},error:e=>{let n=e.status,o="Ocurri\xF3 un error al reenviar el c\xF3digo.";n===404?o="Usuario no encontrado.":n===500&&(o="Error interno del servidor."),this.notificationService.error(o),this.isResend=!1}})}startCountdown(){this.countdownSub?.unsubscribe(),this.resendDisabled=!0,this.secondsLeft=120,this.countdownSub=A1(1e3).pipe(Lg(()=>this.secondsLeft>0)).subscribe(()=>{this.secondsLeft--,this.secondsLeft===0&&(this.resendDisabled=!1)})}get formattedTime(){let i=Math.floor(this.secondsLeft/60).toString().padStart(2,"0"),e=(this.secondsLeft%60).toString().padStart(2,"0");return`${i}:${e}`}onCodeInput(i,e){let o=i.target.value.replace(/\D/g,"").slice(0,1),r=`digit${e}`;this.verificationForm.controls[r].setValue(o,{emitEvent:!1}),o&&e<this.digitInputs.length-1&&this.digitInputs.toArray()[e+1].nativeElement.focus()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ai({type:t,selectors:[["app-verification"]],viewQuery:function(e,n){if(e&1&&pr(U0e,5),e&2){let o;sn(o=ln())&&(n.digitInputs=o)}},decls:33,vars:9,consts:[["digitInput",""],[1,"verification-container"],[1,"logo"],[1,"fas","fa-shield-alt"],[1,"subtitle"],[3,"ngSubmit","formGroup"],[1,"code-inputs"],["type","text","maxlength","1","formControlName","digit0","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit1","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit2","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit3","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit4","placeholder","-",1,"digit-input",3,"input"],["type","text","maxlength","1","formControlName","digit5","placeholder","-",1,"digit-input",3,"input"],[1,"password-group"],["type","password","formControlName","password","placeholder","Nueva contrase\xF1a",1,"password-input"],["class","error-message",4,"ngIf"],["type","submit",1,"submit-button",3,"disabled"],["class","fas fa-check-circle",4,"ngIf"],["class","fas fa-spinner fa-spin me-2",4,"ngIf"],[1,"resend-container"],["type","button",1,"resend-button",3,"click","disabled"],[1,"fas","fa-clock"],[4,"ngIf"],[1,"error-message"],[1,"fas","fa-check-circle"],[1,"fas","fa-spinner","fa-spin","me-2"]],template:function(e,n){if(e&1){let o=zi();ae(0,"div",1)(1,"div",2),jt(2,"i",3),se(),ae(3,"h2"),Oe(4,"Confirmaci\xF3n de restablecer contrase\xF1a"),se(),ae(5,"p",4),Oe(6,"Ingresa el c\xF3digo de 6 d\xEDgitos y tu nueva contrase\xF1a"),se(),ae(7,"form",5),Nt("ngSubmit",function(){return ri(o),oi(n.submitCode())}),ae(8,"div",6)(9,"input",7,0),Nt("input",function(g){return ri(o),oi(n.onCodeInput(g,0))}),se(),ae(11,"input",8,0),Nt("input",function(g){return ri(o),oi(n.onCodeInput(g,1))}),se(),ae(13,"input",9,0),Nt("input",function(g){return ri(o),oi(n.onCodeInput(g,2))}),se(),ae(15,"input",10,0),Nt("input",function(g){return ri(o),oi(n.onCodeInput(g,3))}),se(),ae(17,"input",11,0),Nt("input",function(g){return ri(o),oi(n.onCodeInput(g,4))}),se(),ae(19,"input",12,0),Nt("input",function(g){return ri(o),oi(n.onCodeInput(g,5))}),se()(),ae(21,"div",13),jt(22,"input",14),Tt(23,H0e,2,0,"div",15),se(),ae(24,"button",16),Tt(25,q0e,1,0,"i",17)(26,$0e,1,0,"i",18),Oe(27),se()(),ae(28,"div",19)(29,"button",20),Nt("click",function(){return ri(o),oi(n.resendCode())}),jt(30,"i",21),Tt(31,G0e,2,1,"span",22)(32,W0e,2,0,"span",22),se()()()}if(e&2){let o;Se(7),Xe("formGroup",n.verificationForm),Se(16),Xe("ngIf",((o=n.verificationForm.get("password"))==null?null:o.invalid)&&((o=n.verificationForm.get("password"))==null?null:o.touched)),Se(),Xe("disabled",n.verificationForm.invalid||n.isSubmitting),Se(),Xe("ngIf",!n.isSubmitting),Se(),Xe("ngIf",n.isSubmitting),Se(),an(" ",n.isSubmitting?"Restableciendo...":"Confirmar y Cambiar"," "),Se(2),Xe("disabled",n.resendDisabled||n.isSubmitting||n.isResend),Se(2),Xe("ngIf",n.resendDisabled),Se(),Xe("ngIf",!n.resendDisabled)}},dependencies:[Or,Er,Ta,is,jo,la,ts,Fw,ko,Ua],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c}.verification-container[_ngcontent-%COMP%]{width:380px;background:var(--input-bg);margin:80px auto;padding:30px 25px;border-radius:12px;text-align:center;box-shadow:0 4px 15px #0000001a}.logo[_ngcontent-%COMP%]{font-size:3rem;color:var(--primary-accent);margin-bottom:15px}h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:8px;color:var(--primary-dark)}.subtitle[_ngcontent-%COMP%]{font-size:14px;margin-bottom:25px;color:var(--primary-accent)}.code-inputs[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:10px}.digit-input[_ngcontent-%COMP%]{width:40px;height:50px;font-size:1.5rem;text-align:center;border:2px dashed var(--primary-dark);border-radius:6px;background:var(--input-bg);background-image:linear-gradient(to bottom right,var(--primary-accent) 2px,transparent 2px);background-size:100% 100%;transition:background .2s ease,border-color .2s ease;box-sizing:border-box}.digit-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-accent)}.digit-input.ng-valid[_ngcontent-%COMP%]{background-image:none}.submit-button[_ngcontent-%COMP%]{width:100%;padding:12px;margin-top:8px;background:var(--primary-accent);color:var(--primary-dark);border:none;border-radius:6px;cursor:pointer;font-size:16px;font-weight:600;transition:background .3s ease,transform .2s ease;box-shadow:0 2px 8px #00000026}.submit-button[_ngcontent-%COMP%]:disabled{background:#aaa;cursor:not-allowed;color:#ccc}.submit-button[_ngcontent-%COMP%]:not(:disabled):hover{background:var(--primary-dark);transform:translateY(-2px);color:var(--input-bg)}.resend-container[_ngcontent-%COMP%]{margin-top:20px}.resend-button[_ngcontent-%COMP%]{padding:10px 16px;background:var(--primary-bg);color:var(--primary-dark);border:2px solid var(--primary-accent);border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;transition:background .3s ease,transform .2s ease;display:inline-flex;align-items:center;gap:8px}.resend-button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.resend-button[_ngcontent-%COMP%]:not(:disabled):hover{background:var(--primary-accent);color:var(--input-bg);transform:translateY(-1px)}.password-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.password-input[_ngcontent-%COMP%]{padding:10px;font-size:16px;margin-bottom:10px;border:2px solid #ccc;border-radius:6px;background:var(--input-bg);transition:border-color .2s ease}.password-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-accent)}.error-message[_ngcontent-%COMP%]{color:var(--error-color);font-size:13px;text-align:left;margin-top:-10px}"]})};var DM=class t{constructor(i){this.router=i}goHome(){this.router.navigate(["/map"])}static \u0275fac=function(e){return new(e||t)(Ci($n))};static \u0275cmp=ai({type:t,selectors:[["app-not-found"]],decls:10,vars:0,consts:[[1,"not-found-container"],[1,"icon-wrapper"],[1,"fas","fa-exclamation-triangle"],[1,"submit-button",3,"click"],[1,"fas","fa-home"]],template:function(e,n){e&1&&(ae(0,"div",0)(1,"div",1),jt(2,"i",2),se(),ae(3,"h1"),Oe(4,"P\xE1gina no encontrada"),se(),ae(5,"p"),Oe(6,"Lo sentimos, la ruta que est\xE1s buscando no existe."),se(),ae(7,"button",3),Nt("click",function(){return n.goHome()}),jt(8,"i",4),Oe(9," Ir al inicio "),se()())},dependencies:[nu],styles:["[_nghost-%COMP%]{display:block}.not-found-container[_ngcontent-%COMP%]{max-width:400px;margin:100px auto;padding:40px;text-align:center;background-color:var(--input-bg);border-radius:12px;box-shadow:0 4px 20px #0000001a}.icon-wrapper[_ngcontent-%COMP%]{font-size:60px;color:var(--primary-accent);margin-bottom:20px}.not-found-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:26px;color:var(--primary-dark);margin-bottom:10px}.not-found-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#555;margin-bottom:30px;font-size:16px}.submit-button[_ngcontent-%COMP%]{width:100%;padding:12px;background:var(--primary-accent);color:#000;border:none;border-radius:6px;cursor:pointer;font-size:16px;font-weight:600;transition:background .3s ease,transform .2s ease;box-shadow:0 2px 8px #00000026}.submit-button[_ngcontent-%COMP%]:hover{background:var(--primary-dark);transform:translateY(-2px)}.submit-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:8px}"]})};var F0=class{applyChanges(i,e,n,o,r){i.forEachOperation((g,w,T)=>{let k,N;if(g.previousIndex==null){let V=n(g,w,T);k=e.createEmbeddedView(V.templateRef,V.context,V.index),N=xm.INSERTED}else T==null?(e.remove(w),N=xm.REMOVED):(k=e.get(w),e.move(k,T),N=xm.MOVED);r&&r({context:k?.context,operation:N,record:g})})}detach(){}};var Z0e=[[["caption"]],[["colgroup"],["col"]],"*"],Y0e=["caption","colgroup, col","*"];function K0e(t,i){t&1&&On(0,2)}function X0e(t,i){t&1&&(ae(0,"thead",0),ys(1,1),se(),ae(2,"tbody",0),ys(3,2)(4,3),se(),ae(5,"tfoot",0),ys(6,4),se())}function Q0e(t,i){t&1&&ys(0,1)(1,2)(2,3)(3,4)}var Wd=new Ot("CDK_TABLE");var OM=(()=>{class t{template=J(Zo);constructor(){}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","cdkCellDef",""]]})}return t})(),PM=(()=>{class t{template=J(Zo);constructor(){}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","cdkHeaderCellDef",""]]})}return t})(),zZ=(()=>{class t{template=J(Zo);constructor(){}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","cdkFooterCellDef",""]]})}return t})(),bv=(()=>{class t{_table=J(Wd,{optional:!0});_hasStickyChanged=!1;get name(){return this._name}set name(e){this._setNameInput(e)}_name;get sticky(){return this._sticky}set sticky(e){e!==this._sticky&&(this._sticky=e,this._hasStickyChanged=!0)}_sticky=!1;get stickyEnd(){return this._stickyEnd}set stickyEnd(e){e!==this._stickyEnd&&(this._stickyEnd=e,this._hasStickyChanged=!0)}_stickyEnd=!1;cell;headerCell;footerCell;cssClassFriendlyName;_columnCssClassName;constructor(){}hasStickyChanged(){let e=this._hasStickyChanged;return this.resetStickyChanged(),e}resetStickyChanged(){this._hasStickyChanged=!1}_updateColumnCssClassName(){this._columnCssClassName=[`cdk-column-${this.cssClassFriendlyName}`]}_setNameInput(e){e&&(this._name=e,this.cssClassFriendlyName=e.replace(/[^a-z0-9_-]/gi,"-"),this._updateColumnCssClassName())}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","cdkColumnDef",""]],contentQueries:function(n,o,r){if(n&1&&(ao(r,OM,5),ao(r,PM,5),ao(r,zZ,5)),n&2){let g;sn(g=ln())&&(o.cell=g.first),sn(g=ln())&&(o.headerCell=g.first),sn(g=ln())&&(o.footerCell=g.first)}},inputs:{name:[0,"cdkColumnDef","name"],sticky:[2,"sticky","sticky",Bi],stickyEnd:[2,"stickyEnd","stickyEnd",Bi]},features:[fr([{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:t}])]})}return t})(),IM=class{constructor(i,e){e.nativeElement.classList.add(...i._columnCssClassName)}},BZ=(()=>{class t extends IM{constructor(){super(J(bv),J(Qi))}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["cdk-header-cell"],["th","cdk-header-cell",""]],hostAttrs:["role","columnheader",1,"cdk-header-cell"],features:[Fn]})}return t})();var VZ=(()=>{class t extends IM{constructor(){let e=J(bv),n=J(Qi);super(e,n);let o=e._table?._getCellRole();o&&n.nativeElement.setAttribute("role",o)}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["cdk-cell"],["td","cdk-cell",""]],hostAttrs:[1,"cdk-cell"],features:[Fn]})}return t})(),AM=class{tasks=[];endTasks=[]},RM=new Ot("_COALESCED_STYLE_SCHEDULER"),d4=(()=>{class t{_currentSchedule=null;_ngZone=J(Oi);constructor(){}schedule(e){this._createScheduleIfNeeded(),this._currentSchedule.tasks.push(e)}scheduleEnd(e){this._createScheduleIfNeeded(),this._currentSchedule.endTasks.push(e)}_createScheduleIfNeeded(){this._currentSchedule||(this._currentSchedule=new AM,this._ngZone.runOutsideAngular(()=>queueMicrotask(()=>{for(;this._currentSchedule.tasks.length||this._currentSchedule.endTasks.length;){let e=this._currentSchedule;this._currentSchedule=new AM;for(let n of e.tasks)n();for(let n of e.endTasks)n()}this._currentSchedule=null})))}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})();var h4=(()=>{class t{template=J(Zo);_differs=J(Ph);columns;_columnsDiffer;constructor(){}ngOnChanges(e){if(!this._columnsDiffer){let n=e.columns&&e.columns.currentValue||[];this._columnsDiffer=this._differs.find(n).create(),this._columnsDiffer.diff(n)}}getColumnsDiff(){return this._columnsDiffer.diff(this.columns)}extractCellTemplate(e){return this instanceof $w?e.headerCell.template:this instanceof p4?e.footerCell.template:e.cell.template}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,features:[$r]})}return t})(),$w=(()=>{class t extends h4{_table=J(Wd,{optional:!0});_hasStickyChanged=!1;get sticky(){return this._sticky}set sticky(e){e!==this._sticky&&(this._sticky=e,this._hasStickyChanged=!0)}_sticky=!1;constructor(){super(J(Zo),J(Ph))}ngOnChanges(e){super.ngOnChanges(e)}hasStickyChanged(){let e=this._hasStickyChanged;return this.resetStickyChanged(),e}resetStickyChanged(){this._hasStickyChanged=!1}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","cdkHeaderRowDef",""]],inputs:{columns:[0,"cdkHeaderRowDef","columns"],sticky:[2,"cdkHeaderRowDefSticky","sticky",Bi]},features:[Fn,$r]})}return t})(),p4=(()=>{class t extends h4{_table=J(Wd,{optional:!0});_hasStickyChanged=!1;get sticky(){return this._sticky}set sticky(e){e!==this._sticky&&(this._sticky=e,this._hasStickyChanged=!0)}_sticky=!1;constructor(){super(J(Zo),J(Ph))}ngOnChanges(e){super.ngOnChanges(e)}hasStickyChanged(){let e=this._hasStickyChanged;return this.resetStickyChanged(),e}resetStickyChanged(){this._hasStickyChanged=!1}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","cdkFooterRowDef",""]],inputs:{columns:[0,"cdkFooterRowDef","columns"],sticky:[2,"cdkFooterRowDefSticky","sticky",Bi]},features:[Fn,$r]})}return t})(),NM=(()=>{class t extends h4{_table=J(Wd,{optional:!0});when;constructor(){super(J(Zo),J(Ph))}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","cdkRowDef",""]],inputs:{columns:[0,"cdkRowDefColumns","columns"],when:[0,"cdkRowDefWhen","when"]},features:[Fn]})}return t})(),z0=(()=>{class t{_viewContainer=J(na);cells;context;static mostRecentCellOutlet=null;constructor(){t.mostRecentCellOutlet=this}ngOnDestroy(){t.mostRecentCellOutlet===this&&(t.mostRecentCellOutlet=null)}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","cdkCellOutlet",""]]})}return t})(),f4=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["cdk-header-row"],["tr","cdk-header-row",""]],hostAttrs:["role","row",1,"cdk-header-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(n,o){n&1&&ys(0,0)},dependencies:[z0],encapsulation:2})}return t})();var m4=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["cdk-row"],["tr","cdk-row",""]],hostAttrs:["role","row",1,"cdk-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(n,o){n&1&&ys(0,0)},dependencies:[z0],encapsulation:2})}return t})(),jZ=(()=>{class t{templateRef=J(Zo);_contentClassName="cdk-no-data-row";constructor(){}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["ng-template","cdkNoDataRow",""]]})}return t})(),NZ=["top","bottom","left","right"],u4=class{_isNativeHtmlTable;_stickCellCss;direction;_coalescedStyleScheduler;_isBrowser;_needsPositionStickyOnElement;_positionListener;_tableInjector;_elemSizeCache=new WeakMap;_resizeObserver=globalThis?.ResizeObserver?new globalThis.ResizeObserver(i=>this._updateCachedSizes(i)):null;_updatedStickyColumnsParamsToReplay=[];_stickyColumnsReplayTimeout=null;_cachedCellWidths=[];_borderCellCss;_destroyed=!1;constructor(i,e,n,o,r=!0,g=!0,w,T){this._isNativeHtmlTable=i,this._stickCellCss=e,this.direction=n,this._coalescedStyleScheduler=o,this._isBrowser=r,this._needsPositionStickyOnElement=g,this._positionListener=w,this._tableInjector=T,this._borderCellCss={top:`${e}-border-elem-top`,bottom:`${e}-border-elem-bottom`,left:`${e}-border-elem-left`,right:`${e}-border-elem-right`}}clearStickyPositioning(i,e){(e.includes("left")||e.includes("right"))&&this._removeFromStickyColumnReplayQueue(i);let n=[];for(let o of i)o.nodeType===o.ELEMENT_NODE&&n.push(o,...Array.from(o.children));this._afterNextRender({write:()=>{for(let o of n)this._removeStickyStyle(o,e)}})}updateStickyColumns(i,e,n,o=!0,r=!0){if(!i.length||!this._isBrowser||!(e.some(De=>De)||n.some(De=>De))){this._positionListener?.stickyColumnsUpdated({sizes:[]}),this._positionListener?.stickyEndColumnsUpdated({sizes:[]});return}let g=i[0],w=g.children.length,T=this.direction==="rtl",k=T?"right":"left",N=T?"left":"right",V=e.lastIndexOf(!0),q=n.indexOf(!0),Z,X,te;r&&this._updateStickyColumnReplayQueue({rows:[...i],stickyStartStates:[...e],stickyEndStates:[...n]}),this._afterNextRender({earlyRead:()=>{Z=this._getCellWidths(g,o),X=this._getStickyStartColumnPositions(Z,e),te=this._getStickyEndColumnPositions(Z,n)},write:()=>{for(let De of i)for(let _e=0;_e<w;_e++){let he=De.children[_e];e[_e]&&this._addStickyStyle(he,k,X[_e],_e===V),n[_e]&&this._addStickyStyle(he,N,te[_e],_e===q)}this._positionListener&&Z.some(De=>!!De)&&(this._positionListener.stickyColumnsUpdated({sizes:V===-1?[]:Z.slice(0,V+1).map((De,_e)=>e[_e]?De:null)}),this._positionListener.stickyEndColumnsUpdated({sizes:q===-1?[]:Z.slice(q).map((De,_e)=>n[_e+q]?De:null).reverse()}))}})}stickRows(i,e,n){if(!this._isBrowser)return;let o=n==="bottom"?i.slice().reverse():i,r=n==="bottom"?e.slice().reverse():e,g=[],w=[],T=[];this._afterNextRender({earlyRead:()=>{for(let k=0,N=0;k<o.length;k++){if(!r[k])continue;g[k]=N;let V=o[k];T[k]=this._isNativeHtmlTable?Array.from(V.children):[V];let q=this._retrieveElementSize(V).height;N+=q,w[k]=q}},write:()=>{let k=r.lastIndexOf(!0);for(let N=0;N<o.length;N++){if(!r[N])continue;let V=g[N],q=N===k;for(let Z of T[N])this._addStickyStyle(Z,n,V,q)}n==="top"?this._positionListener?.stickyHeaderRowsUpdated({sizes:w,offsets:g,elements:T}):this._positionListener?.stickyFooterRowsUpdated({sizes:w,offsets:g,elements:T})}})}updateStickyFooterContainer(i,e){this._isNativeHtmlTable&&this._afterNextRender({write:()=>{let n=i.querySelector("tfoot");n&&(e.some(o=>!o)?this._removeStickyStyle(n,["bottom"]):this._addStickyStyle(n,"bottom",0,!1))}})}destroy(){this._stickyColumnsReplayTimeout&&clearTimeout(this._stickyColumnsReplayTimeout),this._resizeObserver?.disconnect(),this._destroyed=!0}_removeStickyStyle(i,e){if(!i.classList.contains(this._stickCellCss))return;for(let o of e)i.style[o]="",i.classList.remove(this._borderCellCss[o]);NZ.some(o=>e.indexOf(o)===-1&&i.style[o])?i.style.zIndex=this._getCalculatedZIndex(i):(i.style.zIndex="",this._needsPositionStickyOnElement&&(i.style.position=""),i.classList.remove(this._stickCellCss))}_addStickyStyle(i,e,n,o){i.classList.add(this._stickCellCss),o&&i.classList.add(this._borderCellCss[e]),i.style[e]=`${n}px`,i.style.zIndex=this._getCalculatedZIndex(i),this._needsPositionStickyOnElement&&(i.style.cssText+="position: -webkit-sticky; position: sticky; ")}_getCalculatedZIndex(i){let e={top:100,bottom:10,left:1,right:1},n=0;for(let o of NZ)i.style[o]&&(n+=e[o]);return n?`${n}`:""}_getCellWidths(i,e=!0){if(!e&&this._cachedCellWidths.length)return this._cachedCellWidths;let n=[],o=i.children;for(let r=0;r<o.length;r++){let g=o[r];n.push(this._retrieveElementSize(g).width)}return this._cachedCellWidths=n,n}_getStickyStartColumnPositions(i,e){let n=[],o=0;for(let r=0;r<i.length;r++)e[r]&&(n[r]=o,o+=i[r]);return n}_getStickyEndColumnPositions(i,e){let n=[],o=0;for(let r=i.length;r>0;r--)e[r]&&(n[r]=o,o+=i[r]);return n}_retrieveElementSize(i){let e=this._elemSizeCache.get(i);if(e)return e;let n=i.getBoundingClientRect(),o={width:n.width,height:n.height};return this._resizeObserver&&(this._elemSizeCache.set(i,o),this._resizeObserver.observe(i,{box:"border-box"})),o}_updateStickyColumnReplayQueue(i){this._removeFromStickyColumnReplayQueue(i.rows),this._stickyColumnsReplayTimeout||this._updatedStickyColumnsParamsToReplay.push(i)}_removeFromStickyColumnReplayQueue(i){let e=new Set(i);for(let n of this._updatedStickyColumnsParamsToReplay)n.rows=n.rows.filter(o=>!e.has(o));this._updatedStickyColumnsParamsToReplay=this._updatedStickyColumnsParamsToReplay.filter(n=>!!n.rows.length)}_updateCachedSizes(i){let e=!1;for(let n of i){let o=n.borderBoxSize?.length?{width:n.borderBoxSize[0].inlineSize,height:n.borderBoxSize[0].blockSize}:{width:n.contentRect.width,height:n.contentRect.height};o.width!==this._elemSizeCache.get(n.target)?.width&&J0e(n.target)&&(e=!0),this._elemSizeCache.set(n.target,o)}e&&this._updatedStickyColumnsParamsToReplay.length&&(this._stickyColumnsReplayTimeout&&clearTimeout(this._stickyColumnsReplayTimeout),this._stickyColumnsReplayTimeout=setTimeout(()=>{if(!this._destroyed){for(let n of this._updatedStickyColumnsParamsToReplay)this.updateStickyColumns(n.rows,n.stickyStartStates,n.stickyEndStates,!0,!1);this._updatedStickyColumnsParamsToReplay=[],this._stickyColumnsReplayTimeout=null}},0))}_afterNextRender(i){this._tableInjector?_s(i,{injector:this._tableInjector}):this._coalescedStyleScheduler.schedule(()=>{i.earlyRead?.(),i.write()})}};function J0e(t){return["cdk-cell","cdk-header-cell","cdk-footer-cell"].some(i=>t.classList.contains(i))}var kM=new Ot("CDK_SPL");var g4=(()=>{class t{viewContainer=J(na);elementRef=J(Qi);constructor(){let e=J(Wd);e._rowOutlet=this,e._outletAssigned()}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","rowOutlet",""]]})}return t})(),_4=(()=>{class t{viewContainer=J(na);elementRef=J(Qi);constructor(){let e=J(Wd);e._headerRowOutlet=this,e._outletAssigned()}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","headerRowOutlet",""]]})}return t})(),y4=(()=>{class t{viewContainer=J(na);elementRef=J(Qi);constructor(){let e=J(Wd);e._footerRowOutlet=this,e._outletAssigned()}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","footerRowOutlet",""]]})}return t})(),v4=(()=>{class t{viewContainer=J(na);elementRef=J(Qi);constructor(){let e=J(Wd);e._noDataRowOutlet=this,e._outletAssigned()}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","noDataRowOutlet",""]]})}return t})();var b4=(()=>{class t{_differs=J(Ph);_changeDetectorRef=J(vr);_elementRef=J(Qi);_dir=J(aa,{optional:!0});_platform=J(Pr);_viewRepeater=J(av);_coalescedStyleScheduler=J(RM);_viewportRuler=J(wm);_stickyPositioningListener=J(kM,{optional:!0,skipSelf:!0});_document=J(cn);_data;_onDestroy=new gi;_renderRows;_renderChangeSubscription;_columnDefsByName=new Map;_rowDefs;_headerRowDefs;_footerRowDefs;_dataDiffer;_defaultRowDef;_customColumnDefs=new Set;_customRowDefs=new Set;_customHeaderRowDefs=new Set;_customFooterRowDefs=new Set;_customNoDataRow;_headerRowDefChanged=!0;_footerRowDefChanged=!0;_stickyColumnStylesNeedReset=!0;_forceRecalculateCellWidths=!0;_cachedRenderRowsMap=new Map;_isNativeHtmlTable;_stickyStyler;stickyCssClass="cdk-table-sticky";needsPositionStickyOnElement=!0;_isServer;_isShowingNoDataRow=!1;_hasAllOutlets=!1;_hasInitialized=!1;_getCellRole(){if(this._cellRoleInternal===void 0){let e=this._elementRef.nativeElement.getAttribute("role");return e==="grid"||e==="treegrid"?"gridcell":"cell"}return this._cellRoleInternal}_cellRoleInternal=void 0;get trackBy(){return this._trackByFn}set trackBy(e){this._trackByFn=e}_trackByFn;get dataSource(){return this._dataSource}set dataSource(e){this._dataSource!==e&&this._switchDataSource(e)}_dataSource;get multiTemplateDataRows(){return this._multiTemplateDataRows}set multiTemplateDataRows(e){this._multiTemplateDataRows=e,this._rowOutlet&&this._rowOutlet.viewContainer.length&&(this._forceRenderDataRows(),this.updateStickyColumnStyles())}_multiTemplateDataRows=!1;get fixedLayout(){return this._fixedLayout}set fixedLayout(e){this._fixedLayout=e,this._forceRecalculateCellWidths=!0,this._stickyColumnStylesNeedReset=!0}_fixedLayout=!1;contentChanged=new Mi;viewChange=new to({start:0,end:Number.MAX_VALUE});_rowOutlet;_headerRowOutlet;_footerRowOutlet;_noDataRowOutlet;_contentColumnDefs;_contentRowDefs;_contentHeaderRowDefs;_contentFooterRowDefs;_noDataRow;_injector=J(wn);constructor(){J(new Ru("role"),{optional:!0})||this._elementRef.nativeElement.setAttribute("role","table"),this._isServer=!this._platform.isBrowser,this._isNativeHtmlTable=this._elementRef.nativeElement.nodeName==="TABLE",this._dataDiffer=this._differs.find([]).create((n,o)=>this.trackBy?this.trackBy(o.dataIndex,o.data):o)}ngOnInit(){this._setupStickyStyler(),this._viewportRuler.change().pipe(_r(this._onDestroy)).subscribe(()=>{this._forceRecalculateCellWidths=!0})}ngAfterContentInit(){this._hasInitialized=!0}ngAfterContentChecked(){this._canRender()&&this._render()}ngOnDestroy(){this._stickyStyler?.destroy(),[this._rowOutlet?.viewContainer,this._headerRowOutlet?.viewContainer,this._footerRowOutlet?.viewContainer,this._cachedRenderRowsMap,this._customColumnDefs,this._customRowDefs,this._customHeaderRowDefs,this._customFooterRowDefs,this._columnDefsByName].forEach(e=>{e?.clear()}),this._headerRowDefs=[],this._footerRowDefs=[],this._defaultRowDef=null,this._onDestroy.next(),this._onDestroy.complete(),PD(this.dataSource)&&this.dataSource.disconnect(this)}renderRows(){this._renderRows=this._getAllRenderRows();let e=this._dataDiffer.diff(this._renderRows);if(!e){this._updateNoDataRow(),this.contentChanged.next();return}let n=this._rowOutlet.viewContainer;this._viewRepeater.applyChanges(e,n,(o,r,g)=>this._getEmbeddedViewArgs(o.item,g),o=>o.item.data,o=>{o.operation===xm.INSERTED&&o.context&&this._renderCellTemplateForItem(o.record.item.rowDef,o.context)}),this._updateRowIndexContext(),e.forEachIdentityChange(o=>{let r=n.get(o.currentIndex);r.context.$implicit=o.item.data}),this._updateNoDataRow(),this.contentChanged.next(),this.updateStickyColumnStyles()}addColumnDef(e){this._customColumnDefs.add(e)}removeColumnDef(e){this._customColumnDefs.delete(e)}addRowDef(e){this._customRowDefs.add(e)}removeRowDef(e){this._customRowDefs.delete(e)}addHeaderRowDef(e){this._customHeaderRowDefs.add(e),this._headerRowDefChanged=!0}removeHeaderRowDef(e){this._customHeaderRowDefs.delete(e),this._headerRowDefChanged=!0}addFooterRowDef(e){this._customFooterRowDefs.add(e),this._footerRowDefChanged=!0}removeFooterRowDef(e){this._customFooterRowDefs.delete(e),this._footerRowDefChanged=!0}setNoDataRow(e){this._customNoDataRow=e}updateStickyHeaderRowStyles(){let e=this._getRenderedRows(this._headerRowOutlet);if(this._isNativeHtmlTable){let o=LZ(this._headerRowOutlet,"thead");o&&(o.style.display=e.length?"":"none")}let n=this._headerRowDefs.map(o=>o.sticky);this._stickyStyler.clearStickyPositioning(e,["top"]),this._stickyStyler.stickRows(e,n,"top"),this._headerRowDefs.forEach(o=>o.resetStickyChanged())}updateStickyFooterRowStyles(){let e=this._getRenderedRows(this._footerRowOutlet);if(this._isNativeHtmlTable){let o=LZ(this._footerRowOutlet,"tfoot");o&&(o.style.display=e.length?"":"none")}let n=this._footerRowDefs.map(o=>o.sticky);this._stickyStyler.clearStickyPositioning(e,["bottom"]),this._stickyStyler.stickRows(e,n,"bottom"),this._stickyStyler.updateStickyFooterContainer(this._elementRef.nativeElement,n),this._footerRowDefs.forEach(o=>o.resetStickyChanged())}updateStickyColumnStyles(){let e=this._getRenderedRows(this._headerRowOutlet),n=this._getRenderedRows(this._rowOutlet),o=this._getRenderedRows(this._footerRowOutlet);(this._isNativeHtmlTable&&!this._fixedLayout||this._stickyColumnStylesNeedReset)&&(this._stickyStyler.clearStickyPositioning([...e,...n,...o],["left","right"]),this._stickyColumnStylesNeedReset=!1),e.forEach((r,g)=>{this._addStickyColumnStyles([r],this._headerRowDefs[g])}),this._rowDefs.forEach(r=>{let g=[];for(let w=0;w<n.length;w++)this._renderRows[w].rowDef===r&&g.push(n[w]);this._addStickyColumnStyles(g,r)}),o.forEach((r,g)=>{this._addStickyColumnStyles([r],this._footerRowDefs[g])}),Array.from(this._columnDefsByName.values()).forEach(r=>r.resetStickyChanged())}_outletAssigned(){!this._hasAllOutlets&&this._rowOutlet&&this._headerRowOutlet&&this._footerRowOutlet&&this._noDataRowOutlet&&(this._hasAllOutlets=!0,this._canRender()&&this._render())}_canRender(){return this._hasAllOutlets&&this._hasInitialized}_render(){this._cacheRowDefs(),this._cacheColumnDefs(),!this._headerRowDefs.length&&!this._footerRowDefs.length&&this._rowDefs.length;let n=this._renderUpdatedColumns()||this._headerRowDefChanged||this._footerRowDefChanged;this._stickyColumnStylesNeedReset=this._stickyColumnStylesNeedReset||n,this._forceRecalculateCellWidths=n,this._headerRowDefChanged&&(this._forceRenderHeaderRows(),this._headerRowDefChanged=!1),this._footerRowDefChanged&&(this._forceRenderFooterRows(),this._footerRowDefChanged=!1),this.dataSource&&this._rowDefs.length>0&&!this._renderChangeSubscription?this._observeRenderChanges():this._stickyColumnStylesNeedReset&&this.updateStickyColumnStyles(),this._checkStickyStates()}_getAllRenderRows(){let e=[],n=this._cachedRenderRowsMap;if(this._cachedRenderRowsMap=new Map,!this._data)return e;for(let o=0;o<this._data.length;o++){let r=this._data[o],g=this._getRenderRowsForData(r,o,n.get(r));this._cachedRenderRowsMap.has(r)||this._cachedRenderRowsMap.set(r,new WeakMap);for(let w=0;w<g.length;w++){let T=g[w],k=this._cachedRenderRowsMap.get(T.data);k.has(T.rowDef)?k.get(T.rowDef).push(T):k.set(T.rowDef,[T]),e.push(T)}}return e}_getRenderRowsForData(e,n,o){return this._getRowDefs(e,n).map(g=>{let w=o&&o.has(g)?o.get(g):[];if(w.length){let T=w.shift();return T.dataIndex=n,T}else return{data:e,rowDef:g,dataIndex:n}})}_cacheColumnDefs(){this._columnDefsByName.clear(),MM(this._getOwnDefs(this._contentColumnDefs),this._customColumnDefs).forEach(n=>{this._columnDefsByName.has(n.name),this._columnDefsByName.set(n.name,n)})}_cacheRowDefs(){this._headerRowDefs=MM(this._getOwnDefs(this._contentHeaderRowDefs),this._customHeaderRowDefs),this._footerRowDefs=MM(this._getOwnDefs(this._contentFooterRowDefs),this._customFooterRowDefs),this._rowDefs=MM(this._getOwnDefs(this._contentRowDefs),this._customRowDefs);let e=this._rowDefs.filter(n=>!n.when);!this.multiTemplateDataRows&&e.length>1,this._defaultRowDef=e[0]}_renderUpdatedColumns(){let e=(g,w)=>{let T=!!w.getColumnsDiff();return g||T},n=this._rowDefs.reduce(e,!1);n&&this._forceRenderDataRows();let o=this._headerRowDefs.reduce(e,!1);o&&this._forceRenderHeaderRows();let r=this._footerRowDefs.reduce(e,!1);return r&&this._forceRenderFooterRows(),n||o||r}_switchDataSource(e){this._data=[],PD(this.dataSource)&&this.dataSource.disconnect(this),this._renderChangeSubscription&&(this._renderChangeSubscription.unsubscribe(),this._renderChangeSubscription=null),e||(this._dataDiffer&&this._dataDiffer.diff([]),this._rowOutlet&&this._rowOutlet.viewContainer.clear()),this._dataSource=e}_observeRenderChanges(){if(!this.dataSource)return;let e;PD(this.dataSource)?e=this.dataSource.connect(this):ry(this.dataSource)?e=this.dataSource:Array.isArray(this.dataSource)&&(e=Ni(this.dataSource)),this._renderChangeSubscription=e.pipe(_r(this._onDestroy)).subscribe(n=>{this._data=n||[],this.renderRows()})}_forceRenderHeaderRows(){this._headerRowOutlet.viewContainer.length>0&&this._headerRowOutlet.viewContainer.clear(),this._headerRowDefs.forEach((e,n)=>this._renderRow(this._headerRowOutlet,e,n)),this.updateStickyHeaderRowStyles()}_forceRenderFooterRows(){this._footerRowOutlet.viewContainer.length>0&&this._footerRowOutlet.viewContainer.clear(),this._footerRowDefs.forEach((e,n)=>this._renderRow(this._footerRowOutlet,e,n)),this.updateStickyFooterRowStyles()}_addStickyColumnStyles(e,n){let o=Array.from(n?.columns||[]).map(w=>{let T=this._columnDefsByName.get(w);return T}),r=o.map(w=>w.sticky),g=o.map(w=>w.stickyEnd);this._stickyStyler.updateStickyColumns(e,r,g,!this._fixedLayout||this._forceRecalculateCellWidths)}_getRenderedRows(e){let n=[];for(let o=0;o<e.viewContainer.length;o++){let r=e.viewContainer.get(o);n.push(r.rootNodes[0])}return n}_getRowDefs(e,n){if(this._rowDefs.length==1)return[this._rowDefs[0]];let o=[];if(this.multiTemplateDataRows)o=this._rowDefs.filter(r=>!r.when||r.when(n,e));else{let r=this._rowDefs.find(g=>g.when&&g.when(n,e))||this._defaultRowDef;r&&o.push(r)}return o.length,o}_getEmbeddedViewArgs(e,n){let o=e.rowDef,r={$implicit:e.data};return{templateRef:o.template,context:r,index:n}}_renderRow(e,n,o,r={}){let g=e.viewContainer.createEmbeddedView(n.template,r,o);return this._renderCellTemplateForItem(n,r),g}_renderCellTemplateForItem(e,n){for(let o of this._getCellTemplates(e))z0.mostRecentCellOutlet&&z0.mostRecentCellOutlet._viewContainer.createEmbeddedView(o,n);this._changeDetectorRef.markForCheck()}_updateRowIndexContext(){let e=this._rowOutlet.viewContainer;for(let n=0,o=e.length;n<o;n++){let g=e.get(n).context;g.count=o,g.first=n===0,g.last=n===o-1,g.even=n%2===0,g.odd=!g.even,this.multiTemplateDataRows?(g.dataIndex=this._renderRows[n].dataIndex,g.renderIndex=n):g.index=this._renderRows[n].dataIndex}}_getCellTemplates(e){return!e||!e.columns?[]:Array.from(e.columns,n=>{let o=this._columnDefsByName.get(n);return e.extractCellTemplate(o)})}_forceRenderDataRows(){this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear(),this.renderRows()}_checkStickyStates(){let e=(n,o)=>n||o.hasStickyChanged();this._headerRowDefs.reduce(e,!1)&&this.updateStickyHeaderRowStyles(),this._footerRowDefs.reduce(e,!1)&&this.updateStickyFooterRowStyles(),Array.from(this._columnDefsByName.values()).reduce(e,!1)&&(this._stickyColumnStylesNeedReset=!0,this.updateStickyColumnStyles())}_setupStickyStyler(){let e=this._dir?this._dir.value:"ltr";this._stickyStyler=new u4(this._isNativeHtmlTable,this.stickyCssClass,e,this._coalescedStyleScheduler,this._platform.isBrowser,this.needsPositionStickyOnElement,this._stickyPositioningListener,this._injector),(this._dir?this._dir.change:Ni()).pipe(_r(this._onDestroy)).subscribe(n=>{this._stickyStyler.direction=n,this.updateStickyColumnStyles()})}_getOwnDefs(e){return e.filter(n=>!n._table||n._table===this)}_updateNoDataRow(){let e=this._customNoDataRow||this._noDataRow;if(!e)return;let n=this._rowOutlet.viewContainer.length===0;if(n===this._isShowingNoDataRow)return;let o=this._noDataRowOutlet.viewContainer;if(n){let r=o.createEmbeddedView(e.templateRef),g=r.rootNodes[0];r.rootNodes.length===1&&g?.nodeType===this._document.ELEMENT_NODE&&(g.setAttribute("role","row"),g.classList.add(e._contentClassName))}else o.clear();this._isShowingNoDataRow=n,this._changeDetectorRef.markForCheck()}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["cdk-table"],["table","cdk-table",""]],contentQueries:function(n,o,r){if(n&1&&(ao(r,jZ,5),ao(r,bv,5),ao(r,NM,5),ao(r,$w,5),ao(r,p4,5)),n&2){let g;sn(g=ln())&&(o._noDataRow=g.first),sn(g=ln())&&(o._contentColumnDefs=g),sn(g=ln())&&(o._contentRowDefs=g),sn(g=ln())&&(o._contentHeaderRowDefs=g),sn(g=ln())&&(o._contentFooterRowDefs=g)}},hostAttrs:[1,"cdk-table"],hostVars:2,hostBindings:function(n,o){n&2&&Ji("cdk-table-fixed-layout",o.fixedLayout)},inputs:{trackBy:"trackBy",dataSource:"dataSource",multiTemplateDataRows:[2,"multiTemplateDataRows","multiTemplateDataRows",Bi],fixedLayout:[2,"fixedLayout","fixedLayout",Bi]},outputs:{contentChanged:"contentChanged"},exportAs:["cdkTable"],features:[fr([{provide:Wd,useExisting:t},{provide:av,useClass:F0},{provide:RM,useClass:d4},{provide:kM,useValue:null}])],ngContentSelectors:Y0e,decls:5,vars:2,consts:[["role","rowgroup"],["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(n,o){n&1&&(Qr(Z0e),On(0),On(1,1),Tt(2,K0e,1,0)(3,X0e,7,0)(4,Q0e,4,0)),n&2&&(Se(2),zn(o._isServer?2:-1),Se(),zn(o._isNativeHtmlTable?3:4))},dependencies:[_4,g4,v4,y4],styles:[`.cdk-table-fixed-layout{table-layout:fixed}
`],encapsulation:2})}return t})();function MM(t,i){return t.concat(Array.from(i))}function LZ(t,i){let e=i.toUpperCase(),n=t.viewContainer.element.nativeElement;for(;n;){let o=n.nodeType===1?n.nodeName:null;if(o===e)return n;if(o==="TABLE")break;n=n.parentNode}return null}var UZ=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({imports:[yw]})}return t})();var Gw=class{_multiple;_emitChanges;compareWith;_selection=new Set;_deselectedToEmit=[];_selectedToEmit=[];_selected;get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}changed=new gi;constructor(i=!1,e,n=!0,o){this._multiple=i,this._emitChanges=n,this.compareWith=o,e&&e.length&&(i?e.forEach(r=>this._markSelected(r)):this._markSelected(e[0]),this._selectedToEmit.length=0)}select(...i){this._verifyValueAssignment(i),i.forEach(n=>this._markSelected(n));let e=this._hasQueuedChanges();return this._emitChangeEvent(),e}deselect(...i){this._verifyValueAssignment(i),i.forEach(n=>this._unmarkSelected(n));let e=this._hasQueuedChanges();return this._emitChangeEvent(),e}setSelection(...i){this._verifyValueAssignment(i);let e=this.selected,n=new Set(i.map(r=>this._getConcreteValue(r)));i.forEach(r=>this._markSelected(r)),e.filter(r=>!n.has(this._getConcreteValue(r,n))).forEach(r=>this._unmarkSelected(r));let o=this._hasQueuedChanges();return this._emitChangeEvent(),o}toggle(i){return this.isSelected(i)?this.deselect(i):this.select(i)}clear(i=!0){this._unmarkAll();let e=this._hasQueuedChanges();return i&&this._emitChangeEvent(),e}isSelected(i){return this._selection.has(this._getConcreteValue(i))}isEmpty(){return this._selection.size===0}hasValue(){return!this.isEmpty()}sort(i){this._multiple&&this.selected&&this._selected.sort(i)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(i){i=this._getConcreteValue(i),this.isSelected(i)||(this._multiple||this._unmarkAll(),this.isSelected(i)||this._selection.add(i),this._emitChanges&&this._selectedToEmit.push(i))}_unmarkSelected(i){i=this._getConcreteValue(i),this.isSelected(i)&&(this._selection.delete(i),this._emitChanges&&this._deselectedToEmit.push(i))}_unmarkAll(){this.isEmpty()||this._selection.forEach(i=>this._unmarkSelected(i))}_verifyValueAssignment(i){i.length>1&&this._multiple}_hasQueuedChanges(){return!!(this._deselectedToEmit.length||this._selectedToEmit.length)}_getConcreteValue(i,e){if(this.compareWith){e=e??this._selection;for(let n of e)if(this.compareWith(i,n))return n;return i}else return i}};var e_e=[[["caption"]],[["colgroup"],["col"]],"*"],t_e=["caption","colgroup, col","*"];function i_e(t,i){t&1&&On(0,2)}function n_e(t,i){t&1&&(ae(0,"thead",0),ys(1,1),se(),ae(2,"tbody",2),ys(3,3)(4,4),se(),ae(5,"tfoot",0),ys(6,5),se())}function r_e(t,i){t&1&&ys(0,1)(1,3)(2,4)(3,5)}var Dm=(()=>{class t extends b4{stickyCssClass="mat-mdc-table-sticky";needsPositionStickyOnElement=!1;static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275cmp=ai({type:t,selectors:[["mat-table"],["table","mat-table",""]],hostAttrs:[1,"mat-mdc-table","mdc-data-table__table"],hostVars:2,hostBindings:function(n,o){n&2&&Ji("mdc-table-fixed-layout",o.fixedLayout)},exportAs:["matTable"],features:[fr([{provide:b4,useExisting:t},{provide:Wd,useExisting:t},{provide:RM,useClass:d4},{provide:av,useClass:F0},{provide:kM,useValue:null}]),Fn],ngContentSelectors:t_e,decls:5,vars:2,consts:[["role","rowgroup"],["headerRowOutlet",""],["role","rowgroup",1,"mdc-data-table__content"],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(n,o){n&1&&(Qr(e_e),On(0),On(1,1),Tt(2,i_e,1,0)(3,n_e,7,0)(4,r_e,4,0)),n&2&&(Se(2),zn(o._isServer?2:-1),Se(),zn(o._isNativeHtmlTable?3:4))},dependencies:[_4,g4,v4,y4],styles:[`.mat-mdc-table-sticky{position:sticky !important}mat-table{display:block}mat-header-row{min-height:56px}mat-row,mat-footer-row{min-height:48px}mat-row,mat-header-row,mat-footer-row{display:flex;border-width:0;border-bottom-width:1px;border-style:solid;align-items:center;box-sizing:border-box}mat-cell:first-of-type,mat-header-cell:first-of-type,mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] mat-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:first-of-type:not(:only-of-type){padding-left:0;padding-right:24px}mat-cell:last-of-type,mat-header-cell:last-of-type,mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] mat-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:last-of-type:not(:only-of-type){padding-right:0;padding-left:24px}mat-cell,mat-header-cell,mat-footer-cell{flex:1;display:flex;align-items:center;overflow:hidden;word-wrap:break-word;min-height:inherit}.mat-mdc-table{min-width:100%;border:0;border-spacing:0;table-layout:auto;white-space:normal;background-color:var(--mat-table-background-color, var(--mat-sys-surface))}.mdc-data-table__cell{box-sizing:border-box;overflow:hidden;text-align:left;text-overflow:ellipsis}[dir=rtl] .mdc-data-table__cell{text-align:right}.mdc-data-table__cell,.mdc-data-table__header-cell{padding:0 16px}.mat-mdc-header-row{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-header-container-height, 56px);color:var(--mat-table-header-headline-color, var(--mat-sys-on-surface, rgba(0, 0, 0, 0.87)));font-family:var(--mat-table-header-headline-font, var(--mat-sys-title-small-font, Roboto, sans-serif));line-height:var(--mat-table-header-headline-line-height, var(--mat-sys-title-small-line-height));font-size:var(--mat-table-header-headline-size, var(--mat-sys-title-small-size, 14px));font-weight:var(--mat-table-header-headline-weight, var(--mat-sys-title-small-weight, 500))}.mat-mdc-row{height:var(--mat-table-row-item-container-height, 52px);color:var(--mat-table-row-item-label-text-color, var(--mat-sys-on-surface, rgba(0, 0, 0, 0.87)))}.mat-mdc-row,.mdc-data-table__content{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-table-row-item-label-text-font, var(--mat-sys-body-medium-font, Roboto, sans-serif));line-height:var(--mat-table-row-item-label-text-line-height, var(--mat-sys-body-medium-line-height));font-size:var(--mat-table-row-item-label-text-size, var(--mat-sys-body-medium-size, 14px));font-weight:var(--mat-table-row-item-label-text-weight, var(--mat-sys-body-medium-weight))}.mat-mdc-footer-row{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-footer-container-height, 52px);color:var(--mat-table-row-item-label-text-color, var(--mat-sys-on-surface, rgba(0, 0, 0, 0.87)));font-family:var(--mat-table-footer-supporting-text-font, var(--mat-sys-body-medium-font, Roboto, sans-serif));line-height:var(--mat-table-footer-supporting-text-line-height, var(--mat-sys-body-medium-line-height));font-size:var(--mat-table-footer-supporting-text-size, var(--mat-sys-body-medium-size, 14px));font-weight:var(--mat-table-footer-supporting-text-weight, var(--mat-sys-body-medium-weight));letter-spacing:var(--mat-table-footer-supporting-text-tracking, var(--mat-sys-body-medium-tracking))}.mat-mdc-header-cell{border-bottom-color:var(--mat-table-row-item-outline-color, var(--mat-sys-outline, rgba(0, 0, 0, 0.12)));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-header-headline-tracking, var(--mat-sys-title-small-tracking));font-weight:inherit;line-height:inherit;box-sizing:border-box;text-overflow:ellipsis;overflow:hidden;outline:none;text-align:left}[dir=rtl] .mat-mdc-header-cell{text-align:right}.mdc-data-table__row:last-child>.mat-mdc-header-cell{border-bottom:none}.mat-mdc-cell{border-bottom-color:var(--mat-table-row-item-outline-color, var(--mat-sys-outline, rgba(0, 0, 0, 0.12)));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-row-item-label-text-tracking, var(--mat-sys-body-medium-tracking));line-height:inherit}.mdc-data-table__row:last-child>.mat-mdc-cell{border-bottom:none}.mat-mdc-footer-cell{letter-spacing:var(--mat-table-row-item-label-text-tracking, var(--mat-sys-body-medium-tracking))}mat-row.mat-mdc-row,mat-header-row.mat-mdc-header-row,mat-footer-row.mat-mdc-footer-row{border-bottom:none}.mat-mdc-table tbody,.mat-mdc-table tfoot,.mat-mdc-table thead,.mat-mdc-cell,.mat-mdc-footer-cell,.mat-mdc-header-row,.mat-mdc-row,.mat-mdc-footer-row,.mat-mdc-table .mat-mdc-header-cell{background:inherit}.mat-mdc-table mat-header-row.mat-mdc-header-row,.mat-mdc-table mat-row.mat-mdc-row,.mat-mdc-table mat-footer-row.mat-mdc-footer-cell{height:unset}mat-header-cell.mat-mdc-header-cell,mat-cell.mat-mdc-cell,mat-footer-cell.mat-mdc-footer-cell{align-self:stretch}
`],encapsulation:2})}return t})(),Mm=(()=>{class t extends OM{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275dir=vi({type:t,selectors:[["","matCellDef",""]],features:[fr([{provide:OM,useExisting:t}]),Fn]})}return t})(),Im=(()=>{class t extends PM{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275dir=vi({type:t,selectors:[["","matHeaderCellDef",""]],features:[fr([{provide:PM,useExisting:t}]),Fn]})}return t})();var Am=(()=>{class t extends bv{get name(){return this._name}set name(e){this._setNameInput(e)}_updateColumnCssClassName(){super._updateColumnCssClassName(),this._columnCssClassName.push(`mat-column-${this.cssClassFriendlyName}`)}static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275dir=vi({type:t,selectors:[["","matColumnDef",""]],inputs:{name:[0,"matColumnDef","name"]},features:[fr([{provide:bv,useExisting:t},{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:t}]),Fn]})}return t})(),Rm=(()=>{class t extends BZ{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275dir=vi({type:t,selectors:[["mat-header-cell"],["th","mat-header-cell",""]],hostAttrs:["role","columnheader",1,"mat-mdc-header-cell","mdc-data-table__header-cell"],features:[Fn]})}return t})();var km=(()=>{class t extends VZ{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275dir=vi({type:t,selectors:[["mat-cell"],["td","mat-cell",""]],hostAttrs:[1,"mat-mdc-cell","mdc-data-table__cell"],features:[Fn]})}return t})();var Om=(()=>{class t extends $w{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275dir=vi({type:t,selectors:[["","matHeaderRowDef",""]],inputs:{columns:[0,"matHeaderRowDef","columns"],sticky:[2,"matHeaderRowDefSticky","sticky",Bi]},features:[fr([{provide:$w,useExisting:t}]),Fn]})}return t})();var Pm=(()=>{class t extends NM{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275dir=vi({type:t,selectors:[["","matRowDef",""]],inputs:{columns:[0,"matRowDefColumns","columns"],when:[0,"matRowDefWhen","when"]},features:[fr([{provide:NM,useExisting:t}]),Fn]})}return t})(),Nm=(()=>{class t extends f4{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275cmp=ai({type:t,selectors:[["mat-header-row"],["tr","mat-header-row",""]],hostAttrs:["role","row",1,"mat-mdc-header-row","mdc-data-table__header-row"],exportAs:["matHeaderRow"],features:[fr([{provide:f4,useExisting:t}]),Fn],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(n,o){n&1&&ys(0,0)},dependencies:[z0],encapsulation:2})}return t})();var Lm=(()=>{class t extends m4{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275cmp=ai({type:t,selectors:[["mat-row"],["tr","mat-row",""]],hostAttrs:["role","row",1,"mat-mdc-row","mdc-data-table__row"],exportAs:["matRow"],features:[fr([{provide:m4,useExisting:t}]),Fn],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(n,o){n&1&&ys(0,0)},dependencies:[z0],encapsulation:2})}return t})();var Fm=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({imports:[Wn,UZ,Wn]})}return t})();var x4=class{_box;_destroyed=new gi;_resizeSubject=new gi;_resizeObserver;_elementObservables=new Map;constructor(i){this._box=i,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(e=>this._resizeSubject.next(e)))}observe(i){return this._elementObservables.has(i)||this._elementObservables.set(i,new wr(e=>{let n=this._resizeSubject.subscribe(e);return this._resizeObserver?.observe(i,{box:this._box}),()=>{this._resizeObserver?.unobserve(i),n.unsubscribe(),this._elementObservables.delete(i)}}).pipe(zr(e=>e.some(n=>n.target===i)),v2({bufferSize:1,refCount:!0}),_r(this._destroyed))),this._elementObservables.get(i)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}},HZ=(()=>{class t{_cleanupErrorListener;_observers=new Map;_ngZone=J(Oi);constructor(){typeof ResizeObserver<"u"}ngOnDestroy(){for(let[,e]of this._observers)e.destroy();this._observers.clear(),this._cleanupErrorListener?.()}observe(e,n){let o=n?.box||"content-box";return this._observers.has(o)||this._observers.set(o,new x4(o)),this._observers.get(o).observe(e)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var o_e=["notch"],a_e=["matFormFieldNotchedOutline",""],s_e=["*"],l_e=["textField"],c_e=["iconPrefixContainer"],u_e=["textPrefixContainer"],d_e=["iconSuffixContainer"],h_e=["textSuffixContainer"],p_e=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],f_e=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];function m_e(t,i){t&1&&jt(0,"span",20)}function g_e(t,i){if(t&1&&(ae(0,"label",19),On(1,1),Tt(2,m_e,1,0,"span",20),se()),t&2){let e=zt(2);Xe("floating",e._shouldLabelFloat())("monitorResize",e._hasOutline())("id",e._labelId),un("for",e._control.disableAutomaticLabeling?null:e._control.id),Se(2),zn(!e.hideRequiredMarker&&e._control.required?2:-1)}}function __e(t,i){if(t&1&&Tt(0,g_e,3,5,"label",19),t&2){let e=zt();zn(e._hasFloatingLabel()?0:-1)}}function y_e(t,i){t&1&&jt(0,"div",7)}function v_e(t,i){}function b_e(t,i){if(t&1&&Tt(0,v_e,0,0,"ng-template",13),t&2){zt(2);let e=Ca(1);Xe("ngTemplateOutlet",e)}}function x_e(t,i){if(t&1&&(ae(0,"div",9),Tt(1,b_e,1,1,null,13),se()),t&2){let e=zt();Xe("matFormFieldNotchedOutlineOpen",e._shouldLabelFloat()),Se(),zn(e._forceDisplayInfixLabel()?-1:1)}}function w_e(t,i){t&1&&(ae(0,"div",10,2),On(2,2),se())}function E_e(t,i){t&1&&(ae(0,"div",11,3),On(2,3),se())}function C_e(t,i){}function S_e(t,i){if(t&1&&Tt(0,C_e,0,0,"ng-template",13),t&2){zt();let e=Ca(1);Xe("ngTemplateOutlet",e)}}function T_e(t,i){t&1&&(ae(0,"div",14,4),On(2,4),se())}function D_e(t,i){t&1&&(ae(0,"div",15,5),On(2,5),se())}function M_e(t,i){t&1&&jt(0,"div",16)}function I_e(t,i){t&1&&On(0,6)}function A_e(t,i){if(t&1&&(ae(0,"mat-hint",21),Oe(1),se()),t&2){let e=zt(2);Xe("id",e._hintLabelId),Se(),En(e.hintLabel)}}function R_e(t,i){if(t&1&&(Tt(0,A_e,2,2,"mat-hint",21),On(1,7),jt(2,"div",22),On(3,8)),t&2){let e=zt();zn(e.hintLabel?0:-1)}}var Zd=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["mat-label"]]})}return t})(),E4=new Ot("MatError"),C4=(()=>{class t{id=J(po).getId("mat-mdc-error-");constructor(){}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["mat-error"],["","matError",""]],hostAttrs:[1,"mat-mdc-form-field-error","mat-mdc-form-field-bottom-align"],hostVars:1,hostBindings:function(n,o){n&2&&vs("id",o.id)},inputs:{id:"id"},features:[fr([{provide:E4,useExisting:t}])]})}return t})(),w4=(()=>{class t{align="start";id=J(po).getId("mat-mdc-hint-");static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(n,o){n&2&&(vs("id",o.id),un("align",null),Ji("mat-mdc-form-field-hint-end",o.align==="end"))},inputs:{align:"align",id:"id"}})}return t})(),KZ=new Ot("MatPrefix");var S4=new Ot("MatSuffix"),T4=(()=>{class t{set _isTextSelector(e){this._isText=!0}_isText=!1;static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","matSuffix",""],["","matIconSuffix",""],["","matTextSuffix",""]],inputs:{_isTextSelector:[0,"matTextSuffix","_isTextSelector"]},features:[fr([{provide:S4,useExisting:t}])]})}return t})(),XZ=new Ot("FloatingLabelParent"),qZ=(()=>{class t{_elementRef=J(Qi);get floating(){return this._floating}set floating(e){this._floating=e,this.monitorResize&&this._handleResize()}_floating=!1;get monitorResize(){return this._monitorResize}set monitorResize(e){this._monitorResize=e,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}_monitorResize=!1;_resizeObserver=J(HZ);_ngZone=J(Oi);_parent=J(XZ);_resizeSubscription=new nr;constructor(){}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return k_e(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(n,o){n&2&&Ji("mdc-floating-label--float-above",o.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"}})}return t})();function k_e(t){let i=t;if(i.offsetParent!==null)return i.scrollWidth;let e=i.cloneNode(!0);e.style.setProperty("position","absolute"),e.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(e);let n=e.scrollWidth;return e.remove(),n}var $Z="mdc-line-ripple--active",FM="mdc-line-ripple--deactivating",GZ=(()=>{class t{_elementRef=J(Qi);_cleanupTransitionEnd;constructor(){let e=J(Oi),n=J(Ko);e.runOutsideAngular(()=>{this._cleanupTransitionEnd=n.listen(this._elementRef.nativeElement,"transitionend",this._handleTransitionEnd)})}activate(){let e=this._elementRef.nativeElement.classList;e.remove(FM),e.add($Z)}deactivate(){this._elementRef.nativeElement.classList.add(FM)}_handleTransitionEnd=e=>{let n=this._elementRef.nativeElement.classList,o=n.contains(FM);e.propertyName==="opacity"&&o&&n.remove($Z,FM)};ngOnDestroy(){this._cleanupTransitionEnd()}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"]})}return t})(),WZ=(()=>{class t{_elementRef=J(Qi);_ngZone=J(Oi);open=!1;_notch;constructor(){}ngAfterViewInit(){let e=this._elementRef.nativeElement.querySelector(".mdc-floating-label");e?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),typeof requestAnimationFrame=="function"&&(e.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>e.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(e){!this.open||!e?this._notch.nativeElement.style.width="":this._notch.nativeElement.style.width=`calc(${e}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(n,o){if(n&1&&pr(o_e,5),n&2){let r;sn(r=ln())&&(o._notch=r.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(n,o){n&2&&Ji("mdc-notched-outline--notched",o.open)},inputs:{open:[0,"matFormFieldNotchedOutlineOpen","open"]},attrs:a_e,ngContentSelectors:s_e,decls:5,vars:0,consts:[["notch",""],[1,"mat-mdc-notch-piece","mdc-notched-outline__leading"],[1,"mat-mdc-notch-piece","mdc-notched-outline__notch"],[1,"mat-mdc-notch-piece","mdc-notched-outline__trailing"]],template:function(n,o){n&1&&(Qr(),jt(0,"div",1),ae(1,"div",2,0),On(3),se(),jt(4,"div",3))},encapsulation:2,changeDetection:0})}return t})(),B0=(()=>{class t{value;stateChanges;id;placeholder;ngControl;focused;empty;shouldLabelFloat;required;disabled;errorState;controlType;autofilled;userAriaDescribedBy;disableAutomaticLabeling;static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t})}return t})();var zm=new Ot("MatFormField"),QZ=new Ot("MAT_FORM_FIELD_DEFAULT_OPTIONS"),ZZ="fill",O_e="auto",YZ="fixed",P_e="translateY(-50%)",du=(()=>{class t{_elementRef=J(Qi);_changeDetectorRef=J(vr);_dir=J(aa);_platform=J(Pr);_idGenerator=J(po);_ngZone=J(Oi);_injector=J(wn);_defaults=J(QZ,{optional:!0});_textField;_iconPrefixContainer;_textPrefixContainer;_iconSuffixContainer;_textSuffixContainer;_floatingLabel;_notchedOutline;_lineRipple;_formFieldControl;_prefixChildren;_suffixChildren;_errorChildren;_hintChildren;_labelChild=I7(Zd);get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(e){this._hideRequiredMarker=su(e)}_hideRequiredMarker=!1;color="primary";get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||O_e}set floatLabel(e){e!==this._floatLabel&&(this._floatLabel=e,this._changeDetectorRef.markForCheck())}_floatLabel;get appearance(){return this._appearance}set appearance(e){let n=this._appearance,o=e||this._defaults?.appearance||ZZ;this._appearance=o,this._appearance==="outline"&&this._appearance!==n&&(this._needsOutlineLabelOffsetUpdate=!0)}_appearance=ZZ;get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||YZ}set subscriptSizing(e){this._subscriptSizing=e||this._defaults?.subscriptSizing||YZ}_subscriptSizing=null;get hintLabel(){return this._hintLabel}set hintLabel(e){this._hintLabel=e,this._processHints()}_hintLabel="";_hasIconPrefix=!1;_hasTextPrefix=!1;_hasIconSuffix=!1;_hasTextSuffix=!1;_labelId=this._idGenerator.getId("mat-mdc-form-field-label-");_hintLabelId=this._idGenerator.getId("mat-mdc-hint-");get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(e){this._explicitFormFieldControl=e}_destroyed=new gi;_isFocused=null;_explicitFormFieldControl;_needsOutlineLabelOffsetUpdate=!1;_previousControl=null;_previousControlValidatorFn=null;_stateChanges;_valueChanges;_describedByChanges;_animationsDisabled;constructor(){let e=this._defaults;e&&(e.appearance&&(this.appearance=e.appearance),this._hideRequiredMarker=!!e?.hideRequiredMarker,e.color&&(this.color=e.color)),this._animationsDisabled=J(oo,{optional:!0})==="NoopAnimations"}ngAfterViewInit(){this._updateFocusState(),this._animationsDisabled||this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{this._elementRef.nativeElement.classList.add("mat-form-field-animations-enabled")},300)}),this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl(),this._control!==this._previousControl&&(this._initializeControl(this._previousControl),this._control.ngControl&&this._control.ngControl.control&&(this._previousControlValidatorFn=this._control.ngControl.control.validator),this._previousControl=this._control),this._control.ngControl&&this._control.ngControl.control&&this._control.ngControl.control.validator!==this._previousControlValidatorFn&&this._changeDetectorRef.markForCheck()}ngOnDestroy(){this._stateChanges?.unsubscribe(),this._valueChanges?.unsubscribe(),this._describedByChanges?.unsubscribe(),this._destroyed.next(),this._destroyed.complete()}getLabelId=wc(()=>this._hasFloatingLabel()?this._labelId:null);getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(e){let n=this._control,o="mat-mdc-form-field-type-";e&&this._elementRef.nativeElement.classList.remove(o+e.controlType),n.controlType&&this._elementRef.nativeElement.classList.add(o+n.controlType),this._stateChanges?.unsubscribe(),this._stateChanges=n.stateChanges.subscribe(()=>{this._updateFocusState(),this._changeDetectorRef.markForCheck()}),this._describedByChanges?.unsubscribe(),this._describedByChanges=n.stateChanges.pipe(ia([void 0,void 0]),hn(()=>[n.errorState,n.userAriaDescribedBy]),y2(),zr(([[r,g],[w,T]])=>r!==w||g!==T)).subscribe(()=>this._syncDescribedByIds()),this._valueChanges?.unsubscribe(),n.ngControl&&n.ngControl.valueChanges&&(this._valueChanges=n.ngControl.valueChanges.pipe(_r(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()))}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(e=>!e._isText),this._hasTextPrefix=!!this._prefixChildren.find(e=>e._isText),this._hasIconSuffix=!!this._suffixChildren.find(e=>!e._isText),this._hasTextSuffix=!!this._suffixChildren.find(e=>e._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),ks(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){this._control}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||this._isFocused===null)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdate=!0),i0(()=>{this._needsOutlineLabelOffsetUpdate&&(this._needsOutlineLabelOffsetUpdate=!1,this._updateOutlineLabelOffset())},{injector:this._injector}),this._dir.change.pipe(_r(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdate=!0)}_shouldAlwaysFloat(){return this.floatLabel==="always"}_hasOutline(){return this.appearance==="outline"}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel=wc(()=>!!this._labelChild());_shouldLabelFloat(){return this._hasFloatingLabel()?this._control.shouldLabelFloat||this._shouldAlwaysFloat():!1}_shouldForward(e){let n=this._control?this._control.ngControl:null;return n&&n[e]}_getSubscriptMessageType(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||!this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(0):this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){this._hintChildren}_syncDescribedByIds(){if(this._control){let e=[];if(this._control.userAriaDescribedBy&&typeof this._control.userAriaDescribedBy=="string"&&e.push(...this._control.userAriaDescribedBy.split(" ")),this._getSubscriptMessageType()==="hint"){let n=this._hintChildren?this._hintChildren.find(r=>r.align==="start"):null,o=this._hintChildren?this._hintChildren.find(r=>r.align==="end"):null;n?e.push(n.id):this._hintLabel&&e.push(this._hintLabelId),o&&e.push(o.id)}else this._errorChildren&&e.push(...this._errorChildren.map(n=>n.id));this._control.setDescribedByIds(e)}}_updateOutlineLabelOffset(){if(!this._hasOutline()||!this._floatingLabel)return;let e=this._floatingLabel.element;if(!(this._iconPrefixContainer||this._textPrefixContainer)){e.style.transform="";return}if(!this._isAttachedToDom()){this._needsOutlineLabelOffsetUpdate=!0;return}let n=this._iconPrefixContainer?.nativeElement,o=this._textPrefixContainer?.nativeElement,r=this._iconSuffixContainer?.nativeElement,g=this._textSuffixContainer?.nativeElement,w=n?.getBoundingClientRect().width??0,T=o?.getBoundingClientRect().width??0,k=r?.getBoundingClientRect().width??0,N=g?.getBoundingClientRect().width??0,V=this._dir.value==="rtl"?"-1":"1",q=`${w+T}px`,X=`calc(${V} * (${q} + var(--mat-mdc-form-field-label-offset-x, 0px)))`;e.style.transform=`var(
        --mat-mdc-form-field-label-transform,
        ${P_e} translateX(${X})
    )`;let te=w+T+k+N;this._elementRef.nativeElement.style.setProperty("--mat-form-field-notch-max-width",`calc(100% - ${te}px)`)}_isAttachedToDom(){let e=this._elementRef.nativeElement;if(e.getRootNode){let n=e.getRootNode();return n&&n!==e}return document.documentElement.contains(e)}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-form-field"]],contentQueries:function(n,o,r){if(n&1&&(oj(r,o._labelChild,Zd,5),ao(r,B0,5),ao(r,KZ,5),ao(r,S4,5),ao(r,E4,5),ao(r,w4,5)),n&2){aj();let g;sn(g=ln())&&(o._formFieldControl=g.first),sn(g=ln())&&(o._prefixChildren=g),sn(g=ln())&&(o._suffixChildren=g),sn(g=ln())&&(o._errorChildren=g),sn(g=ln())&&(o._hintChildren=g)}},viewQuery:function(n,o){if(n&1&&(pr(l_e,5),pr(c_e,5),pr(u_e,5),pr(d_e,5),pr(h_e,5),pr(qZ,5),pr(WZ,5),pr(GZ,5)),n&2){let r;sn(r=ln())&&(o._textField=r.first),sn(r=ln())&&(o._iconPrefixContainer=r.first),sn(r=ln())&&(o._textPrefixContainer=r.first),sn(r=ln())&&(o._iconSuffixContainer=r.first),sn(r=ln())&&(o._textSuffixContainer=r.first),sn(r=ln())&&(o._floatingLabel=r.first),sn(r=ln())&&(o._notchedOutline=r.first),sn(r=ln())&&(o._lineRipple=r.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:40,hostBindings:function(n,o){n&2&&Ji("mat-mdc-form-field-label-always-float",o._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",o._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",o._hasIconSuffix)("mat-form-field-invalid",o._control.errorState)("mat-form-field-disabled",o._control.disabled)("mat-form-field-autofilled",o._control.autofilled)("mat-form-field-appearance-fill",o.appearance=="fill")("mat-form-field-appearance-outline",o.appearance=="outline")("mat-form-field-hide-placeholder",o._hasFloatingLabel()&&!o._shouldLabelFloat())("mat-focused",o._control.focused)("mat-primary",o.color!=="accent"&&o.color!=="warn")("mat-accent",o.color==="accent")("mat-warn",o.color==="warn")("ng-untouched",o._shouldForward("untouched"))("ng-touched",o._shouldForward("touched"))("ng-pristine",o._shouldForward("pristine"))("ng-dirty",o._shouldForward("dirty"))("ng-valid",o._shouldForward("valid"))("ng-invalid",o._shouldForward("invalid"))("ng-pending",o._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[fr([{provide:zm,useExisting:t},{provide:XZ,useExisting:t}])],ngContentSelectors:f_e,decls:20,vars:25,consts:[["labelTemplate",""],["textField",""],["iconPrefixContainer",""],["textPrefixContainer",""],["textSuffixContainer",""],["iconSuffixContainer",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],[1,"mat-mdc-form-field-focus-overlay"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[1,"mat-mdc-form-field-icon-prefix"],[1,"mat-mdc-form-field-text-prefix"],[1,"mat-mdc-form-field-infix"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align"],["aria-atomic","true","aria-live","polite"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[3,"id"],[1,"mat-mdc-form-field-hint-spacer"]],template:function(n,o){if(n&1){let r=zi();Qr(p_e),Tt(0,__e,1,1,"ng-template",null,0,rm),ae(2,"div",6,1),Nt("click",function(w){return ri(r),oi(o._control.onContainerClick(w))}),Tt(4,y_e,1,0,"div",7),ae(5,"div",8),Tt(6,x_e,2,2,"div",9)(7,w_e,3,0,"div",10)(8,E_e,3,0,"div",11),ae(9,"div",12),Tt(10,S_e,1,1,null,13),On(11),se(),Tt(12,T_e,3,0,"div",14)(13,D_e,3,0,"div",15),se(),Tt(14,M_e,1,0,"div",16),se(),ae(15,"div",17),xO(16),ae(17,"div",18),Tt(18,I_e,1,0)(19,R_e,4,1),se()()}if(n&2){let r;Se(2),Ji("mdc-text-field--filled",!o._hasOutline())("mdc-text-field--outlined",o._hasOutline())("mdc-text-field--no-label",!o._hasFloatingLabel())("mdc-text-field--disabled",o._control.disabled)("mdc-text-field--invalid",o._control.errorState),Se(2),zn(!o._hasOutline()&&!o._control.disabled?4:-1),Se(2),zn(o._hasOutline()?6:-1),Se(),zn(o._hasIconPrefix?7:-1),Se(),zn(o._hasTextPrefix?8:-1),Se(2),zn(!o._hasOutline()||o._forceDisplayInfixLabel()?10:-1),Se(2),zn(o._hasTextSuffix?12:-1),Se(),zn(o._hasIconSuffix?13:-1),Se(),zn(o._hasOutline()?-1:14),Se(),Ji("mat-mdc-form-field-subscript-dynamic-size",o.subscriptSizing==="dynamic");let g=o._getSubscriptMessageType();Se(2),Ji("mat-mdc-form-field-error-wrapper",g==="error")("mat-mdc-form-field-hint-wrapper",g==="hint"),Se(),zn((r=g)==="error"?18:r==="hint"?19:-1)}},dependencies:[qZ,WZ,wx,GZ,w4],styles:[`.mdc-text-field{display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color;border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field__input{width:100%;min-width:0;border:none;border-radius:0;background:none;padding:0;-moz-appearance:none;-webkit-appearance:none;height:28px}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}.mdc-text-field__input::placeholder{opacity:0}.mdc-text-field__input::-moz-placeholder{opacity:0}.mdc-text-field__input::-webkit-input-placeholder{opacity:0}.mdc-text-field__input:-ms-input-placeholder{opacity:0}.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input::-moz-placeholder,.mdc-text-field--focused .mdc-text-field__input::-moz-placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input::-webkit-input-placeholder,.mdc-text-field--focused .mdc-text-field__input::-webkit-input-placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive::placeholder{opacity:0}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive::-moz-placeholder{opacity:0}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive::-webkit-input-placeholder{opacity:0}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive:-ms-input-placeholder{opacity:0}.mdc-text-field--outlined .mdc-text-field__input,.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-filled-text-field-input-text-color, var(--mat-sys-on-surface));caret-color:var(--mdc-filled-text-field-caret-color, var(--mat-sys-primary))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::-moz-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::-webkit-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-error-caret-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-filled-text-field-disabled-input-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-outlined-text-field-input-text-color, var(--mat-sys-on-surface));caret-color:var(--mdc-outlined-text-field-caret-color, var(--mat-sys-primary))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::-moz-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::-webkit-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-error-caret-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}@media(forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}}.mdc-text-field--filled{height:56px;border-bottom-right-radius:0;border-bottom-left-radius:0;border-top-left-radius:var(--mdc-filled-text-field-container-shape, var(--mat-sys-corner-extra-small));border-top-right-radius:var(--mdc-filled-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mdc-filled-text-field-container-color, var(--mat-sys-surface-variant))}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mdc-filled-text-field-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 4%, transparent))}.mdc-text-field--outlined{height:56px;overflow:visible;padding-right:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)));padding-left:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)) + 4px)}[dir=rtl] .mdc-text-field--outlined{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)) + 4px);padding-left:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)))}.mdc-floating-label{position:absolute;left:0;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label{right:0;left:auto;transform-origin:right top;text-align:right}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:auto}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label{left:auto;right:4px}.mdc-text-field--filled .mdc-floating-label{left:16px;right:auto}[dir=rtl] .mdc-text-field--filled .mdc-floating-label{left:auto;right:16px}.mdc-text-field--disabled .mdc-floating-label{cursor:default}@media(forced-colors: active){.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label{color:var(--mdc-filled-text-field-label-text-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label{color:var(--mdc-filled-text-field-focus-label-text-color, var(--mat-sys-primary))}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label{color:var(--mdc-filled-text-field-hover-label-text-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label{color:var(--mdc-filled-text-field-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-floating-label{color:var(--mdc-filled-text-field-error-label-text-color, var(--mat-sys-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mdc-floating-label{color:var(--mdc-filled-text-field-error-focus-label-text-color, var(--mat-sys-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--disabled):hover .mdc-floating-label{color:var(--mdc-filled-text-field-error-hover-label-text-color, var(--mat-sys-on-error-container))}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mdc-filled-text-field-label-text-font, var(--mat-sys-body-large-font));font-size:var(--mdc-filled-text-field-label-text-size, var(--mat-sys-body-large-size));font-weight:var(--mdc-filled-text-field-label-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mdc-filled-text-field-label-text-tracking, var(--mat-sys-body-large-tracking))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label{color:var(--mdc-outlined-text-field-label-text-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label{color:var(--mdc-outlined-text-field-focus-label-text-color, var(--mat-sys-primary))}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label{color:var(--mdc-outlined-text-field-hover-label-text-color, var(--mat-sys-on-surface))}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label{color:var(--mdc-outlined-text-field-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-floating-label{color:var(--mdc-outlined-text-field-error-label-text-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mdc-floating-label{color:var(--mdc-outlined-text-field-error-focus-label-text-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--disabled):hover .mdc-floating-label{color:var(--mdc-outlined-text-field-error-hover-label-text-color, var(--mat-sys-on-error-container))}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mdc-outlined-text-field-label-text-font, var(--mat-sys-body-large-font));font-size:var(--mdc-outlined-text-field-label-text-size, var(--mat-sys-body-large-size));font-weight:var(--mdc-outlined-text-field-label-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mdc-outlined-text-field-label-text-tracking, var(--mat-sys-body-large-tracking))}.mdc-floating-label--float-above{cursor:auto;transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1);font-size:.75rem}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline{text-align:right}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mat-mdc-notch-piece{box-sizing:border-box;height:100%;pointer-events:none;border-top:1px solid;border-bottom:1px solid}.mdc-text-field--focused .mat-mdc-notch-piece{border-width:2px}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-outline-color, var(--mat-sys-outline));border-width:var(--mdc-outlined-text-field-outline-width, 1px)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-hover-outline-color, var(--mat-sys-on-surface))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-focus-outline-color, var(--mat-sys-primary))}.mdc-text-field--outlined.mdc-text-field--disabled .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-disabled-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-error-outline-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--focused):hover .mdc-notched-outline .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-error-hover-outline-color, var(--mat-sys-on-error-container))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-error-focus-outline-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mat-mdc-notch-piece{border-width:var(--mdc-outlined-text-field-focus-outline-width, 2px)}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;border-top-right-radius:0;border-bottom-right-radius:0;border-top-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)))}[dir=rtl] .mdc-notched-outline__leading{border-left:none;border-right:1px solid;border-bottom-left-radius:0;border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-notched-outline__trailing{flex-grow:1;border-left:none;border-right:1px solid;border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}[dir=rtl] .mdc-notched-outline__trailing{border-left:1px solid;border-right:none;border-top-right-radius:0;border-bottom-right-radius:0;border-top-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:min(var(--mat-form-field-notch-max-width, 100%),100% - max(12px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)))*2)}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none;--mat-form-field-notch-max-width: 100%}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1;border-bottom-width:var(--mdc-filled-text-field-active-indicator-height, 1px)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-active-indicator-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-hover-active-indicator-color, var(--mat-sys-on-surface))}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-disabled-active-indicator-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-active-indicator-color, var(--mat-sys-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-hover-active-indicator-color, var(--mat-sys-on-error-container))}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mdc-filled-text-field-focus-active-indicator-height, 2px)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-focus-active-indicator-color, var(--mat-sys-primary))}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-error-focus-active-indicator-color, var(--mat-sys-error))}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-text-field--disabled{pointer-events:none}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all;will-change:auto}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto;will-change:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:1px solid rgba(0,0,0,0)}[dir=rtl] .mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:none;border-right:1px solid rgba(0,0,0,0)}.mat-mdc-form-field-infix{min-height:var(--mat-form-field-container-height, 56px);padding-top:var(--mat-form-field-filled-with-label-container-padding-top, 24px);padding-bottom:var(--mat-form-field-filled-with-label-container-padding-bottom, 8px)}.mdc-text-field--outlined .mat-mdc-form-field-infix,.mdc-text-field--no-label .mat-mdc-form-field-infix{padding-top:var(--mat-form-field-container-vertical-padding, 16px);padding-bottom:var(--mat-form-field-container-vertical-padding, 16px)}.mat-mdc-text-field-wrapper .mat-mdc-form-field-flex .mat-mdc-floating-label{top:calc(var(--mat-form-field-container-height, 56px)/2)}.mdc-text-field--filled .mat-mdc-floating-label{display:var(--mat-form-field-filled-label-display, block)}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{--mat-mdc-form-field-label-transform: translateY(calc(calc(6.75px + var(--mat-form-field-container-height, 56px) / 2) * -1)) scale(var(--mat-mdc-form-field-floating-label-scale, 0.75));transform:var(--mat-mdc-form-field-label-transform)}@keyframes _mat-form-field-subscript-animation{from{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px;opacity:1;transform:translateY(0);animation:_mat-form-field-subscript-animation 0ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block;color:var(--mat-form-field-error-text-color, var(--mat-sys-error))}.mat-mdc-form-field-subscript-wrapper,.mat-mdc-form-field-bottom-align::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-subscript-text-font, var(--mat-sys-body-small-font));line-height:var(--mat-form-field-subscript-text-line-height, var(--mat-sys-body-small-line-height));font-size:var(--mat-form-field-subscript-text-size, var(--mat-sys-body-small-size));letter-spacing:var(--mat-form-field-subscript-text-tracking, var(--mat-sys-body-small-tracking));font-weight:var(--mat-form-field-subscript-text-weight, var(--mat-sys-body-small-weight))}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none;background-color:var(--mat-form-field-state-layer-color, var(--mat-sys-on-surface))}.mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-form-field.mat-focused .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-focus-state-layer-opacity, 0)}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option{color:var(--mat-form-field-select-option-text-color, var(--mat-sys-neutral10))}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option:disabled{color:var(--mat-form-field-select-disabled-option-text-color, color-mix(in srgb, var(--mat-sys-neutral10) 38%, transparent))}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none;color:var(--mat-form-field-enabled-select-arrow-color, var(--mat-sys-on-surface-variant))}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select.mat-focused .mat-mdc-form-field-infix::after{color:var(--mat-form-field-focus-select-arrow-color, var(--mat-sys-primary))}.mat-mdc-form-field-type-mat-native-select.mat-form-field-disabled .mat-mdc-form-field-infix::after{color:var(--mat-form-field-disabled-select-arrow-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}@media(forced-colors: active){.mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}}@media(forced-colors: active){.mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}}@media(forced-colors: active){.mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}}@media(forced-colors: active){.mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font, var(--mat-sys-body-large-font));line-height:var(--mat-form-field-container-text-line-height, var(--mat-sys-body-large-line-height));font-size:var(--mat-form-field-container-text-size, var(--mat-sys-body-large-size));letter-spacing:var(--mat-form-field-container-text-tracking, var(--mat-sys-body-large-tracking));font-weight:var(--mat-form-field-container-text-weight, var(--mat-sys-body-large-weight))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size)*var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%;z-index:0}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:0 12px;box-sizing:content-box}.mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-leading-icon-color, var(--mat-sys-on-surface-variant))}.mat-form-field-disabled .mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-disabled-leading-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-trailing-icon-color, var(--mat-sys-on-surface-variant))}.mat-form-field-disabled .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-disabled-trailing-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-invalid .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-trailing-icon-color, var(--mat-sys-error))}.mat-form-field-invalid:not(.mat-focused):not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-hover-trailing-icon-color, var(--mat-sys-on-error-container))}.mat-form-field-invalid.mat-focused .mat-mdc-text-field-wrapper .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-focus-trailing-icon-color, var(--mat-sys-error))}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field-infix:has(textarea[cols]){width:auto}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-text-field__input{transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-text-field__input::placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-text-field__input::-moz-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-text-field__input::-webkit-input-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--focused .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--no-label .mdc-text-field__input::-moz-placeholder,.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--focused .mdc-text-field__input::-moz-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--no-label .mdc-text-field__input::-webkit-input-placeholder,.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--focused .mdc-text-field__input::-webkit-input-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field.mat-form-field-animations-enabled .mat-mdc-form-field-error-wrapper{animation-duration:300ms}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}
`],encapsulation:2,changeDetection:0})}return t})();var JZ=(()=>{class t{_animationMode=J(oo,{optional:!0});state="unchecked";disabled=!1;appearance="full";constructor(){}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:12,hostBindings:function(n,o){n&2&&Ji("mat-pseudo-checkbox-indeterminate",o.state==="indeterminate")("mat-pseudo-checkbox-checked",o.state==="checked")("mat-pseudo-checkbox-disabled",o.disabled)("mat-pseudo-checkbox-minimal",o.appearance==="minimal")("mat-pseudo-checkbox-full",o.appearance==="full")("_mat-animation-noopable",o._animationMode==="NoopAnimations")},inputs:{state:"state",disabled:"disabled",appearance:"appearance"},decls:0,vars:0,template:function(n,o){},styles:[`.mat-pseudo-checkbox{border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{left:1px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{left:1px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-minimal-pseudo-checkbox-selected-checkmark-color, var(--mat-sys-primary))}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-pseudo-checkbox-full{border-color:var(--mat-full-pseudo-checkbox-unselected-icon-color, var(--mat-sys-on-surface-variant));border-width:2px;border-style:solid}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-disabled{border-color:var(--mat-full-pseudo-checkbox-disabled-unselected-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate{background-color:var(--mat-full-pseudo-checkbox-selected-icon-color, var(--mat-sys-primary));border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-full-pseudo-checkbox-selected-checkmark-color, var(--mat-sys-on-primary))}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled{background-color:var(--mat-full-pseudo-checkbox-disabled-selected-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-full-pseudo-checkbox-disabled-selected-checkmark-color, var(--mat-sys-surface))}.mat-pseudo-checkbox{width:18px;height:18px}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after{width:14px;height:6px;transform-origin:center;top:-4.2426406871px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{top:8px;width:16px}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after{width:10px;height:4px;transform-origin:center;top:-2.8284271247px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{top:6px;width:12px}
`],encapsulation:2,changeDetection:0})}return t})();var N_e=["text"],L_e=[[["mat-icon"]],"*"],F_e=["mat-icon","*"];function z_e(t,i){if(t&1&&jt(0,"mat-pseudo-checkbox",1),t&2){let e=zt();Xe("disabled",e.disabled)("state",e.selected?"checked":"unchecked")}}function B_e(t,i){if(t&1&&jt(0,"mat-pseudo-checkbox",3),t&2){let e=zt();Xe("disabled",e.disabled)}}function V_e(t,i){if(t&1&&(ae(0,"span",4),Oe(1),se()),t&2){let e=zt();Se(),an("(",e.group.label,")")}}var M4=new Ot("MAT_OPTION_PARENT_COMPONENT"),I4=new Ot("MatOptgroup");var D4=class{source;isUserInput;constructor(i,e=!1){this.source=i,this.isUserInput=e}},Yd=(()=>{class t{_element=J(Qi);_changeDetectorRef=J(vr);_parent=J(M4,{optional:!0});group=J(I4,{optional:!0});_signalDisableRipple=!1;_selected=!1;_active=!1;_disabled=!1;_mostRecentViewValue="";get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}value;id=J(po).getId("mat-option-");get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(e){this._disabled=e}get disableRipple(){return this._signalDisableRipple?this._parent.disableRipple():!!this._parent?.disableRipple}get hideSingleSelectionIndicator(){return!!(this._parent&&this._parent.hideSingleSelectionIndicator)}onSelectionChange=new Mi;_text;_stateChanges=new gi;constructor(){let e=J(Vo);e.load(qd),e.load(Hu),this._signalDisableRipple=!!this._parent&&Jf(this._parent.disableRipple)}get active(){return this._active}get viewValue(){return(this._text?.nativeElement.textContent||"").trim()}select(e=!0){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),e&&this._emitSelectionChangeEvent())}deselect(e=!0){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),e&&this._emitSelectionChangeEvent())}focus(e,n){let o=this._getHostElement();typeof o.focus=="function"&&o.focus(n)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(e){(e.keyCode===13||e.keyCode===32)&&!ga(e)&&(this._selectViaInteraction(),e.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=this.multiple?!this._selected:!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){let e=this.viewValue;e!==this._mostRecentViewValue&&(this._mostRecentViewValue&&this._stateChanges.next(),this._mostRecentViewValue=e)}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(e=!1){this.onSelectionChange.emit(new D4(this,e))}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-option"]],viewQuery:function(n,o){if(n&1&&pr(N_e,7),n&2){let r;sn(r=ln())&&(o._text=r.first)}},hostAttrs:["role","option",1,"mat-mdc-option","mdc-list-item"],hostVars:11,hostBindings:function(n,o){n&1&&Nt("click",function(){return o._selectViaInteraction()})("keydown",function(g){return o._handleKeydown(g)}),n&2&&(vs("id",o.id),un("aria-selected",o.selected)("aria-disabled",o.disabled.toString()),Ji("mdc-list-item--selected",o.selected)("mat-mdc-option-multiple",o.multiple)("mat-mdc-option-active",o.active)("mdc-list-item--disabled",o.disabled))},inputs:{value:"value",id:"id",disabled:[2,"disabled","disabled",Bi]},outputs:{onSelectionChange:"onSelectionChange"},exportAs:["matOption"],ngContentSelectors:F_e,decls:8,vars:5,consts:[["text",""],["aria-hidden","true",1,"mat-mdc-option-pseudo-checkbox",3,"disabled","state"],[1,"mdc-list-item__primary-text"],["state","checked","aria-hidden","true","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"cdk-visually-hidden"],["aria-hidden","true","mat-ripple","",1,"mat-mdc-option-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled"]],template:function(n,o){n&1&&(Qr(L_e),Tt(0,z_e,1,2,"mat-pseudo-checkbox",1),On(1),ae(2,"span",2,0),On(4,1),se(),Tt(5,B_e,1,1,"mat-pseudo-checkbox",3)(6,V_e,2,1,"span",4),jt(7,"div",5)),n&2&&(zn(o.multiple?0:-1),Se(5),zn(!o.multiple&&o.selected&&!o.hideSingleSelectionIndicator?5:-1),Se(),zn(o.group&&o.group._inert?6:-1),Se(),Xe("matRippleTrigger",o._getHostElement())("matRippleDisabled",o.disabled||o.disableRipple))},dependencies:[JZ,YD],styles:[`.mat-mdc-option{-webkit-user-select:none;user-select:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;min-height:48px;padding:0 16px;cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);color:var(--mat-option-label-text-color, var(--mat-sys-on-surface));font-family:var(--mat-option-label-text-font, var(--mat-sys-label-large-font));line-height:var(--mat-option-label-text-line-height, var(--mat-sys-label-large-line-height));font-size:var(--mat-option-label-text-size, var(--mat-sys-body-large-size));letter-spacing:var(--mat-option-label-text-tracking, var(--mat-sys-label-large-tracking));font-weight:var(--mat-option-label-text-weight, var(--mat-sys-body-large-weight))}.mat-mdc-option:hover:not(.mdc-list-item--disabled){background-color:var(--mat-option-hover-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-hover-state-layer-opacity) * 100%), transparent))}.mat-mdc-option:focus.mdc-list-item,.mat-mdc-option.mat-mdc-option-active.mdc-list-item{background-color:var(--mat-option-focus-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-focus-state-layer-opacity) * 100%), transparent));outline:0}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled):not(.mat-mdc-option-multiple){background-color:var(--mat-option-selected-state-layer-color, var(--mat-sys-secondary-container))}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled):not(.mat-mdc-option-multiple) .mdc-list-item__primary-text{color:var(--mat-option-selected-state-label-text-color, var(--mat-sys-on-secondary-container))}.mat-mdc-option .mat-pseudo-checkbox{--mat-minimal-pseudo-checkbox-selected-checkmark-color: var(--mat-option-selected-state-label-text-color, var(--mat-sys-on-secondary-container))}.mat-mdc-option.mdc-list-item{align-items:center;background:rgba(0,0,0,0)}.mat-mdc-option.mdc-list-item--disabled{cursor:default;pointer-events:none}.mat-mdc-option.mdc-list-item--disabled .mat-mdc-option-pseudo-checkbox,.mat-mdc-option.mdc-list-item--disabled .mdc-list-item__primary-text,.mat-mdc-option.mdc-list-item--disabled>mat-icon{opacity:.38}.mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:32px}[dir=rtl] .mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:16px;padding-right:32px}.mat-mdc-option .mat-icon,.mat-mdc-option .mat-pseudo-checkbox-full{margin-right:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-icon,[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-full{margin-right:0;margin-left:16px}.mat-mdc-option .mat-pseudo-checkbox-minimal{margin-left:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-minimal{margin-right:16px;margin-left:0}.mat-mdc-option .mat-mdc-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-option .mdc-list-item__primary-text{white-space:normal;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;font-family:inherit;text-decoration:inherit;text-transform:inherit;margin-right:auto}[dir=rtl] .mat-mdc-option .mdc-list-item__primary-text{margin-right:0;margin-left:auto}@media(forced-colors: active){.mat-mdc-option.mdc-list-item--selected:not(:has(.mat-mdc-option-pseudo-checkbox))::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .mat-mdc-option.mdc-list-item--selected:not(:has(.mat-mdc-option-pseudo-checkbox))::after{right:auto;left:16px}}.mat-mdc-option-multiple{--mdc-list-list-item-selected-container-color:var(--mdc-list-list-item-container-color, transparent)}.mat-mdc-option-active .mat-focus-indicator::before{content:""}
`],encapsulation:2,changeDetection:0})}return t})();function eY(t,i,e){if(e.length){let n=i.toArray(),o=e.toArray(),r=0;for(let g=0;g<t+1;g++)n[g].group&&n[g].group===o[r]&&r++;return r}return 0}function tY(t,i,e,n){return t<e?t:t+i>e+n?Math.max(0,t-n+i):e}var xv=(()=>{class t{isErrorState(e,n){return!!(e&&e.invalid&&(e.touched||n&&n.submitted))}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var wv=class{_defaultMatcher;ngControl;_parentFormGroup;_parentForm;_stateChanges;errorState=!1;matcher;constructor(i,e,n,o,r){this._defaultMatcher=i,this.ngControl=e,this._parentFormGroup=n,this._parentForm=o,this._stateChanges=r}updateErrorState(){let i=this.errorState,e=this._parentFormGroup||this._parentForm,n=this.matcher||this._defaultMatcher,o=this.ngControl?this.ngControl.control:null,r=n?.isErrorState(o,e)??!1;r!==i&&(this.errorState=r,this._stateChanges.next())}};var El=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({imports:[Wn,ID,Wn]})}return t})();var iY=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({imports:[Wn]})}return t})();var A4=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({imports:[hv,Wn,iY]})}return t})();var j_e=["trigger"],U_e=["panel"],H_e=[[["mat-select-trigger"]],"*"],q_e=["mat-select-trigger","*"];function $_e(t,i){if(t&1&&(ae(0,"span",4),Oe(1),se()),t&2){let e=zt();Se(),En(e.placeholder)}}function G_e(t,i){t&1&&On(0)}function W_e(t,i){if(t&1&&(ae(0,"span",11),Oe(1),se()),t&2){let e=zt(2);Se(),En(e.triggerValue)}}function Z_e(t,i){if(t&1&&(ae(0,"span",5),Tt(1,G_e,1,0)(2,W_e,2,1,"span",11),se()),t&2){let e=zt();Se(),zn(e.customTrigger?1:2)}}function Y_e(t,i){if(t&1){let e=zi();ae(0,"div",12,1),Nt("keydown",function(o){ri(e);let r=zt();return oi(r._handleKeydown(o))}),On(2,1),se()}if(t&2){let e=zt();J7("mat-mdc-select-panel mdc-menu-surface mdc-menu-surface--open ",e._getPanelTheme(),""),Ji("mat-select-panel-animations-enabled",!e._animationsDisabled),Xe("ngClass",e.panelClass),un("id",e.id+"-panel")("aria-multiselectable",e.multiple)("aria-label",e.ariaLabel||null)("aria-labelledby",e._getPanelAriaLabelledby())}}var R4=new Ot("mat-select-scroll-strategy",{providedIn:"root",factory:()=>{let t=J(sa);return()=>t.scrollStrategies.reposition()}});function nY(t){return()=>t.scrollStrategies.reposition()}var rY=new Ot("MAT_SELECT_CONFIG"),oY={provide:R4,deps:[sa],useFactory:nY},aY=new Ot("MatSelectTrigger"),zM=class{source;value;constructor(i,e){this.source=i,this.value=e}},Zp=(()=>{class t{_viewportRuler=J(wm);_changeDetectorRef=J(vr);_elementRef=J(Qi);_dir=J(aa,{optional:!0});_idGenerator=J(po);_renderer=J(Ko);_parentFormField=J(zm,{optional:!0});ngControl=J(cu,{self:!0,optional:!0});_liveAnnouncer=J(_w);_defaultOptions=J(rY,{optional:!0});_animationsDisabled=J(oo,{optional:!0})==="NoopAnimations";_initialized=new gi;_cleanupDetach;options;optionGroups;customTrigger;_positions=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"}];_scrollOptionIntoView(e){let n=this.options.toArray()[e];if(n){let o=this.panel.nativeElement,r=eY(e,this.options,this.optionGroups),g=n._getHostElement();e===0&&r===1?o.scrollTop=0:o.scrollTop=tY(g.offsetTop,g.offsetHeight,o.scrollTop,o.offsetHeight)}}_positioningSettled(){this._scrollOptionIntoView(this._keyManager.activeItemIndex||0)}_getChangeEvent(e){return new zM(this,e)}_scrollStrategyFactory=J(R4);_panelOpen=!1;_compareWith=(e,n)=>e===n;_uid=this._idGenerator.getId("mat-select-");_triggerAriaLabelledBy=null;_previousControl;_destroy=new gi;_errorStateTracker;stateChanges=new gi;disableAutomaticLabeling=!0;userAriaDescribedBy;_selectionModel;_keyManager;_preferredOverlayOrigin;_overlayWidth;_onChange=()=>{};_onTouched=()=>{};_valueId=this._idGenerator.getId("mat-select-value-");_scrollStrategy;_overlayPanelClass=this._defaultOptions?.overlayPanelClass||"";get focused(){return this._focused||this._panelOpen}_focused=!1;controlType="mat-select";trigger;panel;_overlayDir;panelClass;disabled=!1;disableRipple=!1;tabIndex=0;get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(e){this._hideSingleSelectionIndicator=e,this._syncParentProperties()}_hideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1;get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.stateChanges.next()}_placeholder;get required(){return this._required??this.ngControl?.control?.hasValidator(Ti.required)??!1}set required(e){this._required=e,this.stateChanges.next()}_required;get multiple(){return this._multiple}set multiple(e){this._selectionModel,this._multiple=e}_multiple=!1;disableOptionCentering=this._defaultOptions?.disableOptionCentering??!1;get compareWith(){return this._compareWith}set compareWith(e){this._compareWith=e,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(e){this._assignValue(e)&&this._onChange(e)}_value;ariaLabel="";ariaLabelledby;get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(e){this._errorStateTracker.matcher=e}typeaheadDebounceInterval;sortComparator;get id(){return this._id}set id(e){this._id=e||this._uid,this.stateChanges.next()}_id;get errorState(){return this._errorStateTracker.errorState}set errorState(e){this._errorStateTracker.errorState=e}panelWidth=this._defaultOptions&&typeof this._defaultOptions.panelWidth<"u"?this._defaultOptions.panelWidth:"auto";canSelectNullableOptions=this._defaultOptions?.canSelectNullableOptions??!1;optionSelectionChanges=Ch(()=>{let e=this.options;return e?e.changes.pipe(ia(e),Za(()=>ks(...e.map(n=>n.onSelectionChange)))):this._initialized.pipe(Za(()=>this.optionSelectionChanges))});openedChange=new Mi;_openedStream=this.openedChange.pipe(zr(e=>e),hn(()=>{}));_closedStream=this.openedChange.pipe(zr(e=>!e),hn(()=>{}));selectionChange=new Mi;valueChange=new Mi;constructor(){let e=J(xv),n=J(P0,{optional:!0}),o=J(ko,{optional:!0}),r=J(new Ru("tabindex"),{optional:!0});this.ngControl&&(this.ngControl.valueAccessor=this),this._defaultOptions?.typeaheadDebounceInterval!=null&&(this.typeaheadDebounceInterval=this._defaultOptions.typeaheadDebounceInterval),this._errorStateTracker=new wv(e,this.ngControl,o,n,this.stateChanges),this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=r==null?0:parseInt(r)||0,this.id=this.id}ngOnInit(){this._selectionModel=new Gw(this.multiple),this.stateChanges.next(),this._viewportRuler.change().pipe(_r(this._destroy)).subscribe(()=>{this.panelOpen&&(this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._changeDetectorRef.detectChanges())})}ngAfterContentInit(){this._initialized.next(),this._initialized.complete(),this._initKeyManager(),this._selectionModel.changed.pipe(_r(this._destroy)).subscribe(e=>{e.added.forEach(n=>n.select()),e.removed.forEach(n=>n.deselect())}),this.options.changes.pipe(ia(null),_r(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){let e=this._getTriggerAriaLabelledby(),n=this.ngControl;if(e!==this._triggerAriaLabelledBy){let o=this._elementRef.nativeElement;this._triggerAriaLabelledBy=e,e?o.setAttribute("aria-labelledby",e):o.removeAttribute("aria-labelledby")}n&&(this._previousControl!==n.control&&(this._previousControl!==void 0&&n.disabled!==null&&n.disabled!==this.disabled&&(this.disabled=n.disabled),this._previousControl=n.control),this.updateErrorState())}ngOnChanges(e){(e.disabled||e.userAriaDescribedBy)&&this.stateChanges.next(),e.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this.typeaheadDebounceInterval)}ngOnDestroy(){this._cleanupDetach?.(),this._keyManager?.destroy(),this._destroy.next(),this._destroy.complete(),this.stateChanges.complete(),this._clearFromModal()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._parentFormField&&(this._preferredOverlayOrigin=this._parentFormField.getConnectedOverlayOrigin()),this._cleanupDetach?.(),this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._applyModalPanelOwnership(),this._panelOpen=!0,this._overlayDir.positionChange.pipe(ta(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()}),this._overlayDir.attachOverlay(),this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck(),this.stateChanges.next(),Promise.resolve().then(()=>this.openedChange.emit(!0)))}_trackedModal=null;_applyModalPanelOwnership(){let e=this._elementRef.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!e)return;let n=`${this.id}-panel`;this._trackedModal&&WD(this._trackedModal,"aria-owns",n),PL(e,"aria-owns",n),this._trackedModal=e}_clearFromModal(){if(!this._trackedModal)return;let e=`${this.id}-panel`;WD(this._trackedModal,"aria-owns",e),this._trackedModal=null}close(){this._panelOpen&&(this._panelOpen=!1,this._exitAndDetach(),this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched(),this.stateChanges.next(),Promise.resolve().then(()=>this.openedChange.emit(!1)))}_exitAndDetach(){if(this._animationsDisabled||!this.panel){this._detachOverlay();return}this._cleanupDetach?.(),this._cleanupDetach=()=>{n(),clearTimeout(o),this._cleanupDetach=void 0};let e=this.panel.nativeElement,n=this._renderer.listen(e,"animationend",r=>{r.animationName==="_mat-select-exit"&&(this._cleanupDetach?.(),this._detachOverlay())}),o=setTimeout(()=>{this._cleanupDetach?.(),this._detachOverlay()},200);e.classList.add("mat-select-panel-exit")}_detachOverlay(){this._overlayDir.detachOverlay(),this._changeDetectorRef.markForCheck()}writeValue(e){this._assignValue(e)}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel?.selected||[]:this._selectionModel?.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){let e=this._selectionModel.selected.map(n=>n.viewValue);return this._isRtl()&&e.reverse(),e.join(", ")}return this._selectionModel.selected[0].viewValue}updateErrorState(){this._errorStateTracker.updateErrorState()}_isRtl(){return this._dir?this._dir.value==="rtl":!1}_handleKeydown(e){this.disabled||(this.panelOpen?this._handleOpenKeydown(e):this._handleClosedKeydown(e))}_handleClosedKeydown(e){let n=e.keyCode,o=n===40||n===38||n===37||n===39,r=n===13||n===32,g=this._keyManager;if(!g.isTyping()&&r&&!ga(e)||(this.multiple||e.altKey)&&o)e.preventDefault(),this.open();else if(!this.multiple){let w=this.selected;g.onKeydown(e);let T=this.selected;T&&w!==T&&this._liveAnnouncer.announce(T.viewValue,1e4)}}_handleOpenKeydown(e){let n=this._keyManager,o=e.keyCode,r=o===40||o===38,g=n.isTyping();if(r&&e.altKey)e.preventDefault(),this.close();else if(!g&&(o===13||o===32)&&n.activeItem&&!ga(e))e.preventDefault(),n.activeItem._selectViaInteraction();else if(!g&&this._multiple&&o===65&&e.ctrlKey){e.preventDefault();let w=this.options.some(T=>!T.disabled&&!T.selected);this.options.forEach(T=>{T.disabled||(w?T.select():T.deselect())})}else{let w=n.activeItemIndex;n.onKeydown(e),this._multiple&&r&&e.shiftKey&&n.activeItem&&n.activeItemIndex!==w&&n.activeItem._selectViaInteraction()}}_handleOverlayKeydown(e){e.keyCode===27&&!ga(e)&&(e.preventDefault(),this.close())}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this._keyManager?.cancelTypeahead(),!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(e){if(this.options.forEach(n=>n.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&e)Array.isArray(e),e.forEach(n=>this._selectOptionByValue(n)),this._sortValues();else{let n=this._selectOptionByValue(e);n?this._keyManager.updateActiveItem(n):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(e){let n=this.options.find(o=>{if(this._selectionModel.isSelected(o))return!1;try{return(o.value!=null||this.canSelectNullableOptions)&&this._compareWith(o.value,e)}catch{return!1}});return n&&this._selectionModel.select(n),n}_assignValue(e){return e!==this._value||this._multiple&&Array.isArray(e)?(this.options&&this._setSelectionByValue(e),this._value=e,!0):!1}_skipPredicate=e=>this.panelOpen?!1:e.disabled;_getOverlayWidth(e){return this.panelWidth==="auto"?(e instanceof cv?e.elementRef:e||this._elementRef).nativeElement.getBoundingClientRect().width:this.panelWidth===null?"":this.panelWidth}_syncParentProperties(){if(this.options)for(let e of this.options)e._changeDetectorRef.markForCheck()}_initKeyManager(){this._keyManager=new Ew(this.options).withTypeAhead(this.typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withPageUpDown().withAllowedModifierKeys(["shiftKey"]).skipPredicate(this._skipPredicate),this._keyManager.tabOut.subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){let e=ks(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(_r(e)).subscribe(n=>{this._onSelect(n.source,n.isUserInput),n.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),ks(...this.options.map(n=>n._stateChanges)).pipe(_r(e)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this.stateChanges.next()})}_onSelect(e,n){let o=this._selectionModel.isSelected(e);!this.canSelectNullableOptions&&e.value==null&&!this._multiple?(e.deselect(),this._selectionModel.clear(),this.value!=null&&this._propagateChanges(e.value)):(o!==e.selected&&(e.selected?this._selectionModel.select(e):this._selectionModel.deselect(e)),n&&this._keyManager.setActiveItem(e),this.multiple&&(this._sortValues(),n&&this.focus())),o!==this._selectionModel.isSelected(e)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){let e=this.options.toArray();this._selectionModel.sort((n,o)=>this.sortComparator?this.sortComparator(n,o,e):e.indexOf(n)-e.indexOf(o)),this.stateChanges.next()}}_propagateChanges(e){let n;this.multiple?n=this.selected.map(o=>o.value):n=this.selected?this.selected.value:e,this._value=n,this.valueChange.emit(n),this._onChange(n),this.selectionChange.emit(this._getChangeEvent(n)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){if(this._keyManager)if(this.empty){let e=-1;for(let n=0;n<this.options.length;n++)if(!this.options.get(n).disabled){e=n;break}this._keyManager.setActiveItem(e)}else this._keyManager.setActiveItem(this._selectionModel.selected[0])}_canOpen(){return!this._panelOpen&&!this.disabled&&this.options?.length>0&&!!this._overlayDir}focus(e){this._elementRef.nativeElement.focus(e)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;let e=this._parentFormField?.getLabelId()||null,n=e?e+" ":"";return this.ariaLabelledby?n+this.ariaLabelledby:e}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;let e=this._parentFormField?.getLabelId()||"";return this.ariaLabelledby&&(e+=" "+this.ariaLabelledby),e||(e=this._valueId),e}setDescribedByIds(e){e.length?this._elementRef.nativeElement.setAttribute("aria-describedby",e.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this.panelOpen||!this.empty||this.focused&&!!this.placeholder}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-select"]],contentQueries:function(n,o,r){if(n&1&&(ao(r,aY,5),ao(r,Yd,5),ao(r,I4,5)),n&2){let g;sn(g=ln())&&(o.customTrigger=g.first),sn(g=ln())&&(o.options=g),sn(g=ln())&&(o.optionGroups=g)}},viewQuery:function(n,o){if(n&1&&(pr(j_e,5),pr(U_e,5),pr(jD,5)),n&2){let r;sn(r=ln())&&(o.trigger=r.first),sn(r=ln())&&(o.panel=r.first),sn(r=ln())&&(o._overlayDir=r.first)}},hostAttrs:["role","combobox","aria-haspopup","listbox",1,"mat-mdc-select"],hostVars:19,hostBindings:function(n,o){n&1&&Nt("keydown",function(g){return o._handleKeydown(g)})("focus",function(){return o._onFocus()})("blur",function(){return o._onBlur()}),n&2&&(un("id",o.id)("tabindex",o.disabled?-1:o.tabIndex)("aria-controls",o.panelOpen?o.id+"-panel":null)("aria-expanded",o.panelOpen)("aria-label",o.ariaLabel||null)("aria-required",o.required.toString())("aria-disabled",o.disabled.toString())("aria-invalid",o.errorState)("aria-activedescendant",o._getAriaActiveDescendant()),Ji("mat-mdc-select-disabled",o.disabled)("mat-mdc-select-invalid",o.errorState)("mat-mdc-select-required",o.required)("mat-mdc-select-empty",o.empty)("mat-mdc-select-multiple",o.multiple))},inputs:{userAriaDescribedBy:[0,"aria-describedby","userAriaDescribedBy"],panelClass:"panelClass",disabled:[2,"disabled","disabled",Bi],disableRipple:[2,"disableRipple","disableRipple",Bi],tabIndex:[2,"tabIndex","tabIndex",e=>e==null?0:bs(e)],hideSingleSelectionIndicator:[2,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",Bi],placeholder:"placeholder",required:[2,"required","required",Bi],multiple:[2,"multiple","multiple",Bi],disableOptionCentering:[2,"disableOptionCentering","disableOptionCentering",Bi],compareWith:"compareWith",value:"value",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:[2,"typeaheadDebounceInterval","typeaheadDebounceInterval",bs],sortComparator:"sortComparator",id:"id",panelWidth:"panelWidth",canSelectNullableOptions:[2,"canSelectNullableOptions","canSelectNullableOptions",Bi]},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},exportAs:["matSelect"],features:[fr([{provide:B0,useExisting:t},{provide:M4,useExisting:t}]),$r],ngContentSelectors:q_e,decls:11,vars:9,consts:[["fallbackOverlayOrigin","cdkOverlayOrigin","trigger",""],["panel",""],["cdk-overlay-origin","",1,"mat-mdc-select-trigger",3,"click"],[1,"mat-mdc-select-value"],[1,"mat-mdc-select-placeholder","mat-mdc-select-min-line"],[1,"mat-mdc-select-value-text"],[1,"mat-mdc-select-arrow-wrapper"],[1,"mat-mdc-select-arrow"],["viewBox","0 0 24 24","width","24px","height","24px","focusable","false","aria-hidden","true"],["d","M7 10l5 5 5-5z"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"detach","backdropClick","overlayKeydown","cdkConnectedOverlayDisableClose","cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayPositions","cdkConnectedOverlayWidth","cdkConnectedOverlayFlexibleDimensions"],[1,"mat-mdc-select-min-line"],["role","listbox","tabindex","-1",3,"keydown","ngClass"]],template:function(n,o){if(n&1){let r=zi();Qr(H_e),ae(0,"div",2,0),Nt("click",function(){return ri(r),oi(o.open())}),ae(3,"div",3),Tt(4,$_e,2,1,"span",4)(5,Z_e,3,1,"span",5),se(),ae(6,"div",6)(7,"div",7),gs(),ae(8,"svg",8),jt(9,"path",9),se()()()(),Tt(10,Y_e,3,10,"ng-template",10),Nt("detach",function(){return ri(r),oi(o.close())})("backdropClick",function(){return ri(r),oi(o.close())})("overlayKeydown",function(w){return ri(r),oi(o._handleOverlayKeydown(w))})}if(n&2){let r=Ca(1);Se(3),un("id",o._valueId),Se(),zn(o.empty?4:5),Se(6),Xe("cdkConnectedOverlayDisableClose",!0)("cdkConnectedOverlayPanelClass",o._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",o._scrollStrategy)("cdkConnectedOverlayOrigin",o._preferredOverlayOrigin||r)("cdkConnectedOverlayPositions",o._positions)("cdkConnectedOverlayWidth",o._overlayWidth)("cdkConnectedOverlayFlexibleDimensions",!0)}},dependencies:[cv,jD,Js],styles:[`@keyframes _mat-select-enter{from{opacity:0;transform:scaleY(0.8)}to{opacity:1;transform:none}}@keyframes _mat-select-exit{from{opacity:1}to{opacity:0}}.mat-mdc-select{display:inline-block;width:100%;outline:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-select-enabled-trigger-text-color, var(--mat-sys-on-surface));font-family:var(--mat-select-trigger-text-font, var(--mat-sys-body-large-font));line-height:var(--mat-select-trigger-text-line-height, var(--mat-sys-body-large-line-height));font-size:var(--mat-select-trigger-text-size, var(--mat-sys-body-large-size));font-weight:var(--mat-select-trigger-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mat-select-trigger-text-tracking, var(--mat-sys-body-large-tracking))}div.mat-mdc-select-panel{box-shadow:var(--mat-select-container-elevation-shadow, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-select-disabled{color:var(--mat-select-disabled-trigger-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-select-disabled .mat-mdc-select-placeholder{color:var(--mat-select-disabled-trigger-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-mdc-select-disabled .mat-mdc-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-mdc-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-mdc-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-mdc-select-arrow-wrapper{height:24px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mdc-text-field--no-label .mat-mdc-select-arrow-wrapper{transform:none}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-invalid .mat-mdc-select-arrow,.mat-form-field-invalid:not(.mat-form-field-disabled) .mat-mdc-form-field-infix::after{color:var(--mat-select-invalid-arrow-color, var(--mat-sys-error))}.mat-mdc-select-arrow{width:10px;height:5px;position:relative;color:var(--mat-select-enabled-arrow-color, var(--mat-sys-on-surface-variant))}.mat-mdc-form-field.mat-focused .mat-mdc-select-arrow{color:var(--mat-select-focused-arrow-color, var(--mat-sys-primary))}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-disabled .mat-mdc-select-arrow{color:var(--mat-select-disabled-arrow-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-select-arrow svg{fill:currentColor;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}@media(forced-colors: active){.mat-mdc-select-arrow svg{fill:CanvasText}.mat-mdc-select-disabled .mat-mdc-select-arrow svg{fill:GrayText}}div.mat-mdc-select-panel{width:100%;max-height:275px;outline:0;overflow:auto;padding:8px 0;border-radius:4px;box-sizing:border-box;position:static;background-color:var(--mat-select-panel-background-color, var(--mat-sys-surface-container))}@media(forced-colors: active){div.mat-mdc-select-panel{outline:solid 1px}}.cdk-overlay-pane:not(.mat-mdc-select-panel-above) div.mat-mdc-select-panel{border-top-left-radius:0;border-top-right-radius:0;transform-origin:top center}.mat-mdc-select-panel-above div.mat-mdc-select-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:bottom center}div.mat-mdc-select-panel .mat-mdc-option{--mdc-list-list-item-container-color: var(--mat-select-panel-background-color)}.mat-select-panel-animations-enabled{animation:_mat-select-enter 120ms cubic-bezier(0, 0, 0.2, 1)}.mat-select-panel-animations-enabled.mat-select-panel-exit{animation:_mat-select-exit 100ms linear}.mat-mdc-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1);color:var(--mat-select-placeholder-text-color, var(--mat-sys-on-surface-variant))}.mat-mdc-form-field:not(.mat-form-field-animations-enabled) .mat-mdc-select-placeholder,._mat-animation-noopable .mat-mdc-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-mdc-select-placeholder{color:rgba(0,0,0,0);-webkit-text-fill-color:rgba(0,0,0,0);transition:none;display:block}.mat-mdc-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper{cursor:pointer}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mat-mdc-floating-label{max-width:calc(100% - 18px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 24px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-text-field--label-floating .mdc-notched-outline__notch{max-width:calc(100% - 24px)}.mat-mdc-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;visibility:hidden}.mat-form-field-appearance-fill .mat-mdc-select-arrow-wrapper{transform:var(--mat-select-arrow-transform, translateY(-8px))}
`],encapsulation:2,changeDetection:0})}return t})();var Kd=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({providers:[oY],imports:[au,A4,Wn,Hp,El,A4,Wn]})}return t})();var K_e=["tooltip"],cY=20;var uY=new Ot("mat-tooltip-scroll-strategy",{providedIn:"root",factory:()=>{let t=J(sa);return()=>t.scrollStrategies.reposition({scrollThrottle:cY})}});function X_e(t){return()=>t.scrollStrategies.reposition({scrollThrottle:cY})}var Q_e={provide:uY,deps:[sa],useFactory:X_e};function J_e(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}var eye=new Ot("mat-tooltip-default-options",{providedIn:"root",factory:J_e});var sY="tooltip-panel",lY=ym({passive:!0}),tye=8,iye=8,nye=24,rye=200,dY=(()=>{class t{_elementRef=J(Qi);_ngZone=J(Oi);_platform=J(Pr);_ariaDescriber=J(yW);_focusMonitor=J(Uu);_dir=J(aa);_injector=J(wn);_viewContainerRef=J(na);_defaultOptions=J(eye,{optional:!0});_overlayRef;_tooltipInstance;_portal;_position="below";_positionAtOrigin=!1;_disabled=!1;_tooltipClass;_viewInitialized=!1;_pointerExitEventsInitialized=!1;_tooltipComponent=oye;_viewportMargin=8;_currentPosition;_cssClassPrefix="mat-mdc";_ariaDescriptionPending;_dirSubscribed=!1;get position(){return this._position}set position(e){e!==this._position&&(this._position=e,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(e){this._positionAtOrigin=su(e),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(e){let n=su(e);this._disabled!==n&&(this._disabled=n,n?this.hide(0):this._setupPointerEnterEventsIfNeeded(),this._syncAriaDescription(this.message))}get showDelay(){return this._showDelay}set showDelay(e){this._showDelay=Up(e)}_showDelay;get hideDelay(){return this._hideDelay}set hideDelay(e){this._hideDelay=Up(e),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}_hideDelay;touchGestures="auto";get message(){return this._message}set message(e){let n=this._message;this._message=e!=null?String(e).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage()),this._syncAriaDescription(n)}_message="";get tooltipClass(){return this._tooltipClass}set tooltipClass(e){this._tooltipClass=e,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}_passiveListeners=[];_touchstartTimeout=null;_destroyed=new gi;_isDestroyed=!1;constructor(){let e=this._defaultOptions;e&&(this._showDelay=e.showDelay,this._hideDelay=e.hideDelay,e.position&&(this.position=e.position),e.positionAtOrigin&&(this.positionAtOrigin=e.positionAtOrigin),e.touchGestures&&(this.touchGestures=e.touchGestures),e.tooltipClass&&(this.tooltipClass=e.tooltipClass)),this._viewportMargin=tye}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(_r(this._destroyed)).subscribe(e=>{e?e==="keyboard"&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){let e=this._elementRef.nativeElement;this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([n,o])=>{e.removeEventListener(n,o,lY)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._isDestroyed=!0,this._ariaDescriber.removeDescription(e,this.message,"tooltip"),this._focusMonitor.stopMonitoring(e)}show(e=this.showDelay,n){if(this.disabled||!this.message||this._isTooltipVisible()){this._tooltipInstance?._cancelPendingAnimations();return}let o=this._createOverlay(n);this._detach(),this._portal=this._portal||new $l(this._tooltipComponent,this._viewContainerRef);let r=this._tooltipInstance=o.attach(this._portal).instance;r._triggerElement=this._elementRef.nativeElement,r._mouseLeaveHideDelay=this._hideDelay,r.afterHidden().pipe(_r(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),r.show(e)}hide(e=this.hideDelay){let n=this._tooltipInstance;n&&(n.isVisible()?n.hide(e):(n._cancelPendingAnimations(),this._detach()))}toggle(e){this._isTooltipVisible()?this.hide():this.show(void 0,e)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(e){if(this._overlayRef){let g=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!e)&&g._origin instanceof Qi)return this._overlayRef;this._detach()}let n=this._injector.get(sv).getAncestorScrollContainers(this._elementRef),o=this._injector.get(sa),r=o.position().flexibleConnectedTo(this.positionAtOrigin?e||this._elementRef:this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(n);return r.positionChanges.pipe(_r(this._destroyed)).subscribe(g=>{this._updateCurrentPositionClass(g.connectionPair),this._tooltipInstance&&g.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=o.create({direction:this._dir,positionStrategy:r,panelClass:`${this._cssClassPrefix}-${sY}`,scrollStrategy:this._injector.get(uY)()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(_r(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(_r(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(_r(this._destroyed)).subscribe(g=>{this._isTooltipVisible()&&g.keyCode===27&&!ga(g)&&(g.preventDefault(),g.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._dirSubscribed||(this._dirSubscribed=!0,this._dir.change.pipe(_r(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)})),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(e){let n=e.getConfig().positionStrategy,o=this._getOrigin(),r=this._getOverlayPosition();n.withPositions([this._addOffset(It(It({},o.main),r.main)),this._addOffset(It(It({},o.fallback),r.fallback))])}_addOffset(e){let n=iye,o=!this._dir||this._dir.value=="ltr";return e.originY==="top"?e.offsetY=-8:e.originY==="bottom"?e.offsetY=n:e.originX==="start"?e.offsetX=o?-8:n:e.originX==="end"&&(e.offsetX=o?n:-8),e}_getOrigin(){let e=!this._dir||this._dir.value=="ltr",n=this.position,o;n=="above"||n=="below"?o={originX:"center",originY:n=="above"?"top":"bottom"}:n=="before"||n=="left"&&e||n=="right"&&!e?o={originX:"start",originY:"center"}:(n=="after"||n=="right"&&e||n=="left"&&!e)&&(o={originX:"end",originY:"center"});let{x:r,y:g}=this._invertPosition(o.originX,o.originY);return{main:o,fallback:{originX:r,originY:g}}}_getOverlayPosition(){let e=!this._dir||this._dir.value=="ltr",n=this.position,o;n=="above"?o={overlayX:"center",overlayY:"bottom"}:n=="below"?o={overlayX:"center",overlayY:"top"}:n=="before"||n=="left"&&e||n=="right"&&!e?o={overlayX:"end",overlayY:"center"}:(n=="after"||n=="right"&&e||n=="left"&&!e)&&(o={overlayX:"start",overlayY:"center"});let{x:r,y:g}=this._invertPosition(o.overlayX,o.overlayY);return{main:o,fallback:{overlayX:r,overlayY:g}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),_s(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()},{injector:this._injector}))}_setTooltipClass(e){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=e,this._tooltipInstance._markForCheck())}_invertPosition(e,n){return this.position==="above"||this.position==="below"?n==="top"?n="bottom":n==="bottom"&&(n="top"):e==="end"?e="start":e==="start"&&(e="end"),{x:e,y:n}}_updateCurrentPositionClass(e){let{overlayY:n,originX:o,originY:r}=e,g;if(n==="center"?this._dir&&this._dir.value==="rtl"?g=o==="end"?"left":"right":g=o==="start"?"left":"right":g=n==="bottom"&&r==="top"?"above":"below",g!==this._currentPosition){let w=this._overlayRef;if(w){let T=`${this._cssClassPrefix}-${sY}-`;w.removePanelClass(T+this._currentPosition),w.addPanelClass(T+g)}this._currentPosition=g}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",e=>{this._setupPointerExitEventsIfNeeded();let n;e.x!==void 0&&e.y!==void 0&&(n=e),this.show(void 0,n)}]):this.touchGestures!=="off"&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",e=>{let n=e.targetTouches?.[0],o=n?{x:n.clientX,y:n.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),this._touchstartTimeout&&clearTimeout(this._touchstartTimeout);let r=500;this._touchstartTimeout=setTimeout(()=>{this._touchstartTimeout=null,this.show(void 0,o)},this._defaultOptions?.touchLongPressShowDelay??r)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;let e=[];if(this._platformSupportsMouseEvents())e.push(["mouseleave",n=>{let o=n.relatedTarget;(!o||!this._overlayRef?.overlayElement.contains(o))&&this.hide()}],["wheel",n=>this._wheelListener(n)]);else if(this.touchGestures!=="off"){this._disableNativeGesturesIfNecessary();let n=()=>{this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions?.touchendHideDelay)};e.push(["touchend",n],["touchcancel",n])}this._addListeners(e),this._passiveListeners.push(...e)}_addListeners(e){e.forEach(([n,o])=>{this._elementRef.nativeElement.addEventListener(n,o,lY)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(e){if(this._isTooltipVisible()){let n=this._injector.get(cn).elementFromPoint(e.clientX,e.clientY),o=this._elementRef.nativeElement;n!==o&&!o.contains(n)&&this.hide()}}_disableNativeGesturesIfNecessary(){let e=this.touchGestures;if(e!=="off"){let n=this._elementRef.nativeElement,o=n.style;(e==="on"||n.nodeName!=="INPUT"&&n.nodeName!=="TEXTAREA")&&(o.userSelect=o.msUserSelect=o.webkitUserSelect=o.MozUserSelect="none"),(e==="on"||!n.draggable)&&(o.webkitUserDrag="none"),o.touchAction="none",o.webkitTapHighlightColor="transparent"}}_syncAriaDescription(e){this._ariaDescriptionPending||(this._ariaDescriptionPending=!0,this._ariaDescriber.removeDescription(this._elementRef.nativeElement,e,"tooltip"),this._isDestroyed||_s({write:()=>{this._ariaDescriptionPending=!1,this.message&&!this.disabled&&this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")}},{injector:this._injector}))}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],hostVars:2,hostBindings:function(n,o){n&2&&Ji("mat-mdc-tooltip-disabled",o.disabled)},inputs:{position:[0,"matTooltipPosition","position"],positionAtOrigin:[0,"matTooltipPositionAtOrigin","positionAtOrigin"],disabled:[0,"matTooltipDisabled","disabled"],showDelay:[0,"matTooltipShowDelay","showDelay"],hideDelay:[0,"matTooltipHideDelay","hideDelay"],touchGestures:[0,"matTooltipTouchGestures","touchGestures"],message:[0,"matTooltip","message"],tooltipClass:[0,"matTooltipClass","tooltipClass"]},exportAs:["matTooltip"]})}return t})(),oye=(()=>{class t{_changeDetectorRef=J(vr);_elementRef=J(Qi);_isMultiline=!1;message;tooltipClass;_showTimeoutId;_hideTimeoutId;_triggerElement;_mouseLeaveHideDelay;_animationsDisabled;_tooltip;_closeOnInteraction=!1;_isVisible=!1;_onHide=new gi;_showAnimation="mat-mdc-tooltip-show";_hideAnimation="mat-mdc-tooltip-hide";constructor(){let e=J(oo,{optional:!0});this._animationsDisabled=e==="NoopAnimations"}show(e){this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},e)}hide(e){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},e)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:e}){(!e||!this._triggerElement.contains(e))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){let e=this._elementRef.nativeElement.getBoundingClientRect();return e.height>nye&&e.width>=rye}_handleAnimationEnd({animationName:e}){(e===this._showAnimation||e===this._hideAnimation)&&this._finalizeAnimation(e===this._showAnimation)}_cancelPendingAnimations(){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(e){e?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(e){let n=this._tooltip.nativeElement,o=this._showAnimation,r=this._hideAnimation;if(n.classList.remove(e?r:o),n.classList.add(e?o:r),this._isVisible!==e&&(this._isVisible=e,this._changeDetectorRef.markForCheck()),e&&!this._animationsDisabled&&typeof getComputedStyle=="function"){let g=getComputedStyle(n);(g.getPropertyValue("animation-duration")==="0s"||g.getPropertyValue("animation-name")==="none")&&(this._animationsDisabled=!0)}e&&this._onShow(),this._animationsDisabled&&(n.classList.add("_mat-animation-noopable"),this._finalizeAnimation(e))}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-tooltip-component"]],viewQuery:function(n,o){if(n&1&&pr(K_e,7),n&2){let r;sn(r=ln())&&(o._tooltip=r.first)}},hostAttrs:["aria-hidden","true"],hostBindings:function(n,o){n&1&&Nt("mouseleave",function(g){return o._handleMouseLeave(g)})},decls:4,vars:4,consts:[["tooltip",""],[1,"mdc-tooltip","mat-mdc-tooltip",3,"animationend","ngClass"],[1,"mat-mdc-tooltip-surface","mdc-tooltip__surface"]],template:function(n,o){if(n&1){let r=zi();ae(0,"div",1,0),Nt("animationend",function(w){return ri(r),oi(o._handleAnimationEnd(w))}),ae(2,"div",2),Oe(3),se()()}n&2&&(Ji("mdc-tooltip--multiline",o._isMultiline),Xe("ngClass",o.tooltipClass),Se(3),En(o.message))},dependencies:[Js],styles:[`.mat-mdc-tooltip{position:relative;transform:scale(0);display:inline-flex}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-surface{word-break:normal;overflow-wrap:anywhere;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center;will-change:transform,opacity;background-color:var(--mdc-plain-tooltip-container-color, var(--mat-sys-inverse-surface));color:var(--mdc-plain-tooltip-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mdc-plain-tooltip-container-shape, var(--mat-sys-corner-extra-small));font-family:var(--mdc-plain-tooltip-supporting-text-font, var(--mat-sys-body-small-font));font-size:var(--mdc-plain-tooltip-supporting-text-size, var(--mat-sys-body-small-size));font-weight:var(--mdc-plain-tooltip-supporting-text-weight, var(--mat-sys-body-small-weight));line-height:var(--mdc-plain-tooltip-supporting-text-line-height, var(--mat-sys-body-small-line-height));letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking, var(--mat-sys-body-small-tracking))}.mat-mdc-tooltip-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:right}.mat-mdc-tooltip-panel{line-height:normal}.mat-mdc-tooltip-panel.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}
`],encapsulation:2,changeDetection:0})}return t})(),hY=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({providers:[Q_e],imports:[T0,au,Wn,Wn,Hp]})}return t})();function aye(t,i){if(t&1&&(ae(0,"mat-option",17),Oe(1),se()),t&2){let e=i.$implicit;Xe("value",e),Se(),an(" ",e," ")}}function sye(t,i){if(t&1){let e=zi();ae(0,"mat-form-field",14)(1,"mat-select",16,0),Nt("selectionChange",function(o){ri(e);let r=zt(2);return oi(r._changePageSize(o.value))}),ky(3,aye,2,2,"mat-option",17,ej),se(),ae(5,"div",18),Nt("click",function(){ri(e);let o=Ca(2);return oi(o.open())}),se()()}if(t&2){let e=zt(2);Xe("appearance",e._formFieldAppearance)("color",e.color),Se(),Xe("value",e.pageSize)("disabled",e.disabled)("aria-labelledby",e._pageSizeLabelId)("panelClass",e.selectConfig.panelClass||"")("disableOptionCentering",e.selectConfig.disableOptionCentering),Se(2),Oy(e._displayedPageSizeOptions)}}function lye(t,i){if(t&1&&(ae(0,"div",15),Oe(1),se()),t&2){let e=zt(2);Se(),En(e.pageSize)}}function cye(t,i){if(t&1&&(ae(0,"div",3)(1,"div",13),Oe(2),se(),Tt(3,sye,6,7,"mat-form-field",14)(4,lye,2,1,"div",15),se()),t&2){let e=zt();Se(),un("id",e._pageSizeLabelId),Se(),an(" ",e._intl.itemsPerPageLabel," "),Se(),zn(e._displayedPageSizeOptions.length>1?3:-1),Se(),zn(e._displayedPageSizeOptions.length<=1?4:-1)}}function uye(t,i){if(t&1){let e=zi();ae(0,"button",19),Nt("click",function(){ri(e);let o=zt();return oi(o._buttonClicked(0,o._previousButtonsDisabled()))}),gs(),ae(1,"svg",8),jt(2,"path",20),se()()}if(t&2){let e=zt();Xe("matTooltip",e._intl.firstPageLabel)("matTooltipDisabled",e._previousButtonsDisabled())("disabled",e._previousButtonsDisabled())("tabindex",e._previousButtonsDisabled()?-1:null),un("aria-label",e._intl.firstPageLabel)}}function dye(t,i){if(t&1){let e=zi();ae(0,"button",21),Nt("click",function(){ri(e);let o=zt();return oi(o._buttonClicked(o.getNumberOfPages()-1,o._nextButtonsDisabled()))}),gs(),ae(1,"svg",8),jt(2,"path",22),se()()}if(t&2){let e=zt();Xe("matTooltip",e._intl.lastPageLabel)("matTooltipDisabled",e._nextButtonsDisabled())("disabled",e._nextButtonsDisabled())("tabindex",e._nextButtonsDisabled()?-1:null),un("aria-label",e._intl.lastPageLabel)}}var BM=(()=>{class t{changes=new gi;itemsPerPageLabel="Items per page:";nextPageLabel="Next page";previousPageLabel="Previous page";firstPageLabel="First page";lastPageLabel="Last page";getRangeLabel=(e,n,o)=>{if(o==0||n==0)return`0 of ${o}`;o=Math.max(o,0);let r=e*n,g=r<o?Math.min(r+n,o):r+n;return`${r+1} \u2013 ${g} of ${o}`};static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function hye(t){return t||new BM}var pye={provide:BM,deps:[[new Rh,new by,BM]],useFactory:hye},fye=50;var mye=new Ot("MAT_PAGINATOR_DEFAULT_OPTIONS"),V0=(()=>{class t{_intl=J(BM);_changeDetectorRef=J(vr);_formFieldAppearance;_pageSizeLabelId=J(po).getId("mat-paginator-page-size-label-");_intlChanges;_isInitialized=!1;_initializedStream=new kg(1);color;get pageIndex(){return this._pageIndex}set pageIndex(e){this._pageIndex=Math.max(e||0,0),this._changeDetectorRef.markForCheck()}_pageIndex=0;get length(){return this._length}set length(e){this._length=e||0,this._changeDetectorRef.markForCheck()}_length=0;get pageSize(){return this._pageSize}set pageSize(e){this._pageSize=Math.max(e||0,0),this._updateDisplayedPageSizeOptions()}_pageSize;get pageSizeOptions(){return this._pageSizeOptions}set pageSizeOptions(e){this._pageSizeOptions=(e||[]).map(n=>bs(n,0)),this._updateDisplayedPageSizeOptions()}_pageSizeOptions=[];hidePageSize=!1;showFirstLastButtons=!1;selectConfig={};disabled=!1;page=new Mi;_displayedPageSizeOptions;initialized=this._initializedStream;constructor(){let e=this._intl,n=J(mye,{optional:!0});if(this._intlChanges=e.changes.subscribe(()=>this._changeDetectorRef.markForCheck()),n){let{pageSize:o,pageSizeOptions:r,hidePageSize:g,showFirstLastButtons:w}=n;o!=null&&(this._pageSize=o),r!=null&&(this._pageSizeOptions=r),g!=null&&(this.hidePageSize=g),w!=null&&(this.showFirstLastButtons=w)}this._formFieldAppearance=n?.formFieldAppearance||"outline"}ngOnInit(){this._isInitialized=!0,this._updateDisplayedPageSizeOptions(),this._initializedStream.next()}ngOnDestroy(){this._initializedStream.complete(),this._intlChanges.unsubscribe()}nextPage(){this.hasNextPage()&&this._navigate(this.pageIndex+1)}previousPage(){this.hasPreviousPage()&&this._navigate(this.pageIndex-1)}firstPage(){this.hasPreviousPage()&&this._navigate(0)}lastPage(){this.hasNextPage()&&this._navigate(this.getNumberOfPages()-1)}hasPreviousPage(){return this.pageIndex>=1&&this.pageSize!=0}hasNextPage(){let e=this.getNumberOfPages()-1;return this.pageIndex<e&&this.pageSize!=0}getNumberOfPages(){return this.pageSize?Math.ceil(this.length/this.pageSize):0}_changePageSize(e){let n=this.pageIndex*this.pageSize,o=this.pageIndex;this.pageIndex=Math.floor(n/e)||0,this.pageSize=e,this._emitPageEvent(o)}_nextButtonsDisabled(){return this.disabled||!this.hasNextPage()}_previousButtonsDisabled(){return this.disabled||!this.hasPreviousPage()}_updateDisplayedPageSizeOptions(){this._isInitialized&&(this.pageSize||(this._pageSize=this.pageSizeOptions.length!=0?this.pageSizeOptions[0]:fye),this._displayedPageSizeOptions=this.pageSizeOptions.slice(),this._displayedPageSizeOptions.indexOf(this.pageSize)===-1&&this._displayedPageSizeOptions.push(this.pageSize),this._displayedPageSizeOptions.sort((e,n)=>e-n),this._changeDetectorRef.markForCheck())}_emitPageEvent(e){this.page.emit({previousPageIndex:e,pageIndex:this.pageIndex,pageSize:this.pageSize,length:this.length})}_navigate(e){let n=this.pageIndex;e!==n&&(this.pageIndex=e,this._emitPageEvent(n))}_buttonClicked(e,n){n||this._navigate(e)}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-paginator"]],hostAttrs:["role","group",1,"mat-mdc-paginator"],inputs:{color:"color",pageIndex:[2,"pageIndex","pageIndex",bs],length:[2,"length","length",bs],pageSize:[2,"pageSize","pageSize",bs],pageSizeOptions:"pageSizeOptions",hidePageSize:[2,"hidePageSize","hidePageSize",Bi],showFirstLastButtons:[2,"showFirstLastButtons","showFirstLastButtons",Bi],selectConfig:"selectConfig",disabled:[2,"disabled","disabled",Bi]},outputs:{page:"page"},exportAs:["matPaginator"],decls:14,vars:14,consts:[["selectRef",""],[1,"mat-mdc-paginator-outer-container"],[1,"mat-mdc-paginator-container"],[1,"mat-mdc-paginator-page-size"],[1,"mat-mdc-paginator-range-actions"],["aria-live","polite",1,"mat-mdc-paginator-range-label"],["mat-icon-button","","type","button","matTooltipPosition","above","disabledInteractive","",1,"mat-mdc-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","disabled","tabindex"],["mat-icon-button","","type","button","matTooltipPosition","above","disabledInteractive","",1,"mat-mdc-paginator-navigation-previous",3,"click","matTooltip","matTooltipDisabled","disabled","tabindex"],["viewBox","0 0 24 24","focusable","false","aria-hidden","true",1,"mat-mdc-paginator-icon"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button","matTooltipPosition","above","disabledInteractive","",1,"mat-mdc-paginator-navigation-next",3,"click","matTooltip","matTooltipDisabled","disabled","tabindex"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["mat-icon-button","","type","button","matTooltipPosition","above","disabledInteractive","",1,"mat-mdc-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","disabled","tabindex"],[1,"mat-mdc-paginator-page-size-label"],[1,"mat-mdc-paginator-page-size-select",3,"appearance","color"],[1,"mat-mdc-paginator-page-size-value"],["hideSingleSelectionIndicator","",3,"selectionChange","value","disabled","aria-labelledby","panelClass","disableOptionCentering"],[3,"value"],[1,"mat-mdc-paginator-touch-target",3,"click"],["mat-icon-button","","type","button","matTooltipPosition","above","disabledInteractive","",1,"mat-mdc-paginator-navigation-first",3,"click","matTooltip","matTooltipDisabled","disabled","tabindex"],["d","M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"],["mat-icon-button","","type","button","matTooltipPosition","above","disabledInteractive","",1,"mat-mdc-paginator-navigation-last",3,"click","matTooltip","matTooltipDisabled","disabled","tabindex"],["d","M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"]],template:function(n,o){n&1&&(ae(0,"div",1)(1,"div",2),Tt(2,cye,5,4,"div",3),ae(3,"div",4)(4,"div",5),Oe(5),se(),Tt(6,uye,3,5,"button",6),ae(7,"button",7),Nt("click",function(){return o._buttonClicked(o.pageIndex-1,o._previousButtonsDisabled())}),gs(),ae(8,"svg",8),jt(9,"path",9),se()(),Jg(),ae(10,"button",10),Nt("click",function(){return o._buttonClicked(o.pageIndex+1,o._nextButtonsDisabled())}),gs(),ae(11,"svg",8),jt(12,"path",11),se()(),Tt(13,dye,3,5,"button",12),se()()()),n&2&&(Se(2),zn(o.hidePageSize?-1:2),Se(3),an(" ",o._intl.getRangeLabel(o.pageIndex,o.pageSize,o.length)," "),Se(),zn(o.showFirstLastButtons?6:-1),Se(),Xe("matTooltip",o._intl.previousPageLabel)("matTooltipDisabled",o._previousButtonsDisabled())("disabled",o._previousButtonsDisabled())("tabindex",o._previousButtonsDisabled()?-1:null),un("aria-label",o._intl.previousPageLabel),Se(3),Xe("matTooltip",o._intl.nextPageLabel)("matTooltipDisabled",o._nextButtonsDisabled())("disabled",o._nextButtonsDisabled())("tabindex",o._nextButtonsDisabled()?-1:null),un("aria-label",o._intl.nextPageLabel),Se(3),zn(o.showFirstLastButtons?13:-1))},dependencies:[du,Zp,Yd,wl,dY],styles:[`.mat-mdc-paginator{display:block;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-paginator-container-text-color, var(--mat-sys-on-surface));background-color:var(--mat-paginator-container-background-color, var(--mat-sys-surface));font-family:var(--mat-paginator-container-text-font, var(--mat-sys-body-small-font));line-height:var(--mat-paginator-container-text-line-height, var(--mat-sys-body-small-line-height));font-size:var(--mat-paginator-container-text-size, var(--mat-sys-body-small-size));font-weight:var(--mat-paginator-container-text-weight, var(--mat-sys-body-small-weight));letter-spacing:var(--mat-paginator-container-text-tracking, var(--mat-sys-body-small-tracking));--mat-form-field-container-height:var(--mat-paginator-form-field-container-height, 40px);--mat-form-field-container-vertical-padding:var(--mat-paginator-form-field-container-vertical-padding, 8px)}.mat-mdc-paginator .mat-mdc-select-value{font-size:var(--mat-paginator-select-trigger-text-size, var(--mat-sys-body-small-size))}.mat-mdc-paginator .mat-mdc-form-field-subscript-wrapper{display:none}.mat-mdc-paginator .mat-mdc-select{line-height:1.5}.mat-mdc-paginator-outer-container{display:flex}.mat-mdc-paginator-container{display:flex;align-items:center;justify-content:flex-end;padding:0 8px;flex-wrap:wrap;width:100%;min-height:var(--mat-paginator-container-size, 56px)}.mat-mdc-paginator-page-size{display:flex;align-items:baseline;margin-right:8px}[dir=rtl] .mat-mdc-paginator-page-size{margin-right:0;margin-left:8px}.mat-mdc-paginator-page-size-label{margin:0 4px}.mat-mdc-paginator-page-size-select{margin:0 4px;width:84px}.mat-mdc-paginator-range-label{margin:0 32px 0 24px}.mat-mdc-paginator-range-actions{display:flex;align-items:center}.mat-mdc-paginator-icon{display:inline-block;width:28px;fill:var(--mat-paginator-enabled-icon-color, var(--mat-sys-on-surface-variant))}.mat-mdc-icon-button[aria-disabled] .mat-mdc-paginator-icon{fill:var(--mat-paginator-disabled-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}[dir=rtl] .mat-mdc-paginator-icon{transform:rotate(180deg)}@media(forced-colors: active){.mat-mdc-icon-button[aria-disabled] .mat-mdc-paginator-icon,.mat-mdc-paginator-icon{fill:currentColor}.mat-mdc-paginator-range-actions .mat-mdc-icon-button{outline:solid 1px}.mat-mdc-paginator-range-actions .mat-mdc-icon-button[aria-disabled]{color:GrayText}}.mat-mdc-paginator-touch-target{display:var(--mat-paginator-touch-target-display, block);position:absolute;top:50%;left:50%;width:84px;height:48px;background-color:rgba(0,0,0,0);transform:translate(-50%, -50%);cursor:pointer}
`],encapsulation:2,changeDetection:0})}return t})(),Ev=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({providers:[pye],imports:[Fs,Kd,hY,V0]})}return t})();var gye=["*"];var _ye=[[["","mat-card-avatar",""],["","matCardAvatar",""]],[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],"*"],yye=["[mat-card-avatar], [matCardAvatar]",`mat-card-title, mat-card-subtitle,
      [mat-card-title], [mat-card-subtitle],
      [matCardTitle], [matCardSubtitle]`,"*"],vye=new Ot("MAT_CARD_CONFIG"),Zu=(()=>{class t{appearance;constructor(){let e=J(vye,{optional:!0});this.appearance=e?.appearance||"raised"}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(n,o){n&2&&Ji("mat-mdc-card-outlined",o.appearance==="outlined")("mdc-card--outlined",o.appearance==="outlined")},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:gye,decls:1,vars:0,template:function(n,o){n&1&&(Qr(),On(0))},styles:[`.mat-mdc-card{display:flex;flex-direction:column;box-sizing:border-box;position:relative;border-style:solid;border-width:0;background-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium));box-shadow:var(--mdc-elevated-card-container-elevation, var(--mat-sys-level1))}.mat-mdc-card::after{position:absolute;top:0;left:0;width:100%;height:100%;border:solid 1px rgba(0,0,0,0);content:"";display:block;pointer-events:none;box-sizing:border-box;border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium))}.mat-mdc-card-outlined{background-color:var(--mdc-outlined-card-container-color, var(--mat-sys-surface));border-radius:var(--mdc-outlined-card-container-shape, var(--mat-sys-corner-medium));border-width:var(--mdc-outlined-card-outline-width, 1px);border-color:var(--mdc-outlined-card-outline-color, var(--mat-sys-outline-variant));box-shadow:var(--mdc-outlined-card-container-elevation, var(--mat-sys-level0))}.mat-mdc-card-outlined::after{border:none}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mat-mdc-card-actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font, var(--mat-sys-title-large-font));line-height:var(--mat-card-title-text-line-height, var(--mat-sys-title-large-line-height));font-size:var(--mat-card-title-text-size, var(--mat-sys-title-large-size));letter-spacing:var(--mat-card-title-text-tracking, var(--mat-sys-title-large-tracking));font-weight:var(--mat-card-title-text-weight, var(--mat-sys-title-large-weight))}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color, var(--mat-sys-on-surface));font-family:var(--mat-card-subtitle-text-font, var(--mat-sys-title-medium-font));line-height:var(--mat-card-subtitle-text-line-height, var(--mat-sys-title-medium-line-height));font-size:var(--mat-card-subtitle-text-size, var(--mat-sys-title-medium-size));letter-spacing:var(--mat-card-subtitle-text-tracking, var(--mat-sys-title-medium-tracking));font-weight:var(--mat-card-subtitle-text-weight, var(--mat-sys-title-medium-weight))}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}
`],encapsulation:2,changeDetection:0})}return t})(),Bm=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["mat-card-title"],["","mat-card-title",""],["","matCardTitle",""]],hostAttrs:[1,"mat-mdc-card-title"]})}return t})();var Vm=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["mat-card-content"]],hostAttrs:[1,"mat-mdc-card-content"]})}return t})(),VM=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["mat-card-subtitle"],["","mat-card-subtitle",""],["","matCardSubtitle",""]],hostAttrs:[1,"mat-mdc-card-subtitle"]})}return t})(),jM=(()=>{class t{align="start";static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["mat-card-actions"]],hostAttrs:[1,"mat-mdc-card-actions","mdc-card__actions"],hostVars:2,hostBindings:function(n,o){n&2&&Ji("mat-mdc-card-actions-align-end",o.align==="end")},inputs:{align:"align"},exportAs:["matCardActions"]})}return t})(),jm=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-card-header"]],hostAttrs:[1,"mat-mdc-card-header"],ngContentSelectors:yye,decls:4,vars:0,consts:[[1,"mat-mdc-card-header-text"]],template:function(n,o){n&1&&(Qr(_ye),On(0),ae(1,"div",0),On(2,1),se(),On(3,2))},encapsulation:2,changeDetection:0})}return t})();var Yu=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({imports:[Wn,Wn]})}return t})();var UM=(()=>{class t{get vertical(){return this._vertical}set vertical(e){this._vertical=su(e)}_vertical=!1;get inset(){return this._inset}set inset(e){this._inset=su(e)}_inset=!1;static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(n,o){n&2&&(un("aria-orientation",o.vertical?"vertical":"horizontal"),Ji("mat-divider-vertical",o.vertical)("mat-divider-horizontal",!o.vertical)("mat-divider-inset",o.inset))},inputs:{vertical:"vertical",inset:"inset"},decls:0,vars:0,template:function(n,o){},styles:[`.mat-divider{display:block;margin:0;border-top-style:solid;border-top-color:var(--mat-divider-color, var(--mat-sys-outline));border-top-width:var(--mat-divider-width, 1px)}.mat-divider.mat-divider-vertical{border-top:0;border-right-style:solid;border-right-color:var(--mat-divider-color, var(--mat-sys-outline));border-right-width:var(--mat-divider-width, 1px)}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}
`],encapsulation:2,changeDetection:0})}return t})(),Sv=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({imports:[Wn,Wn]})}return t})();var _Y=["*",[["mat-chip-avatar"],["","matChipAvatar",""]],[["mat-chip-trailing-icon"],["","matChipRemove",""],["","matChipTrailingIcon",""]]],yY=["*","mat-chip-avatar, [matChipAvatar]","mat-chip-trailing-icon,[matChipRemove],[matChipTrailingIcon]"];function xye(t,i){t&1&&(ae(0,"span",3),On(1,1),se())}function wye(t,i){t&1&&(ae(0,"span",6),On(1,2),se())}function Eye(t,i){t&1&&(ae(0,"span",3),On(1,1),ae(2,"span",8),gs(),ae(3,"svg",9),jt(4,"path",10),se()()())}function Cye(t,i){t&1&&(ae(0,"span",6),On(1,2),se())}var Sye=`.mdc-evolution-chip,.mdc-evolution-chip__cell,.mdc-evolution-chip__action{display:inline-flex;align-items:center}.mdc-evolution-chip{position:relative;max-width:100%}.mdc-evolution-chip__cell,.mdc-evolution-chip__action{height:100%}.mdc-evolution-chip__cell--primary{flex-basis:100%;overflow-x:hidden}.mdc-evolution-chip__cell--trailing{flex:1 0 auto}.mdc-evolution-chip__action{align-items:center;background:none;border:none;box-sizing:content-box;cursor:pointer;display:inline-flex;justify-content:center;outline:none;padding:0;text-decoration:none;color:inherit}.mdc-evolution-chip__action--presentational{cursor:auto}.mdc-evolution-chip--disabled,.mdc-evolution-chip__action:disabled{pointer-events:none}@media(forced-colors: active){.mdc-evolution-chip--disabled,.mdc-evolution-chip__action:disabled{forced-color-adjust:none}}.mdc-evolution-chip__action--primary{font:inherit;letter-spacing:inherit;white-space:inherit;overflow-x:hidden}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary::before{border-width:var(--mdc-chip-outline-width, 1px);border-radius:var(--mdc-chip-container-shape-radius, 8px);box-sizing:border-box;content:"";height:100%;left:0;position:absolute;pointer-events:none;top:0;width:100%;z-index:1;border-style:solid}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__action--primary::before{border-color:var(--mdc-chip-outline-color, var(--mat-sys-outline))}.mdc-evolution-chip__action--primary:not(.mdc-evolution-chip__action--presentational):not(.mdc-ripple-upgraded):focus::before{border-color:var(--mdc-chip-focus-outline-color, var(--mat-sys-on-surface-variant))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__action--primary::before{border-color:var(--mdc-chip-disabled-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-standard-chip.mdc-evolution-chip--selected .mdc-evolution-chip__action--primary::before{border-width:var(--mdc-chip-flat-selected-outline-width, 0)}.mat-mdc-basic-chip .mdc-evolution-chip__action--primary{font:inherit}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}.mdc-evolution-chip__action--trailing{position:relative;overflow:visible}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__action--trailing{color:var(--mdc-chip-with-trailing-icon-trailing-icon-color, var(--mat-sys-on-surface-variant))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__action--trailing{color:var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-color, var(--mat-sys-on-surface))}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}.mdc-evolution-chip__text-label{-webkit-user-select:none;user-select:none;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.mat-mdc-standard-chip .mdc-evolution-chip__text-label{font-family:var(--mdc-chip-label-text-font, var(--mat-sys-label-large-font));line-height:var(--mdc-chip-label-text-line-height, var(--mat-sys-label-large-line-height));font-size:var(--mdc-chip-label-text-size, var(--mat-sys-label-large-size));font-weight:var(--mdc-chip-label-text-weight, var(--mat-sys-label-large-weight));letter-spacing:var(--mdc-chip-label-text-tracking, var(--mat-sys-label-large-tracking))}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__text-label{color:var(--mdc-chip-label-text-color, var(--mat-sys-on-surface-variant))}.mat-mdc-standard-chip.mdc-evolution-chip--selected:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__text-label{color:var(--mdc-chip-selected-label-text-color, var(--mat-sys-on-secondary-container))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label,.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-evolution-chip__graphic{align-items:center;display:inline-flex;justify-content:center;overflow:hidden;pointer-events:none;position:relative;flex:1 0 auto}.mat-mdc-standard-chip .mdc-evolution-chip__graphic{width:var(--mdc-chip-with-avatar-avatar-size, 24px);height:var(--mdc-chip-with-avatar-avatar-size, 24px);font-size:var(--mdc-chip-with-avatar-avatar-size, 24px)}.mdc-evolution-chip--selecting .mdc-evolution-chip__graphic{transition:width 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--selected):not(.mdc-evolution-chip--with-primary-icon) .mdc-evolution-chip__graphic{width:0}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:8px;padding-right:4px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:8px;padding-right:4px}.mdc-evolution-chip__checkmark{position:absolute;opacity:0;top:50%;left:50%;height:20px;width:20px}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color, var(--mat-sys-on-secondary-container))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-disabled-icon-color, var(--mat-sys-on-surface))}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark{transition:transform 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark{transform:translate(-50%, -50%);opacity:1}.mdc-evolution-chip__checkmark-svg{display:block}.mdc-evolution-chip__checkmark-path{stroke-width:2px;stroke-dasharray:29.7833385;stroke-dashoffset:29.7833385;stroke:currentColor}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 45ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}@media(forced-colors: active){.mdc-evolution-chip__checkmark-path{stroke:CanvasText !important}}.mat-mdc-standard-chip .mdc-evolution-chip__icon--trailing{height:18px;width:18px;font-size:18px}.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing.mat-mdc-chip-remove{opacity:calc(var(--mat-chip-trailing-action-opacity, 1)*var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-opacity, 0.38))}.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing.mat-mdc-chip-remove:focus{opacity:calc(var(--mat-chip-trailing-action-focus-opacity, 1)*var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-opacity, 0.38))}.mat-mdc-standard-chip{border-radius:var(--mdc-chip-container-shape-radius, 8px);height:var(--mdc-chip-container-height, 32px)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled){background-color:var(--mdc-chip-elevated-container-color, transparent)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color)}.mat-mdc-standard-chip.mdc-evolution-chip--selected:not(.mdc-evolution-chip--disabled){background-color:var(--mdc-chip-elevated-selected-container-color, var(--mat-sys-secondary-container))}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-flat-disabled-selected-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}@media(forced-colors: active){.mat-mdc-standard-chip{outline:solid 1px}}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{border-radius:var(--mdc-chip-with-avatar-avatar-shape-radius, 24px);width:var(--mdc-chip-with-icon-icon-size, 18px);height:var(--mdc-chip-with-icon-icon-size, 18px);font-size:var(--mdc-chip-with-icon-icon-size, 18px)}.mdc-evolution-chip--selected .mdc-evolution-chip__icon--primary{opacity:0}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-icon-color, var(--mat-sys-on-surface-variant))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-disabled-icon-color, var(--mat-sys-on-surface))}.mat-mdc-chip-highlighted{--mdc-chip-with-icon-icon-color:var(--mdc-chip-with-icon-selected-icon-color, var(--mat-sys-on-secondary-container));--mdc-chip-elevated-container-color:var(--mdc-chip-elevated-selected-container-color, var(--mat-sys-secondary-container));--mdc-chip-label-text-color:var(--mdc-chip-selected-label-text-color, var(--mat-sys-on-secondary-container));--mdc-chip-outline-width:var(--mdc-chip-flat-selected-outline-width, 0)}.mat-mdc-chip-focus-overlay{background:var(--mdc-chip-focus-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-chip-selected .mat-mdc-chip-focus-overlay,.mat-mdc-chip-highlighted .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-selected-focus-state-layer-color, var(--mat-sys-on-secondary-container))}.mat-mdc-chip:hover .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-hover-state-layer-color, var(--mat-sys-on-surface-variant));opacity:var(--mdc-chip-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-chip-focus-overlay .mat-mdc-chip-selected:hover,.mat-mdc-chip-highlighted:hover .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-selected-hover-state-layer-color, var(--mat-sys-on-secondary-container));opacity:var(--mdc-chip-selected-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-chip.cdk-focused .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-focus-state-layer-color, var(--mat-sys-on-surface-variant));opacity:var(--mdc-chip-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-chip-selected.cdk-focused .mat-mdc-chip-focus-overlay,.mat-mdc-chip-highlighted.cdk-focused .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-selected-focus-state-layer-color, var(--mat-sys-on-secondary-container));opacity:var(--mdc-chip-selected-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mdc-evolution-chip--disabled:not(.mdc-evolution-chip--selected) .mat-mdc-chip-avatar{opacity:var(--mdc-chip-with-avatar-disabled-avatar-opacity, 0.38)}.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing{opacity:var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-opacity, 0.38)}.mdc-evolution-chip--disabled.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark{opacity:var(--mdc-chip-with-icon-disabled-icon-opacity, 0.38)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{opacity:var(--mat-chip-disabled-container-opacity, 1)}.mat-mdc-standard-chip.mdc-evolution-chip--selected .mdc-evolution-chip__icon--trailing,.mat-mdc-standard-chip.mat-mdc-chip-highlighted .mdc-evolution-chip__icon--trailing{color:var(--mat-chip-selected-trailing-icon-color, var(--mat-sys-on-secondary-container))}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing,.mat-mdc-standard-chip.mat-mdc-chip-highlighted.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing{color:var(--mat-chip-selected-disabled-trailing-icon-color, var(--mat-sys-on-surface))}.mat-mdc-chip-remove{opacity:var(--mat-chip-trailing-action-opacity, 1)}.mat-mdc-chip-remove:focus{opacity:var(--mat-chip-trailing-action-focus-opacity, 1)}.mat-mdc-chip-remove::after{background-color:var(--mat-chip-trailing-action-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-chip-remove:hover::after{opacity:var(--mat-chip-trailing-action-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-chip-remove:focus::after{opacity:var(--mat-chip-trailing-action-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-chip-selected .mat-mdc-chip-remove::after,.mat-mdc-chip-highlighted .mat-mdc-chip-remove::after{background-color:var(--mat-chip-selected-trailing-action-state-layer-color, var(--mat-sys-on-secondary-container))}.mat-mdc-standard-chip{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mat-mdc-chip-action-label{overflow:visible}.mat-mdc-standard-chip .mat-mdc-chip-graphic,.mat-mdc-standard-chip .mat-mdc-chip-trailing-icon{box-sizing:content-box}.mat-mdc-standard-chip._mat-animation-noopable,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__graphic,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark-path{transition-duration:1ms;animation-duration:1ms}.mat-mdc-chip-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;opacity:0;border-radius:inherit;transition:opacity 150ms linear}._mat-animation-noopable .mat-mdc-chip-focus-overlay{transition:none}.mat-mdc-basic-chip .mat-mdc-chip-focus-overlay{display:none}.mat-mdc-chip .mat-ripple.mat-mdc-chip-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-chip-avatar{text-align:center;line-height:1;color:var(--mdc-chip-with-icon-icon-color, currentColor)}.mat-mdc-chip{position:relative;z-index:0}.mat-mdc-chip-action-label{text-align:left;z-index:1}[dir=rtl] .mat-mdc-chip-action-label{text-align:right}.mat-mdc-chip.mdc-evolution-chip--with-trailing-action .mat-mdc-chip-action-label{position:relative}.mat-mdc-chip-action-label .mat-mdc-chip-primary-focus-indicator{position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none}.mat-mdc-chip-action-label .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-chip-remove::before{margin:calc(var(--mat-focus-indicator-border-width, 3px)*-1);left:8px;right:8px}.mat-mdc-chip-remove::after{content:"";display:block;opacity:0;position:absolute;top:-3px;bottom:-3px;left:5px;right:5px;border-radius:50%;box-sizing:border-box;padding:12px;margin:-12px;background-clip:content-box}.mat-mdc-chip-remove .mat-icon{width:18px;height:18px;font-size:18px;box-sizing:content-box}.mat-chip-edit-input{cursor:text;display:inline-block;color:inherit;outline:0}@media(forced-colors: active){.mat-mdc-chip-selected:not(.mat-mdc-chip-multiple){outline-width:3px}}.mat-mdc-chip-action:focus .mat-focus-indicator::before{content:""}
`;var vY=["*"],Tye=`.mat-mdc-chip-set{display:flex}.mat-mdc-chip-set:focus{outline:none}.mat-mdc-chip-set .mdc-evolution-chip-set__chips{min-width:100%;margin-left:-8px;margin-right:0}.mat-mdc-chip-set .mdc-evolution-chip{margin:4px 0 4px 8px}[dir=rtl] .mat-mdc-chip-set .mdc-evolution-chip-set__chips{margin-left:0;margin-right:-8px}[dir=rtl] .mat-mdc-chip-set .mdc-evolution-chip{margin-left:0;margin-right:8px}.mdc-evolution-chip-set__chips{display:flex;flex-flow:wrap;min-width:0}.mat-mdc-chip-set-stacked{flex-direction:column;align-items:flex-start}.mat-mdc-chip-set-stacked .mat-mdc-chip{width:100%}.mat-mdc-chip-set-stacked .mdc-evolution-chip__graphic{flex-grow:0}.mat-mdc-chip-set-stacked .mdc-evolution-chip__action--primary{flex-basis:100%;justify-content:start}input.mat-mdc-chip-input{flex:1 0 150px;margin-left:8px}[dir=rtl] input.mat-mdc-chip-input{margin-left:0;margin-right:8px}
`,N4=new Ot("mat-chips-default-options",{providedIn:"root",factory:()=>({separatorKeyCodes:[13]})}),fY=new Ot("MatChipAvatar"),mY=new Ot("MatChipTrailingIcon"),gY=new Ot("MatChipRemove"),L4=new Ot("MatChip"),O4=(()=>{class t{_elementRef=J(Qi);_parentChip=J(L4);isInteractive=!0;_isPrimary=!0;get disabled(){return this._disabled||this._parentChip?.disabled||!1}set disabled(e){this._disabled=e}_disabled=!1;tabIndex=-1;_allowFocusWhenDisabled=!1;_getDisabledAttribute(){return this.disabled&&!this._allowFocusWhenDisabled?"":null}_getTabindex(){return this.disabled&&!this._allowFocusWhenDisabled||!this.isInteractive?null:this.tabIndex.toString()}constructor(){J(Vo).load(qd),this._elementRef.nativeElement.nodeName==="BUTTON"&&this._elementRef.nativeElement.setAttribute("type","button")}focus(){this._elementRef.nativeElement.focus()}_handleClick(e){!this.disabled&&this.isInteractive&&this._isPrimary&&(e.preventDefault(),this._parentChip._handlePrimaryActionInteraction())}_handleKeydown(e){(e.keyCode===13||e.keyCode===32)&&!this.disabled&&this.isInteractive&&this._isPrimary&&!this._parentChip._isEditing&&(e.preventDefault(),this._parentChip._handlePrimaryActionInteraction())}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","matChipAction",""]],hostAttrs:[1,"mdc-evolution-chip__action","mat-mdc-chip-action"],hostVars:9,hostBindings:function(n,o){n&1&&Nt("click",function(g){return o._handleClick(g)})("keydown",function(g){return o._handleKeydown(g)}),n&2&&(un("tabindex",o._getTabindex())("disabled",o._getDisabledAttribute())("aria-disabled",o.disabled),Ji("mdc-evolution-chip__action--primary",o._isPrimary)("mdc-evolution-chip__action--presentational",!o.isInteractive)("mdc-evolution-chip__action--trailing",!o._isPrimary))},inputs:{isInteractive:"isInteractive",disabled:[2,"disabled","disabled",Bi],tabIndex:[2,"tabIndex","tabIndex",e=>e==null?-1:bs(e)],_allowFocusWhenDisabled:"_allowFocusWhenDisabled"}})}return t})();var j0=(()=>{class t{_changeDetectorRef=J(vr);_elementRef=J(Qi);_ngZone=J(Oi);_focusMonitor=J(Uu);_globalRippleOptions=J(Iw,{optional:!0});_document=J(cn);_onFocus=new gi;_onBlur=new gi;_isBasicChip;role=null;_hasFocusInternal=!1;_pendingFocus;_actionChanges;_animationsDisabled;_allLeadingIcons;_allTrailingIcons;_allRemoveIcons;_hasFocus(){return this._hasFocusInternal}id=J(po).getId("mat-mdc-chip-");ariaLabel=null;ariaDescription=null;_ariaDescriptionId=`${this.id}-aria-description`;_chipListDisabled=!1;_textElement;get value(){return this._value!==void 0?this._value:this._textElement.textContent.trim()}set value(e){this._value=e}_value;color;removable=!0;highlighted=!1;disableRipple=!1;get disabled(){return this._disabled||this._chipListDisabled}set disabled(e){this._disabled=e}_disabled=!1;removed=new Mi;destroyed=new Mi;basicChipAttrName="mat-basic-chip";leadingIcon;trailingIcon;removeIcon;primaryAction;_rippleLoader=J(XD);_injector=J(wn);constructor(){let e=J(Vo);e.load(qd),e.load(Hu);let n=J(oo,{optional:!0});this._animationsDisabled=n==="NoopAnimations",this._monitorFocus(),this._rippleLoader?.configureRipple(this._elementRef.nativeElement,{className:"mat-mdc-chip-ripple",disabled:this._isRippleDisabled()})}ngOnInit(){let e=this._elementRef.nativeElement;this._isBasicChip=e.hasAttribute(this.basicChipAttrName)||e.tagName.toLowerCase()===this.basicChipAttrName}ngAfterViewInit(){this._textElement=this._elementRef.nativeElement.querySelector(".mat-mdc-chip-action-label"),this._pendingFocus&&(this._pendingFocus=!1,this.focus())}ngAfterContentInit(){this._actionChanges=ks(this._allLeadingIcons.changes,this._allTrailingIcons.changes,this._allRemoveIcons.changes).subscribe(()=>this._changeDetectorRef.markForCheck())}ngDoCheck(){this._rippleLoader.setDisabled(this._elementRef.nativeElement,this._isRippleDisabled())}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement),this._actionChanges?.unsubscribe(),this.destroyed.emit({chip:this}),this.destroyed.complete()}remove(){this.removable&&this.removed.emit({chip:this})}_isRippleDisabled(){return this.disabled||this.disableRipple||this._animationsDisabled||this._isBasicChip||!!this._globalRippleOptions?.disabled}_hasTrailingIcon(){return!!(this.trailingIcon||this.removeIcon)}_handleKeydown(e){(e.keyCode===8&&!e.repeat||e.keyCode===46)&&(e.preventDefault(),this.remove())}focus(){this.disabled||(this.primaryAction?this.primaryAction.focus():this._pendingFocus=!0)}_getSourceAction(e){return this._getActions().find(n=>{let o=n._elementRef.nativeElement;return o===e||o.contains(e)})}_getActions(){let e=[];return this.primaryAction&&e.push(this.primaryAction),this.removeIcon&&e.push(this.removeIcon),this.trailingIcon&&e.push(this.trailingIcon),e}_handlePrimaryActionInteraction(){}_monitorFocus(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{let n=e!==null;n!==this._hasFocusInternal&&(this._hasFocusInternal=n,n?this._onFocus.next({chip:this}):(this._changeDetectorRef.markForCheck(),setTimeout(()=>this._ngZone.run(()=>this._onBlur.next({chip:this})))))})}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-basic-chip"],["","mat-basic-chip",""],["mat-chip"],["","mat-chip",""]],contentQueries:function(n,o,r){if(n&1&&(ao(r,fY,5),ao(r,mY,5),ao(r,gY,5),ao(r,fY,5),ao(r,mY,5),ao(r,gY,5)),n&2){let g;sn(g=ln())&&(o.leadingIcon=g.first),sn(g=ln())&&(o.trailingIcon=g.first),sn(g=ln())&&(o.removeIcon=g.first),sn(g=ln())&&(o._allLeadingIcons=g),sn(g=ln())&&(o._allTrailingIcons=g),sn(g=ln())&&(o._allRemoveIcons=g)}},viewQuery:function(n,o){if(n&1&&pr(O4,5),n&2){let r;sn(r=ln())&&(o.primaryAction=r.first)}},hostAttrs:[1,"mat-mdc-chip"],hostVars:31,hostBindings:function(n,o){n&1&&Nt("keydown",function(g){return o._handleKeydown(g)}),n&2&&(vs("id",o.id),un("role",o.role)("aria-label",o.ariaLabel),ql("mat-"+(o.color||"primary")),Ji("mdc-evolution-chip",!o._isBasicChip)("mdc-evolution-chip--disabled",o.disabled)("mdc-evolution-chip--with-trailing-action",o._hasTrailingIcon())("mdc-evolution-chip--with-primary-graphic",o.leadingIcon)("mdc-evolution-chip--with-primary-icon",o.leadingIcon)("mdc-evolution-chip--with-avatar",o.leadingIcon)("mat-mdc-chip-with-avatar",o.leadingIcon)("mat-mdc-chip-highlighted",o.highlighted)("mat-mdc-chip-disabled",o.disabled)("mat-mdc-basic-chip",o._isBasicChip)("mat-mdc-standard-chip",!o._isBasicChip)("mat-mdc-chip-with-trailing-icon",o._hasTrailingIcon())("_mat-animation-noopable",o._animationsDisabled))},inputs:{role:"role",id:"id",ariaLabel:[0,"aria-label","ariaLabel"],ariaDescription:[0,"aria-description","ariaDescription"],value:"value",color:"color",removable:[2,"removable","removable",Bi],highlighted:[2,"highlighted","highlighted",Bi],disableRipple:[2,"disableRipple","disableRipple",Bi],disabled:[2,"disabled","disabled",Bi]},outputs:{removed:"removed",destroyed:"destroyed"},exportAs:["matChip"],features:[fr([{provide:L4,useExisting:t}])],ngContentSelectors:yY,decls:8,vars:3,consts:[[1,"mat-mdc-chip-focus-overlay"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--primary"],["matChipAction","",3,"isInteractive"],[1,"mdc-evolution-chip__graphic","mat-mdc-chip-graphic"],[1,"mdc-evolution-chip__text-label","mat-mdc-chip-action-label"],[1,"mat-mdc-chip-primary-focus-indicator","mat-focus-indicator"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--trailing"]],template:function(n,o){n&1&&(Qr(_Y),jt(0,"span",0),ae(1,"span",1)(2,"span",2),Tt(3,xye,2,0,"span",3),ae(4,"span",4),On(5),jt(6,"span",5),se()()(),Tt(7,wye,2,0,"span",6)),n&2&&(Se(2),Xe("isInteractive",!1),Se(),zn(o.leadingIcon?3:-1),Se(4),zn(o._hasTrailingIcon()?7:-1))},dependencies:[O4],styles:[`.mdc-evolution-chip,.mdc-evolution-chip__cell,.mdc-evolution-chip__action{display:inline-flex;align-items:center}.mdc-evolution-chip{position:relative;max-width:100%}.mdc-evolution-chip__cell,.mdc-evolution-chip__action{height:100%}.mdc-evolution-chip__cell--primary{flex-basis:100%;overflow-x:hidden}.mdc-evolution-chip__cell--trailing{flex:1 0 auto}.mdc-evolution-chip__action{align-items:center;background:none;border:none;box-sizing:content-box;cursor:pointer;display:inline-flex;justify-content:center;outline:none;padding:0;text-decoration:none;color:inherit}.mdc-evolution-chip__action--presentational{cursor:auto}.mdc-evolution-chip--disabled,.mdc-evolution-chip__action:disabled{pointer-events:none}@media(forced-colors: active){.mdc-evolution-chip--disabled,.mdc-evolution-chip__action:disabled{forced-color-adjust:none}}.mdc-evolution-chip__action--primary{font:inherit;letter-spacing:inherit;white-space:inherit;overflow-x:hidden}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary::before{border-width:var(--mdc-chip-outline-width, 1px);border-radius:var(--mdc-chip-container-shape-radius, 8px);box-sizing:border-box;content:"";height:100%;left:0;position:absolute;pointer-events:none;top:0;width:100%;z-index:1;border-style:solid}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__action--primary::before{border-color:var(--mdc-chip-outline-color, var(--mat-sys-outline))}.mdc-evolution-chip__action--primary:not(.mdc-evolution-chip__action--presentational):not(.mdc-ripple-upgraded):focus::before{border-color:var(--mdc-chip-focus-outline-color, var(--mat-sys-on-surface-variant))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__action--primary::before{border-color:var(--mdc-chip-disabled-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-standard-chip.mdc-evolution-chip--selected .mdc-evolution-chip__action--primary::before{border-width:var(--mdc-chip-flat-selected-outline-width, 0)}.mat-mdc-basic-chip .mdc-evolution-chip__action--primary{font:inherit}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}.mdc-evolution-chip__action--trailing{position:relative;overflow:visible}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__action--trailing{color:var(--mdc-chip-with-trailing-icon-trailing-icon-color, var(--mat-sys-on-surface-variant))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__action--trailing{color:var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-color, var(--mat-sys-on-surface))}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}.mdc-evolution-chip__text-label{-webkit-user-select:none;user-select:none;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.mat-mdc-standard-chip .mdc-evolution-chip__text-label{font-family:var(--mdc-chip-label-text-font, var(--mat-sys-label-large-font));line-height:var(--mdc-chip-label-text-line-height, var(--mat-sys-label-large-line-height));font-size:var(--mdc-chip-label-text-size, var(--mat-sys-label-large-size));font-weight:var(--mdc-chip-label-text-weight, var(--mat-sys-label-large-weight));letter-spacing:var(--mdc-chip-label-text-tracking, var(--mat-sys-label-large-tracking))}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__text-label{color:var(--mdc-chip-label-text-color, var(--mat-sys-on-surface-variant))}.mat-mdc-standard-chip.mdc-evolution-chip--selected:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__text-label{color:var(--mdc-chip-selected-label-text-color, var(--mat-sys-on-secondary-container))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label,.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-evolution-chip__graphic{align-items:center;display:inline-flex;justify-content:center;overflow:hidden;pointer-events:none;position:relative;flex:1 0 auto}.mat-mdc-standard-chip .mdc-evolution-chip__graphic{width:var(--mdc-chip-with-avatar-avatar-size, 24px);height:var(--mdc-chip-with-avatar-avatar-size, 24px);font-size:var(--mdc-chip-with-avatar-avatar-size, 24px)}.mdc-evolution-chip--selecting .mdc-evolution-chip__graphic{transition:width 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--selected):not(.mdc-evolution-chip--with-primary-icon) .mdc-evolution-chip__graphic{width:0}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:8px;padding-right:4px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:8px;padding-right:4px}.mdc-evolution-chip__checkmark{position:absolute;opacity:0;top:50%;left:50%;height:20px;width:20px}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color, var(--mat-sys-on-secondary-container))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-disabled-icon-color, var(--mat-sys-on-surface))}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark{transition:transform 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark{transform:translate(-50%, -50%);opacity:1}.mdc-evolution-chip__checkmark-svg{display:block}.mdc-evolution-chip__checkmark-path{stroke-width:2px;stroke-dasharray:29.7833385;stroke-dashoffset:29.7833385;stroke:currentColor}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 45ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}@media(forced-colors: active){.mdc-evolution-chip__checkmark-path{stroke:CanvasText !important}}.mat-mdc-standard-chip .mdc-evolution-chip__icon--trailing{height:18px;width:18px;font-size:18px}.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing.mat-mdc-chip-remove{opacity:calc(var(--mat-chip-trailing-action-opacity, 1)*var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-opacity, 0.38))}.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing.mat-mdc-chip-remove:focus{opacity:calc(var(--mat-chip-trailing-action-focus-opacity, 1)*var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-opacity, 0.38))}.mat-mdc-standard-chip{border-radius:var(--mdc-chip-container-shape-radius, 8px);height:var(--mdc-chip-container-height, 32px)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled){background-color:var(--mdc-chip-elevated-container-color, transparent)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color)}.mat-mdc-standard-chip.mdc-evolution-chip--selected:not(.mdc-evolution-chip--disabled){background-color:var(--mdc-chip-elevated-selected-container-color, var(--mat-sys-secondary-container))}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-flat-disabled-selected-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}@media(forced-colors: active){.mat-mdc-standard-chip{outline:solid 1px}}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{border-radius:var(--mdc-chip-with-avatar-avatar-shape-radius, 24px);width:var(--mdc-chip-with-icon-icon-size, 18px);height:var(--mdc-chip-with-icon-icon-size, 18px);font-size:var(--mdc-chip-with-icon-icon-size, 18px)}.mdc-evolution-chip--selected .mdc-evolution-chip__icon--primary{opacity:0}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-icon-color, var(--mat-sys-on-surface-variant))}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-disabled-icon-color, var(--mat-sys-on-surface))}.mat-mdc-chip-highlighted{--mdc-chip-with-icon-icon-color:var(--mdc-chip-with-icon-selected-icon-color, var(--mat-sys-on-secondary-container));--mdc-chip-elevated-container-color:var(--mdc-chip-elevated-selected-container-color, var(--mat-sys-secondary-container));--mdc-chip-label-text-color:var(--mdc-chip-selected-label-text-color, var(--mat-sys-on-secondary-container));--mdc-chip-outline-width:var(--mdc-chip-flat-selected-outline-width, 0)}.mat-mdc-chip-focus-overlay{background:var(--mdc-chip-focus-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-chip-selected .mat-mdc-chip-focus-overlay,.mat-mdc-chip-highlighted .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-selected-focus-state-layer-color, var(--mat-sys-on-secondary-container))}.mat-mdc-chip:hover .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-hover-state-layer-color, var(--mat-sys-on-surface-variant));opacity:var(--mdc-chip-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-chip-focus-overlay .mat-mdc-chip-selected:hover,.mat-mdc-chip-highlighted:hover .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-selected-hover-state-layer-color, var(--mat-sys-on-secondary-container));opacity:var(--mdc-chip-selected-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-chip.cdk-focused .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-focus-state-layer-color, var(--mat-sys-on-surface-variant));opacity:var(--mdc-chip-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-chip-selected.cdk-focused .mat-mdc-chip-focus-overlay,.mat-mdc-chip-highlighted.cdk-focused .mat-mdc-chip-focus-overlay{background:var(--mdc-chip-selected-focus-state-layer-color, var(--mat-sys-on-secondary-container));opacity:var(--mdc-chip-selected-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mdc-evolution-chip--disabled:not(.mdc-evolution-chip--selected) .mat-mdc-chip-avatar{opacity:var(--mdc-chip-with-avatar-disabled-avatar-opacity, 0.38)}.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing{opacity:var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-opacity, 0.38)}.mdc-evolution-chip--disabled.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark{opacity:var(--mdc-chip-with-icon-disabled-icon-opacity, 0.38)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{opacity:var(--mat-chip-disabled-container-opacity, 1)}.mat-mdc-standard-chip.mdc-evolution-chip--selected .mdc-evolution-chip__icon--trailing,.mat-mdc-standard-chip.mat-mdc-chip-highlighted .mdc-evolution-chip__icon--trailing{color:var(--mat-chip-selected-trailing-icon-color, var(--mat-sys-on-secondary-container))}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing,.mat-mdc-standard-chip.mat-mdc-chip-highlighted.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing{color:var(--mat-chip-selected-disabled-trailing-icon-color, var(--mat-sys-on-surface))}.mat-mdc-chip-remove{opacity:var(--mat-chip-trailing-action-opacity, 1)}.mat-mdc-chip-remove:focus{opacity:var(--mat-chip-trailing-action-focus-opacity, 1)}.mat-mdc-chip-remove::after{background-color:var(--mat-chip-trailing-action-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-chip-remove:hover::after{opacity:var(--mat-chip-trailing-action-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-chip-remove:focus::after{opacity:var(--mat-chip-trailing-action-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-chip-selected .mat-mdc-chip-remove::after,.mat-mdc-chip-highlighted .mat-mdc-chip-remove::after{background-color:var(--mat-chip-selected-trailing-action-state-layer-color, var(--mat-sys-on-secondary-container))}.mat-mdc-standard-chip{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mat-mdc-chip-action-label{overflow:visible}.mat-mdc-standard-chip .mat-mdc-chip-graphic,.mat-mdc-standard-chip .mat-mdc-chip-trailing-icon{box-sizing:content-box}.mat-mdc-standard-chip._mat-animation-noopable,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__graphic,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark-path{transition-duration:1ms;animation-duration:1ms}.mat-mdc-chip-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;opacity:0;border-radius:inherit;transition:opacity 150ms linear}._mat-animation-noopable .mat-mdc-chip-focus-overlay{transition:none}.mat-mdc-basic-chip .mat-mdc-chip-focus-overlay{display:none}.mat-mdc-chip .mat-ripple.mat-mdc-chip-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-chip-avatar{text-align:center;line-height:1;color:var(--mdc-chip-with-icon-icon-color, currentColor)}.mat-mdc-chip{position:relative;z-index:0}.mat-mdc-chip-action-label{text-align:left;z-index:1}[dir=rtl] .mat-mdc-chip-action-label{text-align:right}.mat-mdc-chip.mdc-evolution-chip--with-trailing-action .mat-mdc-chip-action-label{position:relative}.mat-mdc-chip-action-label .mat-mdc-chip-primary-focus-indicator{position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none}.mat-mdc-chip-action-label .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-chip-remove::before{margin:calc(var(--mat-focus-indicator-border-width, 3px)*-1);left:8px;right:8px}.mat-mdc-chip-remove::after{content:"";display:block;opacity:0;position:absolute;top:-3px;bottom:-3px;left:5px;right:5px;border-radius:50%;box-sizing:border-box;padding:12px;margin:-12px;background-clip:content-box}.mat-mdc-chip-remove .mat-icon{width:18px;height:18px;font-size:18px;box-sizing:content-box}.mat-chip-edit-input{cursor:text;display:inline-block;color:inherit;outline:0}@media(forced-colors: active){.mat-mdc-chip-selected:not(.mat-mdc-chip-multiple){outline-width:3px}}.mat-mdc-chip-action:focus .mat-focus-indicator::before{content:""}
`],encapsulation:2,changeDetection:0})}return t})();var F4=(()=>{class t extends j0{_defaultOptions=J(N4,{optional:!0});chipListSelectable=!0;_chipListMultiple=!1;_chipListHideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1;get selectable(){return this._selectable&&this.chipListSelectable}set selectable(e){this._selectable=e,this._changeDetectorRef.markForCheck()}_selectable=!0;get selected(){return this._selected}set selected(e){this._setSelectedState(e,!1,!0)}_selected=!1;get ariaSelected(){return this.selectable?this.selected.toString():null}basicChipAttrName="mat-basic-chip-option";selectionChange=new Mi;ngOnInit(){super.ngOnInit(),this.role="presentation"}select(){this._setSelectedState(!0,!1,!0)}deselect(){this._setSelectedState(!1,!1,!0)}selectViaInteraction(){this._setSelectedState(!0,!0,!0)}toggleSelected(e=!1){return this._setSelectedState(!this.selected,e,!0),this.selected}_handlePrimaryActionInteraction(){this.disabled||(this.focus(),this.selectable&&this.toggleSelected(!0))}_hasLeadingGraphic(){return this.leadingIcon?!0:!this._chipListHideSingleSelectionIndicator||this._chipListMultiple}_setSelectedState(e,n,o){e!==this.selected&&(this._selected=e,o&&this.selectionChange.emit({source:this,isUserInput:n,selected:this.selected}),this._changeDetectorRef.markForCheck())}static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275cmp=ai({type:t,selectors:[["mat-basic-chip-option"],["","mat-basic-chip-option",""],["mat-chip-option"],["","mat-chip-option",""]],hostAttrs:[1,"mat-mdc-chip","mat-mdc-chip-option"],hostVars:37,hostBindings:function(n,o){n&2&&(vs("id",o.id),un("tabindex",null)("aria-label",null)("aria-description",null)("role",o.role),Ji("mdc-evolution-chip",!o._isBasicChip)("mdc-evolution-chip--filter",!o._isBasicChip)("mdc-evolution-chip--selectable",!o._isBasicChip)("mat-mdc-chip-selected",o.selected)("mat-mdc-chip-multiple",o._chipListMultiple)("mat-mdc-chip-disabled",o.disabled)("mat-mdc-chip-with-avatar",o.leadingIcon)("mdc-evolution-chip--disabled",o.disabled)("mdc-evolution-chip--selected",o.selected)("mdc-evolution-chip--selecting",!o._animationsDisabled)("mdc-evolution-chip--with-trailing-action",o._hasTrailingIcon())("mdc-evolution-chip--with-primary-icon",o.leadingIcon)("mdc-evolution-chip--with-primary-graphic",o._hasLeadingGraphic())("mdc-evolution-chip--with-avatar",o.leadingIcon)("mat-mdc-chip-highlighted",o.highlighted)("mat-mdc-chip-with-trailing-icon",o._hasTrailingIcon()))},inputs:{selectable:[2,"selectable","selectable",Bi],selected:[2,"selected","selected",Bi]},outputs:{selectionChange:"selectionChange"},features:[fr([{provide:j0,useExisting:t},{provide:L4,useExisting:t}]),Fn],ngContentSelectors:yY,decls:10,vars:8,consts:[[1,"mat-mdc-chip-focus-overlay"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--primary"],["matChipAction","","role","option",3,"_allowFocusWhenDisabled"],[1,"mdc-evolution-chip__graphic","mat-mdc-chip-graphic"],[1,"mdc-evolution-chip__text-label","mat-mdc-chip-action-label"],[1,"mat-mdc-chip-primary-focus-indicator","mat-focus-indicator"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--trailing"],[1,"cdk-visually-hidden",3,"id"],[1,"mdc-evolution-chip__checkmark"],["viewBox","-2 -3 30 30","focusable","false","aria-hidden","true",1,"mdc-evolution-chip__checkmark-svg"],["fill","none","stroke","currentColor","d","M1.73,12.91 8.1,19.28 22.79,4.59",1,"mdc-evolution-chip__checkmark-path"]],template:function(n,o){n&1&&(Qr(_Y),jt(0,"span",0),ae(1,"span",1)(2,"button",2),Tt(3,Eye,5,0,"span",3),ae(4,"span",4),On(5),jt(6,"span",5),se()()(),Tt(7,Cye,2,0,"span",6),ae(8,"span",7),Oe(9),se()),n&2&&(Se(2),Xe("_allowFocusWhenDisabled",!0),un("aria-selected",o.ariaSelected)("aria-label",o.ariaLabel)("aria-describedby",o._ariaDescriptionId),Se(),zn(o._hasLeadingGraphic()?3:-1),Se(4),zn(o._hasTrailingIcon()?7:-1),Se(),Xe("id",o._ariaDescriptionId),Se(),En(o.ariaDescription))},dependencies:[O4],styles:[Sye],encapsulation:2,changeDetection:0})}return t})();var Ww=(()=>{class t{_elementRef=J(Qi);_changeDetectorRef=J(vr);_dir=J(aa,{optional:!0});_lastDestroyedFocusedChipIndex=null;_keyManager;_destroyed=new gi;_defaultRole="presentation";get chipFocusChanges(){return this._getChipStream(e=>e._onFocus)}get chipDestroyedChanges(){return this._getChipStream(e=>e.destroyed)}get chipRemovedChanges(){return this._getChipStream(e=>e.removed)}get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._syncChipsState()}_disabled=!1;get empty(){return!this._chips||this._chips.length===0}get role(){return this._explicitRole?this._explicitRole:this.empty?null:this._defaultRole}tabIndex=0;set role(e){this._explicitRole=e}_explicitRole=null;get focused(){return this._hasFocusedChip()}_chips;_chipActions=new Zf;constructor(){}ngAfterViewInit(){this._setUpFocusManagement(),this._trackChipSetChanges(),this._trackDestroyedFocusedChip()}ngOnDestroy(){this._keyManager?.destroy(),this._chipActions.destroy(),this._destroyed.next(),this._destroyed.complete()}_hasFocusedChip(){return this._chips&&this._chips.some(e=>e._hasFocus())}_syncChipsState(){this._chips?.forEach(e=>{e._chipListDisabled=this._disabled,e._changeDetectorRef.markForCheck()})}focus(){}_handleKeydown(e){this._originatesFromChip(e)&&this._keyManager.onKeydown(e)}_isValidIndex(e){return e>=0&&e<this._chips.length}_allowFocusEscape(){let e=this._elementRef.nativeElement.tabIndex;e!==-1&&(this._elementRef.nativeElement.tabIndex=-1,setTimeout(()=>this._elementRef.nativeElement.tabIndex=e))}_getChipStream(e){return this._chips.changes.pipe(ia(null),Za(()=>ks(...this._chips.map(e))))}_originatesFromChip(e){let n=e.target;for(;n&&n!==this._elementRef.nativeElement;){if(n.classList.contains("mat-mdc-chip"))return!0;n=n.parentElement}return!1}_setUpFocusManagement(){this._chips.changes.pipe(ia(this._chips)).subscribe(e=>{let n=[];e.forEach(o=>o._getActions().forEach(r=>n.push(r))),this._chipActions.reset(n),this._chipActions.notifyOnChanges()}),this._keyManager=new Cw(this._chipActions).withVerticalOrientation().withHorizontalOrientation(this._dir?this._dir.value:"ltr").withHomeAndEnd().skipPredicate(e=>this._skipPredicate(e)),this.chipFocusChanges.pipe(_r(this._destroyed)).subscribe(({chip:e})=>{let n=e._getSourceAction(document.activeElement);n&&this._keyManager.updateActiveItem(n)}),this._dir?.change.pipe(_r(this._destroyed)).subscribe(e=>this._keyManager.withHorizontalOrientation(e))}_skipPredicate(e){return!e.isInteractive||e.disabled}_trackChipSetChanges(){this._chips.changes.pipe(ia(null),_r(this._destroyed)).subscribe(()=>{this.disabled&&Promise.resolve().then(()=>this._syncChipsState()),this._redirectDestroyedChipFocus()})}_trackDestroyedFocusedChip(){this.chipDestroyedChanges.pipe(_r(this._destroyed)).subscribe(e=>{let o=this._chips.toArray().indexOf(e.chip);this._isValidIndex(o)&&e.chip._hasFocus()&&(this._lastDestroyedFocusedChipIndex=o)})}_redirectDestroyedChipFocus(){if(this._lastDestroyedFocusedChipIndex!=null){if(this._chips.length){let e=Math.min(this._lastDestroyedFocusedChipIndex,this._chips.length-1),n=this._chips.toArray()[e];n.disabled?this._chips.length===1?this.focus():this._keyManager.setPreviousItemActive():n.focus()}else this.focus();this._lastDestroyedFocusedChipIndex=null}}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-chip-set"]],contentQueries:function(n,o,r){if(n&1&&ao(r,j0,5),n&2){let g;sn(g=ln())&&(o._chips=g)}},hostAttrs:[1,"mat-mdc-chip-set","mdc-evolution-chip-set"],hostVars:1,hostBindings:function(n,o){n&1&&Nt("keydown",function(g){return o._handleKeydown(g)}),n&2&&un("role",o.role)},inputs:{disabled:[2,"disabled","disabled",Bi],role:"role",tabIndex:[2,"tabIndex","tabIndex",e=>e==null?0:bs(e)]},ngContentSelectors:vY,decls:2,vars:0,consts:[["role","presentation",1,"mdc-evolution-chip-set__chips"]],template:function(n,o){n&1&&(Qr(),ae(0,"div",0),On(1),se())},styles:[`.mat-mdc-chip-set{display:flex}.mat-mdc-chip-set:focus{outline:none}.mat-mdc-chip-set .mdc-evolution-chip-set__chips{min-width:100%;margin-left:-8px;margin-right:0}.mat-mdc-chip-set .mdc-evolution-chip{margin:4px 0 4px 8px}[dir=rtl] .mat-mdc-chip-set .mdc-evolution-chip-set__chips{margin-left:0;margin-right:-8px}[dir=rtl] .mat-mdc-chip-set .mdc-evolution-chip{margin-left:0;margin-right:8px}.mdc-evolution-chip-set__chips{display:flex;flex-flow:wrap;min-width:0}.mat-mdc-chip-set-stacked{flex-direction:column;align-items:flex-start}.mat-mdc-chip-set-stacked .mat-mdc-chip{width:100%}.mat-mdc-chip-set-stacked .mdc-evolution-chip__graphic{flex-grow:0}.mat-mdc-chip-set-stacked .mdc-evolution-chip__action--primary{flex-basis:100%;justify-content:start}input.mat-mdc-chip-input{flex:1 0 150px;margin-left:8px}[dir=rtl] input.mat-mdc-chip-input{margin-left:0;margin-right:8px}
`],encapsulation:2,changeDetection:0})}return t})(),P4=class{source;value;constructor(i,e){this.source=i,this.value=e}},Dye={provide:qh,useExisting:Ka(()=>z4),multi:!0},z4=(()=>{class t extends Ww{_onTouched=()=>{};_onChange=()=>{};_defaultRole="listbox";_defaultOptions=J(N4,{optional:!0});get multiple(){return this._multiple}set multiple(e){this._multiple=e,this._syncListboxProperties()}_multiple=!1;get selected(){let e=this._chips.toArray().filter(n=>n.selected);return this.multiple?e:e[0]}ariaOrientation="horizontal";get selectable(){return this._selectable}set selectable(e){this._selectable=e,this._syncListboxProperties()}_selectable=!0;compareWith=(e,n)=>e===n;required=!1;get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(e){this._hideSingleSelectionIndicator=e,this._syncListboxProperties()}_hideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1;get chipSelectionChanges(){return this._getChipStream(e=>e.selectionChange)}get chipBlurChanges(){return this._getChipStream(e=>e._onBlur)}get value(){return this._value}set value(e){this._chips&&this._chips.length&&this._setSelectionByValue(e,!1),this._value=e}_value;change=new Mi;_chips=void 0;ngAfterContentInit(){this._chips.changes.pipe(ia(null),_r(this._destroyed)).subscribe(()=>{this.value!==void 0&&Promise.resolve().then(()=>{this._setSelectionByValue(this.value,!1)}),this._syncListboxProperties()}),this.chipBlurChanges.pipe(_r(this._destroyed)).subscribe(()=>this._blur()),this.chipSelectionChanges.pipe(_r(this._destroyed)).subscribe(e=>{this.multiple||this._chips.forEach(n=>{n!==e.source&&n._setSelectedState(!1,!1,!1)}),e.isUserInput&&this._propagateChanges()})}focus(){if(this.disabled)return;let e=this._getFirstSelectedChip();e&&!e.disabled?e.focus():this._chips.length>0?this._keyManager.setFirstItemActive():this._elementRef.nativeElement.focus()}writeValue(e){e!=null?this.value=e:this.value=void 0}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_setSelectionByValue(e,n=!0){this._clearSelection(),Array.isArray(e)?e.forEach(o=>this._selectValue(o,n)):this._selectValue(e,n)}_blur(){this.disabled||setTimeout(()=>{this.focused||this._markAsTouched()})}_keydown(e){e.keyCode===9&&super._allowFocusEscape()}_markAsTouched(){this._onTouched(),this._changeDetectorRef.markForCheck()}_propagateChanges(){let e=null;Array.isArray(this.selected)?e=this.selected.map(n=>n.value):e=this.selected?this.selected.value:void 0,this._value=e,this.change.emit(new P4(this,e)),this._onChange(e),this._changeDetectorRef.markForCheck()}_clearSelection(e){this._chips.forEach(n=>{n!==e&&n.deselect()})}_selectValue(e,n){let o=this._chips.find(r=>r.value!=null&&this.compareWith(r.value,e));return o&&(n?o.selectViaInteraction():o.select()),o}_syncListboxProperties(){this._chips&&Promise.resolve().then(()=>{this._chips.forEach(e=>{e._chipListMultiple=this.multiple,e.chipListSelectable=this._selectable,e._chipListHideSingleSelectionIndicator=this.hideSingleSelectionIndicator,e._changeDetectorRef.markForCheck()})})}_getFirstSelectedChip(){return Array.isArray(this.selected)?this.selected.length?this.selected[0]:void 0:this.selected}_skipPredicate(e){return!e.isInteractive}static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275cmp=ai({type:t,selectors:[["mat-chip-listbox"]],contentQueries:function(n,o,r){if(n&1&&ao(r,F4,5),n&2){let g;sn(g=ln())&&(o._chips=g)}},hostAttrs:[1,"mdc-evolution-chip-set","mat-mdc-chip-listbox"],hostVars:10,hostBindings:function(n,o){n&1&&Nt("focus",function(){return o.focus()})("blur",function(){return o._blur()})("keydown",function(g){return o._keydown(g)}),n&2&&(vs("tabIndex",o.disabled||o.empty?-1:o.tabIndex),un("role",o.role)("aria-required",o.role?o.required:null)("aria-disabled",o.disabled.toString())("aria-multiselectable",o.multiple)("aria-orientation",o.ariaOrientation),Ji("mat-mdc-chip-list-disabled",o.disabled)("mat-mdc-chip-list-required",o.required))},inputs:{multiple:[2,"multiple","multiple",Bi],ariaOrientation:[0,"aria-orientation","ariaOrientation"],selectable:[2,"selectable","selectable",Bi],compareWith:"compareWith",required:[2,"required","required",Bi],hideSingleSelectionIndicator:[2,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",Bi],value:"value"},outputs:{change:"change"},features:[fr([Dye]),Fn],ngContentSelectors:vY,decls:2,vars:0,consts:[["role","presentation",1,"mdc-evolution-chip-set__chips"]],template:function(n,o){n&1&&(Qr(),ae(0,"div",0),On(1),se())},styles:[Tye],encapsulation:2,changeDetection:0})}return t})();var Tv=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({providers:[xv,{provide:N4,useValue:{separatorKeyCodes:[13]}}],imports:[Wn,hv,Wn]})}return t})();var Mye=["determinateSpinner"];function Iye(t,i){if(t&1&&(gs(),ae(0,"svg",11),jt(1,"circle",12),se()),t&2){let e=zt();un("viewBox",e._viewBox()),Se(),Pu("stroke-dasharray",e._strokeCircumference(),"px")("stroke-dashoffset",e._strokeCircumference()/2,"px")("stroke-width",e._circleStrokeWidth(),"%"),un("r",e._circleRadius())}}var Aye=new Ot("mat-progress-spinner-default-options",{providedIn:"root",factory:Rye});function Rye(){return{diameter:bY}}var bY=100,kye=10,Ku=(()=>{class t{_elementRef=J(Qi);_noopAnimations;get color(){return this._color||this._defaultColor}set color(e){this._color=e}_color;_defaultColor="primary";_determinateCircle;constructor(){let e=J(oo,{optional:!0}),n=J(Aye);this._noopAnimations=e==="NoopAnimations"&&!!n&&!n._forceAnimations,this.mode=this._elementRef.nativeElement.nodeName.toLowerCase()==="mat-spinner"?"indeterminate":"determinate",n&&(n.color&&(this.color=this._defaultColor=n.color),n.diameter&&(this.diameter=n.diameter),n.strokeWidth&&(this.strokeWidth=n.strokeWidth))}mode;get value(){return this.mode==="determinate"?this._value:0}set value(e){this._value=Math.max(0,Math.min(100,e||0))}_value=0;get diameter(){return this._diameter}set diameter(e){this._diameter=e||0}_diameter=bY;get strokeWidth(){return this._strokeWidth??this.diameter/10}set strokeWidth(e){this._strokeWidth=e||0}_strokeWidth;_circleRadius(){return(this.diameter-kye)/2}_viewBox(){let e=this._circleRadius()*2+this.strokeWidth;return`0 0 ${e} ${e}`}_strokeCircumference(){return 2*Math.PI*this._circleRadius()}_strokeDashOffset(){return this.mode==="determinate"?this._strokeCircumference()*(100-this._value)/100:null}_circleStrokeWidth(){return this.strokeWidth/this.diameter*100}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-progress-spinner"],["mat-spinner"]],viewQuery:function(n,o){if(n&1&&pr(Mye,5),n&2){let r;sn(r=ln())&&(o._determinateCircle=r.first)}},hostAttrs:["role","progressbar","tabindex","-1",1,"mat-mdc-progress-spinner","mdc-circular-progress"],hostVars:18,hostBindings:function(n,o){n&2&&(un("aria-valuemin",0)("aria-valuemax",100)("aria-valuenow",o.mode==="determinate"?o.value:null)("mode",o.mode),ql("mat-"+o.color),Pu("width",o.diameter,"px")("height",o.diameter,"px")("--mdc-circular-progress-size",o.diameter+"px")("--mdc-circular-progress-active-indicator-width",o.diameter+"px"),Ji("_mat-animation-noopable",o._noopAnimations)("mdc-circular-progress--indeterminate",o.mode==="indeterminate"))},inputs:{color:"color",mode:"mode",value:[2,"value","value",bs],diameter:[2,"diameter","diameter",bs],strokeWidth:[2,"strokeWidth","strokeWidth",bs]},exportAs:["matProgressSpinner"],decls:14,vars:11,consts:[["circle",""],["determinateSpinner",""],["aria-hidden","true",1,"mdc-circular-progress__determinate-container"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__determinate-circle-graphic"],["cx","50%","cy","50%",1,"mdc-circular-progress__determinate-circle"],["aria-hidden","true",1,"mdc-circular-progress__indeterminate-container"],[1,"mdc-circular-progress__spinner-layer"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-left"],[3,"ngTemplateOutlet"],[1,"mdc-circular-progress__gap-patch"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-right"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__indeterminate-circle-graphic"],["cx","50%","cy","50%"]],template:function(n,o){if(n&1&&(Tt(0,Iye,2,8,"ng-template",null,0,rm),ae(2,"div",2,1),gs(),ae(4,"svg",3),jt(5,"circle",4),se()(),Jg(),ae(6,"div",5)(7,"div",6)(8,"div",7),ys(9,8),se(),ae(10,"div",9),ys(11,8),se(),ae(12,"div",10),ys(13,8),se()()()),n&2){let r=Ca(1);Se(4),un("viewBox",o._viewBox()),Se(),Pu("stroke-dasharray",o._strokeCircumference(),"px")("stroke-dashoffset",o._strokeDashOffset(),"px")("stroke-width",o._circleStrokeWidth(),"%"),un("r",o._circleRadius()),Se(4),Xe("ngTemplateOutlet",r),Se(2),Xe("ngTemplateOutlet",r),Se(2),Xe("ngTemplateOutlet",r)}},dependencies:[wx],styles:[`.mat-mdc-progress-spinner{display:block;overflow:hidden;line-height:0;position:relative;direction:ltr;transition:opacity 250ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-progress-spinner circle{stroke-width:var(--mdc-circular-progress-active-indicator-width, 4px)}.mat-mdc-progress-spinner._mat-animation-noopable,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__determinate-circle{transition:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__spinner-layer,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container{animation:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container circle{stroke-dasharray:0 !important}@media(forced-colors: active){.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle{stroke:currentColor;stroke:CanvasText}}.mdc-circular-progress__determinate-container,.mdc-circular-progress__indeterminate-circle-graphic,.mdc-circular-progress__indeterminate-container,.mdc-circular-progress__spinner-layer{position:absolute;width:100%;height:100%}.mdc-circular-progress__determinate-container{transform:rotate(-90deg)}.mdc-circular-progress--indeterminate .mdc-circular-progress__determinate-container{opacity:0}.mdc-circular-progress__indeterminate-container{font-size:0;letter-spacing:0;white-space:nowrap;opacity:0}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{opacity:1;animation:mdc-circular-progress-container-rotate 1568.2352941176ms linear infinite}.mdc-circular-progress__determinate-circle-graphic,.mdc-circular-progress__indeterminate-circle-graphic{fill:rgba(0,0,0,0)}.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:var(--mdc-circular-progress-active-indicator-color, var(--mat-sys-primary))}@media(forced-colors: active){.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mdc-circular-progress__determinate-circle{transition:stroke-dashoffset 500ms cubic-bezier(0, 0, 0.2, 1)}.mdc-circular-progress__gap-patch{position:absolute;top:0;left:47.5%;box-sizing:border-box;width:5%;height:100%;overflow:hidden}.mdc-circular-progress__gap-patch .mdc-circular-progress__indeterminate-circle-graphic{left:-900%;width:2000%;transform:rotate(180deg)}.mdc-circular-progress__circle-clipper .mdc-circular-progress__indeterminate-circle-graphic{width:200%}.mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{left:-100%}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-left .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress__circle-clipper{display:inline-flex;position:relative;width:50%;height:100%;overflow:hidden}.mdc-circular-progress--indeterminate .mdc-circular-progress__spinner-layer{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}@keyframes mdc-circular-progress-container-rotate{to{transform:rotate(360deg)}}@keyframes mdc-circular-progress-spinner-layer-rotate{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes mdc-circular-progress-left-spin{from{transform:rotate(265deg)}50%{transform:rotate(130deg)}to{transform:rotate(265deg)}}@keyframes mdc-circular-progress-right-spin{from{transform:rotate(-265deg)}50%{transform:rotate(-130deg)}to{transform:rotate(-265deg)}}
`],encapsulation:2,changeDetection:0})}return t})();var Zh=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({imports:[Wn]})}return t})();var Oye=()=>[5,10,25],Pye=(t,i,e,n)=>({"status-pending":t,"status-rejected":i,"status-verified":e,"status-resolved":n});function Nye(t,i){if(t&1&&(ae(0,"mat-option",8),Oe(1),se()),t&2){let e=i.$implicit;Xe("value",e),Se(),an(" ",e," ")}}function Lye(t,i){t&1&&(ae(0,"div",9),jt(1,"mat-spinner",10),se())}function Fye(t,i){t&1&&(ae(0,"th",25),Oe(1,"T\xEDtulo"),se())}function zye(t,i){if(t&1&&(ae(0,"td",26),Oe(1),se()),t&2){let e=i.$implicit;Se(),En(e.title)}}function Bye(t,i){t&1&&(ae(0,"th",25),Oe(1,"Descripci\xF3n"),se())}function Vye(t,i){if(t&1&&(ae(0,"td",26),Oe(1),se()),t&2){let e=i.$implicit;Se(),En(e.description)}}function jye(t,i){t&1&&(ae(0,"th",25),Oe(1,"Categor\xEDas"),se())}function Uye(t,i){if(t&1&&(ae(0,"mat-chip"),Oe(1),se()),t&2){let e=i.$implicit;Se(),En(e.name)}}function Hye(t,i){if(t&1&&(ae(0,"td",26)(1,"mat-chip-set"),Tt(2,Uye,2,1,"mat-chip",27),se()()),t&2){let e=i.$implicit;Se(2),Xe("ngForOf",e.categoryList)}}function qye(t,i){t&1&&(ae(0,"th",25),Oe(1,"Ubicaci\xF3n"),se())}function $ye(t,i){if(t&1&&(ae(0,"td",26),Oe(1),se()),t&2){let e=i.$implicit;Se(),kh(" ",e.latitude,", ",e.longitude," ")}}function Gye(t,i){t&1&&(ae(0,"th",25),Oe(1,"Estado"),se())}function Wye(t,i){if(t&1&&(ae(0,"td",26)(1,"span",28),Oe(2),se()()),t&2){let e=i.$implicit;Se(),Xe("ngClass",jS(2,Pye,e.reportStatus==="PENDING",e.reportStatus==="REJECTED",e.reportStatus==="VERIFIED",e.reportStatus==="RESOLVED")),Se(),an(" ",e.reportStatus," ")}}function Zye(t,i){t&1&&(ae(0,"th",25),Oe(1,"Fecha Creaci\xF3n"),se())}function Yye(t,i){if(t&1&&(ae(0,"td",26),Oe(1),bc(2,"date"),se()),t&2){let e=i.$implicit;Se(),an(" ",Oh(2,1,e.createdAt,"short")," ")}}function Kye(t,i){t&1&&(ae(0,"th",25),Oe(1,"Votos"),se())}function Xye(t,i){if(t&1&&(ae(0,"td",26),Oe(1),se()),t&2){let e=i.$implicit;Se(),En(e.importantVotes)}}function Qye(t,i){t&1&&(ae(0,"th",25),Oe(1,"Acciones"),se())}function Jye(t,i){if(t&1){let e=zi();Xn(0),ae(1,"button",29),Nt("click",function(){ri(e);let o=zt().$implicit,r=zt(2);return oi(r.verifyReport(o.id))}),ae(2,"mat-icon"),Oe(3,"check"),se(),Oe(4," Verificar "),se(),ae(5,"button",30),Nt("click",function(){ri(e);let o=zt().$implicit,r=zt(2);return oi(r.rejectReport(o.id))}),ae(6,"mat-icon"),Oe(7,"close"),se(),Oe(8," Rechazar "),se(),Qn()}}function eve(t,i){if(t&1){let e=zi();Xn(0),ae(1,"button",29),Nt("click",function(){ri(e);let o=zt().$implicit,r=zt(2);return oi(r.verifyReport(o.id))}),ae(2,"mat-icon"),Oe(3,"check"),se(),Oe(4," Verificar "),se(),Qn()}}function tve(t,i){if(t&1){let e=zi();Xn(0),ae(1,"button",31),Nt("click",function(){ri(e);let o=zt().$implicit,r=zt(2);return oi(r.resolveReport(o.id))}),ae(2,"mat-icon"),Oe(3,"done_all"),se(),Oe(4," Resolver "),se(),Qn()}}function ive(t,i){if(t&1&&(ae(0,"td",26),Tt(1,Jye,9,0,"ng-container",7)(2,eve,5,0,"ng-container",7)(3,tve,5,0,"ng-container",7),se()),t&2){let e=i.$implicit;Se(),Xe("ngIf",e.reportStatus==="PENDING"),Se(),Xe("ngIf",e.reportStatus==="REJECTED"),Se(),Xe("ngIf",e.reportStatus==="VERIFIED")}}function nve(t,i){t&1&&jt(0,"tr",32)}function rve(t,i){t&1&&jt(0,"tr",33)}function ove(t,i){if(t&1){let e=zi();ae(0,"div")(1,"table",11),Xn(2,12),Tt(3,Fye,2,0,"th",13)(4,zye,2,1,"td",14),Qn(),Xn(5,15),Tt(6,Bye,2,0,"th",13)(7,Vye,2,1,"td",14),Qn(),Xn(8,16),Tt(9,jye,2,0,"th",13)(10,Hye,3,1,"td",14),Qn(),Xn(11,17),Tt(12,qye,2,0,"th",13)(13,$ye,2,2,"td",14),Qn(),Xn(14,18),Tt(15,Gye,2,0,"th",13)(16,Wye,3,7,"td",14),Qn(),Xn(17,19),Tt(18,Zye,2,0,"th",13)(19,Yye,3,4,"td",14),Qn(),Xn(20,20),Tt(21,Kye,2,0,"th",13)(22,Xye,2,1,"td",14),Qn(),Xn(23,21),Tt(24,Qye,2,0,"th",13)(25,ive,4,3,"td",14),Qn(),Tt(26,nve,1,0,"tr",22)(27,rve,1,0,"tr",23),se(),ae(28,"mat-paginator",24),Nt("page",function(o){ri(e);let r=zt();return oi(r.onPageChange(o))}),se()()}if(t&2){let e=zt();Se(),Xe("dataSource",e.filteredContent()),Se(25),Xe("matHeaderRowDef",e.displayedColumns),Se(),Xe("matRowDefColumns",e.displayedColumns),Se(),Xe("length",e.paginatedData().totalElements)("pageSize",e.paginatedData().size)("pageIndex",e.paginatedData().page-1)("pageSizeOptions",Py(7,Oye))}}var HM=class t{reportService=J(Mc);notificationService=J(fo);dialog=J(lu);loading=ma(!1);paginatedData=ma({content:[],page:0,size:10,totalElements:0,totalPages:0});router=J($n);statuses=["PENDING","VERIFIED","REJECTED","RESOLVED"];selectedStatus=ma("");filteredContent=wc(()=>{let i=this.paginatedData().content,e=this.selectedStatus();return e?i.filter(n=>n.reportStatus===e):i});displayedColumns=["title","description","categories","location","reportStatus","dateCreation","importantVotes","actions"];ngOnInit(){this.loadReports(1,10)}loadReports(i,e,n=""){this.loading.set(!0),this.reportService.getAllReportsPaginated(i,e,n).subscribe({next:o=>this.paginatedData.set(o),error:o=>{},complete:()=>this.loading.set(!1)})}verifyReport(i){if(!i)return;let e={title:"Verificar reporte",message:"\xBFSeguro que deseas verificar este reporte?",confirmText:"Verificar",cancelText:"Cancelar"};this.dialog.open(Zl,{data:e}).afterClosed().subscribe(n=>{n===!0&&this.reportService.updateReportStatus(i,"VERIFIED").subscribe({next:()=>{this.notificationService.success("\u2705 Reporte verificado correctamente."),this.loadReports(1,10)},error:o=>{console.error("\u274C Error al verificar reporte:",o),this.notificationService.error("Ocurri\xF3 un error al verificar el reporte.")}})})}rejectReport(i){if(!i)return;let e={title:"Rechazar reporte",message:"Por favor, indica el motivo del rechazo:",confirmText:"Rechazar",cancelText:"Cancelar",input:!0,inputPlaceholder:"Motivo de rechazo\u2026"};this.dialog.open(Zl,{data:e}).afterClosed().subscribe(n=>{typeof n=="string"&&this.reportService.updateReportStatus(i,"REJECTED",n).subscribe({next:()=>{this.notificationService.success("\u2705 Reporte rechazado correctamente."),this.loadReports(1,10)},error:o=>{console.error("\u274C Error al rechazar reporte:",o),this.notificationService.error("Ocurri\xF3 un error al rechazar el reporte.")}})})}resolveReport(i){if(!i)return;let e={title:"Resolver reporte",message:"\xBFDeseas marcar este reporte como resuelto?",confirmText:"Resolver",cancelText:"Cancelar"};this.dialog.open(Zl,{data:e}).afterClosed().subscribe(n=>{n===!0&&this.reportService.updateReportStatus(i,"RESOLVED").subscribe({next:()=>{this.notificationService.success("\u2705 Reporte marcado como resuelto."),this.loadReports(1,10)},error:o=>{console.error("\u274C Error al resolver reporte:",o),this.notificationService.error("Ocurri\xF3 un error al resolver el reporte.")}})})}onPageChange(i){let e=i.pageIndex+1,n=i.pageSize;this.loadReports(e,n,this.selectedStatus())}onStatusChange(i){this.selectedStatus.set(i),this.loadReports(1,this.paginatedData().size,i)}goBack(){this.router.navigate(["/map"])}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ai({type:t,selectors:[["app-report-list"]],decls:16,vars:4,consts:[["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],[1,"contenedor"],["appearance","outline",1,"status-filter"],[3,"selectionChange","value"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","loading-container",4,"ngIf"],[4,"ngIf"],[3,"value"],[1,"loading-container"],["diameter","50"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","title"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","categories"],["matColumnDef","location"],["matColumnDef","reportStatus"],["matColumnDef","dateCreation"],["matColumnDef","importantVotes"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Seleccionar p\xE1gina",3,"page","length","pageSize","pageIndex","pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],[4,"ngFor","ngForOf"],[3,"ngClass"],["mat-raised-button","","color","primary",1,"action-button",3,"click"],["mat-raised-button","","color","warn",1,"action-button",3,"click"],["mat-raised-button","","color","accent",1,"action-button",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,n){e&1&&(ae(0,"button",0),Nt("click",function(){return n.goBack()}),ae(1,"mat-icon"),Oe(2,"arrow_back"),se()(),ae(3,"mat-card",1)(4,"h1"),Oe(5,"Listado de reportes"),se(),jt(6,"mat-divider"),ae(7,"mat-form-field",2)(8,"mat-label"),Oe(9,"Filtrar por estado"),se(),ae(10,"mat-select",3),Nt("selectionChange",function(r){return n.onStatusChange(r.value)}),ae(11,"mat-option",4),Oe(12,"Todos"),se(),Tt(13,Nye,2,2,"mat-option",5),se()(),Tt(14,Lye,2,0,"div",6)(15,ove,29,8,"div",7),se()),e&2&&(Se(10),Xe("value",n.selectedStatus()),Se(3),Xe("ngForOf",n.statuses),Se(),Xe("ngIf",n.loading()),Se(),Xe("ngIf",!n.loading()))},dependencies:[Or,Js,bl,Er,Ld,El,du,Zd,Kd,Zp,Yd,Zh,Ku,Fm,Dm,Im,Om,Am,Mm,Pm,Rm,km,Nm,Lm,Ev,V0,Yu,Zu,Sv,UM,Tv,j0,Ww,rs,Uo],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c;--resolve-color: #26a69a;--table-header-bg: #d0eaf5;--table-row-hover: #f2faff}mat-card[_ngcontent-%COMP%]{margin:2rem auto;padding:1.5rem;background:var(--input-bg);box-shadow:0 4px 20px #0000001a;border-radius:12px}mat-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:.5rem;color:var(--primary-dark);font-weight:600;font-size:24px}.status-filter[_ngcontent-%COMP%]{width:250px;margin:1.5rem 0}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:50px 0}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background-color:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px #0000000d}th.mat-header-cell[_ngcontent-%COMP%]{background-color:var(--table-header-bg);color:var(--primary-dark);font-weight:600;padding:12px;border-bottom:1px solid #ccc}td.mat-cell[_ngcontent-%COMP%]{padding:12px 16px;color:#333;border-bottom:1px solid #eee}tr.mat-row[_ngcontent-%COMP%]:hover{background-color:var(--table-row-hover);transition:background-color .2s ease-in-out}mat-chip[_ngcontent-%COMP%]{background-color:var(--primary-accent);color:#fff;font-weight:500;margin-right:5px}.status-pending[_ngcontent-%COMP%], .status-rejected[_ngcontent-%COMP%], .status-verified[_ngcontent-%COMP%], .status-resolved[_ngcontent-%COMP%]{display:inline-block;padding:6px 10px;border-radius:4px;font-weight:600;font-size:13px}.status-pending[_ngcontent-%COMP%]{background-color:#fff59d;color:#444}.status-rejected[_ngcontent-%COMP%]{background-color:#ef9a9a;color:#fff}.status-verified[_ngcontent-%COMP%]{background-color:#a5d6a7;color:#fff}.status-resolved[_ngcontent-%COMP%]{background-color:#81d4fa;color:#fff}td.mat-cell[_ngcontent-%COMP%] > ng-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:8px 0}.action-button[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;gap:6px;height:36px;width:120px;padding:0 12px;font-size:13px;font-weight:500;line-height:1;border-radius:6px;box-shadow:0 2px 4px #0000001a;text-transform:none;box-sizing:border-box;transition:background-color .2s ease,box-shadow .2s ease}.action-button[color=primary][_ngcontent-%COMP%]{background-color:var(--primary-accent);color:#000}.action-button[color=primary][_ngcontent-%COMP%]:hover{background-color:#1e8e81;box-shadow:0 3px 6px #00000026;color:#fff}.action-button[color=warn][_ngcontent-%COMP%]{background-color:var(--error-color);color:#000}.action-button[color=warn][_ngcontent-%COMP%]:hover{background-color:#ac1e08;color:#fff}.action-button[color=accent][_ngcontent-%COMP%]{background-color:var(--resolve-color);color:#000}.action-button[color=accent][_ngcontent-%COMP%]:hover{background-color:#5fa2c9;color:#fff}.action-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;line-height:1}mat-paginator[_ngcontent-%COMP%]{margin-top:1.5rem;background:transparent}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;width:40px;height:40px;padding:0;background-color:#fff;border:1px solid #ccc;border-radius:8px;box-shadow:0 4px 12px #0000000d;display:flex;align-items:center;justify-content:center;transition:background-color .2s ease,transform .1s ease}.back-button[_ngcontent-%COMP%]:hover{background-color:#f9f9f9;transform:translate(-2px)}.back-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;color:#0009}"]})};var ave=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["ng-component"]],hostAttrs:["cdk-text-field-style-loader",""],decls:0,vars:0,template:function(n,o){},styles:[`textarea.cdk-textarea-autosize{resize:none}textarea.cdk-textarea-autosize-measuring{padding:2px 0 !important;box-sizing:content-box !important;height:auto !important;overflow:hidden !important}textarea.cdk-textarea-autosize-measuring-firefox{padding:2px 0 !important;box-sizing:content-box !important;height:0 !important}@keyframes cdk-text-field-autofill-start{/*!*/}@keyframes cdk-text-field-autofill-end{/*!*/}.cdk-text-field-autofill-monitored:-webkit-autofill{animation:cdk-text-field-autofill-start 0s 1ms}.cdk-text-field-autofill-monitored:not(:-webkit-autofill){animation:cdk-text-field-autofill-end 0s 1ms}
`],encapsulation:2,changeDetection:0})}return t})(),sve={passive:!0},xY=(()=>{class t{_platform=J(Pr);_ngZone=J(Oi);_renderer=J(Fa).createRenderer(null,null);_styleLoader=J(Vo);_monitoredElements=new Map;constructor(){}monitor(e){if(!this._platform.isBrowser)return Rs;this._styleLoader.load(ave);let n=ou(e),o=this._monitoredElements.get(n);if(o)return o.subject;let r=new gi,g="cdk-text-field-autofilled",w=k=>{k.animationName==="cdk-text-field-autofill-start"&&!n.classList.contains(g)?(n.classList.add(g),this._ngZone.run(()=>r.next({target:k.target,isAutofilled:!0}))):k.animationName==="cdk-text-field-autofill-end"&&n.classList.contains(g)&&(n.classList.remove(g),this._ngZone.run(()=>r.next({target:k.target,isAutofilled:!1})))},T=this._ngZone.runOutsideAngular(()=>(n.classList.add("cdk-text-field-autofill-monitored"),Sa(this._renderer,n,"animationstart",w,sve)));return this._monitoredElements.set(n,{subject:r,unlisten:T}),r}stopMonitoring(e){let n=ou(e),o=this._monitoredElements.get(n);o&&(o.unlisten(),o.subject.complete(),n.classList.remove("cdk-text-field-autofill-monitored"),n.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(n))}ngOnDestroy(){this._monitoredElements.forEach((e,n)=>this.stopMonitoring(n))}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var wY=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({})}return t})();var qM=new Ot("MAT_INPUT_VALUE_ACCESSOR");var lve=["button","checkbox","file","hidden","image","radio","range","reset","submit"],cve=new Ot("MAT_INPUT_CONFIG"),Dv=(()=>{class t{_elementRef=J(Qi);_platform=J(Pr);ngControl=J(cu,{optional:!0,self:!0});_autofillMonitor=J(xY);_ngZone=J(Oi);_formField=J(zm,{optional:!0});_renderer=J(Ko);_uid=J(po).getId("mat-input-");_previousNativeValue;_inputValueAccessor;_signalBasedValueAccessor;_previousPlaceholder;_errorStateTracker;_config=J(cve,{optional:!0});_cleanupIosKeyup;_cleanupWebkitWheel;_formFieldDescribedBy;_isServer;_isNativeSelect;_isTextarea;_isInFormField;focused=!1;stateChanges=new gi;controlType="mat-input";autofilled=!1;get disabled(){return this._disabled}set disabled(e){this._disabled=su(e),this.focused&&(this.focused=!1,this.stateChanges.next())}_disabled=!1;get id(){return this._id}set id(e){this._id=e||this._uid}_id;placeholder;name;get required(){return this._required??this.ngControl?.control?.hasValidator(Ti.required)??!1}set required(e){this._required=su(e)}_required;get type(){return this._type}set type(e){let n=this._type;this._type=e||"text",this._validateType(),!this._isTextarea&&BL().has(this._type)&&(this._elementRef.nativeElement.type=this._type),this._type!==n&&this._ensureWheelDefaultBehavior()}_type="text";get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(e){this._errorStateTracker.matcher=e}userAriaDescribedBy;get value(){return this._signalBasedValueAccessor?this._signalBasedValueAccessor.value():this._inputValueAccessor.value}set value(e){e!==this.value&&(this._signalBasedValueAccessor?this._signalBasedValueAccessor.value.set(e):this._inputValueAccessor.value=e,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(e){this._readonly=su(e)}_readonly=!1;disabledInteractive;get errorState(){return this._errorStateTracker.errorState}set errorState(e){this._errorStateTracker.errorState=e}_neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(e=>BL().has(e));constructor(){let e=J(P0,{optional:!0}),n=J(ko,{optional:!0}),o=J(xv),r=J(qM,{optional:!0,self:!0}),g=this._elementRef.nativeElement,w=g.nodeName.toLowerCase();r?Jf(r.value)?this._signalBasedValueAccessor=r:this._inputValueAccessor=r:this._inputValueAccessor=g,this._previousNativeValue=this.value,this.id=this.id,this._platform.IOS&&this._ngZone.runOutsideAngular(()=>{this._cleanupIosKeyup=this._renderer.listen(g,"keyup",this._iOSKeyupListener)}),this._errorStateTracker=new wv(o,this.ngControl,n,e,this.stateChanges),this._isServer=!this._platform.isBrowser,this._isNativeSelect=w==="select",this._isTextarea=w==="textarea",this._isInFormField=!!this._formField,this.disabledInteractive=this._config?.disabledInteractive||!1,this._isNativeSelect&&(this.controlType=g.multiple?"mat-native-select-multiple":"mat-native-select"),this._signalBasedValueAccessor&&mx(()=>{this._signalBasedValueAccessor.value(),this.stateChanges.next()})}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(e=>{this.autofilled=e.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._cleanupIosKeyup?.(),this._cleanupWebkitWheel?.()}ngDoCheck(){this.ngControl&&(this.updateErrorState(),this.ngControl.disabled!==null&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(e){this._elementRef.nativeElement.focus(e)}updateErrorState(){this._errorStateTracker.updateErrorState()}_focusChanged(e){if(e!==this.focused){if(!this._isNativeSelect&&e&&this.disabled&&this.disabledInteractive){let n=this._elementRef.nativeElement;n.type==="number"?(n.type="text",n.setSelectionRange(0,0),n.type="number"):n.setSelectionRange(0,0)}this.focused=e,this.stateChanges.next()}}_onInput(){}_dirtyCheckNativeValue(){let e=this._elementRef.nativeElement.value;this._previousNativeValue!==e&&(this._previousNativeValue=e,this.stateChanges.next())}_dirtyCheckPlaceholder(){let e=this._getPlaceholder();if(e!==this._previousPlaceholder){let n=this._elementRef.nativeElement;this._previousPlaceholder=e,e?n.setAttribute("placeholder",e):n.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){lve.indexOf(this._type)>-1}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let e=this._elementRef.nativeElement.validity;return e&&e.badInput}get empty(){return!this._isNeverEmpty()&&!this._elementRef.nativeElement.value&&!this._isBadInput()&&!this.autofilled}get shouldLabelFloat(){if(this._isNativeSelect){let e=this._elementRef.nativeElement,n=e.options[0];return this.focused||e.multiple||!this.empty||!!(e.selectedIndex>-1&&n&&n.label)}else return this.focused&&!this.disabled||!this.empty}setDescribedByIds(e){let n=this._elementRef.nativeElement,o=n.getAttribute("aria-describedby"),r;if(o){let g=this._formFieldDescribedBy||e;r=e.concat(o.split(" ").filter(w=>w&&!g.includes(w)))}else r=e;this._formFieldDescribedBy=e,r.length?n.setAttribute("aria-describedby",r.join(" ")):n.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){let e=this._elementRef.nativeElement;return this._isNativeSelect&&(e.multiple||e.size>1)}_iOSKeyupListener=e=>{let n=e.target;!n.value&&n.selectionStart===0&&n.selectionEnd===0&&(n.setSelectionRange(1,1),n.setSelectionRange(0,0))};_webkitBlinkWheelListener=()=>{};_ensureWheelDefaultBehavior(){this._cleanupWebkitWheel?.(),this._type==="number"&&(this._platform.BLINK||this._platform.WEBKIT)&&(this._cleanupWebkitWheel=this._renderer.listen(this._elementRef.nativeElement,"wheel",this._webkitBlinkWheelListener))}_getReadonlyAttribute(){return this._isNativeSelect?null:this.readonly||this.disabled&&this.disabledInteractive?"true":null}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:21,hostBindings:function(n,o){n&1&&Nt("focus",function(){return o._focusChanged(!0)})("blur",function(){return o._focusChanged(!1)})("input",function(){return o._onInput()}),n&2&&(vs("id",o.id)("disabled",o.disabled&&!o.disabledInteractive)("required",o.required),un("name",o.name||null)("readonly",o._getReadonlyAttribute())("aria-disabled",o.disabled&&o.disabledInteractive?"true":null)("aria-invalid",o.empty&&o.required?null:o.errorState)("aria-required",o.required)("id",o.id),Ji("mat-input-server",o._isServer)("mat-mdc-form-field-textarea-control",o._isInFormField&&o._isTextarea)("mat-mdc-form-field-input-control",o._isInFormField)("mat-mdc-input-disabled-interactive",o.disabledInteractive)("mdc-text-field__input",o._isInFormField)("mat-mdc-native-select-inline",o._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:[0,"aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly",disabledInteractive:[2,"disabledInteractive","disabledInteractive",Bi]},exportAs:["matInput"],features:[fr([{provide:B0,useExisting:t}]),$r]})}return t})(),Mv=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({imports:[Wn,El,El,wY,Wn]})}return t})();var U4=new Ot("MAT_DATE_LOCALE",{providedIn:"root",factory:uve});function uve(){return J(om)}var Iv="Method not implemented",Cl=class{locale;_localeChanges=new gi;localeChanges=this._localeChanges;setTime(i,e,n,o){throw new Error(Iv)}getHours(i){throw new Error(Iv)}getMinutes(i){throw new Error(Iv)}getSeconds(i){throw new Error(Iv)}parseTime(i,e){throw new Error(Iv)}addSeconds(i,e){throw new Error(Iv)}getValidDateOrNull(i){return this.isDateInstance(i)&&this.isValid(i)?i:null}deserialize(i){return i==null||this.isDateInstance(i)&&this.isValid(i)?i:this.invalid()}setLocale(i){this.locale=i,this._localeChanges.next()}compareDate(i,e){return this.getYear(i)-this.getYear(e)||this.getMonth(i)-this.getMonth(e)||this.getDate(i)-this.getDate(e)}compareTime(i,e){return this.getHours(i)-this.getHours(e)||this.getMinutes(i)-this.getMinutes(e)||this.getSeconds(i)-this.getSeconds(e)}sameDate(i,e){if(i&&e){let n=this.isValid(i),o=this.isValid(e);return n&&o?!this.compareDate(i,e):n==o}return i==e}sameTime(i,e){if(i&&e){let n=this.isValid(i),o=this.isValid(e);return n&&o?!this.compareTime(i,e):n==o}return i==e}clampDate(i,e,n){return e&&this.compareDate(i,e)<0?e:n&&this.compareDate(i,n)>0?n:i}},Um=new Ot("mat-date-formats");var dve=["mat-calendar-body",""];function hve(t,i){return this._trackRow(i)}var AY=(t,i)=>i.id;function pve(t,i){if(t&1&&(ae(0,"tr",0)(1,"td",3),Oe(2),se()()),t&2){let e=zt();Se(),Pu("padding-top",e._cellPadding)("padding-bottom",e._cellPadding),un("colspan",e.numCols),Se(),an(" ",e.label," ")}}function fve(t,i){if(t&1&&(ae(0,"td",3),Oe(1),se()),t&2){let e=zt(2);Pu("padding-top",e._cellPadding)("padding-bottom",e._cellPadding),un("colspan",e._firstRowOffset),Se(),an(" ",e._firstRowOffset>=e.labelMinRequiredCells?e.label:""," ")}}function mve(t,i){if(t&1){let e=zi();ae(0,"td",6)(1,"button",7),Nt("click",function(o){let r=ri(e).$implicit,g=zt(2);return oi(g._cellClicked(r,o))})("focus",function(o){let r=ri(e).$implicit,g=zt(2);return oi(g._emitActiveDateChange(r,o))}),ae(2,"span",8),Oe(3),se(),jt(4,"span",9),se()()}if(t&2){let e=i.$implicit,n=i.$index,o=zt().$index,r=zt();Pu("width",r._cellWidth)("padding-top",r._cellPadding)("padding-bottom",r._cellPadding),un("data-mat-row",o)("data-mat-col",n),Se(),Ji("mat-calendar-body-disabled",!e.enabled)("mat-calendar-body-active",r._isActiveCell(o,n))("mat-calendar-body-range-start",r._isRangeStart(e.compareValue))("mat-calendar-body-range-end",r._isRangeEnd(e.compareValue))("mat-calendar-body-in-range",r._isInRange(e.compareValue))("mat-calendar-body-comparison-bridge-start",r._isComparisonBridgeStart(e.compareValue,o,n))("mat-calendar-body-comparison-bridge-end",r._isComparisonBridgeEnd(e.compareValue,o,n))("mat-calendar-body-comparison-start",r._isComparisonStart(e.compareValue))("mat-calendar-body-comparison-end",r._isComparisonEnd(e.compareValue))("mat-calendar-body-in-comparison-range",r._isInComparisonRange(e.compareValue))("mat-calendar-body-preview-start",r._isPreviewStart(e.compareValue))("mat-calendar-body-preview-end",r._isPreviewEnd(e.compareValue))("mat-calendar-body-in-preview",r._isInPreview(e.compareValue)),Xe("ngClass",e.cssClasses)("tabindex",r._isActiveCell(o,n)?0:-1),un("aria-label",e.ariaLabel)("aria-disabled",!e.enabled||null)("aria-pressed",r._isSelected(e.compareValue))("aria-current",r.todayValue===e.compareValue?"date":null)("aria-describedby",r._getDescribedby(e.compareValue)),Se(),Ji("mat-calendar-body-selected",r._isSelected(e.compareValue))("mat-calendar-body-comparison-identical",r._isComparisonIdentical(e.compareValue))("mat-calendar-body-today",r.todayValue===e.compareValue),Se(),an(" ",e.displayValue," ")}}function gve(t,i){if(t&1&&(ae(0,"tr",1),Tt(1,fve,2,6,"td",4),ky(2,mve,5,48,"td",5,AY),se()),t&2){let e=i.$implicit,n=i.$index,o=zt();Se(),zn(n===0&&o._firstRowOffset?1:-1),Se(),Oy(e)}}function _ve(t,i){if(t&1&&(ae(0,"th",2)(1,"span",6),Oe(2),se(),ae(3,"span",3),Oe(4),se()()),t&2){let e=i.$implicit;Se(2),En(e.long),Se(2),En(e.narrow)}}var yve=["*"];function vve(t,i){}function bve(t,i){if(t&1){let e=zi();ae(0,"mat-month-view",4),kp("activeDateChange",function(o){ri(e);let r=zt();return nm(r.activeDate,o)||(r.activeDate=o),oi(o)}),Nt("_userSelection",function(o){ri(e);let r=zt();return oi(r._dateSelected(o))})("dragStarted",function(o){ri(e);let r=zt();return oi(r._dragStarted(o))})("dragEnded",function(o){ri(e);let r=zt();return oi(r._dragEnded(o))}),se()}if(t&2){let e=zt();Rp("activeDate",e.activeDate),Xe("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)("comparisonStart",e.comparisonStart)("comparisonEnd",e.comparisonEnd)("startDateAccessibleName",e.startDateAccessibleName)("endDateAccessibleName",e.endDateAccessibleName)("activeDrag",e._activeDrag)}}function xve(t,i){if(t&1){let e=zi();ae(0,"mat-year-view",5),kp("activeDateChange",function(o){ri(e);let r=zt();return nm(r.activeDate,o)||(r.activeDate=o),oi(o)}),Nt("monthSelected",function(o){ri(e);let r=zt();return oi(r._monthSelectedInYearView(o))})("selectedChange",function(o){ri(e);let r=zt();return oi(r._goToDateInView(o,"month"))}),se()}if(t&2){let e=zt();Rp("activeDate",e.activeDate),Xe("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)}}function wve(t,i){if(t&1){let e=zi();ae(0,"mat-multi-year-view",6),kp("activeDateChange",function(o){ri(e);let r=zt();return nm(r.activeDate,o)||(r.activeDate=o),oi(o)}),Nt("yearSelected",function(o){ri(e);let r=zt();return oi(r._yearSelectedInMultiYearView(o))})("selectedChange",function(o){ri(e);let r=zt();return oi(r._goToDateInView(o,"year"))}),se()}if(t&2){let e=zt();Rp("activeDate",e.activeDate),Xe("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)}}function Eve(t,i){}var Cve=["button"],Sve=[[["","matDatepickerToggleIcon",""]]],Tve=["[matDatepickerToggleIcon]"];function Dve(t,i){t&1&&(gs(),ae(0,"svg",2),jt(1,"path",3),se())}var kv=(()=>{class t{changes=new gi;calendarLabel="Calendar";openCalendarLabel="Open calendar";closeCalendarLabel="Close calendar";prevMonthLabel="Previous month";nextMonthLabel="Next month";prevYearLabel="Previous year";nextYearLabel="Next year";prevMultiYearLabel="Previous 24 years";nextMultiYearLabel="Next 24 years";switchToMonthViewLabel="Choose date";switchToMultiYearViewLabel="Choose month and year";startDateLabel="Start date";endDateLabel="End date";comparisonDateLabel="Comparison range";formatYearRange(e,n){return`${e} \u2013 ${n}`}formatYearRangeLabel(e,n){return`${e} to ${n}`}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Mve=0,Xw=class{value;displayValue;ariaLabel;enabled;cssClasses;compareValue;rawValue;id=Mve++;constructor(i,e,n,o,r={},g=i,w){this.value=i,this.displayValue=e,this.ariaLabel=n,this.enabled=o,this.cssClasses=r,this.compareValue=g,this.rawValue=w}},Ive={passive:!1,capture:!0},$M={passive:!0,capture:!0},EY={passive:!0},Rv=(()=>{class t{_elementRef=J(Qi);_ngZone=J(Oi);_platform=J(Pr);_intl=J(kv);_eventCleanups;_skipNextFocus;_focusActiveCellAfterViewChecked=!1;label;rows;todayValue;startValue;endValue;labelMinRequiredCells;numCols=7;activeCell=0;ngAfterViewChecked(){this._focusActiveCellAfterViewChecked&&(this._focusActiveCell(),this._focusActiveCellAfterViewChecked=!1)}isRange=!1;cellAspectRatio=1;comparisonStart;comparisonEnd;previewStart=null;previewEnd=null;startDateAccessibleName;endDateAccessibleName;selectedValueChange=new Mi;previewChange=new Mi;activeDateChange=new Mi;dragStarted=new Mi;dragEnded=new Mi;_firstRowOffset;_cellPadding;_cellWidth;_startDateLabelId;_endDateLabelId;_comparisonStartDateLabelId;_comparisonEndDateLabelId;_didDragSinceMouseDown=!1;_injector=J(wn);comparisonDateAccessibleName=this._intl.comparisonDateLabel;_trackRow=e=>e;constructor(){let e=J(Ko),n=J(po);this._startDateLabelId=n.getId("mat-calendar-body-start-"),this._endDateLabelId=n.getId("mat-calendar-body-end-"),this._comparisonStartDateLabelId=n.getId("mat-calendar-body-comparison-start-"),this._comparisonEndDateLabelId=n.getId("mat-calendar-body-comparison-end-"),J(Vo).load(qd),this._ngZone.runOutsideAngular(()=>{let o=this._elementRef.nativeElement,r=[Sa(e,o,"touchmove",this._touchmoveHandler,Ive),Sa(e,o,"mouseenter",this._enterHandler,$M),Sa(e,o,"focus",this._enterHandler,$M),Sa(e,o,"mouseleave",this._leaveHandler,$M),Sa(e,o,"blur",this._leaveHandler,$M),Sa(e,o,"mousedown",this._mousedownHandler,EY),Sa(e,o,"touchstart",this._mousedownHandler,EY)];this._platform.isBrowser&&r.push(e.listen("window","mouseup",this._mouseupHandler),e.listen("window","touchend",this._touchendHandler)),this._eventCleanups=r})}_cellClicked(e,n){this._didDragSinceMouseDown||e.enabled&&this.selectedValueChange.emit({value:e.value,event:n})}_emitActiveDateChange(e,n){e.enabled&&this.activeDateChange.emit({value:e.value,event:n})}_isSelected(e){return this.startValue===e||this.endValue===e}ngOnChanges(e){let n=e.numCols,{rows:o,numCols:r}=this;(e.rows||n)&&(this._firstRowOffset=o&&o.length&&o[0].length?r-o[0].length:0),(e.cellAspectRatio||n||!this._cellPadding)&&(this._cellPadding=`${50*this.cellAspectRatio/r}%`),(n||!this._cellWidth)&&(this._cellWidth=`${100/r}%`)}ngOnDestroy(){this._eventCleanups.forEach(e=>e())}_isActiveCell(e,n){let o=e*this.numCols+n;return e&&(o-=this._firstRowOffset),o==this.activeCell}_focusActiveCell(e=!0){_s(()=>{setTimeout(()=>{let n=this._elementRef.nativeElement.querySelector(".mat-calendar-body-active");n&&(e||(this._skipNextFocus=!0),n.focus())})},{injector:this._injector})}_scheduleFocusActiveCellAfterViewChecked(){this._focusActiveCellAfterViewChecked=!0}_isRangeStart(e){return $4(e,this.startValue,this.endValue)}_isRangeEnd(e){return G4(e,this.startValue,this.endValue)}_isInRange(e){return W4(e,this.startValue,this.endValue,this.isRange)}_isComparisonStart(e){return $4(e,this.comparisonStart,this.comparisonEnd)}_isComparisonBridgeStart(e,n,o){if(!this._isComparisonStart(e)||this._isRangeStart(e)||!this._isInRange(e))return!1;let r=this.rows[n][o-1];if(!r){let g=this.rows[n-1];r=g&&g[g.length-1]}return r&&!this._isRangeEnd(r.compareValue)}_isComparisonBridgeEnd(e,n,o){if(!this._isComparisonEnd(e)||this._isRangeEnd(e)||!this._isInRange(e))return!1;let r=this.rows[n][o+1];if(!r){let g=this.rows[n+1];r=g&&g[0]}return r&&!this._isRangeStart(r.compareValue)}_isComparisonEnd(e){return G4(e,this.comparisonStart,this.comparisonEnd)}_isInComparisonRange(e){return W4(e,this.comparisonStart,this.comparisonEnd,this.isRange)}_isComparisonIdentical(e){return this.comparisonStart===this.comparisonEnd&&e===this.comparisonStart}_isPreviewStart(e){return $4(e,this.previewStart,this.previewEnd)}_isPreviewEnd(e){return G4(e,this.previewStart,this.previewEnd)}_isInPreview(e){return W4(e,this.previewStart,this.previewEnd,this.isRange)}_getDescribedby(e){if(!this.isRange)return null;if(this.startValue===e&&this.endValue===e)return`${this._startDateLabelId} ${this._endDateLabelId}`;if(this.startValue===e)return this._startDateLabelId;if(this.endValue===e)return this._endDateLabelId;if(this.comparisonStart!==null&&this.comparisonEnd!==null){if(e===this.comparisonStart&&e===this.comparisonEnd)return`${this._comparisonStartDateLabelId} ${this._comparisonEndDateLabelId}`;if(e===this.comparisonStart)return this._comparisonStartDateLabelId;if(e===this.comparisonEnd)return this._comparisonEndDateLabelId}return null}_enterHandler=e=>{if(this._skipNextFocus&&e.type==="focus"){this._skipNextFocus=!1;return}if(e.target&&this.isRange){let n=this._getCellFromElement(e.target);n&&this._ngZone.run(()=>this.previewChange.emit({value:n.enabled?n:null,event:e}))}};_touchmoveHandler=e=>{if(!this.isRange)return;let n=CY(e),o=n?this._getCellFromElement(n):null;n!==e.target&&(this._didDragSinceMouseDown=!0),q4(e.target)&&e.preventDefault(),this._ngZone.run(()=>this.previewChange.emit({value:o?.enabled?o:null,event:e}))};_leaveHandler=e=>{this.previewEnd!==null&&this.isRange&&(e.type!=="blur"&&(this._didDragSinceMouseDown=!0),e.target&&this._getCellFromElement(e.target)&&!(e.relatedTarget&&this._getCellFromElement(e.relatedTarget))&&this._ngZone.run(()=>this.previewChange.emit({value:null,event:e})))};_mousedownHandler=e=>{if(!this.isRange)return;this._didDragSinceMouseDown=!1;let n=e.target&&this._getCellFromElement(e.target);!n||!this._isInRange(n.compareValue)||this._ngZone.run(()=>{this.dragStarted.emit({value:n.rawValue,event:e})})};_mouseupHandler=e=>{if(!this.isRange)return;let n=q4(e.target);if(!n){this._ngZone.run(()=>{this.dragEnded.emit({value:null,event:e})});return}n.closest(".mat-calendar-body")===this._elementRef.nativeElement&&this._ngZone.run(()=>{let o=this._getCellFromElement(n);this.dragEnded.emit({value:o?.rawValue??null,event:e})})};_touchendHandler=e=>{let n=CY(e);n&&this._mouseupHandler({target:n})};_getCellFromElement(e){let n=q4(e);if(n){let o=n.getAttribute("data-mat-row"),r=n.getAttribute("data-mat-col");if(o&&r)return this.rows[parseInt(o)][parseInt(r)]}return null}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["","mat-calendar-body",""]],hostAttrs:[1,"mat-calendar-body"],inputs:{label:"label",rows:"rows",todayValue:"todayValue",startValue:"startValue",endValue:"endValue",labelMinRequiredCells:"labelMinRequiredCells",numCols:"numCols",activeCell:"activeCell",isRange:"isRange",cellAspectRatio:"cellAspectRatio",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",previewStart:"previewStart",previewEnd:"previewEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedValueChange:"selectedValueChange",previewChange:"previewChange",activeDateChange:"activeDateChange",dragStarted:"dragStarted",dragEnded:"dragEnded"},exportAs:["matCalendarBody"],features:[$r],attrs:dve,decls:11,vars:11,consts:[["aria-hidden","true"],["role","row"],[1,"mat-calendar-body-hidden-label",3,"id"],[1,"mat-calendar-body-label"],[1,"mat-calendar-body-label",3,"paddingTop","paddingBottom"],["role","gridcell",1,"mat-calendar-body-cell-container",3,"width","paddingTop","paddingBottom"],["role","gridcell",1,"mat-calendar-body-cell-container"],["type","button",1,"mat-calendar-body-cell",3,"click","focus","ngClass","tabindex"],[1,"mat-calendar-body-cell-content","mat-focus-indicator"],["aria-hidden","true",1,"mat-calendar-body-cell-preview"]],template:function(n,o){n&1&&(Tt(0,pve,3,6,"tr",0),ky(1,gve,4,1,"tr",1,hve,!0),ae(3,"span",2),Oe(4),se(),ae(5,"span",2),Oe(6),se(),ae(7,"span",2),Oe(8),se(),ae(9,"span",2),Oe(10),se()),n&2&&(zn(o._firstRowOffset<o.labelMinRequiredCells?0:-1),Se(),Oy(o.rows),Se(2),Xe("id",o._startDateLabelId),Se(),an(" ",o.startDateAccessibleName,`
`),Se(),Xe("id",o._endDateLabelId),Se(),an(" ",o.endDateAccessibleName,`
`),Se(),Xe("id",o._comparisonStartDateLabelId),Se(),kh(" ",o.comparisonDateAccessibleName," ",o.startDateAccessibleName,`
`),Se(),Xe("id",o._comparisonEndDateLabelId),Se(),kh(" ",o.comparisonDateAccessibleName," ",o.endDateAccessibleName,`
`))},dependencies:[Js],styles:[`.mat-calendar-body{min-width:224px}.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-outline-color, var(--mat-sys-primary))}.mat-calendar-body-label{height:0;line-height:0;text-align:start;padding-left:4.7142857143%;padding-right:4.7142857143%;font-size:var(--mat-datepicker-calendar-body-label-text-size, var(--mat-sys-title-small-size));font-weight:var(--mat-datepicker-calendar-body-label-text-weight, var(--mat-sys-title-small-weight));color:var(--mat-datepicker-calendar-body-label-text-color, var(--mat-sys-on-surface))}.mat-calendar-body-hidden-label{display:none}.mat-calendar-body-cell-container{position:relative;height:0;line-height:0}.mat-calendar-body-cell{position:absolute;top:0;left:0;width:100%;height:100%;background:none;text-align:center;outline:none;font-family:inherit;margin:0;font-family:var(--mat-datepicker-calendar-text-font, var(--mat-sys-body-medium-font));font-size:var(--mat-datepicker-calendar-text-size, var(--mat-sys-body-medium-size));-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-calendar-body-cell::-moz-focus-inner{border:0}.mat-calendar-body-cell::before,.mat-calendar-body-cell::after,.mat-calendar-body-cell-preview{content:"";position:absolute;top:5%;left:0;z-index:0;box-sizing:border-box;display:block;height:90%;width:100%}.mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-start::after,.mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,.mat-calendar-body-comparison-start::after,.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:5%;width:95%;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,[dir=rtl] .mat-calendar-body-comparison-start::after,[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:0;border-radius:0;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,.mat-calendar-body-comparison-end::after,.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}[dir=rtl] .mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,[dir=rtl] .mat-calendar-body-comparison-end::after,[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{left:5%;border-radius:0;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-comparison-bridge-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-bridge-end.mat-calendar-body-range-start::after{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end.mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-end.mat-calendar-body-range-start::after{width:90%}.mat-calendar-body-in-preview{color:var(--mat-datepicker-calendar-date-preview-state-outline-color, var(--mat-sys-primary))}.mat-calendar-body-in-preview .mat-calendar-body-cell-preview{border-top:dashed 1px;border-bottom:dashed 1px}.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:dashed 1px}[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:0;border-right:dashed 1px}.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:dashed 1px}[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:0;border-left:dashed 1px}.mat-calendar-body-disabled{cursor:default}.mat-calendar-body-disabled>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){color:var(--mat-datepicker-calendar-date-disabled-state-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-calendar-body-disabled>.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-disabled-state-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}@media(forced-colors: active){.mat-calendar-body-disabled{opacity:.5}}.mat-calendar-body-cell-content{top:5%;left:5%;z-index:1;display:flex;align-items:center;justify-content:center;box-sizing:border-box;width:90%;height:90%;line-height:1;border-width:1px;border-style:solid;border-radius:999px;color:var(--mat-datepicker-calendar-date-text-color, var(--mat-sys-on-surface));border-color:var(--mat-datepicker-calendar-date-outline-color, transparent)}.mat-calendar-body-cell-content.mat-focus-indicator{position:absolute}@media(forced-colors: active){.mat-calendar-body-cell-content{border:none}}.cdk-keyboard-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical),.cdk-program-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-focus-state-background-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-focus-state-layer-opacity) * 100%), transparent))}@media(hover: hover){.mat-calendar-body-cell:not(.mat-calendar-body-disabled):hover>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-hover-state-background-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-hover-state-layer-opacity) * 100%), transparent))}}.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-state-background-color, var(--mat-sys-primary));color:var(--mat-datepicker-calendar-date-selected-state-text-color, var(--mat-sys-on-primary))}.mat-calendar-body-disabled>.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-disabled-state-background-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-calendar-body-selected.mat-calendar-body-today{box-shadow:inset 0 0 0 1px var(--mat-datepicker-calendar-date-today-selected-state-outline-color, var(--mat-sys-primary))}.mat-calendar-body-in-range::before{background:var(--mat-datepicker-calendar-date-in-range-state-background-color, var(--mat-sys-primary-container))}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color, var(--mat-sys-tertiary-container))}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color, var(--mat-sys-tertiary-container))}.mat-calendar-body-comparison-bridge-start::before,[dir=rtl] .mat-calendar-body-comparison-bridge-end::before{background:linear-gradient(to right, var(--mat-datepicker-calendar-date-in-range-state-background-color, var(--mat-sys-primary-container)) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color, var(--mat-sys-tertiary-container)) 50%)}.mat-calendar-body-comparison-bridge-end::before,[dir=rtl] .mat-calendar-body-comparison-bridge-start::before{background:linear-gradient(to left, var(--mat-datepicker-calendar-date-in-range-state-background-color, var(--mat-sys-primary-container)) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color, var(--mat-sys-tertiary-container)) 50%)}.mat-calendar-body-in-range>.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range.mat-calendar-body-in-range::after{background:var(--mat-datepicker-calendar-date-in-overlap-range-state-background-color, var(--mat-sys-secondary-container))}.mat-calendar-body-comparison-identical.mat-calendar-body-selected,.mat-calendar-body-in-comparison-range>.mat-calendar-body-selected{background:var(--mat-datepicker-calendar-date-in-overlap-range-selected-state-background-color, var(--mat-sys-secondary))}@media(forced-colors: active){.mat-datepicker-popup:not(:empty),.mat-calendar-body-cell:not(.mat-calendar-body-in-range) .mat-calendar-body-selected{outline:solid 1px}.mat-calendar-body-today{outline:dotted 1px}.mat-calendar-body-cell::before,.mat-calendar-body-cell::after,.mat-calendar-body-selected{background:none}.mat-calendar-body-in-range::before,.mat-calendar-body-comparison-bridge-start::before,.mat-calendar-body-comparison-bridge-end::before{border-top:solid 1px;border-bottom:solid 1px}.mat-calendar-body-range-start::before{border-left:solid 1px}[dir=rtl] .mat-calendar-body-range-start::before{border-left:0;border-right:solid 1px}.mat-calendar-body-range-end::before{border-right:solid 1px}[dir=rtl] .mat-calendar-body-range-end::before{border-right:0;border-left:solid 1px}.mat-calendar-body-in-comparison-range::before{border-top:dashed 1px;border-bottom:dashed 1px}.mat-calendar-body-comparison-start::before{border-left:dashed 1px}[dir=rtl] .mat-calendar-body-comparison-start::before{border-left:0;border-right:dashed 1px}.mat-calendar-body-comparison-end::before{border-right:dashed 1px}[dir=rtl] .mat-calendar-body-comparison-end::before{border-right:0;border-left:dashed 1px}}
`],encapsulation:2,changeDetection:0})}return t})();function H4(t){return t?.nodeName==="TD"}function q4(t){let i;return H4(t)?i=t:H4(t.parentNode)?i=t.parentNode:H4(t.parentNode?.parentNode)&&(i=t.parentNode.parentNode),i?.getAttribute("data-mat-row")!=null?i:null}function $4(t,i,e){return e!==null&&i!==e&&t<e&&t===i}function G4(t,i,e){return i!==null&&i!==e&&t>=i&&t===e}function W4(t,i,e,n){return n&&i!==null&&e!==null&&i!==e&&t>=i&&t<=e}function CY(t){let i=t.changedTouches[0];return document.elementFromPoint(i.clientX,i.clientY)}var Xu=class{start;end;_disableStructuralEquivalency;constructor(i,e){this.start=i,this.end=e}},Qw=(()=>{class t{selection;_adapter;_selectionChanged=new gi;selectionChanged=this._selectionChanged;constructor(e,n){this.selection=e,this._adapter=n,this.selection=e}updateSelection(e,n){let o=this.selection;this.selection=e,this._selectionChanged.next({selection:e,source:n,oldValue:o})}ngOnDestroy(){this._selectionChanged.complete()}_isValidDateInstance(e){return this._adapter.isDateInstance(e)&&this._adapter.isValid(e)}static \u0275fac=function(n){BS()};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})(),Ave=(()=>{class t extends Qw{constructor(e){super(null,e)}add(e){super.updateSelection(e,this)}isValid(){return this.selection!=null&&this._isValidDateInstance(this.selection)}isComplete(){return this.selection!=null}clone(){let e=new t(this._adapter);return e.updateSelection(this.selection,this),e}static \u0275fac=function(n){return new(n||t)(bi(Cl))};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})();function Rve(t,i){return t||new Ave(i)}var RY={provide:Qw,deps:[[new Rh,new by,Qw],Cl],useFactory:Rve};var kY=new Ot("MAT_DATE_RANGE_SELECTION_STRATEGY");var Z4=7,kve=0,SY=(()=>{class t{_changeDetectorRef=J(vr);_dateFormats=J(Um,{optional:!0});_dateAdapter=J(Cl,{optional:!0});_dir=J(aa,{optional:!0});_rangeStrategy=J(kY,{optional:!0});_rerenderSubscription=nr.EMPTY;_selectionKeyPressed;get activeDate(){return this._activeDate}set activeDate(e){let n=this._activeDate,o=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(o,this.minDate,this.maxDate),this._hasSameMonthAndYear(n,this._activeDate)||this._init()}_activeDate;get selected(){return this._selected}set selected(e){e instanceof Xu?this._selected=e:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setRanges(this._selected)}_selected;get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_minDate;get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_maxDate;dateFilter;dateClass;comparisonStart;comparisonEnd;startDateAccessibleName;endDateAccessibleName;activeDrag=null;selectedChange=new Mi;_userSelection=new Mi;dragStarted=new Mi;dragEnded=new Mi;activeDateChange=new Mi;_matCalendarBody;_monthLabel;_weeks;_firstWeekOffset;_rangeStart;_rangeEnd;_comparisonRangeStart;_comparisonRangeEnd;_previewStart;_previewEnd;_isRange;_todayDate;_weekdays;constructor(){J(Vo).load(Hu),this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(ia(null)).subscribe(()=>this._init())}ngOnChanges(e){let n=e.comparisonStart||e.comparisonEnd;n&&!n.firstChange&&this._setRanges(this.selected),e.activeDrag&&!this.activeDrag&&this._clearPreview()}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_dateSelected(e){let n=e.value,o=this._getDateFromDayOfMonth(n),r,g;this._selected instanceof Xu?(r=this._getDateInCurrentMonth(this._selected.start),g=this._getDateInCurrentMonth(this._selected.end)):r=g=this._getDateInCurrentMonth(this._selected),(r!==n||g!==n)&&this.selectedChange.emit(o),this._userSelection.emit({value:o,event:e.event}),this._clearPreview(),this._changeDetectorRef.markForCheck()}_updateActiveDate(e){let n=e.value,o=this._activeDate;this.activeDate=this._getDateFromDayOfMonth(n),this._dateAdapter.compareDate(o,this.activeDate)&&this.activeDateChange.emit(this._activeDate)}_handleCalendarBodyKeydown(e){let n=this._activeDate,o=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,o?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,o?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,-7);break;case 40:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,7);break;case 36:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,1-this._dateAdapter.getDate(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,this._dateAdapter.getNumDaysInMonth(this._activeDate)-this._dateAdapter.getDate(this._activeDate));break;case 33:this.activeDate=e.altKey?this._dateAdapter.addCalendarYears(this._activeDate,-1):this._dateAdapter.addCalendarMonths(this._activeDate,-1);break;case 34:this.activeDate=e.altKey?this._dateAdapter.addCalendarYears(this._activeDate,1):this._dateAdapter.addCalendarMonths(this._activeDate,1);break;case 13:case 32:this._selectionKeyPressed=!0,this._canSelect(this._activeDate)&&e.preventDefault();return;case 27:this._previewEnd!=null&&!ga(e)&&(this._clearPreview(),this.activeDrag?this.dragEnded.emit({value:null,event:e}):(this.selectedChange.emit(null),this._userSelection.emit({value:null,event:e})),e.preventDefault(),e.stopPropagation());return;default:return}this._dateAdapter.compareDate(n,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),e.preventDefault()}_handleCalendarBodyKeyup(e){(e.keyCode===32||e.keyCode===13)&&(this._selectionKeyPressed&&this._canSelect(this._activeDate)&&this._dateSelected({value:this._dateAdapter.getDate(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_init(){this._setRanges(this.selected),this._todayDate=this._getCellCompareValue(this._dateAdapter.today()),this._monthLabel=this._dateFormats.display.monthLabel?this._dateAdapter.format(this.activeDate,this._dateFormats.display.monthLabel):this._dateAdapter.getMonthNames("short")[this._dateAdapter.getMonth(this.activeDate)].toLocaleUpperCase();let e=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),1);this._firstWeekOffset=(Z4+this._dateAdapter.getDayOfWeek(e)-this._dateAdapter.getFirstDayOfWeek())%Z4,this._initWeekdays(),this._createWeekCells(),this._changeDetectorRef.markForCheck()}_focusActiveCell(e){this._matCalendarBody._focusActiveCell(e)}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_previewChanged({event:e,value:n}){if(this._rangeStrategy){let o=n?n.rawValue:null,r=this._rangeStrategy.createPreview(o,this.selected,e);if(this._previewStart=this._getCellCompareValue(r.start),this._previewEnd=this._getCellCompareValue(r.end),this.activeDrag&&o){let g=this._rangeStrategy.createDrag?.(this.activeDrag.value,this.selected,o,e);g&&(this._previewStart=this._getCellCompareValue(g.start),this._previewEnd=this._getCellCompareValue(g.end))}this._changeDetectorRef.detectChanges()}}_dragEnded(e){if(this.activeDrag)if(e.value){let n=this._rangeStrategy?.createDrag?.(this.activeDrag.value,this.selected,e.value,e.event);this.dragEnded.emit({value:n??null,event:e.event})}else this.dragEnded.emit({value:null,event:e.event})}_getDateFromDayOfMonth(e){return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),e)}_initWeekdays(){let e=this._dateAdapter.getFirstDayOfWeek(),n=this._dateAdapter.getDayOfWeekNames("narrow"),r=this._dateAdapter.getDayOfWeekNames("long").map((g,w)=>({long:g,narrow:n[w],id:kve++}));this._weekdays=r.slice(e).concat(r.slice(0,e))}_createWeekCells(){let e=this._dateAdapter.getNumDaysInMonth(this.activeDate),n=this._dateAdapter.getDateNames();this._weeks=[[]];for(let o=0,r=this._firstWeekOffset;o<e;o++,r++){r==Z4&&(this._weeks.push([]),r=0);let g=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),o+1),w=this._shouldEnableDate(g),T=this._dateAdapter.format(g,this._dateFormats.display.dateA11yLabel),k=this.dateClass?this.dateClass(g,"month"):void 0;this._weeks[this._weeks.length-1].push(new Xw(o+1,n[o],T,w,k,this._getCellCompareValue(g),g))}}_shouldEnableDate(e){return!!e&&(!this.minDate||this._dateAdapter.compareDate(e,this.minDate)>=0)&&(!this.maxDate||this._dateAdapter.compareDate(e,this.maxDate)<=0)&&(!this.dateFilter||this.dateFilter(e))}_getDateInCurrentMonth(e){return e&&this._hasSameMonthAndYear(e,this.activeDate)?this._dateAdapter.getDate(e):null}_hasSameMonthAndYear(e,n){return!!(e&&n&&this._dateAdapter.getMonth(e)==this._dateAdapter.getMonth(n)&&this._dateAdapter.getYear(e)==this._dateAdapter.getYear(n))}_getCellCompareValue(e){if(e){let n=this._dateAdapter.getYear(e),o=this._dateAdapter.getMonth(e),r=this._dateAdapter.getDate(e);return new Date(n,o,r).getTime()}return null}_isRtl(){return this._dir&&this._dir.value==="rtl"}_setRanges(e){e instanceof Xu?(this._rangeStart=this._getCellCompareValue(e.start),this._rangeEnd=this._getCellCompareValue(e.end),this._isRange=!0):(this._rangeStart=this._rangeEnd=this._getCellCompareValue(e),this._isRange=!1),this._comparisonRangeStart=this._getCellCompareValue(this.comparisonStart),this._comparisonRangeEnd=this._getCellCompareValue(this.comparisonEnd)}_canSelect(e){return!this.dateFilter||this.dateFilter(e)}_clearPreview(){this._previewStart=this._previewEnd=null}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-month-view"]],viewQuery:function(n,o){if(n&1&&pr(Rv,5),n&2){let r;sn(r=ln())&&(o._matCalendarBody=r.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName",activeDrag:"activeDrag"},outputs:{selectedChange:"selectedChange",_userSelection:"_userSelection",dragStarted:"dragStarted",dragEnded:"dragEnded",activeDateChange:"activeDateChange"},exportAs:["matMonthView"],features:[$r],decls:8,vars:14,consts:[["role","grid",1,"mat-calendar-table"],[1,"mat-calendar-table-header"],["scope","col"],["aria-hidden","true"],["colspan","7",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"selectedValueChange","activeDateChange","previewChange","dragStarted","dragEnded","keyup","keydown","label","rows","todayValue","startValue","endValue","comparisonStart","comparisonEnd","previewStart","previewEnd","isRange","labelMinRequiredCells","activeCell","startDateAccessibleName","endDateAccessibleName"],[1,"cdk-visually-hidden"]],template:function(n,o){n&1&&(ae(0,"table",0)(1,"thead",1)(2,"tr"),ky(3,_ve,5,2,"th",2,AY),se(),ae(5,"tr",3),jt(6,"th",4),se()(),ae(7,"tbody",5),Nt("selectedValueChange",function(g){return o._dateSelected(g)})("activeDateChange",function(g){return o._updateActiveDate(g)})("previewChange",function(g){return o._previewChanged(g)})("dragStarted",function(g){return o.dragStarted.emit(g)})("dragEnded",function(g){return o._dragEnded(g)})("keyup",function(g){return o._handleCalendarBodyKeyup(g)})("keydown",function(g){return o._handleCalendarBodyKeydown(g)}),se()()),n&2&&(Se(3),Oy(o._weekdays),Se(4),Xe("label",o._monthLabel)("rows",o._weeks)("todayValue",o._todayDate)("startValue",o._rangeStart)("endValue",o._rangeEnd)("comparisonStart",o._comparisonRangeStart)("comparisonEnd",o._comparisonRangeEnd)("previewStart",o._previewStart)("previewEnd",o._previewEnd)("isRange",o._isRange)("labelMinRequiredCells",3)("activeCell",o._dateAdapter.getDate(o.activeDate)-1)("startDateAccessibleName",o.startDateAccessibleName)("endDateAccessibleName",o.endDateAccessibleName))},dependencies:[Rv],encapsulation:2,changeDetection:0})}return t})(),Yh=24,TY=4,DY=(()=>{class t{_changeDetectorRef=J(vr);_dateAdapter=J(Cl,{optional:!0});_dir=J(aa,{optional:!0});_rerenderSubscription=nr.EMPTY;_selectionKeyPressed;get activeDate(){return this._activeDate}set activeDate(e){let n=this._activeDate,o=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(o,this.minDate,this.maxDate),OY(this._dateAdapter,n,this._activeDate,this.minDate,this.maxDate)||this._init()}_activeDate;get selected(){return this._selected}set selected(e){e instanceof Xu?this._selected=e:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setSelectedYear(e)}_selected;get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_minDate;get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_maxDate;dateFilter;dateClass;selectedChange=new Mi;yearSelected=new Mi;activeDateChange=new Mi;_matCalendarBody;_years;_todayYear;_selectedYear;constructor(){this._dateAdapter,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(ia(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_init(){this._todayYear=this._dateAdapter.getYear(this._dateAdapter.today());let n=this._dateAdapter.getYear(this._activeDate)-Kw(this._dateAdapter,this.activeDate,this.minDate,this.maxDate);this._years=[];for(let o=0,r=[];o<Yh;o++)r.push(n+o),r.length==TY&&(this._years.push(r.map(g=>this._createCellForYear(g))),r=[]);this._changeDetectorRef.markForCheck()}_yearSelected(e){let n=e.value,o=this._dateAdapter.createDate(n,0,1),r=this._getDateFromYear(n);this.yearSelected.emit(o),this.selectedChange.emit(r)}_updateActiveDate(e){let n=e.value,o=this._activeDate;this.activeDate=this._getDateFromYear(n),this._dateAdapter.compareDate(o,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(e){let n=this._activeDate,o=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,o?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,o?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,TY);break;case 36:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-Kw(this._dateAdapter,this.activeDate,this.minDate,this.maxDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,Yh-Kw(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)-1);break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?-24*10:-24);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?Yh*10:Yh);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(n,this.activeDate)&&this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked(),e.preventDefault()}_handleCalendarBodyKeyup(e){(e.keyCode===32||e.keyCode===13)&&(this._selectionKeyPressed&&this._yearSelected({value:this._dateAdapter.getYear(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_getActiveCell(){return Kw(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getDateFromYear(e){let n=this._dateAdapter.getMonth(this.activeDate),o=this._dateAdapter.getNumDaysInMonth(this._dateAdapter.createDate(e,n,1));return this._dateAdapter.createDate(e,n,Math.min(this._dateAdapter.getDate(this.activeDate),o))}_createCellForYear(e){let n=this._dateAdapter.createDate(e,0,1),o=this._dateAdapter.getYearName(n),r=this.dateClass?this.dateClass(n,"multi-year"):void 0;return new Xw(e,o,o,this._shouldEnableYear(e),r)}_shouldEnableYear(e){if(e==null||this.maxDate&&e>this._dateAdapter.getYear(this.maxDate)||this.minDate&&e<this._dateAdapter.getYear(this.minDate))return!1;if(!this.dateFilter)return!0;let n=this._dateAdapter.createDate(e,0,1);for(let o=n;this._dateAdapter.getYear(o)==e;o=this._dateAdapter.addCalendarDays(o,1))if(this.dateFilter(o))return!0;return!1}_isRtl(){return this._dir&&this._dir.value==="rtl"}_setSelectedYear(e){if(this._selectedYear=null,e instanceof Xu){let n=e.start||e.end;n&&(this._selectedYear=this._dateAdapter.getYear(n))}else e&&(this._selectedYear=this._dateAdapter.getYear(e))}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-multi-year-view"]],viewQuery:function(n,o){if(n&1&&pr(Rv,5),n&2){let r;sn(r=ln())&&(o._matCalendarBody=r.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",activeDateChange:"activeDateChange"},exportAs:["matMultiYearView"],decls:5,vars:7,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"selectedValueChange","activeDateChange","keyup","keydown","rows","todayValue","startValue","endValue","numCols","cellAspectRatio","activeCell"]],template:function(n,o){n&1&&(ae(0,"table",0)(1,"thead",1)(2,"tr"),jt(3,"th",2),se()(),ae(4,"tbody",3),Nt("selectedValueChange",function(g){return o._yearSelected(g)})("activeDateChange",function(g){return o._updateActiveDate(g)})("keyup",function(g){return o._handleCalendarBodyKeyup(g)})("keydown",function(g){return o._handleCalendarBodyKeydown(g)}),se()()),n&2&&(Se(4),Xe("rows",o._years)("todayValue",o._todayYear)("startValue",o._selectedYear)("endValue",o._selectedYear)("numCols",4)("cellAspectRatio",4/7)("activeCell",o._getActiveCell()))},dependencies:[Rv],encapsulation:2,changeDetection:0})}return t})();function OY(t,i,e,n,o){let r=t.getYear(i),g=t.getYear(e),w=PY(t,n,o);return Math.floor((r-w)/Yh)===Math.floor((g-w)/Yh)}function Kw(t,i,e,n){let o=t.getYear(i);return Ove(o-PY(t,e,n),Yh)}function PY(t,i,e){let n=0;return e?n=t.getYear(e)-Yh+1:i&&(n=t.getYear(i)),n}function Ove(t,i){return(t%i+i)%i}var MY=(()=>{class t{_changeDetectorRef=J(vr);_dateFormats=J(Um,{optional:!0});_dateAdapter=J(Cl,{optional:!0});_dir=J(aa,{optional:!0});_rerenderSubscription=nr.EMPTY;_selectionKeyPressed;get activeDate(){return this._activeDate}set activeDate(e){let n=this._activeDate,o=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(o,this.minDate,this.maxDate),this._dateAdapter.getYear(n)!==this._dateAdapter.getYear(this._activeDate)&&this._init()}_activeDate;get selected(){return this._selected}set selected(e){e instanceof Xu?this._selected=e:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setSelectedMonth(e)}_selected;get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_minDate;get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_maxDate;dateFilter;dateClass;selectedChange=new Mi;monthSelected=new Mi;activeDateChange=new Mi;_matCalendarBody;_months;_yearLabel;_todayMonth;_selectedMonth;constructor(){this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(ia(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_monthSelected(e){let n=e.value,o=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),n,1);this.monthSelected.emit(o);let r=this._getDateFromMonth(n);this.selectedChange.emit(r)}_updateActiveDate(e){let n=e.value,o=this._activeDate;this.activeDate=this._getDateFromMonth(n),this._dateAdapter.compareDate(o,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(e){let n=this._activeDate,o=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,o?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,o?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-this._dateAdapter.getMonth(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,11-this._dateAdapter.getMonth(this._activeDate));break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?-10:-1);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?10:1);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(n,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),e.preventDefault()}_handleCalendarBodyKeyup(e){(e.keyCode===32||e.keyCode===13)&&(this._selectionKeyPressed&&this._monthSelected({value:this._dateAdapter.getMonth(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_init(){this._setSelectedMonth(this.selected),this._todayMonth=this._getMonthInCurrentYear(this._dateAdapter.today()),this._yearLabel=this._dateAdapter.getYearName(this.activeDate);let e=this._dateAdapter.getMonthNames("short");this._months=[[0,1,2,3],[4,5,6,7],[8,9,10,11]].map(n=>n.map(o=>this._createCellForMonth(o,e[o]))),this._changeDetectorRef.markForCheck()}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getMonthInCurrentYear(e){return e&&this._dateAdapter.getYear(e)==this._dateAdapter.getYear(this.activeDate)?this._dateAdapter.getMonth(e):null}_getDateFromMonth(e){let n=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,1),o=this._dateAdapter.getNumDaysInMonth(n);return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,Math.min(this._dateAdapter.getDate(this.activeDate),o))}_createCellForMonth(e,n){let o=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,1),r=this._dateAdapter.format(o,this._dateFormats.display.monthYearA11yLabel),g=this.dateClass?this.dateClass(o,"year"):void 0;return new Xw(e,n.toLocaleUpperCase(),r,this._shouldEnableMonth(e),g)}_shouldEnableMonth(e){let n=this._dateAdapter.getYear(this.activeDate);if(e==null||this._isYearAndMonthAfterMaxDate(n,e)||this._isYearAndMonthBeforeMinDate(n,e))return!1;if(!this.dateFilter)return!0;let o=this._dateAdapter.createDate(n,e,1);for(let r=o;this._dateAdapter.getMonth(r)==e;r=this._dateAdapter.addCalendarDays(r,1))if(this.dateFilter(r))return!0;return!1}_isYearAndMonthAfterMaxDate(e,n){if(this.maxDate){let o=this._dateAdapter.getYear(this.maxDate),r=this._dateAdapter.getMonth(this.maxDate);return e>o||e===o&&n>r}return!1}_isYearAndMonthBeforeMinDate(e,n){if(this.minDate){let o=this._dateAdapter.getYear(this.minDate),r=this._dateAdapter.getMonth(this.minDate);return e<o||e===o&&n<r}return!1}_isRtl(){return this._dir&&this._dir.value==="rtl"}_setSelectedMonth(e){e instanceof Xu?this._selectedMonth=this._getMonthInCurrentYear(e.start)||this._getMonthInCurrentYear(e.end):this._selectedMonth=this._getMonthInCurrentYear(e)}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-year-view"]],viewQuery:function(n,o){if(n&1&&pr(Rv,5),n&2){let r;sn(r=ln())&&(o._matCalendarBody=r.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",monthSelected:"monthSelected",activeDateChange:"activeDateChange"},exportAs:["matYearView"],decls:5,vars:9,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"selectedValueChange","activeDateChange","keyup","keydown","label","rows","todayValue","startValue","endValue","labelMinRequiredCells","numCols","cellAspectRatio","activeCell"]],template:function(n,o){n&1&&(ae(0,"table",0)(1,"thead",1)(2,"tr"),jt(3,"th",2),se()(),ae(4,"tbody",3),Nt("selectedValueChange",function(g){return o._monthSelected(g)})("activeDateChange",function(g){return o._updateActiveDate(g)})("keyup",function(g){return o._handleCalendarBodyKeyup(g)})("keydown",function(g){return o._handleCalendarBodyKeydown(g)}),se()()),n&2&&(Se(4),Xe("label",o._yearLabel)("rows",o._months)("todayValue",o._todayMonth)("startValue",o._selectedMonth)("endValue",o._selectedMonth)("labelMinRequiredCells",2)("numCols",4)("cellAspectRatio",4/7)("activeCell",o._dateAdapter.getMonth(o.activeDate)))},dependencies:[Rv],encapsulation:2,changeDetection:0})}return t})(),NY=(()=>{class t{_intl=J(kv);calendar=J(Y4);_dateAdapter=J(Cl,{optional:!0});_dateFormats=J(Um,{optional:!0});constructor(){J(Vo).load(Hu);let e=J(vr);this.calendar.stateChanges.subscribe(()=>e.markForCheck())}get periodButtonText(){return this.calendar.currentView=="month"?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():this.calendar.currentView=="year"?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRange(...this._formatMinAndMaxYearLabels())}get periodButtonDescription(){return this.calendar.currentView=="month"?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():this.calendar.currentView=="year"?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRangeLabel(...this._formatMinAndMaxYearLabels())}get periodButtonLabel(){return this.calendar.currentView=="month"?this._intl.switchToMultiYearViewLabel:this._intl.switchToMonthViewLabel}get prevButtonLabel(){return{month:this._intl.prevMonthLabel,year:this._intl.prevYearLabel,"multi-year":this._intl.prevMultiYearLabel}[this.calendar.currentView]}get nextButtonLabel(){return{month:this._intl.nextMonthLabel,year:this._intl.nextYearLabel,"multi-year":this._intl.nextMultiYearLabel}[this.calendar.currentView]}currentPeriodClicked(){this.calendar.currentView=this.calendar.currentView=="month"?"multi-year":"month"}previousClicked(){this.calendar.activeDate=this.calendar.currentView=="month"?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,-1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,this.calendar.currentView=="year"?-1:-24)}nextClicked(){this.calendar.activeDate=this.calendar.currentView=="month"?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,this.calendar.currentView=="year"?1:Yh)}previousEnabled(){return this.calendar.minDate?!this.calendar.minDate||!this._isSameView(this.calendar.activeDate,this.calendar.minDate):!0}nextEnabled(){return!this.calendar.maxDate||!this._isSameView(this.calendar.activeDate,this.calendar.maxDate)}_isSameView(e,n){return this.calendar.currentView=="month"?this._dateAdapter.getYear(e)==this._dateAdapter.getYear(n)&&this._dateAdapter.getMonth(e)==this._dateAdapter.getMonth(n):this.calendar.currentView=="year"?this._dateAdapter.getYear(e)==this._dateAdapter.getYear(n):OY(this._dateAdapter,e,n,this.calendar.minDate,this.calendar.maxDate)}_formatMinAndMaxYearLabels(){let n=this._dateAdapter.getYear(this.calendar.activeDate)-Kw(this._dateAdapter,this.calendar.activeDate,this.calendar.minDate,this.calendar.maxDate),o=n+Yh-1,r=this._dateAdapter.getYearName(this._dateAdapter.createDate(n,0,1)),g=this._dateAdapter.getYearName(this._dateAdapter.createDate(o,0,1));return[r,g]}_periodButtonLabelId=J(po).getId("mat-calendar-period-label-");static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-calendar-header"]],exportAs:["matCalendarHeader"],ngContentSelectors:yve,decls:17,vars:11,consts:[[1,"mat-calendar-header"],[1,"mat-calendar-controls"],["aria-live","polite",1,"cdk-visually-hidden",3,"id"],["mat-button","","type","button",1,"mat-calendar-period-button",3,"click"],["aria-hidden","true"],["viewBox","0 0 10 5","focusable","false","aria-hidden","true",1,"mat-calendar-arrow"],["points","0,0 5,5 10,0"],[1,"mat-calendar-spacer"],["mat-icon-button","","type","button",1,"mat-calendar-previous-button",3,"click","disabled"],["viewBox","0 0 24 24","focusable","false","aria-hidden","true"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button",1,"mat-calendar-next-button",3,"click","disabled"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"]],template:function(n,o){n&1&&(Qr(),ae(0,"div",0)(1,"div",1)(2,"span",2),Oe(3),se(),ae(4,"button",3),Nt("click",function(){return o.currentPeriodClicked()}),ae(5,"span",4),Oe(6),se(),gs(),ae(7,"svg",5),jt(8,"polygon",6),se()(),Jg(),jt(9,"div",7),On(10),ae(11,"button",8),Nt("click",function(){return o.previousClicked()}),gs(),ae(12,"svg",9),jt(13,"path",10),se()(),Jg(),ae(14,"button",11),Nt("click",function(){return o.nextClicked()}),gs(),ae(15,"svg",9),jt(16,"path",12),se()()()()),n&2&&(Se(2),Xe("id",o._periodButtonLabelId),Se(),En(o.periodButtonDescription),Se(),un("aria-label",o.periodButtonLabel)("aria-describedby",o._periodButtonLabelId),Se(2),En(o.periodButtonText),Se(),Ji("mat-calendar-invert",o.calendar.currentView!=="month"),Se(4),Xe("disabled",!o.previousEnabled()),un("aria-label",o.prevButtonLabel),Se(3),Xe("disabled",!o.nextEnabled()),un("aria-label",o.nextButtonLabel))},dependencies:[Wl,wl],encapsulation:2,changeDetection:0})}return t})(),Y4=(()=>{class t{_dateAdapter=J(Cl,{optional:!0});_dateFormats=J(Um,{optional:!0});_changeDetectorRef=J(vr);headerComponent;_calendarHeaderPortal;_intlChanges;_moveFocusOnNextTick=!1;get startAt(){return this._startAt}set startAt(e){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_startAt;startView="month";get selected(){return this._selected}set selected(e){e instanceof Xu?this._selected=e:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_selected;get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_minDate;get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_maxDate;dateFilter;dateClass;comparisonStart;comparisonEnd;startDateAccessibleName;endDateAccessibleName;selectedChange=new Mi;yearSelected=new Mi;monthSelected=new Mi;viewChanged=new Mi(!0);_userSelection=new Mi;_userDragDrop=new Mi;monthView;yearView;multiYearView;get activeDate(){return this._clampedActiveDate}set activeDate(e){this._clampedActiveDate=this._dateAdapter.clampDate(e,this.minDate,this.maxDate),this.stateChanges.next(),this._changeDetectorRef.markForCheck()}_clampedActiveDate;get currentView(){return this._currentView}set currentView(e){let n=this._currentView!==e?e:null;this._currentView=e,this._moveFocusOnNextTick=!0,this._changeDetectorRef.markForCheck(),n&&this.viewChanged.emit(n)}_currentView;_activeDrag=null;stateChanges=new gi;constructor(){this._intlChanges=J(kv).changes.subscribe(()=>{this._changeDetectorRef.markForCheck(),this.stateChanges.next()})}ngAfterContentInit(){this._calendarHeaderPortal=new $l(this.headerComponent||NY),this.activeDate=this.startAt||this._dateAdapter.today(),this._currentView=this.startView}ngAfterViewChecked(){this._moveFocusOnNextTick&&(this._moveFocusOnNextTick=!1,this.focusActiveCell())}ngOnDestroy(){this._intlChanges.unsubscribe(),this.stateChanges.complete()}ngOnChanges(e){let n=e.minDate&&!this._dateAdapter.sameDate(e.minDate.previousValue,e.minDate.currentValue)?e.minDate:void 0,o=e.maxDate&&!this._dateAdapter.sameDate(e.maxDate.previousValue,e.maxDate.currentValue)?e.maxDate:void 0,r=n||o||e.dateFilter;if(r&&!r.firstChange){let g=this._getCurrentViewComponent();g&&(this._moveFocusOnNextTick=!0,this._changeDetectorRef.detectChanges(),g._init())}this.stateChanges.next()}focusActiveCell(){this._getCurrentViewComponent()._focusActiveCell(!1)}updateTodaysDate(){this._getCurrentViewComponent()._init()}_dateSelected(e){let n=e.value;(this.selected instanceof Xu||n&&!this._dateAdapter.sameDate(n,this.selected))&&this.selectedChange.emit(n),this._userSelection.emit(e)}_yearSelectedInMultiYearView(e){this.yearSelected.emit(e)}_monthSelectedInYearView(e){this.monthSelected.emit(e)}_goToDateInView(e,n){this.activeDate=e,this.currentView=n}_dragStarted(e){this._activeDrag=e}_dragEnded(e){this._activeDrag&&(e.value&&this._userDragDrop.emit(e),this._activeDrag=null)}_getCurrentViewComponent(){return this.monthView||this.yearView||this.multiYearView}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-calendar"]],viewQuery:function(n,o){if(n&1&&(pr(SY,5),pr(MY,5),pr(DY,5)),n&2){let r;sn(r=ln())&&(o.monthView=r.first),sn(r=ln())&&(o.yearView=r.first),sn(r=ln())&&(o.multiYearView=r.first)}},hostAttrs:[1,"mat-calendar"],inputs:{headerComponent:"headerComponent",startAt:"startAt",startView:"startView",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",_userSelection:"_userSelection",_userDragDrop:"_userDragDrop"},exportAs:["matCalendar"],features:[fr([RY]),$r],decls:5,vars:2,consts:[[3,"cdkPortalOutlet"],["cdkMonitorSubtreeFocus","","tabindex","-1",1,"mat-calendar-content"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass"],[3,"activeDateChange","_userSelection","dragStarted","dragEnded","activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag"],[3,"activeDateChange","monthSelected","selectedChange","activeDate","selected","dateFilter","maxDate","minDate","dateClass"],[3,"activeDateChange","yearSelected","selectedChange","activeDate","selected","dateFilter","maxDate","minDate","dateClass"]],template:function(n,o){if(n&1&&(Tt(0,vve,0,0,"ng-template",0),ae(1,"div",1),Tt(2,bve,1,11,"mat-month-view",2)(3,xve,1,6,"mat-year-view",3)(4,wve,1,6,"mat-multi-year-view",3),se()),n&2){let r;Xe("cdkPortalOutlet",o._calendarHeaderPortal),Se(2),zn((r=o.currentView)==="month"?2:r==="year"?3:r==="multi-year"?4:-1)}},dependencies:[Vu,vL,SY,MY,DY],styles:[`.mat-calendar{display:block;line-height:normal;font-family:var(--mat-datepicker-calendar-text-font, var(--mat-sys-body-medium-font));font-size:var(--mat-datepicker-calendar-text-size, var(--mat-sys-body-medium-size))}.mat-calendar-header{padding:8px 8px 0 8px}.mat-calendar-content{padding:0 8px 8px 8px;outline:none}.mat-calendar-controls{display:flex;align-items:center;margin:5% calc(4.7142857143% - 16px)}.mat-calendar-spacer{flex:1 1 auto}.mat-calendar-period-button{min-width:0;margin:0 8px;font-size:var(--mat-datepicker-calendar-period-button-text-size, var(--mat-sys-title-small-size));font-weight:var(--mat-datepicker-calendar-period-button-text-weight, var(--mat-sys-title-small-weight));--mdc-text-button-label-text-color:var(--mat-datepicker-calendar-period-button-text-color, var(--mat-sys-on-surface-variant))}.mat-calendar-arrow{display:inline-block;width:10px;height:5px;margin:0 0 0 5px;vertical-align:middle;fill:var(--mat-datepicker-calendar-period-button-icon-color, var(--mat-sys-on-surface-variant))}.mat-calendar-arrow.mat-calendar-invert{transform:rotate(180deg)}[dir=rtl] .mat-calendar-arrow{margin:0 5px 0 0}@media(forced-colors: active){.mat-calendar-arrow{fill:CanvasText}}.mat-datepicker-content .mat-calendar-previous-button:not(.mat-mdc-button-disabled),.mat-datepicker-content .mat-calendar-next-button:not(.mat-mdc-button-disabled){color:var(--mat-datepicker-calendar-navigation-button-icon-color, var(--mat-sys-on-surface-variant))}[dir=rtl] .mat-calendar-previous-button,[dir=rtl] .mat-calendar-next-button{transform:rotate(180deg)}.mat-calendar-table{border-spacing:0;border-collapse:collapse;width:100%}.mat-calendar-table-header th{text-align:center;padding:0 0 8px 0;color:var(--mat-datepicker-calendar-header-text-color, var(--mat-sys-on-surface-variant));font-size:var(--mat-datepicker-calendar-header-text-size, var(--mat-sys-title-small-size));font-weight:var(--mat-datepicker-calendar-header-text-weight, var(--mat-sys-title-small-weight))}.mat-calendar-table-header-divider{position:relative;height:1px}.mat-calendar-table-header-divider::after{content:"";position:absolute;top:0;left:-8px;right:-8px;height:1px;background:var(--mat-datepicker-calendar-header-divider-color, transparent)}.mat-calendar-body-cell-content::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px)*-1)}.mat-calendar-body-cell:focus .mat-focus-indicator::before{content:""}
`],encapsulation:2,changeDetection:0})}return t})(),LY=new Ot("mat-datepicker-scroll-strategy",{providedIn:"root",factory:()=>{let t=J(sa);return()=>t.scrollStrategies.reposition()}});function Pve(t){return()=>t.scrollStrategies.reposition()}var Nve={provide:LY,deps:[sa],useFactory:Pve},FY=(()=>{class t{_elementRef=J(Qi);_animationsDisabled=J(oo,{optional:!0})==="NoopAnimations";_changeDetectorRef=J(vr);_globalModel=J(Qw);_dateAdapter=J(Cl);_ngZone=J(Oi);_rangeSelectionStrategy=J(kY,{optional:!0});_stateChanges;_model;_eventCleanups;_animationFallback;_calendar;color;datepicker;comparisonStart;comparisonEnd;startDateAccessibleName;endDateAccessibleName;_isAbove;_animationDone=new gi;_isAnimating=!1;_closeButtonText;_closeButtonFocused;_actionsPortal=null;_dialogLabelId;constructor(){if(J(Vo).load(Hu),this._closeButtonText=J(kv).closeCalendarLabel,!this._animationsDisabled){let e=this._elementRef.nativeElement,n=J(Ko);this._eventCleanups=this._ngZone.runOutsideAngular(()=>[n.listen(e,"animationstart",this._handleAnimationEvent),n.listen(e,"animationend",this._handleAnimationEvent),n.listen(e,"animationcancel",this._handleAnimationEvent)])}}ngAfterViewInit(){this._stateChanges=this.datepicker.stateChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()}),this._calendar.focusActiveCell()}ngOnDestroy(){clearTimeout(this._animationFallback),this._eventCleanups?.forEach(e=>e()),this._stateChanges?.unsubscribe(),this._animationDone.complete()}_handleUserSelection(e){let n=this._model.selection,o=e.value,r=n instanceof Xu;if(r&&this._rangeSelectionStrategy){let g=this._rangeSelectionStrategy.selectionFinished(o,n,e.event);this._model.updateSelection(g,this)}else o&&(r||!this._dateAdapter.sameDate(o,n))&&this._model.add(o);(!this._model||this._model.isComplete())&&!this._actionsPortal&&this.datepicker.close()}_handleUserDragDrop(e){this._model.updateSelection(e.value,this)}_startExitAnimation(){this._elementRef.nativeElement.classList.add("mat-datepicker-content-exit"),this._animationsDisabled?this._animationDone.next():(clearTimeout(this._animationFallback),this._animationFallback=setTimeout(()=>{this._isAnimating||this._animationDone.next()},200))}_handleAnimationEvent=e=>{let n=this._elementRef.nativeElement;e.target!==n||!e.animationName.startsWith("_mat-datepicker-content")||(clearTimeout(this._animationFallback),this._isAnimating=e.type==="animationstart",n.classList.toggle("mat-datepicker-content-animating",this._isAnimating),this._isAnimating||this._animationDone.next())};_getSelected(){return this._model.selection}_applyPendingSelection(){this._model!==this._globalModel&&this._globalModel.updateSelection(this._model.selection,this)}_assignActions(e,n){this._model=e?this._globalModel.clone():this._globalModel,this._actionsPortal=e,n&&this._changeDetectorRef.detectChanges()}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-datepicker-content"]],viewQuery:function(n,o){if(n&1&&pr(Y4,5),n&2){let r;sn(r=ln())&&(o._calendar=r.first)}},hostAttrs:[1,"mat-datepicker-content"],hostVars:6,hostBindings:function(n,o){n&2&&(ql(o.color?"mat-"+o.color:""),Ji("mat-datepicker-content-touch",o.datepicker.touchUi)("mat-datepicker-content-animations-enabled",!o._animationsDisabled))},inputs:{color:"color"},exportAs:["matDatepickerContent"],decls:5,vars:26,consts:[["cdkTrapFocus","","role","dialog",1,"mat-datepicker-content-container"],[3,"yearSelected","monthSelected","viewChanged","_userSelection","_userDragDrop","id","startAt","startView","minDate","maxDate","dateFilter","headerComponent","selected","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName"],[3,"cdkPortalOutlet"],["type","button","mat-raised-button","",1,"mat-datepicker-close-button",3,"focus","blur","click","color"]],template:function(n,o){if(n&1&&(ae(0,"div",0)(1,"mat-calendar",1),Nt("yearSelected",function(g){return o.datepicker._selectYear(g)})("monthSelected",function(g){return o.datepicker._selectMonth(g)})("viewChanged",function(g){return o.datepicker._viewChanged(g)})("_userSelection",function(g){return o._handleUserSelection(g)})("_userDragDrop",function(g){return o._handleUserDragDrop(g)}),se(),Tt(2,Eve,0,0,"ng-template",2),ae(3,"button",3),Nt("focus",function(){return o._closeButtonFocused=!0})("blur",function(){return o._closeButtonFocused=!1})("click",function(){return o.datepicker.close()}),Oe(4),se()()),n&2){let r;Ji("mat-datepicker-content-container-with-custom-header",o.datepicker.calendarHeaderComponent)("mat-datepicker-content-container-with-actions",o._actionsPortal),un("aria-modal",!0)("aria-labelledby",(r=o._dialogLabelId)!==null&&r!==void 0?r:void 0),Se(),ql(o.datepicker.panelClass),Xe("id",o.datepicker.id)("startAt",o.datepicker.startAt)("startView",o.datepicker.startView)("minDate",o.datepicker._getMinDate())("maxDate",o.datepicker._getMaxDate())("dateFilter",o.datepicker._getDateFilter())("headerComponent",o.datepicker.calendarHeaderComponent)("selected",o._getSelected())("dateClass",o.datepicker.dateClass)("comparisonStart",o.comparisonStart)("comparisonEnd",o.comparisonEnd)("startDateAccessibleName",o.startDateAccessibleName)("endDateAccessibleName",o.endDateAccessibleName),Se(),Xe("cdkPortalOutlet",o._actionsPortal),Se(),Ji("cdk-visually-hidden",!o._closeButtonFocused),Xe("color",o.color||"primary"),Se(),En(o._closeButtonText)}},dependencies:[EL,Y4,Vu,Wl],styles:[`@keyframes _mat-datepicker-content-dropdown-enter{from{opacity:0;transform:scaleY(0.8)}to{opacity:1;transform:none}}@keyframes _mat-datepicker-content-dialog-enter{from{opacity:0;transform:scale(0.8)}to{opacity:1;transform:none}}@keyframes _mat-datepicker-content-exit{from{opacity:1}to{opacity:0}}.mat-datepicker-content{display:block;border-radius:4px;background-color:var(--mat-datepicker-calendar-container-background-color, var(--mat-sys-surface-container-high));color:var(--mat-datepicker-calendar-container-text-color, var(--mat-sys-on-surface));box-shadow:var(--mat-datepicker-calendar-container-elevation-shadow, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12));border-radius:var(--mat-datepicker-calendar-container-shape, var(--mat-sys-corner-large))}.mat-datepicker-content.mat-datepicker-content-animations-enabled{animation:_mat-datepicker-content-dropdown-enter 120ms cubic-bezier(0, 0, 0.2, 1)}.mat-datepicker-content .mat-calendar{width:296px;height:354px}.mat-datepicker-content .mat-datepicker-content-container-with-custom-header .mat-calendar{height:auto}.mat-datepicker-content .mat-datepicker-close-button{position:absolute;top:100%;left:0;margin-top:8px}.mat-datepicker-content-animating .mat-datepicker-content .mat-datepicker-close-button{display:none}.mat-datepicker-content-container{display:flex;flex-direction:column;justify-content:space-between}.mat-datepicker-content-touch{display:block;max-height:80vh;box-shadow:var(--mat-datepicker-calendar-container-touch-elevation-shadow, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12));border-radius:var(--mat-datepicker-calendar-container-touch-shape, var(--mat-sys-corner-extra-large));position:relative;overflow:visible}.mat-datepicker-content-touch.mat-datepicker-content-animations-enabled{animation:_mat-datepicker-content-dialog-enter 150ms cubic-bezier(0, 0, 0.2, 1)}.mat-datepicker-content-touch .mat-datepicker-content-container{min-height:312px;max-height:788px;min-width:250px;max-width:750px}.mat-datepicker-content-touch .mat-calendar{width:100%;height:auto}.mat-datepicker-content-exit.mat-datepicker-content-animations-enabled{animation:_mat-datepicker-content-exit 100ms linear}@media all and (orientation: landscape){.mat-datepicker-content-touch .mat-datepicker-content-container{width:64vh;height:80vh}}@media all and (orientation: portrait){.mat-datepicker-content-touch .mat-datepicker-content-container{width:80vw;height:100vw}.mat-datepicker-content-touch .mat-datepicker-content-container-with-actions{height:115vw}}
`],encapsulation:2,changeDetection:0})}return t})(),IY=(()=>{class t{_overlay=J(sa);_viewContainerRef=J(na);_dateAdapter=J(Cl,{optional:!0});_dir=J(aa,{optional:!0});_model=J(Qw);_scrollStrategy=J(LY);_inputStateChanges=nr.EMPTY;_document=J(cn);calendarHeaderComponent;get startAt(){return this._startAt||(this.datepickerInput?this.datepickerInput.getStartValue():null)}set startAt(e){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_startAt;startView="month";get color(){return this._color||(this.datepickerInput?this.datepickerInput.getThemePalette():void 0)}set color(e){this._color=e}_color;touchUi=!1;get disabled(){return this._disabled===void 0&&this.datepickerInput?this.datepickerInput.disabled:!!this._disabled}set disabled(e){e!==this._disabled&&(this._disabled=e,this.stateChanges.next(void 0))}_disabled;xPosition="start";yPosition="below";restoreFocus=!0;yearSelected=new Mi;monthSelected=new Mi;viewChanged=new Mi(!0);dateClass;openedStream=new Mi;closedStream=new Mi;get panelClass(){return this._panelClass}set panelClass(e){this._panelClass=pW(e)}_panelClass;get opened(){return this._opened}set opened(e){e?this.open():this.close()}_opened=!1;id=J(po).getId("mat-datepicker-");_getMinDate(){return this.datepickerInput&&this.datepickerInput.min}_getMaxDate(){return this.datepickerInput&&this.datepickerInput.max}_getDateFilter(){return this.datepickerInput&&this.datepickerInput.dateFilter}_overlayRef;_componentRef;_focusedElementBeforeOpen=null;_backdropHarnessClass=`${this.id}-backdrop`;_actionsPortal;datepickerInput;stateChanges=new gi;_injector=J(wn);_changeDetectorRef=J(vr);constructor(){this._dateAdapter,this._model.selectionChanged.subscribe(()=>{this._changeDetectorRef.markForCheck()})}ngOnChanges(e){let n=e.xPosition||e.yPosition;if(n&&!n.firstChange&&this._overlayRef){let o=this._overlayRef.getConfig().positionStrategy;o instanceof lv&&(this._setConnectedPositions(o),this.opened&&this._overlayRef.updatePosition())}this.stateChanges.next(void 0)}ngOnDestroy(){this._destroyOverlay(),this.close(),this._inputStateChanges.unsubscribe(),this.stateChanges.complete()}select(e){this._model.add(e)}_selectYear(e){this.yearSelected.emit(e)}_selectMonth(e){this.monthSelected.emit(e)}_viewChanged(e){this.viewChanged.emit(e)}registerInput(e){return this.datepickerInput,this._inputStateChanges.unsubscribe(),this.datepickerInput=e,this._inputStateChanges=e.stateChanges.subscribe(()=>this.stateChanges.next(void 0)),this._model}registerActions(e){this._actionsPortal,this._actionsPortal=e,this._componentRef?.instance._assignActions(e,!0)}removeActions(e){e===this._actionsPortal&&(this._actionsPortal=null,this._componentRef?.instance._assignActions(null,!0))}open(){this._opened||this.disabled||this._componentRef?.instance._isAnimating||(this.datepickerInput,this._focusedElementBeforeOpen=jp(),this._openOverlay(),this._opened=!0,this.openedStream.emit())}close(){if(!this._opened||this._componentRef?.instance._isAnimating)return;let e=this.restoreFocus&&this._focusedElementBeforeOpen&&typeof this._focusedElementBeforeOpen.focus=="function",n=()=>{this._opened&&(this._opened=!1,this.closedStream.emit())};if(this._componentRef){let{instance:o,location:r}=this._componentRef;o._animationDone.pipe(ta(1)).subscribe(()=>{let g=this._document.activeElement;e&&(!g||g===this._document.activeElement||r.nativeElement.contains(g))&&this._focusedElementBeforeOpen.focus(),this._focusedElementBeforeOpen=null,this._destroyOverlay()}),o._startExitAnimation()}e?setTimeout(n):n()}_applyPendingSelection(){this._componentRef?.instance?._applyPendingSelection()}_forwardContentValues(e){e.datepicker=this,e.color=this.color,e._dialogLabelId=this.datepickerInput.getOverlayLabelId(),e._assignActions(this._actionsPortal,!1)}_openOverlay(){this._destroyOverlay();let e=this.touchUi,n=new $l(FY,this._viewContainerRef),o=this._overlayRef=this._overlay.create(new Hd({positionStrategy:e?this._getDialogStrategy():this._getDropdownStrategy(),hasBackdrop:!0,backdropClass:[e?"cdk-overlay-dark-backdrop":"mat-overlay-transparent-backdrop",this._backdropHarnessClass],direction:this._dir||"ltr",scrollStrategy:e?this._overlay.scrollStrategies.block():this._scrollStrategy(),panelClass:`mat-datepicker-${e?"dialog":"popup"}`}));this._getCloseStream(o).subscribe(r=>{r&&r.preventDefault(),this.close()}),o.keydownEvents().subscribe(r=>{let g=r.keyCode;(g===38||g===40||g===37||g===39||g===33||g===34)&&r.preventDefault()}),this._componentRef=o.attach(n),this._forwardContentValues(this._componentRef.instance),e||_s(()=>{o.updatePosition()},{injector:this._injector})}_destroyOverlay(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=this._componentRef=null)}_getDialogStrategy(){return this._overlay.position().global().centerHorizontally().centerVertically()}_getDropdownStrategy(){let e=this._overlay.position().flexibleConnectedTo(this.datepickerInput.getConnectedOverlayOrigin()).withTransformOriginOn(".mat-datepicker-content").withFlexibleDimensions(!1).withViewportMargin(8).withLockedPosition();return this._setConnectedPositions(e)}_setConnectedPositions(e){let n=this.xPosition==="end"?"end":"start",o=n==="start"?"end":"start",r=this.yPosition==="above"?"bottom":"top",g=r==="top"?"bottom":"top";return e.withPositions([{originX:n,originY:g,overlayX:n,overlayY:r},{originX:n,originY:r,overlayX:n,overlayY:g},{originX:o,originY:g,overlayX:o,overlayY:r},{originX:o,originY:r,overlayX:o,overlayY:g}])}_getCloseStream(e){let n=["ctrlKey","shiftKey","metaKey"];return ks(e.backdropClick(),e.detachments(),e.keydownEvents().pipe(zr(o=>o.keyCode===27&&!ga(o)||this.datepickerInput&&ga(o,"altKey")&&o.keyCode===38&&n.every(r=>!ga(o,r)))))}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,inputs:{calendarHeaderComponent:"calendarHeaderComponent",startAt:"startAt",startView:"startView",color:"color",touchUi:[2,"touchUi","touchUi",Bi],disabled:[2,"disabled","disabled",Bi],xPosition:"xPosition",yPosition:"yPosition",restoreFocus:[2,"restoreFocus","restoreFocus",Bi],dateClass:"dateClass",panelClass:"panelClass",opened:[2,"opened","opened",Bi]},outputs:{yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",openedStream:"opened",closedStream:"closed"},features:[$r]})}return t})(),zY=(()=>{class t extends IY{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Vr(t)))(o||t)}})();static \u0275cmp=ai({type:t,selectors:[["mat-datepicker"]],exportAs:["matDatepicker"],features:[fr([RY,{provide:IY,useExisting:t}]),Fn],decls:0,vars:0,template:function(n,o){},encapsulation:2,changeDetection:0})}return t})(),Av=class{target;targetElement;value;constructor(i,e){this.target=i,this.targetElement=e,this.value=this.target.value}},Lve=(()=>{class t{_elementRef=J(Qi);_dateAdapter=J(Cl,{optional:!0});_dateFormats=J(Um,{optional:!0});_isInitialized;get value(){return this._model?this._getValueFromModel(this._model.selection):this._pendingValue}set value(e){this._assignValueProgrammatically(e)}_model;get disabled(){return!!this._disabled||this._parentDisabled()}set disabled(e){let n=e,o=this._elementRef.nativeElement;this._disabled!==n&&(this._disabled=n,this.stateChanges.next(void 0)),n&&this._isInitialized&&o.blur&&o.blur()}_disabled;dateChange=new Mi;dateInput=new Mi;stateChanges=new gi;_onTouched=()=>{};_validatorOnChange=()=>{};_cvaOnChange=()=>{};_valueChangesSubscription=nr.EMPTY;_localeSubscription=nr.EMPTY;_pendingValue;_parseValidator=()=>this._lastValueValid?null:{matDatepickerParse:{text:this._elementRef.nativeElement.value}};_filterValidator=e=>{let n=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e.value));return!n||this._matchesFilter(n)?null:{matDatepickerFilter:!0}};_minValidator=e=>{let n=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e.value)),o=this._getMinDate();return!o||!n||this._dateAdapter.compareDate(o,n)<=0?null:{matDatepickerMin:{min:o,actual:n}}};_maxValidator=e=>{let n=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e.value)),o=this._getMaxDate();return!o||!n||this._dateAdapter.compareDate(o,n)>=0?null:{matDatepickerMax:{max:o,actual:n}}};_getValidators(){return[this._parseValidator,this._minValidator,this._maxValidator,this._filterValidator]}_registerModel(e){this._model=e,this._valueChangesSubscription.unsubscribe(),this._pendingValue&&this._assignValue(this._pendingValue),this._valueChangesSubscription=this._model.selectionChanged.subscribe(n=>{if(this._shouldHandleChangeEvent(n)){let o=this._getValueFromModel(n.selection);this._lastValueValid=this._isValidValue(o),this._cvaOnChange(o),this._onTouched(),this._formatValue(o),this.dateInput.emit(new Av(this,this._elementRef.nativeElement)),this.dateChange.emit(new Av(this,this._elementRef.nativeElement))}})}_lastValueValid=!1;constructor(){this._localeSubscription=this._dateAdapter.localeChanges.subscribe(()=>{this._assignValueProgrammatically(this.value)})}ngAfterViewInit(){this._isInitialized=!0}ngOnChanges(e){Fve(e,this._dateAdapter)&&this.stateChanges.next(void 0)}ngOnDestroy(){this._valueChangesSubscription.unsubscribe(),this._localeSubscription.unsubscribe(),this.stateChanges.complete()}registerOnValidatorChange(e){this._validatorOnChange=e}validate(e){return this._validator?this._validator(e):null}writeValue(e){this._assignValueProgrammatically(e)}registerOnChange(e){this._cvaOnChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_onKeydown(e){let n=["ctrlKey","shiftKey","metaKey"];ga(e,"altKey")&&e.keyCode===40&&n.every(r=>!ga(e,r))&&!this._elementRef.nativeElement.readOnly&&(this._openPopup(),e.preventDefault())}_onInput(e){let n=this._lastValueValid,o=this._dateAdapter.parse(e,this._dateFormats.parse.dateInput);this._lastValueValid=this._isValidValue(o),o=this._dateAdapter.getValidDateOrNull(o);let r=!this._dateAdapter.sameDate(o,this.value);!o||r?this._cvaOnChange(o):(e&&!this.value&&this._cvaOnChange(o),n!==this._lastValueValid&&this._validatorOnChange()),r&&(this._assignValue(o),this.dateInput.emit(new Av(this,this._elementRef.nativeElement)))}_onChange(){this.dateChange.emit(new Av(this,this._elementRef.nativeElement))}_onBlur(){this.value&&this._formatValue(this.value),this._onTouched()}_formatValue(e){this._elementRef.nativeElement.value=e!=null?this._dateAdapter.format(e,this._dateFormats.display.dateInput):""}_assignValue(e){this._model?(this._assignValueToModel(e),this._pendingValue=null):this._pendingValue=e}_isValidValue(e){return!e||this._dateAdapter.isValid(e)}_parentDisabled(){return!1}_assignValueProgrammatically(e){e=this._dateAdapter.deserialize(e),this._lastValueValid=this._isValidValue(e),e=this._dateAdapter.getValidDateOrNull(e),this._assignValue(e),this._formatValue(e)}_matchesFilter(e){let n=this._getDateFilter();return!n||n(e)}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,inputs:{value:"value",disabled:[2,"disabled","disabled",Bi]},outputs:{dateChange:"dateChange",dateInput:"dateInput"},features:[$r]})}return t})();function Fve(t,i){let e=Object.keys(t);for(let n of e){let{previousValue:o,currentValue:r}=t[n];if(i.isDateInstance(o)&&i.isDateInstance(r)){if(!i.sameDate(o,r))return!0}else return!0}return!1}var zve={provide:qh,useExisting:Ka(()=>GM),multi:!0},Bve={provide:$d,useExisting:Ka(()=>GM),multi:!0},GM=(()=>{class t extends Lve{_formField=J(zm,{optional:!0});_closedSubscription=nr.EMPTY;_openedSubscription=nr.EMPTY;set matDatepicker(e){e&&(this._datepicker=e,this._ariaOwns.set(e.opened?e.id:null),this._closedSubscription=e.closedStream.subscribe(()=>{this._onTouched(),this._ariaOwns.set(null)}),this._openedSubscription=e.openedStream.subscribe(()=>{this._ariaOwns.set(e.id)}),this._registerModel(e.registerInput(this)))}_datepicker;_ariaOwns=ma(null);get min(){return this._min}set min(e){let n=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e));this._dateAdapter.sameDate(n,this._min)||(this._min=n,this._validatorOnChange())}_min;get max(){return this._max}set max(e){let n=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e));this._dateAdapter.sameDate(n,this._max)||(this._max=n,this._validatorOnChange())}_max;get dateFilter(){return this._dateFilter}set dateFilter(e){let n=this._matchesFilter(this.value);this._dateFilter=e,this._matchesFilter(this.value)!==n&&this._validatorOnChange()}_dateFilter;_validator;constructor(){super(),this._validator=Ti.compose(super._getValidators())}getConnectedOverlayOrigin(){return this._formField?this._formField.getConnectedOverlayOrigin():this._elementRef}getOverlayLabelId(){return this._formField?this._formField.getLabelId():this._elementRef.nativeElement.getAttribute("aria-labelledby")}getThemePalette(){return this._formField?this._formField.color:void 0}getStartValue(){return this.value}ngOnDestroy(){super.ngOnDestroy(),this._closedSubscription.unsubscribe(),this._openedSubscription.unsubscribe()}_openPopup(){this._datepicker&&this._datepicker.open()}_getValueFromModel(e){return e}_assignValueToModel(e){this._model&&this._model.updateSelection(e,this)}_getMinDate(){return this._min}_getMaxDate(){return this._max}_getDateFilter(){return this._dateFilter}_shouldHandleChangeEvent(e){return e.source!==this}static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["input","matDatepicker",""]],hostAttrs:[1,"mat-datepicker-input"],hostVars:6,hostBindings:function(n,o){n&1&&Nt("input",function(g){return o._onInput(g.target.value)})("change",function(){return o._onChange()})("blur",function(){return o._onBlur()})("keydown",function(g){return o._onKeydown(g)}),n&2&&(vs("disabled",o.disabled),un("aria-haspopup",o._datepicker?"dialog":null)("aria-owns",o._ariaOwns())("min",o.min?o._dateAdapter.toIso8601(o.min):null)("max",o.max?o._dateAdapter.toIso8601(o.max):null)("data-mat-calendar",o._datepicker?o._datepicker.id:null))},inputs:{matDatepicker:"matDatepicker",min:"min",max:"max",dateFilter:[0,"matDatepickerFilter","dateFilter"]},exportAs:["matDatepickerInput"],features:[fr([zve,Bve,{provide:qM,useExisting:t}]),Fn]})}return t})(),Vve=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275dir=vi({type:t,selectors:[["","matDatepickerToggleIcon",""]]})}return t})(),K4=(()=>{class t{_intl=J(kv);_changeDetectorRef=J(vr);_stateChanges=nr.EMPTY;datepicker;tabIndex;ariaLabel;get disabled(){return this._disabled===void 0&&this.datepicker?this.datepicker.disabled:!!this._disabled}set disabled(e){this._disabled=e}_disabled;disableRipple;_customIcon;_button;constructor(){let e=J(new Ru("tabindex"),{optional:!0}),n=Number(e);this.tabIndex=n||n===0?n:null}ngOnChanges(e){e.datepicker&&this._watchStateChanges()}ngOnDestroy(){this._stateChanges.unsubscribe()}ngAfterContentInit(){this._watchStateChanges()}_open(e){this.datepicker&&!this.disabled&&(this.datepicker.open(),e.stopPropagation())}_watchStateChanges(){let e=this.datepicker?this.datepicker.stateChanges:Ni(),n=this.datepicker&&this.datepicker.datepickerInput?this.datepicker.datepickerInput.stateChanges:Ni(),o=this.datepicker?ks(this.datepicker.openedStream,this.datepicker.closedStream):Ni();this._stateChanges.unsubscribe(),this._stateChanges=ks(this._intl.changes,e,n,o).subscribe(()=>this._changeDetectorRef.markForCheck())}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-datepicker-toggle"]],contentQueries:function(n,o,r){if(n&1&&ao(r,Vve,5),n&2){let g;sn(g=ln())&&(o._customIcon=g.first)}},viewQuery:function(n,o){if(n&1&&pr(Cve,5),n&2){let r;sn(r=ln())&&(o._button=r.first)}},hostAttrs:[1,"mat-datepicker-toggle"],hostVars:8,hostBindings:function(n,o){n&1&&Nt("click",function(g){return o._open(g)}),n&2&&(un("tabindex",null)("data-mat-calendar",o.datepicker?o.datepicker.id:null),Ji("mat-datepicker-toggle-active",o.datepicker&&o.datepicker.opened)("mat-accent",o.datepicker&&o.datepicker.color==="accent")("mat-warn",o.datepicker&&o.datepicker.color==="warn"))},inputs:{datepicker:[0,"for","datepicker"],tabIndex:"tabIndex",ariaLabel:[0,"aria-label","ariaLabel"],disabled:[2,"disabled","disabled",Bi],disableRipple:"disableRipple"},exportAs:["matDatepickerToggle"],features:[$r],ngContentSelectors:Tve,decls:4,vars:7,consts:[["button",""],["mat-icon-button","","type","button",3,"disabled","disableRipple"],["viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false","aria-hidden","true",1,"mat-datepicker-toggle-default-icon"],["d","M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"]],template:function(n,o){n&1&&(Qr(Sve),ae(0,"button",1,0),Tt(2,Dve,2,0,":svg:svg",2),On(3),se()),n&2&&(Xe("disabled",o.disabled)("disableRipple",o.disableRipple),un("aria-haspopup",o.datepicker?"dialog":null)("aria-label",o.ariaLabel||o._intl.openCalendarLabel)("tabindex",o.disabled?-1:o.tabIndex)("aria-expanded",o.datepicker?o.datepicker.opened:null),Se(2),zn(o._customIcon?-1:2))},dependencies:[wl],styles:[`.mat-datepicker-toggle{pointer-events:auto;color:var(--mat-datepicker-toggle-icon-color, var(--mat-sys-on-surface-variant))}.mat-datepicker-toggle-active{color:var(--mat-datepicker-toggle-active-state-icon-color, var(--mat-sys-on-surface-variant))}@media(forced-colors: active){.mat-datepicker-toggle-default-icon{color:CanvasText}}
`],encapsulation:2,changeDetection:0})}return t})();var WM=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({providers:[kv,Nve],imports:[Fs,au,T0,ju,Wn,FY,K4,NY,Hp]})}return t})();var ZM=class t{constructor(i){this.http=i}apiUrl=`${es.urlBack}/report-status-histories`;getAllHistories(i=1,e=20){let n=new ws().set("page",i).set("size",e);return this.http.get(this.apiUrl,{params:n,withCredentials:!0})}getByReportId(i,e=1,n=20){let o=new ws().set("page",e).set("size",n);return this.http.get(`${this.apiUrl}/by-report`,{params:o.set("reportId",i),withCredentials:!0})}getByUserId(i,e=1,n=20){let o=new ws().set("page",e).set("size",n);return this.http.get(`${this.apiUrl}/by-user`,{params:o.set("userId",i),withCredentials:!0})}getByPreviousStatus(i,e=1,n=20){let o=new ws().set("page",e).set("size",n);return this.http.get(`${this.apiUrl}/by-previous-status`,{params:o.set("previousStatus",i),withCredentials:!0})}getByNewStatus(i,e=1,n=20){let o=new ws().set("page",e).set("size",n);return this.http.get(`${this.apiUrl}/by-new-satatus`,{params:o.set("newStatus",i),withCredentials:!0})}getByStatus(i,e,n=1,o=20){return i&&!e?this.getByPreviousStatus(i,n,o):!i&&e?this.getByNewStatus(e,n,o):this.getAllHistories(n,o)}static \u0275fac=function(e){return new(e||t)(bi(Qa))};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})};var Uve=()=>[10,20,50,100],BY=(t,i,e,n,o)=>({"status-pending":t,"status-rejected":i,"status-verified":e,"status-resolved":n,"status-na":o});function Hve(t,i){t&1&&(Xn(0),ae(1,"mat-form-field",3)(2,"mat-label"),Oe(3,"ID de Reporte"),se(),jt(4,"input",16),se(),Qn())}function qve(t,i){t&1&&(Xn(0),ae(1,"mat-form-field",3)(2,"mat-label"),Oe(3,"ID de Usuario"),se(),jt(4,"input",17),se(),Qn())}function $ve(t,i){t&1&&(Xn(0),ae(1,"mat-form-field",3)(2,"mat-label"),Oe(3,"Estado Anterior"),se(),ae(4,"mat-select",18)(5,"mat-option",19),Oe(6,"PENDING"),se(),ae(7,"mat-option",20),Oe(8,"DELETED"),se(),ae(9,"mat-option",21),Oe(10,"VERIFIED"),se(),ae(11,"mat-option",22),Oe(12,"RESOLVED"),se(),ae(13,"mat-option",23),Oe(14,"REJECTED"),se()()(),Qn())}function Gve(t,i){t&1&&(Xn(0),ae(1,"mat-form-field",3)(2,"mat-label"),Oe(3,"Estado Nuevo"),se(),ae(4,"mat-select",24)(5,"mat-option",19),Oe(6,"PENDING"),se(),ae(7,"mat-option",20),Oe(8,"DELETED"),se(),ae(9,"mat-option",21),Oe(10,"VERIFIED"),se(),ae(11,"mat-option",22),Oe(12,"RESOLVED"),se(),ae(13,"mat-option",23),Oe(14,"REJECTED"),se()()(),Qn())}function Wve(t,i){t&1&&(ae(0,"div",14),jt(1,"mat-spinner",25),ae(2,"span"),Oe(3,"Cargando historial..."),se()())}function Zve(t,i){t&1&&(ae(0,"th",38),Oe(1,"ID"),se())}function Yve(t,i){if(t&1&&(ae(0,"td",39),Oe(1),se()),t&2){let e=i.$implicit;Se(),En(e.id)}}function Kve(t,i){t&1&&(ae(0,"th",38),Oe(1,"Reporte ID"),se())}function Xve(t,i){if(t&1&&(ae(0,"td",39),Oe(1),se()),t&2){let e=i.$implicit;Se(),En(e.reportId)}}function Qve(t,i){t&1&&(ae(0,"th",38),Oe(1,"Usuario ID"),se())}function Jve(t,i){if(t&1&&(ae(0,"td",39),Oe(1),se()),t&2){let e=i.$implicit;Se(),En(e.userId)}}function ebe(t,i){t&1&&(ae(0,"th",38),Oe(1,"Estado Anterior"),se())}function tbe(t,i){if(t&1&&(ae(0,"td",39)(1,"span",40),Oe(2),se()()),t&2){let e=i.$implicit;Se(),Xe("ngClass",wO(2,BY,e.previousStatus==="PENDING",e.previousStatus==="REJECTED",e.previousStatus==="VERIFIED",e.previousStatus==="RESOLVED",!e.previousStatus)),Se(),an(" ",e.previousStatus||"N/A"," ")}}function ibe(t,i){t&1&&(ae(0,"th",38),Oe(1,"Estado Nuevo"),se())}function nbe(t,i){if(t&1&&(ae(0,"td",39)(1,"span",40),Oe(2),se()()),t&2){let e=i.$implicit;Se(),Xe("ngClass",wO(2,BY,e.newStatus==="PENDING",e.newStatus==="REJECTED",e.newStatus==="VERIFIED",e.newStatus==="RESOLVED",!e.newStatus)),Se(),an(" ",e.newStatus||"N/A"," ")}}function rbe(t,i){t&1&&(ae(0,"th",38),Oe(1,"Fecha Cambio"),se())}function obe(t,i){if(t&1&&(ae(0,"td",39),Oe(1),bc(2,"date"),se()),t&2){let e=i.$implicit;Se(),En(Oh(2,1,e.changedAt,"medium"))}}function abe(t,i){t&1&&jt(0,"tr",41)}function sbe(t,i){t&1&&jt(0,"tr",42)}function lbe(t,i){if(t&1){let e=zi();ae(0,"div",15)(1,"table",26),Xn(2,27),Tt(3,Zve,2,0,"th",28)(4,Yve,2,1,"td",29),Qn(),Xn(5,30),Tt(6,Kve,2,0,"th",28)(7,Xve,2,1,"td",29),Qn(),Xn(8,31),Tt(9,Qve,2,0,"th",28)(10,Jve,2,1,"td",29),Qn(),Xn(11,32),Tt(12,ebe,2,0,"th",28)(13,tbe,3,8,"td",29),Qn(),Xn(14,33),Tt(15,ibe,2,0,"th",28)(16,nbe,3,8,"td",29),Qn(),Xn(17,34),Tt(18,rbe,2,0,"th",28)(19,obe,3,4,"td",29),Qn(),Tt(20,abe,1,0,"tr",35)(21,sbe,1,0,"tr",36),se(),ae(22,"mat-paginator",37),Nt("page",function(o){ri(e);let r=zt();return oi(r.onPageChange(o))}),se()()}if(t&2){let e=zt();Se(),Xe("dataSource",e.paginatedData().content),Se(19),Xe("matHeaderRowDef",e.displayedColumns),Se(),Xe("matRowDefColumns",e.displayedColumns),Se(),Xe("length",e.paginatedData().totalElements)("pageSize",e.paginatedData().size)("pageSizeOptions",Py(7,Uve))("pageIndex",e.paginatedData().page-1)}}var YM=class t{historyService=J(ZM);notificationService=J(fo);fb=J(ns);router=J($n);loading=ma(!1);paginatedData=ma({content:[],page:0,size:20,totalElements:0,totalPages:0});statusOptions=[{value:"",display:"Todos"},{value:"PENDING",display:"Pendiente"},{value:"DELETED",display:"Eliminado"},{value:"VERIFIED",display:"Verificado"},{value:"RESOLVED",display:"Resuelto"},{value:"REJECTED",display:"Rechazado"}];filterForm=this.fb.group({filterType:["all"],reportId:[""],userId:[""],previousStatus:[""],newStatus:[""],startDate:[""],endDate:[""]});displayedColumns=["id","reportId","userId","previousStatus","newStatus","changedAt"];ngOnInit(){this.loadAllHistories(1,20)}loadAllHistories(i,e){this.loading.set(!0),this.historyService.getAllHistories(i,e).subscribe({next:n=>this.handleSuccessResponse(n),error:n=>this.handleError(n)})}loadByReportId(i,e,n){this.loading.set(!0),this.historyService.getByReportId(i,e,n).subscribe({next:o=>this.handleSuccessResponse(o),error:o=>this.handleError(o)})}loadByUserId(i,e,n){this.loading.set(!0),this.historyService.getByUserId(i,e,n).subscribe({next:o=>this.handleSuccessResponse(o),error:o=>this.handleError(o)})}loadByPreviousStatus(i,e,n){this.loading.set(!0),this.historyService.getByPreviousStatus(i,e,n).subscribe({next:o=>this.handleSuccessResponse(o),error:o=>this.handleError(o)})}loadByNewStatus(i,e,n){this.loading.set(!0),this.historyService.getByNewStatus(i,e,n).subscribe({next:o=>this.handleSuccessResponse(o),error:o=>this.handleError(o)})}loadByBothStatuses(i,e,n,o){this.loading.set(!0),this.historyService.getByStatus(i,e,n,o).subscribe({next:r=>this.handleSuccessResponse(r),error:r=>this.handleError(r)})}handleSuccessResponse(i){this.paginatedData.set(ji(It({},i),{content:i.content.map(e=>ji(It({},e),{changedAt:new Date(e.changedAt)}))})),this.loading.set(!1)}handleError(i){console.error("Error cargando historiales",i),this.notificationService.error("No se pudo cargar el historial."),this.loading.set(!1)}onPageChange(i){let g=this.filterForm.value,{filterType:e}=g,n=Ys(g,["filterType"]),o=i.pageIndex+1,r=i.pageSize;switch(e){case"by-report":this.loadByReportId(n.reportId,o,r);break;case"by-user":this.loadByUserId(n.userId,o,r);break;case"by-previous-status":this.loadByPreviousStatus(n.previousStatus,o,r);break;case"by-new-status":this.loadByNewStatus(n.newStatus,o,r);break;case"by-status":this.loadByBothStatuses(n.previousStatus,n.newStatus,o,r);break;default:this.loadAllHistories(o,r)}}applyFilters(){let i=this.filterForm.value,e=1,n=this.paginatedData().size;switch(i.filterType){case"by-report":if(!i.reportId){this.notificationService.error("Debe ingresar un ID de reporte");return}this.loadByReportId(i.reportId,e,n);break;case"by-user":if(!i.userId){this.notificationService.error("Debe ingresar un ID de usuario");return}this.loadByUserId(i.userId,e,n);break;case"by-previous-status":this.loadByPreviousStatus(i.previousStatus||"",e,n);break;case"by-new-status":this.loadByNewStatus(i.newStatus||"",e,n);break;case"by-status":this.loadByBothStatuses(i.previousStatus||"",i.newStatus||"",e,n);break;default:this.loadAllHistories(e,n)}}clearFilters(){this.filterForm.reset({filterType:"all"}),this.loadAllHistories(1,this.paginatedData().size)}goBack(){this.router.navigate(["/map"])}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ai({type:t,selectors:[["app-history-list"]],decls:40,vars:9,consts:[["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],[1,"filter-form",3,"ngSubmit","formGroup"],[1,"filter-row"],["appearance","outline"],["formControlName","filterType"],["value","all"],["value","by-report"],["value","by-user"],["value","by-previous-status"],["value","by-new-status"],[4,"ngIf"],[1,"filter-actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-button","","type","button",3,"click","disabled"],[1,"loading-section"],[1,"table-container"],["matInput","","formControlName","reportId","required",""],["matInput","","formControlName","userId","required",""],["formControlName","previousStatus"],["value","PENDING"],["value","DELETED"],["value","VERIFIED"],["value","RESOLVED"],["value","REJECTED"],["formControlName","newStatus"],["diameter","40"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","reportId"],["matColumnDef","userId"],["matColumnDef","previousStatus"],["matColumnDef","newStatus"],["matColumnDef","changedAt"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Seleccionar p\xE1gina",3,"page","length","pageSize","pageSizeOptions","pageIndex"],["mat-header-cell",""],["mat-cell",""],[3,"ngClass"],["mat-header-row",""],["mat-row",""]],template:function(e,n){if(e&1&&(ae(0,"button",0),Nt("click",function(){return n.goBack()}),ae(1,"mat-icon"),Oe(2,"arrow_back"),se()(),ae(3,"mat-card")(4,"mat-card-header")(5,"mat-card-title"),Oe(6,"Historial de Cambios de Estado"),se()(),jt(7,"br"),ae(8,"mat-card-content")(9,"form",1),Nt("ngSubmit",function(){return n.applyFilters()}),ae(10,"div",2)(11,"mat-form-field",3)(12,"mat-label"),Oe(13,"Tipo de Filtro"),se(),ae(14,"mat-select",4)(15,"mat-option",5),Oe(16,"Todos los historiales"),se(),ae(17,"mat-option",6),Oe(18,"Por Reporte"),se(),ae(19,"mat-option",7),Oe(20,"Por Usuario"),se(),ae(21,"mat-option",8),Oe(22,"Por Estado Anterior"),se(),ae(23,"mat-option",9),Oe(24,"Por Nuevo Estado"),se()()(),Tt(25,Hve,5,0,"ng-container",10)(26,qve,5,0,"ng-container",10)(27,$ve,15,0,"ng-container",10)(28,Gve,15,0,"ng-container",10),se(),ae(29,"div",11)(30,"button",12)(31,"mat-icon"),Oe(32,"search"),se(),Oe(33," Filtrar "),se(),ae(34,"button",13),Nt("click",function(){return n.clearFilters()}),ae(35,"mat-icon"),Oe(36,"clear"),se(),Oe(37," Limpiar "),se()()(),Tt(38,Wve,4,0,"div",14)(39,lbe,23,8,"div",15),se()()),e&2){let o,r,g,w;Se(9),Xe("formGroup",n.filterForm),Se(16),Xe("ngIf",((o=n.filterForm.get("filterType"))==null?null:o.value)==="by-report"),Se(),Xe("ngIf",((r=n.filterForm.get("filterType"))==null?null:r.value)==="by-user"),Se(),Xe("ngIf",((g=n.filterForm.get("filterType"))==null?null:g.value)==="by-previous-status"),Se(),Xe("ngIf",((w=n.filterForm.get("filterType"))==null?null:w.value)==="by-new-status"),Se(2),Xe("disabled",n.loading()||n.filterForm.invalid),Se(4),Xe("disabled",n.loading()),Se(4),zn(n.loading()?38:-1),Se(),zn(n.loading()?-1:39)}},dependencies:[Or,Js,Er,Ld,Yu,Zu,Vm,jm,Bm,Sv,Zh,Ku,Fm,Dm,Im,Om,Am,Mm,Pm,Rm,km,Nm,Lm,Ev,V0,El,du,Zd,Mv,Dv,Fs,Wl,wl,rs,Uo,Kd,Zp,Yd,WM,Sm,is,jo,la,ts,n4,Ta,ko,Ua,nu],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c;--resolve-color: #26a69a;--table-header-bg: #d0eaf5;--table-row-hover: #f2faff}mat-card[_ngcontent-%COMP%]{margin:1.5rem auto;padding:1rem;background:var(--input-bg);border-radius:8px;box-shadow:0 4px 12px #0000000d}mat-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:.5rem;color:var(--primary-dark);font-size:20px}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:40px 0}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th.mat-header-cell[_ngcontent-%COMP%]{background:var(--table-header-bg);font-weight:600;padding:8px}td.mat-cell[_ngcontent-%COMP%]{padding:8px;border-bottom:1px solid #eee}tr.mat-row[_ngcontent-%COMP%]:hover{background:var(--table-row-hover);transition:background .2s}.status-pending[_ngcontent-%COMP%], .status-rejected[_ngcontent-%COMP%], .status-verified[_ngcontent-%COMP%], .status-resolved[_ngcontent-%COMP%]{display:inline-block;padding:4px 8px;border-radius:4px;font-weight:600;font-size:12px;text-transform:uppercase}.status-pending[_ngcontent-%COMP%]{background:#fff59d;color:#444}.status-rejected[_ngcontent-%COMP%]{background:#ef9a9a;color:#fff}.status-verified[_ngcontent-%COMP%]{background:#a5d6a7;color:#fff}.status-resolved[_ngcontent-%COMP%]{background:#81d4fa;color:#fff}mat-paginator[_ngcontent-%COMP%]{margin-top:1rem}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;background-color:#fff;border-radius:50%;box-shadow:0 2px 6px #0003}"]})};var cbe=["mat-internal-form-field",""],ube=["*"],VY=(()=>{class t{labelPosition;static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["div","mat-internal-form-field",""]],hostAttrs:[1,"mdc-form-field","mat-internal-form-field"],hostVars:2,hostBindings:function(n,o){n&2&&Ji("mdc-form-field--align-end",o.labelPosition==="before")},inputs:{labelPosition:"labelPosition"},attrs:cbe,ngContentSelectors:ube,decls:1,vars:0,template:function(n,o){n&1&&(Qr(),On(0))},styles:[`.mat-internal-form-field{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:inline-flex;align-items:center;vertical-align:middle}.mat-internal-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mat-internal-form-field>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end .mdc-form-field--align-end label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0}
`],encapsulation:2,changeDetection:0})}return t})();var dbe=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/,hbe=/^(\d?\d)[:.](\d?\d)(?:[:.](\d?\d))?\s*(AM|PM)?$/i;function X4(t,i){let e=Array(t);for(let n=0;n<t;n++)e[n]=i(n);return e}var pbe=(()=>{class t extends Cl{useUtcForDisplay=!1;_matDateLocale=J(U4,{optional:!0});constructor(){super();let e=J(U4,{optional:!0});e!==void 0&&(this._matDateLocale=e),super.setLocale(this._matDateLocale)}getYear(e){return e.getFullYear()}getMonth(e){return e.getMonth()}getDate(e){return e.getDate()}getDayOfWeek(e){return e.getDay()}getMonthNames(e){let n=new Intl.DateTimeFormat(this.locale,{month:e,timeZone:"utc"});return X4(12,o=>this._format(n,new Date(2017,o,1)))}getDateNames(){let e=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return X4(31,n=>this._format(e,new Date(2017,0,n+1)))}getDayOfWeekNames(e){let n=new Intl.DateTimeFormat(this.locale,{weekday:e,timeZone:"utc"});return X4(7,o=>this._format(n,new Date(2017,0,o+1)))}getYearName(e){let n=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._format(n,e)}getFirstDayOfWeek(){if(typeof Intl<"u"&&Intl.Locale){let e=new Intl.Locale(this.locale),n=(e.getWeekInfo?.()||e.weekInfo)?.firstDay??0;return n===7?0:n}return 0}getNumDaysInMonth(e){return this.getDate(this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+1,0))}clone(e){return new Date(e.getTime())}createDate(e,n,o){let r=this._createDateWithOverflow(e,n,o);return r.getMonth()!=n,r}today(){return new Date}parse(e,n){return typeof e=="number"?new Date(e):e?new Date(Date.parse(e)):null}format(e,n){if(!this.isValid(e))throw Error("NativeDateAdapter: Cannot format invalid date.");let o=new Intl.DateTimeFormat(this.locale,ji(It({},n),{timeZone:"utc"}));return this._format(o,e)}addCalendarYears(e,n){return this.addCalendarMonths(e,n*12)}addCalendarMonths(e,n){let o=this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+n,this.getDate(e));return this.getMonth(o)!=((this.getMonth(e)+n)%12+12)%12&&(o=this._createDateWithOverflow(this.getYear(o),this.getMonth(o),0)),o}addCalendarDays(e,n){return this._createDateWithOverflow(this.getYear(e),this.getMonth(e),this.getDate(e)+n)}toIso8601(e){return[e.getUTCFullYear(),this._2digit(e.getUTCMonth()+1),this._2digit(e.getUTCDate())].join("-")}deserialize(e){if(typeof e=="string"){if(!e)return null;if(dbe.test(e)){let n=new Date(e);if(this.isValid(n))return n}}return super.deserialize(e)}isDateInstance(e){return e instanceof Date}isValid(e){return!isNaN(e.getTime())}invalid(){return new Date(NaN)}setTime(e,n,o,r){let g=this.clone(e);return g.setHours(n,o,r,0),g}getHours(e){return e.getHours()}getMinutes(e){return e.getMinutes()}getSeconds(e){return e.getSeconds()}parseTime(e,n){if(typeof e!="string")return e instanceof Date?new Date(e.getTime()):null;let o=e.trim();if(o.length===0)return null;let r=this._parseTimeString(o);if(r===null){let g=o.replace(/[^0-9:(AM|PM)]/gi,"").trim();g.length>0&&(r=this._parseTimeString(g))}return r||this.invalid()}addSeconds(e,n){return new Date(e.getTime()+n*1e3)}_createDateWithOverflow(e,n,o){let r=new Date;return r.setFullYear(e,n,o),r.setHours(0,0,0,0),r}_2digit(e){return("00"+e).slice(-2)}_format(e,n){let o=new Date;return o.setUTCFullYear(n.getFullYear(),n.getMonth(),n.getDate()),o.setUTCHours(n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()),e.format(o)}_parseTimeString(e){let n=e.toUpperCase().match(hbe);if(n){let o=parseInt(n[1]),r=parseInt(n[2]),g=n[3]==null?void 0:parseInt(n[3]),w=n[4];if(o===12?o=w==="AM"?0:o:w==="PM"&&(o+=12),Q4(o,0,23)&&Q4(r,0,59)&&(g==null||Q4(g,0,59)))return this.setTime(this.today(),o,r,g||0)}return null}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})();function Q4(t,i,e){return!isNaN(t)&&t>=i&&t<=e}var fbe={parse:{dateInput:null,timeInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},timeInput:{hour:"numeric",minute:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"},timeOptionLabel:{hour:"numeric",minute:"numeric"}}};var jY=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({providers:[mbe()]})}return t})();function mbe(t=fbe){return[{provide:Cl,useClass:pbe},{provide:Um,useValue:t}]}var HY=K_(UY());var KM=K_(vv());function gbe(t,i){if(t&1&&(ae(0,"mat-error"),Oe(1),se()),t&2){let e=zt();Se(),an(" ",e.filterForm.getError("dateOrder")," ")}}function _be(t,i){t&1&&jt(0,"mat-spinner",12)}function ybe(t,i){if(t&1){let e=zi();ae(0,"mat-chip-option",25),Nt("click",function(){let o=ri(e).$implicit,r=zt(2);return oi(r.toggleCategory(o.id))}),Oe(1),se()}if(t&2){let e=i.$implicit,n=zt(2);Xe("selected",n.isSelected(e.id)),Se(),an(" ",e.name," ")}}function vbe(t,i){t&1&&(ae(0,"mat-error"),Oe(1," Debes seleccionar al menos una categor\xEDa "),se())}function bbe(t,i){if(t&1&&(ae(0,"div",22)(1,"mat-chip-listbox",23),Tt(2,ybe,2,2,"mat-chip-option",24),se()(),Tt(3,vbe,2,0,"mat-error")),t&2){let e,n=zt();Se(),Xe("multiple",!0),Se(),Xe("ngForOf",n.categories),Se(),zn((e=n.filterForm.get("categoryIds"))!=null&&e.invalid&&((e=n.filterForm.get("categoryIds"))!=null&&e.touched)?3:-1)}}function xbe(t,i){t&1&&(ae(0,"mat-error"),Oe(1," La latitud debe estar entre -90 y 90 "),se())}function wbe(t,i){t&1&&(ae(0,"mat-error"),Oe(1," La longitud debe estar entre -180 y 180 "),se())}function Ebe(t,i){t&1&&(ae(0,"mat-error"),Oe(1," El radio debe ser un n\xFAmero positivo "),se())}function Cbe(t,i){t&1&&jt(0,"mat-spinner",26)}var XM=class t{fb=J(ns);http=J(Qa);categoryService=J(Gu);snackBar=J(L0);loading=!1;categories=[];loadingCategories=!1;map;radiusMarker=null;isMapInitialized=!1;router=J($n);filterForm=this.fb.group({startDate:new Ro(null),endDate:new Ro(null),categoryIds:new Ro([],{validators:[Ti.minLength(1)]}),centerLat:new Ro(null,{validators:[Ti.min(-90),Ti.max(90)]}),centerLng:new Ro(null,{validators:[Ti.min(-180),Ti.max(180)]}),radiusKm:new Ro(null,{validators:[Ti.min(0)]})});ngOnInit(){this.loadCategories()}ngAfterViewInit(){this.initializeMap()}ngOnDestroy(){this.map&&this.map.remove()}initializeMap(){let i=sessionStorage.getItem("lat"),e=sessionStorage.getItem("lng"),n,o;i&&e?(n={lng:parseFloat(e),lat:parseFloat(i)},o=13):(n={lng:-75.681,lat:4.533},o=13),this.map=new KM.default.Map({accessToken:es.mapboxToken,container:"map-container",style:"mapbox://styles/mapbox/streets-v11",center:n,zoom:13}),this.map.addControl(new KM.default.NavigationControl,"top-right"),this.map.on("load",()=>{this.isMapInitialized=!0,this.setupRadiusSelection()}),this.filterForm.value.centerLat&&this.filterForm.value.centerLng&&this.updateMapWithCurrentValues()}setupRadiusSelection(){let i=!1,e=this.filterForm.value.radiusKm||5;this.map.on("click",n=>{let{lng:o,lat:r}=n.lngLat;this.filterForm.patchValue({centerLng:o,centerLat:r,radiusKm:e}),this.drawRadiusCircle([o,r],e)}),this.map.on("mousedown",()=>{i=!0}),this.map.on("mouseup",()=>{i=!1}),this.map.on("mousemove",n=>{if(!i||!this.radiusMarker)return;let o=this.radiusMarker.getLngLat(),r=c4([o.lng,o.lat],[n.lngLat.lng,n.lngLat.lat],{units:"kilometers"});e=Math.max(.1,r),this.filterForm.patchValue({radiusKm:e}),this.drawRadiusCircle([o.lng,o.lat],e)})}drawRadiusCircle(i,e){this.map.getLayer("radius-fill")&&this.map.removeLayer("radius-fill"),this.map.getLayer("radius-outline")&&this.map.removeLayer("radius-outline"),this.map.getSource("radius")&&this.map.removeSource("radius"),this.radiusMarker&&this.radiusMarker.remove();let n=Uw(i,e,{steps:64,units:"kilometers"});this.map.addSource("radius",{type:"geojson",data:n}),this.map.addLayer({id:"radius-fill",type:"fill",source:"radius",paint:{"fill-color":"#4285F4","fill-opacity":.2}}),this.map.addLayer({id:"radius-outline",type:"line",source:"radius",paint:{"line-color":"#4285F4","line-width":2}}),this.radiusMarker=new KM.default.Marker({draggable:!0,color:"#4285F4"}).setLngLat(i).addTo(this.map),this.radiusMarker.on("drag",()=>{let o=this.radiusMarker.getLngLat();this.filterForm.patchValue({centerLng:o.lng,centerLat:o.lat}),this.drawRadiusCircle([o.lng,o.lat],e)})}updateMapWithCurrentValues(){if(!this.isMapInitialized)return;let{centerLat:i,centerLng:e,radiusKm:n}=this.filterForm.value;if(i&&e){let o=[e,i];this.map.flyTo({center:o,zoom:12}),n&&this.drawRadiusCircle(o,n)}}loadCategories(){this.loadingCategories=!0,this.categoryService.getAllActiveCategories().subscribe({next:i=>{this.categories=i,this.loadingCategories=!1},error:i=>{console.error("Error cargando categor\xEDas",i),this.snackBar.open("Error al cargar categor\xEDas","Cerrar",{duration:3e3}),this.loadingCategories=!1}})}toggleCategory(i){let e=this.filterForm.get("categoryIds"),n=e?.value||[],o=n.indexOf(i);o>-1?n.splice(o,1):n.push(i),e?.setValue([...n])}isSelected(i){return(this.filterForm.get("categoryIds")?.value||[]).includes(i)}generateReport(){if(this.filterForm.invalid)return;this.loading=!0;let i=this.filterForm.value,e={startDate:i.startDate?new Date(i.startDate).toISOString():null,endDate:i.endDate?new Date(i.endDate).toISOString():null,categoryIds:i.categoryIds||[],center:i.centerLat&&i.centerLng?{type:"Point",coordinates:[i.centerLng,i.centerLat]}:null,radiusKm:i.radiusKm||null},n=Object.fromEntries(Object.entries(e).filter(([o,r])=>r!==null));this.http.post(`${es.urlBack}/admin/reportSummaries/pdf`,n,{params:{page:1,size:20},responseType:"arraybuffer",withCredentials:!0}).subscribe({next:o=>{let r=new Blob([o],{type:"application/pdf"});(0,HY.saveAs)(r,`reporte_${new Date().toISOString().split("T")[0]}.pdf`),this.loading=!1},error:o=>{console.error("Error generando PDF",o),this.snackBar.open("Error generando PDF","Cerrar",{duration:3e3}),this.loading=!1}})}goBack(){this.router.navigate(["/map"])}clearFilters(){this.filterForm.reset({startDate:null,endDate:null,categoryIds:[],centerLat:null,centerLng:null,radiusKm:null}),this.isMapInitialized&&(["radius-fill","radius-outline"].forEach(i=>{this.map.getLayer(i)&&this.map.removeLayer(i)}),this.map.getSource("radius")&&this.map.removeSource("radius"),this.radiusMarker&&(this.radiusMarker.remove(),this.radiusMarker=null))}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ai({type:t,selectors:[["app-report-pdf-generator"]],decls:67,vars:13,consts:[["startPicker",""],["endPicker",""],["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],[1,"contenedor"],[3,"ngSubmit","formGroup"],[1,"filter-section"],[1,"date-filters"],["appearance","fill"],["matInput","","formControlName","startDate","placeholder","YYYY-MM-DD",3,"matDatepicker"],["matSuffix","",3,"for"],["matInput","","formControlName","endDate","placeholder","YYYY-MM-DD",3,"matDatepicker"],[4,"ngIf"],["diameter","30"],["id","map-container",1,"map-container"],[1,"location-inputs"],["matInput","","formControlName","centerLat","type","number","step","0.000001"],["matInput","","formControlName","centerLng","type","number","step","0.000001"],["matInput","","formControlName","radiusKm","type","number","step","0.1","min","0"],[1,"actions"],["mat-raised-button","","color","primary","type","button",3,"click","disabled"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["diameter","20",4,"ngIf"],[1,"category-chip-container"],[3,"multiple"],[3,"selected","click",4,"ngFor","ngForOf"],[3,"click","selected"],["diameter","20"]],template:function(e,n){if(e&1){let o=zi();ae(0,"button",2),Nt("click",function(){return ri(o),oi(n.goBack())}),ae(1,"mat-icon"),Oe(2,"arrow_back"),se()(),ae(3,"mat-card",3)(4,"mat-card-header")(5,"mat-card-title"),Oe(6,"Generar Informe PDF"),se(),ae(7,"mat-card-subtitle"),Oe(8,"Filtros opcionales para el reporte"),se()(),ae(9,"mat-card-content")(10,"form",4),Nt("ngSubmit",function(){return ri(o),oi(n.generateReport())}),ae(11,"div",5)(12,"h3"),Oe(13,"Filtros por Fecha"),se(),ae(14,"div",6)(15,"mat-form-field",7)(16,"mat-label"),Oe(17,"Fecha inicio"),se(),jt(18,"input",8)(19,"mat-datepicker-toggle",9)(20,"mat-datepicker",null,0),se(),ae(22,"mat-form-field",7)(23,"mat-label"),Oe(24,"Fecha fin"),se(),jt(25,"input",10)(26,"mat-datepicker-toggle",9)(27,"mat-datepicker",null,1),se()(),Tt(29,gbe,2,1,"mat-error",11),se(),ae(30,"div",5)(31,"h3"),Oe(32,"Filtros por Categor\xEDa"),se(),Tt(33,_be,1,0,"mat-spinner",12)(34,bbe,4,3),se(),ae(35,"div",5)(36,"h3"),Oe(37,"Filtros por Ubicaci\xF3n"),se(),ae(38,"p"),Oe(39,"Selecciona un \xE1rea en el mapa haciendo clic para establecer el centro y arrastrando para ajustar el radio."),se(),jt(40,"div",13),ae(41,"div",14)(42,"mat-form-field",7)(43,"mat-label"),Oe(44,"Latitud"),se(),jt(45,"input",15),Tt(46,xbe,2,0,"mat-error",11),se(),ae(47,"mat-form-field",7)(48,"mat-label"),Oe(49,"Longitud"),se(),jt(50,"input",16),Tt(51,wbe,2,0,"mat-error",11),se(),ae(52,"mat-form-field",7)(53,"mat-label"),Oe(54,"Radio (km)"),se(),jt(55,"input",17),Tt(56,Ebe,2,0,"mat-error",11),se()()(),ae(57,"div",18)(58,"button",19),Nt("click",function(){return ri(o),oi(n.clearFilters())}),ae(59,"mat-icon"),Oe(60,"clear"),se(),Oe(61," Limpiar filtros "),se(),ae(62,"button",20)(63,"mat-icon"),Oe(64,"picture_as_pdf"),se(),Oe(65," Generar PDF "),Tt(66,Cbe,1,0,"mat-spinner",21),se()()()()()}if(e&2){let o,r,g,w=Ca(21),T=Ca(28);Se(10),Xe("formGroup",n.filterForm),Se(8),Xe("matDatepicker",w),Se(),Xe("for",w),Se(6),Xe("matDatepicker",T),Se(),Xe("for",T),Se(3),Xe("ngIf",n.filterForm.hasError("dateOrder")),Se(4),zn(n.loadingCategories?33:34),Se(13),Xe("ngIf",(o=n.filterForm.get("centerLat"))==null?null:o.invalid),Se(5),Xe("ngIf",(r=n.filterForm.get("centerLng"))==null?null:r.invalid),Se(5),Xe("ngIf",(g=n.filterForm.get("radiusKm"))==null?null:g.invalid),Se(2),Xe("disabled",n.loading),Se(4),Xe("disabled",n.loading||n.filterForm.invalid),Se(4),Xe("ngIf",n.loading)}},dependencies:[Or,bl,Er,Sm,is,jo,N0,la,ts,i4,Ta,ko,Ua,Yu,Zu,Vm,jm,VM,Bm,El,du,Zd,C4,T4,Mv,Dv,WM,zY,GM,K4,jY,Kd,Fs,Wl,wl,rs,Uo,Zh,Ku,Tv,z4,F4],styles:[".contenedor[_ngcontent-%COMP%]{max-width:800px;margin:50px auto;padding:30px 40px;border:1px solid #ccc;border-radius:8px;background-color:#fff;box-shadow:0 4px 12px #0000000d}.category-chip-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:8px}mat-chip-option[_ngcontent-%COMP%]{cursor:pointer}.actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:16px}mat-spinner[_ngcontent-%COMP%]{margin-left:8px}.date-filters[_ngcontent-%COMP%]{display:flex;gap:16px;flex-wrap:wrap}.map-container[_ngcontent-%COMP%]{width:100%;height:300px;margin-bottom:16px}.date-filters[_ngcontent-%COMP%]{display:flex;gap:16px;flex-wrap:wrap;margin-bottom:8px}.filter-section[_ngcontent-%COMP%]{margin-bottom:24px}.coords-display[_ngcontent-%COMP%]{font-size:.85em;color:#0009;margin-bottom:8px}.actions[_ngcontent-%COMP%]{margin-top:16px}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;background-color:#fff;border-radius:50%;box-shadow:0 2px 6px #0003}"]})};function Sbe(t,i){t&1&&(ae(0,"div",11),Oe(1," El nombre es obligatorio "),se())}function Tbe(t,i){t&1&&(ae(0,"div",11),Oe(1," M\xE1ximo 100 caracteres "),se())}function Dbe(t,i){t&1&&(ae(0,"div",11),Oe(1," M\xE1ximo 255 caracteres "),se())}var Jw=class t{fb=J(ns);categoryService=J(Gu);notification=J(fo);route=J(Tc);router=J($n);form=this.fb.group({name:["",[Ti.required,Ti.maxLength(100)]],description:["",[Ti.maxLength(255)]]});loading=!1;isEditMode=!1;categoryId=null;ngOnInit(){this.categoryId=this.route.snapshot.paramMap.get("id"),this.isEditMode=!!this.categoryId,this.isEditMode&&this.categoryId&&(this.loading=!0,this.categoryService.getCategoryById(this.categoryId).subscribe({next:i=>{this.form.patchValue({name:i.name,description:i.description})},error:i=>{this.notification.error("No se pudo cargar la categor\xEDa")},complete:()=>this.loading=!1}))}onSubmit(){if(this.form.invalid){this.form.markAllAsTouched();return}let i={name:this.form.value.name,description:this.form.value.description||""};this.loading=!0,(this.isEditMode?this.categoryService.updateCategory(this.categoryId,i):this.categoryService.addCategory(i)).subscribe({next:()=>{let n=this.isEditMode?"Categor\xEDa actualizada correctamente":"Categor\xEDa creada correctamente";this.notification.success(n),this.router.navigate(["/category-list"])},error:n=>{let o=this.isEditMode?"Error al actualizar categor\xEDa":"Error al crear categor\xEDa";this.notification.error(o)},complete:()=>this.loading=!1})}goBack(){this.router.navigate(["/category-list"])}get name(){return this.form.get("name")}get description(){return this.form.get("description")}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ai({type:t,selectors:[["app-category-form"]],decls:22,vars:7,consts:[["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],[1,"report-container"],[3,"ngSubmit","formGroup"],[1,"field-group"],["for","name"],["appearance","outline",1,"full-width"],["matInput","","id","name","formControlName","name","placeholder","Nombre de la categor\xEDa"],["class","error-message",4,"ngIf"],["for","description"],["matInput","","id","description","formControlName","description","placeholder","Descripci\xF3n de la categor\xEDa","rows","4"],["type","submit",1,"submit-button",3,"disabled"],[1,"error-message"]],template:function(e,n){e&1&&(ae(0,"button",0),Nt("click",function(){return n.goBack()}),ae(1,"mat-icon"),Oe(2,"arrow_back"),se()(),ae(3,"div",1)(4,"h2"),Oe(5),se(),ae(6,"form",2),Nt("ngSubmit",function(){return n.onSubmit()}),ae(7,"div",3)(8,"label",4),Oe(9,"Nombre"),se(),ae(10,"mat-form-field",5),jt(11,"input",6),se(),Tt(12,Sbe,2,0,"div",7)(13,Tbe,2,0,"div",7),se(),ae(14,"div",3)(15,"label",8),Oe(16,"Descripci\xF3n (opcional)"),se(),ae(17,"mat-form-field",5),jt(18,"textarea",9),se(),Tt(19,Dbe,2,0,"div",7),se(),ae(20,"button",10),Oe(21),se()()()),e&2&&(Se(5),an(" ",n.isEditMode?"Editar Categor\xEDa":"Crear Nueva Categor\xEDa"," "),Se(),Xe("formGroup",n.form),Se(6),Xe("ngIf",(n.name==null?null:n.name.touched)&&(n.name==null?null:n.name.hasError("required"))),Se(),Xe("ngIf",(n.name==null?null:n.name.touched)&&(n.name==null?null:n.name.hasError("maxLength"))),Se(6),Xe("ngIf",(n.description==null?null:n.description.touched)&&(n.description==null?null:n.description.hasError("maxLength"))),Se(),Xe("disabled",n.loading||n.form.invalid),Se(),an(" ",n.loading?n.isEditMode?"Actualizando...":"Creando...":n.isEditMode?"Actualizar Categor\xEDa":"Crear Categor\xEDa"," "))},dependencies:[Or,Er,Ta,is,jo,la,ts,ko,Ua,El,du,Mv,Dv,Fs,wl,rs,Uo],styles:[".back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;background-color:#fff;border:none;border-radius:50%;box-shadow:0 2px 8px #00000026;width:40px;height:40px;display:flex;align-items:center;justify-content:center;transition:background-color .2s ease,transform .2s ease}.back-button[_ngcontent-%COMP%]:hover{background-color:#f0f0f0;transform:translate(-2px)}.report-container[_ngcontent-%COMP%]{max-width:700px;margin:80px auto 40px;padding:30px 40px;border:1px solid #ddd;border-radius:10px;background-color:#fff;box-shadow:0 6px 16px #0000000d}.report-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;font-size:30px;color:#2c3e50;margin-bottom:30px}.field-group[_ngcontent-%COMP%]{margin-bottom:30px}.field-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:600;color:#34495e}.full-width[_ngcontent-%COMP%]{width:100%}.error-message[_ngcontent-%COMP%]{color:#e74c3c;font-size:.85em;margin-top:6px}.submit-button[_ngcontent-%COMP%]{display:block;width:100%;padding:14px;background-color:#f9f9f9;color:#2c3e50;border:1px solid #ccc;border-radius:4px;font-size:16px;font-weight:600;cursor:pointer;transition:background-color .2s ease,box-shadow .2s ease;margin-top:20px}.submit-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#eaeaea;box-shadow:0 2px 8px #0000001a}.submit-button[_ngcontent-%COMP%]:disabled{background-color:#f0f0f0;color:#999;cursor:not-allowed}"]})};var Mbe=["switch"],Ibe=["*"];function Abe(t,i){t&1&&(ae(0,"span",10),gs(),ae(1,"svg",12),jt(2,"path",13),se(),ae(3,"svg",14),jt(4,"path",15),se()())}var Rbe=new Ot("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1,hideIcon:!1,disabledInteractive:!1})}),kbe={provide:qh,useExisting:Ka(()=>JM),multi:!0},QM=class{source;checked;constructor(i,e){this.source=i,this.checked=e}},JM=(()=>{class t{_elementRef=J(Qi);_focusMonitor=J(Uu);_changeDetectorRef=J(vr);defaults=J(Rbe);_onChange=e=>{};_onTouched=()=>{};_validatorOnChange=()=>{};_uniqueId;_checked=!1;_createChangeEvent(e){return new QM(this,e)}_labelId;get buttonId(){return`${this.id||this._uniqueId}-button`}_switchElement;focus(){this._switchElement.nativeElement.focus()}_noopAnimations;_focused;name=null;id;labelPosition="after";ariaLabel=null;ariaLabelledby=null;ariaDescribedby;required;color;disabled=!1;disableRipple=!1;tabIndex=0;get checked(){return this._checked}set checked(e){this._checked=e,this._changeDetectorRef.markForCheck()}hideIcon;disabledInteractive;change=new Mi;toggleChange=new Mi;get inputId(){return`${this.id||this._uniqueId}-input`}constructor(){J(Vo).load(qd);let e=J(new Ru("tabindex"),{optional:!0}),n=this.defaults,o=J(oo,{optional:!0});this.tabIndex=e==null?0:parseInt(e)||0,this.color=n.color||"accent",this._noopAnimations=o==="NoopAnimations",this.id=this._uniqueId=J(po).getId("mat-mdc-slide-toggle-"),this.hideIcon=n.hideIcon??!1,this.disabledInteractive=n.disabledInteractive??!1,this._labelId=this._uniqueId+"-label"}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{e==="keyboard"||e==="program"?(this._focused=!0,this._changeDetectorRef.markForCheck()):e||Promise.resolve().then(()=>{this._focused=!1,this._onTouched(),this._changeDetectorRef.markForCheck()})})}ngOnChanges(e){e.required&&this._validatorOnChange()}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}writeValue(e){this.checked=!!e}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}validate(e){return this.required&&e.value!==!0?{required:!0}:null}registerOnValidatorChange(e){this._validatorOnChange=e}setDisabledState(e){this.disabled=e,this._changeDetectorRef.markForCheck()}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(this._createChangeEvent(this.checked))}_handleClick(){this.disabled||(this.toggleChange.emit(),this.defaults.disableToggleValue||(this.checked=!this.checked,this._onChange(this.checked),this.change.emit(new QM(this,this.checked))))}_getAriaLabelledBy(){return this.ariaLabelledby?this.ariaLabelledby:this.ariaLabel?null:this._labelId}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ai({type:t,selectors:[["mat-slide-toggle"]],viewQuery:function(n,o){if(n&1&&pr(Mbe,5),n&2){let r;sn(r=ln())&&(o._switchElement=r.first)}},hostAttrs:[1,"mat-mdc-slide-toggle"],hostVars:13,hostBindings:function(n,o){n&2&&(vs("id",o.id),un("tabindex",null)("aria-label",null)("name",null)("aria-labelledby",null),ql(o.color?"mat-"+o.color:""),Ji("mat-mdc-slide-toggle-focused",o._focused)("mat-mdc-slide-toggle-checked",o.checked)("_mat-animation-noopable",o._noopAnimations))},inputs:{name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],required:[2,"required","required",Bi],color:"color",disabled:[2,"disabled","disabled",Bi],disableRipple:[2,"disableRipple","disableRipple",Bi],tabIndex:[2,"tabIndex","tabIndex",e=>e==null?0:bs(e)],checked:[2,"checked","checked",Bi],hideIcon:[2,"hideIcon","hideIcon",Bi],disabledInteractive:[2,"disabledInteractive","disabledInteractive",Bi]},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],features:[fr([kbe,{provide:$d,useExisting:t,multi:!0}]),$r],ngContentSelectors:Ibe,decls:13,vars:27,consts:[["switch",""],["mat-internal-form-field","",3,"labelPosition"],["role","switch","type","button",1,"mdc-switch",3,"click","tabIndex","disabled"],[1,"mdc-switch__track"],[1,"mdc-switch__handle-track"],[1,"mdc-switch__handle"],[1,"mdc-switch__shadow"],[1,"mdc-elevation-overlay"],[1,"mdc-switch__ripple"],["mat-ripple","",1,"mat-mdc-slide-toggle-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-switch__icons"],[1,"mdc-label",3,"click","for"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--on"],["d","M19.69,5.23L8.96,15.96l-4.23-4.23L2.96,13.5l6,6L21.46,7L19.69,5.23z"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--off"],["d","M20 13H4v-2h16v2z"]],template:function(n,o){if(n&1){let r=zi();Qr(),ae(0,"div",1)(1,"button",2,0),Nt("click",function(){return ri(r),oi(o._handleClick())}),jt(3,"span",3),ae(4,"span",4)(5,"span",5)(6,"span",6),jt(7,"span",7),se(),ae(8,"span",8),jt(9,"span",9),se(),Tt(10,Abe,5,0,"span",10),se()()(),ae(11,"label",11),Nt("click",function(w){return ri(r),oi(w.stopPropagation())}),On(12),se()()}if(n&2){let r=Ca(2);Xe("labelPosition",o.labelPosition),Se(),Ji("mdc-switch--selected",o.checked)("mdc-switch--unselected",!o.checked)("mdc-switch--checked",o.checked)("mdc-switch--disabled",o.disabled)("mat-mdc-slide-toggle-disabled-interactive",o.disabledInteractive),Xe("tabIndex",o.disabled&&!o.disabledInteractive?-1:o.tabIndex)("disabled",o.disabled&&!o.disabledInteractive),un("id",o.buttonId)("name",o.name)("aria-label",o.ariaLabel)("aria-labelledby",o._getAriaLabelledBy())("aria-describedby",o.ariaDescribedby)("aria-required",o.required||null)("aria-checked",o.checked)("aria-disabled",o.disabled&&o.disabledInteractive?"true":null),Se(8),Xe("matRippleTrigger",r)("matRippleDisabled",o.disableRipple||o.disabled)("matRippleCentered",!0),Se(),zn(o.hideIcon?-1:10),Se(),Xe("for",o.buttonId),un("id",o._labelId)}},dependencies:[YD,VY],styles:[`.mdc-switch{align-items:center;background:none;border:none;cursor:pointer;display:inline-flex;flex-shrink:0;margin:0;outline:none;overflow:visible;padding:0;position:relative;width:var(--mdc-switch-track-width, 52px)}.mdc-switch.mdc-switch--disabled{cursor:default;pointer-events:none}.mdc-switch.mat-mdc-slide-toggle-disabled-interactive{pointer-events:auto}.mdc-switch__track{overflow:hidden;position:relative;width:100%;height:var(--mdc-switch-track-height, 32px);border-radius:var(--mdc-switch-track-shape, var(--mat-sys-corner-full))}.mdc-switch--disabled.mdc-switch .mdc-switch__track{opacity:var(--mdc-switch-disabled-track-opacity, 0.12)}.mdc-switch__track::before,.mdc-switch__track::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";height:100%;left:0;position:absolute;width:100%;border-width:var(--mat-switch-track-outline-width, 2px);border-color:var(--mat-switch-track-outline-color, var(--mat-sys-outline))}.mdc-switch--selected .mdc-switch__track::before,.mdc-switch--selected .mdc-switch__track::after{border-width:var(--mat-switch-selected-track-outline-width, 2px);border-color:var(--mat-switch-selected-track-outline-color, transparent)}.mdc-switch--disabled .mdc-switch__track::before,.mdc-switch--disabled .mdc-switch__track::after{border-width:var(--mat-switch-disabled-unselected-track-outline-width, 2px);border-color:var(--mat-switch-disabled-unselected-track-outline-color, var(--mat-sys-on-surface))}@media(forced-colors: active){.mdc-switch__track{border-color:currentColor}}.mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:translateX(0);background:var(--mdc-switch-unselected-track-color, var(--mat-sys-surface-variant))}.mdc-switch--selected .mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.6, 1);transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch--selected .mdc-switch__track::before{transform:translateX(-100%)}.mdc-switch--selected .mdc-switch__track::before{opacity:var(--mat-switch-hidden-track-opacity, 0);transition:var(--mat-switch-hidden-track-transition, opacity 75ms)}.mdc-switch--unselected .mdc-switch__track::before{opacity:var(--mat-switch-visible-track-opacity, 1);transition:var(--mat-switch-visible-track-transition, opacity 75ms)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-hover-track-color, var(--mat-sys-surface-variant))}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-focus-track-color, var(--mat-sys-surface-variant))}.mdc-switch:enabled:active .mdc-switch__track::before{background:var(--mdc-switch-unselected-pressed-track-color, var(--mat-sys-surface-variant))}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:hover:not(:focus):not(:active) .mdc-switch__track::before,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:focus:not(:active) .mdc-switch__track::before,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:active .mdc-switch__track::before,.mdc-switch.mdc-switch--disabled .mdc-switch__track::before{background:var(--mdc-switch-disabled-unselected-track-color, var(--mat-sys-surface-variant))}.mdc-switch__track::after{transform:translateX(-100%);background:var(--mdc-switch-selected-track-color, var(--mat-sys-primary))}[dir=rtl] .mdc-switch__track::after{transform:translateX(100%)}.mdc-switch--selected .mdc-switch__track::after{transform:translateX(0)}.mdc-switch--selected .mdc-switch__track::after{opacity:var(--mat-switch-visible-track-opacity, 1);transition:var(--mat-switch-visible-track-transition, opacity 75ms)}.mdc-switch--unselected .mdc-switch__track::after{opacity:var(--mat-switch-hidden-track-opacity, 0);transition:var(--mat-switch-hidden-track-transition, opacity 75ms)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-hover-track-color, var(--mat-sys-primary))}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-focus-track-color, var(--mat-sys-primary))}.mdc-switch:enabled:active .mdc-switch__track::after{background:var(--mdc-switch-selected-pressed-track-color, var(--mat-sys-primary))}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:hover:not(:focus):not(:active) .mdc-switch__track::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:focus:not(:active) .mdc-switch__track::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:active .mdc-switch__track::after,.mdc-switch.mdc-switch--disabled .mdc-switch__track::after{background:var(--mdc-switch-disabled-selected-track-color, var(--mat-sys-on-surface))}.mdc-switch__handle-track{height:100%;pointer-events:none;position:absolute;top:0;transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);left:0;right:auto;transform:translateX(0);width:calc(100% - var(--mdc-switch-handle-width))}[dir=rtl] .mdc-switch__handle-track{left:auto;right:0}.mdc-switch--selected .mdc-switch__handle-track{transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch__handle-track{transform:translateX(-100%)}.mdc-switch__handle{display:flex;pointer-events:auto;position:absolute;top:50%;transform:translateY(-50%);left:0;right:auto;transition:width 75ms cubic-bezier(0.4, 0, 0.2, 1),height 75ms cubic-bezier(0.4, 0, 0.2, 1),margin 75ms cubic-bezier(0.4, 0, 0.2, 1);width:var(--mdc-switch-handle-width);height:var(--mdc-switch-handle-height);border-radius:var(--mdc-switch-handle-shape, var(--mat-sys-corner-full))}[dir=rtl] .mdc-switch__handle{left:auto;right:0}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle{width:var(--mat-switch-unselected-handle-size, 16px);height:var(--mat-switch-unselected-handle-size, 16px);margin:var(--mat-switch-unselected-handle-horizontal-margin, 0 8px)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-unselected-with-icon-handle-horizontal-margin, 0 4px)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle{width:var(--mat-switch-selected-handle-size, 24px);height:var(--mat-switch-selected-handle-size, 24px);margin:var(--mat-switch-selected-handle-horizontal-margin, 0 24px)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-selected-with-icon-handle-horizontal-margin, 0 24px)}.mat-mdc-slide-toggle .mdc-switch__handle:has(.mdc-switch__icons){width:var(--mat-switch-with-icon-handle-size, 24px);height:var(--mat-switch-with-icon-handle-size, 24px)}.mat-mdc-slide-toggle .mdc-switch:active:not(.mdc-switch--disabled) .mdc-switch__handle{width:var(--mat-switch-pressed-handle-size, 28px);height:var(--mat-switch-pressed-handle-size, 28px)}.mat-mdc-slide-toggle .mdc-switch--selected:active:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-selected-pressed-handle-horizontal-margin, 0 22px)}.mat-mdc-slide-toggle .mdc-switch--unselected:active:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-unselected-pressed-handle-horizontal-margin, 0 2px)}.mdc-switch--disabled.mdc-switch--selected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-selected-handle-opacity, 1)}.mdc-switch--disabled.mdc-switch--unselected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-unselected-handle-opacity, 0.38)}.mdc-switch__handle::before,.mdc-switch__handle::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";width:100%;height:100%;left:0;position:absolute;top:0;transition:background-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1),border-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);z-index:-1}@media(forced-colors: active){.mdc-switch__handle::before,.mdc-switch__handle::after{border-color:currentColor}}.mdc-switch--selected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-selected-handle-color, var(--mat-sys-on-primary))}.mdc-switch--selected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-hover-handle-color, var(--mat-sys-primary-container))}.mdc-switch--selected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-focus-handle-color, var(--mat-sys-primary-container))}.mdc-switch--selected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-selected-pressed-handle-color, var(--mat-sys-primary-container))}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled.mdc-switch--selected:hover:not(:focus):not(:active) .mdc-switch__handle::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled.mdc-switch--selected:focus:not(:active) .mdc-switch__handle::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled.mdc-switch--selected:active .mdc-switch__handle::after,.mdc-switch--selected.mdc-switch--disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-selected-handle-color, var(--mat-sys-surface))}.mdc-switch--unselected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-unselected-handle-color, var(--mat-sys-outline))}.mdc-switch--unselected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-hover-handle-color, var(--mat-sys-on-surface-variant))}.mdc-switch--unselected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-focus-handle-color, var(--mat-sys-on-surface-variant))}.mdc-switch--unselected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-unselected-pressed-handle-color, var(--mat-sys-on-surface-variant))}.mdc-switch--unselected.mdc-switch--disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-unselected-handle-color, var(--mat-sys-on-surface))}.mdc-switch__handle::before{background:var(--mdc-switch-handle-surface-color)}.mdc-switch__shadow{border-radius:inherit;bottom:0;left:0;position:absolute;right:0;top:0}.mdc-switch:enabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-handle-elevation-shadow)}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:hover:not(:focus):not(:active) .mdc-switch__shadow,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:focus:not(:active) .mdc-switch__shadow,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:active .mdc-switch__shadow,.mdc-switch.mdc-switch--disabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-disabled-handle-elevation-shadow)}.mdc-switch__ripple{left:50%;position:absolute;top:50%;transform:translate(-50%, -50%);z-index:-1;width:var(--mdc-switch-state-layer-size, 40px);height:var(--mdc-switch-state-layer-size, 40px)}.mdc-switch__ripple::after{content:"";opacity:0}.mdc-switch--disabled .mdc-switch__ripple::after{display:none}.mat-mdc-slide-toggle-disabled-interactive .mdc-switch__ripple::after{display:block}.mdc-switch:hover .mdc-switch__ripple::after{opacity:.04;transition:75ms opacity cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mdc-switch .mdc-switch__ripple::after{opacity:.12}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:enabled:focus .mdc-switch__ripple::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:enabled:active .mdc-switch__ripple::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:enabled:hover:not(:focus) .mdc-switch__ripple::after,.mdc-switch--unselected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background:var(--mdc-switch-unselected-hover-state-layer-color, var(--mat-sys-on-surface))}.mdc-switch--unselected:enabled:focus .mdc-switch__ripple::after{background:var(--mdc-switch-unselected-focus-state-layer-color, var(--mat-sys-on-surface))}.mdc-switch--unselected:enabled:active .mdc-switch__ripple::after{background:var(--mdc-switch-unselected-pressed-state-layer-color, var(--mat-sys-on-surface));opacity:var(--mdc-switch-unselected-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity));transition:opacity 75ms linear}.mdc-switch--selected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background:var(--mdc-switch-selected-hover-state-layer-color, var(--mat-sys-primary))}.mdc-switch--selected:enabled:focus .mdc-switch__ripple::after{background:var(--mdc-switch-selected-focus-state-layer-color, var(--mat-sys-primary))}.mdc-switch--selected:enabled:active .mdc-switch__ripple::after{background:var(--mdc-switch-selected-pressed-state-layer-color, var(--mat-sys-primary));opacity:var(--mdc-switch-selected-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity));transition:opacity 75ms linear}.mdc-switch__icons{position:relative;height:100%;width:100%;z-index:1;transform:translateZ(0)}.mdc-switch--disabled.mdc-switch--unselected .mdc-switch__icons{opacity:var(--mdc-switch-disabled-unselected-icon-opacity, 0.38)}.mdc-switch--disabled.mdc-switch--selected .mdc-switch__icons{opacity:var(--mdc-switch-disabled-selected-icon-opacity, 0.38)}.mdc-switch__icon{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0;opacity:0;transition:opacity 30ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-switch--unselected .mdc-switch__icon{width:var(--mdc-switch-unselected-icon-size, 16px);height:var(--mdc-switch-unselected-icon-size, 16px);fill:var(--mdc-switch-unselected-icon-color, var(--mat-sys-surface-variant))}.mdc-switch--unselected.mdc-switch--disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-unselected-icon-color, var(--mat-sys-surface-variant))}.mdc-switch--selected .mdc-switch__icon{width:var(--mdc-switch-selected-icon-size, 16px);height:var(--mdc-switch-selected-icon-size, 16px);fill:var(--mdc-switch-selected-icon-color, var(--mat-sys-on-primary-container))}.mdc-switch--selected.mdc-switch--disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-selected-icon-color, var(--mat-sys-on-surface))}.mdc-switch--selected .mdc-switch__icon--on,.mdc-switch--unselected .mdc-switch__icon--off{opacity:1;transition:opacity 45ms 30ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle{-webkit-user-select:none;user-select:none;display:inline-block;-webkit-tap-highlight-color:rgba(0,0,0,0);outline:0}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple,.mat-mdc-slide-toggle .mdc-switch__ripple::after{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple:not(:empty),.mat-mdc-slide-toggle .mdc-switch__ripple::after:not(:empty){transform:translateZ(0)}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mat-focus-indicator::before{content:""}.mat-mdc-slide-toggle .mat-internal-form-field{color:var(--mat-switch-label-text-color, var(--mat-sys-on-surface));font-family:var(--mat-switch-label-text-font, var(--mat-sys-body-medium-font));line-height:var(--mat-switch-label-text-line-height, var(--mat-sys-body-medium-line-height));font-size:var(--mat-switch-label-text-size, var(--mat-sys-body-medium-size));letter-spacing:var(--mat-switch-label-text-tracking, var(--mat-sys-body-medium-tracking));font-weight:var(--mat-switch-label-text-weight, var(--mat-sys-body-medium-weight))}.mat-mdc-slide-toggle .mat-ripple-element{opacity:.12}.mat-mdc-slide-toggle .mat-focus-indicator::before{border-radius:50%}.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle-track,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__icon,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::after,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::after{transition:none}.mat-mdc-slide-toggle .mdc-switch:enabled+.mdc-label{cursor:pointer}.mat-mdc-slide-toggle .mdc-switch--disabled+label{color:var(--mdc-switch-disabled-label-text-color)}
`],encapsulation:2,changeDetection:0})}return t})();var qY=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({imports:[JM,Wn,Wn]})}return t})();function Pbe(t,i){t&1&&(ae(0,"div",4),jt(1,"mat-spinner",5),ae(2,"p"),Oe(3,"Cargando categor\xEDas\u2026"),se()())}function Nbe(t,i){t&1&&(ae(0,"th",17),Oe(1,"ID"),se())}function Lbe(t,i){if(t&1&&(ae(0,"td",18),Oe(1),se()),t&2){let e=i.$implicit;Se(),En(e.id)}}function Fbe(t,i){t&1&&(ae(0,"th",17),Oe(1,"Nombre"),se())}function zbe(t,i){if(t&1&&(ae(0,"td",18),Oe(1),se()),t&2){let e=i.$implicit;Se(),En(e.name)}}function Bbe(t,i){t&1&&(ae(0,"th",17),Oe(1,"Descripci\xF3n"),se())}function Vbe(t,i){if(t&1&&(ae(0,"td",18),Oe(1),se()),t&2){let e=i.$implicit;Se(),En(e.description)}}function jbe(t,i){t&1&&(ae(0,"th",17),Oe(1,"Creado En"),se())}function Ube(t,i){if(t&1&&(ae(0,"td",18),Oe(1),bc(2,"date"),se()),t&2){let e=i.$implicit;Se(),an(" ",Oh(2,1,e.createdAt,"yyyy-MM-dd hh:mm a")," ")}}function Hbe(t,i){t&1&&(ae(0,"th",17),Oe(1,"Estado"),se())}function qbe(t,i){if(t&1){let e=zi();ae(0,"td",18)(1,"mat-slide-toggle",19),Nt("change",function(){let o=ri(e).$implicit,r=zt(2);return oi(r.onToggleActivation(o))}),Oe(2),se()()}if(t&2){let e=i.$implicit;Se(),Xe("checked",e.activated)("disabled",!e.id),Se(),an(" ",e.activated?"Activada":"Desactivada"," ")}}function $be(t,i){t&1&&(ae(0,"th",17),Oe(1,"Acciones"),se())}function Gbe(t,i){if(t&1){let e=zi();ae(0,"td",18)(1,"button",20),Nt("click",function(){let o=ri(e).$implicit,r=zt(2);return oi(r.onEdit(o))}),ae(2,"mat-icon"),Oe(3,"edit"),se()()()}}function Wbe(t,i){t&1&&jt(0,"tr",21)}function Zbe(t,i){t&1&&jt(0,"tr",22)}function Ybe(t,i){if(t&1&&(ae(0,"table",6),Xn(1,7),Tt(2,Nbe,2,0,"th",8)(3,Lbe,2,1,"td",9),Qn(),Xn(4,10),Tt(5,Fbe,2,0,"th",8)(6,zbe,2,1,"td",9),Qn(),Xn(7,11),Tt(8,Bbe,2,0,"th",8)(9,Vbe,2,1,"td",9),Qn(),Xn(10,12),Tt(11,jbe,2,0,"th",8)(12,Ube,3,4,"td",9),Qn(),Xn(13,13),Tt(14,Hbe,2,0,"th",8)(15,qbe,3,3,"td",9),Qn(),Xn(16,14),Tt(17,$be,2,0,"th",8)(18,Gbe,4,0,"td",9),Qn(),Tt(19,Wbe,1,0,"tr",15)(20,Zbe,1,0,"tr",16),se()),t&2){let e=zt();Xe("dataSource",e.categories),Se(19),Xe("matHeaderRowDef",e.displayedColumns),Se(),Xe("matRowDefColumns",e.displayedColumns)}}var eI=class t{categoryService=J(Gu);notification=J(fo);router=J($n);dialog=J(lu);loading=!1;categories=[];displayedColumns=["id","name","description","createdAt","activated","actions"];ngOnInit(){this.fetchCategories()}fetchCategories(){this.loading=!0,this.categoryService.getAllCategories().subscribe({next:i=>this.categories=i,error:i=>{console.error("Error cargando categor\xEDas",i),this.notification.error("No fue posible cargar las categor\xEDas")},complete:()=>this.loading=!1})}onAdd(){this.router.navigate(["/categories/create"])}onEdit(i){i.id&&this.router.navigate(["/categories/edit",i.id])}onToggleActivation(i){if(!i.id)return;let e=i.activated?"Desactivar":"Activar",n=i.activated?"desactivada":"activada",o={title:`${e} Categor\xEDa`,message:`\xBFSeguro que deseas ${e.toLowerCase()} la categor\xEDa \u201C${i.name}\u201D?`,confirmText:e,cancelText:"Cancelar"};this.dialog.open(Zl,{data:o}).afterClosed().subscribe(r=>{r===!0&&this.categoryService.toggleCategoryActivation(i.id).subscribe({next:g=>{this.notification.success(`Categor\xEDa \u201C${i.name}\u201D ${n}`),this.fetchCategories(),i.activated=g.activated},error:g=>{console.error("Error cambiando estado de categor\xEDa",g),this.notification.error(`No se pudo ${e.toLowerCase()} la categor\xEDa`)}})})}goBack(){this.router.navigate(["/map"])}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ai({type:t,selectors:[["app-category-list"]],decls:16,vars:2,consts:[["tableBlock",""],["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],["mat-flat-button","","color","primary",3,"click"],["class","loading-section",4,"ngIf","ngIfElse"],[1,"loading-section"],["diameter","40"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","description"],["matColumnDef","createdAt"],["matColumnDef","activated"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["color","primary",3,"change","checked","disabled"],["mat-icon-button","","color","accent",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,n){if(e&1){let o=zi();ae(0,"button",1),Nt("click",function(){return ri(o),oi(n.goBack())}),ae(1,"mat-icon"),Oe(2,"arrow_back"),se()(),ae(3,"mat-card")(4,"mat-card-header")(5,"mat-card-title"),Oe(6,"Listado de Categor\xEDas"),se(),ae(7,"mat-card-actions")(8,"button",2),Nt("click",function(){return ri(o),oi(n.onAdd())}),ae(9,"mat-icon"),Oe(10,"add"),se(),Oe(11," A\xF1adir Categor\xEDa "),se()()(),ae(12,"mat-card-content"),Tt(13,Pbe,4,0,"div",3)(14,Ybe,21,3,"ng-template",null,0,rm),se()()}if(e&2){let o=Ca(15);Se(13),Xe("ngIf",n.loading)("ngIfElse",o)}},dependencies:[Or,Er,Ld,Yu,Zu,jM,Vm,jm,Bm,Fm,Dm,Im,Om,Am,Mm,Pm,Rm,km,Nm,Lm,Zh,Ku,Fs,Wl,wl,rs,Uo,O0,qY,JM],styles:[".loading-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;justify-content:center;padding:40px 0}table[_ngcontent-%COMP%]{width:100%;margin-top:16px}th.mat-header-cell[_ngcontent-%COMP%]{font-weight:700}td.mat-cell[_ngcontent-%COMP%]{word-wrap:break-word}mat-card-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}mat-card-actions[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;margin-top:12px}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;background-color:#fff;border-radius:50%;box-shadow:0 2px 6px #0003}.bg-green[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724;font-weight:700;padding:4px 8px;border-radius:4px}.bg-red[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24;font-weight:700;padding:4px 8px;border-radius:4px}"]})};var Yp=class t{constructor(i,e){this.authService=i;this.router=e}canActivate(){return this.authService.checkIsAdmin().pipe(hn(i=>i?!0:this.router.createUrlTree(["/map"])),Br(()=>Ni(this.router.createUrlTree(["/map"]))))}static \u0275fac=function(e){return new(e||t)(bi(Bo),bi($n))};static \u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"})};var tI=K_(vv());function Kbe(t,i){t&1&&(ae(0,"div",16),Oe(1," \u26A0 El nombre completo es obligatorio. "),se())}function Xbe(t,i){t&1&&(ae(0,"div",16),Oe(1," \u26A0 El nombre debe tener al menos 8 caracteres. "),se())}function Qbe(t,i){t&1&&(ae(0,"div",16),Oe(1," \u26A0 El nombre no puede exceder 50 caracteres. "),se())}function Jbe(t,i){t&1&&(ae(0,"div",16),Oe(1," \u26A0 El correo electr\xF3nico es obligatorio. "),se())}function e1e(t,i){t&1&&(ae(0,"div",16),Oe(1," \u26A0 El formato de correo no es v\xE1lido. "),se())}function t1e(t,i){t&1&&(ae(0,"div",16),Oe(1," \u26A0 El correo debe tener al menos 8 caracteres. "),se())}function i1e(t,i){t&1&&(ae(0,"div",16),Oe(1," \u26A0 El correo no puede exceder 50 caracteres. "),se())}function n1e(t,i){t&1&&(ae(0,"div",16),Oe(1," \u26A0 La ciudad de residencia es obligatoria. "),se())}function r1e(t,i){t&1&&(ae(0,"div",16),Oe(1," \u26A0 El radio de notificaciones es obligatorio. "),se())}function o1e(t,i){t&1&&(ae(0,"div",16),Oe(1," \u26A0 El radio de notificaciones debe ser mayor que 0. "),se())}function a1e(t,i){if(t&1){let e=zi();ae(0,"div")(1,"div",5),jt(2,"i",6)(3,"input",7),se(),Tt(4,Kbe,2,0,"div",8)(5,Xbe,2,0,"div",8)(6,Qbe,2,0,"div",8),ae(7,"div",5),jt(8,"i",9)(9,"input",10),se(),Tt(10,Jbe,2,0,"div",8)(11,e1e,2,0,"div",8)(12,t1e,2,0,"div",8)(13,i1e,2,0,"div",8),ae(14,"div",5),jt(15,"i",11)(16,"input",12),se(),Tt(17,n1e,2,0,"div",8),ae(18,"div",5),jt(19,"i",13)(20,"input",14),se(),Tt(21,r1e,2,0,"div",8)(22,o1e,2,0,"div",8),ae(23,"button",15),Nt("click",function(){ri(e);let o=zt();return oi(o.continueToMap())}),Oe(24," Actualizar Ubicaci\xF3n "),se()()}if(t&2){let e=zt();Se(4),Xe("ngIf",e.hasError("fullName","required")),Se(),Xe("ngIf",e.hasError("fullName","minlength")),Se(),Xe("ngIf",e.hasError("fullName","maxlength")),Se(4),Xe("ngIf",e.hasError("email","required")),Se(),Xe("ngIf",e.hasError("email","email")),Se(),Xe("ngIf",e.hasError("email","minlength")),Se(),Xe("ngIf",e.hasError("email","maxlength")),Se(4),Xe("ngIf",e.hasError("cityOfResidence","required")),Se(4),Xe("ngIf",e.hasError("notificationRadiusKm","required")),Se(),Xe("ngIf",e.hasError("notificationRadiusKm","min")),Se(),Xe("disabled",e.profileForm.invalid)}}function s1e(t,i){t&1&&(ae(0,"div",17),Oe(1," Cargando mapa... "),se())}function l1e(t,i){t&1&&jt(0,"i",23)}function c1e(t,i){if(t&1){let e=zi();ae(0,"div"),jt(1,"div",18),ae(2,"p",19),Oe(3,"Haz clic en el mapa para actualizar tu ubicaci\xF3n"),se(),ae(4,"div",20)(5,"button",21),Tt(6,l1e,1,0,"i",22),Oe(7),se(),ae(8,"button",15),Nt("click",function(){ri(e);let o=zt();return oi(o.showMap=!1)}),Oe(9," Cancelar "),se()()()}if(t&2){let e=zt();Se(5),Xe("disabled",e.profileForm.invalid||e.isSubmitting),Se(),Xe("ngIf",e.isSubmitting),Se(),an(" ",e.isSubmitting?"Guardando...":"Guardar Cambios"," "),Se(),Xe("disabled",e.isSubmitting)}}var iI=class t{constructor(i,e,n,o,r){this.fb=i;this.authService=e;this.notificationService=n;this.router=o;this.cdr=r;this.profileForm=this.fb.group({email:["",[Ti.required,Ti.email,Ti.minLength(8),Ti.maxLength(50)]],fullName:["",[Ti.required,Ti.minLength(8),Ti.maxLength(50)]],cityOfResidence:["",Ti.required],notificationRadiusKm:[null,[Ti.required,Ti.min(1)]],latitude:[null,Ti.required],longitude:[null,Ti.required]})}profileForm;showMap=!1;isLoadingMap=!1;map;marker;isSubmitting=!1;currentUser;ngOnInit(){this.loadUserData()}ngAfterViewInit(){this.currentUser?.latitude&&this.currentUser?.longitude&&setTimeout(()=>{this.showMap=!0,this.initializeMap({lng:this.currentUser.longitude,lat:this.currentUser.latitude}),this.cdr.detectChanges()},0)}loadUserData(){this.authService.getMe().subscribe({next:i=>{this.currentUser=i,this.populateForm(i)},error:()=>{this.notificationService.error("Error al cargar los datos del usuario"),this.router.navigate(["/"])}})}populateForm(i){this.profileForm.patchValue({email:i.email,fullName:i.fullName,dateBirth:i.dateBirth,cityOfResidence:i.cityOfResidence,notificationRadiusKm:i.notificationRadiusKm,latitude:i.latitude,longitude:i.longitude})}hasError(i,e){let n=this.profileForm.get(i);return!!(n&&n.touched&&n.hasError(e))}continueToMap(){if(!this.profileForm.valid){this.profileForm.markAllAsTouched();return}let e=this.profileForm.get("cityOfResidence").value;if(e===this.currentUser.cityOfResidence){this.showMap=!0,this.isLoadingMap=!1,this.cdr.detectChanges(),setTimeout(()=>{let n=this.profileForm.get("latitude").value,o=this.profileForm.get("longitude").value;this.initializeMap({lng:o,lat:n})},0);return}this.isLoadingMap=!0,this.showMap=!0,this.cdr.detectChanges(),console.log("Buscando coordenadas para:",e),this.getCityCoordinates(e).then(n=>{setTimeout(()=>this.initializeMap({lng:n.lng,lat:n.lat}),0)}).catch(n=>{console.error("Error al obtener coordenadas:",n);let o=n?.message==="Ciudad no encontrada"?"No pudimos encontrar tu ciudad. Revisa el nombre.":"Ocurri\xF3 un error al cargar el mapa. Intenta nuevamente.";this.notificationService.error(o),this.showMap=!1}).finally(()=>this.isLoadingMap=!1)}initializeMap(i){console.log("Inicializando mapa con coords:",i),this.map&&(this.map.remove(),console.log("Mapa anterior eliminado")),this.map=new tI.default.Map({container:"map_user",style:"mapbox://styles/mapbox/streets-v11",center:[i.lng,i.lat],zoom:12,accessToken:Gd.mapboxToken}),this.map.on("load",()=>{this.map.resize(),this.isLoadingMap=!1}),this.map.addControl(new tI.default.NavigationControl,"bottom-right"),this.map.on("click",({lngLat:e})=>this.onMapClick(e)),this.addMarker(i)}onMapClick(i){this.updateLocation(i),this.marker?this.marker.setLngLat(i):this.addMarker({lng:i.lng,lat:i.lat})}addMarker(i){this.marker&&this.marker.remove(),this.marker=new tI.default.Marker({draggable:!0,anchor:"center"}).setLngLat([i.lng,i.lat]).addTo(this.map).on("dragend",()=>{let e=this.marker.getLngLat();this.updateLocation(e)})}updateLocation(i){this.profileForm.patchValue({latitude:i.lat,longitude:i.lng})}getCityCoordinates(i){let n=`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(i+", Colombia")}.json?access_token=${Gd.mapboxToken}&limit=1`;return fetch(n).then(o=>o.json()).then(o=>{if(!o.features||o.features.length===0)throw new Error("No se encontr\xF3 la ciudad");let[r,g]=o.features[0].center;return{lng:r,lat:g}})}onSubmit(){if(this.profileForm.invalid){this.profileForm.markAllAsTouched();return}this.isSubmitting=!0;let i=this.profileForm.value;this.authService.updateUser(this.currentUser.id,i).subscribe({next:e=>{this.notificationService.success("Datos actualizados correctamente"),this.currentUser=e,this.isSubmitting=!1,this.goBack()},error:e=>{let n=e.error?.message||"Error al actualizar los datos";this.notificationService.error(n),this.populateForm(this.currentUser),this.isSubmitting=!1}})}goBack(){this.router.navigate(["/profile"])}static \u0275fac=function(e){return new(e||t)(Ci(ns),Ci(Bo),Ci(fo),Ci($n),Ci(vr))};static \u0275cmp=ai({type:t,selectors:[["app-profile"]],decls:10,vars:4,consts:[["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],[1,"profile-container"],[3,"ngSubmit","formGroup"],[4,"ngIf"],["class","loading-spinner",4,"ngIf"],[1,"field-group"],[1,"icon","fa","fa-user"],["type","text","placeholder","Nombre completo","formControlName","fullName"],["class","error-message",4,"ngIf"],[1,"icon","fa","fa-envelope"],["type","email","placeholder","Correo electr\xF3nico","formControlName","email"],[1,"icon","fa","fa-city"],["type","text","placeholder","Ciudad de residencia","formControlName","cityOfResidence"],[1,"icon","fa","fa-bullhorn"],["type","number","placeholder","Radio de notificaciones (Km)","formControlName","notificationRadiusKm"],["type","button",1,"submit-button",3,"click","disabled"],[1,"error-message"],[1,"loading-spinner"],["id","map_user"],[1,"map-instructions"],[1,"form-actions"],["type","submit",1,"submit-button",3,"disabled"],["class","fas fa-spinner fa-spin me-2",4,"ngIf"],[1,"fas","fa-spinner","fa-spin","me-2"]],template:function(e,n){e&1&&(ae(0,"button",0),Nt("click",function(){return n.goBack()}),ae(1,"mat-icon"),Oe(2,"arrow_back"),se()(),ae(3,"div",1)(4,"h2"),Oe(5,"Actualizar campos"),se(),ae(6,"form",2),Nt("ngSubmit",function(){return n.onSubmit()}),Tt(7,a1e,25,11,"div",3)(8,s1e,2,0,"div",4)(9,c1e,10,4,"div",3),se()()),e&2&&(Se(6),Xe("formGroup",n.profileForm),Se(),Xe("ngIf",!n.showMap),Se(),Xe("ngIf",n.isLoadingMap),Se(),Xe("ngIf",n.showMap&&!n.isLoadingMap))},dependencies:[Or,Er,Ta,is,jo,N0,la,ts,ko,Ua,Uo],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c;--cancel-color: #95a5a6}.profile-container[_ngcontent-%COMP%]{width:360px;background:var(--input-bg);margin:60px auto;padding:30px;border-radius:12px;text-align:center;box-shadow:0 4px 15px #0000001a;position:relative}.profile-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;margin:0 0 25px;color:var(--primary-dark)}.field-group[_ngcontent-%COMP%]{position:relative;margin-bottom:15px}.field-group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:12px;transform:translateY(-50%);color:var(--primary-accent);font-size:18px}.field-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px 12px 12px 40px;border:2px solid #ccc;border-radius:6px;font-size:14px;background:var(--input-bg);transition:border-color .2s ease;box-sizing:border-box}.field-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-accent)}.error-message[_ngcontent-%COMP%]{text-align:left;color:var(--error-color);font-size:13px;margin:-10px 0 10px;padding-left:40px}.submit-button[_ngcontent-%COMP%]{width:100%;padding:12px;margin-top:3px;background:var(--primary-accent);color:#000;border:none;border-radius:6px;cursor:pointer;font-size:16px;font-weight:600;transition:background .3s ease,transform .2s ease;box-shadow:0 2px 8px #00000026}.cancel-button[_ngcontent-%COMP%]{width:100%;padding:12px;margin-top:10px;background:var(--cancel-color);color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:16px;font-weight:600;transition:background .3s ease}.submit-button[_ngcontent-%COMP%]:disabled, .cancel-button[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.submit-button[_ngcontent-%COMP%]:not(:disabled):hover{background:var(--primary-dark);transform:translateY(-2px)}.cancel-button[_ngcontent-%COMP%]:not(:disabled):hover{background:#7f8c8d}#map_user[_ngcontent-%COMP%]{width:100%;height:400px;border:1px solid #ccc;border-radius:4px;margin-bottom:15px}.map-instructions[_ngcontent-%COMP%]{color:var(--primary-dark);font-size:14px;margin-bottom:20px}.loading-spinner[_ngcontent-%COMP%]{font-size:16px;color:var(--primary-dark);margin:20px 0}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;background-color:#fff;border-radius:50%;box-shadow:0 2px 6px #0003}.form-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}"]})};function u1e(t,i){t&1&&(ae(0,"div",13),Oe(1," \u26A0 La contrase\xF1a actual es obligatoria. "),se())}function d1e(t,i){t&1&&(ae(0,"div",13),Oe(1," \u26A0 La nueva contrase\xF1a es obligatoria. "),se())}function h1e(t,i){t&1&&(ae(0,"div",13),Oe(1," \u26A0 Debe tener entre 8 y 50 caracteres. "),se())}function p1e(t,i){t&1&&(ae(0,"div",13),Oe(1," \u26A0 Debe contener al menos un d\xEDgito, una may\xFAscula y una min\xFAscula. "),se())}function f1e(t,i){t&1&&jt(0,"i",14)}var nI=class t{constructor(i,e,n,o){this.fb=i;this.authService=e;this.notificationService=n;this.router=o}passwordForm;isSubmitting=!1;userId;ngOnInit(){this.initForm(),this.authService.getMe().subscribe({next:i=>this.userId=i.id,error:()=>{this.notificationService.error("Error al obtener informaci\xF3n del usuario"),this.router.navigate(["/"])}})}initForm(){this.passwordForm=this.fb.group({currentPassword:["",[Ti.required]],newPassword:["",[Ti.required,Ti.minLength(8),Ti.maxLength(50),Ti.pattern(/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/)]]})}hasError(i,e){let n=this.passwordForm.get(i);return!!(n&&n.touched&&n.hasError(e))}onSubmit(){if(this.passwordForm.invalid){this.passwordForm.markAllAsTouched();return}this.isSubmitting=!0;let i=this.passwordForm.value;this.authService.updatePassword(this.userId,i).subscribe({next:()=>{this.notificationService.success("Contrase\xF1a actualizada correctamente"),this.router.navigate(["/profile"])},error:e=>{let n=e.error?.message||"Error al actualizar la contrase\xF1a";this.notificationService.error(n),this.isSubmitting=!1}})}goBack(){this.router.navigate(["/profile"])}static \u0275fac=function(e){return new(e||t)(Ci(ns),Ci(Bo),Ci(fo),Ci($n))};static \u0275cmp=ai({type:t,selectors:[["app-password-update"]],decls:23,vars:9,consts:[["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],[1,"password-update-container"],["novalidate","",3,"ngSubmit","formGroup"],[1,"field-group"],[1,"icon","fa","fa-lock"],["type","password","placeholder","Contrase\xF1a actual","formControlName","currentPassword"],["class","error-message",4,"ngIf"],[1,"icon","fa","fa-key"],["type","password","placeholder","Nueva contrase\xF1a","formControlName","newPassword"],[1,"button-group"],["type","submit",3,"disabled"],["class","fas fa-spinner fa-spin",4,"ngIf"],["type","button",3,"click","disabled"],[1,"error-message"],[1,"fas","fa-spinner","fa-spin"]],template:function(e,n){e&1&&(ae(0,"button",0),Nt("click",function(){return n.goBack()}),ae(1,"mat-icon"),Oe(2,"arrow_back"),se()(),ae(3,"div",1)(4,"h2"),Oe(5,"Actualizar contrase\xF1a"),se(),ae(6,"form",2),Nt("ngSubmit",function(){return n.onSubmit()}),ae(7,"div",3),jt(8,"i",4)(9,"input",5),se(),Tt(10,u1e,2,0,"div",6),ae(11,"div",3),jt(12,"i",7)(13,"input",8),se(),Tt(14,d1e,2,0,"div",6)(15,h1e,2,0,"div",6)(16,p1e,2,0,"div",6),ae(17,"div",9)(18,"button",10),Tt(19,f1e,1,0,"i",11),Oe(20),se(),ae(21,"button",12),Nt("click",function(){return n.goBack()}),Oe(22," Cancelar "),se()()()()),e&2&&(Se(6),Xe("formGroup",n.passwordForm),Se(4),Xe("ngIf",n.hasError("currentPassword","required")),Se(4),Xe("ngIf",n.hasError("newPassword","required")),Se(),Xe("ngIf",n.hasError("newPassword","minlength")||n.hasError("newPassword","maxlength")),Se(),Xe("ngIf",n.hasError("newPassword","pattern")),Se(2),Xe("disabled",n.isSubmitting),Se(),Xe("ngIf",n.isSubmitting),Se(),an(" ",n.isSubmitting?"Actualizando...":"Actualizar contrase\xF1a"," "),Se(),Xe("disabled",n.isSubmitting))},dependencies:[Or,Er,Ta,is,jo,la,ts,ko,Ua,Uo],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c}.password-update-container[_ngcontent-%COMP%]{width:360px;background:var(--input-bg);margin:60px auto;padding:30px;border-radius:12px;text-align:center;box-shadow:0 4px 15px #0000001a;position:relative}.password-update-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:25px;color:var(--primary-dark)}.field-group[_ngcontent-%COMP%]{position:relative;margin-bottom:15px}.field-group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:12px;transform:translateY(-50%);color:var(--primary-accent);font-size:18px}.field-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px 12px 12px 40px;border:2px solid #ccc;border-radius:6px;font-size:14px;background:var(--input-bg);transition:border-color .2s ease;box-sizing:border-box}.field-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-accent)}.error-message[_ngcontent-%COMP%]{text-align:left;color:var(--error-color);font-size:13px;margin:-10px 0 10px;padding-left:40px}.button-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:10px}.button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:12px;background:var(--primary-accent);color:#000;border:none;border-radius:6px;cursor:pointer;font-size:16px;font-weight:600;transition:background .3s ease,transform .2s ease;box-shadow:0 2px 8px #00000026}.button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background:#aaa;color:#ccc;cursor:not-allowed}.button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:not(:disabled):hover{background:var(--primary-dark);transform:translateY(-2px)}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;background-color:#fff;border-radius:50%;box-shadow:0 2px 6px #0003}.fa-spinner[_ngcontent-%COMP%]{margin-right:8px}"]})};function m1e(t,i){if(t&1){let e=zi();ae(0,"mat-card",3)(1,"mat-card-header",4)(2,"mat-card-title"),Oe(3),se(),ae(4,"mat-card-subtitle"),Oe(5),se()(),ae(6,"mat-card-content",5)(7,"div",6)(8,"strong"),Oe(9,"Ciudad:"),se(),ae(10,"span"),Oe(11),se()(),ae(12,"div",6)(13,"strong"),Oe(14,"Radio de notificaciones:"),se(),ae(15,"span"),Oe(16),se()()(),ae(17,"mat-card-actions",7)(18,"button",8),Nt("click",function(){ri(e);let o=zt();return oi(o.onEditData())}),ae(19,"mat-icon"),Oe(20,"edit"),se(),Oe(21," Editar datos "),se(),ae(22,"button",9),Nt("click",function(){ri(e);let o=zt();return oi(o.onUpdatePassword())}),ae(23,"mat-icon"),Oe(24,"lock"),se(),Oe(25," Actualizar contrase\xF1a "),se(),ae(26,"button",10),Nt("click",function(){ri(e);let o=zt();return oi(o.onDeleteAccount())}),ae(27,"mat-icon",11),Oe(28,"delete_forever"),se(),Oe(29," Eliminar cuenta "),se()()()}if(t&2){let e=zt();Se(3),En(e.user.fullName),Se(2),En(e.user.email),Se(6),En(e.user.cityOfResidence),Se(5),an("",e.user.notificationRadiusKm," km")}}function g1e(t,i){t&1&&(ae(0,"div",12),jt(1,"mat-progress-spinner",13),se())}var rI=class t{authService=J(Bo);notification=J(fo);router=J($n);dialog=J(lu);user;loading=!0;ngOnInit(){this.authService.getMe().subscribe({next:i=>{this.user=i},error:i=>{console.error("Error al cargar perfil",i),this.notification.error("No fue posible cargar tu perfil"),this.router.navigate(["/"])},complete:()=>this.loading=!1})}onEditData(){this.router.navigate(["/user/edit"])}onUpdatePassword(){this.router.navigate(["/user/edit/password"])}onDeleteAccount(){if(!this.user?.id)return;let i={title:"Eliminar cuenta",message:"\xBFEst\xE1s seguro de que deseas eliminar tu cuenta? Esta acci\xF3n no se puede deshacer.",confirmText:"Eliminar",cancelText:"Cancelar"};this.dialog.open(Zl,{data:i}).afterClosed().subscribe(e=>{e&&this.authService.deleteUser(this.user.id).subscribe({next:()=>{this.notification.success("Cuenta eliminada correctamente"),this.router.navigate(["/login"])},error:n=>{console.error("Error al eliminar cuenta",n),this.notification.error("No se pudo eliminar tu cuenta")}})})}goBack(){this.router.navigate(["/map"])}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ai({type:t,selectors:[["app-profile"]],decls:5,vars:2,consts:[["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],["class","profile-card",4,"ngIf"],["class","loading-spinner",4,"ngIf"],[1,"profile-card"],[1,"profile-header"],[1,"content"],[1,"info-group"],[1,"actions"],["mat-stroked-button","",3,"click"],["mat-stroked-button","","color","primary",3,"click"],["mat-flat-button","","color","primary",1,"delete-button",3,"click"],[1,"delete-icon"],[1,"loading-spinner"],["mode","indeterminate"]],template:function(e,n){e&1&&(ae(0,"button",0),Nt("click",function(){return n.goBack()}),ae(1,"mat-icon"),Oe(2,"arrow_back"),se()(),Tt(3,m1e,30,4,"mat-card",1)(4,g1e,2,0,"div",2)),e&2&&(Se(3),Xe("ngIf",!n.loading&&n.user),Se(),Xe("ngIf",n.loading))},dependencies:[Or,Er,Yu,Zu,jM,Vm,jm,VM,Bm,Fs,Wl,wl,rs,Uo,O0,Ku],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;background-color:var(--input-bg);color:var(--primary-dark);border-radius:50%;box-shadow:0 2px 6px #0000001a;z-index:1000;transition:all .2s ease}.back-button[_ngcontent-%COMP%]:hover{background-color:var(--primary-bg);transform:scale(1.05)}.profile-card[_ngcontent-%COMP%]{max-width:500px;width:90%;margin:80px auto 40px;padding:24px;background:var(--input-bg);border-radius:12px;box-shadow:0 4px 15px #0000001a}.profile-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:20px;text-align:center;width:100%}.avatar-center[_ngcontent-%COMP%]{width:80px;height:80px;margin:0 auto 16px;border-radius:50%;background-color:var(--primary-bg);color:var(--primary-dark);display:flex;align-items:center;justify-content:center}.avatar-center[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:36px}mat-card-title[_ngcontent-%COMP%]{font-size:1.5rem;color:var(--primary-dark);margin:0 auto 4px;text-align:center;width:100%}mat-card-subtitle[_ngcontent-%COMP%]{color:var(--primary-accent);font-size:1rem;text-align:center;width:100%;margin:0 auto}.content[_ngcontent-%COMP%]{padding:16px 0;margin:16px 0;border-top:1px solid rgba(0,0,0,.1);border-bottom:1px solid rgba(0,0,0,.1)}.info-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:12px;padding:0 8px}.info-group[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--primary-dark)}.actions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;gap:12px;margin-top:24px}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:160px;padding:8px 16px;display:flex;align-items:center;justify-content:center;gap:8px;border-radius:6px;transition:all .2s ease}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px}button[color=warn][_ngcontent-%COMP%]{background-color:var(--error-color);color:#fff}button[color=warn][_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff}.loading-spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:80px}@media (max-width: 600px){.profile-card[_ngcontent-%COMP%]{margin-top:60px;padding:16px}.actions[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}"]})};var _1e=()=>[5,10,25],y1e=(t,i,e,n)=>({"status-pending":t,"status-rejected":i,"status-verified":e,"status-resolved":n});function v1e(t,i){if(t&1&&(ae(0,"mat-option",8),Oe(1),se()),t&2){let e=i.$implicit;Xe("value",e),Se(),an(" ",e," ")}}function b1e(t,i){t&1&&(ae(0,"div",9),jt(1,"mat-spinner",10),se())}function x1e(t,i){t&1&&(ae(0,"th",25),Oe(1,"T\xEDtulo"),se())}function w1e(t,i){if(t&1&&(ae(0,"td",26),Oe(1),se()),t&2){let e=i.$implicit;Se(),En(e.title)}}function E1e(t,i){t&1&&(ae(0,"th",25),Oe(1,"Descripci\xF3n"),se())}function C1e(t,i){if(t&1&&(ae(0,"td",26),Oe(1),se()),t&2){let e=i.$implicit;Se(),En(e.description)}}function S1e(t,i){t&1&&(ae(0,"th",25),Oe(1,"Categor\xEDas"),se())}function T1e(t,i){if(t&1&&(ae(0,"mat-chip"),Oe(1),se()),t&2){let e=i.$implicit;Se(),En(e.name)}}function D1e(t,i){if(t&1&&(ae(0,"td",26)(1,"mat-chip-set"),Tt(2,T1e,2,1,"mat-chip",27),se()()),t&2){let e=i.$implicit;Se(2),Xe("ngForOf",e.categoryList)}}function M1e(t,i){t&1&&(ae(0,"th",25),Oe(1,"Ubicaci\xF3n"),se())}function I1e(t,i){if(t&1&&(ae(0,"td",26),Oe(1),se()),t&2){let e=i.$implicit;Se(),kh(" ",e.latitude,", ",e.longitude," ")}}function A1e(t,i){t&1&&(ae(0,"th",25),Oe(1,"Estado"),se())}function R1e(t,i){if(t&1&&(ae(0,"td",26)(1,"span",28),Oe(2),se()()),t&2){let e=i.$implicit;Se(),Xe("ngClass",jS(2,y1e,e.reportStatus==="PENDING",e.reportStatus==="REJECTED",e.reportStatus==="VERIFIED",e.reportStatus==="RESOLVED")),Se(),an(" ",e.reportStatus," ")}}function k1e(t,i){t&1&&(ae(0,"th",25),Oe(1,"Fecha Creaci\xF3n"),se())}function O1e(t,i){if(t&1&&(ae(0,"td",26),Oe(1),bc(2,"date"),se()),t&2){let e=i.$implicit;Se(),an(" ",Oh(2,1,e.createdAt,"short")," ")}}function P1e(t,i){t&1&&(ae(0,"th",25),Oe(1,"Votos"),se())}function N1e(t,i){if(t&1&&(ae(0,"td",26),Oe(1),se()),t&2){let e=i.$implicit;Se(),En(e.importantVotes)}}function L1e(t,i){t&1&&(ae(0,"th",25),Oe(1,"Acciones"),se())}function F1e(t,i){if(t&1){let e=zi();Xn(0),ae(1,"button",31),Nt("click",function(){ri(e);let o=zt().$implicit,r=zt(2);return oi(r.resolveReport(o.id))}),ae(2,"mat-icon"),Oe(3,"done_all"),se(),Oe(4," Resolver "),se(),Qn()}}function z1e(t,i){if(t&1){let e=zi();ae(0,"td",26),Xn(1),ae(2,"button",29),Nt("click",function(){let o=ri(e).$implicit,r=zt(2);return oi(r.editReport(o.id))}),ae(3,"mat-icon"),Oe(4,"edit"),se(),Oe(5," Editar "),se(),ae(6,"button",30),Nt("click",function(){let o=ri(e).$implicit,r=zt(2);return oi(r.deleteReport(o.id))}),ae(7,"mat-icon"),Oe(8,"close"),se(),Oe(9," Eliminar "),se(),Qn(),Tt(10,F1e,5,0,"ng-container",7),se()}if(t&2){let e=i.$implicit;Se(10),Xe("ngIf",e.reportStatus==="VERIFIED")}}function B1e(t,i){t&1&&jt(0,"tr",32)}function V1e(t,i){t&1&&jt(0,"tr",33)}function j1e(t,i){if(t&1){let e=zi();ae(0,"div")(1,"table",11),Xn(2,12),Tt(3,x1e,2,0,"th",13)(4,w1e,2,1,"td",14),Qn(),Xn(5,15),Tt(6,E1e,2,0,"th",13)(7,C1e,2,1,"td",14),Qn(),Xn(8,16),Tt(9,S1e,2,0,"th",13)(10,D1e,3,1,"td",14),Qn(),Xn(11,17),Tt(12,M1e,2,0,"th",13)(13,I1e,2,2,"td",14),Qn(),Xn(14,18),Tt(15,A1e,2,0,"th",13)(16,R1e,3,7,"td",14),Qn(),Xn(17,19),Tt(18,k1e,2,0,"th",13)(19,O1e,3,4,"td",14),Qn(),Xn(20,20),Tt(21,P1e,2,0,"th",13)(22,N1e,2,1,"td",14),Qn(),Xn(23,21),Tt(24,L1e,2,0,"th",13)(25,z1e,11,1,"td",14),Qn(),Tt(26,B1e,1,0,"tr",22)(27,V1e,1,0,"tr",23),se(),ae(28,"mat-paginator",24),Nt("page",function(o){ri(e);let r=zt();return oi(r.onPageChange(o))}),se()()}if(t&2){let e=zt();Se(),Xe("dataSource",e.filteredContent()),Se(25),Xe("matHeaderRowDef",e.displayedColumns),Se(),Xe("matRowDefColumns",e.displayedColumns),Se(),Xe("length",e.paginatedData().totalElements)("pageSize",e.paginatedData().size)("pageIndex",e.paginatedData().page-1)("pageSizeOptions",Py(7,_1e))}}var oI=class t{reportService=J(Mc);notificationService=J(fo);dialog=J(lu);loading=ma(!1);paginatedData=ma({content:[],page:0,size:10,totalElements:0,totalPages:0});router=J($n);statuses=["PENDING","VERIFIED","REJECTED","RESOLVED"];selectedStatus=ma("");filteredContent=wc(()=>{let i=this.paginatedData().content,e=this.selectedStatus();return e?i.filter(n=>n.reportStatus===e):i});displayedColumns=["title","description","categories","location","reportStatus","dateCreation","importantVotes","actions"];ngOnInit(){this.loadReports(1,10)}loadReports(i,e,n=""){this.loading.set(!0),this.reportService.getMyReportsPaginated(i,e,n).subscribe({next:o=>this.paginatedData.set(o),error:o=>{},complete:()=>this.loading.set(!1)})}deleteReport(i){if(!i)return;let e={title:"Eliminar Reporte",message:"\xBFSeguro que quieres eliminar este reporte?",confirmText:"Eliminar",cancelText:"Cancelar"};this.dialog.open(Zl,{data:e}).afterClosed().subscribe(n=>{n===!0&&this.reportService.deleteReport(i).subscribe({next:()=>{this.notificationService.success("\u2705 Reporte eliminado correctamente."),this.loadReports(1,10)},error:o=>{console.error("\u274C Error al rechazar reporte:",o),this.notificationService.error("Ocurri\xF3 un error al rechazar el reporte.")}})})}editReport(i){i&&this.router.navigate([`report/edit/${i}`])}resolveReport(i){if(!i)return;let e={title:"Resolver reporte",message:"\xBFDeseas marcar este reporte como resuelto?",confirmText:"Resolver",cancelText:"Cancelar"};this.dialog.open(Zl,{data:e}).afterClosed().subscribe(n=>{n===!0&&this.reportService.updateReportStatus(i,"RESOLVED").subscribe({next:()=>{this.notificationService.success("\u2705 Reporte marcado como resuelto."),this.loadReports(1,10)},error:o=>{console.error("\u274C Error al resolver reporte:",o),this.notificationService.error("Ocurri\xF3 un error al resolver el reporte.")}})})}onPageChange(i){let e=i.pageIndex+1,n=i.pageSize;this.loadReports(e,n,this.selectedStatus())}onStatusChange(i){this.selectedStatus.set(i),this.loadReports(1,this.paginatedData().size,i)}goBack(){this.router.navigate(["/map"])}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ai({type:t,selectors:[["app-report-list"]],decls:16,vars:4,consts:[["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],[1,"contenedor"],["appearance","outline",1,"status-filter"],[3,"selectionChange","value"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","loading-container",4,"ngIf"],[4,"ngIf"],[3,"value"],[1,"loading-container"],["diameter","50"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","title"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","categories"],["matColumnDef","location"],["matColumnDef","reportStatus"],["matColumnDef","dateCreation"],["matColumnDef","importantVotes"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Seleccionar p\xE1gina",3,"page","length","pageSize","pageIndex","pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],[4,"ngFor","ngForOf"],[3,"ngClass"],["mat-raised-button","","color","primary",1,"action-button",3,"click"],["mat-raised-button","","color","warn",1,"action-button",3,"click"],["mat-raised-button","","color","accent",1,"action-button",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,n){e&1&&(ae(0,"button",0),Nt("click",function(){return n.goBack()}),ae(1,"mat-icon"),Oe(2,"arrow_back"),se()(),ae(3,"mat-card",1)(4,"h1"),Oe(5,"Mis Reportes"),se(),jt(6,"mat-divider"),ae(7,"mat-form-field",2)(8,"mat-label"),Oe(9,"Filtrar por estado"),se(),ae(10,"mat-select",3),Nt("selectionChange",function(r){return n.onStatusChange(r.value)}),ae(11,"mat-option",4),Oe(12,"Todos"),se(),Tt(13,v1e,2,2,"mat-option",5),se()(),Tt(14,b1e,2,0,"div",6)(15,j1e,29,8,"div",7),se()),e&2&&(Se(10),Xe("value",n.selectedStatus()),Se(3),Xe("ngForOf",n.statuses),Se(),Xe("ngIf",n.loading()),Se(),Xe("ngIf",!n.loading()))},dependencies:[Or,Js,bl,Er,Ld,El,du,Zd,Kd,Zp,Yd,Zh,Ku,Fm,Dm,Im,Om,Am,Mm,Pm,Rm,km,Nm,Lm,Ev,V0,Yu,Zu,Sv,UM,Tv,j0,Ww,rs,Uo],styles:["[_ngcontent-%COMP%]:root{--primary-bg: #e0f4fa;--primary-accent: #79b4d8;--primary-dark: #1e3a5f;--input-bg: #ffffff;--error-color: #e74c3c;--resolve-color: #26a69a;--table-header-bg: #d0eaf5;--table-row-hover: #f2faff}mat-card[_ngcontent-%COMP%]{margin:2rem auto;padding:1.5rem;background:var(--input-bg);box-shadow:0 4px 20px #0000001a;border-radius:12px}mat-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:.5rem;color:var(--primary-dark);font-weight:600;font-size:24px}.status-filter[_ngcontent-%COMP%]{width:250px;margin:1.5rem 0}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:50px 0}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background-color:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px #0000000d}th.mat-header-cell[_ngcontent-%COMP%]{background-color:var(--table-header-bg);color:var(--primary-dark);font-weight:600;padding:12px;border-bottom:1px solid #ccc}td.mat-cell[_ngcontent-%COMP%]{padding:12px 16px;color:#333;border-bottom:1px solid #eee}tr.mat-row[_ngcontent-%COMP%]:hover{background-color:var(--table-row-hover);transition:background-color .2s ease-in-out}mat-chip[_ngcontent-%COMP%]{background-color:var(--primary-accent);color:#fff;font-weight:500;margin-right:5px}.status-pending[_ngcontent-%COMP%], .status-rejected[_ngcontent-%COMP%], .status-verified[_ngcontent-%COMP%], .status-resolved[_ngcontent-%COMP%]{display:inline-block;padding:6px 10px;border-radius:4px;font-weight:600;font-size:13px}.status-pending[_ngcontent-%COMP%]{background-color:#fff59d;color:#444}.status-rejected[_ngcontent-%COMP%]{background-color:#ef9a9a;color:#fff}.status-verified[_ngcontent-%COMP%]{background-color:#a5d6a7;color:#fff}.status-resolved[_ngcontent-%COMP%]{background-color:#81d4fa;color:#fff}td.mat-cell[_ngcontent-%COMP%] > ng-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:8px 0}.action-button[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;gap:6px;height:36px;width:120px;padding:0 12px;font-size:13px;font-weight:500;line-height:1;border-radius:6px;box-shadow:0 2px 4px #0000001a;text-transform:none;box-sizing:border-box;transition:background-color .2s ease,box-shadow .2s ease}.action-button[color=primary][_ngcontent-%COMP%]{background-color:var(--primary-accent);color:#000}.action-button[color=primary][_ngcontent-%COMP%]:hover{background-color:#1e8e81;box-shadow:0 3px 6px #00000026;color:#fff}.action-button[color=warn][_ngcontent-%COMP%]{background-color:var(--error-color);color:#000}.action-button[color=warn][_ngcontent-%COMP%]:hover{background-color:#ac1e08;color:#fff}.action-button[color=accent][_ngcontent-%COMP%]{background-color:var(--resolve-color);color:#000}.action-button[color=accent][_ngcontent-%COMP%]:hover{background-color:#5fa2c9;color:#fff}.action-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;line-height:1}mat-paginator[_ngcontent-%COMP%]{margin-top:1.5rem;background:transparent}.back-button[_ngcontent-%COMP%]{position:fixed;top:16px;left:16px;z-index:1000;width:40px;height:40px;padding:0;background-color:#fff;border:1px solid #ccc;border-radius:8px;box-shadow:0 4px 12px #0000000d;display:flex;align-items:center;justify-content:center;transition:background-color .2s ease,transform .1s ease}.back-button[_ngcontent-%COMP%]:hover{background-color:#f9f9f9;transform:translate(-2px)}.back-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;color:#0009}"]})};var $Y=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:yM},{path:"register",component:_M},{path:"validate-account",component:Hw},{path:"map",component:SM,canActivate:[Gh]},{path:"report/new",component:qw,canActivate:[Gh]},{path:"report/edit/:id",component:qw,canActivate:[Gh]},{path:"user/edit",component:iI,canActivate:[Gh]},{path:"user/edit/password",component:nI,canActivate:[Gh]},{path:"profile",component:rI,canActivate:[Gh]},{path:"my-reports",component:oI,canActivate:[Gh]},{path:"validate-account",component:Hw},{path:"reset-password",component:TM},{path:"report-list-admin",component:HM,canActivate:[Yp]},{path:"report-histories",component:YM,canActivate:[Yp]},{path:"report-summary",component:XM,canActivate:[Yp]},{path:"category-list",component:eI,canActivate:[Yp]},{path:"categories/create",component:Jw,canActivate:[Yp]},{path:"categories/edit/:id",component:Jw,canActivate:[Yp]},{path:"**",component:DM}];var Nr=function(t){return t[t.State=0]="State",t[t.Transition=1]="Transition",t[t.Sequence=2]="Sequence",t[t.Group=3]="Group",t[t.Animate=4]="Animate",t[t.Keyframes=5]="Keyframes",t[t.Style=6]="Style",t[t.Trigger=7]="Trigger",t[t.Reference=8]="Reference",t[t.AnimateChild=9]="AnimateChild",t[t.AnimateRef=10]="AnimateRef",t[t.Query=11]="Query",t[t.Stagger=12]="Stagger",t}(Nr||{}),Xd="*";function GY(t,i=null){return{type:Nr.Sequence,steps:t,options:i}}function tF(t){return{type:Nr.Style,styles:t,offset:null}}var Kp=class{_onDoneFns=[];_onStartFns=[];_onDestroyFns=[];_originalOnDoneFns=[];_originalOnStartFns=[];_started=!1;_destroyed=!1;_finished=!1;_position=0;parentPlayer=null;totalTime;constructor(i=0,e=0){this.totalTime=i+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(i=>i()),this._onDoneFns=[])}onStart(i){this._originalOnStartFns.push(i),this._onStartFns.push(i)}onDone(i){this._originalOnDoneFns.push(i),this._onDoneFns.push(i)}onDestroy(i){this._onDestroyFns.push(i)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(i=>i()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(i=>i()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(i){this._position=this.totalTime?i*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(i){let e=i=="start"?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}},Ov=class{_onDoneFns=[];_onStartFns=[];_finished=!1;_started=!1;_destroyed=!1;_onDestroyFns=[];parentPlayer=null;totalTime=0;players;constructor(i){this.players=i;let e=0,n=0,o=0,r=this.players.length;r==0?queueMicrotask(()=>this._onFinish()):this.players.forEach(g=>{g.onDone(()=>{++e==r&&this._onFinish()}),g.onDestroy(()=>{++n==r&&this._onDestroy()}),g.onStart(()=>{++o==r&&this._onStart()})}),this.totalTime=this.players.reduce((g,w)=>Math.max(g,w.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(i=>i()),this._onDoneFns=[])}init(){this.players.forEach(i=>i.init())}onStart(i){this._onStartFns.push(i)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(i=>i()),this._onStartFns=[])}onDone(i){this._onDoneFns.push(i)}onDestroy(i){this._onDestroyFns.push(i)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(i=>i.play())}pause(){this.players.forEach(i=>i.pause())}restart(){this.players.forEach(i=>i.restart())}finish(){this._onFinish(),this.players.forEach(i=>i.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(i=>i.destroy()),this._onDestroyFns.forEach(i=>i()),this._onDestroyFns=[])}reset(){this.players.forEach(i=>i.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(i){let e=i*this.totalTime;this.players.forEach(n=>{let o=n.totalTime?Math.min(1,e/n.totalTime):1;n.setPosition(o)})}getPosition(){let i=this.players.reduce((e,n)=>e===null||n.totalTime>e.totalTime?n:e,null);return i!=null?i.getPosition():0}beforeDestroy(){this.players.forEach(i=>{i.beforeDestroy&&i.beforeDestroy()})}triggerCallback(i){let e=i=="start"?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}},eE="!";function WY(t){return new si(3e3,!1)}function U1e(){return new si(3100,!1)}function H1e(){return new si(3101,!1)}function q1e(t){return new si(3001,!1)}function $1e(t){return new si(3003,!1)}function G1e(t){return new si(3004,!1)}function YY(t,i){return new si(3005,!1)}function KY(){return new si(3006,!1)}function XY(){return new si(3007,!1)}function QY(t,i){return new si(3008,!1)}function JY(t){return new si(3002,!1)}function eK(t,i,e,n,o){return new si(3010,!1)}function tK(){return new si(3011,!1)}function iK(){return new si(3012,!1)}function nK(){return new si(3200,!1)}function rK(){return new si(3202,!1)}function oK(){return new si(3013,!1)}function aK(t){return new si(3014,!1)}function sK(t){return new si(3015,!1)}function lK(t){return new si(3016,!1)}function cK(t,i){return new si(3404,!1)}function W1e(t){return new si(3502,!1)}function uK(t){return new si(3503,!1)}function dK(){return new si(3300,!1)}function hK(t){return new si(3504,!1)}function pK(t){return new si(3301,!1)}function fK(t,i){return new si(3302,!1)}function mK(t){return new si(3303,!1)}function gK(t,i){return new si(3400,!1)}function _K(t){return new si(3401,!1)}function yK(t){return new si(3402,!1)}function vK(t,i){return new si(3505,!1)}function Xp(t){switch(t.length){case 0:return new Kp;case 1:return t[0];default:return new Ov(t)}}function oF(t,i,e=new Map,n=new Map){let o=[],r=[],g=-1,w=null;if(i.forEach(T=>{let k=T.get("offset"),N=k==g,V=N&&w||new Map;T.forEach((q,Z)=>{let X=Z,te=q;if(Z!=="offset")switch(X=t.normalizePropertyName(X,o),te){case eE:te=e.get(Z);break;case Xd:te=n.get(Z);break;default:te=t.normalizeStyleValue(Z,X,te,o);break}V.set(X,te)}),N||r.push(V),w=V,g=k}),o.length)throw W1e(o);return r}function aI(t,i,e,n){switch(i){case"start":t.onStart(()=>n(e&&iF(e,"start",t)));break;case"done":t.onDone(()=>n(e&&iF(e,"done",t)));break;case"destroy":t.onDestroy(()=>n(e&&iF(e,"destroy",t)));break}}function iF(t,i,e){let n=e.totalTime,o=!!e.disabled,r=sI(t.element,t.triggerName,t.fromState,t.toState,i||t.phaseName,n??t.totalTime,o),g=t._data;return g!=null&&(r._data=g),r}function sI(t,i,e,n,o="",r=0,g){return{element:t,triggerName:i,fromState:e,toState:n,phaseName:o,totalTime:r,disabled:!!g}}function Ac(t,i,e){let n=t.get(i);return n||t.set(i,n=e),n}function aF(t){let i=t.indexOf(":"),e=t.substring(1,i),n=t.slice(i+1);return[e,n]}var Z1e=typeof document>"u"?null:document.documentElement;function sF(t){let i=t.parentNode||t.host||null;return i===Z1e?null:i}function Y1e(t){return t.substring(1,6)=="ebkit"}var U0=null,ZY=!1;function bK(t){U0||(U0=K1e()||{},ZY=U0.style?"WebkitAppearance"in U0.style:!1);let i=!0;return U0.style&&!Y1e(t)&&(i=t in U0.style,!i&&ZY&&(i="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in U0.style)),i}function K1e(){return typeof document<"u"?document.body:null}function xK(t,i){for(;i;){if(i===t)return!0;i=sF(i)}return!1}function wK(t,i,e){if(e)return Array.from(t.querySelectorAll(i));let n=t.querySelector(i);return n?[n]:[]}var X1e=1e3,lF="{{",Q1e="}}",cF="ng-enter",lI="ng-leave",tE="ng-trigger",iE=".ng-trigger",uF="ng-animating",cI=".ng-animating";function Kh(t){if(typeof t=="number")return t;let i=t.match(/^(-?[\.\d]+)(m?s)/);return!i||i.length<2?0:nF(parseFloat(i[1]),i[2])}function nF(t,i){switch(i){case"s":return t*X1e;default:return t}}function nE(t,i,e){return t.hasOwnProperty("duration")?t:J1e(t,i,e)}function J1e(t,i,e){let n=/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i,o,r=0,g="";if(typeof t=="string"){let w=t.match(n);if(w===null)return i.push(WY(t)),{duration:0,delay:0,easing:""};o=nF(parseFloat(w[1]),w[2]);let T=w[3];T!=null&&(r=nF(parseFloat(T),w[4]));let k=w[5];k&&(g=k)}else o=t;if(!e){let w=!1,T=i.length;o<0&&(i.push(U1e()),w=!0),r<0&&(i.push(H1e()),w=!0),w&&i.splice(T,0,WY(t))}return{duration:o,delay:r,easing:g}}function H0(t,i,e){i.forEach((n,o)=>{let r=uI(o);e&&!e.has(o)&&e.set(o,t.style[r]),t.style[r]=n})}function Pv(t,i){i.forEach((e,n)=>{let o=uI(n);t.style[o]=""})}function Nv(t){return Array.isArray(t)?t.length==1?t[0]:GY(t):t}function EK(t,i,e){let n=i.params||{},o=dF(t);o.length&&o.forEach(r=>{n.hasOwnProperty(r)||e.push(q1e(r))})}var rF=new RegExp(`${lF}\\s*(.+?)\\s*${Q1e}`,"g");function dF(t){let i=[];if(typeof t=="string"){let e;for(;e=rF.exec(t);)i.push(e[1]);rF.lastIndex=0}return i}function Lv(t,i,e){let n=`${t}`,o=n.replace(rF,(r,g)=>{let w=i[g];return w==null&&(e.push($1e(g)),w=""),w.toString()});return o==n?t:o}var exe=/-+([a-z0-9])/g;function uI(t){return t.replace(exe,(...i)=>i[1].toUpperCase())}function Rc(t,i,e){switch(i.type){case Nr.Trigger:return t.visitTrigger(i,e);case Nr.State:return t.visitState(i,e);case Nr.Transition:return t.visitTransition(i,e);case Nr.Sequence:return t.visitSequence(i,e);case Nr.Group:return t.visitGroup(i,e);case Nr.Animate:return t.visitAnimate(i,e);case Nr.Keyframes:return t.visitKeyframes(i,e);case Nr.Style:return t.visitStyle(i,e);case Nr.Reference:return t.visitReference(i,e);case Nr.AnimateChild:return t.visitAnimateChild(i,e);case Nr.AnimateRef:return t.visitAnimateRef(i,e);case Nr.Query:return t.visitQuery(i,e);case Nr.Stagger:return t.visitStagger(i,e);default:throw G1e(i.type)}}var wI=(()=>{class t{validateStyleProperty(e){return bK(e)}containsElement(e,n){return xK(e,n)}getParentElement(e){return sF(e)}query(e,n,o){return wK(e,n,o)}computeStyle(e,n,o){return o||""}animate(e,n,o,r,g,w=[],T){return new Kp(o,r)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})(),$0=class{static NOOP=new wI},G0=class{};var txe=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]),mI=class extends G0{normalizePropertyName(i,e){return uI(i)}normalizeStyleValue(i,e,n,o){let r="",g=n.toString().trim();if(txe.has(e)&&n!==0&&n!=="0")if(typeof n=="number")r="px";else{let w=n.match(/^[+-]?[\d\.]+([a-z]*)$/);w&&w[1].length==0&&o.push(YY(i,n))}return g+r}};var gI="*";function ixe(t,i){let e=[];return typeof t=="string"?t.split(/\s*,\s*/).forEach(n=>nxe(n,e,i)):e.push(t),e}function nxe(t,i,e){if(t[0]==":"){let T=rxe(t,e);if(typeof T=="function"){i.push(T);return}t=T}let n=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(n==null||n.length<4)return e.push(sK(t)),i;let o=n[1],r=n[2],g=n[3];i.push(CK(o,g));let w=o==gI&&g==gI;r[0]=="<"&&!w&&i.push(CK(g,o))}function rxe(t,i){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,n)=>parseFloat(n)>parseFloat(e);case":decrement":return(e,n)=>parseFloat(n)<parseFloat(e);default:return i.push(lK(t)),"* => *"}}var dI=new Set(["true","1"]),hI=new Set(["false","0"]);function CK(t,i){let e=dI.has(t)||hI.has(t),n=dI.has(i)||hI.has(i);return(o,r)=>{let g=t==gI||t==o,w=i==gI||i==r;return!g&&e&&typeof o=="boolean"&&(g=o?dI.has(t):hI.has(t)),!w&&n&&typeof r=="boolean"&&(w=r?dI.has(i):hI.has(i)),g&&w}}var PK=":self",oxe=new RegExp(`s*${PK}s*,?`,"g");function NK(t,i,e,n){return new gF(t).build(i,e,n)}var SK="",gF=class{_driver;constructor(i){this._driver=i}build(i,e,n){let o=new _F(e);return this._resetContextStyleTimingState(o),Rc(this,Nv(i),o)}_resetContextStyleTimingState(i){i.currentQuerySelector=SK,i.collectedStyles=new Map,i.collectedStyles.set(SK,new Map),i.currentTime=0}visitTrigger(i,e){let n=e.queryCount=0,o=e.depCount=0,r=[],g=[];return i.name.charAt(0)=="@"&&e.errors.push(KY()),i.definitions.forEach(w=>{if(this._resetContextStyleTimingState(e),w.type==Nr.State){let T=w,k=T.name;k.toString().split(/\s*,\s*/).forEach(N=>{T.name=N,r.push(this.visitState(T,e))}),T.name=k}else if(w.type==Nr.Transition){let T=this.visitTransition(w,e);n+=T.queryCount,o+=T.depCount,g.push(T)}else e.errors.push(XY())}),{type:Nr.Trigger,name:i.name,states:r,transitions:g,queryCount:n,depCount:o,options:null}}visitState(i,e){let n=this.visitStyle(i.styles,e),o=i.options&&i.options.params||null;if(n.containsDynamicStyles){let r=new Set,g=o||{};n.styles.forEach(w=>{w instanceof Map&&w.forEach(T=>{dF(T).forEach(k=>{g.hasOwnProperty(k)||r.add(k)})})}),r.size&&e.errors.push(QY(i.name,[...r.values()]))}return{type:Nr.State,name:i.name,style:n,options:o?{params:o}:null}}visitTransition(i,e){e.queryCount=0,e.depCount=0;let n=Rc(this,Nv(i.animation),e),o=ixe(i.expr,e.errors);return{type:Nr.Transition,matchers:o,animation:n,queryCount:e.queryCount,depCount:e.depCount,options:q0(i.options)}}visitSequence(i,e){return{type:Nr.Sequence,steps:i.steps.map(n=>Rc(this,n,e)),options:q0(i.options)}}visitGroup(i,e){let n=e.currentTime,o=0,r=i.steps.map(g=>{e.currentTime=n;let w=Rc(this,g,e);return o=Math.max(o,e.currentTime),w});return e.currentTime=o,{type:Nr.Group,steps:r,options:q0(i.options)}}visitAnimate(i,e){let n=cxe(i.timings,e.errors);e.currentAnimateTimings=n;let o,r=i.styles?i.styles:tF({});if(r.type==Nr.Keyframes)o=this.visitKeyframes(r,e);else{let g=i.styles,w=!1;if(!g){w=!0;let k={};n.easing&&(k.easing=n.easing),g=tF(k)}e.currentTime+=n.duration+n.delay;let T=this.visitStyle(g,e);T.isEmptyStep=w,o=T}return e.currentAnimateTimings=null,{type:Nr.Animate,timings:n,style:o,options:null}}visitStyle(i,e){let n=this._makeStyleAst(i,e);return this._validateStyleAst(n,e),n}_makeStyleAst(i,e){let n=[],o=Array.isArray(i.styles)?i.styles:[i.styles];for(let w of o)typeof w=="string"?w===Xd?n.push(w):e.errors.push(JY(w)):n.push(new Map(Object.entries(w)));let r=!1,g=null;return n.forEach(w=>{if(w instanceof Map&&(w.has("easing")&&(g=w.get("easing"),w.delete("easing")),!r)){for(let T of w.values())if(T.toString().indexOf(lF)>=0){r=!0;break}}}),{type:Nr.Style,styles:n,easing:g,offset:i.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(i,e){let n=e.currentAnimateTimings,o=e.currentTime,r=e.currentTime;n&&r>0&&(r-=n.duration+n.delay),i.styles.forEach(g=>{typeof g!="string"&&g.forEach((w,T)=>{let k=e.collectedStyles.get(e.currentQuerySelector),N=k.get(T),V=!0;N&&(r!=o&&r>=N.startTime&&o<=N.endTime&&(e.errors.push(eK(T,N.startTime,N.endTime,r,o)),V=!1),r=N.startTime),V&&k.set(T,{startTime:r,endTime:o}),e.options&&EK(w,e.options,e.errors)})})}visitKeyframes(i,e){let n={type:Nr.Keyframes,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(tK()),n;let o=1,r=0,g=[],w=!1,T=!1,k=0,N=i.steps.map(_e=>{let he=this._makeStyleAst(_e,e),Ce=he.offset!=null?he.offset:lxe(he.styles),Pe=0;return Ce!=null&&(r++,Pe=he.offset=Ce),T=T||Pe<0||Pe>1,w=w||Pe<k,k=Pe,g.push(Pe),he});T&&e.errors.push(iK()),w&&e.errors.push(nK());let V=i.steps.length,q=0;r>0&&r<V?e.errors.push(rK()):r==0&&(q=o/(V-1));let Z=V-1,X=e.currentTime,te=e.currentAnimateTimings,De=te.duration;return N.forEach((_e,he)=>{let Ce=q>0?he==Z?1:q*he:g[he],Pe=Ce*De;e.currentTime=X+te.delay+Pe,te.duration=Pe,this._validateStyleAst(_e,e),_e.offset=Ce,n.styles.push(_e)}),n}visitReference(i,e){return{type:Nr.Reference,animation:Rc(this,Nv(i.animation),e),options:q0(i.options)}}visitAnimateChild(i,e){return e.depCount++,{type:Nr.AnimateChild,options:q0(i.options)}}visitAnimateRef(i,e){return{type:Nr.AnimateRef,animation:this.visitReference(i.animation,e),options:q0(i.options)}}visitQuery(i,e){let n=e.currentQuerySelector,o=i.options||{};e.queryCount++,e.currentQuery=i;let[r,g]=axe(i.selector);e.currentQuerySelector=n.length?n+" "+r:r,Ac(e.collectedStyles,e.currentQuerySelector,new Map);let w=Rc(this,Nv(i.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:Nr.Query,selector:r,limit:o.limit||0,optional:!!o.optional,includeSelf:g,animation:w,originalSelector:i.selector,options:q0(i.options)}}visitStagger(i,e){e.currentQuery||e.errors.push(oK());let n=i.timings==="full"?{duration:0,delay:0,easing:"full"}:nE(i.timings,e.errors,!0);return{type:Nr.Stagger,animation:Rc(this,Nv(i.animation),e),timings:n,options:null}}};function axe(t){let i=!!t.split(/\s*,\s*/).find(e=>e==PK);return i&&(t=t.replace(oxe,"")),t=t.replace(/@\*/g,iE).replace(/@\w+/g,e=>iE+"-"+e.slice(1)).replace(/:animating/g,cI),[t,i]}function sxe(t){return t?It({},t):null}var _F=class{errors;queryCount=0;depCount=0;currentTransition=null;currentQuery=null;currentQuerySelector=null;currentAnimateTimings=null;currentTime=0;collectedStyles=new Map;options=null;unsupportedCSSPropertiesFound=new Set;constructor(i){this.errors=i}};function lxe(t){if(typeof t=="string")return null;let i=null;if(Array.isArray(t))t.forEach(e=>{if(e instanceof Map&&e.has("offset")){let n=e;i=parseFloat(n.get("offset")),n.delete("offset")}});else if(t instanceof Map&&t.has("offset")){let e=t;i=parseFloat(e.get("offset")),e.delete("offset")}return i}function cxe(t,i){if(t.hasOwnProperty("duration"))return t;if(typeof t=="number"){let r=nE(t,i).duration;return hF(r,0,"")}let e=t;if(e.split(/\s+/).some(r=>r.charAt(0)=="{"&&r.charAt(1)=="{")){let r=hF(0,0,"");return r.dynamic=!0,r.strValue=e,r}let o=nE(e,i);return hF(o.duration,o.delay,o.easing)}function q0(t){return t?(t=It({},t),t.params&&(t.params=sxe(t.params))):t={},t}function hF(t,i,e){return{duration:t,delay:i,easing:e}}function DF(t,i,e,n,o,r,g=null,w=!1){return{type:1,element:t,keyframes:i,preStyleProps:e,postStyleProps:n,duration:o,delay:r,totalTime:o+r,easing:g,subTimeline:w}}var oE=class{_map=new Map;get(i){return this._map.get(i)||[]}append(i,e){let n=this._map.get(i);n||this._map.set(i,n=[]),n.push(...e)}has(i){return this._map.has(i)}clear(){this._map.clear()}},uxe=1,dxe=":enter",hxe=new RegExp(dxe,"g"),pxe=":leave",fxe=new RegExp(pxe,"g");function LK(t,i,e,n,o,r=new Map,g=new Map,w,T,k=[]){return new yF().buildKeyframes(t,i,e,n,o,r,g,w,T,k)}var yF=class{buildKeyframes(i,e,n,o,r,g,w,T,k,N=[]){k=k||new oE;let V=new vF(i,e,k,o,r,N,[]);V.options=T;let q=T.delay?Kh(T.delay):0;V.currentTimeline.delayNextStep(q),V.currentTimeline.setStyles([g],null,V.errors,T),Rc(this,n,V);let Z=V.timelines.filter(X=>X.containsAnimation());if(Z.length&&w.size){let X;for(let te=Z.length-1;te>=0;te--){let De=Z[te];if(De.element===e){X=De;break}}X&&!X.allowOnlyTimelineStyles()&&X.setStyles([w],null,V.errors,T)}return Z.length?Z.map(X=>X.buildKeyframes()):[DF(e,[],[],[],0,q,"",!1)]}visitTrigger(i,e){}visitState(i,e){}visitTransition(i,e){}visitAnimateChild(i,e){let n=e.subInstructions.get(e.element);if(n){let o=e.createSubContext(i.options),r=e.currentTimeline.currentTime,g=this._visitSubInstructions(n,o,o.options);r!=g&&e.transformIntoNewTimeline(g)}e.previousNode=i}visitAnimateRef(i,e){let n=e.createSubContext(i.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([i.options,i.animation.options],e,n),this.visitReference(i.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=i}_applyAnimationRefDelays(i,e,n){for(let o of i){let r=o?.delay;if(r){let g=typeof r=="number"?r:Kh(Lv(r,o?.params??{},e.errors));n.delayNextStep(g)}}}_visitSubInstructions(i,e,n){let r=e.currentTimeline.currentTime,g=n.duration!=null?Kh(n.duration):null,w=n.delay!=null?Kh(n.delay):null;return g!==0&&i.forEach(T=>{let k=e.appendInstructionToTimeline(T,g,w);r=Math.max(r,k.duration+k.delay)}),r}visitReference(i,e){e.updateOptions(i.options,!0),Rc(this,i.animation,e),e.previousNode=i}visitSequence(i,e){let n=e.subContextCount,o=e,r=i.options;if(r&&(r.params||r.delay)&&(o=e.createSubContext(r),o.transformIntoNewTimeline(),r.delay!=null)){o.previousNode.type==Nr.Style&&(o.currentTimeline.snapshotCurrentStyles(),o.previousNode=_I);let g=Kh(r.delay);o.delayNextStep(g)}i.steps.length&&(i.steps.forEach(g=>Rc(this,g,o)),o.currentTimeline.applyStylesToKeyframe(),o.subContextCount>n&&o.transformIntoNewTimeline()),e.previousNode=i}visitGroup(i,e){let n=[],o=e.currentTimeline.currentTime,r=i.options&&i.options.delay?Kh(i.options.delay):0;i.steps.forEach(g=>{let w=e.createSubContext(i.options);r&&w.delayNextStep(r),Rc(this,g,w),o=Math.max(o,w.currentTimeline.currentTime),n.push(w.currentTimeline)}),n.forEach(g=>e.currentTimeline.mergeTimelineCollectedStyles(g)),e.transformIntoNewTimeline(o),e.previousNode=i}_visitTiming(i,e){if(i.dynamic){let n=i.strValue,o=e.params?Lv(n,e.params,e.errors):n;return nE(o,e.errors)}else return{duration:i.duration,delay:i.delay,easing:i.easing}}visitAnimate(i,e){let n=e.currentAnimateTimings=this._visitTiming(i.timings,e),o=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),o.snapshotCurrentStyles());let r=i.style;r.type==Nr.Keyframes?this.visitKeyframes(r,e):(e.incrementTime(n.duration),this.visitStyle(r,e),o.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=i}visitStyle(i,e){let n=e.currentTimeline,o=e.currentAnimateTimings;!o&&n.hasCurrentStyleProperties()&&n.forwardFrame();let r=o&&o.easing||i.easing;i.isEmptyStep?n.applyEmptyStep(r):n.setStyles(i.styles,r,e.errors,e.options),e.previousNode=i}visitKeyframes(i,e){let n=e.currentAnimateTimings,o=e.currentTimeline.duration,r=n.duration,w=e.createSubContext().currentTimeline;w.easing=n.easing,i.styles.forEach(T=>{let k=T.offset||0;w.forwardTime(k*r),w.setStyles(T.styles,T.easing,e.errors,e.options),w.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(w),e.transformIntoNewTimeline(o+r),e.previousNode=i}visitQuery(i,e){let n=e.currentTimeline.currentTime,o=i.options||{},r=o.delay?Kh(o.delay):0;r&&(e.previousNode.type===Nr.Style||n==0&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=_I);let g=n,w=e.invokeQuery(i.selector,i.originalSelector,i.limit,i.includeSelf,!!o.optional,e.errors);e.currentQueryTotal=w.length;let T=null;w.forEach((k,N)=>{e.currentQueryIndex=N;let V=e.createSubContext(i.options,k);r&&V.delayNextStep(r),k===e.element&&(T=V.currentTimeline),Rc(this,i.animation,V),V.currentTimeline.applyStylesToKeyframe();let q=V.currentTimeline.currentTime;g=Math.max(g,q)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(g),T&&(e.currentTimeline.mergeTimelineCollectedStyles(T),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=i}visitStagger(i,e){let n=e.parentContext,o=e.currentTimeline,r=i.timings,g=Math.abs(r.duration),w=g*(e.currentQueryTotal-1),T=g*e.currentQueryIndex;switch(r.duration<0?"reverse":r.easing){case"reverse":T=w-T;break;case"full":T=n.currentStaggerTime;break}let N=e.currentTimeline;T&&N.delayNextStep(T);let V=N.currentTime;Rc(this,i.animation,e),e.previousNode=i,n.currentStaggerTime=o.currentTime-V+(o.startTime-n.currentTimeline.startTime)}},_I={},vF=class t{_driver;element;subInstructions;_enterClassName;_leaveClassName;errors;timelines;parentContext=null;currentTimeline;currentAnimateTimings=null;previousNode=_I;subContextCount=0;options={};currentQueryIndex=0;currentQueryTotal=0;currentStaggerTime=0;constructor(i,e,n,o,r,g,w,T){this._driver=i,this.element=e,this.subInstructions=n,this._enterClassName=o,this._leaveClassName=r,this.errors=g,this.timelines=w,this.currentTimeline=T||new yI(this._driver,e,0),w.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(i,e){if(!i)return;let n=i,o=this.options;n.duration!=null&&(o.duration=Kh(n.duration)),n.delay!=null&&(o.delay=Kh(n.delay));let r=n.params;if(r){let g=o.params;g||(g=this.options.params={}),Object.keys(r).forEach(w=>{(!e||!g.hasOwnProperty(w))&&(g[w]=Lv(r[w],g,this.errors))})}}_copyOptions(){let i={};if(this.options){let e=this.options.params;if(e){let n=i.params={};Object.keys(e).forEach(o=>{n[o]=e[o]})}}return i}createSubContext(i=null,e,n){let o=e||this.element,r=new t(this._driver,o,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(o,n||0));return r.previousNode=this.previousNode,r.currentAnimateTimings=this.currentAnimateTimings,r.options=this._copyOptions(),r.updateOptions(i),r.currentQueryIndex=this.currentQueryIndex,r.currentQueryTotal=this.currentQueryTotal,r.parentContext=this,this.subContextCount++,r}transformIntoNewTimeline(i){return this.previousNode=_I,this.currentTimeline=this.currentTimeline.fork(this.element,i),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(i,e,n){let o={duration:e??i.duration,delay:this.currentTimeline.currentTime+(n??0)+i.delay,easing:""},r=new bF(this._driver,i.element,i.keyframes,i.preStyleProps,i.postStyleProps,o,i.stretchStartingKeyframe);return this.timelines.push(r),o}incrementTime(i){this.currentTimeline.forwardTime(this.currentTimeline.duration+i)}delayNextStep(i){i>0&&this.currentTimeline.delayNextStep(i)}invokeQuery(i,e,n,o,r,g){let w=[];if(o&&w.push(this.element),i.length>0){i=i.replace(hxe,"."+this._enterClassName),i=i.replace(fxe,"."+this._leaveClassName);let T=n!=1,k=this._driver.query(this.element,i,T);n!==0&&(k=n<0?k.slice(k.length+n,k.length):k.slice(0,n)),w.push(...k)}return!r&&w.length==0&&g.push(aK(e)),w}},yI=class t{_driver;element;startTime;_elementTimelineStylesLookup;duration=0;easing=null;_previousKeyframe=new Map;_currentKeyframe=new Map;_keyframes=new Map;_styleSummary=new Map;_localTimelineStyles=new Map;_globalTimelineStyles;_pendingStyles=new Map;_backFill=new Map;_currentEmptyStepKeyframe=null;constructor(i,e,n,o){this._driver=i,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=o,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(i){let e=this._keyframes.size===1&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+i),e&&this.snapshotCurrentStyles()):this.startTime+=i}fork(i,e){return this.applyStylesToKeyframe(),new t(this._driver,i,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=uxe,this._loadKeyframe()}forwardTime(i){this.applyStylesToKeyframe(),this.duration=i,this._loadKeyframe()}_updateStyle(i,e){this._localTimelineStyles.set(i,e),this._globalTimelineStyles.set(i,e),this._styleSummary.set(i,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(i){i&&this._previousKeyframe.set("easing",i);for(let[e,n]of this._globalTimelineStyles)this._backFill.set(e,n||Xd),this._currentKeyframe.set(e,Xd);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(i,e,n,o){e&&this._previousKeyframe.set("easing",e);let r=o&&o.params||{},g=mxe(i,this._globalTimelineStyles);for(let[w,T]of g){let k=Lv(T,r,n);this._pendingStyles.set(w,k),this._localTimelineStyles.has(w)||this._backFill.set(w,this._globalTimelineStyles.get(w)??Xd),this._updateStyle(w,k)}}applyStylesToKeyframe(){this._pendingStyles.size!=0&&(this._pendingStyles.forEach((i,e)=>{this._currentKeyframe.set(e,i)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((i,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,i)}))}snapshotCurrentStyles(){for(let[i,e]of this._localTimelineStyles)this._pendingStyles.set(i,e),this._updateStyle(i,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){let i=[];for(let e in this._currentKeyframe)i.push(e);return i}mergeTimelineCollectedStyles(i){i._styleSummary.forEach((e,n)=>{let o=this._styleSummary.get(n);(!o||e.time>o.time)&&this._updateStyle(n,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();let i=new Set,e=new Set,n=this._keyframes.size===1&&this.duration===0,o=[];this._keyframes.forEach((w,T)=>{let k=new Map([...this._backFill,...w]);k.forEach((N,V)=>{N===eE?i.add(V):N===Xd&&e.add(V)}),n||k.set("offset",T/this.duration),o.push(k)});let r=[...i.values()],g=[...e.values()];if(n){let w=o[0],T=new Map(w);w.set("offset",0),T.set("offset",1),o=[w,T]}return DF(this.element,o,r,g,this.duration,this.startTime,this.easing,!1)}},bF=class extends yI{keyframes;preStyleProps;postStyleProps;_stretchStartingKeyframe;timings;constructor(i,e,n,o,r,g,w=!1){super(i,e,g.delay),this.keyframes=n,this.preStyleProps=o,this.postStyleProps=r,this._stretchStartingKeyframe=w,this.timings={duration:g.duration,delay:g.delay,easing:g.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let i=this.keyframes,{delay:e,duration:n,easing:o}=this.timings;if(this._stretchStartingKeyframe&&e){let r=[],g=n+e,w=e/g,T=new Map(i[0]);T.set("offset",0),r.push(T);let k=new Map(i[0]);k.set("offset",TK(w)),r.push(k);let N=i.length-1;for(let V=1;V<=N;V++){let q=new Map(i[V]),Z=q.get("offset"),X=e+Z*n;q.set("offset",TK(X/g)),r.push(q)}n=g,e=0,o="",i=r}return DF(this.element,i,this.preStyleProps,this.postStyleProps,n,e,o,!0)}};function TK(t,i=3){let e=Math.pow(10,i-1);return Math.round(t*e)/e}function mxe(t,i){let e=new Map,n;return t.forEach(o=>{if(o==="*"){n??=i.keys();for(let r of n)e.set(r,Xd)}else for(let[r,g]of o)e.set(r,g)}),e}function DK(t,i,e,n,o,r,g,w,T,k,N,V,q){return{type:0,element:t,triggerName:i,isRemovalTransition:o,fromState:e,fromStyles:r,toState:n,toStyles:g,timelines:w,queriedElements:T,preStyleProps:k,postStyleProps:N,totalTime:V,errors:q}}var pF={},vI=class{_triggerName;ast;_stateStyles;constructor(i,e,n){this._triggerName=i,this.ast=e,this._stateStyles=n}match(i,e,n,o){return gxe(this.ast.matchers,i,e,n,o)}buildStyles(i,e,n){let o=this._stateStyles.get("*");return i!==void 0&&(o=this._stateStyles.get(i?.toString())||o),o?o.buildStyles(e,n):new Map}build(i,e,n,o,r,g,w,T,k,N){let V=[],q=this.ast.options&&this.ast.options.params||pF,Z=w&&w.params||pF,X=this.buildStyles(n,Z,V),te=T&&T.params||pF,De=this.buildStyles(o,te,V),_e=new Set,he=new Map,Ce=new Map,Pe=o==="void",ye={params:FK(te,q),delay:this.ast.options?.delay},vt=N?[]:LK(i,e,this.ast.animation,r,g,X,De,ye,k,V),Rt=0;return vt.forEach(ut=>{Rt=Math.max(ut.duration+ut.delay,Rt)}),V.length?DK(e,this._triggerName,n,o,Pe,X,De,[],[],he,Ce,Rt,V):(vt.forEach(ut=>{let ct=ut.element,We=Ac(he,ct,new Set);ut.preStyleProps.forEach(ui=>We.add(ui));let Pt=Ac(Ce,ct,new Set);ut.postStyleProps.forEach(ui=>Pt.add(ui)),ct!==e&&_e.add(ct)}),DK(e,this._triggerName,n,o,Pe,X,De,vt,[..._e.values()],he,Ce,Rt))}};function gxe(t,i,e,n,o){return t.some(r=>r(i,e,n,o))}function FK(t,i){let e=It({},i);return Object.entries(t).forEach(([n,o])=>{o!=null&&(e[n]=o)}),e}var xF=class{styles;defaultParams;normalizer;constructor(i,e,n){this.styles=i,this.defaultParams=e,this.normalizer=n}buildStyles(i,e){let n=new Map,o=FK(i,this.defaultParams);return this.styles.styles.forEach(r=>{typeof r!="string"&&r.forEach((g,w)=>{g&&(g=Lv(g,o,e));let T=this.normalizer.normalizePropertyName(w,e);g=this.normalizer.normalizeStyleValue(w,T,g,e),n.set(w,g)})}),n}};function _xe(t,i,e){return new wF(t,i,e)}var wF=class{name;ast;_normalizer;transitionFactories=[];fallbackTransition;states=new Map;constructor(i,e,n){this.name=i,this.ast=e,this._normalizer=n,e.states.forEach(o=>{let r=o.options&&o.options.params||{};this.states.set(o.name,new xF(o.style,r,n))}),MK(this.states,"true","1"),MK(this.states,"false","0"),e.transitions.forEach(o=>{this.transitionFactories.push(new vI(i,o,this.states))}),this.fallbackTransition=yxe(i,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(i,e,n,o){return this.transitionFactories.find(g=>g.match(i,e,n,o))||null}matchStyles(i,e,n){return this.fallbackTransition.buildStyles(i,e,n)}};function yxe(t,i,e){let n=[(g,w)=>!0],o={type:Nr.Sequence,steps:[],options:null},r={type:Nr.Transition,animation:o,matchers:n,options:null,queryCount:0,depCount:0};return new vI(t,r,i)}function MK(t,i,e){t.has(i)?t.has(e)||t.set(e,t.get(i)):t.has(e)&&t.set(i,t.get(e))}var vxe=new oE,EF=class{bodyNode;_driver;_normalizer;_animations=new Map;_playersById=new Map;players=[];constructor(i,e,n){this.bodyNode=i,this._driver=e,this._normalizer=n}register(i,e){let n=[],o=[],r=NK(this._driver,e,n,o);if(n.length)throw uK(n);this._animations.set(i,r)}_buildPlayer(i,e,n){let o=i.element,r=oF(this._normalizer,i.keyframes,e,n);return this._driver.animate(o,r,i.duration,i.delay,i.easing,[],!0)}create(i,e,n={}){let o=[],r=this._animations.get(i),g,w=new Map;if(r?(g=LK(this._driver,e,r,cF,lI,new Map,new Map,n,vxe,o),g.forEach(N=>{let V=Ac(w,N.element,new Map);N.postStyleProps.forEach(q=>V.set(q,null))})):(o.push(dK()),g=[]),o.length)throw hK(o);w.forEach((N,V)=>{N.forEach((q,Z)=>{N.set(Z,this._driver.computeStyle(V,Z,Xd))})});let T=g.map(N=>{let V=w.get(N.element);return this._buildPlayer(N,new Map,V)}),k=Xp(T);return this._playersById.set(i,k),k.onDestroy(()=>this.destroy(i)),this.players.push(k),k}destroy(i){let e=this._getPlayer(i);e.destroy(),this._playersById.delete(i);let n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(i){let e=this._playersById.get(i);if(!e)throw pK(i);return e}listen(i,e,n,o){let r=sI(e,"","","");return aI(this._getPlayer(i),n,r,o),()=>{}}command(i,e,n,o){if(n=="register"){this.register(i,o[0]);return}if(n=="create"){let g=o[0]||{};this.create(i,e,g);return}let r=this._getPlayer(i);switch(n){case"play":r.play();break;case"pause":r.pause();break;case"reset":r.reset();break;case"restart":r.restart();break;case"finish":r.finish();break;case"init":r.init();break;case"setPosition":r.setPosition(parseFloat(o[0]));break;case"destroy":this.destroy(i);break}}},IK="ng-animate-queued",bxe=".ng-animate-queued",fF="ng-animate-disabled",xxe=".ng-animate-disabled",wxe="ng-star-inserted",Exe=".ng-star-inserted",Cxe=[],zK={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Sxe={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Qd="__ng_removed",aE=class{namespaceId;value;options;get params(){return this.options.params}constructor(i,e=""){this.namespaceId=e;let n=i&&i.hasOwnProperty("value"),o=n?i.value:i;if(this.value=Dxe(o),n){let r=i,{value:g}=r,w=Ys(r,["value"]);this.options=w}else this.options={};this.options.params||(this.options.params={})}absorbOptions(i){let e=i.params;if(e){let n=this.options.params;Object.keys(e).forEach(o=>{n[o]==null&&(n[o]=e[o])})}}},rE="void",mF=new aE(rE),CF=class{id;hostElement;_engine;players=[];_triggers=new Map;_queue=[];_elementListeners=new Map;_hostClassName;constructor(i,e,n){this.id=i,this.hostElement=e,this._engine=n,this._hostClassName="ng-tns-"+i,Qu(e,this._hostClassName)}listen(i,e,n,o){if(!this._triggers.has(e))throw fK(n,e);if(n==null||n.length==0)throw mK(e);if(!Mxe(n))throw gK(n,e);let r=Ac(this._elementListeners,i,[]),g={name:e,phase:n,callback:o};r.push(g);let w=Ac(this._engine.statesByElement,i,new Map);return w.has(e)||(Qu(i,tE),Qu(i,tE+"-"+e),w.set(e,mF)),()=>{this._engine.afterFlush(()=>{let T=r.indexOf(g);T>=0&&r.splice(T,1),this._triggers.has(e)||w.delete(e)})}}register(i,e){return this._triggers.has(i)?!1:(this._triggers.set(i,e),!0)}_getTrigger(i){let e=this._triggers.get(i);if(!e)throw _K(i);return e}trigger(i,e,n,o=!0){let r=this._getTrigger(e),g=new sE(this.id,e,i),w=this._engine.statesByElement.get(i);w||(Qu(i,tE),Qu(i,tE+"-"+e),this._engine.statesByElement.set(i,w=new Map));let T=w.get(e),k=new aE(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&T&&k.absorbOptions(T.options),w.set(e,k),T||(T=mF),!(k.value===rE)&&T.value===k.value){if(!Rxe(T.params,k.params)){let te=[],De=r.matchStyles(T.value,T.params,te),_e=r.matchStyles(k.value,k.params,te);te.length?this._engine.reportError(te):this._engine.afterFlush(()=>{Pv(i,De),H0(i,_e)})}return}let q=Ac(this._engine.playersByElement,i,[]);q.forEach(te=>{te.namespaceId==this.id&&te.triggerName==e&&te.queued&&te.destroy()});let Z=r.matchTransition(T.value,k.value,i,k.params),X=!1;if(!Z){if(!o)return;Z=r.fallbackTransition,X=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:i,triggerName:e,transition:Z,fromState:T,toState:k,player:g,isFallbackTransition:X}),X||(Qu(i,IK),g.onStart(()=>{Fv(i,IK)})),g.onDone(()=>{let te=this.players.indexOf(g);te>=0&&this.players.splice(te,1);let De=this._engine.playersByElement.get(i);if(De){let _e=De.indexOf(g);_e>=0&&De.splice(_e,1)}}),this.players.push(g),q.push(g),g}deregister(i){this._triggers.delete(i),this._engine.statesByElement.forEach(e=>e.delete(i)),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(o=>o.name!=i))})}clearElementCache(i){this._engine.statesByElement.delete(i),this._elementListeners.delete(i);let e=this._engine.playersByElement.get(i);e&&(e.forEach(n=>n.destroy()),this._engine.playersByElement.delete(i))}_signalRemovalForInnerTriggers(i,e){let n=this._engine.driver.query(i,iE,!0);n.forEach(o=>{if(o[Qd])return;let r=this._engine.fetchNamespacesByElement(o);r.size?r.forEach(g=>g.triggerLeaveAnimation(o,e,!1,!0)):this.clearElementCache(o)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(o=>this.clearElementCache(o)))}triggerLeaveAnimation(i,e,n,o){let r=this._engine.statesByElement.get(i),g=new Map;if(r){let w=[];if(r.forEach((T,k)=>{if(g.set(k,T.value),this._triggers.has(k)){let N=this.trigger(i,k,rE,o);N&&w.push(N)}}),w.length)return this._engine.markElementAsRemoved(this.id,i,!0,e,g),n&&Xp(w).onDone(()=>this._engine.processLeaveNode(i)),!0}return!1}prepareLeaveAnimationListeners(i){let e=this._elementListeners.get(i),n=this._engine.statesByElement.get(i);if(e&&n){let o=new Set;e.forEach(r=>{let g=r.name;if(o.has(g))return;o.add(g);let T=this._triggers.get(g).fallbackTransition,k=n.get(g)||mF,N=new aE(rE),V=new sE(this.id,g,i);this._engine.totalQueuedPlayers++,this._queue.push({element:i,triggerName:g,transition:T,fromState:k,toState:N,player:V,isFallbackTransition:!0})})}}removeNode(i,e){let n=this._engine;if(i.childElementCount&&this._signalRemovalForInnerTriggers(i,e),this.triggerLeaveAnimation(i,e,!0))return;let o=!1;if(n.totalAnimations){let r=n.players.length?n.playersByQueriedElement.get(i):[];if(r&&r.length)o=!0;else{let g=i;for(;g=g.parentNode;)if(n.statesByElement.get(g)){o=!0;break}}}if(this.prepareLeaveAnimationListeners(i),o)n.markElementAsRemoved(this.id,i,!1,e);else{let r=i[Qd];(!r||r===zK)&&(n.afterFlush(()=>this.clearElementCache(i)),n.destroyInnerAnimations(i),n._onRemovalComplete(i,e))}}insertNode(i,e){Qu(i,this._hostClassName)}drainQueuedTransitions(i){let e=[];return this._queue.forEach(n=>{let o=n.player;if(o.destroyed)return;let r=n.element,g=this._elementListeners.get(r);g&&g.forEach(w=>{if(w.name==n.triggerName){let T=sI(r,n.triggerName,n.fromState.value,n.toState.value);T._data=i,aI(n.player,w.phase,T,w.callback)}}),o.markedForDestroy?this._engine.afterFlush(()=>{o.destroy()}):e.push(n)}),this._queue=[],e.sort((n,o)=>{let r=n.transition.ast.depCount,g=o.transition.ast.depCount;return r==0||g==0?r-g:this._engine.driver.containsElement(n.element,o.element)?1:-1})}destroy(i){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,i)}},SF=class{bodyNode;driver;_normalizer;players=[];newHostElements=new Map;playersByElement=new Map;playersByQueriedElement=new Map;statesByElement=new Map;disabledNodes=new Set;totalAnimations=0;totalQueuedPlayers=0;_namespaceLookup={};_namespaceList=[];_flushFns=[];_whenQuietFns=[];namespacesByHostElement=new Map;collectedEnterElements=[];collectedLeaveElements=[];onRemovalComplete=(i,e)=>{};_onRemovalComplete(i,e){this.onRemovalComplete(i,e)}constructor(i,e,n){this.bodyNode=i,this.driver=e,this._normalizer=n}get queuedPlayers(){let i=[];return this._namespaceList.forEach(e=>{e.players.forEach(n=>{n.queued&&i.push(n)})}),i}createNamespace(i,e){let n=new CF(i,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[i]=n}_balanceNamespaceList(i,e){let n=this._namespaceList,o=this.namespacesByHostElement;if(n.length-1>=0){let g=!1,w=this.driver.getParentElement(e);for(;w;){let T=o.get(w);if(T){let k=n.indexOf(T);n.splice(k+1,0,i),g=!0;break}w=this.driver.getParentElement(w)}g||n.unshift(i)}else n.push(i);return o.set(e,i),i}register(i,e){let n=this._namespaceLookup[i];return n||(n=this.createNamespace(i,e)),n}registerTrigger(i,e,n){let o=this._namespaceLookup[i];o&&o.register(e,n)&&this.totalAnimations++}destroy(i,e){i&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{let n=this._fetchNamespace(i);this.namespacesByHostElement.delete(n.hostElement);let o=this._namespaceList.indexOf(n);o>=0&&this._namespaceList.splice(o,1),n.destroy(e),delete this._namespaceLookup[i]}))}_fetchNamespace(i){return this._namespaceLookup[i]}fetchNamespacesByElement(i){let e=new Set,n=this.statesByElement.get(i);if(n){for(let o of n.values())if(o.namespaceId){let r=this._fetchNamespace(o.namespaceId);r&&e.add(r)}}return e}trigger(i,e,n,o){if(pI(e)){let r=this._fetchNamespace(i);if(r)return r.trigger(e,n,o),!0}return!1}insertNode(i,e,n,o){if(!pI(e))return;let r=e[Qd];if(r&&r.setForRemoval){r.setForRemoval=!1,r.setForMove=!0;let g=this.collectedLeaveElements.indexOf(e);g>=0&&this.collectedLeaveElements.splice(g,1)}if(i){let g=this._fetchNamespace(i);g&&g.insertNode(e,n)}o&&this.collectEnterElement(e)}collectEnterElement(i){this.collectedEnterElements.push(i)}markElementAsDisabled(i,e){e?this.disabledNodes.has(i)||(this.disabledNodes.add(i),Qu(i,fF)):this.disabledNodes.has(i)&&(this.disabledNodes.delete(i),Fv(i,fF))}removeNode(i,e,n){if(pI(e)){let o=i?this._fetchNamespace(i):null;o?o.removeNode(e,n):this.markElementAsRemoved(i,e,!1,n);let r=this.namespacesByHostElement.get(e);r&&r.id!==i&&r.removeNode(e,n)}else this._onRemovalComplete(e,n)}markElementAsRemoved(i,e,n,o,r){this.collectedLeaveElements.push(e),e[Qd]={namespaceId:i,setForRemoval:o,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:r}}listen(i,e,n,o,r){return pI(e)?this._fetchNamespace(i).listen(e,n,o,r):()=>{}}_buildInstruction(i,e,n,o,r){return i.transition.build(this.driver,i.element,i.fromState.value,i.toState.value,n,o,i.fromState.options,i.toState.options,e,r)}destroyInnerAnimations(i){let e=this.driver.query(i,iE,!0);e.forEach(n=>this.destroyActiveAnimationsForElement(n)),this.playersByQueriedElement.size!=0&&(e=this.driver.query(i,cI,!0),e.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(i){let e=this.playersByElement.get(i);e&&e.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(i){let e=this.playersByQueriedElement.get(i);e&&e.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(i=>{if(this.players.length)return Xp(this.players).onDone(()=>i());i()})}processLeaveNode(i){let e=i[Qd];if(e&&e.setForRemoval){if(i[Qd]=zK,e.namespaceId){this.destroyInnerAnimations(i);let n=this._fetchNamespace(e.namespaceId);n&&n.clearElementCache(i)}this._onRemovalComplete(i,e.setForRemoval)}i.classList?.contains(fF)&&this.markElementAsDisabled(i,!1),this.driver.query(i,xxe,!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(i=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,o)=>this._balanceNamespaceList(n,o)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++){let o=this.collectedEnterElements[n];Qu(o,wxe)}if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){let n=[];try{e=this._flushAnimations(n,i)}finally{for(let o=0;o<n.length;o++)n[o]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++){let o=this.collectedLeaveElements[n];this.processLeaveNode(o)}if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){let n=this._whenQuietFns;this._whenQuietFns=[],e.length?Xp(e).onDone(()=>{n.forEach(o=>o())}):n.forEach(o=>o())}}reportError(i){throw yK(i)}_flushAnimations(i,e){let n=new oE,o=[],r=new Map,g=[],w=new Map,T=new Map,k=new Map,N=new Set;this.disabledNodes.forEach(ke=>{N.add(ke);let He=this.driver.query(ke,bxe,!0);for(let yt=0;yt<He.length;yt++)N.add(He[yt])});let V=this.bodyNode,q=Array.from(this.statesByElement.keys()),Z=kK(q,this.collectedEnterElements),X=new Map,te=0;Z.forEach((ke,He)=>{let yt=cF+te++;X.set(He,yt),ke.forEach(li=>Qu(li,yt))});let De=[],_e=new Set,he=new Set;for(let ke=0;ke<this.collectedLeaveElements.length;ke++){let He=this.collectedLeaveElements[ke],yt=He[Qd];yt&&yt.setForRemoval&&(De.push(He),_e.add(He),yt.hasAnimation?this.driver.query(He,Exe,!0).forEach(li=>_e.add(li)):he.add(He))}let Ce=new Map,Pe=kK(q,Array.from(_e));Pe.forEach((ke,He)=>{let yt=lI+te++;Ce.set(He,yt),ke.forEach(li=>Qu(li,yt))}),i.push(()=>{Z.forEach((ke,He)=>{let yt=X.get(He);ke.forEach(li=>Fv(li,yt))}),Pe.forEach((ke,He)=>{let yt=Ce.get(He);ke.forEach(li=>Fv(li,yt))}),De.forEach(ke=>{this.processLeaveNode(ke)})});let ye=[],vt=[];for(let ke=this._namespaceList.length-1;ke>=0;ke--)this._namespaceList[ke].drainQueuedTransitions(e).forEach(yt=>{let li=yt.player,Ai=yt.element;if(ye.push(li),this.collectedEnterElements.length){let io=Ai[Qd];if(io&&io.setForMove){if(io.previousTriggersValues&&io.previousTriggersValues.has(yt.triggerName)){let ge=io.previousTriggersValues.get(yt.triggerName),Po=this.statesByElement.get(yt.element);if(Po&&Po.has(yt.triggerName)){let os=Po.get(yt.triggerName);os.value=ge,Po.set(yt.triggerName,os)}}li.destroy();return}}let hi=!V||!this.driver.containsElement(V,Ai),it=Ce.get(Ai),pt=X.get(Ai),di=this._buildInstruction(yt,n,pt,it,hi);if(di.errors&&di.errors.length){vt.push(di);return}if(hi){li.onStart(()=>Pv(Ai,di.fromStyles)),li.onDestroy(()=>H0(Ai,di.toStyles)),o.push(li);return}if(yt.isFallbackTransition){li.onStart(()=>Pv(Ai,di.fromStyles)),li.onDestroy(()=>H0(Ai,di.toStyles)),o.push(li);return}let Cn=[];di.timelines.forEach(io=>{io.stretchStartingKeyframe=!0,this.disabledNodes.has(io.element)||Cn.push(io)}),di.timelines=Cn,n.append(Ai,di.timelines);let Oo={instruction:di,player:li,element:Ai};g.push(Oo),di.queriedElements.forEach(io=>Ac(w,io,[]).push(li)),di.preStyleProps.forEach((io,ge)=>{if(io.size){let Po=T.get(ge);Po||T.set(ge,Po=new Set),io.forEach((os,ca)=>Po.add(ca))}}),di.postStyleProps.forEach((io,ge)=>{let Po=k.get(ge);Po||k.set(ge,Po=new Set),io.forEach((os,ca)=>Po.add(ca))})});if(vt.length){let ke=[];vt.forEach(He=>{ke.push(vK(He.triggerName,He.errors))}),ye.forEach(He=>He.destroy()),this.reportError(ke)}let Rt=new Map,ut=new Map;g.forEach(ke=>{let He=ke.element;n.has(He)&&(ut.set(He,He),this._beforeAnimationBuild(ke.player.namespaceId,ke.instruction,Rt))}),o.forEach(ke=>{let He=ke.element;this._getPreviousPlayers(He,!1,ke.namespaceId,ke.triggerName,null).forEach(li=>{Ac(Rt,He,[]).push(li),li.destroy()})});let ct=De.filter(ke=>OK(ke,T,k)),We=new Map;RK(We,this.driver,he,k,Xd).forEach(ke=>{OK(ke,T,k)&&ct.push(ke)});let ui=new Map;Z.forEach((ke,He)=>{RK(ui,this.driver,new Set(ke),T,eE)}),ct.forEach(ke=>{let He=We.get(ke),yt=ui.get(ke);We.set(ke,new Map([...He?.entries()??[],...yt?.entries()??[]]))});let we=[],xe=[],le={};g.forEach(ke=>{let{element:He,player:yt,instruction:li}=ke;if(n.has(He)){if(N.has(He)){yt.onDestroy(()=>H0(He,li.toStyles)),yt.disabled=!0,yt.overrideTotalTime(li.totalTime),o.push(yt);return}let Ai=le;if(ut.size>1){let it=He,pt=[];for(;it=it.parentNode;){let di=ut.get(it);if(di){Ai=di;break}pt.push(it)}pt.forEach(di=>ut.set(di,Ai))}let hi=this._buildAnimation(yt.namespaceId,li,Rt,r,ui,We);if(yt.setRealPlayer(hi),Ai===le)we.push(yt);else{let it=this.playersByElement.get(Ai);it&&it.length&&(yt.parentPlayer=Xp(it)),o.push(yt)}}else Pv(He,li.fromStyles),yt.onDestroy(()=>H0(He,li.toStyles)),xe.push(yt),N.has(He)&&o.push(yt)}),xe.forEach(ke=>{let He=r.get(ke.element);if(He&&He.length){let yt=Xp(He);ke.setRealPlayer(yt)}}),o.forEach(ke=>{ke.parentPlayer?ke.syncPlayerEvents(ke.parentPlayer):ke.destroy()});for(let ke=0;ke<De.length;ke++){let He=De[ke],yt=He[Qd];if(Fv(He,lI),yt&&yt.hasAnimation)continue;let li=[];if(w.size){let hi=w.get(He);hi&&hi.length&&li.push(...hi);let it=this.driver.query(He,cI,!0);for(let pt=0;pt<it.length;pt++){let di=w.get(it[pt]);di&&di.length&&li.push(...di)}}let Ai=li.filter(hi=>!hi.destroyed);Ai.length?Ixe(this,He,Ai):this.processLeaveNode(He)}return De.length=0,we.forEach(ke=>{this.players.push(ke),ke.onDone(()=>{ke.destroy();let He=this.players.indexOf(ke);this.players.splice(He,1)}),ke.play()}),we}afterFlush(i){this._flushFns.push(i)}afterFlushAnimationsDone(i){this._whenQuietFns.push(i)}_getPreviousPlayers(i,e,n,o,r){let g=[];if(e){let w=this.playersByQueriedElement.get(i);w&&(g=w)}else{let w=this.playersByElement.get(i);if(w){let T=!r||r==rE;w.forEach(k=>{k.queued||!T&&k.triggerName!=o||g.push(k)})}}return(n||o)&&(g=g.filter(w=>!(n&&n!=w.namespaceId||o&&o!=w.triggerName))),g}_beforeAnimationBuild(i,e,n){let o=e.triggerName,r=e.element,g=e.isRemovalTransition?void 0:i,w=e.isRemovalTransition?void 0:o;for(let T of e.timelines){let k=T.element,N=k!==r,V=Ac(n,k,[]);this._getPreviousPlayers(k,N,g,w,e.toState).forEach(Z=>{let X=Z.getRealPlayer();X.beforeDestroy&&X.beforeDestroy(),Z.destroy(),V.push(Z)})}Pv(r,e.fromStyles)}_buildAnimation(i,e,n,o,r,g){let w=e.triggerName,T=e.element,k=[],N=new Set,V=new Set,q=e.timelines.map(X=>{let te=X.element;N.add(te);let De=te[Qd];if(De&&De.removedBeforeQueried)return new Kp(X.duration,X.delay);let _e=te!==T,he=Axe((n.get(te)||Cxe).map(Rt=>Rt.getRealPlayer())).filter(Rt=>{let ut=Rt;return ut.element?ut.element===te:!1}),Ce=r.get(te),Pe=g.get(te),ye=oF(this._normalizer,X.keyframes,Ce,Pe),vt=this._buildPlayer(X,ye,he);if(X.subTimeline&&o&&V.add(te),_e){let Rt=new sE(i,w,te);Rt.setRealPlayer(vt),k.push(Rt)}return vt});k.forEach(X=>{Ac(this.playersByQueriedElement,X.element,[]).push(X),X.onDone(()=>Txe(this.playersByQueriedElement,X.element,X))}),N.forEach(X=>Qu(X,uF));let Z=Xp(q);return Z.onDestroy(()=>{N.forEach(X=>Fv(X,uF)),H0(T,e.toStyles)}),V.forEach(X=>{Ac(o,X,[]).push(Z)}),Z}_buildPlayer(i,e,n){return e.length>0?this.driver.animate(i.element,e,i.duration,i.delay,i.easing,n):new Kp(i.duration,i.delay)}},sE=class{namespaceId;triggerName;element;_player=new Kp;_containsRealPlayer=!1;_queuedCallbacks=new Map;destroyed=!1;parentPlayer=null;markedForDestroy=!1;disabled=!1;queued=!0;totalTime=0;constructor(i,e,n){this.namespaceId=i,this.triggerName=e,this.element=n}setRealPlayer(i){this._containsRealPlayer||(this._player=i,this._queuedCallbacks.forEach((e,n)=>{e.forEach(o=>aI(i,n,void 0,o))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(i.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(i){this.totalTime=i}syncPlayerEvents(i){let e=this._player;e.triggerCallback&&i.onStart(()=>e.triggerCallback("start")),i.onDone(()=>this.finish()),i.onDestroy(()=>this.destroy())}_queueEvent(i,e){Ac(this._queuedCallbacks,i,[]).push(e)}onDone(i){this.queued&&this._queueEvent("done",i),this._player.onDone(i)}onStart(i){this.queued&&this._queueEvent("start",i),this._player.onStart(i)}onDestroy(i){this.queued&&this._queueEvent("destroy",i),this._player.onDestroy(i)}init(){this._player.init()}hasStarted(){return this.queued?!1:this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(i){this.queued||this._player.setPosition(i)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(i){let e=this._player;e.triggerCallback&&e.triggerCallback(i)}};function Txe(t,i,e){let n=t.get(i);if(n){if(n.length){let o=n.indexOf(e);n.splice(o,1)}n.length==0&&t.delete(i)}return n}function Dxe(t){return t??null}function pI(t){return t&&t.nodeType===1}function Mxe(t){return t=="start"||t=="done"}function AK(t,i){let e=t.style.display;return t.style.display=i??"none",e}function RK(t,i,e,n,o){let r=[];e.forEach(T=>r.push(AK(T)));let g=[];n.forEach((T,k)=>{let N=new Map;T.forEach(V=>{let q=i.computeStyle(k,V,o);N.set(V,q),(!q||q.length==0)&&(k[Qd]=Sxe,g.push(k))}),t.set(k,N)});let w=0;return e.forEach(T=>AK(T,r[w++])),g}function kK(t,i){let e=new Map;if(t.forEach(w=>e.set(w,[])),i.length==0)return e;let n=1,o=new Set(i),r=new Map;function g(w){if(!w)return n;let T=r.get(w);if(T)return T;let k=w.parentNode;return e.has(k)?T=k:o.has(k)?T=n:T=g(k),r.set(w,T),T}return i.forEach(w=>{let T=g(w);T!==n&&e.get(T).push(w)}),e}function Qu(t,i){t.classList?.add(i)}function Fv(t,i){t.classList?.remove(i)}function Ixe(t,i,e){Xp(e).onDone(()=>t.processLeaveNode(i))}function Axe(t){let i=[];return BK(t,i),i}function BK(t,i){for(let e=0;e<t.length;e++){let n=t[e];n instanceof Ov?BK(n.players,i):i.push(n)}}function Rxe(t,i){let e=Object.keys(t),n=Object.keys(i);if(e.length!=n.length)return!1;for(let o=0;o<e.length;o++){let r=e[o];if(!i.hasOwnProperty(r)||t[r]!==i[r])return!1}return!0}function OK(t,i,e){let n=e.get(t);if(!n)return!1;let o=i.get(t);return o?n.forEach(r=>o.add(r)):i.set(t,n),e.delete(t),!0}var zv=class{_driver;_normalizer;_transitionEngine;_timelineEngine;_triggerCache={};onRemovalComplete=(i,e)=>{};constructor(i,e,n){this._driver=e,this._normalizer=n,this._transitionEngine=new SF(i.body,e,n),this._timelineEngine=new EF(i.body,e,n),this._transitionEngine.onRemovalComplete=(o,r)=>this.onRemovalComplete(o,r)}registerTrigger(i,e,n,o,r){let g=i+"-"+o,w=this._triggerCache[g];if(!w){let T=[],k=[],N=NK(this._driver,r,T,k);if(T.length)throw cK(o,T);w=_xe(o,N,this._normalizer),this._triggerCache[g]=w}this._transitionEngine.registerTrigger(e,o,w)}register(i,e){this._transitionEngine.register(i,e)}destroy(i,e){this._transitionEngine.destroy(i,e)}onInsert(i,e,n,o){this._transitionEngine.insertNode(i,e,n,o)}onRemove(i,e,n){this._transitionEngine.removeNode(i,e,n)}disableAnimations(i,e){this._transitionEngine.markElementAsDisabled(i,e)}process(i,e,n,o){if(n.charAt(0)=="@"){let[r,g]=aF(n),w=o;this._timelineEngine.command(r,e,g,w)}else this._transitionEngine.trigger(i,e,n,o)}listen(i,e,n,o,r){if(n.charAt(0)=="@"){let[g,w]=aF(n);return this._timelineEngine.listen(g,e,w,r)}return this._transitionEngine.listen(i,e,n,o,r)}flush(i=-1){this._transitionEngine.flush(i)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(i){this._transitionEngine.afterFlushAnimationsDone(i)}};var fI="@",VK="@.disabled",bI=class{namespaceId;delegate;engine;_onDestroy;\u0275type=0;constructor(i,e,n,o){this.namespaceId=i,this.delegate=e,this.engine=n,this._onDestroy=o}get data(){return this.delegate.data}destroyNode(i){this.delegate.destroyNode?.(i)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(i,e){return this.delegate.createElement(i,e)}createComment(i){return this.delegate.createComment(i)}createText(i){return this.delegate.createText(i)}appendChild(i,e){this.delegate.appendChild(i,e),this.engine.onInsert(this.namespaceId,e,i,!1)}insertBefore(i,e,n,o=!0){this.delegate.insertBefore(i,e,n),this.engine.onInsert(this.namespaceId,e,i,o)}removeChild(i,e,n){this.parentNode(e)&&this.engine.onRemove(this.namespaceId,e,this.delegate)}selectRootElement(i,e){return this.delegate.selectRootElement(i,e)}parentNode(i){return this.delegate.parentNode(i)}nextSibling(i){return this.delegate.nextSibling(i)}setAttribute(i,e,n,o){this.delegate.setAttribute(i,e,n,o)}removeAttribute(i,e,n){this.delegate.removeAttribute(i,e,n)}addClass(i,e){this.delegate.addClass(i,e)}removeClass(i,e){this.delegate.removeClass(i,e)}setStyle(i,e,n,o){this.delegate.setStyle(i,e,n,o)}removeStyle(i,e,n){this.delegate.removeStyle(i,e,n)}setProperty(i,e,n){e.charAt(0)==fI&&e==VK?this.disableAnimations(i,!!n):this.delegate.setProperty(i,e,n)}setValue(i,e){this.delegate.setValue(i,e)}listen(i,e,n,o){return this.delegate.listen(i,e,n,o)}disableAnimations(i,e){this.engine.disableAnimations(i,e)}},TF=class extends bI{factory;constructor(i,e,n,o,r){super(e,n,o,r),this.factory=i,this.namespaceId=e}setProperty(i,e,n){e.charAt(0)==fI?e.charAt(1)=="."&&e==VK?(n=n===void 0?!0:!!n,this.disableAnimations(i,n)):this.engine.process(this.namespaceId,i,e.slice(1),n):this.delegate.setProperty(i,e,n)}listen(i,e,n,o){if(e.charAt(0)==fI){let r=kxe(i),g=e.slice(1),w="";return g.charAt(0)!=fI&&([g,w]=Oxe(g)),this.engine.listen(this.namespaceId,r,g,w,T=>{let k=T._data||-1;this.factory.scheduleListenerCallback(k,n,T)})}return this.delegate.listen(i,e,n,o)}};function kxe(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}function Oxe(t){let i=t.indexOf("."),e=t.substring(0,i),n=t.slice(i+1);return[e,n]}var xI=class{delegate;engine;_zone;_currentId=0;_microtaskId=1;_animationCallbacksBuffer=[];_rendererCache=new Map;_cdRecurDepth=0;constructor(i,e,n){this.delegate=i,this.engine=e,this._zone=n,e.onRemovalComplete=(o,r)=>{r?.removeChild(null,o)}}createRenderer(i,e){let n="",o=this.delegate.createRenderer(i,e);if(!i||!e?.data?.animation){let k=this._rendererCache,N=k.get(o);if(!N){let V=()=>k.delete(o);N=new bI(n,o,this.engine,V),k.set(o,N)}return N}let r=e.id,g=e.id+"-"+this._currentId;this._currentId++,this.engine.register(g,i);let w=k=>{Array.isArray(k)?k.forEach(w):this.engine.registerTrigger(r,g,i,k.name,k)};return e.data.animation.forEach(w),new TF(this,g,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(i,e,n){if(i>=0&&i<this._microtaskId){this._zone.run(()=>e(n));return}let o=this._animationCallbacksBuffer;o.length==0&&queueMicrotask(()=>{this._zone.run(()=>{o.forEach(r=>{let[g,w]=r;g(w)}),this._animationCallbacksBuffer=[]})}),o.push([e,n])}end(){this._cdRecurDepth--,this._cdRecurDepth==0&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}componentReplaced(i){this.engine.flush(),this.delegate.componentReplaced?.(i)}};var Nxe=(()=>{class t extends zv{constructor(e,n,o){super(e,n,o)}ngOnDestroy(){this.flush()}static \u0275fac=function(n){return new(n||t)(bi(cn),bi($0),bi(G0))};static \u0275prov=Ft({token:t,factory:t.\u0275fac})}return t})();function Lxe(){return new mI}function Fxe(t,i,e){return new xI(t,i,e)}var UK=[{provide:G0,useFactory:Lxe},{provide:zv,useClass:Nxe},{provide:Fa,useFactory:Fxe,deps:[Mx,zv,Oi]}],zxe=[{provide:$0,useClass:wI},{provide:oo,useValue:"NoopAnimations"},...UK],jK=[{provide:$0,useFactory:()=>new wI},{provide:oo,useFactory:()=>"NoopAnimations"},...UK],HK=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?zxe:jK}}static \u0275fac=function(n){return new(n||t)};static \u0275mod=$i({type:t});static \u0275inj=qi({providers:jK,imports:[cT]})}return t})();var qK={providers:[fj({eventCoalescing:!0}),TP($Y,GT()),YO(KO()),BU(zU()),vk(Ta,HK,gZ)]};var $K=[{path:"report/edit/:id",renderMode:oa.Server},{path:"categories/edit/:id",renderMode:oa.Server},{path:"**",renderMode:oa.Prerender}];var Bxe={providers:[uq(),IG($K)]},GK=Nj(qK,Bxe);var Vxe=()=>HO(pM,GK),jxe=Vxe;export{jxe as default,Tfe as \u0275destroyAngularServerApp,AG as \u0275extractRoutesAndCreateRouteTree,Sfe as \u0275getOrCreateAngularServerApp,Cse as \u0275resetCompiledComponents};
